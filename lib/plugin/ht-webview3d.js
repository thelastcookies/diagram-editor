!function(R){"use strict";function t(J){var y,o,i,F,R,s,K,P=[],l=0;y=n.createDiv(!0);var V=J.getView();V.insertBefore(y,J.getCanvas()),o=A.Default.createDiv(),o.style.WebkitTransformStyle="preserve-3d",o.style.MozTransformStyle="preserve-3d",o.style.transformStyle="preserve-3d",y.appendChild(o),[{event:"mousedown",style:"none"},{event:"mouseup",style:"auto"},{event:"touchstart",style:"none"},{event:"touchend",style:"auto"}].forEach(function(B){var M=B.style;O.addEventListener(V,B.event,function(){J.isDragProtectForWebView()&&(y.style.pointerEvents=M)})}),this.updateWebView=function(){if(J.getWidth()&&J.getHeight()){var n=J.getCanvas(),G=1*n.style.width.slice(0,-2),W=1*n.style.height.slice(0,-2);(P[0]!==G||P[1]!==W)&&(P[0]=G,P[1]=W,y.style.width=G+"px",y.style.height=W+"px",o.style.width=G+"px",o.style.height=W+"px");var N=J._projectMatrix[5]*P[1]/2;N!==i&&(i=N,y.style.WebkitPerspective=i+"px",y.style.MozPerspective=i+"px",y.style.perspective=i+"px"),s="translateZ("+i+"px)"+d(J._viewMatrix);var a=s+"translate("+P[0]/2+"px,"+P[1]/2+"px)";F===a||R||(o.style.WebkitTransform=a,o.style.MozTransform=a,o.style.transform=a,F=a),l++,K=!1,J.dm().each(function(z){z.isWebView&&r(z)});for(var k,D=o.children,Z=[],I=0,V=D.length;V>I;I++)k=D[I],k._isHtWebView&&k._renderCookie!==l&&Z.push(k);Z.length&&Z.forEach(function(p){o.removeChild(p)})}};var D=new Array(16),r=function(e){var j=e.getAttach();if(j){var r=J.isVisible(e);if(r&&j.parentNode!==o?o.appendChild(j):!r&&j.parentNode&&n.removeHTML(j),r){j._renderCookie=l,K=!0;var T=e.getFinalScale3d(),c=e._prefrenceSize;c&&c[0]?c[1]||(c[1]=c[0]/T[0]*T[1]):c=[T[0],T[1]],j.style.width=c[0]+"px",j.style.height=c[1]+"px";var U=1/c[0],Q=1/c[1],h=1,V=e.mat;D[0]=V[0]*U,D[1]=V[1]*U,D[2]=V[2]*U,D[3]=V[3]*U,D[4]=V[4]*Q,D[5]=V[5]*Q,D[6]=V[6]*Q,D[7]=V[7]*Q,D[8]=V[8]*h,D[9]=V[9]*h,D[10]=V[10]*h,D[11]=V[11]*h,D[12]=V[12],D[13]=V[13],D[14]=V[14],D[15]=V[15];var u=w(D,R?"translate("+P[0]/2+"px,"+P[1]/2+"px)"+s:""),i=j.$a2;i!==u&&(j.$a2=u,j.style.WebkitTransform=u,j.style.MozTransform=u,j.style.transform=u)}}}}function Z(V){return Math.abs(V)<1e-10?0:V}function d(O){var e=O;return"matrix3d("+Z(e[0])+","+Z(-e[1])+","+Z(e[2])+","+Z(e[3])+","+Z(e[4])+","+Z(-e[5])+","+Z(e[6])+","+Z(e[7])+","+Z(e[8])+","+Z(-e[9])+","+Z(e[10])+","+Z(e[11])+","+Z(e[12])+","+Z(-e[13])+","+Z(e[14])+","+Z(e[15])+")"}function w(f,s){var $=f,V="matrix3d("+Z($[0])+","+Z($[1])+","+Z($[2])+","+Z($[3])+","+Z(-$[4])+","+Z(-$[5])+","+Z(-$[6])+","+Z(-$[7])+","+Z($[8])+","+Z($[9])+","+Z($[10])+","+Z($[11])+","+Z($[12])+","+Z($[13])+","+Z($[14])+","+Z($[15])+")";return"translate(-50%,-50%)"+(s||"")+V}var g="ht",A=R[g],n=A.Default,O=n.getInternal(),S=O.superCall,K=A.graph3d.Graph3dView,H=K.prototype.validateImpl;K.prototype.validateImpl=function(){H.call(this);var i=this._webViewRenderer;i||(i=this._webViewRenderer=new t(this)),i.updateWebView()},K.prototype.isDragProtectForWebView=function(){return this._dragProtectForWebView},K.prototype.setDragProtectForWebView=function(f){this._dragProtectForWebView=f};var Q=A.WebView3d=function(){var X=this;S(Q,X),X.s({shape3d:"billboard","shape3d.reverse.flip":!0})},W=[1,1,1,1],Y=[0,0,0,0];n.def(g+"."+"WebView3d",A.Node,{ms_ac:["attach"],isWebView:!0,attachDOM:function(p,l,$){if(!p)return this.detachDOM();if("string"==typeof p){var I=document.createElement("iframe");I.src=p,p=I}var U=p.style;U.position="absolute",U.border=0,U.outline=0,U.padding=0,U.margin=0,p._isHtWebView=!0,this.setAttach(p),this._prefrenceSize=[l,$],this.s("shape3d.blend",Y)},detachDOM:function(){this.setAttach(null),this.s("shape3d.blend",this.getBgColor())},setBgColor:function(l){this.a("defaultBgColor",l),this.getAttach()||this.s("shape3d.blend",l)},getBgColor:function(){return this.a("defaultBgColor")||W}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);