!function(n,b){"use strict";var q="position",k="absolute",L="relative",j="px",Z="left",g="right",e="top",t="bottom",W="display",m="none",A="block",x=ht.Default,o=x.getInternal(),f=Math.floor,G=Math.ceil,s=Math.PI,c=null,S=n.parseInt,B=function(y){return y.getContext("2d")},U=function(){return document},D=function(B){return U().createElement(B)},Y=function(){return D("canvas")},M=function(j,y,i){j.style.setProperty(y,i,c)},_=function(S,G,q){x.def(ht.widget[S],G,q)},J=function(m,F){m.appendChild(F)},X=function(M,E){M.removeChild(E)},o=x.getInternal(),V=o.addEventListener,R=o.removeEventListener;ht.widget.RulerFrame=function(F){var t=this,X=t._view=o.createView(null,t),u=t.$1k=Y(),n=t.$2k=Y(),Z=t.$3k=Y(),p=t.$4k=Y();t._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},t._topRulerConfig={visible:!0},t._rightRulerConfig={visible:!1},t._bottomRulerConfig={visible:!1},t._leftRulerConfig={visible:!0},J(X,u),J(X,Z),J(X,n),J(X,p),M(X,q,L),M(X,"box-sizing","border-box"),M(X,"-moz-box-sizing","border-box"),M(u,q,k),M(n,q,k),M(Z,q,k),M(p,q,k),t.$14k=function(){t.$13k=1,t.iv()},t.$15k=function(n){if(t._topRulerConfig.guideVisible||t._rightRulerConfig.guideVisible||t._bottomRulerConfig.guideVisible||t._leftRulerConfig.guideVisible||t._defaultRulerConfig.guideVisible||(t._topRulerConfig.guideTipVisible||t._rightRulerConfig.guideTipVisible||t._bottomRulerConfig.guideTipVisible||t._leftRulerConfig.guideTipVisible||t._defaultRulerConfig.guideTipVisible)&&t._component){var F=X.getBoundingClientRect();t.$16k={x:n.clientX-F.left,y:n.clientY-F.top},t.$5k()}},t.setComponent(F)},_("RulerFrame",b,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(U){var y=this,P=y._component,i=y.getView();if(i){if(y._component=U,y.fp("component",P,U),P){var b=y.getComponentView(P);X(i,b),R(i,"mousemove",y.$15k),y.removeComponentPropertyChangeListener(P,y.$14k)}if(U){var c=y.getComponentView(U);J(i,c),M(c,q,k),V(i,"mousemove",y.$15k),y.addComponentPropertyChangeListener(U,y.$14k)}}},addComponentPropertyChangeListener:function(g,f){g&&g.mp&&g.mp(f)},removeComponentPropertyChangeListener:function(b,F){b&&b.ump&&b.ump(F)},getComponentHZoom:function(n){return n&&n.getZoom?n.getZoom():1},getComponentVZoom:function(H){return H&&H.getZoom?H.getZoom():1},getComponentViewRect:function(z){return z&&z.getViewRect?z.getViewRect():void 0},getComponentView:function(Q){return Q&&Q.getView?Q.getView():Q},invalidateComponent:function(x){x&&x.iv&&x.iv()},validateComponent:function(O){O&&O.validate&&O.validate()},$7k:function(p,V,r,f,z,E,I,Y,P,j,s,Q){if(V.visible){var g=this._defaultRulerConfig,_="borderStyle",y="borderColor",L="borderWidth",q="background",T=V[_]||g[_],v=V[y]||g[y],K=V[L]||g[L],$=V.size!=c?V.size:g.size,J=V[q]||g[q],Z=$+K,B=this.$6k(K,T,v,p,r,z,Z,I,Y,P,j,s,Q);M(p,z,"0px"),E?o.setCanvas(p,f-B,$):o.setCanvas(p,$,f-B),M(p,"background",J),M(p,W,A)}else M(p,W,m),M(this.getComponentView(this._component),z,"0px")},$6k:function(C,u,O,K,n,i,y,m,F,X,d,o,p){var c=0;return M(K,n,C+"px "+u+" "+O),M(this.getComponentView(this._component),i,y+j),m?(M(K,F,X+j),c+=X):M(K,F,"0px"),d?(M(K,o,p+j),c+=p):M(K,o,"0px"),c},validateImpl:function(){var j=this,n=j._component,L=j.$1k,h=j.$2k,S=j.$3k,H=j.$4k,F=j._view,b=j._defaultRulerConfig,p=j._topRulerConfig,q=j._rightRulerConfig,E=j._bottomRulerConfig,I=j._leftRulerConfig,P=b.size;if(F&&n){var U=p.size!=c?p.size:P,C=q.size!=c?q.size:P,Y=E.size!=c?E.size:P,m=I.size!=c?I.size:P;j.$7k(L,p,"border-bottom",F.offsetWidth,e,!0,I.visible,Z,m,q.visible,g,C),j.$7k(h,q,"border-left",F.offsetHeight,g,!1,p.visible,e,U,E.visible,t,Y),j.$7k(S,E,"border-top",F.offsetWidth,t,!0,I.visible,Z,m,q.visible,g,C),j.$7k(H,I,"border-right",F.offsetHeight,Z,!1,p.visible,e,U,E.visible,t,Y),j.$13k?delete j.$13k:j.invalidateComponent(n),j.validateComponent(n),j.$5k()}},$5k:function(){function P(i,h,k,d,l,O){if(h.visible){var M=B(i),S=h[U]||Q,P=h[m]!=c?h[m]:K,z=h[F]||b,H=h[y]||w,s=h.size!=c?h.size:D,ye=h[o]||C,Wr=h[R]||Z,Mr=h[t]||W,pl=h[$]!=c?h[$]:u,xr=h[f]!=c?h[f]:J,wo=h[I]!=c?h[I]:a,Em=h[L]!=c?h[L]:_,ag=h[G]!=c?h[G]:p,Fr=h[X]!=c?h[X]:A,dm=h[T]||Tf,As=h[r]||Wh;P&&(S=e[O]=e.$8k(e[O]||S,h[g]||q,h[j]||Y,d?N:V,Wr)),k.call(e,M,x,v,E,n,s,d?N:V,S,z,H,l,ye,Mr);var ek=e.$16k;(pl||xr)&&ek&&(d?e.$9k(M,ek.x,s,dm,As,pl,xr,wo,Em,ag,Fr):e.$10k(M,ek.y,s,dm,As,pl,xr,wo,Em,ag,Fr,l))}}var e=this,M=e.$1k,i=e.$2k,H=e.$3k,k=e.$4k,d=e._topRulerConfig,S=e._rightRulerConfig,z=e._bottomRulerConfig,h=e._leftRulerConfig,s=e._defaultRulerConfig,O=e._component,l=e.getComponentViewRect(O),N=e.getComponentHZoom(O),V=e.getComponentVZoom(O),x=l.x*N,E=x+l.width*N,v=l.y*V,n=v+l.height*V,D=e._defaultRulerConfig.size,U="defaultMajorTickSpacing",g="maxPhysicalMajorTickSpacing",j="minPhysicalMajorTickSpacing",m="tickSpacingAdaptable",F="majorTickTextFont",y="majorTickTextColor",o="majorTickColor",t="minorTickColor",$="guideVisible",f="guideTipVisible",I="guideTipBorderColor",L="guideTipTextColor",G="guideTipTextFont",X="guideTipBackground",T="guideColor",r="guideWidth",R="minMajorTickSpacing",Q=s[U],q=s[g],Y=s[j],K=s[m],b=s[F],w=s[y],C=s[o],Z=s[R],W=s[t],u=s[$],J=s[f],a=s[I],_=s[L],p=s[G],A=s[X],Tf=s[T],Wh=s[r];e._view&&O&&(P(M,d,e.$11k,!0,!1,"_currentTopMajorTickSpacing"),P(i,S,e.$12k,!1,!0,"_currentRightMajorTickSpacing"),P(H,z,e.$11k,!0,!0,"_currentBottomMajorTickSpacing"),P(k,h,e.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(N,H,Z,U,I){return Z>N*U?N=f(H/U/I)*I:N*U>H&&(N=G(Z/U/I)*I),N},getHTipText:function(T){var D=this,b=D._component,s=0,c=D._view.getBoundingClientRect();return b.lp?s=S(b.lp({x:T.x+c.left,y:T.y}).x):s-=S(this.getComponentView(b).style.left)||0,s},$9k:function(I,O,x,$,P,w,f,b,s,Z,F){var u=this,N=u._component;I.save(),o.translateAndScale(I,0,0,1);var e=O-(S(this.getComponentView(N).style.left)||0),L=0;if(O=u.getHTipText(u.$16k),w&&(I.beginPath(),I.fillStyle=$,I.rect(e,L,P,x),I.fill()),f){I.beginPath(),I.textAlign="center",I.textBaseline="middle",I.font=Z;var _=I.measureText(O).width+6;I.fillStyle=F,I.rect(e-_/2,L,_,x),I.fill(),I.strokeStyle=b,I.stroke(),I.beginPath(),I.fillStyle=s,I.fillText(O,e,L+x/2)}I.restore()},getVTipText:function(q){var Z=this,p=Z._component,F=0,a=Z._view.getBoundingClientRect();return p.lp?F=S(p.lp({x:q.x,y:q.y+a.top}).y):F-=S(this.getComponentView(p).style.top)||0,F},formatScaleText:function(e){return Math.round(e)},$10k:function(z,N,m,K,a,A,q,T,x,k,I,l){var u=this,v=u._component;z.save(),o.translateAndScale(z,0,0,1);var Z=m/2,O=N-(S(this.getComponentView(v).style.top)||0);if(N=u.getVTipText(u.$16k),A&&(z.beginPath(),z.fillStyle=K,z.rect(Z-m/2,O,m,a),z.fill()),q){z.translate(Z,O),z.rotate((l?90:-90)*s/180),z.translate(-Z,-O),z.beginPath(),z.textAlign="center",z.textBaseline="middle",z.font=k;var h=z.measureText(N).width+6;z.fillStyle=I,z.rect(Z-h/2,O-m/2,h,m),z.fill(),z.strokeStyle=T,z.stroke(),z.fillStyle=x,z.fillText(N,Z,O)}z.restore()},$11k:function(L,g,u,$,i,d,r,t,G,s,A,Q,T){L.save(),u=0;var Y=g,E=$,O=(Y+E)/2;g=0,$=E-Y,o.translateAndScale(L,0,0,1);var c=0,X=0,k=S(d/2),B=d-k,F=A?0:k,q=t*r,P=q/10;g-=q,$+=q,L.clearRect(g,0,$-g,d),L.beginPath(),L.fillStyle=T;var x=f(O/P)*P-Y;for(c=x;$>c;c+=P)L.rect(c,u+F,1,B);for(c=x;c>g;c-=P)L.rect(c,u+F,1,B);for(L.fill(),F=A?0:1,L.beginPath(),L.fillStyle=Q,x=f(O/q)*q-Y,c=x;$>c;c+=q)L.rect(c,u+F,1,d-1);for(c=x;c>g;c-=q)L.rect(c,u+F,1,d-1);L.fill();var v=S(/\d+px/.exec(G)[0]),H=(v||10)/2;L.textBaseline="middle",F=A?d-H-2:H+2,L.beginPath(),L.fillStyle=s,L.font=G;var b=f(O/q)*q/r;for(c=x,X=b;$>c;c+=q,X+=t){var V=this.getHScaleText?this.getHScaleText(c):X;L.fillText(this.formatScaleText(V),c+2,u+F)}for(c=x,X=b;c>g;c-=q,X-=t){var V=this.getHScaleText?this.getHScaleText(c):X;L.fillText(this.formatScaleText(V),c+2,u+F)}L.restore()},$12k:function(Y,t,P,c,q,r,k,E,F,p,v,w,$){function D(L,A,l,R,P,s){P=N.getVScaleText?N.getVScaleText(l):P,P=N.formatScaleText(P),Y.translate(L+A,l),Y.rotate(-R),Y.translate(-L-A,-l),Y.fillText(P,L+A+(s?2:1),l),Y.translate(L+A,l),Y.rotate(R),Y.translate(-L-A,-l)}Y.save(),t=0;var A=P,O=q,M=(A+O)/2;P=0,q=O-A,o.translateAndScale(Y,0,0,1);var G=0,N=this,V=0,U=S(r/2),j=r-U,H=v?0:U,e=E*k,L=e/10;P-=e,q+=e,Y.clearRect(t,0,r,q-P),Y.beginPath(),Y.fillStyle=$;var X=f(M/L)*L-A;for(G=X;q>G;G+=L)Y.rect(t+H,G,j,1);for(G=X;G>P;G-=L)Y.rect(t+H,G,j,1);for(Y.fill(),H=v?0:1,Y.beginPath(),Y.fillStyle=w,X=f(M/e)*e-A,G=X;q>G;G+=e)Y.rect(t+H,G,r-1,1);for(G=X;G>P;G-=e)Y.rect(t+H,G,r-1,1);Y.fill();var b=S(/\d+px/.exec(F)[0]),m=(b||10)/2,g=90*s/180;Y.textBaseline="middle",H=v?r-m:m+2,g=v?-g:g,Y.beginPath(),Y.fillStyle=p,Y.font=F;var l=f(M/e)*e/k;for(G=X,V=l;q>G;G+=e,V+=E)D(t,H,G,g,V,v);for(G=X,V=l;G>P;G-=e,V-=E)D(t,H,G,g,V,v);Y.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var Y=this,O=Y._component,E=Y._view;O&&Y.removeComponentPropertyChangeListener(O,Y.$14k),E&&(R(E,"mousemove",Y.$15k),X(E.parentNode,E),Y._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);