!function(w,H,a){"use strict";var C="ht",N=w[C],Y=N.Default,u=N.graph,W=Y.getInternal(),E=W.ui(),t=E.NodeUI.prototype,$=E.ShapeUI.prototype,y=u.GraphView,F=y.prototype,l=E.EdgeUI.prototype,r=N.Node,x=N.Shape,O=N.Edge,d=N.Group,K=Y.isTouchable,i=Y.isTouchEvent,D=Y.preventDefault,o=w.setTimeout,g=Y.grow,k=Y.isDragging,T=Y.getDistance,f=null,V=N.List,R="undefined"!=typeof Float32Array?Float32Array:Array,I=Math,n=I.PI,J="Crossing",A="No Crossing",L=n/2,s=2*n,z=I.atan2,j=I.sqrt,B=I.pow,G=I.sin,P=I.cos,q=I.min,S=I.max,h=I.abs,X=I.ceil,p=I.round,e=Y.unionPoint,c=Y.unionRect,m=Y.containsPoint,v=Y.clone,M="rgb(52, 152, 219)",Z="red",U={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},_={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var U=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],z=0;z<U.length;z++){var G=U[z];G=0===z%2?G/400*_.width:G/100*_.height,U[z]=G}return _.width>120&&(U[4]=_.width-26,U[6]=_.width-40,U[10]=_.width-40,U[12]=_.width-26,U[18]=33),U}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},b={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:M,rotation:.61},{type:"circle",rect:[200,120,70,70],background:M,rotation:.61},{type:"circle",rect:[200,220,70,70],background:M,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:M},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:M}]},Q={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:Z,rotation:.61}]},fd={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:M},{type:"circle",rect:[0,210,90,90],background:M},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:M}]},tn={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:Z},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:Z}]},ds={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:M}]},xp={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:Z}]},lr={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},bf={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},nj=function(j){var u=j.touches[0];return u?u:j.changedTouches[0]},Re=function(g,B,e,J){return z(J-B,e-g)},er=function(E,b){return{x:E.x*b,y:E.y*b}},ko=function(Y,J){Y.each(function(k){return Y.isSelected(k)?J(k):void 0})},sf=function(J,m){J.reverseEach(function(z){return J.isSelected(z)?m(z):void 0})},qn=function(j,n,S){var I,P,L,v,e,k=this,a=n,z=k.gv;if(j instanceof x){L=j.getSegments();var c=z.getDataUI(j);e=c._55O.$15l,L&&L.size()||(L=Vo(e)),j.isClosePath()&&L.indexOf(5)<0&&(L=new V(L._as),L.add(5)),I=ze(j,c,a),P=e[I]}else{var X=z.getDataUI(j);e=Zb(X,j.s("edge.points")),L=j.s("edge.segments"),L&&L.size()||(L=Vo(e)),e=e._as,I=ze(j,X,a),P=e[I]}if(L&&(v=L.get(a)),2===v||1===v||5===v){var u=e[I+1];5===v&&(u=e[0]);var D=mn(P,S,u);return D}return S},sr=function(d,S,t,M){var X=S/2,T=t/2,Q=gh(d,-X,-T,M),F=gh(d,X,-T,M),Y=gh(d,-X,T,M),L=gh(d,X,T,M),q=gh(d,0,-T,M),B=gh(d,X,0,M),R=gh(d,0,T,M),j=gh(d,-X,0,M);return[Q,F,Y,L,q,B,R,j]},mn=function(m,w,b){var F={x:w.x-m.x,y:w.y-m.y},$={x:b.x-m.x,y:b.y-m.y},r=j(B(b.x-m.x,2)+B(b.y-m.y,2)),c={x:$.x/r,y:$.y/r},M=F.x*c.x+F.y*c.y,v={x:c.x*M,y:c.y*M};return{x:m.x+v.x,y:m.y+v.y}},gh=function(l,W,y,f){var k=P(f)*W-G(f)*y,C=G(f)*W+P(f)*y;return l?{x:l.x+k,y:l.y+C}:{x:k,y:C}},cn=function(o,z){return z>2*o?o:z/2},pq=function(h,j,y,W){var F=T(h,j);return y=W?q(y,F):cn(y,F),F?y/=F:y=0,{x:h.x+(j.x-h.x)*y,y:h.y+(j.y-h.y)*y}},Gg=function(j,y){var Q,k,a=j.gv,s=j._data,n=s._40I,Y=s._41I,x=s.s("edge.offset"),S=s.s("edge.source.position"),I=s.s("edge.target.position"),t=s.s("edge.source.offset.x"),P=s.s("edge.source.offset.y"),B=s.s("edge.target.offset.x"),T=s.s("edge.target.offset.y"),O=s.s("edge.source.anchor.x"),v=s.s("edge.source.anchor.y"),X=s.s("edge.target.anchor.x"),h=s.s("edge.target.anchor.y");if(y?(Q=W.getEdgeAgentPosition(a,n,S,t,P,O,v),k=W.getEdgeAgentPosition(a,Y,I,B,T,X,h)):(Q=W.getEdgeAgentPosition(a,n,S,0,0,O,v),k=W.getEdgeAgentPosition(a,Y,I,0,0,X,h)),"points"===s.s("edge.type")&&x&&!s.s("edge.center")&&Q){var i=s.s("edge.points")||new V,D=i.size(),r=pq(Q,D?i.get(0):k,x,D),g=pq(k,D?i.get(D-1):Q,x,D);Q=r,k=g}return[Q,k]},Zb=function(q,H,T){var A=q._78o,a=q._data,J=a.s("edge.type"),L=[A.sourcePoint,A.targetPoint];return"points"===J?T&&(L=Gg(q)):L=A.center?J?T?Gg(q):Gg(q,!0):T?Gg(q):[A.c1,A.c2]:T?Gg(q):Gg(q,!0),H=new V(H?H._as:f),H.add(L[0],0),H.add(L[1]),H},Gf=function(l){return l=new V(l._as),l.removeAt(0),l.removeAt(l.size()-1),l},Vo=function(R){R._as||(R=new V(R));var i=new V;i.add(1);for(var o=1;o<R.size();o++)i.add(2);return i},Xk=function(i,p){return{x:(i.x+p.x)/2,y:(i.y+p.y)/2}},sq=function(q,w){return{x:q.x+1*(w.x-q.x)/4,y:q.y+1*(w.y-q.y)/4}},gr=function(Y,u){return{x:Y.x+3*(u.x-Y.x)/4,y:Y.y+3*(u.y-Y.y)/4}},ql=function(p,Y,n,Z){var k=Y.x+Y.width/2,M=Y.y+Y.height/2,W=j(k*k+M*M),r=z(M,k)+n;return{x:Z.x+W*P(r),y:Z.y+W*G(r)}},Sl=F.validateImpl,lk=F.isRectEditable,gp=F.isPointEditable,Dn=F._42,Zp=$._79o,$p=l._79o,ub=$._48O,Rb=$._47O,zg=t._48O,ro=t._80o,qd=$._80o,Rm=t.getSelectWidth,ne=t._47O,vp=l._47O,gs=F.isEditable,Ij=["northwest","north","northeast","east","southeast","south","southwest","west"],Xf=function(M,h,V,B,s,l,H,z,J,F){var E=M.x,K=M.y,i=M.width,m=M.height,d={x:E+i/2,y:K+m/2};B=B||0,h=gh(d,h.x-d.x,h.y-d.y,-B),H&&!z&&(h.x+=J,h.y+=F);var v=.01;if("northwest"===V?(h.x+s>E+i-v&&(h.x=E+i-s-v),h.y+s>K+m-v&&(h.y=K+m-s-v),M=e(h,{x:E+i,y:K+m})):"north"===V?(h.y+s>K+m-v&&(h.y=K+m-s-v),M=e({x:E,y:h.y},{x:E+i,y:K+m})):"northeast"===V?(h.x<E+s+v&&(h.x=E+s+v),h.y+s>K+m-v&&(h.y=K+m-s-v),M=e({x:E,y:h.y},{x:h.x,y:K+m})):"west"===V?(h.x+s>E+i-v&&(h.x=E+i-s-v),M=e({x:h.x,y:K},{x:E+i,y:K+m})):"east"===V?(h.x<E+s+v&&(h.x=E+s+v),M=e({x:E,y:K},{x:h.x,y:K+m})):"southwest"===V?(h.x+s>E+i-v&&(h.x=E+i-s-v),h.y<K+s+v&&(h.y=K+s+v),M=e({x:h.x,y:K},{x:E+i,y:h.y})):"south"===V?(h.y<K+s+v&&(h.y=K+s+v),M=e({x:E,y:K},{x:E+i,y:h.y})):"southeast"===V&&(h.x<E+s+v&&(h.x=E+s+v),h.y<K+s+v&&(h.y=K+s+v),M=e({x:E,y:K},h)),"keepRatio"===l&&(!H&&z||H&&!z)&&("northeast"===V||"southeast"===V||"northwest"===V||"southwest"===V)){var C=M.width,L=M.height,_=C/i,I=L/m,y=q(_,I);M.width=i*y,M.height=m*y,"northeast"===V?M.y=K+(m-M.height):"northwest"===V?(M.y=K+(m-M.height),M.x=E+(i-M.width)):"southwest"===V&&(M.x=E+(i-M.width))}M.x-=d.x,M.y-=d.y;var u=ql(f,M,B,d);return M.x=u.x-M.width/2,M.y=u.y-M.height/2,M},Xd=function(Q,S,q,I){var M=Q.getRotation(),u=S,w=u.x,J=u.y,O=u.width,F=u.height,v={x:w+u.width/2,y:J+u.height/2};I=gh(v,I.x-v.x,I.y-v.y,-M),"northwest"===q?u=e(I,{x:w+O,y:J+F}):"north"===q?u=e({x:w,y:I.y},{x:w+O,y:J+F}):"northeast"===q?u=e({x:w,y:I.y},{x:I.x,y:J+F}):"west"===q?u=e({x:I.x,y:J},{x:w+O,y:J+F}):"east"===q?u=e({x:w,y:J},{x:I.x,y:J+F}):"southwest"===q?u=e({x:I.x,y:J},{x:w+O,y:I.y}):"south"===q?u=e({x:w,y:J},{x:w+O,y:I.y}):"southeast"===q&&(u=e({x:w,y:J},I)),Q.setRect(u),u.x-=v.x,u.y-=v.y;var V=ql(Q,u,M,v);Q.p(V.x,V.y)},Ae=function(x,K,W,z,$,m,j,t){var H=f;m?(H=gh(f,$.x-K.x,$.y-K.y,-W),H.x-=j.x,H.y-=j.y):H=gh(f,$.x-K.x,$.y-K.y,0);var u={x:K.x+H.x,y:K.y+H.y};t&&(u=t(u.x,u.y)),u.e=x.getPoints().get(z).e,x.setPoint(z,u);var Z=x.getWidth(),v=x.getHeight(),I=x.p().x-Z/2,R=x.p().y-v/2;I-=K.x,R-=K.y;var g=ql(x,{x:I,y:R,width:Z,height:v},W,K);x.p(g.x,g.y)},ze=function(X,D,o){var i,G;if(X instanceof x?(i=X.getPoints(),G=X.getSegments()):X instanceof O&&"points"===X.s("edge.type")&&(i=X.s("edge.points"),G=X.s("edge.segments"),i=Zb(D,i)),G&&G.size()||(G=Vo(i)),X instanceof x&&X.isClosePath()&&G.indexOf(5)<0&&(G=new V(G._as),G.add(5)),G)for(var a=-1,f=0;f<G.size();f++){if(f===o)return a;var s=G.get(f);1===s?a+=1:2===s?a+=1:3===s?a+=2:4===s&&(a+=3)}},Ab=function(Y,f,b){var V,z;if(Y instanceof x?(V=Y.getPoints(),z=Y.getSegments()):Y instanceof O&&"points"===Y.s("edge.type")&&(V=Y.s("edge.points"),z=Y.s("edge.segments"),V=Zb(f,V)),z&&z.size()||(z=Vo(V)),z)for(var T=-1,r=0;r<z.size();r++){var C=z.get(r);if(1===C?T+=1:2===C?T+=1:3===C?T+=2:4===C&&(T+=3),T===b)return r}},Jj=function(L,q){var n=[L[0]-q[0],L[1]-q[1],L[2]-q[2]];return n},Bi=function(){var Z=new R(16);return Z[0]=1,Z[1]=0,Z[2]=0,Z[3]=0,Z[4]=0,Z[5]=1,Z[6]=0,Z[7]=0,Z[8]=0,Z[9]=0,Z[10]=1,Z[11]=0,Z[12]=0,Z[13]=0,Z[14]=0,Z[15]=1,Z},Yf=function($,P){var Z=$[0],n=$[1],E=$[2];return $[0]=P[0]*Z+P[4]*n+P[8]*E+P[12],$[1]=P[1]*Z+P[5]*n+P[9]*E+P[13],$[2]=P[2]*Z+P[6]*n+P[10]*E+P[14],$},Lc=function(D,h){if(h){var Z=G(h),z=P(h),R=D[0],i=D[1],A=D[2],b=D[3],p=D[8],g=D[9],F=D[10],q=D[11];D[0]=R*z-p*Z,D[1]=i*z-g*Z,D[2]=A*z-F*Z,D[3]=b*z-q*Z,D[8]=R*Z+p*z,D[9]=i*Z+g*z,D[10]=A*Z+F*z,D[11]=b*Z+q*z}},yd=function(A,o){for(var J=A.s("grid.row.count"),n=A.s("grid.column.count"),B=0;J>B;B++)for(var f=0;n>f;f++){var G=A.getCellRect(B,f);if(m(G,o))return{rowIndex:B,columnIndex:f,rect:G,grid:A}}return null},gd=function(M,y,v,b,w,d){var m={},t=v-M,C=b-y,f=I.sqrt(t*t+C*C),D=t/f,n=C/f,V=(-M+w)*D+(-y+d)*n;return 0>=V?(m.x=M,m.y=y):V>=f?(m.x=v,m.y=b):(m.x=M+V*D,m.y=y+V*n),t=w-m.x,C=d-m.y,m.z=I.sqrt(t*t+C*C),m},Ig=function(s,Y){var L,S,A,o,d,X,r,C,q=s.getPoints(),U=s.getSegments(),j=s.p(),M=s.getRotation();if(!U||!(U.indexOf(3)>0||U.indexOf(4)>0)){for(C=0;C<=q.size()-1;C++)if(C===q.size()-1?(d=q.get(0),o=q.get(C)):(o=q.get(C),d=q.get(C+1)),o=gh(j,o.x-j.x,o.y-j.y,M),d=gh(j,d.x-j.x,d.y-j.y,M),X=gd(o.x,o.y,d.x,d.y,Y.x,Y.y),r=X.z,r<(s.s("shape.border.width")||10)){S=o,A=d,L=C;break}if(L!=f){var l=gd(S.x,S.y,A.x,A.y,Y.x,Y.y),c=T(S,l);return{attachIndex:L,attachOffset:c}}}},_h=function(D){for(var n=D._data,h=n.p(),o=n.getRotation(),y=n.getPoints(),T=f,$=[],t=0;t<y.size();t++)T=y.get(t),$.push(gh(h,T.x-h.x,T.y-h.y,o));D._55O.$15l=$};Y.setImage("xeditinteractor_parentIcon",b),Y.setImage("xeditinteractor_hostIcon",Q),Y.setImage("xeditinteractor_edgeIcon",fd),Y.setImage("xeditinteractor_removeIcon",tn),Y.setImage("xeditinteractor_sourceIcon",ds),Y.setImage("xeditinteractor_targetIcon",xp),Y.setImage("xeditinteractor_elevationIcon",lr),Y.setImage("xeditinteractor_tallIcon",bf),F._editPointSize=K?24:9,F._edgeHelpers=["parent","remove","source","target"],F._leftTopHelpers=["parent"],F._rightTopHelpers=["host"],F._leftBottomHelpers=["edge"],F._rightBottomHelpers=["remove"],Ij=Ij.concat(Ij).concat(Ij),l._79o=function(){var r=this,W=r.gv,P=W.getZoom(),O=W._editInteractor,Q=$p.call(r);if(!Q)return null;var $=Gg(r,!0),U=$[0],V=$[1],n={x:Q.x,y:Q.y,width:Q.width,height:Q.height},R=e(U,V);if(O instanceof u.XEditInteractor){n=c(n,R);var A=r._55O,N=W.getEditPointSize()/P+2,t=0;A&&A._43O&&(t+=N/2,g(n,t))}return n},l._47O=function(n){var i=this,C=i.gv,b=C._editInteractor;b instanceof u.XEditInteractor||vp.call(i,n)},l.rectIntersects=function(D){var q=this,$=q._data,c=q.gv,O=c.getZoom(),t=q._55O,l=c._editInteractor;if(l instanceof u.XEditInteractor&&c.isEditable($)&&t&&t._43O&&"points"===$.s("edge.type")){var E=$.s("edge.points"),N=$.s("edge.segments");E=Zb(q,E),N&&N.size()||(N=Vo(E)),E=E._as;var v=!1,Z=K?5:1,F=D.x+Z,H=D.y+Z,p={x:F,y:H};if(l._edge===$&&l._hoverSegmentIndex>=0){var j=c._editInteractor._hoverSegmentIndex,r=N.get(j),o=ze($,q,j),y=f;if(o!=f&&o>=0){var G=E[o],V=c.getSegmentHoverWidth()/O;if(2===r||1===r){var x=E[o+1];y=rn(new _f(G.x,G.y),new _f(x.x,x.y),new _f(p.x-V,p.y-V),new _f(p.x+2*V,p.y+2*V)),y.$62l===J&&(v=!0)}else if(3===r){var Y=E[o+1],x=E[o+2];y=zn(new _f(G.x,G.y),new _f(Y.x,Y.y),new _f(x.x,x.y),new _f(p.x-V,p.y-V),new _f(p.x+2*V,p.y+2*V)),y.$62l===J&&(v=!0)}else if(4===r){var s=E[o+1],I=E[o+2];x=E[o+3],y=Mg(new _f(G.x,G.y),new _f(s.x,s.y),new _f(I.x,I.y),new _f(x.x,x.y),new _f(p.x-V,p.y-V),new _f(p.x+2*V,p.y+2*V)),y.$62l===J&&(v=!0)}}}if(v)return!0}return f},$._47O=function(c){var m=this,a=m.gv,d=a._editInteractor;d instanceof u.XEditInteractor||Rb.call(m,c)},$.rectIntersects=function(D){var I=this,b=I._data,U=I.gv,P=U.getZoom(),p=I._55O,q=U._editInteractor;if(q instanceof u.XEditInteractor&&U.isEditable(b)&&p&&p._43O){var R=p.$15l,l=!1,M=K?5:1,x=D.x+M,G=D.y+M,Y={x:x,y:G};if(R&&R.length===b.getPoints().size()||(_h(I),R=p.$15l),q._shape===b&&q._hoverSegmentIndex>=0){var N=b.getSegments();N&&N.size()||(N=Vo(R));var k=U._editInteractor._hoverSegmentIndex,o=N.get(k),h=ze(b,I,k),c=f;if(h!=f&&h>=0){var y=R[h],n=U.getSegmentHoverWidth()/P;if(2===o||1===o){var g=R[h+1];c=rn(new _f(y.x,y.y),new _f(g.x,g.y),new _f(Y.x-n,Y.y-n),new _f(Y.x+2*n,Y.y+2*n)),c.$62l===J&&(l=!0)}else if(3===o){var d=R[h+1],g=R[h+2];c=zn(new _f(y.x,y.y),new _f(d.x,d.y),new _f(g.x,g.y),new _f(Y.x-n,Y.y-n),new _f(Y.x+2*n,Y.y+2*n)),c.$62l===J&&(l=!0)}else if(4===o){var L=R[h+1],r=R[h+2];g=R[h+3],c=Mg(new _f(y.x,y.y),new _f(L.x,L.y),new _f(r.x,r.y),new _f(g.x,g.y),new _f(Y.x-n,Y.y-n),new _f(Y.x+2*n,Y.y+2*n)),c.$62l===J&&(l=!0)}}}if(l)return!0}return f},$._48O=function(){var s=this,F=s.gv,m=F._editInteractor;m instanceof u.XEditInteractor?(t._48O.call(s),s._55O._43O&&_h(s)):ub.call(s)},$._79o=function(){var Y=this,P=Y.gv,C=P.getZoom(),N=P._editInteractor,n=Zp.call(Y);if(n){var p={x:n.x,y:n.y,width:n.width,height:n.height};if(N instanceof u.XEditInteractor){var X=Y._55O,h=P.getEditPointSize()/C+2,M=0;X&&X._43O&&(M+=h/2,g(p,M))}return p}},t._47O=function(C){var A=this,H=A.gv,q=H._editInteractor;if(q instanceof u.XEditInteractor);else{var N=A._55O;N&&N._98o&&ne.call(A,C)}},t.getSelectWidth=function(){var C=this,o=C.gv,$=o._editInteractor,h=C._data;return o.isEditable(h)&&$ instanceof u.XEditInteractor?0:Rm.call(C)},t._80o=function(e){var t=this,R=t.gv._editInteractor;if(ro.call(t,e),R&&R._debug){e.save(),e.beginPath(),e.lineWidth=1,e.strokeStyle="green";var $=t._79o();$&&(e.rect($.x,$.y,$.width,$.height),e.stroke()),e.restore()}},$._80o=function(I){var e=this,W=e.gv._editInteractor;if(qd.call(e,I),W&&W._debug){I.save(),I.beginPath(),I.lineWidth=1,I.strokeStyle="green";var y=e._79o();I.rect(y.x,y.y,y.width,y.height),I.stroke(),I.restore()}},t._48O=function(){var R=this,r=R.gv,L=R._data,D=r._editInteractor,w=R._55O,V=L.p(),I=L.getRotation();if(D instanceof u.XEditInteractor){if(w._42O){var M=sr(V,L.getWidth(),L.getHeight(),I),H=M[0],b=M[1],j=M[2],T=M[3],a=M[4],z=M[5],k=M[6],C=M[7];w.$45l=[H,a,b,z,T,k,j,C]}}else zg.call(R)},F.getResizeMode=function(){return this.$25l||"normal"},F.setResizeMode=function(E){var p=this.$25l;this.$25l=E,this.fp("resizeMode",p,E)},F.getSnapAngle=function(){return this.$26l||Math.PI/36},F.setSnapAngle=function(V){var a=this.$26l;this.$26l=V,this.fp("snapAngle",a,V)},F.getSnapSpacing=function(){return this.$27l},F.setSnapSpacing=function(r){var p=this.$27l;this.$27l=r,this.fp("snapSpacing",p,r)},F.getPointSnapSpacing=function(){return this._pointSnapSpacing},F.setPointSnapSpacing=function(v){var I=this._pointSnapSpacing;this._pointSnapSpacing=v,this.fp("pointSnapSpacing",I,v)},F.setHelperEditableFunc=function(y){var m=this._helperEditableFunc;this._helperEditableFunc=y,this.fp("helperEditableFunc",m,y)},F.getHelperEditableFunc=function(){return this._helperEditableFunc},F.setLeftTopHelpers=function(Z){var J=this._leftTopHelpers;this._leftTopHelpers=Z,this.fp("leftTopHelpers",J,Z)},F.getLeftTopHelpers=function(){return this._leftTopHelpers},F.setLeftTopHelpersAlign=function(G){var O=this._leftTopHelpersAlign;this._leftTopHelpersAlign=G,this.fp("leftTopHelpersAlign",O,G)},F.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},F.setRightTopHelpers=function(c){var U=this._rightTopHelpers;this._rightTopHelpers=c,this.fp("rightTopHelpers",U,c)},F.getRightTopHelpers=function(){return this._rightTopHelpers},F.setRightTopHelpersAlign=function(W){var a=this._rightTopHelpersAlign;this._rightTopHelpersAlign=W,this.fp("rightTopHelpersAlign",a,W)},F.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},F.setLeftBottomHelpers=function(w){var $=this._leftBottomHelpers;this._leftBottomHelpers=w,this.fp("leftBottomHelpers",$,w)},F.getLeftBottomHelpers=function(){return this._leftBottomHelpers},F.setLeftBottomHelpersAlign=function(C){var U=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=C,this.fp("leftBottomHelpersAlign",U,C)},F.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},F.setRightBottomHelpers=function(H){var c=this._rightBottomHelpers;this._rightBottomHelpers=H,this.fp("rightBottomHelpers",c,H)},F.getRightBottomHelpers=function(){return this._rightBottomHelpers},F.setRightBottomHelpersAlign=function(z){var $=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=z,this.fp("rightBottomHelpersAlign",$,z)},F.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},F.setEdgeHelpers=function(M){var X=this._edgeHelpers;this._edgeHelpers=M,this.fp("edgeHelpers",X,M)},F.getEdgeHelpers=function(){return this._edgeHelpers},F.isHelperEditable=function(m,W){return m instanceof O&&("host"===W||"edge"===W||"elevation"===W||"tall"===W)?!1:m instanceof r&&("source"===W||"target"===W)?!1:"pointElevation"===W?this._helperEditableFunc?this._helperEditableFunc(m,W):!1:this._helperEditableFunc?this._helperEditableFunc(m,W):!0},F.getEditHelperSize=function(){return this._editHelperSize||(K?28:16)},F.setEditHelperSize=function(g){var t=this._editHelperSize;this._editHelperSize=g,this.fp("editHelperSize",t,g)},F.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},F.setEditRectBorderColor=function(c){var z=this.$28l;this.$28l=c,this.fp("editRectBorderColor",z,c)},F.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},F.setNodeBorderColor=function(M){var N=this.$29l;this.$29l=M,this.fp("nodeBorderColor",N,M)},F.getEditRectBorderStyle=function(){return this.$30l||"dashed"},F.setEditRectBorderStyle=function(U){var h=this.$30l;this.$30l=U,this.fp("editRectBorderStyle",h,U)},F.getControlPointBackground=function(){return this.$31l||"#ff0"},F.setControlPointBackground=function(j){var q=this.$31l;this.$31l=j,this.fp("controlPointBackground",q,j)},F.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},F.setControlPointBorderColor=function(t){var d=this.$32l;this.$32l=t,this.fp("controlPointBorderColor",d,t)},F.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},F.setJoinPointBackground=function(O){var o=this.$33l;this.$33l=O,this.fp("joinPointBackground",o,O)},F.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},F.setJoinPointBorderColor=function(V){var M=this.$34l;this.$34l=V,this.fp("joinPointBorderColor",M,V)},F.getDirectionLineColor=function(){return this.$35l||"#888"},F.setDirectionLineColor=function(S){var I=this.$35l;this.$35l=S,this.fp("directionLineColor",I,S)},F.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},F.setSegmentHoverColor=function(n){var T=this.$36l;this.$36l=n,this.fp("segmentHoverColor",T,n)},F.getSegmentHoverWidth=function(){return this.$22l||(K?16:8)},F.setSegmentHoverWidth=function(t){var x=this.$22l;this.$22l=t,this.fp("segmentHoverWidth",x,t)},F.getSnapPointBorderColor=function(){return this.$38l||"#f00"},F.setSnapPointBorderColor=function(M){var K=this.$38l;this.$38l=M,this.fp("snapPointBorderColor",K,M)},F.getEditRectPadding=function(){return this.$39l!=f?this.$39l:6},F.setEditRectPadding=function(p){var Q=this.$39l;this.$39l=p,this.fp("editRectPading",Q,p)},F.isRectEditable=function(T){var U=this,O=U._editInteractor;return O instanceof u.XEditInteractor?U._rectEditableFunc?U._rectEditableFunc(T):!0:lk.call(U,T)},F.isPointEditable=function(Y){var O=this,R=O._editInteractor;return R instanceof u.XEditInteractor?O._pointEditableFunc?O._pointEditableFunc(Y):!0:gp.call(O,Y)},F.validateImpl=function(){var t=this,S=t.$14l,o=t._editInteractor;if(S){var l=t.getWidth(),w=t.getHeight();(l!==S.clientWidth||w!==S.clientHeight)&&(o&&(o._68I=1),W.setCanvas(S,l,w),t._32I=1)}Sl.call(this)},F.isEditable=function(w){var l=gs.call(this,w),F=this._editInteractor;if(F instanceof u.XEditInteractor&&w instanceof O){if(!w.s("2d.editable"))return!1;var r=this.getEditableFunc();l=r?r(w):!0}return l},F._42=function(J,e){var P=this,R=P._editInteractor;Dn.call(P,J,e),R instanceof u.XEditInteractor&&R._68I&&R._42()},F.isSnapPoint=function(){return!0};var Te=function(c){arguments.length>0&&this.$58l(c)},Ad=Te.prototype;Ad.$58l=function(c){this.$62l=c,this.points=new Array},Ad.$56l=function(S){this.points.push(S)},Ad.$57l=function(Y){this.points=this.points.concat(Y)};var _f=function(l,C){arguments.length>0&&this.$58l(l,C)},Oq=_f.prototype;Oq.$58l=function(A,P){this.x=A,this.y=P},Oq.add=function(u){return new _f(this.x+u.x,this.y+u.y)},Oq.addEquals=function(y){return this.x+=y.x,this.y+=y.y,this},Oq.$55l=function(E){return new _f(this.x*E,this.y*E)},Oq.eq=function(M){return this.x==M.x&&this.y==M.y},Oq.lt=function(Q){return this.x<Q.x&&this.y<Q.y},Oq.lte=function(w){return this.x<=w.x&&this.y<=w.y},Oq.gt=function(H){return this.x>H.x&&this.y>H.y},Oq.gte=function(p){return this.x>=p.x&&this.y>=p.y},Oq.lerp=function(H,z){return new _f(this.x+(H.x-this.x)*z,this.y+(H.y-this.y)*z)},Oq.distanceFrom=function($){var y=this.x-$.x,D=this.y-$.y;return j(y*y+D*D)},Oq.min=function(l){return new _f(q(this.x,l.x),q(this.y,l.y))},Oq.max=function(U){return new _f(S(this.x,U.x),S(this.y,U.y))},Oq.toString=function(){return this.x+","+this.y};var Fm=function(){this.$58l(arguments)},xd=Fm.prototype;Fm.TO=1e-6,Fm.AC=6,xd.$58l=function(y){this.co=new Array;for(var Y=y.length-1;Y>=0;Y--)this.co.push(y[Y])},xd.$55l=function(q){for(var L=new Fm,p=0;p<=this.$50l()+q.$50l();p++)L.co.push(0);for(var p=0;p<=this.$50l();p++)for(var o=0;o<=q.$50l();o++)L.co[p+o]+=this.co[p]*q.co[o];return L},xd.$59l=function(){for(var l=this.$50l();l>=0&&h(this.co[l])<=Fm.TO;l--)this.co.pop()},xd.$50l=function(){return this.co.length-1},xd.$51l=function(){var y;switch(this.$59l(),this.$50l()){case 0:y=new Array;break;case 1:y=this.$52l();break;case 2:y=this.$53l();break;case 3:y=this.$54l();break;case 4:y=this.$63l();break;default:y=new Array}return y},xd.$52l=function(){var T=new Array,y=this.co[1];return 0!=y&&T.push(-this.co[0]/y),T},xd.$53l=function(){var B=new Array;if(2==this.$50l()){var z=this.co[2],S=this.co[1]/z,i=this.co[0]/z,F=S*S-4*i;if(F>0){var f=j(F);B.push(.5*(-S+f)),B.push(.5*(-S-f))}else 0==F&&B.push(.5*-S)}return B},xd.$63l=function(){var s=new Array;if(4==this.$50l()){var k=this.co[4],V=this.co[3]/k,m=this.co[2]/k,B=this.co[1]/k,z=this.co[0]/k,n=new Fm(1,-m,V*B-4*z,-V*V*z+4*m*z-B*B).$54l(),F=n[0],w=V*V/4-m+F;if(h(w)<=Fm.TO&&(w=0),w>0){var d=j(w),Z=3*V*V/4-d*d-2*m,_=(4*V*m-8*B-V*V*V)/(4*d),R=Z+_,Q=Z-_;if(h(R)<=Fm.TO&&(R=0),h(Q)<=Fm.TO&&(Q=0),R>=0){var A=j(R);s.push(-V/4+(d+A)/2),s.push(-V/4+(d-A)/2)}if(Q>=0){var A=j(Q);s.push(-V/4+(A-d)/2),s.push(-V/4-(A+d)/2)}}else if(0>w);else{var _=F*F-4*z;if(_>=-Fm.TO){if(0>_&&(_=0),_=2*j(_),Z=3*V*V/4-2*m,Z+_>=Fm.TO){var q=j(Z+_);s.push(-V/4+q/2),s.push(-V/4-q/2)}if(Z-_>=Fm.TO){var q=j(Z-_);s.push(-V/4+q/2),s.push(-V/4-q/2)}}}}return s},xd.$54l=function(){var v=new Array;if(3==this.$50l()){var J=this.co[3],a=this.co[2]/J,u=this.co[1]/J,n=this.co[0]/J,Y=(3*u-a*a)/3,q=(2*a*a*a-9*u*a+27*n)/27,Q=a/3,F=q*q/4+Y*Y*Y/27,s=q/2;if(h(F)<=Fm.TO&&(F=0),F>0){var O,V,l=j(F);O=-s+l,V=O>=0?B(O,1/3):-B(-O,1/3),O=-s-l,O>=0?V+=B(O,1/3):V-=B(-O,1/3),v.push(V-Q)}else if(0>F){var Z=j(-Y/3),M=z(j(-F),-s)/3,S=P(M),o=G(M),d=j(3);v.push(2*Z*S-Q),v.push(-Z*(S+d*o)-Q),v.push(-Z*(S-d*o)-Q)}else{var O;O=s>=0?-B(s,1/3):B(-s,1/3),v.push(2*O-Q),v.push(-O-Q)}}return v};var Tk=function(J,N){arguments.length>0&&this.$58l(J,N)},hf=Tk.prototype;hf.$58l=function(W,J){this.x=W,this.y=J},hf.length=function(){return j(this.x*this.x+this.y*this.y)},hf.$60l=function(d){return this.x*d.x+this.y*d.y};var bd=function(p,o,G,w){var T,E=(w.x-G.x)*(p.y-G.y)-(w.y-G.y)*(p.x-G.x),L=(o.x-p.x)*(p.y-G.y)-(o.y-p.y)*(p.x-G.x),y=(w.y-G.y)*(o.x-p.x)-(w.x-G.x)*(o.y-p.y);if(0!=y){var t=E/y,j=L/y;t>=0&&1>=t&&j>=0&&1>=j?(T=new Te(J),T.points.push(new _f(p.x+t*(o.x-p.x),p.y+t*(o.y-p.y)))):T=new Te(A)}else T=0==E||0==L?new Te("C"):new Te("P");return T},$q=function(u,B,j,y,f){var N,s,Y,T,G,_,W,P=y.min(f),w=y.max(f),k=new Te(A);N=B.$55l(-2),Y=u.add(N.add(j)),N=u.$55l(-2),s=B.$55l(2),T=N.add(s),G=new _f(u.x,u.y),W=new Tk(y.y-f.y,f.x-y.x),_=y.x*f.y-f.x*y.y;for(var g=new Fm(W.$60l(Y),W.$60l(T),W.$60l(G)+_).$51l(),$=0;$<g.length;$++){var v=g[$];if(v>=0&&1>=v){var i=u.lerp(B,v),Q=B.lerp(j,v),z=i.lerp(Q,v);y.x==f.x?P.y<=z.y&&z.y<=w.y&&(k.$62l=J,k.$56l(z)):y.y==f.y?P.x<=z.x&&z.x<=w.x&&(k.$62l=J,k.$56l(z)):z.gte(P)&&z.lte(w)&&(k.$62l=J,k.$56l(z))}}return k},zn=function(S,j,o,e,C){var u=e.min(C),M=e.max(C),O=new _f(M.x,u.y),m=new _f(u.x,M.y),c=$q(S,j,o,u,O),q=$q(S,j,o,O,M),f=$q(S,j,o,M,m),E=$q(S,j,o,m,u),T=new Te(A);return T.$57l(c.points),T.$57l(q.points),T.$57l(f.points),T.$57l(E.points),T.points.length>0&&(T.$62l=J),T},On=function(T,O,z,W,e,M){var p,k,B,q,P,Z,Q,I,R,c,H=e.min(M),E=e.max(M),h=new Te(A);p=T.$55l(-1),k=O.$55l(3),B=z.$55l(-3),q=p.add(k.add(B.add(W))),P=new Tk(q.x,q.y),p=T.$55l(3),k=O.$55l(-6),B=z.$55l(3),q=p.add(k.add(B)),Z=new Tk(q.x,q.y),p=T.$55l(-3),k=O.$55l(3),B=p.add(k),Q=new Tk(B.x,B.y),I=new Tk(T.x,T.y),c=new Tk(e.y-M.y,M.x-e.x),R=e.x*M.y-M.x*e.y;for(var U=new Fm(c.$60l(P),c.$60l(Z),c.$60l(Q),c.$60l(I)+R).$51l(),V=0;V<U.length;V++){var F=U[V];if(F>=0&&1>=F){var v=T.lerp(O,F),Y=O.lerp(z,F),d=z.lerp(W,F),f=v.lerp(Y,F),t=Y.lerp(d,F),D=f.lerp(t,F);e.x==M.x?H.y<=D.y&&D.y<=E.y&&(h.$62l=J,h.$56l(D)):e.y==M.y?H.x<=D.x&&D.x<=E.x&&(h.$62l=J,h.$56l(D)):D.gte(H)&&D.lte(E)&&(h.$62l=J,h.$56l(D))}}return h},Mg=function(C,Z,V,B,z,s){var P=z.min(s),D=z.max(s),i=new _f(D.x,P.y),F=new _f(P.x,D.y),x=On(C,Z,V,B,P,i),t=On(C,Z,V,B,i,D),H=On(C,Z,V,B,D,F),u=On(C,Z,V,B,F,P),j=new Te(A);return j.$57l(x.points),j.$57l(t.points),j.$57l(H.points),j.$57l(u.points),j.points.length>0&&(j.$62l=J),j},rn=function(x,j,o,q){var y=o.min(q),W=o.max(q),M=new _f(W.x,y.y),O=new _f(y.x,W.y),T=bd(y,M,x,j),Z=bd(M,W,x,j),w=bd(W,O,x,j),F=bd(O,y,x,j),U=new Te(A);return U.$57l(T.points),U.$57l(Z.points),U.$57l(w.points),U.$57l(F.points),U.points.length>0&&(U.$62l=J),U},Nb=u.XEditInteractor=function(q){var H=this,V=H._view=document.createElement("canvas");V.className="editCanvas",V.style.position="absolute",Nb.superClass.constructor.call(H,q)};Y.def(Nb,u.Interactor,{ms_edit:1,setUp:function(){var h=this,z=h.gv,W=z.getView(),l=h._view;Nb.superClass.setUp.call(h),z.setEditInteractor(h),z.$14l=l,z._79O?W.insertBefore(l,z._79O):W.appendChild(l);var Z=h.$49l=h.$11l.bind(h);z.dm().md(Z),z.sm().ms(Z),z.mp(Z)},tearDown:function(){var p=this,B=p.gv,W=B.getView(),u=p.$49l;Nb.superClass.tearDown.call(p),B.setEditInteractor(f),B.$14l=f,W.removeChild(p._view),B.dm().umd(u),B.sm().ums(u),B.ump(u)},clear:function(){var Q=this,x=Q.gv;delete Q._hoverSegmentIndex,delete Q._edge,delete Q._shape,delete x._editing,delete Q.$10l,delete Q.$13l,delete Q.$9l,delete Q._removePointIndex,delete Q._lp,Q.$12l="",delete Q.$40l,delete Q.$67l,delete Q.$72l,delete Q.$73l,delete Q.$75l,delete Q.$1l,delete Q.$3l,delete Q.$2l,delete Q.$92l,delete Q.$93l,delete Q.$94l,Q.clearDragging()},handle_keydown:function(Z){this.$48l!==Z.shiftKey&&(this.$48l=Z.shiftKey,this.handle_mousemove(Z,a,!0))},handle_keyup:function(u){this.$48l!==u.shiftKey&&(this.$48l=u.shiftKey,this.handle_mousemove(u,a,!0))},handle_touchstart:function(S){this.handle_mousemove(S),this.handle_mousedown(S)},handle_mousedown:function(Z){D(Z);var u=this,j=u.$13l,V=u.gv,i=V.dm(),X=V.sm(),$=V.getZoom(),J=V.lp(Z),y=Y.isDoubleClick(Z),p=Y.isLeftButton(Z),G=u.$7l,_=u._shape,R=u._hoverSegmentIndex,w=u._edge,d=u.$87l,P=u.$88l,T=function(){u._68I||d===u.$87l&&P===u.$88l||u.$43l()};if(7!==u.$67l&&(delete u.$87l,delete u.$88l),p&&(_||w)&&R>=0&&y&&(_&&X.contains(_)||w&&X.contains(w))){var g=qn.call(u,_||w,R,J);return u.addShapePoint(_||w,R,g),o(function(){u.handle_mousemove(Z)},40),void 0}if(p&&(_||w)&&u._removePointIndex>=0&&y)return u.removeShapePoint(),u.$5l=1,o(function(){u.handle_mousemove(Z)},40),void 0;if(!p||!V._editing)return T(),void 0;if(_&&j>=0){var H=_.getPoints().get(j),F=_.p(),E=gh(F,H.x-F.x,H.y-F.y,-G+_.getRotation());S=gh(F,J.x-F.x,J.y-F.y,-G),u.$24l={x:S.x-E.x,y:S.y-E.y},u.startDragging(Z),i.beginTransaction(),u.fi({kind:"beginEditPoint",event:Z,data:_,index:j}),u.$88l=j,u.$87l=_}else if(u.$10l){var A=V.sm().getSelection(),l=u.$6l,n=u.$1l={},q=u.$3l={},C=u.$16l[U[u.$10l]],M={x:l.x,y:l.y},k={x:l.x+l.width/2,y:l.y+l.height/2};u.$24l={x:J.x-C.x/$,y:J.y-C.y/$},u.$2l=v(u.$8l),u.$4l=v(l),A.each(function(g){if(g instanceof r){var v=g.p(),o=g.getWidth(),w=g.getHeight(),L=gh(k,v.x-k.x,v.y-k.y,-G);n[g.getId()]={x:v.x-o/2,y:v.y-w/2,width:o,height:w},q[g.getId()]={x:(L.x-M.x)/l.width,y:(L.y-M.y)/l.height}}}),u.startDragging(Z),i.beginTransaction(),u.fi({kind:"beginEditRect",event:Z,direction:u.$10l})}else if(w&&j>=0){var s=Zb(V.getDataUI(w),w.s("edge.points")),H=s.get(j);u.$24l={x:J.x-H.x,y:J.y-H.y},u.startDragging(Z),i.beginTransaction(),u.fi({kind:"beginEditPoint",event:Z,data:w,index:j}),u.$88l=j,u.$87l=w}else if(u.$40l){var l=u.$6l,k={x:l.x+l.width/2,y:l.y+l.height/2},O=v(u.$23l);O.x/=$,O.y/=$;var c=gh(k,O.x-k.x,O.y-k.y,-G),S=gh(k,J.x-k.x,J.y-k.y,-G);u.$24l={x:S.x-c.x,y:S.y-c.y},u.startDragging(Z),i.beginTransaction(),u.fi({kind:"beginEditRotation",event:Z,data:u._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(u.$67l)>=0){var z=u.$67l;(7===z||8===z||9===z)&&i.beginTransaction(),u.startDragging(Z)}else if(u.$71l&&y&&u.$79l(u.$71l,J)){var e=X.toSelection();i.beginTransaction(),e.each(function(s){i.remove(s)}),i.endTransaction()}T()},$11l:function(){var n=this,B=n.gv;B._editing&&(n.$13l==f||n._shape==f&&n._edge==f)&&(n.$73l==f||1!==n.$67l&&5!==n.$67l&&6!==n.$67l)||(n.$5l=1),n._68I=1},$46l:function(L){var s=this,x=s.gv,u=x.lp(L),H=[];return sf(x,function(T){var s=x.getDataUI(T);if(s){var z=s._79o();m(z,u)&&H.push(T)}}),H},$47l:function(F){var W=this,A=W.$13l,q=W.gv.dm();W.$10l?(W.fi({kind:"endEditRect",event:F,direction:W.$10l}),q.endTransaction()):W._shape&&A>=0?(W.fi({kind:"endEditPoint",event:F,data:W._shape,index:A}),q.endTransaction()):W._edge&&A>=0?(W.fi({kind:"endEditPoint",event:F,data:W._edge,index:A}),q.endTransaction()):W.$23l&&W.$40l&&(W.fi({kind:"endEditRotation",event:F}),q.endTransaction())},handleWindowTouchEnd:function(Q){this.handleWindowMouseUp(Q)},handleWindowMouseUp:function(M){var B=this,z=B.gv,$=z.dm(),Q=B._shape,e=B._edge,j=B.$13l,I=B.$40l,v=B.$9l,l=B.$10l,K=B.$67l;if((Q||e)&&j>=0&&v>=0){var E,m;if(Q){var U=Q.p(),Y=Q.getRotation();E=Q.getPoints(),m=E.get(v),Ae(Q,U,Y,j,m,!1)}else if(E=Zb(z.getDataUI(e),e.s("edge.points"),!0),m=E.get(v),0===j){var S=E.get(0);e.s("edge.source.offset.x",m.x-S.x),e.s("edge.source.offset.y",m.y-S.y)}else if(j===E.size()-1){var b=E.get(E.size()-1);e.s("edge.target.offset.x",m.x-b.x),e.s("edge.target.offset.y",m.y-b.y)}else"points"===e.s("edge.type")&&(E.set(j,m),e.s("edge.points",Gf(E)))}B.$47l(M);var y=B.$73l;1===K?($.beginTransaction(),y?z.sm().each(function(I){if(I.setHost&&z.isHelperEditable(I,"host")){I.setHost(y);
var u=B.$75l,k=B.$74l;u&&(I.s("attach.row.index",u.rowIndex),I.s("attach.column.index",u.columnIndex)),k&&(I.s("attach.index",k.attachIndex),I.s("attach.offset",k.attachOffset),I.s("attach.offset.relative",!1),I.s("attach.offset.opposite",!1))}}):z.sm().each(function(T){T.setHost&&z.isHelperEditable(T,"host")&&(T.setHost(f),T.s("attach.row.index",a),T.s("attach.column.index",a),T.s("attach.index",a),T.s("attach.offset",a),T.s("attach.offset.relative",!1),T.s("attach.offset.opposite",!1))}),$.endTransaction()):2===K?($.beginTransaction(),y?z.sm().each(function(Q){Q.setParent&&z.isHelperEditable(Q,"parent")&&Q.setParent(y)}):z.sm().each(function(S){S.setParent&&z.isHelperEditable(S,"parent")&&S.setParent(f)}),$.endTransaction()):3===K?y&&($.beginTransaction(),z.sm().each(function(K){if(z.isHelperEditable(K,"edge")&&K instanceof r&&y instanceof r){var T=new N.Edge;$.add(T),T.setSource(K),T.setTarget(y),B.onEdgeCreated&&B.onEdgeCreated(M,T)}}),$.endTransaction()):5===K||6===K?y&&($.beginTransaction(),z.sm().each(function(q){q instanceof O&&y instanceof r&&(5===K&&z.isHelperEditable(q,"source")?q.setSource(y):6===K&&z.isHelperEditable(q,"source")&&q.setTarget(y))}),$.endTransaction()):(7===K||8===K||9===K)&&$.endTransaction(),(l||I)&&B.$43l(!0),i(M)?(B.clear(),delete B.$64l,B._68I||B.$43l()):(B.handle_mousemove(M,!0),K&&!B._68I&&B.$43l())},handleWindowTouchMove:function(W){this.handleWindowMouseMove(W)},handleWindowMouseMove:function(Q){this._78I(Q)},handle_mousemove:function(v,$,l){if(!this._pause){if(!l){var D=i(v)?nj(v):v;this.$61l={clientX:D.clientX,clientY:D.clientY}}if($===!0||!k()){var e=this,t=e.gv,M=!1,h=f;e.clear(),t.sm().size()>0&&(h=t.lp(l?e.$61l:v),M=e._79I(v,h)),M&&(t._editing=1),e.$12l!==e.$65l&&(e.$65l=e.$12l,e.setCursor(e.$12l)),e.$40l!==e.$64l&&(e.$64l=e.$40l,e._68I||e.$43l()),e._hoverSegmentIndex!==e.$66l&&(e.$66l=e._hoverSegmentIndex,e._68I||e.$43l())}}},_78I:function(Z){this.autoScroll(Z);var v=this,A=v.gv,i=A.lp(Z),V=A.getZoom(),H=v.$13l;if((v._shape||v._edge)&&H>=0){var d,M,_,b=v._shape,E=v._edge,C=v.$24l,S=A.getPointSnapSpacing(),R=function(d,y){return S==f||isNaN(S)?{x:d,y:y}:{x:p(d/S)*S,y:p(y/S)*S}};if(b){d=b.getPoints();var k=b.p(),l=b.getRotation(),X=0;M=gh(k,i.x-k.x,i.y-k.y,-l),Ae(b,k,l,H,i,!0,C,R),v.fi({kind:"betweenEditPoint",event:Z,data:b,index:H})}else if(E){d=Zb(A.getDataUI(E),E.s("edge.points"),!0),i.x-=C.x,i.y-=C.y,M=i;var K,$,W=E.s("edge.offset"),N=d.size(),J=N>2;if(0===H){var y=d.get(0);W&&(y=pq(y,d.get(1),-W,J),i=pq(i,d.get(1),-W,J)),K=i.x-y.x,$=i.y-y.y,_=R(K,$),E.s("edge.source.offset.x",_.x),E.s("edge.source.offset.y",_.y)}else if(H===N-1){var c=d.get(N-1);W&&(c=pq(c,d.get(N-2),-W,J),i=pq(i,d.get(N-2),-W,J)),K=i.x-c.x,$=i.y-c.y,_=R(K,$),E.s("edge.target.offset.x",_.x),E.s("edge.target.offset.y",_.y)}else"points"===E.s("edge.type")&&(_=R(i.x,i.y),_.e=d.get(H).e,d.set(H,_),E.s("edge.points",Gf(d)));v.fi({kind:"betweenEditPoint",event:Z,data:E,index:H})}if(delete v.$9l,A.isSnapPoint(b)||A.isSnapPoint(E))for(X=0;X<d.size();X++)if(X!==H){var a=d.get(X);if(T(a,M)<A.getEditPointSize()/V){v.$9l=X;break}}}else if(v.$10l){var C=v.$24l;i.x-=C.x,i.y-=C.y;var Q=A.sm().getSelection(),u=v.$1l,t=v.$7l,G=v.$10l,B=v.$4l,w=v.$2l,g=A.getEditRectPadding()/V,P=2*g,e=A.getSnapSpacing(),U=e!=f&&!isNaN(e),F=Xf(w,i,G,t,2*g,A.getResizeMode(),U,!0),D=v.$6l;if(U){var q=F.width-P,m=F.height-P,I=p(q/e)*e,Bf=p(m/e)*e,oo=I-q,pj=Bf-m;("west"===G||"northwest"===G||"southwest"===G)&&(oo=-oo),("north"===G||"northwest"===G||"northeast"===G)&&(pj=-pj),F=Xf(w,i,G,t,2*g,A.getResizeMode(),U,!1,oo,pj)}v.$8l=F,D.x=F.x+g,D.y=F.y+g,D.width=F.width-P,D.height=F.height-P;var Xm=F.x+F.width/2,tb=F.y+F.height/2,hf=D.x,Dq=D.y,ig=D.width/B.width,Hq=D.height/B.height;Q.each(function(L){if(L instanceof r&&A.isEditable(L)&&A.isRectEditable(L)){var g=u[L.getId()],P=v.$3l[L.getId()],S={x:g.x+g.width/2,y:g.y+g.height/2},O=0,i=0,s=G,W=180*h(t-L.getRotation())/n;"northeast"===G?W>=315||45>W?(O=g.width*ig+g.x,i=g.height*(1-Hq)+g.y,s="northeast"):W>=45&&135>W?(O=g.width*(1-Hq)+g.x,i=g.height*(1-ig)+g.y,s="northwest"):W>=135&&225>W?(O=g.width*(1-ig)+g.x,i=g.height*Hq+g.y,s="southwest"):(O=g.width*Hq+g.x,i=g.height*ig+g.y,s="southeast"):"north"===G?W>=315||45>W?(i=g.height*(1-Hq)+g.y,s="north"):W>=45&&135>W?(O=g.width*(1-Hq)+g.x,s="west"):W>=135&&225>W?(i=g.height*Hq+g.y,s="south"):(O=g.width*Hq+g.x,s="east"):"northwest"===G?W>=315||45>W?(O=g.width*(1-ig)+g.x,i=g.height*(1-Hq)+g.y,s="northwest"):W>=45&&135>W?(O=g.width*(1-Hq)+g.x,i=g.height*ig+g.y,s="southwest"):W>=135&&225>W?(O=g.width*ig+g.x,i=g.height*Hq+g.y,s="southeast"):(O=g.width*Hq+g.x,i=g.height*(1-ig)+g.y,s="northeast"):"west"===G?W>=315||45>W?(O=g.width*(1-ig)+g.x,s="west"):W>=45&&135>W?(i=g.height*ig+g.y,s="south"):W>=135&&225>W?(O=g.width*ig+g.x,s="east"):(i=g.height*(1-ig)+g.y,s="north"):"southwest"===G?W>=315||45>W?(O=g.width*(1-ig)+g.x,i=g.height*Hq+g.y,s="southwest"):W>=45&&135>W?(O=g.width*Hq+g.x,i=g.height*ig+g.y,s="southeast"):W>=135&&225>W?(O=g.width*ig+g.x,i=g.height*(1-Hq)+g.y,s="northeast"):(O=g.width*(1-Hq)+g.x,i=g.height*(1-ig)+g.y,s="northwest"):"east"===G?W>=315||45>W?(O=g.width*ig+g.x,s="east"):W>=45&&135>W?(i=g.height*(1-ig)+g.y,s="north"):W>=135&&225>W?(O=g.width*(1-ig)+g.x,s="west"):(i=g.height*ig+g.y,s="south"):"south"===G?W>=315||45>W?(i=g.height*Hq+g.y,s="south"):W>=45&&135>W?(O=g.width*Hq+g.x,s="east"):W>=135&&225>W?(i=g.height*(1-Hq)+g.y,s="north"):(O=g.width*(1-Hq)+g.x,s="west"):"southeast"===G&&(W>=315||45>W?(O=g.width*ig+g.x,i=g.height*Hq+g.y,s="southeast"):W>=45&&135>W?(O=g.width*Hq+g.x,i=g.height*(1-ig)+g.y,s="northeast"):W>=135&&225>W?(O=g.width*(1-ig)+g.x,i=g.height*(1-Hq)+g.y,s="northwest"):(O=g.width*(1-Hq)+g.x,i=g.height*ig+g.y,s="southwest"));var B=gh(S,O-S.x,i-S.y,L.getRotation());Xd(L,g,s,{x:B.x,y:B.y});var C=hf+D.width*P.x,V=Dq+D.height*P.y,T={x:C,y:V};T=gh({x:Xm,y:tb},T.x-Xm,T.y-tb,t),L.p(T.x,T.y)}}),v.fi({kind:"betweenEditRect",event:Z,direction:G})}else if(v.$23l&&v.$40l){var er=v.$8l,wc=er.width,Pk=er.height,k={x:er.x+wc/2,y:er.y+Pk/2},C=v.$24l,_j=v.$23l,hd=_j.x/V-k.x,db=_j.y/V-k.y,ze=j(hd*hd+db*db),De=Math.asin(C.x/ze),Zd=A.sm().getSelection(),hj=L+z(i.y-k.y,i.x-k.x)-De,If=A.getSnapAngle(),hj=p(hj/If)*If;0>hj&&(hj+=s);var Ai=hj-v.$7l,Ac=[k.x,0,k.y];Zd.each(function(m){if(A.isEditable(m)&&A.isRotationEditable(m)&&A.isVisible(m)){var H=Jj(m.p3(),Ac),U=Bi();Lc(U,-Ai),m.setRotation(m.getRotation()+Ai),Yf(H,U),m.p3(Ac[0]+H[0],Ac[1]+H[1],Ac[2]+H[2])}}),v.$7l=hj,v.fi({kind:"betweenEditRotation",event:Z})}else if([1,2,3,5,6].indexOf(v.$67l)>=0)v.$72l=Z,v.$78l||(v.$78l=1,o(function(){Y.isDragging()&&v.$43l(),delete v.$78l},12));else if(7===v.$67l){if(v.$87l instanceof x){var b=v.$87l,Yd=v.$88l,xq=Y.clone(b.getPoints().get(Yd)),Ce=i.y-xq.y;xq.e||(xq.e=0),v.$92l||(v.$92l=xq.e),xq.e=v.$92l-Ce,b.setPoint(Yd,xq)}else if(v.$87l instanceof O){var E=v.$87l,Yd=v.$88l,d=Zb(A.getDataUI(E),E.s("edge.points")),xq=d.get(Yd),Ce=i.y-xq.y;xq.e||(xq.e=0),v.$92l||(v.$92l=xq.e),xq.e=v.$92l-Ce,d.set(Yd,xq),E.s("edge.points",Gf(d))}}else if(8===v.$67l){var Zd=A.sm().getSelection(),Gh=v.$93l;Gh||(Gh=v.$93l={}),Zd.each(function(o){if(o.p3){var X=o.p3(),W=Gh[o.getId()];W==f&&(W=Gh[o.getId()]=X[1]),o.p3([X[0],W-(i.y-v.$90l.y/V),X[2]])}})}else if(9===v.$67l){var Zd=A.sm().getSelection(),uc=v.$94l;uc||(uc=v.$94l={}),Zd.each(function(F){if(F.s3){var Z=F.s3(),$=uc[F.getId()];$==f&&($=uc[F.getId()]=Z[1]);var D=$-(i.y-v.$91l.y/V);0>D&&(D=.01),F.s3([Z[0],D,Z[2]])}})}},$79l:function(D,R){var k=this,e=k.gv,N=e.getZoom(),X=e.getEditHelperSize(),h=D.x/N,Y=D.y/N,K=X/N,p=K/2;return m({x:h-p,y:Y-p,width:K,height:K},R)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(n,N){for(var U=this,o=U.gv,q=o.getZoom(),c=o.getEditPointSize(),X=c/q,b=X/2,M=U.$46l(n),K=0;K<M.length;K++){var B,u,C=M[K],e=o.getDataUI(C);if(e&&e._55O){var A=e._55O;if(A._43O&&C instanceof O){if(B=C.s("edge.points"),B=Zb(e,B),u=C.s("edge.segments"),u&&u.size()||(u=Vo(B)),U.$42l(C,N,B._as,u,"edge"))return!0;if("points"===C.s("edge.type")&&U.$41l(C,N,B._as,u,"edge"))return}if(A._43O&&C instanceof x&&A.$15l&&A.$15l.length===C.getPoints().size()){if(B=A.$15l,u=C.getSegments(),u&&u.size()||(u=Vo(B)),U.$42l(C,N,B,u,"shape"))return!0;if(U.$41l(C,N,B,u,"shape"))return}}}if(U.$16l){var B,Z=U.$16l,J=Z[3].x-Z[7].x,h=Z[3].y-Z[7].y,g=j(J*J+h*h),_=Z[1].x-Z[5].x,r=Z[1].y-Z[5].y,R=j(_*_+r*r),d={x:N.x*q,y:N.y*q};if(U._80I(d,0,Z[0],"northwest",g,R)||U._80I(d,1,Z[1],"north",g,R)||U._80I(d,2,Z[2],"northeast",g,R)||U._80I(d,7,Z[7],"west",g,R)||U._80I(d,3,Z[3],"east",g,R)||U._80I(d,6,Z[6],"southwest",g,R)||U._80I(d,5,Z[5],"south",g,R)||U._80I(d,4,Z[4],"southeast",g,R))return!0}if(U.$23l){var w=U.$23l,i=w.x/q,T=w.y/q;if(m({x:i-b,y:T-b,width:X,height:X},N))return U.$40l=1,U.$12l=U.getHelperCursor("rotation")||"crosshair",!0}return U.$68l&&U.$79l(U.$68l,N)?(U.$67l=1,U.$12l=U.getHelperCursor("host")||"crosshair",!0):U.$69l&&U.$79l(U.$69l,N)?(U.$67l=2,U.$12l=U.getHelperCursor("parent")||"crosshair",!0):U.$70l&&U.$79l(U.$70l,N)?(U.$67l=3,U.$12l=U.getHelperCursor("edge")||"crosshair",!0):U.$71l&&U.$79l(U.$71l,N)?(U.$67l=4,U.$12l=U.getHelperCursor("remove")||"crosshair",!0):U.$82l&&U.$79l(U.$82l,N)?(U.$67l=5,U.$12l=U.getHelperCursor("source")||"crosshair",!0):U.$83l&&U.$79l(U.$83l,N)?(U.$67l=6,U.$12l=U.getHelperCursor("target")||"crosshair",!0):U._pointElevationHelperPoint&&U.$79l(U._pointElevationHelperPoint,N)?(U.$67l=7,U.$12l=U.getHelperCursor("pointElevation")||"crosshair",!0):U.$90l&&U.$79l(U.$90l,N)?(U.$67l=8,U.$12l=U.getHelperCursor("elevation")||"crosshair",!0):U.$91l&&U.$79l(U.$91l,N)?(U.$67l=9,U.$12l=U.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(Y,u,R,E,b,w){var o=this,I=o.gv,$=I.getEditPointSize(),P=$/2,i=I.sm(),Q=I.isDirectionEditable;if(Q&&1===i.size()){var k=i.ld();if(Q=Q.bind(I),k instanceof r){if(!Q(k,E))return!1;if("east"===E){if(Q(k,"northeast")&&Q(k,"southeast")&&2*$>=w)return!1}else if("west"===E){if(Q(k,"northwest")&&Q(k,"southwest")&&2*$>=w)return!1}else if("north"===E){if(Q(k,"northwest")&&Q(k,"northeast")&&2*$>=b)return!1}else if("south"===E&&Q(k,"southwest")&&Q(k,"southeast")&&2*$>=b)return!1}}else{if(2*$>=b&&("north"===E||"south"===E))return!1;if(2*$>=w&&("east"===E||"west"===E))return!1}if(m({x:R.x-P,y:R.y-P,width:$,height:$},Y)){if(o.$10l!==E){var X=180*o.$7l/n,J="";X>=337.5||22.5>X?J="north":X>=22.5&&67.5>X?J="northeast":X>=67.5&&112.5>X?J="east":X>=112.5&&157.5>X?J="southeast":X>=157.5&&202.5>X?J="south":X>=202.5&&247.5>X?J="southwest":X>=247.5&&292.5>X?J="west":X>=292.5&&337.5>X&&(J="northwest");var W=Ij.indexOf(J),J=Ij[u-(1-W)+8];switch(J){case"northwest":o.$12l="nwse-resize";break;case"northeast":o.$12l="nesw-resize";break;case"southwest":o.$12l="nesw-resize";break;case"southeast":o.$12l="nwse-resize";break;case"north":o.$12l="ns-resize";break;case"east":o.$12l="ew-resize";break;case"south":o.$12l="ns-resize";break;case"west":o.$12l="ew-resize"}o.$10l=E}return!0}return!1},$42l:function(F,u,T,O,H){var s,_=this,D=_.gv,M=D.getEditPointSize(),I=M/D.getZoom(),N=-1,v={x:u.x,y:u.y,width:0,height:0},A=function(B){"shape"===H?_._shape=F:_._edge=F,_._removePointIndex=B},E=function(f){"shape"===H?_._shape=F:_._edge=F,_.$13l=f,_.$12l="crosshair"};for(g(v,I/2),N=T.length-1,s=O.size()-1;s>=0;s--){var z=O.get(s);if(1===z||2===z)N-=1;else if(3===z){var Q=T[N-1];if(m(v,Q))return E(N-1),!0;N-=2}else if(4===z){var w=T[N-1],o=T[N-2];if(m(v,w))return E(N-1),!0;if(m(v,o))return E(N-2),!0;N-=3}}for(N=T.length-1,s=O.size()-1;s>=0;s--){var z=O.get(s),L=T[N];if(m(v,L))return A(N),E(N),!0;1===z||2===z?N-=1:3===z?N-=2:4===z&&(N-=3)}return!1},$41l:function(w,r,h,y,Z){var H=this,q=H.gv,P=-1,T=0,B={x:r.x,y:r.y,width:0,height:0},D=function(U,A){H._hoverSegmentIndex=A,H._lp=r,"shape"===Z?H._shape=w:H._edge=w};for(g(B,q.getSegmentHoverWidth()/2/q.getZoom()),w instanceof x&&w.isClosePath()&&y.indexOf(5)<0&&(y=new V(y._as),y.add(5));T<y.size();T++){var _=y.get(T);if(1===_){var Y=h[P],v=h[P+1];if(Y){var m=rn(new _f(Y.x,Y.y),new _f(v.x,v.y),new _f(B.x,B.y),new _f(B.x+B.width,B.y+B.height));if(m.$62l===J&&m.points.length>0)return D(m,T),!0}P+=1}else if(2===_){var Y=h[P],v=h[P+1],m=rn(new _f(Y.x,Y.y),new _f(v.x,v.y),new _f(B.x,B.y),new _f(B.x+B.width,B.y+B.height));if(m.$62l===J&&m.points.length>0)return D(m,T),!0;P+=1}else if(3===_){var Y=h[P],X=h[P+1],e=h[P+2],m=zn(new _f(Y.x,Y.y),new _f(X.x,X.y),new _f(e.x,e.y),new _f(B.x,B.y),new _f(B.x+B.width,B.y+B.height));if(m.$62l===J)return D(m,T),!0;P+=2}else if(4===_){var Y=h[P],U=h[P+1],O=h[P+2],e=h[P+3],m=Mg(new _f(Y.x,Y.y),new _f(U.x,U.y),new _f(O.x,O.y),new _f(e.x,e.y),new _f(B.x,B.y),new _f(B.x+B.width,B.y+B.height));if(m.$62l===J)return D(m,T),!0;P+=3}else if(5===_){var Y=h[P],v=h[0];if(Y){var m=rn(new _f(Y.x,Y.y),new _f(v.x,v.y),new _f(B.x,B.y),new _f(B.x+B.width,B.y+B.height));if(m.$62l===J&&m.points.length>0)return D(m,T),!0}}}return!1},addShapePoint:function(n,q,a){var N=this,E=N.gv,Y=E.dm();if(Y.beginTransaction(),0===arguments.length&&(n=N._shape||N._edge,q=N._hoverSegmentIndex,a=N._lp),n instanceof x||n instanceof O){var v=ze(n,E.getDataUI(n),q);if(!isNaN(q)&&a&&!isNaN(v)){var p=a;if(n instanceof x){var W=n.p(),U=n.getRotation(),y=n.toSegments();y&&y.size()||(y=Vo(n.getPoints())),n.isClosePath()&&y.indexOf(5)<0&&(y=new V(y._as),y.add(5));var d=y.get(q),c="addPoint",F="removePointAt";if(2===d||1===d){var S={x:p.x,y:p.y};y.add(d,q),S=gh(W,S.x-W.x,S.y-W.y,-U),n[c](S,v+1)}else if(3===d){var e=n.getPoints(),t=e.get(v),I=e.get(v+2),S={x:p.x,y:p.y};S=gh(W,S.x-W.x,S.y-W.y,-U);var H=Xk(t,S),A=Xk(S,I);y.removeAt(q),y.add(3,q),y.add(3,q),n.setPoint(v+1,S),n[c](A,v+2),n[c](H,v+1)}else if(4===d){var e=n.getPoints(),t=e.get(v),I=e.get(v+3),S={x:p.x,y:p.y};S=gh(W,S.x-W.x,S.y-W.y,-U);var H=sq(t,S),A=gr(t,S),h=sq(S,I),Z=gr(S,I);y.removeAt(q),y.add(4,q),y.add(4,q),n[F](v+1),n[F](v+1),n[c](S,v+1),n[c](Z,v+2),n[c](h,v+2),n[c](A,v+1),n[c](H,v+1)}else if(5===d){var S={x:p.x,y:p.y};y.add(2,q),S=gh(W,S.x-W.x,S.y-W.y,-U),n[c](S,v+1)}n.isClosePath()&&y.remove(5),n.setSegments(y);var b=n.getWidth(),k=n.getHeight(),r=n.p().x-b/2,T=n.p().y-k/2;r-=W.x,T-=W.y;var w=ql(n,{x:r,y:T,width:b,height:k},U,W);n.p(w.x,w.y)}else if(n instanceof O){if("points"!==n.s("edge.type"))return Y.endTransaction(),void 0;var e=n.s("edge.points");y=n.s("edge.segments"),e=Zb(E.getDataUI(n),e),y&&y.size()||(y=Vo(e)),y=new V(y._as.slice(0)),e=new V(e._as.slice(0));var d=y.get(q);if(2===d||1===d){var S={x:p.x,y:p.y};y.add(d,q),e.add(S,v+1)}else if(3===d){var t=e.get(v),I=e.get(v+2),S={x:p.x,y:p.y},H=Xk(t,S),A=Xk(S,I);y.removeAt(q),y.add(3,q),y.add(3,q),e.set(v+1,S),e.add(A,v+2),e.add(H,v+1)}else if(4===d){var t=e.get(v),I=e.get(v+3),S={x:p.x,y:p.y},H=sq(t,S),A=gr(t,S),h=sq(S,I),Z=gr(S,I);y.removeAt(q),y.add(4,q),y.add(4,q),e.removeAt(v+1),e.removeAt(v+1),e.add(S,v+1),e.add(Z,v+2),e.add(h,v+2),e.add(A,v+1),e.add(H,v+1)}n.s("edge.points",Gf(e)),n.s("edge.segments",y)}}}Y.endTransaction()},removeShapePoint:function(U,p){var a=this,Y="removeAt",w=a.gv,o=w.dm();if(o.beginTransaction(),0===arguments.length&&(U=a._shape||a._edge,p=a._removePointIndex),p>=0&&(U instanceof x||U instanceof O)){var m=Ab(U,a.gv.getDataUI(U),p),k=p;if(U instanceof x){var N=U.p(),J=U.toSegments();J&&J.size()||(J=Vo(U.getPoints()));var Z=J.get(m),$="removePointAt";if(1===Z&&0===k)if(U.getPoints().size()>1){var r=J.get(m+1);J[Y](m+1),3===r?U[$](k+1):4===r&&(U[$](k+2),U[$](k+1)),U[$](k)}else U.dm().remove(U);else 2===Z||1===Z?(J[Y](m),U[$](k)):3===Z?(J[Y](m),U[$](k),U[$](k-1)):4===Z&&(J[Y](m),U[$](k),U[$](k-1),U[$](k-2));U.setSegments(J);var Q=U.getWidth(),b=U.getHeight(),W=U.p().x-Q/2,c=U.p().y-b/2;W-=N.x,c-=N.y;var l=ql(U,{x:W,y:c,width:Q,height:b},U.getRotation(),N);U.p(l.x,l.y)}else if(U instanceof O){if("points"!==U.s("edge.type"))return o.endTransaction(),void 0;var j=U.s("edge.points");if(J=U.s("edge.segments"),j&&(j=Zb(a.gv.getDataUI(U),j),J&&J.size()||(J=Vo(j))),0===p||p===j.size()-1)return o.endTransaction(),void 0;J=new V(J._as.slice(0)),j=new V(j._as.slice(0));var Z=J.get(m);2===Z||1===Z?(J[Y](m),j[Y](k)):3===Z?(J[Y](m),j[Y](k),j[Y](k-1)):4===Z&&(J[Y](m),j[Y](k),j[Y](k-1),j[Y](k-2)),U.s("edge.segments",J),U.s("edge.points",Gf(j))}}o.endTransaction()},changeShapeSegment:function(z,i,C){var E=this,c=E.gv,P=c.dm();if(P.beginTransaction(),1!==arguments.length||isNaN(z)||(C=z,z=E._shape||E._edge,i=E._hoverSegmentIndex),z instanceof x||z instanceof O){var I=ze(z,E.gv.getDataUI(z),i);if(!isNaN(i)&&!isNaN(I))if(z instanceof x){var R=z.p(),m=z.toSegments();m&&m.size()||(m=Vo(z.getPoints()));var $=m.get(i),q=z.toPoints();if(1===C||2===C)1===$||2===$?m.set(i,C):3===$?(m.set(i,C),q.removeAt(I+1)):4===$&&(m.set(i,C),q.removeAt(I+1),q.removeAt(I+1));else if(3===C){var l=function(){var f=q.get(I),S=q.get(I+1),Y=Xk(f,S);m.set(i,3),q.add(Y,I+1)};2===$||1===$?l():4===$&&(q.removeAt(I+1),q.removeAt(I+1),l())}else if(4===C){var y=function(){var N=q.get(I),e=q.get(I+1),P=sq(N,e),c=gr(N,e);m.set(i,4),q.add(P,I+1),q.add(c,I+2)};2===$||1===$?y():3===$&&(q.removeAt(I+1),y())}z.setSegments(m),z.setPoints(q);var Z=z.getWidth(),u=z.getHeight(),K=z.p().x-Z/2,s=z.p().y-u/2;K-=R.x,s-=R.y;var J=new ql(z,{x:K,y:s,width:Z,height:u},z.getRotation(),R);z.p(J.x,J.y)}else if(z instanceof O){if("points"!==z.s("edge.type"))return P.endTransaction(),void 0;var q=z.s("edge.points");m=z.s("edge.segments"),q&&(q=Zb(E.gv.getDataUI(z),q),m&&m.size()||(m=Vo(q))),m=new V(m._as.slice(0)),q=new V(q._as.slice(0));var $=m.get(i);if(1===C||2===C)1===$||2===$?m.set(i,C):3===$?(m.set(i,C),q.removeAt(I+1)):4===$&&(m.set(i,C),q.removeAt(I+1),q.removeAt(I+1));else if(3===C){var l=function(){var Y=q.get(I),s=q.get(I+1),C=Xk(Y,s);m.set(i,3),q.add(C,I+1)};2===$||1===$?l():4===$&&(q.removeAt(I+1),q.removeAt(I+1),l())}else if(4===C){var y=function(){var f=q.get(I),N=q.get(I+1),W=sq(f,N),D=gr(f,N);m.set(i,4),q.add(W,I+1),q.add(D,I+2)};2===$||1===$?y():3===$&&(q.removeAt(I+1),y())}z.s("edge.points",Gf(q)),z.s("edge.segments",m)}}P.endTransaction()},getDefaultSegments:function(n){var e=this.gv,y=e.getDataUI(n);if(n instanceof O){var k=n.s("edge.points");return k=Zb(y,k),Vo(k)}if(n instanceof x){var k=n.getPoints(),g=n.getSegments();return g&&g.size()>0?g:Vo(k)}},$43l:function(l){var g=this;l&&(g.$5l=1),g._68I=1,g._42()},_42:function(){var i=this;if(i._68I){delete i._68I;var U=i.gv,z=i.$5l,K=U.getZoom(),o=U.getEditPointSize(),n=o/2,B=new V,l=i._view,S=i._edge,D=i._shape,C=l.getContext("2d"),F=U.tx(),p=U.ty(),h=f,P=U.getEditPointBackground(),k=U.getControlPointBackground(),A=U.getControlPointBorderColor(),G=U.getEditPointBorderColor(),a=U.getEditRectBorderColor(),u=U.getDirectionLineColor(),y=U.getSegmentHoverColor(),J=U.getSnapPointBorderColor(),I=U.getJoinPointBackground(),q=U.getJoinPointBorderColor(),T=U.getSegmentHoverWidth(),b=[5,5],R=U.getEditRectBorderStyle();ko(U,function(p){U.isSelected(p)&&U.isVisible(p)&&B.add(p)}),C.clearRect(0,0,X(l.width),X(l.height)),C.save(),W.translateAndScale(C,F,p,1);var H=f,m={x:0,y:0,width:0,height:0},t=0,w=0,L=0,Q=0,$=0,E=0,Bg=0,ys=0,jh=0,Be=0,rj=[];if(z?(delete i.$6l,delete i.$8l,delete i.$7l,delete i.$16l,delete i.$23l):(H=i.$6l,h=i.$7l),delete i.$68l,delete i.$69l,delete i.$71l,delete i.$70l,delete i.$82l,delete i.$83l,delete i._pointElevationHelperPoint,delete i.$90l,delete i.$91l,delete i.$75l,delete i.$74l,B.each(function(Z){var k=U.getDataUI(Z);if(k){var o=k._55O;if(U.isEditable(Z))o._56O&&Z instanceof r&&w++,rj.push(Z),o._42O&&Z instanceof r&&t++,U.isHelperEditable(Z,"host")&&Q++,U.isHelperEditable(Z,"parent")&&L++,U.isHelperEditable(Z,"remove")&&$++,U.isHelperEditable(Z,"edge")&&E++,U.isHelperEditable(Z,"source")&&Bg++,U.isHelperEditable(Z,"target")&&ys++,U.isHelperEditable(Z,"elevation")&&jh++,U.isHelperEditable(Z,"tall")&&Be++;else if(Z instanceof d&&Z.isExpanded()){var M=!0,X=U.getEditableFunc();X&&(M=X(Z)),M&&(U.isHelperEditable(Z,"host")&&Q++,U.isHelperEditable(Z,"parent")&&L++,U.isHelperEditable(Z,"remove")&&$++,U.isHelperEditable(Z,"edge")&&E++,U.isHelperEditable(Z,"source")&&Bg++,U.isHelperEditable(Z,"target")&&ys++,U.isHelperEditable(Z,"elevation")&&jh++,U.isHelperEditable(Z,"tall")&&Be++,rj.push(Z))}}}),C.beginPath(),C.lineWidth=1,C.strokeStyle=U.getNodeBorderColor(),rj.forEach(function(W){var k=U.getDataUI(W),g=k._55O;if(z)if(h==f&&(h=W instanceof O?0:W instanceof d&&W.isExpanded()?0:W.getRotation(),i.$7l=h),H==f){var F,Z,Y;if(W instanceof d&&W.isExpanded()||W instanceof O){var l=U.getDataUIBounds(W);Z=l.width,Y=l.height,F={x:l.x+Z/2,y:l.y+Y/2}}else F=W.p(),Z=W.getWidth(),Y=W.getHeight();H={x:F.x,y:F.y,width:0,height:0},m.x=F.x-Z/2,m.y=F.y-Y/2,m.width=Z,m.height=Y,H=c(H,m)}else{var F,Z,Y,x,L=H.x+H.width/2,A=H.y+H.height/2,B={x:L,y:A};if(W instanceof d&&W.isExpanded()||W instanceof O){x=0;var l=U.getDataUIBounds(W);Z=l.width,Y=l.height,F={x:l.x+Z/2,y:l.y+Y/2}}else F=W.p(),Z=W.getWidth(),Y=W.getHeight(),x=W.getRotation();var X={x:F.x-Z/2,y:F.y-Y/2,width:Z,height:Y},n={x:X.x,y:X.y},u={x:X.x+X.width,y:X.y},J={x:X.x,y:X.y+X.height},N={x:X.x+X.width,y:X.y+X.height},n=gh(F,n.x-F.x,n.y-F.y,x),J=gh(F,J.x-F.x,J.y-F.y,x),N=gh(F,N.x-F.x,N.y-F.y,x),u=gh(F,u.x-F.x,u.y-F.y,x),$=-h,j=gh(B,n.x-B.x,n.y-B.y,$),E=gh(B,u.x-B.x,u.y-B.y,$),y=gh(B,J.x-B.x,J.y-B.y,$),P=gh(B,N.x-B.x,N.y-B.y,$),I=e([j,E,y,P]);H=c(H,I),H.x-=L,H.y-=A;var _=ql(f,H,h,B);H.x=_.x-H.width/2,H.y=_.y-H.height/2}if(t>1&&U.isEditable(W)&&U.isRectEditable(W)&&W instanceof r){var a=W.getRect(),D=g.$45l,M=er(D[0],K),G=er(D[2],K),v=er(D[4],K),o=er(D[6],K);W.getRotation()?(C.moveTo(M.x,M.y),C.lineTo(G.x,G.y),C.lineTo(v.x,v.y),C.lineTo(o.x,o.y),C.lineTo(M.x,M.y)):C.rect(a.x*K,a.y*K,a.width*K,a.height*K)}}),C.stroke(),H){i.$6l=v(H),g(H,U.getEditRectPadding()/K);var Fc={x:H.x+H.width/2,y:H.y+H.height/2},gr=sr(Fc,H.width,H.height,h),qq=gr[0],Zp=gr[1],Un=gr[2],Lk=gr[3],jc=gr[4],Mr=gr[5],Uo=gr[6],Ul=gr[7];if(qq=er(gr[0],K),Zp=er(gr[1],K),Un=er(gr[2],K),Lk=er(gr[3],K),jc=er(gr[4],K),Mr=er(gr[5],K),Uo=er(gr[6],K),Ul=er(gr[7],K),i.$8l=H,t>0&&(i.$16l=[qq,jc,Zp,Mr,Lk,Uo,Un,Ul],C.beginPath(),C.lineWidth=1,C.strokeStyle=a,"dashed"===R&&C.setLineDash&&C.setLineDash(b),C.moveTo(qq.x,qq.y),C.lineTo(Zp.x,Zp.y),C.lineTo(Lk.x,Lk.y),C.lineTo(Un.x,Un.y),C.lineTo(qq.x,qq.y),C.stroke(),"dashed"===R&&C.setLineDash&&C.setLineDash([])),C.beginPath(),C.lineWidth=1,C.fillStyle=P,C.strokeStyle=G,t>0){var kh=Mr.x-Ul.x,We=Mr.y-Ul.y,Od=j(kh*kh+We*We),fe=jc.x-Uo.x,Wc=jc.y-Uo.y,Xb=j(fe*fe+Wc*Wc),Bp=2*o;if(U.isDirectionEditable&&1===rj.length){var Xq=rj[0],Ng=U.getDataUI(Xq),kk=Ng._55O,dc=U.isDirectionEditable.bind(U);if(kk._42O){var Xo,lp,Tl,te;dc(Xq,"northwest")&&(Xo=!0,C.rect(qq.x-n,qq.y-n,o,o)),dc(Xq,"northeast")&&(lp=!0,C.rect(Zp.x-n,Zp.y-n,o,o)),dc(Xq,"southwest")&&(Tl=!0,C.rect(Un.x-n,Un.y-n,o,o)),dc(Xq,"southeast")&&(te=!0,C.rect(Lk.x-n,Lk.y-n,o,o)),dc(Xq,"north")&&(Xo&&lp?Od>Bp&&C.rect(jc.x-n,jc.y-n,o,o):C.rect(jc.x-n,jc.y-n,o,o)),dc(Xq,"south")&&(te&&Tl?Od>Bp&&C.rect(Uo.x-n,Uo.y-n,o,o):C.rect(Uo.x-n,Uo.y-n,o,o)),dc(Xq,"west")&&(Tl&&Xo?Xb>Bp&&C.rect(Ul.x-n,Ul.y-n,o,o):C.rect(Ul.x-n,Ul.y-n,o,o)),dc(Xq,"east")&&(te&&lp?Xb>Bp&&C.rect(Mr.x-n,Mr.y-n,o,o):C.rect(Mr.x-n,Mr.y-n,o,o))}}else Od>Bp&&(C.rect(jc.x-n,jc.y-n,o,o),C.rect(Uo.x-n,Uo.y-n,o,o)),Xb>Bp&&(C.rect(Mr.x-n,Mr.y-n,o,o),C.rect(Ul.x-n,Ul.y-n,o,o)),C.rect(qq.x-n,qq.y-n,o,o),C.rect(Zp.x-n,Zp.y-n,o,o),C.rect(Un.x-n,Un.y-n,o,o),C.rect(Lk.x-n,Lk.y-n,o,o)}if(w>0){var cg=i.$23l=gh(jc,0,2*-o,h);C.moveTo(cg.x+n,cg.y),C.arc(cg.x,cg.y,n,0,s,!1)}C.fill(),C.stroke(),i.$40l&&i.$44l(C,H,h);var Po,dq,uh=U.getLeftTopHelpers(),Yc=U.getRightTopHelpers(),Wg=U.getLeftBottomHelpers(),Yf=U.getRightBottomHelpers(),yc=U.getEdgeHelpers(),Aq=U.getEditHelperSize(),Rm=Aq/2,$e=function(X,j,N,m){"leftTop"===j?(Po=H.x*K-Aq-n-("h"===m?N*(Aq+n):0)-1,dq=H.y*K-Aq-n-("v"===m?N*(Aq+n):0)-1):"rightTop"===j?(Po=(H.x+H.width)*K+n+("h"===m?N*(Aq+n):0)+1,dq=H.y*K-Aq-n-("v"===m?N*(Aq+n):0)-1):"leftBottom"===j?(Po=H.x*K-Aq-n-("h"===m?N*(Aq+n):0)-1,dq=(H.y+H.height)*K+n+("v"===m?N*(Aq+n):0)+1):"rightBottom"===j&&(Po=(H.x+H.width)*K+n+("h"===m?N*(Aq+n):0)+1,dq=(H.y+H.height)*K+n+("v"===m?N*(Aq+n):0)+1);var I=Po+Rm,f=dq+Rm,A=(H.x+H.width/2)*K,x=(H.y+H.height/2)*K,R=gh({x:A,y:x},I-A,f-x,h);if("host"===X){if(Q>0)return i.$77l(C,h,R),!0}else if("edge"===X){if(E>0)return i.$80l(C,h,R),!0}else if("remove"===X){if($>0)return rj&&1===rj.length&&rj[0]instanceof O?i.$81l(C,h,{x:A+Aq/2+5,y:x}):i.$81l(C,h,R),!0}else if("parent"===X){if(L>0)return rj&&1===rj.length&&rj[0]instanceof O?i.$76l(C,h,{x:A-Aq/2-5,y:x}):i.$76l(C,h,R),!0}else if("elevation"===X){if(jh>0)return i.$85l(C,h,R),!0}else if("tall"===X){if(Be>0)return i.$86l(C,h,R),!0}else if("source"===X||"target"===X){var T=rj[0],p=U.getDataUI(T),S=Gg(p,!0),b=S[0],w=S[1];if(Bg&&"source"===X)return i.$84l(C,H,b,!0,T.isLooped(),j,N,m),!0;if(ys&&"target"===X)return i.$84l(C,H,w,!1,T.isLooped(),j,N,m),!0}};if(uh&&uh.length>0){var ej=0;uh.forEach(function(d){$e(d,"leftTop",ej,U.getLeftTopHelpersAlign()||"h")&&ej++})}if(Yc&&Yc.length>0){var ej=0;Yc.forEach(function(X){$e(X,"rightTop",ej,U.getRightTopHelpersAlign()||"h")&&ej++})}if(Wg&&Wg.length>0){var ej=0;Wg.forEach(function(W){$e(W,"leftBottom",ej,U.getLeftBottomHelpersAlign()||"h")&&ej++})}if(Yf&&Yf.length>0){var ej=0;Yf.forEach(function(A){$e(A,"rightBottom",ej,U.getRightBottomHelpersAlign()||"h")&&ej++})}if(yc&&yc.length>0&&((Bg||ys)&&rj&&1===rj.length&&rj[0]instanceof O?!0:!1)){var ej=0;yc.forEach(function(p){$e(p,"edge",ej,"h")&&ej++})}if(i.$72l){var Vf,of=i.$67l,yq=i.$68l,vc=i.$69l,Hk=(i.$71l,i.$70l),db=i.$82l,on=i.$83l;if(1===of?Vf=yq:2===of?Vf=vc:3===of?Vf=Hk:5===of?Vf=db:6===of&&(Vf=on),Vf){var vg=U.lp(i.$72l),dp=U.getDataAt(i.$72l);if(dp&&dp instanceof r){var ik,gj,Wd;if(i.$73l=dp,1===of)if(dp instanceof N.Grid)ik=i.$75l=yd(dp,vg);else if(dp instanceof N.Shape){Wd=i.$74l=Ig(dp,vg);var Oh=dp.getPoints();if(Wd){var Nm=Wd.attachIndex,ch=ze(dp,U.getDataUI(dp),Nm)+1,Vj=ch+1>=Oh.size()?0:ch+1,Ne=Oh.get(ch),ip=Oh.get(Vj),Ah=dp.p(),Wi=dp.getRotation();Ne=gh(Ah,Ne.x-Ah.x,Ne.y-Ah.y,Wi),ip=gh(Ah,ip.x-Ah.x,ip.y-Ah.y,Wi),C.beginPath(),C.strokeStyle=y,C.lineWidth=T,C.moveTo(Ne.x*K,Ne.y*K),C.lineTo(ip.x*K,ip.y*K),C.stroke()}}ik?gj=ik.rect:(gj=Y.clone(U.getDataUIBounds(dp)),Y.grow(gj,2)),C.beginPath(),C.rect(gj.x*K,gj.y*K,gj.width*K,gj.height*K),C.strokeStyle=1===of||4===of||6===of?Z:M,C.lineWidth=2,C.setLineDash&&C.setLineDash([8,8]),C.stroke()}else delete i.$73l;vg.x=vg.x*K,vg.y=vg.y*K;var _n=Re(Vf.x,Vf.y,vg.x,vg.y),Ep=gh(Vf,vg.x-Vf.x,vg.y-Vf.y,-_n),Ye=Ep.x-Vf.x;C.save(),C.translate(Vf.x,Vf.y),C.rotate(_n),_.width=Ye,_.height=40;var Hp=M;(1===of||4===of||6===of)&&(Hp=Z),_.comps[0].gradientColor=Hp,Y.drawImage(C,_,0,-20,Ye,40),C.restore()}}}if(B.each(function(O){var w=U.getDataUI(O);if(w){var v,N,p=w._55O,X=w._78o;if(p&&p._43O&&O instanceof x?(v=p.$15l,N=O.getSegments(),N&&N.size()||(N=Vo(v)),O.isClosePath()&&N.indexOf(5)<0&&(N=new V(N._as),N.add(5))):p&&X&&p._43O&&(v=O.s("edge.points"),N=O.s("edge.segments"),v=Zb(w,v),N&&N.size()||(N=Vo(v)),v&&(v=v._as)),v&&N){var e=0,M=N.size(),F=i._hoverSegmentIndex;v=v.slice(0);for(var Z=0;Z<v.length;Z++)v[Z]=er(v[Z],K);C.beginPath(),C.strokeStyle=u,C.lineWidth=1,e=0;for(var Z=0;M>Z;Z++){var W=N.get(Z);if(1===W||2===W)e++;else if(3===W){var h=v[e-1],g=v[e],P=v[e+1];C.moveTo(h.x,h.y),C.lineTo(g.x,g.y),C.lineTo(P.x,P.y),e+=2}else if(4===W){var h=v[e-1],c=v[e],a=v[e+1],P=v[e+2];C.moveTo(h.x,h.y),C.lineTo(c.x,c.y),C.moveTo(a.x,a.y),C.lineTo(P.x,P.y),e+=3}}if(C.stroke(),D===O||S===O&&"points"===S.s("edge.type")){C.beginPath(),e=0,C.strokeStyle=y,C.lineWidth=T;for(var Z=0;M>Z;Z++){var W=N.get(Z);if(1===W||2===W){if(F===Z){var h=v[e-1],P=v[e];C.moveTo(h.x,h.y),C.lineTo(P.x,P.y);break}e++}else if(3===W){if(F===Z){var h=v[e-1],g=v[e],P=v[e+1];C.moveTo(h.x,h.y),C.quadraticCurveTo(g.x,g.y,P.x,P.y);break}e+=2}else if(4===W){if(F===Z){var h=v[e-1],c=v[e],a=v[e+1],P=v[e+2];C.moveTo(h.x,h.y),C.bezierCurveTo(c.x,c.y,a.x,a.y,P.x,P.y);break}e+=3}else if(5===W&&F===Z){var h=v[e-1],P=v[0];C.moveTo(h.x,h.y),C.lineTo(P.x,P.y);break}}C.stroke()}C.beginPath(),e=0,C.strokeStyle=q,C.lineWidth=1,C.fillStyle=I;for(var Z=0;M>Z;Z++){var W=N.get(Z);if(1===W||2===W){var P=v[e];C.moveTo(P.x+n,P.y),C.arc(P.x,P.y,n,0,s,!0),e++}else if(3===W){var P=v[e+1];C.moveTo(P.x+n,P.y),C.arc(P.x,P.y,n,0,s,!0),e+=2}else if(4===W){var P=v[e+2];C.moveTo(P.x+n,P.y),C.arc(P.x,P.y,n,0,s,!0),e+=3}}C.fill(),C.stroke(),C.beginPath(),e=0,C.strokeStyle=A,C.lineWidth=1,C.fillStyle=k;for(var Z=0;M>Z;Z++){var W=N.get(Z);if(1===W||2===W)e++;else if(3===W){var g=v[e];C.moveTo(g.x+n,g.y),C.arc(g.x,g.y,n,0,s,!0),e+=2}else if(4===W){var c=v[e],a=v[e+1];C.moveTo(c.x+n,c.y),C.arc(c.x,c.y,n,0,s,!0),C.moveTo(a.x+n,a.y),C.arc(a.x,a.y,n,0,s,!0),e+=3}}if(C.fill(),C.stroke(),C.beginPath(),e=0,C.strokeStyle=J,C.lineWidth=2,(D===O||S===O)&&i.$9l!=f){var P=v[i.$9l];C.moveTo(P.x+n,P.y),C.arc(P.x,P.y,n,0,s,!0),C.stroke()}}}}),i.$87l&&U.sm().contains(i.$87l)){var Kk,nj=i.$87l,Vk=i.$88l,Aq=U.getEditHelperSize(),Rm=Aq/2;if(U.isHelperEditable(nj,"pointElevation"))if(nj instanceof x){var vf=nj.getPosition();Kk=Y.clone(nj.getPoints().get(Vk)),Kk=gh({x:vf.x,y:vf.y},Kk.x-vf.x,Kk.y-vf.y,nj.getRotation()),Kk.x*=K,Kk.y*=K,C.translate(Kk.x,Kk.y),Y.drawImage(C,Y.getImage("xeditinteractor_elevationIcon"),Rm,-Rm,Aq,Aq),C.translate(-Kk.x,-Kk.y),i._pointElevationHelperPoint={x:Kk.x+Aq,y:Kk.y}}else if(nj instanceof O){var qo=Zb(U.getDataUI(nj),nj.s("edge.points")),Kk=Y.clone(qo.get(Vk));Kk.x*=K,Kk.y*=K,C.translate(Kk.x,Kk.y),Y.drawImage(C,Y.getImage("xeditinteractor_elevationIcon"),Rm,-Rm,Aq,Aq),C.translate(-Kk.x,-Kk.y),i._pointElevationHelperPoint={x:Kk.x+Aq,y:Kk.y}}}C.restore(),i.$5l=0}},$89l:function(c,x,O,n){c.save();var u=this,P=u.gv,r=P.getEditHelperSize(),I=r/2;c.beginPath(),c.translate(O.x,O.y),c.rotate(x),Y.drawImage(c,n,-I,-I,r,r),c.restore()},$85l:function(k,H,v){var P=this;P.$90l=v,P.$89l(k,H,v,Y.getImage("xeditinteractor_elevationIcon"))},$86l:function(D,g,Z){var h=this;h.$91l=Z,h.$89l(D,g,Z,Y.getImage("xeditinteractor_tallIcon"))},$77l:function(v,E,f){var I=this;I.$68l=f,I.$89l(v,E,f,Y.getImage("xeditinteractor_hostIcon"))},$80l:function(f,C,n){var D=this;D.$70l=n,D.$89l(f,C,n,Y.getImage("xeditinteractor_edgeIcon"))},$81l:function(F,Q,d){var $=this;$.$71l=d,$.$89l(F,Q,d,Y.getImage("xeditinteractor_removeIcon"))},$76l:function(d,D,T){var B=this;B.$69l=T,B.$89l(d,D,T,Y.getImage("xeditinteractor_parentIcon"))},$84l:function(C,p,L,s,y){var r,c=this,K=c.gv,R=K.getZoom(),n=K.getEditHelperSize(),G=n/2;L.x*=R,L.y*=R,y&&(s?L.x-=G+5:L.x+=G+5),L.y-=n-2,s?(c.$82l=L,r=Y.getImage("xeditinteractor_sourceIcon")):(c.$83l=L,r=Y.getImage("xeditinteractor_targetIcon")),C.beginPath(),C.translate(L.x,L.y),Y.drawImage(C,r,-G,-G,n,n),C.translate(-L.x,-L.y)},$44l:function(r,q,A){r.save();var N=this.gv.getZoom(),d=j(B(q.width,2)+B(q.height,2))/2*N+10,f=d,S=f+8,F=f+18,z=A,m=q.x+q.width/2,k=q.y+q.height/2;r.translate(m*N,k*N),r.beginPath(),r.strokeStyle="rgb(150, 150, 150)";for(var T=0,H=0,g=0,y=0,V=0,_=0;360>_;_++)T=_*n/180,0===_%5&&(H=P(T)*f,g=G(T)*f,y=P(T)*S,V=G(T)*S,r.moveTo(H,g),r.lineTo(y,V)),0===_%45&&(H=P(T)*f,g=G(T)*f,y=P(T)*F,V=G(T)*F,r.moveTo(H,g),r.lineTo(y,V));r.stroke(),r.beginPath(),r.rotate(-L),r.beginPath(),r.fillStyle="rgba(255, 0, 0, 0.1)",r.strokeStyle="rgb(157, 157, 157)",r.moveTo(0,0),r.arc(0,0,F,0,A,!1),r.fill(),r.beginPath(),r.moveTo(0+F,0),r.arc(0,0,F,0,A,!1),r.stroke(),r.rotate(L),r.font="bold 12px Verdana, Arial";var u=20*G(z),Y=20*P(z),$=p(180*z/n)+"°";r.textAlign="center",r.textBaseline="middle",r.beginPath();var w=r.measureText("365.°").width;r.fillStyle="white",r.rect(u-w/2,-Y-10,w,20),r.fill(),r.beginPath(),r.fillStyle="rgb(79,79,79)",r.fillText($,u,-Y),r.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);