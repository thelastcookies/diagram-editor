!function(x){"use strict";var r="ht",a=x[r],K=function(){return document},A=function(){return K().body},y=function(j,R,s){j.style.setProperty(R,s,null)},M=function(H){return K().createElement(H)},h=function(){return M("div")},H=function(){var F=M("canvas");return F},C=function(r,t){y(r,"-webkit-transform",t),y(r,"-ms-transform",t),y(r,"transform",t)},X=function(H,Q){y(H,"-webkit-transform-origin",Q),y(H,"-ms-transform-origin",Q),y(H,"transform-origin",Q)},d=function(G,d){G.appendChild(d)},O=function(m,b){m.removeChild(b)},P=x.parseInt,Z=a.Default,T=Z.getInternal(),W=T.addEventListener,Q=(T.removeEventListener,Math.PI),L="white-space",n="visibility",o="left",k="top",R="width",b="height",S="position",v="display",V="z-index",e="px",E="0 0",l="absolute",F="visible",m="hidden",B="none",I="block",j="nowrap",N="rgba(0, 0, 0, 0.005)";Z.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var Y=a.graph.GraphView.prototype,c=Y._42;Y.adjustHtmlNodeIndex=!0,Y._42=function(w,C){if(c.call(this,w,C),this.adjustHtmlNodeIndex)for(var A=this.getDataModel()._datas._as,O=A.length,u=1,K=0;O>K;K++){var d=A[K];if(d instanceof t){var i=this.getDataUI(d);y(i.$2f,V,u+""),y(i.$3f,V,u+1+""),u+=2}}};var u=a.HtmlNodeUI=function(k,U){var f=this;u.superClass.constructor.call(f,k,U);var J=f.$2f=h(),o=f.$3f=H();y(J,S,l),y(J,n,m),y(J,L,j),o.draggable=!1,y(o,S,l),y(o,v,B),X(o,E),W(J,"change",function(T){var P=T.target,d=P.bind||P.getAttribute("bind"),n=P.type&&"checkbox"===P.type?P.checked:P.value,R=U.getContext();d&&R&&(R[d]=n,f.$4f=JSON.stringify(R))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(f){W(J,f,this.$9f.bind(this))},f)};Z.def(u,T.ui().NodeUI,{_visible:!0,$11f:function(){var g=this,v=g.$3f,x=g._data,e=x.getDraggerImageWidth(),i=x.getDraggerImageHeight(),l=x.getDraggerImage(),M=T.initContext(v);M.beginPath(),T.setCanvas(v,e,i),T.translateAndScale(M,0,0,1),M.clearRect(0,0,e,i),Z.drawImage(M,Z.getImage(l),0,0,e,i),M.restore()},_80o:function(O){u.superClass._80o.call(this,O);var i=this,r=i._data,Z=r._padding,t=2*Z,A=i.$2f,f=i.$3f,M=i.gv,D=M.getZoom(),a=M.getTranslateX(),U=M.getTranslateY(),s=M.getView(),x=i._83o,z=r._width,E=r._height,q=x.position,L=x.rotation,G=(z-t)/r.$5f*D,W=(E-t)/r.$6f*D,g=i._html,$=r._html,Y=r.getHtmlType();if("html"===Y){var w=r.getContext()||{},H=i.$4f,_=r.$10f,c=JSON.stringify(w);g&&H&&g===$&&H===c||(i.$4f=c,i._html=$,A.innerHTML=_?_(w):$)}else if(null!=Y){var J=r.getHtml();"ht"===Y&&(J=J.getView()),g&&g===J&&A.contains(g)||(i._html=J,A.innerHTML="",d(A,J))}if(!A.parentNode){var p=M.$1f;if(!p){var K=h();y(K,S,l),y(K,V,"0"),p=M.$1f=K;var T=M._canvas.nextSibling;T?s.insertBefore(K,T):d(s,K)}d(p,A),d(p,f),r.onContentInitialized&&r.onContentInitialized(A)}if(r._scalable){var j=r.$5f,X=r.$6f;C(A,"rotate("+180*(L/Q)+"deg) scale("+G+","+W+")"),y(A,R,""),y(A,b,""),y(A,o,(q.x-j/D/2)*D+a+e),y(A,k,(q.y-X/D/2)*D+U+e)}else{var as=P(A.style.width),cr=P(A.style.height),Gl=P((z-t)*D),hn=P((E-t)*D),ql="100%",Po=A.children[0];y(Po,R,ql),y(Po,b,ql),(as!==Gl||cr!==hn)&&(y(A,R,Gl+e),y(A,b,hn+e),"ht"===Y&&$.invalidate()),C(A,"rotate("+180*(L/Q)+"deg)"),y(A,o,(q.x-Gl/D/2)*D+a+e),y(A,k,(q.y-hn/D/2)*D+U+e)}var Tr=i.dragRect;M.isMovable(r)&&M.isSelected(r)&&Tr?(O.save(),O.fillStyle=N,O.fillRect(Tr.x,Tr.y,Tr.width,Tr.height),O.restore(),y(f,o,Tr.x*D+a+e),y(f,k,Tr.y*D+U+e),C(f,"scale("+D+","+D+")"),y(f,v,I),i.$11f()):y(f,v,B),y(A,n,this._visible?F:m)},dispose:function(){var f=this.gv.$1f;this.$2f.parentNode===f&&f.removeChild(this.$2f),this.$3f.parentNode===f&&f.removeChild(this.$3f)},_84o:function(G){this._visible=G,y(this.$2f,n,G?F:m),y(this.$3f,v,G?I:B)},_3O:function(){var n=this,C=n.gv,x=n._data;u.superClass._3O.call(n);var h=x.getRect();C.isEditable(x)&&(n.dragRect={x:h.x+h.width+x._padding,y:h.y+10,width:x.getDraggerImageWidth(),height:x.getDraggerImageHeight()},n._68o(n.dragRect))},rectIntersects:function(I){var S=this._79o();return a.Default.intersection(S,I)?!0:void 0},$9f:function(c){var b=this.gv,m=this._data;b.sm().contains(m)&&c.stopPropagation()}});var t=a.HtmlNode=function(){t.superClass.constructor.call(this)};a.Default.def(t,a.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:a.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(R){var b=this,w=b._html;b._html=R,"html"===b.getHtmlType()&&"Handlebars"in x&&(b.$10f=Handlebars.compile(R)),b.$13f(),b.fp("html",w,R)},setContext:function(Q){var t=this,d=t._context;t._context=Q,t.fp("context",d,Q),t.$13f()},setScalable:function(R){var P=this,p=P._scalable;P._scalable=R,P.fp("scalable",p,R),P.$13f()},getHtmlType:function(){var W=this._html;return W?"string"==typeof W?"html":W.getView?"ht":"dom":null},$13f:function(){var W=this,Q=W._html,I=W.$10f;if(Q){var x=h(),$=!1,M=W.getHtmlType();if(y(x,S,l),y(x,L,j),y(x,n,m),"html"===M?(x.innerHTML=I?I(W.getContext()||{}):Q,$=!0):"ht"===M?(d(x,Q.getView()),$=!0):"dom"===M&&(d(x,Q),$=!0),$){var r=2*W._padding;d(A(),x),W.$5f=x.scrollWidth,W.$6f=x.scrollHeight,W._width=W.$5f+r,W._height=W.$6f+r,W._originWidth=W._width,W._originHeight=W._height,O(A(),x)}}},getUIClass:function(){return a.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);