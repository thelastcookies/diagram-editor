!function(C,b,r){"use strict";function D(c,U){if("function"!=typeof U&&null!==U)throw new TypeError("Super expression must either be null or a function");c.prototype=b.create(U&&U.prototype,{constructor:{value:c,writable:!0,configurable:!0}}),U&&wq(c,U)}function B(K){var B=b.prototype.toString.call(K);return"Array]"===B.substring(B.length-6)}function i(q,m,o,T,B,_){m=m||[],o=o||[],T=T||[];try{m.push(q);var R=Function.apply(0,m);return o[o.length]="return "+R,Function.apply(0,o).apply(0,T)}catch(F){return _&&_(F),B}}function Y(S){var v={};return{get:function(t){if(v[t]!==r)return v[t];var g;switch(t){case"WEBGL_depth_texture":g=S.getExtension("WEBGL_depth_texture")||S.getExtension("MOZ_WEBGL_depth_texture")||S.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":g=S.getExtension("EXT_texture_filter_anisotropic")||S.getExtension("MOZ_EXT_texture_filter_anisotropic")||S.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":g=S.getExtension("WEBGL_compressed_texture_s3tc")||S.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||S.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":g=S.getExtension("WEBGL_compressed_texture_pvrtc")||S.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":g=S.getExtension("WEBGL_compressed_texture_etc1");break;default:g=S.getExtension(t)}return v[t]=g,g}}}function V(c,b,p){function m(){if(H!==r)return H;var J=b.get("EXT_texture_filter_anisotropic");return H=null!==J?c.getParameter(J.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function N(y){if("highp"===y){if(c.getShaderPrecisionFormat(c.VERTEX_SHADER,c.HIGH_FLOAT).precision>0&&c.getShaderPrecisionFormat(c.FRAGMENT_SHADER,c.HIGH_FLOAT).precision>0)return"highp";y="mediump"}return"mediump"===y&&c.getShaderPrecisionFormat(c.VERTEX_SHADER,c.MEDIUM_FLOAT).precision>0&&c.getShaderPrecisionFormat(c.FRAGMENT_SHADER,c.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var H;p=p||{};var V="undefined"!=typeof WebGL2RenderingContext&&c instanceof WebGL2RenderingContext,W=p.precision!==r?p.precision:"highp",n=N(W);n!==W&&(console.warn("WebGL:",W,"not supported, using",n,"instead."),W=n);var k,x=p.logarithmicDepthBuffer===!0,D=c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS),e=c.getParameter(c.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Y=c.getParameter(c.MAX_TEXTURE_SIZE),h=c.getParameter(c.MAX_CUBE_MAP_TEXTURE_SIZE),u=c.getParameter(c.MAX_VERTEX_ATTRIBS),z=c.getParameter(c.MAX_VERTEX_UNIFORM_VECTORS),A=c.getParameter(c.MAX_VARYING_VECTORS),J=c.getParameter(c.MAX_FRAGMENT_UNIFORM_VECTORS),v=e>0,R=V||!!b.get("OES_texture_float"),G=(V||!!b.get("OES_element_index_uint"))&&"undefined"!=typeof Uint32Array,q=v&&R,d=V?c.getParameter(c.MAX_SAMPLES):0,l=!1;return V?l=!0:(k=b.get("ANGLE_instanced_arrays"))&&(l=!0,c.vertexAttribDivisor=function(u,R){return k.vertexAttribDivisorANGLE(u,R)},c.drawElementsInstanced=function(n,Z,C,a,m){return k.drawElementsInstancedANGLE(n,Z,C,a,m)},c.drawArraysInstanced=function(R,K,U,z){return k.drawArraysInstancedANGLE(R,K,U,z)}),{getMaxAnisotropy:m,getMaxPrecision:N,precision:W,logarithmicDepthBuffer:x,maxTextures:D,maxVertexTextures:e,maxTextureSize:Y,maxCubemapSize:h,maxAttributes:u,maxVertexUniforms:z,maxVaryings:A,maxFragmentUniforms:J,vertexTextures:v,floatFragmentTextures:R,elementTypeUint:G,floatVertexTextures:q,maxSamples:d,instancedArray:l}}function v(d,A){return d.z!==A.z?A.z-d.z:d.id-A.id}var n="ht";if(!C[n]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),C.performance&&C.performance.now||function(){var M=Date.now();C.performance||(C.performance={}),C.performance.now=function(){return Date.now()-M}}();for(var X=Date.now(),i=16,L=["ms","moz","webkit","o"],M=0;M<L.length&&!C.requestAnimationFrame;++M)C.requestAnimationFrame=C[L[M]+"RequestAnimationFrame"],C.cancelAnimationFrame=C[L[M]+"CancelAnimationFrame"]||C[L[M]+"CancelRequestAnimationFrame"];C.requestAnimationFrame||(C.requestAnimationFrame=function(I){var W=Date.now(),A=i+X-W;return 0>A&&(A=0),X=W,C.setTimeout(function(){X=Date.now(),I(performance.now())},A)}),C.cancelAnimationFrame||(C.cancelAnimationFrame=function(Y){return C.clearTimeout(Y)}),b.assign===r&&(b.assign=function(I){if(I===r||null===I)throw new TypeError("Cannot convert undefined or null to object");for(var M=b(I),N=1;N<arguments.length;N++){var m=arguments[N];if(m!==r&&null!==m)for(var T in m)b.prototype.hasOwnProperty.call(m,T)&&(M[T]=m[T])}return M}),C.btoa===r&&(C.btoa=function(y){for(var Z,B,b=String(y),N=0,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",w="";b.charAt(0|N)||(t="=",N%1);w+=t.charAt(63&Z>>8-8*(N%1))){if(B=b.charCodeAt(N+=.75),B>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");Z=Z<<8|B}return w})}();var L,H,P,y,K=C.location,G=K&&C.document,$=null,d=r,A=C[n]={},c=C[n+"config"],u=A.Default=c&&c.Default||{},x=A.Style=c&&c.Style||{},o=A.Attr=c&&c.Attr||{},Q=function(){return!0},a=function(){return!1},U=function(P){return P},q=function(a){return!a},p=A.Color=c&&c.Color||{},j=A.IsGetter=c&&c.IsGetter||{};!function(){var l=!1;try{var k=b.defineProperty({},"passive",{get:function(){return l=!0,r}});K&&(P=L=K)&&C.addEventListener("test",k,k),K&&(y=H=K)&&C.removeEventListener("test",k,k)}catch(x){l=!1}u.passiveSupported=l}();var e,z,W,w,N=u.passiveSupported,h=u.eventListenerOptionsFalse=N?{passive:!1,capture:!1}:!1,T=u.eventListenerOptionsTrue=N?{passive:!1,capture:!0}:!0,f=function(M,w,W,O){M.addEventListener(w,W,O?T:h)},I=function(B,X,n,N){B.removeEventListener(X,n,N?T:h)},S=Math,t=S.round,M=S.floor,l=S.ceil,_=S.sqrt,E=S.max,O=S.min,k=S.abs,m=S.cos,s=S.acos,X=S.sin,J=S.pow,F=S.asin,R=S.exp,Z=S.PI,g=2*Z,Ce=Z/2,Hb=S.tan,ys=S.atan2,Fi=S.random,Tn=S.log,vi=function(b,h,m){return Math.max(h,Math.min(m,b))},wn=J(2,1),xb=!1,rr=C.parseInt||global.parseInt,ss="2022-5-15",wo=K&&(C.navigator?C.navigator.platform.indexOf("Win")>-1:!1),kc=function(r){return r*r},Kb=K&&C.setTimeout,Xi=K&&C.clearTimeout,Ui=K&&(C.navigator?C.navigator.userAgent.toLowerCase():""),mo=function(z){return z.test(Ui)},$j=mo(/msie/),yo=mo(/msie/)||mo(/trident/),gi=mo(/msie 10/),pf=mo(/edge/),xo=mo(/firefox/),aj=mo(/mac/),Zk=mo(/mscAndroid/),Ze=u.isTouchable===r?wo?!1:G?"ontouchend"in G:!1:u.isTouchable,de="default",Wb="single",Qj="multiple",Er="front",yc="back",sl="left",vp="right",Yd="top",gg="bottom",eo="center",Np="eye",we="middle",zd="east",ui="west",Yb="north",hh="none",en="px",Qp="absolute",ki="border",xj="triangle",Ne="rect",Oq="circle",ym="cylinder",Rr="shape",Jc="items",id="normal",Vc="remove",vo="clear",Ac="width",Tl="height",cg="ingroup",Wl="check",vj="uncheck",jb="radio",yl="radioOn",rk="radioOff",no="points",kb="values",rj="series",Ef="body",Ni="label",Di="label2",sf="note",_b="note2",vl="icons",nl="labelFont",Mk="labelColor",ye="labelSelectColor",Kg="note.expanded",qi="note2.expanded",Rb="edge.expanded",sp="edge.points",uf="edge.type",jl="rotation",Rq="hidden",uo="visible",yh="tuv",Gf="no",Ri="draw",tf="select",Xe="currentSubGraph",cn="selectBackground",mh="autoMakeVisible",Mj="autoHideScrollBar",lo="scrollBarColor",me="scrollBarSize",Zo="indent",_i="rowHeight",mk="columnLineColor",og="rowLineColor",np="columnLineVisible",ed="rowLineVisible",Vn="visibleFunc",Dl="expandIcon",bm="collapseIcon",ap="checkMode",hm="sortFunc",ql="editable",zf="batchEditable",De="tristate",Mi="asc",pd="desc",zk="position",fr="__",Ob="elevation",Re="children",Ld="translateX",dg="translateY",Xm="dataModel",lg="maxSize",yp="enc",Nc="state",Rh=yp+"o"+"de",lp="shape3d",pp="shape3d.resolution",on="shape3d.visible",gf="shape3d.from.visible",sq="shape3d.to.visible",Ul="shape3d.top.visible",se="shape3d.bottom.visible",em="repeat.uv.length",dn="serializeValue",$f="deserializeValue",Hc="centerUniform",qq="uniform",ld="rgba(255,255,255,0)",sr="style",Lg="attr",On="field",ac="string",kh="boolean",pq="color",rs="int",zj="number",Bm="ew-resize",xr="ns-resize",cd="pointer",Qc="auto",yk="mousedown",Uk="mousemove",Tm="mouseup",Yq="mouseout",wc="touchstart",sn="touchmove",Po="touchend",wd="keydown",je="keyup",le=["DOMMouseScroll","mousewheel"],Be=xo?le[0]:le[1],To=fr+n+fr+Rh,Oh=[wc,sn,Po],xf=[yk,Uk,Tm,Yq,Be,"wheel","mouseenter","mouseleave","mouseover"],Cb=[wd,je,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],sj=Ze?Oh.concat(Cb):xf.concat(Cb),Wg=$,js=$,Fk=$,$g=$,Vq=!1,Aq=Tm.length,mm=function(){Fk&&(Xi(Fk.timeout),Fk=$)},dr=function(){Fk&&ee(Fk.e,Fk.info)};C.addEventListener&&(d=K)&&(Ze||(f(C,Yq,function(){mm()}),f(C,Be,function(){Wo()})),f(C,je,function($){91===$.keyCode?gc={}:delete gc[$.keyCode]},!0),f(C,wd,function(F){gc[F.keyCode]=!0},!0),f(C,"blur",function(){gc={}}));var Hr,Vi,Rn,Qk=0,bs=$,hr=function(a,w){var W=Kb(function(){delete bs[W],Rd(bs)&&(bs=$),a()},w);return W},vm=$,Pd=$,Bd={},ps={},En={},us={},Fp={},gc={},Gl={},Se={},ic={},Cl={},Dj=/.json$/,Ep=/\.(json|bin)$/,Zq=/^data:image\/svg\+xml/,is={},Bj=[],Oe={},Qd=$,Im=$,rg=function(){},of=function(){throw"Oops!"},dd=[0,0,0],ze={x:0,y:0,width:0,height:0},Vp=$,vd=$,ep=$,yg=function(n,h){ps[n]=h,h&&h.comps&&!h.uuid&&(h.uuid=A.Math.generateUUID()),dh[n]&&(h.cacheRule=dh[n],delete dh[n])},Ci=function(I){vd&&!I._72O&&(ep||(ep={}),ep[I._72O=tq()]=I),Hr!=$?Wr()<.05&&w&&!Vi&&(Tj=mm):Tj=xn},Xc=function(H,l,x,m){vd||(vd={});var K=vd[H];if(K){if(K.url===l)return;K.image?(K.image.onload=rg,K.image.onerror=rg):K.request&&(K.request.onload=rg,K.request.onerror=rg)}if(Dj.test(l)){var y=new uk;if(vd[H]={request:y,url:l},l=u.beforeLoadURL(l,H),l.data){var i=u.parse(l.data);Wp(H,i),u.handleImageLoaded(H,i)}else{y.onload=function(){if(200===this.status||0===this.status){var K=u.parse(y.getResponseText());Wp(H,K),u.handleImageLoaded(H,K)}else Wp(H,u.handleUnfoundImage(H,l)||$)},y.onerror=function(){Wp(H,u.handleUnfoundImage(H,l)||$)};var e={};e.url=encodeURI(l),e.sync=!1,y.send(e)}}else{var i=new Image;vd[H]={image:i,url:l},/^data:image/.test(l)||(l=u.beforeLoadURL(l,H),l=u.appendTimeStamp(l),l=encodeURI(l),i.crossOrigin=u.crossOrigin),u.convertImageSrc(l,function(g){yo&&(l.toLowerCase().indexOf(".svg")>0||Zq.test(l))?(G.body.appendChild(i),i.style.visibility="hidden",i.onload=function(){Kb(function(){if(x&&(i.width=x),m&&(i.height=m),!i.width||!i.height){var N=i.width||i.clientWidth,D=i.height||i.clientHeight;i.width=N,i.height=D}u.handleImageLoaded(H,i),Wp(H,i),G.body.removeChild(i),i.style.visibility=""},180)},i.onerror=function(){Wp(H,u.handleUnfoundImage(H,l)||$),G.body.removeChild(i),i.style.visibility=""}):(i.onload=function(){x&&(i.width=x),m&&(i.height=m),u.handleImageLoaded(H,i),Wp(H,i)},i.onerror=function(){Wp(H,u.handleUnfoundImage(H,l)||$)}),i.src=g})}},Wp=function(y,Q){if(yg(y,Q),delete vd[y],Rd(vd)&&(vd=$,ep)){for(var a in ep){var L=ep[a];L._2O&&L._2O[y]&&(L.deleteTexture(y),delete L._2O[y]),L.invalidateAll&&L.invalidateAll(r,"imageLoaded",y),L.redraw&&L.redraw(),L.iv(),Q&&Q.layoutAttach&&Xp(L.dm)&&L.dm().updateLayoutAttach(y),delete L._72O}ep=$}if(Q&&ep)for(var a in ep){var L=ep[a];L.invalidateAll&&L.invalidateAll(r,"imageLoading",y),L.redraw&&L.redraw(),L.iv(),Q.layoutAttach&&Xp(L.dm)&&L.dm().updateLayoutAttach(y)}},ei=function(){return Tn=S&&Date,function(){return C.performance&&C.performance.now?C.performance.now():Date.now()}}(),$l=function($,B,r){return{width:$,height:B,comps:Zf(r)?r:[r]}},Pm=function(c,m){return{type:Oq,rect:[c,m,1.6,1.6],borderWidth:1,borderColor:tm,gradient:hl,gradientColor:ns,background:tm}},up=function(h,U){return $l(16,16,{type:xj,rect:[4,4,10,8],background:h,rotation:U?1.57:3.14})},hq=function(P,i){return $l(16,16,{type:xj,rect:[4,4,8,7],background:P,rotation:i?3.14:0})},_g=function(m){var F=m._orientation;return"horizontal"===F||"h"===F},Ok=function(R,M){var v=$||4,V=$||1,w=$||1;0>v?v=0:v>.25&&(v=.25);var E,u,s,P,h,f,S,i=.5,d=[],I=[],K=[],T=g/w,e=g/V,F=i-v;for(u=0;V>=u;u++)for(P=-Z+u*e,f=m(P),h=X(P),E=0;w>=E;E++)s=E*T,S=F+v*f,d.push(m(s)*S,h*v,-X(s)*S),(z=[R,M])&&I.push(E/w,1-u/V);for(u=0;V>u;u++){var Q=u*(w+1),n=(u+1)*(w+1);for(E=0;w>E;E++)K.push(Q+E,n+E+1,n+E,Q+E,Q+E+1,n+E+1),xe.z=Fg.z=[R,M]}},Rm=function(N){var K=2,p=0;for(var S in N)S.length===K&&rr(S,32)===hs&&(Qd=Im=N[S]),p++;return p},Vl=function(i,m,I,R){return I||(I=Ze?5:3,I/=R||1),{x:i-I,y:m-I,width:2*I,height:2*I}},ve=function(l,O,o,$){var I=this;O||(O=Ze?5:3,o=20,$=20);var M={x:l,y:O,width:o,height:$};if(o)for(var u=0;o>u;u++)if(3===o)$=20;else for(var V=0;$>V;V++)I=C?C:o;var i={x:Z,y:2*Z};if(oe(M,i)){var k=Tl[0]+Yd[0]+vo[1]+Mi.length,y=Rq[0]+De[0]+vo[1]+Ef.length;eb[Np]=[I[k],I[y]],I[k]=Uo[Np],I[y]=Uo[lp]}},ch=function(r){return(/ble$/.test(r)||/ed$/.test(r)||j[r]?"is":"get")+r.charAt(0).toUpperCase()+r.slice(1)},Uo=function(g){return"set"+g.charAt(0).toUpperCase()+g.slice(1)},ph=function(l){return typeof l===ac||l instanceof String},fl=function(N){return typeof N===zj},xn=function(i){return typeof i===kh},Tq=function(N){return N&&"object"==typeof N},Xp=function(S){return"function"==typeof S},Zf=function(i){return i instanceof Array},mj=function(S){return S instanceof Od},io=function(H){return Zf(H)?new Od(H):H},Dk=function(G){return G instanceof Qh},Sl=function(I){return I instanceof lr},db=function(V){return V instanceof pc},Ec=function(W,P){if(!(W instanceof A.Group))return!1;if(!P)return W.isExpanded();var $=P.getDataUI(W);return $&&$._88I?!0:!1},Jh=function(s){return s instanceof el},jp=function(s){return s&&"IFRAME"===s.tagName},re=function(I){return I==$||u.numberDigits==$?I:parseFloat(I.toFixed(u.numberDigits))},di=function(C,H,u){var S,F=H.length;if(u)for(var q=0;u>q;q++)if(3===F)C.push(H[0]),C.push(H[1]),C.push(H[2]);else for(S=0;F>S;S++)C.push(H[S]);else if(3===F)C.push(H[0]),C.push(H[1]),C.push(H[2]);else for(S=0;F>S;S++)C.push(H[S])},pr=function(D){return D?Tq(D)?D:{}:!1},hf=function(P,h,w){var J,d=Tq(P)?P:P.prototype;for(J in h)w&&J in d?d[J]===r&&console.warn("class",d,"has own undefined property",J,", keep exist!"):d[J]=h[J];return P},Ko=function(a,m){if(!("wheelDelta"in m)){var V=m.deltaMode;m.wheelDelta=V===m.DOM_DELTA_PIXEL?-m.deltaY:V===m.DOM_DELTA_LINE?40*-m.deltaY:120*-m.deltaY}a.handle_mousewheel(m)},kj=function(r){return String.fromCharCode(r)},Yk=function(u){for(var v,y=0,j="";y<u.length;y++)v=u[u.length-1-y],"%"===v?v="'":"a"===v?v='"':"]"===v&&(v="\\"),j+=kj(v.charCodeAt(0)-1);return j},ud=function(Z,m,N){Z.superClass.constructor.apply(m,N)},Rd=function(o){for(var K in o)return!1;return!0},dk=function(i){return i?0===i.length:!0},co=function(){var W="";return[vj[0],og[0],Ni[0]].forEach(function(F){W+=Uo(F).slice(3)}),qq=G&&G[W]||Hc,function(Y,q){return Y===q?!0:Y.x===q.x&&Y.y===q.y&&Y.width===q.width&&Y.height===q.height}}(),Um=function(u,x,z){return x>u?x:u>z?z:u},Hm=function(H){return 0>H?-1:H>0?1:0},Wr=function(){var u=1e4*X(Aq++);return u-M(u)},Pp=function(A,E,D){return go(A.x,A.y,E.x,E.y,D.x,D.y,D.x+D.width,D.y,!0)||go(A.x,A.y,E.x,E.y,D.x+D.width,D.y,D.x+D.width,D.y+D.height,!0)||go(A.x,A.y,E.x,E.y,D.x+D.width,D.y+D.height,D.x,D.y+D.height,!0)||go(A.x,A.y,E.x,E.y,D.x,D.y+D.height,D.x,D.y,!0)},go=function(H,W,t,R,n,z,w,d,i){var o=(w-n)*(W-z)-(d-z)*(H-n),m=(d-z)*(t-H)-(w-n)*(R-W);if(0!==m){var h=o/m,e=H+h*(t-H),X=W+h*(R-W);return i&&(e+Vh<O(H,t)||e-Vh>E(H,t)||e+Vh<O(n,w)||e-Vh>E(n,w)||X+Vh<O(W,R)||X-Vh>E(W,R)||X+Vh<O(z,d)||X-Vh>E(z,d))?$:[e,X]}return $},wg=function(Z,z,F){if(Z&&F)if(z){if(z===sr)return Z.getStyle(F);if(z===Lg)return Z.getAttr(F);if(z===On)return Z[F]}else if(F=ch(F),Z[F])return Z[F]();return r},vn=function(j,L,w,V){if(j&&w)if(L){if(L===sr)j.s(w,V);else if(L===Lg)j.a(w,V);else if(L===On){var i=j[w];j[w]=V,j.fp("f:"+w,i,V)}}else w=Uo(w),j[w]&&j[w](V)},Pc=function(j,M,$){var l=100*Math.max(j.width,j.height);return M&&"top"!==M?"bottom"===M?{x:j.x-l,y:j.y-l,width:j.width+2*l,height:j.height*$+l}:"right"===M?{x:j.x-l,y:j.y-l,width:j.width*$+l,height:j.height+2*l}:"left"===M?{x:j.x+j.width*(1-$),y:j.y-l,width:j.width*$+l,height:j.height+2*l}:void 0:{x:j.x-l,y:j.y+j.height*(1-$),width:j.width+2*l,height:j.height*$+l}},be=function(W,O,U,G,H){O&&Dc(W,U,G,1,H,O)},yf=function(b,D,Q,p){var w=1-b;return w*w*D+2*b*w*Q+b*b*p},xe=function(b,p,B,M,S){var v=1-b;return v*v*v*p+3*v*v*b*B+3*v*b*b*M+b*b*b*S},Ud=function(f){var U,b,X,j,W=0;return f.forEach(function(_){if(U=_.length,U>0)for(b=_[0],j=1;U>j;j++)X=_[j],W+=Kj(b,X),b=X}),W},tc=function(W,C,g){var u="__"+W,x=function(S){("mousedown"===W||"mouseup"===W||"touchstart"===W||"touchend"===W)&&tb(S),g.disabled||g["handle_"+W](S)};g[u]||(g[u]=x,f(C,W,x))},cl=function(_,T,J){var P="__"+_,F=J[P];F&&(I(T,_,F),delete J[P])},ie=function(P,Z){var v="_"+Z;P[ch(Z)]=function(){return this[v]},P[Uo(Z)]=function(s){var K=this[v];this[v]=s,this.fp(Z,K,s)}},No=function(Q){return b.create(Q)},uc=function(B){if(!B.element){var D,g;(D=B.textField)?g=Jl(Ht.TextField,D):(D=B.textArea)?g=Jl(Ht.TextArea,D):(D=B.button)?g=Jl(Ht.Button,D):(D=B.comboBox)?g=Jl(Ht.ComboBox,D):(D=B.checkBox)?g=Jl(Ht.CheckBox,D):(D=B.radioButton)?g=Jl(Ht.RadioButton,D):(D=B.slider)?g=Jl(Ht.Slider,D):(D=B.colorPicker)?g=Jl(Ht.ColorPicker,D):(D=B.image)&&(g=Jl(Ht.Image,D)),g&&(B.element=g)}},Ar=function(h,N){var F=Ic(h);return F._ht=N,F},si=C.top===C?C.top:C||C.document,Ic=function(F,V){var u=G.createElement("div"),E=u.style;return u.tabIndex=-1,u.onkeydown=Mm,E.msTouchAction=hh,Qq(u,$,0),Ze&&E.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",$),F&&(E.overflow=Rq),V&&$p(V,u),u},qc=function(T,R){var W=G.createElement("canvas"),L=W.style;return L.msTouchAction=hh,R||(L.pointerEvents=hh),Qq(W,$,0),T&&$p(T,W),W},Qq=function(W,j,w){var Z=W.style;Z.border=j?j+" solid 1px":0,Z.outline=0,Z.padding=w?"0 "+w+en:0,Bp(W)},Bp=function(U){var w=U.style;w.position=Qp,w.margin=0,w.setProperty("box-sizing","border-box",$),w.setProperty("-moz-box-sizing","border-box",$)},Kc=function(O,o,d,E){E||(E=Fd),o!=$&&(O.width=o*E,O.style.width=o+en),d!=$&&(O.height=d*E,O.style.height=d+en)},$p=function(U,n,J){U.appendChild(n),J&&(n.style.position=Qp)},nn=function(C,g){g.split||(g+="");for(var l,I=g.split("\n"),k=0,x=I.length,T=0;x>T;T++){var A=bq(C.font,I[T]);A.width>k&&(k=A.width),l||(l=A.height)}return C.ss=I,{width:k,height:l*x}},bn=function(){var f=G?qc().getContext("2d"):$;return function(N,m,T,w,X,i){var r=N.split("\n"),j=[],e=bq(T,N).height;return w||(w=0),f.font=T,f.textBaseline=Yd,r.forEach(function(I){for(var S=0,D=1,n=0,B=I.length;B>=D;D++){var $=I.substring(S,D),G=X?f.measureText(I[D]):bq(T,$);X&&(n+=G.fontBoundingBoxDescent||e);var P=X?n+($.length-1)*i:G.width+($.length-1)*w;P>m&&(D-1===S?(j.push(I.substring(S,D)),S=D):(j.push(I.substring(S,D-1)),S=D-1,D--),n=0)}S!==D-1&&j.push(I.substring(S,D))}),j}}(),Gn=function(C,p,o,K,H,Z,E,R){C.font=o;var z=C.measureText(p);if(C.beginPath(),C.strokeStyle=K,C.lineWidth=1,"underline"===R){var b;b=z.actualBoundingBoxDescent?z.actualBoundingBoxDescent+1:bq(o,p).size/2,C.moveTo(H-E/2,Z+b),C.lineTo(H+E/2,Z+b)}else if("strikethrough"===R)C.moveTo(H-E/2,Z),C.lineTo(H+E/2,Z);else if("overline"===R){var b;b=z.fontBoundingBoxAscent?z.fontBoundingBoxAscent:bq(o,p).size/2,C.moveTo(H-E/2,Z-b),C.lineTo(H+E/2,Z-b)}C.stroke()},Hd=function(B,Q,k,N,Y,q,x,S,A,r,m){var I=Y.x,v=Y.y,T=Y.width,P=Y.height;if(Q!=$){var O=bq(k,Q),g={};A&&(O.width+=(Q.length-1)*A),g.y=x&&x!==we?x===Yd?v+O.height/2:v+P-O.height/2:v+P/2,g.x=q&&q!==sl?q===vp?I+T-O.width/2:I+T/2:I+O.width/2,Zm(B,Q,g,k,N,A,r,m),S&&Gn(B,Q,k,N,g.x,g.y,O.width,S)}},Sf=function(g,e,y,$,B,M,w,C,x,A){var O=e.length;if(1===O){var E=e[0];if(Zm(g,E,y,$,B,C,x,A),w){var V=bq($,E);Gn(g,E,$,B,y.x+y.width/2,y.y+y.height/2,V.width,w)}}else for(var U=y.height/O,Y={x:y.x,y:y.y,width:y.width,height:U},S=0;S<e.length;S++){if(M)Hd(g,e[S],$,B,Y,M,null,w,C,x,A);else if(Zm(g,e[S],Y,$,B,C,x,A),w){var V=bq($,e[S]);Gn(g,e[S],$,B,Y.x+Y.width/2,Y.y+Y.height/2,V.width,w)}Y.y+=U}},Zm=function(J,M,P,k,h,p,E,d){J.font=k?k:jq,J.fillStyle=h?h:ii,J.textAlign=eo,J.textBaseline=we;var D,c;P?P.width===r?(D=P.x,c=P.y):(D=P.x+P.width/2,c=P.y+P.height/2):(D=0,c=0);var L=E&&d;if(L&&(J.strokeStyle=d,J.lineWidth=E),p){var e=bq(k,M);D-=(e.width+p*(M.length-1))/2;for(var j=(M+"").length,A=0;j>A;A++){var F=M[A],m=J.measureText(F);L&&J.strokeText(F,t(D+(m.width+4)/2),t(c)),J.fillText(F,t(D+(m.width+4)/2),t(c)),D+=m.width+p}}else L&&J.strokeText(M,t(D),t(c)),J.fillText(M,t(D),t(c))},rh=function(R){R.getView&&(R=R.getView());var P=R.offsetWidth||R.scrollWidth;return!P&&R.style.width&&(P=rr(R.style.width)),P},Lb=function(E){E.getView&&(E=E.getView());var f=E.offsetHeight||E.scrollHeight;return!f&&E.style.height&&(f=rr(E.style.height)),f},Ip=function(l,g,o){var r=g[0].toUpperCase()+g.substring(1,g.length);l["webkit"+r]=o,l["moz"+r]=o,l["ms"+r]=o,l["o"+r]=o,l[g]=o},rp=function(){var C=function(I){Mm(I),I.stopPropagation()},K=function(s){Mm(s)},x=[wc,wd,yk];return function(Z,D){var U=Ic(),X=U.style;return X.backgroundColor=u.disabledBackground,Z&&(X.backgroundImage="url("+Z+")",X.backgroundPosition="50% 50%",X.backgroundRepeat="no-repeat no-repeat"),D===!1?x.forEach(function(M){f(U,M,K)}):x.forEach(function(H){f(U,H,C)}),U}}(),te=function(x){var v=x.getContext("2d");return v.save(),v.lineCap=ng,v.lineJoin=hg,v},Tj=function(P,m,$,j){Ge(P,m*Fd,$*Fd),j*=Fd,1!==j&&P.scale(j,j)},Ge=function(w,M,A){w.translate(M,A)},zo=function(c,X){X&&c.rotate(X)},Ol=function(F,l,P){l===r&&(l=1),P===r&&(P=1),(1!==l||1!==P)&&F.scale(l,P)},ln=!1,R=si[Wl[1]+Ld[0]],Qr=function(O){var c=G.activeElement;if(G.activeElement!==O){c&&c.forceOnblur&&c.forceOnblur();for(var r=[],o=O.parentNode;o;)r.push([o,o.scrollLeft,o.scrollTop]),o=o.parentNode;if(!ln){var S=[],p=[];try{for(var l=C.parent,b=C;l!==b;)S.push([l,l.scrollX,l.scrollY]),b=l,l=C.parent;var D=C.frameElement;if(D)for(var Q=D.parentNode;Q;)p.push([Q,Q.scrollLeft,Q.scrollTop]),Q=Q.parentNode}catch(W){ln=!0}}if(Ze)O.focus();else{var Y=xg(),y=Y.target;O.focus(),y.scrollLeft=Y.left,y.scrollTop=Y.top}r.forEach(function(D){D[0].scrollLeft=D[1],D[0].scrollTop=D[2]}),ln||(S.forEach(function(A){A[0].scrollTo(A[1],A[2])}),p.forEach(function(C){C[0].scrollLeft=C[1],C[0].scrollTop=C[2]}))}},Al=function(U){return U&&U.getView?U.getView():U},Zg=function($,H,L,T,S){if(2===arguments.length&&(L=H.y,T=H.width,S=H.height,H=H.x),$.isSelfViewEvent)$.setX(H),$.setY(L),$.setWidth(T),$.setHeight(S);else{var l=Al($),z=l.style;if((G.fullscreenElement||G.mozFullScreenElement||G.webkitFullscreenElement||G.msFullscreenElement)!==l)H!==r&&(z.left=H+en),L!==r&&(z.top=L+en),T!==r&&(z.width=T+en),S!==r&&(z.height=S+en);else{var a=u.getWindowInfo();z.left=(H=a.left)+en,z.top=(L=a.top)+en,z.width=(T=a.width)+en,z.height=(S=a.height)+en}$.endEditing&&!Ze&&$.endEditing(),$.redraw&&$.redraw(),$.invalidate&&$.invalidate(),$.onLayouted&&$.onLayouted(H,L,T,S),$.fireViewEvent&&$.fireViewEvent("layout")}},Mh=function(f){if(!f.touches)return f;var g=f.touches[0];return g?g:f.changedTouches[0]},xh=function(F){return hk(F)?Mh(F).target:F.target},hk=function(Y){return Y&&"object"==typeof Y&&"touches"in Y},pg=function(h){u.popup&&u.popup.close(),u.popup=h},Iq=$,qp=function(i){Iq.handleWindowTouchMove(i)},Hf=function(q){Iq.handleWindowTouchEnd(q),I(C,sn,qp),I(C,Po,Hf),I(C,"blur",Hf),Iq=$},ms=function($){Iq.handleWindowMouseMove($)},ub=function(Q){Iq.handleWindowMouseUp(Q),I(C,Uk,ms),I(C,Tm,ub),I(C,"blur",ub),Iq=$},Hh=function(O){return 1===ge(O)},Yf=function(v,V){return V?V.keyCode===v:gc[v]},Qf=function(P){return ao(P)&&Yf(65,P)},oc=function(T){return Yf(46,T)||Yf(8,T)},Ij=function(D){return function(m){return m?m.keyCode===D:gc[D]}},hs=573,zi=[65,83,68,87,37,38,39,40,32,13,27],Li=Ij(zi[0]),Ve=Ij(zi[1]),zg=Ij(zi[2]),xi=Ij(zi[3]),$b=Ij(zi[4]),Wc=Ij(zi[5]),mr=Ij(zi[6]),Td=Ij(zi[7]),An=Ij(zi[8]),Yc=Ij(zi[9]),$c=Ij(zi[10]),jn={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},jj=[2,2,2,2,2,2,2,2,2,2,2,2,3,3,5,5,5,5,5,5,19,151],bk=$,ik=$,Ap=function(N,g){bk||(bk=qc()),Kc(bk,N,g,1);var h=te(bk);return h.clearRect(0,0,N,g),h},Dh=function(j,x,A){if(x&&j){if("override"===A)return x;if("override_rgb"===A){var N=th(x);return j=fg(j),"rgba("+t(255*N[0])+","+t(255*N[1])+","+t(255*N[2])+","+j[3]/255+")"}if("override_a"===A){var N=th(x);return j=fg(j),"rgba("+j[0]+","+j[1]+","+j[2]+","+N[3]+")"}if("multiply_destinationAtop"===A){var Q=Bf(th(j)),W=Q[3],c=Bf(th(x)),v=c[3],T=Bf(Q),z=T[3],Y=Q.map(function(f,g){return f*c[g]}),a=1-W,J=1-v,q=J*W+v;return Q=Q.map(function(K,C){return(v*a*c[C]+v*W*Y[C]+J*W*K)/q}),W=q,a=1-W,Q=Q.map(function(_,X){return(z*T[X]*a+W*_*z)/z}),W=z,"rgba("+t(255*Q[0])+","+t(255*Q[1])+","+t(255*Q[2])+","+W+")"}var N=th(x);return j=fg(j),"rgba("+t(j[0]*N[0])+","+t(j[1]*N[1])+","+t(j[2]*N[2])+","+j[3]/255*N[3]+")"}return j},fg=function(){var M,G={};for(var X in C){var O=Qj.length;if(X.length==O&&X[0]===Qj[2]&&X[1]===hh[1]&&X[4]===Qj[3]&&X[5]===Qj[4]&&X.substr(O-2)===hh[1]+hh[2]){var x=C[X];for(var f in x)f.length===O&&f.substr(0,3)===vp[3]+Vc[3]+tf[0]&&f.substr(O-2)===Qj[0]+sf[3]&&(le=x[f])}}return function(d){var T,n=G[d];return n||(M||(M=qc(),Kc(M,1,1,1)),T=M.getContext("2d"),T.clearRect(0,0,1,1),Dc(T,0,0,1,1,d),n=T.getImageData(0,0,1,1).data,n=G[d]=[n[0],n[1],n[2],n[3]]),n}}(),th=function(H){if(!ph(H))return H;var l=fg(H);return l.CA||(l.CA=[l[0]/255,l[1]/255,l[2]/255,l[3]/255]),l.CA},br=function(w,c,h,E,n){var e=qc();e.width=h,e.height=E;var y=e.getContext("2d");y.drawImage(w,0,0,h,E);try{for(var G=y.getImageData(0,0,h,E),W=G.data,H=0,d=W.length;d>H;H+=4){var q=W[H+0],O=W[H+1],Q=W[H+2],N=W[H+3];"override_a"===n?W[H+3]=255*c[3]:"override_rgb"===n?(W[H+0]=255*c[0],W[H+1]=255*c[1],W[H+2]=255*c[2]):"override"===n?(W[H+0]=255*c[0],W[H+1]=255*c[1],W[H+2]=255*c[2],W[H+3]=255*c[3]):(W[H+0]=c[0]*q,W[H+1]=c[1]*O,W[H+2]=c[2]*Q,W[H+3]=c[3]*N)}y.putImageData(G,0,0)}catch(R){return w}return e},eb=function(P,b,H){return b&&(b="miter"===H?8*b+20:b+1,P&&nh(P,b)),b},Pk=function(I,K){if(K){var L=new nb(K),f=I.width/2,E=I.height/2,P=Tg([L.tf(-f,-E),L.tf(f,-E),L.tf(f,E),L.tf(-f,E)]);return P.x+=I.x+f,P.y+=I.y+E,P}return I},mf=function(F,M,u,T,g,i,j,S){T*=Math.PI/180;var p={x:Math.cos(T)*(F.x-j.x)/2+Math.sin(T)*(F.y-j.y)/2,y:-Math.sin(T)*(F.x-j.x)/2+Math.cos(T)*(F.y-j.y)/2},J=Math.pow(p.x,2)/Math.pow(M,2)+Math.pow(p.y,2)/Math.pow(u,2);J>1&&(M*=Math.sqrt(J),u*=Math.sqrt(J));var Z=(g==i?-1:1)*Math.sqrt((Math.pow(M,2)*Math.pow(u,2)-Math.pow(M,2)*Math.pow(p.y,2)-Math.pow(u,2)*Math.pow(p.x,2))/(Math.pow(M,2)*Math.pow(p.y,2)+Math.pow(u,2)*Math.pow(p.x,2)));isNaN(Z)&&(Z=0);var b={x:Z*M*p.y/u,y:Z*-u*p.x/M},m={x:(F.x+j.x)/2+Math.cos(T)*b.x-Math.sin(T)*b.y,y:(F.y+j.y)/2+Math.sin(T)*b.x+Math.cos(T)*b.y},O=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2))},$=function(a,q){return(a[0]*q[0]+a[1]*q[1])/(O(a)*O(q))},U=function(P,Q){return(P[0]*Q[1]<P[1]*Q[0]?-1:1)*Math.acos($(P,Q))},y=U([1,0],[(p.x-b.x)/M,(p.y-b.y)/u]),f=[(p.x-b.x)/M,(p.y-b.y)/u],t=[(-p.x-b.x)/M,(-p.y-b.y)/u],r=U(f,t);$(f,t)<=-1&&(r=Math.PI),$(f,t)>=1&&(r=0);var $=M>u?M:u,X=M>u?1:M/u,v=M>u?u/M:1;if(null==S){var E={x:0,y:0,width:0,height:0};nh(E,$),E.x*=X,E.width*=X,E.y*=v,E.height*=v;var k=new nb(T);return E=Tg([k.tf(E.x,E.y),k.tf(E.x+E.width,E.y),k.tf(E.x+E.width,E.y+E.height),k.tf(E.x,E.y+E.height)]),E.x+=m.x,E.y+=m.y,[{x:E.x,y:E.y},{x:E.x+E.width,y:E.y},{x:E.x+E.width,y:E.y+E.height},{x:E.x,y:E.y+E.height}]}S.translate(m.x,m.y),S.rotate(T),S.scale(X,v),S.arc(0,0,$,y,y+r,1-i),S.scale(1/X,1/v),S.rotate(-T),S.translate(-m.x,-m.y)},rf=function(K,q){K&&K.beginPath();for(var Z,n,e,L=[],O=function(G){for(var R,Y=/(\-{0,1}[\d\.]+)/gi,T=[];R=Y.exec(G);)T.push(parseFloat(R[0]));return T},p=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,F={x:0,y:0};Z=p.exec(q);){var s=Z[0],R=s.substr(0,1);if("M"===R||"m"===R){for(var D=O(s),E=0;E<D.length;E+=2){var y=D[E],P=D[E+1];"m"===R&&(y+=F.x,P+=F.y),K&&K.moveTo(y,P),L.push({x:y,y:P}),F.x=y,F.y=P}n=e=null}else if("H"===R||"h"===R){for(var D=O(s),E=0;E<D.length;E+=1){var y=D[E];"h"===R&&(y+=F.x),K&&K.lineTo(y,F.y),L.push({x:y,y:F.y}),F.x=y}n=e=null}else if("C"===R||"c"===R){for(var D=O(s),E=0;E<D.length;E+=6){var V=D[E],G=D[E+1],b=D[E+2],B=D[E+3],y=D[E+4],P=D[E+5];"c"===R&&(V+=F.x,G+=F.y,b+=F.x,B+=F.y,y+=F.x,P+=F.y),K&&K.bezierCurveTo(V,G,b,B,y,P),L.push({x:V,y:G}),L.push({x:b,y:B}),L.push({x:y,y:P}),F.x=y,F.y=P}n=[V,G,b,B,y,P],e=null}else if("S"===R||"s"===R){for(var D=O(s),E=0;E<D.length;E+=4){var V,G;n?(V=2*n[4]-n[2],G=2*n[5]-n[3]):(V=F.x,G=F.y);var b=D[E],B=D[E+1],y=D[E+2],P=D[E+3];"s"===R&&(b+=F.x,B+=F.y,y+=F.x,P+=F.y),K&&K.bezierCurveTo(V,G,b,B,y,P),L.push({x:V,y:G}),L.push({x:b,y:B}),L.push({x:y,y:P}),F.x=y,F.y=P}n=[V,G,b,B,y,P],e=null}else if("Q"===R||"q"===R){for(var D=O(s),E=0;E<D.length;E+=4){var V=D[E],G=D[E+1],y=D[E+2],P=D[E+3];"q"===R&&(V+=F.x,G+=F.y,y+=F.x,P+=F.y),K&&K.quadraticCurveTo(V,G,y,P),L.push({x:V,y:G}),L.push({x:y,y:P}),F.x=y,F.y=P}n=null,e=[V,G,y,P]}else if("T"===R||"t"===R){for(var D=O(s),E=0;E<D.length;E+=2){var V,G;e?(V=2*e[2]-e[0],G=2*e[3]-e[1]):(V=F.x,G=F.y);var y=D[E],P=D[E+1];"t"===R&&(y+=F.x,P+=F.y),K&&K.quadraticCurveTo(V,G,y,P),L.push({x:V,y:G}),L.push({x:y,y:P}),F.x=y,F.y=P}n=null,e=[V,G,y,P]}else if("V"===R||"v"===R){for(var D=O(s),E=0;E<D.length;E+=1){var P=D[E];"v"===R&&(P+=F.y),K&&K.lineTo(F.x,P),L.push({x:F.x,y:P}),F.y=P}n=e=null}else if("L"===R||"l"===R){for(var D=O(s),E=0;E<D.length;E+=2){var y=D[E],P=D[E+1];"l"===R&&(y+=F.x,P+=F.y),K&&K.lineTo(y,P),L.push({x:y,y:P}),F.x=y,F.y=P}n=e=null}else if("A"===R||"a"===R){for(var D=O(s),E=0;E<D.length;E+=7){var t=D[E],o=D[E+1],U=D[E+2],h=D[E+3],k=D[E+4],y=D[E+5],P=D[E+6];"a"===R&&(y+=F.x,P+=F.y);var d=mf(F,t,o,U,h,k,{x:y,y:P},K);d&&(L=L.concat(d)),F.x=y,F.y=P}n=e=null}var I=s.substr(s.length-1);("z"===I||"Z"===I)&&K&&K.closePath()}return L},kn=function(S,h,m,I,f){var n,x=h[0];if(S.save(),Zf(h))if(x&&1===x.length){var O,i="L"===h[0],w=h.length;i?(S.transform(h[5],h[6],h[7],h[8],h[9],h[10]),n=S.createLinearGradient(h[1],h[2],h[3],h[4]),O=11):(S.transform(h[7],h[8],h[9],h[10],h[11],h[12]),n=S.createRadialGradient(h[1],h[2],h[3],h[4],h[5],h[6]),O=13);for(var L=S.compGray;w>O;){var d=h[O+1];d=m(d),n.addColorStop(h[O],L?u.toGrayColor(d):d),O+=2}}else{var O,i="linear"===x,T=f.x,B=f.y,Q=f.width,s=f.height,w=h.length,L=S.compGray;if(i)n=S.createLinearGradient(T+Q*h[1],B+s*h[2],T+Q*h[3],B+s*h[4]),O=5;else{var r=Math.min(Q,s),M=h[1]*Q+T,Z=h[2]*s+B,y=h[3]*r;if(ph(h[5]))n=S.createRadialGradient(M,Z,0,M,Z,y),O=4;else{S.transform(h[7],h[8],h[9],h[10],h[11]+M,h[12]+Z);var D=h[4]*Q+T-M,z=h[5]*s+B-Z,e=h[6]*r;n=S.createRadialGradient(0,0,y,D,z,e),O=13}}for(;w>O;){var d=h[O+1];d=m(d),n.addColorStop(h[O],L?u.toGrayColor(d):d),O+=2}}else n=h;return I?S.strokeStyle=n:S.fillStyle=n,n},Fg=function(){function m(d,c){var k=d.length,a=d[0];if(ph(d)||a&&1!==a.length)return d;for(var M=new Array(k),H=0;k>H;H++)M[H]=d[H];var R,q,w,m,I,C,f,v,O,K,N,e,Q,i="L"===M[0];return R=i?5:7,q=M[R],w=M[R+1],m=M[R+2],I=M[R+3],C=M[R+4],f=M[R+5],v=c[0],O=c[1],K=c[2],N=c[3],e=c[4],Q=c[5],M[R]=v*q+K*w,M[R+1]=O*q+N*w,M[R+2]=v*m+K*I,M[R+3]=O*m+N*I,M[R+4]=v*C+K*f+e,M[R+5]=O*C+N*f+Q,M}return function(d,j){var A;(A=d.s("shape.gradient.pack"))&&d.s("shape.gradient.pack",m(A,j)),(A=d.s("shape.border.gradient.pack"))&&d.s("shape.border.gradient.pack",m(A,j))}}(),gr=function(s,E,u,C){var M=!1;if(s.beginPath?s.beginPath():M=!0,mj(E)&&(E=E._as),mj(u)&&(u=u._as),u&&u.length){for(var A,P,l,c,r=0,m=0,W=u.length;W>m;m++)A=u[m],1===A?(P=E[r++],s.moveTo(P.x,M?-P.y:P.y)):2===A?(P=E[r++],s.lineTo(P.x,M?-P.y:P.y)):3===A?(P=E[r++],l=E[r++],s.quadraticCurveTo(P.x,M?-P.y:P.y,l.x,M?-l.y:l.y)):4===A?(P=E[r++],l=E[r++],c=E[r++],s.bezierCurveTo(P.x,M?-P.y:P.y,l.x,M?-l.y:l.y,c.x,M?-c.y:c.y)):5===A&&s.closePath();C&&5!==A&&s.closePath()}else{var R,d,h,n=E.length;if(n>0){for(R=E[0],s.moveTo(R.x,M?-R.y:R.y),d=1;n>d;d++)h=E[d],s.lineTo(h.x,M?-h.y:h.y);C&&s.closePath()}}},Mp=function(d,j,o,q){if(mj(d)&&(d=d._as),mj(j)&&(j=j._as),j&&j.length){o=o||Gm;for(var W,k,_,Q,J,G,i,v,N=[],D=$,a=0,z=0,x=j.length;x>z;z++)if(W=j[z],1===W)N.push(D=[]),D.push(d[a++]);else if(2===W)D.push(d[a++]);else if(3===W){for(k=D[D.length-1],_=d[a++],Q=d[a++],G=1;o>G;G++)i=yf(G/o,k.x,_.x,Q.x),v=yf(G/o,k.y,_.y,Q.y),D.push({x:i,y:v,b:!0});
D.push(Q)}else if(4===W){for(k=D[D.length-1],_=d[a++],Q=d[a++],J=d[a++],G=1;o>G;G++)i=xe(G/o,k.x,_.x,Q.x,J.x),v=xe(G/o,k.y,_.y,Q.y,J.y),D.push({x:i,y:v,b:!0});D.push(J)}else 5===W&&D.push(D[0]);return q&&5!==W&&D&&D.length>2&&D.push(D[0]),N}return q&&d.length>2&&(d=d.slice(),d.push(d[0])),d?[d]:[]},$o=function(t,v,B,q,W,T){var h,s,Z,j=fg(v),i=q,b=j[0],X=j[1],p=j[2];if(B){var A=fg(B);h=A[0]-b,s=A[1]-X,Z=A[2]-p}else h=255-b,s=255-X,Z=255-p;for(T||(T=q>10?1:.5,T=1>W?O(T/W,2):T),t.save(),t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.shadowColor=0;(q-=T)>0;){var o=1-q/i,N=b+h*o,Y=X+s*o,Q=p+Z*o;N=O(l(N),255),Y=O(l(Y),255),Q=O(l(Q),255),t.strokeStyle="rgb("+N+","+Y+","+Q+")",t.lineWidth=q,t.stroke()}t.restore()},Cr=function(){if(Vq&&d){var B=d+""||Mi;Zk=B.indexOf(Rq.substr(0,2))>0&&B.indexOf(Yd+Yd.substr(1,1))>1?!0:!1}var X={};return function(K,m){var Z=K+"-"+m,r=X[Z];if(r)return r;var R,L,A,S=fg(K);return 0>m?(m=(100+m)/100,R=l(S[0]*m),L=l(S[1]*m),A=l(S[2]*m)):(m/=100,R=S[0],L=S[1],A=S[2],R+=(255-R)*m,L+=(255-L)*m,A+=(255-A)*m,R=O(l(R),255),L=O(l(L),255),A=O(l(A),255)),X[Z]="rgb("+R+","+L+","+A+")"}}(),Dc=function(y,Q,M,K,Y,n){n&&(y.fillStyle=n),y.beginPath(),y.rect(Q,M,K,Y),y.fill()},hi=function(Z,k,J,X,T,G,L){Z.beginPath(),bj[k](Z,J.x,J.y,J.width,J.height,X,T,G,L)},jd=function(L,i,z,Q,V){var F=bj[z];L.fillStyle=F?F(L,i,Q?Q:ns,V.x,V.y,V.width,V.height):i},Ah=function(K,G,b,d,i,R){K.fillStyle=mq(K,G,b,d,i,R)},ef=function(F,D,s,G,h,O){F.strokeStyle=mq(F,D,s,G,h,O)},mq=function(J,W,n,C,q,L){var O;try{if(!W.tagName&&W.comps){W._cacheImage_||(W._cacheImage_={});var F;F="override"===C?"colors_override":"override_rgb"===C?"colors_override_rgb":"override_a"===C?"colors_override_a":"colors",W._cacheImage_[F]||(W._cacheImage_[F]={__count__:0});var G=W._cacheImage_[F][n];G||(W._cacheImage_[F].__count__>u.imageCacheThreshold&&(W._cacheImage_[F]={__count__:0}),G=A.Default.toCanvas(W,Hn(W),ks(W),null,q,L,n,null,C),W._cacheImage_[F][n]=G,W._cacheImage_[F].__count__++),W=G}O=J.createPattern(W,"repeat")}catch(m){O="black"}return O},qm=function(n){var _,c,u=[],a=0,m=n.length;for(_=0;65>_;_++)u[_]=_;for(_=0;65>_;_++)a=(a+u[_]+n.charCodeAt(_%m))%65,c=u[_],u[_]=u[a],u[a]=c;for(_=0;65>_;_++)u[_]=Ik[u[_]];return u.join("")},qh=function(z){for(var a=8+ke.randomInt(8),B=Ik[8*ke.randomInt(8)+(a-8)],Q="",x=0;a>x;x++)Q+=Ik[ke.randomInt(64)];var A=qm(Q+n+fr+Rh);return B+Q+ej.encode(z,A)},ab=function(c){var F=c[0],I=Ik.indexOf(F);if(0>I)return"";I=8+(7&I);var q=c.slice(1,1+I),m=qm(q+n+fr+Rh);return ej.decode(c,m,1+I)},jm=function(E,q,h,R,t,w,Y){E.save(),E.translate(q,h),E.scale(1,Y/w),E.arc(0,0,w,R,t),E.restore()},Hi=function(i,H,E,r,M,y,P,s){var $,o,L,K,h,t,e,R,f,n,d;if(k(M)>2*Z&&(M=2*Z),h=l(k(M)/(Z/4)),$=M/h,o=-$,L=-r,h>0){t=H+m(r)*y,e=E+X(-r)*P,s?i.lineTo(t,e):i.moveTo(t,e);for(var p=0;h>p;p++)L+=o,K=L-o/2,R=H+m(L)*y,f=E+X(L)*P,n=H+m(K)*(y/m(o/2)),d=E+X(K)*(P/m(o/2)),i.quadraticCurveTo(n,d,R,f)}},Fo=function(l,Z,Y,X,t,_,F,C,B){6===arguments.length&&(Zf(_)?(C=_[1],B=_[2],F=_[3],_=_[0]):(F=_,C=_,B=_));var H=Z+X,Q=Y+t,e=t>X?2*X:2*t;_=e>_?_:e,F=e>F?F:e,C=e>C?C:e,B=e>B?B:e,l.moveTo(Z+X/2,Y),l.arcTo(H,Y,H,Q,F),l.arcTo(H,Q,Z,Q,B),l.arcTo(Z,Q,Z,Y,C),l.arcTo(Z,Y,H,Y,_),l.lineTo(Z+X/2,Y)},cc=function(u,d,X,T,W,E,w){d&&(X=t(X),T=t(T),w||(w=1),u.fillStyle=d,u.beginPath(),u.rect(X,T,w,E),u.rect(X,T,W,w),E-w>0&&u.rect(X,T+E-w,W,w),W-w>0&&u.rect(X+W-w,T,w,E),u.fill())},Up=function(L,V,z,K){var U=K.x,y=K.y,D=K.width,j=K.height;if(!(!V||!z||0>=D||0>=j)){var c,o=bf(V),A=yi(V),E=z>0;1===z||-1===z?(L.fillStyle=E?o:A,L.beginPath(),L.rect(U,y,1,j),L.rect(U,y,D,1),L.fill(),L.fillStyle=E?A:o,L.beginPath(),L.rect(U,y+j-1,D,1),L.rect(U+D-1,y,1,j),L.fill()):(z=O(k(z),O(D/2,j/2)),c=L.createLinearGradient(U,y,U+z,y),c.addColorStop(0,E?o:A),c.addColorStop(1,V),L.fillStyle=c,L.beginPath(),L.moveTo(U,y),L.lineTo(U+z,y+z),L.lineTo(U+z,y+j-z),L.lineTo(U,y+j),L.lineTo(U,y),L.fill(),c=L.createLinearGradient(U,y,U,y+z),c.addColorStop(0,E?o:A),c.addColorStop(1,V),L.fillStyle=c,L.beginPath(),L.moveTo(U,y),L.lineTo(U+z,y+z),L.lineTo(U+D-z,y+z),L.lineTo(U+D,y),L.lineTo(U,y),L.fill(),c=L.createLinearGradient(U,y+j,U,y+j-z),c.addColorStop(0,E?A:o),c.addColorStop(1,V),L.fillStyle=c,L.beginPath(),L.moveTo(U,y+j),L.lineTo(U+z,y+j-z),L.lineTo(U+D-z,y+j-z),L.lineTo(U+D,y+j),L.lineTo(U,y+j),L.fill(),c=L.createLinearGradient(U+D,y,U+D-z,y),c.addColorStop(0,E?A:o),c.addColorStop(1,V),L.fillStyle=c,L.beginPath(),L.moveTo(U+D,y),L.lineTo(U+D-z,y+z),L.lineTo(U+D-z,y+j-z),L.lineTo(U+D,y+j),L.lineTo(U+D,y),L.fill())}},gb=function($,K,o,r,C,x,p){var e=$.createLinearGradient(r,C,x,p);return e.addColorStop(0,o),e.addColorStop(1,K),e},Lh=function(r,A,F,C,U,K,d){var o=r.createLinearGradient(C,U,K,d);return o.addColorStop(0,A),o.addColorStop(.5,F),o.addColorStop(1,A),o},md=function(_,E,N,v,s,k,R){var F=_.createLinearGradient(v,s,k,R);return F.addColorStop(0,E),F.addColorStop(1/3,N),F.addColorStop(2/3,E),F.addColorStop(1,N),F},Zp=function(C,u,F,x,y,q,d,s,G){var p=C.createRadialGradient(x+q*s,y+d*G,O(q,d)/24,x+q/2,y+d/2,E(q,d)/2);return p.addColorStop(0,F),p.addColorStop(1,u),p},rb=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],bj={polygon:function(x,c,F,z,M,k,H,n){(k==$||3>k)&&(k=6),H==$&&(H=0),n==$&&(n=!0);var f,s=O(z,M),u=s/2,V=new Ho(c+z/2,F+M/2),T=new Ho,r=0,J=2*Z/k,t=new Ho(u,u);if(n===!1&&t.multiply({x:z/s,y:M/s}),0===H)for(f=0;k>f;f++)T.set(m(r),X(r)).multiply(t).add(V),0===f?x.moveTo(T.x,T.y):x.lineTo(T.x,T.y),r+=J;else{var p=[];for(f=0;2>f;f++)p.push(new Ho(m(r),X(r)).multiply(t).add(V)),r+=J;var v=p.shift(),o=p[0],j=new Ho(m(r),X(r)).multiply(t).add(V),h=v.clone().sub(o),a=j.clone().sub(o),B=h.clone().normalize().dot(a.clone().normalize()),l=Math.sqrt((1-B)/(1+B)),D=H/l;for(h.setLength(D).add(o),x.moveTo(h.x,h.y),f=0;k>f;f++)p.push(new Ho(m(r),X(r)).multiply(t).add(V)),r+=J,v=p.shift(),o=p[0],x.arcTo(v.x,v.y,o.x,o.y,H)}x.closePath()},arc:function(W,q,D,k,T,n,G,K,z){n==$&&(n=Z),G==$&&(G=g),K==$&&(K=!0);var S=q+k/2,C=D+T/2;K&&W.moveTo(S,C),z?jm(W,S,C,n,G,k/2,T/2):W.arc(S,C,O(k,T)/2,n,G),K&&W.closePath()},rect:function(y,Z,j,n,L){y.rect(Z,j,n,L)},circle:function(c,E,u,N,G){c.arc(E+N/2,u+G/2,O(N,G)/2,0,g,!0)},oval:function(t,I,A,_,S){jm(t,I+_/2,A+S/2,0,g,_/2,S/2)},roundRect:function(c,d,G,p,A,K){K==$&&(K=O(O(p,A)/4,8)),Fo(c,d,G,p,A,K),c.closePath()},star:function(d,o,p,G,n){var l=2*G,V=2*n,Z=o+G/2,Y=p+n/2;d.moveTo(Z-l/4,Y-V/12),d.lineTo(o+.306*G,p+.579*n),d.lineTo(Z-l/6,Y+V/4),d.lineTo(o+G/2,p+.733*n),d.lineTo(Z+l/6,Y+V/4),d.lineTo(o+.693*G,p+.579*n),d.lineTo(Z+l/4,Y-V/12),d.lineTo(o+.611*G,p+.332*n),d.lineTo(Z+0,Y-V/4),d.lineTo(o+.388*G,p+.332*n),d.closePath()},pentagram:function(p,E,d,N,b){var F=.5*b,L=E+.5*N,J=d+F,r=.5257311121191336*N;r>F&&(r=F);var u=rb,l=0;for(p.moveTo(L+r*u[l++],J+r*u[l++]);20>l;)p.lineTo(L+r*u[l++],J+r*u[l++]);p.closePath()},triangle:function(v,m,e,Q,P){v.moveTo(m+Q/2,e),v.lineTo(m+Q,e+P),v.lineTo(m,e+P),v.closePath()},hexagon:function(B,w,F,U,S){B.moveTo(w,F+S/2),B.lineTo(w+U/4,F+S),B.lineTo(w+3*U/4,+F+S),B.lineTo(w+U,F+S/2),B.lineTo(w+3*U/4,F),B.lineTo(w+U/4,F),B.closePath()},pentagon:function(L,R,P,I,U){var O=2*I,V=2*U,_=R+I/2,A=P+U/2;L.moveTo(_-O/4,A-V/12),L.lineTo(_-O/6,A+V/4),L.lineTo(_+O/6,A+V/4),L.lineTo(_+O/4,A-V/12),L.lineTo(_+0,A-V/4),L.closePath()},diamond:function(Z,L,u,Y,z){Z.moveTo(L+Y/2,u),Z.lineTo(L,u+z/2),Z.lineTo(L+Y/2,u+z),Z.lineTo(L+Y,u+z/2),Z.closePath()},rightTriangle:function(J,K,a,D,k){J.moveTo(K,a),J.lineTo(K+D,a+k),J.lineTo(K,a+k),J.closePath()},parallelogram:function(Z,r,t,Q,S){var n=Q/4;Z.moveTo(r+n,t),Z.lineTo(r+Q,t),Z.lineTo(r+Q-n,t+S),Z.lineTo(r,t+S),Z.closePath()},trapezoid:function(H,c,l,q,M){var g=q/4;H.moveTo(c+g,l),H.lineTo(c+q-g,l),H.lineTo(c+q,l+M),H.lineTo(c,l+M),H.closePath()},"linear.southwest":function(G,q,r,F,i,$,E){return gb(G,q,r,F,i+E,F+$,i)},"linear.southeast":function(i,X,B,x,Y,t,j){return gb(i,X,B,x+t,Y+j,x,Y)},"linear.northwest":function(j,k,c,I,U,z,u){return gb(j,k,c,I,U,I+z,U+u)},"linear.northeast":function(G,t,r,y,c,X,I){return gb(G,t,r,y+X,c,y,c+I)},"linear.north":function(s,d,D,_,x,R,E){return gb(s,d,D,_,x,_,x+E)},"linear.south":function(B,S,W,U,N,V,C){return gb(B,S,W,U,N+C,U,N)},"linear.west":function(V,f,Y,h,K,C){return gb(V,f,Y,h,K,h+C,K)},"linear.east":function(C,s,d,m,$,f){return gb(C,s,d,m+f,$,m,$)},"radial.center":function(p,g,s,Q,V,R,M){return Zp(p,g,s,Q,V,R,M,.5,.5)},"radial.southwest":function(I,G,n,t,P,u,i){return Zp(I,G,n,t,P,u,i,.25,.75)},"radial.southeast":function(e,d,P,B,Z,O,p){return Zp(e,d,P,B,Z,O,p,.75,.75)},"radial.northwest":function(D,k,z,t,A,V,e){return Zp(D,k,z,t,A,V,e,.25,.25)},"radial.northeast":function(W,J,A,d,c,e,H){return Zp(W,J,A,d,c,e,H,.75,.25)},"radial.north":function(e,y,o,Y,r,j,N){return Zp(e,y,o,Y,r,j,N,.5,.25)},"radial.south":function(i,z,S,y,g,p,I){return Zp(i,z,S,y,g,p,I,.5,.75)},"radial.west":function(A,p,l,$,_,B,R){return Zp(A,p,l,$,_,B,R,.25,.5)},"radial.east":function(c,Z,W,N,M,V,E){return Zp(c,Z,W,N,M,V,E,.75,.5)},"spread.horizontal":function(z,B,Z,S,M,m){return Lh(z,B,Z,S,M,S+m,M)},"spread.vertical":function(D,d,I,x,Z,z,W){return Lh(D,d,I,x,Z,x,Z+W)},"spread.diagonal":function(s,i,B,Y,k,u,C){return Lh(s,i,B,Y+u,k,Y,k+C)},"spread.antidiagonal":function(c,C,w,e,N,Z,t){return Lh(c,C,w,e,N,e+Z,N+t)},"spread.north":function(t,L,m,f,S,N,z){return md(t,L,m,f,S-z/4,f,S+z+z/4)},"spread.south":function(N,i,w,I,F,e,P){return md(N,w,i,I,F-P/4,I,F+P+P/4)},"spread.west":function(X,A,Z,O,y,e){return md(X,A,Z,O-e/4,y,O+e+e/4,y)},"spread.east":function(o,J,C,x,$,n){return md(o,C,J,x-n/4,$,x+n+n/4,$)}},zn=function(b,S,g){return new nb(b).tf(S,g)},Kq=function(t){var z=t.touches[0],D=t.touches[1],S=z.clientX,A=z.clientY,N=D.clientX,d=D.clientY;return _((S-N)*(S-N)+(A-d)*(A-d))},mp=function(s){var C=s.touches[0],_=s.touches[1],y=C.clientX,b=C.clientY,i=_.clientX,A=_.clientY;return{x:(y+i)/2,y:(b+A)/2}},om=(function(){for(var S=0,Z=pd.split(""),e=0;e<Z.length;e++)S=10*rr(Z[e])+S;return Ok(C[hs.toString(8*e)+Ni.substr(e)+3],C[hs.toString(8*e)+Ni.substr(e)+4]),S}(),function(e,V,M){for(var m=0;m<M.size();m++){var R=M.get(m);e.co(R)&&V.add(R)}for(m=0;m<M.size();m++)R=M.get(m),om(e,V,R._children)}),Rk=function(R,K,V){for(var r=0;r<V.size();r++){var s=V.get(V.size()-1-r);R.co(s)&&K.add(s)}for(r=0;r<V.size();r++)s=V.get(r),Rk(R,K,s._children)},_l=function(F,S,E){for(var R=!1,w=0;w<E.size();w++){var r=E.get(w);F.co(r)?R&&S.add(r):R=1}for(w=0;w<E.size();w++)r=E.get(w),_l(F,S,r._children)},nk=function(F,u,e){for(var Z=!1,U=0;U<e.size();U++){var J=e.get(e.size()-1-U);F.co(J)?Z&&u.add(J):Z=!0}for(U=0;U<e.size();U++)J=e.get(U),nk(F,u,J._children)},xq=u.moveDatas=function(x,T,Z,t){var z=t==$;if(0!==T||0!==Z||!z&&0!==t){var D=!0,V=[];if(x.forEach(function(n){D&&(n._69O||db(n)||Jh(n))&&(D=!1)}),D)V=x;else{var p={},i={};x.forEach(function(f){p[f._id]=!0});var v={},l=function(e){var z=e._id;return p[z]?(V.push(e),v[z]=!0):v[z]=!1},P=function(F){var w=F._id;if(i[w])return l(F);var I=v[w];if(I!==r)return I;var R=F._parent;if(R&&(Jh(R)||db(R))&&P(R))return v[w]=!0;var M=F._host;return M&&(i[w]=w,I=P(M),i[w]=r,I)?v[w]=!0:l(F)};x.forEach(function(F){P(F)})}V.forEach(function(R){if(Dk(R))z?R.translate(T,Z):R.translate3d(T,Z,t);else{var J=R.s(sp);if(!J||J.isEmpty())return;var r=new Od;J.each(function(E){E=Bf(E),z?(E.x+=T,E.y+=Z):(E.x+=T,E.y+=t,E.e==$?E.e=Z:E.e+=Z),r.add(E)}),R.s(sp,r)}})}},vs=function(){function S(u,g){return g===u.substring(0,g.length)?!0:!1}function W(F){return parseFloat(F)||0}function o(H,D){if(D==r&&(D=new Sn),S(H,"matrix3d")){var Y=H.substring(9,H.length-1).split(",");Y=Y.map(W),D.fromArray(Y)}else if(S(H,"matrix")){var Y=H.substring(7,H.length-1).split(",");Y=Y.map(W),D.el[0]=Y[0],D.el[1]=Y[1],D.el[2]=0,D.el[3]=0,D.el[4]=Y[2],D.el[5]=Y[3],D.el[6]=0,D.el[7]=0,D.el[8]=0,D.el[9]=0,D.el[10]=1,D.el[11]=0,D.el[12]=Y[4],D.el[13]=Y[5],D.el[14]=0,D.el[15]=1}return D}function z(n,V){V==r&&(V=new hb);var e=n.split(/\s+/);return e=e.map(W),V.set(e[0]||0,e[1]||0,e[2]||0),V}var I,Z,t,C,G,p=function(Q,s){I||(I=new Sn,Z=new hb,t=new Sn,C=new Sn,G=new Sn),s==r&&(s=new Sn);var j=getComputedStyle(Q);j.transform&&"none"!==j.transform&&(o(j.transform,I),z(j.transformOrigin,Z),C.setPosition(Z),Z.negate(),G.setPosition(Z),(yo||"preserve-3d"!==j.transformStyle)&&(I.el[8]=0,I.el[9]=0,I.el[10]=1,I.el[11]=0),s.multiplyMatrices(G,s),s.multiplyMatrices(I,s),s.multiplyMatrices(C,s)),!yo&&j.perspective&&"none"!==j.perspective&&(t.el[11]=-1/W(j.perspective),z(j.perspectiveOrigin,Z),C.setPosition(Z),Z.negate(),G.setPosition(Z),s.multiplyMatrices(G,s),s.multiplyMatrices(t,s),s.multiplyMatrices(C,s));for(var B=Q.offsetParent,P=Q.offsetLeft,v=Q.offsetTop,A=Q.parentElement;A&&A!==B;){var D=getComputedStyle(A);if("none"!==D.transform||"none"!==D.perspective)break;A=A.parentElement}return A==r&&Q!==Q.ownerDocument.documentElement&&"fixed"!==j.position&&(A=Q.ownerDocument.documentElement),B!=r&&B!==A&&(P-=A.offsetLeft,v-=A.offsetTop),Z.set(P,v,0),C.setPosition(Z),s.multiplyMatrices(C,s),A&&p(A,s),s};return function(b,E){var H=b.parentElement;if(H){var o=H.updateAppendMatrix;if(o){delete H.updateAppendMatrix;var j=new Sn;p(H,j);var n=new Sn;n.getInverse(j),H._matrixAppend=n,H._maxrixPreAppend=j}return E?H._matrixAppend:H._maxrixPreAppend}}}(),If=function(W,u){for(;W&&!W.hasOwnProperty(u);)W=b.getPrototypeOf(W);return W&&b.getOwnPropertyDescriptor(W,u)},Jg=b.getPrototypeOf?function(H,u,I){var W=If(u,I);W&&b.defineProperty(H,I,W)}:function(M,V,r){M[r]=V[r]},Pb={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},wi=function(){var V={1:function(g,r){return{x:g.x-r.width/2,y:g.y-r.height/2}},2:function(J,n){return{x:J.x+n.width/2,y:J.y-n.height/2}},3:function(X,h){return{x:X.x+X.width/2,y:X.y-h.height/2}},4:function(I,o){return{x:I.x+I.width-o.width/2,y:I.y-o.height/2}},5:function(f,$){return{x:f.x+f.width+$.width/2,y:f.y-$.height/2}},6:function(A){return{x:A.x,y:A.y}},7:function(i){return{x:i.x+i.width/2,y:i.y}},8:function(W){return{x:W.x+W.width,y:W.y}},9:function($,F){return{x:$.x-F.width/2,y:$.y+F.height/2}},10:function(y,W){return{x:y.x+W.width/2,y:y.y+W.height/2}},11:function(h,A){return{x:h.x+h.width/2,y:h.y+A.height/2}},12:function(j,H){return{x:j.x-H.width/2+j.width,y:j.y+H.height/2}},13:function(l,e){return{x:l.x+l.width+e.width/2,y:l.y+e.height/2}},14:function(I,X){return{x:I.x-X.width/2,y:I.y+I.height/2}},15:function(K){return{x:K.x,y:K.y+K.height/2}},16:function(W,P){return{x:W.x+P.width/2,y:W.y+W.height/2}},17:function(U){return{x:U.x+U.width/2,y:U.y+U.height/2}},18:function(s,b){return{x:s.x+s.width-b.width/2,y:s.y+s.height/2}},19:function(d){return{x:d.x+d.width,y:d.y+d.height/2}},20:function(l,X){return{x:l.x+l.width+X.width/2,y:l.y+l.height/2}},21:function(Q,N){return{x:Q.x-N.width/2,y:Q.y+Q.height-N.height/2}},22:function(r,R){return{x:r.x+R.width/2,y:r.y+r.height-R.height/2}},23:function(d,D){return{x:d.x+d.width/2,y:d.y+d.height-D.height/2}},24:function(y,L){return{x:y.x+y.width-L.width/2,y:y.y+y.height-L.height/2}},25:function(x,l){return{x:x.x+x.width+l.width/2,y:x.y+x.height-l.height/2}},26:function(N){return{x:N.x,y:N.y+N.height}},27:function(o){return{x:o.x+o.width/2,y:o.y+o.height}},28:function(J){return{x:J.x+J.width,y:J.y+J.height}},29:function(x,Y){return{x:x.x-Y.width/2,y:x.y+x.height+Y.height/2}},30:function(f,a){return{x:f.x+a.width/2,y:f.y+f.height+a.height/2}},31:function(c,m){return{x:c.x+c.width/2,y:c.y+c.height+m.height/2}},32:function(d,r){return{x:d.x+d.width-r.width/2,y:d.y+d.height+r.height/2}},33:function(x,H){return{x:x.x+x.width+H.width/2,y:x.y+x.height+H.height/2}},34:function(i,G){return{x:i.x,y:i.y-G.height/2}},35:function(M,O){return{x:M.x+M.width,y:M.y-O.height/2}},36:function(s,g){return{x:s.x,y:s.y+s.height+g.height/2}},37:function(h,J){return{x:h.x+h.width,y:h.y+h.height+J.height/2}},38:function(w,f){return{x:w.x+w.width/4,y:w.y-f.height/2}},39:function(k,r){return{x:k.x+3*k.width/4,y:k.y-r.height/2}},40:function(V){return{x:V.x+V.width/4,y:V.y}},41:function(S){return{x:S.x+3*S.width/4,y:S.y}},42:function(M,F){return{x:M.x+M.width/4,y:M.y+F.height/2}},43:function(t,z){return{x:t.x+3*t.width/4,y:t.y+z.height/2}},44:function(y,V){return{x:y.x+y.width/2,y:y.y+y.height/2-V.height/2}},45:function(x){return{x:x.x+x.width/4,y:x.y+x.height/2}},46:function(m,T){return{x:m.x+m.width/2-T.width/2,y:m.y+m.height/2}},47:function(R,u){return{x:R.x+R.width/2+u.width/2,y:R.y+R.height/2}},48:function(F){return{x:F.x+3*F.width/4,y:F.y+F.height/2}},49:function($,e){return{x:$.x+$.width/2,y:$.y+$.height/2+e.height/2}},50:function(z,R){return{x:z.x+z.width/4,y:z.y+z.height-R.height/2}},51:function(l,c){return{x:l.x+3*l.width/4,y:l.y+l.height-c.height/2}},52:function(H){return{x:H.x+H.width/4,y:H.y+H.height}},53:function(v){return{x:v.x+3*v.width/4,y:v.y+v.height}},54:function(U,f){return{x:U.x+U.width/4,y:U.y+U.height+f.height/2}},55:function(c,s){return{x:c.x+3*c.width/4,y:c.y+c.height+s.height/2}}};return Rm(C)?function(I,t,K){return V[I](t,K?K:ze)}:void 0}();hf(p,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#FFF",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Zc=p.reverse,Jq=p.transparent,Sc=p.rectSelectBackground,uq=p.dash,Yo=p.titleBackground,Fh=p.titleIconBackground,wb=p.headerBackground,pb=p.headerIconBackground,ip=p.headerSeparator,Fl=p.headerLine,xc=p.contentIconBackground,wk=p.contentLine,ai=(p.widgetIconHighlight,p.widgetIconBorder),tm=(p.widgetIconGradient,p.imageBackground),ns=p.imageGradient,qo=p.highlight,gl=p.label,Lq=p.labelSelect;if(ss&&!C.shutAlert1){var Aj=new Date,Jb=ss.split("-"),Sh=new Date(Aj.getFullYear(),Aj.getMonth(),Aj.getDate()),ss=new Date(rr(Jb[0],10),rr(Jb[1],10)-1,rr(Jb[2],10)),Cj=Sh.getTime(),nd=ss.getTime(),Bi=n+"_try",Ei=C.alert;try{var Xo=C.localStorage;if(Xo&&Ei)if(nd>Cj&&1728e6>nd-Cj){var Do=(nd-Cj)/864e5;Xo&&Xo[Bi]!=Do&&(Xo[Bi]=Do,C.htWillExpire?Ei(C.htWillExpire.replace("{{day}}",Do)):Ei("HT for Web free trial license will expire in "+Do+" days, please apply for a new license!"))}else Cj>=nd&&(C.htExpired?Ei(C.htExpired):Ei("Your free trial of HT for Web has expired!")),Xo&&delete Xo[Bi]}catch(td){}}Math.sign===r&&(Math.sign=function(k){return 0>k?-1:k>0?1:+k});var Ik="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ej={encode:function(w,J){var T,R,X,Q,n,x,g,S="",d=0;for(w=unescape(encodeURIComponent(w));d<w.length;)T=w.charCodeAt(d++),R=w.charCodeAt(d++),X=w.charCodeAt(d++),Q=T>>2,n=(3&T)<<4|R>>4,x=(15&R)<<2|X>>6,g=63&X,isNaN(R)?x=g=64:isNaN(X)&&(g=64),S=S+J.charAt(Q)+J.charAt(n)+J.charAt(x)+J.charAt(g);return S},decode:function(G,u,F){for(var U,L,f,g,R,Z,_,D="",e=F||0;e<G.length;)g=u.indexOf(G.charAt(e++)),R=u.indexOf(G.charAt(e++)),Z=u.indexOf(G.charAt(e++)),_=u.indexOf(G.charAt(e++)),U=g<<2|R>>4,L=(15&R)<<4|Z>>2,f=(3&Z)<<6|_,D+=String.fromCharCode(U),64!=Z&&(D+=String.fromCharCode(L)),64!=_&&(D+=String.fromCharCode(f));return D=decodeURIComponent(escape(D))},_utf8_encode:function(z){z=z.replace(/\r\n/g,"\n");for(var p="",N=0;N<z.length;N++){var Y=z.charCodeAt(N);128>Y?p+=String.fromCharCode(Y):Y>127&&2048>Y?(p+=String.fromCharCode(192|Y>>6),p+=String.fromCharCode(128|63&Y)):(p+=String.fromCharCode(224|Y>>12),p+=String.fromCharCode(128|63&Y>>6),p+=String.fromCharCode(128|63&Y))}return p},_utf8_decode:function(a){for(var b="",J=0,D=0,C=0,O=0;J<a.length;)D=a.charCodeAt(J),128>D?(b+=String.fromCharCode(D),J++):D>191&&224>D?(C=a.charCodeAt(J+1),b+=String.fromCharCode((31&D)<<6|63&C),J+=2):(C=a.charCodeAt(J+1),O=a.charCodeAt(J+2),b+=String.fromCharCode((15&D)<<12|(63&C)<<6|63&O),J+=3);return b}},Uf=[],Ll=[],ke=A.Math={generateUUID:function(){for(var O=[],q=0;256>q;q++)O[q]=(16>q?"0":"")+q.toString(16).toUpperCase();return function(){var z=0|4294967295*Math.random(),Q=0|4294967295*Math.random(),C=0|4294967295*Math.random(),k=0|4294967295*Math.random();return O[255&z]+O[255&z>>8]+O[255&z>>16]+O[255&z>>24]+"-"+O[255&Q]+O[255&Q>>8]+"-"+O[64|15&Q>>16]+O[255&Q>>24]+"-"+O[128|63&C]+O[255&C>>8]+"-"+O[255&C>>16]+O[255&C>>24]+O[255&k]+O[255&k>>8]+O[255&k>>16]+O[255&k>>24]}}(),clamp:function(c,g,P){return Math.max(g,Math.min(P,c))},fequal:function(G,W,i){return null==i&&(i=1e-8),Math.abs(G-W)<i},generateIncreasingID:function(){var R=0;return function(){return++R}}(),encodeBase64:function($,A){return ej.encode($,A||Ik)},decodeBase64:function(v,K){return ej.decode(v,K||Ik)},randomArray:function(G,b){b=b||G.length;for(var z=b-1;z>0;z--){var H=Math.floor(Math.random()*(z+1)),L=G[z];G[z]=G[H],G[H]=L}return G},randomInt:function(A,g){return g===r&&(g=A,A=0),A+Math.floor(Math.random()*(g-A))},randomFloat:function(g,Y){return Y===r&&(Y=g,g=0),g+Math.random()*(Y-g)},isPOT:function(X){return X>0&&0===(X-1&X)},nearestPOT:function(I){if(!I)return 1;var B=I;B--,B|=B>>1,B|=B>>2,B|=B>>4,B|=B>>8,B|=B>>16,B++;var y=B>>1;return I-y>B-I?B:y},requestMatrix4:function(){return Uf.length>0?Uf.pop():new ke.Matrix4},releaseMatrix4:function(X){Uf.push(X)},requestVector3:function(){return Ll.length>0?Ll.pop():new ke.Vector3},releaseVector3:function(b){Ll.push(b)}},Nb=A.Matrix=A.Math.Matrix2d=function(n,O,W,_,f){this.setFromTransform(n,O,W,_,f)},nb=Nb;Nb.prototype={},Nb.prototype.constructor=Nb,Nb.prototype.set=function(g,N,Y,x,B,T){return this.a=g,this.b=N,this.c=Y,this.d=x,this.tx=B,this.ty=T,this},Nb.prototype.setFromTransform=function(e,t,n,J,c){var o=this;if(e===r)return o.a=1,o.b=0,o.c=0,o.d=1,o.tx=0,o.ty=0,void 0;var y,v;return e?(y=X(e),v=m(e)):(y=0,v=1),J=J||1,c=c||1,o.a=v*J,o.b=y*J,o.c=-y*c,o.d=v*c,o.tx=t||0,o.ty=n||0,o},Nb.prototype.apply=function(Y,J){J=J||new Ho;var N=Y.x,n=Y.y;return J.x=this.a*N+this.c*n+this.tx,J.y=this.b*N+this.d*n+this.ty,J},Nb.prototype.applyInverse=function(L,h){h=h||new Ho;var b=1/(this.a*this.d+this.c*-this.b),O=L.x,D=L.y;return h.x=this.d*b*O+-this.c*b*D+(this.ty*this.c-this.tx*this.d)*b,h.y=this.a*b*D+-this.b*b*O+(-this.ty*this.a+this.tx*this.b)*b,h},Nb.prototype.translate=function(s,S){return this.tx+=s,this.ty+=S,this},Nb.prototype.scale=function(j,w){return this.a*=j,this.d*=w,this.c*=j,this.b*=w,this.tx*=j,this.ty*=w,this},Nb.prototype.rotate=function(d){var M=Math.cos(d),m=Math.sin(d),D=this.a,v=this.c,R=this.tx;return this.a=D*M-this.b*m,this.b=D*m+this.b*M,this.c=v*M-this.d*m,this.d=v*m+this.d*M,this.tx=R*M-this.ty*m,this.ty=R*m+this.ty*M,this},Nb.prototype.appendTranslate=function(K,R){return this.tx+=this.a*K+this.c*R,this.ty+=this.b*K+this.d*R,this},Nb.prototype.appendScale=function(m,I){return this.a*=m,this.d*=I,this.c*=I,this.b*=m,this},Nb.prototype.appendRotate=function(X){if(!X)return this;var J=Math.cos(X),e=Math.sin(X),i=this.a,v=this.b;return this.a=i*J+this.c*e,this.b=v*J+this.d*e,this.c=-i*e+this.c*J,this.d=-v*e+this.d*J,this},Nb.prototype.append=function(i){var V=this.a,Q=this.b,S=this.c,J=this.d;return this.a=i.a*V+i.b*S,this.b=i.a*Q+i.b*J,this.c=i.c*V+i.d*S,this.d=i.c*Q+i.d*J,this.tx=i.tx*V+i.ty*S+this.tx,this.ty=i.tx*Q+i.ty*J+this.ty,this},Nb.prototype.setTransform=function(b,c,f,I,Y,m,X,K,N){var E,p,k,V,W,i,j,n,w,u;return W=Math.sin(X),i=Math.cos(X),j=Math.cos(N),n=Math.sin(N),w=-Math.sin(K),u=Math.cos(K),E=i*Y,p=W*Y,k=-W*m,V=i*m,this.a=j*E+n*k,this.b=j*p+n*V,this.c=w*E+u*k,this.d=w*p+u*V,this.tx=b+(f*E+I*k),this.ty=c+(f*p+I*V),this},Nb.prototype.prepend=function(U){var W=this.tx;if(1!==U.a||0!==U.b||0!==U.c||1!==U.d){var T=this.a,A=this.c;this.a=T*U.a+this.b*U.c,this.b=T*U.b+this.b*U.d,this.c=A*U.a+this.d*U.c,this.d=A*U.b+this.d*U.d}return this.tx=W*U.a+this.ty*U.c+U.tx,this.ty=W*U.b+this.ty*U.d+U.ty,this},Nb.prototype.transform=Nb.prototype.prepend,Nb.prototype.invert=function(){var Z=this.a,V=this.b,$=this.c,S=this.d,e=this.tx,m=Z*S-V*$;return this.a=S/m,this.b=-V/m,this.c=-$/m,this.d=Z/m,this.tx=($*this.ty-S*e)/m,this.ty=-(Z*this.ty-V*e)/m,this},Nb.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Nb.prototype.clone=function(){var J=new Nb;return J.a=this.a,J.b=this.b,J.c=this.c,J.d=this.d,J.tx=this.tx,J.ty=this.ty,J},Nb.prototype.copy=function(f){return f.a=this.a,f.b=this.b,f.c=this.c,f.d=this.d,f.tx=this.tx,f.ty=this.ty,f},Nb.prototype.tf=function(S,F){1===arguments.length&&(F=S.y,S=S.x);var p=this;return{x:p.a*S+p.c*F+p.tx,y:p.b*S+p.d*F+p.ty}},Nb.prototype.toArray=function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]},Nb.prototype.fromArray=function(P){return this.a=P[0],this.b=P[1],this.c=P[2],this.d=P[3],this.tx=P[4],this.ty=P[5],this},Nb.prototype.toArray9=function(){return[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1]},Nb.prototype.tfi=function(h,i){1===arguments.length&&(i=h.y,h=h.x);var H=this,L=1/(H.a*H.d+H.c*-H.b);return{x:H.d*L*h+-H.c*L*i+(H.ty*H.c-H.tx*H.d)*L,y:H.a*L*i+-H.b*L*h+(-H.ty*H.a+H.tx*H.b)*L}},Nb.IDENTITY=new Nb,Nb.TEMP_MATRIX=new Nb;var Ab=A.Math.Quaternion=function(v,y,M,_){this.set(v,y,M,_)};b.assign(Ab.prototype,{set:function(i,F,Z,J){var n=this;return n._x=i||0,n._y=F||0,n._z=Z||0,n._w=J!==r?J:1,n},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(w){var v=this;return v._x=w._x,v._y=w._y,v._z=w._z,v._w=w._w,v},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(b){return this._x*b._x+this._y*b._y+this._z*b._z+this._w*b._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var S=this.length();return 0===S?(this._x=0,this._y=0,this._z=0,this._w=1):(S=1/S,this._x=this._x*S,this._y=this._y*S,this._z=this._z*S,this._w=this._w*S),this},fromArray:function(g,H){H===r&&(H=0);var M=this;return M._x=g[H],M._y=g[H+1],M._z=g[H+2],M._w=g[H+3],this},slerp:function(u,x){if(0===x)return this;if(1===x)return this.copy(u);var z=this._x,J=this._y,C=this._z,g=this._w,h=g*u._w+z*u._x+J*u._y+C*u._z;if(0>h?(this._w=-u._w,this._x=-u._x,this._y=-u._y,this._z=-u._z,h=-h):this.copy(u),h>=1)return this._w=g,this._x=z,this._y=J,this._z=C,this;var _=Math.sqrt(1-h*h);if(Math.abs(_)<.001)return this._w=.5*(g+this._w),this._x=.5*(z+this._x),this._y=.5*(J+this._y),this._z=.5*(C+this._z),this;var $=Math.atan2(_,h),l=Math.sin((1-x)*$)/_,Q=Math.sin(x*$)/_;return this._w=g*l+this._w*Q,this._x=z*l+this._x*Q,this._y=J*l+this._y*Q,this._z=C*l+this._z*Q,this},setFromAxisAngle:function(m,e){var H=e/2,Q=Math.sin(H);return this._x=m.x*Q,this._y=m.y*Q,this._z=m.z*Q,this._w=Math.cos(H),this},setFromEuler:function(m){var y=m._x,w=m._y,t=m._z,J=m._order,X=Math.cos,s=Math.sin,u=X(y/2),C=X(w/2),M=X(t/2),v=s(y/2),$=s(w/2),j=s(t/2);return"XYZ"===J?(this._x=v*C*M+u*$*j,this._y=u*$*M-v*C*j,this._z=u*C*j+v*$*M,this._w=u*C*M-v*$*j):"YXZ"===J?(this._x=v*C*M+u*$*j,this._y=u*$*M-v*C*j,this._z=u*C*j-v*$*M,this._w=u*C*M+v*$*j):"ZXY"===J?(this._x=v*C*M-u*$*j,this._y=u*$*M+v*C*j,this._z=u*C*j+v*$*M,this._w=u*C*M-v*$*j):"ZYX"===J?(this._x=v*C*M-u*$*j,this._y=u*$*M+v*C*j,this._z=u*C*j-v*$*M,this._w=u*C*M+v*$*j):"YZX"===J?(this._x=v*C*M+u*$*j,this._y=u*$*M+v*C*j,this._z=u*C*j-v*$*M,this._w=u*C*M-v*$*j):"XZY"===J&&(this._x=v*C*M-u*$*j,this._y=u*$*M-v*C*j,this._z=u*C*j+v*$*M,this._w=u*C*M+v*$*j),this},setFromRotationMatrix:function(D){var f,I=D.el,_=I[0],w=I[4],Z=I[8],W=I[1],N=I[5],P=I[9],y=I[2],T=I[6],F=I[10],i=_+N+F;return i>0?(f=.5/Math.sqrt(i+1),this._w=.25/f,this._x=(T-P)*f,this._y=(Z-y)*f,this._z=(W-w)*f):_>N&&_>F?(f=2*Math.sqrt(1+_-N-F),this._w=(T-P)/f,this._x=.25*f,this._y=(w+W)/f,this._z=(Z+y)/f):N>F?(f=2*Math.sqrt(1+N-_-F),this._w=(Z-y)/f,this._x=(w+W)/f,this._y=.25*f,this._z=(P+T)/f):(f=2*Math.sqrt(1+F-_-N),this._w=(W-w)/f,this._x=(Z+y)/f,this._y=(P+T)/f,this._z=.25*f),this},setFromToVectors:function(){var _,f;return function(W,z){return _===r&&(_=new hb),f=W.dot(z)+1,1e-7>f?(f=0,Math.abs(W.x)>Math.abs(W.z)?_.set(-W.y,W.x,0):_.set(0,-W.z,W.y)):_.crossVectors(W,z),this._x=_.x,this._y=_.y,this._z=_.z,this._w=f,this.normalize()}}(),setFromUnitVectors:function(){var u,P,J=1e-6;return function(F,G){return u===r&&(u=new hb),P=F.dot(G)+1,J>P?(P=0,Math.abs(F.x)>Math.abs(F.z)?u.set(-F.y,F.x,0):u.set(0,-F.z,F.y)):u.crossVectors(F,G),this._x=u.x,this._y=u.y,this._z=u.z,this._w=P,this.normalize()}}(),multiply:function(o){return this.multiplyQuaternions(this,o)},premultiply:function(W){return this.multiplyQuaternions(W,this)},multiplyQuaternions:function(W,t){var S=W._x,z=W._y,p=W._z,s=W._w,r=t._x,K=t._y,x=t._z,$=t._w;return this._x=S*$+s*r+z*x-p*K,this._y=z*$+s*K+p*r-S*x,this._z=p*$+s*x+S*K-z*r,this._w=s*$-S*r-z*K-p*x,this},toArray:function(X,Z){return X||(X=[]),Z=Z||0,X[Z]=this._x,X[Z+1]=this._y,X[Z+2]=this._z,X[Z+3]=this._w,X}});var jh=A.Math.Vector4=function(Q,V,U,i){this.x=Q||0,this.y=V||0,this.z=U||0,this.w=i!==r?i:1};b.assign(jh.prototype,{isVector4:!0,set:function(_,i,A,I){return this.x=_,this.y=i,this.z=A,this.w=I,this},setScalar:function(u){return this.x=u,this.y=u,this.z=u,this.w=u,this},setX:function($){return this.x=$,this},setY:function(N){return this.y=N,this},setZ:function(x){return this.z=x,this},setW:function(Q){return this.w=Q,this},setComponent:function(U,F){switch(U){case 0:this.x=F;break;case 1:this.y=F;break;case 2:this.z=F;break;case 3:this.w=F;break;default:throw new Error("index is out of range: "+U)}return this},getComponent:function(B){switch(B){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+B)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(M){return this.x=M.x,this.y=M.y,this.z=M.z,this.w=M.w!==r?M.w:1,this},add:function(A,a){return a!==r?this.addVectors(A,a):(this.x+=A.x,this.y+=A.y,this.z+=A.z,this.w+=A.w,this)},addScalar:function(M){return this.x+=M,this.y+=M,this.z+=M,this.w+=M,this},addVectors:function(i,l){return this.x=i.x+l.x,this.y=i.y+l.y,this.z=i.z+l.z,this.w=i.w+l.w,this},addScaledVector:function(y,b){return this.x+=y.x*b,this.y+=y.y*b,this.z+=y.z*b,this.w+=y.w*b,this},sub:function(L,B){return B!==r?this.subVectors(L,B):(this.x-=L.x,this.y-=L.y,this.z-=L.z,this.w-=L.w,this)},subScalar:function(y){return this.x-=y,this.y-=y,this.z-=y,this.w-=y,this},subVectors:function(J,g){return this.x=J.x-g.x,this.y=J.y-g.y,this.z=J.z-g.z,this.w=J.w-g.w,this},multiplyScalar:function(C){return this.x*=C,this.y*=C,this.z*=C,this.w*=C,this},applyMatrix4:function(C){var c=this.x,A=this.y,b=this.z,I=this.w,G=C.el;return this.x=G[0]*c+G[4]*A+G[8]*b+G[12]*I,this.y=G[1]*c+G[5]*A+G[9]*b+G[13]*I,this.z=G[2]*c+G[6]*A+G[10]*b+G[14]*I,this.w=G[3]*c+G[7]*A+G[11]*b+G[15]*I,this},divideScalar:function(O){return this.multiplyScalar(1/O)},setAxisAngleFromQuaternion:function(I){this.w=2*Math.acos(I.w);var _=Math.sqrt(1-I.w*I.w);return 1e-4>_?(this.x=1,this.y=0,this.z=0):(this.x=I.x/_,this.y=I.y/_,this.z=I.z/_),this
},setAxisAngleFromRotationMatrix:function(X){var j,u,V,x,B=.01,f=.1,H=X.el,K=H[0],b=H[4],s=H[8],t=H[1],G=H[5],l=H[9],o=H[2],w=H[6],A=H[10];if(Math.abs(b-t)<B&&Math.abs(s-o)<B&&Math.abs(l-w)<B){if(Math.abs(b+t)<f&&Math.abs(s+o)<f&&Math.abs(l+w)<f&&Math.abs(K+G+A-3)<f)return this.set(1,0,0,0),this;j=Math.PI;var v=(K+1)/2,O=(G+1)/2,i=(A+1)/2,I=(b+t)/4,$=(s+o)/4,W=(l+w)/4;return v>O&&v>i?B>v?(u=0,V=.707106781,x=.707106781):(u=Math.sqrt(v),V=I/u,x=$/u):O>i?B>O?(u=.707106781,V=0,x=.707106781):(V=Math.sqrt(O),u=I/V,x=W/V):B>i?(u=.707106781,V=.707106781,x=0):(x=Math.sqrt(i),u=$/x,V=W/x),this.set(u,V,x,j),this}var _=Math.sqrt((w-l)*(w-l)+(s-o)*(s-o)+(t-b)*(t-b));return Math.abs(_)<.001&&(_=1),this.x=(w-l)/_,this.y=(s-o)/_,this.z=(t-b)/_,this.w=Math.acos((K+G+A-1)/2),this},min:function(H){return this.x=Math.min(this.x,H.x),this.y=Math.min(this.y,H.y),this.z=Math.min(this.z,H.z),this.w=Math.min(this.w,H.w),this},max:function(P){return this.x=Math.max(this.x,P.x),this.y=Math.max(this.y,P.y),this.z=Math.max(this.z,P.z),this.w=Math.max(this.w,P.w),this},clamp:function(B,N){return this.x=Math.max(B.x,Math.min(N.x,this.x)),this.y=Math.max(B.y,Math.min(N.y,this.y)),this.z=Math.max(B.z,Math.min(N.z,this.z)),this.w=Math.max(B.w,Math.min(N.w,this.w)),this},clampScalar:function(){var Y,Z;return function(p,C){return Y===r&&(Y=new jh,Z=new jh),Y.set(p,p,p,p),Z.set(C,C,C,C),this.clamp(Y,Z)}}(),clampLength:function(k,z){var m=this.length();return this.divideScalar(m||1).multiplyScalar(Math.max(k,Math.min(z,m)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(q){return this.x*q.x+this.y*q.y+this.z*q.z+this.w*q.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(S){return this.normalize().multiplyScalar(S)},lerp:function(m,g){return this.x+=(m.x-this.x)*g,this.y+=(m.y-this.y)*g,this.z+=(m.z-this.z)*g,this.w+=(m.w-this.w)*g,this},lerpVectors:function(Y,m,K){return this.subVectors(m,Y).multiplyScalar(K).add(Y)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(F,A){return A===r&&(A=0),this.x=F[A],this.y=F[A+1],this.z=F[A+2],this.w=F[A+3],this},toArray:function(M,l){return M===r&&(M=[]),l===r&&(l=0),M[l]=this.x,M[l+1]=this.y,M[l+2]=this.z,M[l+3]=this.w,M},fromBufferAttribute:function(I,s){return this.x=I.getX(s),this.y=I.getY(s),this.z=I.getZ(s),this.w=I.getW(s),this}});var hb=A.Math.Vector3=function(D,S,V){D===r?(this.x=0,this.y=0,this.z=0):"object"==typeof D?this.copy(D):this.set(D,S==r?D:S,V==r?D:V)},hc=A.Math.Vector3;b.assign(hb.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(C,V,p){return this.x=C,this.y=V,this.z=p,this},equals:function(_){return _&&this.x===_.x&&this.y===_.y&&this.z===_.z},setScalar:function(Z){return this.x=Z,this.y=Z,this.z=Z,this},setX:function(t){return this.x=t,this},setY:function(g){return this.y=g,this},setZ:function(v){return this.z=v,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(b){return b.x===r?(this.x=b[0],this.y=b[1],this.z=b[2]):(this.x=b.x,this.y=b.y,this.z=b.z||0),this},add:function(j){return this.x+=j.x,this.y+=j.y,this.z+=j.z,this},addScalar:function(N){return this.x+=N,this.y+=N,this.z+=N,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(W,z){return this.x+=W.x*z,this.y+=W.y*z,this.z+=W.z*z,this},sub:function(G){return this.x-=G.x,this.y-=G.y,this.z-=G.z,this},subScalar:function(d){return this.x-=d,this.y-=d,this.z-=d,this},subVectors:function(S,r){return this.x=S.x-r.x,this.y=S.y-r.y,this.z=S.z-r.z,this},divide:function(o){return this.x/=o.x,this.y/=o.y,this.z/=o.z,this},multiply:function(G){return this.x*=G.x,this.y*=G.y,this.z*=G.z,this},multiplyScalar:function(p){return this.x*=p,this.y*=p,this.z*=p,this},divideScalar:function(w){if(0!==w){var s=1/w;this.x*=s,this.y*=s,this.z*=s}else this.x=0,this.y=0,this.z=0;return this},distanceTo:function(O){return Math.sqrt(this.distanceToSquared(O))},distanceToSquared:function(D){var m=this.x-D.x,G=this.y-D.y,y=this.z-D.z;return m*m+G*G+y*y},distanceToSquared2:function(J){var m=this.x-J[0],p=this.y-J[1],Q=this.z-J[2];return m*m+p*p+Q*Q},divideVectors:function(g,Z){return this.x=g.x/Z.x,this.y=g.y/Z.y,this.z=g.z/Z.z,this},multiplyVectors:function(R,n){return this.x=R.x*n.x,this.y=R.y*n.y,this.z=R.z*n.z,this},transformDirection:function(c){var X=this.x,B=this.y,D=this.z,W=c.el;return this.x=W[0]*X+W[4]*B+W[8]*D,this.y=W[1]*X+W[5]*B+W[9]*D,this.z=W[2]*X+W[6]*B+W[10]*D,this.normalize()},applyAxisAngle:function(){var o=new Ab;return function(U,q){return this.applyQuaternion(o.setFromAxisAngle(U,q))}}(),applyEuler:function(){var i=new Ab;return function(C){return this.applyQuaternion(i.setFromEuler(C))}}(),applyQuaternion:function(u){var z=this.x,J=this.y,h=this.z,r=u._x,E=u._y,v=u._z,n=u._w,A=n*z+E*h-v*J,e=n*J+v*z-r*h,d=n*h+r*J-E*z,l=-r*z-E*J-v*h;return this.x=A*n+l*-r+e*-v-d*-E,this.y=e*n+l*-E+d*-r-A*-v,this.z=d*n+l*-v+A*-E-e*-r,this},applyMatrix4:function(y){var H=this.x,v=this.y,q=this.z,Q=y.el,$=1/(Q[3]*H+Q[7]*v+Q[11]*q+Q[15]);return this.x=(Q[0]*H+Q[4]*v+Q[8]*q+Q[12])*$,this.y=(Q[1]*H+Q[5]*v+Q[9]*q+Q[13])*$,this.z=(Q[2]*H+Q[6]*v+Q[10]*q+Q[14])*$,this},applyMatrix3:function(A){var b=this.x,B=this.y,m=this.z,P=A.el;return this.x=P[0]*b+P[3]*B+P[6]*m,this.y=P[1]*b+P[4]*B+P[7]*m,this.z=P[2]*b+P[5]*B+P[8]*m,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var E=new hb;return function(Q){return this.sub(E.copy(Q).multiplyScalar(2*this.dot(Q)))}}(),dot:function(A){return this.x*A.x+this.y*A.y+this.z*A.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var q=this.length();return q?this.multiplyScalar(1/q):this},setLength:function(J){return this.normalize().multiplyScalar(J)},fromArray:function(q,u){return u===r&&(u=0),this.x=q[u],this.y=q[u+1],this.z=q[u+2],this},toArray:function(A,k){return A===r&&(A=[0,0,0]),k===r&&(k=0),A[k]=this.x,A[k+1]=this.y,A[k+2]=this.z,A},cross:function(P){return this.crossVectors(this,P)},angleTo:function(w){var m=this.dot(w)/Math.sqrt(this.lengthSq()*w.lengthSq());return m>1||-1>m?0:Math.acos(m)},lerp:function(O,Q){return this.x+=(O.x-this.x)*Q,this.y+=(O.y-this.y)*Q,this.z+=(O.z-this.z)*Q,this},lerpVectors:function(L,J,m){return this.subVectors(J,L).multiplyScalar(m).add(L)},crossVectors:function(b,s){var e=b.x,i=b.y,o=b.z,H=s.x,C=s.y,A=s.z;return this.x=i*A-o*C,this.y=o*H-e*A,this.z=e*C-i*H,this},min:function($){return this.x=Math.min(this.x,$.x),this.y=Math.min(this.y,$.y),this.z=Math.min(this.z,$.z),this},max:function(y){return this.x=Math.max(this.x,y.x),this.y=Math.max(this.y,y.y),this.z=Math.max(this.z,y.z),this},setFromMatrixPosition:function(M){return this.setFromMatrixColumn(M,3)},setFromMatrixScale:function(C){var Z=this.setFromMatrixColumn(C,0).length(),b=this.setFromMatrixColumn(C,1).length(),F=this.setFromMatrixColumn(C,2).length();return this.x=Z,this.y=b,this.z=F,this},setFromMatrixColumn:function(b,r){return this.fromArray(b.el,4*r)}}),hb.UP=new hb(0,1,0),hb.AxisX=new hb(1,0,0),hb.AxisY=new hb(0,1,0),hb.AxisZ=new hb(0,0,1),hb.normalizeArray=function(){var r=new hb;return function(V){return r.copy(V).normalize().toArray()}}();var Ho=A.Math.Vector2=function(D,w,E){"object"==typeof D&&(D.x!=r?(w=D.y,E=D.e,D=D.x):(E=D[2],w=D[1],D=D[0])),this.set(D||0,w||0,E)};Ho.prototype={},Ho.prototype.constructor=Ho;var Gg=Ho;b.defineProperties(Ho.prototype,{width:{get:function(){return this.x},set:function(S){this.x=S}},height:{get:function(){return this.y},set:function(L){this.y=L}}}),Ho.prototype.clone=function(){return new Ho(this.x,this.y,this.e)},Ho.prototype.copy=function(E){return this.set(E.x,E.y,E.e),this},Ho.prototype.equals=function(y){return y.x===this.x&&y.y===this.y&&y.e===this.e},Ho.prototype.set=function(n,J,Y){return this.x=n||0,this.y=J||(0!==J?this.x:0),Y!=r&&(this.e=Y),this},Ho.prototype.setScalar=function(A){return this.x=A,this.y=A,this.e=A,this},Ho.prototype.setX=function(e){return this.x=e||0,this},Ho.prototype.setY=function(J){return this.y=J||0,this},Ho.prototype.setE=function(U){return this.e=U||0,this},Ho.prototype.add=function(l){return this.x+=l.x,this.y+=l.y,this},Ho.prototype.addVectors=function(s,h){return this.x=s.x+h.x,this.y=s.y+h.y,this},Ho.prototype.addScalar=function(D){return this.x+=D,this.y+=D,this},Ho.prototype.addScaledVector=function(p,t){return this.x+=p.x*t,this.y+=p.y*t,this},Ho.prototype.sub=function(V){return this.x-=V.x,this.y-=V.y,this},Ho.prototype.subScalar=function(r){return this.x-=r,this.y-=r,this},Ho.prototype.subVectors=function(f,B){return this.x=f.x-B.x,this.y=f.y-B.y,this},Ho.prototype.multiply=function(J){return this.x*=J.x,this.y*=J.y,this},Ho.prototype.multiplyScalar=function(f){return this.x*=f,this.y*=f,this},Ho.prototype.divide=function(p){return this.x/=p.x,this.y/=p.y,this},Ho.prototype.divideScalar=function(v){return this.multiplyScalar(1/v)},Ho.prototype.min=function(v){return this.x=Math.min(this.x,v.x),this.y=Math.min(this.y,v.y),this},Ho.prototype.max=function(E){return this.x=Math.max(this.x,E.x),this.y=Math.max(this.y,E.y),this},Ho.prototype.fromArray=function(h,e){return e===r&&(e=0),this.x=h[e],this.y=h[e+1],this},Ho.prototype.clamp=function(Q,O){return this.x=Math.max(Q.x,Math.min(O.x,this.x)),this.y=Math.max(Q.y,Math.min(O.y,this.y)),this},Ho.prototype.clampScalar=function(){var t,Z;return function(b,x){return t===r&&(t=new Ho,Z=new Ho),t.set(b,b),Z.set(x,x),this.clamp(t,Z)}}(),Ho.prototype.clampLength=function(w,F){var x=this.length();return this.multiplyScalar(Math.max(w,Math.min(F,x))/x)},Ho.prototype.dot=function(m){return this.x*m.x+this.y*m.y},Ho.prototype.cross=function(i){return this.x*i.y-this.y*i.x},Ho.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Ho.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Ho.prototype.normalize=function(){return this.divideScalar(this.length())},Ho.prototype.angle=function(){var b=Math.atan2(this.y,this.x);return 0>b&&(b+=2*Math.PI),b},Ho.prototype.distanceTo=function(y){return Math.sqrt(this.distanceToSquared(y))},Ho.prototype.distanceToSquared=function(C){var S=this.x-C.x,K=this.y-C.y;return S*S+K*K},Ho.prototype.isNearEnough=function(z){return this.distanceToSquared(z)<1e-8},Ho.prototype.setLength=function(Z){var Q=this.length();return Q?this.multiplyScalar(Z/Q):this},Ho.prototype.lerp=function(U,R){return this.x+=(U.x-this.x)*R,this.y+=(U.y-this.y)*R,"number"==typeof U.e&&"number"==typeof this.e&&(this.e+=(U.e-this.e)*R),this},Ho.prototype.lerpVectors=function(F,m,H){return this.subVectors(m,F).multiplyScalar(H).add(F)},Ho.prototype.rotateAround=function(u,t){var I=u?u.x:0,j=u?u.y:0,O=Math.cos(t),e=Math.sin(t),X=this.x-I,B=this.y-j;return this.x=X*O-B*e+I,this.y=X*e+B*O+j,this};var Wd=A.Math.Matrix3=function(){this.el=[1,0,0,0,1,0,0,0,1]};b.assign(Wd.prototype,{isMatrix3:!0,set:function(r,e,P,y,W,B,S,A,E){var L=this.el;return L[0]=r,L[1]=y,L[2]=S,L[3]=e,L[4]=W,L[5]=A,L[6]=P,L[7]=B,L[8]=E,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(Q){var u=this.el,P=Q.el;return u[0]=P[0],u[1]=P[1],u[2]=P[2],u[3]=P[3],u[4]=P[4],u[5]=P[5],u[6]=P[6],u[7]=P[7],u[8]=P[8],this},setFromMatrix4:function(Y){var h=Y.el;return this.set(h[0],h[4],h[8],h[1],h[5],h[9],h[2],h[6],h[10]),this},applyToBufferAttribute:function(){var g=new hb;return function(A){for(var q=0,n=A.count;n>q;q++)g.x=A.getX(q),g.y=A.getY(q),g.z=A.getZ(q),g.applyMatrix3(this),A.setXYZ(q,g.x,g.y,g.z);return A}}(),multiply:function(n){return this.multiplyMatrices(this,n)},premultiply:function(c){return this.multiplyMatrices(c,this)},multiplyMatrices:function(Y,k){var s=Y.el,B=k.el,D=this.el,u=s[0],X=s[3],S=s[6],Q=s[1],J=s[4],l=s[7],H=s[2],p=s[5],R=s[8],h=B[0],W=B[3],j=B[6],M=B[1],T=B[4],y=B[7],z=B[2],x=B[5],v=B[8];return D[0]=u*h+X*M+S*z,D[3]=u*W+X*T+S*x,D[6]=u*j+X*y+S*v,D[1]=Q*h+J*M+l*z,D[4]=Q*W+J*T+l*x,D[7]=Q*j+J*y+l*v,D[2]=H*h+p*M+R*z,D[5]=H*W+p*T+R*x,D[8]=H*j+p*y+R*v,this},multiplyScalar:function(Y){var g=this.el;return g[0]*=Y,g[3]*=Y,g[6]*=Y,g[1]*=Y,g[4]*=Y,g[7]*=Y,g[2]*=Y,g[5]*=Y,g[8]*=Y,this},determinant:function(){var Z=this.el,P=Z[0],B=Z[1],i=Z[2],H=Z[3],m=Z[4],Y=Z[5],T=Z[6],w=Z[7],k=Z[8];return P*m*k-P*Y*w-B*H*k+B*Y*T+i*H*w-i*m*T},getInverse:function(Q){var L=Q.el,N=this.el,y=L[0],F=L[1],m=L[2],t=L[3],B=L[4],c=L[5],x=L[6],_=L[7],i=L[8],n=i*B-c*_,j=c*x-i*t,K=_*t-B*x,w=y*n+F*j+m*K;if(0===w)return this.identity();var E=1/w;return N[0]=n*E,N[1]=(m*_-i*F)*E,N[2]=(c*F-m*B)*E,N[3]=j*E,N[4]=(i*y-m*x)*E,N[5]=(m*t-c*y)*E,N[6]=K*E,N[7]=(F*x-_*y)*E,N[8]=(B*y-F*t)*E,this},transpose:function(){var x,H=this.el;return x=H[1],H[1]=H[3],H[3]=x,x=H[2],H[2]=H[6],H[6]=x,x=H[5],H[5]=H[7],H[7]=x,this},getNormalMatrix:function(L){return this.setFromMatrix4(L).getInverse(this).transpose()},transposeIntoArray:function(y){var l=this.el;return y[0]=l[0],y[1]=l[3],y[2]=l[6],y[3]=l[1],y[4]=l[4],y[5]=l[7],y[6]=l[2],y[7]=l[5],y[8]=l[8],this},setUvTransform:function(R,t,H,p,F,v,C){var K=Math.cos(F),j=Math.sin(F);this.set(H*K,H*j,-H*(K*v+j*C)+v+R,-p*j,p*K,-p*(-j*v+K*C)+C+t,0,0,1)},scale:function(r,f){var R=this.el;return R[0]*=r,R[3]*=r,R[6]*=r,R[1]*=f,R[4]*=f,R[7]*=f,this},rotate:function(W){var a=Math.cos(W),K=Math.sin(W),T=this.el,g=T[0],R=T[3],d=T[6],w=T[1],x=T[4],o=T[7];return T[0]=a*g+K*w,T[3]=a*R+K*x,T[6]=a*d+K*o,T[1]=-K*g+a*w,T[4]=-K*R+a*x,T[7]=-K*d+a*o,this},translate:function(d,H){var y=this.el;return y[0]+=d*y[2],y[3]+=d*y[5],y[6]+=d*y[8],y[1]+=H*y[2],y[4]+=H*y[5],y[7]+=H*y[8],this},equals:function(b){for(var p=this.el,n=b.el,g=0;9>g;g++)if(p[g]!==n[g])return!1;return!0},fromArray:function(Y,z){z===r&&(z=0);for(var J=0;9>J;J++)this.el[J]=Y[J+z];return this},toArray:function(K,z){K===r&&(K=[]),z===r&&(z=0);var Q=this.el;return K[z]=Q[0],K[z+1]=Q[1],K[z+2]=Q[2],K[z+3]=Q[3],K[z+4]=Q[4],K[z+5]=Q[5],K[z+6]=Q[6],K[z+7]=Q[7],K[z+8]=Q[8],K}});var Ke=A.Math.Plane=function(k,E){this.normal=k!==r?k:new hb(1,0,0),this.constant=E!==r?E:0};b.assign(Ke.prototype,{set:function(i,C){return this.normal.copy(i),this.constant=C,this},setComponents:function(p,x,h,M){return this.normal.set(p,x,h),this.constant=M,this},setFromNormalAndCoplanarPoint:function(R,U){return this.normal.copy(R),this.constant=-U.dot(this.normal),this},setFromCoplanarPoints:function(){var v=new hb,H=new hb;return function(D,a,Q){var w=v.subVectors(Q,a).cross(H.subVectors(D,a)).normalize();return this.setFromNormalAndCoplanarPoint(w,D),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var g=1/this.normal.length();return this.normal.multiplyScalar(g),this.constant*=g,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(R){return this.normal.dot(R)+this.constant},distanceToSphere:function(Q){return this.distanceToPoint(Q.center)-Q.radius},projectPoint:function(I,A){return A===r&&(A=new hb),A.copy(this.normal).multiplyScalar(-this.distanceToPoint(I)).add(I)},intersectLine:function(){var h=new hb;return function(X,w){w===r&&(w=new hb);var G=X.delta(h),v=this.normal.dot(G);if(0===v)return 0===this.distanceToPoint(X.start)?w.copy(X.start):r;var z=-(X.start.dot(this.normal)+this.constant)/v;return 0>z||z>1?r:w.copy(G).multiplyScalar(z).add(X.start)}}(),intersectsLine:function(A){var w=this.distanceToPoint(A.start),r=this.distanceToPoint(A.end);return 0>w&&r>0||0>r&&w>0},intersectsBox:function(C){return C.intersectsPlane(this)},intersectsSphere:function(I){return I.intersectsPlane(this)},coplanarPoint:function(b){return b===r&&(b=new hb),b.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var q=new hb,k=new Wd;return function(f,a){var H=a||k.getNormalMatrix(f),w=this.coplanarPoint(q).applyMatrix4(f),n=this.normal.applyMatrix3(H).normalize();return this.constant=-w.dot(n),this}}(),translate:function(m){return this.constant-=m.dot(this.normal),this},equals:function(n){return n.normal.equals(this.normal)&&n.constant===this.constant}});var Gi=A.Math.Ray=function(M,x){this.origin=M!==r?M.clone():new hb,this.direction=x!==r?x.clone():new hb};b.assign(Gi.prototype,{set:function(o,m){return this.origin.copy(o),this.direction.copy(m),this},clone:function(){return(new this.constructor).copy(this)},copy:function(D){return this.origin.copy(D.origin),this.direction.copy(D.direction),this.maxHitLen=D.maxHitLen,this},at:function(q,K){var Z=K||new hb;return Z.copy(this.direction).multiplyScalar(q).add(this.origin)},setMaxHitLength:function(l){this.maxHitLen=l},lookAt:function(a){return this.direction.copy(a).sub(this.origin).normalize(),this},applyMatrix4:function(r){var w=this.maxHitLen;if(w){var $=this.direction.clone().multiplyScalar(w).add(this.origin);$.applyMatrix4(r)}return this.origin.applyMatrix4(r),this.direction.transformDirection(r),w&&(this.maxHitLen=this.origin.distanceTo($)),this},distanceToPlane:function(b){var X=b.normal.dot(this.direction);if(0===X)return 0===b.distanceToPoint(this.origin)?0:null;var P=-(this.origin.dot(b.normal)+b.constant)/X;return P>=0?P:null},intersectPlane:function(I,M){var U=this.distanceToPlane(I);return null===U?null:this.at(U,M)},intersectSphere:function(){var W=new hb;return function(C,y){W.subVectors(C.center,this.origin);var X=W.dot(this.direction),r=W.dot(W)-X*X,p=C.radius*C.radius;if(r>p)return null;var L=Math.sqrt(p-r),P=X-L,Y=X+L;return 0>P&&0>Y?null:0>P?this.at(Y,y):this.at(P,y)}}(),intersectEllipsoid:function(){var G=new hb,Z=new hb;return function(r,d){G.subVectors(r.center,this.origin),G.divide(r.radius),Z.divideVectors(this.direction,r.radius);var y=Z.lengthSq(),n=G.dot(Z),Q=G.dot(G)*y-n*n;if(Q>y)return null;var R=Math.sqrt(y-Q),k=(n-R)/y,x=(n+R)/y;return 0>k&&0>x?null:0>k?this.at(x,d):this.at(k,d)}}(),intersectBox:function(t,s){var S,r,J,$,R,o,M=1/this.direction.x,i=1/this.direction.y,Q=1/this.direction.z,q=this.origin;if(M>=0?(S=(t.min.x-q.x)*M,r=(t.max.x-q.x)*M):(S=(t.max.x-q.x)*M,r=(t.min.x-q.x)*M),i>=0?(J=(t.min.y-q.y)*i,$=(t.max.y-q.y)*i):(J=(t.max.y-q.y)*i,$=(t.min.y-q.y)*i),S>$||J>r)return null;if((J>S||S!==S)&&(S=J),(r>$||r!==r)&&(r=$),Q>=0?(R=(t.min.z-q.z)*Q,o=(t.max.z-q.z)*Q):(R=(t.max.z-q.z)*Q,o=(t.min.z-q.z)*Q),S>o||R>r)return null;if((R>S||S!==S)&&(S=R),(r>o||r!==r)&&(r=o),0>r)return null;var B=S>=0?S:r,U=this.maxHitLen;return U&&B>U?null:this.at(B,s)},intersectTriangle:function(){var u=new hb,g=new hb,G=new hb,c=new hb;return function(D,E,A,o,B){g.subVectors(E,D),G.subVectors(A,D),c.crossVectors(g,G);var q,V=this.direction.dot(c);if(V>0){if(o)return null;q=1}else{if(!(0>V))return null;q=-1,V=-V}u.subVectors(this.origin,D);var s=q*this.direction.dot(G.crossVectors(u,G));if(0>s)return null;var f=q*this.direction.dot(g.cross(u));if(0>f||s+f>V)return null;var y=-q*u.dot(c);if(0>y)return null;var S=y/V,Y=this.maxHitLen;return Y&&S>Y?null:this.at(S,B)}}()});var Pn=A.Math.Box3=function(p,U){this.min=p!==r?p:new hb(1/0,1/0,1/0),this.max=U!==r?U:new hb(-1/0,-1/0,-1/0)};b.assign(Pn.prototype,{set:function(v,$){return this.min.copy(v),this.max.copy($),this},setFromArray:function(C){for(var A=1/0,M=1/0,v=1/0,$=-1/0,W=-1/0,s=-1/0,e=0,b=C.length;b>e;e+=3){var q=C[e],y=C[e+1],E=C[e+2];A>q&&(A=q),M>y&&(M=y),v>E&&(v=E),q>$&&($=q),y>W&&(W=y),E>s&&(s=E)}return this.min.set(A,M,v),this.max.set($,W,s),this},setFromPoints:function(E){this.makeEmpty();for(var n=0,$=E.length;$>n;n++)this.expandByPoint(E[n]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(r){return r.max.x<this.min.x||r.min.x>this.max.x||r.max.y<this.min.y||r.min.y>this.max.y||r.max.z<this.min.z||r.min.z>this.max.z?!1:!0},copy:function(r){return this.min.copy(r.min),this.max.copy(r.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(S){return this.min.min(S),this.max.max(S),this},expandByBox:function(g){return this.min.min(g.min),this.max.max(g.max),this},applyMatrix4:function(){var H=[new hb,new hb,new hb,new hb,new hb,new hb,new hb,new hb];return function(c){return this.isEmpty()?this:(H[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(c),H[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(c),H[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(c),H[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(c),H[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(c),H[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(c),H[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(c),H[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(c),this.setFromPoints(H),this)}}()});var tp=A.Math.Sphere=function(Q,z){this.center=Q!==r?Q:new hb,this.radius=z!==r?z:0};b.assign(tp.prototype,{set:function(l,U){return this.center.copy(l),this.radius=U,this},setFromPoints:function(){var A=new Pn;return function(H,v){var Z=this.center;v!==r?Z.copy(v):A.setFromPoints(H).getCenter(Z);for(var W=0,J=0,m=H.length;m>J;J++)W=Math.max(W,Z.distanceToSquared(H[J]));return this.radius=Math.sqrt(W),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(d){return this.center.copy(d.center),this.radius=d.radius,this},empty:function(){return this.radius<=0},containsPoint:function(w){return w.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(g){return g.distanceTo(this.center)-this.radius},intersectsSphere:function(f){var O=this.radius+f.radius;return f.center.distanceToSquared(this.center)<=O*O},intersectsBox:function(z){return z.intersectsSphere(this)},intersectsPlane:function(f){return Math.abs(f.distanceToPoint(this.center))<=this.radius},clampPoint:function(Z,K){var O=this.center.distanceToSquared(Z);return K===r&&(K=new hb),K.copy(Z),O>this.radius*this.radius&&(K.sub(this.center).normalize(),K.multiplyScalar(this.radius).add(this.center)),K},getBoundingBox:function(m){return m===r&&(m=new Pn),m.set(this.center,this.center),m.expandByScalar(this.radius),m},applyMatrix4:function(N){return this.center.applyMatrix4(N),this.radius=this.radius*N.getMaxScaleOnAxis(),this},translate:function(U){return this.center.add(U),this},equals:function(B){return B.center.equals(this.center)&&B.radius===this.radius}});var es=A.Math.Frustum=function(w,d,s,q,S,c){this.planes=[w!==r?w:new Ke,d!==r?d:new Ke,s!==r?s:new Ke,q!==r?q:new Ke,S!==r?S:new Ke,c!==r?c:new Ke]};b.assign(es.prototype,{set:function(B,Y,y,s,x,O){var L=this.planes;return L[0].copy(B),L[1].copy(Y),L[2].copy(y),L[3].copy(s),L[4].copy(x),L[5].copy(O),this},clone:function(){return(new this.constructor).copy(this)},copy:function(j){for(var C=this.planes,d=0;6>d;d++)C[d].copy(j.planes[d]);return this},setFromMatrix:function(Z){var B=this.planes,b=Z.el,m=b[0],q=b[1],X=b[2],M=b[3],Y=b[4],O=b[5],J=b[6],C=b[7],W=b[8],A=b[9],n=b[10],R=b[11],y=b[12],Q=b[13],D=b[14],o=b[15];return B[0].setComponents(M-m,C-Y,R-W,o-y).normalize(),B[1].setComponents(M+m,C+Y,R+W,o+y).normalize(),B[2].setComponents(M+q,C+O,R+A,o+Q).normalize(),B[3].setComponents(M-q,C-O,R-A,o-Q).normalize(),B[4].setComponents(M-X,C-J,R-n,o-D).normalize(),B[5].setComponents(M+X,C+J,R+n,o+D).normalize(),this},intersectsObject:function(){var X=new tp;return function(a){var e=a.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),X.copy(e.boundingSphere).applyMatrix4(a.matrixWorld),this.intersectsSphere(X)}}(),intersectsSprite:function(){var g=new tp;return function(I){return g.center.set(0,0,0),g.radius=.7071067811865476,g.applyMatrix4(I.matrixWorld),this.intersectsSphere(g)}}(),intersectsSphere:function(F){for(var i=this.planes,j=F.center,E=-F.radius,p=0;6>p;p++){var C=i[p].distanceToPoint(j);if(E>C)return!1}return!0},intersectsBox:function(){var i=new hb;return function(x){for(var n=this.planes,A=0;6>A;A++){var c=n[A];if(i.x=c.normal.x>0?x.max.x:x.min.x,i.y=c.normal.y>0?x.max.y:x.min.y,i.z=c.normal.z>0?x.max.z:x.min.z,c.distanceToPoint(i)<0)return!1}return!0}}(),containsPoint:function(t){for(var J=this.planes,G=0;6>G;G++)if(J[G].distanceToPoint(t)<0)return!1;return!0}});var Sn=A.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};b.assign(Sn.prototype,{set:function(C,A,x,t,V,I,g,D,k,K,Y,E,j,$,M,b){var Q=this.el;return Q[0]=C,Q[4]=A,Q[8]=x,Q[12]=t,Q[1]=V,Q[5]=I,Q[9]=g,Q[13]=D,Q[2]=k,Q[6]=K,Q[10]=Y,Q[14]=E,Q[3]=j,Q[7]=$,Q[11]=M,Q[15]=b,this},clone:function(){return(new Sn).fromArray(this.el)},fromArray:function(P,t){t===r&&(t=0);for(var p=this.el,z=0;16>z;z++)p[z]=P[z+t];return this},getElements:function(){return this.el},scale:function(D){var v=this.el,k=D.x,N=D.y,Z=D.z;return v[0]*=k,v[4]*=N,v[8]*=Z,v[1]*=k,v[5]*=N,v[9]*=Z,v[2]*=k,v[6]*=N,v[10]*=Z,v[3]*=k,v[7]*=N,v[11]*=Z,this},makeRotationFromEuler:function(M){var Z=this.el,B=M._x,v=M._y,I=M._z,e=M._order,D=Math.cos(B),d=Math.sin(B),$=Math.cos(v),N=Math.sin(v),L=Math.cos(I),J=Math.sin(I);if("XYZ"===e){var u=D*L,m=D*J,k=d*L,S=d*J;Z[0]=$*L,Z[4]=-$*J,Z[8]=N,Z[1]=m+k*N,Z[5]=u-S*N,Z[9]=-d*$,Z[2]=S-u*N,Z[6]=k+m*N,Z[10]=D*$}else if("YXZ"===e){var V=$*L,f=$*J,i=N*L,o=N*J;Z[0]=V+o*d,Z[4]=i*d-f,Z[8]=D*N,Z[1]=D*J,Z[5]=D*L,Z[9]=-d,Z[2]=f*d-i,Z[6]=o+V*d,Z[10]=D*$}else if("ZXY"===e){var V=$*L,f=$*J,i=N*L,o=N*J;Z[0]=V-o*d,Z[4]=-D*J,Z[8]=i+f*d,Z[1]=f+i*d,Z[5]=D*L,Z[9]=o-V*d,Z[2]=-D*N,Z[6]=d,Z[10]=D*$}else if("ZYX"===e){var u=D*L,m=D*J,k=d*L,S=d*J;Z[0]=$*L,Z[4]=k*N-m,Z[8]=u*N+S,Z[1]=$*J,Z[5]=S*N+u,Z[9]=m*N-k,Z[2]=-N,Z[6]=d*$,Z[10]=D*$}else if("YZX"===e){var n=D*$,A=D*N,r=d*$,c=d*N;Z[0]=$*L,Z[4]=c-n*J,Z[8]=r*J+A,Z[1]=J,Z[5]=D*L,Z[9]=-d*L,Z[2]=-N*L,Z[6]=A*J+r,Z[10]=n-c*J}else if("XZY"===e){var n=D*$,A=D*N,r=d*$,c=d*N;Z[0]=$*L,Z[4]=-J,Z[8]=N*L,Z[1]=n*J+c,Z[5]=D*L,Z[9]=A*J-r,Z[2]=r*J-A,Z[6]=d*L,Z[10]=c*J+n}return Z[3]=0,Z[7]=0,Z[11]=0,Z[12]=0,Z[13]=0,Z[14]=0,Z[15]=1,this},makeRotationFromQuaternion:function(s){var G=this.el,F=s._x,D=s._y,J=s._z,V=s._w,b=F+F,_=D+D,g=J+J,i=F*b,U=F*_,N=F*g,p=D*_,T=D*g,n=J*g,t=V*b,w=V*_,B=V*g;return G[0]=1-(p+n),G[4]=U-B,G[8]=N+w,G[1]=U+B,G[5]=1-(i+n),G[9]=T-t,G[2]=N-w,G[6]=T+t,G[10]=1-(i+p),G[3]=0,G[7]=0,G[11]=0,G[12]=0,G[13]=0,G[14]=0,G[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(E){var g=this.el,h=E.el,v=h[0],o=h[1],T=h[2],G=h[3],P=h[4],X=h[5],Q=h[6],f=h[7],l=h[8],b=h[9],U=h[10],I=h[11],a=h[12],y=h[13],L=h[14],c=h[15],e=b*L*f-y*U*f+y*Q*I-X*L*I-b*Q*c+X*U*c,R=a*U*f-l*L*f-a*Q*I+P*L*I+l*Q*c-P*U*c,t=l*y*f-a*b*f+a*X*I-P*y*I-l*X*c+P*b*c,Y=a*b*Q-l*y*Q-a*X*U+P*y*U+l*X*L-P*b*L,J=v*e+o*R+T*t+G*Y;if(0===J)return this.identity();var B=1/J;return g[0]=e*B,g[1]=(y*U*G-b*L*G-y*T*I+o*L*I+b*T*c-o*U*c)*B,g[2]=(X*L*G-y*Q*G+y*T*f-o*L*f-X*T*c+o*Q*c)*B,g[3]=(b*Q*G-X*U*G-b*T*f+o*U*f+X*T*I-o*Q*I)*B,g[4]=R*B,g[5]=(l*L*G-a*U*G+a*T*I-v*L*I-l*T*c+v*U*c)*B,g[6]=(a*Q*G-P*L*G-a*T*f+v*L*f+P*T*c-v*Q*c)*B,g[7]=(P*U*G-l*Q*G+l*T*f-v*U*f-P*T*I+v*Q*I)*B,g[8]=t*B,g[9]=(a*b*G-l*y*G-a*o*I+v*y*I+l*o*c-v*b*c)*B,g[10]=(P*y*G-a*X*G+a*o*f-v*y*f-P*o*c+v*X*c)*B,g[11]=(l*X*G-P*b*G-l*o*f+v*b*f+P*o*I-v*X*I)*B,g[12]=Y*B,g[13]=(l*y*T-a*b*T+a*o*U-v*y*U-l*o*L+v*b*L)*B,g[14]=(a*X*T-P*y*T-a*o*Q+v*y*Q+P*o*L-v*X*L)*B,g[15]=(P*b*T-l*X*T+l*o*Q-v*b*Q-P*o*U+v*X*U)*B,this},makeRotationAxis:function(z,c){var $=Math.cos(c),J=Math.sin(c),H=1-$,m=z.x,U=z.y,k=z.z,M=H*m,S=H*U;return this.set(M*m+$,M*U-J*k,M*k+J*U,0,M*U+J*k,S*U+$,S*k-J*m,0,M*k-J*U,S*k+J*m,H*k*k+$,0,0,0,0,1),this},multiply:function(u){return this.multiplyMatrices(this,u)},premultiply:function(V){return this.multiplyMatrices(V,this)},multiplyMatrices:function(c,A){var R=c.el,Z=A.el,H=this.el,b=R[0],u=R[4],D=R[8],C=R[12],p=R[1],J=R[5],q=R[9],F=R[13],P=R[2],n=R[6],K=R[10],z=R[14],l=R[3],_=R[7],i=R[11],$=R[15],S=Z[0],s=Z[4],N=Z[8],E=Z[12],y=Z[1],g=Z[5],e=Z[9],G=Z[13],k=Z[2],d=Z[6],U=Z[10],W=Z[14],v=Z[3],x=Z[7],w=Z[11],h=Z[15];return H[0]=b*S+u*y+D*k+C*v,H[4]=b*s+u*g+D*d+C*x,H[8]=b*N+u*e+D*U+C*w,H[12]=b*E+u*G+D*W+C*h,H[1]=p*S+J*y+q*k+F*v,H[5]=p*s+J*g+q*d+F*x,H[9]=p*N+J*e+q*U+F*w,H[13]=p*E+J*G+q*W+F*h,H[2]=P*S+n*y+K*k+z*v,H[6]=P*s+n*g+K*d+z*x,H[10]=P*N+n*e+K*U+z*w,H[14]=P*E+n*G+K*W+z*h,H[3]=l*S+_*y+i*k+$*v,H[7]=l*s+_*g+i*d+$*x,H[11]=l*N+_*e+i*U+$*w,H[15]=l*E+_*G+i*W+$*h,this},lookAt:function(){var g=new hb;return function(i,j,T){return g.subVectors(i,j),this.lookAtDirection(g,T)}}(),lookAtDirection:function(){var k=new hb,K=new hb,F=new hb;return function(R,o){o||(o=hb.UP);var y=this.el;return F.copy(R),0===F.lengthSq()&&(F.z=1),F.normalize(),k.crossVectors(o,F),0===k.lengthSq()&&(1===Math.abs(o.z)?F.x+=1e-4:F.z+=1e-4,F.normalize(),k.crossVectors(o,F)),k.normalize(),K.crossVectors(F,k),y[0]=k.x,y[4]=K.x,y[8]=F.x,y[1]=k.y,y[5]=K.y,y[9]=F.y,y[2]=k.z,y[6]=K.z,y[10]=F.z,this}}(),extractScale:function(){var G;return function(s){G===r&&(G=new hb),s===r&&(s=new hb);var L=G.setFromMatrixColumn(this,0).length(),i=G.setFromMatrixColumn(this,1).length(),F=G.setFromMatrixColumn(this,2).length();return s.set(L,i,F),s}}(),extractRotation:function(){var _;return function(j){_===r&&(_=new hb),j===r&&(j=new Sn);var e=this.el,b=j.el,Y=1/_.setFromMatrixColumn(j,0).length(),d=1/_.setFromMatrixColumn(j,1).length(),B=1/_.setFromMatrixColumn(j,2).length();return e[0]=b[0]*Y,e[1]=b[1]*Y,e[2]=b[2]*Y,e[4]=b[4]*d,e[5]=b[5]*d,e[6]=b[6]*d,e[8]=b[8]*B,e[9]=b[9]*B,e[10]=b[10]*B,this}}(),multiplyScalar:function(N){var v=this.el;return v[0]*=N,v[4]*=N,v[8]*=N,v[12]*=N,v[1]*=N,v[5]*=N,v[9]*=N,v[13]*=N,v[2]*=N,v[6]*=N,v[10]*=N,v[14]*=N,v[3]*=N,v[7]*=N,v[11]*=N,v[15]*=N,this},getPosition:function(H){return H===r&&(H=new hb),H.setFromMatrixColumn(this,3)},setPosition:function(N){var m=this.el;return m[12]=N.x,m[13]=N.y,m[14]=N.z,this},toArray:function(_,y){_===r&&(_=[]),y===r&&(y=0);var p=this.el;return _[y]=p[0],_[y+1]=p[1],_[y+2]=p[2],_[y+3]=p[3],_[y+4]=p[4],_[y+5]=p[5],_[y+6]=p[6],_[y+7]=p[7],_[y+8]=p[8],_[y+9]=p[9],_[y+10]=p[10],_[y+11]=p[11],_[y+12]=p[12],_[y+13]=p[13],_[y+14]=p[14],_[y+15]=p[15],_},determinant:function(){var A=this.el,U=A[0],h=A[4],o=A[8],K=A[12],b=A[1],k=A[5],q=A[9],x=A[13],J=A[2],w=A[6],H=A[10],M=A[14],Q=A[3],s=A[7],O=A[11],S=A[15];return Q*(+K*q*w-o*x*w-K*k*H+h*x*H+o*k*M-h*q*M)+s*(+U*q*M-U*x*H+K*b*H-o*b*M+o*x*J-K*q*J)+O*(+U*x*w-U*k*M-K*b*w+h*b*M+K*k*J-h*x*J)+S*(-o*k*J-U*q*w+U*k*H+o*b*w-h*b*H+h*q*J)},copy:function(S){var k=this.el,j=S.el;return k[0]=j[0],k[1]=j[1],k[2]=j[2],k[3]=j[3],k[4]=j[4],k[5]=j[5],k[6]=j[6],k[7]=j[7],k[8]=j[8],k[9]=j[9],k[10]=j[10],k[11]=j[11],k[12]=j[12],k[13]=j[13],k[14]=j[14],k[15]=j[15],this},compose:function(U,k,z){var L=this.el,w=k._x,C=k._y,W=k._z,$=k._w,G=w+w,R=C+C,Z=W+W,y=w*G,c=w*R,S=w*Z,v=C*R,E=C*Z,d=W*Z,P=$*G,o=$*R,q=$*Z,A=z.x,T=z.y,g=z.z;return L[0]=(1-(v+d))*A,L[1]=(c+q)*A,L[2]=(S-o)*A,L[3]=0,L[4]=(c-q)*T,L[5]=(1-(y+d))*T,L[6]=(E+P)*T,L[7]=0,L[8]=(S+o)*g,L[9]=(E-P)*g,L[10]=(1-(y+v))*g,L[11]=0,L[12]=U.x,L[13]=U.y,L[14]=U.z,L[15]=1,this
},decompose:function(){var y=new hb,A=new Sn;return function(M,g,K){var G=this.el,L=y.set(G[0],G[1],G[2]).length(),R=y.set(G[4],G[5],G[6]).length(),x=y.set(G[8],G[9],G[10]).length(),J=this.determinant();0>J&&(L=-L),M.x=G[12],M.y=G[13],M.z=G[14],A.copy(this);var d=1/L,W=1/R,U=1/x;return A.el[0]*=d,A.el[1]*=d,A.el[2]*=d,A.el[4]*=W,A.el[5]*=W,A.el[6]*=W,A.el[8]*=U,A.el[9]*=U,A.el[10]*=U,g.setFromRotationMatrix(A),K.x=L,K.y=R,K.z=x,this}}()});var _k=A.Math.Triangle=function(R,M,C){this.a=R!==r?R:new hb,this.b=M!==r?M:new hb,this.c=C!==r?C:new hb};b.assign(_k,{barycoordFromPoint:function(){var t=new hb,l=new hb,X=new hb;return function(P,N,f,D,J){t.subVectors(D,N),l.subVectors(f,N),X.subVectors(P,N);var j=t.dot(t),C=t.dot(l),d=t.dot(X),S=l.dot(l),Q=l.dot(X),x=j*S-C*C,e=J||new hb;if(0===x)return e.set(-2,-1,-1);var L=1/x,b=(S*d-C*Q)*L,E=(j*Q-C*d)*L;return e.set(1-b-E,E,b)}}(),uvIntersection:function(){var e=new hb;return function(c,u,k,L,D,H,T){return _k.barycoordFromPoint(c,u,k,L,e),D.multiplyScalar(e.x),H.multiplyScalar(e.y),T.multiplyScalar(e.z),D.add(H).add(T),D.clone()}}()});var Mn=A.Math.Euler=function(I,P,b,r,R){this.set(I,P,b,r,R)};Mn.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Mn.DefaultOrder="XYZ",Mn.ReverseOrder=function(){var J={xyz:"ZYX",xzy:"YZX",yxz:"ZXY",yzx:"XZY",zxy:"YXZ",zyx:"XYZ"};return function(V){return J[V]}}(),b.defineProperties(Mn.prototype,{x:{get:function(){return this._x},set:function(H){this._x=H,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(u){this._y=u,this.onChangeCallback()}},z:{get:function(){return this._z},set:function($){this._z=$,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(Z){this._order=Z,this.onChangeCallback()}}}),b.assign(Mn.prototype,{set:function(x,w,d,C,i){return Zf(x)&&(i=d,C=w,d=x[2],w=x[1],x=x[0]),C?i&&(C=Mn.ReverseOrder(C)):C="ZYX",this._x=x||0,this._y=w||0,this._z=d||0,this._order=C||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(K){return this._x=K._x,this._y=K._y,this._z=K._z,this._order=K._order,this.onChangeCallback(),this},setFromRotationMatrix:function(l,$,M){var D=A.Math.clamp,V=l.el||l,b=V[0],G=V[4],S=V[8],W=V[1],d=V[5],T=V[9],h=V[2],g=V[6],H=V[10];return $=$||this._order,"XYZ"===$?(this._y=Math.asin(D(S,-1,1)),Math.abs(S)<.99999?(this._x=Math.atan2(-T,H),this._z=Math.atan2(-G,b)):(this._x=Math.atan2(g,d),this._z=0)):"YXZ"===$?(this._x=Math.asin(-D(T,-1,1)),Math.abs(T)<.99999?(this._y=Math.atan2(S,H),this._z=Math.atan2(W,d)):(this._y=Math.atan2(-h,b),this._z=0)):"ZXY"===$?(this._x=Math.asin(D(g,-1,1)),Math.abs(g)<.99999?(this._y=Math.atan2(-h,H),this._z=Math.atan2(-G,d)):(this._y=0,this._z=Math.atan2(W,b))):"ZYX"===$?(this._y=Math.asin(-D(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(g,H),this._z=Math.atan2(W,b)):(this._x=0,this._z=Math.atan2(-G,d))):"YZX"===$?(this._z=Math.asin(D(W,-1,1)),Math.abs(W)<.99999?(this._x=Math.atan2(-T,d),this._y=Math.atan2(-h,b)):(this._x=0,this._y=Math.atan2(S,H))):"XZY"===$?(this._z=Math.asin(-D(G,-1,1)),Math.abs(G)<.99999?(this._x=Math.atan2(g,d),this._y=Math.atan2(S,b)):(this._x=Math.atan2(-T,H),this._y=0)):console.warn("unsupported order: "+$),this._order=$,M!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var N=new Sn;return function(G,B,c){return N.makeRotationFromQuaternion(G),this.setFromRotationMatrix(N,B,c)}}(),setFromVector3:function(P,m){return this.set(P.x,P.y,P.z,m||this._order)},reorder:function(){var W=new Ab;return function(C){return W.setFromEuler(this),this.setFromQuaternion(W,C)}}(),equals:function(A){return A._x===this._x&&A._y===this._y&&A._z===this._z&&A._order===this._order},fromArray:function(L){return this._x=L[0],this._y=L[1],this._z=L[2],L[3]!==r&&(this._order=L[3]),this.onChangeCallback(),this},toArray:function(b,M){return b===r&&(b=[]),M===r&&(M=0),b[M]=this._x,b[M+1]=this._y,b[M+2]=this._z,b[M+3]=this._order,b},toVector3:function(b){return b?b.set(this._x,this._y,this._z):new hb(this._x,this._y,this._z)},onChange:function(i){return this.onChangeCallback=i,this},onChangeCallback:function(){}});var Wi={ms_ac:function(R,M){for(var x=M.ms_ac,s=0;s<x.length;s++)ie(R,x[s])},ms_listener:function(S){S.addListeners=function(){var D=this,T=sj;u.mockTouch&&(T=Oh.concat(xf).concat(Cb)),D.__events__=T;for(var t=0,d=T.length;d>t;t++){var A=T[t];"wheel"===A&&!D.handle_wheel&&D.handle_mousewheel&&(D.handle_wheel=function(g){Ko(D,g)}),D["handle_"+A]&&tc(A,D.getView(),D)}},S.removeListeners=function(){var s=this,c=s.__events__;if(c){s.__events__=r;for(var o=0,X=c.length;X>o;o++)s["handle_"+c[o]]&&cl(c[o],s.getView(),s)}}},ms_fire:function(M){M.mp=function(l,Y,i){this.addPropertyChangeListener(l,Y,i)},M.ump=function(F,I){this.removePropertyChangeListener(F,I)},M.fp=function(e,n,Z,h,Y){return this.firePropertyChange(e,n,Z,h,Y)},M.addPropertyChangeListener=function(W,F,A){var f=this;f._62I||(f._62I=new lm),f._62I.add(W,F,A)},M.removePropertyChangeListener=function(F,i){this._62I&&this._62I.remove(F,i)},M.firePropertyChange=function(J,u,q,p,i){if(p){if(p(u,q))return!1}else if(u===q)return!1;var T=this,a=i||{};return a.property=J,a.oldValue=u,a.newValue=q,a.source=T,a.data=T,T._62I&&T._62I.fire(a),T.onPropertyChanged&&T.onPropertyChanged(a),!0}},ms_attr:function(p){p.a=function(E,m){var B=this;if(2===arguments.length)B.setAttr(E,m);else{if(!Tq(E))return B.getAttr(E);for(var v in E)B.setAttr(v,E[v])}return B},p.getAttr=function(G,V){if(V===r&&(V=1),this._attrObject&&G in this._attrObject)return this._attrObject[G];if(this.getImage){var j=this.getImage();if(ph(j)&&(j=ps[j]),Tq(j)&&"dataBindings"in j)for(var H=j.dataBindings,i=H.length-1;i>=0;i--){var h=H[i];if(h.attr===G){if("defaultValue"in h)return h.defaultValue;break}}}return V?o[G]:r},p.setAttr=function(d,k){var a=this;a._attrObject||(a._attrObject={});var X=a._attrObject[d];k===r?delete a._attrObject[d]:a._attrObject[d]=k,a.fp&&a.fp("a:"+d,X,k)&&a.onAttrChanged&&a.onAttrChanged(d,X,k)},p.getSerializableAttrs=function(){var L,x={};for(L in this._attrObject)x[L]=1;return x}},ms_bnb:function(M){M.getBodyColor=function(X){return X.s("body.color")},M.getBorderColor=function(u){return u.s("border.color")}},_51o:function(C){C.mi=function(x,K,f){this.addInteractorListener(x,K,f)},C.umi=function(p,I){this.removeInteractorListener(p,I)},C.fi=function(V){this.fireInteractorEvent(V)},C.addInteractorListener=function(Q,d,V){var s=this;s._63I||(s._63I=new lm),s._63I.add(Q,d,V)},C.removeInteractorListener=function(Z,D){this._63I&&this._63I.remove(Z,D)},C.fireInteractorEvent=function(z){this._63I&&this._63I.fire(z)},C.setInteractors=function(x){var H=this,U=H._interactors;U&&U.each(function(b){b.tearDown()}),Zf(x)&&(x=new Od(x)),H._interactors=x,x&&x.each(function(O){O.setUp()}),H.fp("interactors",U,x),H.invalidateSelection()},C.getInteractors=function(){return this._interactors}},_49o:function(T){T._44O=$,T._45O=$,T.getTopPainters=function(){return this._44O},T.getBottomPainters=function(){return this._45O},T.addTopPainter=function(t){var k=this;k._44O||(k._44O=new Od),k._44O.contains(t)||(k._44O.add(t),k.redraw&&k.redraw())},T.removeTopPainter=function(D){var k=this;k._44O&&(k._44O.remove(D),k.redraw&&k.redraw())},T.addBottomPainter=function(E){var i=this;i._45O||(i._45O=new Od),i._45O.contains(E)||(i._45O.add(E),i.redraw&&i.redraw())},T.removeBottomPainter=function(E){var k=this;k._45O&&(k._45O.remove(E),k.redraw&&k.redraw())},T._93db=function(w,S){var E=this;E._45O&&E._45O.each(function(Q){Q.draw?Q.draw(w,S):Q.call(E,w,S)})},T._92db=function(q,H){var I=this;I._44O&&I._44O.each(function(O){O.draw?O.draw(q,H):O.call(I,q,H)})}},ms_sm:function(y){y.sm=function(){return this.getSelectionModel()},y.setSelectableFunc=function(v){this.sm().setFilterFunc(v)},y.getSelectableFunc=function(){return this.sm().getFilterFunc()},y.getSelectionModel=function(){var l=this;return l._selectionModel?l._selectionModel:l.dm().sm()},y.isSelectionModelShared=function(){return!this._selectionModel},y.setSelectionModelShared=function(b){var Y=this,Q=Y.sm(),R=!Y._selectionModel,S=Y.handleSelectionChange,B=Y.dm();R!==b&&(Y.invalidateSelection&&Y.invalidateSelection(),b?(B.sm().ms(S,Y),Y._selectionModel.ums(S,Y),Y._selectionModel.dispose(),Y._selectionModel=$):(B.sm().ums(S,Y),Y._selectionModel=new ak(B),Y._selectionModel.ms(S,Y)),Y.onSelectionModelSharedChanged(),Y.fp("selectionModelShared",R,b),Y.fireViewEvent({kind:"selectionModelSharedChange",oldValue:R,newValue:b,oldSelectionModel:Q,newSelectionModel:Y.sm()}))},y.onSelectionModelSharedChanged=function(){var b=this;b.redraw(),b.invalidateSelection&&b.invalidateSelection()},y.removeSelection=function(){var b=this.dm();b.beginTransaction(),this.sm().toSelection().each(b.remove,b),b.endTransaction()},y.selectAll=function(){var Z=this;Z.sm().ss(Z.dm().toDatas(function(f){return Z.isVisible(f)&&Z.isSelectable(f)}))},y.isSelected=function(Y){return this.sm().co(Y)},y.isSelectedById=function($){var v=this.dm().getDataById($);return v?this.isSelected(v):!1},y.isSelectable=function(O){return this.sm().isSelectable(O)}},ms_tx:function(j){j._64I=0,j._65O=0,j.isScrollable=function(){return this.getWidth()<this._64I},j._40o=function(){return this.isScrollable()},j.getLogicalPoint=function(A){return Xr(A,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},j.tx=function(x){return x===r?this.getTranslateX():(this.setTranslateX(x),void 0)},j.getTranslateX=function(){return this._65O},j.setTranslateX=function(F){var Q=this,l=Q.getWidth()-Q._64I;l>F&&(F=l),F>0&&(F=0),F=t(F);var u=Q._65O;Q._65O=F,Q.fp(Ld,u,F)}},ms_ty:function(v){v._23Q=0,v._66O=0,v._41o=function(){return this.getHeight()<this._23Q},v.getLogicalPoint=function(r){return Xr(r,this._canvas||this._view,this.tx?this.tx():0,this.ty())},v.ty=function(n){return n===r?this.getTranslateY():(this.setTranslateY(n),void 0)},v.getTranslateY=function(){return this._66O},v.setTranslateY=function(c){var b=this,l=b.getHeight()-b._23Q;l>c&&(c=l),c>0&&(c=0),c=t(c);var v=b._66O;b._66O=c,b.fp(dg,v,c)}},ms_txy:function(z){z._65O=0,z._66O=0,z.tx=function(e){return e===r?this.getTranslateX():(this.setTranslateX(e),void 0)},z.ty=function(Y){return Y===r?this.getTranslateY():(this.setTranslateY(Y),void 0)},z.onTranslateEnded=function(){},z.setTranslate=function(H,c,w){var h=this;if(w=pr(w)){h._65I&&h._65I.stop(!0);var q=h.tx(),Z=h.ty();w.action=function(d){h.setTranslate(q+(H-q)*d,Z+(c-Z)*d)},w._37o=function(){delete h._66I,delete h._65I,h.onTranslateEnded()},h._66I=1,h._65I=ce(w)}else h.tx(H),h.ty(c)},z.getTranslateX=function(){return this._65O},z.setTranslateX=function(J){var l=this;J=l.adjustTranslateX(J);var R=l._65O;l._65O=J,l.fp(Ld,R,J)},z.getTranslateY=function(){return this._66O},z.setTranslateY=function(b){var i=this;b=i.adjustTranslateY(b);var F=i._66O;i._66O=b,i.fp(dg,F,b)},z.adjustTranslateX=function(A){return t(A)},z.adjustTranslateY=function(c){return t(c)},z.translate=function(P,U,C){this.setTranslate(this.tx()+P,this.ty()+U,C)},z.getLogicalPoint=function(s){var h=this;return Xr(s,this._canvas||h._view,h.tx(),h.ty())}},ms_dm:function(z){z.dm=function(X){return X?(this.setDataModel(X),void 0):this.getDataModel()},z.getDataModel=function(){return this._dataModel}},ms_lp:function(w){w.lp=function(m){return this.getLogicalPoint(m)}},ms_v:function(H){H._disabled=!1,H.setDisabled=function(b,S){var D=this,U=D._disabled;U!==b&&(U&&(lk(D._63O),delete D._63O),b&&($p(D._view,D._63O=rp(S)),D.iv()),D._disabled=b,D.fp("disabled",U,b))},H.isDisabled=function(){return this._disabled},H.getDisabledDiv=function(){return this._63O},H.getView=function(){return this._view},H.addToDOM=function($){var d=this,m=d.getView(),b=m.style;$=$||G.body,$.appendChild(m),b.left="0",b.right="0",b.top="0",b.bottom="0",f(C,"resize",function(){d.iv()}),d.iv()},H.setCursor=function(f){"default"===f&&(f=this._defaultCursor||f);var A=this.getView().style;A.cursor=f,A.cursor="-webkit-"+f,A.cursor="-moz-"+f},H.getWidth=function(){return this._view.clientWidth},H.getHeight=function(){return this._view.clientHeight},H.setWidth=function(q){var k=this;k._view.style.width=q+en,k.iv(),k.fp&&k.fp(Ac,$,q)},H.setHeight=function(I){var E=this;E._view.style.height=I+en,E.iv(),E.fp&&E.fp(Tl,$,I)},H.setFocus=function(v){var s=this,K=s._currentEditor;return v&&K&&(K.getView&&(K=K.getView()),K.contains(v.target))?!1:(Qr(s._view),s.endEditing&&s.endEditing(),s.fireViewEvent("focus"),!0)},H.iv=function(L){this.invalidate(L)},H.invalidate=function(t){var m=this;m._68I||(m._68I=1,Qi(m.validate,m,$,t),m.onInvalidated&&m.onInvalidated(),m.fireViewEvent("invalidate"))},H.validate=function(){var T=this,Q=T._view;if(T._68I&&(delete T._68I,Q.parentNode))if(0===Q.offsetWidth&&0===Q.offsetHeight&&T._67I!==$)T._67I===r&&(T._67I=u.reinvalidateCount),T._67I>0?T._67I--:T._67I=$,T.iv();else{T.fireViewEvent("beginValidate"),T.validateImpl(),T.onValidated&&T.onValidated(),T.fireViewEvent("validate");var G=T._63O;G&&(Q.lastChild!==G&&(lk(G),$p(Q,G)),Zg(G,0,0,T.getWidth(),T.getHeight())),Ci(T),_f(T),Qe(T)}},H.layout=function(B,Z,s,m){1===arguments.length?Zg(this,B):Zg(this,B,Z,s,m)},H.addViewListener=function(p,L,R){var K=this;K._67O||(K._67O=new lm),K._67O.add(p,L,R)},H.removeViewListener=function(f,i){this._67O.remove(f,i)},H.fireViewEvent=function(R){var B=this;B._67O&&(ph(R)&&(R={kind:R}),B._67O.fire(R)),u.viewListener&&u.viewListener(B,R)}},ms_tip:function(N){N.setToolTipEnabled=function(w){var B=this;w?Ze||B._13o||(B.enableToolTip(),B.fp("toolTipEnabled",!1,!0)):B._13o&&(B.disableToolTip(),B.fp("toolTipEnabled",!0,!1))},N.isToolTipEnabled=function(){return!!this._13o},N.enableToolTip=function(){var p=this;if(!Ze&&!p._13o){p._13o=function(J){var f=p.getToolTip(J);f!=$?(u.toolTipContinual&&u.isToolTipShowing()?ee(J,f):(Wo(),Fk={timeout:Kb(dr,ar),e:J,info:f}),$g={e:J,view:p}):Wo()};var a=p.getView();f(a,Uk,p._13o),f(a,"mouseleave",u.hideToolTip)}},N.disableToolTip=function(){var D=this;if(D._13o){var A=D.getView();I(A,Uk,D._13o),I(A,"mouseleave",u.hideToolTip),delete D._13o}},N.getToolTip=function(o){var K=this;if(K.getDataAt){var C=K.getDataAt(o);return C?C.getToolTip():$}return K.getValue?K.getValue():void 0}},_52o:function(r){r._zoom=1,r._29I=ze,r.zoomIn=function(j,z){this.setZoom(this._zoom*$e,j,z)},r.zoomOut=function(J,z){this.setZoom(this._zoom/$e,J,z)},r.zoomReset=function(T,S){this.setZoom(1,T,S)},r.scrollZoomIn=function(C){this.setZoom(this._zoom*_n,$,C)},r.scrollZoomOut=function(h){this.setZoom(this._zoom/_n,$,h)},r.pinchZoomIn=function(O){this.setZoom(this._zoom*Hp,$,O)},r.pinchZoomOut=function(z){this.setZoom(this._zoom/Hp,$,z)},r.adjustZoom=function(m){return fk>m?fk:m>Fn?Fn:m},r.getZoom=function(){return this._zoom},r.setZoom=function(H,O,r){var F=this;if(O=pr(O)){F._14o&&F._14o.stop(!0);var M=F._zoom;O.action=function(e){F._96O(M+(H-M)*e,r)},O._37o=function(){delete F._zooming,delete F._14o,F.onZoomEnded()},F._zooming=1,F._14o=ce(O)}else F._96O(H,r)},r._96O=function(D,m){var K=this;if(D=K.adjustZoom(D),D!==K._zoom){K.validate();var U=K._29I,o=K._zoom;0!==U.width&&0!==U.height&&(m=m?m:{x:U.x+U.width/2,y:U.y+U.height/2},K.tx((m.x-U.x)*o-m.x*D),K.ty((m.y-U.y)*o-m.y*D)),K._zoom=D,K.fp("zoom",o,D)}}},ms_edge:function(Q){Q._2I=function(i){var Z=this;Z._44I||(Z._44I=new Od),Z._42I||(Z._42I=new Od),Z._44I.add(i),Z._42I.add(i),Z._20I()},Q._4I=function($){var y=this;y._44I||(y._44I=new Od),y._43I||(y._43I=new Od),y._44I.add($),y._43I.add($),y._20I()},Q._16I=function(M){var _=this;_._44I.remove(M),_._42I.remove(M),_._44I.isEmpty()&&delete _._44I,_._42I.isEmpty()&&delete _._42I,_._20I()},Q._18I=function(r){var J=this;J._44I.remove(r),J._43I.remove(r),J._44I.isEmpty()&&delete J._44I,J._43I.isEmpty()&&delete J._43I,J._20I()},Q._20I=function(){var $=this;if(delete $._45I,!$._44I||$._44I.isEmpty())return delete $._70O,void 0;var n;$._44I.each(function(D){D.isLooped()&&(n||(n={}),n[D._id]||($._45I||($._45I=new Od),$._45I.add(D),n[D._id]=D))}),n?($._70O=new Od,$._44I.each(function(h){n[h._id]?"A"===n[h._id]||(n[h._id]="A",$._70O.add(h)):$._70O.add(h)})):$._70O=$._44I},Q.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},Q.getSourceAgentEdges=function(){return this._46I},Q.getTargetAgentEdges=function(){return this._47I},Q._1I=function(T){var h=this;h._46I||(h._46I=new Od),h._48I||(h._48I=new Od),h._46I.add(T),h._48I.add(T),h._19I()},Q._3I=function(f){var D=this;D._47I||(D._47I=new Od),D._48I||(D._48I=new Od),D._47I.add(f),D._48I.add(f),D._19I()},Q._15I=function(K){var P=this;P._46I.remove(K),P._48I.remove(K),P._46I.isEmpty()&&delete P._46I,P._48I.isEmpty()&&delete P._48I,P._19I()},Q._17I=function(Q){var W=this;W._47I.remove(Q),W._48I.remove(Q),W._47I.isEmpty()&&delete W._47I,W._48I.isEmpty()&&delete W._48I,W._19I()},Q._19I=function(){var V=this;delete V._49I;var X=V._48I;if(X&&!X.isEmpty()){var j={};X.each(function(a){j[a._id]?V._49I||(V._49I=new Od):j[a._id]=a}),V._49I?X.each(function(J){j[J._id]&&(V._49I.add(J),delete j[J._id])}):V._49I=X}},Q.getLoopedEdges=function(){return this._45I},Q.getEdges=function(){return this._70O},Q.getAgentEdges=function(){return this._49I},Q.getSourceEdges=function(){return this._42I},Q.getTargetEdges=function(){return this._43I},Q._8I=function(){this._70O&&this._70O.each(function(y){y._7I()})}}};hf(u,{getVersion:function(){return"7.2.8"}},!0);var oj=function(y){return y.devicePixelRatio?y.devicePixelRatio:y.screen&&y.screen.logicalXDPI?y.screen.deviceXDPI/y.screen.logicalXDPI:1};hf(u,{numberDigits:5,crossOrigin:"",baseZIndex:r,isTouchable:Ze,mockTouch:!0,devicePixelRatio:oj(C),reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:p.disabledBackground,forceHierarchicalSerialization:!0,extractBatchTranslation:!1,extractShapeTranslation:!1,extractPolylineTranslation:!1,extractVerticesTranslation:!1,envmapProbeMinWaitTime:300,envmapProbeMaxWaitTime:25e3,EnvmapTextureSize:1024,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Iq},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],blockMinSize:1,textExtraWidth:4,encodeStringKey:null,doubleClickSpeed:500,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(R){return R*R},labelColor:gl,labelSelectColor:Lq,labelFont:"12px arial, sans-serif",widgetIndent:Ze?30:20,widgetRowHeight:Ze?30:20,widgetHeaderHeight:Ze?32:22,widgetTitleHeight:Ze?34:24,scrollBarColor:Jq,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Ze?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Pp,intersectionLineLine:go,isEnter:Yc,isEsc:$c,isDelete:oc,isSpace:An,isLeft:$b,isUp:Wc,isRight:mr,isDown:Td,isTouchEvent:hk,getTarget:xh,isString:ph,isNumber:fl,isBoolean:xn,isArray:Zf,isSelectAll:Qf,isFunction:Xp,isObject:Tq,getPropertyValue:wg,setPropertyValue:vn,addMethod:hf,createGradient:function(R,Y,V,u,k,N,c,X){var m=bj[Y];return m(R,V,u,k,N,c,X)},appendToScreen:function(K){K=K.getView?K.getView():K,(G.fullscreenElement||G.mozFullScreenElement||G.webkitFullscreenElement||G.msFullscreenElement||G.body).appendChild(K)},encodeString:function(o){return A.Math.encodeBase64(o,u.encodeStringKey)},decodeString:function(K){return A.Math.decodeBase64(K,u.encodeStringKey)},findView:function(N){var C=function(W,G){var l=G._ht;l&&W.push(l);var I=G.children,P=I.length;if(P)for(var z=0;P>z;z++)C(W,I[z])},B=[];C(B,G.body);var d=function(s,V){for(var g="2d"===V?bl.GraphView:Fr.Graph3dView,v=0,S=s.length;S>v;v++)if(s[v]instanceof g)return B[v];return null};return"all"===N?B:"2d"===N?d(B,"2d"):"3d"===N?d(B,"3d"):d(B,"3d")||d(B,"2d")},toggleFullscreen:function(F){var e=F.getView();if(G.fullscreenElement||G.mozFullScreenElement||G.webkitFullscreenElement||G.msFullscreenElement)G.exitFullscreen?G.exitFullscreen():G.msExitFullscreen?G.msExitFullscreen():G.mozCancelFullScreen?G.mozCancelFullScreen():G.webkitExitFullscreen&&G.webkitExitFullscreen();else{var Y=!0;if(F.isSelfViewEvent){var W=F.getX(),z=F.getY(),B=F.getWidth(),x=F.getHeight(),v=e.style.background,R=e.style.backgroundColor;v||R||(e.style.backgroundColor="white"),e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen();var w=setInterval(function(){if(e!==(G.fullscreenElement||G.mozFullScreenElement||G.webkitFullscreenElement||G.msFullscreenElement))clearInterval(w),F.setX(W),F.setY(z),F.setWidth(B),F.setHeight(x),F._fullscreen=!1,e.style.oldBackgroundColor=R,F.iv();else{var O=A.Default.getWindowInfo();(Y||O.width!==F.getWidth()||O.height!==F.getHeight())&&(F.setX(O.left),F.setY(O.top),F.setWidth(O.width),F.setHeight(O.height),F._fullscreen=!0,F.iv(),Y=!1)}},500)}else{var $=e.style.left,D=e.style.top,B=e.style.width,x=e.style.height,v=e.style.background,R=e.style.backgroundColor;v||R||(e.style.backgroundColor="white"),e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen();var w=setInterval(function(){if(e!==(G.fullscreenElement||G.mozFullScreenElement||G.webkitFullscreenElement||G.msFullscreenElement))clearInterval(w),e.style.left=$,e.style.top=D,e.style.width=B,e.style.height=x,e.style.oldBackgroundColor=R,F.iv();else{var Q=A.Default.getWindowInfo();(Y||Q.width!==F.getWidth()||Q.height!==F.getHeight())&&(Zg(F),Y=!1)}},500)}}},appendTimeStamp:function(c){return c},setCompType:function(j,g){ph(g)&&g.substr(0,12)==To&&(g=u.parse(g)),Xp(g)||Tq(g)?Gl[j]=g:vc(j)},getCompType:function(F){var X=Gl[F];return X===r&&Dj.test(F)&&vc(F),X},getCompTypeMap:function(){return Gl},drawCompType:function(e,n,Y,r,c,L){e(n,Y,r,c,L)},numberListener:function(){var r={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(P){var X=P.keyCode;r[X]||65===X&&u.isCtrlDown(P)||86===X&&u.isCtrlDown(P)||67===X&&u.isCtrlDown(P)||88===X&&u.isCtrlDown(P)||X>=35&&40>=X||(P.shiftKey||48>X||X>57)&&(96>X||X>105)&&P.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(x){var Q=x.target.tagName;("DIV"===Q||"CANVAS"===Q)&&!(u.ignoreKeyCodes.indexOf(x.keyCode)>=0)&&("keydown"!==x.type||$b(x)||mr(x)||Wc(x)||Td(x)||oc(x)||65===x.keyCode&&(x.metaKey||x.ctrlKey))&&x.cancelable===!0&&(x.preventDefault(),x.preventManipulation&&x.preventManipulation())},getWindowInfo:function(){var l=G.documentElement,v=l&&(l.scrollLeft||l.scrollTop)?l:G.body;return{target:v,left:v.scrollLeft,top:v.scrollTop,width:C.innerWidth||v.clientWidth,height:C.innerHeight||v.clientHeight}},isDragging:function(){return!!Iq},isLeftButton:function(l){return hk(l)?!0:0===l.button},isMiddleButton:function(f){return hk(f)?!1:f&&(1===f.button||4&(f.buttons||0))},isRightButton:function(R){return hk(R)?!1:R&&(2===R.button||2&(R.buttons||0))},isInput:function(M){if(!M)return!1;var P=M.tagName;return"INPUT"===P||"TEXTAREA"===P||"SELECT"===P},getTouchCount:function(q){return hk(q)?q.touches.length:1},isDoubleClick:function(){function H(S){S.details=0,S.timeout=null,S.lastPoint=null}var Z={};return vm=new Tn,Pd=vm.getTime(),function(g){if(ge(g)>1)return!1;var Y=g.button==$?"":g.button,Q=g.type+Y,J=Q+"_isDoubleClick",S=Z[Q];if(S||(S=Z[Q]={details:0,timeout:null,lastPoint:null}),g[J]===r){g[J]=!0;var O=dj(g);S.timeout&&(Xi(S.timeout),S.timeout=null);var e=hk(g)?u.doubleTouchRange:u.doubleClickRange;S.lastPoint&&Kj(S.lastPoint,O)>e&&H(S),S.lastPoint=O,S.details++,S.timeout=Kb(function(){H(this)}.bind(S),u.doubleClickSpeed)}return 2===S.details}}(),isShiftDown:function(W){return W?W.shiftKey:gc["16"]},isCtrlDown:function(u){return u?aj?u.metaKey:u.ctrlKey:aj?gc["91"]:gc["17"]},getClientPoint:function(v){return hk(v)&&(v=Mh(v)),{x:v.clientX,y:v.clientY}},isMouseEvent:function(C){return C instanceof MouseEvent||0===C.type.indexOf("mouse")},getTargetElement:function(Z){var g,n=Bc(Z);if(g=u.isMouseEvent(Z)||!G.elementFromPoint?Z.target:G.elementFromPoint(n.x,n.y),yo&&G.elementFromPoint){for(var O=[],l=[];"none"===g.style.pointerEvents;)O.push(g),l.push(g.style.display||""),g.style.display="none",g=G.elementFromPoint(n.x,n.y);O.forEach(function(o,q){o.style.display=l[q]})}return g},getPagePoint:function(G){return hk(G)&&(G=Mh(G)),{x:G.pageX,y:G.pageY}},createObject:function(z,V){var R=new z;for(var E in V){var n=V[E];if(Xp(n))R[E]=n;else if(0===E.indexOf("s:"))R.s(E.substr(2),V[E]);else if(0===E.indexOf("a:"))R.a(E.substr(2),V[E]);else{var c=Uo(E),n=V[E];R[c]?(R[c](n),"setToolTip"===c&&R.enableToolTip&&R.enableToolTip()):R[E]=n}}return R},setImage:function(D,m,Y,w){var I=arguments.length;4===I?Xc(D,w,m,Y):2===I?ph(m)?m.substr(0,12)==To?yg(D,u.parse(m)):Xc(D,m):yg(D,m):1===I&&Xc(D,D)},getImage:function(w,V,v){var m;if(w==$)return $;if(Tq(w)?m=w:(m=ps[w],w&&m===r&&(vd&&vd[w]||Xc(w,w))),V&&m&&m.tagName){var F;F="override"===v?"colors_override":"override_rgb"===v?"colors_override_rgb":"override_a"===v?"colors_override_a":"colors",m[F]||(m[F]={__count__:0});var H=m[F][V];return H||(m[F].__count__>u.imageCacheThreshold&&(m[F]={__count__:0}),H=br(m,th(V),m.width,m.height,v),m[F][V]=H,m[F].__count__++),H}return m},isImageComplete:function(c,v,g){var B=Of(c);if(!B)return!1;if(B.tagName)return B.complete;for(var x,c,h,t=B.comps,w=!0,T=0,k=t.length;k>T;T++)if(x=t[T],h=x.type,"image"===x.type){c=x.name,c&&c.func&&(c=Tp(c,v));var Z=Bg(c,v,g);if(!Z){w=!1;break}}else if(Dj.test(h)&&u.getCompType(h)===r){w=!1,vc(h);break}return w},getId:function(){var Y=1;return function(){return++Y}}(),callLater:function(d,x,H,f){var e=function(){d.apply(x,H)};return f?Kb(e,f):C.requestAnimationFrame(e)},cancelLater:function(j,m){m?Xi(j):C.cancelAnimationFrame(j)},clone:function(w){if(null==w||"object"!=typeof w)return w;if(w instanceof Date){var Q=new Date;return Q.setTime(w.getTime()),Q}if(w instanceof Array){for(var Q=[],O=0,C=w.length;C>O;O++)Q[O]=Bf(w[O]);return Q}if(w instanceof Od){for(var Q=new Od,O=0,C=w.length;C>O;O++)Q.set(O,Bf(w.get(O)));return Q}if(w instanceof $h)return w;if(w instanceof Or){var Q=new Or;return Q.deserialize(w.serialize()),Q}if(w instanceof b){var Q={};for(var P in w)w.hasOwnProperty(P)&&(Q[P]=Bf(w[P]));return Q}return w},callWhenLoaded:function(G,X){X=X||100;var t=hr(G,X);bs||(bs={}),bs[t]={tick:t,cb:G,delay:X}},beforeLoadURL:function(e,J){if(bs){var m={};for(var J in bs){var E=bs[J];Xi(E.tick);var f=hr(E.cb,E.delay);m[f]={tick:f,delay:E.delay,cb:E.cb}}bs=m}return u.convertURL?u.convertURL(e,J):e},convertURL:function(o){return o},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return u.getImage("default_blank")},resizeImage:function(d,F,k,Q){k||(k=F),Q||(Q=qc());var L=Q.getContext("2d");return Kc(Q,F,k,1),L.drawImage(d,0,0,F,k),Q},resizeImagePOT:function(S,H,E){if(!S||!S.tagName)return S;var w=S.width,d=S.height;if(!w||!d)return S;if(ke.isPOT(w)&&ke.isPOT(d)&&(!H||w===d))return S;var X,v;return H?v=X=ke.nearestPOT(Math.min(w,d)):(X=ke.nearestPOT(w),v=ke.nearestPOT(d)),u.resizeImage(S,X,v,E)},sortFunc:function(i,Y){if(i===Y)return 0;if(i==$&&Y!=$)return 1;if(i!=$&&Y==$)return-1;if(i==$&&Y==$)return 0;var S,U=typeof i,M=typeof Y;return U===ac&&M===ac?S=i.localeCompare(Y):U===zj&&M===zj&&(S=i-Y),S===r&&(S=(""+i).localeCompare(""+Y)),S>0?1:0>S?-1:0},getClassMap:function(){return Bd},getClass:function(g){if(ph(g)){var $,Q=Bd[g];if(!Q){$=g.split("."),Q=C;for(var c=0;c<$.length;c++)Q=Q[$[c]];Bd[g]=Q}return Q}return g},def:function(g,W,w){var l,q,A,e=function(){};if(e.prototype=W.prototype,l=new e,ph(g)){if(Bd[g])throw"'"+g+"' already defined";A=Bq(g),l.getClassName=function(){return g}}else A=g;if(l.constructor=A,l.getClass=function(){return A},l.getSuperClass=function(){return W},w)for(q in w)Wi[q]&&Wi.hasOwnProperty(q)?Wi[q](l,w):Jg(l,w,q);A.prototype=l,A.superClass=W.prototype},startAnim:function(){var L=function(W){W.duration&&(W.startTime=ei()),W.timeId=Qi(W.tick,$,$,W.interval)};return function(h){return h=Bf(h),h.easing=h.easing||u.animEasing,h.duration||h.frames||(h.duration=u.animDuration),h.t=0,h.duration?h.interval=0:(h.frame=0,h.interval=h.interval||10),h.tick=function(){if(h.duration){var x=(ei()-h.startTime)/h.duration;if(x>1&&(x=1),h.t=x,h.action(h.easing(x),x),!h.isRunning())return;1===x?h.stop():h._isPaused||(h.timeId=Qi(h.tick))}else{if(h.frame++,x=h.t=h.frame/h.frames,h.action(h.easing(x),x),!h.isRunning())return;h.frame<h.frames?h._isPaused||(h.timeId=Qi(h.tick,$,$,h.interval)):h.stop()}},h.resume=function(){h._isPaused&&(delete h._isPaused,h.duration?h.t<1&&(h.startTime=ei()-h.duration*h.t,h.timeId=Qi(h.tick)):h.frame<h.frames&&(h.timeId=Qi(h.tick,$,$,h.interval)))},h.pause=function(){os(h.timeId,!h.duration),h._isPaused=!0},h.isPaused=function(){return this._isPaused},h.stop=function(z){h.isRunning()&&(os(h.timeId,!h.duration),delete h.timeId,h.duration?h.t<1&&z&&(h.t=1,h.action(h.easing(1),1)):h.frame<h.frames&&z&&(h.frame=h.frames,h.action(h.easing(1),1)),h._37o&&h._37o(),h.finishFunc&&h.finishFunc())},h.isRunning=function(){return h.timeId!=$},h.delay?Qi(L,$,[h],h.delay):L(h),h}}(),getTextSize:function(){var q={},r=G?qc().getContext("2d"):$;return function(g,J){r.font=g?g:jq;var U=q[r.font];return U||(U=2*r.measureText("e").width+4,q[r.font]=U),{width:r.measureText(J).width+u.textExtraWidth,height:U}}}(),drawText:function(m,F,z,b,J,c,x,I,A,i,V){if(F!=$){var K=bq(z,F),G={};G.y=i&&i!==we?i===Yd?c+K.height/2:c+I-K.height/2:c+I/2,G.x=A&&A!==sl?A===vp?J+x-K.width/2:J+x/2:J+K.width/2,Zm(m,F,G,z,b),V&&Gn(m,F,z,b,G.x,G.y,K.width,V)}},getDistance:function(c,T){var P=c.length;return T?3===P?_(kc(c[0]-T[0])+kc(c[1]-T[1])+kc(c[2]-T[2])):2===P?_(kc(c[0]-T[0])+kc(c[1]-T[1])):c.z===r?_(kc(T.x-c.x)+kc(T.y-c.y)):_(kc(T.x-c.x)+kc(T.y-c.y)+kc(T.z-c.z)):3===P?_(kc(c[0])+kc(c[1])+kc(c[2])):2===P?_(kc(c[0])+kc(c[1])):void 0},brighter:function(W,o){return 0>o&&(o=-o),Cr(W,o?o:40)},darker:function(W,T){return T>0&&(T=-T),Cr(W,T?T:-40)},unionPoint:function(j,D){if(!j)return $;if(2===arguments.length)return j&&D?{x:O(j.x,D.x),y:O(j.y,D.y),width:k(j.x-D.x),height:k(j.y-D.y)}:$;var S=j;if(S._as&&(S=S._as),S.length===r)return $;var w=S.length;if(0>=w)return $;for(var X=1,l=S[0],o={x:l.x,y:l.y,width:0,height:0};w>X;X++){l=S[X];var g=O(o.x,l.x),G=E(o.x+o.width,l.x),d=O(o.y,l.y),b=E(o.y+o.height,l.y);o.x=g,o.y=d,o.width=G-g,o.height=b-d}return o},unionRect:function(P,h){if(P&&!h)return Bf(P);if(!P&&h)return Bf(h);if(P&&h){var n={x:O(P.x,h.x),y:O(P.y,h.y)};return n.width=E(P.x+P.width,h.x+h.width)-n.x,n.height=E(P.y+P.height,h.y+h.height)-n.y,n}return $},containsPoint:function(P,r,f,T){if(T!=$&&1!==T){var i=P.x+P.width/2,c=P.y+P.height/2;P={x:i-P.width/2*T,y:c-P.height/2*T,width:P.width*T,height:P.height*T}}if(f){var Y=P.width/2,d=P.height/2,o=X(-f),u=m(-f),K=r.x-P.x-Y,B=r.y-P.y-d;return r={x:u*K-o*B,y:o*K+u*B},oe({x:-Y,y:-d,width:P.width,height:P.height},r)}return!(!P||r.x<P.x||r.y<P.y||r.x>P.x+P.width||r.y>P.y+P.height)},containsRect:function(T,D){if(!T||!D)return!1;var V=D.x,l=D.y,s=D.width,C=D.height,k=T.width,Q=T.height;if(0>(k|Q|s|C))return!1;var U=T.x,j=T.y;if(U>V||j>l)return!1;if(k+=U,s+=V,V>=s){if(k>=U||s>k)return!1}else if(k>=U&&s>k)return!1;if(Q+=j,C+=l,l>=C){if(Q>=j||C>Q)return!1}else if(Q>=j&&C>Q)return!1;return!0},intersectsRect:function(O,C){if(!O||!C)return!1;var r=C.width,K=C.height,m=O.width,S=O.height;if(0>=m||0>=S||0>=r||0>=K)return!1;var X=C.x,F=C.y,Z=O.x,z=O.y;return m+=Z,S+=z,r+=X,K+=F,m>X&&S>F&&r>Z&&K>z},intersection:function(N,Q){if(!N||!Q)return $;var U=Q.x,d=Q.y,x=N.x,g=N.y,e=U,F=d,o=x,W=g;return e+=Q.width,F+=Q.height,o+=N.width,W+=N.height,x>U&&(U=x),g>d&&(d=g),e>o&&(e=o),F>W&&(F=W),e-=U,F-=d,0>=e||0>=F?$:{x:U,y:d,width:e,height:F}},grow:function(c,y,Y){Y===r&&(Y=y),c.x-=y,c.y-=Y,c.width=c.width+2*y,c.height=c.height+2*Y},getScreenPoint:function(B,N,Y,O,w,d,k){var V=Y.getBoundingClientRect(),t=B*(d||1)-Y.scrollLeft+(O||0),$=N*(k||1)-Y.scrollTop+(w||0),U=vs(Y,!1);
if(U){var W=new hb(t,$,0);return W.applyMatrix4(U),console.log(W),{x:W.x,y:W.y}}return{x:t+V.left,y:$+V.top}},getLogicalPoint:function(o,h,P,a,m,e){var D,l,r=h.getBoundingClientRect();o.target?(ao(o)?aj?gc["91"]=!0:gc["17"]=!0:aj?gc["91"]=!1:gc["17"]=!1,gc["16"]=Ng(o)?!0:!1,o=hk(o)?Mh(o):o,D=o.clientX,l=o.clientY):(D=o.x,l=o.y);var O=vs(h,!0);if(O){var q=new hb(D,l,0);q.applyMatrix4(O);do{if(Math.abs(q.z)<=1e-6)break;var F=new hb(D,l,1);if(F.applyMatrix4(matrix),Math.abs(F.z)<=1e-6){q=F;break}if(F.sub(q),Math.abs(F.z)<=1e-6)break;q.addScaledVector(F,-q.z/F.z)}while(!1);return{x:(q.x+h.scrollLeft-(P||0))/(m||1),y:(q.y+h.scrollTop-(a||0))/(e||1)}}return{x:(D-r.left+h.scrollLeft-(P||0))/(m||1),y:(l-r.top+h.scrollTop-(a||0))/(e||1)}},removeHTML:function(){var d;return function(i){return i&&i.getView&&(i=i.getView()),i&&i.parentNode?d===i?!0:(d=i,i.parentNode.removeChild(i),d=$,!0):!1}}(),getToolTipDiv:function(){if(!Wg){Wg=Ic(),js=Ic();var l=Wg.style;u.baseZIndex!=$&&(l.zIndex=rr(u.baseZIndex)+3+""),l.whiteSpace="nowrap",l.color=u.toolTipLabelColor,l.background=u.toolTipBackground,l.font=u.toolTipLabelFont,l.padding="5px",l.boxShadow="0px 0px 3px "+u.toolTipShadowColor}return Wg},isToolTipShowing:function(){return Wg&&Wg.parentNode?!0:js&&js.parentNode?!0:!1},updateToolTipContent:function(T,O){if(u.isToolTipShowing()&&(O||(O=$g&&$g.view),T===r&&O&&$g.e&&(T=O.getToolTip($g.e)),T!=$)){var l;T.html?(T=T.html,l=js):l=Wg,l.innerHTML=T}},hideToolTip:function(){if(u.isToolTipShowing()){lk(Wg),lk(js),mm();var j=$g&&$g.view;j&&j.onHideToolTip&&j.onHideToolTip(),$g=$}},showToolTip:function(k,a,P){if(!k||a==$)return Wo(),void 0;u.getToolTipDiv();var Y,v;if(a.html?(a=a.html,Y=js,lk(Wg)):(Y=Wg,lk(js)),v=Y.style,Y.innerHTML=a,Y.parentNode||A.Default.appendToScreen(Y),k.target){k=Bc(k);var M=xg(),J=k.x,w=k.y,U=Ze?60:12;if(Ze){var I=Y.getBoundingClientRect();v.left=J-I.width/2+en,v.top=w-I.height-U<M.top?w+U+en:w-I.height-U+en}else{v.left=J+U+en,v.top=w+U+en;var I=Y.getBoundingClientRect();I.left+I.width>M.width&&(v.left=J-U-I.width+en),I.top+I.height>M.height&&(v.top=w-U-I.height+en),I.left<0&&(v.left=J+U+en),I.top<0&&(v.top=w+U+en)}}else v.left=k.x+en,v.top=k.y+en;mm(),P===r?P=$g&&$g.view:$g={e:k,view:P},P&&P.onShowToolTip&&P.onShowToolTip()},startDragging:function(e,p,P){P==r&&(P=!0),e!==Iq&&(Iq?P&&(hk(p)?Iq.handleWindowTouchEnd(p):Iq.handleWindowMouseUp(p)):hk(p)?(f(C,sn,qp),f(C,Po,Hf),f(C,"blur",Hf)):(f(C,Uk,ms),f(C,Tm,ub),f(C,"blur",ub)),Iq=e)},getImageMap:function(){return ps},toBoundaries:function(y,q,s,u){var n=[];return Mp(y,q,s,u).forEach(function(H){var o=[];H.forEach(function(x){o.push(x.x,x.y)}),n.push(o)}),n},getCurrentKeyCodeMap:function(){return gc},drawCenterImage:function(r,$,_,m,J,T,d,S){!J&&T&&T.isSelfViewEvent&&(J=T);var B=Hn($,J,T),q=ks($,J,T);zm(r,$,t(_-B/2),t(m-q/2),B,q,J,T,d,S)},drawStretchImage:function(A,E,j,$,J,n,l,I,Y,b,U,m){!I&&Y&&Y.isSelfViewEvent&&(I=Y);var M,T=Hn(E,I,Y,n),w=ks(E,I,Y,l);"uniform"===j?(M=O(n/T,l/w),T*=M,w*=M,$+=t((n-T)/2),J+=t((l-w)/2),n=T,l=w):"centerUniform"===j&&((T>n||w>l)&&(M=O(n/T,l/w),T*=M,w*=M),$+=t((n-T)/2),J+=t((l-w)/2),n=T,l=w);var s=A.interactiveInfo;if(s){var B;if(B="center"===j?{x:$+n/2-T/2,y:J+l/2-w/2,width:T,height:w}:{x:$,y:J,width:n,height:l},s.rect){var P=s.compInfos,D=P.length;D&&(P[D-1].rect.image=E)}else s.rect=B}if("center"===j){var x=U!==!1&&(T>n||w>l);x&&(A.save(),A.beginPath(),A.rect($,J,n,l),A.clip()),zm(A,E,$+n/2-T/2,J+l/2-w/2,T,w,I,Y,b,m),x&&A.restore()}else zm(A,E,$,J,n,l,I,Y,b,m)},toCanvas:function(v,G,L,w,B,m,i,E,y){v=Of(v,i),G=G||Hn(v,B),L=L||ks(v,B);var q=qc(),C=te(q);return E?(Kc(q,G,L,E),C.scale(E,E)):Kc(q,G,L,1),Gp(C,v,w,0,0,G,L,B,m,i,y),v&&v.clampToEdge&&(q.clampToEdge=v.clampToEdge),C.restore(),q},toGrayColor:function(_){if(!_)return _;var l=fg(_),s=t(.299*l[0]+.587*l[1]+.114*l[2]);return"rgba("+s+","+s+","+s+","+l[3]/255+")"},createGradientImage:function(Y,T,d,a){for(var E=["L",0,0,Y,0,1,0,0,1,0,0],m=0,I=Math.min(T.length,d.length);I>m;m++)E.push(d[m],T[m]);var B=A.Default.toCanvas({width:Y,height:Y,clampToEdge:!0,comps:[{type:"shape",rotation:a||0,points:[0,0,Y,0,Y,Y,0,Y],background:"#ffffff",gradientPack:E}]});return B},createElement:function(B,r,J,L){var b=G.createElement(B);return Qq(b,r||p.widgetBorder,2),b.style.font=J?J:jq,L!=$&&(b.value=L),u.onElementCreated&&u.onElementCreated(b),b},containedInView:function(t,N){var g=Al(N).getBoundingClientRect();return oe({x:g.left,y:g.top,width:g.width,height:g.height},dj(t))},isIsolating:function(){return Qk>0},setIsolating:function(q){q?Qk++:Qk--},getMSMap:function(){return Wi},stringify:function(C,X,t){var B=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var K=Or.prototype.toJSON;Or.prototype.toJSON=function(){return"__ht__dataModel"+this.serialize(0)},X=t?0:X==$?2:X;var R=JSON.stringify(C,function(t,B){return"function"==typeof B?"__ht__"+(B.__ht__||B.toString()):fl(B)?re(B):B instanceof A.List?"__ht__list"+(B.__ht__list||u.stringify(B._as)):B},X);return Date.prototype.toJSON=B,Or.prototype.toJSON=K,t&&(R=To+qh(R)),R},parse:function($,L){return ph($)?$.substr(0,12)!=To||($=ab($.substr(12)),ph($))?(L=L||{},JSON.parse($,function(F,O){if(ph(O))if(L.ignoreFunction||"__ht__function"!=O.substr(0,14)){if(!L.ignoreDate&&"__ht__date"==O.substr(0,10))return new Date(rr(O.substr(10)));if("__ht__list"===O.substr(0,10))return new Od(u.parse(O.substr(10)));if(!L.ignoreDataModel&&"__ht__dataModel"===O.substr(0,15)){var H=new Or;return H.deserialize(u.parse(O.substr(15))),H}}else{var z=O.indexOf("{")+1,Z=O.lastIndexOf("}"),E=O.indexOf("(")+1,A=O.indexOf(")");if(z&&Z&&E&&A)try{var U=new Function(O.substring(E,A),O.substring(z,Z));return U.__ht__=O.substr(6),U}catch(v){throw console.info("=== SyntaxError ===\n",O),v}}return O})):$:$},loadJS:function(t,E){E&&t.push(E);var d=t.shift();if(Zf(d))t=d.contact(t),u.loadJS(t);else if(Xp(d))d(),u.loadJS(t);else if(ph(d)){var C=G.createElement("script");C.onload=function(){u.loadJS(t)},C.setAttribute("src",d),G.getElementsByTagName("head")[0].appendChild(C)}else t.length&&u.loadJS(t)},extendClass:function(U,_){var L=U.prototype;for(var Y in _)Wi[Y]&&Wi.hasOwnProperty(Y)?Wi[Y](L,_):L[Y]=_[Y]},toRoundedCorner:function(){function U(d,T,c){d.x=T.x,d.y=T.e||c,d.z=T.y}var Q=new hb,E=new hb,T=new hb,F=new hb;return function(z,q){var v,V=0;z.getPoints&&(V=z.getElevation(),z=z.getPoints()),v=z instanceof Od?z:new Od(z);var D=v.size();if(0>=q)return{points:v};var d=new Od,R=new Od,p=v.get(0);U(Q,p,V),d.add(p),R.add(1);for(var S=1;D>S;S++)if(D>S+1){var t=v.get(S),B=v.get(S+1);U(E,t,V),U(T,B,V),F.subVectors(Q,E).setLength(Math.min(.99*F.length(),q)).add(E),t.e!==r||p.e!==r?d.add({x:F.x,y:F.z,e:F.y}):d.add({x:F.x,y:F.z}),d.add(t),F.subVectors(T,E).setLength(Math.min(.99*F.length(),q)).add(E),t.e!==r||B.e!==r?d.add(p={x:F.x,y:F.z,e:F.y}):d.add(p={x:F.x,y:F.z}),Q.copy(F),R.addAll([2,3])}else d.add(v.get(S)),R.add(2);return{points:d,segments:R}}}(),toColorData:fg,setCanvas:Kc,createDiv:Ic,createDisabledDiv:rp,createView:Ar,createCanvas:qc,appendChild:$p,initContext:te,checkLoadingImage:Ci,translateAndScale:Tj,layout:Zg,getPosition:wi,drawPoints:gr,drawRoundRect:Fo,drawBorder:cc,setFocus:Qr,getter:ch,setter:Uo,isEmptyObject:Rd,cameraPriority:function(){var W={skybox:0,main:1e4,top:1e7,infinity:1/0};return b.seal(b.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return W.skybox},set:function(m){if(m>=W.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");W.skybox=Number(m)}},main:{configurable:!1,enumerable:!1,get:function(){return W.main},set:function(A){if(A<=W.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(A>=W.top)throw new RangeError("Main camera must have lower priority than the top camera.");W.main=Number(A)}},top:{configurable:!1,enumerable:!1,get:function(){return W.top},set:function($){if($<=W.main)throw new RangeError("Top camera must have higher priority than the main camera.");W.top=Number($)}}}))}()},!0),hf(j,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var uh=u.disabledOpacity,ar=u.toolTipDelay,Fd=u.devicePixelRatio,Rc=u.autoMakeVisible,fp=u.autoHideScrollBar,hl=u.imageGradient,ee=u.showToolTip,Wo=u.hideToolTip,Oj=u.dashPattern,ng=u.lineCap,hg=u.lineJoin,ii=u.labelColor,Sd=u.labelSelectColor,jq=u.labelFont,sb=u.widgetIndent,Vo=u.widgetRowHeight,Cq=u.widgetHeaderHeight,fh=u.widgetTitleHeight,Si=u.scrollBarColor,Tr=u.scrollBarSize,tj=u.scrollBarTimeout,sc=u.scrollBarMinLength,rq=u.scrollBarInteractiveSize,$e=u.zoomIncrement,_n=u.scrollZoomIncrement,Hp=u.pinchZoomIncrement,Fn=u.zoomMax,fk=u.zoomMin,Jl=u.createObject,Mm=u.preventDefault,Yg=u.setImage,Of=u.getImage,Bg=u.isImageComplete,Mq=u.drawCenterImage,Gp=u.drawStretchImage,tq=u.getId,Qi=u.callLater,os=u.cancelLater,Hq=u.sortFunc,Bf=u.clone,Bq=u.getClass,ce=u.startAnim,bf=u.brighter,yi=u.darker,$d=u.drawText,bq=u.getTextSize,ok=u.isLeftButton,Tc=u.isMiddleButton,pi=u.isRightButton,ge=u.getTouchCount,tb=u.isDoubleClick,Ng=u.isShiftDown,ao=u.isCtrlDown,dj=u.getClientPoint,Bc=u.getPagePoint,Kj=u.getDistance,Tg=u.unionPoint,so=u.unionRect,oe=u.containsPoint,hj=u.containsRect,Ii=u.intersectsRect,qs=u.intersection,xg=u.getWindowInfo,nh=u.grow,Xr=u.getLogicalPoint,_h=u.getScreenPoint,ec=u.startDragging,lk=u.removeHTML,We=u.createElement,Gm=u.segmentResolution,Xq=u.shapeResolution,Mg=u.shapeSide,bd=u.def,Mf=function(p,C,A){bd(n+"."+p,C,A)},Yn=function(z,A){z.childNodes.forEach(function(y){A(y),Yn(y,A)})};hf(u,{toolTipLabelColor:ii,toolTipLabelFont:jq,toolTipBackground:p.toolTipBackground,toolTipShadowColor:Jq,debugTipLabelFont:jq,debugTipLabelColor:ii,debugTipBackground:p.toolTipBackground,drawBreakableText:Sf,setDevicePixelRatio:function(g){Fd=u.devicePixelRatio="number"==typeof g?g:oj(C),Yn(G.body,function(w){var Q=w._ht;Q&&Q._canvas&&(Kc(Q._canvas,Q.getWidth(),Q.getHeight()),Q.redraw?Q.redraw():Q.iv())})},getPosition3dGap:function(){return Db()}},!0);var Vh=1e-6,Ro="undefined"!=typeof Uint16Array?Uint16Array:Array,Ki="undefined"!=typeof Float32Array?Float32Array:Array,Ur=function(d,b,A){var v=[d[0]-b[0],d[1]-b[1],d[2]-b[2]];if(A){var D=Kj(v);D>0&&(v[0]/=D,v[1]/=D,v[2]/=D)}return v},Ig=function(){var J="charCodeAt",X=2*(2*Qp.length+1);for(var c in C)if(c===n+sl[0]+(en.length+2)){var M=C[c];if(!M)break;for(var S=M.length,m=0;S>m;m++)if(M[m][J](0)===X&&M[m+1]!=$&&M[m+1]===en[0]&&M[m+2]!=$&&M[m+2][J](0)===X){for(var W=m+3;S>W;W++)if(M[W][J](0)===X){if(0==M[W+1])for(var Q,V=W+2;S>V;V++){if(M[V][J](0)===X){0==M[V-1]&&Q&&($j=Q.substr(0,Q.length-1));break}Q==$?Q=M[V]:Q+=M[V]}break}break}break}return function(d){return[-d[0],-d[1],-d[2]]}}(),Jn=function(T,P){return 3===T.length?T[0]*P[0]+T[1]*P[1]+T[2]*P[2]:T[0]*P[0]+T[1]*P[1]},Kl=function(){var H=new Array(16);return H[0]=1,H[1]=0,H[2]=0,H[3]=0,H[4]=0,H[5]=1,H[6]=0,H[7]=0,H[8]=0,H[9]=0,H[10]=1,H[11]=0,H[12]=0,H[13]=0,H[14]=0,H[15]=1,H},Jd=Kl(),bg=function(v){var P=new Array(16);return P[0]=v[0],P[1]=v[1],P[2]=v[2],P[3]=v[3],P[4]=v[4],P[5]=v[5],P[6]=v[6],P[7]=v[7],P[8]=v[8],P[9]=v[9],P[10]=v[10],P[11]=v[11],P[12]=v[12],P[13]=v[13],P[14]=v[14],P[15]=v[15],P},Gc=function(H,q){return H[0]=q[0],H[1]=q[1],H[2]=q[2],H[3]=q[3],H[4]=q[4],H[5]=q[5],H[6]=q[6],H[7]=q[7],H[8]=q[8],H[9]=q[9],H[10]=q[10],H[11]=q[11],H[12]=q[12],H[13]=q[13],H[14]=q[14],H[15]=q[15],H},Gj=function(R){return R[0]=1,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=1,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=1,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R},Vk=function(u,M){var r=u[0],n=u[1],N=u[2];return u[0]=M[0]*r+M[4]*n+M[8]*N+M[12],u[1]=M[1]*r+M[5]*n+M[9]*N+M[13],u[2]=M[2]*r+M[6]*n+M[10]*N+M[14],u},Zh=function(h,T){var G=h[0],i=h[1],y=h[2],B=h[3];return h[0]=T[0]*G+T[4]*i+T[8]*y+T[12]*B,h[1]=T[1]*G+T[5]*i+T[9]*y+T[13]*B,h[2]=T[2]*G+T[6]*i+T[10]*y+T[14]*B,h[3]=T[3]*G+T[7]*i+T[11]*y+T[15]*B,h},wf=function(){var G,B,m,k,I=kj(zi[1]+zi[7]),U=kj(zi[0]+zi[3]-zi[10]),v=kj(zi[8]+2),Z=function(){return B=m.charAt(G),G+=1,B},K=function(){var H="";if(B===v)for(;Z();){if(B===v)return Z(),H;H+=B}else Z()},j=function(){for(;B&&" ">=B;)Z()},n=function(){var p,P={};if(B===I){if(Z(),j(),B===U)return Z(),P;for(;B;){if(p=K(),j(),Z(),P[p]=k(),j(),B===U)return Z(),P;Z(),j()}}};return k=function(){switch(j(),B){case I:return n();default:return K()}},function(q){if(w={},q){var _;if(m=q,G=0,B=" ",_=k(),j(),!B)return _}}}(),kd=function(K,z){if(z){var j=X(z),O=m(z),G=K[4],Z=K[5],J=K[6],M=K[7],Q=K[8],n=K[9],w=K[10],$=K[11];K[4]=G*O+Q*j,K[5]=Z*O+n*j,K[6]=J*O+w*j,K[7]=M*O+$*j,K[8]=Q*O-G*j,K[9]=n*O-Z*j,K[10]=w*O-J*j,K[11]=$*O-M*j}},ob=function(A,O){if(O){var B=X(O),r=m(O),U=A[0],h=A[1],G=A[2],f=A[3],a=A[8],q=A[9],l=A[10],d=A[11];A[0]=U*r-a*B,A[1]=h*r-q*B,A[2]=G*r-l*B,A[3]=f*r-d*B,A[8]=U*B+a*r,A[9]=h*B+q*r,A[10]=G*B+l*r,A[11]=f*B+d*r}},Eq=function(d,$){if($){var p=X($),J=m($),T=d[0],H=d[1],e=d[2],Q=d[3],S=d[4],R=d[5],i=d[6],n=d[7];d[0]=T*J+S*p,d[1]=H*J+R*p,d[2]=e*J+i*p,d[3]=Q*J+n*p,d[4]=S*J-T*p,d[5]=R*J-H*p,d[6]=i*J-e*p,d[7]=n*J-Q*p}},Zi=function(p,I,x){return Nm($,x===!1?$:p.getFinalScale3d(),p.getFinalRotation3d(),p.getRotationMode(),p.p3(),$,I)},Nm=function(T,A,Z,i,b,L,C){return L||(L=Kl()),b&&Ph(L,b),zh(L,Z,i),C&&fm(L,L,C),A&&bp(L,A),T&&fm(L,L,T),L},Lm=function(Z,B,Y){B=rr(B),Y=rr(Y);var E=this;E.g=Z,E._84O=B,E._85O=Y,E._70I=!0,E.F=0,E._83O=B+Y,E.pen={x:0,y:0}},ho="lineDashOffset",Xl="setLineDash",ll=function(_){for(var v in _)1===v.length&&(ho=_[v]);return v?1:0},$q=function(x,I,L){return dk(I)?x:x[Xl]?(x[Xl](I),L&&(x.lineDashOffset=L),x):new Lm(x,I[0],I.length>1?I[1]:I[0])},Je=function(Z,p){!dk(p)&&Z[Xl]&&(Z[Xl](Bj),Z.lineDashOffset=0)};bd(Lm,b,{_69I:6,moveTo:function(J,B){var U=this,V=U.pen;V.x=J,V.y=B,U.g.moveTo(J,B),U.start||(U.start={x:J,y:B})},lineTo:function(B,r){var o=this,z=o.pen,v=B-z.x,n=r-z.y,w=ys(n,v),q=m(w),L=X(w),P=o._23O(z.x,z.y,B,r),d=o._85O,O=o._84O,$=o._83O;if(o.F){if(o.F>P)return o._70I?o._72I(B,r):o.moveTo(B,r),o.F-=P,void 0;if(o._70I?o._72I(z.x+q*o.F,z.y+L*o.F):o.moveTo(z.x+q*o.F,z.y+L*o.F),P-=o.F,o.F=0,o._70I=!o._70I,!P)return}var W=M(P/$);if(W){for(var c=q*O,F=L*O,Q=q*d,t=L*d,p=0;W>p;p++)o._70I?(o._72I(z.x+c,z.y+F),o.moveTo(z.x+Q,z.y+t)):(o.moveTo(z.x+Q,z.y+t),o._72I(z.x+c,z.y+F));P-=$*W}o._70I?P>O?(o._72I(z.x+q*O,z.y+L*O),o.moveTo(B,r),o.F=d-(P-O),o._70I=!1):(o._72I(B,r),P===O?(o.F=0,o._70I=!o._70I):(o.F=O-P,o.moveTo(B,r))):P>d?(o.moveTo(z.x+q*d,z.y+L*d),o._72I(B,r),o.F=O-(P-d),o._70I=!0):(o.moveTo(B,r),P===d?(o.F=0,o._70I=!o._70I):o.F=d-P)},quadraticCurveTo:function(f,y,j,R){var b,$=this,h=$.pen,s=h.x,e=h.y,T=$._22O(s,e,f,y,j,R),W=0,Y=0,Q=$._85O,H=$._84O;if($.F){if($.F>T)return $._70I?$._71I(f,y,j,R):$.moveTo(j,R),$.F-=T,void 0;if(W=$.F/T,b=$._20O(s,e,f,y,j,R,W),$._70I?$._71I(b[2],b[3],b[4],b[5]):$.moveTo(b[4],b[5]),$.F=0,$._70I=!$._70I,!T)return}var t=T-T*W,p=M(t/$._83O),k=H/T,S=Q/T;if(p)for(var n=0;p>n;n++)$._70I?(Y=W+k,b=$._21O(s,e,f,y,j,R,W,Y),$._71I(b[2],b[3],b[4],b[5]),W=Y,Y=W+S,b=$._21O(s,e,f,y,j,R,W,Y),$.moveTo(b[4],b[5])):(Y=W+S,b=$._21O(s,e,f,y,j,R,W,Y),$.moveTo(b[4],b[5]),W=Y,Y=W+k,b=$._21O(s,e,f,y,j,R,W,Y),$._71I(b[2],b[3],b[4],b[5])),W=Y;t=T-T*W,$._70I?t>H?(Y=W+k,b=$._21O(s,e,f,y,j,R,W,Y),$._71I(b[2],b[3],b[4],b[5]),$.moveTo(j,R),$.F=Q-(t-H),$._70I=!1):(b=$._19O(s,e,f,y,j,R,W),$._71I(b[2],b[3],b[4],b[5]),T===H?($.F=0,$._70I=!$._70I):($.F=H-t,$.moveTo(j,R))):t>Q?(Y=W+S,b=$._21O(s,e,f,y,j,R,W,Y),$.moveTo(b[4],b[5]),b=$._19O(s,e,f,y,j,R,Y),$._71I(b[2],b[3],b[4],b[5]),$.F=H-(t-Q),$._70I=!0):($.moveTo(j,R),t===Q?($.F=0,$._70I=!$._70I):$.F=Q-t)},bezierCurveTo:function(){var C=arguments;this.pen={x:C[4],y:C[5]},this.g.bezierCurveTo(C[0],C[1],C[2],C[3],C[4],C[5])},arc:function(I,K,e,r,O,L){L||(r=-r,O=-O),Hi(this,I,K,r,O-r,e,e,!1)},rect:function(P,R,S,M){var x=this;x.pen={x:P,y:R},x.moveTo(P,R),x.lineTo(P,R+M),x.lineTo(P+S,R+M),x.lineTo(P+S,R),x.lineTo(P,R)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(f,K,d,z){var j=d-f,$=z-K;return _(j*j+$*$)},_22O:function(p,I,c,r,T,C,n){for(var H,m,$,l,A,E,R,Y=0,g=p,i=I,q=n>0?n:this._69I,e=1;q>=e;e++)$=e/q,l=1-$,A=l*l,E=2*$*l,R=$*$,H=A*p+E*c+R*T,m=A*I+E*r+R*C,Y+=this._23O(g,i,H,m),g=H,i=m;return Y},_21O:function(d,H,V,q,h,i,C,L){var _=this;if(0===C)return _._20O(d,H,V,q,h,i,L);if(1===L)return _._19O(d,H,V,q,h,i,C);var B=_._20O(d,H,V,q,h,i,L);return B.push(C/L),_._19O.apply(_,B)},_20O:function(y,$,Z,w,o,r,E){if(1!==E){var z=Z+(o-Z)*E,N=w+(r-w)*E;Z=y+(Z-y)*E,w=$+(w-$)*E,o=Z+(z-Z)*E,r=w+(N-w)*E}return[y,$,Z,w,o,r]},_19O:function(E,J,r,A,t,L,I){if(1!==I){var P=E+(r-E)*I,j=J+(A-J)*I;r+=(t-r)*I,A+=(L-A)*I,E=P+(r-P)*I,J=j+(A-j)*I}return[E,J,r,A,t,L]},_72I:function(i,T){var O=this.pen;(i!==O.x||T!==O.y)&&(O.x=i,O.y=T,this.g.lineTo(i,T))},_71I:function(D,f,J,z){var B=this.pen;(D!==J||f!==z||J!==B.x||z!==B.y)&&(B.x=J,B.y=z,this.g.quadraticCurveTo(D,f,J,z))}}),Wi.ms_quickVisible=function(V){V._4BQ=!1,V._4CQ=function(E){var h=E._4EQ;return h!==r?h:h=E._4EQ=this._4FQ(E)},V._4DQ=function(Q){if(!Q)return this.dm().each(function(P){P._4EQ=r}),void 0;Q._4EQ=r;var j=this;if(Q instanceof el||db(Q)||Q instanceof Cd||Q.ISubGraph)Q.eachChild(function(f){j.invalidateQuickVisible(f)});else if(Q.getEdges){var B=Q.getEdges();B&&B.each(function(P){j.invalidateQuickVisible(P)})}},V.enableQuickVisibleMode=function(){this._4BQ||(this._4BQ=!0,this._4FQ=this.isVisible,this.isVisible=this._4CQ,this.invalidateQuickVisible=this._4DQ)},V.disableQuickVisibleMode=function(){this._4BQ&&(this._4BQ=!1,this.isVisible=this._4FQ,this.invalidateQuickVisible=rg)},V.isQuickVisibleMode=function(){return this._4BQ},V.invalidateQuickVisible=rg},xb=Fi()+1,wn&&C.console&&xb&&!1&&(C.navigator&&C.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?C.console.log.apply(console,["Hightopo - Version："+A.Default.getVersion()+" - %cTrial：http://hightopo.com/request.html","color: #f00;"]):C.console.log("Hightopo - Version："+A.Default.getVersion()+" - Trial：http://hightopo.com/request.html"));var mi=$,Og=$,_f=u.checkLoadingCompType=function(o){mi&&!o._72O_&&(Og||(Og={}),Og[o._72O_=tq()]=o)},vc=function(O,_){if(_||(_=O),_&&(mi||(mi={}),!mi[O])){var U=new uk;if(mi[_]={request:U,url:_},_=u.beforeLoadURL(_,O),_.data){var c=u.parse(_.data);Oi(O,c),u.handleCompTypeLoaded(O,c)}else{U.onload=function(){if(200===this.status||0===this.status){var f=u.parse(U.getResponseText());Oi(O,f),u.handleCompTypeLoaded(O,f)}else Oi(O,$)},U.onerror=function(){Oi(O,$)};var F={};F.url=encodeURI(_),F.sync=!1,U.send(F)}}},Oi=function(z,Q){if(Gl[z]=Q,delete mi[z],Rd(mi)&&(mi=$,Og)){for(var l in Og){var S=Og[l];S.invalidateAll&&S.invalidateAll(r,"compTypeLoaded",z),S.redraw&&S.redraw(),S.iv(),delete S._72O_}Og=$}if(Q&&Og)for(var l in Og){var S=Og[l];S.invalidateAll&&S.invalidateAll(r,"compTypeLoading",z),S.redraw&&S.redraw(),S.iv()}},ws=p.chart,rd="",yb=!0,Qo=u.compStack=[],Pq=/^style@/,Kk=/^attr@/,hn=/^field@/,_m={x:.5,y:.5},Xk=function(){yb=!0},po=function(){return yb},nc=function(B,w,V){if(!B)return!1;var h;return V&&V.isImageFitSize&&(h=V.isImageFitSize(w,B)),h==$&&(h=Tp(B.fitSize,w,V)),h},Hn=function(O,R,w,e){if(!O)return 0;if(nc(O,R,w)&&e)return e;var o=Tp(O.width,R,w);return null==o?20:o},ks=function(x,U,$,K){if(!x)return 0;if(nc(x,U,$)&&K)return K;var p=Tp(x.height,U,$);return null==p?20:p},Tp=function(N,f,H){if(!N||!N.func)return N;var d,O=N.func,l=N.value;return d=Xp(O)?H&&H.vectorDataBindingDisabled&&!N.isSafeFunc?l:O(f,H):f instanceof $h||(A.ui?f instanceof A.ui.View:0)?Kk.test(O)?f.a(rd+O.slice(5)):Pq.test(O)?f.s(rd+O.slice(6)):hn.test(O)?f[O.slice(6)]:f[O]?f[O](H):l:l,l!==r&&d==$?l:d},zm=u.drawImage=function(){var b,v,Y,j,_,z,n=3,M=6,I=function(Y,h){Y.getValue&&Y.getValue.compType===h||(Y.getValue=function(I){var R=J(Y,I);if(R===r&&h.properties){var p=h.properties[I];p&&(R=p.defaultValue)}return R},Y.getColor=function(K,g){return g===!0?s(K):s(Y.getValue(K))},Y.getValue.compType=h)},J=function(Z,k,f){var W,u=!1;if(Z.prefix&&v instanceof $h){var J=v.a(rd+k);J!==r&&(u=!0,W=J)}return W===r&&(W=Z[k]),W&&W.func&&(u=!0,W=Tp(W,v,Y)),f&&(W=f(W),u||(Z[k]=W)),W},s=function(G,M){var X;return X=M?J(G,M):G,b&&b.compGray&&X?u.toGrayColor(X):_&&X?Dh(X,_,z):X},t=function(N){if(Zf(N)){for(var q=new Od,s=N.length,n=0;s>n;n+=2)q.add({x:N[n],y:N[n+1]});N=q}return N},y=function(x){var p=J(x,"anchorX"),F=J(x,"anchorY");if(p!==r||F!==r)return{x:p===r?_m.x:p,y:F===r?_m.y:F};var L=J(x,"type"),d=J(x,"name");if("image"!==L||!d)return _m;var l=Of(d);return l&&l.anchorX!==r&&l.anchorY!==r?{x:l.anchorX,y:l.anchorY}:_m},F=function(N,Y){var T=J(N,Ne),L=y(N);if(Zf(T)){var V=T.length,H=J(N,"relative"),f=Y.width,b=Y.height;if(4===V)T={x:T[0],y:T[1],width:T[2],height:T[3]},H&&(T.x*=f,T.y*=b,T.width*=f,T.height*=b);else if(3===V){var j=T[0];T={width:T[1],height:T[2]},H&&(T.width*=f,T.height*=b),"object"==typeof j?j.length&&(j={x:j[0],y:j[1]}):j=wi(j,Y,T),T.x=j.x-T.width*L.x,T.y=j.y-T.height*L.y}T.x+=J(N,"offsetX")||0,T.y+=J(N,"offsetY")||0,!H&&Y.fitSize&&(T=o(N,T,Y))}return T},o=function(z,h,T){if(h){var k,C,O,S={x:h.x,y:h.y,width:h.width,height:h.height},u=y(z),v=J(z,"layoutH"),Z=J(z,"layoutV"),D=1,W=1,H=0,t=0,Q=1,d=1;switch(v){case"left":break;case"right":S.x+=T.width-T.rw;break;case"center":S.x+=.5*(T.width-T.rw);break;case"scale":case"leftright":default:k=J(z,jl)||0,k&&(H=Math.abs(t=Math.sin(k)),Q=Math.abs(d=Math.cos(k))),"leftright"!==v?(D+=Q*(T.widthScale-1),W+=H*(T.widthScale-1)):(D+=S.width?Q*(T.width-T.rw)/S.width:0,W+=S.height?H*(T.width-T.rw)/S.height:0,C=-Math.min(-u.x*d+u.y*t,-u.x*d-(1-u.y)*t,(1-u.x)*d+u.y*t,(1-u.x)*d-(1-u.y)*t))}switch(Z){case"top":break;case"bottom":S.y+=T.height-T.rh;break;case"center":S.y+=.5*(T.height-T.rh);break;case"scale":case"topbottom":default:k==$&&(k=J(z,jl),k&&(H=Math.abs(t=Math.sin(k)),Q=Math.abs(d=Math.cos(k)))),"topbottom"!==Z?(D+=H*(T.heightScale-1),W+=Q*(T.heightScale-1)):(D+=S.width?H*(T.height-T.rh)/S.width:0,W+=S.height?Q*(T.height-T.rh)/S.height:0,O=-Math.min(-u.x*t-u.y*d,-u.x*t+(1-u.y)*d,(1-u.x)*t-u.y*d,(1-u.x)*t+(1-u.y)*d))}return(1!==D||1!==W)&&("scale"!==v&&v?"leftright"===v&&(S.x+=S.width*(1-D)*u.x+C*(T.width-T.rw)):S.x+=S.x*(T.widthScale-1)+u.x*S.width*(T.widthScale-D),"scale"!==Z&&Z?"topbottom"===Z&&(S.y+=S.height*(1-W)*u.y+O*(T.height-T.rh)):S.y+=S.y*(T.heightScale-1)+u.y*S.height*(T.heightScale-W),S.width*=D,S.height*=W),S.width<0&&(S.width=0),S.height<0&&(S.height=0),S}},T=function(s){return Zf(s)?new Od(s):s},k=function(K,P,N,v,n,O,z){var d=b.interactiveInfo,F=K.transform;if(F)return b.save(),b.setTransform(F.a,F.b,F.c,F.d,F.tx,F.ty),d&&d.compInfos.push({comp:K,rect:P,matrix:F.clone(),prefix:rd,refRect:d.refRect}),!0;n===r&&(n=1),O===r&&(O=1);var w=J(K,"clipPercentage"),Z=co(N,P);if(Z&&!v&&1===n&&1===O&&w==r)return d&&d.compInfos.push({comp:K,rect:P,matrix:d.matrix.clone(),prefix:rd,refRect:d.refRect}),!1;z=z||_m;var S=P.x+P.width*z.x,i=P.y+P.height*z.y,U=N.x+N.width*z.x,R=N.y+N.height*z.y,M=N.width?n*(P.width/N.width):1,B=N.height?O*(P.height/N.height):1;if(b.save(),d&&(d.matrix.appendTranslate(S,i).appendRotate(v).appendScale(M,B).appendTranslate(-U,-R),d.compInfos.push({comp:K,rect:P,matrix:d.matrix.clone(),prefix:rd,refRect:d.refRect})),Ge(b,S,i),zo(b,v||0),Ol(b,M,B),Ge(b,-U,-R),w!=r){var m=Pc(N,J(K,"clipDirection"),w);b.beginPath(),b.rect(m.x,m.y,m.width,m.height),b.clip()}return!0},f=function(){b.restore()},D=function(B,q,w){var S=J(B,"path"),E=J(B,jl),Q=J(B,"scaleX"),l=J(B,"scaleY"),o=y(B),t=$,D=rf(null,S);if(w||(w=B.unionRect,w||(w=Tg(D),B.path.func||(B.unionRect=w)),t=w),w){t||(t=B.unionRect,t||(t=Tg(D),B.path.func||(B.unionRect=t)));var G=k(B,w,t,E,Q,l,o),X=J(B,"borderPattern"),c=$q(b,X),x=s(B,"background"),z=s(B,"borderColor"),h=J(B,"borderWidth"),e=J(B,"gradient"),T=s(B,"gradientColor"),U=J(B,"border3d"),d=s(B,"border3dColor"),A=J(B,"border3dAccuracy"),M=b.lineJoin,O=b.lineCap;b.lineJoin=J(B,"borderJoin")||hg,b.lineCap=J(B,"borderCap")||ng,x?(jd(b,x,e,T,t),rf(b,S),b.fill(),c!==b&&rf(b,S)):rf(b,S);var _=J(B,"borderWidthAbsolute");if(_&&(b.save(),b.setTransform(1,0,0,1,0,0)),h&&z&&(b.lineWidth=h,b.strokeStyle=z,b.stroke(),U&&$o(b,z,d,h,j,A)),Je(b,X),J(B,"dash")){var r=J(B,"dashWidth")||h;if(r>0){X=J(B,"dashPattern")||Oj;var c=$q(b,X,J(B,"dashOffset")),Z=s(B,"dashColor")||s(uq);c!==b&&rf(b,S),b.strokeStyle=Z,b.lineWidth=r,b.stroke(),J(B,"dash3d")&&$o(b,Z,s(B,"dash3dColor"),r,j,J(B,"dash3dAccuracy")),Je(b,X)}}_&&b.restore(),q===Ne&&Up(b,x,J(B,"depth"),t),b.lineJoin=M,b.lineCap=O,G&&f()}},B=function(R,K,h,F){var g=J(R,no,t),C=J(R,jl),l=y(R);if(g&&F.fitSize){var x=new Od,E=Tg(g),q=o(R,E,F),e=E.x+l.x*E.width,X=E.y+l.y*E.height,V=q.x+l.x*q.width,O=q.y+l.y*q.height,P=E.width?q.width/E.width:1,n=E.height?q.height/E.height:1;g.each(function(k){x.add({x:V+(k.x-e)*P,y:O+(k.y-X)*n})}),g=x,R.unionRect=null}var W=J(R,"scaleX"),S=J(R,"scaleY"),i=K===Rr,u=$;if(!h&&i&&(h=R.unionRect,h||(h=Tg(g),R.points.func||(R.unionRect=h)),u=h),h){i?u||(u=R.unionRect,u||(u=Tg(g),R.points.func||(R.unionRect=u))):u=h;var G,U,Q,Z,L=k(R,h,u,C,W,S,l),p=J(R,"borderPattern"),A=$q(b,p),M=s(R,"background"),a=Of(J(R,"repeatImage"),_,z),I=J(R,"gradientPack"),w=J(R,"borderGradientPack"),N=s(R,"borderColor"),D=J(R,"borderWidth"),m=Of(J(R,"borderRepeatImage"),_,z),d=J(R,"segments",T),H=J(R,"gradient"),B=s(R,"gradientColor"),c=J(R,"border3d"),gg=s(R,"border3dColor"),nj=J(R,"border3dAccuracy"),jq=J(R,"closePath"),Lb=J(R,"fillRule")||"nonzero",Kk=b.lineJoin,wr=b.lineCap;if(b.lineJoin=J(R,"borderJoin")||hg,b.lineCap=J(R,"borderCap")||ng,i)if(M||a||I){var dm=J(R,"fillClipPercentage");if(dm!=r){var Bi=Pc(u,J(R,"fillClipDirection"),dm);b.save(),b.beginPath(),b.rect(Bi.x,Bi.y,Bi.width,Bi.height),b.clip()}gr(b,g,d,jq),I?kn(b,I,s,!1,h):a?Ah(b,a,_,z,v,Y):jd(b,M,H,B,u),b.fill(Lb),I&&b.restore(),dm!=r&&b.restore(),A!==b&&gr(A,g,d,jq)}else gr(A,g,d,jq);else if("roundRect"===K?G=J(R,"cornerRadius"):"polygon"===K?(G=J(R,"polygonSide"),U=J(R,"cornerRadius"),Q=J(R,"regular")):"arc"===K&&(G=J(R,"arcFrom"),U=J(R,"arcTo"),Q=J(R,"arcClose"),Z=J(R,"arcOval")),M||a||I){var dm=J(R,"fillClipPercentage");if(dm!=r){var Bi=Pc(u,J(R,"fillClipDirection"),dm);b.save(),b.beginPath(),b.rect(Bi.x,Bi.y,Bi.width,Bi.height),b.clip()}hi(b,K,u,G,U,Q,Z),I?kn(b,I,s,!1,h):a?Ah(b,a,_,z,v,Y):jd(b,M,H,B,u),b.fill(Lb),I&&b.restore(),dm!=r&&b.restore(),b!==A&&hi(A,K,u,G,U,Q,Z)}else hi(A,K,u,G,U,Q,Z);var Gj=J(R,"borderWidthAbsolute");if(Gj&&(b.save(),b.setTransform(1,0,0,1,0,0)),D&&(N||m||w)&&(b.lineWidth=D,w?kn(b,w,s,!0,h):m?ef(b,m,_,z,v,Y):b.strokeStyle=N,b.stroke(),w&&b.restore(),c&&$o(b,N,gg,D,j,nj)),Je(b,p),J(R,"dash")){var iq=J(R,"dashWidth")||D;if(iq>0){p=J(R,"dashPattern")||Oj;var A=$q(b,p,J(R,"dashOffset")),yk=s(R,"dashColor")||s(uq);A!==b&&(i?gr(A,g,d,jq):hi(A,K,u,G,U,Q,Z)),b.strokeStyle=yk,b.lineWidth=iq,b.stroke(),J(R,"dash3d")&&$o(b,yk,s(R,"dash3dColor"),iq,j,J(R,"dash3dAccuracy")),Je(b,p)}}Gj&&b.restore(),K===Ne&&Up(b,M,J(R,"depth"),u),b.lineJoin=Kk,b.lineCap=wr,L&&f()}},c=function(Z,c){var s=_||J(Z,pq),r=z||J(Z,"blendMode"),T=J(Z,"name"),e=Of(T,s,r);e&&e.cacheRule!=$&&(e=tl(b,e,J(Z,"stretch"),c.width,c.height,v,Y,s)),e?Gp(b,e,J(Z,"stretch"),c.x,c.y,c.width,c.height,v,Y,s,null,r):yb=!1},i=function(G,m){var q=J(G,"text");if(q!=$){q+="";var f,D=J(G,"gradientPack"),w=J(G,"gradient"),S=s(G,"gradientColor"),x=J(G,"font"),K=J(G,"vertical"),M=J(G,"verticalGap")||0,j=J(G,"align"),H=J(G,"vAlign"),T=J(G,"decoration"),Y=J(G,"letterGap")||0,O=J(G,"wrap"),V=J(G,"borderWidth"),c=J(G,"borderColor"),P=bq(x,q);if(D?(f=kn(b,D,s,!1,m),b.restore()):f=s(G,pq),!D&&w&&(f=u.createGradient(b,w,f||u.labelColor,S||p.imageGradient,m.x,m.y,m.width,m.height)),V&&Zf(c)&&(c=kn(b,c,s,!1,m),b.restore()),K){null==M&&(M=1);var Q,W,z,g=[],_=[];Q=O?bn(q,m.height,x,Y,K,M):[q],b.textBaseline=Yd,b.font=x,Q.forEach(function(e){for(var z=e.length,n=0,N=(z-1)*M,X=0;z>X;X++){var l=b.measureText(e[X]);g.push(l),N+=l.fontBoundingBoxDescent||P.height,n=E(n,l.width)}_.push({width:n,height:N})});var R=(Q.length-1)*Y;_.forEach(function(P){R+=P.width}),W=j&&j!==sl?j===vp?m.x+m.width-R:m.x+(m.width-R)/2:m.x;var n=0;Q.forEach(function(N,u){var O=_[u],F=N.length;z=H&&H!==we?H===Yd?m.y:m.y+m.height-O.height:m.y+(m.height-O.height)/2;for(var w=0;F>w;w++){var y=N[w],Q=g[n],B=Q.fontBoundingBoxDescent||P.height;Hd(b,y,x,f,{x:W,y:z,width:O.width,height:B},eo,H,T,Y,V,c),z+=B+M,n++}W+=O.width+Y})}else{var Q=O?bn(q,m.width,x,Y,K,M):q.split("\n"),L=Q.length;if(L>1){var e=bq(x,q),U=e.height,h=L*U+M*(L-1),C=Bf(m);return H&&H!==we?H===gg&&(C.y=m.y+m.height-h):C.y=m.y+(m.height-h)/2,C.height=h,Sf(b,Q,C,x,f,j||sl,T,Y,V,c),void 0}Hd(b,q,x,f,m,j,H,T,Y,V,c)}}},S=function(W,H){cc(b,s(W,pq),H.x,H.y,H.width,H.height,J(W,"width"))},Q=function(r,d){var Y=J(r,kb),K=0;if(Y&&(Y.forEach(function(I){K+=I}),K>0)){for(var Q=J(r,"colors")||ws,V=J(r,"startAngle")||0,l=J(r,"hollow"),w=J(r,Ni),e=J(r,nl),x=J(r,Mk),y=w?new Od:$,c=d.x,h=d.y,W=d.width,s=d.height,G=c+W/2,P=h+s/2,I=O(W,s)/2,q=0,_=0;_<Y.length;_++){var u=Y[_],S=g*u/K,n=V+S;if(b.fillStyle=Q[q++],q===Q.length&&(q=0),b.beginPath(),l){var j=G+m(V)*I/2,k=P+X(V)*I/2,i=G+m(n)*I,N=P+X(n)*I;b.moveTo(j,k),b.arc(G,P,I/2,V,n,!1),b.lineTo(i,N),b.arc(G,P,I,n,V,!0)}else b.moveTo(G,P),b.arc(G,P,I,n,V,!0);y&&(S=(V+n)/2,y.add({text:Xp(w)?w(u,_,K,v):u,x:G+.75*m(S)*I,y:P+.75*X(S)*I})),b.closePath(),b.fill(),V=n}y&&y.each(function(o){$d(b,o.text,e,x,o.x,o.y,0,0,eo)})}},h=function(P,S){var W=J(P,rj);if(W&&W.length>0){var w=W.length,D=J(P,Ni),h=J(P,nl),K=J(P,Mk),V=D?new Od:$,c=J(P,"minValue")||0,o=J(P,"maxValue");if(o==$&&(o=0,W.forEach(function(M){J(M,kb).forEach(function(m){o=E(o,m)})})),c===o)return;for(var R=S.height/(o-c),u=S.y+o*R,k=J(W[0],kb).length,f=S.width/(3*k+1),U=2*f/w,X=0,C=0;w>C;C++)for(var N=W[C],F=J(N,pq),y=J(N,"colors"),z=J(N,kb),m=0;k>m;m++){y?b.fillStyle=y[m]:F?b.fillStyle=F:(b.fillStyle=ws[X++],X===ws.length&&(X=0));var B=z[m],O=B*R,r=S.x+(1+3*m)*f+C*U;if(Dc(b,r,u-O,U,O),V){var j=Xp(D)?D(B,m,N,v):B,d=bq(h,j).height;V.add({x:r,y:u-O-d,width:U,height:d,text:j})}}V&&V.each(function(I){$d(b,I.text,h,K,I.x,I.y,I.width,I.height,eo)})}},W=function(L,x){var U=J(L,rj);if(U&&U.length>0){var K=U.length,D=J(U[0],kb).length,l=x.width/(3*D+1),j=0,R=J(L,"maxValue"),W=J(L,Ni),M=J(L,nl),X=J(L,Mk),m=W?new Od:$;if(R==$){R=0;for(var t=0;D>t;t++){for(var u=0,c=0;K>c;c++)u+=J(U[c],kb)[t];R=E(R,u)}}if(R>0){for(var t=0;D>t;t++)for(var O=x.y+x.height,c=0;K>c;c++){var a=U[c],h=J(a,pq),g=J(a,kb)[t],A=g/R*x.height;h?b.fillStyle=h:(b.fillStyle=ws[j++],j===ws.length&&(j=0)),O-=A;var S={x:x.x+(1+3*t)*l,y:O,width:2*l,height:A};Dc(b,S.x,S.y,S.width,S.height),m&&(S.text=Xp(W)?W(g,t,a,v):g,m.add(S))}m&&m.each(function(l){$d(b,l.text,M,X,l.x,l.y,l.width,l.height,eo)})}}},R=function(S,A){var x=J(S,rj);if(x&&x.length>0){for(var D=x.length,i=J(x[0],kb).length,r=A.width/(3*i+1),U=0,R=J(S,Ni),c=J(S,nl),e=J(S,Mk),y=R?new Od:$,Y=0;i>Y;Y++){for(var o=0,f=0;D>f;f++)o+=J(x[f],kb)[Y];if(o>0){var q=A.y+A.height;for(f=0;D>f;f++){var s=x[f],H=J(s,pq),u=J(s,kb)[Y],W=u/o*A.height;H?b.fillStyle=H:(b.fillStyle=ws[U++],U===ws.length&&(U=0)),q-=W;var t={x:A.x+(1+3*Y)*r,y:q,width:2*r,height:W};Dc(b,t.x,t.y,t.width,t.height),y&&(t.text=Xp(R)?R(u,Y,s,v):u,y.add(t))}}}y&&y.each(function(g){$d(b,g.text,c,e,g.x,g.y,g.width,g.height,eo)})}},H=function(P,U){var k=J(P,rj);if(k&&k.length>0){var u=k.length,n=J(P,"minValue")||0,G=J(P,"maxValue");if(G==$&&(G=0,k.forEach(function(a){J(a,kb).forEach(function(s){G=E(G,s)})})),n===G)return;for(var I=U.height/(G-n),A=U.y+G*I,C=J(k[0],kb).length,x=U.width/(3*C+1),c=0,K=J(P,"lineWidth")||2,h=J(P,"line3d"),e=J(P,"linePoint"),a=J(P,Ni),Q=J(P,nl),S=J(P,Mk),O=0;u>O;O++){var D=k[O],m=J(D,pq),w=J(D,kb);m?b.strokeStyle=m:(m=b.strokeStyle=ws[c++],c===ws.length&&(c=0)),b.beginPath();for(var H=0;C>H;H++){var M=U.x+(2+3*H)*x,L=A-w[H]*I;0===H?b.moveTo(M,L):b.lineTo(M,L)}if(b.lineWidth=K,b.stroke(),h&&$o(b,m,$,K,j),e||a){var R,V=K/2+2;for(H=0;C>H;H++){var X=w[H];if(M=U.x+(2+3*H)*x,L=A-X*I,Xp(e)?e(b,M,L,m,H,D,v):e&&(b.fillStyle=m,b.beginPath(),b.arc(M,L,V,0,g,!0),b.fill()),Xp(a)?R=a(X,H,D,v):a&&(R=X),R){var z=bq(Q,R).height,Y=b.shadowBlur;
if(Y){var d=b.shadowOffsetX,y=b.shadowOffsetY,i=b.shadowColor;b.shadowOffsetX=0,b.shadowOffsetY=0,b.shadowBlur=0,b.shadowColor=$}$d(b,R,Q,S,M,L-z-V+2,0,z,eo),Y&&(b.shadowOffsetX=d,b.shadowOffsetY=y,b.shadowBlur=Y,b.shadowColor=i)}}}}}},U=function(N){b=N[0],v=N[1],Y=N[2],j=N[3],_=N[4],z=N[5]},l=function(){return[b,v,Y,j,_,z]},G=function(K,G){var T;Y&&Y.getDrawableState?T=Y.getDrawableState(v):Y&&Y.getState?T=Y.getState(v):(T=v instanceof $h?v.s(Nc):null,(T===r||null===T)&&(T=J(K,Nc)));var q=J(G,Nc);return q!==r&&null!==q&&q!==T?!1:J(G,uo)},K={border:S,image:c,text:i,pieChart:Q,columnChart:h,stackedColumnChart:W,percentageColumnChart:R,lineChart:H};return function(o,P,c,E,X,d,L,w,q,N){if(P&&X&&d){var x=l();b=o,v=L,Y=w,!v&&Y&&Y.isSelfViewEvent&&(v=Y),j=Y?Y._zoom?Y._zoom:1:1,_=q,z=N;var Q=X,h=d;if(or()){var O,p,a,i,H,R;0===b[lg]?or[0]&&(O=!0):O=!0,b.texureImage2D?or[1]&&(p=!0):p=!0,b.texureImage3D?or[2]&&(a=!0):a=!0,b.drawDNDState?or[3]&&(H=!0):H=!0,A[me[1]+mh[0]+uf[1]]?or[mh[0]]&&(R=!0):R=!0,Im.widget[0]?or[4]&&(i=!0):i=!0,O&&p&&a&&i&&H&&R&&(Q=c,h=E)}if(P.tagName)return ph($j)&&!C[$j]||b.drawImage(P,Q,h,X,d),U(x),void 0;if(0==J(P,"visible"))return U(x),void 0;_||(_=Tp(P.color,v,Y)),N||(z=Tp(P.blendMode,v,Y)),ph($j)&&!C[$j]&&(X=Q,d=h);var m=Hn(P,v,Y,X),g=ks(P,v,Y,d),e={x:0,y:0,width:m,height:g,fitSize:nc(P,v,Y)},W=J(P,"clip"),V=J(P,"opacity");if(e.fitSize){var S=e.rw=Tp(P.width,v,Y)||20;e.widthScale=m/S;var Z=e.rh=Tp(P.height,v,Y)||20;e.heightScale=g/Z}if(b.save(),b.interactiveInfo){var yr=b.interactiveInfo.matrix,Vm=yr.clone();yr.appendTranslate(Q,h).appendScale(X/m,d/g),b.interactiveInfo.refRect=e}Ge(b,Q,h),(m!==X||g!==d)&&b.scale(X/m,d/g),W&&(Xp(W)?W(b,m,g,v,Y,P):(b.beginPath(),b.rect(0,0,m,g),b.clip())),V!=$&&(b.globalAlpha*=V),J(P,"comps").forEach(function(R){if(R.prefix){var S=rd,Q=Tp(R.prefix,v,Y);Q&&(rd=rd+Q+".")}if(0==G(P,R))return R.prefix&&(rd=S),void 0;if(Qo.splice(0,0,R),b.interactiveInfo)var q=b.interactiveInfo.matrix.clone();var h=J(R,"opacity"),Z=J(R,"shadow"),_=J(R,"type"),X=J(R,"refRect")||e,z=F(R,X);if(h!=$){var U=b.globalAlpha;b.globalAlpha*=h}if(Z){var O=j*u.devicePixelRatio,w=b.shadowOffsetX,p=b.shadowOffsetY,m=b.shadowBlur,C=b.shadowColor,c=J(R,"shadowOffsetX"),x=J(R,"shadowOffsetY"),i=J(R,"shadowBlur"),l=s(R,"shadowColor");b.shadowOffsetX=(c==$?n:c)*O,b.shadowOffsetY=(x==$?n:x)*O,b.shadowBlur=(i==$?M:i)*O,b.shadowColor=l||s(qo)}if("save"===_)b.save();else if("endClip"===_||"restore"===_)b.restore();else if("clip"===_)b.save(),gr(b,J(R,"points",t),J(R,"segments",T),!0),b.clip();else if(bj[_]){if(z=z||{x:0,y:0,width:X.width,height:X.height},B(R,_,z,X),R.prefix&&0===R.prefix.indexOf("ui.")&&Y&&A.ui&&Y instanceof A.ui.View){Y._vectorCompInfo||(Y._vectorCompInfo=[]);for(var E=!1,o=0;o<Y._vectorCompInfo.length;o++){var d=Y._vectorCompInfo[o];if(R.prefix===d.comp.prefix&&L===d.data){Y._vectorCompInfo[o]={comp:R,type:_,rect:z,compRefRect:X,data:L,image:P,transform:b.getTransform()},E=!0;break}}E||Y._vectorCompInfo.push({comp:R,type:_,rect:z,compRefRect:X,data:L,image:P,transform:b.getTransform()})}}else if(_===Rr)B(R,_,z,X);else if("SVGPath"===_)D(R,_,z);else{z=z||{x:0,y:0,width:X.width,height:X.height};var g=J(R,jl),a=J(R,"scaleX"),N=J(R,"scaleY"),W=y(R),V=k(R,z,z,g,a,N,W);if(Xp(_))I(R,_),u.drawCompType(_,b,z,R,v,Y);else if(u.getCompType(_)){var H=u.getCompType(_),Lf=H.func||H;I(R,H),u.drawCompType(Lf,b,z,R,v,Y)}else K[_]?K[_](R,z):u.getCompType(_)===r&&Dj.test(_)&&(vc(_),yb=!1);V&&f()}Z&&(b.shadowOffsetX=w,b.shadowOffsetY=p,b.shadowBlur=m,b.shadowColor=C),h!=$&&(b.globalAlpha=U),b.interactiveInfo&&(b.interactiveInfo.matrix=q),R.prefix&&(rd=S),Qo.splice(0,1)}),b.interactiveInfo&&(b.interactiveInfo.matrix=Vm),b.restore(),U(x)}}}();u.getCurrentComp=function(){return Qo[0]},u.getParentComp=function(){return Qo[1]},u.getInternal=function(){return{isEnter:Yc,isEsc:$c,isSpace:An,isLeft:$b,isUp:Wc,isRight:mr,isDown:Td,addMethod:hf,superCall:ud,toPointsArray:Mp,translateAndScale:Tj,appendArray:di,createWorldMatrix:Nm,vec3TransformMat4:Vk,setCanvas:Kc,createDiv:Ic,createView:Ar,createCanvas:qc,createImage:$l,initContext:te,layout:Zg,fillRect:Dc,Mat:nb,drawBorder:cc,isString:ph,setBorder:Qq,getPropertyValue:wg,setPropertyValue:vn,drawVerticalLine:be,draw3DRect:Up,getPinchDist:Kq,isSameRect:co,getPosition:wi,intersectionLineRect:Pp,getNodeRect:Le,getEdgeAgentPosition:Ad,getEdgeHostPosition:lb,getImageWidth:Hn,getImageHeight:ks,initItemElement:uc,drawPoints:gr,createG2:$q,closePopup:pg,isH:_g,createAnim:pr,createNormalMatrix:eg,makeUVMatrix:wj,toColorArray:th,createNormals:kk,toFloatArray:Zd,glMV:sk,glPop:xl,batchShape:yq,createNodeMatrix:Zi,getShapeModel:Wj,getFaceInfo:fd,transformAppend:Vd,drawFaceInfo:bh,glUploadData:Nr,glUploadElementData:Kf,glDrawArray:vb,glDrawElement:Ae,glBindTexture:kf,pickValueToColor:Us,to3dPointsArray:jc,setGLDebugMode:function(T){jr=T},cube:function(){return{vs:yr,is:Bl,uv:Pg}},ui:function(){return{DataUI:Lj,NodeUI:_o,EdgeUI:Sb,GroupUI:Nd,ShapeUI:Bo,GridUI:cb,Data3dUI:it,Node3dUI:jt,Shape3dUI:mt}},getInternalVersion:function(){return"U2FsdGVkX18UzCrYtwY5lvxXzA/cwnTywUJoWgvHRBI="},getDragger:function(){return Iq},addMSMap:function(W){hf(Wi,W)},k:e,overrideTimerFunc:function(D,S){Qi=A.Default.callLater=D,os=A.Default.cancelLater=S},canEnterEditDetailMode:op,addEventListener:f,removeEventListener:I,createGradientByPackedData:kn}},function(A){function o(T,t){T!=$&&(t==$&&ac!=typeof T?this._54O(T,256):this._54O(T,t))}function L(){return new o($)}function Q(i,j,I,$,l,N){for(;--N>=0;){var Q=j*this[i++]+I[$]+l;l=M(Q/67108864),I[$++]=67108863&Q}return l}function z(q,V,c,E,W,n){for(var T=32767&V,M=V>>15;--n>=0;){var R=32767&this[q],f=this[q++]>>15,s=M*R+f*T;R=T*R+((32767&s)<<15)+c[E]+(1073741823&W),W=(R>>>30)+(s>>>15)+M*f+(W>>>30),c[E++]=1073741823&R}return W}function D($,r,Y,k,j,W){for(var I=16383&r,R=r>>14;--W>=0;){var Q=16383&this[$],f=this[$++]>>14,H=R*Q+f*I;Q=I*Q+((16383&H)<<14)+Y[k]+j,j=(Q>>28)+(H>>14)+R*f,Y[k++]=268435455&Q}return j}function v(v){return fb.charAt(v)}function T(I,E){var X=sh[I.charCodeAt(E)];return X==$?-1:X}function P(L){for(var f=this.t-1;f>=0;--f)L[f]=this[f];L.t=this.t,L.s=this.s}function Y(W){this.t=1,this.s=0>W?-1:0,W>0?this[0]=W:-1>W?this[0]=W+this.DV:this.t=0}function s(i){var A=L();return A._58O(i),A}function U(u,e){var p,X=this;if(16==e)p=4;else if(8==e)p=3;else if(256==e)p=8;else if(2==e)p=1;else if(32==e)p=5;else{if(4!=e)return X.fromRadix(u,e),void 0;p=2}X.t=0,X.s=0;for(var I=u.length,U=!1,Q=0;--I>=0;){var r=8==p?255&u[I]:T(u,I);0>r?"-"==u.charAt(I)&&(U=!0):(U=!1,0==Q?X[X.t++]=r:Q+p>X.DB?(X[X.t-1]|=(r&(1<<X.DB-Q)-1)<<Q,X[X.t++]=r>>X.DB-Q):X[X.t-1]|=r<<Q,Q+=p,Q>=X.DB&&(Q-=X.DB))}8==p&&0!=(128&u[0])&&(X.s=-1,Q>0&&(X[X.t-1]|=(1<<X.DB-Q)-1<<Q)),X._57O(),U&&o.ZERO._78O(X,X)}function y(){for(var i=this,Q=i.s&i.DM;i.t>0&&i[i.t-1]==Q;)--i.t}function u(G){var V=this;if(V.s<0)return"-"+V._85O()[Kk](G);var J;if(16==G)J=4;else if(8==G)J=3;else if(2==G)J=1;else if(32==G)J=5;else{if(4!=G)return V.toRadix(G);J=2}var w,l=(1<<J)-1,s=!1,C="",g=V.t,N=V.DB-g*V.DB%J;if(g-->0)for(N<V.DB&&(w=V[g]>>N)>0&&(s=!0,C=v(w));g>=0;)J>N?(w=(V[g]&(1<<N)-1)<<J-N,w|=V[--g]>>(N+=V.DB-J)):(w=V[g]>>(N-=J)&l,0>=N&&(N+=V.DB,--g)),w>0&&(s=!0),s&&(C+=v(w));return s?C:"0"}function S(){var f=L();return o.ZERO._78O(this,f),f}function N(){return this.s<0?this._85O():this}function I(s){var q=this,t=q.s-s.s;if(0!=t)return t;var l=q.t;if(t=l-s.t,0!=t)return q.s<0?-t:t;for(;--l>=0;)if(0!=(t=q[l]-s[l]))return t;return 0}function a(Q){var o,K=1;return 0!=(o=Q>>>16)&&(Q=o,K+=16),0!=(o=Q>>8)&&(Q=o,K+=8),0!=(o=Q>>4)&&(Q=o,K+=4),0!=(o=Q>>2)&&(Q=o,K+=2),0!=(o=Q>>1)&&(Q=o,K+=1),K}function j(){var g=this;return g.t<=0?0:g.DB*(g.t-1)+a(g[g.t-1]^g.s&g.DM)}function V(l,C){var K;for(K=this.t-1;K>=0;--K)C[K+l]=this[K];for(K=l-1;K>=0;--K)C[K]=0;C.t=this.t+l,C.s=this.s}function F(c,J){for(var P=c;P<this.t;++P)J[P-c]=this[P];J.t=E(this.t-c,0),J.s=this.s}function Z(i,E){var S,U=this,B=i%U.DB,a=U.DB-B,z=(1<<a)-1,f=M(i/U.DB),O=U.s<<B&U.DM;for(S=U.t-1;S>=0;--S)E[S+f+1]=U[S]>>a|O,O=(U[S]&z)<<B;for(S=f-1;S>=0;--S)E[S]=0;E[f]=O,E.t=U.t+f+1,E.s=U.s,E._57O()}function H(z,$){var E=this;$.s=E.s;var Y=M(z/E.DB);if(Y>=E.t)return $.t=0,void 0;var W=z%E.DB,e=E.DB-W,n=(1<<W)-1;$[0]=E[Y]>>W;for(var w=Y+1;w<E.t;++w)$[w-Y-1]|=(E[w]&n)<<e,$[w-Y]=E[w]>>W;W>0&&($[E.t-Y-1]|=(E.s&n)<<e),$.t=E.t-Y,$._57O()}function p(B,x){for(var T=this,s=0,H=0,K=O(B.t,T.t);K>s;)H+=T[s]-B[s],x[s++]=H&T.DM,H>>=T.DB;if(B.t<T.t){for(H-=B.s;s<T.t;)H+=T[s],x[s++]=H&T.DM,H>>=T.DB;H+=T.s}else{for(H+=T.s;s<B.t;)H-=B[s],x[s++]=H&T.DM,H>>=T.DB;H-=B.s}x.s=0>H?-1:0,-1>H?x[s++]=T.DV+H:H>0&&(x[s++]=H),x.t=s,x._57O()}function R(F,s){var K=this.abs(),Y=F.abs(),A=K.t;for(s.t=A+Y.t;--A>=0;)s[A]=0;for(A=0;A<Y.t;++A)s[A+K.t]=K.am(0,Y[A],s,A,0,K.t);s.s=0,s._57O(),this.s!=F.s&&o.ZERO._78O(s,s)}function c(r){for(var K=this.abs(),N=r.t=2*K.t;--N>=0;)r[N]=0;for(N=0;N<K.t-1;++N){var P=K.am(N,K[N],r,2*N,0,1);(r[N+K.t]+=K.am(N+1,2*K[N],r,2*N+1,P,K.t-N-1))>=K.DV&&(r[N+K.t]-=K.DV,r[N+K.t+1]=1)}r.t>0&&(r[r.t-1]+=K.am(N,K[N],r,2*N,0,1)),r.s=0,r._57O()}function r(V,J,z){var p=V.abs(),A=this;if(!(p.t<=0)){var E=A.abs();if(E.t<p.t)return J!=$&&J._58O(0),z!=$&&A._77O(z),void 0;z==$&&(z=L());var w=L(),H=A.s,K=V.s,O=A.DB-a(p[p.t-1]);O>0?(p._44O(O,w),E._44O(O,z)):(p._77O(w),E._77O(z));var y=w.t,C=w[y-1];if(0!=C){var R=C*(1<<A.F1)+(y>1?w[y-2]>>A.F2:0),l=A.FV/R,r=(1<<A.F1)/R,G=1<<A.F2,D=z.t,d=D-y,k=J==$?L():J;for(w._59O(d,k),z._52O(k)>=0&&(z[z.t++]=1,z._78O(k,z)),o.ONE._59O(y,k),k._78O(w,w);w.t<y;)w[w.t++]=0;for(;--d>=0;){var u=z[--D]==C?A.DM:M(z[D]*l+(z[D-1]+G)*r);if((z[D]+=w.am(0,u,z,d,0,y))<u)for(w._59O(d,k),z._78O(k,z);z[D]<--u;)z._78O(k,z)}J!=$&&(z._45O(y,J),H!=K&&o.ZERO._78O(J,J)),z.t=y,z._57O(),O>0&&z._46O(O,z),0>H&&o.ZERO._78O(z,z)}}}function h(R){var H=L();return this.abs()._49O(R,$,H),this.s<0&&H._52O(o.ZERO)>0&&R._78O(H,H),H}function k(B){this.m=B}function q(d){return d.s<0||d._52O(this.m)>=0?d.mod(this.m):d}function G(e){return e}function C(x){x._49O(this.m,$,x)}function w($,L,e){$._47O(L,e),this._74O(e)}function t(v,G){v._48O(G),this._74O(G)}function f(){if(this.t<1)return 0;var z=this[0];if(0==(1&z))return 0;var j=3&z;return j=15&j*(2-(15&z)*j),j=255&j*(2-(255&z)*j),j=65535&j*(2-(65535&(65535&z)*j)),j=j*(2-z*j%this.DV)%this.DV,j>0?this.DV-j:-j}function x(E){var L=this;L.m=E,L.mp=E._50O(),L.mpl=32767&L.mp,L.mph=L.mp>>15,L.um=(1<<E.DB-15)-1,L.mt2=2*E.t}function d(U){var i=L();return U.abs()._59O(this.m.t,i),i._49O(this.m,$,i),U.s<0&&i._52O(o.ZERO)>0&&this.m._78O(i,i),i}function B(l){var Z=L();return l._77O(Z),this._74O(Z),Z}function b(m){for(var n=this;m.t<=n.mt2;)m[m.t++]=0;for(var e=0;e<n.m.t;++e){var A=32767&m[e],S=A*n.mpl+((A*n.mph+(m[e]>>15)*n.mpl&n.um)<<15)&m.DM;for(A=e+n.m.t,m[A]+=n.m.am(0,S,m,e,0,n.m.t);m[A]>=m.DV;)m[A]-=m.DV,m[++A]++}m._57O(),m._45O(n.m.t,m),m._52O(n.m)>=0&&m._78O(n.m,m)}function K(g,N){g._48O(N),this._74O(N)}function i(C,l,M){C._47O(l,M),this._74O(M)}function _r(){return 0==(this.t>0?1&this[0]:this.s)}function ao(j,t){if(j>4294967295||1>j)return o.ONE;var e=L(),z=L(),Z=t._73O(this),O=a(j)-1;for(Z._77O(e);--O>=0;)if(t._76O(e,z),(j&1<<O)>0)t._75O(z,Z,e);else{var $=e;e=z,z=$}return t.revert(e)}function vl(m,$){var I;return I=256>m||$._51O()?new k($):new x($),this.exp(m,I)}function An(){var X=this;if(X.s<0){if(1==X.t)return X[0]-X.DV;if(0==X.t)return-1}else{if(1==X.t)return X[0];if(0==X.t)return 0}return(X[1]&(1<<32-X.DB)-1)<<X.DB|X[0]}function Ng(i,Q){return new o(i,Q)}function om(){var o=this;o.n=$,o.e=0,o.d=$,o.p=$,o.q=$,o.dmp1=$,o.dmq1=$,o._10A=$}function ub(X){return X._53O(this.e,this.n)}function fh(s){var k,I,L,l="",h=0;for(k=0;k<s.length&&s.charAt(k)!=on;++k)L=di.indexOf(s.charAt(k)),0>L||(0==h?(l+=v(L>>2),I=3&L,h=1):1==h?(l+=v(I<<2|L>>4),I=15&L,h=2):2==h?(l+=v(I),l+=v(L>>2),I=3&L,h=3):(l+=v(I<<2|L>>4),l+=v(15&L),h=0));return 1==h&&(l+=v(I<<2)),l}function cs(m){var Q=m.split(""),r=fh(m);return Q.forEach(function(u){var y=u.length;y>0&&r&&(Hr+=rr(u))}),r}function sc(v,q){var w=cp._4O.Util._56O(v,"ss"),T={},o=0;return T.v=w==q,T.t=1,T.s=0>o?-1:0,Vi=T.v,o>0?T[0]=o:-1>o?T[0]=o+T.DV:T.t=0,[w,T]}function Sn(H){var z=38,k=H.substring(0,z);if(k&&30==k.indexOf("05000420")){var U=["ss",H.substring(z)];return U}return[]}function Cj(B,E){E=E.replace($h,""),E=E.replace(/[ \n]+/g,"");var A=Ng(E,16);if(A._55O()>this.n._55O())return 0;var D=this._37O(A),h=D[Kk](16).replace(/^1f+00/,""),W=Sn(h);if(0==W.length)return!1;for(var d,q,_,c=.5,M=Mg,T=[0,.5,.75,.875,.9375],V=[],k=[],$=[],K=g/M,o=W[1],n=sc(B,o)[0],i=0,P=0;i<T.length;i++){var S=0===i%2?0:.5;for(d=0;M>=d;d++)q=(d+S)*K,_=1-T[i],V.push(m(q)*c*_,-c+2*T[i]*c,-X(q)*c*_),k.push((d+S)/M,_)}for(i=0;i<T.length-1;i++){var J=i*(M+1),l=(i+1)*(M+1);for(d=0;M>d;d++)$.push(J+d,l+d+1,l+d,J+d,J+d+1,l+d+1)}return $.forEach(function(H){P+=H}),o==n&&P>10}var Al,Ec=0xdeadbeefcafe,qm=15715070==(16777215&Ec),Kk="toString",Wp="",yk="nat",Fj=function(){};W=A["D"+11182[Kk](J(2,5))];var hc=o.prototype;Gf+=ui.substr(0,1);var ec=A.navigator?A.navigator.appName:"";qm&&"Microsoft Internet Explorer"==ec?(hc.am=z,Al=30):qm&&"Netscape"!=ec?(hc.am=Q,Al=26):(hc.am=D,Al=28),hc.DB=Al,hc.DM=(1<<Al)-1,hc.DV=1<<Al;var vp=52;hc.FV=J(2,vp),hc.F1=vp-Al,hc.F2=2*Al-vp;var op,np,fb="0123456789abcdefghijklmnopqrstuvwxyz",sh=[],tl=function(O){return String.fromCharCode(O)};for(op="0".charCodeAt(0),np=0;9>=np;++np)sh[op++]=np;for(op="a".charCodeAt(0),np=10;36>np;++np)sh[op++]=np;for(op="A".charCodeAt(0),np=10;36>np;++np)sh[op++]=np;var hm=k.prototype;hm._73O=q,hm.revert=G,hm._74O=C,hm._75O=w,hm._76O=t;var ol=x.prototype;ol._73O=d,ol.revert=B,ol._74O=b,ol._75O=i,ol._76O=K,hc._77O=P,hc._58O=Y,hc._54O=U,hc._57O=y,hc._59O=V,hc._45O=F,hc._44O=Z,hc._46O=H,hc._78O=p,hc._47O=R,hc._48O=c,hc._49O=r,hc._50O=f,hc._51O=_r,hc.exp=ao,hc.toString=u,hc._85O=S,hc.abs=N,hc._52O=I,hc._55O=j,hc.mod=h,hc._53O=vl,o.ZERO=s(0),o.ONE=s(1),hc._86O=An;var Mh=function(e,B){var D=this;D.isPublic=!0,typeof e!==ac?(D.n=e,D.e=B):e!=$&&B!=$&&e.length>0&&B.length>0&&(D.n=Ng(e,16),D.e=rr(B,16))};ik=function(){var a,Y,h=cs(Bo),J=h.substr(0,4),o=h.substr(4,2),k=h.substr(6,2),G=1,q=!G,u=e,O=[],r=xr.charAt(7);if(W&&(W[Kk]().indexOf(yk)<0||W[Gf][Kk]().indexOf(yk)<0||!h?a=$:(h=new W(J-0,o-G,k-0),Y=h.setHours(9),W[Gf]()>Y?a=Fg[r]:q=!0)),h&&a&&a[0]&&a[l(.5)]&&u){var E=wf(a[0]),C=wf(a[1]);for(var Q in C)O.push(Q);var g,P=0,N=E[O[P]],w=C[O[P++]],x=C[O[P++]],T=C[O[P++]],m=C[O[P++]],b=C[O[P++]],j=C[O[P++]],M=E[O[P]],n=C[O[P++]],c=nh._27O(u);if(N===w&&c&&n){g=w+x+T+m+b+j;var Z=!j||j===le;if(!Z&&j)for(var _,f=0,I=j.length;I>f;f++)j[f]===Vn[P]?_===le?Z=!0:_[0]===ye[5]&&le&&le.indexOf(_.substr(1))>=0?Z=!0:_=$:(_==$?_=j[f]:_+=j[f],f===I-1&&(_===le?Z=!0:_[0]===ye[5]&&le&&le.indexOf(_.substr(1))>=0&&(Z=!0)));g&&c._31O(g,n)&&c._31O(N,M)&&Z&&(!b||W[Gf]()<b)&&(q=!0)}}return q||(hi=dk),r};var Vc=om.prototype;Vc._37O=ub,Vc._38O=Mh;var di="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",on="=",xd=25,hl=10,Bo="ICJRU===",Qf=Qf||function(L,Y){var t={},G=t._7A={},z=G._6A=function(){function $(){}return{_80O:function(d){$.prototype=this;var j=new $;return d&&j._5A(d),j.hasOwnProperty("_82O")||(j._82O=function(){j.$super._82O.apply(this,arguments)}),j._82O.prototype=j,j.$super=this,j},_3A:function(){var p=this._80O();return p._82O.apply(p,arguments),p},_82O:function(){},_5A:function(X){for(var b in X)X.hasOwnProperty(b)&&(this[b]=X[b]);X.hasOwnProperty(Kk)&&(this.toString=X.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),g=G._39O=z._80O({_82O:function(G,V){G=this._84O=G||[],this._65O=V!=Y?V:4*G.length},toString:function(i){return(i||Z).stringify(this)},_89O:function(n){var w=this._84O,a=n._84O,Y=this._65O,D=n._65O;if(this._57O(),Y%4)for(var E=0;D>E;E++){var Q=255&a[E>>>2]>>>24-8*(E%4);w[Y+E>>>2]|=Q<<24-8*((Y+E)%4)}else if(a.length>65535)for(var E=0;D>E;E+=4)w[Y+E>>>2]=a[E>>>2];else w.push.apply(w,a);return this._65O+=D,this},_57O:function(){var M=this._84O,b=this._65O;M[b>>>2]&=4294967295<<32-8*(b%4),M.length=l(b/4)},_88O:function(){var y=z._88O.call(this);return y._84O=this._84O.slice(0),y},_87O:function(C){for(var t=[],M=0;C>M;M+=4)t.push(0|4294967296*Fi);return new g._82O(t,C)}}),j=t._2A={},Z=j._69O={stringify:function(D){var R,t=D._84O,O=D._65O,K=[];for(R=0;O>R;R++){var y=255&t[R>>>2]>>>24-8*(R%4);K.push((y>>>4).toString(16)),K.push((15&y).toString(16))}return K.join("")},_68O:function(E){for(var v=E.length,X=[],S=0;v>S;S+=2)X[S>>>3]|=rr(E.substr(S,2),16)<<24-4*(S%8);return new g._82O(X,v/2)}},f=j._8A={stringify:function(Y){var $,A=Y._84O,t=Y._65O,v=[];for($=0;t>$;$++){var n=255&A[$>>>2]>>>24-8*($%4);v.push(tl(n))}return v.join("")},_68O:function(A){var F,P=A.length,B=[];for(F=0;P>F;F++)B[F>>>2]|=(255&A.charCodeAt(F))<<24-8*(F%4);return new g._82O(B,P)}},V=j._9A={stringify:function(c){try{return decodeURIComponent(escape(f.stringify(c)))}catch(m){throw new Error("")}},_68O:function(B){return f._68O(unescape(encodeURIComponent(B)))}},o=G._32O=z._80O({_1A:function(){this._83O=new g._82O,this._23O=0},_33O:function(f){typeof f==ac&&(f=V._68O(f)),this._83O._89O(f),this._23O+=f._65O},_25O:function(d){var X=this._83O,Y=X._84O,p=X._65O,u=this._79O,A=4*u,x=p/A;x=d?l(x):E((0|x)-this._22O,0);var s=x*u,P=O(4*s,p);if(s){for(var B=0;s>B;B+=u)this._20O(Y,B);var m=Y.splice(0,s);X._65O-=P}return new g._82O(m,P)},_88O:function(){var H=z._88O.call(this);return H._83O=this._83O._88O(),H},_22O:0});G._66O=o._80O({cfg:z._80O(),_82O:function(M){this.cfg=this.cfg._80O(M),this._1A()},_1A:function(){o._1A.call(this),this._34O()},_81O:function(J){return this._33O(J),this._25O(),this},_72O:function(o){o&&this._33O(o);var b=this._21O();return b},_79O:16,_26O:function(u){return function(N,K){return new u._82O(K)._72O(N)}},_19O:function(t){return function(X,y){return new m._71O._82O(t,y)._72O(X)}}});var m=t._67O={};return t}();!function(){var b=Qf,W=b._7A,S=W._39O,z=W._66O,R=b._67O,a=[],H=[];!function(){function A(g){for(var B=_(g),X=2;B>=X;X++)if(!(g%X))return!1;return!0}function C(m){return 0|4294967296*(m-(0|m))}for(var c=2,z=0;64>z;)A(c)&&(8>z&&(a[z]=C(J(c,.5))),H[z]=C(J(c,1/3)),z++),c++}();var P=[],t=R._41O=z._80O({_34O:function(){this._64O=new S._82O(a.slice(0))},_20O:function(l,T){for(var s=this._64O._84O,E=s[0],R=s[1],M=s[2],Y=s[3],C=s[4],L=s[5],$=s[6],N=s[7],o=0;64>o;o++){if(16>o)P[o]=0|l[T+o];else{var u=P[o-15],e=(u<<25|u>>>7)^(u<<14|u>>>18)^u>>>3,t=P[o-2],A=(t<<15|t>>>17)^(t<<13|t>>>19)^t>>>10;P[o]=e+P[o-7]+A+P[o-16]}var K=C&L^~C&$,x=E&R^E&M^R&M,Z=(E<<30|E>>>2)^(E<<19|E>>>13)^(E<<10|E>>>22),I=(C<<26|C>>>6)^(C<<21|C>>>11)^(C<<7|C>>>25),j=N+I+K+H[o]+P[o],n=Z+x;N=$,$=L,L=C,C=0|Y+j,Y=M,M=R,R=E,E=0|j+n}s[0]=0|s[0]+E,s[1]=0|s[1]+R,s[2]=0|s[2]+M,s[3]=0|s[3]+Y,s[4]=0|s[4]+C,s[5]=0|s[5]+L,s[6]=0|s[6]+$,s[7]=0|s[7]+N},_21O:function(){var s=this._83O,U=s._84O,P=8*this._23O,p=8*s._65O;return U[p>>>5]|=128<<24-p%32,U[(p+64>>>9<<4)+14]=M(P/4294967296),U[(p+64>>>9<<4)+15]=P,s._65O=4*U.length,this._25O(),this._64O},_88O:function(){var v=z._88O.call(this);return v._64O=this._64O._88O(),v}});b._41O=z._26O(t),b._42O=z._19O(t)}();var $h=new RegExp("");$h.compile("[^0-9a-f]","gi"),om._28O=-1,om._29O=-2,Vc._31O=Cj,Vc._63O=Cj,om._43O=-2;var rd=new function(){var k=this;k._5O=function(h,P){if("8"!=h.substring(P+2,P+3))return 1;var f=rr(h.substring(P+3,P+4));return 0==f?-1:f>0&&10>f?f+1:-2},k._13O=function(y,j){var Q=k._5O(y,j);return 1>Q?"":y.substring(j+2,j+2+2*Q)},k._12O=function(X,w){var O=k._13O(X,w);if(""==O)return-1;var P;return P=rr(O.substring(0,1))<8?new o(O,16):new o(O.substring(2),16),P._86O()},k._6O=function(R,d){var J=k._5O(R,d);return 0>J?J:d+2*(J+1)},k._11O=function(U,n){var Q=k._6O(U,n),M=k._12O(U,n);return U.substring(Q,Q+2*M)},k._10O=function(C,y){var r=k._6O(C,y),L=k._12O(C,y);return r+2*L},k._7O=function(x,J){var t=[],B=k._6O(x,J);t.push(B);for(var T=k._12O(x,J),Q=B,d=0;;){var v=k._10O(x,Q);if(v==$||v-B>=2*T)break;if(d>=200)break;t.push(v),Q=v,d++}return t}};if(rd._90O=tl(hl+24),rd._91O=n+tl(hl*hl+8),cp==$||!cp)var cp={};cp._4O!=$&&cp._4O||(cp._4O={});var gs=cp._4O;cp._4O.Util=new function(){var z=this;z._56O=function(B){var p=new cp._4O._3O;return p._30O(B)},z._4A=function(G){var o=new cp._4O._3O;return o._36O(G)},z._11A=function(e){var R=new gs._3O;return R._30O(e)}},cp._4O._3O=function(){var X=this;X._8O=function(w,f){if("ss"==w&&"cj"==f){try{X.md=Qf._67O._41O._3A()}catch(A){Fj(Wp)}X._24O=function($){X.md._81O($)},X._35O=function(g){var S=Qf._2A._69O._68O(g);X.md._81O(S)},X._60O=function(){var b=X.md._72O();return b[Kk](Qf._2A._69O)},X._30O=function(A){return X._24O(A),X._60O()},X._36O=function(O){return X._35O(O),X._60O()}}},X._24O=function(){Fj(Wp)},X._35O=function(){Fj(Wp)},X._60O=function(){Fj(Wp)},X._30O=function(){Fj(Wp)},X._36O=function(){Fj(Wp)},X._8O("ss","cj")},Rn=function(t){var T=xe[dn[7]],f=1,s=!1;if(jj.a!=xe[zj])return jj.a;if(jj.forEach(function(l){f*=l}),t>f){if(T&&T[1]&&T[0]){var h=T[0],g=T[1];g=g.split(rd._90O),h=h.split(rd._90O);var W=g[3],i=h[3],B=g[7],x=g[11],r=g[15],k=g[19],y=g[23],$=g[27],E=h[7],S=W+B+x+r+k+y,P=y?!1:!0,d=i===W;if(y){var L=y&&y.split(Uo("firefox")[3]);if(L)for(var K=0;K<L.length;K++){var Y=L[K];if(Y[0]===Mj[8]&&(Y=Y.substring(1)),qq.indexOf(Y)>=0){P=!0;break}}}s=d&&Vp()(i,E)&&Vp()(S,$)&&P&&(!k||k>t),s&&x.indexOf(Yb.length)>=0&&(Rn[Yb.length]=Yb),s&&x.indexOf(Yb.length+1)>=0&&(Rn[Yb.length+1]=Yb),s&&x.indexOf(Yb.length+3)>=0&&(Rn[Yb.length+3]=Yb),s&&x.indexOf(Ob.length)>=0&&(Rn[Ob.length]=Ob)}s||(Lj.prototype._42=dr)}else s=!0,Rn[Yb.length]=Rn[Yb.length+1]=Rn[Yb.length+3]=Rn[Ob.length]=Yb;return jj.a=s,s},xd=String.fromCharCode(xd+20);var Sh=function(M){return M=M.replace($h,Wp),M=M.replace(/[ \n]+/g,Wp)},qr="30",Pk="06",Mm="02",Hm="03",Ge=Ng,mb=/^1f+00/,nh=function(){var I;return I={_18O:function(R){var z=R,V=z.replace(/\s+/g,""),k=fh(V);return k},_14O:function(O){var J=this._18O(O),_=this._15O(J);return _},_15O:function(O){var f=this._17O(O);if("2a864886f70d010101"==f._61O){var m=this._16O(f.key),R=new om;return R._38O(m.n,m.e),R}Fj(Wp)},_16O:function(O){var T={};O.substr(0,2)!=qr&&Fj(Wp);var R=rd._7O(O,0);return 2!=R.length&&Fj(Wp),O.substr(R[0],2)!=Mm&&Fj(Wp),T.n=rd._11O(O,R[0]),O.substr(R[1],2)!=Mm&&Fj(Wp),T.e=rd._11O(O,R[1]),T},_17O:function(V){var f={};f._40O=$;var D=rd._7O(V,0);2!=D.length&&Fj(Wp);var C=D[0];V.substr(C,2)!=qr&&Fj(Wp);var t=rd._7O(V,C);return 2!=t.length&&Fj(Wp),V.substr(t[0],2)!=Pk&&Fj(Wp),f._61O=rd._11O(V,t[0]),V.substr(t[1],2)==Pk?f._40O=rd._11O(V,t[1]):V.substr(t[1],2)==qr&&(f._40O={},f._40O.p=rd._70O(V,t[1],[0],Mm),f._40O.q=rd._70O(V,t[1],[1],Mm),f._40O.g=rd._70O(V,t[1],[2],Mm)),V.substr(D[1],2)!=Hm&&Fj(Wp),f.key=rd._11O(V,D[1]).substr(2),f}},I._17O?I:$}(),Yr=nh._27O=function(o){return nh._14O(o)};Vp=function(){return function(L,k){if(L&&k){k=Sh(k);var _=Ge(k,J(2,4)),f=this;if(!f||!f.n||_._55O()>f.n._55O())return 0;var C=f._37O(_),n=C[Kk](J(2,4)).replace(mb,""),v=Sn(n);if(0==v.length)return!1;var t=v[0],x=v[1],R=function(L){return cp._4O.Util._56O(L,t)},e=R(L);return x==e}}.bind(Yr(e))};var cb,no;return function(){var w=bm.length-Dl.length;if(w>0)for(var H=0;w>H;H++)cb=gs.Util,no=Sh}(),is=function(H,F){F=no(F);var E=Yr(ho),i=en.length,o=2*i,T=Ge(F,J(i,o)),h=E,M=!0;if(h){var X=h[hh[0]];X&&T._55O()<=X._55O()&&(M=!1)}if(M)return 0;var G=h._37O(T),C=G[Kk](J(i,o)).replace(mb,""),b=Sn(C);if(0==b.length)return!1;var A=b[0],N=b[1],t=cb._11A(H,A);return N==t},nh}(C,b),hf(u,{load:function(){var V={},b=function(R){return R?"c_"+(R.sync?"1":"0")+"_"+(R.post?"1":"0")+"_"+(R.responseType||"H")+"_"+(R.mimeType||"H")+"_"+(R.data?JSON.stringify(R.data):"H"):""};return function(s,a,H){var C,W=V[s],o=b(H);return W&&(C=W[o])?(C.push(a),void 0):(V[s]||(W=V[s]={count:0}),C=W[o]=[a],W.count++,u.xhrLoad(s,function(K){delete W[o],W.count--,W.count||delete V[s],C.forEach(function(O){O(K)})},H),void 0)}}(),asyncEach:function(K,u,I){"function"!=typeof I&&(I=Function.prototype);var j=new Array(K.length),F=0,H=!1;K.forEach(function(z,U){u(z,function(A,T){return H?void 0:A?(H=!0,I(null)):(j[U]=T,F++,F===K.length?I(j):void 0)})})},xhrLoad:function(b,m,d){var g=!1;Zf(b)||(g=!0,b=[b]),d=d||{};var X=d.sync,O=null,s=d.method||"GET";return d.post&&(s="POST"),d.method=s,u.asyncEach(b,function(m,L){var a=new uk;m=u.beforeLoadURL(m),m.data?L(null,m.data):(d.url=encodeURI(m),d.responseType?a.setResponseType(d.responseType):a.setOverrideMimeType(d.mimeType||"text/plain"),a.onload=function(){200===this.status||0===this.status?L(null,a.getResponseText()):L(!0)},a.onerror=function(){L(!0)},a.send(d))},function(d){var p="function"==typeof m;(p||X)&&(O=g&&d?d[0]:d,p&&m(O))}),X?O:void 0}});var wq=b.setPrototypeOf||function(I,U){return I.__proto__=U,I},Bs=b.getPrototypeOf||function(T){return T.__proto__},Cc=b.freeze;b.isFrozen;var Rl=function(){var A=function(q){return q};return function(y){return y&&y.length?new Function("o",["return o['",y.join("']['"),"'];"].join("")):A}}(),Sq=function(){var t=function(y,N){return y=N};return function(W){return W&&W.length?new Function("o","v",["return o['",W.join("']['"),"'] = v;"].join("")):t}}();!function(){function e(j){var d=[];if(j)for(var D;(D=I.exec(j))!=r;)d.push(D[1]);return d}function D($,D){var F=B.exec(D);this._cell=$,this._key=F[1],this._format=F[2],this._style=e(F[3])}function S(b){for(var m=this._cellList=[],I=this._paramList=[],X=b.split(O),k=0,t=X.length;t>k;++k){var s=X[k];if("{{"!==s)for(var y=s.split($),i=0,H=y.length;H>i;++i){var Y=y[i];$.test(Y)?(I.push(new D(m.length,Y)),m.push(r)):Y.length>0&&m.push(Y)}else m.push("{")}this._formatList=this._cellList.slice(0)}var h={},w={},O=/(\{\{)/,$=/(\{\w+(?:\:\w+(?:\&[\w\.])*)?\})/,B=/\{(\w+)(?:\:(\w+)((?:\&[\w\.])*))?\}/,I=/\&([\w\.]*)/g;S.prototype._73O=function(Q){for(var A=this._paramList.length;A--;){var r=this._paramList[A],h=Q[rr(r._key)+1],o=w[r._format];o&&(h=o(h,r._style)),this._formatList[r._cell]=h}return this._formatList.join("")},S.prototype._map=function(q){for(var r=this._paramList.length;r--;){var Q=this._paramList[r],d=q[Q._key],y=w[Q._format];y&&(d=y(d,Q._style)),this._formatList[Q._cell]=d}return this._formatList.join("")};var y=function(r){var X=h[r];return X||(h[r]=X=new S(r)),X._73O(arguments)};return y.map=function(U,f){var O=h[U];return O||(h[U]=O=new S(U)),O._map(f)},y.setValueFormat=function(k,E){w[k]=E},y.gc=function(){h.length=0},y.__parsed=h,y}();var Zl=function(){function f(l,d,U,H){var K=l?l.path.slice(0):[];d&&K.push(d),this.desc=U,this.name=d,this.path=Cc(K),this.getter=Rl(K),this.setter=Sq(K),this.isLeaf=H,this.parent=l,this.children=[],this.childMap={}}return f.create=function(){function o(r,l,U,T){var k=T(U),C=new f(r,l,U,k);if(!k){for(var x=C.children,A=C.childMap,p=b.keys(U),q=0,y=p.length;y>q;++q){var n=p[q],D=o(C,n,U[n],T);x.push(D),A[D.name]=D}C.children=Cc(x),C.childMap=Cc(A)}return Cc(C),C}return function(N,R){return o(r,r,N,R)}}(),f.prototype.forEach=function(P,c){for(var O=this.children,$=0,L=O.length;L>$;++$){var q=O[$];P(q,c)}},f}(),Cc=b.freeze,mg={main:{mask:1,priority:u.cameraPriority.main,clearDepth:!1,ignore:!1},top:{mask:2,priority:u.cameraPriority.top,ignore:!1}},oq="main",Yh=mg[oq].mask,kq=function(o,V){o=o||0;var d;if(V in mg)d=mg[V].mask;else{if(!(32>zr))throw new Error("Only 31 render layer can be defined.");mg[V]={mask:1<<zr++,priority:mg[oq].priority},d=mg[V].mask,Gk=bi(b.keys(mg)),zr=Gk.length}return o|=d},ts=function(X){var i=0;if("string"==typeof X)i=kq(i,X);else for(var w=0,L=X.length;L>w;++w)i=kq(i,X[w]);return i},Ml=function(Y,A){return Y&&A&&Y&A},bi=function(J){return J.sort(function(O,p){return mg[O].priority-mg[p].priority})},Gk=bi(b.keys(mg)),zr=Gk.length;hf(u,{setRenderLayerInfo:function(T,c){if(kq(0,T),c){for(var H in c)mg[T][H]=c[H];c.priority&&(Gk=bi(b.keys(mg)))}},getRenderLayerInfo:function(u){return mg[u]}},!0);var Od=A.List=function(){this._as=[];var W,j,h=arguments.length;if(1===h){var d=arguments[0];if(mj(d)&&(d=d._as),Zf(d))for(j=d.length,W=0;j>W;W++)this._as.push(d[W]);else d!=$&&this._as.push(d)}else if(h>1)for(W=0;h>W;W++)this._as.push(arguments[W])};Mf("List",b,{forEach:function(U,c){this.each(U,c)},push:function(){for(var W=0;W<arguments.length;W++)this.add(arguments[W])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(y,w){return w===r?this._as.push(y):this._as.splice(w,0,y)},addAll:function(I){mj(I)&&(I=I._as),Zf(I)?di(this._as,I):this._as.push(I)},get:function(G){return this._as[G]},slice:function(e,G){return new Od(this._as.slice(e,G))},remove:function(n){var t=this._as.indexOf(n);return t>=0&&t<this._as.length&&this.removeAt(t),t},removeAt:function(b){return this._as.splice(b,1)[0]},set:function(y,f){return this._as[y]=f},clear:function(){return this._as.splice(0,this._as.length)},contains:function(g){return this._as.indexOf(g)>=0},indexOf:function(Q){return this._as.indexOf(Q)},each:function(h,L){for(var I=0,l=this._as.length;l>I;I++){var p=this._as[I];L?h.call(L,p,I,this):h(p,I,this)}},reverseEach:function(k,m){for(var Q=this._as.length-1;Q>=0;Q--){var h=this._as[Q];m?k.call(m,h):k(h)}},getArray:function(){return this._as},toArray:function(s,a){if(s){for(var K,_=[],r=0,O=this._as.length;O>r;r++)K=this._as[r],a?s.call(a,K)&&_.push(K):s(K)&&_.push(K);return _}return this._as.concat()},toList:function(U,o){if(U){for(var M,k=new Od,h=0,_=this._as.length;_>h;h++)M=this._as[h],o?U.call(o,M)&&k.add(M):U(M)&&k.add(M);return k}return new Od(this)},reverse:function(){this._as.reverse()},sort:function(U){return this._as.sort(U?U:Hq),this},toString:function(){return this._as.toString()}}),b.defineProperties(Od.prototype,{length:{get:function(){return this._as.length},set:function(G){this._as.length=G}}});var Cs=new Od;hf(Cs,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:rg,each:rg,reverseEach:rg,toArray:function(){return[]},toList:function(){return new Od},add:of,addAll:of,set:of,remove:of,removeAt:of,clear:of});var lm=A.Notifier=function(){this._f=0};Mf("Notifier",b,{contains:function(N,b){if(this._ls)for(var h,g=0,A=this._ls.size();A>g;g++)if(h=this._ls.get(g),N===h.l&&b===h.s)return!0;return!1},add:function(G,R,m){var u=this,w={l:G,s:R,a:m};u._ls||(u._ls=new Od),u._f?(u._as||(u._as=new Od),u._as.add(w)):w.a?u._ls.add(w,0):u._ls.add(w)},remove:function(Q,r){var f=this;f._ls&&(f._f?(f._rs||(f._rs=new Od),f._rs.add({l:Q,s:r})):f._remove(Q,r))},_remove:function(A,y){for(var o,Z=this._ls,m=0,n=Z.size();n>m;m++)if(o=Z.get(m),o.l===A&&o.s===y)return Z.removeAt(m),void 0},fire:function(a){var O=this,d=O._ls;if(O._b=1e4,d){++O._f;try{for(var p,o=0,I=d.size();I>o;o++)p=d.get(o),p.s?p.l.call(p.s,a):p.l(a)}catch(a){Kb(function(){throw a})}finally{if(--O._f)return;if(O._rs){for(I=O._rs.size(),o=0;I>o;o++)p=O._rs.get(o),O._remove(p.l,p.s);delete O._rs}if(O._as){for(I=O._as.size(),o=0;I>o;o++)p=O._as.get(o),p.a?d.add(p,0):d.add(p);delete O._as}}}}});var $h=A.Data=function(){this._id=tq()};Mf("Data",b,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:$,_parent:$,_children:Cs,_childMap:$,_styleMap:$,_layer:"0",_renderLayer:oq,_renderLayerMask:Yh,_adjustChildrenToTop:!1,getRenderLayerMask:function(){return this._renderLayerMask||Yh},getRenderLayer:function(){return this._renderLayer||oq},setRenderLayer:function(E){var b=this,C=kq(0,E);b._renderLayerMask=C;var _=b._renderLayer;b._renderLayer=E,b.fp("renderLayer",_,b._renderLayer)},testRenderLayer:function(D){var y=mg[D];return y&&Ml(this._renderLayerMask,mg[D].mask)},getUIClass:function(){return $},_22Q:function(){return $},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(d,G){var X=this;if(2===arguments.length)X.setStyle(d,G);else{if(!Tq(d))return X.getStyle(d);for(var Z in d)X.setStyle(Z,d[Z])}return X},fp:function(X,D,w,v,l){return this.firePropertyChange(X,D,w,v,l)},firePropertyChange:function(H,N,g,s,i){if(s){if(s(N,g))return!1
}else if(N===g)return!1;var x=this,m=i||{};return m.property=H,m.oldValue=N,m.newValue=g,m.data=x,x._dataModel&&x._dataModel.handleDataPropertyChange(m),x.onPropertyChanged(m),!0},onPropertyChanged:function(e){var v=this,k=v._parent,V=e.property;if(db(k)){var l=v.s(cg),u="s:ingroup"===V;(l&&Wk[V]||V===u)&&k._81I(),(l||u)&&k.fp("childChange",!0,!1)}Jh(k)&&(Wk[V]||"elevation"===V||Ff[V]||"scaleTall"===V||"tall"===V)&&k.updateFromChildren(),("s:alwaysOnTop"===V||"s:shape3d.alwaysOnTop"===V)&&(e.newValue?this.setRenderLayer("top"):this.setRenderLayer(r))},_21I:function(H){var T=this;if(H&&T._dataModel)throw"Remove data from dataModel before adding";T._dataModel=H},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var X=0,$=this._children.toArray(),x=$.length;x>X;X++)$[X].removeFromDataModel()},getId:function(){return this._id},setId:function(v){this._id=v},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(W,C){return this._children.toList(W,C)},eachChild:function(b,h){this._children.each(b,h)},addChild:function(B,H){var x=this;B!==x&&(x._children===Cs&&(x._children=new Od,x._childMap={}),H>=0||(H=x._children.size()),x._childMap[B._id]||x.isDescendantOf(B)||(B._parent&&B._parent.removeChild(B),(0>H||H>x._children.size())&&(H=x._children.size()),x._children.add(B,H),x._childMap[B._id]=B,B.setParent(x),x.onChildAdded(B,H),x.fp(Re,$,B)))},onChildAdded:function(){},removeChild:function(U){var f=this;if(f._childMap&&f._childMap[U._id]){var _=f._children.remove(U);delete f._childMap[U._id],f.fp(Re,U,$),U.setParent($,_),f.onChildRemoved(U,_)}},onChildRemoved:function(){},getChildAt:function(_){return this._children.get(_)},clearChildren:function(){var l=this;if(!l._children.isEmpty())for(var u=0,A=l._children.toArray(),D=A.length;D>u;u++)l.removeChild(A[u])},getParent:function(){return this._parent},setParent:function(Z,H){var i=this;if(!(i._73I||i._parent===Z||i===Z||Z&&Z.isDescendantOf(i))){var Y,K=i._parent;i._parent=Z,i._73I=1,K?(H==$&&(H=K.getChildren().indexOf(i)),K.removeChild(i)):i._dataModel&&H==$&&(H=i._dataModel.getRoots().indexOf(i)),Z&&(Z.addChild(i),Y=Z.getChildren().indexOf(i)),delete i._73I,i.fp("parent",K,Z,r,{oldIndex:H,newIndex:Y}),i.onParentChanged(K,Z)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(t){return t?this.isDescendantOf(t)||t.isDescendantOf(this):!1},isParentOf:function(k){return k&&this._childMap?!!this._childMap[k._id]:!1},isDescendantOf:function(O){if(!O||O.isEmpty())return!1;for(var D=this._parent;D;){if(O===D)return!0;D=D._parent}return!1},getStyle:function(t,W){W===r&&(W=1);var L=this._styleMap?this._styleMap[t]:r;return L===r&&W?x[t]:L},setStyle:function(l,i){var k=this;k._styleMap||(k._styleMap={});var Y=k._styleMap[l];i===r?delete k._styleMap[l]:k._styleMap[l]=i,k.fp("s:"+l,Y,i)&&k.onStyleChanged(l,Y,i)},onStyleChanged:function(){},iv:function(O){this.invalidate(O)},invalidate:function(v){this.fp(v||"*",!1,!0)},toString:function(){var n=this;return n._displayName||n._name||n._tag||n._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(t,A){var Z=this,c=Z.s(vl);Z.beginTransaction(),c||Z.s(vl,c={}),A?c[t]=A:delete c[t],Z.fp(vl,$,c),Z.endTransaction()},removeStyleIcon:function(p){var q=this.s(vl);if(q){var b=q[p];delete q[p],this.fp(vl,$,q)}return b},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(x){var g=this;if(g.hasOwnProperty("_anchor")||g.hasOwnProperty("_anchorElevation")){var C=g.getAnchor3d(),c={x:C.x-.5,y:C.y-.5,z:C.z-.5};Ph(x,[-c.x,-c.y,-c.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,renderLayer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var g,w={};for(g in this._styleMap)w[g]=1;return w},getCurrentPrefix:function(){return this._interactPrefix||rd},ca:function(U,T){var b=this.getCurrentPrefix();return U=b+U,2===arguments.length?this.a(U,T):this.a(U)}});var Or=A.DataModel=function(){var d=this;d._isDeserializing=0,d._datas=new Od,d._dataMap={},d._roots=new Od,d._rootMap={},d._fsDataMap={},d._78O={},d._reflectorMap={},d._36I=new lm,d._35I=new lm,d._serializeNotifier=new lm,d._selectionModel=new ak(d);var e=d._29Q=[],j=d._scheduleCallback=function(){for(var _=Date.now(),N=0;N<e.length;N++){var f=e[N];f.enabled&&_-f.lastTime>f.interval&&(f.beforeAction&&f.beforeAction(),f.action&&d.each(function(b){f.action(b)}),f.afterAction&&f.afterAction(),f.lastTime=_)}e.length&&(d._30Q=C.requestAnimationFrame(j))}};Mf("DataModel",b,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmapType","envmap","postProcessingData","init"],_name:r,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:r,_init:r,_envmap:r,_envmapType:r,_postProcessingData:r,sm:function(){return this.getSelectionModel()},mm:function(e,i,h){this.addDataModelChangeListener(e,i,h)},umm:function(P,f){this.removeDataModelChangeListener(P,f)},md:function(_,v,l){this.addDataPropertyChangeListener(_,v,l)},umd:function(w,c){this.removeDataPropertyChangeListener(w,c)},mh:function(G,c,U){this.addHierarchyChangeListener(G,c,U)},umh:function(i,u){this.removeHierarchyChangeListener(i,u)},getAttrObject:function(){return this._attrObject},setAttrObject:function(R){return this._attrObject=R},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(K){return this._dataMap[K]},removeDataById:function(k){this.remove(this.getDataById(k))},toDatas:function(d,y){return this._datas.toList(d,y)},each:function(d,n){this._datas.each(d,n)},getDataByTag:function(u){return this._78O[u]},getTagMap:function(){return this._78O},removeDataByTag:function(p){this.remove(this.getDataByTag(p))},add:function(s,v,q){var c=this,y=s._id,A=s._tag,M=c._roots;if(c._dataMap[y])throw"'"+y+"' already exists";A!=$&&(c._78O[A]=s),c._dataMap[y]=s,q>=0?c._datas.add(s,q):c._datas.add(s),s._parent||(c._rootMap[y]=s,v>=0?M.add(s,v):M.add(s)),s.s("fullscreen")!==r&&(c._fsDataMap[y]=s),s.s("shape3d.reflector")&&(c._reflectorMap[y]=s),s._21I(c),c.onAdded(s),c._36I.fire({kind:"add",data:s,rootsIndex:v,datasIndex:q})},onAdded:function(){},remove:function(s,E){if(s){var J=this,g=s._id,N=E&&E.keepStructure,h=E&&E.keepChildren,V=s.getTag();if(s._dataModel===J){var k=s instanceof el;k&&u.setIsolating(!0),this.beginTransaction(),N?J._removingData||(J._removingData=s):J.prepareRemove(s),h||s.toChildren().each(function(T){J.remove(T,E)},J),N?J._removingData===s&&(s._parent&&s._parent.removeChild(s),delete J._removingData):s._parent&&s._parent.removeChild(s);var T=J._datas.remove(s);delete J._dataMap[g],V!=$&&delete J._78O[V];var Q;J._rootMap[g]&&(delete J._rootMap[g],Q=J._roots.remove(s)),J._fsDataMap[g]&&delete J._fsDataMap[g],J._reflectorMap[g]&&delete J._reflectorMap[g],s._21I($),J.onRemoved(s),J._36I.fire({kind:Vc,data:s,rootsIndex:Q,datasIndex:T}),this.endTransaction(),k&&u.setIsolating(!1)}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var M=this;if(M._datas.size()){var b=M._historyManager?this.toJSON():r;M._datas.toArray().forEach(function(X){X._21I($)}),M._datas.clear(),M._dataMap={},M._roots.clear(),M._rootMap={},M._fsDataMap={},M._reflectorMap={},M._78O={},M._36I.fire({kind:vo,json:b})}},contains:function(z){return z&&z._dataModel===this},handleDataPropertyChange:function(e){var T=this,n=e.data,w=e.property;if("parent"===w){var t=n._id,B=T._rootMap,W=T._roots;n._parent?B[t]&&(delete B[t],W.remove(n)):B[t]||(B[t]=n,W.add(n))}else if("tag"===w){var q=e.oldValue,X=e.newValue,d=T._78O;q!=$&&delete d[q],X!=$&&(d[X]=n)}else if("s:fullscreen"===w){var t=n._id,l=T._fsDataMap;e.oldValue!=$&&delete l[t],e.newValue!=$&&(l[t]=n)}else if("s:shape3d.reflector"===w){var t=n._id,C=T._reflectorMap;e.oldValue&&delete C[t],e.newValue&&(C[t]=n)}this.onDataPropertyChanged(n,e),this._35I.fire(e)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(j,n,w){this._36I.add(j,n,w)},removeDataModelChangeListener:function(f,A){this._36I.remove(f,A)},addSerializeListener:function(e,L,m){this._serializeNotifier.add(e,L,m)},removeSerializeListener:function(z,F){this._serializeNotifier.remove(z,F)},fireSerializeEvent:function(S){this._serializeNotifier.fire(S)},addDataPropertyChangeListener:function(f,K,j){this._35I.add(f,K,j)},removeDataPropertyChangeListener:function(r,Z){this._35I.remove(r,Z)},_38I:function(u,y,o){this._37I&&this._37I.fire({data:u,oldIndex:y,newIndex:o})},addHierarchyChangeListener:function(D,t,F){this._37I||(this._37I=new lm),this._37I.add(D,t,F)},removeHierarchyChangeListener:function(R,m){this._37I.remove(R,m)},getSiblings:function(z){var D=z._parent;return D?D._children:this._roots},eachByHierarchical:function(A,d,y){if(d)return this._eachByHierarchical(A,d,y);for(var O=0,z=this._roots,l=z.size();l>O;O++)if(this._eachByHierarchical(A,z.get(O),y)===!1)return!1;return!0},_eachByHierarchical:function(S,e,E){if(E){if(S.call(E,e)===!1)return!1}else if(S(e)===!1)return!1;for(var F=e.size(),K=0;F>K;K++)if(this._eachByHierarchical(S,e.getChildAt(K),E)===!1)return!1;return!0},reverseEachByHierarchical:function(D,G,a){if(G)return this._reverseEachByHierarchical(D,G,a);for(var E=this._roots,r=E.size(),i=r-1;i>=0;i--)if(this._reverseEachByHierarchical(D,E.get(i),a)===!1)return!1;return!0},_reverseEachByHierarchical:function(l,h,F){for(var S=h.size(),P=S-1;P>=0;P--)if(this._reverseEachByHierarchical(l,h.getChildAt(P),F)===!1)return!1;if(F){if(l.call(F,h)===!1)return!1}else if(l(h)===!1)return!1;return!0},eachByDepthFirst:function(s,D,S){if(D)return this._11I(s,D,S);for(var h=0,c=this._roots,y=c.size();y>h;h++)if(this._11I(s,c.get(h),S)===!1)return!1;return!0},_11I:function(Y,C,W){for(var w=C.size(),f=0;w>f;f++)if(this._11I(Y,C.getChildAt(f),W)===!1)return!1;if(W){if(Y.call(W,C)===!1)return!1}else if(Y(C)===!1)return!1;return!0},eachByBreadthFirst:function(C,X,M){var x=new Od;for(X?x.add(X):this._roots.each(x.add,x);x.size()>0;)if(X=x.removeAt(0),X.eachChild(x.add,x),M){if(C.call(M,X)===!1)return!1}else if(C(X)===!1)return!1;return!0},moveTo:function(y,C){var R=this.getSiblings(y),z=R.indexOf(y);z===C||0>z||C>=0&&C<=R.size()&&(R.remove(y),C>R.size()&&C--,R.add(y,C),this._38I(y,z,C))},moveUp:function(d){this.moveTo(d,this.getSiblings(d).indexOf(d)-1)},moveDown:function(u){this.moveTo(u,this.getSiblings(u).indexOf(u)+1)},moveToTop:function(B){this.moveTo(B,0)},moveToBottom:function(q){this.moveTo(q,this.getSiblings(q).size())},moveSelectionUp:function(j){this.beginTransaction(),j||(j=this.sm());var q=new Od;_l(j,q,this._roots),q.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(w){this.beginTransaction(),w||(w=this.sm());var a=new Od;nk(w,a,this._roots),a.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(I){this.beginTransaction(),I||(I=this.sm());var F=new Od;Rk(I,F,this._roots),F.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(u){this.beginTransaction(),u||(u=this.sm());var d=new Od;om(u,d,this._roots),d.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(T,l,$){var Q=this.getDatas();null==$&&($=Q.indexOf(T)),$===l||0>$||l>=0&&l<=Q.size()&&(Q.remove(T),l>Q.size()&&l--,Q.add(T,l),this._76I(T,$,l))},bringForward:function(W){this.moveToIndex(W,this.getDatas().indexOf(W)+1)},bringToFront:function(k){this.moveToIndex(k,this.size())},sendBackward:function(W){this.moveToIndex(W,this.getDatas().indexOf(W)-1)},sendToBack:function(n){this.moveToIndex(n,0)},bringSelectionForward:function(a){this.beginTransaction(),a||(a=this.sm());for(var H=new Od,$=this.getDatas(),V=!1,v=0;v<$.size();v++){var T=$.get($.size()-1-v);a.contains(T)?V&&H.add(T):V=!0}H.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(l){this.beginTransaction(),l||(l=this.sm());for(var v=new Od,C=this.getDatas(),$=0;$<C.size();$++){var D=C.get($);l.contains(D)&&v.add(D)}v.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(Q){this.beginTransaction(),Q||(Q=this.sm());for(var G=new Od,W=this.getDatas(),s=!1,e=0;e<W.size();e++){var k=W.get(e);Q.contains(k)?s&&G.add(k):s=!0}G.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(h){this.beginTransaction(),h||(h=this.sm());for(var W=new Od,p=this.getDatas(),A=0;A<p.size();A++){var k=p.get(p.size()-1-A);h.contains(k)&&W.add(k)}W.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(J){var K=this;K.removeScheduleTask(J),J.enabled==$&&(J.enabled=!0),J.interval==$&&(J.interval=10),J.lastTime=Date.now(),K._29Q.push(J),K._30Q==$&&(K._30Q=C.requestAnimationFrame(K._scheduleCallback))},removeScheduleTask:function(S){var a=this,F=a._29Q,D=F.indexOf(S);D>=0&&F.splice(D,1),F.length||a._30Q==$||(C.cancelAnimationFrame(a._30Q),delete a._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(m){this._historyManager||new A.HistoryManager(this),null!=m&&this._historyManager.setMaxHistoryCount(m),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(Y){this._historyManager&&this._historyManager.undo(Y)},redo:function(C){this._historyManager&&this._historyManager.redo(C)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(d){this._historyManager&&this._historyManager.addHistory(d)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(Z){Z?this._isDeserializing++:this._isDeserializing--},updateLayoutAttach:function(g){this.each(function(o){o instanceof Qh&&o.getImage()===g&&o.updateLayoutAttaches()})},isCubicEnvmap:function(){return!1},setCubicEnvmap:function(){},setEnvmap:function(Y){var J=this._envmap;this._envmap=Y,"object"==typeof J&&"object"==typeof Y&&(J=null),this.fp("envmap",J,Y)}});var ak=A.SelectionModel=function(T){var X=this;X._68O=Qj,X._map={},X._73O=new Od,X._74I=new lm,X._21I(T)};Mf("SelectionModel",b,{ms_fire:1,ms_dm:1,ms:function(h,W,E){this.addSelectionChangeListener(h,W,E)},ums:function(v,w){this.removeSelectionChangeListener(v,w)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===Wb},co:function(X){return this._map[X._id]!=$},ss:function(M){this.setSelection(M)},as:function(M){this.appendSelection(M)},rs:function(X){this.removeSelection(X)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(X){var F=this;if(F._68O!==X&&(X===hh||X===Wb||X===Qj)){F.cs();var $=F._68O;F._68O=X,F.fp("selectionMode",$,X)}},_21I:function(r){var b=this,R=b._dataModel;R!==r&&(R&&(b.cs(),R.umm(b.handleDataModelChange,b)),b._dataModel=r,r.mm(b.handleDataModelChange,b,!0),b.fp(Xm,R,r))},dispose:function(){var y=this;y.cs(),y._dataModel.umm(y.handleDataModelChange,y)},handleDataModelChange:function(T){var j=this;if(T.kind===Vc){var I=T.data;j.co(I)&&(j._73O.remove(I),delete j._map[I._id],j._75I(Vc,new Od(I)))}else T.kind===vo&&j.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function($){var y=this;if(y._filterFunc!==$){y.cs();var R=y._filterFunc;y._filterFunc=$,y.fp("filterFunc",R,y._filterFunc)}},_75I:function(Y,w,Z,c){Z&&(this._73O.each(function(I){c[I._id]?Z.remove(I):Z.add(I)}),w=Z.toList()),this._74I.fire({kind:Y,datas:new Od(w)})},addSelectionChangeListener:function(d,M,v){this._74I.add(d,M,v)},removeSelectionChangeListener:function(Y,_){this._74I.remove(Y,_)},_97O:function(T,g){for(var p,t=this,w=0,Z=new Od(T);w<Z.size();w++)p=Z.get(w),(t._filterFunc&&!t._filterFunc(p)||g&&t.co(p)||!g&&!t.co(p)||!t._dataModel.contains(p))&&(Z.removeAt(w),w--);return Z},appendSelection:function(m){var G=this;if(G._68O!==hh){var z,J,b=G._73O,R=G._97O(m,!0);R.isEmpty()||(G.sg()&&(z=new Od(b),J=G._map,b.clear(),G._map={},R=new Od(R.get(R.size()-1))),R.each(function(C){b.add(C),G._map[C._id]=C}),G._75I("append",R,z,J))}},removeSelection:function(Z){var m=this,d=m._97O(Z),L=0,S=d.size();if(0!==S){for(;S>L;L++){var h=d.get(L);m._73O.remove(h),delete m._map[h._id]}m._75I(Vc,d)}},toSelection:function(i,b){return this._73O.toList(i,b)},getSelection:function(){return this._73O},each:function(I,d){this._73O.each(I,d)},setSelection:function(l){var e=this,S=e._73O;if(e._68O!==hh&&!(S.isEmpty()&&!l||1===S.size()&&e.ld()===l)){var I=new Od(S),q=e._map;S.clear(),e._map={};var _=e._97O(l,!0);e.sg()&&_.size()>1&&(_=new Od(_.get(_.size()-1))),_.each(function(O){S.add(O),e._map[O._id]=O}),e._75I("set",$,I,q)}},clearSelection:function(){var C=this,m=C._73O;if(m.size()>0){var c=m.toList();m.clear(),C._map={},C._75I(vo,c)}},selectAll:function(){var F=this;if(F._68O!==hh){var y,g,h=F._dataModel.toDatas();if(F._filterFunc)for(y=0;y<h.size();y++)g=h.get(y),F._filterFunc(g)||(h.removeAt(y),y--);var T=F._73O,l=new Od(T),u=F._map;T.clear(),F._map={},F.sg()&&h.size()>1&&(h=new Od(h.get(h.size()-1)));var R=h.size();for(y=0;R>y;y++)g=h.get(y),T.add(g),F._map[g._id]=g;F._75I("all",$,l,u)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(h){return this._map[h._id]!=$},getLastData:function(){var L=this._73O;return L.size()>0?L.get(L.size()-1):$},getFirstData:function(){var e=this._73O;return e.size()>0?e.get(0):$},isSelectable:function(s){var Y=this;return s&&Y._68O!==hh?Y._filterFunc?Y._filterFunc(s):!0:!1},getTopSelection:function(){var Q=this,L=new Od;return Q._73O.each(function(m){for(var G=m.getParent();G;){if(Q.contains(G)){m=$;break}G=G.parent}m&&L.add(m)}),L}});var Le=function(){return ve(0),function(H,U){var K;if(Ec(U)){var X=H.getDataUI(U);X&&X._88I&&(K=X._88I.rect)}return K?K:U.getRect()}}();hf(u,{edgeGroupAgentFunc:$,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:p.rectSelectBorder,graphViewRectSelectBackground:Sc,graphViewEditPointSize:Ze?17:7,graphViewEditPointBorderColor:p.editPointBorder,graphViewEditPointBackground:p.editPointBackground,setEdgeType:function(Q,n,Y){Se[Q]=n,Cl[Q]=Y},getEdgeType:function($){return Se[$]},getEdgeTypeMap:function(){return Se},getNodeRect:Le},!0);var nq={"layout.h":r,"layout.v":r,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":r,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:r,ingroup:!0,"body.color":r,"2d.gray":!1,fullscreen:r,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:r,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"vector.layoutable":!1,"clip.direction":"top","clip.percentage":r,"select.color":qo,"select.width":1,"select.padding":2,"select.type":Ne,"shadow.interactable":!0,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,shadow2:!1,"shadow2.color":qo,"shadow2.blur":6,"shadow2.offset.x":3,"shadow2.offset.y":3,"border.color":r,"border.width":2,"border.padding":2,"border.type":Ne,label:r,"label.font":r,"label.color":ii,"label.background":r,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":r,"label.max":r,"label.opacity":r,"label.scale":1,"label.align":r,"label.selectable":!0,"label.decoration":r,label2:r,"label2.font":r,"label2.color":ii,"label2.background":r,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":r,"label2.max":r,"label2.opacity":r,"label2.scale":1,"label2.align":r,"label2.selectable":!0,"label2.decoration":r,note:r,"note.expanded":!0,"note.font":r,"note.color":Sd,"note.background":qo,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":r,"note.toggleable":!0,"note.border.width":1,"note.border.color":r,"note.opacity":r,"note.scale":1,"note.align":r,note2:r,"note2.expanded":!0,"note2.font":r,"note2.color":Sd,"note2.background":qo,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":r,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":r,"note2.opacity":r,"note2.scale":1,"note2.align":r,"group.type":r,"group.image":r,"group.image.stretch":"fill","group.repeat.image":r,"group.border.repeat.image":r,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":r,"group.title.color":Sd,"group.title.background":p.groupTitleBackground,"group.title.align":sl,"group.title.orientation":Yd,"group.background":p.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":r,"group.border.color":tm,"group.border.radius":r,"group.border.cap":ng,"group.border.join":hg,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":$,"group.gradient.color":"#FFF",shape:r,"shape.background":tm,"shape.repeat.image":r,"shape.border.repeat.image":r,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":tm,"shape.border.3d":!1,"shape.border.3d.color":r,"shape.border.3d.accuracy":r,"shape.border.cap":ng,"shape.border.join":hg,"shape.border.pattern":r,"shape.gradient":$,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":Oj,"shape.dash.offset":0,"shape.dash.color":uq,"shape.dash.width":r,"shape.dash.3d":!1,"shape.dash.3d.color":r,"shape.dash.3d.accuracy":r,"shape.polygon.side":6,"shape.arc.from":Z,"shape.arc.to":g,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":r,"shape.gradient.pack":r,"shape.border.gradient.pack":r,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":r,"shape.foreground":r,"shape.foreground.gradient":$,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":r,"shape.regular":!0,"autolayout.gap":r,"autolayout.hgap":r,"autolayout.vgap":r,"edge.type":r,"edge.points":r,"edge.segments":r,"edge.color":tm,"edge.width":2,"edge.width.absolute":!1,"edge.repeat.image":null,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":r,"edge.3d.accuracy":r,"edge.cap":ng,"edge.join":hg,"edge.source.position":17,"edge.source.anchor.x":r,"edge.source.anchor.y":r,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":r,"edge.target.anchor.y":r,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":r,"edge.dash":!1,"edge.dash.pattern":Oj,"edge.dash.offset":0,"edge.dash.color":uq,"edge.dash.width":r,"edge.dash.3d":!1,"edge.dash.3d.color":r,"edge.dash.3d.accuracy":r,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":r,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":r,"grid.column.percents":r,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":p.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":p.gridCellBorderColor,"grid.block":r,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":p.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":ii,"text.gradient.pack":r,"text.font":jq,"text.shadow":!1,"text.shadow.color":qo,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,"text.gradient":r,"text.gradient.color":"#FFF","text.decoration":r,"text.vertical":!1,"text.vertical.gap":1,"text.wrap":!1,"text.letter.gap":null,"text.border.color":qo,"text.border.width":0,keepPosition:!0};nq[Nc]=r,hf(x,nq,!0),hf(Or,{_76I:function(N,c,t){this._39I&&this._39I.fire({data:N,oldIndex:c,newIndex:t})},addIndexChangeListener:function(s,m,B){var A=this;A._39I||(A._39I=new lm),A._39I.add(s,m,B)},removeIndexChangeListener:function(c,X){this._39I.remove(c,X)},prepareRemove:function(Z){Sl(Z)&&(Z.setSource($),Z.setTarget($)),Z._70O&&Z._70O.toList().each(this.remove,this),Z._69O&&Z._69O.toList().each(function(N){N.setHost($)}),Z._host&&Z.setHost($)},onAdded:function(x){this.isAutoAdjustIndex()&&this.adjustIndex(x)},onDataPropertyChanged:function(n,t){kg[t.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(n)},isAdjustable:function(s){return Dk(s)||Sl(s)},isAdjustedToBottom:function(q){return db(q)?q.isExpanded()&&Am(q):!1},adjustIndex:function(r){var L=this;this.isHierarchicalRendering()||(L.isAdjustedToBottom(r)?(L.sendToBottom(r),r.eachChild(L.adjustIndex,L)):L.sendToTop(r))},sendToTop:function(l){var s=this;if(s.contains(l)&&s.isAdjustable(l)){var O=s._datas;if(l!==O.get(s.size()-1)){var n=O.indexOf(l);O.removeAt(n),O.add(l),s._76I(l,n,s.size()-1)}if(Sl(l)){var j=l._40I;j&&!s.isAdjustedToBottom(j)&&s.sendToTop(j),j=l._41I,j&&!s.isAdjustedToBottom(j)&&s.sendToTop(j)}l._69O&&l._69O.each(function(N){N.isRelatedTo(l)||Dk(l)&&N.isLoopedHostOn(l)||s.sendToTop(N)}),l.ISubGraph||(!db(l)||l.isExpanded())&&l._adjustChildrenToTop&&l.eachChild(function(q){Sl(q)||s.sendToTop(q)})}},sendToBottom:function(g,v){var F=this;if(g!==v&&F.contains(g)&&F.isAdjustable(g)&&(!v||F.contains(v))){var Q=F._datas,q=Q.remove(g),x=v?F._datas.indexOf(v):0;if(Q.add(g,x),q!==x){F._76I(g,q,x);var D=g._parent;!D||D.ISubGraph||Sl(D)||F.sendToBottom(g._parent,g)}}}}),hf(Wi,{ms_edit:function(f){f._46O=function(r){var d=this,H=d.gv.dm(),V=d._index,Q=d._89I,N=d._node,i=d._shape,_=d._edge,t=d._77I;N&&Q?(this.fi({kind:"endEditRect",event:r,data:N,direction:Q}),H.endTransaction()):i&&V>=0?(d.fi({kind:"endEditPoint",event:r,data:i,index:V}),H.endTransaction()):_&&V>=0?(d.fi({kind:"endEditPoint",event:r,data:_,index:V}),H.endTransaction()):t&&(d.fi({kind:"endEditRotation",event:r,data:t}),H.endTransaction())},f._78I=function(O){var i=this;i.autoScroll(O);var B=i.gv.lp(O),u=i._index,y=i._89I,Y=i._node,A=i._shape,M=i._edge,l=i._77I;if(Y&&y)i._80O(B),i.fi({kind:"betweenEditRect",event:O,data:Y,direction:y});else if(A&&u>=0)B.e=A.getPoints().get(u).e,A.setPoint(u,B),i.fi({kind:"betweenEditPoint",event:O,data:A,index:u});else if(M&&u>=0){var N=M.s(sp);B.e=N.get(u).e,N.set(u,B),M.fp(sp,$,N),i.fi({kind:"betweenEditPoint",event:O,data:M,index:u})}else if(l){var I=l.p(),x=l.getScale(),d=Ce+ys(B.y-I.y,B.x-I.x);x.y<0&&(d+=Z),k(d)<.04&&(d=0),l.setRotation(d),i.fi({kind:"betweenEditRotation",event:O,data:l})}},f._80O=function(H){var v=this,p=v._node,O=v._rect,W=O.x,Q=O.y,e=O.width,d=O.height,b=v._89I,B=v._anchor,Z=v._matrix,H=Z.tfi(H);"northwest"===b?O=Tg(H,{x:W+e,y:Q+d}):b===Yb?O=Tg({x:W,y:H.y},{x:W+e,y:Q+d}):"northeast"===b?O=Tg({x:W,y:H.y},{x:H.x,y:Q+d}):b===ui?O=Tg({x:H.x,y:Q},{x:W+e,y:Q+d}):b===zd?O=Tg({x:W,y:Q},{x:H.x,y:Q+d}):"southwest"===b?O=Tg({x:H.x,y:Q},{x:W+e,y:H.y}):"south"===b?O=Tg({x:W,y:Q},{x:W+e,y:H.y}):"southeast"===b&&(O=Tg({x:W,y:Q},H)),p.setPosition(Z.tf(O.x+O.width*B.x,O.y+O.height*B.y)),p.setWidth(O.width),p.setHeight(O.height)},f._80I=function(N,A,d,C){var T=this,v=T.gv._zoom,p=(T.gv.getEditPointSize()+2)/v;return oe({x:A-p/2,y:d-p/2,width:p,height:p},N)?(T._89I!==C&&(T._89I=C),!0):!1},f._79I=function(R,E,K){var S=this,O=S.gv,l=E?O.getDataUI(E):$,Z=l?l._55O:$;if(Z){var j,r,Y,J,D=O._zoom,A=(O.getEditPointSize()+2)/D,G=O.lp(R);if(Dk(E)){if(Z._56O&&Dk(E)&&(r=Z._98o,oe({x:r.x-A/2,y:r.y-A/2,width:A,height:A},G)))return S._77I=E,K&&S.fi({kind:"beginEditRotation",event:R,data:E}),S.setCursor("crosshair"),!0;if(Z._43O&&E instanceof ck)for(Y=E.getPoints(),j=Y.size()-1;j>=0;j--)if(r=Y.get(j),oe({x:r.x-A/2,y:r.y-A/2,width:A,height:A},G))return S._index=j,S._shape=E,K&&S.fi({kind:"beginEditPoint",event:R,data:E,index:j}),S.setCursor("crosshair"),!0;if(Z._42O)for(var H=E.getEditControlPoints(),W=["northwest",-1,-1,ui,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,zd,1,0,"northeast",1,-1,Yb,0,-1],j=0,J=H.length;J>j;j++){var p=W[3*j],_=H[j];if(S._80I(G,_.x,_.y,p)){S._node=E;var B=E.getWidth(),F=E.getHeight(),o=E.getAnchor();S._rect={x:-B*o.x,y:-F*o.y,width:B,height:F},S._anchor=o,S._matrix=E.getMatrix();var f=E.getRotation(),y=m(f),u=X(f),P=W[3*j+1]*Hm(E.getScale().x),V=W[3*j+2]*Hm(E.getScale().y),q=Math.atan2(-u*P-y*V,y*P-u*V),C=(Math.round(q/(Math.PI/4))+8)%8,c=[Bm,"nesw-resize",xr,"nwse-resize",Bm,"nesw-resize",xr,"nwse-resize"][C];return S.setCursor(c),K&&S.fi({kind:"beginEditRect",event:R,data:E,direction:S._89I}),!0}}}if(Z._43O&&Sl(E)&&E.s(uf)===no&&(Y=E.s(sp)))for(j=Y.size()-1;j>=0;j--)if(r=Y.get(j),oe({x:r.x-A/2,y:r.y-A/2,width:A,height:A},G))return S._index=j,S._edge=E,K&&S.fi({kind:"beginEditPoint",event:R,data:E,index:j}),S.setCursor("crosshair"),!0}return!1}},ms_gv:function(n){n._currentSubGraph=$,n._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},n.upSubGraph=function(){this.setCurrentSubGraph(_r(this._currentSubGraph))},n.isVisible=function(t){var p=this;if(_r(t)!==p._currentSubGraph)return!1;if(Sl(t)){var C=t._40I,m=t._41I;if(!C||!m)return!1;if(!(t.s("edge.independent")||p.isVisible(C)&&p.isVisible(m)))return!1;if(t.isEdgeGroupHidden())return!1}else for(var T=t._parent;T&&!T.ISubGraph;){if(db(T)&&(!T.isExpanded()||!p.isVisible(T)))return!1;T=T._parent}if(t._parent instanceof el&&!p.isVisible(t._parent))return!1;if(t._refGraph instanceof Cd&&!p.isVisible(t._refGraph))return!1;if(p instanceof Es){if(!t.s("3d.visible"))return!1}else{var B=p.getLayersInfo();if(B){var u=B[t._layer];if(u&&u.visible===!1)return!1}if(!t.s("2d.visible"))return!1}return p._visibleFunc?p._visibleFunc(t):!0},n.handleSelectionChange=function(k){var g=this;k.datas.each(function(h){g.invalidateData(h);var j=h._parent;db(j)&&Dk(h)&&h.s(cg)&&(g.invalidateData(j),j._49I&&j._49I.each(function(S){g.invalidateData(S)}))}),g.onSelectionChanged(k)},n.onSelectionChanged=function(o){var y=this,d=y.sm();if(1===d.size()&&("set"===o.kind||"append"===o.kind)){var D=d.ld();y.isAutoMakeVisible()&&y.makeVisible(D),y.adjustIndex&&y._dataModel.isAutoAdjustIndex()&&y.adjustIndex(D)}},n.makeVisible=function(C){if(C){var d=this,b=d.getDataUI?d.getDataUI(C):d.getData3dUI(C);if(b){var D=C,f=_r(C);for(f!==d._currentSubGraph&&d.setCurrentSubGraph(f);(D=D._parent)&&D!==f;)db(D)&&D.setExpanded(!0);d._23I=C,d.iv()}}},n.getLabel=function(e){var d=e.getStyle(Ni);return d===r?e.getName():d},n.getLabelBackground=function(G){return G.getStyle("label.background")},n.getLabelColor=function(A){return A.getStyle("label.color")},n.getLabel2=function(T){return T.getStyle("label2")},n.getLabel2Background=function(D){return D.getStyle("label2.background")},n.getLabel2Color=function(t){return t.getStyle("label2.color")},n.getNote=function(g){return g.getStyle(sf)},n.getNoteBackground=function(u){return u.getStyle("note.background")},n.getNote2=function(Q){return Q.getStyle(_b)},n.getNote2Background=function(V){return V.getStyle("note2.background")},n.handleClick=function(u,J,V){var E=this;J?(E.fi({kind:"clickData",event:u,data:J,part:V}),E.onDataClicked(J,u)):(E.fi({kind:"clickBackground",event:u}),E.onBackgroundClicked(u))
},n.handleDoubleClick=function(B,t,J){var W=this;ok(B)&&(t?(W.fi({kind:"doubleClickData",event:B,data:t,part:J}),W.onDataDoubleClicked(t,B,J),W.checkDoubleClickOnNote(B,t,J)||W.checkDoubleClickOnRotation&&W.checkDoubleClickOnRotation(B,t,J)||(Sl(t)?W.onEdgeDoubleClicked(t,B,J):t.ISubGraph?W.onSubGraphDoubleClicked(t,B,J):db(t)?W.onGroupDoubleClicked(t,B,J):t.IDoorWindow?W.onDoorWindowDoubleClicked(t,B,J):t.ICSGBox&&W.onCSGBoxDoubleClicked(t,B,J))):(W.fi({kind:"doubleClickBackground",event:B}),W.onBackgroundDoubleClicked(B)))},n.onSubGraphDoubleClicked=function(r){this.setCurrentSubGraph(r)},n.onEdgeDoubleClicked=function(c,d){this.isEditable(c)||(c.ISubGraph&&!ao(d)?this.setCurrentSubGraph(c):c.s("edge.toggleable")&&c.toggle())},n._39Q=function(z){return this.isInteractive(z)?this.preventDefaultWhenInteractive(z):!1},n.preventDefaultWhenInteractive=function(X){return X.s("preventDefaultWhenInteractive")},n.onGroupDoubleClicked=function(N){N.s("group.toggleable")&&N.toggle()},n.onDoorWindowDoubleClicked=function(H){H.s("dw.toggleable")&&H.toggle(!0)},n.onCSGBoxDoubleClicked=function(d,f){var T=this;if(T instanceof Es){var N=T.intersectObject(f,d);N&&d.s(N.part+".toggleable")&&d.toggleFace(N.part,!0)}},n.onBackgroundClicked=function(){},n.onBackgroundDoubleClicked=function(){this.upSubGraph()},n.onDataClicked=function(){},n.onDataDoubleClicked=function(){},n.onAutoLayoutEnded=function(){},n.onMoveEnded=function(){},n.onPanEnded=function(){},n.onPinchEnded=function(){},n.onRectSelectEnded=function(){},n.onZoomEnded=function(){},n.serialize=function(t){return this.dm().serialize(t)},n.toJSON=function(){return this.dm().toJSON()},n.deserialize=function(j,a){var H=this;a=a instanceof $h?{rootParent:a}:xn(a)?{setId:a}:Xp(a)?{finishFunc:a}:a||{},a.view=H;var X=H.dm();return a.reset&&(X.setAttrObject({}),X.setLayers(r),X.setName(r),X.setAutoAdjustIndex(!0),X.setHierarchicalRendering(!1),X.setBackground(r),X.setInit(r),X.setPostProcessingData(r),X.setEnvmap(r),X.setEnvmapType(r),H.disableToolTip(),H instanceof A.graph.GraphView?(H.setZoomable(u.graphViewZoomable),H.setPannable(u.graphViewPannable),H.setRectSelectable(u.graphViewRectSelectable)):H instanceof A.graph3d.Graph3dView&&(H.shadowMap.resetProperties(),H.setDashDisabled(u.graph3dViewDashDisabled),H.setUvClipEnabled(u.graph3dViewUvClipEnabled),H.getHighlightHelper().resetProperties(),H.resetHeadlightProperties(),H.resetFogProperties(),H.setBatchInfoMap({}),H.setBatchColorDisabled(u.graph3dViewBatchColorDisabled),H.setBatchInstancedDisabled(u.graph3dViewBatchInstancedDisabled),H.setBatchBlendDisabled(u.graph3dViewBatchBlendDisabled),H.setBatchBrightnessDisabled(u.graph3dViewBatchBrightnessDisabled),H.setFlowBlendMode(u.graph3dViewFlowBlendMode),H.setMoveStep(u.graph3dViewMoveStep),H.setRotateStep(u.graph3dViewRotateStep),H.setSortable(u.graph3dViewSortable),H.setSortFunc(r),H.setSkybox(r),Cf(H))),a.__innerHandler__=function(c){if(xn(X.a("toolTipEnable"))&&(X.a("toolTipEnable")?H.enableToolTip():H.disableToolTip()),H instanceof A.graph.GraphView&&(xn(X.a("zoomable"))&&H.setZoomable&&H.setZoomable(X.a("zoomable")),xn(X.a("pannable"))&&H.setPannable&&H.setPannable(X.a("pannable")),xn(X.a("rectSelectable"))&&H.setRectSelectable&&H.setRectSelectable(X.a("rectSelectable")),X.a("fitContent")===!0&&H.fitContent&&H.fitContent(!0,0)),H instanceof A.graph3d.Graph3dView){var g=c.scene;g&&g.shadow!=$&&H.shadowMap.setShadow(g.shadow,g.shadowParams);var C=X.a("sceneContext");C?(C.eye&&H.setEye(C.eye),C.center&&H.setCenter(C.center),fl(C.far)&&H.setFar(C.far),fl(C.near)&&H.setNear(C.near)):(fl(X.a("sceneNear"))&&H.setNear(X.a("sceneNear")),fl(X.a("sceneFar"))&&H.setFar(X.a("sceneFar")),g&&(g.eye&&H.setEye(g.eye),g.center&&H.setCenter(g.center))),xn(X.a("sceneShadowEnabled"))&&(X.a("sceneShadowEnabled")?H.enableShadow():H.disableShadow()),fl(X.a("sceneShadowDegreeX"))&&H.setShadowDegreeX(X.a("sceneShadowDegreeX")),fl(X.a("sceneShadowDegreeZ"))&&H.setShadowDegreeZ(X.a("sceneShadowDegreeZ")),fl(X.a("sceneShadowIntensity"))&&H.setShadowIntensity(X.a("sceneShadowIntensity")),X.a("sceneShadowQuality")!=$&&H.setShadowQuality(X.a("sceneShadowQuality")),X.a("sceneShadowType")&&H.setShadowType(X.a("sceneShadowType")),fl(X.a("sceneShadowRadius"))&&H.setShadowRadius(X.a("sceneShadowRadius")),fl(X.a("sceneShadowBias"))&&H.setShadowBias(X.a("sceneShadowBias")),xn(X.a("sceneDashEnable"))&&H.setDashDisabled(!X.a("sceneDashEnable")),xn(X.a("sceneUvClipEnabled"))&&H.setUvClipEnabled(X.a("sceneUvClipEnabled")),ph(X.a("sceneHighlightMode"))&&H.setHighlightMode(X.a("sceneHighlightMode")),fl(X.a("sceneHighlightWidth"))&&H.setHighlightWidth(X.a("sceneHighlightWidth")),X.a("sceneHighlightColor")&&H.setHighlightColor(X.a("sceneHighlightColor")),X.a("sceneHighlightType")&&H.setHighlightType(X.a("sceneHighlightType")),X.a("sceneHighlightGlow")&&H.setHighlightGlow(X.a("sceneHighlightGlow")),X.a("sceneHighlightStrength")&&H.setHighlightStrength(X.a("sceneHighlightStrength")),xn(X.a("sceneHeadlightEnable"))&&H.setHeadlightDisabled(!X.a("sceneHeadlightEnable")),X.a("sceneHeadlightDirection")!=$&&H.setHeadlightDirection(X.a("sceneHeadlightDirection")),fl(X.a("sceneHeadlightRange"))&&H.setHeadlightRange(X.a("sceneHeadlightRange")),X.a("sceneHeadlightColor")&&H.setHeadlightColor(X.a("sceneHeadlightColor")),fl(X.a("sceneHeadlightIntensity"))&&H.setHeadlightIntensity(X.a("sceneHeadlightIntensity")),fl(X.a("sceneHeadlightAmbientIntensity"))&&H.setHeadlightAmbientIntensity(X.a("sceneHeadlightAmbientIntensity")),fl(X.a("sceneHeadlightGroup"))&&H.setHeadlightGroup(X.a("sceneHeadlightGroup")),xn(X.a("sceneFogEnable"))&&H.setFogDisabled(!X.a("sceneFogEnable")),X.a("sceneFogMode")&&H.setFogMode(X.a("sceneFogMode")),fl(X.a("sceneFogDensity"))&&H.setFogDensity(X.a("sceneFogDensity")),X.a("sceneFogColor")&&H.setFogColor(X.a("sceneFogColor")),fl(X.a("sceneFogNear"))&&H.setFogNear(X.a("sceneFogNear")),fl(X.a("sceneFogFar"))&&H.setFogFar(X.a("sceneFogFar")),xn(X.a("sceneBatchBrightnessDisabled"))&&H.setBatchBrightnessDisabled(X.a("sceneBatchBrightnessDisabled")),X.a("sceneFlowBlendMode")!==r&&H.setFlowBlendMode(X.a("sceneFlowBlendMode")),xn(X.a("sceneBatchBlendDisabled"))&&H.setBatchBlendDisabled(X.a("sceneBatchBlendDisabled")),xn(X.a("sceneBatchColorDisabled"))&&H.setBatchColorDisabled(X.a("sceneBatchColorDisabled")),xn(X.a("sceneBatchInstancedDisabled"))&&H.setBatchInstancedDisabled(X.a("sceneBatchInstancedDisabled")),X.a("sceneBatchInfoMap")&&H.setBatchInfoMap(X.a("sceneBatchInfoMap")),fl(X.a("sceneMoveStep"))&&H.setMoveStep(X.a("sceneMoveStep")),fl(X.a("sceneRotateStep"))&&H.setRotateStep(X.a("sceneRotateStep")),xn(X.a("sceneSortable"))&&H.setSortable(X.a("sceneSortable")),Xp(X.a("sceneSortFunc"))&&H.setSortFunc(X.a("sceneSortFunc"));var O=X.a("sceneSkyboxType")||"sphere";if(O!=$){var Y={},b=!1;if("sphere"===O){Y.shape3d=O;var W=X.a("sceneSkyboxImage");W&&(Y["shape3d.image"]=W,b=!0)}else"cube"===O?(Y.shape3d=r,["front","back","left","right","top","bottom"].forEach(function(M){var u=M+".image",T=M.charAt(0).toUpperCase()+M.slice(1),j=X.a("sceneSkybox"+T+"Image");j&&(Y[u]=j,b=!0)})):"color"===O&&(b=!0);if(b){var L=new Qh,p=X.a("sceneSkyboxDiameter");if(fl(p)?L.s3(p,p,p):L.s3(20,20,20),Y["body.color"]=X.a("sceneSkyboxBodyColor"),Y.envmap=X.a("sceneSkyboxEnvmap"),Y["envmap.probe"]=X.a("sceneSkyboxEnvmapProbe"),Y.roughness=X.a("sceneSkyboxRoughness"),Y["shape3d.light"]=Y["all.light"]=X.a("sceneSkyboxLight"),Y["light.mask"]=X.a("sceneSkyboxLightMask"),Y["headlight.ambientIntensity"]=X.a("sceneSkyboxHeadLightAmbientIntensity"),Y["texture.wrap"]="clampToEdge",Y["3d.clipbox.mask"]=Ak,Y["effect.flow.mask"]=Ak,"color"===O){Y.shape3d="sphere";var q=2,S=1024,W=L.s("shape3d.image"),h=W&&A.Default.getImage(W);h&&"CANVAS"===h.tagName||(h=G.createElement("canvas"),W=A.Math.generateUUID(),A.Default.setImage(W,h)),W&&H.getTextureMap()&&H.deleteTexture(W),A.Default.setCanvas(h,q,S,1);var t=h.getContext("2d");t.clearRect(0,0,q,S),t.beginPath(),t.rect(0,0,q,S),kn(t,X.a("sceneSkyboxColor"),function(V){return V},!1,{x:0,y:0,width:q,height:S}),t.fill(),t.restore(),Y["shape3d.image"]=W}L.s(Y),["X","Y","Z"].forEach(function(y){var B=X.a("sceneSkyboxRotation"+y);fl(B)&&L["setRotation"+y](B)}),H.setSkybox(L)}}}},X.deserialize(j,a.rootParent,a)},n.isDebugTipShowing=function(){return!!this._debugDiv},n.showDebugTip=function(){var q=this,N=q._debugDiv;if(!N){N=q._debugDiv=G.createElement("div"),N.style.position="absolute",N.style.overflow="hidden",N.style.font=u.debugTipLabelFont,N.style.padding="6px",N.style.backgroundColor=u.debugTipBackground,N.style.color=u.debugTipLabelColor;var e=q.getView();q._79O?e.insertBefore(N,q._79O):e.appendChild(N);var a=function(){q.redraw();var H=q._canvas,e="FPS: "+q._fpsInfo.fps+"<br/>"+"Datas: "+q.dm().getDatas().length+(H?"<br/>Size: "+H.width+" * "+H.height:""),$=q.dm()._historyManager;$&&(e+="<br/>Undoes: "+$.getHistories().length+" index: "+$.getHistoryIndex());var x=q.getDebugTip();x&&(e+="<hr>"+x),N.innerHTML=e,q._isDebugging&&requestAnimationFrame(a)};requestAnimationFrame(a),q._isDebugging=!0}},n.hideDebugTip=function(){var g=this,x=g._debugDiv;x&&(delete g._debugDiv,g.getView().removeChild(x),g._isDebugging=!1)},n.updateDOMAppendMatrix=function(){var x=this.getView();x&&(x.updateAppendMatrix=!0)},n.countFrame=function(){if(this._isDebugging){var L=Date.now(),T=this._fpsInfo;L-T.time>1e3?(T.fps=Math.round(1e5*(T.frames+1)/(L-T.time))/100,T.time=L,T.frames=0):T.frames++}}},ms_icons:function(q){q.getRotation=function(T){return T==$?0:T},q._15O=function(){var l=this,D=l.s(vl);if(D){var b=l,v=l.data||l._data,S=v.getRotation&&v.getRotation(),J=l._38o={icons:D,rects:{}};for(var G in D){var e=D[G],I=Tp(e.shape3d,v,b);if(!(Tp(e.visible,v,b)===!1||Tp(e.for3d,v,b)&&!l.I3d||I&&!l.I3d)){var i=I?[I]:Tp(e.names,v,b),A=i?i.length:0,w=Tp(e.position,v,b)||3,L=Tp(e.offsetX,v,b)||0,y=Tp(e.offsetY,v,b)||0,p=Tp(e.direction,v,b)||zd,O=Tp(e.gap,v,b),Z=O!=$?O:1,Q=Tp(e.rotation,v,b),n=Tp(e.keepOrien,v,b),j=Tp(e.rotationFixed,v,b)?Q:l.getRotation(Q,n,w),R=$,H=J.rects[G]=new Array(A);fl(S)&&(fl(j)?j+=S:j=S),H.rotation=j;for(var k=0;A>k;k++){var N,c,h,W,x=i[k];if(I)h=0,W=0;else{var T=Of(x);h=Tp(e.width,v,b),W=Tp(e.height,v,b),h==$&&(h=Hn(T,v)),W==$&&(W=ks(T,v))}if(R?p===zd?L+=h/2:p===ui?L-=h/2:p===Yb?y-=W/2:y+=W/2:R={width:h,height:W},l.I3d){var f=-h/2,d=-W/2;c={width:h,height:W,mat:l._16O(Tp(e.autorotate,v,b),w,R,Tp(e.face,v,b)||Er,Tp(e.t3,v,b),Tp(e.r3,v,b),Tp(e.rotationMode,v,b),L,y),vs:new Ki([f,-d,0,f,-d-W,0,f+h,-d-W,0,f+h,-d,0])}}else N=l.getPosition(w,L,y,R,Tp(e.positionFixed,v,b)),c={x:N.x-h/2,y:N.y-W/2,width:h,height:W},l._68o(c,j);H[k]=c,p===zd?L+=h/2+Z:p===ui?L-=h/2+Z:p===Yb?y-=W/2+Z:y+=W/2+Z}}}}}}});var dq={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Qn={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},dm={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},kg={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Wk={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Il={"edge.type":1,"edge.group":1},Ff={rotation:1,rotationX:1,rotationZ:1,rotation3d:1},Qb={rotation:1,position:1,width:1,height:1,anchor:1,scale:1,host:1},qd={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},al={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Gq={shape:1,thickness:1,position:1,anchor:1,scale:1},_r=function(y){if(!y)return $;if(Sl(y)){var P=y._40I,o=y._41I;if(!P||!o)return $;var C=_r(P),J=_r(o);return C===J?C:$}for(var F=y._parent;Sl(F)&&!F.ISubGraph;)F=F._parent;return F?F.ISubGraph?F:_r(F):$},Hj=function(d,_,w,Y){var E=_.getStyle(w)*Y;E&&nh(d,E),E=_.getStyle(w+".left")*Y,E&&(d.x-=E,d.width+=E),E=_.getStyle(w+".right")*Y,E&&(d.width+=E),E=_.getStyle(w+".top")*Y,E&&(d.y-=E,d.height+=E),E=_.getStyle(w+".bottom")*Y,E&&(d.height+=E),d.width<0&&(d.width=-d.width,d.x-=d.width),d.height<0&&(d.height=-d.height,d.y-=d.height)},Am=function($){for(var d,O=0,H=$.size();H>O;O++)if(d=$.getChildAt(O),Dk(d)&&Am(d))return!0;return $.hasAgentEdges()},oo=function(f){if(!f)return $;for(var Q=f._parent;db(Q);){if(!db(Q._parent))return Q.isExpanded()?f:Q;Q.isExpanded()||(f=Q),Q=Q._parent}return f},Ie=function(q,h){if(!q||!h)return $;var R,p,W,E=_r(q),H=_r(h);if(E!==H){for(;H&&E!==H;)H=_r(H);if(E===H)return q;R=new Od,R.add(q,0);for(var o=q._parent;Dk(o)&&!h.isDescendantOf(o);)R.add(o,0),o=o._parent;for(W=R.size(),p=0;W>p;p++){var Z=R.get(p);if(db(Z)&&!Z.isExpanded())return Z;if(Z.ISubGraph)return Z}return q}return q},lq=function(o){if(o.isLooped())return o._source;var E=oo(o._source),$=oo(o._target);return E===$?o._source:Ie(E,$)},Gd=function(h){if(h.isLooped())return h._target;var r=oo(h._source),I=oo(h._target);return r===I?h._target:Ie(I,r)},lb=function(s,F,A){"target"!==A&&(A="source");var P="target"===A?F.getTargetAgent():F.getSourceAgent(),b="edge."+A+".";if(Sl(P)){var C=s.getDataUI(P);C._79o();var z=F.s(b+"index");if(z>=0){var I=kr(C);return I[Math.max(0,Math.min(z,I.length-1))]}var _=F.s(b+"percent")||0;_=Math.max(0,Math.min(_,1));var H=Sm(C);return Lf(H,100*_)}return Ad(s,P,F.s(b+"position"),F.s(b+"offset.x"),F.s(b+"offset.y"),F.s(b+"anchor.x"),F.s(b+"anchor.y"))},Ad=function(T,h,_,S,O,z,C){if(!h)return $;var j,e=h.getRotation?h.getRotation():0;if(z!==r||C!==r){z=z===r?.5:z,C=C===r?.5:C;var p=h.getScale();if(e&&!Ec(h,T)||p.x<0||p.y<0){var W=h.getPosition(),R=h.getWidth(),Y=h.getHeight(),J=h.getAnchor(),b=new nb(e,W.x,W.y,p.x,p.y);_=b.tf((z-J.x)*R,(C-J.y)*Y)}else j=Le(T,h),_={x:j.x+z*j.width,y:j.y+C*j.height}}else _=wi(_,Le(T,h));if(e){var d=m(e),t=X(e),f=S*d-O*t;O=S*t+O*d,S=f}return _.x+=S,_.y+=O,_},Jm=function(B,N){if(!B||!N)return $;var O,z,L,V,K,u;if(B===N){if(V=B.getLoopedEdges(),!V)return $;V=new Od(V)}else{if(K=B.getAgentEdges(),u=N.getAgentEdges(),!K||!u)return $;for(z=K.size(),O=0;z>O;O++)L=K.get(O),u.contains(L)&&(V||(V=new Od),V.add(L))}if(V)for(O=0;O<V.size();O++)L=V.get(O),L.getStyle(uf)===no&&(L._22I($),V.removeAt(O),O--);return V},Yp=function(F,x){var K=Jm(F,x);if(K&&!K.isEmpty()){if(1===K.size())return K.get(0)._22I($),void 0;var d=new Od,C=new Od;K.each(function(i){var g=i.s("edge.group");d.contains(g)||d.add(g)}),d.sort(),d.each(function(V){C.add(new A.EdgeGroup(K.toList(function(J){return V===J.s("edge.group")}),C))}),C.each(function(J){J.each(function(k){k._22I(J)})})}},Ln=function(J,z,r){var H=J._canvas;J._zoom;var D=Xr(z,H),d=Xr(r,H);return{x:D.x-d.x,y:D.y-d.y}},Ek=function(W,g){if(g){var M=g.rect,h=g.color,j=g.rotation,N=g.labelWidth,U=g.background,R=g.opacity,G=g.scale,q=G!=$&&1!==G;if(R!=$){var F=W.globalAlpha;W.globalAlpha*=R}if(j||q){W.save();var z=M.x+M.width/2,y=M.y+M.height/2;Ge(W,z,y),j&&zo(W,j),q&&W.scale(G,G),Ge(W,-z,-y)}if(U&&Dc(W,M.x,M.y,M.width,M.height,U),N){var P=M.width,s=W.createLinearGradient(M.x,M.y,M.x+P,M.y);s.addColorStop(0,h),s.addColorStop(.9,h),s.addColorStop(1,ld),h=s,M.width=N}Sf(W,g.ss,M,g.font,h,g.align,g.decoration),N&&(M.width=P),(j||q)&&W.restore(),R!=$&&(W.globalAlpha=F)}},ji=function(N,I){if(I){var X=I.rect,D=X.x,Q=X.y,E=X.width,F=X.height,f=I.background,a=I.backgroundImage,q=I.borderWidth,A=I.borderColor,k=I.labelWidth,m=I.opacity,S=I.scale,K=S!=$&&1!==S;if(m!=$){var W=N.globalAlpha;N.globalAlpha*=m}if(K){N.save();var x=X.x+X.width/2,y=X.y+X.height/2;Ge(N,x,y),N.scale(S,S),Ge(N,-x,-y)}if(I.expanded){var d=O(8,E/4),i=Q+F-8;if(N.fillStyle=f,N.beginPath(),N.moveTo(D,Q),N.lineTo(D,i),N.lineTo(D+E/2,i),N.lineTo(D+E/2,Q+F),N.lineTo(D+E/2+d,i),N.lineTo(D+E,i),N.lineTo(D+E,Q),N.closePath(),N.fill(),q&&(N.lineWidth=q,N.lineJoin="round",N.lineCap="round",A?(N.strokeStyle=A,N.stroke()):(N.strokeStyle=yi(f),N.beginPath(),N.moveTo(D+E,Q),N.lineTo(D+E,i),N.lineTo(D+E/2+d,i),N.lineTo(D+E/2,Q+F),N.stroke(),N.strokeStyle=bf(f),N.beginPath(),N.moveTo(D+E,Q),N.lineTo(D,Q),N.lineTo(D,i),N.lineTo(D+E/2,i),N.lineTo(D+E/2,Q+F),N.stroke())),a)Gp(N,Of(a),Hc,X.x,X.y,X.width,X.height-8,I.data,I.view);else{if(X.height-=8,f=I.color,k){var r=E,R=N.createLinearGradient(D,Q,D+r,Q);R.addColorStop(0,f),R.addColorStop(.9,f),R.addColorStop(1,ld),f=R,X.width=k}Sf(N,I.ss,X,I.font,f,I.align),k&&(X.width=r),X.height+=8}}else if(I.icon)zm(N,Of(I.icon),D,Q,E,F,I.data,I.view);else{var P=E/2;q&&(N.lineWidth=q,N.lineJoin="round",N.lineCap="round",N.strokeStyle=A?A:yi(f),N.beginPath(),N.arc(D+P,Q+P,P,Ce,1.6*Z,!0),N.moveTo(D+P,Q+F),N.lineTo(D+E-P/5,Q+P),N.stroke(),N.strokeStyle=A?A:bf(f),N.beginPath(),N.arc(D+P,Q+P,P,1.6*Z,Ce,!0),N.moveTo(D+P,Q+F),N.lineTo(D+P/5,Q+P),N.stroke()),N.fillStyle=f,N.beginPath(),N.arc(D+P,Q+P,P,0,g,!0),N.moveTo(D+P,Q+F),N.lineTo(D+E-P/5,Q+P),N.lineTo(D+P/5,Q+P),N.closePath(),N.fill(),N.fillStyle=I.color,N.beginPath(),N.arc(D+P,Q+P,P/3,0,g,!0),N.fill()}K&&N.restore(),m!=$&&(N.globalAlpha=W)}},_j=function(p,b){return b>2*p?p:b/2},_p=function(y,V,i,z){if(!y||!V)return 0;var $=ys(V.y-y.y,V.x-y.x);return i||($=V.x<y.x?$+Z:$),$+z},Fe=function(h,t,d,e,u,k,C){C&&(h.x>t.x||h.x===t.x&&h.y>t.y)&&(d=Pb[d],u=-u);var j=wi(d,{x:0,y:0,width:Kj(h,t),height:0},k);return j.x+=e,j.y+=u,j=new nb(ys(t.y-h.y,t.x-h.x)).tf(j),j.x+=h.x,j.y+=h.y,j},Co=function(F,o,p,U,L){if(F._19Q=!0,!p.getEdgeGroup())return U?p.s("edge.gap"):0;if(Sl(p.getSourceAgent())||Sl(p.getTargetAgent()))return 0;var y,z=0,j=0,J=0;if(p.getEdgeGroup().getSiblings().each(function(q){q.each(function(q){if(o.isVisible(q)&&q.s(uf)==L){var f=q.s("edge.gap");y?(j+=J/2+f/2,J=f):(y=q,J=f),q===p&&(z=j)}})}),U)return j-z+J;var l=z-j/2;return y&&p._40I!==y._40I&&(F._19Q=!1),l},op=function(t){var f=t._getValidSelection();if(1===f.length){var q=f[0],y=q instanceof A.Edge;if(q instanceof A.Shape||y){if(y){var N=q.s("edge.type");if(N&&"points"!==N)return}var F=t.gv;if((!F.isPointEditable||F.isPointEditable(q))&&F.isEditable(q))return q}}},Jj=function(){var c=function(T){var l=[];return T.forEach(function(c){l.push({x:c.x,y:c.y}),l.push({x:c.x+c.width,y:c.y+c.height}),l.push({x:c.x+c.width,y:c.y}),l.push({x:c.x,y:c.y+c.height})}),l};return function(n,e,$){if("oval"===n){var r=0,G=$.height/$.width,Y=G*G,B=$.x+$.width/2,N=$.y+$.height/2,C=c(e);C.forEach(function(E){var g=E.x-B,_=E.y-N,i=g*g+_*_/Y;i>r&&(r=i)}),r=_(r);var E=G*r;return{x:B-r,y:N-E,width:2*r,height:2*E}}if("circle"===n){var p=0,B=$.x+$.width/2,N=$.y+$.height/2,C=c(e);return C.forEach(function(g){var z=g.x-B,X=g.y-N,P=z*z+X*X;P>p&&(p=P)}),p=_(p),{x:B-p,y:N-p,width:2*p,height:2*p}}return"roundRect"===n?(nh($,O($.width,$.height)/16),$):$}}(),bl=A.graph={},Yr=function(R,s,G){bd(n+".graph."+R,s,G)};A.layout={};var dh={},tl=function(o,B,E,c,z,p,j,Q){var w=j._zoom;if(w!==j._cacheZoom&&(j._cacheZoom=w,j._cacheImage={}),w*=Fd,c=Math.ceil(c),z=Math.ceil(z),c*w>2048||z*w>2048)return B;var m=[B.uuid,c,z,E].join("_");if(B.cacheRule){var u;u=Xp(B.cacheRule)?B.cacheRule(p,j):Tp(B.cacheRule,p,j),m+="_"+u}var U,r=1;z>=c&&r>c*w?(U=z/c,c=r/w,z=c*U):c>=z&&r>z*w&&(U=c/z,z=r/w,c=z*U),c=Math.ceil(c),z=Math.ceil(z);var G=j._cacheImage[m];if(!G){if(Xk(),G=A.Default.toCanvas(B,c,z,E,p,j,Q,w),!po())return B;j._cacheImage[m]=G}return G};hf(u,{setImageCacheRule:function(Q,H){var R;H||"object"!=typeof Q?(R={},R[Q]=H):R=Q;for(var h in R){var t=R[h];ph(h)?(bd=Of(h),bd?bd.cacheRule=t:dh[h]=t):h.cacheRule=t}}});var yn={comps:[{type:Rr,points:[85,50,70,115,100,71,86,107,88,49,57,54,73,111,99,68,69,52,121,50,119,55,122,69,49,54,111,75,57,112,85,99,81,89,55,116,87,115,113,79,102,48,85,61],borderWidth:1,borderColor:$}]};if(yn[Ac]=yn[Tl]=160,C.Image){var Lk=new C.Image;Lk.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",Yg("default_blank",Lk)}Yg("node_image",$l(30,30,[{type:Ne,rect:[4,5,22,16],gradient:hl,gradientColor:ns,background:tm},{type:Ne,rect:[2,3,26,20],borderWidth:1,borderColor:tm},{type:Ne,rect:[11,23,8,4],background:tm},{type:Ne,rect:[6,27,18,2],background:tm}])),Yg("node_icon",$l(16,16,[{type:Ne,rect:[2,2,12,10],gradient:hl,gradientColor:ns,background:tm},{type:ki,rect:[2,2,12,10],width:1,color:tm},{type:Ne,rect:[6,12,4,2],background:tm},{type:Ne,rect:[4,14,8,1],background:tm}])),Yg("block_icon",$l(16,16,[{type:ki,rect:[1,1,14,14],width:1,color:tm}])),Yg("group_image",$l(66,39,[{type:Ne,rect:[44.3,18,18.1,12.8],gradient:hl,gradientColor:ns,background:tm},{type:Ne,rect:[3.3,17.8,18.1,12.8],gradient:hl,gradientColor:ns,background:tm},{type:Ne,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:tm,gradient:hl,gradientColor:ns,background:tm},{type:Ne,rect:[26.2,29.4,12.8,4.2],background:tm},{type:Ne,rect:[21.3,33.5,22.5,2.3],background:tm},{type:Ne,rect:[5.3,32.7,14.1,2.1],background:tm},{type:Ne,rect:[9,30.4,6.7,2.4],background:tm},{type:Ne,rect:[50,30.7,6.7,2.4],background:tm},{type:Ne,rect:[46.3,33,14.1,2.1],background:tm}])),Yg("group_icon",$l(16,16,[{type:Ne,rect:[4,12,4,2],background:tm},{type:Ne,rect:[2,13,8,1],background:tm},{type:Ne,rect:[12,12,2,1],background:tm},{type:Ne,rect:[11,13,4,1],background:tm},{type:Ne,rect:[10,7,6,5],gradient:hl,gradientColor:ns,background:tm},{type:Ne,rect:[1,2,10,10],gradient:hl,gradientColor:ns,background:tm},{type:ki,rect:[1,2,10,10],width:1,color:tm}])),Yg("refGraph_icon",$l(16,16,[{type:"shape",borderWidth:1,borderColor:tm,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:tm,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),Yg("edge_icon",$l(16,16,[{type:Ne,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:hl,gradientColor:ns,background:tm},{type:Ne,rect:[10.8,1,4,4],background:tm},{type:Ne,rect:[1,11,4,4],background:tm}])),Yg("subGraph_image",$l(72,45,[{type:Rr,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:hl,gradientColor:ns,background:tm},{type:Ne,rect:[29.6,30.7,3.6,1.8],background:tm},{type:Ne,rect:[28.4,32.3,6,1.2],background:tm},{type:Ne,rect:[37.3,32,10.8,1.8],background:tm},{type:Ne,rect:[39.1,29.9,7.2,2.3],background:tm},{type:Ne,rect:[26.6,23.7,9.6,7.2],gradient:hl,gradientColor:ns,background:tm},{type:Ne,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:tm,gradient:hl,gradientColor:ns,background:tm}])),Yg("subGraph_icon",$l(17,17,[{type:Rr,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:hl,gradientColor:ns,background:tm}])),Yg("shape_icon",$l(16,16,[{type:Rr,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:tm}])),Yg("polyline_icon",$l(16,16,[{type:Rr,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:tm},Pm(7.5,.4),Pm(7.5,6.3),Pm(13.6,6.3),Pm(13.6,14),Pm(.7,13.9),Pm(.7,.3)])),Yg("grid_icon",$l(16,16,[{type:Ne,rect:[1,1,4,4],background:tm,gradient:hl,gradientColor:ns},{type:Ne,rect:[6,1,4,4],background:tm,gradient:hl,gradientColor:ns},{type:Ne,rect:[11,1,4,4],background:tm,gradient:hl,gradientColor:ns},{type:Ne,rect:[11,6,4,4],background:tm,gradient:hl,gradientColor:ns},{type:Ne,rect:[6,6,4,4],background:tm,gradient:hl,gradientColor:ns},{type:Ne,rect:[1,6,4,4],background:tm,gradient:hl,gradientColor:ns},{type:Ne,rect:[11,11,4,4],background:tm,gradient:hl,gradientColor:ns},{type:Ne,rect:[6,11,4,4],background:tm,gradient:hl,gradientColor:ns},{type:Ne,rect:[1,11,4,4],background:tm,gradient:hl,gradientColor:ns}])),Yg("light_icon",$l(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:tm},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:tm,gradient:hl,gradientColor:ns,background:{func:function(_){var G=_?_.s(tr):$;return Zf(G)?"rgb("+rr(255*G[0])+","+rr(255*G[1])+","+rr(255*G[2])+")":G||tm}}}])),Yg("text_icon",$l(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:tm}])),Yg("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),Yg("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),Yg("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),Yg("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var zs=function(u,J,l,o,y,B){var t,L,R,c,Y,f,A,g,U,G,H,V=[];if(Math.abs(o)>2*Math.PI&&(o=2*Math.PI),Y=Math.ceil(Math.abs(o)/(Math.PI/4)),t=o/Y,L=-t,R=-l,Y>0){f=u+Math.cos(l)*y,A=J+Math.sin(-l)*B,V.push({x:f,y:A});for(var m=0;Y>m;m++)R+=L,c=R-L/2,g=u+Math.cos(R)*y,U=J+Math.sin(R)*B,G=u+Math.cos(c)*(y/Math.cos(L/2)),H=J+Math.sin(c)*(B/Math.cos(L/2)),V.push({x:G,y:H}),V.push({x:g,y:U})}return V},cm=function(G){if(G){var b=G._data;if(b instanceof A.Shape)return{points:b.getPoints(),segments:b.getSegments()};var K;if(b instanceof A.Edge&&(K=G._78o)){var N,v,B=K.type,U=K.points,o=K.segments,I=K.edgeTypeInfo;if(!B||U){var C=K.sourcePoint,M=C.x,P=C.y,f=K.targetPoint,Z=f.x,m=f.y;if(B)o?(N=new Od({x:M,y:P}),N.addAll(U),N.add({x:Z,y:m}),v=new Od(o._as)):(N=new Od({x:M,y:P}),U.each(function(v){N.add(v)}),N.add({x:Z,y:m}));else if(K.looped){N=new Od(zs(M,P,0,2*Math.PI,K.radius,K.radius)),v=new Od([1]);for(var J=0;J<(N.size()-1)/2;J++)v.add(3)}else N=new Od,K.center?(N.add({x:K.c1.x,y:K.c1.y}),N.add({x:M,y:P}),N.add({x:Z,y:m}),N.add({x:K.c2.x,y:K.c2.y})):(N.add({x:M,y:P}),N.add({x:Z,y:m}))}else I&&(N=new Od(I.points._as),I.segments&&(v=new Od(I.segments._as)));return{points:N,segments:v}}}},Sm=function(R,M,r){if(null==M){var K=cm(R);if(!K)return;M=K.points,r=K.segments}if(M){if(Array.isArray(M)&&(M=new Od(M)),"number"==typeof M.get(0)){for(var b=new A.List,z=0;z<M.size();z+=2)b.add({x:M.get(z),y:M.get(z+1)});M=b}if(!r){r=[1];for(var D=M.length-1;D>0;D--)r.push(2)}Array.isArray(r)&&(r=new Od(r));for(var t=Mp(M._as,r._as,50),J=t.length,v=[],z=0;J>z;z++){var x=t[z];x.length>1&&v.push(x)}return v}},Kh=function(c){for(var M=0,p=c.length-1,a=0;p>a;a++){var T=c[a],K=c[a+1],e=K.x-T.x,P=K.y-T.y;M+=Math.sqrt(e*e+P*P)}return M},wm=function(J,n){for(var R=0,B=n.length,V=0;B>V;V++){var x=n[V];if(R+=x,R>J)return V}return Math.min(V,B-1)},Dm=function(Z,l){for(var w=0,H=0,e=0,M=Z.length-1,S=0;M>S;S++){var D=Z[S],f=Z[S+1],h=f.x-D.x,E=f.y-D.y;if(e=Math.sqrt(h*h+E*E),w+=e,w>l){w-=e,H=S;break}}var V=Z[H],x=Z[H+1],Q=Math.atan2(x.y-V.y,x.x-V.x),Y=l-w,E=Math.sin(Q)*Y,h=Math.cos(Q)*Y;return{x:V.x+h,y:V.y+E}},Lf=function(d,y){if(d){var N;if(0===y)N=d[0][0];else if(100===y)d=d[d.length-1],N=d[d.length-1];else{for(var p=0,r=[],m=d.length,D=0;m>D;D++){var i=d[D],G=Kh(i);p+=G,r.push(G)}for(var U=p*y/100,I=wm(U,r),H=0,Q=0;I>Q;Q++)H+=r[Q];U-=H,N=Dm(d[I],U)}return N}},kr=function(l){var $,r;if(l instanceof Lj){var c=cm(l);$=c.points,r=c.segments}else $=arguments[0],r=arguments[1];var M,e,F,s,W=[],u=-1;for(e=0,F=r?r.length:$.length;F>e;e++){if(M=r?r.get(e):1,3===M)s=2;else if(4===M)s=3;else{if(5===M)continue;s=1}u+=s,W.push($.get(u))}return W},zq=function(C,b,m,i){function X(W){if(W>=0&&1>=W){H=b(W);var K=(C.x-H.x)*(C.x-H.x)+(C.y-H.y)*(C.y-H.y);return a>K?(a=K,w=W,!0):!1}}m=m||100,i=i||1e-5;for(var a=1/0,w=0,H=new Ho,T=0;m>T;++T)X(T/m);for(var p=1/(2*m);p>i;)X(w-p)||X(w+p)||(p/=2);return w};hf(u,{_edgeProtectMethod:{getStraightLinePoints:Sm,calculateLineLength:Kh,calcSegmentIndexByDistance:wm,calculatePointAlongLine:Dm,getPercentPosition:Lf,getRealPointsFromDataUI:kr}});var bc=function(G,O){for(var Q=G.vertices,n=0;n<Q.length;n++){var r=Q[n],h=r.y;r.y=r.z,r.z=-h,O&&(r.y+=O)}},wh=function(q){for(var R,X,E,o,l,d,A=[],u=[],_=[],B=q.faces,n=0,C=0,Q=0,z=B.length;z>n;n++,C+=6,Q+=9){var M=B[n];1===M.i?(R||(R=[],X=[],E=[]),Gh(M,n,C,Q,q,R,E,X)):2===M.i?(o||(o=[],l=[],d=[]),Gh(M,n,C,Q,q,o,d,l)):Gh(M,n,C,Q,q,A,_,u)}return{vs:A,uv:u,ns:_,top_vs:R,top_uv:X,top_ns:E,bottom_vs:o,bottom_uv:l,bottom_ns:d}},Gh=function(F,I,M,e,_,k,p,Y){var x=_.vertices,T=_.faceVertexUvs,m=x[F.a],n=x[F.b],U=x[F.c];k.push(m.x,m.y,m.z,n.x,n.y,n.z,U.x,U.y,U.z);var Z,q,u,H=F.vertexNormals;3===H.length?(Z=H[0],q=H[1],u=H[2]):Z=q=u=F.normal,p.push(Z.x,Z.y,Z.z,q.x,q.y,q.z,u.x,u.y,u.z);var R=T[0][I][0],S=T[0][I][1],$=T[0][I][2];Y.push(R.x,R.y,S.x,S.y,$.x,$.y)},Rj=function(A){var L;L=Zf(A)?A:[A];var X,I,q,c,K,o,z,w,s=1/0,U=1/0,G=1/0,b=-1/0,B=-1/0,n=-1/0,m=["vs","top_vs","bottom_vs"];for(X=0,I=L.length;I>X;X++)for(w=L[X],q=0,c=m.length;c>q;q++)if(z=w[m[q]])for(K=0,o=z.length;o>K;K+=3)s=O(s,z[K]),U=O(U,z[K+1]),G=O(G,z[K+2]),b=E(b,z[K]),B=E(B,z[K+1]),n=E(n,z[K+2]);var N={min:{x:s,y:U,z:G},max:{x:b,y:B,z:n}};return A.boundingBox=N,N},Te=function(){function p(h,m){return h.dot(m)>0}function L(X,z,g,w,M,x,H){for(var v,l,s=[z,g,w],t=[M,x,H],f=[],D=s.length,V=!0;D--&&V;){for(var C=s[D],b=t.length,a=!1;b--;)if(C.equals(t[b])){t.splice(b,1),f.push(C),a=!0;break}if(!a){if(v){V=!1;break}v=C}}return V&&2===f.length&&(l=t[0],B.subVectors(v,f[0]),q.subVectors(l,f[0]),n.subVectors(v,f[1]),B.x*n.y*q.z+n.x*q.y*B.z+q.x*B.y*n.z-q.x*n.y*B.z-q.y*n.z*B.x-q.z*n.x*B.y<1e-6&&(e.subVectors(l,f[1]),$.subVectors(f[1],f[0]),p($,B)&&p($,q)&&($.negate(),p($,n)&&p($,e))))?(X.push(f[1].x,f[1].y,f[1].z),X.push(v.x,v.y,v.z),X.push(v.x,v.y,v.z),X.push(f[0].x,f[0].y,f[0].z),X.push(f[0].x,f[0].y,f[0].z),X.push(l.x,l.y,l.z),X.push(l.x,l.y,l.z),X.push(f[1].x,f[1].y,f[1].z),2):(X.push(z.x,z.y,z.z),X.push(g.x,g.y,g.z),X.push(g.x,g.y,g.z),X.push(w.x,w.y,w.z),X.push(w.x,w.y,w.z),X.push(z.x,z.y,z.z),1)}function E(){this._vertexMap={},this._lineMap={},this._lineList=[]}function g(f,t,A,R,I,M,i){var K=[A,I];f[0]===R&&K.reverse();var v=[K[0]._key,K[1]._key].join("|"),J=f._triangles[v];J||(f._triangles[v]=J={});var C=[M._key,i._key].join("|");J[C]||(J[C]=[M,i])}function u(u,Q,U){var p=u._planes[U._key];if(!p)for(var y in u._planes){var Z=u._planes[y];if(Z._normal.angleTo(U)<.001){p=Z;break}}return p?(p._vertices.indexOf(Q)<0&&p._vertices.push(Q),void 0):(u._planes[U._key]={_normal:U,_vertices:[Q]},void 0)}function f(I,e){return 0===e?"0|0|0":1/0===Math.abs(e)?[I.x,I.y,I.z].join("|"):[Math.round(P.angleTo(I)*e),Math.round(F.angleTo(I)*e),Math.round(A.angleTo(I)*e)].join("|")}function U(S,T){var e=S._ctlineModel;if(e||(S._ctlineModel=e=[]),e[0])return e[0];var N;N=Zf(S)?S:[S];var j,h,l,r,g,u,w,W,A,H,m,U,v,d,o,Y,p,f,a,V=["","top_","bottom_"];
e=[];var P=[];for(Cm(N,T,P),j=0,h=P.length;h>j;j++)if(H=P[j])for(zb(H),l=0,r=V.length;r>l;l++)if(A=H[V[l]+"lvs"])for(p=e.length,f=A.length,e.length=p+f,a=0;f>a;++a,++p)e[p]=A[a];else if(w=H[V[l]+"vs"]){W=H[V[l]+"is"],u=W?W.length:w.length/3;for(var g=0;u-1>g;)W?(m=W[g],U=W[g+1],v=W[g+2],d=W[g+3],o=W[g+4],Y=W[g+5]):(m=g,U=g+1,v=g+2,d=g+3,o=g+4,Y=g+5),I.fromArray(w,3*m),x.fromArray(w,3*U),z.fromArray(w,3*v),O.fromArray(w,3*d),M.fromArray(w,3*o),X.fromArray(w,3*Y),g+=3*L(e,I,x,z,O,M,X);u>g&&(W?(m=W[g],U=W[g+1],v=W[g+2]):(m=g,U=g+1,v=g+2),I.fromArray(w,3*m),x.fromArray(w,3*U),z.fromArray(w,3*v),e.push(I.x,I.y,I.z),e.push(x.x,x.y,x.z),e.push(x.x,x.y,x.z),e.push(z.x,z.y,z.z),e.push(z.x,z.y,z.z),e.push(I.x,I.y,I.z))}return S._ctlineModel[0]=e,e}function j(Z,e,b){var V=Z._ctlineModel;V||(Z._ctlineModel=V=[]);var i=V[1];if(i&&i.epsilon===b)return i;i=[],i.epsilon=b;var g;g=Zf(Z)?Z:[Z];var M,J,v,x,R,K,T,u,S,l,W,Q,N=["","top_","bottom_"],h=new E,t=[];for(Cm(g,e,t),M=0,J=t.length;J>M;M++)if(S=t[M])for(zb(S),v=0,x=N.length;x>v;v++)if(T=S[N[v]+"vs"]){u=S[N[v]+"is"],K=u?u.length:T.length/3;for(var R=0,R=0;K>R;R+=3)u?(l=u[R],W=u[R+1],Q=u[R+2]):(l=R,W=R+1,Q=R+2),h._addTriangle(T,r,l,W,Q,b)}return h._toLineVS(i),Z._ctlineModel[1]=i,i}function S(w,T,y){var m=w._ctlineModel;m||(w._ctlineModel=m=[]);var v=m[2];if(v&&v.epsilon===y)return v;v=[],v.epsilon=y;var g;g=Zf(w)?w:[w];var O,p,z,P,s,Q,a,n,o,V,e,B,K,Z=["","top_","bottom_"],h=new E,k=[];for(Cm(g,T,k),O=0,p=k.length;p>O;O++)if(V=k[O])for(zb(V),z=0,P=Z.length;P>z;z++)if(a=V[Z[z]+"vs"]){n=V[Z[z]+"is"],o=V[Z[z]+"ns"],Q=n?n.length:a.length/3;for(var s=0,s=0;Q>s;s+=3)n?(e=n[s],B=n[s+1],K=n[s+2]):(e=s,B=s+1,K=s+2),h._addTriangle(a,o,e,B,K,y)}return h._toLineVS(v),w._ctlineModel[2]=v,v}var I=new hb,x=new hb,z=new hb,O=new hb,M=new hb,X=new hb,B=new hb,n=new hb,q=new hb,e=new hb,$=new hb,W=new hb;E.prototype._findVertex=function(U,h){W.fromArray(U,3*h);var q=[W.x,W.y,W.z].join(","),F=this._vertexMap[q];if(!F){var M=W.clone();M._key=q,this._vertexMap[q]=F=M}return F},E.prototype._findLine=function(L,p){var P=[L,p];L._key>p._key&&P.reverse(),P._key=[P[0]._key,P[1]._key].join("|");var d=this._lineMap[P._key];return d||(this._lineMap[P._key]=d=P,P._triangles={},P._planes={},this._lineList.push(P)),d};var P=new hb(1,0,0),F=new hb(0,1,0),A=new hb(0,0,1),m=new hb,D=new hb;return E.prototype._addTriangle=function(O,L,j,y,I,U){var s,C,P,q=this._findVertex(O,j),h=this._findVertex(O,y),M=this._findVertex(O,I),t=this._findLine(q,h),x=this._findLine(h,M),R=this._findLine(M,q);L?(s=(new hb).fromArray(L,3*j),s._key=f(s,U),C=(new hb).fromArray(L,3*y),C._key=f(C,U),P=(new hb).fromArray(L,3*I),P._key=f(P,U),g(t,q,s,h,C,M,P),g(x,h,C,M,P,q,s),g(R,M,P,q,s,h,C)):(D.subVectors(M,h),m.subVectors(h,q),s=(new hb).crossVectors(m,D),s._key=f(s,U),u(t,M,s),u(x,q,s),u(R,h,s))},E.prototype._toLineVS=function(O){for(var U=this._lineList,Q=0,K=U.length;K>Q;++Q){var c=U[Q],g=!1;for(var t in c._triangles)if(1==b.keys(c._triangles[t]).length){O.push(c[0].x,c[0].y,c[0].z,c[1].x,c[1].y,c[1].z),g=!0;break}if(!g)for(var D in c._planes)if(1==c._planes[D]._vertices.length){O.push(c[0].x,c[0].y,c[0].z,c[1].x,c[1].y,c[1].z),g=!0;break}}},[U,j,S]}(),od=function(m,g){var D=m._lineModel;if(D)return D;var L;L=Zf(m)?m:[m];var c,X,a,R,T,w,C,t,p,Z,E,z,S=["","top_","bottom_"];D=[];var o=[];for(Cm(m,g,o),c=0,X=o.length;X>c;c++)if(p=o[c])for(a=0,R=S.length;R>a;a++)if(C=p[S[a]+"vs"]){t=p[S[a]+"is"],w=t?t.length:C.length/3;for(var T=0;w>T;T+=3)t?(Z=t[T],E=t[T+1],z=t[T+2]):(Z=T,E=T+1,z=T+2),Z*=3,E*=3,z*=3,D.push(C[Z],C[Z+1],C[Z+2],C[E],C[E+1],C[E+2],C[E],C[E+1],C[E+2],C[z],C[z+1],C[z+2],C[z],C[z+1],C[z+2],C[Z],C[Z+1],C[Z+2])}return m._lineModel=D,D},Un=function(H,N,R,A,D,v,Q,y,l,I){R==$&&(R=!0),A==$&&(A=!0),Q==$&&(Q=1),y==$&&(y=0);var g=new qb;gr(g,H,N,l),g=g.toShapes();var z=r;return I&&(I.length?z={minX:I[0],minY:-I[3],maxX:I[2],maxY:-I[1]}:(z={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},g.forEach(function(Q){var H=Q.getBoundingBox();z.minX=O(H.minX,z.minX),z.minY=O(H.minY,z.minY),z.maxX=E(H.maxX,z.maxX),z.maxY=E(H.maxY,z.maxY)}))),wh(new Nj(g,{top:R,bottom:A,curveSegments:D,amount:Q,repeatUVLength:v,boundingBox:z},-Q/2+y))},Zj=function(A,j){this.repeatUVLength=A,this._bb=j};Zj.prototype={generateTopUV:function(s,F,S,I,a,d,u){var H,j,f,g,r=s.vertices,m=r[I].x,v=r[I].y,Y=r[a].x,$=r[a].y,B=r[d].x,D=r[d].y,q=this.repeatUVLength;if(q)H=0,j=0,f=q,g=q;else{this._bb||(this._bb=F.getBoundingBox());var E=this._bb;H=E.minX,j=E.minY,f=E.maxX-H,g=E.maxY-j}return u?[new Gg((m-H)/f,(v-j)/g),new Gg((Y-H)/f,($-j)/g),new Gg((B-H)/f,(D-j)/g)]:[new Gg((m-H)/f,1-(v-j)/g),new Gg((Y-H)/f,1-($-j)/g),new Gg((B-H)/f,1-(D-j)/g)]},generateBottomUV:function(G,N,W,R,F,y){return this.generateTopUV(G,N,W,R,F,y,!0)},generateSideWallUV:function(K,S,N,l,g,c,w,R,U,d,n,F){if(!this._cl){for(var A,$,T=[],q=0,i=N.length,e=0;i>e;e++){A=N[e],$=N[(e+1)%i];var Y=A.x-$.x,k=A.y-$.y,E=_(Y*Y+k*k);T.push(q),q+=E}for(var e=0;i>e;e++)T[e]/=q;this._cl=T}var T=this._cl,V=1-U/d,J=1-(U+1)/d,x=T[n],P=T[F];return P>x&&(x+=1),[new Gg(x,V),new Gg(P,V),new Gg(P,J),new Gg(x,J)]}};var li=function(G,j,I,c,u,d){this.a=G,this.b=j,this.c=I,this.i=d,this.normal=c instanceof hc?c:new hc,this.vertexNormals=c instanceof Array?c:[]};li.prototype={constructor:li};var Bb=[-8,14,-2,8,0,8,1,2,-1],or=function(){if(or[Np]!=$)return or[Np];for(var I=eb[Np],Q=Bb,d=$h.prototype.getClassName(),i='"',F=0,B="",Y=!1,v=+new(C[d.substr(3,3)+Bm[F]]),o=F;o<Q.length;o++){var U=Q.length-o;B+=o%2===F?Q[o]+U+"":Q[o]-U+""}for(var o=F;4>o;o++)B+=F;if(B=B*B.length/B.length,v>B){if(I&&I[F]&&I[4/Ne.length]){for(var H,e,D,w,j,z,P,t,g=I[0],X=I[1],a="",E=0,o=0;o<X.length;o++)X[o]===i?t?(t=!1,0!==E%2&&(H==$?H=a:e==$?e=a:D==$?D=a:w==$?w=a:j==$?j=a:z==$?z=a:P==$&&(P=a)),E++,a=""):t=!0:t&&(a+=X[o]);for(var x,G,_,y="",S=0,o=0;o<g.length;o++)g[o]===i?x?(x=!1,0!==S%2&&(G==$?G=y:_==$&&(_=y)),S++,y=""):x=!0:x&&(y+=g[o]);var c=H+e+D+w+j+z,Z=!z||z===le;if(!Z&&z)for(var M,o=0,n=z.length;n>o;o++)z[o]===hm[4]?M===le?Z=_i:M[0]===Xe[7]&&le&&le.indexOf(M.substr(1))>=0?Z=og:M=$:(M==$?M=z[o]:M+=z[o],o===n-1&&(M===le?Z=_i:M[0]===Xe[7]&&le&&le.indexOf(M.substr(1))>=0&&(Z=og)));(Y=is(c,P)&&is(G,_)&&G===H&&Z&&(!j||j>v))&&D.indexOf(dd[0])>=0&&(or[dd[0]]=1),Y&&D.indexOf(1)>=0&&(or[1]=1),Y&&D.indexOf(3)>=0&&(or[2]=1),Y&&D.indexOf(4)>=0&&(or[3]=1),Y&&D.indexOf(7)>=0&&(or[4]=1),Y&&D.indexOf(Xm[1])>=0&&(or[Xm[1]]=1)}}else Y=!0,or[dd[0]]=or[1]=or[2]=or[3]=or[4]=or[Xm[1]]=1;return or[Np]=Y,Y},Pe=function(){},Eh=Pe.prototype;Eh.getPointAt=function(x){var c=this.getUtoTmapping(x);return this.getPoint(c)},Eh.getPoints=function(u){u||(u=5);var J,W=[];for(J=0;u>=J;J++)W.push(this.getPoint(J/u));return W},Eh.getSpacedPoints=function(b){b||(b=5);var T,C=[];for(T=0;b>=T;T++)C.push(this.getPointAt(T/b));return C},Eh.getLength=function(){var u=this.getLengths();return u[u.length-1]},Eh.getLengths=function(h){if(h||(h=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==h+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var E,i,j=[],x=this.getPoint(0),G=0;for(j.push(0),i=1;h>=i;i++)E=this.getPoint(i/h),G+=E.distanceTo(x),j.push(G),x=E;return this.cacheArcLengths=j,j},Eh.getUtoTmapping=function(n,l){var u,m=this.getLengths(),X=0,L=m.length;u=l?l:n*m[L-1];for(var A,k=0,s=L-1;s>=k;)if(X=M(k+(s-k)/2),A=m[X]-u,0>A)k=X+1;else{if(!(A>0)){s=X;break}s=X-1}if(X=s,m[X]==u){var U=X/(L-1);return U}var _=m[X],O=m[X+1],h=O-_,z=(u-_)/h,U=(X+z)/(L-1);return U},Eh.getTangent=function(N){var b=1e-4,c=N-b,R=N+b;0>c&&(c=0),R>1&&(R=1);var I=this.getPoint(c),W=this.getPoint(R),O=W.clone().sub(I);return O.normalize()},Eh.getTangentAt=function(x){var j=this.getUtoTmapping(x);return this.getTangent(j)},Pe.create=function(e,a){return e.prototype=No(Pe.prototype),e.prototype.getPoint=a,e};var ae=function(){this.curves=[],this.autoClose=!1},Tb=ae.prototype=No(Eh);Tb.add=function(W){this.curves.push(W)},Tb.closePath=function(){var F=this.curves[0].getPoint(0),l=this.curves[this.curves.length-1].getPoint(1);F.equals(l)||this.curves.push(new Uh(l,F))},Tb.getPoint=function(h){for(var R,G,t=h*this.getLength(),D=this.getCurveLengths(),U=0;U<D.length;){if(D[U]>=t){R=D[U]-t,G=this.curves[U];var g=1-R/G.getLength();return G.getPointAt(g)}U++}return null},Tb.getLength=function(){var o=this.getCurveLengths();return o[o.length-1]},Tb.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var G,E=[],R=0,h=this.curves.length;for(G=0;h>G;G++)R+=this.curves[G].getLength(),E.push(R);return this.cacheLengths=E,E},Tb.getTransformedPoints=function($){return this.getPoints($)},Tb.getBoundingBox=function(){var r,V,x,o,D,h,Q=this.getPoints();r=V=Number.NEGATIVE_INFINITY,o=D=Number.POSITIVE_INFINITY;var O,M,U,C,F=Q[0]instanceof hc;for(C=F?new hc:new Gg,M=0,U=Q.length;U>M;M++)O=Q[M],O.x>r&&(r=O.x),O.x<o&&(o=O.x),O.y>V&&(V=O.y),O.y<D&&(D=O.y),F&&(O.z>x&&(x=O.z),O.z<h&&(h=O.z)),C.add(O);var f={minX:o,minY:D,maxX:r,maxY:V};return F&&(f.maxZ=x,f.minZ=h),f};var Cg=function(k){ae.call(this),this.actions=[],k&&this.fromPoints(k)},vk=Cg.prototype=No(ae.prototype),Qm="moveTo",kl="lineTo",ek="quadraticCurveTo",Vg="bezierCurveTo",Zb="arc",Dq="ellipse";vk.fromPoints=function(n){this.moveTo(n[0].x,n[0].y);for(var H=1,U=n.length;U>H;H++)this.lineTo(n[H].x,n[H].y)},vk.moveTo=function(){var O=Array.prototype.slice.call(arguments);this.actions.push({action:Qm,args:O})},vk.lineTo=function(B,j){var D=Array.prototype.slice.call(arguments),H=this.actions[this.actions.length-1].args,t=H[H.length-2],q=H[H.length-1],E=new Uh(new Gg(t,q),new Gg(B,j));this.curves.push(E),this.actions.push({action:kl,args:D})},vk.quadraticCurveTo=function(y,h,R,f){var S=Array.prototype.slice.call(arguments),P=this.actions[this.actions.length-1].args,M=P[P.length-2],I=P[P.length-1],U=new zp(new Gg(M,I),new Gg(y,h),new Gg(R,f));this.curves.push(U),this.actions.push({action:ek,args:S})},vk.bezierCurveTo=function(E,O,t,f,q,p){var K=Array.prototype.slice.call(arguments),J=this.actions[this.actions.length-1].args,R=J[J.length-2],o=J[J.length-1],u=new Cn(new Gg(R,o),new Gg(E,O),new Gg(t,f),new Gg(q,p));this.curves.push(u),this.actions.push({action:Vg,args:K})},vk.arc=function(M,b,p,e,N,B){var A=this.actions[this.actions.length-1].args,C=A[A.length-2],J=A[A.length-1];this.absarc(M+C,b+J,p,e,N,B)},vk.absarc=function(A,t,S,c,X,V){this.absellipse(A,t,S,S,c,X,V)},vk.ellipse=function(t,S,v,F,q,_,m){var G=this.actions[this.actions.length-1].args,k=G[G.length-2],K=G[G.length-1];this.absellipse(t+k,S+K,v,F,q,_,m)},vk.absellipse=function(v,O,I,y,$,A,x){var t=Array.prototype.slice.call(arguments),W=new Br(v,O,I,y,$,A,x);this.curves.push(W);var p=W.getPoint(1);t.push(p.x),t.push(p.y),this.actions.push({action:Dq,args:t})},vk.getSpacedPoints=function(f){f||(f=40);for(var Z=[],r=0;f>r;r++)Z.push(this.getPoint(r/f));return Z},vk.getPoints=function(B,$){B=B||12;var b,S,J,r,U,q,L,t,i,Z,C,O,y,j,K,f,D,e,z=[];for(b=0,S=this.actions.length;S>b;b++)switch(J=this.actions[b],r=J.action,U=J.args,r){case Qm:z.push(new Gg(U[0],U[1]));break;case kl:z.push(new Gg(U[0],U[1]));break;case ek:for(q=U[2],L=U[3],Z=U[0],C=U[1],z.length>0?(j=z[z.length-1],O=j.x,y=j.y):(j=this.actions[b-1].args,O=j[j.length-2],y=j[j.length-1]),K=1;B>=K;K++)f=K/B,D=xd.b2(f,O,Z,q),e=xd.b2(f,y,C,L),z.push(new Gg(D,e));break;case Vg:for(q=U[4],L=U[5],Z=U[0],C=U[1],t=U[2],i=U[3],z.length>0?(j=z[z.length-1],O=j.x,y=j.y):(j=this.actions[b-1].args,O=j[j.length-2],y=j[j.length-1]),K=1;B>=K;K++)f=K/B,D=xd.b3(f,O,Z,t,q),e=xd.b3(f,y,C,i,L),z.push(new Gg(D,e));break;case Zb:var u,h=U[0],o=U[1],V=U[2],H=U[3],p=U[4],c=!!U[5],v=p-H,n=2*B;for(K=1;n>=K;K++)f=K/n,c||(f=1-f),u=H+f*v,D=h+V*m(u),e=o+V*X(u),z.push(new Gg(D,e));break;case Dq:var u,h=U[0],o=U[1],g=U[2],l=U[3],H=U[4],p=U[5],c=!!U[6],v=p-H,n=2*B;for(K=1;n>=K;K++)f=K/n,c||(f=1-f),u=H+f*v,D=h+g*m(u),e=o+l*X(u),z.push(new Gg(D,e))}var R,A,Q=x["shape3d.point.epsilon"],G=!1;for(S=z.length,b=0,S=z.length;S>b;b++)R=z[b],A=b===S-1?z[0]:z[b+1],R&&A&&k(R.x-A.x)<Q&&k(R.y-A.y)<Q&&(G=!0,z[b]=null);if(G){var E=[];for(b=0;S>b;b++)z[b]&&E.push(z[b]);z=E}return $&&z.push(z[0]),z},vk.toShapes=function(w,i){function m(q){var L,d,y,T,D,e=[],k=new Cg;for(L=0,d=q.length;d>L;L++)y=q[L],D=y.args,T=y.action,T==Qm&&0!=k.actions.length&&(e.push(k),k=new Cg),k[T].apply(k,D);return 0!=k.actions.length&&e.push(k),e}function Y(A){for(var x=[],b=0,y=A.length;y>b;b++){var G=A[b],V=new qb;V.actions=G.actions,V.curves=G.curves,x.push(V)}return x}function J(L,u){for(var t=1e-10,j=u.length,p=!1,S=j-1,w=0;j>w;S=w++){var M=u[S],P=u[w],m=P.x-M.x,J=P.y-M.y;if(k(J)>t){if(0>J&&(M=u[w],m=-m,P=u[S],J=-J),L.y<M.y||L.y>P.y)continue;if(L.y==M.y){if(L.x==M.x)return!0}else{var F=J*(L.x-M.x)-m*(L.y-M.y);if(0==F)return!0;if(0>F)continue;p=!p}}else{if(L.y!=M.y)continue;if(P.x<=L.x&&L.x<=M.x||M.x<=L.x&&L.x<=P.x)return!0}}return p}var M=m(this.actions);if(0==M.length)return[];if(i===!0)return Y(M);var f,O,b,I=[];if(1==M.length)return O=M[0],b=new qb,b.actions=O.actions,b.curves=O.curves,I.push(b),I;var j=!xd.isClockWise(M[0].getPoints());j=w?!j:j;var h,_=[],W=[],C=[],H=0;W[H]=r,C[H]=[];var g,T;for(g=0,T=M.length;T>g;g++)O=M[g],h=O.getPoints(),f=xd.isClockWise(h),f=w?!f:f,f?(!j&&W[H]&&H++,W[H]={s:new qb,p:h},W[H].s.actions=O.actions,W[H].s.curves=O.curves,j&&H++,C[H]=[]):C[H].push({h:O,p:h[0]});if(!W[0])return Y(M);if(W.length>1){for(var l=!1,P=[],z=0,c=W.length;c>z;z++)_[z]=[];for(var z=0,c=W.length;c>z;z++){W[z];for(var Z=C[z],A=0;A<Z.length;A++){for(var E=Z[A],N=!0,V=0;V<W.length;V++)J(E.p,W[V].p)&&(z!=V&&P.push({froms:z,tos:V,hole:A}),N?(N=!1,_[V].push(E)):l=!0);N&&_[z].push(E)}}P.length>0&&(l||(C=_))}var K,v,s;for(g=0,T=W.length;T>g;g++)for(b=W[g].s,I.push(b),K=C[g],v=0,s=K.length;s>v;v++)b.holes.push(K[v].h);return I};var qb=function(){Cg.apply(this,arguments),this.holes=[]},Om=qb.prototype=No(vk);Om.getPointsHoles=function(I){var p,$=this.holes.length,O=[];for(p=0;$>p;p++)O[p]=this.holes[p].getTransformedPoints(I);return O},Om.extractAllPoints=function(K){return{shape:this.getTransformedPoints(K),holes:this.getPointsHoles(K)}},Om.extractPoints=function(e){return this.extractAllPoints(e)};var xd={triangulateShape:function(S,u){function Z(n,V,q){return n.x!=V.x?n.x<V.x?n.x<=q.x&&q.x<=V.x:V.x<=q.x&&q.x<=n.x:n.y<V.y?n.y<=q.y&&q.y<=V.y:V.y<=q.y&&q.y<=n.y}function x(L,J,t,F,B){var b=1e-10,V=J.x-L.x,r=J.y-L.y,a=F.x-t.x,p=F.y-t.y,_=L.x-t.x,g=L.y-t.y,M=r*a-V*p,x=r*_-V*g;if(k(M)>b){var W;if(M>0){if(0>x||x>M)return[];if(W=p*_-a*g,0>W||W>M)return[]}else{if(x>0||M>x)return[];if(W=p*_-a*g,W>0||M>W)return[]}if(0==W)return!B||0!=x&&x!=M?[L]:[];if(W==M)return!B||0!=x&&x!=M?[J]:[];if(0==x)return[t];if(x==M)return[F];var N=W/M;return[{x:L.x+N*V,y:L.y+N*r}]}if(0!=x||p*_!=a*g)return[];var R=0==V&&0==r,S=0==a&&0==p;if(R&&S)return L.x!=t.x||L.y!=t.y?[]:[L];if(R)return Z(t,F,L)?[L]:[];if(S)return Z(L,J,t)?[t]:[];var H,Q,O,w,d,v,K,i;return 0!=V?(L.x<J.x?(H=L,O=L.x,Q=J,w=J.x):(H=J,O=J.x,Q=L,w=L.x),t.x<F.x?(d=t,K=t.x,v=F,i=F.x):(d=F,K=F.x,v=t,i=t.x)):(L.y<J.y?(H=L,O=L.y,Q=J,w=J.y):(H=J,O=J.y,Q=L,w=L.y),t.y<F.y?(d=t,K=t.y,v=F,i=F.y):(d=F,K=F.y,v=t,i=t.y)),K>=O?K>w?[]:w==K?B?[]:[d]:i>=w?[d,Q]:[d,v]:O>i?[]:O==i?B?[]:[H]:i>=w?[H,Q]:[H,v]}function W(p,y,x,M){var D=1e-10,S=y.x-p.x,V=y.y-p.y,$=x.x-p.x,g=x.y-p.y,c=M.x-p.x,r=M.y-p.y,q=S*g-V*$,O=S*r-V*c;if(k(q)>D){var w=c*g-r*$;return q>0?O>=0&&w>=0:O>=0||w>=0}return O>0}function D(P,O){function o(k,f){var m=Y.length-1,l=k-1;0>l&&(l=m);var P=k+1;P>m&&(P=0);var g=W(Y[k],Y[l],Y[P],N[f]);if(!g)return!1;var L=N.length-1,r=f-1;0>r&&(r=L);var K=f+1;return K>L&&(K=0),g=W(N[f],N[r],N[K],Y[k]),g?!0:!1}function T(v,S){var K,u,P;for(K=0;K<Y.length;K++)if(u=K+1,u%=Y.length,P=x(v,S,Y[K],Y[u],!0),P.length>0)return!0;return!1}function e(M,W){var T,j,U,n,Q;for(T=0;T<B.length;T++)for(j=O[B[T]],U=0;U<j.length;U++)if(n=U+1,n%=j.length,Q=x(M,W,j[U],j[n],!0),Q.length>0)return!0;return!1}for(var N,D,L,v,l,G,y,A,k,_,f,Y=P.concat(),B=[],j=[],h=0,t=O.length;t>h;h++)B.push(h);for(var C=0,p=2*B.length;B.length>0&&(p--,!(0>p));)for(L=C;L<Y.length;L++){v=Y[L],D=-1;for(var h=0;h<B.length;h++)if(G=B[h],y=v.x+":"+v.y+":"+G,j[y]===r){N=O[G];for(var I=0;I<N.length;I++)if(l=N[I],o(L,I)&&!T(v,l)&&!e(v,l)){D=I,B.splice(h,1),A=Y.slice(0,L+1),k=Y.slice(L),_=N.slice(D),f=N.slice(0,D+1),Y=A.concat(_).concat(f).concat(k),C=L;break}if(D>=0)break;j[y]=!0}if(D>=0)break}return Y}for(var V,O,v,$,A,y,Q={},j=S.concat(),U=0,G=u.length;G>U;U++)Array.prototype.push.apply(j,u[U]);for(V=0,O=j.length;O>V;V++)A=j[V].x+":"+j[V].y,Q[A]!==r,Q[A]=V;var m=D(S,u),d=Mo.Triangulate(m,!1);for(V=0,O=d.length;O>V;V++)for($=d[V],v=0;3>v;v++)A=$[v].x+":"+$[v].y,y=Q[A],y!==r&&($[v]=y);return d.concat()},isClockWise:function(M){return Mo.Triangulate.area(M)<0},b2p0:function(x,G){var y=1-x;return y*y*G},b2p1:function(u,l){return 2*(1-u)*u*l},b2p2:function(I,B){return I*I*B},b2:function(c,Z,p,f){return this.b2p0(c,Z)+this.b2p1(c,p)+this.b2p2(c,f)},b3p0:function(Y,e){var l=1-Y;return l*l*l*e},b3p1:function(k,R){var Q=1-k;return 3*Q*Q*k*R},b3p2:function(y,Y){var n=1-y;return 3*n*y*y*Y},b3p3:function(b,C){return b*b*b*C},b3:function(D,J,b,k,G){return this.b3p0(D,J)+this.b3p1(D,b)+this.b3p2(D,k)+this.b3p3(D,G)}},Mo={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var g=b.keys(this.faces);return g.length?g[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(a){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(u){var A=u.familyName.toLowerCase(),c=this;return c.faces[A]=c.faces[A]||{},c.faces[A][u.cssFontWeight]=c.faces[A][u.cssFontWeight]||{},c.faces[A][u.cssFontWeight][u.cssFontStyle]=u,u},drawText:function(W){var P,i=this.getFace(),c=this.size/i.resolution,m=0,v=String(W).split(""),f=v.length,Z=[];for(P=0;f>P;P++){var t=new Cg,e=this.extractGlyphPoints(v[P],i,c,m,t);e&&(m+=e.offset*this.spacing,Z.push(e.path))}var H=m/2;return{paths:Z,offset:H}},extractGlyphPoints:function(R,u,$,w,i){var K,D,l,k,V,F,U,M,t,E,p,H,O,s,c,A,e,G,f,y=[],h=u.glyphs[R]||u.glyphs["?"];if(h){if(h.o)for(k=h._cachedOutline||(h._cachedOutline=h.o.split(" ")),F=k.length,U=$,M=$,K=0;F>K;)switch(V=k[K++]){case"m":t=k[K++]*U+w,E=k[K++]*M,i.moveTo(t,E);break;case"l":t=k[K++]*U+w,E=k[K++]*M,i.lineTo(t,E);break;case"q":if(p=k[K++]*U+w,H=k[K++]*M,c=k[K++]*U+w,A=k[K++]*M,i.quadraticCurveTo(c,A,p,H),f=y[y.length-1])for(O=f.x,s=f.y,D=1,l=this.divisions;l>=D;D++){var _=D/l;xd.b2(_,O,c,p),xd.b2(_,s,A,H)}break;case"b":if(p=k[K++]*U+w,H=k[K++]*M,c=k[K++]*U+w,A=k[K++]*M,e=k[K++]*U+w,G=k[K++]*M,i.bezierCurveTo(c,A,e,G,p,H),f=y[y.length-1])for(O=f.x,s=f.y,D=1,l=this.divisions;l>=D;D++){var _=D/l;xd.b3(_,O,c,e,p),xd.b3(_,s,A,G,H)}}return{offset:h.ha*$,path:i}}}};Mo.generateShapes=function(D,l){l=l||{};var M=l.font;if(M===r&&(M=Mo.getDefaultFont(),!M))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var q=l.size!==r?l.size:1,y=l.curveSegments!==r?l.curveSegments:4,L=l.spacing!==r?l.spacing:1,t=l.weight!==r?l.weight:"normal",e=l.style!==r?l.style:"normal";Mo.size=q,Mo.divisions=y,Mo.face=M,Mo.weight=t,Mo.style=e,Mo.spacing=L;for(var K=Mo.drawText(D),s=K.paths,Y=[],$=0,R=s.length;R>$;$++)Array.prototype.push.apply(Y,s[$].toShapes());return Y},function(v){var d=1e-10,h=function(V,R){var X=V.length;if(3>X)return null;var e,l,$,h=[],i=[],T=[];if(y(V)>0)for(l=0;X>l;l++)i[l]=l;else for(l=0;X>l;l++)i[l]=X-1-l;var B=X,Y=2*B;for(l=B-1;B>2;){if(Y--<=0)return R?T:h;if(e=l,e>=B&&(e=0),l=e+1,l>=B&&(l=0),$=l+1,$>=B&&($=0),S(V,e,l,$,B,i)){var p,v,g,Q,w;for(p=i[e],v=i[l],g=i[$],h.push([V[p],V[v],V[g]]),T.push([i[e],i[l],i[$]]),Q=l,w=l+1;B>w;Q++,w++)i[Q]=i[w];B--,Y=2*B}}return R?T:h},y=function(e){for(var j=e.length,t=0,b=j-1,Z=0;j>Z;b=Z++)t+=e[b].x*e[Z].y-e[Z].x*e[b].y;return.5*t},S=function(U,h,A,E,b,y){var J,z,W,l,I,Y,O,t,S;if(z=U[y[h]].x,W=U[y[h]].y,l=U[y[A]].x,I=U[y[A]].y,Y=U[y[E]].x,O=U[y[E]].y,d>(l-z)*(O-W)-(I-W)*(Y-z))return!1;var T,Z,c,j,e,B,L,k,m,K,N,f,o,Q,D;for(T=Y-l,Z=O-I,c=z-Y,j=W-O,e=l-z,B=I-W,J=0;b>J;J++)if(t=U[y[J]].x,S=U[y[J]].y,!(t===z&&S===W||t===l&&S===I||t===Y&&S===O)&&(L=t-z,k=S-W,m=t-l,K=S-I,N=t-Y,f=S-O,D=T*K-Z*m,o=e*k-B*L,Q=c*f-j*N,D>=-d&&Q>=-d&&o>=-d))return!1;return!0};return v.Triangulate=h,v.Triangulate.area=y,v}(Mo),C._typeface_js={faces:Mo.faces,loadFace:Mo.loadFace};var Ag=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},Xf=Ag.prototype={constructor:Ag,computeFaceNormals:function(){for(var G=new hc,X=new hc,n=0,f=this.faces.length;f>n;n++){var V=this.faces[n],r=this.vertices[V.a],F=this.vertices[V.b],T=this.vertices[V.c];G.subVectors(T,F),X.subVectors(r,F),G.cross(X),G.normalize(),V.normal.copy(G)}},computeVertexNormals:function(X){var m,N,g,f,Y,_;for(_=new Array(this.vertices.length),m=0,N=this.vertices.length;N>m;m++)_[m]=new hc;if(X){var b,y,W,a=new hc,I=new hc;for(g=0,f=this.faces.length;f>g;g++)Y=this.faces[g],b=this.vertices[Y.a],y=this.vertices[Y.b],W=this.vertices[Y.c],a.subVectors(W,y),I.subVectors(b,y),a.cross(I),_[Y.a].add(a),_[Y.b].add(a),_[Y.c].add(a)}else for(g=0,f=this.faces.length;f>g;g++)Y=this.faces[g],_[Y.a].add(Y.normal),_[Y.b].add(Y.normal),_[Y.c].add(Y.normal);for(m=0,N=this.vertices.length;N>m;m++)_[m].normalize();for(g=0,f=this.faces.length;f>g;g++)Y=this.faces[g],Y.vertexNormals[0]=_[Y.a].clone(),Y.vertexNormals[1]=_[Y.b].clone(),Y.vertexNormals[2]=_[Y.c].clone()},mergeVertices:function(){var E,P,Y,l,z,m,o,H,b={},v=[],V=[],G=4,Z=J(10,G);for(Y=0,l=this.vertices.length;l>Y;Y++)E=this.vertices[Y],P=t(E.x*Z)+"_"+t(E.y*Z)+"_"+t(E.z*Z),b[P]===r?(b[P]=Y,v.push(this.vertices[Y]),V[Y]=v.length-1):V[Y]=V[b[P]];var N=[];for(Y=0,l=this.faces.length;l>Y;Y++){z=this.faces[Y],z.a=V[z.a],z.b=V[z.b],z.c=V[z.c],m=[z.a,z.b,z.c];for(var D=0;3>D;D++)if(m[D]==m[(D+1)%3]){N.push(Y);break}}for(Y=N.length-1;Y>=0;Y--){var g=N[Y];for(this.faces.splice(g,1),o=0,H=this.faceVertexUvs.length;H>o;o++)this.faceVertexUvs[o].splice(g,1)}var x=this.vertices.length-v.length;return this.vertices=v,x}},Br=function(C,U,D,W,F,y,n){this.aX=C,this.aY=U,this.xRadius=D,this.yRadius=W,this.aStartAngle=F,this.aEndAngle=y,this.aClockwise=n};Br.prototype=No(Eh),Br.prototype.getPoint=function(y){var A,S=this.aEndAngle-this.aStartAngle;0>S&&(S+=g),S>g&&(S-=g),A=this.aClockwise===!0?this.aEndAngle+(1-y)*(g-S):this.aStartAngle+y*S;var E=this.aX+this.xRadius*m(A),R=this.aY+this.yRadius*X(A);return new Gg(E,R)};var Uh=function(i,D){this.v1=i,this.v2=D},cp=Uh.prototype=No(Eh);cp.getPoint=function(R){var d=this.v2.clone().sub(this.v1);return d.multiplyScalar(R).add(this.v1),d},cp.getPointAt=function(J){return this.getPoint(J)},cp.getTangent=function(){var X=this.v2.clone().sub(this.v1);return X.normalize()};var zp=function(l,M,B){this.v0=l,this.v1=M,this.v2=B};zp.prototype=No(Eh),zp.prototype.getPoint=function(a){var u,q;return u=xd.b2(a,this.v0.x,this.v1.x,this.v2.x),q=xd.b2(a,this.v0.y,this.v1.y,this.v2.y),new Gg(u,q)};var Cn=function(G,s,f,x){this.v0=G,this.v1=s,this.v2=f,this.v3=x};Cn.prototype=No(Eh),Cn.prototype.getPoint=function(N){var J,S;return J=xd.b3(N,this.v0.x,this.v1.x,this.v2.x,this.v3.x),S=xd.b3(N,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Gg(J,S)},Pe.create(function(Z,J){this.v1=Z,this.v2=J},function(F){var R=new hc;return R.subVectors(this.v2,this.v1),R.multiplyScalar(F),R.add(this.v1),R});var sh=Pe.create(function(W,V,i){this.v0=W,this.v1=V,this.v2=i},function(l){var L,b,r;return L=xd.b2(l,this.v0.x,this.v1.x,this.v2.x),b=xd.b2(l,this.v0.y,this.v1.y,this.v2.y),r=xd.b2(l,this.v0.z,this.v1.z,this.v2.z),new hc(L,b,r)}),Go=Pe.create(function(S,q,z,E){this.v0=S,this.v1=q,this.v2=z,this.v3=E},function(v){var e,D,u;return e=xd.b3(v,this.v0.x,this.v1.x,this.v2.x,this.v3.x),D=xd.b3(v,this.v0.y,this.v1.y,this.v2.y,this.v3.y),u=xd.b3(v,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new hc(e,D,u)}),pm=function(U,f,L,Y,Q,V,A,I){Ag.call(this),Y=Y!==r?Y:.5,Q=Q!==r?Q:.5,I=I!==r?I:1,U=U||8,V=V||0,A=A||g;var B,D,J=1,Z=I/2,y=[],j=[],x=this.vertices,R=this.faces,T=this.faceVertexUvs;for(D=0;J>=D;D++){var k=[],H=[],p=D/J,P=p*(Q-Y)+Y;for(B=0;U>=B;B++){var W=B/U,S=new hc,M=-(W*A+V);S.z=P*X(M),S.y=-p*I+Z,S.x=P*m(M),x.push(S),k.push(x.length-1),H.push(new Gg(W,p))}y.push(k),j.push(H)}var n,w,i=(Q-Y)/I;for(B=0;U>B;B++)for(0!==Y?(n=x[y[0][B]].clone(),w=x[y[0][B+1]].clone()):(n=x[y[1][B]].clone(),w=x[y[1][B+1]].clone()),n.setY(_(n.x*n.x+n.z*n.z)*i).normalize(),w.setY(_(w.x*w.x+w.z*w.z)*i).normalize(),D=0;J>D;D++){var G=y[D][B],b=y[D+1][B],c=y[D+1][B+1],E=y[D][B+1],l=n.clone(),t=n.clone(),v=w.clone(),z=w.clone(),N=j[D][B].clone(),q=j[D+1][B].clone(),e=j[D+1][B+1].clone(),$=j[D][B+1].clone();R.push(new li(G,b,E,[l,t,z])),T[0].push([N,q,$]),R.push(new li(b,c,E,[t.clone(),v,z.clone()])),T[0].push([q.clone(),e,$.clone()])}if(f&&Y>0)for(this.vertices.push(new hc(0,Z,0)),B=0;U>B;B++){var G=y[0][B],b=y[0][B+1],c=this.vertices.length-1,l=new hc(0,1,0),t=new hc(0,1,0),v=new hc(0,1,0),N=j[0][B].clone(),q=j[0][B+1].clone(),e=new Gg(q.x,0);R.push(new li(G,b,c,[l,t,v],null,1));var d=B/U*g,K=m(d),F=X(d),u=(B+1)/U*g,s=m(u),O=X(u);T[0].push([new Gg(.5+.5*K,.5+.5*F),new Gg(.5+.5*s,.5+.5*O),new Gg(.5,.5)])}if(L&&Q>0)for(this.vertices.push(new hc(0,-Z,0)),B=0;U>B;B++){var G=y[D][B+1],b=y[D][B],c=x.length-1,l=new hc(0,-1,0),t=new hc(0,-1,0),v=new hc(0,-1,0),N=j[D][B+1].clone(),q=j[D][B].clone();R.push(new li(G,b,c,[l,t,v],null,2));var d=B/U*g,K=m(d),F=X(d),u=(B+1)/U*g,s=m(u),O=X(u);T[0].push([new Gg(.5+.5*s,.5-.5*O),new Gg(.5+.5*K,.5-.5*F),new Gg(.5,.5)])}};pm.prototype=No(Xf);var ir=function(B,x,E,j,e,Y,P){Ag.call(this),P=P||.5,B=B||16,x=x||16,E=(E!==r?E:0)-Z,j=j!==r?j:g,e=e!==r?e:0,Y=Y!==r?Y:Z;var C,T,f=[],$=[],I=this.vertices,z=this.faces,i=this.faceVertexUvs;for(T=0;x>=T;T++){var G=[],v=[];for(C=0;B>=C;C++){var J=C/B,F=T/x,L=new hc;L.x=-P*m(E+J*j)*X(e+F*Y),L.y=P*m(e+F*Y),L.z=P*X(E+J*j)*X(e+F*Y),I.push(L),G.push(I.length-1),v.push(new Gg(J,F))}f.push(G),$.push(v)}for(T=0;x>T;T++)for(C=0;B>C;C++){var o=f[T][C+1],q=f[T][C],K=f[T+1][C],a=f[T+1][C+1],D=I[o].clone().normalize(),A=I[q].clone().normalize(),t=I[K].clone().normalize(),d=I[a].clone().normalize(),w=$[T][C+1].clone(),s=$[T][C].clone(),H=$[T+1][C].clone(),W=$[T+1][C+1].clone();k(I[o].y)===P?(w.x=(w.x+s.x)/2,z.push(new li(o,K,a,[D,t,d])),i[0].push([w,H,W])):k(I[K].y)===P?(H.x=(H.x+W.x)/2,z.push(new li(o,q,K,[D,A,t])),i[0].push([w,s,H])):(z.push(new li(o,q,a,[D,A,d])),i[0].push([w,s,W]),z.push(new li(q,K,a,[A.clone(),t,d.clone()])),i[0].push([s.clone(),H,W.clone()]))}};ir.prototype=No(Xf);var pj=function(d,l,c,u,T,I){Ag.call(this),d=d||.33,l=l||.17,u=u||8,c=c||6,T=T||0,I=I||g;for(var U=new hc,x=[],y=[],D=0;u>=D;D++)for(var H=D/u*g+Z,R=0;c>=R;R++){var V=R/c*I+T;U.x=d*m(V),U.z=-d*X(V);var p=new hc,B=d+l*m(H);p.x=B*m(V),p.z=-B*X(V),p.y=l*X(H),this.vertices.push(p),x.push(new Gg(R/c,1-D/u)),y.push(p.clone().sub(U).normalize())}for(var D=1;u>=D;D++)for(var R=1;c>=R;R++){var F=(c+1)*D+R-1,G=(c+1)*(D-1)+R-1,r=(c+1)*(D-1)+R,j=(c+1)*D+R,O=new li(F,G,j,[y[F].clone(),y[G].clone(),y[j].clone()]);this.faces.push(O),this.faceVertexUvs[0].push([x[F].clone(),x[G].clone(),x[j].clone()]),O=new li(G,r,j,[y[G].clone(),y[r].clone(),y[j].clone()]),this.faces.push(O),this.faceVertexUvs[0].push([x[G].clone(),x[r].clone(),x[j].clone()])}this.computeFaceNormals()};pj.prototype=No(Xf);var Nj=function(B,d,b){return B?(Ag.call(this),B=B instanceof Array?B:[B],this.addShapeList(B,d),d.convertYZ!==!1&&bc(this,b),this.computeFaceNormals(),void 0):(B=[],void 0)},qr=Nj.prototype=No(Ag.prototype);qr.addShapeList=function(D,V){for(var l=D.length,q=0;l>q;q++){var Z=D[q];this.addShape(Z,V)}},qr.addShape=function(K,g){function O(){if(g.bottom)for(var H=0;J>H;H++)y=E[H],j(y[2],y[1],y[0],!0);if(g.top)for(H=0;J>H;H++)y=E[H],j(y[0]+S*G,y[1]+S*G,y[2]+S*G,!1)}function Z(){var X=0;for(U(L,X),X+=L.length,T=0,A=f.length;A>T;T++)N=f[T],U(N,X),X+=N.length}function U(o,r){for(var b,Q,q=o.length;--q>=0;){b=q,Q=q-1,0>Q&&(Q=o.length-1);var A=0,x=G;for(A=0;x>A;A++){var X=S*A,J=S*(A+1),z=r+b+X,B=r+Q+X,F=r+Q+J,l=r+b+J;c(z,B,F,l,o,A,x,b,Q)}}}function D(J,U,I){_.vertices.push(new hc(J,U,I))}function j(u,q,x,T){u+=Q,q+=Q,x+=Q,_.faces.push(new li(u,q,x,null,null,T?2:1));var n=T?o.generateBottomUV(_,K,g,u,q,x):o.generateTopUV(_,K,g,u,q,x);_.faceVertexUvs[0].push(n)}function c(Y,W,F,T,H,I,G,d,w){Y+=Q,W+=Q,F+=Q,T+=Q,_.faces.push(new li(Y,W,T)),_.faces.push(new li(W,F,T));var r=o.generateSideWallUV(_,K,H,g,Y,W,F,T,I,G,d,w);_.faceVertexUvs[0].push([r[0],r[1],r[3]]),_.faceVertexUvs[0].push([r[1],r[2],r[3]])}var h,R,k,t,m,b=g.amount,p=g.curveSegments||Xq,G=g.steps||1,$=g.extrudePath,C=!1,o=new Zj(g.repeatUVLength,g.boundingBox);$&&(h=$.getSpacedPoints(G),C=!0,R=g.frames!==r?g.frames:new Dp.FrenetFrames($,G,!1),k=new hc,t=new hc,m=new hc);var N,T,A,_=this,Q=this.vertices.length,P=K.extractPoints(p),W=P.shape,f=P.holes,e=!xd.isClockWise(W);if(e){for(W=W.reverse(),T=0,A=f.length;A>T;T++)N=f[T],xd.isClockWise(N)&&(f[T]=N.reverse());e=!1}var E=xd.triangulateShape(W,f),L=W;for(T=0,A=f.length;A>T;T++)N=f[T],W=W.concat(N);for(var d,y,S=W.length,J=E.length,q=0;S>q;q++)d=W[q],C?(t.copy(R.normals[0]).multiplyScalar(d.x),k.copy(R.binormals[0]).multiplyScalar(d.y),m.copy(h[0]).add(t).add(k),D(m.x,m.y,m.z)):D(d.x,d.y,0);var w;for(w=1;G>=w;w++)for(q=0;S>q;q++)d=W[q],C?(t.copy(R.normals[w]).multiplyScalar(d.x),k.copy(R.binormals[w]).multiplyScalar(d.y),m.copy(h[w]).add(t).add(k),D(m.x,m.y,m.z)):D(d.x,d.y,b/G*w);O(),Z()};var Dp=function(c,H,r,P,u){function S(A,I,q){return Y.vertices.push(new hc(A,I,q))-1}Ag.call(this),H=H||64,r=r||1,P=P||8,u=u||!1;var w,R,G,Z,D,o,N,I,U,J,W,l,s,_,i,k,v,Q,p,t,q=[],Y=this,z=H+1,f=new hc,E=new Dp.FrenetFrames(c,H,u),h=E.tangents,O=E.normals,V=E.binormals;for(this.tangents=h,this.normals=O,this.binormals=V,U=0;z>U;U++)for(q[U]=[],Z=U/(z-1),I=c.getPointAt(Z),w=h[U],R=O[U],G=V[U],J=0;P>J;J++)D=J/P*g,o=-r*m(D),N=r*X(D),f.copy(I),f.x+=o*R.x+N*G.x,f.y+=o*R.y+N*G.y,f.z+=o*R.z+N*G.z,q[U][J]=S(f.x,f.y,f.z);for(U=0;H>U;U++)for(J=0;P>J;J++)W=u?(U+1)%H:U+1,l=(J+1)%P,s=q[U][J],_=q[W][J],i=q[W][l],k=q[U][l],v=new Gg(U/H,J/P),Q=new Gg((U+1)/H,J/P),p=new Gg((U+1)/H,(J+1)/P),t=new Gg(U/H,(J+1)/P),this.faces.push(new li(s,_,k)),this.faceVertexUvs[0].push([v,Q,t]),this.faces.push(new li(_,i,k)),this.faceVertexUvs[0].push([Q.clone(),p,t.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Dp.prototype=No(Xf),Dp.FrenetFrames=function(n,J,Y){function D(){S[0]=new hc,w[0]=new hc,F=Number.MAX_VALUE,o=k(A[0].x),M=k(A[0].y),e=k(A[0].z),F>=o&&(F=o,Q.set(1,0,0)),F>=M&&(F=M,Q.set(0,1,0)),F>=e&&Q.set(0,0,1),d.crossVectors(A[0],Q).normalize(),S[0].crossVectors(A[0],d),w[0].crossVectors(A[0],S[0])}var u,F,o,M,e,G,N,Q=new hc,A=[],S=[],w=[],d=new hc,g=new Sn,b=J+1,x=1e-4;for(this.tangents=A,this.normals=S,this.binormals=w,G=0;b>G;G++)N=G/(b-1),A[G]=n.getTangentAt(N),A[G].normalize();for(D(),G=1;b>G;G++)S[G]=S[G-1].clone(),w[G]=w[G-1].clone(),d.crossVectors(A[G-1],A[G]),d.length()>x&&(d.normalize(),u=s(Um(A[G-1].dot(A[G]),-1,1)),S[G].applyMatrix4(g.makeRotationAxis(d,u))),w[G].crossVectors(A[G],S[G]);if(Y)for(u=s(Um(S[0].dot(S[b-1]),-1,1)),u/=b-1,A[0].dot(d.crossVectors(S[0],S[b-1]))>0&&(u=-u),G=1;b>G;G++)S[G].applyMatrix4(g.makeRotationAxis(A[G],u*G)),w[G].crossVectors(A[G],S[G])};var wp=function(i,x,P,j){Ag.call(this),x=x||18,P=P||0,j=j==$?g:j;for(var Y=1/(i.length-1),Q=1/x,c=0,L=x;L>=c;c++)for(var K=P+c*Q*j,y=m(K),B=X(K),R=0,O=i.length;O>R;R++){var M=i[R],s=new hc;s.x=y*M.x-B*M.y,s.y=B*M.x+y*M.y,s.z=M.z,this.vertices.push(s)}for(var A=i.length,c=0,L=x;L>c;c++)for(var R=0,O=i.length-1;O>R;R++){var z=R+A*c,N=z,e=z+A,y=z+1+A,h=z+1,T=c*Q,l=R*Y,H=T+Q,Z=l+Y;this.faces.push(new li(N,h,e)),this.faceVertexUvs[0].push([new Gg(T,l),new Gg(T,Z),new Gg(H,l)]),this.faces.push(new li(e,h,y)),this.faceVertexUvs[0].push([new Gg(H,l),new Gg(T,Z),new Gg(H,Z)])}this.mergeVertices(),bc(this),this.computeFaceNormals(),this.computeVertexNormals()};wp.prototype=No(Xf);var ue=function(E,v){v=v||{};var z=Mo.generateShapes(E,v);v.amount=v.amount!==r?v.amount:.5,v.convertYZ=!1,v.fill!==!1&&(v.bottom=!0,v.top=!0),Nj.call(this,z,v)
};ue.prototype=No(qr);var Qh=A.Node=function(){ud(Qh,this)},Wf={X:kd,Y:ob,Z:Eq},jk={X:0,Y:1,Z:2},Yl={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},lj=new Ab,_c="xzy",zh=function(E,Z,L){if(Z){var N=Z[0],F=Z[1],d=Z[2];"xzy"===L?(ob(E,F),Eq(E,d),kd(E,N)):"xyz"===L?(Eq(E,d),ob(E,F),kd(E,N)):"yxz"===L?(Eq(E,d),kd(E,N),ob(E,F)):"yzx"===L?(kd(E,N),Eq(E,d),ob(E,F)):"zxy"===L?(ob(E,F),kd(E,N),Eq(E,d)):"zyx"===L?(kd(E,N),ob(E,F),Eq(E,d)):(ob(E,F),Eq(E,d),kd(E,N))}};Mf("Node",$h,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:_c,_64O:0,_rotationX:0,_53O:0,_host:$,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return _o},_22Q:function(){return jt},getX:function(){return this.p().x},setX:function(j){this.p(j,this.p().y)},getY:function(){return this.p().y},setY:function(u){this.p(this.p().x,u)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(T){this.setAnchor(T,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(U){this.setAnchor(this.getAnchor().x,U)},getScaleX:function(){return this.getScale().x},setScaleX:function(Q){this.setScale(Q,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(T){this.setScale(this.getScale().x,T)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},setQuaternion:function(P){var Z=(new Mn).setFromQuaternion(P,Mn.ReverseOrder(this.getRotationMode()));return this._applyClosestR3(Z.x,Z.y,Z.z)},getQuaternion:function(){var D=new Mn,Q=new Mn,g=new Ab;return function($){return $||($=new Ab),this.getEuler(D),D.equals(Q)?$.copy(g):$.copy(g.setFromEuler(Q.copy(D)))}}(),getEuler:function(y){var Z=this.r3();return y||(y=new Mn),y.set(Z[0],Z[1],Z[2],Mn.ReverseOrder(this.getRotationMode()))},setEuler:function(K){return K=K.clone().reorder(Mn.ReverseOrder(this.getRotationMode())),this.r3(K.x,K.y,K.z)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(f,G){Vk(f,Nm($,$,this.r3(),this.getRotationMode())),this.translate3d(f[0]*G,f[1]*G,f[2]*G)},translateFront:function(V){this.translate3dBy([0,0,1],V)},translateBack:function(Z){this.translate3dBy([0,0,-1],Z)},translateLeft:function(i){this.translate3dBy([-1,0,0],i)},translateRight:function(O){this.translate3dBy([1,0,0],O)},translateTop:function(U){this.translate3dBy([0,1,0],U)},translateBottom:function(r){this.translate3dBy([0,-1,0],r)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(m,o,y){1===arguments.length&&(o=m[1],y=m[2],m=m[0]),this.p(m,y),this.setElevation(o)},translate3d:function(Q,W,q){1===arguments.length&&(W=Q[1],q=Q[2],Q=Q[0]),this.translate(Q,q),this.setElevation(this._54O+W)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(Z,M,j){1===arguments.length&&(M=Z[1],j=Z[2],Z=Z[0]),this.setSize(Z,j),this.setTall(M)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(i,F,f){var M=this;if(!M._updatingRotation3d){M._updatingRotation3d=1,1===arguments.length&&(F=i[1],f=i[2],i=i[0]);var q=[M._rotationX,-M._64O,M._53O];M._rotationX=i,M._64O=-F,M._53O=f,M.fp("rotation3d",q,[i,F,f]),delete M._updatingRotation3d}},_applyClosestR3:function(){function $(Y){return Y%=g,0>Y&&(Y+=g),Y>Z?g-Y:Y}function D(T,g){return $(T[0]-g[0])+$(T[1]-g[1])+$(T[2]-g[2])}return function(e,Q,P){var I,K,L,G=this.r3(),l=this.getRotationMode();"xzy"===l||"yzx"===l?(I=e>0?e-Z:e+Z,K=Q>0?Q-Z:Q+Z,L=P>0?Z-P:-Z-P):"xyz"===l||"zyx"===l?(I=e>0?e-Z:e+Z,L=P>0?P-Z:P+Z,K=Q>0?Z-Q:-Z-Q):("yxz"===l||"zxy"===l)&&(L=P>0?P-Z:P+Z,K=Q>0?Q-Z:Q+Z,I=e>0?Z-e:-Z-e),D([I,K,L],G)<D([e,Q,P],G)?this.r3(I,K,L):this.r3(e,Q,P)}}(),setRotationY:function(e){this.setRotation(-e)},getRotationY:function(){return-this._64O},lookAtDirection:function(i,d){d=d||Er;var w=this,T=Kj(i);d===Er?(w.r3([-F(i[1]/T),-ys(i[2],i[0])+Ce,0]),w.setRotationMode("xzy")):d===vp?(w.r3(0,-ys(i[2],i[0]),F(i[1]/T)),w.setRotationMode("zyx")):d===sl?(w.r3(0,-ys(i[2],i[0])+Z,-F(i[1]/T)),w.setRotationMode("zyx")):d===Yd?(w.r3([-F(i[1]/T)+Ce,-ys(i[2],i[0])+Ce,0]),w.setRotationMode("xzy")):d===gg&&(w.r3([-F(i[1]/T)-Ce,-ys(i[2],i[0])+Ce,0]),w.setRotationMode("xzy")),d===yc&&(w.r3([-F(i[1]/T)+Z,-ys(i[2],i[0])+Ce,Z]),w.setRotationMode("zxy"))},lookAt:function(c,f){return this.lookAtDirection(Ur(c,this.p3()),f)},lookAtX:function(){var v=new hb,T=new hb,B=new hb,Z=new Sn,C=new Sn,_=new Mn;return function(o,g){var t=Zi(this);if(Z.fromArray(t),B.copy(this.p3()),v.copy(o).sub(B),!(v.lengthSq()<1e-6)){v.normalize(),g=g||Er,"string"==typeof g?g===Er?T.set(0,0,1):g===yc?T.set(0,0,-1):g===sl?T.set(-1,0,0):g===vp?T.set(1,0,0):g===Yd?T.set(0,1,0):g===gg&&T.set(0,-1,0):T.copy(g).normalize(),T.applyMatrix4(Z).sub(B).normalize();var X=Math.acos(v.dot(T));if(X){var q=v.clone().cross(T);q.lengthSq()<1e-6&&(g===Yd||g===gg||0===g[0]&&0===g[1]?q.set(0,0,1).applyMatrix4(Z).sub(B):q.set(0,1,0).applyMatrix4(Z).sub(B)),q.normalize(),_.set(this.r3(),this.getRotationMode(),!0),Z.makeRotationFromEuler(_),C.makeRotationAxis(q,-X),_.setFromRotationMatrix(C.multiply(Z)),this._applyClosestR3(_.x,_.y,_.z)}}}}(),getHost:function(){return this._host},setHost:function(k){var H=this;if(H!==k&&H._host!==k){var c=H._host;c&&(c._removeAttach(H),c.updateLayoutAttaches()),H._host=k,H._host&&(H._host._addAttach(H),H._host.updateLayoutAttaches()),H.fp("host",c,k),H.onHostChanged(c,k)}},getAttaches:function(){return this._69O},_addAttach:function(h){var K=this;K._69O||(K._69O=new Od),K._69O.add(h),K.fp("attaches",$,h)},_removeAttach:function(I){var c=this;c._69O.remove(I),c._69O.isEmpty()&&delete c._69O,c.fp("attaches",I,$)},getImage:function(){if(this._pendingCheckImageJSON){var j=u.getImage(this._image);j&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Cd&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(e){var f=this,S=f._image,y=f.getWidth(),T=f.getHeight();if(f._image=e,f.fp("image",S,e)){if(null!=e&&(Tq(e)||ph(e)&&/\.json$/i.test(e))&&(this._pendingCheckImageJSON=!0),Qk)return;f.fp(Ac,y,f.getWidth()),f.fp(Tl,T,f.getHeight())}},getElevation:function(){return this._54O},setElevation:function(F){var d=this;if(!d._50O){d._50O=1;var f=d._54O;d._54O=F,d.fp(Ob,f,F),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(S){var s=this;if(!s._49O){s._49O=1;var Q=s._64O;s._64O=S,s.fp(jl,Q,S),delete s._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(r){var e=this;if(!e._51O){e._51O=1;var E=e._rotationX;e._rotationX=r,e.fp("rotationX",E,r),delete e._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(C){var u=this;if(!u._52O){u._52O=1;var V=u._53O;u._53O=C,u.fp("rotationZ",V,C),delete u._52O}},getPosition:function(){return this._position},setPosition:function(v,E){var H=this;if(!H._50I){H._50I=1;var V;if(V=2===arguments.length?{x:v,y:E}:v,V.x!==H._position.x||V.y!==H._position.y){var L=H._position;H._position=V,H.fp(zk,L,V)}delete H._50I}},translate:function(U,G){var b=this._position;this.p(b.x+U,b.y+G)},hasInheritedSize:function(){var R=this,$=R.getStyle("shape3d");if($){var D=Pf($);if(D&&D.rawS3)return!0;if(("billboard"===$||"plane"===$)&&Of(R.getStyle("shape3d.image")))return!0}return R.hasOwnProperty("_image")&&Of(R._image)?!0:!1},getWidth:function(){var L=this;if(L._width>=0)return L._width;var r=L.getStyle("shape3d");if(r){var v=Pf(r);if(v&&v.rawS3)return v.rawS3[0];if("billboard"===r||"plane"===r){var k=Of(L.getStyle("shape3d.image"));return k?Hn(k,L):20}}var k=Of(L._image);return k?Hn(k,L):20},setWidth:function(b){var n=this,R=n._width;n._width=b,n.fp(Ac,R,b)},getHeight:function(){var j=this;if(j._height>=0)return j._height;var l=j.getStyle("shape3d");if(l){var M=Pf(l);if(M&&M.rawS3)return M.rawS3[2];if("plane"===l){var y=Of(j.getStyle("shape3d.image"));return y?ks(y,j):20}if("billboard"===l)return 2}var y=Of(j._image);return y?ks(y,j):20},setHeight:function(e){var T=this,L=T._height;T._height=e,T.fp(Tl,L,e)},getTall:function(){var Z=this;if(Z._tall>=0)return Z._tall;var y=Z.getStyle("shape3d");if(y){var B=Pf(y);if(B&&B.rawS3)return B.rawS3[1];if("billboard"===y){var A=Of(Z.getStyle("shape3d.image"));return A?ks(A,Z):20}if("plane"===y)return 2}return 20},setTall:function(x){var u=this,t=u._tall;u._tall=x,u.fp("tall",t,x)},setSize:function(K,F){var $=this;2===arguments.length?($.setWidth(K),$.setHeight(F)):($.setWidth(K.width),$.setHeight(K.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(v,u,i,g,t){var s=this,y=s.getAnchor(),b=s.getScale();arguments.length<=2&&(t=u,u=v.y,i=v.width,g=v.height,v=v.x);var o=t&&b.x<0?1-y.x:y.x,M=t&&b.y<0?1-y.y:y.y;s.p(v+i*o,u+g*M),t&&(i/=Math.abs(b.x),g/=Math.abs(b.y)),s.setWidth(i),s.setHeight(g)},getMatrix:function(){var v=this,K=v._64O,O=v._position,I=v.getScale();return new nb(K,O.x,O.y,I.x,I.y)},getMatrix4:function(){var n=new hb,C=new Ab,O=new hb;return function(P){return this.getQuaternion(C),n.copy(this.p3()),O.copy(this.getFinalScale3d()),P||(P=new Sn),P.compose(n,C,O)}}(),getAnchorRect:function(){var k=this,I=k.getWidth(),L=k.getHeight(),P=k.getAnchor();return{x:-I*P.x,y:-L*P.y,width:I,height:L}},toLocal:function(g){return this.getMatrix().tfi(g)},toGlobal:function(h){return this.getMatrix().tf(h)},getAttachPosition:function(){var X=new nb;return function(z,b,A,y){A=A||0,y=y||0;var l=this,c=l.getAnchor(),v=l._64O,w=l._position,W=l.getScale();return X.setFromTransform(v,w.x,w.y).tf({x:A+W.x*l.getWidth()*(z-c.x),y:y+W.y*l.getHeight()*(b-c.y)})}}(),isInRect:function(D){D=this.toLocal(D);var C=this.getWidth(),i=this.getHeight();return D.x+=C*this.getAnchorX(),D.y+=i*this.getAnchorY(),!(D.x<0||D.y<0||D.x>C||D.y>i)},getRect:function(){var H=this,K=H.getWidth(),C=H.getHeight(),j=H.getAnchor(),R={x:-K*j.x,y:-C*j.y,width:K,height:C},S=H.getMatrix();return R=Tg([S.tf(R.x,R.y),S.tf(R.x+R.width,R.y),S.tf(R.x+R.width,R.y+R.height),S.tf(R.x,R.y+R.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var h=this,D=h.getAnchor(),c=h._anchorElevation;return{x:D.x,y:c,z:D.y}},setAnchorElevation:function(c){var F=this,l=F._anchorElevation;return l!==c?(F._anchorElevation=c,F.fp("anchorElevation",l,c),!0):!1},setAnchor3d:function(i,m,P,B){var q,s=this;"number"==typeof i?q={x:i,y:m,z:P}:(q=i.length?{x:i[0],y:i[1],z:i[2]}:i,B=m),s.beginTransaction();var z=s.getAnchor3d(),R=s.setAnchor(q.x,q.z);if(s.setAnchorElevation(q.y)&&(R=!0),R&&B&&!Qk){s.getAnchor3d();var g=Zi(s),H=Vk([q.x-z.x,q.y-z.y,q.z-z.z],g);s.p3(H)}return s.endTransaction(),R},getAnchor:function(){var M=this;if(M.hasOwnProperty("_anchor"))return M._anchor;var n=Of(M._image);return n&&n.anchorX!==r?{x:n.anchorX,y:n.anchorY}:M._anchor},setAnchor:function(Q,x,r){var _,Z=this;"number"==typeof Q?_={x:Q,y:x}:(_=Q.length?{x:Q[0],y:Q[1]}:Q,r=x);var u=Z.getAnchor();if(u.x!==_.x||u.y!==_.y){if(Z.beginTransaction(),Z._anchor=_,Z.fp("anchor",u,_),r&&!Qk){var T=Z.getPosition(),U=Z.getSize(),s=Z.getRotation(),W=Z.getScale(),p=-U.width*(u.x-_.x)*W.x,N=-U.height*(u.y-_.y)*W.y,a=X(s),V=m(s);Z.setPosition(T.x+V*p-a*N,T.y+a*p+V*N)}return Z.endTransaction(),!0}return!1},getLocalQuaternion:function(C){var k=this,c=k.getHost();if(!c)return k.getQuaternion(C);var i=c.getQuaternion(),S=k.getQuaternion();return C||(C=new Ab),C.copy(i).inverse().multiply(S)},setLocalQuaternion:function(T){var h=this,w=h.getHost();if(!w)return h.setQuaternion(T);var Z=w.getQuaternion();h.setQuaternion(Z.clone().multiply(T))},getLocalEuler:function(){var L=new Ab;return function(p){var m=this,T=m.getHost();return T?(m.getLocalQuaternion(L),p||(p=new Mn),p.setFromQuaternion(L,Mn.ReverseOrder(this.getRotationMode()))):m.getEuler(p)}}(),setLocalEuler:function(){var t=new Ab;return function(V){var K=this,q=K.getHost();return q?(t.setFromEuler(V),K.setLocalQuaternion(t)):K.setEuler(V)}}(),getLocalPosition3d:function(o){var C=this;o||(o=new hb),o.copy(C.p3());var m=C.getHost();if(!m)return o;var w=m.getMatrix4();return o.applyMatrix4(w.getInverse(w))},setLocalPosition3d:function(y){var w=this,I=w.getHost();if(!I)return y.x!==r?w.p3(y.x,y.y,y.z):w.p3(y),void 0;var B=I.getMatrix4(),E=new hb(y);E.applyMatrix4(B),w.p3(E.x,E.y,E.z)},getScale:function(){return this._scale},setScale:function(D,r){var X,o=this;X=2===arguments.length?{x:D,y:r}:D;var P=o.getScale();(P.x!==X.x||P.y!==X.y)&&(o._scale=X,o.fp("scale",P,X))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var s=this,U=s._scaleTall,t=s.getScale();return[t.x,U,t.y]},getFinalScale3d:function(){var h=this,O=h.s3(),y=h._dynamicScale3d,J=h.getScale3d();return O&&(J[0]*=O[0],J[1]*=O[1],J[2]*=O[2]),y&&(J[0]*=y[0],J[1]*=y[1],J[2]*=y[2]),J},getFinalRotation3d:function(){var G=this;return G._dynamicRotation||G.r3()},setScaleTall:function(E){var b=this,P=b._scaleTall;P!==E&&(b._scaleTall=E,b.fp("scaleTall",P,E))},setScale3d:function(F,Q,T){var g,a=this;g="number"==typeof F?{x:F,y:Q,z:T}:F.length?{x:F[0],y:F[1],z:F[2]}:F,a.setScaleTall(g.y),a.setScale(g.x,g.z)},getCorners:function(k,H){k==$&&(k=0),H==$&&(H=k);var E=this,z=E.getAnchor(),O=E.getWidth(),j=E.getHeight(),t=-O*z.x-k,K=-j*z.y-H,D=O+2*k,q=j+2*H,g=E.getMatrix();return[g.tf(t,K),g.tf(t,K+q),g.tf(t+D,K+q),g.tf(t+D,K)]},getEditControlPoints:function(A,h,M){h==$&&(h=0),M==$&&(M=h);var Q=this,D=Q.getAnchor(),z=Q.getWidth(),T=Q.getHeight(),t=-z*D.x-h,Y=-T*D.y-M,l=z+2*h,N=T+2*M;if(A)return[{x:t,y:Y},{x:t,y:0},{x:t,y:Y+N},{x:0,y:Y+N},{x:t+l,y:Y+N},{x:t+l,y:0},{x:t+l,y:Y},{x:0,y:Y}];var I=Q.getMatrix();return[I.tf(t,Y),I.tf(t,0),I.tf(t,Y+N),I.tf(0,Y+N),I.tf(t+l,Y+N),I.tf(t+l,0),I.tf(t+l,Y),I.tf(0,Y)]},rotateAt:function(n,q,S){var Q=this,g=Q._position,H=Q._64O,Y=new nb(H,g.x,g.y).tf(n,q),T=_(n*n+q*q),x=ys(g.y-Y.y,g.x-Y.x)+S;Q.setRotation(H+S),Q.p(Y.x+T*m(x),Y.y+T*X(x))},rotateAroundAxis:function(p,c){this.setQuaternion(this.getQuaternion().multiply(lj.setFromAxisAngle(p,c)))},rotateAroundWorldAxis:function(K,m){this.setQuaternion(this.getQuaternion().premultiply(lj.setFromAxisAngle(K,m)))},rotateX:function(N){return this.rotateAroundAxis(hb.AxisX,N)},rotateY:function(k){return this.rotateAroundAxis(hb.AxisY,k)},rotateZ:function(I){return this.rotateAroundAxis(hb.AxisZ,I)},onParentChanged:function(){Qh.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var N={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function($){N[$]=!0}),function(s){var a=this;Qh.superClass.onPropertyChanged.call(a,s);var L=s.property;if(N[L]&&!a._layoutUpdating&&a.updateLayoutParameters(null,L),a._69O&&a._69O.each(function(m){m.handleHostPropertyChange(s)}),a._49I&&a._49I.each(function(c){c.fp("agentChange",!0,!1)}),Qb[L]&&this.updateLayoutAttaches(),"a:layout"===L.substring(0,8)){this.updateLayoutAttaches();var n=a._host;n&&n.updateLayoutAttaches()}("s:shape3d.autorotate"===L||"s:autorotate"===L||"s:shape3d.fixSizeOnScreen"===L||"s:fixSizeOnScreen"===L||"s:hide.overlapping.group"===L)&&(a._47Q=a.s("autorotate")||a.s("shape3d.autorotate")||a.s("fixSizeOnScreen")||a.s("shape3d.fixSizeOnScreen")||a.s("hide.overlapping.group"))}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(Z){this.updateAttach(Z)},onStyleChanged:function(D){Qh.superClass.onStyleChanged.apply(this,arguments),al[D]&&this.updateAttach()},updateLayoutAttaches:function(){if(!Qk&&this.s("vector.layoutable")){var U,A,Y=this;return U=Of(Y.getImage()),U&&U.layoutAttach&&(A=U.layoutAttach,A&&A(Y))?!0:void 0}},updateAttach:function(G){var i=this;return Qk?(i.updateLayoutParameters(),void 0):(i._51I||(i._51I=1,i._71O(G),delete i._51I),void 0)},_71O:function(q){var w,P,m,a,C,R,M=this,s=M._host,O=q?q.property:$,T=q?q.oldValue:$,N=q?q.newValue:$;if(s instanceof Qh&&(!q||Qb[O])){var D;if(D=Of(s.getImage()),D&&D.layoutAttach)return}if(s instanceof A.Grid){if(O===Ob)M.setElevation(M._54O+N-T);else if(!q||qd[O]){if(w=M.s("attach.row.index"),P=M.s("attach.column.index"),m=s.getCellRect(w,P),!m)return;a=M.s("attach.row.span"),C=M.s("attach.column.span"),(1!==a||1!==C)&&(m=so(m,s.getCellRect(w+a-1,P+C-1))),Hj(m,M,"attach.padding",1),M.setRect(m)}}else if(s instanceof ck&&(R=M.s("attach.index"))>=0&&(!q||Gq[O])){var H=M.s("attach.thickness"),x=s.getScale(),h=Math.max(x.x,x.y);H>0&&M.setHeight(s.getThickness()*H*h);var E=M.s("attach.offset"),k=s.getPoints(),I=k.size();if(I>R){var B=s.getPointsMatrix2d(),X=k.get(R),Y=I===R+1?k.get(0):k.get(R+1);X=B.apply(X),Y=B.apply(Y);var c=[Y.x-X.x,Y.y-X.y],z=Kj(c);if(z){M.s("attach.offset.relative")&&(E*=z),M.s("attach.offset.opposite")&&(E=z-E);var V={x:X.x+c[0]/z*E,y:X.y+c[1]/z*E},p=M.s("attach.gap");p&&(M.s("attach.gap.relative")&&(p*=s.getThickness()*h),V=_d($,V,Y,p)),M.p(V),M.setRotation(ys(c[1],c[0]))}}}else q&&(O===zk?M.translate(N.x-T.x,N.y-T.y):O===Ob?M.setElevation(M._54O+N-T):Ff[O]?"rotation3d"===O?M.syncRotation3d(s,N,T):M._11Q(s,O,N-T):("anchor"===O||"width"===O||"height"===O||"scale"===O)&&M.layout(s))},_11Q:function(){var T=new A.Math.Euler,t=A.Math.Euler.ReverseOrder,l=new A.Math.Vector2,o=new A.Math.Vector2;return function(L,e,u){var W=this,E=L.p3(),n=L.r3(),k=W.p3(),X=W.r3();if(e===jl&&(e="rotationY",u=-u),(e===jl||"rotationY"===e)&&0===X[0]&&0===X[2]&&0===n[0]&&0===n[2]&&0===k[1]&&0===E[1])return W.setRotation(-X[1]-u),l.set(k[0],k[2]).rotateAround(o.set(E[0],E[2]),-u),W.p(l.x,l.y),void 0;var _=Yl[L.getRotationMode()],v=_[0],g=_[1],F=_[2],z=Wf[v],D=Wf[g],B=Wf[F],G=Kl();e===jl+v?(B(G,n[jk[F]]),D(G,n[jk[g]]),z(G,u),D(G,-n[jk[g]]),B(G,-n[jk[F]])):e===jl+g?(B(G,n[jk[F]]),D(G,u),B(G,-n[jk[F]])):e===jl+F&&B(G,u);var N=Ur(k,E);Vk(N,G),W.p3(E[0]+N[0],E[1]+N[1],E[2]+N[2]);var S=W.getRotationMode();zh(G,W.r3(),S),T.setFromRotationMatrix(G,t(S)),W.r3([T.x,T.y,T.z])}}(),syncRotation3d:function(){var F=new Ab,c=new Mn,Q=new hb;return function(P,i,B){var D=this;if(B[0]!==i[0]||B[1]!==i[1]||B[2]!==i[2]){var z=Mn.ReverseOrder(P.getRotationMode());lj.setFromEuler(c.set(B[0],B[1],B[2],z)),F.setFromEuler(c.set(i[0],i[1],i[2],z)),F.multiply(lj.inverse());var $=P.p3(),N=D.p3();Q.set(N[0]-$[0],N[1]-$[1],N[2]-$[2]).applyQuaternion(F),D.p3($[0]+Q.x,$[1]+Q.y,$[2]+Q.z),D.setQuaternion(D.getQuaternion(lj).premultiply(F))}}}(),isHostOn:function(M){var c=this;if(c._host&&M&&M._69O)for(var S={},T=c._host;T&&T!==c&&!S[T._id];){if(T===M)return!0;S[T._id]=T,T=T._host}return!1},isLoopedHostOn:function(s){return this.isHostOn(s)&&s.isHostOn(this)},getScaledSize:function(){var V=this.getSize(),D=this.getScale();return V.width*=Math.abs(D.x),V.height*=Math.abs(D.y),V},layout:function(E){if(E=E||this.getHost()){var x=this,V=x.s("layout.h")||"center",H=x.s("layout.v")||"center";if("center"!==V||"center"!==H){var j=new A.Math.Vector2,Y=E.getPosition(),o=E.getAnchor(),n=E.getScaledSize();x.getPosition();var T,L,s,Z,u,U=1,v=1;switch(x._layoutUpdating=!0,V){case"left":j.setX(x._layoutHValue-o.x*n.width);break;case"right":j.setX((1-o.x)*n.width-x._layoutHValue);break;case"leftright":T=n.width-x._layoutHValue[2],s=x.getRotation()-E.getRotation(),Z=Math.abs(Math.sin(s)),u=Math.abs(Math.cos(s)),U+=u*T/x._layoutHValue[3],v+=Z*T/x._layoutHValue[4],j.setX(x._layoutHValue[1]+(x._layoutHValue[5]-o.x)*n.width);break;case"center":j.setX((.5-o.x)*n.width-x._layoutHValue);break;case"scale":s=x.getRotation()-E.getRotation(),Z=Math.abs(Math.sin(s)),u=Math.abs(Math.cos(s)),j.setX((.5-o.x)*n.width-x._layoutHValue[1]*n.width/x._layoutHValue[0]),L=n.width/x._layoutHValue[2]-1,U+=u*L,v+=Z*L}switch(H){case"top":j.setY(x._layoutVValue-o.y*n.height);break;case"bottom":j.setY((1-o.y)*n.height-x._layoutVValue);break;case"topbottom":s||(s=x.getRotation()-E.getRotation(),Z=Math.abs(Math.sin(s)),u=Math.abs(Math.cos(s))),T=n.height-x._layoutVValue[2],U+=Z*T/x._layoutVValue[3],v+=u*T/x._layoutVValue[4],j.setY(x._layoutVValue[1]+(x._layoutVValue[5]-o.y)*n.height);break;case"center":j.setY((.5-o.y)*n.height-x._layoutVValue);break;case"scale":s||(s=x.getRotation()-E.getRotation(),Z=Math.abs(Math.sin(s)),u=Math.abs(Math.cos(s))),j.setY((.5-o.y)*n.height-x._layoutVValue[1]*n.height/x._layoutVValue[0]),L=n.height/x._layoutVValue[2]-1,U+=Z*L,v+=u*L}if("leftright"===V||"scale"===V||"topbottom"===H||"scale"===H){var K=this.getScale(),D=Math.abs(K.x),h=Math.abs(K.y);"leftright"===V||"scale"===V?x.setSize(x._layoutHValue[3]*U/D,x._layoutHValue[4]*v/h):x.setSize(x._layoutVValue[3]*U/D,x._layoutVValue[4]*v/h)}j.rotateAround(null,E.getRotation()),this.setPosition(j.x+Y.x,j.y+Y.y),x._layoutUpdating=r}}},updateLayoutParameters:function(l,M){if(l=l||this.getHost()){var V=this,G=V.s("layout.h"),B=V.s("layout.v");if(G||B){var E,N,H,k,T,t,R=new A.Math.Vector2,z=l.getPosition(),r=l.getAnchor(),n=l.getScaledSize(),J=V.getPosition(),i=V.getScaledSize();switch(R.set(J.x-z.x,J.y-z.y),R.rotateAround(null,-l.getRotation()),G){case"left":V._layoutHValue=R.x+r.x*n.width;break;case"right":V._layoutHValue=-R.x+(1-r.x)*n.width;break;case"center":V._layoutHValue=-R.x+(.5-r.x)*n.width;break;case"leftright":case"scale":"scale"===G?E=-R.x+(.5-r.x)*n.width:(N=V.getAnchor(),H=V.getRotation()-l.getRotation(),k=Math.cos(H),T=Math.sin(H),t=-Math.min(-N.x*k+N.y*T,-N.x*k-(1-N.y)*T,(1-N.x)*k+N.y*T,(1-N.x)*k-(1-N.y)*T),E=R.x-(t-r.x)*n.width),"position"===M&&"object"==typeof V._layoutHValue?(V._layoutHValue[0]=n.width,V._layoutHValue[1]=E):V._layoutHValue=[n.width,E,n.width,i.width,i.height,t]}switch(B){case"top":V._layoutVValue=R.y+r.y*n.height;break;case"bottom":V._layoutVValue=-R.y+(1-r.y)*n.height;break;case"center":V._layoutVValue=-R.y+(.5-r.y)*n.height;break;case"topbottom":case"scale":"scale"===B?E=-R.y+(.5-r.y)*n.height:(H||(N=V.getAnchor(),H=V.getRotation()-l.getRotation(),k=Math.cos(H),T=Math.sin(H)),t=-Math.min(-N.x*T-N.y*k,-N.x*T+(1-N.y)*k,(1-N.x)*T-N.y*k,(1-N.x)*T+(1-N.y)*k),E=R.y-(t-r.y)*n.height),"position"===M&&"object"==typeof V._layoutVValue?(V._layoutVValue[0]=n.height,V._layoutVValue[1]=E):V._layoutVValue=[n.height,E,n.height,i.width,i.height,t]}}}},getSerializableProperties:function(){var C=Qh.superClass.getSerializableProperties.call(this);return hf(C,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),C}});var lr=A.Edge=function(D,b){var q=this;ud(lr,q),q.setSource(D),q.setTarget(b)};Mf("Edge",$h,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return Sb},_22Q:function(){return lt},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(r){if(r===this)return!1;if(Dk(r))return!0;for(var E,u,$,h,o,D=[this],P=-1,n=0;n>P;)if(P++,E=D[P],u=E._44I)for(u=u.getArray(),h=0,o=u.length;o>h;h++)if($=u[h],Sl($)&&!(D.indexOf($)>=0)){if($===r)return!1;D.push($),n++}return!0},setSource:function(Q){var h=this;if(h._source!==Q&&h.canSetSourceTarget(Q)){var o=h._source;h._source=Q,o&&o._16I(h),Q&&Q._2I(h),h._7I(),h.fp("source",o,Q)}},setTarget:function(A){var K=this;if(K._target!==A&&K.canSetSourceTarget(A)){var h=K._target;K._target=A,h&&h._18I(K),A&&A._4I(K),K._7I(),K.fp("target",h,A)}},isLooped:function(){var I=this;return I._source===I._target&&Dk(I._source)&&Dk(I._target)},onPropertyChanged:function(P){var j=this;j._49I&&j._49I.each(function(q){q.fp("agentChange",!0,!1)}),("s:alwaysOnTop"===P.property||"s:shape3d.alwaysOnTop"===P.property)&&(P.newValue?this.setRenderLayer("top"):this.setRenderLayer(r))},_7I:function(){var n,U=this,V=lq(U);U._40I!==V&&(n=this._40I,n&&n._15I(U),U._40I=V,V&&V._1I(U),U.fp("sourceAgent",n,V),Yp(n,U._41I),Yp(V,U._41I));var Q=Gd(U);U._41I!==Q&&(n=U._41I,n&&n._17I(U),U._41I=Q,Q&&Q._3I(U),U.fp("targetAgent",n,Q),Yp(n,U._40I),Yp(Q,U._40I))},_22I:function(M){this._52I=M,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var K=this;return K._52I&&K._52I.get(0)!==K&&!K.getStyle(Rb)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var S=this,x=S._52I;return x&&!S.getStyle(Rb)&&x.size()>1&&S===x.get(0)},toggle:function(){this.beginTransaction();var V=this._52I,U=!this.s(Rb);V&&V.size()>1&&(V.each(function(P){P.s(Rb,U)}),V.getSiblings().each(function(D){D!==V&&D.each(function(a){a.fp("edgeGroup",$,D)})})),this.endTransaction()},setStyle:function(I,L){(I===sp||"edge.segments"===I)&&(L=io(L)),lr.superClass.setStyle.call(this,I,L)},onStyleChanged:function(m){lr.superClass.onStyleChanged.apply(this,arguments),Il[m]&&Yp(this._41I,this._40I)},getSerializableProperties:function(){var Q=lr.superClass.getSerializableProperties.call(this);return hf(Q,{source:1,target:1}),Q}});var pc=A.Group=function(){ud(pc,this)};Mf("Group",Qh,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Nd},onChildAdded:function(){pc.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){pc.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var f=this;if(!f._54I&&!Qk){var q=f.getChildrenRect();q&&(f._53I=1,f.p(wi(f.s("group.position"),q,f.getSize())),delete f._53I)}},getChildrenRect:function(){var H,L=this;return L.eachChild(function(Y){Dk(Y)&&(H=so(H,L.getChildRect(Y)))}),H},getChildRect:function(R){var u;return Dk(R)&&R.s(cg)&&(db(R)&&R.isExpanded()&&R.eachChild(function(C){u=so(u,R.getChildRect(C))}),!u&&R.getRect&&(u=R.getRect())),u},setPosition:function(I,h){var G=this;if(!G._54I){var t;t=2===arguments.length?{x:I,y:h}:I,Qk||G._53I||(G._54I=1,xq(G._children,t.x-G._position.x,t.y-G._position.y),delete G._54I),pc.superClass.setPosition.call(this,t)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(s){var R=this;if(R._57O!==s){var x=R._57O;R._57O=s,R.fp("expanded",x,R._57O),R._fireInvalidateDeep(),R._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(c){db(c)?c._fireInvalidateDeep():c.iv()})},_8I:function(){pc.superClass._8I.call(this),this.eachChild(function(v){Dk(v)&&v._8I()})},onStyleChanged:function(J){pc.superClass.onStyleChanged.apply(this,arguments),"group.position"===J&&this._81I()},getSerializableProperties:function(){var E=pc.superClass.getSerializableProperties.call(this);return E.expanded=1,E}});var Sj=A.Camera=function(){ud(Sj,this),this.s({"shadow.cast":!1,"shadow.receive":!1,shape3d:"billboard"}),this._viewMatrix=new ke.Matrix4,this._projectMatrix=new ke.Matrix4,this.setScale3d(1,1,-1),this.setCullingMask("main,top"),this._projectMatrixDirty=!0};Sj.CubeDirectionParam=[1,0,0,0,-1,0,-1,0,0,0,-1,0,0,1,0,0,0,1,0,-1,0,0,0,-1,0,0,1,0,-1,0,0,0,-1,0,-1,0],Mf("Camera",Qh,{_22Q:function(){return Camera3dUI},attachRenderTarget:function(z){this._projectMatrixDirty=!0,this.renderTarget=z},detachRenderTarget:function(){this._projectMatrixDirty=!0,this.renderTarget=null},setCullingMask:function(i){var k=i.split(",");this._cullingMask=ts(k)},isLayerVisible:function(B){var A=mg[B];return A&&Ml(this._cullingMask,A.mask)},isOrtho:function(){return"ortho"===this.s("camera.type")&&!this.isCube()},isCube:function(){return this.renderTarget&&this.renderTarget.isCube()},isPerspective:function(){return!this.isOrtho()},setViewMatrix:function(){var Q=new A.Math.Matrix4,n=new A.Math.Euler;return function(V){var P=this;V.isMatrix4?P._viewMatrix.copy(V):P._viewMatrix.fromArray(V),Q.getInverse(P._viewMatrix),P.p3(Q.getPosition().toArray()),n.set(0,0,0,P.getRotationMode(),!0).setFromRotationMatrix(Q),P.r3([n.x,n.y,n.z])}}(),getViewMatrix:function(N){var n=this,J=Nm(null,null,n.r3(),n.getRotationMode(),n.p3()),I=n._viewMatrix;return I.fromArray(J).getInverse(I),I.toArray(N)},setProjectMatrix:function(x){var _=this;x.isMatrix4?_._projectMatrix.copy(x):_._projectMatrix.fromArray(x),x=_._projectMatrix.getElements(),_.isOrtho()?_.s({"camera.near":(x[14]+1)/x[10],"camera.far":(x[14]-1)/x[10],"camera.ortho.width":2/x[0]}):_.s({"camera.near":x[14]/(x[10]-1),"camera.far":x[14]/(x[10]+1),"camera.fovy":2*Math.atan(1/x[5]),"camera.aspect":x[5]/x[0]}),_._projectMatrixDirty=!1},onPropertyChanged:function(V){var r=this;Sj.superClass.onPropertyChanged.call(r,V);var z=V.property;("s:camera.near"===z||"s:camera.far"===z||"s:camera.fovy"===z||"s:camera.aspect"===z||"s:camera.ortho.width"===z)&&(r._projectMatrixDirty=!0)},getProjectMatrix:function(){var D=this;if(D._projectMatrixDirty){var X=D.gv,G=D.isCube(),H=G?1:D.s("camera.aspect")||(X?X.getAspect():null)||u.graph3dViewAspect,V=D.s("camera.near")||(X?X.getNear():null)||u.graph3dViewNear,b=D.s("camera.far")||(X?X.getFar():null)||u.graph3dViewFar,c=Kl();if(D.isOrtho()){var e=D.s("camera.ortho.width")||(X?X.getOrthoWidth():null)||u.graph3dViewOrthoWidth,s=e/2,R=s/H;mb(c,-s,s,-R,R,V,b)}else{var y=G?Math.PI/2:D.s("camera.fovy")||(X?X.getFovy():null)||u.graph3dViewFovy;aq(c,y,H,V,b)}D._projectMatrix.fromArray(c),D._projectMatrixDirty=!1}return D._projectMatrix.toArray()},lookAt:function(K,z){var A=this.p3();return K.x?this.lookAtDirection([K.x-A[0],K.y-A[1],K.z-A[2]],z):this.lookAtDirection([K[0]-A[0],K[1]-A[1],K[2]-A[2]],z)},lookAtDirection:function(){var P=new A.Math.Matrix4,x=new A.Math.Euler,s=new A.Math.Vector3,O=new A.Math.Vector3;return function(z,Y){P.lookAtDirection(s.copy(z).multiplyScalar(-1),Y?O.copy(Y):O.set(0,1,0)),x.set(0,0,0,this.getRotationMode(),!0).setFromRotationMatrix(P),this.r3([x.x,x.y,x.z])}}(),updateAndRender:function(n){return n.syncRenderState(),n.updateScene(),this.render(n)},render:function(b){var D=this,r=b.getGL();if(!r)return!1;var P,n,a=D.renderTarget;if(a)P=a.width,n=a.height;else{var j=b.getDevicePixelRatio();P=b.getWidth()*j,n=b.getHeight()*j}D.gv=b,b._camera=D;var m=b._frameState.renderState.glState,i=m.color.clear.slice(0);gp(r,D.s("camera.background"));var e=b.getEye;if(b.getEye=function(){return D.p3()},D.isCube())for(var G=Sj.CubeDirectionParam,U=0;6>U;U++)a&&a.bind(r,U),D.lookAtDirection([G[6*U+0],G[6*U+1],G[6*U+2]],[G[6*U+3],G[6*U+4],G[6*U+5]]),D.s("camera.clear")!==!1&&r.clear(r.COLOR_BUFFER_BIT),b.setViewport(r,0,0,P,n),D.s("camera.onlySky")?b.renderSky():b.renderScene({renderAxis:D.s("camera.renderAxis"),renderGrid:D.s("camera.renderGrid"),renderEdit:D.s("camera.renderEdit"),renderReflector:!1}),a&&a.unbind(r);else a&&a.bind(r),D.s("camera.clear")!==!1&&r.clear(r.COLOR_BUFFER_BIT),b.overlappingBox.clear(),b.setViewport(r,0,0,P,n),D.s("camera.onlySky")?b.renderSky():b.renderScene({renderAxis:D.s("camera.renderAxis"),renderGrid:D.s("camera.renderGrid"),renderEdit:D.s("camera.renderEdit")}),a&&a.unbind(r);return b.getEye=e,gp(r,i),b._camera=null,D.gv=null,!0}});var el=A.Block=function(){ud(el,this),this.s({"shadow.cast":!1,"shadow.receive":!1})};Mf("Block",Qh,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return jg},_22Q:function(){return kt},onChildAdded:function(){el.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){el.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:function(){function B(q,T,Q){M.fromArray(Zi(T));var Z=T.getAnchor3d();q.push((new hb).set(0-Z.x,0-Z.y,0-Z.z).applyMatrix4(M).applyMatrix4(Q)),q.push((new hb).set(0-Z.x,0-Z.y,1-Z.z).applyMatrix4(M).applyMatrix4(Q)),q.push((new hb).set(0-Z.x,1-Z.y,0-Z.z).applyMatrix4(M).applyMatrix4(Q)),q.push((new hb).set(0-Z.x,1-Z.y,1-Z.z).applyMatrix4(M).applyMatrix4(Q)),q.push((new hb).set(1-Z.x,0-Z.y,0-Z.z).applyMatrix4(M).applyMatrix4(Q)),q.push((new hb).set(1-Z.x,0-Z.y,1-Z.z).applyMatrix4(M).applyMatrix4(Q)),q.push((new hb).set(1-Z.x,1-Z.y,0-Z.z).applyMatrix4(M).applyMatrix4(Q)),q.push((new hb).set(1-Z.x,1-Z.y,1-Z.z).applyMatrix4(M).applyMatrix4(Q))
}function c(i,y){var q=(new Sn).makeRotationFromEuler(this.getEuler()).setPosition((new hb).fromArray(this.p3()));q.getInverse(q),i.forEach(function(Y){Dk(Y)&&B(y,Y,q)})}var M=new Sn;return function(K,J){if(K instanceof Qh&&(K=[K]),!K||0===K.length)return $;var J=[];c.call(this,K,J);var e=[1/0,1/0,1/0],Z=[-1/0,-1/0,-1/0];return J.forEach(function(b){e[0]=Math.min(b.x,e[0]),e[1]=Math.min(b.y,e[1]),e[2]=Math.min(b.z,e[2]),Z[0]=Math.max(b.x,Z[0]),Z[1]=Math.max(b.y,Z[1]),Z[2]=Math.max(b.z,Z[2])}),{min:e,max:Z}}}(),updateFromChildren:function(){var f=this;if(!Qk&&!f._updatingToChildren&&f._syncSize&&0!==f.size()&&!f._freezeSyncFromChildren){var D=this._getBoundingBox(f.toChildren(Dk));if(D){f._updatingFromChildren=1;var t=(new hb).fromArray(this.getScale3d()),P=(new hb).fromArray(D.min),W=(new hb).fromArray(D.max),X=u.blockMinSize,d=new hb,o=W.clone().sub(P);0===o.x&&d.setX(.5),0===o.y&&d.setY(.5),0===o.z&&d.setZ(.5);var J=this._width==$||-1===this._width,r=new hb(this.getAnchor3d()),U=t.clone().multiply((new hb).fromArray(this.s3())),L=o.clone();0===L.x&&L.setX(X),0===L.y&&L.setY(X),0===L.z&&L.setZ(X);var S=r.clone().multiply(U),T=S.clone().multiplyScalar(-1).sub(P).divide(L).add(S.divide(L)).add(d),I=this.s("keepPosition");if(J||this._anchorChanged||this._scaleChanged||!I){!J&&I&&(r=T);var b=r.clone().multiply(o).add(P).applyEuler(this.getEuler()).add((new hb).fromArray(this.p3()));this.p3([b.x,b.y,b.z])}else this.setAnchor3d(T.x,T.y,T.z);var m=new hb(1,1,1).divide(t).multiply(o);this.s3(Math.abs(m.x),Math.abs(m.y),Math.abs(m.z)),delete f._updatingFromChildren}}},setPosition:function(q,I){var D=this;if(!D._updatingToChildren){var R;R=2===arguments.length?{x:q,y:I}:q,Qk||D._updatingFromChildren||(D._updatingToChildren=1,xq(D._children,R.x-D._position.x,R.y-D._position.y),delete D._updatingToChildren),el.superClass.setPosition.call(this,R)}},setSize3d:function(){this.beginTransaction(),el.superClass.setSize3d.apply(this,arguments),this.endTransaction()},setTall:function(G){var l=this;if(!l._updatingToChildren){this.beginTransaction(),G=E(G,u.blockMinSize);var i=l.getTall();if(G!==i&&el.superClass.setTall.call(l,G),!Qk&&!l._updatingFromChildren){l._updatingToChildren=1;var M=G/i;l._adjustChildTallOrScale(M,"size"),delete l._updatingToChildren,l.updateFromChildren()}this.endTransaction()}},setWidth:function(R){return this.setSize(R,this.getHeight())},setHeight:function(z){return this.setSize(this.getWidth(),z)},setSize:function(G,d){var m=u.blockMinSize;G=E(G,m),d=E(d,m);var D=this;if(!D._updatingToChildren){2!==arguments.length&&(d=G.height,G=G.width),this.beginTransaction();var X=D.getWidth(),i=D.getHeight();if(G!==X&&el.superClass.setWidth.call(D,G),d!==i&&el.superClass.setHeight.call(D,d),!Qk&&!D._updatingFromChildren){D._updatingToChildren=1;var T=G/X,R=d/i;D._adjustChildScaleOrSize(T,R,"size"),delete D._updatingToChildren,D.updateFromChildren()}this.endTransaction()}},_adjustChildScaleOrSize:function(k,v,L){var N=this;if(N._syncSize){var y=N.getPosition(),V=N.getRotation();N.eachChild(function(J){if(Dk(J)){var I=J.getPosition(),r=J.getRotation(),Q=J.getWidth(),O=J.getHeight(),q=J.getScale(),G=q.x*Q,U=q.y*O;if(0!==G&&0!==U){0>k*v&&J.setRotation(-1*r);var u=new nb(r,I.x,I.y,G,U);u.translate(-y.x,-y.y),u.rotate(-V),r=ys(u.b*Math.sign(G),u.a*Math.sign(G)),u.scale(k,v);var h,K,p,g=m(r);if(Math.abs(g)<.001?(h=X(r),K=u.b/h,p=-u.c/h):(K=u.a/g,p=u.d/g),"scale"===L)J.setScale(K/Q,p/O);else if("size"===L){var w=K/q.x,b=p/q.y;J.setScale(Hm(K)*Math.abs(q.x),Hm(p)*Math.abs(q.y)),J instanceof A.Shape?(J.setWidthForce(Math.max(Math.abs(w),1e-5)),J.setHeightForce(Math.max(Math.abs(b),1e-5))):J.setSize(Math.max(.01,Math.abs(w)),Math.max(.01,Math.abs(b)))}u.rotate(V),u.translate(y.x,y.y),J.setPosition(u.tx,u.ty)}}})}},_calcChangeFactor:function(V,B,A,G){var Q,x,R,M;return Q=k(V),x=k(A),R=Q>x?Q/x:x/Q,Q=k(B),x=k(G),M=Q>x?Q/x:x/Q,E(R,M)},setElevation:function(c){var v=this;if(!v._updatingToChildren){var R=v.getElevation(),$=c-R;0!==$&&(Qk||v._updatingFromChildren||(v._updatingToChildren=1,xq(v._children,0,$,0),delete v._updatingToChildren),el.superClass.setElevation.apply(v,arguments))}},setScaleTall:function(U){var v=this;if(!v._updatingToChildren){var G=v.getScaleTall();if(k(U)<.01&&(U=.01*(Hm(U)||Hm(G))),el.superClass.setScaleTall.call(v,U),!Qk&&!v._updatingFromChildren){v._updatingToChildren=1;var e=U/G;v._adjustChildTallOrScale(e,"scale"),delete v._updatingToChildren,v._scaleChanged=1,this.updateFromChildren(),delete v._scaleChanged}}},_adjustChildTallOrScale:function(j,A){var F=this;if(F._syncSize){var Y=F.getElevation();F.eachChild(function(R){if(Dk(R)){if("size"===A){var n=R.getTall();0>j&&R.setScaleTall(-1*R.getScaleTall()),R.setTall(Math.max(.01,Math.abs(n*j)))}else{var k=R.getScaleTall();R.setScaleTall(k*j)}R.setElevation(Y+(R.getElevation()-Y)*j)}})}},setAnchor3d:function(){if(!this._updatingToChildren){this.beginTransaction();var m=el.superClass.setAnchor3d.apply(this,arguments);return m&&!Qk&&!this._updatingFromChildren&&this._syncSize&&(this._anchorChanged=1,this.updateFromChildren(),delete this._anchorChanged),this.endTransaction(),m}},setAnchor:function(){var P=this;if(!P._updatingToChildren){var N=P.getAnchor(),s=el.superClass.setAnchor.apply(P,arguments);if(Qk||P._updatingFromChildren||!P._syncSize)return s;P._updatingToChildren=1;var G=P.getAnchor(),S=P.getSize(),u=S.width*(N.x-G.x),z=S.height*(N.y-G.y),d=(new Sn).compose(new hb,this.getQuaternion(),new hb(this.getScale3d())),C=new hb(u,0,z).applyMatrix4(d);return P.eachChild(function(p){if(Dk(p)){var L=new hb(p.p3());p.p3(L.add(C).toArray())}}),delete P._updatingToChildren,s}},setAnchorElevation:function(){var O=this;if(!O._updatingToChildren){var x=O.getAnchorElevation(),U=el.superClass.setAnchorElevation.apply(O,arguments);if(Qk||O._updatingFromChildren||!O._syncSize)return U;O._updatingToChildren=1;var i=O.getAnchorElevation(),k=O.getTall()*(x-i),X=(new Sn).compose(new hb,this.getQuaternion(),new hb(this.getScale3d())),w=new hb(0,k,0).applyMatrix4(X);return O.eachChild(function(X){if(Dk(X)){var m=new hb(X.p3());X.p3(m.add(w).toArray())}}),delete O._updatingToChildren,U}},setRotation:function(o){this._updateChildrenRotation3d("rotation",o)},setRotationX:function(W){this._updateChildrenRotation3d("rotationX",W)},setRotationZ:function(f){this._updateChildrenRotation3d("rotationZ",f)},setRotation3d:function(){var d=this;if(!d._updatingToChildren){var y=d.r3();el.superClass.setRotation3d.apply(d,arguments);var p=d.r3();Qk||d._updatingFromChildren||(d._updatingToChildren=1,d.eachChild(function(i){Dk(i)&&i.syncRotation3d(d,p,y)}),delete d._updatingToChildren)}},_updateChildrenRotation3d:function(S,j){var n=this;if(!n._updatingToChildren){var C=n[ch(S)]();el.superClass[Uo(S)].call(n,j),Qk||n._updatingFromChildren||this._updateRotationToChildren(S,j-C)}},_updateRotationToChildren:function(C,b){var j=this;j._updatingToChildren=1,j.eachChild(function(v){Dk(v)&&v._11Q(j,C,b)}),delete j._updatingToChildren},setScale:function(K,o){var F=this;if(!F._updatingToChildren){null==o&&(o=K.y,K=K.x);var e=F.getScale();if(k(K)<.01&&(K=.01*(Hm(K)||Hm(e.x))),k(o)<.01&&(o=.01*(Hm(o)||Hm(e.y))),el.superClass.setScale.call(F,K,o),!Qk&&!F._updatingFromChildren){F._updatingToChildren=1;var T=K/e.x,l=o/e.y;F._adjustChildScaleOrSize(T,l,"scale"),delete F._updatingToChildren,F._scaleChanged=1,F.updateFromChildren(),delete F._scaleChanged}}},onPropertyChanged:function(N){el.superClass.onPropertyChanged.call(this,N),"s:3d.visible"===N.property&&this._invalidateChildrenBatch()},_invalidateChildrenBatch:function(){this.eachChild(function(k){(k.s("batch")||k.s("wf.geometry")||k.s("wf.visible"))&&k.iv(),k instanceof el&&k._invalidateChildrenBatch()})},getSerializableProperties:function(){var B=el.superClass.getSerializableProperties.call(this);return B.clickThroughEnabled=1,B.syncSize=1,B}});var Jo=A.Grid=function(){ud(A.Grid,this)};Mf("Grid",Qh,{IRotatable:!1,_icon:"grid_icon",_image:$,getUIClass:function(){return cb},setRotation:function(){},getCellRect:function(I,L){var K=this,p=K.s("grid.row.count"),H=K.s("grid.column.count");if(0>=p||0>=H||0>I||I>=p||0>L||L>=H)return $;var R,W,B,O=K.getRect(),e=K.s("grid.row.percents"),E=K.s("grid.column.percents");if(Hj(O,K,"grid.border",-1),e&&e._as&&(e=e._as),E&&E._as&&(E=E._as),e&&e.length===p){for(B=0,R=0;I>R;R++)B+=O.height*e[R];O.y+=B,O.height=O.height*e[I]}else O.height=O.height/p,O.y+=O.height*I;if(E&&E.length===H){for(W=0,R=0;L>R;R++)W+=O.width*E[R];O.x+=W,O.width=O.width*E[L]}else O.width=O.width/H,O.x+=O.width*L;return nh(O,-K.s("grid.gap")),O}});var Df=A.Text=function(){ud(Df,this),this.setSize(100,50),this.s("text","TEXT")};Mf("Text",Qh,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return af},setWidth:function(p){p||(p=.001),Df.superClass.setWidth.call(this,p)},setHeight:function(N){N||(N=.001),Df.superClass.setHeight.call(this,N)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),Yg("__text__",{width:{value:100,isSafeFunc:!0,func:function(I){return I?I._width:100}},height:{value:50,isSafeFunc:!0,func:function(T){return T?T._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"},gradient:{func:"style@text.gradient"},gradientColor:{func:"style@text.gradient.color"},gradientPack:{func:"style@text.gradient.pack"},decoration:{func:"style@text.decoration"},vertical:{func:"style@text.vertical"},verticalGap:{func:"style@text.vertical.gap"},wrap:{func:"style@text.wrap"},letterGap:{func:"style@text.letter.gap"},borderWidth:{func:"style@text.border.width"},borderColor:{func:"style@text.border.color"}}]});var ck=A.Shape=function(){ud(ck,this),this._59O=new Od};ck.__de__=yn,Mf("Shape",Qh,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Bo},_22Q:function(){return mt},getLength:function(H){return Ud(Mp(this._59O,this._58O,H,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var v=this._58O;return v?new Od(v._as.slice(0)):v},setSegments:function(h){var x=this._58O;h=h?Zf(h)?new Od(h.slice(0)):new Od(h._as.slice(0)):null,(x&&h&&x._as.join(",")!==h._as.join(",")||x!==h)&&(this._58O=h,this.fp("segments",x,h))},getPoints:function(){return this._59O},toPoints:function(){var C=this._59O;return new Od(C._as.slice(0))},getPointsMatrix2d:function(){var W=this,j=new ke.Matrix2d,Z=W.getPosition(),k=W.getScale(),X=W.getRotation();return j.translate(-Z.x,-Z.y).scale(k.x,k.y).rotate(X).translate(Z.x,Z.y),j},getPointsMatrix3d:function(){return function(){var U=this,V=new ke.Matrix4,W=V.getElements(),B=U.p3();Ph(W,B),zh(W,U.getFinalRotation3d(),U.getRotationMode());var G=U.getScale3d(),n=U._dynamicScale3d;return n&&(G[0]*=n[0],G[1]*=n[1],G[2]*=n[2]),bp(W,G),Ph(W,Ig(B)),V}}(),setPoints:function(O,P){var V=this,i=V._59O;O=O?Zf(O)?new Od(O.slice(0)):new Od(O._as.slice(0)):new Od;var h,F,N,x,K,n;P&&(h=V.getPosition(),n=new nb(V.getRotation(),0,0,V.getScale().x,V.getScale().y)),(i&&O&&i._as.join(",")!==O._as.join(",")||i!==O)&&(V._59O=O,V.fs(),V.fp("points",i,O)),P&&(F=V.getPosition(),N=F.x-h.x,x=F.y-h.y,K=n.tf(N,x),V.setPosition(F.x-N+K.x,F.y-x+K.y))},setPoints3d:function(o,$){var G=new hb(this.p3()),K=this.getPointsMatrix3d();if(K.setPosition(new hb),lf.superClass.setPoints.call(this,o),$){var e=new hb(this.p3()),p=e.clone().sub(G).applyMatrix4(K);G.add(p),this.p3(G.x,G.y,G.z)}},addPoint:function(I,u,o){var b=this.toPoints();b.add(I,u),this.setPoints(b,o)},setPoint:function(u,T,F){var t=this.toPoints();t.set(u,T),this.setPoints(t,F)},removePointAt:function(n){var f=this.toPoints();f.removeAt(n),this.setPoints(f)},setWidthForce:function(t){var I=this;if(!I._55I&&!Qk&&I.getWidth()){I._55I=1;var r=I._position.x,O=t/I.getWidth(),k=I.toPoints(),C=new Od;1!==O&&(k.each(function(u){C.add({x:(u.x-r)*O+r,y:u.y,e:u.e})}),I.setPoints(C),Fg(I,[O,0,0,1,r*(1-O),0]),I.fs()),delete I._55I}ck.superClass.setWidth.call(I,t)},setWidth:function($){return this.setWidthForce(Vh>$?Vh:$)},setHeightForce:function(j){var y=this;if(!y._55I&&!Qk&&y.getHeight()){y._55I=1;var P=y._position.y,F=j/y.getHeight(),h=y.toPoints(),S=new Od;1!==F&&(h.each(function(X){S.add({x:X.x,y:(X.y-P)*F+P,e:X.e})}),y.setPoints(S),Fg(y,[1,0,0,F,0,P*(1-F)]),y.fs()),delete y._55I}ck.superClass.setHeight.call(y,j)},setHeight:function(_){return this.setHeightForce(Vh>_?Vh:_)},setAnchorElevation:function(F){var o=this;o._55I=!0;var c=o._updatingAnchor3d,k=!Qk&&!c;if(k){var Y,J=F,v=o.getAnchorElevation(),r=o.getTall();Y=r*(v-J),0!==Y&&o.shiftPointsElevation(Y)}var f=ck.superClass.setAnchorElevation.apply(o,arguments);return c||delete o._55I,f},getShapeElevation:function(){var C=this,N=C._54O;return N-(C.getTall()||0)*(C._anchorElevation-.5)},setAnchor3d:function(n,U,l,N){var F,g=this;if("number"==typeof n?F={x:n,y:U,z:l}:(F=n.length?{x:n[0],y:n[1],z:n[2]}:n,N=U),g._55I=!0,g._updatingAnchor3d=!0,g.beginTransaction(),!Qk){var V=g.getAnchor3d(),u=g.getSize(),J=g.getTall(),d=u.width*(V.x-F.x),x=u.height*(V.z-F.z),H=J*(V.y-F.y);N||g.shiftPoints(d,x,H);var t=g.p3()}var k=ck.superClass.setAnchor3d.apply(g,arguments);if(!Qk&&N){var R=g.p3();g.shiftPoints(R[0]-t[0]+d,R[2]-t[2]+x,R[1]-t[1]+H)}return g.endTransaction(),delete g._updatingAnchor3d,delete g._55I,k},setAnchor:function(a,z,H){var D=this;D._55I=!0;var O=D._updatingAnchor3d,e=!Qk&&!O;if(e){var Y,o,T;"number"==typeof a?T={x:a,y:z}:(T=a.length?{x:a[0],y:a[1]}:a,H=z);var N=D.getAnchor(),F=D.getSize();Y=F.width*(N.x-T.x),o=F.height*(N.y-T.y),H||D.shiftPoints(Y,o);var q=D.getPosition()}var m=ck.superClass.setAnchor.apply(D,arguments);if(e){var Z=D.getPosition();H&&D.shiftPoints(Z.x-q.x+Y,Z.y-q.y+o)}return O||delete D._55I,m},shiftPoints:function(J,t,q){if(J||t||q){var a=this,Q=a.getElevation()||0,e=a.toPoints(),R=new Od;e.each(function(Z){var W=Z.e;q&&(W=(W==$?Q:W)+q),R.add({x:Z.x+J,y:Z.y+t,e:W})}),a.setPoints(R),a.fs()}},shiftPointsElevation:function(u){return this.shiftPoints(0,0,u)},setPosition:function(_,w){var k,e=this;if(!e._28Q){if(e._28Q=1,!e._55I&&!Qk){k=2===arguments.length?{x:_,y:w}:_;var J=k.x-e._position.x,O=k.y-e._position.y;if(0===J&&0===O)return delete e._28Q,void 0;e._55I=1,e.shiftPoints(J,O),Fg(e,[1,0,0,1,J,O]),delete e._55I}ck.superClass.setPosition.apply(e,arguments),delete e._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var t=this;if(2!==t._59O.size())return!1;var y=t._58O;return y?2===y.size()&&1===y.get(0)&&2===y.get(1)?!0:!1:!0},fireShapeChange:function(){var Y=this;if(!Y._55I&&!Qk){var h=Tg(Y._59O);h&&(Y._55I=1,Y.setRect(h),delete Y._55I)}Y.fp(Rr,!1,!0)},getSerializableProperties:function(){var R=ck.superClass.getSerializableProperties.call(this);return R.segments=1,R.points=1,R.thickness=1,R.closePath=1,R}});var Hg=A.Points=function(){ud(Hg,this)};Mf("Points",Qh,{_59O:[],_colors:[],_sizes:[],_uvoffsets:[],_22Q:function(){return nt},getPoints:function(){return this._59O},setPoints:function(B){var F=this._59O;B=B?B.slice(0):[];var Q=B[0];if(fl(Q)){var c=B;B=[];for(var o=0,e=c.length;e>o;o+=3)B.push({x:c[o],e:c[o+1],y:c[o+2]})}this._59O=B,this._pointsDirty=!0,this.fp("points",F,this._59O)},setPoint:function(u,C){var A=this._59O.slice(0);A[u]=C,this.setPoints(A)},addPoint:function(q){this.setPoint(this._59O.length,q)},getColors:function(){return this._colors},setColors:function(L){var V=this._colors;L=L?L.slice(0):[],this._colors=L,this._colorsDirty=!0,this.fp("colors",V,L)},setPointColor:function(s,V){var o=this._colors.slice(0);o[s]=V,this.setColors(o)},getSizes:function(){return this._sizes},setSizes:function(E){var g=this._sizes;E=E?E.slice(0):[],this._sizes=E,this._sizesDirty=!0,this.fp("sizes",g,this._sizes)},setPointSize:function(E,n){var j=this._sizes.slice(0);j[E]=n,this.setSizes(j)},getUvoffsets:function(){return this._uvoffsets},setUvoffsets:function(h){var W=this._uvoffsets;h=h?h.slice(0):[],this._uvoffsets=h,this._offsetsDirty=!0,this.fp("uvoffsets",W,this._uvoffsets)},setPointUvoffset:function(p,z,E){var d;"object"==typeof z?(d=z[0],E=z[1]):d=z;var m=this._uvoffsets.slice(0);m[2*p+0]=d,m[2*p+1]=E,this.setUvoffsets(m)},getPointInfo:function(j){var l=this.getPoints();if(!l||l[j]==$)return $;var m=l[j],R=[m.x,m.e,m.y],E=this.mat||Zi(this),h=[R[0],R[1],R[2]];Vk(h,E);var p=this.getColors(),J=p[j]||this.s("points.color"),B=this.getSizes(),X=B[j];return{size:X==$?this.s("points.size"):X,color:J,local:R,world:h}},getSerializableProperties:function(){var i=Hg.superClass.getSerializableProperties.call(this);return i.points=1,i.colors=1,i.sizes=1,i.uvoffsets=1,i},onPropertyChanged:function(Y){Hg.superClass.onPropertyChanged.call(this,Y);var _=Y.property;"s:points.color"===_?this._colorsDirty=!0:"s:points.size"===_?this._sizesDirty=!0:"s:points.model"===_&&(this._modelDirty=!0)},getWidth:function(){var e=this;if(e._width>=0)return e._width;var O=e.getStyle("points.model");if(O){var D=Pf(O);if(D&&D.rawS3)return D.rawS3[0]}return 1},getHeight:function(){var D=this;if(D._height>=0)return D._height;var f=D.getStyle("points.model");if(f){var H=Pf(f);if(H&&H.rawS3)return H.rawS3[2]}return 1},getTall:function(){var h=this;if(h._tall>=0)return h._tall;var Y=h.getStyle("points.model");if(Y){var w=Pf(Y);if(w&&w.rawS3)return w.rawS3[1]}return 1}});var lf=A.Polyline=function(){ud(lf,this),this.s({"shape.background":null,"shape.border.width":2})};Mf("Polyline",ck,{_icon:"polyline_icon",_22Q:function(){return qt},getUIClass:function(){return fj},setClosePath:function(){},setTall:function(F){var G=this;if(G.beginTransaction(),!G._55I&&!G._24Q&&!Qk&&G.getTall()){G._24Q=1;var H=G._54O,Q=F/G.getTall();if(1!==Q){var a=G.toPoints(),O=new Od;a.each(function(V){O.add({x:V.x,y:V.y,e:V.e==$?V.e:(V.e-H)*Q+H})}),G.setPoints(O),G.fs()}delete G._24Q}lf.superClass.setTall.call(G,F),G.endTransaction()},setElevation:function(K){var l=this;if(l.beginTransaction(),!l._55I&&!l._24Q&&!Qk){l._24Q=1;var $=K-l._54O;0!==$&&l.shiftPointsElevation($),delete l._24Q}lf.superClass.setElevation.apply(l,arguments),l.endTransaction()},fireShapeChange:function(){var y=this,q=y._59O;if(!y._55I&&!y._24Q&&!Qk){var M=q.size();if(M){var P=1,a=q.get(0),x=y._54O;a.e==$&&(a.e=x);for(var e=a.e,d=0;M>P;P++){a=q.get(P),a.e==$&&(a.e=x);var Z=O(e,a.e),C=E(e+d,a.e);e=Z,d=C-Z}y._24Q=1,y.setTall(d),y.setElevation(e+d*y._anchorElevation),delete y._24Q}}lf.superClass.fireShapeChange.apply(y,arguments)}});var km=A.SubGraph=function(){ud(km,this)};Mf("SubGraph",Qh,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){km.superClass._8I.call(this),this.eachChild(function(R){Dk(R)&&R._8I()})}}),u.loadingRefGraph=0;var Cd=A.RefGraph=function(){ud(Cd,this)};Mf("RefGraph",el,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(S){var L=this._ref;this._ref=S,this.fp("ref",L,S),this.updateRef()},_21I:function(){Cd.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var N=this;if(u.loadingRefGraph++,N.clearChildrenFromDataModel(),u.loadingRefGraph--,N._ref&&N._dataModel){N._xhrLoadHandler&&(N._xhrLoadHandler.cancel=!0);var W=Qk,h=N._xhrLoadHandler=function(C){if(C&&N._dataModel){u.loadingRefGraph++;var S=N._pendingUpdateInfo={needToRestore:W};W&&(S.p3=N.p3(),S.s3=N.s3(),S.r3=N.r3(),S.anchor3d=N.getAnchor3d(),S.scale3d=N.getScale3d()),N.r3(0,0,0),N.setScale3d(1,1,1),N.setAnchor3d(.5,.5,.5),N.p3(0,0,0);var L=u.parse(C),A=N._dataModel.deserialize(L,N,{justDatas:!0});A.each(function(y){y._refGraph=N}),N.checkPendingUpdateInfo(),u.loadingRefGraph--,u.handleRefGraphLoaded(N,A,L)}};h.xhrLoadCalled=!1,u.load(N._ref,function(T){h.cancel||(h.xhrLoadCalled?h(T):Qi(function(){h(T)}))}),h.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var m=this,W=m._pendingUpdateInfo;if(!W)return m.onPendingUpdated&&(u.loadingRefGraph++,m.onPendingUpdated(),u.loadingRefGraph--),void 0;var j=!0;this.eachChild(function(e){(e._pendingCheckImageJSON||e._pendingUpdateInfo)&&(j=!1)}),j&&(u.loadingRefGraph++,m._pendingUpdateInfo=null,m.updateFromChildren(),W.needToRestore&&(m.setAnchor3d(W.anchor3d),m.setScale3d(W.scale3d),m.r3(W.r3),m.p3(W.p3)),this.getParent()instanceof Cd&&this.getParent().checkPendingUpdateInfo(),m.onPendingUpdated&&m.onPendingUpdated(),u.loadingRefGraph--)},getSerializableProperties:function(){var L=Cd.superClass.getSerializableProperties.call(this);return L.ref=1,L}}),A.EdgeGroup=function(l,g){this._70O=l,this._siblings=g;for(var a,v,F=0,n=l.size(),c=x[Rb];n>F;F++)if(a=l.get(F).getStyle(Rb,!1),a!=$){c=a;break}c==$&&(c=!0);var S=u.edgeGroupAgentFunc;for(S&&(v=S(l),v&&v!==l.get(0)&&(l.remove(v),l.add(v,0))),F=0;n>F;F++)l.get(F).s(Rb,c)},Mf("EdgeGroup",b,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function($){return this._70O.get($)},indexOf:function(l){return this._70O.indexOf(l)},each:function(x,K){this._70O.each(x,K)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(z,p){this._siblings.each(function(E){E._70O.each(z,p)})}});var ne=function(E,X,I){var T=ic[E]={type:E,action:X};if(I)for(var O in I)T[O]=I[O]};hf(u,{setConnectAction:ne,getConnectAction:function(r,A){if(!A){if(!r)return null;A=r.getCurrentConnectActionType()}return ic[A]},doConnectAction:function(F,o,q,C){C=C||F.getCurrentConnectActionType();var A=ic[C];if(!A)return!1;var n=A.action;return n?(o instanceof um.Group?F.sm().getSelection().each(function(S){n.call(null,F,S,q)}):n.call(null,F,o,q),!0):!1},doDeleteConnectionAction:function(b,N,Z){Z=Z||b.getCurrentConnectActionType();var C=ic[Z];if(!C||!C.delete)return!1;var m=C.delete.action;return m?(N instanceof um.Group?b.sm().getSelection().each(function(y){m.call(null,b,y)}):m.call(null,b,N),!0):!1}});var vf=A.JSONSerializer=function(e,_){this.dm=this._dataModel=e,this._hierarchical=u.forceHierarchicalSerialization?!0:_==$?e.isHierarchicalRendering():_};Mf("JSONSerializer",b,{ms_ac:["hierarchical"],serialize:function(E){return u.stringify(this.toJSON(),E)},toJSON:function(){var l,U=this,v=U.dm,y=v.getRoots(),z=U.json={v:u.getVersion(),p:{},a:{},d:[]},E=v.getSerializableAttrs();(l=v.getInit())&&(z.init=l),(l=v.getName())&&(z.p.name=l),(l=v.getBackground())&&(z.p.background=l),(l=v.getLayers())&&(z.p.layers=l),(l=v.getEnvmap())&&(z.p.envmap=l),(l=v.getEnvmapType())&&(z.p.envmapType=l),z.p.autoAdjustIndex=v.isAutoAdjustIndex(),z.p.hierarchicalRendering=v.isHierarchicalRendering();for(var k in E){var Y=v.a(k);Y!==r&&U[dn](k,Y,z.a)}return Rd(z.a)&&delete z.a,U._hierarchical?y.each(U.serializeData,this):v.each(function(d){U.serializeData(d)}),v.fireSerializeEvent({type:"serialize",json:z}),v.getPostProcessingData()&&(z.p.postProcessingData=v.getPostProcessingData()),z},isSerializable:function(){return!0},getProperties:function(W){return W.getSerializableProperties()},getStyles:function(Q){return Q.getSerializableStyles()},getAttrs:function(d){return d.getSerializableAttrs()},serializeData:function(X){var H=this;if(H.isSerializable(X)&&!X._refGraph){var t,B,C,j,w,z,K=Bq(X.getClassName())||X.getClass(),O=new K,D={c:X.getClassName(),i:X.getId(),p:{},s:{},a:{}};H.json.d.push(D),t=H.getProperties(X);for(B in t)if(/^_/.test(B)){if(C=X[B],!("_width"!==B&&"_height"!==B||C!=$&&-1!==C)){if(w==r){var I;z=(X.s("layout.h")||X.s("layout.v"))&&X.getHost()||X instanceof A.Node&&(I=X.getParent())&&I instanceof A.Block||X.s("fullscreen"),w=X.hasInheritedSize()}z&&w&&(C=X[B]="_width"===B?X.getWidth():X.getHeight())}C!==O[B]&&H[dn](B.substr(1),C,D.p)}else j=ch(B),X[j]&&(C=X[j](),C!==O[j]()&&H[dn](B,C,D.p));t=H.getStyles(X);for(B in t)C=X.s(B),C!==O.s(B)&&H[dn](B,C,D.s);t=H.getAttrs(X);for(B in t)C=X.a(B),C!==O.a(B)&&H[dn](B,C,D.a);Rd(D.p)&&delete D.p,Rd(D.s)&&delete D.s,Rd(D.a)&&delete D.a}H._hierarchical&&X.getChildren().each(H.serializeData,H)},serializeValue:function(o,S,O){mj(S)?S={__a:S._as}:S instanceof $h?S={__i:S.getId()}:S instanceof Or&&(S={__dm:S.serialize(0)}),O[o]=S},deserialize:function(A,D,n){var s=this;return ph(A)&&/.json$/.test(A)?(u.xhrLoad(A,function(Q){s.deserializeImpl(Q,D,n)}),void 0):s.deserializeImpl(A,D,n)},deserializeImpl:function(j,Z,e){var m=this,V=m.dm;V.setDeserializing(!0),e=xn(e)?{setId:e}:Xp(e)?{finishFunc:e}:e||{},j=m.json=ph(j)?u.parse(j):j,!e.justDatas&&j.a&&j.a.onPreDeserialize&&!e.disableOnPreDeserialize&&j.a.onPreDeserialize(j,V,e.view),V.beginTransaction(),Qk++,m._82I={};var L=new Od,b=new Od,I=0,H=j.d.length;if(e.justDatas||(!e.disableInit&&Xp(j.init)&&j.init(V),V.setInit(j.init)),!e.justDatas){for(var A in j.a)V.a(A,m[$f](j.a[A]));for(var x in j.p)V[Uo(x)](j.p[x])}for(;H>I;I++){var n=j.d[I],X=Bq(n.c),i=new X,o=n.i;e.setId&&o!=$&&(i._id=o),m._82I[o]=i,L.add(i),b.add(n)}for(I=0;H>I;I++)m.deserializeData(L.get(I),b.get(I));return L.each(function(T){Z&&!T.getParent()&&T.setParent(Z),V.add(T)}),e.__innerHandler__&&e.__innerHandler__(j,V,e.view,L),V.fireSerializeEvent({type:"deserialize",json:j}),Qk--,V.endTransaction(),!e.justDatas&&j.a&&j.a.onPostDeserialize&&!e.disableOnPostDeserialize&&j.a.onPostDeserialize(j,V,e.view,L),e.finishFunc&&e.finishFunc(j,V,e.view,L),V.setDeserializing(!1),L},deserializeData:function(m,S){for(var a in S.p)m[Uo(a)](this[$f](S.p[a]));for(a in S.s)m.s(a,this[$f](S.s[a]));for(a in S.a)m.a(a,this[$f](S.a[a]))},deserializeValue:function(R){if(Tq(R)){var z=R.__i;if(z!=$)return this._82I[z];if(z=R.__dm,z!=$){var X=new A.DataModel;return X.deserialize(z),X}if(z=R.__a,Zf(z))return new Od(z)}return R}}),hf(Or,{serialize:function(W,j){return new vf(this,j).serialize(W)},toJSON:function(G){return new vf(this,G).toJSON()},deserialize:function(d,B,r){return new vf(this).deserialize(d,B,r)}});var lc=A.OverlappingBox=function(F){this.gv=F,this.boxes={}};Mf("OverlappingBox",b,{clear:function(){var L,i,b=this.boxes;for(L in b)i=b[L],i.length=0},isOverlapping:function(u,n){var X,A,g=this,d=g.boxes,y=d[u];y?(X=y.rects,A=y.length):y=d[u]={rects:X=[],length:A=0};var v,Q,n;for(v=0;A>v;v++)if(Q=X[v],Q.x<n.x+n.w&&Q.x+Q.w>n.x&&Q.y<n.y+n.h&&Q.h+Q.y>n.y)return!0;return X.length<=A?(X.push(n),y.length++):X[y.length++]=n,!1}}),hf(u,{fetch:function(R,e){var E="GET",w=!1,F=null,H="";e&&(E=e.method||"GET",w=e.sync,H=e.url,F=e.data||null),R.open(E,H,!w),e.responseType?R.responseType=e.responseType:e.overrideMimeType&&R.overrideMimeType&&R.overrideMimeType(e.overrideMimeType),R.send(F)},convertImageSrc:function(T,e){e&&"function"==typeof e||(e=function(){}),e(T)}});var uk=A.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};Mf("Request",b,{_responseType:null,_overrideMimeType:"text/plain",send:function(q){var $=this._xhr,N=this.onload,k=this.onerror;this.getResponseType()?q.responseType=this.getResponseType():this.getOverrideMimeType()&&(q.overrideMimeType=this.getOverrideMimeType()),$.onload=N,$.onerror=k,u.fetch($,q)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(g){this._responseType=g},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(T){this._overrideMimeType=T},getResponseText:function(){var a=this._xhr;return a.response||a.responseText}}),bl.GraphView=function(m){var _=this;_._24I={},_._34I=new Od,_.enableDirtyRect(),_._25I={},_._56I={},_._view=Ar(1,_),_._canvas=qc(_._view),_.dm(m?m:new Or),this._coreInteractor=new Wh(this),_.setEditable(!1),_.setScrollBarVisible(u.graphViewScrollBarVisible),_._initView()},Yr("GraphView",b,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[lo,me,mh,Mj,"resettable","editInteractor",Xe,"zoomable","pannable","rectSelectable","autoScrollZone",Vn,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:u.graphViewZoomable,_resettable:u.graphViewResettable,_pannable:u.graphViewPannable,_rectSelectable:u.graphViewRectSelectable,_autoScrollZone:u.graphViewAutoScrollZone,_rectSelectBackground:u.graphViewRectSelectBackground,_rectSelectBorderColor:u.graphViewRectSelectBorderColor,_editPointSize:u.graphViewEditPointSize,_editPointBorderColor:u.graphViewEditPointBorderColor,_editPointBackground:u.graphViewEditPointBackground,_scrollBarColor:Si,_scrollBarSize:Tr,_autoHideScrollBar:fp,_autoMakeVisible:Rc,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(o){this._dataModel.setLayers(o)},setEditable:function(u){var H=this,m=H.__interactorMap__;if(!m){var V=bl.XEditInteractor;m=H.__interactorMap__={scrollBar:new Vr(H),select:new ug(H),edit:V?new V(H):new cs(H),text:new lh(H),move:new bo(H),"default":new cr(H),touch:new In(H,{editable:!1})}}u?(H._uieditable=!0,H.setInteractors([m.scrollBar,m.select,m.edit,m.text,m.move,m.default,m.touch])):(H._uieditable=!1,H.setInteractors([m.scrollBar,m.select,m.move,m.default,m.touch]))},getCanvas:function(){return this._canvas},_33I:function(h){var z=h.getUIClass();return z?new z(this,h):$},getDataUI:function(j){var d=this,u=d._25I[j._id];return u===r&&(u=d._33I(j),d._25I[j._id]=u),u},getNodeRect:function(i){return u.getNodeRect(this,i)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(j){var y=this.getDataUI(j);return y?(y._79o(),y._78o):null},getEdgeSourcePosition:function(h){var v=this,y=v.getDataUI(h),k=y.s,M=y._data._40I;return Ad(v,M,k("edge.source.position"),k("edge.source.offset.x"),k("edge.source.offset.y"),k("edge.source.anchor.x"),k("edge.source.anchor.y"))},getEdgeTargetPosition:function(A){var S=this,$=S.getDataUI(A),e=$.s,D=$._data._41I;return Ad(S,D,e("edge.target.position"),e("edge.target.offset.x"),e("edge.target.offset.y"),e("edge.target.anchor.x"),e("edge.target.anchor.y"))},invalidateAll:function(p){var v=this;if(p){for(var h in v._25I){var c=v._25I[h];c&&c.dispose()}v._25I={},v._56I={},v._24I={},v._34I.clear(),v.redraw()}else v.dm().each(function(J){v.invalidateData(J)})},invalidateSelection:function(){var c=this;c.sm().each(function(f){c.invalidateData(f)})},invalidateData:function(Z){var t=this;t._24I[Z._id]=Z,t._21Q(Z),t.iv()},_21Q:function(E){var t=this,d=t._24I;if(Sl(E)&&Cl[E.s(uf)]){var B=E.getSourceAgent();B&&B.getAgentEdges().each(function(u){d[u._id]=u}),B=E.getTargetAgent(),B&&B.getAgentEdges().each(function(s){d[s._id]=s}),t.iv()}},redraw:function(K){var _=this;_._32I||(K?_._34I.add(K):(_._32I=1,_._34I.clear()),_.iv())},each:function(j,T){var S,t,p,O=0,_=this.getLayers(),Q=this._dataModel,N=Q._datas._as,c=N.length;if(_){var B,y={};Q.isHierarchicalRendering()&&Q.eachByHierarchical(function(Z){p=Z._layer,B=y[p],B||(B=y[p]=[]),B.push(Z)});for(var i=_.length;i>O;O++)if(p=_[O],Tq(p)&&(p=p.name),Q.isHierarchicalRendering()){B=y[p];var C,S,u;if(B&&(C=B.length)>0)for(var h=0;C>h;h++)if(S=B[h],u=T?j.call(T,S):j(S),u===!1)return}else for(var h=0;c>h;h++)if(S=N[h],S._layer===p&&(t=T?j.call(T,S):j(S),t===!1))return}else if(Q.isHierarchicalRendering())this._dataModel.eachByHierarchical(j,null,T);else for(;c>O;O++)if(S=N[O],t=T?j.call(T,S):j(S),t===!1)return},reverseEach:function(j,O){var t,c,M,X,i=this._dataModel,V=i._layers,C=i._datas._as,L=C.length;if(V){var B,d={};for(i.isHierarchicalRendering()&&i.reverseEachByHierarchical(function(v){X=v._layer,B=d[X],B||(B=d[X]=[]),B.push(v)}),t=V.length-1;t>=0;t--)if(X=V[t],Tq(X)&&(X=X.name),i.isHierarchicalRendering()){B=d[X];var H,c,s;if(B&&(H=B.length)>0)for(var r=0;H>r;r++)if(c=B[r],s=O?j.call(O,c):j(c),s===!1)return}else for(var r=L-1;r>=0;r--)if(c=C[r],c._layer===X&&(M=O?j.call(O,c):j(c),M===!1))return}else if(i.isHierarchicalRendering())i.reverseEachByHierarchical(j,null,O);
else for(t=L-1;t>=0;t--)if(c=C[t],M=O?j.call(O,c):j(c),M===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var T=this,f=T._84I;if(!f){var R=this.dm().a("width"),u=this.dm().a("height");R>0&&u>0?T._84I={x:0,y:0,width:R,height:u}:(T.each(function(o){T.isVisible(o)&&(f=so(f,T.getDataUIBounds(o)))}),T._84I=f?f:ze)}return T._84I},getScrollRect:function(){return so(this.getContentRect(),this._29I)},makeCenter:function(h,i,T){var c=this;if(!c.getWidth()||!c.getHeight())return T||Qi(c.makeCenter,c,[h,i,!0],500),void 0;c.makeVisible(h),c.validate();var K=c.getDataUIBounds(h);if(K){var O=c.getWidth(),J=c.getHeight(),S=K.x+K.width/2,t=K.y+K.height/2,y=-S*c._zoom+O/2,e=-t*c._zoom+J/2;c.setTranslate(y,e,i)}},fitData:function(T,Y,V,v,q){var J=this;if(!J.getWidth()||!J.getHeight())return q||Qi(J.fitData,J,[T,Y,V,v,!0],500),void 0;var c=function(){J.makeVisible(T),J.validate();var g=J.getDataUIBounds(T);g&&(g=Bf(g),nh(g,V==$?20:V),J.fitRect(g,Y,v))};Y?u.callWhenLoaded(c):c()},fitContent:function(E,l,i,F){var o=this;if(!o.getWidth()||!o.getHeight())return F||Qi(o.fitContent,o,[E,l,i,!0],500),void 0;var d=function(){o.validate();var W=Bf(o.getContentRect());nh(W,l==$?20:l),o.fitRect(W,E,i)};E?u.callWhenLoaded(d):d()},fitRect:function(r,S,p){var F=this,P=F.getWidth(),j=F.getHeight(),x=r.x+r.width/2,K=r.y+r.height/2,y=O(P/r.width,j/r.height),R=F._zoom,h=-x*R+P/2,I=-K*R+j/2;0===y||isNaN(y)||(p&&(y=O(1,y)),S?(F._65I&&(delete F._65I.finishFunc,F._65I.stop(!0)),F._14o&&F._14o.stop(!0),F.setTranslate(h,I,{finishFunc:function(){F.setZoom(y,S)}})):(F.setTranslate(h,I),F.setZoom(y)))},fitSelection:function(g,O,R){var Y=this,x=Y.sm(),I=null;x.size()&&(x.each(function(z){I=so(Y.getDataUIBounds(z),I)}),g&&nh(I,g),Y.fitRect(I,O,R))},toCanvas:function(y,k,p){k=k||this._zoom,this.validateImpl();var X=this,r=X.getContentRect();p&&nh(r,p),r.width||(r.width=10),r.height||(r.height=10);var P=qc(),e=r.x*k,F=r.y*k,W=Math.ceil(r.width*k),Z=Math.ceil(r.height*k);Kc(P,W,Z,1);var L=te(P);y=y||this._dataModel.getBackground(),y&&Dc(L,0,0,W,Z,y),Ge(L,-e,-F),L.scale(k,k);var v=this._zoom;return this._zoom=k,X._42(L),this._zoom=v,L.restore(),P},toDataURL:function(c,I,s,i){return this.toCanvas(c,s,i).toDataURL(I||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(U,r){var w=this,K=w.dm().getBackground();if(K){var $=w.dm().a("width"),E=w.dm().a("height");$>0&&E>0&&Dc(U,0,0,$,E,K)}var p=w.__htmlOrderList,e=[],k=w._forcedLayoutHTML;if(w._93db(U,r),w.each(function(q){var v=w.getDataUI(q);if(v){var R=w._56I[q._id],M=v._htmlView;if(R){var u=v._79o();if(M=v._htmlView,A.HtmlNode&&q instanceof A.HtmlNode)v._42(U);else{var K=w.getViewRect(),X=M&&M.layoutHTML;!r||Ii(r,u)?(X&&(M.layoutHTML(),v.__outerLayout&&delete v.__outerLayout),v._42(U)):Ii(K,u)||!X||v.__outerLayout&&!k||(M.layoutHTML(),v.__outerLayout=!0)}}M&&(e.push(M),M.getView&&(M=M.getView()),M.style.display=R?"block":hh)}}),p&&e.length>0){var o=!1;if(p.length!==e.length)o=!0;else for(var q=0;q<e.length;q++)if(e[q]!==p[q]){o=!0;break}o&&(e.forEach(function(H){H.autoAdjustIndex!==!1&&w.appendHTML(H,!0)}),this.__htmlOrderList=e)}else this.__htmlOrderList=e;w._92db(U,r)},disableDirtyRect:function(){this._shouldRedrawAll=Q},enableDirtyRect:function(){var o=this;o._shouldRedrawAll=function(){return o._32I}},validateImpl:function(){this.tryUpdateRootData();var S,s,t,z,c,u=this,J=u.tx(),p=u.ty(),b=u._zoom,X=u._canvas,V=this.getWidth(),j=this.getHeight(),A=u._29I,y={x:-J/b,y:-p/b,width:V/b,height:j/b},W={},O=u._34I,K=u._24I,U=u._shouldRedrawAll(),v=u._23I;u._24I={},(V!==X.clientWidth||j!==X.clientHeight)&&(Kc(X,V,j),U=1,u._forcedLayoutHTML=1),U||co(y,A)||(U=1,u._forcedLayoutHTML=1),u._29I=y,u.each(function(O){s=O._id;var M=W[s]=u.isVisible(O);M!==u._56I[s]&&(K[s]=O,t=u.getDataUI(K[s]),t&&t._84o(M),u._84o(O,M))},u);for(s in K)t=u.getDataUI(K[s]),t&&(!U&&u._56I[s]&&(c=t._79o(),c&&O.add(c)),t.invalidate()),u._83I=1;if(u._56I=W,!U)for(s in K)W[s]&&(t=u.getDataUI(K[s]),t&&(c=t._79o(),c&&O.add(c)));if(U?z=y:(O.each(function(m){Ii(y,m)&&(z=so(z,m))}),z&&(nh(z,E(1,1/b)),z.x=M(z.x*b)/b,z.y=M(z.y*b)/b,z.width=l(z.width*b)/b,z.height=l(z.height*b)/b,z=qs(y,z))),u._74O=z,z&&0!==z.width&&0!==z.height){S=te(X);var a=z.x,e=z.y,R=z.width,h=z.height;a=Math.floor((a*b+J)*Fd),e=Math.floor((e*b+p)*Fd),R=Math.ceil(R*b*Fd)+1,h=Math.ceil(h*b*Fd)+1,U||(z.x=(a/Fd-J)/b,z.y=(e/Fd-p)/b,z.width=R/Fd/b,z.height=h/Fd/b),S.beginPath(),S.rect(a,e,R,h),S.clip(),S.clearRect(a,e,R,h),Tj(S,J,p,b),u._42(S,z),S.restore(),delete u._74O}if(O.clear(),delete u._32I,delete u._forcedLayoutHTML,v&&V>0&&j>0){var t=u.getDataUI(v);if(t){var c=t._79o(),Z=u._29I,d=Z.x,f=Z.y,N=Z.width,m=Z.height,b=u._zoom;c&&!Ii(c,Z)&&(c.x+c.width<d&&u.tx(-c.x*b),c.x>d+N&&u.tx(-(c.x+c.width-N)*b),c.y+c.height<f&&u.ty(-c.y*b),c.y>f+m&&u.ty(-(c.y+c.height-m)*b))}delete u._23I}u._83I&&(delete u._83I,delete u._84I),u._98O(),u.countFrame(),Rd(u._24I)||Qi(u.iv,u)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var v,E=this.getFullscreenDatas();for(var k in E)v=E[k],this.scaleRootData(v);this.onRootDataUpdated&&this.onRootDataUpdated(),this._rootDataUpdating=!1}},scaleRootData:function(J){var y=J.s("fullscreen");if("uniform"===y||"fill"===y){J.getRotation()&&J.setRotation(0);var I=J.s("fullscreen.gap")||0,v=this.getWidth(),K=this.getHeight();if(v&&K){var k,d,h,$=v-2*I,_=K-2*I,U=J.getAnchor(),F=J.getScaledSize(),X=F.width,Q=F.height,R=J.s("fullscreen.lock");if(R)return"uniform"===y?$/_>X/Q?(k=_/Q,X=Q*$/_):(k=$/X,Q=X*_/$):"v"===R?(k=_/Q,X=$/k,J.getWidth()!==X&&J.setWidth(X)):(k=$/X,Q=_/k,J.getHeight()!==Q&&J.setHeight(Q)),this.setZoom(k),d=I-(J.getX()-U.x*X)*k,h=I-(J.getY()-U.y*Q)*k,d!==this.tx()&&this.tx(d),h!==this.ty()&&this.ty(h),void 0;d=this.tx(),h=this.ty(),k=this._zoom;var B={x:(-d+I)/k,y:(-h+I)/k,width:$/k,height:_/k};if("uniform"===y){var q=X/Q,u=Math.min(B.width,B.height*q),Y=u/q;B.x+=.5*(B.width-u),B.y+=.5*(B.height-Y),B.width=u,B.height=Y}$=B.width/J.getScaleX(),_=B.height/J.getScaleY(),(J.getWidth()!=$||J.getHeight()!==_)&&J.setSize($,_);var Z=B.x+U.x*B.width,W=B.y+U.y*B.height,L=J.getPosition();(Z!==L.x||W!==L.y)&&J.setPosition(Z,W)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(x){var O=this;x!==O.isScrollBarVisible()&&(x?($p(O._view,O._79O=Ic()),$p(O._79O,O._27I=Ic()),$p(O._79O,O._28I=Ic())):(lk(O._79O),delete O._79O,delete O._27I,delete O._28I),O.fp("scrollBarVisible",!x,x))},getDebugTip:function(){return""},showScrollBar:function(){var W=this;W._79O&&(W._85I||(Kb(function(){W._86I()},tj),W.iv()),W._85I=new Date)},_86I:function(){var q=this;if(q._85I){var Q=new Date,R=Q.getTime();R-q._85I.getTime()>=tj?(delete q._85I,q.iv()):Kb(function(){q._86I()},tj)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var B=this,P=this._27I,t=this._28I;if(B._79O){if(B._autoHideScrollBar&&!B._85I)return P.style.visibility=Rq,t.style.visibility=Rq,void 0;var f=B.getScrollBarColor(),w=B._zoom,e=B.getScrollBarSize(),L=B.getViewRect(),d=B.getScrollRect(),v=L.height*w,z=d.height*w,y=L.width*w-e-2,R=v*((L.y-d.y)*w/z),m=v*(v/z),_=P.style;z-.5>v?(sc>m&&(R=R+m/2-sc/2,0>R&&(R=0),R+sc>v&&(R=v-sc),m=sc),Zg(P,y,R,e,m),_.visibility=uo,_.background=f,_.borderRadius=e/2+en):_.visibility=Rq;var a=L.width*w,c=d.width*w,R=L.height*w-e-2,y=a*((L.x-d.x)*w/c),i=a*(a/c),_=t.style;c-.5>a?(sc>i&&(y=y+i/2-sc/2,0>y&&(y=0),y+sc>a&&(y=a-sc),i=sc),Zg(t,y,R,i,e),_.visibility=uo,_.background=f,_.borderRadius=e/2+en):_.visibility=Rq}},setDataModel:function(y){var v=this,i=v._dataModel,W=v._selectionModel;i!==y&&(i&&(i.ump(v.handleDataModelPropertyChange,v),i.umm(v.handleDataModelChange,v),i.umd(v.handleDataPropertyChange,v),i.removeIndexChangeListener(v._75O,v),i.removeHierarchyChangeListener(v.handleHierarchyChange,v),W||i.sm().ums(v.handleSelectionChange,v)),v._dataModel=y,y.mp(v.handleDataModelPropertyChange,v),y.mm(v.handleDataModelChange,v),y.md(v.handleDataPropertyChange,v),y.addIndexChangeListener(v._75O,v),y.addHierarchyChangeListener(v.handleHierarchyChange,v),W?W._21I(y):y.sm().ms(v.handleSelectionChange,v),v.invalidateAll(!0),v.fp(Xm,i,y),v.updateBackground())},getLayersInfo:function(){if(this._layersInfo===r){var X=this.getLayers();X?(this._layersInfo={},X.forEach(function(x){var v=Tq(x)?x.name:x;this._layersInfo[v]=x},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(P,q,d){var S,b,$,X,g=this;P instanceof A.Data?(X=g.getDataUI(P),$=Sm(X)):($=Sm(null,arguments[0],arguments[1]),q=arguments[2],d=arguments[3]),2===q.length&&(q=new Ho(q[0],q[1]));var t=zq(q,function(f){return Lf($,100*f)},100,.001),Z=Lf($,100*t);if(!d){var r=X?kr(X):kr(arguments[0],arguments[1]),H=new Ho(Z.x,Z.y),W=49/(g._zoom*g._zoom);for(S=0,b=r.length;b>S;S++)if(H.distanceToSquared(r[S])<W)return{index:S,point:r[S],distance:Math.sqrt((r[S].x-q.x)*(r[S].x-q.x)+(r[S].y-q.y)*(r[S].y-q.y))}}return{percent:t,point:Z,distance:Math.sqrt((Z.x-q.x)*(Z.x-q.x)+(Z.y-q.y)*(Z.y-q.y))}},getPercentPositionOfPath:function(L,$){var W;if(L instanceof A.Data){var l=this.getDataUI(L);W=Sm(l)}else W=Sm(null,arguments[0],arguments[1]),$=arguments[2];return Lf(W,$)},getNeareastPositionOfPath:function(){return this.calculateEdgePosition.apply(this,arguments)},getPointsOfPath:function(){function r(e,D,w,i,d,n){var r=new Ho(D.get(w)),Q=n.apply(r);e.push({local:r,world:Q,type:d,index:w,realIndex:i})}return function($){var b,H;if($ instanceof A.Data){var e=this.getDataUI($),s=cm(e);b=s.points,H=s.segments}else b=arguments[0],H=arguments[1];var P,g,D,k=$ instanceof A.Shape?$.getPointsMatrix2d():new ke.Matrix2d,a=[],u=-1,t=-1;for(g=0,D=H?H.length:b.length;D>g;g++)P=H?H.get(g):1,5!==P&&(t++,3===P?(r(a,b,u+1,t,"C",k),r(a,b,u+2,t,"M",k),u+=2):4===P?(r(a,b,u+1,t-1,"R",k),r(a,b,u+2,t,"L",k),r(a,b,u+3,t,"M",k),u+=3):(r(a,b,u+1,t,"M",k),u+=1));return a}}(),calculateAttachPoint:function(){var B=new Ho,P=new Ho,W=new Ho;return function(p,E){var A=this.getAttachPoints(p);if(!A||!A.length)return null;W.set(E.x,E.y);for(var m,v,c,Y,h,Q=1/0,r=0,e=A.length;e>r;r++)c=A[r],P.x=c.x,P.y=c.y,B.x=c.offsetX||0,B.y=c.offsetY||0,Y=Ad(this,p,0,B.x,B.y,P.x,P.y),v=W.distanceToSquared(Y),Q>v&&(m=r,Q=v,h=Y);Q=Math.sqrt(Q);var L=this.getAttachStyle(p);if("close"===L){var C=p.s("attach.close.threshold")/this._zoom;if(Q>C)return null}return{index:m,distance:Q,info:A[m],point:h}}}(),getAttachPoints:function(X){var G=X.s("attach.points");if(G)return G;var f=Of(X._image);return f?Tp(f.attachPoints,X,this)||null:void 0},getAttachStyle:function(k){var V=k.s("attach.style");if(V)return V;var R=Of(k._image);return R?Tp(R.attachStyle,k,this)||"close":void 0},updateLayers:function(){this._layersInfo=r,this.invalidateSelection(),this.redraw()},updateBackground:function(){var k=this.dm().a("width"),W=this.dm().a("height");this._canvas.style.background=k>0&&W>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(y){if("background"===y.property){var R=this._canvas.style.background,G=y.newValue||"";this.updateBackground(),this.fp("canvasBackground",R,G),this.redraw()}else"a:width"===y.property||"a:height"===y.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===y.property?this.updateLayers():"hierarchicalRendering"===y.property&&this.redraw()},handleDataPropertyChange:function(h){this.dm().isHierarchicalRendering()&&"parent"===h.property&&h.data.hasChildren()&&this.redraw(),this.invalidateData(h.data)},onPropertyChanged:function(r){var P=this,d=r.property;if(P.redraw(),"zoom"===d){var b=P.sm().getSelection();b.size()&&b.each(function(B){B.invalidate()})}else"dataModel"===d&&(P._83I=1);dm[d]?P.showScrollBar():d===Xe&&P.onCurrentSubGraphChanged(r)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(s){var Q=this,B=s.kind,W=s.data;if(Q._83I=1,"add"===B)Q.invalidateData(W),Sl(W)&&W.getEdgeGroup()&&W.getEdgeGroup().eachSiblingEdge(Q.invalidateData,Q),W.getHost&&W.getHost()&&W.getHost().updateLayoutAttaches();else if(B===Vc){Q._21Q(W);var F=W._id,A=Q._25I[F];if(A){if(Q._56I[F]){var i=A._79o();i&&Q.redraw(i)}A.dispose(),delete Q._25I[F],delete Q._24I[F],delete Q._56I[F]}W===Q._currentSubGraph&&Q.setCurrentSubGraph($)}else B===vo&&(Q.invalidateAll(!0),Q.setCurrentSubGraph($))},_75O:function(b){this.invalidateData(b.data)},handleHierarchyChange:function(J){this.dm().isHierarchicalRendering()&&J.data.hasChildren()&&this.redraw(),this.invalidateData(J.data)},adjustIndex:function(w){var u=this;if(u.isVisible(w)){u.dm().beginTransaction();for(var q=w;q._parent&&u.isVisible(q._parent);)q=q._parent;q&&q!==w&&u._dataModel.adjustIndex(q),u._dataModel.adjustIndex(w),u.dm().endTransaction()}},getImage:function(p){return p.getImage?p.getImage():r},getSelectWidth:function(r){var S=Of(this.getImage(r));return S&&Tp(S.disableSelectedBorder,r,this)?0:r.s("select.width")},getSelectColor:function(o){return o.s("select.color")},isSelectable:function(w,J){if(this.isSelected(w))return!0;if(!J&&w.getParent()instanceof el&&this.isSelectable(w.getParent(),!0)&&w.getParent().isSyncSize())return!1;var k=this.getLayersInfo();if(k){var F=k[w._layer];if(F&&F.selectable===!1)return!1}return w.s("2d.selectable")&&this.sm().isSelectable(w)},isMovable:function(J){var n=this;if(Sl(J)&&J.getStyle(uf)!==no)return!1;var H=this.getLayersInfo();if(H){var e=H[J._layer];if(e&&e.movable===!1)return!1}return J.s("2d.movable")?n._movableFunc?n._movableFunc(J):!0:!1},isEditable:function(t){var Y=this;if(A._uiSerializing)return Y._uieditable;if(!Y._editInteractor||!Y.isSelected(t))return!1;if(db(t)){var S=Y.getDataUI(t);if(!S||S._88I)return!1}if(Sl(t)&&t.getStyle(uf)!==no)return!1;var r=this.getLayersInfo();if(r){var p=r[t._layer];if(p&&p.editable===!1)return!1}return t.s("2d.editable")?Y._editableFunc?Y._editableFunc(t):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(e){return Dk(e)&&0!==e.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(e):!0},isRectEditable:function(w){return this._rectEditableFunc?this._rectEditableFunc(w):!0},isAnchorEditable:function(H){return this._anchorEditableFunc?this._anchorEditableFunc(H):!0},isRotationEditable:function(h){return h.setRotation&&h.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(h):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(V){var w=V.getAnchor(),N=V.getScale(),p=this._zoom,S=zn(V.getRotation(),0,-V.getHeight()*N.y*w.y-(N.y<0?-1:1)*(Ze?32:16)/p),I=V.p();return S.x+=I.x,S.y+=I.y,S},getLogicalPoint:function(b){var m=this;return Xr(b,m._canvas,m.tx(),m.ty(),m._zoom,m._zoom)},getScreenPoint:function(n,s){var b,p=this;return"object"==typeof n?n.x!==r?(b=n.x,s=n.y):(b=n[0],s=n[1]):b=n,_h(b,s,p._canvas,p.tx(),p.ty(),p._zoom,p._zoom)},getSelectedDataAt:function(o){var U=this;return this.getDataAt(o,function(r){return U.isSelected(r)})},getDataInfoAt:function(M,s,r){var y,E=this.lp(M),z=this.getDataAt(E,s,r);if(z){var A=this.getDataUI(z);y={data:z,ui:A,point:E};var g=A._38o;if(g){var B=g.icons;for(var a in B){var J=B[a],K=g.rects[a];if(K)for(var w=Tp(J.names,z,this),p=w?w.length:0,X=K.rotation,m=p-1;m>=0;m--){var c=w[m],_=K[m];if(oe(_,E,X))return y.part="icons",y.name=a,y.icon=c,y.rect=_,y.index=m,y.rotation=X,y}}}if(this.isNoteVisible(z)){if(A.note2Info&&oe(A.note2Info.clickRect,E,$,A.note2Info.scale))return y.part="note2",y;if(A.noteInfo&&oe(A.noteInfo.clickRect,E,$,A.noteInfo.scale))return y.part="note",y}if(this.isLabelVisible(z)){if(A.label2Info&&oe(A.label2Info.rect,E,A.label2Info.rotation,A.label2Info.scale))return y.part="label2",y;if(A.labelInfo&&oe(A.labelInfo.rect,E,A.labelInfo.rotation,A.labelInfo.scale))return y.part="label",y}if(z.isInRect&&z.isInRect(E))return y.part="body",y}return y},getDataAt:function(Q,G,T){Q.target&&(Q=this.lp(Q));var q,K=this._zoom;return this.reverseEach(function(N){return(G?G(N):this.isSelectable(N))&&this.rectIntersects(N,Vl(Q.x,Q.y,T,K))?(q=N,!1):void 0},this),q},getIconInfoAt:function(T,H){var W=this;if(T.target&&(T=W.lp(T)),H||(H=W.getDataAt(T)),H){var B=W.getDataUI(H);if(B&&B._38o){var X,_=B._38o,u=new Od;for(X in _.icons)u.add(X);for(var Y=u.size()-1;Y>=0;Y--){X=u.get(Y);for(var v=_.rects[X],a=v.rotation,q=v.length-1;q>=0;q--){var O=v[q],D=O.width,M=O.height,p={x:T.x-O.x-D/2,y:T.y-O.y-M/2};a!=$&&(p=zn(-a,p.x,p.y));var O={x:-D/2,y:-M/2,width:D,height:M};if(oe(O,p))return{key:X,index:q,name:_.icons[X].names[q],rect:v[q],point:T,rotation:a,relativeRect:O,relativePoint:p,data:H}}}}}return $},getDatasInRect:function(y,Y,J){J===r&&(J=1);var h=this,E=new Od;return h.reverseEach(function(f){J&&!h.isSelectable(f)||(Y?h.rectIntersects(f,y):h.rectContains(f,y))&&E.add(f)}),E},moveSelection:function(l,O){var K=this;K.dm().beginTransaction(),xq(K.sm().toSelection(K.isMovable,K),l,O),K.dm().endTransaction()},moveDatas:function(I,X,M){var G=this;G.dm().beginTransaction(),I instanceof Od||(I=new Od(I)),xq(I,X,M),G.dm().endTransaction()},getDataUIBounds:function(n){var i=this.getDataUI(n);return i?i._79o():$},drawData:function(l,b,N){var K=this.getDataUI(b);if(K){var D=K._79o();(!N||Ii(N,D))&&(K._42(l),b instanceof A.Block&&b.eachChild(function(S){this.isVisible(S)&&this.drawData(l,S,N)},this))}},getBoundsForGroup:function(Y){return Y.s(cg)?this.getDataUIBounds(Y):$},isPixelPerfect:function(a){return a.s("pixelPerfect")},rectIntersects:function(o,U){this.validate();var b=$;if(this._56I[o._id]){var x=this._25I[o._id];if(x){var d=x._79o();if(hj(U,d))b=!0;else if((U=qs(U,d))&&(x.rectIntersects&&(b=x.rectIntersects(U)),b==$)){if(!this.isPixelPerfect(o))return!0;var A=U.x,V=U.y,I=U.width,q=U.height,m=this._zoom,J=u.hitMaxArea,L=I*q*m*m;if(L>J){var v=Math.sqrt(J/L);m*=v}I*=m,q*=m,2>I&&(I=2),2>q&&(q=2),A*=m,V*=m;var i=Ap(I,q);Ge(i,-A,-V),i.scale(m,m),this._drawForChecking=!0,this.drawData(i,o,U),this._drawForChecking=!1;try{for(var a=0,N=i.getImageData(0,0,I,q).data;a<N.length;a+=4)if(0!==N[a+3]){b=!0;break}i.restore()}catch(Y){bk=$,b=!1}}}}return b?!0:!1},rectContains:function(I,w){if(this._56I[I._id]){var e=this._25I[I._id];if(e)return hj(w,e._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(r){if(!u.isInput(r.target)){var U=this,f=U._focusData,Q=f&&U._25I[f._id],S=0,J=U._dataModel._datas;if(!(f&&f._enabled&&f._editable&&Q&&Q.onKeyDown&&Q.onKeyDown(r)===!0))if(9===r.keyCode&&(f&&(S=J.indexOf(f),Ng(r)?-1===--S&&(S=0):++S===J.size()&&(S=0)),U._focusData=f=J.get(S),U.sm().setSelection(f)),Qf(r)?U.selectAll():An(r)&&U.isResettable()&&U.reset(),U.sm().isEmpty()){if(U._editing)return;var o=U.tx(),G=U.ty(),q=!1,e=Ng()?100:10;$b(r)&&(o-=e,q=!0),Wc(r)&&(G-=e,q=!0),mr(r)&&(o+=e,q=!0),Td(r)&&(G+=e,q=!0),q&&U.setTranslate(o,G)}else{oc(r)&&U.handleDelete(r);var t=Ng()?10:1;$b(r)&&(U.moveSelection(-t,0),U.fi({kind:"moveLeft"})),Wc(r)&&(U.moveSelection(0,-t),U.fi({kind:"moveUp"})),mr(r)&&(U.moveSelection(t,0),U.fi({kind:"moveRight"})),Td(r)&&(U.moveSelection(0,t),U.fi({kind:"moveDown"}))}}},handleScroll:function(C,P){if(Mm(C),this.isZoomable()){if(!this.getEditInteractor()){var H=this.getDataAt(C);if(H){var d=Of(this.getImage(H));if(d&&Tp(d.scrollable,H,this))return}}var O=this.getFullscreenDatas();for(var j in O)if(O[j].s("fullscreen.lock"))return;var w=this.lp(C);P>0?this.scrollZoomIn(w):0>P&&this.scrollZoomOut(w)}},handlePinch:function(M,h,t){this.isZoomable()&&(Math.abs(h-t)<u.pinchZoomThreshold||(h>t?this.pinchZoomIn(M):this.pinchZoomOut(M)))},checkDoubleClickOnNote:function(M,E){var e=this,V=e.lp(M),U=e.getDataUI(E),T=U.note2Info;return T&&E.s("note2.toggleable")&&oe(T.clickRect,V)?(E.s(qi,!E.s(qi)),e.fi({kind:"toggleNote2",event:M,data:E}),!0):(T=U.noteInfo,T&&E.s("note.toggleable")&&oe(T.clickRect,V)?(E.s(Kg,!E.s(Kg)),e.fi({kind:"toggleNote",event:M,data:E}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(A,c){var V=this,i=V.getAutoScrollZone(),Q=i/V.getZoom(),H=i/4,B=V._29I,N=V.lp(A),X={x:V.tx(),y:V.ty()};return N&&i>0&&B&&(N.x-B.x<Q?V.translate(H,0):B.x+B.width-N.x<Q&&V.translate(-H,0),N.y-B.y<Q?V.translate(0,H):B.y+B.height-N.y<Q&&V.translate(0,-H)),X.x=V.tx()-X.x,X.y=V.ty()-X.y,c&&(c.x+=X.x,c.y+=X.y),X},getMoveMode:function(A,x){var O=x.s("2d.move.mode");return O?O:gc["88"]?"x":gc["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(O,q,M){var N=this;return"currentSubGraph"===q?{__i:O.getId()}:M.serializeProperty(O,q,N)},deserializeProperty:function(i,a,O){var K=this;if("currentSubGraph"===a){var G=K.dm(),W=G.__idMap;return W[i.__i]}return O.deserializeProperty(i,a,K)},setDefaultCursor:function(i,X){this._defaultCursor=i,X!==!1&&this.setCursor(i)},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(V){return V===$||u.getConnectAction(null,V)?(this._currentActionType=V,this.redraw(),!0):!1},getEditStyle:function(y){var f=this.getEditInteractor();return f?f.getStyle(y):r},setEditStyle:function(Z,l,T){var F=this.getEditInteractor();return F?(F.setStyle(Z,l,T),!0):!1},isConnectActionVisible:function(w){var B=u.getConnectAction(this);if(!B)return!1;var P=B.visible;return Xp(P)&&(P=P(this,w)),P},isInteractive:function(O){if(this._drawForChecking)return!1;var K=Of(this.getImage(O));return K&&Tp(K.interactive,O,this)?!0:O.s("interactive")},getRenderingStyleIconName:function(){return gh},appendHTML:function(Z,t){var o=this.getView();if(!(t||Z&&Z.parentNode!==o))return!1;var b=Z.getView&&Z.getView(),i=Z.beforeCanvas;if(!t&&b&&b.parentNode===o)return!1;(Z.getView||Z.isSelfViewEvent)&&(Z=Z.getView());var k=this.getEditInteractor();return i?o.insertBefore(Z,this.getCanvas()):k&&k._canvas?o.insertBefore(Z,k._canvas):this.isScrollBarVisible()?o.insertBefore(Z,this.getView().lastChild):$p(o,Z),!0},_layoutHTMLImpl:function(V,g,f){if(arguments.length>1){var x,e=this,k=e._zoom;if(g.getView&&(x=g,g=g.getView()),g.style.position="absolute",f){var N=V.getRect();Zg(x||g,e.tx()+N.x*k,e.ty()+N.y*k,N.width*k,N.height*k)}else{var j=new Nb,N=V.getAnchorRect(),H=V.getPosition(),n=V.getScale(),m=g.style;Zg(x||g,N),j.appendTranslate(e.tx(),e.ty()),j.appendScale(k,k),j.append(new Nb(V.getRotation(),H.x,H.y,n.x,n.y)),Ip(m,"transform","matrix("+j.a.toFixed(5)+", "+j.b.toFixed(5)+", "+j.c.toFixed(5)+",\n    "+j.d.toFixed(5)+", "+j.tx.toFixed(5)+", "+j.ty.toFixed(5)+")"),Ip(m,"transformOrigin",(-N.x).toFixed(5)+"px "+(-N.y).toFixed(5)+"px"),g.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(U){return U instanceof Df?{name:"text",accessType:"s",font:U.s("text.font"),isMultiline:!0}:void 0},getState:function(S){var h="state",A=S.s(h);if(A)return A;var e=Of(S._image);return e?Tp(e[h],S,this)||null:void 0},getShape:function(M){return M.getStyle(Rr)}}),b.defineProperties(bl.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(v){this._layoutHTML=v}}});var Lj=function(C,W){var d=this;d.gv=C,d.s=function(a){return W.getStyle(a)},d._data=W,d._87I=new Od},gh=$;bd(Lj,b,{_6I:$,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var F=this,M=F.gv.isSelected(F._data);return!M||F.isShadowed()?0:F.gv.getSelectWidth(F._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(_){var w=this._data,N=this.gv.getBodyColor(w);return N?N:_?w.getStyle(_):$},_2Q:function(k){return this.s(k)},_1Q:function(G,$,B,p){var i=this.s,j=i("2d.gray"),V=i($+".dash.color");if(j&&(V=u.toGrayColor(V)),G.strokeStyle=V,G.lineWidth=B,G.stroke(),i($+".dash.3d")){var J=i($+".dash.3d.color");$o(G,V,j?u.toGrayColor(J):J,B,this.gv._zoom,i($+".dash.3d.accuracy"))}Je(G,p)},invalidate:function(){this._6I=$},_79o:function(){var I=this;if(!I._6I){var O=I._data,D=I.gv;I.labelInfo=I.label2Info=I.noteInfo=I.note2Info=I._38o=$,I._87I.clear(),I.interactiveInfo=D.isInteractive(O)?{}:$,I._3O(),I._55O=D.isEditable(O)?{_42O:D.isRectEditable(O),_43O:D.isPointEditable(O),_56O:D.isRotationEditable(O)}:$,I._6I=I._81o()}return I._6I},_3O:function(){},getPosition:function(){return ze},_68o:function(L,p){L&&this._87I.add(Pk(L,p))},_81o:function(){var e=this,m=e.s;e._24O(Ni,"getLabel"),e._24O(Di,"getLabel2"),e._26O(sf,"getNote"),e._26O(_b,"getNote2"),e._15O(),e._55O&&e._48O();var C;if(e._87I.each(function(S){C=so(C,S)}),C&&m("shadow.interactable")){var G=e.isShadowed(),X=m("shadow2"),p=Bf(C);X?(p.x+=m("shadow2.offset.x"),p.y+=m("shadow2.offset.y"),nh(p,m("shadow2.blur"))):G&&(p.x+=m("shadow.offset.x"),p.y+=m("shadow.offset.y"),nh(p,m("shadow.blur"))),C=so(C,p)}return e._87I.clear(),C},_42:function(N){var G=this,y=G._data,_=G.gv,B=G.s,o=B("opacity"),F=this.isShadowed(),g=B("shadow2");if(F||g){var I=N.shadowOffsetX,U=N.shadowOffsetY,A=N.shadowBlur,z=N.shadowColor,Q=_.getZoom()*u.devicePixelRatio,V=F?"shadow":"shadow2";N.shadowOffsetX=B(V+".offset.x")*Q,N.shadowOffsetY=B(V+".offset.y")*Q,N.shadowBlur=B(V+".blur")*Q,N.shadowColor=F?G.getSelectColor():B(V+".color")}if(o!=$){var n=N.globalAlpha;N.globalAlpha=o}G._80o(N),_.isLabelVisible(y)&&((!_._drawForChecking||B("label.selectable"))&&Ek(N,G.labelInfo),(!_._drawForChecking||B("label2.selectable"))&&Ek(N,G.label2Info)),_.isNoteVisible(y)&&(ji(N,G.noteInfo),ji(N,G.note2Info)),G._99O(N),o!=$&&(N.globalAlpha=n),(F||g)&&(N.shadowOffsetX=I,N.shadowOffsetY=U,N.shadowBlur=A,N.shadowColor=z)},_80o:function(){},_47O:function(){},_24O:function(W,p){var K=this,q=K._data,r=K.gv,x=K.s,c=r[p](q);if(c!=$){var d=x(W+".scale"),n=x(W+".max"),u=x(W+".position"),m=K[W+"Info"]={label:c,scale:d,color:r[p+"Color"](q),font:x(W+".font"),opacity:x(W+".opacity"),align:x(W+".align"),decoration:x(W+".decoration"),rotation:K.getRotation(x(W+".rotation"),!1,u),background:r[p+"Background"](q)},I=nn(m,c);n>0&&n<I.width&&(m.labelWidth=I.width,I.width=n),1!==d&&(I.width*=d,I.height*=d);var P=K.getPosition(u,x(W+".offset.x"),x(W+".offset.y"),I,x(W+".position.fixed"));if(I.x=P.x-I.width/2,I.y=P.y-I.height/2,K._68o(m.rect=I,m.rotation),1!==d){var H=I.width/d,y=I.height/d;m.rect={x:P.x-H/2,y:P.y-y/2,width:H,height:y}}}},_26O:function(w,u){var a=this,O=a.gv,c=a._data,F=a.s,E=O[u](c);if(E!=$){var p,X,T=F(w+".scale"),I=a[w+"Info"]={note:E,scale:T,data:c,view:O,expanded:F(w+".expanded"),font:F(w+".font"),color:F(w+".color"),opacity:F(w+".opacity"),align:F(w+".align"),icon:F(w+".icon"),backgroundImage:F(w+".backgroundImage"),borderWidth:F(w+".border.width"),borderColor:F(w+".border.color"),background:O[u+"Background"](c)},Y=a.getPosition(F(w+".position"),F(w+".offset.x"),F(w+".offset.y")),z=Y.x,_=Y.y;if(I.expanded){var N,W=F(w+".max"),x=F(w+".backgroundImage");x?(x=Of(x),N={width:Hn(x,c),height:ks(x,c)}):N=nn(I,E),N.width+=6,N.height+=2,W>0&&W<N.width&&(I.labelWidth=N.width,N.width=W),p=N.width,X=N.height+8,I.clickRect={x:z-p*T/2,y:_-X*T,width:p*T,height:X*T*N.height/X}}else{var r=F(w+".icon");r?(r=Of(r),p=Hn(r,c),X=ks(r,c)):(p=12,X=18),I.clickRect={x:z-p*T/2,y:_-X*T,width:p*T,height:X*T}}I.rect={x:z-p/2,y:_-X*T/2-X/2,width:p,height:X};var P=l(I.borderWidth/2)*T;a._68o({x:z-p*T/2-P,y:_-X*T-P,width:p*T+2*P,height:X*T+2*P})}},_48O:function(){},_99O:function(w){var n=this,Z=n._38o;if(Z){var N=n.gv,b=n._data,i=Z.icons,A=n.interactiveInfo;A&&(A._38o={});for(var L in i){var t=i[L],h=Z.rects[L];if(h){A&&(A._38o[L]=[]);var B=Tp(t.opacity,b,N),c=Tp(t.names,b,N),E=c?c.length:0,d=h.rotation;if(B!=$){var u=w.globalAlpha;w.globalAlpha*=B}for(var Q=0;E>Q;Q++){var k=c[Q],H=Of(k),r=h[Q];if(d){var x=r.x+r.width/2,_=r.y+r.height/2;w.save(),Ge(w,x,_),zo(w,d),Ge(w,-x,-_)}A&&A._38o[L].push(w.interactiveInfo={compInfos:[],matrix:d?new Nb(d,x,_).appendTranslate(-x,-_):new Nb});var K=gh;gh=L,Gp(w,H,Tp(t.stretch,b,N),r.x,r.y,r.width,r.height,n._data,n.gv),gh=K,w.interactiveInfo=$,d&&w.restore()}B!=$&&(w.globalAlpha=u)}}}}});var _o=function(i,o){ud(_o,this,[i,o])};bd(_o,Lj,{_checkEmptyRect:!0,_40O:function($,r){var L=this,D=L.s,W=$.rect;($.borderColor=L.gv.getBorderColor(L._data))&&($.borderType=D("border.type"),$.borderWidth=D("border.width"),$.borderPadding=D("border.padding"),r=E(r,$.borderPadding+$.borderWidth/2));var J=L._data.getScale(),b=E(1,E(k(J.x),k(J.y)));if($.selectWidth=L.getSelectWidth()){var s=L.gv._zoom;$.selectType=D("select.type"),$._97o=L.getSelectColor(),$.selectPadding=D("select.padding"),r=E(r,($.selectPadding+$.selectWidth/2/s)/b)}r>0&&(r*=b,W=Bf(W),nh(W,r)),L._68o(W)},_39O:function(j,F){var d,f=this,p=F.rect;if(F.borderWidth>0&&(d=F.borderPadding,j.strokeStyle=F.borderColor,j.lineWidth=F.borderWidth,hi(j,F.borderType,{x:p.x-d,y:p.y-d,width:p.width+2*d,height:p.height+2*d}),j.stroke()),F.selectWidth>0){var X=f.gv._zoom;if(d=F.selectPadding,j.strokeStyle=F._97o,j.lineWidth=F.selectWidth/X,F.rotation!=$){j.save(),j.translate(F.position.x,F.position.y),j.rotate(F.rotation);var M=f._data,u=M.getWidth(),R=M.getHeight(),h=F.scale,g=F.anchor;p={x:h.x*-u*g.x,y:h.y*-R*g.y,width:h.x*u,height:h.y*R}}hi(j,F.selectType,{x:p.x-d,y:p.y-d,width:p.width+2*d,height:p.height+2*d}),F.rotation!=$&&j.restore(),j.stroke()}},dispose:function(){var k=this,i=k._htmlView;_o.superClass.dispose.call(k),i&&(i.onHTMLRemoved&&i.onHTMLRemoved(),lk(i))},_3O:function(){var h,O=this,Z=O.s,p=O._data,C=O.gv,v=C.getShape(p),X=O.getBodyColor(),j=Z("shape.border.color"),c=O._83o=v?{shape:v,_53o:O.getBodyColor("shape.background"),_27Q:Of(Z("shape.repeat.image"),X),shapeGradientPack:Z("shape.gradient.pack"),shapeBorderGradientPack:Z("shape.border.gradient.pack"),_54o:Z("shape.border.width"),_55o:j,shapeBorderRepeatImage:Of(Z("shape.border.repeat.image"),j),_56o:Z("shape.border.3d"),_57o:Z("shape.border.3d.color"),_58o:Z("shape.border.3d.accuracy"),shapeGradient:Z("shape.gradient"),_59o:Z("shape.gradient.color"),_60o:Z("shape.border.pattern"),_61o:Z("shape.border.cap"),_62o:Z("shape.border.join"),shapeForeground:Z("shape.foreground"),bodyColor:X,gray:Z("2d.gray")}:{img:Of(C.getImage(p),X),bodyColor:X,gray:Z("2d.gray"),stretch:Z("image.stretch")},I=c.img;I&&I.renderHTML?(O._htmlInfo&&O._htmlInfo.img!==I&&(O._htmlInfo=$),O._htmlInfo||(O._htmlInfo={img:I,cache:{}}),h=I.renderHTML(p,C,O._htmlInfo.cache)):O._htmlInfo=$,O._htmlView&&O._htmlView!==h&&(O._htmlView.onHTMLRemoved&&O._htmlView.onHTMLRemoved(),lk(O._htmlView.getView?O._htmlView.getView():O._htmlView)),(O._htmlView=h)&&C.appendHTML(h)&&(h.onHTMLAddedSync&&h.onHTMLAddedSync(),h.onHTMLAdded&&Qi(h.onHTMLAdded)),c.rect=p.getRect(),c.position=p.p(),c.scale=p.getScale(),c.anchor=p.getAnchor(),c.rotation=p.getRotation(),v===Ne&&(c._63o=Z("shape.depth"));var w=0;if(v)w=eb($,c._54o/2,c._62o),O.s("shape.dash")&&(w=E(w,(O.s("shape.dash.width")||c._54o)/2));else if(I&&I.boundExtend)if(w=Tp(I.boundExtend,p,C),I.boundExtendAbsolute){var s=p.getScale();w/=C._zoom*E(1,E(k(s.x),k(s.y)))}else if(!Tp(I.fitSize,p,C)){var G=Tp(I.width,p,C),y=Tp(I.height,p,C);w*=E(p.getWidth()/G,p.getHeight()/y)}O._40O(c,w);var S=Z("clip.percentage");if(S!=r&&(c.clipRect=Pc(p.getAnchorRect(),Z("clip.direction"),S)),v){var Y=Z("shape.fill.clip.percentage");Y!=r&&(c.shapeClipRect=Pc(p.getAnchorRect(),Z("shape.fill.clip.direction"),Y));var e=Z("shape.foreground.clip.percentage");e!=r&&(c.shapeForegroundClipRect=Pc(p.getAnchorRect(),Z("shape.foreground.clip.direction"),e))
}},getPosition:function(c,j,e,Y){var D=wi(c,this._83o.rect,Y);return D.x+=j,D.y+=e,D},_80o:function(p){var X=this,I=X.s,c=X.gv,z=X._data,m=X._83o,K=m.rect,k=m.position,F=m.rotation,O=m.anchor,w=m.scale,M=m.shape,a=m.clipRect;if(!X._checkEmptyRect||K.width>0&&K.height>0){var G=z.getSize();if(G.x=-G.width*O.x,G.y=-G.height*O.y,Vq&&!Zk&&Ge(p,G.width,G.height),p.save(),Ge(p,k.x,k.y),zo(p,F),Ol(p,w.x,w.y),a&&(p.beginPath(),p.rect(a.x,a.y,a.width,a.height),p.clip()),c._drawForChecking&&m.img&&Tp(m.img.pixelPerfect,z,c)===!1)Dc(p,G.x,G.y,G.width,G.height,"#888888");else if(X.freeDraw)X.freeDraw(p,G,m);else if(M){var V,Z,C,S,T=m._60o,Q=$q(p,T),h=m._27Q,Y=m._54o,W=m.shapeGradientPack,U=m.gray,H=p.lineJoin,n=p.lineCap,B=function(A){return U?u.toGrayColor(A):A};"roundRect"===M?V=I("shape.corner.radius"):"polygon"===M?(V=I("shape.polygon.side"),Z=I("shape.corner.radius"),C=I("shape.regular")):"arc"===M&&(V=I("shape.arc.from"),Z=I("shape.arc.to"),C=I("shape.arc.close"),S=I("shape.arc.oval")),p.lineJoin=m._62o,p.lineCap=m._61o;var x=B(m._53o);if(x||h||W){var g=m.shapeClipRect;g&&(p.save(),p.beginPath(),p.rect(g.x,g.y,g.width,g.height),p.clip()),hi(p,M,G,V,Z,C,S),W?kn(p,W,function(W){return Dh(W,m.bodyColor)},!1,G):h?Ah(p,h,B(m.bodyColor),null,z,c):jd(p,x,m.shapeGradient,B(m._59o),G),p.fill(),W&&p.restore(),g&&p.restore(),p!==Q&&hi(Q,M,G,V,Z,C,S)}else hi(Q,M,G,V,Z,C,S);var e=m.shapeForeground;if(e){p.save();var i=m.shapeForegroundClipRect;i&&(p.beginPath(),p.rect(i.x,i.y,i.width,i.height),p.clip()),hi(p,M,G,V,Z,C,S),jd(p,e,I("shape.foreground.gradient"),B(I("shape.foreground.gradient.color")),G),p.fill(),p.restore()}if(Y>0){var f=I("shape.border.width.absolute");f&&(p.save(),p.setTransform(1,0,0,1,0,0)),p.lineWidth=Y;var r=B(m._55o),N=m.shapeBorderGradientPack;N?kn(p,N,B,!0,G):m.shapeBorderRepeatImage?ef(p,m.shapeBorderRepeatImage,r,null,z,c):p.strokeStyle=r,p.stroke(),N&&p.restore(),f&&p.restore(),m._56o&&$o(p,r,B(m._57o),Y,c._zoom,m._58o)}if(Je(p,T),I("shape.dash")){var l=I("shape.dash.width")||Y;if(l>0){T=I("shape.dash.pattern");var Q=$q(p,T,X._2Q("shape.dash.offset"));Q!==p&&hi(Q,M,G,V,Z,C,S),X._1Q(p,"shape",l,T)}}Up(p,x,m._63o,G),p.lineJoin=H,p.lineCap=n}else{var L=X.interactiveInfo;L&&(p.interactiveInfo=L.bodyInfo={compInfos:[],matrix:new Nb(F,k.x,k.y,w.x,w.y)}),m.gray&&(p.compGray=!0);var s=m.img;s&&s.cacheRule!=$&&(s=tl(p,s,m.stretch,G.width,G.height,z,c,m.bodyColor)),Gp(p,s,m.stretch,G.x,G.y,G.width,G.height,z,c,m.bodyColor),p.compGray=!1,p.interactiveInfo=$}p.restore()}X._39O(p,m)},_48O:function(){},_47O:function(){}});var Sb=function(q,Q){ud(Sb,this,[q,Q])},zl=function($,J,j,U){var X=Kj($,J);return j=U?O(j,X):_j(j,X),X?j/=X:j=0,{x:$.x+(J.x-$.x)*j,y:$.y+(J.y-$.y)*j}};bd(Sb,Lj,{_3O:function(){var V,X=this,D=X._data,w=X.gv,h=X.s,m=h(uf),e=D.isLooped(),U=h("edge.width"),A=X.getBodyColor("edge.color"),o=h("edge.center"),Y=h("edge.offset"),M=w.getBorderColor(D),t=M?h("border.width"):0,P=X.getSelectWidth(),G=D._40I,K=D._41I,k=X._78o=G&&K?{looped:e,type:m,width:U,center:o,color:A,repeatImage:Of(h("edge.repeat.image"),A),borderColor:M,borderWidth:t,_97o:P?X.getSelectColor():$,selectWidth:P,pattern:h("edge.pattern"),cap:h("edge.cap"),join:h("edge.join"),is3d:h("edge.3d"),_67o:h("edge.3d.color"),_66o:h("edge.3d.accuracy"),gray:h("2d.gray")}:$;if(k){var R=u.getEdgeType(m);if(R){var l=R(D,Co(X,w,D,e,m),w,X._19Q);l.points&&l.points.size()>1?(k.edgeTypeInfo=l,V=Tg(k.edgeTypeInfo.points)):l[Ri]&&l.rect&&(k.edgeTypeInfo=l,V=l.rect)}else{var J=h("edge.source.anchor.x"),y=h("edge.source.anchor.y"),i=h("edge.target.anchor.x"),L=h("edge.target.anchor.y"),N=lb(w,D,"source"),d=lb(w,D,"target");if(m===no){var q=k.points=h(sp)||Cs,s=q.size();k.segments=h("edge.segments");var S=J!==r||y!==r||Sl(G),f=i!==r||L!==r||Sl(K);if(!o)if(Y)S||(N=zl(N,s?q.get(0):d,Y,s)),f||(d=zl(d,s?q.get(s-1):N,Y,s));else{var x;S||(x=Pp(N,s?q.get(0):d,Le(w,G)),x&&(N={x:x[0],y:x[1]})),f||(x=Pp(s?q.get(s-1):N,d,Le(w,K)),x&&(d={x:x[0],y:x[1]}))}V=so(Tg(k.points),Tg(N,d))}else{var n=Co(X,w,D,e,m);if(X._19Q||(n=-n),e)N=Bf(N),N.x=w.getNodeRect(G).x,k.radius=n,V={x:N.x-n,y:N.y-n,width:2*n,height:2*n};else{var Q=Kj(N,d),_=_j(Y,Q),F={x:_,y:n},I={x:Q-_,y:n},z=ys(d.y-N.y,d.x-N.x),g=k.mat=new nb(z);if(k.orienAngle=z,k.angle=d.x<N.x?z+Z:z,k.rect={x:F.x,y:F.y,width:I.x-F.x,height:0},k.origin=N,F=g.tf(F),F.x+=N.x,F.y+=N.y,I=g.tf(I),I.x+=N.x,I.y+=N.y,o){var B={x:Q,y:0};B=g.tf(B),B.x+=N.x,B.y+=N.y,V=Tg([N,F,I,B]),k.c1=N,k.c2=B}else V=Tg(F,I);N=F,d=I}}k.sourcePoint=N,k.targetPoint=d,D._lastSourcePoint=N,D._lastTargetPoint=d}var j=0;h("edge.dash")&&(j=h("edge.dash.width")||U);var O="square"===k.cap?.71:.5;eb(V,E(j*O,U*O+t+P),k.join),X._68o(V)}},getRotation:function(J,V,P){J=J||0;var I=this._78o;if(I){var Y,N=I.angle,h=I.points,x=I.edgeTypeInfo;if(N!=$)return V?I.orienAngle+J:N+J;if(x&&x[Ri])return x.getRotation?x.getRotation(this,J,V,P):0;if(x&&x.points){var n=x.points;return Y=n.size(),Qn[P]?Y&&0===Y%2?_p(n.get(Y/2-1),n.get(Y/2),V,J):J:dq[P]?_p(n.get(0),n.get(1),V,J):_p(n.get(Y-2),n.get(Y-1),V,J)}if(h)return Y=h.size(),Qn[P]?Y&&0===Y%2?_p(h.get(Y/2-1),h.get(Y/2),V,J):0===Y?_p(I.sourcePoint,I.targetPoint,V,J):J:dq[P]?_p(I.sourcePoint,Y?h.get(0):I.targetPoint,V,J):_p(Y?h.get(Y-1):I.sourcePoint,I.targetPoint,V,J)}return J},getPosition:function(i,F,X,D,o){var k=this._78o;if(k){var A,r=k.type,M=k.points,h=k.edgeTypeInfo,m=k.sourcePoint,Q=k.targetPoint;if(!r)return k.looped?{x:m.x-k.radius+F,y:m.y+X}:(o&&m&&Q&&(m.x>Q.x||m.x===Q.x&&m.y>Q.y)&&(i=Pb[i],X=-X),A=wi(i,k.rect,D),A.x+=F,A.y+=X,A=k.mat.tf(A),A.x+=k.origin.x,A.y+=k.origin.y,A);if(h&&h[Ri])return h.getPosition?h.getPosition(this,i,F,X,D,o):{x:(m.x+Q.x)/2,y:(m.y+Q.y)/2};if(M){var A,H=M.size();if(Qn[i]){if(H){var b=H%2;if(0===b)return Fe(M.get(H/2-1),M.get(H/2),i,F,X,D,o);A=M.get((H-b)/2)}else A={x:(m.x+Q.x)/2,y:(m.y+Q.y)/2};return A=wi(i,{x:A.x,y:A.y,width:0,height:0},D),A.x+=F,A.y+=X,A}return dq[i]?Fe(m,H?M.get(0):Q,i,F,X,D,o):Fe(H?M.get(H-1):m,Q,i,F,X,D,o)}if(h){var G=h.points,H=G.size();if(Qn[i]){var b=H%2;return 0===b?Fe(G.get(H/2-1),G.get(H/2),i,F,X,D,o):(A=G.get((H-b)/2),A=wi(i,{x:A.x,y:A.y,width:0,height:0},D),A.x+=F,A.y+=X,A)}return dq[i]?Fe(G.get(0),G.get(1),i,F,X,D,o):Fe(G.get(H-2),G.get(H-1),i,F,X,D,o)}}return ze},_42:function(B){this._78o&&Sb.superClass._42.call(this,B)},drawPath:function(a,e){a.beginPath();var A=e.type,U=e.points,o=e.segments,z=e.edgeTypeInfo;if(!A||U){var d=e.sourcePoint,F=d.x,k=d.y,B=e.targetPoint,u=B.x,r=B.y;if(A)if(o){var N=new Od({x:F,y:k});N.addAll(U),N.add({x:u,y:r}),gr(a,N,o)}else a.moveTo(F,k),U.each(function(f){a.lineTo(f.x,f.y)}),a.lineTo(u,r);else e.looped?a.arc(F,k,e.radius,0,g,!0):e.center?(a.moveTo(e.c1.x,e.c1.y),a.lineTo(F,k),a.lineTo(u,r),a.lineTo(e.c2.x,e.c2.y)):(a.moveTo(F,k),a.lineTo(u,r))}else z&&(z.points?gr(a,z.points,z.segments):z[Ri]&&z[Ri](a,z))},_80o:function(j){var G=this,O=G.s,y=G._78o,L=y.width,R=y.selectWidth,Q=y.borderWidth,v=y.repeatImage,V=j.lineJoin,_=j.lineCap,Y=y.gray,x=y.pattern;j.lineJoin=y.join,j.lineCap=y.cap,G.drawPath($q(j,x),y);var A=O("edge.width.absolute");A&&(j.save(),j.setTransform(1,0,0,1,0,0)),R&&(j.strokeStyle=y._97o,j.lineWidth=L+2*(Q+R),j.stroke()),Q&&(j.strokeStyle=Y?u.toGrayColor(y.borderColor):y.borderColor,j.lineWidth=L+2*Q,j.stroke());var C=Y?u.toGrayColor(y.color):y.color;if(v?ef(j,v,C,null,G._data,G.gv):j.strokeStyle=C,j.lineWidth=L,j.stroke(),y.is3d){var X=Y?u.toGrayColor(y._67o):y._67o;$o(j,C,X,L,G.gv._zoom,y._66o)}if(Je(j,x),O("edge.dash")){x=O("edge.dash.pattern");var M=$q(j,x,G._2Q("edge.dash.offset"));M!==j&&G.drawPath(M,y),G._1Q(j,"edge",O("edge.dash.width")||L,x)}A&&j.restore(),j.lineJoin=V,j.lineCap=_},_48O:function(){},_47O:function(){}});var Nd=function(C,k){ud(Nd,this,[C,k])};bd(Nd,_o,{_3O:function(){var G,t,y=this,B=y.s,m=y._data,W=y.gv;if(y._88I=$,m.isExpanded()&&m.eachChild(function($){if(Dk($)){var F=W.getBoundsForGroup($);F&&(t||(t=[]),t.push(F),G=so(G,F))}}),G){var K=W.getLabel(m),U=B("group.type"),F=B("group.border.width")||0,O=B("group.border.width.absolute"),k=F/2;O&&(F/=W._zoom),G=Jj(U,t,G),Hj(G,m,"group.padding",1),nh(G,F);var N=y._88I={type:U,rect:G,_64o:G};if(!U&&K!=$){var v,S=y.labelInfo={label:K,color:B("group.title.color"),font:B("group.title.font"),align:B("group.title.align")},f=nn(S,K),L=f.width+F,D=f.height+F,H=B("group.title.align"),M=B("group.title.orientation");if(M===Yd||M===gg?(G.height+=F,L>G.width&&(G.width=L)):(M===sl||M===vp)&&(G.width+=F,L>G.height&&(G.height=L)),v=H===sl?G.x:H===vp?G.x+G.width-L:G.x+G.width/2-L/2,M===gg)N.titleRect={x:G.x,y:G.y+G.height,width:G.width,height:D},N.rect={x:G.x,y:G.y,width:G.width,height:G.height+D},S.rect={x:v,y:G.y+G.height,width:L,height:D};else if(M===sl){var Z=N.titleRect={x:G.x-D,y:G.y,width:D,height:G.height};N.rect={x:G.x-D,y:G.y,width:G.width+D,height:G.height},S.rect={x:Z.x+D/2-G.height/2,y:Z.y+G.height/2-D/2,width:G.height,height:D},S.rotation=-Math.PI/2}else if(M===vp){var Z=N.titleRect={x:G.x+G.width,y:G.y,width:D,height:G.height};N.rect={x:G.x,y:G.y,width:G.width+D,height:G.height},S.rect={x:Z.x+D/2-G.height/2,y:Z.y+G.height/2-D/2,width:G.height,height:D},S.rotation=Math.PI/2}else N.titleRect={x:G.x,y:G.y-D,width:G.width,height:D},N.rect={x:G.x,y:G.y-D,width:G.width,height:G.height+D},S.rect={x:v,y:G.y-D-k,width:L,height:D+F}}y._40O(N,B("group.border.width")/2)}else Nd.superClass._3O.call(y)},getPosition:function(T,U,e,E){var A=this._88I;if(A){var W=wi(T,A.rect,E);return W.x+=U,W.y+=e,W}return Nd.superClass.getPosition.apply(this,arguments)},_24O:function(R,e){var n=this._88I;(!n||n.type||"label2"===R)&&Nd.superClass._24O.call(this,R,e)},_80o:function(x){var f=this,d=f._88I;if(d){var U=f._data,t=f.s,O=f.gv,$=d.type,J=d.rect,z=d._64o,w=d.titleRect,c=f.getBodyColor(),y=Of(t("group.image"),c),q=t("group.image.stretch"),M=f.getBodyColor("group.background"),L=Of(t("group.repeat.image"),c),K=t("group.gradient.pack"),p=t("group.gradient"),s=t("group.gradient.color"),A=t("group.border.width"),X=t("group.border.color"),a=t("group.border.pattern"),h=t("group.title.orientation"),P=t("group.depth"),u=t("group.border.radius"),T=t("group.border.join"),g=t("group.border.cap"),r=t("group.border.width.absolute");r&&(A/=O._zoom);var k=X,Z=t("group.border.repeat.image");if(Z&&(Z=Of(Z,X))&&(k=mq(x,Z,X,null,U,O)),$){var V=x.lineJoin,o=x.lineCap;if(x.lineJoin=T,x.lineCap=g,y){if(x.save(),hi(x,$,J,u),x.clip(),Gp(x,y,q,J.x,J.y,J.width,J.height,U,O,c),x.restore(),A>0){var Q=$q(x,a);hi(Q,$,J,u),x.lineWidth=A,x.strokeStyle=k,x.stroke(),Je(x,a)}}else{var Q=$q(x,a);M||L||K?(hi(x,$,J,u),K?kn(x,K,function(u){return Dh(u,c)},!1,J):L?Ah(x,L,c,null,U,O):jd(x,M,p,s,J),x.fill(),K&&x.restore(),x!==Q&&hi(Q,$,J,u)):hi(Q,$,J,u),A>0&&(x.lineWidth=A,x.strokeStyle=k,x.stroke()),Je(x,a),$===Ne&&Up(x,M,P,J)}x.lineJoin=V,x.lineCap=o}else{var e=t("group.title.background");if((!u||0>u)&&(u=0),y)Gp(x,y,q,z.x,z.y,z.width,z.height,U,O,f.getBodyColor());else if(M||L)if(L?Ah(x,L,c,null,U,O):jd(x,M,p,s,z),0===A)hi(x,Ne,z),x.fill(),Up(x,M,P,z);else{switch(x.beginPath(),h){case gg:Fo(x,z.x,z.y,z.width,z.height,u,u,0,0);break;case sl:Fo(x,z.x,z.y,z.width,z.height,0,u,0,u);break;case vp:Fo(x,z.x,z.y,z.width,z.height,u,0,u,0);break;case Yd:Fo(x,z.x,z.y,z.width,z.height,0,0,u,u)}x.fill()}if(w&&e)if(0===A)Dc(x,w.x,w.y,w.width,w.height,e),Up(x,e,P,w);else{switch(x.beginPath(),x.fillStyle=e,h){case gg:Fo(x,w.x,w.y,w.width,w.height,0,0,u,u);break;case sl:Fo(x,w.x,w.y,w.width,w.height,u,0,u,0);break;case vp:Fo(x,w.x,w.y,w.width,w.height,0,u,0,u);break;case Yd:Fo(x,w.x,w.y,w.width,w.height,u,u,0,0)}x.fill()}if(A>0){var Q=$q(x,a);if(hi(Q,"roundRect",J,u),x.save(),x.lineWidth=A,x.strokeStyle=k,x.lineJoin=T,x.lineCap=g,x.closePath(),x.stroke(),w&&t("group.splitLine")){var R=w.x,C=w.y,j=w.width,v=w.height;x.beginPath(),h===gg?(x.moveTo(R,C),x.lineTo(R+j,C)):h===sl?(x.moveTo(R+j,C),x.lineTo(R+j,C+v)):h===vp?(x.moveTo(R,C),x.lineTo(R,C+v)):(x.moveTo(R,C+v),x.lineTo(R+j,C+v))}x.stroke(),x.restore(),Je(Q,a)}}f._39O(x,d)}else Nd.superClass._80o.call(f,x)}});var jg=function(e,P){ud(jg,this,[e,P])};bd(jg,_o,{_80o:function(X){this._39O(X,this._83o)}});var Bo=function(e,A){ud(Bo,this,[e,A])};bd(Bo,_o,{_3O:function(){var b=this,T=b._data,w=b.s,h=b.gv,R=T.getPoints(),x=h.getBorderColor(T),O=x?w("border.width"):0,D=b.getSelectWidth(),z=w("shape.border.width"),a=T.getRect(),Y=T.getAnchorRect(),B=h.getBodyColor(T),u=w("shape.border.color"),V=b._99o=R.isEmpty()?$:{rect:a,rotation:T.getRotation(),fillRule:w("shape.fill.rule"),scale:T.getScale(),position:T.p(),points:R,segments:T.getSegments(),bodyColor:B,borderColor:x,borderWidth:O,_94o:w("shape.border.3d"),_95o:w("shape.border.3d.color"),_96o:w("shape.border.3d.accuracy"),_97o:D?b.getSelectColor():$,selectWidth:D,_53o:w("shape.background"),_27Q:Of(w("shape.repeat.image"),B),shapeGradientPack:w("shape.gradient.pack"),shapeBorderGradientPack:w("shape.border.gradient.pack"),_54o:z,_55o:u,shapeBorderRepeatImage:Of(w("shape.border.repeat.image"),u),shapeGradient:w("shape.gradient"),_59o:w("shape.gradient.color"),_60o:w("shape.border.pattern"),_61o:w("shape.border.cap"),_62o:w("shape.border.join"),shapeForeground:w("shape.foreground"),gray:w("2d.gray")};if(V){Y.x+=V.position.x,Y.y+=V.position.y,V.gradientRect=Y;var H=T.getScale(),n=E(1,E(k(H.x),k(H.y)));w("shape.dash")&&w("shape.dash.width")>z&&(z=w("shape.dash.width"));var W,U=w("shape.border.width.absolute");W=U?(z+O+D)/b.gv._zoom/n:z*("square"===V._61o?.71:.5)+O+D/b.gv._zoom/n,W&&(W*=n,a=Bf(a),eb(a,W,V._62o)),b._68o(a);var o=w("clip.percentage");o!=r&&(V.clipRect=Pc(T.getAnchorRect(),w("clip.direction"),o));var y=w("shape.fill.clip.percentage");y!=r&&(V.shapeClipRect=Pc(T.getAnchorRect(),w("shape.fill.clip.direction"),y));var X=w("shape.foreground.clip.percentage");X!=r&&(V.shapeForegroundClipRect=Pc(T.getAnchorRect(),w("shape.foreground.clip.direction"),X))}},getPosition:function(x,e,C,b){var w=this._99o;if(w){var J=wi(x,w.rect,b);return J.x+=e,J.y+=C,J}return ze},_42:function(D){this._99o&&Bo.superClass._42.call(this,D)},_80o:function(K){var f,R=this,W=R.s,h=R._99o,r=h.position,z=h.scale,v=h.rotation,H=h.borderWidth,g=R.gv._zoom,V=h.selectWidth/g,o=h._27Q,B=h.shapeGradientPack,p=h._54o,M=h.clipRect,U=h.shapeClipRect,e=h.points,T=h.segments,$=R._data.isClosePath(),i=h.fillRule,C=h.gray,J=function(X){return C?u.toGrayColor(X):X},S=J(h._53o),_=S||o||B;K.save(),Ge(K,r.x,r.y),zo(K,v),Ol(K,z.x,z.y),M&&(K.beginPath(),K.rect(M.x,M.y,M.width,M.height),K.clip()),_&&U&&(K.save(),K.beginPath(),K.rect(U.x,U.y,U.width,U.height),K.clip()),A.Default.extractShapeTranslation?(e=Bf(e),e.forEach(function(e){e.x-=r.x,e.y-=r.y})):Ge(K,-r.x,-r.y);var L=W("shape.border.width.absolute"),X=h._60o;L&&X&&(X=X.map(function(s){return s*g}));var O=$q(K,X),k=K.lineJoin,I=K.lineCap;K.lineJoin=h._62o,K.lineCap=h._61o;var E=J(h.bodyColor);_?(gr(K,e,T,$),B?kn(K,B,function(N){return Dh(N,h.bodyColor)},!1,h.rect):o?Ah(K,o,E,null,R._data,R.gv):(f=E?E:S,jd(K,f,h.shapeGradient,J(h._59o),h.gradientRect)),K.fill(i),B&&K.restore(),U&&(K.restore(),Ge(K,-r.x,-r.y)),O!==K&&gr(O,e,T,$)):gr(O,e,T,$);var N=h.shapeForeground;if(N){K.save();var q=h.shapeForegroundClipRect;q&&(Ge(K,r.x,r.y),K.beginPath(),K.rect(q.x,q.y,q.width,q.height),K.clip(),Ge(K,-r.x,-r.y)),gr(K,e,T,$),jd(K,N,W("shape.foreground.gradient"),J(W("shape.foreground.gradient.color")),h.gradientRect),K.fill(i),K.restore()}if(L&&(K.save(),K.setTransform(1,0,0,1,0,0)),V&&(K.strokeStyle=h._97o,K.lineWidth=p+2*(H+V),K.stroke()),H&&(K.strokeStyle=J(h.borderColor),K.lineWidth=p+2*H,K.stroke()),p){f=J(h._55o);var j=h.shapeBorderGradientPack;j?kn(K,j,J,!0,h.rect):h.shapeBorderRepeatImage?ef(K,h.shapeBorderRepeatImage,f,null,R._data,R.gv):(!S&&E&&(f=E),K.strokeStyle=f),K.lineWidth=p,K.stroke(),j&&K.restore(),h._94o&&$o(K,f,J(h._95o),p,g,h._96o)}if(Je(K,X),W("shape.dash")){var G=W("shape.dash.width")||p;if(G>0){X=W("shape.dash.pattern"),L&&(X=X.map(function(D){return D*g}));var O=$q(K,X,R._2Q("shape.dash.offset"));O!==K&&gr(O,e,T,$),R._1Q(K,"shape",G,X)}}L&&K.restore(),K.lineJoin=k,K.lineCap=I,K.restore()},_48O:function(){},_47O:function(){}});var fj=function(n,L){ud(fj,this,[n,L])};bd(fj,Bo,{getRotation:function(){var C=new Ho,E=new Ho,f=new Nb;return function(k,a,P){k=k||0;var t=this._data,i=t.getPoints(),g=i.size();if(g>1){var I,q,h=t.p(),G=t.getScale();if(f.identity().translate(-h.x,-h.y).scale(G.x,G.y).translate(h.x,h.y),Qn[P]){var w=g%2,U=(g-w)/2;I=i.get(U-1),q=i.get(U)}else dq[P]?(I=i.get(0),q=i.get(1)):(I=i.get(g-2),q=i.get(g-1));return f.apply(I,C),f.apply(q,E),_p(C,E,a,k)}return k}}(),getPosition:function(){var o=new Ho,Z=new Ho,i=new Ho;return function(c,Y,Q,L,P){var $=this._data,y=$.getPoints(),m=y.size();if(m>1){var x,q,z=$.getPointsMatrix2d();if(Qn[c]){var K=m%2,R=(m-K)/2;if(x=y.get(R-1),q=y.get(R),0!==K){var l=wi(c,ze,L);return l.x+=Y,l.y+=Q,z.apply(x,o),z.apply(q,Z),z.identity().rotate(i.copy(Z).sub(o).angle()).tf(l).add(Z)}}else dq[c]?(x=y.get(0),q=y.get(1)):(x=y.get(m-2),q=y.get(m-1));return z.apply(x,o),z.apply(q,Z),Fe(o,Z,c,Y,Q,L,P)}return ze}}()});var cb=function(x,M){ud(cb,this,[x,M])};bd(cb,_o,{_3O:function(){var w=this;cb.superClass._3O.call(w);var T=w.s,N=w._83o;w._82o=N.img||N.shape?$:{background:w.getBodyColor("grid.background"),depth:T("grid.depth"),rect:N.rect,_88o:T("grid.cell.depth"),cellBorderColor:T("grid.cell.border.color"),_89o:T("grid.row.count"),_90o:T("grid.column.count"),block:T("grid.block"),_91o:T("grid.block.color"),_92o:T("grid.block.padding"),_93o:T("grid.block.width")}},_80o:function(P){var z=this,G=z._82o;if(!G)return cb.superClass._80o.call(z,P),void 0;var x,_,k=z._data,f=G.background,W=G.rect,S=G.block,I=G._91o,R=G._92o,s=G._93o,M=G._88o,g=G.cellBorderColor,B=G._89o,J=G._90o;if(f)if(Dc(P,W.x,W.y,W.width,W.height,f),Up(P,f,G.depth,W),M)for(x=0;B>x;x++)for(_=0;J>_;_++)W=k.getCellRect(x,_),W&&Up(P,f,M,W);else if(g){for(P.beginPath(),x=0;B>x;x++)for(_=0;J>_;_++)W=k.getCellRect(x,_),W&&P.rect(W.x,W.y,W.width,W.height);P.strokeStyle=g,P.lineWidth=1,P.stroke()}if("h"===S)for(x=0;B>x;x++)W=so(k.getCellRect(x,0),k.getCellRect(x,J-1)),nh(W,R),cc(P,I,W.x,W.y,W.width,W.height,s);else if("v"===S)for(_=0;J>_;_++)W=so(k.getCellRect(0,_),k.getCellRect(B-1,_)),nh(W,R),cc(P,I,W.x,W.y,W.width,W.height,s);z._39O(P,z._83o)}});var af=function(r,o){ud(af,this,[r,o])},Ub=G?qc().getContext("2d"):$;bd(af,_o,{_checkEmptyRect:!1,_81o:function(){var V=this._data,p=af.superClass._81o.call(this),J=V.s("text");if(J!=$){J+="";var s,u=V.s("text.font"),r=V.s("text.align"),G=V.s("text.vAlign"),Z=V.s("text.wrap"),k=V.s("text.vertical"),a=V.s("text.vertical.gap"),K=V.s("text.letter.gap")||0,l=V.getWidth(),S=V.getHeight();if(null==a&&(a=1),k){var R;R=Z?bn(J,S,u,K,k,a):[J];var j=(R.length-1)*K,f=0;Ub.textBaseline=Yd,Ub.font=u,R.forEach(function(G){for(var T=G.length,$=0,M=(T-1)*a,r=0;T>r;r++){var W=Ub.measureText(G[r]);M+=W.fontBoundingBoxDescent||bq(u,G[r]).height,$=E($,W.width)}j+=$,f=E(M,f)});var X=(R.length-1)*K;R.forEach(function(m){X+=m}),s={width:j,height:f}}else{var R=Z?bn(J,l,u,K,k,a):J.split("\n"),M=R.length;if(M>1){var A=bq(u,J).height,j=0,f=A*M+a*(M-1);R.forEach(function(s){j=E(j,bq(u,s).width)}),s={width:j,height:f}}else s=bq(u,J),K&&(s.width+=(J.length-1)*K)}var O,C,W=s.width,N=s.height,B=V.getAnchor();"left"===r?O=-l*B.x:"center"===r?O=-l*B.x+(l-W)/2:"right"===r&&(O=l*(1-B.x)-s.width),"top"===G?C=-S*B.y:"middle"===G?C=-S*B.y+(S-N)/2:"bottom"===G&&(C=S*(1-B.y)-s.height);var o,e=V.getMatrix();if(o=Tg([e.tf(O,C),e.tf(O+W,C),e.tf(O+W,C+N),e.tf(O,C+N)]),p=so(p,o),p&&V.s("text.shadow")){var n=Bf(p);n.x+=V.s("text.shadow.offset.x"),n.y+=V.s("text.shadow.offset.y"),nh(n,V.s("text.shadow.blur")),p=so(p,n)}}return p}});var hp=bl.Interactor=function(k){this.gv=this._graphView=k};Yr("Interactor",b,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(Z){this.gv.fi(Z)},setCursor:function(j){Ze||this.gv.setCursor(j)},startDragging:function(w){var f=this;f._lastClientPoint=dj(w),f._lastLogicalPoint=f.gv.lp(w),ec(f,w)},clearDragging:function(){var b=this;b._lastClientPoint=b._lastLogicalPoint=b._logicalPoint=$},autoScroll:function(k){return this.gv.autoScroll(k,this._lastClientPoint)}});var ag=$,ff=function(V){ag.handleWindowTouchMove(V)},Wm=function(M){ag.handleWindowTouchEnd(M),I(C,sn,ff),I(C,Po,Wm),ag=$},Lr=function(r){ag.handleWindowMouseMove(r)},il=function(q){ag.handleWindowMouseUp(q),I(C,Uk,Lr),I(C,Tm,il),ag=$},dp=function(R,y){if(R!==ag){var i=hk(y);ag?i?ag.handleWindowTouchEnd(y):ag.handleWindowMouseUp(y):i?(f(C,sn,ff),f(C,Po,Wm)):(f(C,Uk,Lr),f(C,Tm,il)),ag=R}},Wh=function(v){var Y=this;Y.gv=v,Y._is2d=v instanceof bl.GraphView,Y._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",Be,"wheel"].forEach(function(z){Y.addListener(z)}),Y.initImageResource()};bd(Wh,hp,{enableVR:function(T){var j=this;!!j._vrEnable!==T&&(j._vrEnable=T,T?j.gv.vr.mp(j.onVRControllerChange,j):j.gv.vr.ump(j.onVRControllerChange,j))},onVRControllerChange:function(h){var s=this,L=h.property,X=h.newValue,M=X.id,K=s.gv.vr.getController(M),e=K.getRay();if(e){e.controllerId=M;var y=s.gv.vr.getRayEventType(e,L,X._62O);switch(y){case"down":s.handle_mousedown(e);break;case"up":ag&&il(e);break;case"move":s.handle_mousemove(e),ag&&s.handleWindowMouseMove(e)}}},setPreventEventDefault:function(z,p){var w=this,o=w._eventListeners[z];o?o._prevent=p:w._eventListeners[z]=o={_removal:r,_prevent:p}},removeListener:function(v){var X=this,k=X._eventListeners[v];k&&k._removal&&(k._removal(),k._removal=r)},addListener:function(P){var J=this,E=J._eventListeners[P];if(E||(J._eventListeners[P]=E={_removal:r,_prevent:!0}),!E||!E._removal){var $=function(g){E._prevent&&u.preventDefault(g),J.disabled||J.gv._48Q||("wheel"===P?Ko(J,g):J["handle_"+P](g))};f(J.gv.getView(),P,$),E._removal=function(){I(J.gv.getView(),P,$)}}},handleWindowTouchMove:function(p){this.handleWindowMouseMove(p)},handleWindowMouseMove:function(V){return!this.downInfo||hk(V)&&1!==ge(V)?(this.isDragging&&(this.handleDownInfo("onEndDrag",V),this.isDragging=!1),void 0):(this.isDragging?this.handleDownInfo("onDrag",V):(this.handleDownInfo("onBeginDrag",V),this.isDragging=!0),void 0)},handleWindowTouchEnd:function(J){this.handleWindowMouseUp(J)},handleWindowMouseUp:function(C){if(this.isDragging&&(this.handleDownInfo("onEndDrag",C),this.isDragging=!1),this.downInfo){var f=this.handle("onUp",C);if(f&&f.data===this.downInfo.data){this.handleMissingUp(C);var z=this,U=2===C.button?"onContextMenu":"onClick";if(!z._dbclickTimer)return z._dbclickTimer=Kb(function(){delete z._dbclickTimer,z.handleClick(C,U,f),this.downInfo=$},u.clickDelay),void 0;Xi(z._dbclickTimer),delete z._dbclickTimer,U="onDoubleClick",z.handleClick(C,U,f)}else this.handleDownInfo("onUp",C);this.downInfo=$,this.downComps=$}},handle_mouseleave:function(Y){var o=this,z=o.gv;o._hoverTimer&&(Xi(o._hoverTimer),delete o._hoverTimer);var h=o.currentInfo?o.currentInfo.data:$;if(h){h.s("onLeave")&&h.s("onLeave")(Y,h,z),o.fire("data","onLeave",Y,h);var O=o.currentInfo?o.currentInfo.hits:$;if(O)for(var A in O)o.handleLeave(Y,A);o.currentInfo=$}},handle_mousewheel:function(B){B.scrollDelta=B.wheelDelta/40,this.handle("onScroll",B)},handle_DOMMouseScroll:function(y){y.scrollDelta=2===y.axis?-y.detail:0,this.handle("onScroll",y)},handle_touchstart:function(q){this.handle_mousedown(q)},handle_touchmove:function(_){this.handle("onMove",_)},handle_mousedown:function(P){this.isDragging&&(this.handleDownInfo("onEndDrag",P),this.isDragging=!1),this.downComps=[],this.downInfo=this.handle("onDown",P),this.downInfo&&dp(this,P)},handle_mousemove:function(F){var v=this,f=v.gv;if(v._hoverTimer&&(Xi(v._hoverTimer),delete v._hoverTimer),!f._panning&&!f._moving){var L,t,h,y=v.handle("onMove",F),g=this.currentInfo?this.currentInfo.data:$,M=this.currentInfo?this.currentInfo.hits:$;if(y&&(t=y.data,h=y.hits,v._hoverTimer=Kb(function(){Xi(v._hoverTimer),delete v._hoverTimer,v.handle("onHover",F,y)},f.getHoverDelay()||u.hoverDelay)),t!==g){if(g&&(g.s("onLeave")&&g.s("onLeave")(F,g,f),this.fire("data","onLeave",F,g)),t&&(t.s("onEnter")&&t.s("onEnter")(F,t,f),this.fire("data","onEnter",F,t)),M)for(L in M)this.handleLeave(F,L);if(h)for(L in h){var k=h[L],B=t._interactPrefix=k.prefix,r=B&&t.a(B+"onEnter")||k.target.onEnter;r&&r.call(k.target,F,t,f,k.point,k.width,k.height),this.fire(k.type,"onEnter",k.event,k.data,k.image,k.comp,k.point,k),t._interactPrefix=null}}else{if(M)for(L in M)h&&h[L]||this.handleLeave(F,L);if(h)for(L in h)if(!M||!M[L]){var k=h[L],B=t._interactPrefix=k.prefix,r=B&&t.a(B+"onEnter")||k.target.onEnter;r&&r.call(k.target,F,t,f,k.point,k.width,k.height),this.fire(k.type,"onEnter",k.event,k.data,k.image,k.comp,k.point,k),t._interactPrefix=null}}this.currentInfo=y}},handle:function(W,r,V){var v,E=this,J=E.gv;if(E._is2d){if(V=V||J.getDataInfoAt(r),!V||!J.isInteractive(V.data))return;if(v=V.ui.interactiveInfo){var g,X=V.data;if(X.s(W)&&X.s(W)(r,X,J),this.fire("data",W,r,X),"body"===V.part&&v.bodyInfo)g="body",V.hits=this.handleImage(g,J.getImage(X),W,r,X,V.point,v.bodyInfo);else if("icons"===V.part&&v._38o){var K=v._38o[V.name];K&&K[V.index]&&(g="icons|"+V.name+"|"+V.index,V.hits=this.handleImage(g,V.icon,W,r,X,V.point,K[V.index]))}}return V}var X,B;if(!V)if(r&&r instanceof A.Math.Ray&&J.isVREnabled()){var t=J.vr.intersectWorld(r);if(X=t.data,B=t.intersect,J.vr.renderRayDuringInteraction(r,X,B),!X)return;var F=J.getData3dUI(X);if(v=F.interactiveInfo,!v)return;V={data:X,part:B.part,ui:F}}else{if(V=this.getDataInfoAt(r),!V)return;V&&(V={data:V.data,part:V.part})}if(J.isInteractive(V.data)){if(!B){X=V.data;var F=J.getData3dUI(X);if(V.ui=F,v=F.interactiveInfo,!v)return V;if(B=J.intersectObject(r,X),!B)return V}X.s(W)&&X.s(W)(r,X,J),this.fire("data",W,r,X);var Z,G=B.part;return"body"!==G&&(Z=X.s(G+".image")||X.s("shape3d."+G+".image")),Z||(Z=X.s("all.image")||X.s("shape3d.image")),Z?(v="object"==typeof Z?v[Z.uuid]:v[Z],v&&v.bodyInfo?(V.part="body",V.interactiveInfo=v,V.point=this._convertUVToPoint(B.uv,v),V.image=Z,V.hits=this.handleImage("body",Z,W,r,X,V.point,v.bodyInfo),V):V):V}},_handleLeaveOrMissing:function(L,V,b){var r="leave"===L?this.currentInfo:this.downInfo;if(r){var t=r.interactiveInfo||r.ui.interactiveInfo;if(t){var J,W,f=r.data;if(this._is2d){if(W=this.gv.lp(V),"body"===r.part&&t.bodyInfo)J="body","leave"===L?this.handleLeaveImage(b,J,this.gv.getImage(f),V,f,W,t.bodyInfo):this.handleMissingUpImage(J,this.gv.getImage(f),V,f,W,t.bodyInfo);else if("icons"===r.part&&t._38o){var j=t._38o[r.name];j&&j[r.index]&&(J="icons|"+r.name+"|"+r.index,"leave"===L?this.handleLeaveImage(b,J,r.icon,V,f,W,j[r.index]):this.handleMissingUpImage(J,r.icon,V,f,W,j[r.index]))}}else{if(!t.bodyInfo)return;var P=this.gv.intersectObject(V,f);W=P&&P.uv?this._convertUVToPoint(P.uv,t):{x:1/0,y:1/0},"leave"===L?this.handleLeaveImage(b,"body",r.image,V,f,W,t.bodyInfo):this.handleMissingUpImage("body",r.image,V,f,W,t.bodyInfo)}}}},handleClick:function(i,P,V){var e=this,Y=this.downInfo;if(Y&&V){var m,D=V.interactiveInfo||V.ui.interactiveInfo,I=V.data,$=this.gv;if(I.s(P)&&I.s(P)(i,I,$),e.fire("data",P,i,I),D)if(this._is2d){if(Y.part===V.part){var g=$.lp(i);"body"===V.part&&D.bodyInfo&&(m="body",this.handleClickImage(m,$.getImage(I),P,i,I,g,D.bodyInfo,V))}}else{if(!D.bodyInfo)return;var z=$.intersectObject(i,I);if(!z)return;g=this._convertUVToPoint(z.uv,D),this.handleClickImage("body",Y.image,P,i,I,g,D.bodyInfo,V)}}},handleDownInfo:function(q,w){if(this.downInfo){var U=this.downInfo,a=this.gv,j=U.interactiveInfo||U.ui.interactiveInfo;if(j){var T,k=U.data;if(k.s(q)&&k.s(q)(w,k,a),this.fire("data",q,w,k),this._is2d){var J=a.lp(w);if("body"===U.part&&j.bodyInfo)T="body",this.handleDownInfoImage(T,a.getImage(k),q,w,k,J,j.bodyInfo);else if("icons"===U.part&&j._38o){var n=j._38o[U.name];n&&n[U.index]&&(T="icons|"+U.name+"|"+U.index,this.handleDownInfoImage(T,U.icon,q,w,k,J,n[U.index]))}}else{if(!j.bodyInfo)return;var M;if("onBeginDrag"===q?(M=a._raycaster.intersectObjectAndRecordTriangle(w,k),M&&(j.beginDragIntersectInfo=M.triangleInfo)):M=a.intersectObject(w,k),!M&&("onDrag"!==q&&"onEndDrag"!==q||!j.beginDragIntersectInfo||(M=a._raycaster.intersectLastTriangle(w,j.beginDragIntersectInfo)),!M))return;J=this._convertUVToPoint(M.uv,j),this.handleDownInfoImage("body",U.image,q,w,k,J,j.bodyInfo)}}}},fire:function(O,Q,c,s,U,T,X,t){this.gv.fi({kind:Q,type:O,event:c,data:s,image:U,comp:T,view:this.gv,point:X,width:t?t.width:r,height:t?t.height:r})},handleImage:function(Z,N,d,z,R,y,B){var o={};if(N&&(N=Of(N))){var K=this.gv,p=B.rect,l=this.convertPoint(y,B);l.inRect&&(N[d]&&N[d](z,R,K,l,p.width,p.height),this.fire("image",d,z,R,N,r,l,p),o[Z+"|image"]={target:N,type:"image",image:N,data:R,event:z,point:l,width:p.width,height:p.height});for(var n,W=B.compInfos,L=N,H=W.length-1;H>=0;H--){var k=W[H],f=k.comp;if(l=this.convertPoint(y,k,L,f,K,R),l.inRect){p=k.rect;var O=R._interactPrefix=k.prefix,u=O&&R.a(O+d)||f[d];if(u&&(n=u.call(f,z,R,K,l,p.width,p.height)),this.fire("comp",d,z,R,N,f,l,p),n!==!0&&(N=p.image)&&(N[d]&&(n=N[d](z,R,K,l,p.width,p.height)),this.fire("image",d,z,R,N,r,l,p)),R._interactPrefix=null,o[Z+"|"+H]={target:f,type:"comp",comp:f,image:N,data:R,event:z,point:l,width:p.width,height:p.height,prefix:O},this.downComps&&this.downComps.push(f),N&&(o[Z+"|"+H+"|image"]={target:N,type:"image",image:N,data:R,event:z,point:l,width:p.width,height:p.height,prefix:O}),n===!0)break}}}return o},handleLeave:function(y,R){return this._handleLeaveOrMissing("leave",y,R)},handleMissingUp:function(Z){return this._handleLeaveOrMissing("missing",Z)},handleLeaveImage:function(k,I,f,B,s,a,u){if(f&&(f=Of(f))){var d=this.gv,Y=u.rect,j=this.convertPoint(a,u);k===I+"|image"&&(f.onLeave&&f.onLeave(B,s,d,j,Y.width,Y.height),this.fire("image","onLeave",B,s,f,r,j,Y));for(var e,Q=u.compInfos,h=f,i=Q.length-1;i>=0;i--){var G=Q[i],Z=G.comp;j=this.convertPoint(a,G,h,Z,d,s),Y=G.rect;var R=s._interactPrefix=G.prefix;if(k===I+"|"+i){var o=R&&s.a(R+"onLeave")||Z.onLeave;o&&(e=o.call(Z,B,s,d,j,Y.width,Y.height)),this.fire("comp","onLeave",B,s,f,Z,j,Y)}if(e!==!0&&(f=Y.image)&&k===I+"|"+i+"|image"&&(f.onLeave&&(e=f.onLeave(B,s,d,j,Y.width,Y.height)),this.fire("image","onLeave",B,s,f,r,j,Y)),s._interactPrefix=null,e===!0)break}}},handleMissingUpImage:function(h,V,n,q,b,x){var g="onUp",I=this.downInfo.hits;if(I&&V&&(V=Of(V))){var m=this.gv,K=x.rect,N=this.convertPoint(b,x);!N.inRect&&I[h+"|image"]&&(V[g]&&V[g](n,q,m,N,K.width,K.height),this.fire("image",g,n,q,V,r,N,K));for(var D,d=x.compInfos,a=V,E=d.length-1;E>=0;E--){var M=d[E],T=M.comp;if(N=this.convertPoint(b,M,a,T,m,q),!N.inRect){K=M.rect;var Q=q._interactPrefix=M.prefix;if(I[h+"|"+E]){var i=Q&&q.a(Q+g)||T[g];i&&(D=i.call(T,n,q,m,N,K.width,K.height)),this.fire("comp",g,n,q,V,T,N,K)}if(D!==!0&&(V=K.image)&&I[h+"|"+E+"|image"]&&(V[g]&&(D=V[g](n,q,m,N,K.width,K.height)),this.fire("image",g,n,q,V,r,N,K)),q._interactPrefix=null,D===!0)break}}}},handleDownInfoImage:function(Q,n,C,P,l,y,e){var q=this.downInfo.hits;if(q&&n&&(n=Of(n))){var N=this.gv,p=e.rect,g=this.convertPoint(y,e);q[Q+"|image"]&&(n[C]&&n[C](P,l,N,g,p.width,p.height),this.fire("image",C,P,l,n,r,g,p));for(var G,H=e.compInfos,j=n,F=H.length-1;F>=0;F--){var B=H[F],Z=B.comp;g=this.convertPoint(y,B,j,Z,N,l),p=B.rect;var x=l._interactPrefix=B.prefix,V=["onDrag","onEndDrag"].indexOf(C)>=0;if(!V&&q[Q+"|"+F]||V&&this.downComps&&this.downComps.indexOf(Z)>=0){var z=x&&l.a(x+C)||Z[C];z&&(G=z.call(Z,P,l,N,g,p.width,p.height)),this.fire("comp",C,P,l,n,Z,g,p)}if(G!==!0&&(n=p.image)&&q[Q+"|"+F+"|image"]&&(n[C]&&(G=n[C](P,l,N,g,p.width,p.height)),this.fire("image",C,P,l,n,r,g,p)),l._interactPrefix=null,G===!0)break}}},handleClickImage:function(n,k,E,U,J,V,D,z){var P=this.downInfo.hits,s=z.hits;if(P&&k&&(k=Of(k))){var Q=this.gv,u=D.rect,Y=this.convertPoint(V,D);P[n+"|image"]&&(k[E]&&k[E](U,J,Q,Y,u.width,u.height),this.fire("image",E,U,J,k,r,Y,u));for(var N,c=D.compInfos,B=k,I=c.length-1;I>=0;I--){var F=c[I],l=F.comp;Y=this.convertPoint(V,F,B,l,Q,J),u=F.rect;var W=J._interactPrefix=F.prefix;
if(P[n+"|"+I]&&s[n+"|"+I]){var q=W&&J.a(W+E)||l[E];q&&(N=q.call(l,U,J,Q,Y,u.width,u.height)),this.fire("comp",E,U,J,k,l,Y,u)}if(N!==!0&&(k=u.image)&&P[n+"|"+I+"|image"]&&(k[E]&&(N=k[E](U,J,Q,Y,u.width,u.height)),this.fire("image",E,U,J,k,r,Y,u)),J._interactPrefix=null,N===!0)break}}},initImageResource:function(){u.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function($,F){if(!$)return{x:1/0,y:1/0};var l=F.bodyInfo.rect,w=$.clone(),t=$.multiply({x:l.width,y:l.height});return t.local=w,t},convertPoint:function(R,X,t,x,o,z){var _=X.rect,e=X.matrix.applyInverse(R).sub(_),I=e.x>=0&&e.y>=0&&e.x<=_.width&&e.y<=_.height;if(!I)return e;if(x&&Tp(x.pixelPerfect,z,o)){var _,f=1;this._is2d?(f=o.getZoom(),_=Vl(R.x,R.y,r,f)):_=Vl(R.x,R.y);var n=!1,F=_.x,G=_.y,b=_.width,p=_.height,S=u.hitMaxArea,K=b*p*f*f;if(K>S){var H=Math.sqrt(S/K);f*=H}b*=f,p*=f,2>b&&(b=2),2>p&&(p=2),F*=f,G*=f;var c=Ap(b,p),d=new Nb(0,-F,-G,f,f);d.append(X.matrix),o._drawForChecking=!0,x.transform=d;var C=t.fitSize;X.refRect&&X.refRect.fitSize?(x.refRect=X.refRect,t.fitSize=!0):t.fitSize=!1;var l=t.comps;t.comps=[x],zm(c,t,0,0,b,p,z,self),t.comps=l,t.fitSize=C,delete x.refRect,delete x.unionRect,delete x.transform,o._drawForChecking=!1;try{for(var w=0,Y=c.getImageData(0,0,b,p).data;w<Y.length;w+=4)if(0!==Y[w+3]){n=!0;break}c.restore()}catch(Z){bk=$,n=!1}e.inRect=n}else e.inRect=!0;return e},getDataInfoAt:function(z,y){return Os.prototype.getDataInfoAt.call(this,z,y)}});var cr=bl.DefaultInteractor=function(T){ud(cr,this,[T])};Yr("DefaultInteractor",hp,{handle_mousedown:function(W){Mm(W);var S=this,C=S.gv,H=C.getDataAt(W);if(C.setFocus(W)&&!C._editing&&!C._scrolling){tb(W)?C.handleDoubleClick(W,H):C.handleClick(W,H);var A=Tc(W);!An()&&!A&&H&&(C.isMovable(H)||C._39Q(H))||!C.isPannable()||!ok(W)&&!A||ao(W)||(S._tx=C.tx(),S._ty=C.ty(),S.startDragging(W))}},handleWindowMouseUp:function(e){var X=this,C=X.gv;C._panning&&(delete C._panning,C.onPanEnded(),X.fi({kind:"endPan",event:e})),delete X._tx,delete X._ty,X.clearDragging()},handle_mousemove:function(O){var t=this,y=t.gv;t._hoverTimer&&(Xi(t._hoverTimer),delete t._hoverTimer),t._hoverTimer=Kb(function(){t.fi({kind:"hover",event:O}),Xi(t._hoverTimer),delete t._hoverTimer},y.getHoverDelay()||u.hoverDelay)},handle_mouseleave:function(){var D=this;D._hoverTimer&&(Xi(D._hoverTimer),delete D._hoverTimer)},handleWindowMouseMove:function(s){var u=this,T=u.gv;u.fi({kind:T._panning?"betweenPan":"beginPan",event:s}),T._panning=1;var L=Ln(T,s,u._lastClientPoint);T.setTranslate(u._tx+L.x,u._ty+L.y)},handle_mousewheel:function(Y){this.gv.handleScroll(Y,Y.wheelDelta)},handle_DOMMouseScroll:function(p){2===p.axis&&this.gv.handleScroll(p,-p.detail)},handle_keydown:function(s){this.gv.handleKeyDown(s)}});var ug=bl.SelectInteractor=function(D){ud(ug,this,[D])};Yr("SelectInteractor",hp,{_42:function(){var o=this,H=o.gv,T=H.getZoom(),c=o.mark,n=o.div;n||(n=o.div=Ic(),$p(o.getView(),n));var k={};k.x=c.x*T+H.tx(),k.y=c.y*T+H.ty(),k.width=c.width*T,k.height=c.height*T,Zg(n,k),this.intersects()?(n.style.border="",n.style.background=H.getRectSelectBackground()):(n.style.background="",n.style.border="1px solid "+H.getRectSelectBorderColor())},handle_mousedown:function(h){var q=this,t=q.gv;if(q._57I=$,q.pendingClickThrough=$,!(t._editing||t._scrolling||An()||Tc(h))){var I=t.getDataAt(h),p=t.sm();I?ao(h)?p.co(I)?p.rs(I):p.as(I):p.co(I)?I instanceof el&&I.isClickThroughEnabled()&&ok(h)&&(q.pendingClickThrough=dj(h)):p.ss(I):ao(h)||!t.isPannable()?ok(h)&&(ao(h)||p.cs(),t.isRectSelectable()&&(q.startDragging(h),t._77O=1)):ok(h)&&(q._57I=dj(h))}},handle_mouseup:function(C){var v=this,G=v.gv,m=v._57I;if(m&&(Kj(m,dj(C))<=1&&G.sm().cs(),v._57I=$),v.pendingClickThrough){if(Kj(v.pendingClickThrough,dj(C))<=1){var X=G.getDataAt(C);if(X instanceof el&&X.isClickThroughEnabled()){var O=G.getDataAt(C,function(I){var $=I.getParent()===X&&G.isSelectable(I,!0);return $});O&&(C.clickThrough=!0,G.sm().ss(O))}}v.pendingClickThrough=$}},handleWindowMouseUp:function(x){this.clear(x)},handleWindowMouseMove:function(A){var j=this,s=j.gv;j._logicalPoint=s.lp(A),j.mark?(j.fi({kind:"betweenRectSelect",event:A}),s.isPannable()&&j.autoScroll(A),j.redraw()):j.fi({kind:"beginRectSelect",event:A}),j.mark=Tg(j._lastLogicalPoint,j._logicalPoint),j.redraw()},intersects:function(){var f=this,W=f._lastLogicalPoint,B=f._logicalPoint;return W.x>B.x||W.y>B.y},clear:function(g){var R=this,m=R.gv,O=R.mark;if(R._57I=$,R.pendingClickThrough=$,R._lastLogicalPoint){if(O){if(0!==O.width&&0!==O.height){var r=m.getDatasInRect(O,R.intersects());if(!r.isEmpty()){var x=m.sm(),p=x.toSelection(),h=Ng(g),i=g.altKey;r.each(function(l){x.co(l)?(!h||h&&i)&&p.remove(l):(!i||h&&i)&&p.add(l)}),x.ss(p)}}lk(R.div),delete R.div,delete R.mark,R.redraw(),R.fi({kind:"endRectSelect",event:g}),m.onRectSelectEnded()}R.clearDragging(),delete m._77O}},redraw:function(){var D=this;D._draw||(D._draw=1,Kb(function(){D.mark&&D._42(),delete D._draw},16))}});var bo=bl.MoveInteractor=function(C){ud(bo,this,[C])};Yr("MoveInteractor",hp,{handle_mousedown:function(G){var Z=this,w=Z.gv;if(ok(G)&&!w._editing&&!w._scrolling&&!An()){var p=w.getSelectedDataAt(G);!p||w._39Q(p)&&!w.isMovable(p)?w._focusData=$:(Z._data=p,w.handleMouseDown&&w.handleMouseDown(G,p),Z.startDragging(G),w.isMovable(p)&&(w._moving=1))}},handleWindowMouseUp:function(K){var U=this,w=U.gv;w.handleMouseUp&&w.handleMouseUp(K,U._data),U.clear(K)},handleWindowMouseMove:function(o){var r=this,Q=r._data,L=r.gv;if((!L._93O||!L._93O(o,Q))&&L._moving){r._logicalPoint||r.fi({kind:"prepareMove",event:o});var q=r._logicalPoint?"betweenMove":"beginMove",t={kind:q,event:o},f=r._logicalPoint=L.lp(o);"beginMove"!==q||r._alreadyBeginTransaction||(r._alreadyBeginTransaction=!0,L.getDataModel().beginTransaction());var S=r._calcShift(q,o),P=S.x,G=S.y,$=r.gv.getMoveMode(o,Q);$&&("x"===$?G=0:"y"===$?P=0:"xy"!==$&&(P=G=0)),L.moveSelection(P,G),r._lastLogicalPoint=f,r.autoScroll(o),r.fi(t)}},_calcShift:function(){var Z=this,N=Z._logicalPoint,s=Z._lastLogicalPoint,Q=N.x-s.x,g=N.y-s.y;return{x:Q,y:g}},clear:function(p){var q=this,y=q.gv;q._lastLogicalPoint&&(q._lastLogicalPoint=q._data=y._moving=$,q._logicalPoint&&(q.fi({kind:"endMove",event:p}),y.onMoveEnded()),q.clearDragging()),q._alreadyBeginTransaction&&(q._alreadyBeginTransaction=!1,y.getDataModel().endTransaction())}});var lh=bl.TextEditInteractor=function(f){ud(lh,this,[f]),this.init()};Yr("TextEditInteractor",hp,{setUp:function(){var M=this;lh.superClass.setUp.call(M),M.gv.mp(M.handleGvPropertyChange,M)},teatDown:function(){var P=this;lh.superClass.teatDown.call(P),P.gv.ump(P.handleGvPropertyChange,P)},handleGvPropertyChange:function(){this._editTarget&&this.endTextEdit()},init:function(){var p=this,e=this.input=G.createElement("input"),N=e.style;e.text="text",N.border="1px solid #d8d8d8",N.position="absolute",N.padding="2px 3px",N.outline="none",N.marginLeft="-90px",N.marginTop="-16px",N.backgroundColor="rgba(255,255,255, 1)",N.fontSize="14px",N.width="180px",N.height="32px",N.boxShadow="0 0 13px rgba(16,142,233, 0.5)",N.textAlign="center",N.boxSizing="border-box",f(e,"keyup",function(j){return Yc(j)&&p.endTextEdit(),$c(j)?(p.endTextEdit(!0),void 0):void 0}),f(e,"focus",function(){e.select()});var P=this.textarea=G.createElement("textarea"),S=this.wrap=G.createElement("div");S.appendChild(P),N=P.style,N.margin=0,N.padding="4px",N.overflow="hidden",N.boxSizing="border-box",N.position="absolute",N.outline="none",N.backgroundColor="transparent",N.resize="none",N.textAlign="center",N.fontSize="14px",N.borderWidth=0,N.width="100%",N=S.style,N.boxSizing="border-box",N.margin=0,N.padding=0,N.position="absolute",N.boxShadow="0 0 13px rgba(16,142,233, 0.5)",N.border="1px solid #d8d8d8",N.backgroundColor="rgba(255,255,255, 1)",N.zIndex="10",f(P,"keydown",function(L){return(Ng()||ao())&&Yc(L)?(p.endTextEdit(),void 0):$c(L)?(p.endTextEdit(!0),void 0):(p._editTarget instanceof Df||p.calculateTextareaHeight(String.fromCharCode(L.keyCode)),void 0)}),f(P,"focus",function(){P.select()});var M=function(K){K.stopPropagation()};f(e,"mousedown",M),f(e,"touchstart",M),f(P,"mousedown",M),f(P,"touchstart",M),f(P,"click",M),p.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],p.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",p.handleWindowClick=function(J){var B=p._editingDOM;if(B){var t=B.getBoundingClientRect(),A=dj(J);oe(t,A)||p.endTextEdit()}}},handle_mousedown:function(f){var B=this,q=B.gv;if(tb(f)&&!q._editing){var O=q.getDataAt(f);if(O){var N=q.getTextEditInfo(O);N&&(this._editInfo=N,this._editTarget=O,q._editing=!0,N.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var y=this,q=y.gv,_=y._editTarget,l=y.getTargetValue(),k=y.textarea,u=y.wrap,J=this._editInfo;this.hiddenTextarea||this.createHiddenTextarea(),(null===l||l===r)&&(l=""),k.value=l,J.font&&(k.style.font=J.font),y._editingDOM=k,q.appendHTML(u),this.layoutHTML(u,_),_ instanceof Df?k.style.height="100%":(k.style.height="auto",this.calculateTextareaHeight()),Kb(function(){k.focus(),f(C,"mousedown",y.handleWindowClick),f(C,"touchstart",y.handleWindowClick)},10)},handleTextEdit:function(){var Q=this,b=Q.gv,E=Q._editTarget,i=Q.getTargetValue(),q=Q.input;(null===i||i===r)&&(i=""),q.value=i,Q._editingDOM=q,b.getView().appendChild(q),this.layoutHTML(q,E),Kb(function(){q.focus(),f(C,"mousedown",Q.handleWindowClick),f(C,"touchstart",Q.handleWindowClick)},10)},layoutHTML:function(B,G){var R=this.gv,x=R.getZoom();if(G instanceof Df){var q=R.getDataUI(G),N=q._6I,s=G.getScale(),Z=B.style;B.style.left=N.x*x+R.tx()+"px",B.style.top=N.y*x+R.ty()+"px",B.style.width=q._6I.width+"px",B.style.height=q._6I.height+"px",Ip(Z,"transform","scale("+x*s.x+","+x*s.y+")"),Ip(Z,"transformOrigin","0px 0px")}else if(G instanceof Qh){var N=G.getRect(),t=N.width*x;B.style.left=(N.x+N.width/2)*x+R.tx()+"px",B.style.top=(N.y+N.height/2)*x+R.ty()+"px",B.style.width=t+"px",B.style.marginLeft=-t/2+"px"}else if(G instanceof A.Edge){var q=R.getDataUI(G),N=q._6I;B.style.left=(N.x+N.width/2)*x+R.tx()+"px",B.style.top=(N.y+N.height/2)*x+R.ty()+"px"}},endTextEdit:function(p){var s=this,a=s._editInfo.isMultiline?s.wrap:s.input,U=s._editInfo.isMultiline?s.textarea:s.input;p||s.setTargetValue(U.value),s.gv.getView().removeChild(a),s.gv._editing=!1,delete s._editingDOM,delete s._editTarget,I(C,"mousedown",s.handleWindowClick),I(C,"touchstart",s.handleWindowClick)},setTargetValue:function(C){var q=this,u=q._editTarget,D=q._editInfo,J=D.accessType,x=D.name;if(x&&J||(J="p",x="name"),"p"===J){var H=A.Default.setter(x);u[H](C)}else"a"===J?u.a(x,C):u.s(x,C)},getTargetValue:function(){var e=this,u=e._editTarget,Y=e._editInfo,P=Y.accessType,b=Y.name;if(b&&P||(P="p",b="name"),"p"===P){var F=A.Default.getter(b);return u[F]()}return"a"===P?u.a(b):u.s(b)},createHiddenTextarea:function(){this.hiddenTextarea=G.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;pointer-events: none;opacity:0;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(K,v){if(v&&this.computedStyleCache)return this.computedStyleCache;var m=this,f=C.getComputedStyle(K),z=f.getPropertyValue("box-sizing")||f.getPropertyValue("-moz-box-sizing")||f.getPropertyValue("-webkit-box-sizing"),t=parseFloat(f.getPropertyValue("padding-bottom"))+parseFloat(f.getPropertyValue("padding-top")),s=parseFloat(f.getPropertyValue("border-bottom-width"))+parseFloat(f.getPropertyValue("border-top-width")),E=m.SIZING_STYLE.map(function(D){return D+":"+f.getPropertyValue(D)}).join(";"),W={sizingStyle:E,paddingSize:t,borderSize:s,boxSizing:z};return v&&(this.computedStyleCache=W),W},calculateTextareaHeight:function(i){i=i||"";var I=this,s=I.textarea,c=I.hiddenTextarea,N=I.wrap,M=32,b=I.calculateHTMLStyle(s,!1),Y=b.paddingSize,v=b.borderSize,l=b.boxSizing,z=b.sizingStyle;c.setAttribute("style",z+";"+I.HIDDEN_TEXTAREA_STYLE),c.value=s.value+i;var P=c.scrollHeight;"border-box"===l?P+=v:"content-box"===l&&(P-=Y),s.style.height=P+"px",N.style.height=Math.max(P,M)+"px",N.style.marginTop=P*-.5+"px"}});var Vr=bl.ScrollBarInteractor=function(a){ud(Vr,this,[a])};Yr("ScrollBarInteractor",hp,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(Z){var q=this.gv.getViewRect();return this._41o()&&(q.x+q.width-this.gv.lp(Z).x)*this.gv.getZoom()<rq},isH:function(T){var i=this.gv.getViewRect();return this._40o()&&(i.y+i.height-this.gv.lp(T).y)*this.gv.getZoom()<rq},handle_mousemove:function(V){this.handle_touchmove(V)},handle_touchmove:function(V){if(!Iq&&ok(V)&&this.gv.isScrollBarVisible()){var x=this,b=x.isV(V),q=x.isH(V);(b||q)&&x.gv.showScrollBar(),x.gv._scrolling=b||q}},handleWindowMouseUp:function(S){this.handleWindowTouchEnd(S)},handleWindowTouchEnd:function(w){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=$,this.fi({kind:"endScroll",event:w})},handle_mousedown:function(p){this.handle_touchstart(p)},handle_touchstart:function($){var l=this;if(l.gv.setFocus($),Mm($),l.handle_touchmove($),!(ge($)>1)&&l.gv._scrolling&&l.gv.isScrollBarVisible()){l._cp=dj($),l._tx=l.gv.tx(),l._ty=l.gv.ty();var i=l.isV($);l._state=i?"vScroll":"hScroll",ec(l,$),l.fi({kind:"beginScroll",event:$})}},handleWindowMouseMove:function(e){this.handleWindowTouchMove(e)},handleWindowTouchMove:function(o){var P=dj(o),f=this.gv.getViewRect(),e=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-P.y)*e.height/f.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-P.x)*e.width/f.width),this.fi({kind:"betweenScroll",event:o})}});var In=bl.TouchInteractor=function(i,x){x=x||{},x.selectable===r&&(x.selectable=!0),x.movable===r&&(x.movable=!0),x.pannable===r&&(x.pannable=!0),x.pinchable===r&&(x.pinchable=!0),x.editable===r&&(x.editable=!0),this.params=x,ud(In,this,[i])};Yr("TouchInteractor",hp,{ms_edit:1,setUp:function(){var $=this;In.superClass.setUp.call($),Ze&&$.params.editable&&$.gv.setEditInteractor($)},tearDown:function(){var h=this;In.superClass.tearDown.call(h),Ze&&h.params.editable&&h.gv.setEditInteractor($)},clear:function(R){var y=this,L=y.gv;L._moving&&(y.fi({kind:"endMove",event:R}),delete L._moving,L.onMoveEnded(),L.dm().endTransaction()),L._panning&&(y.fi({kind:"endPan",event:R}),delete L._panning,L.onPanEnded()),L._pinching&&(y.fi({kind:"endPinch",event:R}),delete L._pinching,L.onPinchEnded()),L._editing&&(y._46O(R),y._77I=y._node=y._edge=y._shape=y._rect=y._89I=y._index=L._editing=$),y.pendingClickThrough=y._moving=y._panning=y._pinching=y._editing=y._57I=y._data=y._beginHistory=$,y.clearDragging()},handle_touchstart:function(A){var v=this;if(!v.gv._editing){Mm(A),v._57I=$,v.pendingClickThrough=$;var k=v.params,Y=v.gv,Q=Y.sm(),D=Y.getDataAt(A),I=ge(A);if(1===I){if(tb(A))return Y.handleDoubleClick(A,D),void 0;Y.handleClick(A,D),D&&(Y.handleMouseDown&&Y.handleMouseDown(A,D),v._data=D),k.selectable||(D=$),D&&(Q.co(D)?D instanceof el&&D.isClickThroughEnabled()&&(v.pendingClickThrough=dj(A)):Q.ss(D),k.editable&&Y.isEditable(D)&&v._79I(A,D,!0)?(v._editing=1,v.startDragging(A)):k.movable&&Y.isMovable(D)&&(v._moving=1,v.startDragging(A))),D&&(Y.isMovable(D)||Y._39Q(D))||(v._57I=dj(A),k.pannable&&Y.isPannable()&&(v._panning=1,v.startDragging(A),v._translate={x:Y.tx(),y:Y.ty()}))}else if(k.pinchable&&2===I){if(!Y.getEditInteractor()&&D){var y=Of(Y.getImage(D));if(y&&Tp(y.scrollable,D,this))return}v._pinching=1,v.startDragging(A);var n=Y.getView(),e=Y.getZoom(),N=n.getBoundingClientRect(),u=A.touches[0],j=A.touches[1],H={x:(u.clientX+j.clientX)/2-N.left,y:(u.clientY+j.clientY)/2-N.top};H.x-=Y.tx(),H.y-=Y.ty(),H.x/=e,H.y/=e,v._p=H,v._d=Kq(A)}}},handle_touchend:function(p){var S=this,D=S.gv,j=S._57I,x=S._data;if(j&&(Kj(j,dj(p))<=1&&!D.getDataAt(p)&&D.sm().cs(),S._57I=$),x&&D.handleMouseUp&&D.handleMouseUp(p,x),S.pendingClickThrough){if(Kj(S.pendingClickThrough,dj(p))<=1){var x=D.getDataAt(p);if(x instanceof el&&x.isClickThroughEnabled()){var d=D.getDataAt(p,function(Y){var _=Y.getParent()===x&&D.isSelectable(Y,!0);return _});d&&(p.clickThrough=!0,D.sm().ss(d))}}S.pendingClickThrough=$}},handleWindowTouchEnd:function(p){this.clear(p)},handleWindowTouchMove:function($){var K=this,V=K.gv,l=ge($);if(1===l){var H=dj($),_=Ln(V,H,K._lastClientPoint),s=Kj({x:0,y:0},_);if(K._editing&&(K._beginHistory||(K._beginHistory=1,V.dm().beginTransaction()),V._editing=1,K._78I($)),K._moving){if(!V._moving&&s<u.touchMoveThreshold)return;K._beginHistory||(K._beginHistory=1,V.dm().beginTransaction()),K.handleMove($)}else if(K._panning){if(!V._panning&&s<u.touchMoveThreshold)return;V.setTranslate(K._translate.x+_.x,K._translate.y+_.y),K.fi({kind:V._panning?"betweenPan":"beginPan",event:$}),V._panning=1}}else if(2===l&&K._pinching){var b=Kq($);V.handlePinch(K._p,b,K._d),K._d=b,K.fi({kind:V._pinching?"betweenPinch":"beginPinch",event:$}),V._pinching=1}},handleMove:function(T){var e=this,B=e.gv,$=B.lp(T);B._93O&&B._93O(T,e._data)||(B.moveSelection($.x-e._lastLogicalPoint.x,$.y-e._lastLogicalPoint.y),e._lastLogicalPoint=$,e.autoScroll(T),e.fi({kind:B._moving?"betweenMove":"beginMove",event:T}),B._moving=1)}});var A=C.ht,um=A.graph._editor={Math:A.Math,Guide:{}};um.getStyle=function(E){var C,K=um.StyleMap;return K&&(C=K[E],C!==r)?C:um.DefaultStyleMap[E]},um.setStyle=function(V,o){var s=um.StyleMap;s||(s=um.StyleMap={}),s[V]=o},um.inEdit=function(m){return m._inXEdit===!0},um.startEdit=function(R){R._inXEdit=!0,um.Inject.doInject(R)},um._46O=function(q){q._inXEdit=!1,um.Inject.undoInject(q)},um.toScreenPosition=function(P,L){var I=P.tx(),G=P.ty(),t=P._zoom;return new um.Math.Vector2(L.x*t+I,L.y*t+G)},um.checkHit=function(B,h,q){return B.distanceTo(h)<q?!0:!1},um.toWorldPosition=function(_,q){var e=_.tx(),o=_.ty(),M=_._zoom;return{x:(q.x-e)/M,y:(q.y-o)/M}},um.setAntialias=function(w,x){for(var r,A=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],Z=0,L=A.length;L>Z&&(r=A[Z],!(r in w));Z++);w[r],w[r]=x},um.getTargetCornersOnScreen=function(Y,Q){if(!Q)return null;var _,K=[];if(Ec(Q,Y)){var d=Le(Y,Q);_=[{x:d.x,y:d.y},{x:d.x+d.width,y:d.y},{x:d.x+d.width,y:d.y+d.height},{x:d.x,y:d.y+d.height}]}else{if(!Q.getCorners)return null;_=Q.getCorners()}return _.forEach(function(_){var E=um.toScreenPosition(Y,_);K.push(E.x,E.y)}),K},um.log=function(){};var Kp;um.updateTipInfo=function(G,c,z){if(z){var g=A.Default.getLogicalPoint(G,c._canvas);g.x+=um.Icons.TipShiftX,g.y+=um.Icons.TipShiftY,Kp={helperPos:g,text:z,size:z.length}}else Kp=$},um.drawTip=function(U,P){Kp&&um.Icons.DrawIcon(P,U,um.Icons.TipHelper,Kp)};var gk=um.Inject={_modules:[]};gk.registAsModule=function(T,I){var Q={},x={};for(var U in T){var N=I.prototype[U];Q[U]=N}T.getBackup=function(s){return Q[s]},T.getBackups=function(){return Q},x.doInject=function(){for(var q in T)"getBackup"!==q&&(I.prototype[q]=T[q])},x.undoInject=function(){for(var $ in T)"getBackup"!==$&&(I.prototype[$]=Q[$])},gk._modules.push(x)},gk.doInject=function(x){for(var D,K=gk._modules,z=0,S=K.length;S>z;z++)D=K[z],D.doInject(x)},gk.undoInject=function(h){for(var D,C=gk._modules,H=0,$=C.length;$>H;H++)D=C[H],D.undoInject(h)};var hp=A.graph.EditInteractor=function(u){var C=this,K=G.createElement("canvas");K.className="editCanvas",K.style.position="absolute",C._uuid=A.Math.generateUUID(),C._styleMap={},C._canvas=K,C._context=K.getContext("2d"),hp.superClass.constructor.call(C,u),this._editDetail=!1,um.setAntialias(C._context,!1),C._subModules=C.initSubModule(),C._gridGuide=new um.Guide.Grid(C),C._rectGuide=new um.Guide.Rect(C),C._hoverGuide=new um.Guide.Hover(C)},cs=hp;A.Default.def(hp,A.graph.Interactor,{ms_edit:1,ms_fire:1}),b.defineProperties(hp.prototype,{editDetail:{get:function(){var H=!!this._editDetail;return H},set:function(Y){var D=this,r=D._editDetail;r!==Y&&(D._editDetail=Y,D.gv._editing=Y,D.fp("editDetail",r,Y),D.fp("pointsEditingMode",r,Y),D.fi({kind:Y?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(O){(!this._editDetail||O)&&(this.gv._editing=O,O||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(k){this._editing=k,this.gvEditing=k}},editingModule:{get:function(){return this._editMod}},pointsEditingMode:{get:function(){return this.editDetail},set:function(H){var C=this;C.editDetail!==H&&(H?C._tryEnterEditDetailMode():C._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var v=this._gridEnabled;if(!v)return!1;var T=this.gv;return T?!0:!0},set:function(B){B!==this._gridEnabled&&(this._gridEnabled=B,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(q){q!==this._agEnabled&&(this._agEnabled=q,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),hp.prototype.initSubModule=function(){var b=this;return[new um.Anchor(b),new um.RotateX(b),new um.MoveDummy(b),new um.Rect(b),new um.Curve(b),new um.MoveHelper(b)]},hp.prototype.getSubModule=function(s){var B,e,y,Z=this._subModules;for(e=0,y=Z.length;y>e;e++)if(B=Z[e],B.catalog===s)return B},hp.prototype.invokeSubModule=function(Z,t){for(var _,M,V,R=this,a=R._subModules,D=Array.prototype.slice.call(arguments,2),X=0,d=a.length;d>X;X++)if(_=a[X],M=_[Z],M&&(V=M.apply(_,D),V!=r&&t))return _},hp.prototype.invokeSubModuleInverse=function(J,f){var H=this,M=H._subModules;if(M)for(var m,t,Y,W=Array.prototype.slice.call(arguments,2),g=M.length-1;g>=0;g--)if(m=M[g],t=m[J],t&&(Y=t.apply(m,W),Y!=r&&f))return m},hp.prototype.setUp=function(){um.log("setUp");var q=this,y=q.gv,E=y.getView(),U=q._canvas;hp.superClass.setUp.call(q),y.setEditInteractor(q),y._79O?E.insertBefore(U,y._79O):E.appendChild(U),um.startEdit(y),q.invokeSubModule("setUp"),y.dm().mm(q._onDataModelChanged,q),y.dm().md(q._onDataPropertyChanged,q)},hp.prototype.tearDown=function(){um.log("tearDown");var l=this,K=l.gv,m=K.getView();l._resetCustomCursorStyle(),hp.superClass.tearDown.call(l),K.dm().umm(l._onDataModelChanged,l),K.dm().umd(l._onDataPropertyChanged,l),K.setEditInteractor(null),m.removeChild(l._canvas),l._drawTimer&&(Xi(l._drawTimer),l._drawTimer=null),um._46O(K),l.invokeSubModule("tearDown")},hp.prototype._onDataModelChanged=function(f){var x=this;("clear"===f.kind||"remove"===f.kind&&x.editDetail&&f.data===x.getSubModule("Curve").target)&&(x.editDetail=!1,x._42())},hp.prototype._onDataPropertyChanged=function(E){var C=this;if(C.editDetail){var b=C.getSubModule("Curve"),y=E.data;y===b.target&&(y._writing||b._handleDataChanged(E))}},hp.prototype.clear=function(){um.log("clear")},hp.prototype.redraw=function(){this._42()},hp.prototype._42=function(){var V=this;V._drawTimer||(V._drawTimer=Kb(function(){V._drawTimer=null,V.drawImpl()},0))},hp.prototype.drawImpl=function(){var d;for(d in{_42:!0})break;return function(){var C=this,s=C._canvas,E=C.gv,l=E.getWidth(),$=E.getHeight(),G=C._context,n=A.Default.getInternal(),f=u.devicePixelRatio;(s.width!==l||s.height!==$)&&n.setCanvas(s,l,$,f),G.clearRect(0,0,s.width,s.height);var k=C._getValidSelection();G.save(),G.scale(f,f),C._gridGuide._42(),C.invokeSubModuleInverse(d,!1,G,E,k),C._rectGuide._42(),C._hoverGuide._42(),G.restore()}}(),hp.prototype._getValidSelection=function(){var c=this,y=c.gv,q=y.sm().getSelection(),Z=[];return q.each(function(H){y.isVisible(H)&&y.isEditable(H)&&Z.push(H)}),Z},hp.prototype.handle_touchmove=function(d){return this.handle_mousemove(d)},hp.prototype.handle_mousemove=function(x){if(!A.Default.isDragging()){var w=this;if((w.editDetail||!An()&&!Tc(x))&&!w.gv._externalEditing){if(w.gvEditing=!1,w._checkEdit(x))w.gvEditing=!0;else{if(!w.getStyle("hoverGuideVisible"))return;w.hoverData=w.gv.getDataAt(x)}w._42()}}},hp.prototype.handle_touchstart=function(j){return this.handle_mousedown(j)},hp.prototype.handle_mousedown=function(K){Mm(K);var R=this;if((R.editDetail||!An()&&!Tc(K))&&!R.gv._externalEditing){if(tb(K)&&!K.clickThrough){if(R.editDetail){if(R._tryQuitEditDetailMode(K))return}else if(R._tryEnterEditDetailMode())return;R.gv.dm().beginTransaction();var W=R.invokeSubModule("handleDoubleClick",!0,K);if(R.gv.dm().endTransaction(),W)return}var w=R._checkEdit(K);w&&(R._downPosition=R._getLogicalPoint(K),R.gv.dm().beginTransaction(),w.startEdit(R,K),R.editing=!0)}},hp.prototype._checkEdit=function(C){var j=this,I=j.gv,R=j._getLogicalPoint(C),s=j.invokeSubModule("check",!0,I,C,R)||null;return j._editMod=s,s},hp.prototype.handleWindowTouchMove=function(J){return this.handleWindowMouseMove(J)},hp.prototype.handleWindowMouseMove=function(c){var a=this,g=a._downPosition;if(g){var R=a._getLogicalPoint(c);if(R.distanceTo(g)<a.getStyle("moveSensitivity"))return;delete a._downPosition}var S=a._editMod;S&&S.handleEdit(a.gv,c),a.redraw()},hp.prototype._getLogicalPoint=function(F){var J=this,T=A.Default.getLogicalPoint(F,J._canvas);return new um.Math.Vector2(T)},hp.prototype.handleWindowTouchEnd=function(t){return this.handleWindowMouseUp(t)},hp.prototype.handleWindowMouseUp=function(){var A;for(A in{_46O:!0})break;return function(x){var d=this;d.editing=!1,d.setCursor("default"),d.invokeSubModule(A,!1,x),d._42(),d.gv.dm().endTransaction()}}(),hp.prototype.handle_mousewheel=function(m){var M=this;Mm(m),M.invokeSubModule("preHandleScroll",!0)||M.gv.handleScroll(m,m.wheelDelta)},hp.prototype.handleDelete=function(){var i=this;if(!i.editDetail){i.gv.dm().beginTransaction();var s=i.invokeSubModule("handleNormalStateDelete",!0);return i.gv.dm().endTransaction(),s||i.gv.removeSelection(),void 0}i.gv.dm().beginTransaction(),i.invokeSubModule("handleDelete",!0),i.gv.dm().endTransaction(),i._42()},hp.prototype.handle_keydown=function(I){var B=this;if((I.metaKey||I.ctrlKey)&&B._42(),An(I)&&!B.editing)return B.gvEditing=!1,B.setCursor("default"),B._42(),void 0;var k=Yc(I);return B.editDetail?((k||$c(I))&&(B.editDetail=!1,B._42()),B.gv.dm().beginTransaction(),B.invokeSubModule("handle_keydown",!0,I),B.gv.dm().endTransaction(),void 0):(B.gv.dm().beginTransaction(),B.invokeSubModule("handleNormalStateKeyDown",!0,I),B.gv.dm().endTransaction(),k&&B._tryEnterEditDetailMode(),void 0)},hp.prototype.handle_keyup=function(N){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,N),this.gv.dm().endTransaction()},hp.prototype._tryEnterEditDetailMode=function(){var l=this;return!l.editDetail&&l.invokeSubModule("canEnterEditDetailMode",!0)&&1===l._getValidSelection().length?(l.editDetail=!0,l._42(),!0):void 0},hp.prototype._tryQuitEditDetailMode=function(S){var L=this;return L.editDetail?!S||L.invokeSubModule("canQuitEditDetailMode",!0,S)?(L.editDetail=!1,L._42(),!0):!1:!1},hp.prototype.setStyle=function(H,K,q){var x=this;q?um.setStyle(H,K):x._styleMap[H]=K,"baseColor"===H&&(fc=K),x.fp("styleChanged",null,{key:H,value:K,base:q}),x._42()},hp.prototype.getStyle=function(u){var w=this,k=w._styleMap[u];return k!==r?k:um.getStyle(u)},hp.prototype.setCursor=function(S){this._resetCustomCursorStyle(),A.graph.EditInteractor.superClass.setCursor.call(this,S)},hp.prototype._drawHostGuide=function(s){var I=this,Q=I._context,P=I.gv;um.Icons.DrawIcon(I,Q,um.Icons.NodeHoverGuide,s.corners);var M=s.host;if(M){var h=P.getAttachPoints(M);if(h&&h.length)for(var b=0,z=h.length;z>b;b++){var S=h[b],o=Ad(P,M,0,S.offsetX||0,S.offsetY||0,S.x,S.y);o=um.toScreenPosition(P,o),o.isAttach=s.attach===b,um.Icons.DrawIcon(I,Q,um.Icons.AttachPoint,o)}}},hp.prototype._resetCustomCursorStyle=function(){var o=this;if(o._customStyle){var s=this.gv.getView();s.classList&&s.classList.remove&&s.classList.remove(o._customStyle),o._customStyle=null}},hp.prototype._setRotateCursor=function(N){var z=this,e=z._cursorFactory;e||(e=z._cursorFactory=new um.CursorFactory(z));var P=e.getRotateCursor(N),Y=z.gv.getView();z._resetCustomCursorStyle(),z._customStyle=P,Y.classList&&Y.classList.add&&Y.classList.add(P)};var mc=um.Group=function(R){var $=this;$._entities=R,$._64O=0,$._position={x:0,y:0},$._scale={x:1,y:1},$._anchor={x:.5,y:.5},$._anchor2={x:.5,y:.5}};mc.prototype={},mc.prototype.constructor=mc;var er=null,vg=null;mc.findOrCreateGroup=function(L,U){if(vg===U&&er&&er.checkIsMe(L))return er;vg=U;var V=new um.Group(L);return V.getKeyOb()?(er=V,V):void 0},mc.prototype.checkIsMe=function(J){var r=this._entities;if(r.length!==J.length)return!1;var L,V={},F=J.length;for(L=0;F>L;L++)V[J[L]._id]=!0;for(L=0;F>L;L++)if(!V[r[L]._id])return!1;return!0},mc.prototype.getRotation=function(){return this._64O},mc.prototype.getPosition=function(){return this._position},mc.prototype.getAnchor=function(){return this._anchor},mc.prototype.getWidth=function(){return this._width},mc.prototype.getScale=function(){return this._scale},mc.prototype.getSize=function(){return{width:this._width,height:this._height}},mc.prototype.getHeight=function(){return this._height},mc.prototype.getKeyOb=function(){for(var B=this._entities,R=B.length-1;R>=0;R--){var h=B[R];if(this.isNode(h))return h}},mc.prototype.getAnchor2=function(){var S=this,p=S.rotateCenter;if(p)return p;var b=S.getKeyOb();if(!b)return S._anchor;var B=S._anchor2,s=b.getMatrix();return s.tf({x:b.getWidth()*(B.x-b.getAnchor().x),y:b.getHeight()*(B.y-b.getAnchor().y)})},mc.prototype.setAnchor2=function(s,m){var d=this,U=d.getKeyOb();if(U){var H,C=U.getMatrix();H="number"==typeof s?{x:s,y:m}:s;var v=C.tfi(H);d._anchor2={x:U.getAnchor().x+v.x/U.getWidth(),y:U.getAnchor().y+v.y/U.getHeight()}}},mc.prototype.setRotation=function(){},mc.prototype.beginRotate=function(h){this.rotateCenter=h.pos,this.rotateMode=h.groupRotateMode},mc.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},mc.prototype.addRotation=function(Z,e,d){return"batch"===e?this._addRotationInBatchMode(Z,d):"block"===e?this._addRotationInBlockMode(Z,d):void 0},mc.prototype._addRotationInBlockMode=function(e,Z){var u=this,D=u.rotateCenter||u.getPosition();u._entities.forEach(function(y){if(u.isNode(y)&&(!Z||Z(y))){var j=y.getMatrix();j.translate(-D.x,-D.y),j.rotate(e),j.translate(D.x,D.y);var v=Math.sign(y.getScale().x);y.setRotation(ys(j.b*v,j.a*v)),y.setPosition(j.tx,j.ty)}})},mc.prototype._addRotationInBatchMode=function(Z,g){var K=this,I=K._anchor2;K._entities.forEach(function(a){if(K.isNode(a)&&(!g||g(a))){var c=a.getAnchor(),$=a.getMatrix(),n=$.tf({x:a.getWidth()*(I.x-c.x),y:a.getHeight()*(I.y-c.y)}),W=new um.Math.Matrix2d;W.set($.a,$.b,$.c,$.d,$.tx,$.ty),W.translate(-n.x,-n.y),W.rotate(Z),W.translate(n.x,n.y);var T=Math.sign(a.getScale().x);a.setRotation(ys(W.b*T,W.a*T)),a.setPosition(W.tx,W.ty)}})},mc.prototype.setPosition=function(A){var Q,$,J,h,W=this,m=W._position,C=A.x-m.x,D=A.y-m.y,w=W._entities;for($=0,J=w.length;J>$;$++)Q=w[$],Dk(Q)&&(h=Q.getPosition(),Q.setPosition(h.x+C,h.y+D));W._position=A},mc.prototype.setScale=function(e,D){var Q=this,R=e/Q._scale.x,m=D/Q._scale.y;Q._adjustChildScaleOrSize(R,m,"size"),Q._scale={x:e,y:D}},mc.prototype.getRect=function(){var S=this,e=S._position,X=S._width,E=S._height;return{x:e.x-X/2,y:e.y-E/2,width:X,height:E}},mc.prototype.setSize=function(c,x){var M=this,c=Math.max(1,c),x=Math.max(1,x),V=c/M._width,O=x/M._height;
M._adjustChildScaleOrSize(V,O,"size"),M._width=c,M._height=x},mc.prototype._adjustChildScaleOrSize=function(n,G,J){var o,Y,R,p,O,S,N,d,v,u,z,h,Z,E,W=this,D=W._position,L=W._entities,a=new um.Math.Matrix2d;for(Y=0,R=L.length;R>Y;Y++)if(o=L[Y],W.isNode(o)){if(p=o.getPosition(),O=o.getRotation(),S=o.getWidth(),N=o.getHeight(),d=o.getScale(),z=d.x*S,h=d.y*N,a.identity().scale(z,h).rotate(O).translate(p.x,p.y).translate(-D.x,-D.y).rotate(-W._64O),O=ys(a.b*Math.sign(z),a.a*Math.sign(z)),a.scale(n,G),v=Math.cos(O),u=Math.sin(O),Math.abs(v)<.001?(Z=a.b/u,E=-a.c/u):(Z=a.a/v,E=a.d/v),"scale"===J)o.setScale(Z/S,E/N);else if("size"===J){var P=Z/d.x,l=E/d.y;o.setScale(Hm(Z)*Math.abs(d.x),Hm(E)*Math.abs(d.y)),o.setSize(Math.max(.1,Math.abs(P)),Math.max(.1,Math.abs(l)))}a.rotate(W._64O).translate(D.x,D.y),o.setPosition(a.tx,a.ty)}},mc.prototype.getMatrix=function(){var e=this,R=e._position,L=A.Default.getInternal(),Y=e._scale;return new L.Mat(e._64O,R.x,R.y,Y.x,Y.y)},mc.prototype.toGlobal=function(b){return this.getMatrix().tf(b)},mc.prototype.getCorners=function(){var H=this,E=H._width,g=H._height,o=H._anchor,P=-E*o.x,V=-g*o.y,y=H.getMatrix();return[y.tf(P,V),y.tf(P,V+g),y.tf(P+E,V+g),y.tf(P+E,V)]},mc.prototype.calcInfo=function(){var U,i,s,V,x,$,I=this,C=[],_=I._entities,j=I._64O;for(V=0,x=_.length;x>V;V++)$=_[V],I.isNode($)&&$.getCorners&&C.push.apply(C,$.getCorners());if(C.length){var N=Math.cos(-j),R=Math.sin(-j),A=1/0,G=-1/0,a=1/0,f=-1/0;for(V=0,x=C.length;x>V;V++)s=C[V],U=s.x,i=s.y,s.x=N*U-R*i,s.y=R*U+N*i,A=Math.min(A,s.x),G=Math.max(G,s.x),a=Math.min(a,s.y),f=Math.max(f,s.y);I._width=(G-A)/I._scale.x,I._height=(f-a)/I._scale.y,N=Math.cos(j),R=Math.sin(j);var k=I._anchor;U=A+(G-A)*k.x,i=a+(f-a)*k.y,I._position={x:N*U-R*i,y:R*U+N*i}}},mc.prototype.isNode=function(R){return Dk(R)?Ec(R)?R.size()?!1:!0:!0:!1},mc.prototype._42=function(J,b,h){var z,o,S,V,y,I,X,u,N=this,P=N._entities,d=N.rotateMode;for("batch"===d&&(u=N.getKeyOb()),z=0,o=P.length;o>z;z++)S=P[z],N.isNode(S)&&(I=S.getRect(),V=um.toScreenPosition(h,{x:I.x,y:I.y}),y=um.toScreenPosition(h,{x:I.x+I.width,y:I.y+I.height}),X={min:V,max:y},S===u&&(X.isKeyOb=!0),um.Icons.DrawIcon(J,b,um.Icons.GroupSubEntityRect,X))};var Sp=um.CurveActiving=function(n,p){this._curve=n,this._interactor=n._interactor,this.silent=!0;for(var S in p)this[S]=p[S];delete this.silent};Sp.prototype={},Sp.prototype.constructor=Sp,b.defineProperties(Sp.prototype,{point:{get:function(){return this._point},set:function($){var s=this;s._point=$,s.editingCtrl||s.silent||s._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(A){var O=this;O._pairs=A,O.editingCtrl&&!O.silent&&O._firePointChange()}}}),Sp.prototype._firePointChange=function(){var Y=this,O=Y.getCurrentEditingPoint(),K=Y._interactor;if(!O)return K.fi({kind:"selectPoint"}),void 0;var Z=this._curve.target;if(Z){var f=um.getDataMatrix(Z).invert(),o=O.e;O=f.apply(um.toWorldPosition(K.gv,O)),O.e=o;var Q=Y._lastFirePoint;Q&&Math.abs(O.x-Q.x)<1e-5&&Math.abs(O.y-Q.y)<1e-5&&(O.e==r&&Q.e==r||Math.abs(O.e-Q.e)<1e-5)||(Y._lastFirePoint=O,K.fi({kind:"selectPoint",x:O.x,y:O.y,e:O.e}))}},Sp.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Sp.prototype.getCurrentEditingPoint=function(){var j=this,G=j.editingCtrl;if(G){var E=j.pairs;if(E){var l=E[G.pairId];if(l){var y=l[G.type];if(y)return y}}}return j._point};var Xb=um.CursorFactory=function(_){var Y=this;Y._interactor=_,Y._rotateCursorStyles={}};Xb.prototype={},Xb.prototype.constructor=Xb,Xb.prototype.getRotateCursor=function(w){var s=this;0>w&&(w+=2*Math.PI);var T=s._interactor,G=T.getStyle("rotateCursorSize"),L=T.getStyle("rotateCursorRound"),b=Math.round(180*(w/Math.PI)/L);b*L>=360&&(b=0);var F=s._rotateCursorStyles,g="htCustomRotateStyle_"+G+"_"+L+"_"+b;return F[g]||(s._produceRotateCursor(g,G,L,b),F[g]=!0),g},Xb.prototype._produceRotateCursor=function(r,o,V,K){var z=this;z._interactor;var I=z._canvas;I||(I=z._canvas=G.createElement("canvas"));var Y=u.devicePixelRatio;I.width=I.height=o*Y,I.style.width=I.style.height=o+" px";var H=I.getContext("2d");um.setAntialias(H,!1),H.scale(Y,Y);var U,x,N,T,E,S=Math.round(o/2),h=""+S+" "+S+",auto !important;",k=4;U=Math.PI/180*K*V,H.clearRect(0,0,o,o),H.save(),H.scale(o/32,o/32),H.translate(16,15),H.rotate(U+Math.PI/2),H.beginPath(),H.moveTo(-8,0),H.lineTo(-8,k),H.lineTo(-8+k,k),H.moveTo(8,0),H.lineTo(8,k),H.lineTo(8-k,k),H.moveTo(-8,k),H.quadraticCurveTo(0,-6,8,k),H.restore(),H.lineCap="round",H.lineJoin="miter",H.strokeStyle="white",H.lineWidth=4,H.stroke(),H.strokeStyle="black",H.lineWidth=2,H.stroke(),x=JSON.stringify(I.toDataURL()),T="cursor:url("+x+")"+h,1!==Y&&(N='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+o+'px" height="'+o+'px"><image xlink:href='+x+' width="'+o+'" height="'+o+'"/></svg>',T+="cursor:url(data:image/svg+xml;base64,"+btoa(N)+")"+h,T+="cursor:-webkit-image-set(url("+x+")"+Y+"x,url("+x+")1x)"+h),E=G.createElement("style"),E.textContent="body."+r+" *, ."+r+"{"+T+"}",G.head.appendChild(E)};var Jo=um.Guide.Grid=function(D){var q=this;q._interactor=D,q._alignmentGuideId=0,q._xAlignmentGuide=[],q._yAlignmentGuide=[]};Jo.prototype={},Jo.prototype.constructor=Jo,b.defineProperties(Jo.prototype,{gridBlockSize:{get:function(){var J=this;return J._gridBlockSize||J._interactor.getStyle("gridBlockSize")},set:function(u){this._gridBlockSize=u,this._interactor._42()}},gridThickLinesEvery:{get:function(){var z=this;return z._gridThickLinesEvery||z._interactor.getStyle("gridThickLinesEvery")},set:function(D){this._gridThickLinesEvery=D,this._interactor._42()}},gridEnabled:{get:function(){var b=this,I=b._interactor;return I.gridEnabled&&b.isValidGrid()}}}),Jo.prototype._42=function(){var d=this,R=d._interactor;d.gridEnabled&&d.drawGrid(),R.alignmentGuideEnabled&&d.drawAlignmentGuide()},Jo.prototype.makeMatrix=function(){var e=this,U=e._interactor.getStyle("gridAngle"),m=e._interactor.getStyle("gridRotation"),s=new um.Math.Matrix2d,y=Math.sin(U),O=Math.cos(U);return s.set(1,0,O,y,0,0),s.rotate(m),s},Jo.prototype.isValidGrid=function(){var x=this,j=Math.PI,h=x._interactor,v=h.gv;if(v._zoom<h.getStyle("gridZoomThreshold"))return!1;var A=h.getStyle("gridAngle"),G=Math.abs(180*(A%j/j)),L=1-1e-8;return L>G||G>180-L?!1:!0},Jo.prototype.drawAlignmentGuide=function(){var d=this,N=d._interactor,V=N.gv,g=N._canvas,C=N._context,G=g.width,k=g.height,F=V.tx(),b=V.ty(),O=V._zoom;C.beginPath(),C.strokeStyle=N.getStyle("gridAlignmentGuideColor"),C.lineWidth=1,d._xAlignmentGuide.forEach(function(K){var H=K.p*O+F;C.moveTo(H,0),C.lineTo(H,k)}),d._yAlignmentGuide.forEach(function(P){var y=P.p*O+b;C.moveTo(0,y),C.lineTo(G,y)}),C.stroke()},Jo.prototype.drawGrid=function(){function T(W,x,d,F){var B=um.toScreenPosition(S,n.apply({x:W,y:x})),X=um.toScreenPosition(S,n.apply({x:d,y:F}));j.moveTo(B.x,B.y),j.lineTo(X.x,X.y)}var N=this,i=N._interactor,D=N.gridBlockSize,M=N.gridThickLinesEvery,r=i.getStyle("gridThickColor"),$=i.getStyle("gridLightColor"),S=i.gv,P=i._canvas,j=i._context,B=P.width,I=P.height,n=N.makeMatrix(),v=n.applyInverse(um.toWorldPosition(S,{x:0,y:0})),k=n.applyInverse(um.toWorldPosition(S,{x:B,y:0})),q=n.applyInverse(um.toWorldPosition(S,{x:0,y:I})),L=n.applyInverse(um.toWorldPosition(S,{x:B,y:I})),e=Math.min(v.x,k.x,q.x,L.x),b=Math.max(v.x,k.x,q.x,L.x),p=Math.min(v.y,k.y,q.y,L.y),w=Math.max(v.y,k.y,q.y,L.y);B=b-e,I=w-p;var X=Math.ceil(e/D),z=Math.floor(b/D),Q=Math.ceil(p/D),u=Math.floor(w/D);S.tx(),S.ty(),S._zoom;var x,c,f;for(j.save(),j.lineWidth=1,j.beginPath(),j.strokeStyle=r,f=Math.ceil(X/M)*M;z>=f;f+=M)x=f*D,T(x,p,x,w);for(f=Math.ceil(Q/M)*M;u>=f;f+=M)c=f*D,T(e,c,b,c);for(j.stroke(),j.beginPath(),j.strokeStyle=$,f=X;z>=f;f++)0!==f%M&&(x=f*D,T(x,p,x,w));for(f=Q;u>=f;f++)0!==f%M&&(c=f*D,T(e,c,b,c));j.stroke(),j.restore()},Jo.prototype.getAlignmentGuides=function(){var T=this;return{x:T._xAlignmentGuide,y:T._yAlignmentGuide}},Jo.prototype.addAlignmentGuide=function(P,k,G){var X=this,u="x"===P?X._xAlignmentGuide:X._yAlignmentGuide,G=G?G:++X._alignmentGuideId,R={p:k,id:G};if(u.length){var h=X._findClosestAlignmentGuide(R.p,u);h.dis<0?u.splice(h.index+1,0,R):u.splice(h.index,0,R)}else u.push(R);return X._interactor._42(),G},Jo.prototype.findClosest=function(g,X,I){var C=this,t=C._interactor,l=t.gv;I&&(g=um.toWorldPosition(l,g));var Y,F,a,Q=1/0,S=1/0,A=g.x,R=g.y;if(C.gridEnabled){var i=C.gridBlockSize,B=C.makeMatrix(),T=B.applyInverse(g);T=B.apply({x:Math.round(T.x/i)*i,y:Math.round(T.y/i)*i}),Q=T.x-A,S=T.y-R,a=!0}if(t.alignmentGuideEnabled&&(Y=C._findClosestAlignmentGuide(A,C._xAlignmentGuide).dis,F=C._findClosestAlignmentGuide(R,C._yAlignmentGuide).dis,Math.abs(Y)<Math.abs(Q)&&(Q=Y,a=!0),Math.abs(F)<Math.abs(S)&&(S=F,a=!0)),a){a=!1;var u=l._zoom,D=t.getStyle("smartGuideThreshold")/u,$={};if(Math.abs(Q)<D&&"y"!==X&&($.x=I?Q*u:Q,a=!0),Math.abs(S)<D&&"x"!==X&&($.y=I?S*u:S,a=!0),a)return $}},Jo.prototype._findClosestAlignmentGuide=function(b,k){if(!k.length)return{dis:1/0};for(var v,f=0,D=k.length-1;D-f>1;)v=Math.floor((f+D)/2),k[v].p<b?f=v:D=v;var F=k[f].p-b,V=k[D].p-b;return Math.abs(F)<=Math.abs(V)?{line:k[f],dis:F,index:f}:{line:k[D],dis:V,index:D}},Jo.prototype.removeAllAlignmentGuide=function(t){var o=this;"y"!==t&&(o._xAlignmentGuide=[]),"x"!==t&&(o._yAlignmentGuide=[]),o._interactor._42()},Jo.prototype.removeAlignmentGuide=function(b){for(var c,S,E,W=this,B=W._xAlignmentGuide,y=0;2>y;y++)for(B=0===y?W._xAlignmentGuide:W._yAlignmentGuide,c=0,S=B.length;S>c;c++)if(E=B[c],E.id===b)return B.splice(c,1),W._interactor._42(),{axis:0===y?"x":"y",position:E.p};return!1},Jo.prototype.adjustAlignmentGuide=function(T,b){var n=this,U=n.removeAlignmentGuide(T);return U?(n.addAlignmentGuide(U.axis,b,T),!0):!1};var Pi=um.Guide.Rect=function(J){var m=this;m._interactor=J};Pi.prototype={},Pi.prototype.constructor=Pi,Pi.prototype.gatherRects=function(){var b,i,R,h,Q=this,f=Q._interactor.gv,L=[],w=[],J={x:L,y:w},N={},Z=f.getDataModel(),j=Z.a("width"),n=Z.a("height");j&&n&&(b=0,i=0,R=j,h=n,L.push({node:Z,type:0,p:b},{node:Z,type:1,p:b+R/2},{node:Z,type:2,p:b+R}),w.push({node:Z,type:0,p:i},{node:Z,type:1,p:i+h/2},{node:Z,type:2,p:i+h}),N[Z._id||0]={x:b,y:i,width:R,height:h}),Z.each(function(x){if(Dk(x)&&!f.isSelected(x)&&f.isVisible(x)&&f.isValidGuideLineSource(x)){var u=!1;if(f.sm().getSelection().each(function(s){u||(x.isHostOn(s)?u=!0:x.isDescendantOf(s)&&(u=!0))}),!u){var G=x.getRect();b=G.x,i=G.y,R=G.width,h=G.height,L.push({node:x,type:0,p:b},{node:x,type:1,p:b+R/2},{node:x,type:2,p:b+R}),w.push({node:x,type:0,p:i},{node:x,type:1,p:i+h/2},{node:x,type:2,p:i+h}),N[x._id]=G}}}),L.sort(function(v,u){return v.p-u.p}),w.sort(function(A,D){return A.p-D.p}),Q._grid=J,Q._87I=N},Pi.prototype.gatherLines=function(a,Y,n){var W,V,p,I,l,N,D,X,Q,c,K,R,d=this,m=[d.findClosest({x:a.x,y:a.y},Y),d.findClosest({x:a.x+a.w/2,y:a.y+a.h/2},Y),d.findClosest({x:a.x+a.w,y:a.y+a.h},Y)],O={},o=d._87I;n=n||255;var A,w;for(d._guideLine=[],W=0;2>W;W++)for(O={},0===W?(I="y",X=a.x,Q=X+a.w):(I="x",X=a.y,Q=X+a.h),V=0;3>V;V++)l=m[V],l&&isFinite(l[I])&&(A=1<<3*W+V,n&A&&(N=l[I+"Line"],D=N.node,w=D._id||0,O[w]||(O[w]=!0,R=o[w],"y"===I?(c=R.x,K=R.x+R.width):(c=R.y,K=R.y+R.height),p=N.p,d._guideLine.push({type:I,a:X,b:Q,c:c,d:K,p:p,center:1===N.type}))))},Pi.prototype._binarySearchClosest=function(M,X){if(!X.length)return{dis:1/0};for(var Z,$=0,s=X.length-1;s-$>1;)Z=Math.floor(($+s)/2),X[Z].p<M?$=Z:s=Z;var p=X[$].p-M,b=X[s].p-M;return Math.abs(p)<=Math.abs(b)?{line:X[$],dis:p}:{line:X[s],dis:b}},Pi.prototype.findClosest=function(F,N,d){var T=this,u=T._interactor,p=u.gv,z=T._grid;d&&(F=um.toWorldPosition(p,F));var J,G=T._binarySearchClosest(F.x,z.x),h=T._binarySearchClosest(F.y,z.y),j=G.dis,g=h.dis,V=p._zoom,H=u.getStyle("smartGuideThreshold")/V,U={};return Math.abs(j)<H&&"y"!==N&&(U.x=d?j*V:j,U.xLine=G.line,J=!0),Math.abs(g)<H&&"x"!==N&&(U.y=d?g*V:g,U.yLine=h.line,J=!0),J?U:void 0},Pi.prototype._42=function(){var b=this,W=b._guideLine;if(W&&!A.Default.isCtrlDown()){var S=b._interactor;if(S.getStyle("guideLineVisible")){var Z,x,n,q,v,L,d,e,M,X,f,E,Y,r,I,P,t,u=S.gv,O=S._context,y=u.tx(),g=u.ty(),C=u._zoom,p=S.getStyle("guideLineTextSpacing");for(Z=0,x=W.length;x>Z;Z++)n=W[Z],e=n.type,M=n.p,X=n.a,f=n.b,E=n.c,Y=n.d,r=Math.min(X,E),I=Math.max(f,Y),"x"===e?(q=M*C+y,v=r*C+g,L=q,d=I*C+g):(q=r*C+y,v=M*C+g,L=I*C+y,d=v),um.Icons.DrawIcon(S,O,um.Icons.MoveLineGuide,{rect:[q,v,L,d],center:n.center}),Y>=X&&f>=E||(r=X>Y?Y:f,I=X>Y?X:E,t=I-r,"x"===e?(n.center2center||(q-=p,L=q),v=r*C+g,d=I*C+g,P=um.Icons.MoveLineGuideDistanceV):"y"===e&&(n.center2center||(v-=p,d=v),q=r*C+y,L=I*C+y,P=um.Icons.MoveLineGuideDistanceH),um.Icons.DrawIcon(S,O,P,{x0:q,y0:v,x1:L,y1:d,dis:t}))}}},Pi.prototype.clear=function(){this._guideLine=null};var Eb=um.Guide.Hover=function(b){var E=this;E._interactor=b};Eb.prototype={},Eb.prototype.constructor=Eb,b.defineProperties(Eb.prototype,{}),Eb.prototype._42=function(){var t=this._interactor;if(t.getStyle("hoverGuideVisible")&&!t.gvEditing){var S=t.hoverData,A=t.gv;if(!Dk(S)||A.isSelected(S))return t.hoverData=null,void 0;var R=Le(A,S),j=um.toScreenPosition(A,{x:R.x,y:R.y}),l=um.toScreenPosition(A,{x:R.x+R.width,y:R.y+R.height});um.Icons.DrawIcon(t,t._context,um.Icons.HoverDataRect,{min:j,max:l,color:t.getStyle("hoverGuideColor")||t.getStyle("baseColor"),borderWidth:t.getStyle("hoverGuideBorderWidth")||1,borderPattern:t.getStyle("hoverGuideBorderPattern")||[1,4]})}},um.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,rotateTipVisible:!0,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Gr=um.Icons={},fq=1e4,ls=null,fc=um.DefaultStyleMap.baseColor,dl="rgb(183,232,135)",Nf="rgb(255,204,153)",ci=6;A.Default.setImage("Icons.RectPoint",{width:ci,height:ci,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return fc}},rect:[0,0,ci,ci]}]}),Gr.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var e=Gr.GroupSubEntityRect.data;if(!e)return[];var b=e.min,$=e.max;return[b.x,b.y,b.x,$.y,$.x,$.y,$.x,b.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Gr.GroupSubEntityRect.data.isKeyOb?fc:fc}}}]};var Xj=4;Gr.HoverDataRect={comps:[{type:"shape",points:{func:function(){var I=Gr.HoverDataRect.data;if(!I)return[];var Z=I.min,J=I.max,i=Xj;return Z.x-=i,Z.y-=i,J.x+=i,J.y+=i,[Z.x,Z.y,Z.x,J.y,J.x,J.y,J.x,Z.y]}},segments:[1,2,2,2,5],background:null,borderWidth:{func:function(){return Gr.HoverDataRect.data.borderWidth}},borderColor:{func:function(){return Gr.HoverDataRect.data.color}},borderCap:"butt",borderPattern:{func:function(){return Gr.HoverDataRect.data.borderPattern}}}]},Gr.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Gr.Line.data.P1.x,Gr.Line.data.P1.y],ci,ci]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Gr.Line.data.P2.x,Gr.Line.data.P2.y],ci,ci]}}}]},Gr.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Gr.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Gr.Rect={comps:[{type:"shape",points:{func:function(){var X=Gr.Rect.data;if(!X)return[];var o=X.LT,z=X.LB,V=X.RB,p=X.RT;return[o.x,o.y,z.x,z.y,V.x,V.y,p.x,p.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return fc}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Gr.Rect.data.rotation}},rect:{func:function(){return[[Gr.Rect.data.LT.x,Gr.Rect.data.LT.y],ci,ci]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Gr.Rect.data.rotation}},rect:{func:function(){return[[Gr.Rect.data.LB.x,Gr.Rect.data.LB.y],ci,ci]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Gr.Rect.data.rotation}},rect:{func:function(){return[[Gr.Rect.data.RB.x,Gr.Rect.data.RB.y],ci,ci]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Gr.Rect.data.rotation}},rect:{func:function(){return[[Gr.Rect.data.RT.x,Gr.Rect.data.RT.y],ci,ci]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Gr.Rect.data.rotation}},visible:{func:function(){return Gr.Rect.data.L?!0:!1}},rect:{func:function(){return[[Gr.Rect.data.L.x,Gr.Rect.data.L.y],ci,ci]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Gr.Rect.data.rotation}},visible:{func:function(){return Gr.Rect.data.R?!0:!1}},rect:{func:function(){return[[Gr.Rect.data.R.x,Gr.Rect.data.R.y],ci,ci]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Gr.Rect.data.rotation}},visible:{func:function(){return Gr.Rect.data.T?!0:!1}},rect:{func:function(){return[[Gr.Rect.data.T.x,Gr.Rect.data.T.y],ci,ci]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Gr.Rect.data.rotation}},visible:{func:function(){return Gr.Rect.data.B?!0:!1}},rect:{func:function(){return[[Gr.Rect.data.B.x,Gr.Rect.data.B.y],ci,ci]}}}]};var oh=16;A.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return fc}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return fc}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Gr.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Gr.Anchor.data.POS.x,Gr.Anchor.data.POS.y],oh,oh]}}}]},Gr.TipShiftX=12,Gr.TipShiftY=12;var as=[8,28];Gr.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Gr.TipHelper.data.helperPos.x,Gr.TipHelper.data.helperPos.y,as[0]*Gr.TipHelper.data.size,as[1]]}},background:{func:function(){return ls.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Gr.TipHelper.data.text}},rect:{func:function(){return[Gr.TipHelper.data.helperPos.x,Gr.TipHelper.data.helperPos.y,as[0]*Gr.TipHelper.data.size,as[1]]}},color:{func:function(){return ls.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var nf=7;Gr.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!Gr.ShapePoint.data.dynamicVisible}},rect:{func:function(){var D=Gr.ShapePoint.data.point,V=Gr.ShapePoint.data.size||nf;return[D,V+10,V+10]}},background:{func:function(){var U=Date.now(),E=Gr.ShapePoint.data.dynamicPeriod||1500,y=Math.sin(U%E/E*Math.PI);return"rgba(27,124,22,"+.5*y+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var P=Gr.ShapePoint.data.point,R=Gr.ShapePoint.data.size||nf;return[P,R,R]}},background:{func:function(){var z=Gr.ShapePoint.data.isEnd;return z?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return Gr.ShapePoint.data.color||fc}}},{type:"rect",visible:{func:function(){return!!Gr.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return fc}},rect:{func:function(){var p=5;return[Gr.ShapePoint.data.point,p,p]}}}]},Gr.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!Gr.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return Gr.ShapeBgCurve.data.P}},segments:{func:function(){return Gr.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var r=Date.now(),n=Gr.ShapeBgCurve.data.dynamicPeriod||1500,$=Math.sin(r%n/n*Math.PI);return"rgba(27,124,22,"+.3*$+")"}}},{type:"shape",points:{func:function(){return Gr.ShapeBgCurve.data.P}},segments:{func:function(){return Gr.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return Gr.ShapeBgCurve.data.color||fc}}}]};var Bh=8;Gr.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var A=Gr.ShapeHighlighPoint.data;return[[A.x,A.y],Bh,Bh]}},background:{func:function(){return ls.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Rp=10;Gr.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var d=Gr.ShapeHighlighRealPoint.data;return[[d.x,d.y],Rp,Rp]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return fc}}}]};var ib=8;Gr.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var w=Gr.ShapeHighlighCtrlPoint.data,r=w.x,C=w.y,U=ib/2;return[r-U,C-U,r-U,C+U,r+U,C+U,r+U,C-U]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return ls.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return ls.getStyle("shapeCtrlPointBorderColor")||fc}}}]};var Tf=3;Gr.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Gr.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Tf,borderColor:{func:function(){return ls.getStyle("curveHighlightColor")}}}]},Gr.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Gr.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Gr.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Gr.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Gr.MoveLineGuide.data.center?dl:Nf}}}]};var ol=5;Gr.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var m=Gr.MoveLineGuideDistanceH.data,B=m.x0,T=m.y0;return[B,T-ol,B,T+ol]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Nf},{type:"shape",points:{func:function(){var y=Gr.MoveLineGuideDistanceH.data,v=y.x1,k=y.y1;return[v,k-ol,v,k+ol]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Nf},{type:"text",text:{func:function(){return Math.round(Gr.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var E=Gr.MoveLineGuideDistanceH.data;return[[(E.x0+E.x1)/2,E.y0-10],20,20]}},color:Nf,font:"12px Arial",align:"center"}]},Gr.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var D=Gr.MoveLineGuideDistanceV.data,F=D.x0,G=D.y0;return[F-ol,G,F+ol,G]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Nf},{type:"shape",points:{func:function(){var K=Gr.MoveLineGuideDistanceV.data,S=K.x1,B=K.y1;return[S-ol,B,S+ol,B]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Nf},{type:"text",text:{func:function(){return Math.round(Gr.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var v=Gr.MoveLineGuideDistanceV.data;return[[v.x0-10,(v.y0+v.y1)/2],20,20]}},color:Nf,font:"12px Arial",align:"center"}]},A.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Gr.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var A=Gr.EdgeElevationGuide.data,R=A.x,m=A.y,O=ls.getStyle("curveElevationIntersectSize"),a=ls.getStyle("curveElevationGuideShift");return R+=a[0],m+=a[1],[R-O,m-O,2*O,2*O]}}}]},A.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),A.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Gr.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Gr.ConnectGuide.data.rotation}},rect:{func:function(){var E=Gr.ConnectGuide.data.connect;E.x,E.y;var Z=ls.getStyle("connectGuideIntersectSize");return[[E.x,E.y],2*Z,2*Z]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var q=Gr.ConnectGuide.data.cursorPos||Gr.ConnectGuide.data.connect,$=ls.getStyle("connectGuideIntersectSize");return[[q.x,q.y],2*$-2,2*$-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var e=Gr.ConnectGuide.data.connect,x=Gr.ConnectGuide.data.cursorPos||e;return[e.x,e.y,e.x+.5*(x.x-e.x),e.y,x.x+.5*(e.x-x.x),x.y,x.x,x.y]}}}]},A.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),A.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Gr.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var U=Gr.ConnectGuideGarbage.data.hover;return U?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var x=Gr.ConnectGuideGarbage.data,J=ls.getStyle("connectGuideGarbageIntersectsize");return x.hover&&(J+=5),[[x.x,x.y],2*J,2*J]}}}]};var wr=6;Gr.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Gr.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var M=Gr.ShapeActivingCtrl.data;return[M.point.x,M.point.y,M.c1.x,M.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return fc}}},{type:"shape",visible:{func:function(){return Gr.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var y=Gr.ShapeActivingCtrl.data;return[y.point.x,y.point.y,y.c2.x,y.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return fc}}},{type:"shape",visible:{func:function(){return Gr.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var O=Gr.ShapeActivingCtrl.data.c1,e=O.x,D=O.y,W=wr/2;return"c1"===Gr.ShapeActivingCtrl.data.hl&&(W+=.5),[e-W,D-W,e-W,D+W,e+W,D+W,e+W,D-W]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return ls.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Gr.ShapeActivingCtrl.data.hl?ls.getStyle("shapeCtrlPointHighlightBorder")||fc:ls.getStyle("shapeCtrlPointBorderColor")||fc}}},{type:"shape",visible:{func:function(){return Gr.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var z=Gr.ShapeActivingCtrl.data.c2,i=z.x,T=z.y,d=wr/2;return"c2"===Gr.ShapeActivingCtrl.data.hl&&(d+=.5),[i-d,T-d,i-d,T+d,i+d,T+d,i+d,T-d]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return ls.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Gr.ShapeActivingCtrl.data.hl?ls.getStyle("shapeCtrlPointHighlightBorder")||fc:ls.getStyle("shapeCtrlPointBorderColor")||fc}}}]},Gr.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return fc}},rect:{func:function(){return[[Gr.RoundPoint.data.x,Gr.RoundPoint.data.y],ci,ci]}}}]},Gr.AttachPoint={comps:[{type:"rect",background:{func:function(){return Gr.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return fc}},rect:{func:function(){var b=Gr.AttachPoint.data.isAttach?ci+4:ci;return[[Gr.AttachPoint.data.x,Gr.AttachPoint.data.y],b,b]}}}]},Gr.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return Gr.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return Gr.SimpleRect.data.color||fc}},rect:{func:function(){var j=Gr.SimpleRect.data;return[j.x,j.y,j.width,j.height]}}}]},A.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),Gr.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var G=Gr.MoveDummy.data;
return[[G.pos.x,G.pos.y],2*G.size,2*G.size]}}}]},um.Icons.DrawIcon=function(n,e,Y,Q){Y.width=Y.height=fq,Y.data=Q,ls=n,A.Default.drawImage(e,Y,0,0,fq,fq),ls=r},um.Icons.MapPoints=function(X,U){for(var F=0,h=X.length;h>F;F++)X[F]/=U},um.roundTo=function(w,v,Y){var q=Math.abs(w%v);return Y>q||Y>v-q?v*Math.round(w/v):w},um.toFixed=function(s){return Math.round(100*s)/100},um.getDataMatrix=function(X){if(X instanceof A.Shape){var f=new A.Math.Matrix2d,y=X.getPosition();return f.translate(-y.x,-y.y).scale(X.getScale().x,X.getScale().y).rotate(X.getRotation()).translate(y.x,y.y),f}return X.getMatrix?X.getMatrix():new A.Math.Matrix2d};var Ch=um.Math.Curve=function(){this._curves=[]};Ch.prototype={},Ch.prototype.constructor=Ch,Ch.prototype.createFromHtShape=function(y,x,a){x instanceof A.List&&(x=x.toArray());var g,X,Q,Y,M,d,l,s=this,p=null,T=null,Z=0,z=um.Math.Vector2,q=um.Math.CubicBezier,I=function(g){return new z(y[g],y[g+1],a?a[g/2]:r)};for(X=0,Q=x.length;Q>X;X++){switch(Y=x[X],M=null,Y){case 1:T=I(Z),p=T,Z+=2;break;case 2:g=I(Z),Z+=2,M=new q(T,T.clone(),g.clone(),g),T=g;break;case 3:d=I(Z),g=I(Z+2),Z+=4,M=new q(T,d.clone().sub(T).multiplyScalar(2/3).add(T),d.clone().sub(g).multiplyScalar(2/3).add(g),g),T=g;break;case 4:d=I(Z),l=I(Z+2),g=I(Z+4),Z+=6,M=new q(T,d,l,g),T=g;break;case 5:if(!p)break;M=new q(T,T.clone(),p.clone(),p),T=null,p=null}M&&(M._index=s._curves.length,s._curves.push(M))}},Ch.prototype.checkPoint=function(T,F){var i,V,s,H,M,d=this,C=d._curves;for(i=0,V=C.length;V>i;i++)if(H=C[i],M=H.intersectRect(T,F,F),M.length)return s=0,M.forEach(function(D){s+=D.t}),s/=M.length,T=H.getPointAt(s),T.t=s,{bezier:H,intersection:T}},Ch.prototype.insertKnot=function(X,q){var L=X.insertKnot(q),p=this,u=p._curves;u.splice(X._index,1,L[0],L[1])},Ch.prototype._isCloseEnough=function(q,$){return Math.abs(q.x-$.x)<1e-6&&Math.abs(q.y-$.y)<1e-6},Ch.prototype._isSamePoint=function($,X){return $===X},Ch.prototype.moveRealPoint=function(v,Z){var $=this,w=$._curves,O=Z.clone().sub(v);w.forEach(function(n){var Q=n._p1;n._p2,n._p3;var T=n._p4;$._isSamePoint(Q,v)&&(n._p2.add(O),n._p1=Z),$._isSamePoint(T,v)&&(n._p3.add(O),n._p4=Z)})},Ch.prototype.moveCtrlDueToRealPointMovement=function(I,g){var Q=this,e=Q._curves,a=function($){$.add(g),$.e&&g.e&&($.e+=g.e)};e.forEach(function(T){var G=T._p1;T._p2,T._p3;var P=T._p4;Q._isSamePoint(G,I)&&a(T._p2),Q._isSamePoint(P,I)&&a(T._p3)})},Ch.prototype.moveCtrlPoint=function(x,K,v){var A=x[v];if(A){A.e!==r&&(K.e=A.e);var q=this,a=q._curves;K.clone().sub(A),a.forEach(function(O){var B;"c2"===v?B="_p2":"c1"===v&&(B="_p3"),q._isSamePoint(O[B],A)&&(O[B]=K)}),x[v]=K}},Ch.prototype.deleteRealPoint=function(W,Y){var O,q,h,R,T,X,s,v=this,c=v._curves,V={},L=[],d=um.Math.CubicBezier;for(q=0,h=c.length;h>q;q++)O=c[q],R=O._p1,T=O._p2,X=O._p3,s=O._p4,(V[q]||!v._isSamePoint(R,W))&&(v._isSamePoint(s,W)?h>q+1&&v._isSamePoint(c[q+1]._p1,W)&&(Y||L.push(new d(R,T,c[q+1]._p3,c[q+1]._p4))):L.push(O));v._curves=L},Ch.prototype.findPairs=function(J,N){var w,x,$,h,a,M,b,v,X=this,p=X._curves,S={},F=[];for(x=0,$=p.length;$>x;x++)w=p[x],h=w._p1,a=w._p2,M=w._p3,b=w._p4,!S[x]&&X._isSamePoint(h,J)&&(N?F.push({point:h,r2:b}):F.push({point:h,c2:a})),X._isSamePoint(b,J)&&(v=N?{point:b,r1:h}:{point:b,c1:M},$>x+1&&X._isSamePoint(p[x+1]._p1,J)&&(N?v.r2=p[x+1]._p4:v.c2=p[x+1]._p2,S[x+1]=!0),F.push(v));return F},Ch.prototype.toHtShape=function(){var S=this,C=S._curves,n=[],$=[],P={x:1/0,y:1/0};return C.forEach(function(D){var Z=D._p1,s=D._p2,U=D._p3,N=D._p4;return S._isCloseEnough(Z,P)||(n.push(1),$.push(Z.clone())),P=N,S._isCloseEnough(Z,s)&&S._isCloseEnough(U,N)?(n.push(2),$.push(N.clone()),void 0):(n.push(4),$.push(s.clone(),U.clone(),N.clone()),void 0)}),{segments:n,points:$}};var im=um.Math.CubicBezier=function(n,B,F,u){var k=this;k._id=um.Math.CubicBezier._globalId++,k._p1=n,k._p2=B,k._p3=F,k._p4=u};im._globalId=1,im.prototype={},im.prototype.constructor=im,im.prototype.toString=function(){return this._id},im.prototype.intersectRect=function(T,V,u){var X=V/2,J=u/2,C=T.x,w=T.y,_=um.Math.Vector2,c=new _(-X+C,-J+w),g=new _(X+C,J+w),Q=new _(g.x,c.y),S=new _(c.x,g.y),t=this,M=t.intersectLine(c,Q),b=t.intersectLine(Q,g),H=t.intersectLine(g,S),P=t.intersectLine(S,c),s=M.concat(b).concat(H).concat(P);return s},im.prototype.intersectLine=function(Q,R){var y,m,w,K,s,e,V,P,F,g,O,n,k,B=this,X=Q.clone().min(R),T=Q.clone().max(R);K=B._p1,s=B._p2,e=B._p3,V=B._p4,y=K.clone().multiplyScalar(-1),m=s.clone().multiplyScalar(3),w=e.clone().multiplyScalar(-3),O=y.add(m).add(w).add(V),y=K.clone().multiplyScalar(3),m=s.clone().multiplyScalar(-6),w=e.clone().multiplyScalar(3),g=y.add(m).add(w),y=K.clone().multiplyScalar(-3),m=s.clone().multiplyScalar(3),F=y.add(m),P=K.clone(),k=new um.Math.Vector2(Q.y-R.y,R.x-Q.x),n=Q.x*R.y-R.x*Q.y;for(var r=B.getRoots(k.dot(O),k.dot(g),k.dot(F),k.dot(P)+n),i=new Array,D=0,L=r.length;L>D;D++){var A=r[D];if(!(0>A||A>1)){var a=B.getPointAt(A);a.t=A,Q.x==R.x?X.y<=a.y&&a.y<=T.y&&i.push(a):Q.y==R.y?X.x<=a.x&&a.x<=T.x&&i.push(a):a.x>=X.x&&a.y>=X.y&&a.x<=T.x&&a.y<=T.y&&i.push(a)}}return i},im.prototype.solveTForPoint=function(_){var X,B,v,b,c=this;X=c._p1.x-_.x,B=c._p2.x-_.x,v=c._p3.x-_.x,b=c._p4.x-_.x;for(var H=c.getRoots(b-3*v+3*B-X,3*v-6*B+3*X,3*B-3*X,X),V=r,n=1/0,j=0,i=H.length;i>j;j++){var G=H[j];if(!(0>G||G>1)){var k=c.getPointAt(G);k.t=G;var U=Math.abs(k.y-_.y);n>U&&(n=U,V=k)}}return V},im.prototype.getPointAt=function(E){var r=this,T=r._p1,Y=r._p2,M=r._p3,f=r._p4,G=T.clone().lerp(Y,E),d=Y.clone().lerp(M,E),P=M.clone().lerp(f,E),x=G.lerp(d,E),w=d.lerp(P,E);return x.lerp(w,E)},im.prototype.getPointByPercentage=function(C){var t=this.length*C,e=this._cacheLength,L=e.length;if(0===t)return e[0].point;if(C>=1)return e[L-1].point;for(var r=0;L>r;r++){var H=e[r];if(!(H.len<t)){var v=e[r-1];return H.point.clone().sub(v.point).setLength(t-v.len).add(v.point)}}},im.prototype.getTByPercentage=function(x){var q=this.length*x,l=this._cacheLength,t=l.length;if(0===q||0>=x)return l[0].t;if(x>=1)return l[t-1].t;for(var o=0;t>o;o++){var N=l[o];if(!(N.len<q)){var P=l[o-1];return(q-P.len)/(N.len-P.len)*(N.t-P.t)+P.t}}},im.prototype.getRoots=function(M,u,B,L){var D,p,Q,W,q,J=new Array;if(Math.abs(M)<1e-6){var D=u,p=B/D,Q=L/D,W=p*p-4*Q;if(W>0){var q=Math.sqrt(W);J.push(.5*(-p+q)),J.push(.5*(-p-q))}else 0==W&&J.push(.5*-p)}u/=M,B/=M,L/=M,D=(3*B-u*u)/3,p=(2*u*u*u-9*B*u+27*L)/27;var N=u/3,S=p*p/4+D*D*D/27,X=p/2;if(Math.abs(S)<=1e-6&&(S=0),S>0){var s,h,q=Math.sqrt(S);s=-X+q,h=s>=0?Math.pow(s,1/3):-Math.pow(-s,1/3),s=-X-q,s>=0?h+=Math.pow(s,1/3):h-=Math.pow(-s,1/3),J.push(h-N)}else if(0>S){var U=Math.sqrt(-D/3),a=Math.atan2(Math.sqrt(-S),-X)/3,g=Math.cos(a),R=Math.sin(a),i=Math.sqrt(3);J.push(2*U*g-N),J.push(-U*(g+i*R)-N),J.push(-U*(g-i*R)-N)}else{var s;s=X>=0?-Math.pow(X,1/3):Math.pow(-X,1/3),J.push(2*s-N),J.push(-s-N)}return J},im.prototype._70I=function(){var o=this;return o._p1.distanceToSquared(o._p2)<1e-10&&o._p3.distanceToSquared(o._p4)<1e-10},im.prototype.insertKnot=function(X){var _=this,S=_._p1,f=_._p2,C=_._p3,y=_._p4,m=S.clone().lerp(f,X),M=f.clone().lerp(C,X),r=C.clone().lerp(y,X),n=m.clone().lerp(M,X),L=M.clone().lerp(r,X),o=n.clone().lerp(L,X);return _._70I()?(S.clone().lerp(y,X),[new um.Math.CubicBezier(S,S.clone(),o.clone(),o),new um.Math.CubicBezier(o,o.clone(),y.clone(),y)]):[new um.Math.CubicBezier(S,m,n,o),new um.Math.CubicBezier(o,L,r,y)]},b.defineProperties(im.prototype,{length:{get:function(){var w=this._cacheLength;if(!w){w=this._cacheLength=[];for(var V=this._p1,$=0,y=0;1>=$;){var c=this.getPointAt($+=.001);y+=c.clone().sub(V).length(),V=c,w.push({len:y,t:$,point:c.clone()})}}return w[w.length-1].len}},p1:{get:function(){return this._p1},set:function(C){this._p1=C,this._cacheLength=r}},p2:{get:function(){return this._p2},set:function(y){this._p2=y,this._cacheLength=r}},p3:{get:function(){return this._p3},set:function(i){this._p3=i,this._cacheLength=r}},p4:{get:function(){return this._p4},set:function(t){this._p4=t,this._cacheLength=r}}});var Sb=A.Default.getInternal().ui().EdgeUI,Eg={_47O:function(D){var t=this,O=Eg.getBackups()._47O;um.inEdit(t.gv)||O.call(t,D)}};um.Inject.registAsModule(Eg,Sb);var _o=A.Default.getInternal().ui().NodeUI,eh={_47O:function(I){var E=this,d=eh.getBackups()._47O;um.inEdit(E.gv)||d.call(E,I)},getSelectWidth:function(){var c=this,K=c.gv,z=c._data;if(K.isEditable(z)&&um.inEdit(K))return 0;var m=eh.getBackup("getSelectWidth");return m.call(c)}};um.Inject.registAsModule(eh,_o);var Fb=A.graph.GraphView,wl={_editPointSize:function(){var M=A.Default.isTouchable,Y=um.getStyle("pointSize");return Y[M?0:1]}(),isPointEditable:function(A){var S=this;if(um.inEdit(S))return S._pointEditableFunc?S._pointEditableFunc(A):!0;var C=wl.getBackup("isPointEditable");C.call(S,A)},isEditable:function(V){var r,e=this,G=wl.getBackup("isEditable");if(r=V instanceof um.Group?!0:G.call(e,V),!um.inEdit(e))return r;if(!(V instanceof A.Edge))return r;if(!V.s("2d.editable"))return!1;var Q=e.getEditableFunc();return Q?Q(V):!0},_42:function(b,q){var _=this,M=wl.getBackups()._42;if(M.call(_,b,q),um.inEdit(_)){var P=_.getEditInteractor();P.drawImpl()}}};um.Inject.registAsModule(wl,Fb);var Bo=A.Default.getInternal().ui().ShapeUI,tn={_47O:function(h){var I=this,r=tn.getBackups()._47O;um.inEdit(I.gv)||r.call(I,h)}};um.Inject.registAsModule(tn,Bo);var cr=A.graph.DefaultInteractor,ij={handle_mousewheel:function(w){var $=this,V=ij.getBackup("handle_mousewheel");um.inEdit($.gv)||V.call($,w)}};um.Inject.registAsModule(ij,cr);var bo=A.graph.MoveInteractor,vh={_calcShift:function(g,S){var u=this,E=vh.getBackup("_calcShift"),$=u.gv;if(!um.inEdit($))return E.call(u,g,S);var I=$.getEditInteractor(),V=I.getSubModule("Move").calcShift(g,S,u);return V||E.call(u,g,S)},clear:function(C){var E=this,D=vh.getBackup("clear");D.call(E,C);var L=E.gv;if(um.inEdit(L)){var R=L.getEditInteractor();R.getSubModule("Move").clear(C)}}};um.Inject.registAsModule(vh,bo);var Pi=um.Rect=function(r){this.catalog="Rect",this._interactor=r};Pi.prototype={},Pi.prototype.constructor=Pi,Pi.prototype.gatherInfo=function(h,R){var l=this;if(1===R.length){var i=R[0];return i instanceof A.Shape&&i._70I()?l.gatherLine(h,i):Ec(i,h)?!1:l.gatherSingleTarget(h,i)}return R.length>1?l.gatherMultiTargets(h,R):!1},Pi.prototype.gatherSingleTarget=function(j,d){if(d.getCorners){var h,M=this,v=M.info;M.target=d,h=M.screenInfo={};var Z=d.getCorners();v.LT=new um.Math.Vector2(Z[0]),v.LB=new um.Math.Vector2(Z[1]),v.RB=new um.Math.Vector2(Z[2]),v.RT=new um.Math.Vector2(Z[3]),v.T=v.LT.clone().add(v.RT).divideScalar(2),v.B=v.LB.clone().add(v.RB).divideScalar(2),v.L=v.LT.clone().add(v.LB).divideScalar(2),v.R=v.RT.clone().add(v.RB).divideScalar(2);for(var y in v)h[y]=um.toScreenPosition(j,v[y]);var R=M._interactor,U=R.getStyle("checkSize"),a=function(w,L,s){var i=L.clone().sub(w).setLength(-U),l=s.clone().sub(w).setLength(-U),H=i.add(l).add(w);return H};return h.rotLT=a(h.LT,h.RT,h.LB),h.rotLB=a(h.LB,h.LT,h.RB),h.rotRB=a(h.RB,h.LB,h.RT),h.rotRT=a(h.RT,h.LT,h.RB),h.rotT=h.rotLT.clone().add(h.rotRT).divideScalar(2),h.rotB=h.rotLB.clone().add(h.rotRB).divideScalar(2),h.rotL=h.rotLT.clone().add(h.rotLB).divideScalar(2),h.rotR=h.rotRT.clone().add(h.rotRB).divideScalar(2),h.rotation=d.getRotation(),M.gatherConnectInfo(),!0}},Pi.prototype.gatherConnectInfo=function(){var K=this,S=K.target,B=K._interactor,X=K.screenInfo,J=B.gv;if(J.isConnectActionVisible(S)&&B.getStyle("connectGuideVisible")){var n;S.s&&(n=S.s("connectGuideShift")),n||(n=B.getStyle("connectGuideShift"));var A=S.getAnchor(),N=S.getSize(),G=S.toGlobal({x:N.width*(n[0]-A.x),y:N.height*(n[1]-A.y)});G=um.toScreenPosition(J,G),X.P1?G.add(X.P2.clone().sub(X.P1).setLength(n[2])):(G.add(X.RT.clone().sub(X.LT).setLength(n[2])),G.add(X.LB.clone().sub(X.LT).setLength(n[3]))),X.connect=G}},Pi.prototype.gatherMultiTargets=function(g,p){var s=um.Group.findOrCreateGroup(p,this._interactor._uuid);if(!s)return!1;var E=this;return E.editing&&"rotate"!==E.editing.mode||s.calcInfo(),E.gatherSingleTarget(g,s)},Pi.prototype.gatherLine=function(m,t){this.target=t;var H=this.screenInfo={},g=t.getPoints(),f=um.getDataMatrix(t);return H.P1=um.toScreenPosition(m,f.apply(g.get(0))),H.P2=um.toScreenPosition(m,f.apply(g.get(1))),this.gatherConnectInfo(),!0},Pi.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Pi.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Pi.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Pi.prototype.check=function(U,c,$){if(A.Default.isLeftButton(c)){var _=this;if(_.editing=null,_.tipInfo=null,_.screenInfo){var J=_.target,O=U.isEditable(J),p=_.screenInfo;if(O&&p.connect){var M=_._checkConnect($);if(M)return M}if(p.P1)return _._checkLine($);var T,E,D,g=null,Y=_._interactor,q=Y.getStyle("checkSize");if(O&&U.isRectEditable(J))for(E=0;E<um.Rect.ResizeKeys.length;E++)if(D=um.Rect.ResizeKeys[E],um.checkHit($,p[D],q)){g=D,T="resize";break}if(!g&&O&&U.isRotationEditable(J)&&!Y.getStyle("rotateAsClock")){var G=Y.getStyle("rotateCheckSize");for(E=0;E<um.Rect.RotateKeys.length;E++)if(D=um.Rect.RotateKeys[E],um.checkHit($,p[D],G)){g=D,T="rotate";break}}if(!g)return Y.setCursor("default"),void 0;if("rotate"===T){var u,e=U.lp(c);if(J instanceof um.Group){var I=Y.getStyle("groupRotateModeKey");"string"==typeof I&&(I=[I]);for(var r=!1,a=0,H=I.length;H>a;a++)if(c[I[a]]){r=!0;break}var d=Y.getStyle("groupRotateModeDefault");u=r?"batch"===d?"block":"batch":d}var j="batch"===u?J.getAnchor2():J.getPosition(),m=Math.atan2(e.y-j.y,e.x-j.x);Y._setRotateCursor(m),_.editing={mode:T,key:g,pos:j,flipY:J.getScale().y<0,rotation:J.getRotation(),hitRot:m},u&&(_.editing.groupRotateMode=u)}else{var N=um.Rect.ResizeKeys.indexOf(g),Z=um.Rect.ResizeDirection[N],i=Math.cos(J.getRotation()),W=Math.sin(J.getRotation()),w=Z.x*Math.sign(J.getScale().x),o=Z.y*Math.sign(J.getScale().y),x=Math.atan2(-W*w-i*o,i*w-W*o),Q=(Math.round(x/(Math.PI/4))+8)%8,C=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][Q];this._interactor.setCursor(C);var l=J.getWidth(),P=J.getHeight(),B=J.getAnchor();_.editing={mode:T,key:g,rect:{x:-l*B.x,y:-P*B.y,width:l,height:P},anchor:B,matrix:J.getMatrix()}}return g}}},Pi.prototype._checkLine=function(X){var c=this;c.screenInfo;var Q,T=c._interactor.getStyle("checkSize");if(um.checkHit(X,c.screenInfo.P1,T))Q="P1";else{if(!um.checkHit(X,c.screenInfo.P2,T))return this._interactor.setCursor("default"),void 0;Q="P2"}return c.editing={mode:"line",key:Q},Q},Pi.prototype._checkConnect=function(L){var C=this,y=C.screenInfo,X=C._interactor,J=X.getStyle("connectGuideIntersectSize"),w=y.connect,O=L.x,$=w.x;if($>O&&J>$-O&&Math.abs(w.y-L.y)<J||O>=$&&um.checkHit(L,w,J)){var E="connect",b=u.getConnectAction(X.gv);if(C.editing={mode:E},b&&b.delete)if(C.target instanceof um.Group){var U=!0;X.gv.sm().getSelection().each(function(c){b.delete.visible.call(null,X.gv,c)||(U=!1)}),C.editing.hasDeleteAction=U}else b.delete.visible.call(null,X.gv,C.target)&&(C.editing.hasDeleteAction=!0);return X.setCursor("default"),E}},Pi.prototype._fireEditEvent=function(w,L){var U=this._interactor,z=this.editing;if(z){var N=z.mode;N="rotate"===N?"Rotation":"connect"===N?"Connection":"resize"===N?"Rect":N[0].toUpperCase()+N.slice(1),U.fi({kind:w+"Edit"+N,event:L})}},Pi.prototype.startEdit=function(Z,O){Z.startDragging(O);var q=this;q._interactor.fi({kind:"prepareEdit",event:O});var r=q.editing,B=q.target;if(r){if(q._fireEditEvent("begin",O),r.started=!0,"rotate"===r.mode)return r.groupRotateMode&&B.beginRotate(r),Z._42(),void 0;if("connect"!==r.mode)("line"===r.mode||B&&0===B.getRotation())&&(q._inSmartGuide=!0,q._interactor.rectGuide.gatherRects());else if(r.hasDeleteAction){var K=Z.gv,W=q._interactor.getStyle("connectGuideGarbageShift");r.garbageInfo={x:K.getWidth()*W[0]+W[2],y:K.getHeight()*W[1]+W[3],size:q._interactor.getStyle("connectGuideGarbageIntersectsize")},Z._42()}}},Pi.prototype._46O=function(E){var O,P,J=this,m=J.editing,S=J.target;if(m){if("connect"===m.mode&&!m.canceled&&!m.deleted)try{m.garbageInfo&&m.garbageInfo.hover?u.doDeleteConnectionAction(J._interactor.gv,S):u.doConnectAction(J._interactor.gv,S,m.target)}catch(X){console.error(X)}P=m.freezeFlag,O=J.editing.groupRotateMode,J._fireEditEvent("end",E),J.editing=null}J.tipInfo=null,J._inSmartGuide&&(J._interactor.rectGuide.clear(),J._inSmartGuide=!1),O&&S&&S.endRotate(),S instanceof A.Block&&(P===r?delete S._freezeSyncFromChildren:S._freezeSyncFromChildren=P,S.updateFromChildren())},Pi.prototype.handleNormalStateDelete=function(){var K=this,A=K.editing;if(A&&"connect"===A.mode&&!A.canceled&&!A.deleted){if(A.garbageInfo){try{u.doDeleteConnectionAction(K._interactor.gv,K.target)}catch(m){console.error(m)}A.garbageInfo=null}return A.cursorPos=null,A.targetCorners=null,A.deleted=!0,K._interactor._42(),!0}},Pi.prototype.handleNormalStateKeyDown=function(s){var U=this,P=U.editing;return!P||"connect"!==P.mode||P.canceled||P.deleted?void 0:A.Default.isEsc(s)?(P.cursorPos=null,P.targetCorners=null,P.canceled=!0,U._interactor._42(),!0):void 0},Pi.prototype.handleEdit=function(W,Q){var j=this,c=j.editing;if(c){var n,C,d,h,k,V=j.target,Y=c.key,o=c.mode,b=W.lp(Q),N=j._interactor;if("connect"===o){if(c.canceled)return;if(c.deleted)return;c.cursorPos=N._getLogicalPoint(Q);var L=c.garbageInfo;return L&&um.checkHit(c.cursorPos,L,L.size)?(L.hover=!0,c.target=null,c.targetCorners=null):(L&&(L.hover=!1),c.target=W.getDataAt(b,function(R){return W.isSelectable(R)?Dk(R)?!0:!1:!1})||null,c.targetCorners=um.getTargetCornersOnScreen(W,c.target)),N._42(),void 0}if("rotate"===o){var x,P,v=c.pos,r=Math.atan2(b.y-v.y,b.x-v.x);if(c.groupRotateMode?P=r-c.hitRot:(x=r-c.hitRot,P=c.rotation+x),P%=2*Math.PI,0>P&&(P+=2*Math.PI),!A.Default.isCtrlDown(Q)){var u,p;Ng(Q)?(u=N.getStyle("shiftRotateRound"),p=u/2):(u=N.getStyle("rotateRound"),p=N.getStyle("rotateSensitivity")),P=um.roundTo(P,u,p)}c.groupRotateMode?(x=P-(c.lastRotation||0),0!==x&&(V.addRotation(x,c.groupRotateMode,function(d){return W.isRotationEditable(d)}),c.lastRotation=P)):V.setRotation(P),N._setRotateCursor(r),P>Math.PI&&(P-=2*Math.PI);var E=180*(P/Math.PI);E=E.toFixed(2),n=""+E+"°"}else if("resize"===o){var f=c.rect;d=f.x,h=f.y;var q,H=f.width,z=f.height,s=c.anchor,D=c.matrix,t=V.s&&V.s("keepAspectRatio")||N.getStyle("keepAspectRatio");Ng(Q)&&(t=!t);var g=j._unionPointMode1,R=j._unionPointMode2;if(j._inSmartGuide&&!A.Default.isCtrlDown(Q)&&!t){var O;"L"===Y||"R"===Y?O="x":("T"===Y||"B"===Y)&&(O="y"),j._adsorbedToClosest(b,O),k=!0}q=D.tfi(b);var J;"LT"===Y?(f=g(q,{x:d+H,y:h+z},H,z,t),J=9):"T"===Y?(f=R({x:d,y:q.y},{x:d+H,y:h+z},H,z,t,"v"),J=1):"RT"===Y?(f=g(q,{x:d,y:h+z},H,z,t),J=33):"L"===Y?(f=R({x:q.x,y:h},{x:d+H,y:h+z},H,z,t,"h"),J=8):"R"===Y?(f=R({x:d,y:h},{x:q.x,y:h+z},H,z,t,"h"),J=32):"LB"===Y?(f=g(q,{x:d+H,y:h},H,z,t),J=12):"B"===Y?(f=R({x:d,y:h},{x:d+H,y:q.y},H,z,t,"v"),J=4):"RB"===Y&&(f=g(q,{x:d,y:h},H,z,t),J=36);var I=D.tf(f.x+f.width*s.x,f.y+f.height*s.y);V instanceof A.Block&&(c.hasOwnProperty("freezeFlag")||(c.freezeFlag=V._freezeSyncFromChildren,V._freezeSyncFromChildren=!0)),V.setPosition(I),V.setSize(f.width,f.height),k&&(C=V.getRect(),N.rectGuide.gatherLines({node:V,x:C.x,y:C.y,w:C.width,h:C.height},O,J)),n=""+Math.round(f.width)+" * "+Math.round(f.height)}else if("line"===o){if(Ng(Q)){var i=V.getPoints(),$="P1"===Y?i.get(1):i.get(0),_={x:b.x-$.x,y:b.y-$.y},F=N.getStyle("shiftLineRotateRound"),T=j._shiftDirList;if(!T||j._shiftRotateRound!==F){j._shiftRotateRound=F,j._shiftDirList=T=[];for(var l=0;l<Math.PI;l+=F)T.push({x:X(l),y:m(l)})}for(var B,M=0,G=0,U=T.length;U>G;G++){var e=T[G],K=e.x*_.x+e.y*_.y;Math.abs(K)>Math.abs(M)&&(M=K,B=e)}b={x:$.x+B.x*M,y:$.y+B.y*M},N.rectGuide.clear()}else j._inSmartGuide&&!A.Default.isCtrlDown(Q)&&(j._adsorbedToClosest(b),k=!0);var y=um.getDataMatrix(V).applyInverse(b);V.setPoint("P1"===Y?0:1,y,!0);var S=V.getPoints(),Z=S.get(0),a=S.get(1);d=Z.x-a.x,h=Z.y-a.y,n=" "+Math.round(Math.sqrt(d*d+h*h))+" ",k&&(C=V.getRect(),N.rectGuide.gatherLines({node:V,x:C.x,y:C.y,w:C.width,h:C.height}))}if(n){var w=A.Default.getLogicalPoint(Q,N._canvas);w.x+=um.Icons.TipShiftX,w.y+=um.Icons.TipShiftY,j.tipInfo={helperPos:w,text:n,size:n.length}}j._fireEditEvent("between",Q)}},Pi.prototype._unionPointMode1=function(j,x,F,d,Y){if(Y&&F&&d){var U=j.x-x.x,D=j.y-x.y;Math.abs(U*d)<Math.abs(D*F)?(D=Math.sign(D)*Math.abs(U*d/F),j.y=x.y+D):(U=Math.sign(U)*Math.abs(D*F/d),j.x=x.x+U)}return A.Default.unionPoint(j,x)},Pi.prototype._unionPointMode2=function(U,p,B,G,P,d){var i=A.Default.unionPoint(U,p);if(P&&B&&G){var k;"v"===d?(k=i.x+i.width/2,i.width=B*i.height/G,i.x=k-i.width/2):(k=i.y+i.height/2,i.height=G*i.width/B,i.y=k-i.height/2)}return i},Pi.prototype._adsorbedToClosest=function(X,H){var n=this,O=n._interactor,p=O.rectGuide.findClosest(X,H),V=O.gridGuide.findClosest(X,H),w=1/0,T=1/0;p&&(isFinite(p.x)&&(w=p.x),isFinite(p.y)&&(T=p.y)),V&&(isFinite(V.x)&&Math.abs(V.x)<Math.abs(w)&&(w=V.x),isFinite(V.y)&&Math.abs(V.y)<Math.abs(T)&&(T=V.y)),isFinite(w)&&(X.x+=w),isFinite(T)&&(X.y+=T)},Pi.prototype._42=function(L,T,F){var Z=this;Z.info={},Z.screenInfo=null;var d=Z._interactor;if(!d.editDetail&&Z.gatherInfo(T,F)){var b=Z.editing,o=b?b.groupRotateMode:null,x=Z.screenInfo;if("block"!==o||!b||!b.started){if(x.P1?um.Icons.DrawIcon(d,L,um.Icons.Line,x):um.Icons.DrawIcon(d,L,um.Icons.Rect,x),x.connect&&(um.Icons.DrawIcon(d,L,um.Icons.ConnectGuide,{rotation:x.rotation,connect:x.connect,cursorPos:b?b.cursorPos:null}),b)){if(b.targetCorners){for(var R={x:1/0,y:1/0},r={x:-1/0,y:-1/0},V=0,c=b.targetCorners.length;c>V;V+=2)R.x=Math.min(R.x,b.targetCorners[V]),r.x=Math.max(r.x,b.targetCorners[V]),R.y=Math.min(R.y,b.targetCorners[V+1]),r.y=Math.max(r.y,b.targetCorners[V+1]);um.Icons.DrawIcon(d,L,um.Icons.HoverDataRect,{min:R,max:r,color:d.getStyle("hoverGuideColor")||d.getStyle("baseColor")})}b.garbageInfo&&um.Icons.DrawIcon(d,L,um.Icons.ConnectGuideGarbage,b.garbageInfo)}d.getStyle("rotateTipVisible")&&Z.tipInfo&&um.Icons.DrawIcon(d,L,um.Icons.TipHelper,Z.tipInfo)}Z.target instanceof um.Group&&Z.target._42(d,L,T)}};var zc=um.Anchor=function(q){this.catalog="Anchor",this._interactor=q};zc.prototype={},zc.prototype.constructor=zc,zc.prototype.gatherInfo=function(M,b){var m=this;if(1===b.length){var d=b[0];if(!d.getAnchor)return;if(d instanceof A.Shape&&d._70I())return;if(Ec(d,M))return;return m.gatherSingleTarget(M,b[0])}return b.length>1?m.gatherMultiTargets(M,b):!1},zc.prototype.gatherSingleTarget=function(g,u){var C=this;return C.info.POS=u.getPosition(),C.screenInfo.POS=um.toScreenPosition(g,C.info.POS),C.target=u,!0},zc.prototype.gatherMultiTargets=function(p,q){var c=this,s=um.Group.findOrCreateGroup(q,this._interactor._uuid);return s?(c.screenInfo.POS=um.toScreenPosition(p,s.getAnchor2()),c.target=s,!0):!1},zc.prototype.isVisible=function(){var V=this,I=V._interactor;if(I.getStyle("anchorVisible")===!1)return!1;var y=V.target;if(y){if(this.editing)return!0;var f=y.getAnchor(),j=I.getStyle("anchorOutsideVisibleThreshold");if(f.x<-j||f.x>1+j||f.y<-j||f.y>1+j)return!0;var Z=y.getSize(),E=y.getScale(),J=Math.min(Math.abs(Z.width*E.x),Math.abs(Z.height*E.y));if(J*I.gv._zoom<I.getStyle("anchorHideThreshold"))return!1}return!0},zc.prototype.check=function(w,I,b){if(A.Default.isLeftButton(I)){var M=this,l=M._interactor;if(M.isVisible()&&l.getStyle("anchorMovable")!==!1){M.editing=null,M.tipInfo=null;var R=M.target;if(R&&w.isAnchorEditable(R)&&w.isEditable(R)){var m;if(M.screenInfo&&(m=M.screenInfo.POS)&&um.checkHit(b,new um.Math.Vector2(m),l.getStyle("checkSize"))){if(R instanceof um.Group)return M.editing={},!0;var L=R.getWidth(),J=R.getHeight(),o=R.getAnchor();return M.editing={rect:{x:-L*o.x,y:-J*o.y,width:L,height:J},anchor:o,matrix:R.getMatrix()},!0}}}}},zc.prototype.startEdit=function(G,n){G.startDragging(n),G.fi({kind:"beginEditAnchor",event:n})},zc.prototype._46O=function(x){var R=this;R.editing&&(R.editing=null,R._interactor.fi({kind:"endEditAnchor",event:x})),R.tipInfo=null},zc.prototype.handleEdit=function(k,z){var c=this,P=c.target;if(P){var D=c.editing;if(D){var V=k.lp(z),I=c._interactor;if(P instanceof um.Group)return P.setAnchor2(V),I._42(),void 0;var e=D.matrix,o=e.tfi(V),_=D.rect,v=(o.x-_.x)/_.width,h=(o.y-_.y)/_.height;if(!A.Default.isCtrlDown(z)){var O=I.getStyle("anchorRound"),t=I.getStyle("anchorSensitivity");v=um.roundTo(v,O,t),h=um.roundTo(h,O,t)}P.setAnchor(v,h,!0);var d=A.Default.getLogicalPoint(z,I._canvas);d.x+=um.Icons.TipShiftX,d.y+=um.Icons.TipShiftY;var H=""+v.toFixed(2)+", "+h.toFixed(2);c.tipInfo={helperPos:d,text:H,size:H.length},I.fi({kind:"betweenEditAnchor",event:z})}}},zc.prototype._42=function(x,t,l){var B=this;B.info={},B.screenInfo={};var p=B._interactor;p.editDetail||B.gatherInfo(t,l)&&B.isVisible()&&(um.Icons.DrawIcon(p,x,um.Icons.Anchor,B.screenInfo),B.tipInfo&&um.Icons.DrawIcon(p,x,um.Icons.TipHelper,B.tipInfo))};var Yi=um.MoveDummy=function(o){this.catalog="MoveDummy",this._interactor=o};Yi.prototype={},Yi.prototype.constructor=Yi,Yi.prototype.gatherInfo=function(){var T=this,Q=this._interactor.getSubModule("Rect");if(Q){var Z=Q.screenInfo;if(Z){var u=T._interactor,_=T.getMovableTarget(Q.target);if(_){var z=u.getStyle("moveDummyThreshold");if(z!==!1){var G=Z.LT||Z.P1,E=Z.RT||Z.P2,p=Z.LB||G;if(G){var q=Z.P1,j=Math.min(G.distanceTo(p),G.distanceTo(E));if(!(z!==!0&&j>z)){var I=u.getStyle("moveDummyPosition"),R=E.clone().sub(G),v=p.clone().sub(G),b=I[2],$=I[3];if(q){var e=u.getStyle("moveDummyLineExtraShift");e&&(b+=e[0],$+=e[1])}var U=G.clone().add(R.clone().multiplyScalar(I[0])).add(R.setLength(b)).add(v.clone().multiplyScalar(I[1])).add(v.setLength($));return T.screenInfo.pos=U,T.screenInfo.size=u.getStyle("moveDummySensitivity"),!0}}}}}}},Yi.prototype.getMovableTarget=function(w){var r=this._interactor.gv;if(Dk(w)){if(r.isMovable(w))return w}else if(w instanceof um.Group)for(var F=w._entities,c=F.length-1;c>=0;c--){var U=F[c];if(Dk(U)&&r.isMovable(U))return U}return null},Yi.prototype.getMoveInteractor=function(){for(var E,P,A,g=this._interactor.gv,U=g.getInteractors(),E=0,P=U.length;P>E;E++)if(A=U.get(E),A instanceof bo)return A},Yi.prototype.startEdit=function(S,s){S.startDragging(s);var J=this.getMoveInteractor();if(J){var A=this.selectedTarget,N=S.gv;N._moving=1,J._data=A,N.handleMouseDown&&N.handleMouseDown(s,A)}},Yi.prototype._46O=function(k){var e=this,Q=e.getMoveInteractor();Q&&(Q.handleWindowMouseUp(k),e.selectedTarget=null)},Yi.prototype.handleEdit=function(K,P){var G=this.getMoveInteractor();G&&G.handleWindowMouseMove(P)},Yi.prototype.check=function(V,U,I){if(this.selectedTarget=null,A.Default.isLeftButton(U)&&!V._scrolling&&!An()){var L=this;if(L.screenInfo){var M=L.screenInfo.pos;if(M&&!(I.distanceTo(M)>L.screenInfo.size)){var w=L._interactor;return L.selectedTarget=L.getMovableTarget(w.getSubModule("Rect").target),w.setCursor("default"),!0}}}},Yi.prototype._42=function(j,h,R){var O=this;O.screenInfo={};var r=O._interactor;r.editDetail||O.gatherInfo(h,R)&&(!r.editing||O.selectedTarget)&&um.Icons.DrawIcon(r,j,um.Icons.MoveDummy,O.screenInfo)};var fs=um.RotateX=function(P){this.catalog="RotateX",this._interactor=P};fs.prototype={},fs.prototype.constructor=fs,fs.prototype.gatherInfo=function(X,e){var x=this;if(1===e.length){var J=e[0];return J instanceof A.Shape&&J._70I()||Ec(J,X)?!1:x.gatherSingleTarget(X,J)}return e.length>1?x.gatherMultiTargets(X,e):!1},fs.prototype.gatherSingleTarget=function(){var V=new A.Math.Vector2,h=new A.Math.Vector2,J=new A.Math.Vector2,s=new A.Math.Vector2,N=function(Z,U){var z=Z.x-U.x,q=Z.y-U.y;return z*z+q*q};return function(t,H){if(H.getCorners){var X=this,B=H.getCorners(),n=15,m=H.getPosition();V.copy(B[0]),J.copy(B[1]),s.copy(B[3]),h.copy(V).add(s).divideScalar(2).add(V.sub(J).setLength(n/t.getZoom()));var v=Math.max(N(m,B[0]),N(m,B[1]),N(m,B[2]),N(m,B[3]));return X.info.POS=h.clone(),X.screenInfo.POS=um.toScreenPosition(t,X.info.POS),X.screenInfo.LEN=Math.sqrt(v)*t.getZoom()+n,X.screenInfo.CENTER=um.toScreenPosition(t,m),X.target=H,!0}}}(),fs.prototype.gatherMultiTargets=function(c,$){var A=this,D=um.Group.findOrCreateGroup($,this._interactor._uuid);if(!D)return!1;var A=this;return A.gatherSingleTarget(c,D)},fs.prototype.isVisible=function(){var B=this._interactor;if(!B.getStyle("rotateAsClock"))return!1;var Y=this.target;if(!Y)return!0;var t=B.gv;return t.isEditable(Y)&&t.isRotationEditable(Y)?!0:!1},fs.prototype.check=function(Z,u,o){var x=this,S=x._checkImpl(Z,u,o);return(S||x._clockPainted)&&x._interactor._42(),S},fs.prototype._checkImpl=function(u,P,y){if(A.Default.isLeftButton(P)){var M=this;M.editing=null,M.tipInfo=null;var Q;if(M.screenInfo&&(Q=M.screenInfo.POS)&&M.isVisible()){var s=M._interactor;if(um.checkHit(y,Q,s.getStyle("checkSize"))){var r=M.target,W=u.lp(P),j=r.getPosition(),x=Math.atan2(W.y-j.y,W.x-j.x);return s._setRotateCursor(x),M.editing={pos:j,rotation:r.getRotation(),hitRot:x,groupRotateMode:"block",screenInfo:{CENTER:M.screenInfo.CENTER,LEN:M.screenInfo.LEN}},!0}}}},fs.prototype.startEdit=function(U,z){U.startDragging(z),U.fi({kind:"beginEditRotation",event:z}),this.target instanceof um.Group&&this.target.beginRotate(this.editing)},fs.prototype._46O=function(V){var v=this;v.editing&&(v.editing=null,v._interactor.fi({kind:"endEditRotation",event:V})),v.target instanceof um.Group&&v.target.endRotate(),v.tipInfo=null},fs.prototype.handleEdit=function(w,y){var O=this,d=O.editing;if(d){var Y,T,I=O.target,Q=w.lp(y),E=O._interactor,U=d.pos,n=Math.atan2(Q.y-U.y,Q.x-U.x),v=I instanceof um.Group;if(v?T=n-d.hitRot:(Y=n-d.hitRot,T=d.rotation+Y),T%=2*Math.PI,0>T&&(T+=2*Math.PI),!A.Default.isCtrlDown(y)){var S,W;Ng(y)?(S=E.getStyle("shiftRotateRound"),W=S/2):(S=E.getStyle("rotateRound"),W=E.getStyle("rotateSensitivity")),T=um.roundTo(T,S,W)}v?(Y=T-(d.lastRotation||0),0!==Y&&(I.addRotation(Y,d.groupRotateMode,function(l){return w.isRotationEditable(l)}),d.lastRotation=T)):I.setRotation(T),E._setRotateCursor(n),T>Math.PI&&(T-=2*Math.PI);var k=180*(T/Math.PI),_=""+k.toFixed(2)+"°",D=A.Default.getLogicalPoint(y,E._canvas);D.x+=um.Icons.TipShiftX,D.y+=um.Icons.TipShiftY,O.tipInfo={helperPos:D,text:_,size:_.length},E.fi({kind:"betweenEditRotation",event:y})}},fs.prototype._42=function(O,X,I){var h=this;h._clockPainted=!1,h.info={},h.screenInfo={};var l=h._interactor;l.editDetail||h.gatherInfo(X,I)&&h.isVisible()&&(um.Icons.DrawIcon(l,O,um.Icons.RoundPoint,h.screenInfo.POS),l.getStyle("rotateTipVisible")&&h.tipInfo&&um.Icons.DrawIcon(l,O,um.Icons.TipHelper,h.tipInfo),h.editing&&h.drawClock(O))},fs.prototype.drawClock=function(h){h.save();var l=this;l._clockPainted=!0;var q=l.editing||{},r=q.screenInfo||l.screenInfo,B=r.LEN,n=B+8,e=B+18;h.save(),h.translate(r.CENTER.x,r.CENTER.y),h.beginPath(),h.strokeStyle="rgb(150, 150, 150)";for(var J,Q,$,s,d,Z=0;360>Z;Z++)J=Z*Math.PI/180,0===Z%5&&(Q=m(J)*B,$=X(J)*B,s=m(J)*n,d=X(J)*n,h.moveTo(Q,$),h.lineTo(s,d)),0===Z%45&&(Q=m(J)*B,$=X(J)*B,s=m(J)*e,d=X(J)*e,h.moveTo(Q,$),h.lineTo(s,d));h.stroke(),h.rotate(-Ce);var T=q.lastRotation||l.target.getRotation();h.beginPath(),h.fillStyle="rgba(255, 0, 0, 0.1)",h.strokeStyle="rgb(157, 157, 157)",h.moveTo(0,0),h.arc(0,0,e,0,T,!1),h.fill(),h.beginPath(),h.moveTo(0+e,0),h.arc(0,0,e,0,T,!1),h.stroke(),h.restore()};var Ch=um.Curve=function(s){this.catalog="Curve",this._interactor=s};Ch.prototype={},Ch.prototype.constructor=Ch,b.defineProperties(Ch.prototype,{activing:{get:function(){return this._activing},set:function(V){var i=this;if(V)i._activing=new um.CurveActiving(this,V),i.gatherSingleTarget(i._interactor.gv,i.target);else{var l=i._activing;l&&l.dispose(),i._activing=null}}}}),Ch.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Ch.prototype.setUp=function(){var J=this,I=J._interactor;I&&I.gv.mp(J._onGraphviewPropertyChanged,J)},Ch.prototype._onGraphviewPropertyChanged=function(c){("zoom"===c.property||"translateX"===c.property||"translateY"===c.property)&&this._handleDataChanged()},Ch.prototype.tearDown=function(){var V=this,Y=V._interactor;Y&&Y.gv.ump(V._onGraphviewPropertyChanged,V)
},Ch.prototype.canEnterEditDetailMode=function(){var s=op(this._interactor);return s?this.target=s:void 0},Ch.prototype.canQuitEditDetailMode=function(j){var G=this,M=G._interactor._getLogicalPoint(j);return G._checkEditRealPoint(M)?void 0:G._interactor.gv.getDataAt(j)!==G.target?!0:void 0},Ch.prototype.preHandleScroll=function(){var O=this.editing;return O&&O.inEdit?!0:void 0},Ch.prototype.getCurrentSelectintStatus=function(){var O=this;if(O.activing&&!O.activing.selections){if(O.activing.status!=r)return O.activing.status;var Z=function(p){var v=O.activing.status;O.activing.status=p,O._interactor.fp("shapePointStatus",v,p)},_=um.Curve.PointType,L=O.activing.point,V=O.activing.pairs;if(!V||1!==V.length)return Z(_.Mirrored);var S=V[0],B=S.c1&&S.c1.isNearEnough(L),J=S.c2&&S.c2.isNearEnough(L);if(!S.c1||!S.c2)return B||J?Z(_.Straight):Z(_.Disconnected);if(B&&J)return Z(_.Straight);if(B||J)return Z(_.Asymmetric);var j=S.c1.clone().sub(L),F=S.c2.clone().sub(L);return Math.abs(j.x*F.y-j.y*F.x)>1e-5||j.x*F.x>0?Z(_.Disconnected):Math.abs(j.length()-F.length())>1e-5?Z(_.Asymmetric):Z(_.Mirrored)}},Ch.prototype.handle_keydown=function(M){var Q=this;if(Q._interactor.editDetail){var O=um.Curve.PointType;"1"===M.key?Q._setCurrentSelectionStatus(O.Straight):"2"===M.key?Q._setCurrentSelectionStatus(O.Mirrored):"3"===M.key?Q._setCurrentSelectionStatus(O.Disconnected):"4"===M.key&&Q._setCurrentSelectionStatus(O.Asymmetric)}},Ch.prototype.setCurrentSelectionStatus=function(o){var x=this,l=x._interactor;if(l){var Z=l.gv;Z.dm().beginTransaction(),this._setCurrentSelectionStatus(o),Z.dm().endTransaction()}},Ch.prototype._setCurrentSelectionStatus=function(o){var S=this,q=S.activing;if(q){var w=S.getCurrentSelectintStatus();if(null!==w&&w!==o){q.status=o;var P=S.activing.point,L=S.activing.pairs;if(L&&1===L.length){var B=L[0],k=S.screenInfo.curve,I=um.Curve.PointType,d=S._interactor,A=function(){S._writeToHt(),d.fp("shapePointStatus",w,o),S.check(d.gv,null,new um.Math.Vector2(d._lastLogicalPoint))};if(o===I.Straight)return k.moveCtrlPoint(B,P,"c1"),k.moveCtrlPoint(B,P,"c2"),A(),void 0;if(w===I.Straight){var X=k.findPairs(P,!0),U=X[0],$=U.r1||P,T=U.r2||P,v=T.clone().sub($).multiplyScalar(.25);return k.moveCtrlPoint(B,P.clone().sub(v),"c1"),k.moveCtrlPoint(B,P.clone().add(v),"c2"),A(),void 0}var l=B.c1,b=B.c2;if(l&&b){if(o===I.Mirrored)return k.moveCtrlPoint(B,P.clone().multiplyScalar(2).sub(b),"c1"),A(),void 0;if(o===I.Asymmetric&&w===I.Disconnected){var g=l.clone().sub(P).length(),v=P.clone().sub(b).setLength(g).add(P);return k.moveCtrlPoint(B,v,"c1"),A(),void 0}}q._firePointChange(),d.fp("shapePointStatus",w,o),S.check(d.gv,null,new um.Math.Vector2(d._lastLogicalPoint))}}}},Ch.prototype._handleDataChanged=function(){var d="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(R){var x=this;if(x.screenInfo&&x.target){if(R&&d.indexOf(R.property)<0)return;var _=x._interactor;x.gatherSingleTarget(_.gv,x.target,!0),x.check(_.gv,null,new um.Math.Vector2(_._lastLogicalPoint)),_._42()}}}(),Ch.prototype.gatherSingleTarget=function(m,B,N){var U,v,C=this;C.screenInfo&&C.screenInfo.curve&&(v=C.screenInfo.curve._curves);var S=C.editing;U=S?C.screenInfo:C.screenInfo={};var d,W,M=B instanceof A.Edge;M?(d=B.s("edge.segments"),W=B.s("edge.points")||new A.List):(d=B._58O,W=B._59O),U.S=d;var j,F=U.P=[],R=um.getDataMatrix(B);if(B instanceof A.Polyline||B instanceof A.Edge&&C._interactor.getStyle("edgeElevationEditable"))j=B.getElevation&&B.getElevation()||0,U.E=[];else{var a=!1;W.each(function(X){X.e!==r&&(a=!0)}),a&&(U.E=[])}if(W.each(function(c){U.E&&U.E.push(c.e!=r?c.e:j),c=R.apply(c);var p=um.toScreenPosition(m,c);F.push(p.x,p.y)}),M){var e=F.length,t=um.toScreenPosition(m,B._lastSourcePoint||(e?{x:F[0],y:F[1]}:{x:0,y:0})),q=um.toScreenPosition(m,B._lastTargetPoint||(e?{x:F[e-2],y:F[e-1]}:{x:0,y:0}));if(F.splice(0,0,t.x,t.y),F.push(q.x,q.y),U.E){var O=B.getSourceAgent();O instanceof A.Edge?U.E.splice(0,0,B.s("edge.source.offset.elevation")):U.E.splice(0,0,((B.s("edge.source.anchor.elevation")||.5)-.5)*O.getTall()*O.getScaleTall()+O.getElevation()+B.s("edge.source.offset.elevation"));var D=B.getTargetAgent();D instanceof A.Edge?U.E.push(B.s("edge.target.offset.elevation")):U.E.push(((B.s("edge.target.anchor.elevation")||.5)-.5)*D.getTall()*D.getScaleTall()+D.getElevation()+B.s("edge.target.offset.elevation"))}}if(!U.S||!U.S.size()){U.S=new A.List,U.S.add(1);for(var u=0;u<F.length/2-1;u++)U.S.add(2)}if((!S||N)&&C.convertToCubicBezier(v),C.activing&&(N||!C.editing||"realPoint"===C.editing.type)){var Q=U.curve.findPairs(C.activing.point);C.activing.pairs=Q}},Ch.prototype._convertToNewPoint=function(M,b,J,a){var C,t,w;for(C=0,t=b.length;t>C;C++){if(w=b[C],w._p1.isNearEnough(M)&&(!a||a.indexOf(w._p1)<0))return w._p1;if(w._p4.isNearEnough(M)&&(!a||a.indexOf(w._p4)<0))return w._p4}if(J)for(C=0,t=Math.min(J.length,t);t>C;C++){if(w=J[C],w._p1===M&&(!a||a.indexOf(b[C]._p1)<0))return b[C]._p1;if(w._p4===M&&(!a||a.indexOf(b[C]._p4)<0))return b[C]._p4}},Ch.prototype.convertToCubicBezier=function(p){var y,J,E=this,S=new um.Math.Curve,K=E.screenInfo;if(S.createFromHtShape(K.P,K.S,K.E),K.curve=S,E.activing){var G=S._curves;y=E.activing.point,J=E._convertToNewPoint(y,G,p);var r=[];if(J&&(E.activing.point=J,r.push(J)),E.activing.selections){var F=-1,f=E.activing.selections;f.forEach(function(e){F++,J=E._convertToNewPoint(e,G,p,r),J&&(f[F]=J,r.push(J))})}}},Ch.prototype.check=function(F,K,z){if(!K||ok(K)||Tc(K)){var L=this;if(L._interactor.setCursor("default"),L.editing=null,L.highlight=null,L.tipInfo=null,L.edgeEditResult=null,L.screenInfo){if(An()||K&&Tc(K))return L._interactor._42(),!0;if(L._checkEditCtrlPoint(z))return L._interactor._42(),!0;if(L._checkEditRealPoint(z))return L._interactor._42(),!0;if(L._checkEditElevation(z))return L._interactor._42(),!0;var g=L.screenInfo.curve,A=g.checkPoint(z,L._interactor.getStyle("curveIntersectSize"));if(A){var i=L.highlight={};i.type="insertKnot",i.bezier=A.bezier,i.point=A.intersection}return L._interactor._42(),!0}}},Ch.prototype.getAdjacentBeziers=function(c){var x=this.screenInfo;if(x){var B,u,h,y=x.curve._curves,n=[],w=r;for(B=0,u=y.length;u>B;B++)if(h=y[B],w===r){if(h._p4.isNearEnough(c)){n.push(h),w=B;continue}}else{if(h._p1.isNearEnough(c))return n.push(h),n;if(h._p4.isNearEnough(c)){n[0]=h,w=B;continue}}}},Ch.prototype.roundCorner=function(n){if(this.activing&&this.screenInfo){var Z=this.screenInfo.curve,V=Z._curves,v=this.getAdjacentBeziers(this.activing.point),Q=v[1],O=Q._index;Q=Q.insertKnot(Q.getTByPercentage(n/Q.length))[1],V[O]=Q;var f=Q.p1,z=v[0],l=z._index;z=z.insertKnot(z.getTByPercentage(1-n/z.length))[0],V[l]=z;var b=z.p4,j=this.activing.point,P=new um.Math.CubicBezier(b,j.clone().sub(b).multiplyScalar(2/3).add(b),j.clone().sub(f).multiplyScalar(2/3).add(f),f);V.splice(O,0,P),this._writeToHt(),this.activing=null,this._interactor._42()}},Ch.prototype._checkEditRealPoint=function(u){var h,r,P,U,o,t,n=this,A=n.screenInfo.curve._curves,s=n._interactor.getStyle("curvePointIntersectSize"),z=1/0;for(s*=s,P=0,U=A.length;U>P;P++)h=A[P],o=h._p1,t=u.distanceToSquared(o),z>t&&(z=t,r=o),o=h._p4,t=u.distanceToSquared(o),z>t&&(z=t,r=o);if(z>s)return!1;var _=n.highlight={};return _.type="changeRealPoint",_.point=r,n.editing={type:"realPoint",point:r,shiftGuide:{point:r.clone(),dir:"x",limit:0}},n._interactor.setCursor("crosshair"),!0},Ch.prototype._checkEditElevation=function(e){var U=this;if(!U._interactor.getStyle("curveElevationVisible"))return!1;var b=U.target;if(b instanceof A.Edge&&!U._interactor.getStyle("edgeElevationEditable"))return!1;var B=U.activing;if(!B)return!1;var s=B.getCurrentEditingPoint();if(!s)return!1;var t=U._interactor,E=t.getStyle("curveElevationGuideShift"),$=t.getStyle("curveElevationIntersectSize"),H=e.distanceToSquared({x:s.x+E[0],y:s.y+E[1]});if(!(H>$*$)){var l=U.highlight={};l.type="elevation";var W=new um.Math.Vector2(e.x,e.y,s.e);return U.editing={type:"elevation",startPoint:W},U._interactor.setCursor("crosshair"),!0}},Ch.prototype._checkEditCtrlPoint=function(F){var w=this;if(w.activing&&!w.activing.selections){var Q=w.getCurrentSelectintStatus();if(Q!==um.Curve.PointType.Straight){var h=w.activing.pairs;if(h){var z=w._interactor.getStyle("curvePointIntersectSize");z*=z;var L,Y,u,R,U,b,J,m,t,D=1/0;for(J=0,t=h.length;t>J;J++)for(R=h[J],m=0;2>m;m++)U=0===m?"c1":"c2",R[U]&&(b=F.distanceToSquared(R[U]),D>b&&(D=b,L=R,Y=J,u=U));if(D>z)return!1;w.activing.hlpair=L,w.activing.hltype=u;var T=w.highlight={};return T.type="changeCtrlPoint",T.point=L[u],w.editing={type:"ctrlPoint",pair:L,pairId:Y,ctrlType:u,direction:L[u].clone().sub(w.activing.point).normalize()},w._interactor.setCursor("crosshair"),!0}}}},Ch.prototype.startEdit=function(M,e){M.startDragging(e);var a=this;a.highlight&&"insertKnot"===a.highlight.type&&(a.insertKnot(),a.gatherSingleTarget(a._interactor.gv,a.target),a.activing=null,a._checkEditRealPoint(a._interactor._getLogicalPoint(e)));var y=a._activing;if(y){var d=a.editing?a.editing.type:null;"ctrlPoint"===d?y.editingCtrl={pairId:a.editing.pairId,type:y.hltype}:"realPoint"===d&&(y.editingCtrl=!1)}var P=a.highlight,G=A.Default.isCtrlDown(e);if(!P||An()||Tc(e)){var z=a._interactor.gv;if(!z.setFocus(e)||z._scrolling)return;return G?a._multiSelect={startPoint:z.lp(e)}:z.isPannable()&&(ok(e)||Tc(e))&&(a._pan={tx:z.tx(),ty:z.ty()},M.fi({kind:"beginPan",event:e})),void 0}if("changeRealPoint"===P.type){var Z,j=a.activing?a.activing.point:null,T=a.activing?a.activing.selections:null;if(G&&a.activing)j===P.point?(T?(a.activing={point:T[0]},T.length>1&&(T.splice(0,1),a.activing.selections=T)):a.activing=null,a.editing=null):T&&(Z=T.indexOf(P.point))>=0?(T.length>1?T.splice(Z,1):delete a.activing.selections,a.editing=null):T?(T.push(j),a.activing={point:P.point,selections:T}):a.activing={point:P.point,selections:[j]};else if(T)j===P.point||((Z=T.indexOf(P.point))>=0?(T.splice(Z,1,j),a.activing={point:P.point,selections:T}):a.activing={point:P.point});else{var b;j===P.point&&(b=a.activing.status),a.activing={point:P.point},b&&(a.activing.status=b)}M.fi({kind:"beginEditPoint",event:e})}},Ch.prototype.insertKnot=function(){var U=this,Q=U.highlight,k=U.screenInfo.curve;k.insertKnot(Q.bezier,Q.point.t),U._writeToHt()},Ch.prototype._writeToHt=function(){var e,R,Q=this,$=Q.screenInfo.curve,m=$.toHtShape(),r=m.points,N=[],F=m.segments,h=Q._interactor.gv;h.dm().beginTransaction();var f,M,G=Q.target,j=G instanceof A.Edge,C=um.getDataMatrix(G).invert();M=G instanceof A.Polyline||j&&Q._interactor.getStyle("edgeElevationEditable"),M&&(f=G.getElevation&&G.getElevation()||0);for(var z=0,l=r.length;l>z;z++)e=r[z],R=um.toWorldPosition(h,e),R=C.apply(R),isFinite(e.e)&&e.e!==f&&(R.e=e.e),N.push(R);if(G._writing=!0,j){G.s("edge.type","points"),G.setStyle("edge.segments",F),G.setStyle("edge.points",N.slice(1,N.length-1)),G.setStyle("edge.source.offset.x",0),G.setStyle("edge.source.offset.y",0),G.setStyle("edge.target.offset.x",0),G.setStyle("edge.target.offset.y",0);var J=Q._nextChangeEdgeHost;delete Q._nextChangeEdgeHost,J&&("source"===J.type?G.setSource(J.host):G.setTarget(J.host)),Q._writeEdgeHostAnchor("source",N[0]),Q._writeEdgeHostAnchor("target",N[N.length-1])}else N.length?(G.setSegments(F),G.setPoints(N,!0)):G.removeFromDataModel();h.dm().endTransaction(),delete G._writing},Ch.prototype._writeEdgeHostAnchor=function(x,Y){var m=this,_=m.target,M=m._calcHostAnchor(_,x,Y);M.index!==r?(_.setStyle("edge."+x+".index",M.index),_.setStyle("edge."+x+".percent",r),_.setStyle("edge."+x+".anchor.x",r),_.setStyle("edge."+x+".anchor.y",r),_.setStyle("edge."+x+".anchor.elevation",r),_.setStyle("edge."+x+".offset.elevation",Y.e)):M.percent!==r?(_.setStyle("edge."+x+".percent",M.percent),_.setStyle("edge."+x+".index",r),_.setStyle("edge."+x+".anchor.x",r),_.setStyle("edge."+x+".anchor.y",r),_.setStyle("edge."+x+".anchor.elevation",r),_.setStyle("edge."+x+".offset.elevation",Y.e)):(_.s("edge."+x+".anchor.x",M.x),_.s("edge."+x+".anchor.y",M.y),_.s("edge."+x+".anchor.elevation",M.e),M.offsetX||M.offsetY||M.offsetElevation?(_.s("edge."+x+".offset.x",M.offsetX),_.s("edge."+x+".offset.y",M.offsetY),_.s("edge."+x+".offset.elevation",M.offsetElevation)):(_.s("edge."+x+".offset.x",0),_.s("edge."+x+".offset.y",0),_.s("edge."+x+".offset.elevation",0)))},Ch.prototype._calcHostAnchor=function(z,I,h,n){n||(n="source"===I?z.getSource():z.getTarget());var X=this._interactor.gv,B=X.calculateAttachPoint(n,h);if(B)return B.info;if(Sl(n)){var q=X.calculateEdgePosition(n,h);return q}var V=n.getRotation(),u=n.getAnchor();Ec(n,X)&&(V=0);var T=n.getElevation(),U=n.getTall()*n.getScaleTall();T=((h.e||0)-z.s("edge."+I+".offset.elevation")-T)/U+.5;var w=n.getScale();if(V||w.x<0||w.y<0){var g=n.getMatrix(),Y=g.tfi(h),P=n.getSize();return{x:Y.x/P.width+u.x,y:Y.y/P.height+u.y,e:T}}var i=Le(X,n),E={x:(h.x-i.x)/i.width,y:(h.y-i.y)/i.height,e:T};return E},Ch.prototype._handlePanning=function(t){var X=this,I=X._pan;if(I){I.started=!0;var H=X._interactor,_=H.gv,R=H._lastClientPoint,E=dj(t),Z=Ln(_,E,R);_.setTranslate(I.tx+Z.x,I.ty+Z.y),X.gatherSingleTarget(H.gv,X.target),H._42(),H.fi({kind:"betweenPan",event:t})}},Ch.prototype.handleEdit=function(e,a){var J=this,Y=J.editing;if(J._pan)return J._handlePanning(a),void 0;if(J._multiSelect)return J._multiSelect.endPoint=e.lp(a),J._interactor.redraw(),void 0;if(Y){Y.inEdit=!0;var d,B,X,N=J._interactor._getLogicalPoint(a),M=A.Default.isCtrlDown(a),q=A.Default.isShiftDown(a),H=Y.type,z=J.activing;if(J._guideInfo=null,"ctrlPoint"===H&&q){var x=J.editing.direction.clone();d=z.point;var s=x.dot(N.clone().sub(d));N=x.setLength(s).add(d)}else if("ctrlPoint"===H||"realPoint"===H){var x;if("realPoint"===H&&q){var y=J.editing.shiftGuide;B=y.point;var O=Math.abs(N.x-B.x),l=Math.abs(N.y-B.y);O>l&&O>y.limit&&"y"===y.dir&&(y.dir="x"),l>O&&l>y.limit&&"x"===y.dir&&(y.dir="y"),x=y.dir,"x"===x?(N.y=B.y,y.limit=Math.max(y.limit,O)):"y"===x&&(N.x=B.x,y.limit=Math.max(y.limit,l))}if(!M){var j,S=J._isEditEdgeSourceTarget();S&&(j=N.clone());var g=J._guidingToEdit(N,x),Z="realPoint"===H?J._interactor.gridGuide.findClosest(N,x,!0):null,i=1/0,Q=1/0;Z&&(Z.x&&(i=Z.x),Z.y&&(Q=Z.y));var E=!1;if(g&&(g.xList&&(Math.abs(g.x)<=Math.abs(i)?(E=!0,i=g.x):delete g.xList),g.yList&&(Math.abs(g.y)<=Math.abs(Q)?(E=!0,Q=g.y):delete g.yList),E&&(J._guideInfo=g)),isFinite(i)&&(N.x+=i),isFinite(Q)&&(N.y+=Q),E&&(g.v=N),S){var G=E?N.clone():null;N.copy(j);var D=J._editEdgeSourceTarget(S,N,M,G);D&&(J.edgeEditResult=D,X=D.tipText,D.isFixed&&(J._guideInfo=null))}}}var I=J.screenInfo.curve;if("realPoint"===Y.type){d=Y.point,d.e!==r&&(N.e=d.e),I.moveRealPoint(d,N),Y.point=N,J.highlight.point=N;var v=z.status,t=z.selections;if(J.activing={point:N,status:v},t){var u=N.clone().sub(d),U=0;t.forEach(function(c){var e=c.clone().add(u);I.moveRealPoint(c,e),t[U++]=e}),J.activing.selections=t}}else if("ctrlPoint"===Y.type){var f=z.pairs,h=f[Y.pairId];I.moveCtrlPoint(h,N,Y.ctrlType);var m=z.status,V=um.Curve.PointType;if((m===V.Mirrored||m===V.Asymmetric)&&h.c1&&h.c2){var d=new um.Math.Vector2(z.point),W="c1"===Y.ctrlType?"c2":"c1";if(m===um.Curve.PointType.Mirrored)I.moveCtrlPoint(h,d.clone().multiplyScalar(2).sub(N),W);else if(m===V.Asymmetric){var s=h[W].clone().sub(d).length(),F=d.clone().sub(h[Y.ctrlType]).setLength(s).add(d);isNaN(F.x)||I.moveCtrlPoint(h,F,W)}}z._firePointChange()}else if("elevation"===Y.type){B=Y.startPoint;var P=B.e+(B.y-N.y)/e._zoom;J._setCurrentPointImpl("e",P),z._firePointChange(),X="E: "+um.toFixed(P)}var k=A.Default.getLogicalPoint(a,J._interactor._canvas);if(k.x+=um.Icons.TipShiftX,k.y+=um.Icons.TipShiftY,!X){var w=um.toWorldPosition(e,N);X=""+um.toFixed(w.x)+", "+um.toFixed(w.y)}J.tipInfo={helperPos:k,text:X,size:X.length},J._writeToHt(),J._interactor.fi({kind:"betweenEditPoint",event:a})}},Ch.prototype._setCurrentPointImpl=function($,R){var o=this,h=o._activing;if(!h)return!1;var m=o.target;if(!m)return!1;var w=h.getCurrentEditingPoint();if(!w)return!1;var a=h.editingCtrl;if(!a)var g=w.clone();if("e"===$)w.e=R;else{var S;if("x"===$||"y"===$){var q=h._lastFirePoint;S="x"===$?{x:R,y:q?q.y:0}:{x:q?q.x:0,y:R}}else"object"==typeof $?(S=$,$.e!==r&&(w.e=$.e)):(S={x:arguments[0],y:arguments[1]},arguments[2]!==r&&(w.e=arguments[2]));var v=um.getDataMatrix(m);S=um.toScreenPosition(o._interactor.gv,v.apply(S)),w.x=S.x,w.y=S.y}if(!a){var A=g.multiplyScalar(-1).add(w);fl(w.e)&&fl(g.e)&&(A.e=w.e-g.e);var V=o.screenInfo.curve;V.moveCtrlDueToRealPointMovement(w,A);var P=h.selections;if(P){var y=0;P.forEach(function(H){var q=H.clone().add(A);isFinite(A.e)&&(q.e=(isFinite(H.e)?H.e:m.getElevation()||0)+A.e),V.moveRealPoint(H,q),P[y++]=q}),h.selections=P}}return!0},Ch.prototype.setCurrentPoint=function(L,B){return this._setCurrentPointImpl(L,B)?(this._writeToHt(),!0):!1},Ch.prototype._isEditEdgeSourceTarget=function(){var f=this,Z=f.target;if(!(Z instanceof A.Edge))return!1;var M=f.editing.point,I=f.screenInfo.curve._curves;return M===I[0]._p1?"source":M===I[I.length-1]._p4?"target":!1},Ch.prototype._editEdgeSourceTarget=function(K,B,a,m){var v,p=this,d=p.target;if(v="source"===K?d.getSource():d.getTarget()){var H,Z=p._interactor.gv,X=um.toWorldPosition(Z,B),P=p._calcHostAnchor(d,K,X,v);if(H=P.index!==r||P.percent!==r?P.distance*Z.getZoom()>p._interactor.getStyle("edgeHostEdgeMaxDistance"):p._interactor.getStyle("edgeHostDetectPerFrame")?!0:P.x<0||P.x>1||P.y<0||P.y>1?!0:!1){var S=Z.getDataAt(X,function(i){return Z.isSelectable(i)?Z.isSourceTargetEditable(d,i,K)?d.canSetSourceTarget(i,K)?!0:!1:!1:!1});if(S){var w=p._calcHostAnchor(d,K,X,S);v=S,p._nextChangeEdgeHost={type:K,host:S},P=w}}var N,Q,F,n=!1;if(a||P.x===r)(P.percent!==r||P.index!==r)&&(n=!0,Q=P.point);else{var Y=p._interactor.getStyle("anchorRound"),q=p._interactor.getStyle("anchorSensitivity");N=Z.calculateAttachPoint(v,X),N?(P=N.info,n=!0):(m&&(P=p._calcHostAnchor(d,K,um.toWorldPosition(Z,m),v)),P.x=um.roundTo(P.x,Y,q),P.y=um.roundTo(P.y,Y,q)),Q=Ad(Z,v,0,P.offsetX||0,P.offsetY||0,P.x,P.y)}Q&&(F=um.toScreenPosition(Z,Q),B.x=F.x,B.y=F.y),p._edgeHostGuideInfo={corners:um.getTargetCornersOnScreen(Z,v),attach:N?N.index:-1,host:v};var u;return P.percent!==r?u="percent: "+P.percent.toFixed(2):P.index!==r?u="index: "+P.index:(u=""+P.x.toFixed(2)+", "+P.y.toFixed(2),(P.offsetX||P.offsetY)&&(u+=" offset: "+P.offsetX.toFixed(2)+", "+P.offsetY.toFixed(2))),{host:v,anchor:P,tipText:u,isFixed:n}}},Ch.prototype._guidingToEdit=function(h,A){var s,L,Y=this;if(s=Y.screenInfo.curve){L=s._curves;var w,l,Q,O,e,$,r,I,S=1/0,N=1/0,a=[];for(Y.editing&&"realPoint"===Y.editing.type&&(I=Y.editing.point),e=0,$=2*L.length;$>e;e++)r=L[Math.floor(e/2)][e%2?"_p4":"_p1"],a.indexOf(r)>=0||(a.push(r),I&&I===r||(Q=r.x-h.x,O=r.y-h.y,Math.abs(Q)<Math.abs(S)?(S=Q,w=[r]):Q===S&&w.push(r),Math.abs(O)<Math.abs(N)?(N=O,l=[r]):O===N&&l.push(r)));var g=Y._interactor.getStyle("smartGuideThreshold");if((Math.abs(S)>g||"y"===A)&&(w=null),(Math.abs(N)>g||"x"===A)&&(l=null),w||l){var c=!1,G={};if(w&&(c=!0,G.xList=w,G.x=S),l&&(c=!0,G.yList=l,G.y=N),c)return G}}},Ch.prototype._46O=function(u){var Z=this;Z.editing&&(Z.editing=null,Z._interactor.fi({kind:"endEditPoint",event:u})),Z._guideInfo=null,Z._edgeHostGuideInfo=null,Z._pan&&(Z._pan=null,Z._interactor.fi({kind:"endPan",event:u})),Z._multiSelect&&(Z._handleMultiSelect(Z._multiSelect,u),Z._multiSelect=null),Z.tipInfo=null,Z.edgeEditResult=null},Ch.prototype._handleMultiSelect=function(D,U){if(D.startPoint&&D.endPoint){var C,M,P,I,Z,n,h=this,S=h._interactor,j=S.gv,x=um.toScreenPosition(j,D.startPoint),H=um.toScreenPosition(j,D.endPoint),R=A.Default.unionPoint(x,H),m=h.screenInfo.curve._curves,Q=[],g=function(C){C.x>=R.x&&C.y>=R.y&&C.x<=R.x+R.width&&C.y<=R.y+R.height&&Q.indexOf(C)<0&&Q.push(C)};for(C=0,M=m.length;M>C;C++)Z=m[C],g(Z._p1),g(Z._p4);if(Q.length){var G=h.activing||{},k=G.selections||[];G.point&&k.push(G.point);var w=A.Default.isShiftDown(U),e=U.altKey;if(e&&!w)for(n=Q,Q=[],C=0,M=n.length;M>C;C++)P=n[C],I=k.indexOf(P),I>=0&&Q.push(P);for(C=0,M=k.length;M>C;C++)P=k[C],I=Q.indexOf(P),I>=0?(!w||w&&e)&&(Q[I]=r):Q.push(P);for(n=Q,Q=[],C=0,M=n.length;M>C;C++)n[C]&&Q.push(n[C]);M=Q.length,0===M?h.activing=null:1===M?h.activing={point:Q[0]}:(P=Q[M-1],h.activing={point:P,selections:Q.splice(0,M-1)}),S.redraw()}}},Ch.prototype._canDeletePoint=function(d,D){var a=this.target;if(!(a instanceof A.Edge))return!0;var g=d._curves[0],X=d._curves[d._curves.length-1];return g._p1===D||X._p4===D?!1:!0},Ch.prototype.handleDelete=function(){var O=this;if(O.activing&&O.screenInfo){var z=A.Default.isShiftDown(),w=O.screenInfo.curve;O._canDeletePoint(w,O.activing.point)&&w.deleteRealPoint(O.activing.point,z),O.activing.selections&&O.activing.selections.forEach(function($){O._canDeletePoint(w,$)&&w.deleteRealPoint($,z)}),O.activing=null,delete O.editing,delete O.tipInfo,delete O.edgeEditResult,delete O._pan,delete O._multiSelect,O._writeToHt(),O._interactor.fp("deleteShapePoint",!1,!0)}},Ch.prototype.handleDoubleClick=function(m){var q=this,K=q._interactor._getLogicalPoint(m);if(q.screenInfo&&q._checkEditRealPoint(K)){var J=q.getCurrentSelectintStatus(),y=um.Curve.PointType;return J=J===y.Mirrored?y.Straight:y.Mirrored,q._setCurrentSelectionStatus(J),q._interactor._42(),!0}},Ch.prototype._drawHighlight=function(K){var W=this,E=W.highlight;if(E){var A=E.bezier,v=W._interactor;A&&um.Icons.DrawIcon(v,K,um.Icons.ShapeHighlightCurve,[A._p1.x,A._p1.y,A._p2.x,A._p2.y,A._p3.x,A._p3.y,A._p4.x,A._p4.y]);var V=E.point;V&&"insertKnot"===E.type&&um.Icons.DrawIcon(v,K,um.Icons.ShapeHighlighPoint,V)}},Ch.prototype._drawGuide=function(x){var _=this,h=_._guideInfo;if(h){var F,l,D,M,z=h.v;for(F=0;2>F;F++)if(M=0===F?h.xList:h.yList)for(l=0,D=M.length;D>l;l++)um.Icons.DrawIcon(_._interactor,x,um.Icons.ShapeGuideLine,[z.x,z.y,M[l].x,M[l].y])}},Ch.prototype._drawCurrentPoint=function(Z){var c=this;if(c.activing){var i=c.activing,S=c.getCurrentSelectintStatus(),k=c._interactor;if(S!==um.Curve.PointType.Straight){var r=i.pairs;i.hlpair,i.hltype;var m=i.selections,B=i.editingCtrl;if(r&&!m){var C,b,s;for(b=0,s=r.length;s>b;b++)C=r[b],B&&b===B.pairId&&C[B.type]?um.Icons.DrawIcon(k,Z,um.Icons.ShapeActivingCtrl,{point:C.point,c1:C.c1,c2:C.c2,hl:B.type}):um.Icons.DrawIcon(k,Z,um.Icons.ShapeActivingCtrl,C)}}um.Icons.DrawIcon(k,Z,um.Icons.ShapeHighlighRealPoint,c.activing.point),m&&m.forEach(function(a){um.Icons.DrawIcon(k,Z,um.Icons.ShapeHighlighRealPoint,a)})}},Ch.prototype.clear=function(){var Q=this;Q.editing=null,Q._guideInfo=null,Q.activing=null,Q.highlight=null},Ch.prototype._42=function(I){var E=this;E.info={},E.editing||(E.screenInfo=null);var Q=E._interactor;if(!Q.editDetail)return E.clear(),void 0;var d=Q.gv;if(!E.target||!d.isSelected(E.target)||!d.isVisible(E.target))return Q.editDetail=!1,E.clear(),void 0;if(E.gatherSingleTarget(d,E.target),um.Icons.DrawIcon(Q,I,um.Icons.ShapeBgCurve,E.screenInfo),E._interactor.getStyle("curveElevationVisible")&&(E.target instanceof A.Polyline||E.target instanceof A.Edge&&E._interactor.getStyle("edgeElevationEditable"))&&E.activing){var w=E.activing.getCurrentEditingPoint();w&&"string"!=typeof w.e&&um.Icons.DrawIcon(Q,I,um.Icons.EdgeElevationGuide,w)}if(E._drawHighlight(I),E._drawCurrentPoint(I),E._getRealPoint().forEach(function(x){um.Icons.DrawIcon(Q,I,um.Icons.ShapePoint,x)}),E._drawGuide(I),E.tipInfo&&E._interactor.getStyle("curveTipVisible")&&um.Icons.DrawIcon(Q,I,um.Icons.TipHelper,E.tipInfo),E._edgeHostGuideInfo&&Q._drawHostGuide(E._edgeHostGuideInfo),E.edgeEditResult&&E._drawEdgeHostHighlight(I,E.edgeEditResult.host,E.edgeEditResult.anchor),E._multiSelect&&E._multiSelect.endPoint){var p=A.Default.unionPoint(um.toScreenPosition(d,E._multiSelect.startPoint),um.toScreenPosition(d,E._multiSelect.endPoint));p.color=d.getRectSelectBorderColor(),I.save(),I.setTransform(1,0,0,1,0,0);var T=u.devicePixelRatio,M=p.borderWidth=Math.round(T);M/=2,p.x=Math.round(p.x*T)+M,p.y=Math.round(p.y*T)+M,p.width=Math.round(p.width*T),p.height=Math.round(p.height*T),um.Icons.DrawIcon(Q,I,um.Icons.SimpleRect,p),I.restore()}},Ch.prototype._drawEdgeHostHighlight=function(H,m,j){this.drawEdgeHostHighlight(H,m,j),this._interactor.redraw()},Ch.prototype.drawEdgeHostHighlight=function(R,C,H){if(Sl(C)){var k,$,x,z,B=this,n=B._interactor,q=n.gv,p=q.getDataUI(C),D=cm(p),K=[];for(x=0,z=D.points.length;z>x;x++)$=um.toScreenPosition(q,D.points.get(x)),K.push($.x,$.y);D.segments&&(k=D.segments.toArray());var h=n.getStyle("edgeHostHighlighPeriod"),X=n.getStyle("edgeHostEdgeHighlighColor");um.Icons.DrawIcon(n,R,um.Icons.ShapeBgCurve,{P:K,S:k,color:X,dynamicVisible:H.index===r,dynamicPeriod:h}),X=n.getStyle("edgeHostPointHighlighColor");var l=kr(p);for(x=0,z=l.length;z>x;x++){var Q=l[x],g=um.toScreenPosition(q,Q);um.Icons.DrawIcon(n,R,um.Icons.ShapePoint,{point:{x:g.x,y:g.y},color:X,size:12,dynamicVisible:x===H.index,dynamicPeriod:h})}}},Ch.prototype._getRealPoint=function(){var M,B=this.screenInfo,O=B.P,J=B.S,x=-1,e=[],y=-1,G=J.length;return J.each(function(w){y++;var Q=1;if(3===w)Q=2;else if(4===w)Q=3;else if(5===w)return;x+=Q,M=y+1>=G?!0:1===J.get(y+1)?!0:!1,e.push({point:{x:O[2*x],y:O[2*x+1]},segmentIndex:y,pointIndex:x,isEnd:M})}),e},Ch.prototype.getEditingPointsInfo=function(e){var X=this,g=X.activing;if(!g)return!1;var C=g.point;if(!C)return!1;var o=this._getRealPoint(),$=[{screen:C}];g.selections&&g.selections.forEach(function(u){$.push({screen:u})});var B,T,K=o.length;return $.forEach(function(h){for(B=0;K>B;B++)if(T=o[B],h.screen.isNearEnough(T.point)){h.segmentIndex=T.segmentIndex,h.pointIndex=T.pointIndex,h.point=X.target.getPoints().get(T.pointIndex);break}}),e&&$.sort(function(k,l){return k.segmentIndex-l.segmentIndex}),$};var un=um.MoveHelper=function(h){var N=this;N.catalog="Move",N._interactor=h};un.prototype={},un.prototype.constructor=un,un.prototype.calcShift=function(c,j,B){var q,O,o=this,w=o._interactor.gv,u=w.lp(j);if("beginMove"===c&&o._gatherGridInfo(B._lastLogicalPoint||u),q=o._target){var G=q.downPosition;if(G){var y=o._interactor.getStyle("moveSensitivity")/w._zoom;if(G.distanceTo(u)<y)return{x:0,y:0};delete q.downPosition}var I;O=A.Default.isShiftDown(j),O&&(u=o._dealShiftDown(u),I=q.shiftGuide.dir);var z,J=q.rawPos={x:q.pos.x+u.x-q.lp.x,y:q.pos.y+u.y-q.lp.y};if(A.Default.isCtrlDown(j)){if(z=o._calcShiftByAddon(),o._target.node instanceof um.Group){var l=o._target.node;l._position.x+=z.x,l._position.y+=z.y}return z}var h=o._interactor.rectGuide;if(q.node instanceof A.Data&&q.node.s("2d.attachable")){var U=o._calcAttachNodeShift(q.node,J);if(h.clear(),U)return U}for(var d,a=q.x+J.x,v=q.y+J.y,X={x:a,y:v},Z={x:a+q.w/2,y:v+q.h/2},s={x:a+q.w,y:v+q.h},n=o._interactor.gridGuide,V=[h.findClosest(X,I),h.findClosest(Z,I),h.findClosest(s,I),n.findClosest(X,I),n.findClosest(Z,I),n.findClosest(s,I)],T=1/0,r=1/0,t=0,K=V.length;K>t;t++)d=V[t],d&&(a=d.x,v=d.y,isFinite(a)&&Math.abs(a)<Math.abs(T)&&(T=a),isFinite(v)&&Math.abs(v)<Math.abs(r)&&(r=v));if(isFinite(T)||(T=0),isFinite(r)||(r=0),z=o._calcShiftByAddon(T,r),o._target.node instanceof um.Group){var l=o._target.node;l._position.x+=z.x,l._position.y+=z.y}var E=q.node;if(!Ec(E,w)){var i=J.x+T,b=J.y+r;o._interactor.rectGuide.gatherLines({node:E,x:q.x+i,y:q.y+b,w:q.w,h:q.h},I)}return z}},un.prototype._calcShiftByAddon=function(J,E){var K=this._target,L=K.rawPos,Y=K.node.getPosition();return J=J||0,E=E||0,{x:L.x-Y.x+J,y:L.y-Y.y+E}},un.prototype._dealShiftDown=function(v){var S=this,y=S._target.shiftGuide,t=S._target.lp,z=Math.abs(v.x-t.x),F=Math.abs(v.y-t.y);z>F&&z>y.limit&&"y"===y.dir&&(y.dir="x"),F>z&&F>y.limit&&"x"===y.dir&&(y.dir="y");var R=y.dir;return"x"===R?(v.y=t.y,y.limit=Math.max(y.limit,z)):"y"===R&&(v.x=t.x,y.limit=Math.max(y.limit,F)),v},un.prototype._isAttachableLineShape=function(J){if(!J.getSegments)return!1;var w=J.getSegments();if(!w)return!0;w instanceof A.List&&(w=w.getArray());for(var U=1,M=w.length;M>U;U++)if(2!==w[U])return!1;return!0},un.prototype._calcAttachNodeShift=function(){var l=new Ho,U=new Ho,T=new Ho,d=new Ho;return function(s,a){var J=this._interactor.gv,x=s.getHost(),W=J.getDataAt(a,function(h){return h.s("2d.hostable")?!0:!1});if(W&&x!==W&&s.setHost(W),!W)return this._edgeHostGuideInfo=null,s.setHost(null);var n=this._edgeHostGuideInfo={corners:um.getTargetCornersOnScreen(J,W),host:W,attach:-1};if(this._isAttachableLineShape(W)){for(var q,$,c,D,C,m,I=W.getPoints(),Z=I.size(),E=W.getPointsMatrix2d(),O=1/0,N=0;Z>N&&(N!==Z-1||W.isClosePath());N++)0!==N?U.copy(T):E.apply(I.get(N),U),E.apply(N===Z-1?I.get(0):I.get(N+1),T),l.copy(a).sub(U),d.copy(T).sub(U),q=d.length(),d.divideScalar(q),$=l.dot(d),0>$?$=0:$>q&&($=q),d.multiplyScalar($).add(U),c=l.copy(a).sub(d).lengthSq(),O>c&&(O=c,m=N,D=$,C=q);return Math.sqrt(O)*J.getZoom()>this._interactor.getStyle("attachThreshold")?(s.s({"attach.index":-1}),s.setHost(null),void 0):(s.s("attach.offset.opposite")&&(D=C-D),s.s({"attach.index":m,"attach.offset":s.s("attach.offset.relative")?D/C:D}),{x:0,y:0})}var H=J.calculateAttachPoint(W,a);if(H){var o=H.point;return n.attach=H.index,this._calcShiftByAddon(o.x-a.x,o.y-a.y)}}}(),un.prototype._gatherGridInfo=function(U){var S,O=this,G=O._interactor,k=G._getValidSelection();if(k.length){if(1===k.length){if(S=k[0],!S.getRect)return O._target=null,void 0}else if(S=um.Group.findOrCreateGroup(k,G._uuid),!S)return O._target=null,void 0}else{var k=G.gv.sm().getSelection();if(k.length&&(S=k.get(0),!S.getRect))return O._target=null,void 0}if(S){var $=S.getPosition(),f=S.getRect();O._target={node:S,x:f.x-$.x,y:f.y-$.y,w:f.width,h:f.height,lp:{x:U.x,y:U.y},pos:{x:$.x,y:$.y},shiftGuide:{dir:"x",limit:0},downPosition:new um.Math.Vector2(U)},G.rectGuide.gatherRects()}},un.prototype.clear=function(){var $=this;$._edgeHostGuideInfo=null,$._interactor.rectGuide.clear(),$._interactor._42()},un.prototype._42=function(){var $=this._edgeHostGuideInfo;$&&this._interactor._drawHostGuide($)};var Jk=b.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),cj=function(){function p(C,O){var U=r;
return function(){return U||(U=C.getExtension(O)),U}}function y(Q,J){J==r&&(J={}),J.version=V&&(Q instanceof WebGL2RenderingContext||b.prototype.toString.call(Q)===K)?2:1,J.extensions=function(){for(var B={},I=Q.getSupportedExtensions(),W=I.length;W--;)B[name]=p(Q,I[W]);return B}();for(var m=b.keys(n),H=0,I=m.length;I>H;++H){var d=m[H];J[d]=Q.getParameter(n[d])}if(J.version>1){m=b.keys(i);for(var H=0,I=m.length;I>H;++H){var d=m[H];J[d]=Q.getParameter(i[d])}}return J}var V="undefined"!=typeof WebGL2RenderingContext,K="[object WebGL2RenderingContext]",n={aliasedLineWidthRange:Jk.ALIASED_LINE_WIDTH_RANGE,aliasedPointSizeRange:Jk.ALIASED_POINT_SIZE_RANGE,maxCombinedTextureImageUnits:Jk.MAX_COMBINED_TEXTURE_IMAGE_UNITS,maxCubeMapTextureSize:Jk.MAX_CUBE_MAP_TEXTURE_SIZE,maxFragmentUniformVectors:Jk.MAX_FRAGMENT_UNIFORM_VECTORS,maxRenderBufferSize:Jk.MAX_RENDERBUFFER_SIZE,maxTextureImageUnits:Jk.MAX_TEXTURE_IMAGE_UNITS,maxTextureSize:Jk.MAX_TEXTURE_SIZE,maxVaryingVectors:Jk.MAX_VARYING_VECTORS,maxVertexAttribs:Jk.MAX_VERTEX_ATTRIBS,maxVertexTextureImageUnits:Jk.MAX_VERTEX_TEXTURE_IMAGE_UNITS,maxVertexUniformVectors:Jk.MAX_VERTEX_UNIFORM_VECTORS,maxViewportDIMs:Jk.MAX_VIEWPORT_DIMS},i={max3DTextureSize:Jk.MAX_3D_TEXTURE_SIZE,maxArrayTextureLayers:Jk.MAX_ARRAY_TEXTURE_LAYERS,maxColorAttachments:Jk.MAX_COLOR_ATTACHMENTS,maxCombinedFragmentUniformComponents:Jk.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,maxCombinedUniformBlocks:Jk.MAX_COMBINED_UNIFORM_BLOCKS,maxCombinedVertexUniformComponents:Jk.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,maxDrawBuffers:Jk.MAX_DRAW_BUFFERS,maxElementIndex:Jk.MAX_ELEMENT_INDEX,maxElementsIndices:Jk.MAX_ELEMENTS_INDICES,maxElementsVertices:Jk.MAX_ELEMENTS_VERTICES,maxFragmentInpuComponents:Jk.MAX_FRAGMENT_INPUT_COMPONENTS,maxFragmentUniformBlocks:Jk.MAX_FRAGMENT_UNIFORM_BLOCKS,maxFragmentUniformComponents:Jk.MAX_FRAGMENT_UNIFORM_COMPONENTS,maxProgramTexelOffset:Jk.MAX_PROGRAM_TEXEL_OFFSET,maxSamples:Jk.MAX_SAMPLES,maxTextureLODBias:Jk.MAX_TEXTURE_LOD_BIAS,maxTransformFeedbackInterleavedComponents:Jk.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,maxTransformFeedbackSeparateAttribs:Jk.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,maxTransformFeedbackSeparateComponents:Jk.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,maxUniformBlockSize:Jk.MAX_UNIFORM_BLOCK_SIZE,maxUniformBufferBindings:Jk.MAX_UNIFORM_BUFFER_BINDINGS,maxVaryingComponents:Jk.MAX_VARYING_COMPONENTS,maxVertexOutputComponents:Jk.MAX_VERTEX_OUTPUT_COMPONENTS,maxVertexUniformBlocks:Jk.MAX_VERTEX_UNIFORM_BLOCKS,maxVertexUniformComponents:Jk.MAX_VERTEX_UNIFORM_COMPONENTS,minProgramTexelOffset:Jk.MIN_PROGRAM_TEXEL_OFFSET};return{"for":function(U){var K=U._info;return K||(U._info=K=y(U,K)),K}}}(),Zr=function(){function R(k,F,N){return{def:k,getter:N?function(N){var O=cj.for(N);return O.version>1?N.getParameter(F):k}:function(A){return A.getParameter(F)},setter:N?function(D,N){var s=cj.for(D);s.version>1&&D.pixelStorei(F,N)}:function(x,V){x.pixelStorei(F,V)}}}function H(u){return"string"==typeof u?th(u):u.r!==r?(N[0]=u.r,N[1]=u.g,N[2]=u.b,N[3]=u.a,N):u.red!==r?(N[0]=u.red,N[1]=u.green,N[2]=u.blue,N[3]=u.alpha,N):u}function h(p){return B(p)?Array.prototype.slice.call(p,0):p}function u(G,N,v){this.gl=N,this._record=v||{},this._branches={},this._leafSync={},this._struct=G;for(var w=G.children,X=w.length;X--;){var O=w[X],K=O.name;O.isLeaf?(this._leafSync[K]=!1,this._record[K]=h(O.desc.def)):this._record[K]={}}}function q(i){function T(C,z){u.call(this,i,C,z);for(var J=I.length;J--;){var S=I[J];this._branches[S._name]=new S._type(C,this._record[S._name])}}function H(F,m){function w(M,p){for(var z=V,N=!1;z--;)M[z]!==p[z]&&(M[z]=p[z],N=!0);return N}var K=F.name,x=B(F.desc.def),V=x&&F.desc.def.length;if(F.isLeaf){var k=F.desc.setter,c=F.desc.parse;b.defineProperty(m,K,{configurable:!1,enumerable:!0,get:function(){return this._record[K]},set:x?function(H){c&&(H=c(H)),(w(this._record[K],H)||!this._leafSync[K])&&(k(this.gl,this._record[K]),this._leafSync[K]=!0)}:function(z){this._record[K]===z&&this._leafSync[K]||(k(this.gl,z),this._record[K]=z,this._leafSync[K]=!0)}})}else I.push({_name:K,_type:q(F)}),b.defineProperty(m,K,{configurable:!1,enumerable:!0,get:function(){return this._branches[K]},set:function(n){this._branches[K].apply(n)}})}var I=[];return D(T,u),i.forEach(H,T.prototype),T}var N="undefined"!=typeof Float32Array&&new Float32Array(4),e={viewport:{def:[0,0,0/0,0/0],getter:function(n){return n.getParameter(n.VIEWPORT)},setter:function(K,o){var Y=o[2]!==o[2]?K.drawingBufferWidth-o[0]:o[2],b=o[3]!==o[3]?K.drawingBufferHeight-o[1]:o[3];K.viewport(o[0],o[1],Y,b)}},dither:{def:!1,getter:function(R){return R.isEnabled(R.DITHER)},setter:function(b,p){p?b.enable(b.DITHER):b.disable(b.DITHER)}},rasterizerDiscard:{def:!1,getter:function(w){var T=cj.for(w);return T.version>1&&w.isEnabled(w.RASTERIZER_DISCARD)},setter:function(r,b){var u=cj.for(r);1!==u.version&&(b?r.enable(r.RASTERIZER_DISCARD):r.disable(r.RASTERIZER_DISCARD))}},lineWidth:{def:1,getter:function(t){return t.lineWidth?t.getParameter(t.LINE_WIDTH):1},setter:function(r,y){r.lineWidth&&r.lineWidth(y)}},color:{clear:{def:[0,0,0,0],getter:function(C){return C.getParameter(C.COLOR_CLEAR_VALUE)},setter:function(_,h){_.clearColor(h[0],h[1],h[2],h[3])},parse:H},mask:{def:[!0,!0,!0,!0],getter:function(r){return r.getParameter(r.COLOR_WRITEMASK)},setter:function(l,D){l.colorMask(D[0],D[1],D[2],D[3])}}},blend:{enabled:{def:!1,getter:function(r){return r.isEnabled(r.BLEND)},setter:function(N,P){P?N.enable(N.BLEND):N.disable(N.BLEND)}},color:{def:[0,0,0,0],getter:function(D){return D.getParameter(D.BLEND_COLOR)},setter:function(d,Q){d.blendColor(Q[0],Q[1],Q[2],Q[3])},parse:H},equation:{def:[Jk.FUNC_ADD,Jk.FUNC_ADD],getter:function(z){return[z.getParameter(z.BLEND_EQUATION_RGB),z.getParameter(z.BLEND_EQUATION_ALPHA)]},setter:function(D,h){D.blendEquationSeparate(h[0],h[1])},parse:function(h){var q=h.length;return q>1?h:1===q?(N[1]=N[0]=h[0],N):(N[1]=N[0]=h,N)}},func:{def:[Jk.ONE,Jk.ZERO,Jk.ONE,Jk.ZERO],getter:function(O){return[O.getParameter(O.BLEND_SRC_RGB),O.getParameter(O.BLEND_DST_RGB),O.getParameter(O.BLEND_SRC_ALPHA),O.getParameter(O.BLEND_DST_ALPHA)]},setter:function(W,d){W.blendFuncSeparate(d[0],d[1],d[2],d[3])},parse:function(Y){var C=Y.length;return C>3?Y:(N[2]=N[0]=Y[0],N[3]=N[1]=Y[1],N)}}},cullFace:{enabled:{def:!1,getter:function(g){return g.isEnabled(g.CULL_FACE)},setter:function(B,E){E?B.enable(B.CULL_FACE):B.disable(B.CULL_FACE)}},mode:{def:Jk.BACK,getter:function(N){return N.getParameter(N.CULL_FACE_MODE)},setter:function(x,o){x.cullFace(o)}},frontFace:{def:Jk.CCW,getter:function(J){return J.getParameter(J.FRONT_FACE)},setter:function(g,D){g.frontFace(D)}}},scissor:{enabled:{def:!1,getter:function(m){return m.isEnabled(m.SCISSOR_TEST)},setter:function(x,Z){Z?x.enable(x.SCISSOR_TEST):x.disable(x.SCISSOR_TEST)}},box:{def:[0,0,0/0,0/0],getter:function(H){return H.getParameter(H.SCISSOR_BOX)},setter:function($,T){var g=T[2]!==T[2]?$.drawingBufferWidth-T[0]:T[2],K=T[3]!==T[3]?$.drawingBufferHeight-T[1]:T[3];$.scissor(T[0],T[1],g,K)}}},depth:{enabled:{def:!1,getter:function(F){return F.isEnabled(F.DEPTH_TEST)},setter:function(x,$){$?x.enable(x.DEPTH_TEST):x.disable(x.DEPTH_TEST)}},clear:{def:1,getter:function(L){return L.getParameter(L.DEPTH_CLEAR_VALUE)},setter:function(z,U){z.clearDepth(U)}},mask:{def:!0,getter:function(D){return D.getParameter(D.DEPTH_WRITEMASK)},setter:function(g,L){g.depthMask(L)}},range:{def:[-1,1],getter:function(Q){return Q.getParameter(Q.DEPTH_RANGE)},setter:function(o,X){o.depthRange(X[0],X[1])}},func:{def:Jk.LESS,getter:function(g){return g.getParameter(g.DEPTH_FUNC)},setter:function(Y,n){Y.depthFunc(n)}}},stencil:{enabled:{def:!1,getter:function(Q){return Q.isEnabled(Q.STENCIL_TEST)},setter:function(v,S){S?v.enable(v.STENCIL_TEST):v.disable(v.STENCIL_TEST)}},clear:{def:0,getter:function(Y){return Y.getParameter(Y.STENCIL_CLEAR_VALUE)},setter:function(I,P){I.clearStencil(P)}},frontMask:{def:255,getter:function(U){return U.getParameter(U.STENCIL_WRITEMASK)},setter:function(j,U){j.stencilMaskSeparate(j.FRONT,U)}},frontOp:{def:[Jk.KEEP,Jk.KEEP,Jk.KEEP],getter:function(f){return[f.getParameter(f.STENCIL_FAIL),f.getParameter(f.STENCIL_PASS_DEPTH_FAIL),f.getParameter(f.STENCIL_PASS_DEPTH_PASS)]},setter:function(V,X){V.stencilOpSeparate(V.FRONT,X[0],X[1],X[2])}},frontFunc:{def:[Jk.ALWAYS,0,255],getter:function(W){return[W.getParameter(W.STENCIL_FUNC),W.getParameter(W.STENCIL_REF),W.getParameter(W.STENCIL_VALUE_MASK)]},setter:function(Y,O){Y.stencilFuncSeparate(Y.FRONT,O[0],O[1],O[2])}},backMask:{def:255,getter:function(w){return w.getParameter(w.STENCIL_BACK_WRITEMASK)},setter:function(x,k){x.stencilMaskSeparate(x.BACK,k)}},backOp:{def:[Jk.KEEP,Jk.KEEP,Jk.KEEP],getter:function(w){return[w.getParameter(w.STENCIL_BACK_FAIL),w.getParameter(w.STENCIL_BACK_PASS_DEPTH_FAIL),w.getParameter(w.STENCIL_BACK_PASS_DEPTH_PASS)]},setter:function(z,G){z.stencilOpSeparate(z.BACK,G[0],G[1],G[2])}},backFunc:{def:[Jk.ALWAYS,0,255],getter:function($){return[$.getParameter($.STENCIL_BACK_FUNC),$.getParameter($.STENCIL_BACK_REF),$.getParameter($.STENCIL_BACK_VALUE_MASK)]},setter:function(f,i){f.stencilFuncSeparate(f.BACK,i[0],i[1],i[2])}}},hint:{generateMipmap:{def:Jk.DONT_CARE,getter:function(F){return F.getParameter(F.GENERATE_MIPMAP_HINT)},setter:function(L,r){L.hint(L.GENERATE_MIPMAP_HINT,r)}},fragmentShaderDerivative:{def:Jk.DONT_CARE,getter:function(C){var B=cj.for(C);return 1!==B.version||B.extensions.OES_standard_derivatives?C.getParameter(Jk.FRAGMENT_SHADER_DERIVATIVE_HINT):Jk.DONT_CARE},setter:function(E,V){var m=cj.for(E);return m.version>1||m.extensions.OES_standard_derivatives?(E.hint(Jk.FRAGMENT_SHADER_DERIVATIVE_HINT,V),void 0):void 0}}},pixelStore:{packAlignment:R(4,Jk.PACK_ALIGNMENT,!1),unpackAlignment:R(4,Jk.UNPACK_ALIGNMENT,!1),unpackFlipY:R(!1,Jk.UNPACK_FLIP_Y_WEBGL,!1),unpackPremultiplyAlpha:R(!1,Jk.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),unpackColorspaceConversion:R(Jk.BROWSER_DEFAULT_WEBGL,Jk.UNPACK_COLORSPACE_CONVERSION_WEBGL,!1),packRowLength:R(0,Jk.PACK_ROW_LENGTH,!0),packSkipPixels:R(0,Jk.PACK_SKIP_PIXELS,!0),packSkipRows:R(0,Jk.PACK_SKIP_ROWS,!0),unpackRowLength:R(0,Jk.UNPACK_ROW_LENGTH,!0),unpackImageHeight:R(0,Jk.UNPACK_IMAGE_HEIGHT,!0),unpackSkipPixels:R(0,Jk.UNPACK_SKIP_PIXELS,!0),unpackSkipRows:R(0,Jk.UNPACK_SKIP_ROWS,!0),unpackSkipImages:R(0,Jk.UNPACK_SKIP_IMAGES,!0)},polygonOffset:{enabled:{def:!1,getter:function(s){return s.isEnabled(s.POLYGON_OFFSET_FILL)},setter:function(g,z){z?g.enable(g.POLYGON_OFFSET_FILL):g.disable(g.POLYGON_OFFSET_FILL)}},value:{def:[0,0],getter:function(S){return[S.getParameter(S.POLYGON_OFFSET_FACTOR),S.getParameter(S.POLYGON_OFFSET_UNITS)]},setter:function(g,O){g.polygonOffset(O[0],O[1])}}},sampleCoverage:{enabled:{def:!1,getter:function(B){return B.isEnabled(B.SAMPLE_COVERAGE)},setter:function(u,a){a?u.enable(u.SAMPLE_COVERAGE):u.disable(u.SAMPLE_COVERAGE)}},alpha:{def:!1,getter:function(T){return T.isEnabled(T.SAMPLE_ALPHA_TO_COVERAGE)},setter:function(g,A){A?g.enable(g.SAMPLE_ALPHA_TO_COVERAGE):g.disable(g.SAMPLE_ALPHA_TO_COVERAGE)}},value:{def:[1,!1],getter:function(h){return[h.getParameter(h.SAMPLE_COVERAGE_VALUE),h.getParameter(h.SAMPLE_COVERAGE_INVERT)]},setter:function(o,K){o.sampleCoverage(K[0],K[1])}}}},z=Zl.create(e,function(m){return"def"in m});u.prototype.reset=function(){for(var T=this._struct.children,O=T.length;O--;){var H=T[O],$=H.name;H.isLeaf?this[$]=H.desc.def:this._branches[$].reset()}},u.prototype.save=function(j){j==r&&(j={});for(var H=this._struct.children,d=H.length;d--;){var L=H[d],J=L.name;if(L.isLeaf)j[J]=h(this._record[J]);else{var w=j[J];w==r&&(j[J]=w={}),this._branches[J].save(w)}}return j},u.prototype.sync=function(p,W){for(var J=this._struct.children,L=J.length;L--;){var d=J[L],Z=d.name;d.isLeaf?(W||!this._leafSync[Z])&&(p?(this._record[Z]=d.desc.getter(this.gl),this._leafSync[Z]=!0):(d.desc.setter(this.gl,this._record[Z]),this._leafSync[Z]=!0)):this._branches[Z].sync(p,W)}},u.prototype.syncLoss=function(){for(var b=this._struct.children,u=b.length;u--;){var q=b[u];q.isLeaf?this._leafSync[q.name]=!1:this._branches[q.name].syncLoss()}},u.prototype.apply=function(y){for(var i=this._struct.children,Y=i.length;Y--;){var l=i[Y],J=l.name;J in y&&(l.isLeaf?this[J]=y[J]:this._branches[J].apply(y[J]))}},u.prototype.append=function(Q){var S=this._struct.childMap;for(var r in Q){var y=S[r];y&&(y.isLeaf?this[r]=Q[r]:this._branches[r].append(Q[r]))}};var t=q(z);return function(m){var Y=m._state;return Y||(m._state=Y=new t(m)),Y}}(),Pr=function(){function N(N,v,D,K){if(N){var z=N.length;if(z!=r)for(var m=0;K>m;++m)v[D+m]=N[m];else N.toArray&&N.toArray(v,D)}else for(var m=0;K>m;++m)v[D+m]=0}function Q(L,P,y){var M=L[0];if(0>=M||M>0)return L;var X=P*y,n=A[X];if(n==r&&(A[X]=n=new Float32Array(X)),0!==P){N(M,n,0,y);for(var J=1,x=0;J!==P;++J)x+=y,N(L[J],n,x,y)}return n}function q($,D){$.uniform1f(this.addr,D)}function I(V,F){V.uniform1fv(this.addr,F)}function $(t,_){if(_.x!=r)t.uniform2f(this.addr,_.x,_.y);else{var O=A[2];O.set(_,0),t.uniform2fv(this.addr,O)}}function a(r,F){r.uniform2fv(this.addr,Q(F,this.size,2))}function R(Y,W){if(W.x!=r)Y.uniform3f(this.addr,W.x,W.y,W.z);else if(W.r!=r)Y.uniform3f(this.addr,W.r,W.g,W.b);else if(W.red!=r)Y.uniform3f(this.addr,W.red,W.green,W.blue);else{var c=A[3];c.set(W,0),Y.uniform3fv(this.addr,c)}}function o(n,f){n.uniform3fv(this.addr,Q(f,this.size,3))}function v(S,T){if("string"==typeof T&&(T=th(T)),T.x!=r)S.uniform4f(this.addr,T.x,T.y,T.z,T.w);else if(T.r!=r)S.uniform4f(this.addr,T.r,T.g,T.b,T.a);else if(T.red!=r)S.uniform4f(this.addr,T.red,T.green,T.blue,T.alpha);else{var R=A[4];R.set(T,0),S.uniform4fv(this.addr,R)}}function s(b,O){b.uniform4fv(this.addr,Q(O,this.size,4))}function g(B,I){B.uniform1i(this.addr,I)}function e(Z,C){Z.uniform1iv(this.addr,C)}function M(u,t){u.uniform2iv(this.addr,t)}function W(D,Q){D.uniform3iv(this.addr,Q)}function L(G,y){G.uniform4iv(this.addr,y)}function f(y,Z){y.uniform1i(this.addr,C[Z?1:0])}function t(c,m){var g=A[4];g.set(m,0),c.uniformMatrix2fv(this.addr,!1,g)}function _($,z){$.uniformMatrix2fv(this.addr,!1,Q(z,this.size,4))}function m(H,W){var x=A[9];x.set(W,0),H.uniformMatrix3fv(this.addr,!1,x)}function H(k,J){k.uniformMatrix3fv(this.addr,!1,Q(J,this.size,9))}function U(S,w){var Z=A[16];Z.set(w,0),S.uniformMatrix4fv(this.addr,!1,Z)}function E(I,u){I.uniformMatrix4fv(this.addr,!1,Q(u,this.size,16))}function F(w,g){w.uniform1i(this.addr,this.slots[0]),w.activeTexture(w.TEXTURE0+this.slots[0]),w.bindTexture(w.TEXTURE_2D,g||w._emptyTexture)}function Y(i,T){i.uniform1iv(this.addr,this.slots);for(var r=this.slots.length;r--;)i.activeTexture(i.TEXTURE0+this.slots[r]),i.bindTexture(i.TEXTURE_2D,T[r]||i._emptyTexture)}function y($,g){$.uniform1i(this.addr,this.slots[0]),$.activeTexture($.TEXTURE0+this.slots[0]),$.bindTexture($.TEXTURE_CUBE_MAP,g||$._emptyCubeTexture)}function X(B,K){B.uniform1iv(this.addr,this.slots);for(var M=this.slots.length;M--;)B.activeTexture(B.TEXTURE0+this.slots[M]),B.bindTexture(B.TEXTURE_CUBE_MAP,K[M]||B._emptyCubeTexture)}function B(o,J,$){j[o]=[J,$]}function z(Y,S,T){switch(Y.type){case 35678:case 35680:if("uSampler"===T)return[0];if("uBlendSampler"===T)return[1];for(var z=Y.size,l=new Int32Array(z),F=0;z>F;++F)l[F]=S.usedTextureSlot++;return l}return r}function w(V,D,Q,_,I){this.name=V,this.addr=D,this.size=_?Q.size:0,this.activeInfo=Q,this.setter=j[Q.type][_?1:0],this.slots=z(Q,I,V),Cc(this)}function J(P,u,b,A){var W=P.name,c=W.length;for(n.lastIndex=0;;){var i=n.exec(W),e=n.lastIndex,v=i[1],Q="]"===i[2],U=i[3];if(Q&&(v=0|v),U===r||"["===U&&e+2===c){b[v]=new w(v,u,P,U!==r,A);break}var C=b[v];C==r&&(b[v]=C={}),b=C}}function V(S,c,h){this.gl=c,this._program=h,this._leaves={},this._branches={},this._struct=S}function k(c){function p(K,D){V.call(this,c,K,D);for(var s=x.length;s--;){var z=x[s];this._branches[z._name]=new z._type(K,D)}this.uuid=ke.generateUUID()}function E(T,v){var U=T.name;if(T.isLeaf){var E=i("d.setter(this.gl, v);",["v"],["d"],[T.desc]);b.defineProperty(v,U,{configurable:!1,enumerable:!0,get:function(){return E},set:E})}else x.push({_name:U,_type:k(T)}),b.defineProperty(v,U,{configurable:!1,enumerable:!0,get:function(){return this._branches[U]},set:function(J){this._branches[U].apply(J)}})}var x=[];return D(p,V),c.forEach(E,p.prototype),p}function p(O,X){for(var w=O.getProgramParameter(X,O.ACTIVE_UNIFORMS),R={},p={usedTextureSlot:2};w--;){var D=O.getActiveUniform(X,w),L=D.name,N=O.getUniformLocation(X,L);J(D,N,R,p)}var H=Zl.create(R,function(o){return"addr"in o}),j=k(H);return b.defineProperty(j.prototype,"textureCount",{configurable:!1,enumerable:!1,writable:!1,value:p.usedTextureSlot}),new j(O,X)}var A=[];if("function"==typeof Float32Array)for(var l=1;17>l;++l)A[l]=new Float32Array(l);var C=[0,1],j=[];B(Jk.FLOAT,q,I),B(Jk.FLOAT_VEC2,$,a),B(Jk.FLOAT_VEC3,R,o),B(Jk.FLOAT_VEC4,v,s),B(Jk.INT,g,e),B(Jk.INT_VEC2,M,M),B(Jk.INT_VEC3,W,W),B(Jk.INT_VEC4,L,L),B(Jk.BOOL,f,e),B(Jk.BOOL_VEC2,M,M),B(Jk.BOOL_VEC3,W,W),B(Jk.BOOL_VEC4,L,L),B(Jk.FLOAT_MAT2,t,_),B(Jk.FLOAT_MAT3,m,H),B(Jk.FLOAT_MAT4,U,E),B(Jk.SAMPLER_2D,F,Y),B(Jk.SAMPLER_CUBE,y,X);var n=/([\w\d_]+)(\])?(\[|\.)?/g;return V.prototype.apply=function($){for(var v=this._struct.children,S=v.length;S--;){var h=v[S],d=h.name;d in $&&(h.isLeaf?this[d]=$[d]:this._branches[d].apply($[d]))}},V.prototype.append=function(W){var L=this._struct.childMap;for(var B in W){var J=L[B];J&&(J.isLeaf?this[B]=W[B]:this._branches[B].append(W[B]))}},function(w,$){var Q=$._uniforms;return Q||($._uniforms=Q=p(w,$)),Q}}(),Yj=function(){function o(U,X,K){X.vertexAttrib1f(U.addr,K)}function O(P,M,g){if(g.x!=r)M.vertexAttrib2f(P.addr,g.x,g.y);else{var B=p[2];B.set(g,0),M.vertexAttrib2fv(P.addr,B)}}function C(e,F,j){if(j.x!=r)F.vertexAttrib3f(e.addr,j.x,j.y,j.z);else if(j.r!=r)F.vertexAttrib3f(e.addr,j.r,j.g,j.b);else if(j.red!=r)F.vertexAttrib3f(e.addr,j.red,j.green,j.blue);else{var M=p[3];M.set(j,0),F.vertexAttrib3fv(e.addr,M)}}function K(t,P,V){if("string"==typeof V&&(V=th(V)),V.x!=r)P.vertexAttrib4f(t.addr,V.x,V.y,V.z,V.w);else if(V.r!=r)P.vertexAttrib4f(t.addr,V.r,V.g,V.b,V.a);else if(V.red!=r)P.vertexAttrib4f(t.addr,V.red,V.green,V.blue,V.alpha);else{var e=p[4];e.set(V,0),P.vertexAttrib4fv(t.addr,e)}}function l(Q,k,q){q=q.el||q;for(var Y=0,L=0;2>Y;++Y)k.vertexAttrib2f(Q.addr,q[L++],q[L++])}function Q(J,S,Y){Y=Y.el||Y;for(var n=0,l=0;3>n;++n)S.vertexAttrib3f(J.addr,Y[l++],Y[l++],Y[l++])}function f(C,l,s){s=s.el||s;for(var N=0,c=0;4>N;++N)l.vertexAttrib4f(C.addr,s[c++],s[c++],s[c++],s[c++])}function a(P,L,l,e){for(var h,A=l?1:0,J=L.addr,F=P._divisorState,B=0;e>B;B++)h=F[J+B]||0,h!==A&&(F[J+B]=A,P.vertexAttribDivisor(J+B,A))}function x(e,O,s,V,D,z,B){O.bindBuffer(O.ARRAY_BUFFER,s);var C=e.addr;O.enableVertexAttribArray(C),a(O,e,s.instanced,1),O.vertexAttribPointer(C,1,V||O.FLOAT,!!D,z||0,B||0),O.bindBuffer(O.ARRAY_BUFFER,null)}function I(R,C,w,N,o,b,Z){C.bindBuffer(C.ARRAY_BUFFER,w);var l=R.addr;C.enableVertexAttribArray(l),a(C,R,w.instanced,1),C.vertexAttribPointer(l,2,N||C.FLOAT,!!o,b||0,Z||0),C.bindBuffer(C.ARRAY_BUFFER,null)}function T(r,D,U,h,$,c,w){D.bindBuffer(D.ARRAY_BUFFER,U);var g=r.addr;D.enableVertexAttribArray(g),a(D,r,U.instanced,1),D.vertexAttribPointer(g,3,h||D.FLOAT,!!$,c||0,w||0),D.bindBuffer(D.ARRAY_BUFFER,null)}function z(D,i,m,g,C,X,$){i.bindBuffer(i.ARRAY_BUFFER,m);var n=D.addr;i.enableVertexAttribArray(n),a(i,D,m.instanced,1),i.vertexAttribPointer(n,4,g||i.FLOAT,!!C,X||0,$||0),i.bindBuffer(i.ARRAY_BUFFER,null)}function S(U,f,y,C,S,W,j){var W=W||16,j=j||0,s=U.addr;f.bindBuffer(f.ARRAY_BUFFER,y),f.enableVertexAttribArray(s),f.vertexAttribPointer(s,2,C||f.FLOAT,!!S,W,j),f.enableVertexAttribArray(s+1),f.vertexAttribPointer(s+1,2,C||f.FLOAT,!!S,W,j+8),a(f,U,y.instanced,2),f.bindBuffer(f.ARRAY_BUFFER,null)}function g(S,q,P,r,K,W,s){var W=W||36,s=s||0,L=S.addr;q.bindBuffer(q.ARRAY_BUFFER,P);for(var b=0;3>b;b++)q.enableVertexAttribArray(L+b),q.vertexAttribPointer(L+b,3,r||q.FLOAT,!!K,W,s+12*b);a(q,S,P.instanced,3),q.bindBuffer(q.ARRAY_BUFFER,null)}function n(q,i,t,H,Q,M,E){var M=M||64,E=E||0,m=q.addr;i.bindBuffer(i.ARRAY_BUFFER,t);for(var j=0;4>j;j++)i.enableVertexAttribArray(m+j),i.vertexAttribPointer(m+j,4,H||i.FLOAT,!!Q,M,E+16*j);a(i,q,t.instanced,4),i.bindBuffer(i.ARRAY_BUFFER,null)}function X(G,g,h,M){y[G]=function(j,i,m,b,C,J){this.addr==r||this.addr<0||(i==r||i===!1?M(j,this.addr):Bs(i)===Z?h(this,j,i,m,b,C,J):(M(j,this.addr),g(this,j,i)))}}function d(a,j){a.disableVertexAttribArray(j)}function E(h,B){h.disableVertexAttribArray(B),h.disableVertexAttribArray(B+1)}function k(h,y){h.disableVertexAttribArray(y),h.disableVertexAttribArray(y+1),h.disableVertexAttribArray(y+2)}function R(q,v){q.disableVertexAttribArray(v),q.disableVertexAttribArray(v+1),q.disableVertexAttribArray(v+2),q.disableVertexAttribArray(v+3)}function P(G,p,R){this.name=G,this.addr=p,this.activeInfo=R,this.setter=y[R.type],Cc(this)}function F(d,l,p){this.gl=l,this.program=p,this._branches={},this._struct=d}function s(t){function g(Z,W){F.call(this,t,Z,W);for(var T=o.length;T--;){var z=o[T];this._branches[z._name]=new z._type(Z,W)}}function R(g,K){var Z=g.name;if(g.isLeaf){var T=i("d.setter(this.gl, v);",["v"],["d"],[g.desc]);b.defineProperty(K,Z,{configurable:!1,enumerable:!0,get:function(){return T},set:T})}else o.push({_name:Z,_type:s(g)}),b.defineProperty(K,Z,{configurable:!1,enumerable:!0,get:function(){return this._branches[Z]},set:function(y){this._branches[Z].apply(y)}})}var o=[];return D(g,F),t.forEach(R,g.prototype),g}function M(R,b){for(var U=R.getProgramParameter(b,R.ACTIVE_ATTRIBUTES),z={};U--;){var O=R.getActiveAttrib(b,U),T=O.name,C=R.getAttribLocation(b,T);z[T]=new P(T,C,O)}var W=Zl.create(z,function(d){return"addr"in d}),K=s(W);return new K(R,b)}for(var p=[],v=1;17>v;++v)p[v]=new Ki(v);var y=[],Z="undefined"!=typeof WebGLBuffer&&WebGLBuffer.prototype;return X(Jk.FLOAT,o,x,d),X(Jk.FLOAT_VEC2,O,I,d),X(Jk.FLOAT_VEC3,C,T,d),X(Jk.FLOAT_VEC4,K,z,d),X(Jk.FLOAT_MAT2,l,S,E),X(Jk.FLOAT_MAT3,Q,g,k),X(Jk.FLOAT_MAT4,f,n,R),F.prototype.disable=function(){for(var h=this._struct.children,u=h.length;u--;){var p=h[u],g=p.name;p.isLeaf?this[g]=r:this._branches[g].disable()}},F.prototype.apply=function(p){for(var l=this._struct.children,q=l.length;q--;){var L=l[q],i=L.name;i in p&&(L.isLeaf?this[i]=p[i]:this._branches[i].apply(p[i]))}},F.prototype.append=function(w){var v=this._struct.childMap;for(var b in w){var j=v[b];j&&(j.isLeaf?this[b]=w[b]:this._branches[b].append(w[b]))}},function(A,W){var h=W._attribs;return h||(W._attribs=h=M(A,W)),h}}(),El=function(S){var d=this;b.defineProperties(this,{gl:{configurable:!1,enumerable:!1,value:S,writable:!1},glState:{configurable:!1,enumerable:!1,value:Zr(S),writable:!1}}),d._currProgram=r,d._currUniforms=r,d._currAttribs=r,d._sync=!0};b.defineProperties(El.prototype,{program:{configurable:!1,enumerable:!1,get:function(){return this._currProgram},set:function(E){var f=this;f._sync&&E===f._currProgram||(f.gl.useProgram(E),f._currProgram=E,f._currUniforms=Pr(f.gl,E),f._currAttribs=Yj(f.gl,E),f._sync=!0)}},uniforms:{configurable:!1,enumerable:!1,get:function(){var N=this;return N._currProgram&&!N._sync&&(N.gl.useProgram(N._currProgram),N._sync=!0),N._currUniforms},set:function(o){var X=this;X._currUniforms&&(X._currProgram&&!X._sync&&(X.gl.useProgram(X._currProgram),this._sync=!0),X._currUniforms.apply(o))}},attribs:{configurable:!1,enumerable:!1,get:function(){var d=this;return d._currProgram&&!d._sync&&(d.gl.useProgram(d._currProgram),d._sync=!0),d._currAttribs},set:function(j){var V=this;V._currUniforms&&(V._currProgram&&!V._sync&&(V.gl.useProgram(V._currProgram),this._sync=!0),V._currAttribs.apply(j))}}}),El.prototype.useProgram=function(d){var g=this;g._sync&&d===g._currProgram||(g.gl.useProgram(d),g._currProgram=d,g._currUniforms=Pr(g.gl,d),g._currAttribs=Yj(g.gl,d),g._sync=!0)},El.prototype.directState=function(){return this.glState},El.prototype.directUniforms=function(){return this._currUniforms},El.prototype.directAttribs=function(){return this._currAttribs},El.prototype.syncLoss=function(){this._sync=!1,this.glState.syncLoss()},El.for=function(b){var x=b._renderState;return x||(b._renderState=x=new El(b)),x};var cq="directional",uj="point",Ql="spot",tr="light.color",Ye=4294967295,Ak=0,tk={},Vj=[],Nk=0,$m=function(J,d){ph(d)&&Ep.test(d)?Oo(J,d):Tq(d)&&d.modelType?Zn(J,d):d===r?delete us[J]:us[J]=d},qk=function(D){return D},Pf=function(G){G=u.convertShape3dModelName(G);var O;if(Tq(G)){if(G.modelType){if(G.uuid){if(O=us[G.uuid])return O}else G.uuid=A.Math.generateUUID();return O===r&&(ad&&ad[G.uuid]||Zn(G.uuid,G)),r}return G}return O=us[G],G&&O===r&&Ep.test(G)&&(ad&&ad[G]||Oo(G,G)),O},Xg=function(L,b){L.frameStack?L.frameStack.push(b):L.frameStack=[b],L.bindFramebuffer(L.FRAMEBUFFER,b)},Lp=function(H){var Y=H.frameStack;if(Y){if(Y.pop(),Y.length)return H.bindFramebuffer(H.FRAMEBUFFER,Y[Y.length-1]),void 0;H.frameStack=null}H.bindFramebuffer(H.FRAMEBUFFER,null)};hf(u,{graph3dViewAttributes:$,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:Z/60,graph3dViewSortable:!1,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Sc,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewRotateMaxPhi:Z,graph3dViewRotateMinPhi:0,graph3dViewShadowDisabled:!0,graph3dViewShadowQuality:"high",graph3dViewShadowIntensity:.3,graph3dViewShadowBias:-.005,graph3dViewShadowRadius:.1,graph3dViewShadowType:"hard",graph3dViewShadowDegreeX:30,graph3dViewShadowDegreeZ:-10,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewSyncEyeWithOrthoWidth:!1,graph3dViewFovy:Z/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewDataNumWarningLine:1e4,graph3dViewHeadlightDirection:"camera",graph3dViewHeadlightRange:0,graph3dViewHeadlightGroup:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogMode:"linear",graph3dViewFogDensity:5e-4,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewUvClipEnabled:!1,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dViewBatchInstancedDisabled:!0,graph3dViewFlowBlendMode:"addRGB",graph3dViewEnvmapType:"legacy",graph3dMaxVectorCacheTime:50,graph3dEnvmapCapabilityRequire:8,setShape3dModel:$m,getShape3dModel:Pf,convertShape3dModelName:qk,getShape3dModelMap:function(){return us},getCachedShape3dModelMap:function(){return Fp},createMatrix:function(u,M){Zf(u)||(u=[u]);for(var x=u.length-1;x>=0;x--){var s=u[x];M=Nm(s.mat,s.s3,s.r3,s.rotationMode,s.t3,M)}return M},transformVec:function(C,a){return Vk(C,a)},glBindFrame:Xg,glUnbindFrame:Lp,createBoxModel:function(){return{vs:yr,ns:Th,uv:Pg,is:Bl}},createRoundRectModel:function(m,l){return Rf.roundRect(m,l)},createStarModel:function(V,Z){return Rf.star(V,Z)},createRectModel:function(k,C){return Rf.rect(k,C)},createTriangleModel:function(v,l){return Rf.triangle(v,l)},createRightTriangleModel:function(i,l){return Rf.rightTriangle(i,l)},createParallelogramModel:function(G,e){return Rf.parallelogram(G,e)},createTrapezoidModel:function(C,n){return Rf.trapezoid(C,n)},createSmoothSphereModel:function(w,j,h,I,G,T,U){return wh(new ir(w,j,h,I,G,T,U))},createSphereModel:function(Q,x,K,q,F,E,e){return Q?Sk(Q,x,K,q,F,E,e):u.createSmoothSphereModel()},createSmoothConeModel:function(p,m,l,h,L){return mn(p,m,l,h,L)},createConeModel:function(O,l,P,k,M,J,S,C){return O?Vb(O,l,P,k,M,J,S,C):mn(J)},createSmoothCylinderModel:function(U,c,I,O,Q,M,X,f){return wh(new pm(U,c,I,O,Q,M,X,f))},createCylinderModel:function(v,y,d,o,F,g,A,L){return v?Mb(v,y,d,o,F,g,A,L):ko(g,A)},createSmoothTorusModel:function(_,J,I,E,v,x){return wh(new pj(_,J,I,E,v,x))},createTorusModel:function(G,O,K,D,d,R,Q,n){return G?yd(G,O,K,D,d,R,Q,n):Cp(R,Q)},createExtrusionModel:function(U,H,x,u,I,_,j,q){return df(U,H,x,u,I,_,j,q)},createSmoothRingModel:function(c,r,j,S,g,H){for(var C=[],N=0;N<c.length-1;N+=2)C.push({x:c[N],y:c[N+1]});for(c=Mp(C,r,j)[0],C=[],N=0;N<c.length;N++){var X=c[N];C.push(new hc(X.x,0,X.y))}return wh(new wp(C,H,S,g))},createTextGeometry:function(F,x){var c=wh(new ue(F,x));if(x.cube)for(var N=Rj(c),h=N.min,w=N.max,k=h.x,L=h.y,T=h.z,W=w.x-k||1,X=w.y-L||1,J=w.z-T||1,C=["vs","top_vs","bottom_vs"],o=0,i=C.length;i>o;o++){var H=c[C[o]];if(H)for(var n=0,a=H.length;a>n;n+=3)H[n]=(H[n]-k)/W-.5,H[n+1]=(H[n+1]-L)/X-.5,H[n+2]=(H[n+2]-T)/J-.5}return c},loadFontFace:function(H,V){u.xhrLoad(H,function(D){if(!D)return V();var c;try{c=JSON.parse(D)}catch(R){c=JSON.parse(D.substring(65,D.length-2))}Mo.loadFace(c),V&&V(c.familyName.toLowerCase())},V?null:{sync:!0})},getShaderErrorLog:function(){return Vj.join("\n")},createRingModel:function(h,c,N,k,v,b,e,G,n,A){for(var _=[],t=0;t<h.length-1;t+=2)_.push({x:h[t],y:h[t+1]});b=b||u.shapeSide,e=e||0,G=G||b;var p,E,o,L,M,V,j,F,O,f,t,U,R,r,K,T,S,P,x=[],l=[],z=n?[]:$,C=n?[]:$,B=A?[]:$,J=A?[]:$,Z=k?[]:$,y=k?[]:$,I=v?[]:$,W=v?[]:$,h=Mp(_,c,N),g=Ud(h),i=0,H=2*Math.PI/b;return h.forEach(function(_){if(o=_.length,o>1){if(L=_[0],k)for(V=L.x,F=L.y,t=e;G>t;t++)U=t+1,R=t*H,r=U*H,K=m(R),T=X(R),S=m(r),P=X(r),Z.push(K*V,F,-T*V,S*V,F,-P*V,0,F,0),y.push(.5-.5*K,.5-.5*T,.5-.5*S,.5-.5*P,.5,.5);for(f=0;o>f;f++){for(M=_[f],V=L.x,j=M.x,F=L.y,O=M.y,p=i/g,i+=Kj(L,M),E=i/g,t=e;G>t;t++)U=t+1,R=t*H,r=U*H,K=m(R),T=X(R),S=m(r),P=X(r),x.push(K*j,O,-T*j,S*j,O,-P*j,K*V,F,-T*V,S*j,O,-P*j,S*V,F,-P*V,K*V,F,-T*V),l.push(t/b,E,U/b,E,t/b,p,U/b,E,U/b,p,t/b,p),n&&t===e&&(z.push(0,F,0,0,O,0,K*j,O,-T*j,K*j,O,-T*j,K*V,F,-T*V,0,F,0),C.push(0,.5-F,0,.5-O,2*j,.5-O,2*j,.5-O,2*V,.5-F,0,.5-F)),A&&U===G&&(B.push(0,F,0,S*j,O,-P*j,0,O,0,S*j,O,-P*j,0,F,0,S*V,F,-P*V),J.push(1,.5-F,1-2*j,.5-O,1,.5-O,1-2*j,.5-O,1,.5-F,1-2*V,.5-F));L=M}if(v)for(V=L.x,F=L.y,t=e;G>t;t++)U=t+1,R=t*H,r=U*H,K=m(R),T=X(R),S=m(r),P=X(r),I.push(S*V,F,-P*V,K*V,F,-T*V,0,F,0),W.push(.5-.5*S,.5+.5*P,.5-.5*K,.5+.5*T,.5,.5)}}),{vs:x,uv:l,bottom_vs:I,bottom_uv:W,top_vs:Z,top_uv:y,from_vs:z,from_uv:C,to_vs:B,to_uv:J}}},!0),hf(x,{"3d.move.mode":r,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"3d.reflectable":!0,"shape.border.gradient.color":r,"edge.gradient.color":r,"edge.source.t3":r,"edge.target.t3":r,"light.type":uj,"light.group":0,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":Z/4,"light.range":0,"light.exponent":1,"light.intensity":1,"light.mask":Ye,"headlight.ambientIntensity":r,"wf.visible":!1,"wf.width":1,"wf.fog":!0,"wf.color":qo,"wf.short":!1,"wf.mat":r,"wf.boundingBox":!1,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:r,"transparent.mask":!1,brightness:r,"select.brightness":.7,"repeat.uv.length":r,"shadow.cast":!0,"shadow.receive":!0,"3d.clipbox":r,"3d.clipbox.mask":Ye,"3d.clipbox.group":0,"3d.clipbox.shape":"cube","effect.flow":!1,"effect.flow.gradient":"spread.horizontal","effect.flow.uvshape":"rect","effect.flow.size":512,"effect.flow.group":0,"effect.flow.intensity":1,"effect.flow.blend":r,"effect.flow.mask":Ye,bloom:!1,envmap:0,"envmap.probe":0,roughness:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,"texture.cache":!1,"hide.overlapping.group":r,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.type":"hard","highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","highlight.glow":.8,"highlight.strength":2,"color.empty":[0,0,0,0],"label.face":Er,"label.t3":r,"label.r3":r,"label.texture.scale":2,"label.rotationMode":_c,"label.light":!1,"label.blend":r,"label.reverse.flip":!1,"label.reverse.color":Zc,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Er,"label2.t3":r,"label2.r3":r,"label2.texture.scale":2,"label2.rotationMode":_c,"label2.light":!1,"label2.blend":r,"label2.reverse.flip":!1,"label2.reverse.color":Zc,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Er,"note.t3":r,"note.r3":r,"note.texture.scale":2,"note.rotationMode":_c,"note.light":!1,"note.blend":r,"note.reverse.flip":!1,"note.reverse.color":Zc,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Er,"note2.t3":r,"note2.r3":r,"note2.texture.scale":2,"note2.rotationMode":_c,"note2.light":!1,"note2.blend":r,"note2.reverse.flip":!1,"note2.reverse.color":Zc,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:r,"shape3d.color":tm,"shape3d.top.color":r,"shape3d.bottom.color":r,"shape3d.from.color":r,"shape3d.to.color":r,"shape3d.image":r,"shape3d.image.projection":r,"shape3d.top.image":r,"shape3d.bottom.image":r,"shape3d.from.image":r,"shape3d.to.image":r,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":r,"shape3d.side.to":r,"shape3d.smooth":r,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":r,"shape3d.opacity":r,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Zc,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":r,"shape3d.uv.scale":r,"shape3d.uv.rotation":r,"shape3d.uv.anchor":r,"shape3d.uv.union":r,"shape3d.top.uv.offset":r,"shape3d.top.uv.scale":r,"shape3d.top.uv.rotation":r,"shape3d.top.uv.anchor":r,"shape3d.bottom.uv.offset":r,"shape3d.bottom.uv.scale":r,"shape3d.bottom.uv.rotation":r,"shape3d.bottom.uv.anchor":r,"shape3d.from.uv.offset":r,"shape3d.from.uv.scale":r,"shape3d.from.uv.rotation":r,"shape3d.from.uv.anchor":r,"shape3d.to.uv.offset":r,"shape3d.to.uv.scale":r,"shape3d.to.uv.rotation":r,"shape3d.to.uv.anchor":r,"shape3d.top.cap":r,"shape3d.bottom.cap":r,"shape3d.start.angle":0,"shape3d.sweep.angle":g,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.blur":0,"shape3d.reflector.blur.iterations":1,"shape3d.reflector.background":null,"shape3d.reflector.clip":.003,"shape3d.reflector.shadow":"scene","camera.type":"perspective","camera.aspect":1,"camera.fovy":r,"camera.ortho.width":r,"camera.near":r,"camera.far":r,"camera.background":0,"camera.renderSky":!0,"camera.renderAxis":!1,"camera.renderGrid":!1,"camera.renderEdit":!1,"camera.onlySky":!1,"texture.mipmap.max":r,"texture.filter":r,"texture.filter.min":r,"texture.filter.mag":r,"texture.wrap":r,"points.image":"rect","points.color":"white","points.transparent":!1,"points.size":20,"points.opacity":1,"points.uv.scale":[1,1],"points.uv.offset":[0,0],"points.discard.selectable":!1,"all.light":!0,"all.visible":!0,"all.color":tm,"all.image":r,"all.blend":r,"all.opacity":r,"all.reverse.flip":!1,"all.reverse.color":Zc,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":r,"all.uv.offset":r,"all.uv.scale":r,"all.uv.rotation":r,"all.uv.anchor":r,"all.uv.union":r,"all.discard.selectable":!0,mat:r,"left.mat":r,"right.mat":r,"top.mat":r,"bottom.mat":r,"front.mat":r,"back.mat":r,"edge.source.anchor.elevation":r,"edge.target.anchor.elevation":r,"edge.source.offset.elevation":0,"edge.target.offset.elevation":0},!0);
var jr,rm=!1,ti=[0,0,0,0],Dr=function(f){return f instanceof Kr},sm=function(u){return[u.x,u.e||0,u.y]},Bk=function(k,b,s){for(var b=th(b||0),C=b[0],$=b[1],N=b[2];s--;)k.push(C,$,N)},Ao=function(v,q,Q){for(var q=th(q||0),W=q[0],t=q[1],z=q[2],h=q[3];Q--;)v.push(W,t,z,h)},Vd=function(Q,t,R){if(t)for(var N,q,p,h=t[0],u=t[1],J=t[2],v=t[4],x=t[5],U=t[6],X=t[8],g=t[9],s=t[10],T=t[12],H=t[13],F=t[14],I=R.length,P=0,P=0;I>P;P+=3)N=R[P],q=R[P+1],p=R[P+2],Q.push(h*N+v*q+X*p+T,u*N+x*q+g*p+H,J*N+U*q+s*p+F);else di(Q,R);return Q},Op=function($,p,c){var J=p.s("light.intensity"),s=th(p.s(tr)),b=s[0],y=s[1],l=s[2];1!==J&&(b*=J,y*=J,l*=J);var L=p.s("light.disabled");$.push(b,y,l,L?1:0),c.c.push(b,y,l),c.g.push(L?-1:p.s("light.group")),c.e.push(L?1:0)},Uj=function(A,o){var N,p=El.for(o),x=p.directUniforms(),$=A._lastLightUploadInfo={c:[],g:[],e:[]},c=A._headlightDirection;c&&3===c.length?N=c:"shadow"===c&&(N=A.shadowMap.getDirection()),N=N?hb.normalizeArray(A._transformDirectionToViewSpace(null,N)):[0,0,0],x.uHeadlightDirection=N,x.uHeadlightRange=A._headlightRange;var U=x.uHeadlightAmbientIntensity=A._headlightAmbientIntensity,Z=A._headlightIntensity,W=th(A._headlightColor);1!==Z&&(W=[W[0]*Z,W[1]*Z,W[2]*Z]);var M;x.uHeadlightColor=[W[0],W[1],W[2],(M=A._headlightDisabled)?1:0],$.c.push(W[0],W[1],W[2]),$.g.push(M?-1:A._headlightGroup),$.e.push(M?1:0);var b=A._59O,v=A._spots,r=A._dirs;if(b.length){var E=[],a=[],f=[];b.forEach(function(j){Op(E,j,$),di(a,A._transformPointToViewSpace(j.p3())),f.push(j.s("light.range"))}),x.uPointColor=E,x.uPointRange=f,x.uPointPosition=a}if(v.length){var K=[],G=[],g=[],L=[],Y=[],J=[];v.forEach(function(E){Op(K,E,$),di(G,A._transformPointToViewSpace(E.p3())),di(Y,A._transformDirectionToViewSpace(E.p3(),E.s("light.center"))),g.push(E.s("light.range")),L.push(m(E.s("light.angle")/2)),J.push(E.s("light.exponent"))}),x.uSpotColor=K,x.uSpotRange=g,x.uSpotAngle=L,x.uSpotExponent=J,x.uSpotPosition=G,x.uSpotDirection=Y}if(r.length){var l=[],s=[];r.forEach(function(a){Op(l,a,$),di(s,A._transformDirectionToViewSpace(a.p3()))}),x.uDirColor=l,x.uDirDirection=s}A._lastLightMask=Ye,A._lastHeadlightAmbientIntensity=U},xs=function(I,F,u,i){if(i===r&&(i=I._headlightAmbientIntensity),i!==I._lastHeadlightAmbientIntensity&&(F.uHeadlightAmbientIntensity=I._lastHeadlightAmbientIntensity=i),u!==I._lastLightMask){I._lastLightMask=u;var $=I._lastLightUploadInfo;if($){var N,K,v,T=$.g,C=$.e,j=T.length,B=new Array(j),z=!1;for(K=0;j>K;K++)N=T[K],v=0>N||N>=32?1:u&1<<N?0:1,B[K]=v,v!==C[K]&&(z=!0);if(z){$.e=C=B;var P=$.c;F.uHeadlightColor=[P[0],P[1],P[2],C[0]];var M,A=I._59O,y=I._spots,k=I._dirs,h=3,X=1;if(j=A.length){for(K=0,M=[];j>K;K++)M.push(P[h++],P[h++],P[h++],C[X++]);F.uPointColor=M}if(j=y.length){for(K=0,M=[];j>K;K++)M.push(P[h++],P[h++],P[h++],C[X++]);F.uSpotColor=M}if(j=k.length){for(K=0,M=[];j>K;K++)M.push(P[h++],P[h++],P[h++],C[X++]);F.uDirColor=M}}}}},So=function(X,y){return Math.max(X.getRotateMinPhi()+Vh,Math.min(X.getRotateMaxPhi()-Vh,y))},Db=function(){return.05+Fi()/2},tg=function(E,C,k,V){var l,d=E.getEye();return E.isOrtho()?(l=Ur(E.getCenter(),d),l[0]+=V[0],l[1]+=V[1],l[2]+=V[2]):l=d,Lc(C,k,V,l)},Lc=function(b,p,n,e){var C=Jn(b,p),E=Ur(e,n,!0),c=Jn(E,p);if(k(c)<Vh)return $;var M=(C-Jn(n,p))/c;return[n[0]+E[0]*M,n[1]+E[1]*M,n[2]+E[2]*M]},qg=function(o,h){return{x:2*o.x-h.x,y:2*o.y-h.y}},_d=function(d,L,W,K){var S,w;if(!d)return S=ys(L.y-W.y,W.x-L.x),{x:L.x+K*X(S),y:L.y+K*m(S)};if(!W)return S=ys(d.y-L.y,L.x-d.x),{x:L.x+K*X(S),y:L.y+K*m(S)};var z=Ur([d.x,d.y,0],[L.x,L.y,0],!0),l=Ur([W.x,W.y,0],[L.x,L.y,0],!0),o=-(z[0]+l[0])/2,t=-(z[1]+l[1])/2,H=_(o*o+t*t);if(Vh>H)return S=ys(d.y-L.y,L.x-d.x),{x:L.x+K*X(S),y:L.y+K*m(S)};var G=d.x-L.x,O=d.y-L.y,C=W.x-L.x,e=W.y-L.y,R=_(G*G+O*O),T=_(C*C+e*e);S=s(Jn(z,l))/2,w=z[1]*l[0]-z[0]*l[1]>0?-1:1,o/=H,t/=H;var r=K/X(S),u=E(R,T)/m(S);H=Math.min(r,u);var j={x:L.x+w*H*o,y:L.y+w*H*t};return W.b&&r>T/m(S)&&(j.adjust=!0),j},yj=function(k){var A=k[1],P=k[2],N=k[3],C=k[6],a=k[7],s=k[11];k[1]=k[4],k[2]=k[8],k[3]=k[12],k[4]=A,k[6]=k[9],k[7]=k[13],k[8]=P,k[9]=C,k[11]=k[14],k[12]=N,k[13]=a,k[14]=s},Ed=function(k){var A=k[0],c=k[1],_=k[2],h=k[3],N=k[4],l=k[5],v=k[6],e=k[7],q=k[8],g=k[9],D=k[10],F=k[11],s=k[12],z=k[13],G=k[14],S=k[15],j=A*l-c*N,Z=A*v-_*N,i=A*e-h*N,m=c*v-_*l,O=c*e-h*l,X=_*e-h*v,K=q*z-g*s,P=q*G-D*s,Q=q*S-F*s,I=g*G-D*z,L=g*S-F*z,o=D*S-F*G,p=j*o-Z*L+i*I+m*Q-O*P+X*K;return p?(p=1/p,k[0]=(l*o-v*L+e*I)*p,k[1]=(_*L-c*o-h*I)*p,k[2]=(z*X-G*O+S*m)*p,k[3]=(D*O-g*X-F*m)*p,k[4]=(v*Q-N*o-e*P)*p,k[5]=(A*o-_*Q+h*P)*p,k[6]=(G*i-s*X-S*Z)*p,k[7]=(q*X-D*i+F*Z)*p,k[8]=(N*L-l*Q+e*K)*p,k[9]=(c*Q-A*L-h*K)*p,k[10]=(s*O-z*i+S*j)*p,k[11]=(g*i-q*O-F*j)*p,k[12]=(l*P-N*I-v*K)*p,k[13]=(A*I-c*P+_*K)*p,k[14]=(z*Z-s*m-G*j)*p,k[15]=(q*m-g*Z+D*j)*p,void 0):$},Ph=function(U,N){if(N){var n=N[0],k=N[1],Y=N[2];U[12]=U[0]*n+U[4]*k+U[8]*Y+U[12],U[13]=U[1]*n+U[5]*k+U[9]*Y+U[13],U[14]=U[2]*n+U[6]*k+U[10]*Y+U[14],U[15]=U[3]*n+U[7]*k+U[11]*Y+U[15]}},bp=function(P,w){if(w){var p=w[0],K=w[1],o=w[2];P[0]=P[0]*p,P[1]=P[1]*p,P[2]=P[2]*p,P[3]=P[3]*p,P[4]=P[4]*K,P[5]=P[5]*K,P[6]=P[6]*K,P[7]=P[7]*K,P[8]=P[8]*o,P[9]=P[9]*o,P[10]=P[10]*o,P[11]=P[11]*o}},fm=function(U,d,D){var T=d[0],B=d[1],p=d[2],v=d[3],L=d[4],S=d[5],_=d[6],b=d[7],W=d[8],G=d[9],n=d[10],h=d[11],g=d[12],c=d[13],j=d[14],N=d[15],i=D[0],z=D[1],u=D[2],s=D[3];return U[0]=i*T+z*L+u*W+s*g,U[1]=i*B+z*S+u*G+s*c,U[2]=i*p+z*_+u*n+s*j,U[3]=i*v+z*b+u*h+s*N,i=D[4],z=D[5],u=D[6],s=D[7],U[4]=i*T+z*L+u*W+s*g,U[5]=i*B+z*S+u*G+s*c,U[6]=i*p+z*_+u*n+s*j,U[7]=i*v+z*b+u*h+s*N,i=D[8],z=D[9],u=D[10],s=D[11],U[8]=i*T+z*L+u*W+s*g,U[9]=i*B+z*S+u*G+s*c,U[10]=i*p+z*_+u*n+s*j,U[11]=i*v+z*b+u*h+s*N,i=D[12],z=D[13],u=D[14],s=D[15],U[12]=i*T+z*L+u*W+s*g,U[13]=i*B+z*S+u*G+s*c,U[14]=i*p+z*_+u*n+s*j,U[15]=i*v+z*b+u*h+s*N,U},nr=function(K,G,r,R){var q,h,M,u,F,i,W,J,z,d,S=G[0],I=G[1],b=G[2],E=R[0],U=R[1],$=R[2],P=r[0],l=r[1],L=r[2];return k(S-P)<Vh&&k(I-l)<Vh&&k(b-L)<Vh?Gj(K):(W=S-P,J=I-l,z=b-L,d=1/_(W*W+J*J+z*z),W*=d,J*=d,z*=d,q=U*z-$*J,h=$*W-E*z,M=E*J-U*W,d=_(q*q+h*h+M*M),d?(d=1/d,q*=d,h*=d,M*=d):(q=0,h=0,M=0),u=J*M-z*h,F=z*q-W*M,i=W*h-J*q,d=_(u*u+F*F+i*i),d?(d=1/d,u*=d,F*=d,i*=d):(u=0,F=0,i=0),K[0]=q,K[1]=u,K[2]=W,K[3]=0,K[4]=h,K[5]=F,K[6]=J,K[7]=0,K[8]=M,K[9]=i,K[10]=z,K[11]=0,K[12]=-(q*S+h*I+M*b),K[13]=-(u*S+F*I+i*b),K[14]=-(W*S+J*I+z*b),K[15]=1,K)},aq=function(j,O,A,k,u){var P=1/Hb(O/2),l=1/(k-u);return j[0]=P/A,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=P,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[10]=(u+k)*l,j[11]=-1,j[12]=0,j[13]=0,j[14]=2*u*k*l,j[15]=0,j},mb=function(E,p,K,M,G,D,m){var V=1/(p-K),R=1/(M-G),g=1/(D-m);return E[0]=-2*V,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=-2*R,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=2*g,E[11]=0,E[12]=(p+K)*V,E[13]=(G+M)*R,E[14]=(m+D)*g,E[15]=1,E},Nh=function(D,l){var M=l[0],U=l[1],P=l[2],J=l[3],B=M*M+U*U+P*P+J*J,G=B?1/B:0;return D[0]=-M*G,D[1]=-U*G,D[2]=-P*G,D[3]=J*G,D},Xh=function(s,V){var n=V[0]+V[5]+V[10],w=0;return n>0?(w=2*Math.sqrt(n+1),s[3]=.25*w,s[0]=(V[6]-V[9])/w,s[1]=(V[8]-V[2])/w,s[2]=(V[1]-V[4])/w):V[0]>V[5]&V[0]>V[10]?(w=2*Math.sqrt(1+V[0]-V[5]-V[10]),s[3]=(V[6]-V[9])/w,s[0]=.25*w,s[1]=(V[1]+V[4])/w,s[2]=(V[8]+V[2])/w):V[5]>V[10]?(w=2*Math.sqrt(1+V[5]-V[0]-V[10]),s[3]=(V[8]-V[2])/w,s[0]=(V[1]+V[4])/w,s[1]=.25*w,s[2]=(V[6]+V[9])/w):(w=2*Math.sqrt(1+V[10]-V[0]-V[5]),s[3]=(V[1]-V[4])/w,s[0]=(V[8]+V[2])/w,s[1]=(V[6]+V[9])/w,s[2]=.25*w),s},Ih=function(Q,s,H){var q=s[0],K=s[1],D=s[2],C=s[3],f=q+q,u=K+K,E=D+D,L=q*f,o=q*u,G=q*E,a=K*u,N=K*E,V=D*E,O=C*f,B=C*u,k=C*E;return Q[0]=1-(a+V),Q[1]=o+k,Q[2]=G-B,Q[3]=0,Q[4]=o-k,Q[5]=1-(L+V),Q[6]=N+O,Q[7]=0,Q[8]=G+B,Q[9]=N-O,Q[10]=1-(L+a),Q[11]=0,Q[12]=H[0],Q[13]=H[1],Q[14]=H[2],Q[15]=1,Q},ro=function(g,I){if(g.isVREnabled()){var _=g.vr.getViewMatrix(I);if(_)return _}return g._camera?g._camera.getViewMatrix(I):nr(I?I:Kl(),g._eye,g._center,g._up)},Ck=function(S,v){if(S.isVREnabled()){var c=S.vr.getProjectMatrix();if(c)return c}if(S._camera)return S._camera.getProjectMatrix();if(!v&&S._computedProjectMatrix)return bg(S._computedProjectMatrix);var z=S.getAspect(),b=S._near,B=S._far,K=Kl();if(S._ortho){var C=S._orthoWidth/2,H=C/z;mb(K,-C,C,-H,H,b,B)}else aq(K,S._fovy,z,b,B);return K},kk=function(l,f){if(!l)return $;var J=0,E=1,b=2,g=[],c=0,U=l.length,S=U/3;if(f){for(;U>c;c++)g[c]=0;for(c=0;c<f.length;c+=3){var W=[],e=[],G=[];W[J]=l[3*f[c+1]+J]-l[3*f[c]+J],W[E]=l[3*f[c+1]+E]-l[3*f[c]+E],W[b]=l[3*f[c+1]+b]-l[3*f[c]+b],e[J]=l[3*f[c+2]+J]-l[3*f[c+1]+J],e[E]=l[3*f[c+2]+E]-l[3*f[c+1]+E],e[b]=l[3*f[c+2]+b]-l[3*f[c+1]+b],G[J]=W[E]*e[b]-W[b]*e[E],G[E]=W[b]*e[J]-W[J]*e[b],G[b]=W[J]*e[E]-W[E]*e[J];for(var A=0;3>A;A++)g[3*f[c+A]+J]+=G[J],g[3*f[c+A]+E]+=G[E],g[3*f[c+A]+b]+=G[b]}}else for(c=0;S>c;c+=3){var W=[],e=[],G=[];W[J]=l[3*(c+1)+J]-l[3*c+J],W[E]=l[3*(c+1)+E]-l[3*c+E],W[b]=l[3*(c+1)+b]-l[3*c+b],e[J]=l[3*(c+2)+J]-l[3*(c+1)+J],e[E]=l[3*(c+2)+E]-l[3*(c+1)+E],e[b]=l[3*(c+2)+b]-l[3*(c+1)+b],G[J]=W[E]*e[b]-W[b]*e[E],G[E]=W[b]*e[J]-W[J]*e[b],G[b]=W[J]*e[E]-W[E]*e[J];for(var A=0;3>A;A++)g[3*(c+A)+J]=G[J],g[3*(c+A)+E]=G[E],g[3*(c+A)+b]=G[b]}for(c=0;U>c;c+=3){var k=[];k[J]=g[c+J],k[E]=g[c+E],k[b]=g[c+b];var V=_(k[J]*k[J]+k[E]*k[E]+k[b]*k[b]);0===V&&(V=Vh),k[J]=k[J]/V,k[E]=k[E]/V,k[b]=k[b]/V,g[c+J]=k[J],g[c+E]=k[E],g[c+b]=k[b]}return new Ki(g)},gs=function(_,z,w,d){if(w||(w=_.createTexture()),z){var P=_.TEXTURE_2D,Z=_.REPEAT,k=_.CLAMP_TO_EDGE,I=_.TEXTURE_MIN_FILTER;d=d||Oe;var x=d.minFilter||d.filter||_.LINEAR,e=d.magFilter||d.filter||_.LINEAR;_.activeTexture(_.TEXTURE0),kf(_,w),_.texImage2D(P,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,z),he(_,_.TEXTURE_MAG_FILTER,e);var Q=z.naturalWidth||z.width,Y=z.naturalHeight||z.height;ke.isPOT(Q)&&ke.isPOT(Y)&&!d.clampToEdge&&!z.clampToEdge?(he(_,_.TEXTURE_WRAP_S,Z),he(_,_.TEXTURE_WRAP_T,Z),he(_,I,x===_.NEAREST?_.NEAREST_MIPMAP_NEAREST:_.LINEAR_MIPMAP_LINEAR),d.mipmapMaxLevel!==r&&he(_,_.TEXTURE_MAX_LEVEL,d.mipmapMaxLevel),_.generateMipmap(P)):(he(_,_.TEXTURE_WRAP_S,k),he(_,_.TEXTURE_WRAP_T,k),he(_,I,x)),kf(_,$)}return w},Vf=function(U,h,m){var y=new Uint8Array(m||4);return h=h||U.createTexture(),U.activeTexture(U.TEXTURE0),kf(U,h),he(U,U.TEXTURE_MIN_FILTER,U.LINEAR),U.texImage2D(U.TEXTURE_2D,0,U.RGBA,1,1,0,U.RGBA,U.UNSIGNED_BYTE,y),h},sd=function(l,L,v){var e=new Uint8Array(v||4);return L=L||l.createTexture(),l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_CUBE_MAP,L),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_MAG_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_MIN_FILTER,l.LINEAR),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,e),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,e),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,e),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,e),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,e),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,e),L},Cf=function(Z){Z._26I&&Z._prg&&(Z._26I.deleteProgram(Z._prg),Z._prg=$)},Uc=function(){function M(V){if(V.match(U))return rr(V);var M=k[V];if(M)return M;var g=new RegExp("#define\\s+"+V+"\\s+(\\d+)"),F=b.match(g);return k[V]=F?rr(F[1]):0}function H(C){k={},b=C;var f=C.replace(d,Q).replace(R,o);return b=null,k=null,f}function Q(l,u,G){G=M(G);for(var T="",O=0;G>O;O++)T+=u+O+";";return T}function o(N,z,q,n){for(var C="",w=M(z);w<M(q);w++)C+=n.replace(/\[\s*i\s*\]/g,"["+w+"]").replace(/\[\s*I\s*\]/g,w);return C}var k,b,d=/(uniform\s+sampler2D\s+\w+)\[([\S\d]+)\];/g,R=/#UNROLL_LOOP_START\s+for\s*\(\s*int\s+i\s*=\s*([\S\d]+)\s*;\s*i\s*<\s*([\S\d]+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#UNROLL_LOOP_END/g,U=/^\d+$/;return function(y){return H(y)}}(),Nn=function(B,s,h,r){var t=B.createShader(h);return B.shaderSource(t,Uc(r)),B.compileShader(t),B.attachShader(s,t),t},xp=function(K){return K.createBuffer()},kf=function(x,C){x.bindTexture(x.TEXTURE_2D,C||x._emptyTexture)},he=function(d,s,N){d.texParameteri(d.TEXTURE_2D,s,N)},He=function(o,A){var e=El.for(o).directState();e.polygonOffset.enabled=!0,e.polygonOffset.value=A},Wn=function(i){var R=El.for(i).directState();R.polygonOffset.enabled=!1},gp=function(K,o){if(o){var u=El.for(K).directState();u.color.clear=th(o)}},Ej=function(C,G,F){if(F!==G._lastClipboxEnabled){var E=C._boxClipperGroups,R=C._boxClipperShape,U=E?E.length:0,W=new Array(U);if(F)for(var M=0;U>M;M++)W[M]=F&1<<E[M]?R[M]:0;G._lastClipboxEnabled=F,G.uClipperShape=W}},qj=Ej,xm=function(H){var O=El.for(H),C=O.directUniforms(),M=O.directAttribs();C.uFix=!0,M.aNormal=!1},qf=function($){var v=El.for($),h=v.directUniforms();h.uFix=!1},Gb=function(J,b,B,m,O,T,h,l){var K=El.for(J),F=K.directState(),z=K.directUniforms();J._picking||(B?(z.uBlend=!0,z.uBlendColor=B):z.uBlend=!1,z.uLight=z.uFog=m==$?!0:m,fl(O)&&1!==O&&(z.uPartOpacity=O),z.uReverseFlip=T==$?!1:T,z.uFixPickReverseColor=h||Zc),F.cullFace.enabled=l?!0:!1},pl=function(A){if(!A._picking){var t=El.for(A),e=t.directUniforms();e.uPartOpacity=1}},Mc=function(){var v=new A.Math.Matrix2d,L=[1,0,0,0,1,0,0,0,0];return function(q,e,x,Z,D,Q,w,y,B,j,M){var U=El.for(q),O=U.directUniforms(),n=U.directAttribs();return x?(O.uTexture=!0,O.uDiscardSelectable=xn(Z)?Z:!0,n.aUv=Nr(q,D,Q,$,2),M?(O.uBlendTexture=!0,O.uBlendSampler=M):(O.uBlendTexture=!1,O.uBlendSampler=q._emptyBlendTexture),O.uSampler=x,O.uUvMatrix=w||y||B||j?wj(B,w,y,j,v).toArray9():L,void 0):(O.uSampler=q._emptyTexture,O.uBlendSampler=q._emptyBlendTexture,void 0)}}(),ni=function(J,k,S){var P=El.for(J),z=P.directUniforms(),K=P.directAttribs();J.activeTexture(J.TEXTURE0),kf(J,$),J.activeTexture(J.TEXTURE1),kf(J,$),S&&(K.aUv=!1,z.uTexture=!1,z.uSampler=J._emptyTexture,z.uBlendTexture=!1,z.uBlendSampler=J._emptyBlendTexture)},pn=function(r,G,X,o,l,j){var S=El.for(r),J=S.directUniforms(),D=S.directAttribs();!X||yo||pf||r.lineWidth(X),o&&!r._picking&&(J.uFixPickReverseColor=o),l&&(D.aPosition=Nr(r,l,j,$))},vb=function(H,q,k,W,x){jr&&(W=H[jr]),x?H.drawArraysInstanced(W==$?H.TRIANGLES:W,q,k,x):H.drawArrays(W==$?H.TRIANGLES:W,q,k);var s=H._renderInfo;s&&(s.calls++,x&&(k*=x),s.vertices+=k,(W==$||W===H.TRIANGLES)&&(s.faces+=k/3),W===H.LINES&&(s.lines+=k/2),W===H.POINTS&&(s.points+=k))},Ae=function(d,G,V,r,D,B){jr&&(r=d[jr]),B?d.drawElementsInstanced(r==$?d.TRIANGLES:r,V,D==$?d.UNSIGNED_SHORT:D,G==$?0:2*G,B):d.drawElements(r==$?d.TRIANGLES:r,V,D==$?d.UNSIGNED_SHORT:D,G==$?0:2*G);var t=d._renderInfo;t&&(t.calls++,B&&(V*=B),t.vertices+=V,(r==$||r===d.TRIANGLES)&&(t.faces+=V/3),r===d.LINES&&(t.lines+=V/2),r===d.POINTS&&(t.points+=V))},Km=function(V,z,d){var I=V.ARRAY_BUFFER;return V.bindBuffer(I,z),d&&V.bufferData(I,d,V.STATIC_DRAW),z},Sg=function(M,V,R,N,_){var V=Nr(M,V,R,N,_);return V.instanced=!0,V},Nr=function(D,U,a,y,W){return a?Eo(D,D.ARRAY_BUFFER,U,a):Km(D,U,a,y,W)},jf=function(B,X,f){var T=B.ELEMENT_ARRAY_BUFFER;B.bindBuffer(T,X),f&&B.bufferData(T,f,B.STATIC_DRAW)},Kf=function(p,R,h){Eo(p,p.ELEMENT_ARRAY_BUFFER,R,h)},Eo=function(P,x,Q,M){var z=M._bufId;z||(z=M._bufId=A.Math.generateIncreasingID());var Q,O=P._bufPool;return(Q=O[z])&&Q._buf?P.bindBuffer(x,Q._buf):(Q=O[z]={_buf:xp(P)},P.bindBuffer(x,Q._buf),P.bufferData(x,M,P.STATIC_DRAW)),Q._fid=P._renderInfo.frame,Q._buf},Ib=function(U,S){S!=$&&S>=0&&U.enableVertexAttribArray(S)},fe=function(m,h){h!=$&&h>=0&&m.disableVertexAttribArray(h)},xl=function(F,u){var A=F.getGL(),b=El.for(A),t=b.directUniforms();F._7O=F._8O.pop(),u&&(t.uMVMatrix=F._7O,F._6O=u,t.uNMatrix=u)},eg=function(C,A){return A||(A=Kl()),Gc(A,C),Ed(A),yj(A),A},sk=function($,z){var h=$.getGL(),X=$._7O,u=El.for(h),r=u.directUniforms();z?($._8O.push(bg(X)),r.uMMatrix=z,fm(X,X,z),$._7O=X):r.uMMatrix=Jd,r.uMVMatrix=X,r.uNMatrix=eg(X,$._6O)},jo={body:0,label:1,label2:2,note:3,note2:4,symbol:5},Ug=10,Sr=function(x,r,C,N,o,E){var p;if(C){var f=N._pickId;f||(f=N._pickId=r._pickIdUsed,r._pickIdUsed+=Ug);var K,F=jo[o];if(null!=F)K=f+F;else{var h=N._pickExtraPartMap;h||(h=N._pickExtraPartMap={}),(K=h[o])||(K=h[o]=r._pickIdUsed++)}r[K]||(r[K]={data:N.data,part:o}),p=Us(K)}else p=ti;if(!E){var S=El.for(x),Q=S.directUniforms();Q.uFixPickReverseColor=p}return p},dc=Sr,Jr=function(f,h,W){"target"!==W&&(W="source");var p="target"===W?h.getTargetAgent():h.getSourceAgent(),c="edge."+W+".";if(Dk(p)){var V=h.s(c+"anchor.x"),Y=h.s(c+"anchor.elevation"),Z=h.s(c+"anchor.y"),m=Zi(p,f.getMat(p)),a=p.getAnchor3d(),A=Vk([(V===r?.5:V)-a.x,(Y===r?.5:Y)-a.y,(Z===r?.5:Z)-a.z],m);return A[1]+=h.s(c+"offset.elevation"),A}var d=h.s(c+"index"),u=f.getData3dUI(p);if(!u.info||!u.info.list)return!1;if(d>=0){var v,n,C,y,K,J=u.info._lastPointsSegments,I=J.points,q=J.segments,j=-1,Q=-1;for(C=0,y=q?q.length:I.length;y>C;C++){if(n=q?q.get(C):1,3===n)K=2;else if(4===n)K=3;else{if(5===n)continue;K=1}if(j+=K,Q++,Q===d){v=I.get(j);break}}return v||(v=I.get(I.length-1)),[v.x,(v.e||0)+h.s(c+"offset.elevation"),v.y]}var G=h.s(c+"percent")||.5;if(G=Math.max(0,Math.min(G,1)),!u||!u.getCache)return!1;var i=u.getCache(),y=i[i.length-1].length,J=f.getLineOffset(p,G*y),A=J.point;return[A.x,A.y+h.s(c+"offset.elevation"),A.z]},_e=function(){var c={center:function(w,s,b,O,D){var x=-s[1]/2,v={x:-s[0]/2,y:x,width:s[0],height:s[1]},e=wi(w,v,b);return[e.x+O,-e.y-D,u.getPosition3dGap()]},front:function(g,S,I,Z,d){var J=-S[1]/2,k={x:-S[0]/2,y:J,width:S[0],height:S[1]},b=wi(g,k,I);return[b.x+Z,-b.y-d,S[2]/2+u.getPosition3dGap()]},back:function(I,m,l,j,B){var L=-m[0]/2,v=-m[1]/2,R={x:L,y:v,width:m[0],height:m[1]},Q=wi(I,R,l);return[-Q.x-j,-Q.y-B,-m[2]/2-u.getPosition3dGap()]},left:function(V,K,d,E,W){var P=-K[1]/2,A={x:-K[2]/2,y:P,width:K[2],height:K[1]},b=wi(V,A,d);return[-K[0]/2-u.getPosition3dGap(),-b.y-W,b.x+E]},right:function(F,d,w,D,K){var C=-d[2]/2,g=-d[1]/2,x={x:C,y:g,width:d[2],height:d[1]},t=wi(F,x,w);return[d[0]/2+u.getPosition3dGap(),-t.y-K,-t.x-D]},top:function(n,$,C,p,y){var l={x:-$[0]/2,y:-$[2]/2,width:$[0],height:$[2]},S=wi(n,l,C);return[S.x+p,$[1]/2+u.getPosition3dGap(),S.y+y]},bottom:function(C,K,p,X,m){var d=-K[2]/2,L={x:-K[0]/2,y:d,width:K[0],height:K[2]},E=wi(C,L,p);return[E.x+X,-K[1]/2-u.getPosition3dGap(),-E.y-m]}};return function(D,C,O,w,K,B){return c[w](D,C,O,K||0,B||0)}}(),nm=function(g,R,S,C,h,W,k,t,s,j){if(h&&(R[0]+=h[0],R[1]+=h[1],R[2]+=h[2]),Ph(g,S),t){var r=Kl();if(zh(r,s,j),Vk(R,r),Ph(g,R),g.auto=t,g.pos=Vk([0,0,0],g),W){var Y=g.mat2=Kl();zh(Y,W,k)}}else zh(g,s,j),Ph(g,R),C===sl?ob(g,-Ce):C===vp?ob(g,Ce):C===Yd?kd(g,-Ce):C===gg?kd(g,Ce):C===yc&&ob(g,Z),zh(g,W,k);return g},gq=function(I,V){var N=V.auto,x=V.mat2,T=I.gv;if(N){var e,g=Kl(),_=[0,0,0,0];e="string"==typeof N?[N.indexOf("x")<0?T._eye[0]:T._center[0],N.indexOf("y")<0?T._eye[1]:T._center[1],N.indexOf("z")<0?T._eye[2]:T._center[2]]:T._eye,Xh(_,nr(Kl(),e,T._center,T._up)),Ih(g,Nh(_,_),V.pos),x&&fm(g,g,x),sk(T,g)}else sk(T,V)},fi=function(_,p,W,J,s){var M=_.s,x=_.gv,e=x.getGL(),t=x._prg,r=x._buffer,P=x._1O,T=El.for(e),d=T.directAttribs();gs(e,bk,P),gq(_,W),Gb(e,t,M(p+".blend"),M(p+".light"),M(p+".opacity"),M(p+".reverse.flip"),M(p+".reverse.color"),M(p+".reverse.cull")),Mc(e,t,P,s,r.uv,Ir),d.aPosition=Nr(e,r.vs,J,$),d.aNormal=Nr(e,r.ns,$k,$),Kf(e,r.is,$i),Ae(e,0,$i.length),ni(e,t,P),pl(e,t),xl(x)},fd=function(V,s,y){var U=V.gv,L=V.data,j=V[s]={blend:U.getBodyColor(L)||U.getFaceBlend(L,s),light:U.getFaceLight(L,s),color:U.getFaceColor(L,s),opacity:U.getFaceOpacity(L,s),transparent:U.getFaceTransparent(L,s),reverseFlip:U.getFaceReverseFlip(L,s),reverseColor:U.getFaceReverseColor(L,s),reverseCull:U.getFaceReverseCull(L,s),texture:U.getFaceImage(L,s),blendTexture:U.getFaceBlendImage(L,s),discardSelectable:U.getFaceDiscardSelectable(L,s)};if("csg"!==s){j.uv=U.getFaceUv(L,s)||y&&y[s+"Uv"],j.uvScale=U.getFaceUvScale(L,s)||y&&y[s+"UvScale"],j.uvOffset=U.getFaceUvOffset(L,s)||y&&y[s+"UvOffset"],j.uvRotation=U.getFaceUvRotation(L,s)||y&&y[s+"uvRotation"],j.uvAnchor=U.getFaceUvAnchor(L,s)||y&&y[s+"uvAnchor"];var C=U.getFaceMat(L,s);if(C){var e=Zi(L,C);L.appendAnchorMatrix3d(e),j.mat=e}}return j},bh=function(l,T,A,Q,G){var c=l[Q];if(c){if(!G(c.transparent))return;var t=l.data,R=l.gv,r=R._buffer,b=R.getTexture(c.texture,t,Q),k=R.getTexture(c.blendTexture,t),q=El.for(T),Y=q.directUniforms(),z=q.directAttribs();Mc(T,A,b,c.discardSelectable,r.uv,c.tuv,c.uvOffset,c.uvScale,c.uvRotation,c.uvAnchor,k),Gb(T,A,c.blend,c.light,c.opacity,c.reverseFlip,c.reverseColor,c.reverseCull),c.cs&&!R._batchColorDisabled?(Y.uBatchColor=!0,z.aBatchColor=Nr(T,r.batchColor,c.cs,A.aBatchColor,4)):Y.uDiffuse=c.color||x["color.empty"],z.aPosition=Nr(T,r.vs,c.vs,$),z.aNormal=Nr(T,r.ns,c.ns,$),vb(T,0,c.vs.length/3),c.cs&&!R._batchColorDisabled&&(Y.uBatchColor=!1,fe(T,A.aBatchColor)),pl(T,A),ni(T,A,b)}},Cm=function(u,j,P){Zf(u)?u.forEach(function(v){Cm(v,j,P)}):ph(u)?Cm(Wj(j,u),j,P):Tq(u)?u.shape3d?Cm(u.shape3d,j,P):P.push(u):P.push(u)},Pl=function(){for(var c=50,g=arguments.length,q=[],k=0;g>k;k++)q[k]=arguments[k];Vj[Nk]="Time : "+(new Date).toLocaleString()+", Info :"+q.join(", "),Nk=(Nk+1)%c,console.error("Failed to create shader.")},wj=function(){var V=new ke.Matrix2d;return function(W,P,m,L,d){return d||(d=V),d.identity(),L&&d.translate(-L[0],-L[1]),m&&d.scale(m[0],m[1]),W&&d.rotate(W),L&&d.translate(L[0],L[1]),P&&d.translate(P[0],P[1]),d}}(),Ai=function(l,Q,f,w,K,$){var R,W,_,h,j,Z,v,F,L,t,c,O=[w-Q,K-f],B=l?l.length:0;for(_=0;B>_;_++){for(h=2,R=l[_],j=R[0],Z=R[1];h+1<R.length;){if(v=R[h],F=R[h+1],W=go(Q,f,w,K,j,Z,v,F,!0)){L=[v-j,F-Z],t=Kj(L),L[0]/=t,L[1]/=t,t=Jn(O,L),t=t>0?$:-$,c=[L[0]*t,L[1]*t];break}j=v,Z=F,h+=2}if(c)break}if(c)for(w=Q+c[0],K=f+c[1],_=0;B>_;_++)for(h=2,R=l[_],j=R[0],Z=R[1];h+1<R.length;){if(v=R[h],F=R[h+1],W=go(Q,f,w,K,j,Z,v,F,!0))return[0,0];j=v,Z=F,h+=2}return c?c:[w-Q,K-f]},$r=function(X){return"nearest"===X?Jk.NEAREST:"linear"===X?Jk.LINEAR:X},Fr=A.graph3d={WebGLConstants:Jk},Kd=function(T,i,L){bd(n+".graph3d."+T,i,L)},Fc="!~!<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~!<6/1!,!*{/mbdpMwVxpmg!,!z/mbdpMwVxpmg!-y/mbdpMwVxpmg)3dfw!>!^j]wVxpmg!<{zy/*enspgtobsu!+!yjsubNNv!+!^j]yjsubNxpmg)!>!mbdpMwVxpmg!|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1!>!j!uoj)!spg!<mbdpMwVxpmg!4dfw!1!?!UDFKCP`XPMG`YBN!gj$!gjeof$!<enspgtobsu!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!QBNXPEBIT`FTV!gfegj$!gjeof$!~!<fdobutjEfojMb!>!fdobutjEfojMw!|!*itbEv)!gj!ITBE!gfegj$!gjeof$!~!<ttfouihjsCidubCb!>!ttfouihjsCidubCw!|!*ttfouihjsCidubCv)!gj!TTFOUIHJSCIDUBC!gfegj$!gjeof$!~!<eofmCidubCb!>!eofmCidubCw!|!*eofmCidubCv)!gj!EOFMCIDUBC!gfegj$!gjeof$!~!<spmpDidubCb!>!spmpDidubCw!|!*spmpDidubCv)!gj!SPMPDIDUBC!gfegj$!gjeof$!~!<**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw!>!wVw!|!*fsvuyfUv)!gj!ftmf$!<*y/wVb!-**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw)4dfw!>!wVw!QJMD`WV!gfegj$!<*enspgtobsu)4dfw!>!opjujtpQw!gjeof$!~!1!>>!SFQQJMD`YPC`YBN!gj$!<*enspgtobsu!+!yjsubNNv)4dfw!>!emspXw!<*yfusfw)4dfw!>!yfusfWw!gjeof$!<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!ftmf$!<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!ftmf!~!<**1/2!-mbnspOw!+!n)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!<**^3]n!-^3]n)upe!-*^2]n!-^2]n)upe!-*^1]n!-^1]n)upe)4dfw!0!mbnspOb!>!mbnspOw!<*!efdobutoJyjsubNb!)4ubn!>!n!4ubn!|!*fdobutoJftVv)!gj!FDOBUTOJIDUBC!gfegj$!gjeof$!|!*ldjQva)!gj!1!>>!SFQQJMD`YPC`YBN!gj$!<enspgtobsu!+!yjsubNWNv!>!yfusfw!5dfw!gjeof$!~!<enspgtobsu!+!efdobutoJyjsubNb!>!enspgtobsu!|!*fdobutoJftVv)!gj!FDOBUTOJIDUBC!gfegj$!<*1/2!-opjujtpQb)5dfw!>!enspgtobsu!5dfw!|!*ejpw)ojbn!ejpw!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw!<^UDFKCP`XPMG`YBN]yjsubNxpmg!5ubn!nspgjov!1!?!UDFKCP`XPMG`YBN!gj$!gjeof$!<esppDxpebit!5dfw!hojzsbw!<yjsubNxpebit!5ubn!nspgjov!QBNXPEBIT`FTV!gfegj$!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw!<fdobutjEfojMb!ubpmg!fuvcjsuub!<itbEv!mppc!nspgjov!ITBE!gfegj$!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov!<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov!<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov!<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov!<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!gjeof$!<eofmCidubCw!4dfw!hojzsbw!<eofmCidubCb!4dfw!fuvcjsuub!<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw!<ttfouihjsCidubCb!ubpmg!fuvcjsuub!<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!gjeof$!<spmpDidubCw!5dfw!hojzsbw!<spmpDidubCb!5dfw!fuvcjsuub!<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw!<emspXw!4dfw!hojzsbw!<yfusfWw!4dfw!hojzsbw!<mbnspOw!4dfw!hojzsbw!<yjGv!mppc!nspgjov!<ldjQv!mppc!nspgjov!<yjsubNxfjWv!5ubn!nspgjov!<yjsubNOv!5ubn!nspgjov!<yjsubNQv!5ubn!nspgjov!<yjsubNNv!5ubn!nspgjov!<yjsubNWNv!5ubn!nspgjov!<opjujtpQb!4dfw!fuvcjsuub!gjeof$!~!<*{zy/**1/1!-sje)5dfw!+!yjsubn))f{jmbnspo!osvufs!|!*yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsu!4dfw!<efdobutoJyjsubNb!5ubn!fuvcjsuub!<fdobutoJftVv!mppc!nspgjov!FDOBUTOJIDUBC!gfegj$!<mbnspOb!4dfw!fuvcjsuub!gjeof$!<wVw!3dfw!hojzsbw!ftmf$!<wVw!4dfw!hojzsbw!QJMD`WV!gfegj$!<wVb!3dfw!fuvcjsuub!<yjsubNwVv!4ubn!nspgjov!<fsvuyfUeofmCv!mppc!nspgjov!<fsvuyfUv!mppc!nspgjov!YJGFSQ$!^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Fq="!~!~!<eJ!>!spmpDhbsG`mh!~!<spmpDsfmqnbTwv!>+!eJ!<*zy/wVw!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw!|!*fsvuyfUeofmCv)!gj!gjeof$!~!<ttfouihjsCidubCw!>+!chs/eJ!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~!<ttfouihjsCv!>+!chs/eJ!|*1/2!>a!ttfouihjsCv)gj!gjeof$!~!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ!gjeof$!<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg!ftmf$!<*iuqfe!+!iuqfe!+!zujtofEhpGv!+!zujtofEhpGv!.)qyf!.!1/2!>!spudbGhpg!ubpmg!3QYF`HPG!gfegj$!<{/yfusfWw.!>!iuqfe!ubpmg!|!*hpGv)!gj!HPG!gfegj$!~!~!<zujdbqPusbQv!>+!b/eJ!|*1/2!>a!zujdbqPusbQv)gj!~!gjeof$!~!<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ!gjeof$!<*spmpDwof)sbfojMpUmfyfUqbNwof!>!spmpDwof!<**{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv)fcvDfsvuyfu!>!spmpDwof!5dfw!ftmf$!<**ttfoihvps!-*{z/dfWudfmgfs!-y/dfWudfmgfs.)4dfw!-qbNwoFv)WVfcvDfsvuyfu)CHStpUsbfojM!>!spmpDwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!gjeof$!<*mbnspOemspx!-yfusfWpUbsfnbd)udfmgfs!>!dfWudfmgfs!4dfw!ftmf$!<***mbnspOemspx!-yfusfWpUbsfnbd)udfmgfs!-ubvRqbnwoFv)spudfWfubups)f{jmbnspo!>!dfWudfmgfs!4dfw!FUBUPS`QBNWOF!gfegj$!<*yjsubNxfjWv!-O)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw!<*opjujtpQbsfnbDv!.!emspXw)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw!|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!gjeof$!~!~!~!~!<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ!<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt!|*^j]fmhoBupqTv!?!udfggFupqt)gj!<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg!<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw!|*1/1!?!fhobSm)!gj!~!<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm!|*1/1!?!^j]fhobSupqTv)!gj!<1/2!>!fhobSm!ubpmg!<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw!|*1/1!>>!x/^j]spmpDupqTv)gj!|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!gjeof$!~!~!~!<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ!|*1/1!?!fhobSm)!gj!~!<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm!|*1/1!?!^j]fhobSuojpQv)!gj!<1/2!>!fhobSm!ubpmg!<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw!|*1/1!>>!x/^j]spmpDuojpQv)gj!|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!gjeof$!~!~!<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ!|*1/1!>>!x/^j]spmpDsjEv)gj!|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~!<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!gjeof$!~!<fvmbWxpebit!+!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm!~!<osvufs!<esbdtje!|!*1/1!>>!fvmbWxpebit!%%!mmvDxpebit)!gj!<*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit)xpebiTufh!.!1/2!>!fvmbWxpebit!ubpmg!|!*fwjfdfSxpebit)!gj!QBNXPEBIT`FTV!gfegj$!~!<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!>+!nsfUusfcnbm!|*1/1!?!fhobSuihjmebfIv)gj!<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!nsfUusfcnbm)ybn!>!nsfUusfcnbm!<*opjudfsjEuihjmebfIv.!-O)upe!>!nsfUusfcnbm!ftmf!<*M.!-O)upe!>!nsfUusfcnbm!*1/1!>>!{/opjudfsjEuihjmebfIv!%%!1/1!>>!z/opjudfsjEuihjmebfIv!%%!1/1!>>!y/opjudfsjEuihjmebfIv)!gj!<nsfUusfcnbm!ubpmg!|*1/1!>>!x/spmpDuihjmebfIv)gj!gjeof$!EOF`QPPM`MMPSOV$!~!gjeof$!<chs/mfyfUxpmg!>,!chs/eJ!ftmf$!<bchs/mfyfUxpmg!>,!bchs/eJ!*!BCHS`EEB`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<bchs/mfyfUxpmg!>!bchs/eJ!*!BCHS`FEJSSFWP`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<b/mfyfUxpmg!>!b/eJ!*!B`FEJSSFWP`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<chs/mfyfUxpmg!>!chs/eJ!*!CHS`FEJSSFWP`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<bchs/mfyfUxpmg!>+!bchs/eJ!*!BCHS`ZMQJUMVN`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<chs/mfyfUxpmg!>+!chs/eJ!*!CHS`ZMQJUMVN`FEPN`EOFMC`XPMG!)efojgfe!gj$!****1/1)3dfw!-^j]wVxpmg)obiUsfubfsh)mmb!%%!***1/2)3dfw!-^j]wVxpmg)obiUttfm)mmb!%%!^j]efmcboFxpmg)!gj!<*^j]wVxpmg!-^J]fsvuyfUxpmg)E3fsvuyfu!>!mfyfUxpmg!|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1>j!uoj)!spg!USBUT`QPPM`MMPSOV$!<mfyfUxpmg!5dfw!1!?!UDFKCP`XPMG`YBN!gj$!|!*uihjMv)!gj!~!gjeof$!~!<spmpDeofmCv!>+!eJ!|*eofmCv)gj!ftmf$!~!<spmpDeofmCv!>+!eJ!|*eofmCv)gj!ftmf!~!<eofmCidubCw!>+!chs/eJ!|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~!~!<esbdtje!|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~!<ftvggjEv!>!eJ!|ftmf~!<spmpDidubCw!>!eJ!|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|!ftmf!~!<spmpDwv!>!eJ!|*fsvuyfUv)gj!|!ftmf!~!<spmpDftsfwfSldjQyjGv!>!eJ!|*qjmGftsfwfSva!%%!ldbCtj)gj!~!<fvsu!>!ldbCtj!<O.!>!O!|*1/1!=!*O!-F)upe)gj!<ftmbg!>!ldbCtj!mppc!<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw!|!ftmf!~!gjeof$!~!~!<ftvggjEv!>!eJ!|ftmf!~!<esbdtje!|*1/1!>>!x/ftvggjEv)gj!|!*fdobutjEitbEv!?!*fdobutjEqbHitbEv!-fdobutjEfojMw)epn!%%!itbEv)!gj!ITBE!gfegj$!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~!<spmpDftsfwfSldjQyjGv!>!eJ!|!ftmf!~!<spmpDidubCw!>!eJ!|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|!*yjGv)!gj!<eJ!5dfw!|!ftmf!~!~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!|!ftmf!~!<spmpDidubCw!>!spmpDhbsG`mh!|!*spmpDidubCv)!gj!SPMPDIDUBC!gfegj$!|!*ldjQv)!gj!~!<osvufs!<*1/2!-1/1!-1/1!-1/1)5dfw!>!spmpDhbsG`mh!|!*uvpldbmc)!gj!gjeof$!~!~!<osvufs!<esbdtje!|!**6/1!=!*mbdpMw)iuhofm)!>a!^j]sfooJqjmDsfqqjmDv!%%!3!>>!^j]fqbiTsfqqjmDv!}}!***ojNqjmd!-mbdpMw)obiUsfubfsh)mmb!%%!**ybNqjmd!-mbdpMw)obiUttfm)mmb)!>a!^j]sfooJqjmDsfqqjmDv!%%!2!>>!^j]fqbiTsfqqjmDv)!gj!<**1/2!-emspXw)5dfw!+!^j]yjsubNsfqqjmDv)4dfw!>!mbdpMw!|!*,,j!<SFQQJMD`YPC`YBN!=!j!<1!>!j!uoj)!spg!<mbdpMw!4dfw!1!?!SFQQJMD`YPC`YBN!gj$!~!gjeof$!~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj!ftmf$!~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQqjmd!-sje)upe)!gj!~!<*1/1!-1/1!-{/wVw)4dfw!>!opjujtpQqjmd!<1/2.!>!y/sje!|!*:!=!opjudfsjEqjmDv)!gj!ftmf!~!<*1/1!-1/1!-{/wVw)4dfw!>!opjujtpQqjmd!<1/2!>!y/sje!|!*9!=!opjudfsjEqjmDv)!gj!ftmf!QJMD`WV!gfegj$!~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj!gjeof$!<opjujtpQw!>!opjujtpQqjmd!4dfw!QJMD`WV!gfegj$!<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw!|!*1!?!opjudfsjEqjmDv)!gj!~!~!~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!|!ftmf!~!~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!|!*uofsbqtobsUv)!gj!gjeof$!<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv!ftmf$!<*zy/wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv!QJMD`WV!gfegj$!|!**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)!gj!<spmpDwv!5dfw!|!*ejpw)ojbn!ejpw!<uvpldbmc!mppc!nspgjov!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw!<^UDFKCP`XPMG`YBN]efmcboFxpmg!mppc!nspgjov!<^UDFKCP`XPMG`YBN]fsvuyfUxpmg!E3sfmqnbt!nspgjov!1!?!UDFKCP`XPMG`YBN!gj$!gjeof$!gjeof$!~!~!<*1/2!-*Gqjn!-2spmpd!-1spmpd)yjn)5dfw!osvufs!<*1/2!,!uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!2spmpd!4dfw!|!ftmf!~!<*1/2!-1spmpd)5dfw!osvufs!|!*1/1!>>!Gqjn)!gj!<*uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!1spmpd!4dfw!<*qjn)sppmg!>!uoJqjn!ubpmg!<*qjn)udbsg!>!Gqjn!ubpmg!<*mfwfMqjNybn`WVfcvd!-1n!-*ttfoihvps)qjNpUttfoihvps)qnbmd!>!qjn!ubpmg!|!*ttfoihvps!ubpmg!-sjEfmqnbt!4dfw!-qbNwof!E3sfmqnbt)WVfcvDfsvuyfu!5dfw!~!<qjn!osvufs!~!<*ttfoihvps!+!72/2)3hpm!+!1/3!.!>!qjn!|!ftmf!~!<6n!,!*7s!.!6s)!0!*6n!.!7n)!+!*ttfoihvps!.!6s)!>!qjn!|!*7s!>?!ttfoihvps)!gj!ftmf!~!<5n!,!*6s!.!5s)!0!*5n!.!6n)!+!*ttfoihvps!.!5s)!>!qjn!|!*6s!>?!ttfoihvps)!gj!ftmf!~!<2n!,!*5s!.!2s)!0!*2n!.!5n)!+!*ttfoihvps!.!2s)!>!qjn!|!*5s!>?!ttfoihvps)!gj!ftmf!~!<1n!,!*2s!.!1s)!0!*1n!.!2n)!+!*ttfoihvps!.!1s)!>!qjn!|!*2s!>?!ttfoihvps)!gj!<1/1!>!qjn!ubpmg!|!*ttfoihvps!ubpmg)qjNpUttfoihvps!ubpmg!1/5!7n!fojgfe$!9411/1!7w!fojgfe$!23/1!7s!fojgfe$!1/4!6n!fojgfe$!721/1!6w!fojgfe$!614/1!6s!fojgfe$!1/3!5n!fojgfe$!751/1!5w!fojgfe$!5/1!5s!fojgfe$!1/2!.!2n!fojgfe$!783/1!2w!fojgfe$!9/1!2s!fojgfe$!1/3!.!1n!fojgfe$!:44/1!1w!fojgfe$!1/2!1s!fojgfe$!~!<*z/g!-nc!-nu)yjn!osvufs!<*y/g!-sc!-mc)yjn!>!nc!4dfw!<*y/g!-su!-mu)yjn!>!nu!4dfw!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mc!4dfw!<f{jTmfyfu!>.!y/wv!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!sc!4dfw!<f{jTmfyfu!>,!z/wv!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!su!4dfw!<f{jTmfyfu!>,!y/wv!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mu!4dfw!<f{jTmfyfu!>+!wv!<*f{jTfdbg!+!1/3!.!f{jTfmjUybn`WVfcvd!-1/1)ybn!+!1/4!>,!y/wv!<f{jTfmjUojn`WVfcvd!+!1/3!+!uoJsfumjg!>,!z/wv!~!<f{jTfmjUybn`WVfcvd!+!1/3!>,!z/wv!|!*mfwfMqjNybn`WVfcvd!=!uoJqjn)!gj!<f{jTfdbg!+!fdbg!>,!y/wv!~!<1/4!>.!fdbg!<f{jTfdbg!>,!z/wv!|!*1/3!?!fdbg)!gj!<g!.!6/1!>,!wv!<*wv)udbsg!>!g!3dfw!<*1/2!.!f{jTfdbg)!+!*fdbg!-opjudfsje)WVufh!>!wv!3dfw!<*f{jTfmjUybn`WVfcvd!+!1/4)!0!1/2!>!f{jTmfyfu!ubpmg!<*uoJqjn)3qyf!>!f{jTfdbg!ubpmg!<*mfwfMqjNojn`WVfcvd!-uoJqjn)ybn!>!uoJqjn!<*1/1!-uoJqjn!.!mfwfMqjNojn`WVfcvd)ybn!>!uoJsfumjg!ubpmg!<*opjudfsje)fdbGufh!>!fdbg!ubpmg!|!*uoJqjn!ubpmg!-opjudfsje!4dfw!-qbNwof!E3sfmqnbt)WVfcvDsbfojmjc!4dfw!~!<*1/2!,!wv)!+!6/1!osvufs!~!<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje)3dfw!>!wv!|!ftmf!~!<*z/opjudfsje)tcb!0!*{/opjudfsje!-y/opjudfsje!.)3dfw!>!wv!|!*1/5!>>!fdbg)!gj!ftmf!~!<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje!.)3dfw!>!wv!|!*1/4!>>!fdbg)!gj!ftmf!~!<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje!.)3dfw!>!wv!|!*1/3!>>!fdbg)!gj!ftmf!~!<*z/opjudfsje)tcb!0!*{/opjudfsje!.!-y/opjudfsje!.)3dfw!>!wv!|!*1/2!>>!fdbg)!gj!ftmf!~!<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje)3dfw!>!wv!|!*1/1!>>!fdbg)!gj!<wv!3dfw!|!*fdbg!ubpmg!-opjudfsje!4dfw)WVufh!3dfw!~!<fdbg!osvufs!~!<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/6!;!1/3!@!1/1!?!{/opjudfsje!>!fdbg!*z/opjudfsjEtcb!?!{/opjudfsjEtcb)!gj!|!ftmf!~!<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/4!;!1/1!@!1/1!?!y/opjudfsje!>!fdbg!*z/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj!|!*{/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj!<1/2!.!>!fdbg!ubpmg!<*opjudfsje)tcb!>!opjudfsjEtcb!4dfw!|!*opjudfsje!4dfw)fdbGufh!ubpmg!1/72!f{jTfmjUojn`WVfcvd!fojgfe$!1/763!f{jTfmjUybn`WVfcvd!fojgfe$!1/5!mfwfMqjNojn`WVfcvd!fojgfe$!1/9!mfwfMqjNybn`WVfcvd!fojgfe$!WV`FCVD`FQZU`QBNWOF!gfegj$!~!<*{zy/*yjsubn!+!*1/1!-sje)5dfw))f{jmbnspo!osvufs!|!*yjsubn!5ubn!oj!-sje!4dfw!oj)opjudfsjEnspgtobsUftsfwoj!4dfw!gjeof$!~!<*x/fvmbw!-**SPUDBG`BNNBH)4dfw!-{zy/fvmbw)xpq)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!ftmf$!~<*!b/fvmbw!-*!*!*!*!9142411/1!)4dfw!-chs/fvmbw!)mbvrFobiUttfm!)4dfw!-3:/32!+!chs/fvmbw!-*!661/1!)4dfw!.!661/2!+!*!*!77725/1!)4dfw!-chs/fvmbw!)xpq!)yjn!)5dfw!osvufs!|!*!fvmbw!5dfw!oj!)CHStpUsbfojM!5dfw!~!<*b/fvmbw!-****65151/1)4dfw!-chs/fvmbw)mbvrFobiUttfm)4dfw!-9194::4881/1!+!chs/fvmbw!-**5/3)4dfw!-*5218342361/1)4dfw!,!79:387985:/1!+!chs/fvmbw)xpq)yjn)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!gjeof$!~!<{zy/*!*x/ubvr!-{/ubvr.!-z/ubvr.!-y/ubvr.)5dfw!-wr!)ubvRumvn!osvufs!<*!*1/1!-dfw)5dfw!-ubvr!)ubvRumvn!>!wr!5dfw!|!*!dfw!4dfw!-ubvr!5dfw!)spudfWfubups!4dfw!~!<*!{/3r!+!{/2r!.!z/3r!+!z/2r!.!y/3r!+!y/2r!.!x/3r!+!x/2r!-z/3r!+!y/2r!.!y/3r!+!z/2r!,!x/3r!+!{/2r!,!{/3r!+!x/2r!-y/3r!+!{/2r!.!{/3r!+!y/2r!,!x/3r!+!z/2r!,!z/3r!+!x/2r!-{/3r!+!z/2r!.!z/3r!+!{/2r!,!x/3r!+!y/2r!,!y/3r!+!x/2r)5dfw!osvufs!|!*3r!5dfw!-2r!5dfw)ubvRumvn!5dfw!<ubvRqbnwoFv!5dfw!nspgjov!FUBUPS`QBNWOF!gfegj$!<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!QBNWOF`FTV!gfegj$!gjeof$!~!gjeof$!<*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!osvufs!ftmf$!<*1/:!0!1/2)!+!*!*qe!-*z/f{jTmfyfu!-yyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-yyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-yzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-yzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!)!osvufs!<z/f{jTmfyfu!+!tvjebSxpebit!+!*2!-2!.)3dfw!>!uftggp!3dfw!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!}}!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!<*opjujtpQpUuihjm)f{jmbnspo!>!E4ec!4dfw!<tbjCxpebit!>,!qe!<*sbfObsfnbDxpebit!.!sbGbsfnbDxpebit)!0!*sbfObsfnbDxpebit!.!*opjujtpQpUuihjm)iuhofm)!>!qe!ubpmg!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!<**1/3!-1/5)3dfw!+!f{jTqbNxpebit)!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!|!*sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTuojpQufh!ubpmg!~!<*68/1!-684/1)3dfw!,!sbobmq!+!*63/1!-632/1)3dfw!osvufs!~!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!<*z/w)ohjt!>!Zohjt!ubpmg!|!*foPutpnmb!>?!z/Wtcb)!gj!ftmf!~!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!<*y/w)ohjt!>!Yohjt!ubpmg!|!*foPutpnmb!>?!y/Wtcb)!gj!ftmf!~!<y/w!.!1/5!>!y/sbobmq!*1/1!?!{/w)!gj!|!*foPutpnmb!>?!{/Wtcb)!gj!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!<zy/w!>!sbobmq!3dfw!<*Zf{jTmfyfu!+!1/3!.!1/2)!+!fcvDpUfmbdt!>+!w!<fcvDpUfmbdt!>+!Wtcb!<**{/Wtcb!-z/Wtcb)ybn!-y/Wtcb)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!<*w)tcb!>!Wtcb!4dfw!|!*Zf{jTmfyfu!ubpmg!-w!4dfw)WVpUfcvd!3dfw!~!<xpebit!osvufs!~!gjeof$!<*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!>!xpebit!ftmf$!<*1/:!0!1/2)!+!*!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!)!>!xpebit!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!gjmf$!<*1/:!0!1/2)!+!*!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!)!>!xpebit!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!|!*utfUnvutvsg)!gj!<*dfWutfUnvutvsg)mmb!>!utfUnvutvsg!mppc!<*1/2!>=!{/esppDxpebit!-nvutvsGoj)3dfwc!>!dfWutfUnvutvsg!3dfwc!<*dfWnvutvsGoj)mmb!>!nvutvsGoj!mppc!<*1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit)!5dfwc!>!dfWnvutvsGoj!5dfwc!<tbjCxpebit!>,!{/esppDxpebit!<x/esppDxpebit!>0!{zy/esppDxpebit!<1/2!>!xpebit!ubpmg!|!*esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTufh!ubpmg!~!<d!osvufs!<*y/g!-c!-b)yjn!>!d!ubpmg!<*z/g!-us!-cs)yjn!>!c!ubpmg!<*z/g!-um!-cm)yjn!>!b!ubpmg!<*6/1!,!f{jt!+!wv)udbsg!>!g!3dfw!<*fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!us!ubpmg!<*fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cs!ubpmg!<*fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!um!ubpmg!<*fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cm!ubpmg!<f{jt!0!*6/1!,!f{jt!+!wv)sppmg!>!WVejpsuofd!3dfw!<f{jt!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!<*1/2!-1/1)3dfw!>!uftggp!3dfw!utopd!|!*fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt)qsfMxpebiTE3fsvuyfu!ubpmg!~!<***wv!-tiuqfe)E3fsvuyfu)iuqfEpUBCHSldbqov!-fsbqnpd)qfut!osvufs!|!*fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt)fsbqnpDE3fsvuyfu!ubpmg!~!<*tspudbGldbqoV!-w)upe!osvufs!|!*w!5dfw!oj!utopd)iuqfEpUBCHSldbqov!ubpmg!<*/2!-tspudbGldbQ)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!<*/763!-/763!+!/763!-/763!+!/763!+!/763)4dfw!>!tspudbGldbQ!4dfw!utopd!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!<esppDxpebit!5dfw!hojzsbw!<fwjfdfSxpebit!mppc!nspgjov!<tvjebSxpebit!ubpmg!nspgjov!<tbjCxpebit!ubpmg!nspgjov!<zujtofuoJxpebit!ubpmg!nspgjov!<f{jTxpebit!3dfw!nspgjov!<qbNxpebit!E3sfmqnbt!nspgjov!<mmvDxpebit!mppc!nspgjov!QBNXPEBIT`FTV!gfegj$!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw!<fdobutjEqbHitbEv!ubpmg!nspgjov!<fdobutjEitbEv!ubpmg!nspgjov!<itbEv!mppc!nspgjov!ITBE!gfegj$!gjeof$!gjeof$!<sbGhpGv!ubpmg!nspgjov!<sbfOhpGv!ubpmg!nspgjov!ftmf$!<zujtofEhpGv!ubpmg!nspgjov!3QYF`HPG!gfegj$!<hpGv!mppc!nspgjov!<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!gjeof$!<*6/1!-6/1!-6/1)4dfw!>!ybNqjmd!4dfw!utopd!<*6/1.!-6/1.!-6/1.)4dfw!>!ojNqjmd!4dfw!utopd!<^SFQQJMD`YPC`YBN]yjsubNsfqqjmDv!5ubn!nspgjov!<^SFQQJMD`YPC`YBN]sfooJqjmDsfqqjmDv!mppc!nspgjov!<^SFQQJMD`YPC`YBN]fqbiTsfqqjmDv!uoj!nspgjov!1!?!SFQQJMD`YPC`YBN!gj$!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov!<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov!<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov!<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov!<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov!<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov!<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov!<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov!<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!gjeof$!<eofmCidubCw!4dfw!hojzsbw!<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw!<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!gjeof$!<spmpDidubCw!5dfw!hojzsbw!<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjudfsjEuihjmebfIv!4dfw!nspgjov!<spmpDuihjmebfIv!5dfw!nspgjov!<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov!<fhobSuihjmebfIv!ubpmg!nspgjov!<emspXw!4dfw!hojzsbw!<opjujtpQbsfnbDv!4dfw!nspgjov!<yjsubNxfjWv!5ubn!nspgjov!gjeof$!gjeof$!<qbNwoFv!fcvDsfmqnbt!nspgjov!ftmf$!<ttfoihvps!ubpmg!nspgjov!<qbNwoFv!E3sfmqnbt!nspgjov!WV`FCVD`FQZU`QBNWOF!gfegj$!<zujwjudfmgfSv!ubpmg!nspgjov!<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw!<yfusfWw!4dfw!hojzsbw!<mbnspOw!4dfw!hojzsbw!<ftvggjEv!5dfw!nspgjov!<zujdbqPusbQv!ubpmg!nspgjov!<ttfouihjsCv!ubpmg!nspgjov!<uihjMv!mppc!nspgjov!<spmpDeofmCv!5dfw!nspgjov!<eofmCv!mppc!nspgjov!<uofdsfQqjmDv!ubpmg!nspgjov!<opjudfsjEqjmDv!uoj!nspgjov!<sfmqnbTeofmCv!E3sfmqnbt!nspgjov!<sfmqnbTv!E3sfmqnbt!nspgjov!gjeof$!<wVw!3dfw!hojzsbw!ftmf$!<wVw!4dfw!hojzsbw!QJMD`WV!gfegj$!<fsvuyfUeofmCv!mppc!nspgjov!<fsvuyfUv!mppc!nspgjov!<uofsbqtobsUv!mppc!nspgjov!<utfUbiqmBv!ubpmg!nspgjov!<spmpDftsfwfSldjQyjGv!5dfw!nspgjov!<qjmGftsfwfSv!mppc!nspgjov!<ldjQv!mppc!nspgjov!<yjGv!mppc!nspgjov!<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ$!gjeof$!gjeof$!<ubpmg!qnvjefn!opjtjdfsq!ftmf$!<ubpmg!qihji!opjtjdfsq!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!TF`MH!gfegj$!";
hf(u,{setBatchInfo:function(n,O){En[n]=O},getBatchInfo:function(t){return En[t]},getBatchInfoMap:function(){return En},setBatchInfoMap:function(e){En=e}},!0);var Tk=[1,1,1],hd=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],nj=[1,0,0,0,0,1,0,1,1,1,1,0],gj=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],ul=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Nq=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Jp=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Ee=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],ih=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],As=function(_,u){var X=_._40Q;X.each(function(i){i.ivBatch(u)})},cf=function(F,V,Z){var w=Z._id,$=V[w];if($){var D=$.batch,g=F[D],J=g.ds,P=$.index;if(g.invalidate=!0,delete V[w],J.splice(P,1),dk(J))return delete F[D],void 0;for(var z=P,h=$.begin,W=$.size;P<J.length;P++)$=V[J[P]._id],$.index--,$.begin-=W;if(g.ms&&g.ms.length)return g.ms.splice(16*z,16),g.ics&&g.ics.splice(4*z,4),g.ps&&g.ps.splice(4*z,4),void 0;var c=3*h,i=3*W,Q=4*h,L=4*W,j=g.vs,q=g.ps,e=g.uv,s=g.cs,E=g.bs,H=g.rs,I=g.ns,b=g.ls;j.splice(c,i),q.splice(Q,L),e&&e.splice(2*h,2*W),s&&s.splice(Q,L),E&&E.splice(c,i),H&&H.splice(h,W),I&&I.splice(c,i),b&&b.splice(h,W)}},Dg=function(w,X,C,M,v){if(!M)return $;var R=X[M];if(!R){var D=v.getBatchInfo(M)||Oe,r=D.image?[]:$;R=X[M]={vs:[],ns:[],uv:r,cs:r?$:D.color?$:[],bs:D.blend?[]:$,ps:[],rs:D.brightness?[]:$,ds:[],ms:D.instanced?[]:$,ics:r?$:D.color||!D.instanced?$:[]}}return R.invalidate=!0,w[C._id]={index:R.ds.length,begin:R.vs.length/3,batch:M},R.ds.push(C),R},to=function(b,g){return g!=$&&1!==g?[b[0]*g,b[1]*g,b[2]*g,b[3]]:b},oi=function(S){var O=S.shapeModel;O||(O=Wj(S)),O&&(O._ctlineModel=[],O._lineModel=r)},Uq=function(){var U;return function(x,B,e){var D=x.getData3dUI(B),W=D.shapeModel;if(W||(W=Wj(D)),W||!D.shapeName){var S,T=B.s("wf.combineTriangle");if(e.geometry){if(!W&&(B instanceof A.Node&&!(B instanceof A.Shape)?(U||(U={vs:yr,is:Bl,uv:Pg}),W=U):W=[D.left,D.front,D.right,D.back,D.top,D.bottom],!W))return r;if(T){var X=B.s("wf.normEpsilon");isNaN(X)&&(X=2),T=0|Math.min(3,Math.max(1,isNaN(T)?1:T)),S=Te[T-1](W,D,180/(Math.PI*X))}else S=od(W,D);if(!S||0===S.length)return}else if(S=e.short?Kn:rl,B.s("wf.boundingBox")){var l=D.getBoundingBox();if(l){var N=(new Sn).scale(l.max.clone().sub(l.min)).setPosition(l.max.clone().add(l.min).divideScalar(2)).toArray();S=Vd([],N,S)}}var J,m,R,H=x.getBrightness(B),L=B.s("bloom"),Q=B.s("3d.reflectable"),d=th(e.color||"white"),Y=d[3]<1,a=Math.ceil(e.width)||1,_=B.s("3d.clipbox")?Ak:B.s("3d.clipbox.mask"),w=B.s("wf.fog"),t=B.getRenderLayer(),Z=x._40Q.get(t),j=Z.wireframeIndexMap,O=Z.wireframeModelMap,C=B.s("batch"),f=B.s("3d.clip.direction");if(f){if(m=B.s("3d.clip.percentage"),0===m)return;J="_"+B._id,R=D._formatClipUniforms(f,m,B)}else J=C?(Y?"T":"O")+C:(Y?"T":"O")+(L?"_1":"_0")+(Q?"1_":"0_")+_+"_"+a+(w?"1_":"0_");var p=O[J];p||(p=O[J]={vs:[],cs:[],ps:[],ds:[],T:Y,B:L,clipboxMask:_,reflectable:!!Q,W:a,batch:C,fog:w}),p.invalidate=!0;var v=p.vs,E=p.cs,n=p.ds,I=j[B._id]={index:n.length,begin:v.length/3,batch:J};n.push(B);var i,h=D.mat;e.geometry&&B instanceof A.Shape&&(u.extractShapeTranslation||u.extractPolylineTranslation||u.extractVerticesTranslation)&&(i=D._vsTranslation)&&h&&(h=(new ke.Matrix4).fromArray(h).multiply(i).toArray()),B instanceof A.Edge||!(!h||!e.geometry&&B instanceof A.Shape)||(h=Zi(B,e.mat),B.appendAnchorMatrix3d(h)),R?(p.mat=bg(h),p.clipDirection=R[0],p.clipPercent=R[1],Vd(v,null,S)):Vd(v,h,S);var b=I.size=v.length/3-I.begin;Ao(E,to(d,H),b)}}}(),pe=function(N,t,H,m,Z,L,W,G,o){var R=N.getBrightness(t);R==$&&(R=1);var l=to(th(m),R),F=l[3]<1;L=Math.ceil(L)||1;var i=(F?"T":"O")+L;if(W){var E=W[0],J=(W[1]||E)+E;i+="-"+E+"-"+J,o&&(i+="-"+fg(o)+"-"+R,o=to(th(o),R))}var p=t.getRenderLayer(),V=N._40Q.get(p),I=V.polylineIndexMap,x=V.polylineModelMap,n=x[i];n||(n=x[i]={vs:[],cs:[],ps:[],ds:[],ls:W?[]:$,T:F,W:L},W&&(n.D=E,n.G=J,n.A=o)),n.invalidate=!0;var Y,s=n.vs,K=n.cs,y=n.ds,e=n.ls,A=I[t._id]={index:y.length,begin:s.length/3,batch:i};y.push(t),di(s,H);var w,r=A.size=s.length/3-A.begin,Q=H.length,U=0,D=[];if(W||Z)for(Y=0;Q>Y;Y+=6)w=Kj([H[Y],H[Y+1],H[Y+2]],[H[Y+3],H[Y+4],H[Y+5]]),D.push(w),U+=w;if(U&&Z){var P,B=to(th(Z),R),v=[B[0]-l[0],B[1]-l[1],B[2]-l[2],B[3]-l[3]],X=0;for(Y=0;Q>Y;Y+=6)P=X/U,Ao(K,[l[0]+v[0]*P,l[1]+v[1]*P,l[2]+v[2]*P,l[3]+v[3]*P],1),X+=D[Y/6],P=X/U,Ao(K,[l[0]+v[0]*P,l[1]+v[1]*P,l[2]+v[2]*P,l[3]+v[3]*P],1)}else Ao(K,l,r);if(W)for(X=G||0,Y=0;Q>Y;Y+=6)e.push(X),X+=D[Y/6],e.push(X)},Vm=function(j,P,b){if(P){var u=b[P.batch],z=u.ps,F=u.ms&&u.ms.length,y=F?4*P.index:4*P.begin,X=F?1:P.size;if(z[y]!==j[0]||z[y+1]!==j[1]||z[y+2]!==j[2]||z[y+3]!==j[3]){for(var Q=0;X>Q;Q++)z[y++]=j[0],z[y++]=j[1],z[y++]=j[2],z[y++]=j[3];z._invalidateThisFrame=!0}}},Ym=function(){var q=new A.Math.Vector3,g=new A.Math.Vector3;return function(p,W){var o=W+["32"],S=p[W],_=p[o];if(S){if((u.extractBatchTranslation||u.extractVerticesTranslation)&&"vs"===W){g.set(0,0,0);for(var P=S.length,J=0;P>J;J+=3)g.add(q.fromArray(S,J));g.divideScalar(P/3);for(var v=g.x,b=g.y,y=g.z,B=new Array(P),J=0;P>J;J+=3)B[J]=S[J]-v,B[J+1]=S[J+1]-b,B[J+2]=S[J+2]-y;S=B,p.translate=[v,b,y]}_&&_.length===S.length?(_.set(S),_._bufId=null):p[o]=new Ki(S)}else delete p[o]}}(),Lo=function(k,L,D,y,O,a,l,s){var p=L instanceof A.Shape,M=a[0],r=a.length;if(r>1){M=bg(M);for(var v=1;r>v;v++)fm(M,M,a[v])}if(p){var I=L.p3();Ph(M,I)}di(l.ms,M);var g;if(l.ics&&(g=L.s("shape3d.color"))&&Ao(l.ics,g,1),!l.vs.length){var H=bg(hd);p&&Ph(H,Ig(I)),Bn(k,L,D,y,O,[H],l,s)}},Bn=function(T,h,A,U,j,D,y,B){if(Zf(A))A.forEach(function(s){Bn(T,h,s,U,j,D,y,B)});else if(ph(A))Bn(T,h,Wj(U,A),U,j,D,y,B);else if(Tq(A)){var X,e=Tp(A.mat,h,T),Y=Tp(A.s3,h,T),m=Tp(A.t3,h,T),J=Tp(A.r3,h,T);if((Y||J||m||e)&&(X=Nm(e,Y,J,Tp(A.rotationMode,h,T),m),D.push(X)),A.shape3d)Bn(T,h,A.shape3d,U,j,D,y,A);else{var L=U.s;B=B||Oe;var F=D[0],N=D.length,k=L("shape3d.color",A.color,B.color);if(j||(j=L("shape3d.blend",A.blend,B.blend)),N>1){F=bg(F);for(var a=1;N>a;a++)fm(F,F,D[a])}var t=F?eg(F):$;A.vs&&L(on,A.visible,B.visible)&&Jf(F,y,A.vs,A.uv,A.is,A.ns,t,j,k),A.top_vs&&L(Ul,A.topVisible,B.topVisible)&&Jf(F,y,A.top_vs,A.top_uv,A.top_is,A.top_ns,t,j,L("shape3d.top.color",A.topColor,B.topColor)||k),A.bottom_vs&&L(se,A.bottomVisible,B.bottomVisible)&&Jf(F,y,A.bottom_vs,A.bottom_uv,A.bottom_is,A.bottom_ns,t,j,L("shape3d.bottom.color",A.bottomColor,B.bottomColor)||k),A.from_vs&&L(gf,A.fromVisible,B.fromVisible)&&Jf(F,y,A.from_vs,A.from_uv,A.from_is,A.from_ns,t,j,L("shape3d.from.color",A.fromColor,B.fromColor)||k),A.to_vs&&L(sq,A.toVisible,B.toVisible)&&Jf(F,y,A.to_vs,A.to_uv,A.to_is,A.to_ns,t,j,L("shape3d.to.color",A.toColor,B.toColor)||k)}X&&D.pop()}},Jf=function(j,Q,m,O,h,E,C,P,b){var x,t=Q.cs,y=Q.uv,S=Q.bs,q=Q.ns,G=Q.vs;if(E&&0!==E.length||(E=kk(m,h)),h){x=h.length;for(var n=0;x>n;n++){var N=h[n],p=3*N;Vd(G,j,[m[p],m[p+1],m[p+2]]),Vd(q,C,[E[p],E[p+1],E[p+2]]),y&&di(y,[O[2*N],O[2*N+1]])}}else x=m.length/3,Vd(G,j,m),Vd(q,C,E),y&&di(y,O);t&&Ao(t,b,x),S&&(P?Bk(S,P,x):di(S,Tk,x))},Dn=function(D,O,Z){var k=D.data.p3();if(O=bg(O),Ph(O,k),di(Z.ms,O),!Z.vs.length){var M=bg(hd);Ph(M,Ig(k)),eq(D,M,Z)}},eq=function(y,l,i){Fm(y,sl,l,i),Fm(y,vp,l,i),Fm(y,Er,l,i),Fm(y,yc,l,i),Fm(y,Yd,l,i),Fm(y,gg,l,i),Fm(y,"csg",l,i)},fo=function(b,p,J,P,M,U){di(J.ms,M);var X;J.ics&&(X=p.s("all.color"))&&Ao(J.ics,X,1),J.vs.length||Ue(b,p,J,P,bg(hd),U)},Ue=function(z,K,l,S,M,P){Mr(z,K,l,S,M,P,sl,gj),Mr(z,K,l,S,M,P,vp,ul),Mr(z,K,l,S,M,P,Yd,Nq),Mr(z,K,l,S,M,P,gg,Jp),Mr(z,K,l,S,M,P,Er,Ee),Mr(z,K,l,S,M,P,yc,ih)},yq=function($,E,Z,p,t){p?t.instanced?$.gv.batchInstancedModel($.data,p,$,$.getBodyColor(),[E],Z):Bn($.gv,$.data,p,$,$.getBodyColor(),[E],Z):t.instanced?$.gv.batchInstancedShapeFace($,E,Z):eq($,E,Z)},Fm=function(Q,h,u,R){var w=Q[h];if(w){var _=w.tuv;if(_){var l=w.uvScale,V=w.uvOffset,e=w.uvRotation,D=w.uvAnchor;if(l||V||e){var P,B,I,i=wj(e,V,l,D),v=i.a,q=i.b,M=i.c,s=i.d,F=i.tx,o=i.ty,W=_.length;for(I=0;W>I;I+=2)P=_[I],B=_[I+1],_[I]=v*P+M*B+F,_[I+1]=q*P+s*B+o}}Jf(u,R,w.vs,_,$,$,u?eg(u):$,w.blend,w.color)}},Mr=function(T,Q,C,j,c,X,V,h){var z,S=C.cs,N=C.uv,m=C.bs,u=C.vs,H=C.ns,o=kk(h);if(T.getFaceVisible(Q,V)){var s=T.getFaceMat(Q,V);if(s&&(c=Zi(Q,s),X=eg(c)),Vd(u,c,h),Vd(H,X,o),S&&Ao(S,T.getFaceColor(Q,V),6),N){var y=T.getFaceUv(Q,V)||j[V+"Uv"],G=T.getFaceUvScale(Q,V)||j[V+"UvScale"],f=T.getFaceUvOffset(Q,V)||j[V+"UvOffset"],l=T.getFaceUvRotation(Q,V)||j[V+"UvRotation"],e=T.getFaceUvAnchor(Q,V)||j[V+"UvAnchor"];y=y?[y[6],y[7],y[0],y[1],y[2],y[3],y[2],y[3],y[4],y[5],y[6],y[7]]:nj;var O=y[0],x=y[1],q=y[2],Y=y[3],I=y[4],t=y[5],U=y[6],P=y[7],M=y[8],p=y[9],D=y[10],w=y[11];if(G||f||l||e){var A=wj(l,f,G,e),v=A.a,a=A.b,d=A.c,E=A.d,_=A.tx,i=A.ty;O=v*O+d*x+_,x=a*O+E*x+i,q=v*q+d*Y+_,Y=a*q+E*Y+i,I=v*I+d*t+_,t=a*I+E*t+i,U=v*U+d*P+_,P=a*U+E*P+i,M=v*M+d*p+_,p=a*M+E*p+i,D=v*D+d*w+_,w=a*D+E*w+i}N.push(O,x,q,Y,I,t,U,P,M,p,D,w)}m&&(z=T.getBodyColor(Q)||T.getFaceBlend(Q,V),z?Bk(m,z,6):di(m,Tk,6))}},Hk=function(p,f,m,G){var m=p._picking?p.pickColorMap:null,B=p.getGL(),y=p._prg,W=p._buffer;if(!Rd(f)){sk(p,hd),xm(B);var I,d,D,A;for(var u in f){var b,O,j,l,k=f[u];if(k.batch){var S=p.getBatchInfo(k.batch)||Oe;b=S.wfBloom===r?S.bloom:S.wfBloom,O=S.wfReflectable===r?S.reflectable:S.wfReflectable,j=S.wfClipboxMask===r?S.clipboxMask:S.wfClipboxMask,l=S.width}else b=k.B,O=k.reflectable,j=k.clipboxMask,l=k.W;if(!(G&&!k.T||!G&&k.T||p.isReflecting(B)&&O===!1)){k.invalidate?(k.invalidate=!1,Ym(k,"vs"),Ym(k,"cs"),Ym(k,"ls"),Ym(k,"ps")):m&&k.ps&&k.ps._invalidateThisFrame&&(k.ps._invalidateThisFrame=!1,Ym(k,"ps")),I=k.translate,d=k.clipDirection,I||d?(D=d?bg(k.mat):[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],I&&Ph(D,I),A=bg(p._6O),sk(p,D)):D=null;var n=k.vs32,F=m?k.ps32:k.cs32;pn(B,y,l,$,W.vs,n);var C=El.for(B),X=C.directUniforms(),i=C.directAttribs(),c=k.D,s=!p._dashDisabled&&c;X.uAlphaTest=x.alphaTest,B._blooming&&!b&&(X.blackout=!0),d&&(X.uClipPercent=k.clipPercent,X.uClipDirection=d),qj(p,X,j===r?Ye:j),s&&(X.uDash=!0,X.uDashDistance=c,X.uDashGapDistance=k.G,X.uDiffuse=k.A||x["color.empty"],i.aLineDistance=Nr(B,W.lineDistance,k.ls32,$,1));var T=!p._batchColorDisabled;T&&F.length?(X.uBatchColor=!0,i.aBatchColor=Nr(B,W.batchColor,F,$,4)):(X.uBatchColor=!1,i.aBatchColor=!1);var N=k.fog!==!1;N||(X.uFog=!1),Mc(B),vb(B,0,n.length/3,B.LINES),ni(B),N||(X.uFog=!0),T&&(X.uBatchColor=!1,i.aBatchColor=!1),s&&(X.uDash=!1,i.aLineDistance=!1),B._blooming&&!b&&(X.blackout=!1),D&&(d&&(X.uClipDirection=0),xl(p,A))}}qf(B),xl(p)}},an=function(L){L.invalidate=!1,Ym(L,"vs"),Ym(L,"ns"),Ym(L,"cs"),Ym(L,"rs"),Ym(L,"ps"),Ym(L,"bs"),Ym(L,"uv"),Ym(L,"ms"),Ym(L,"ics")},xk=function(v,O,k,s,e){var W,I,N,f,Q,K,H,Z,y,G,t,R,n,k=v._picking?v.pickColorMap:null,g=v.getGL(),L=v._prg,b=El.for(g),j=b.directUniforms(),D=b.directAttribs(),i=v._buffer;if(!Rd(O)&&!v.drawFilter){var T=v._flowObjects.length?v.flowMap:null;sk(v,hd);for(I in O)if(N=v.getBatchInfo(I)||Oe,N.visible!==!1&&!(s&&!N.transparent||!s&&N.transparent||v.isReflecting(g)&&N.reflectable===!1)){var X=N.renderLayerMask;if(X==$&&(X=Yh),e==$&&(e=Yh),Ml(e,X)&&(f=O[I],k||!N.transparentMask)){var h=s&&N.autoSort===!0&&(v._33Q||f.invalidate);f.invalidate?an(f):k&&f.ps&&f.ps._invalidateThisFrame&&(f.ps._invalidateThisFrame=!1,Ym(f,"ps"));var P=f.ms32,M=P&&P.length;if(K=f.vs32,H=k?f.ps32:M?f.ics32:f.cs32,G=f.uv32,Z=f.bs32,y=f.rs32,R=K.length/3,h){var c=qe(K,v.getEye(),v);c?(f.is=c.is,f.elementTypeUint=c.useUint32):(f.is=null,f.elementTypeUint=null)}if(R){n=f.translate,n&&sk(v,[1,0,0,0,0,1,0,0,0,0,1,0,n[0],n[1],n[2],1]),Q=N.light,t=v.getTexture(N.image),Gb(g,L,$,N.light,N.opacity,N.reverseFlip,N.reverseColor,N.reverseCull),W=N.polygonOffset,W&&He(g,W),H?v._batchColorDisabled?(j.uBatchColor=!1,D.aBatchColor=!1):(j.uBatchColor=!0,D.aBatchColor=M?Sg(g,i.instancedBatchColor,H,$,4):Nr(g,i.batchColor,H,$,4)):(j.uBatchColor=!1,j.uDiffuse=N.color||x["color.empty"]);var V=N.alphaTest;j.uAlphaTest=V===r?x.alphaTest:V,j.shadowReceive=!k&&N.shadowReceive!==!1,qj(v,j,N.clipboxMask===r?Ye:N.clipboxMask),xs(v,j,N.lightMask===r?Ye:N.lightMask,N.headlightAmbientIntensity),T&&T.resetFlowUniform(N.effectFlowMask===r?Ye:N.effectFlowMask,j),g._blooming&&!N.bloom&&(j.blackout=!0),N.envmap!==r?(j.uUseEnvMap=!0,j.uReflectivity=N.envmap,j.roughness=N.roughness||0,v._setEnvmapByProbeId(j,N.envmapProbe||0)):(j.uUseEnvMap=!1,j.uReflectivity=0);var A=Z&&!v._batchBlendDisabled;A&&(j.uBatchBlend=!0,D.aBatchBlend=Nr(g,i.batchBlend,Z,$));var E=y&&!v._batchBrightnessDisabled;E&&(j.uBatchBrightness=!0,D.aBatchBrightness=Nr(g,i.batchBrightness,y,$,1)),G?Mc(g,L,t,N.discardSelectable,i.uv,G,N.uvOffset,N.uvScale,N.uvRotation,N.uvAnchor):Mc(g),D.aPosition=Nr(g,i.vs,K,$),D.aNormal=Nr(g,i.ns,f.ns32,$),M&&(j.uUseInstance=!0,D.aMatrixInstanced=Sg(g,i.ms,P,$)),f.is?(jf(g,i.is,f.is),Ae(g,0,R,null,f.elementTypeUint?g.UNSIGNED_INT:null,null,M?f.ms32.length/16:0)):vb(g,0,R,null,M?f.ms32.length/16:0),G?ni(g,L,t):ni(g),H&&!v._batchColorDisabled&&(j.uBatchColor=!1,D.aBatchColor=!1),A&&(j.uBatchBlend=!1,D.aBatchBlend=!1),E&&(j.uBatchBrightness=!1,D.aBatchBrightness=!1),g._blooming&&!N.bloom&&(j.blackout=!1),M&&(j.uUseInstance=!1,D.aMatrixInstanced=r),W&&Wn(g),pl(g,L),n&&xl(v)}}}xl(v)}},qe=function(h,r,L){var o=h.length/3,c=o>65535,j=L._glCapabilities.elementTypeUint&&c;if(!j&&c)return null;for(var f=new Array(o),v=o/3,O=new Array(v),Q=0;v>Q;Q++)O[Q]=Q;O.sort(function(g,p){var n=9*g,G=[(h[n]+h[n+3]+2*h[n+6])/4,(h[n+1]+h[n+4]+2*h[n+7])/4,(h[n+2]+h[n+5]+2*h[n+8])/4];n=9*p;var J=[(h[n]+h[n+3]+2*h[n+6])/4,(h[n+1]+h[n+4]+2*h[n+7])/4,(h[n+2]+h[n+5]+2*h[n+8])/4],R=Kj(r,G)-Kj(r,J);return R>0?-1:0>R?1:0});for(var Q=0;v>Q;Q++){var k=3*Q,i=3*O[Q];f[k]=i,f[k+1]=i+1,f[k+2]=i+2}return{useUint32:j,is:j?new Uint32Array(f):new Ro(f)}},rc={obj:function(z,N){var l={mat:z.mat,s3:z.s3,r3:z.r3,rotationMode:z.rotationMode,t3:z.t3,cube:z.cube==$?!0:z.cube,center:z.center==$?!0:z.center,ignoreMtls:z.ignoreMtls,ignoreTransparent:z.ignoreTransparent,ignoreColor:z.ignoreColor,ignoreImage:z.ignoreImage,ignoreNormal:z.ignoreNormal,prefix:z.prefix,flipY:z.flipY,flipFace:z.flipFace,reverseFlipMtls:z.reverseFlipMtls,finishFunc:function(D,O){if(D){var O=[];for(var m in D){var A=D[m];O.rawS3=A.rawS3,A.center&&(O.center=A.center),O.push(A),z.eachModel&&z.eachModel(m,A)}O.json=z,N(O)}else N()}};u.loadObj(z.obj,z.mtl,l)},bin:function(C,d){var F={finishFunc:function(U){U?d(U):d()}};u.loadBin(C.url,F)}};u.getModelTypeHandlers=function(){return rc},u.setModelTypeHandler=function(N,n){rc[N]=n},u.getModelTypeHandler=function(y){return rc[y]},u.handleModelLoaded=function(){},u.handleUnfoundModel=function(){};var ad=$,Id=$,Qe=function($){ad&&!$._loadingModelView_&&(Id||(Id={}),Id[$._loadingModelView_=tq()]=$)},Oo=function(o,W){ad||(ad={});var v=ad[o];if(v){if(v.url===W)return;v.request.onload=rg,v.request.onerror=rg}if(W.indexOf(".bin")===W.length-4)return Zn(o,{modelType:"bin",url:W},W);if(W=u.beforeLoadURL(W),W.data){var x=u.parse(W.data);Zn(o,x,W)}else{var m=new uk;ad[o]={request:m,url:W},m.onload=function(){if(200===this.status||0===this.status){delete ad[o];var k=u.parse(m.getResponseText());Zn(o,k,W)}else gm(o,u.handleUnfoundModel(o,W)||$)},m.onerror=function(){gm(o,u.handleUnfoundModel(o,W)||$)};var l={};l.url=encodeURI(W),l.sync=!1,m.send(l)}},Zn=function(k,g,Y){var G=g.modelType;if(!G)return gm(k,g),u.handleModelLoaded(k,g),void 0;var T=u.getModelTypeHandler(G);if(T){if(ad||(ad={}),ad[k])return;ad[k]=!0;var R=function(f){f?(gm(k,f),u.handleModelLoaded(k,f)):gm(k,u.handleUnfoundModel(k,Y,g)||$)};T(g,R)}else gm(k,u.handleUnfoundModel(k,Y,g)||$)},gm=function(C,v){if(delete ad[C],ph(v)&&Ep.test(v))return Oo(C,v),void 0;if(us[C]=v,Rd(ad)&&(ad=$,Id)){for(var e in Id){var Y=Id[e];Y.invalidateAll&&Y.invalidateAll(r,"modelLoaded",C),Y.redraw&&Y.redraw(),Y.iv(),delete Y._loadingModelView_}Id=$}if(v&&Id)for(var e in Id){var Y=Id[e];Y.invalidateAll&&Y.invalidateAll(r,"modelLoading",C),Y.redraw&&Y.redraw(),Y.iv()}},Ir=new Ki([0,0,0,1,1,1,1,0]),$k=new Ki([0,0,1,0,0,1,0,0,1,0,0,1]),$i=new Ro([0,1,2,2,3,0]),yr=new Ki([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Bl=new Ro([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Pg=new Ki([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Th=kk(yr,Bl),gd=(new Ki([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Ro([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[sl,Er,vp,yc,Yd,gg]),rl=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Kn=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Sk=function(W,z,Q,s,B,_,M){_=_||16,W=W||16,z=z||0,Q=Q||W;var E,q,K,F,o,k,u,w,v,j=.5,e=[],y=[],x=g/W,G=Z/_;for(E=0;_>E;E++)for(k=E+1,F=E*G,v=k*G,q=z;Q>q;q++)u=q+1,K=q*x,w=u*x,e.push(j*X(F)*m(K),j*m(F),-j*X(F)*X(K),j*X(v)*m(w),j*m(v),-j*X(v)*X(w),j*X(F)*m(w),j*m(F),-j*X(F)*X(w),j*X(F)*m(K),j*m(F),-j*X(F)*X(K),j*X(v)*m(K),j*m(v),-j*X(v)*X(K),j*X(v)*m(w),j*m(v),-j*X(v)*X(w)),y.push(q/W,E/_,u/W,k/_,u/W,E/_,q/W,E/_,q/W,k/_,u/W,k/_);if(M){var t=[];for(E=0,o=e.length;o>E;E+=3)t.push(2*e[E],2*e[E+1],2*e[E+2])}if(s){var p=[],n=[];for(K=z*x,E=0;_>E;E++)k=E+1,F=E*G,v=k*G,p.push(0,0,0,j*X(v)*m(K),j*m(v),-j*X(v)*X(K),j*X(F)*m(K),j*m(F),-j*X(F)*X(K)),n.push(0,.5,z/W,k/_,z/W,E/_)}if(B){var f=[],A=[];for(K=Q*x,E=0;_>E;E++)k=E+1,F=E*G,v=k*G,f.push(0,0,0,j*X(F)*m(K),j*m(F),-j*X(F)*X(K),j*X(v)*m(K),j*m(v),-j*X(v)*X(K)),A.push(1,.5,Q/W,E/_,Q/W,k/_)}var b={vs:e,uv:y,from_vs:p,from_uv:n,to_vs:f,to_uv:A};return M&&(b.ns=t),b},Cp=function(G,j,V){G=G||.17,j=j||12,V=V||18,0>G?G=0:G>.25&&(G=.25);var Y,Q,y,w,b,O,K,D=.5,F=[],W=[],P=[],$=g/V,i=g/j,_=D-G;for(Q=0;j>=Q;Q++)for(w=-Z+Q*i,O=m(w),b=X(w),Y=0;V>=Y;Y++)y=Y*$,K=_+G*O,F.push(m(y)*K,b*G,-X(y)*K),W.push(Y/V,1-Q/j);for(Q=0;j>Q;Q++){var U=Q*(V+1),B=(Q+1)*(V+1);for(Y=0;V>Y;Y++)P.push(U+Y,B+Y+1,B+Y,U+Y,U+Y+1,B+Y+1)}return{vs:F,uv:W,is:P}},yd=function(M,l,U,V,F,y,E,c){E=E||12,M=M||18,l=l||0,U=U||M,y=y||.17,0>y?y=0:y>.25&&(y=.25);var z,j,b,D,W,O,J,t,w,Y,H=.5,h=[],R=[],q=g/M,u=g/E,L=H-y,$=c?[]:r;for(b=0;E>b;b++)for(D=b+1,J=-Z+b*u,t=-Z+D*u,z=l;U>z;z++)j=z+1,W=z*q,O=j*q,w=L+y*m(J),Y=L+y*m(t),h.push(m(W)*w,X(J)*y,-X(W)*w,m(O)*w,X(J)*y,-X(O)*w,m(O)*Y,X(t)*y,-X(O)*Y,m(W)*w,X(J)*y,-X(W)*w,m(O)*Y,X(t)*y,-X(O)*Y,m(W)*Y,X(t)*y,-X(W)*Y),R.push(z/M,1-b/E,j/M,1-b/E,j/M,1-D/E,z/M,1-b/E,j/M,1-D/E,z/M,1-D/E),c&&$.push(m(W)*m(J),X(J),-X(W)*m(J),m(O)*m(J),X(J),-X(O)*m(J),m(O)*m(t),X(t),-X(O)*m(t),m(W)*m(J),X(J),-X(W)*m(J),m(O)*m(t),X(t),-X(O)*m(t),m(W)*m(t),X(t),-X(W)*m(t));if(V){var Q=[],e=[];for(b=0;E>b;b++)D=b+1,J=-Z+b*u,t=-Z+D*u,W=l*q,w=L+y*m(J),Y=L+y*m(t),Q.push(m(W)*w,X(J)*y,-X(W)*w,m(W)*Y,X(t)*y,-X(W)*Y,m(W)*L,0,-X(W)*L),e.push(.5+.5*m(J),.5-.5*X(J),.5+.5*m(t),.5-.5*X(t),.5,.5)}if(F){var x=[],P=[];for(b=0;E>b;b++)D=b+1,J=-Z+b*u,t=-Z+D*u,W=U*q,w=L+y*m(J),Y=L+y*m(t),x.push(m(W)*w,X(J)*y,-X(W)*w,m(W)*L,0,-X(W)*L,m(W)*Y,X(t)*y,-X(W)*Y),P.push(.5-.5*m(J),.5-.5*X(J),.5,.5,.5-.5*m(t),.5-.5*X(t))}var d={vs:h,uv:R,from_vs:Q,from_uv:e,to_vs:x,to_uv:P};return c&&(d.ns=$),d},ko=function(J,l){for(var V,b,I,Q,r,d=.5,o=16,i=[],S=[],G=[],y=[],x=g/o,B=0;o>=B;B++)V=B*x,b=m(V),Q=b*d,I=X(V),r=I*d,i.push(Q,-d,r,Q,d,r),G.push(b,0,I,b,0,I),S.push(1-B/o,1,1-B/o,0);for(B=0;o>B;B++)y.push(2*B,2*B+1,2*B+3,2*B,2*B+3,2*B+2);if(l){var n=[],$=[],p=[];for(n.push(0,-d,0),$.push(.5,.5),B=0;o>=B;B++)V=B*x,b=m(V),I=X(V),n.push(b*d,-d,-I*d),$.push(.5+.5*b,.5+.5*I);for(B=0;o>B;B++)p.push(0,B+2,B+1)}if(J){var O=[],z=[],F=[];for(O.push(0,d,0),z.push(.5,.5),B=0;o>=B;B++)V=B*x,b=m(V),I=X(V),O.push(b*d,d,-I*d),z.push(.5+.5*b,.5-.5*I);for(B=0;o>B;B++)F.push(0,B+1,B+2)}return{vs:i,uv:S,is:y,ns:G,bottom_vs:n,bottom_uv:$,bottom_is:p,top_vs:O,top_uv:z,top_is:F}},Mb=function(j,u,s,y,R,G,l,w){j=j||12,u=u||0,s=s||j;for(var Q,T,t,c,q,C,z,_,Y,d=.5,O=[],L=[],K=g/j,P=u;s>P;P++)Q=P+1,T=P*K,t=Q*K,c=m(T)*d,q=X(T)*d,C=m(t)*d,z=X(t)*d,O.push(c,-d,-q,C,-d,-z,c,d,-q,C,-d,-z,C,d,-z,c,d,-q),L.push(P/j,1,Q/j,1,P/j,0,Q/j,1,Q/j,0,P/j,0);if(w){var E=[];for(P=0,Y=O.length;Y>P;P+=3)E.push(2*O[P],0,2*O[P+2])}if(l){var n=[],Z=[];for(P=u;s>P;P++)T=K*P,t=K*(P+1),c=m(T),q=X(T),C=m(t),z=X(t),n.push(c*d,-d,-q*d,0,-d,0,C*d,-d,-z*d),Z.push(.5+.5*c,.5+.5*q,.5,.5,.5+.5*C,.5+.5*z)}if(G){var e=[],I=[];for(P=u;s>P;P++)T=K*P,t=K*(P+1),c=m(T),q=X(T),C=m(t),z=X(t),e.push(c*d,d,-q*d,C*d,d,-z*d,0,d,0),I.push(.5+.5*c,.5-.5*q,.5+.5*C,.5-.5*z,.5,.5)}if(y){var N=[],M=[];T=K*u,c=m(T)*d,q=X(T)*d,_=u/j,N.push(0,d,0,0,-d,0,c,-d,-q,c,-d,-q,c,d,-q,0,d,0),M.push(0,0,0,1,_,1,_,1,_,0,0,0)}if(R){var W=[],p=[];T=K*s,c=m(T)*d,q=X(T)*d,_=s/j,W.push(0,-d,0,0,d,0,c,d,-q,c,d,-q,c,-d,-q,0,-d,0),p.push(1,1,1,0,_,0,_,0,_,1,1,1)}var H={vs:O,uv:L,bottom_vs:n,bottom_uv:Z,top_vs:e,top_uv:I,from_vs:N,from_uv:M,to_vs:W,to_uv:p};return w&&(H.ns=E),H},mn=function(Y,z,p,t,c){z=z||18,p=p||0,t=t==$?g:t,c=c==$?.5:c;for(var Z,V,j,d,n,l,v=[0,.5,.75,.875,.9375],i=[],C=[],w=[],y=t/z,b=0;b<v.length;b++){var L=0===b%2?0:.5;for(Z=0;z>=Z;Z++)V=(Z+L)*y+p,j=1-v[b],i.push(m(V)*c*j,-c+2*v[b]*c,-X(V)*c*j),C.push((Z+L)/z,j)}for(b=0;b<v.length-1;b++){var M=b*(z+1),s=(b+1)*(z+1);for(Z=0;z>Z;Z++)w.push(M+Z,s+Z+1,s+Z,M+Z,M+Z+1,s+Z+1)}for(l=i.length/3-(z+1),Z=0;z>Z;Z++)i.push(0,c,0),C.push((Z+.5)/z,0);for(Z=0;z>Z;Z++)w.push(l+Z,l+Z+1,l+(z+1)+Z);if(Y){var T=[],J=[],r=[];for(T.push(0,-c,0),J.push(.5,.5),Z=0;z>=Z;Z++)V=Z*y+p,d=m(V),n=X(V),T.push(d*c,-c,-n*c),J.push(.5+.5*d,.5+.5*n);for(Z=0;z>Z;Z++)r.push(0,Z+2,Z+1)}return{vs:i,uv:C,is:w,bottom_vs:T,bottom_uv:J,bottom_is:r}},Vb=function(r,G,P,c,x,k,O,q){r=r||16,G=G||0,P=P||r,O=O||1;var t,D,E,v,b,d,M,e=.5,T=[],w=[],p=g/r,Y=G,l=1/O,D=new hb,E=new hb,J=new hb,S=new hb,B=new hb,Z=new hb,i=new hb;for(q&&(t=[],b=new hb,d=new hb,M=new hb);P>Y;Y++){var n=Y+1,U=p*Y,h=p*n;for(D.set(m(U)*e,-e,-X(U)*e),E.set(m(h)*e,-e,-X(h)*e),J.set(0,e,0),q&&(b.set(m(U),.5,-X(U)).normalize(),d.set(m(h),.5,-X(h)).normalize(),M.copy(b).add(d).normalize()),S.lerpVectors(J,D,l),B.lerpVectors(J,E,l),T.push(S.x,S.y,S.z,B.x,B.y,B.z,J.x,J.y,J.z),w.push(Y/r,l,n/r,l,(Y+n)/2/r,0),q&&t.push(b.x,b.y,b.z,d.x,d.y,d.z,M.x,M.y,M.z),v=1;O>v;v++)S.lerpVectors(J,D,l*(v+1)),B.lerpVectors(J,E,l*(v+1)),Z.lerpVectors(J,D,l*v),i.lerpVectors(J,E,l*v),T.push(S.x,S.y,S.z,B.x,B.y,B.z,Z.x,Z.y,Z.z,Z.x,Z.y,Z.z,B.x,B.y,B.z,i.x,i.y,i.z),w.push(Y/r,l*(v+1),n/r,l*(v+1),Y/r,l*v,Y/r,l*v,n/r,l*(v+1),n/r,l*v),q&&t.push(b.x,b.y,b.z,d.x,d.y,d.z,b.x,b.y,b.z,b.x,b.y,b.z,d.x,d.y,d.z,d.x,d.y,d.z)}if(k){var j=[],H=[];for(Y=G;P>Y;Y++){U=p*Y,h=p*(Y+1);var u=m(U),L=X(U),$=m(h),V=X(h);j.push(u*e,-e,-L*e,0,-e,0,$*e,-e,-V*e),H.push(.5+.5*u,.5+.5*L,.5,.5,.5+.5*$,.5+.5*V)}}if(c){var C=[],F=[];U=p*G,C.push(0,e,0,0,-e,0,m(U)*e,-e,-X(U)*e),F.push(0,0,0,1,G/r,1)}if(x){var o=[],f=[];U=p*P,o.push(0,-e,0,0,e,0,m(U)*e,-e,-X(U)*e),f.push(1,1,1,0,P/r,1)}var z={vs:T,uv:w,bottom_vs:j,bottom_uv:H,from_vs:C,from_uv:F,to_vs:o,to_uv:f};return q&&(z.ns=t),z},df=function(b,h,p,$,E,M,N,J){for(var q=[],O=0;O<b.length-1;O+=2)q.push({x:b[O],y:b[O+1]});return Un(q,h,p,$,E,M,N,J,!1)},Rf={roundRect:function(v,m){return df([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],v,m,3)},star:function(y,Z){return df([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],y,Z)},rect:function(V,M){return df([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],V,M)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(e,D){return df([0,-.5,.5,.5,-.5,.5],[1,2,2,5],e,D)},rightTriangle:function(Q,x){return df([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],Q,x)},parallelogram:function(Q,$){return df([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],Q,$)},trapezoid:function(V,E){return df([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],V,E)}},ds={sphere:1,cylinder:1,cone:1,torus:1},$n={torus:1,sphere:1,cone:1},Xn=hf(Bf(Rf),{cylinder:1}),am=hf(Bf(Rf),{cylinder:1,cone:1}),vq=function(U,V,C){var _,a=Tp(U.anchor3d,C,V),Q=Tp(U.mat,C,V),H=Tp(U.s3,C,V),W=Tp(U.t3,C,V),k=Tp(U.r3,C,V),R=H||k||W||Q;if(a||R){_=bg(V._6O);var f=R?Nm(Q,H,k,Tp(U.rotationMode,C,V),W):Kl();a&&Ph(f,[.5-a[0],.5-a[1],.5-a[2]]),sk(V,f)}return _},Dd=function(p,O,J,R,g,V,k){if(Zf(J))J.forEach(function(c){Dd(p,O,c,R,g,V,k)});else if(ph(J))Dd(p,O,Wj(R,J),R,g,V,k);else if(Tq(J))if(J.shape3d){var $=vq(J,p,O);Dd(p,O,J.shape3d,R,g,V,J),$&&xl(p,$)}else ur(p,O,J,R.s,g,V,k)},ur=function(R,i,m,U,z,V,s){if(s=s||Oe,!V||V(U("shape3d.transparent",m.transparent,s.transparent))){var f=vq(m,R,i);if(zb(m)){var p=R.getData3dUI(i);p.dispatchBoundingBoxChanged()}var v=R._26I,u=R._prg,W=R._buffer,Q=U("shape3d.color",m.color,s.color);z||(z=U("shape3d.blend",m.blend,s.blend));var w,e=m.opacity==$?s.opacity:m.opacity,b=U("shape3d.opacity");w=b!=$&&e!=$?e*b:e!=$?e:b,Gb(v,u,z,U("shape3d.light",m.light,s.light),w,U("shape3d.reverse.flip",m.reverseFlip,s.reverseFlip),U("shape3d.reverse.color",m.reverseColor,s.reverseColor),U("shape3d.reverse.cull",m.reverseCull,s.reverseCull));var q=U("polygonOffset",m.polygonOffset,s.polygonOffset);m.vs&&U(on,m.visible,s.visible)&&kp(v,u,W,Q,R.getTexture(U("shape3d.image",m.image,s.image),i),U("shape3d.discard.selectable",m.discardSelectable,s.discardSelectable),m.vs,m.uv,m.ns,m.is,U("shape3d.uv.offset",m.uvOffset,s.uvOffset),U("shape3d.uv.scale",m.uvScale,s.uvScale),U("shape3d.uv.rotation",m.uvRotation,s.uvRotation),U("shape3d.uv.anchor",m.uvAnchor,s.uvAnchor),q),m.top_vs&&U(Ul,m.topVisible,s.topVisible)&&kp(v,u,W,U("shape3d.top.color",m.topColor,s.topColor)||Q,R.getTexture(U("shape3d.top.image",m.topImage,s.topImage),i,"top"),U("shape3d.top.discard.selectable",m.topDiscardSelectable,s.topDiscardSelectable),m.top_vs,m.top_uv,m.top_ns,m.top_is,U("shape3d.top.uv.offset",m.topUvOffset,s.topUvOffset),U("shape3d.top.uv.scale",m.topUvScale,s.topUvScale),U("shape3d.top.uv.rotation",m.topUvRotation,s.topUvRotation),U("shape3d.top.uv.anchor",m.topUvAnchor,s.topUvAnchor),q),m.bottom_vs&&U(se,m.bottomVisible,s.bottomVisible)&&kp(v,u,W,U("shape3d.bottom.color",m.bottomColor,s.bottomColor)||Q,R.getTexture(U("shape3d.bottom.image",m.bottomImage,s.bottomImage),i,"bottom"),U("shape3d.bottom.discard.selectable",m.bottomDiscardSelectable,s.bottomDiscardSelectable),m.bottom_vs,m.bottom_uv,m.bottom_ns,m.bottom_is,U("shape3d.bottom.uv.offset",m.bottomUvOffset,s.bottomUvOffset),U("shape3d.bottom.uv.scale",m.bottomUvScale,s.bottomUvScale),U("shape3d.bottom.uv.rotation",m.bottomUvRotation,s.bottomUvRotation),U("shape3d.bottom.uv.anchor",m.bottomUvAnchor,s.bottomUvAnchor),q),m.from_vs&&U(gf,m.fromVisible,s.fromVisible)&&kp(v,u,W,U("shape3d.from.color",m.fromColor,s.fromColor)||Q,R.getTexture(U("shape3d.from.image",m.fromImage,s.fromImage),i,"from"),U("shape3d.from.discard.selectable",m.fromDiscardSelectable,s.fromDiscardSelectable),m.from_vs,m.from_uv,m.from_ns,m.from_is,U("shape3d.from.uv.offset",m.fromUvOffset,s.fromUvOffset),U("shape3d.from.uv.scale",m.fromUvScale,s.fromUvScale),U("shape3d.from.uv.rotation",m.fromUvRotation,s.fromUvRotation),U("shape3d.from.uv.anchor",m.fromUvAnchor,s.fromUvAnchor),q),m.to_vs&&U(sq,m.toVisible,s.toVisible)&&kp(v,u,W,U("shape3d.to.color",m.toColor,s.toColor)||Q,R.getTexture(U("shape3d.to.image",m.toImage,s.toImage),i,"to"),U("shape3d.to.discard.selectable",m.toDiscardSelectable,s.toDiscardSelectable),m.to_vs,m.to_uv,m.to_ns,m.to_is,U("shape3d.to.uv.offset",m.toUvOffset,s.toUvOffset),U("shape3d.to.uv.scale",m.toUvScale,s.toUvScale),U("shape3d.to.uv.rotation",m.toUvRotation,s.toUvRotation),U("shape3d.to.uv.anchor",m.toUvAnchor,s.toUvAnchor),q),pl(v,u),f&&xl(R,f)}},kp=function(M,o,K,q,p,c,m,t,e,O,X,f,A,N,Z){if(m){Z&&He(M,Z);var z=El.for(M),G=z.directUniforms(),s=z.directAttribs();G.uDiffuse=q||x["color.empty"],t?Mc(M,o,p,c,K.uv,t,X,f,A,N):Mc(M),s.aPosition=Nr(M,K.vs,m,$),s.aNormal=Nr(M,K.ns,e,$),O?(Kf(M,K.is,O),Ae(M,0,O.length,null,O instanceof Uint32Array?M.UNSIGNED_INT:null)):vb(M,0,m.length/3),t?ni(M,o,p):ni(M),Z&&Wn(M)}},Wj=function(i,S){var b=i.s;if(S||(S=b(lp)),!S)return $;var k=Pf(S);if(k)return k;if("text"===S){var e={amount:b("shape3d.text.amount"),size:b("shape3d.text.size"),font:b("shape3d.text.font"),style:b("shape3d.text.style"),weight:b("shape3d.text.weight"),fill:b("shape3d.text.fill"),curveSegments:b("shape3d.text.curveSegments"),spacing:b("shape3d.text.spacing"),cube:b("shape3d.text.cube")},w=i.gv.getShape3dText(i.data),g=w;for(var B in e)g+="_"+(e[B]===r?"U":e[B]);return i._cachedTextKey===g?i._cachedTextGeometry:(i._cachedTextKey=g,i._cachedTextGeometry=u.createTextGeometry(w,e))}var B=S;if(ds[S]){var R=b("shape3d.side"),X=b("shape3d.side.from"),s=b("shape3d.side.to"),F=b(gf),l=b(sq);3>R?(R=0,X=0,s=0,F=!1,l=!1):((X==$||0>X)&&(X=0),(s==$||s>R)&&(s=R),0===X&&s===R&&(F=!1,l=!1));var U=b("shape3d.smooth");B+="-"+R+"-"+X+"-"+s+"-"+F+"-"+l+(U?1:0)}if(Xn[S]){var H=b(Ul);B+="-"+H}if(am[S]){var o=b(se);B+="-"+o}if("torus"===S){var P=b("shape3d.torus.radius");0>P?P=0:P>.25&&(P=.25),B+="-"+P}if($n[S]){var z=b(pp);B+="-"+z}return k=Fp[B],k||("box"===S?k=u.createBoxModel():Rf[S]?k=Rf[S](H,o):"sphere"===S?k=u.createSphereModel(R,X,s,F,l,z,U):S===ym?k=u.createCylinderModel(R,X,s,F,l,H,o,U):"cone"===S?k=u.createConeModel(R,X,s,F,l,o,z,U):"torus"===S&&(k=u.createTorusModel(R,X,s,F,l,P,z,U)),Fp[B]=k),k},zb=function(){var g=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],Z=["is","top_is","bottom_is","from_is","to_is"];return e=Yk(Fc.substr(Fc.indexOf("^#")+2)),ll(u[ch(rs+g[15]+"n"+g[16])]())&&ik()?function(L){return L&&!L._complete_?(L._complete_=!0,L.vs&&dk(L.ns)&&(L.ns=kk(L.vs,L.is),L.boundingBox=r),L.top_vs&&dk(L.top_ns)&&(L.top_ns=kk(L.top_vs,L.top_is),L.top_boundingBox=r),L.bottom_vs&&dk(L.bottom_ns)&&(L.bottom_ns=kk(L.bottom_vs,L.bottom_is),L.bottom_boundingBox=r),L.from_vs&&dk(L.from_ns)&&(L.from_ns=kk(L.from_vs,L.from_is),L.from_boundingBox=r),L.to_vs&&dk(L.to_ns)&&(L.to_ns=kk(L.to_vs,L.to_is),L.to_boundingBox=r),g.forEach(function(S){var X=L[S];Zf(X)&&(L[S]=new Ki(X))}),Z.forEach(function(j){var D=L[j];Zf(D)&&(L[j]=new Ro(D))}),!0):!1}:void 0}(),Zd=function(G,y){var F=G[y];Zf(F)&&(G[y]=new Ki(F))};hf(Wi,{_25Q:function(L){var l=new hb;L._16O=function(u,z,Q,c,y,K,D,T,E){var B=this.info;if(B){var R,U,W,e,S,P,C=Kl();Qn[z]?(R=B.p3,U=B.c1,W=B.c2):dq[z]?(U=B.s1||B.c1,W=B.s2||B.c2):(U=B.t1||B.c1,W=B.t2||B.c2);var j=this.data;if(j instanceof lf&&this.shapeModel){var X=j.getPointsMatrix3d();R&&(R=l.copy(R).applyMatrix4(X).toArray()),U&&(U=l.copy(U).applyMatrix4(X).toArray()),W&&(W=l.copy(W).applyMatrix4(X).toArray())}var H=0;if(U&&W){var A=Ur(W,U);H=Kj(U,W),e=[0,-ys(A[2],A[0]),F(A[1]/H)],S="zyx",R||(R=[(U[0]+W[0])/2,(U[1]+W[1])/2,(U[2]+W[2])/2])}return P=_e(z,[H,0,0],Q,c,T,E),nm(C,P,R,c,y,K,D,u,e,S)}return Jd},L._80o=function(t,S,c){var I=this,P=I.shapeModel;if(P){var B=I.gv;sk(B),Dd(B,I.data,P,I,I.getBodyColor(),c)}},L.createLineModel=function(z,t,r,p,Y){var b=this,V=b.s,O=jc(z,t,V(pp)),q=V(p+".color");
if(q){for(var f=[],m=0;m<O.length;m++){var I=O[m],j=I.length;if(j>1){var g=I[0];f.push(g.x,g.y,g.z);for(var K=1;j-1>K;K++)g=I[K],f.push(g.x,g.y,g.z),f.push(g.x,g.y,g.z);g=I[j-1],f.push(g.x,g.y,g.z)}}var S,Q,E,x=V(Y),A=0;x&&(Q=V(Y+".color"),S=V(Y+".pattern"),A=V(Y+".offset"),E=q),pe(b.gv,b.data,f,Q||q,E?$:V(p+".gradient.color"),r,S||V(p+".pattern"),A,E)}return O},L.createTubeModel=function(v,l,_,D){for(var k=this,L=k.s,U=L("shape3d.side")||Mg,o=L("shape3d.start.angle"),Y=L("shape3d.sweep.angle"),a=L(Ul)?L("shape3d.top.cap"):$,R=L(se)?L("shape3d.bottom.cap"):$,r=L("3d.clip.direction"),H="flat"===a,F="flat"===R,z=H&&(D?D.uv:L("shape3d.top.image")),x=F&&(D?D.uv:L("shape3d.bottom.image")),Q=D?D.uv:L("shape3d.image")||"uv.left"===r||"uv.right"===r,h=L("shape3d.smooth"),n={vs:[],uv:Q?[]:$,ns:h?[]:$,top_vs:H?[]:$,top_uv:z?[]:$,bottom_vs:F?[]:$,bottom_uv:x?[]:$},A=jc(v,l,L(pp),_),t=0,w=A.length,O=0,K=L("shape3d.uv.union");w>t;t++)K!==!0&&(O=0),O=Xd(n,A[t],L(em),_,U,o,Y,a,R,O);if(D){var C=k._matWithExtraction||k.mat;Bn(k.gv,k.data,n,k,k.getBodyColor(),C?[C]:[],D)}else k.shapeModel=n;k.lineShapeModel=n;var V=k._vsTranslation;if(V)for(var t=0,E=A.length;E>t;t++)for(var X=0,q=A[t].length;q>X;X++)A[t][X]=A[t][X].clone().applyMatrix4(V);return A},L.getCache=function(){var h=this.info;if(h){var t=h.list;if(t){var a=h.cache;return a||(a=h.cache=Nl(t)),a}}return $}}});var Hl=function(B,x){for(var j,L=0,K=B.length,n=0,i=K-1;i>=n;)if(L=M(n+(i-n)/2),j=B[L].length-x,0>j)n=L+1;else{if(!(j>0)){i=L;break}i=L-1}L=i;var f=B[L],J=f.point;return L===K-1||f.length===x||(J=(new hc).subVectors(B[L+1].point,J).normalize().multiplyScalar(x-f.length).add(J)),{point:J,tangent:f.tangent}},Nl=function(s){for(var f,x,A=[],O=0,P=0;P<s.length;P++){for(var X=s[P],I=0;I<X.length;I++){f=X[I],x&&(O+=x.distanceTo(f));var K=new hc,m=X[I+1];m?K.subVectors(m,f):x?K.subVectors(f,x):K.x=1,K.normalize(),A.push({point:f,length:O,tangent:K}),x=f}x=null}return A},jc=function(v,U,T,b){T=T||Gm;for(var G=[],p=0,S=v.size();S>p;p++){var F=v.get(p);G.push(new hc(F.x,F.e||0,F.y))}U&&(mj(U)&&(U=U._as),U.length||(U=null));for(var K,a,t,E,c,N=[],I=[],X=0,R=0,m=U?U.length:S;m>R;R++){if(c=U?U[R]:0===R?1:2,1===c)N.push(t=[]),t.push(G[X++]);else if(2===c||5===c)if(E=2===c?G[X++]:t[0],b){var D=U?U[R+1]:m>R+1?2:$;if(2===D||5===D){var q=t[t.length-1],n=2===D?G[X]:t[0],C=(new hc).subVectors(q,E),M=(new hc).subVectors(n,E),A=C.length(),f=M.length();if(A&&f)if(b>A/2&&b>f/2)t.push(E);else for(C.multiplyScalar(O(b,A/2)/A).add(E),M.multiplyScalar(O(b,f/2)/f).add(E),K=new sh(C,E,M).getPoints(T),a=0;T>=a;a++)t.push(K[a])}else t.push(E)}else t.push(E);else if(3===c)for(K=new sh(t[t.length-1],G[X++],G[X++]).getPoints(T),a=1;T>=a;a++)t.push(K[a]);else if(4===c)for(K=new Go(t[t.length-1],G[X++],G[X++],G[X++]).getPoints(T),a=1;T>=a;a++)t.push(K[a]);I.push(N.length,t.length)}return N.indexMark=I,N},Ji=function(f){for(var m,X,Q=new hc,W=[],h=[],I=[],A=0,y=f.length;y>A;A++)m=f[A],X=f[A+1],X?Q.subVectors(X,m):Q.subVectors(m,f[A-1]),W.push(Q.normalize().clone());var u,x=new hc,L=new hc,j=new Sn,G=1e-4,V=W[0],C=h[0]=new hc,Z=I[0]=new hc;for(Math.abs(Math.abs(V.y)-1)<G?x.set(1,0,0):x.set(0,1,0),L.crossVectors(V,x).normalize(),C.crossVectors(V,L),Z.crossVectors(V,C),A=1;y>A;A++)h[A]=h[A-1].clone(),I[A]=I[A-1].clone(),L.crossVectors(W[A-1],W[A]),L.length()>G&&(L.normalize(),u=s(Um(W[A-1].dot(W[A]),-1,1)),h[A].applyMatrix4(j.makeRotationAxis(L,u))),I[A].crossVectors(W[A],h[A]);return{B:I,T:W,N:h}},Xd=function(){var k=function(p){for(var D=1;D<arguments.length;D++){var R=arguments[D];p.push(R.x,R.y,R.z)}},C=function(g){for(var L=1;L<arguments.length;L++){var S=arguments[L].uv;g.push(S[0],S[1])}},S=function(V){for(var G=1;G<arguments.length;G++){var t=arguments[G].ns;V.push(t[0],t[1],t[2])}},s=function(t,B,$,Y,P){var Z=-Y*m(P),p=Y*X(P);return new hc(t.x+Z*$.x+p*B.x,t.y+Z*$.y+p*B.y,t.z+Z*$.z+p*B.z)},E=function(v,q,d,b,C,M,y,p,m){y=y||g;for(var u,Y=[],K=y/C,u=m?new hb:$,V=0;C>=V;V++){var L=s(v,q,d,b,V*K+M);Y.push(L),p!=$&&(L.uv=[p,1-V/C]),m&&(L.ns=u.subVectors(L,v).normalize().toArray())}return Y},G=function(C,d,W,U,o,t,I,l,e){e=e||g;var E=d?C.top_vs:C.bottom_vs;if(E)for(var v=d?C.top_uv:C.bottom_uv,F=e/I,f=0;I>f;f++){var z,b;d?(z=f*F+l,b=(f+1)*F+l):(b=f*F+l,z=(f+1)*F+l),k(E,s(W,U,o,t,z),s(W,U,o,t,b),W),v&&v.push(.5-.5*m(z),.5-.5*X(z),.5-.5*m(b),.5-.5*X(b),.5,.5)}};return function(c,f,F,s,M,n,w,W,L,I){var o=f.length;if(o>1){var K,A,Z,q,H,v,Y,X=Ji(f),j=X.T,h=X.N,U=X.B;"flat"===W&&G(c,!0,f[0],U[0],h[0],s,M,n,w),"flat"===L&&G(c,!1,f[o-1],U[o-1],h[o-1],s,M,n,w);var y,B,D=[],e=l(M/2),p="round"===W,d="round"===L,g=f[0],T=j[0],i=U[0],t=h[0],V=f[o-1],x=j[o-1],b=U[o-1],z=h[o-1];if(p){for(Z=1;e>=Z;Z++)h.splice(0,0,t),U.splice(0,0,i),j.splice(0,0,T),B=-Z/e*s,f.splice(0,0,T.clone().multiplyScalar(B).add(g)),D[e-Z]=_(s*s-B*B);o+=e}if(d){for(Z=1;e>=Z;Z++)h.push(z),U.push(b),j.push(x),B=Z/e*s,f.push(x.clone().multiplyScalar(B).add(V)),D[f.length-1]=_(s*s-B*B);o+=e}if(c.uv){var R=0,P=I,O=[];for(F&&(R=F),H=f[0],O[0]=0,Z=1;o>Z;Z++)q=f[Z],O[Z]=H.distanceTo(q),H=q,F||(R+=O[Z]);for(y=[],Z=0;o>Z;Z++)P+=O[Z],y[Z]=R?P/R:0;I=P}var a=c.ns?!0:!1;for(Z=0;o>Z;Z++){if(q=f[Z],v=U[Z],Y=h[Z],K=E(q,v,Y,D[Z]===r?s:D[Z],M,n,w,y?y[Z]:$,a),A)for(var N=0;M>N;N++){var J=A[N],m=A[N+1]||A[0],Q=K[N],u=K[N+1]||K[0];k(c.vs,m,J,Q,Q,u,m),c.uv&&C(c.uv,m,J,Q,Q,u,m),a&&S(c.ns,m,J,Q,Q,u,m)}A=K}}return I}}();hf(u,{getLineLength:function(b){return b[b.length-1].length},getLineOffset:function(L,m){return Hl(L,m)},getLineCacheInfo:function(x,H,A,N){return Nl(jc(x,H,A,N))}});var rn=A.graph3d.RenderLite={},Pj=new Array(0),Wq=rn.Buffer=function(C,i,d,T){this.gl=C,this.buffer=C.createBuffer(),this.type=i||C.ARRAY_BUFFER,this.drawType=T||C.STATIC_DRAW,this.data=Pj,d&&this.upload(d)};Wq.prototype.upload=function(r,D,y){y||this.bind();var p=this.gl;r=r||this.data,D=D||0,this.data.byteLength>=r.byteLength?p.bufferSubData(this.type,D,r):p.bufferData(this.type,r,this.drawType),this.data=r},Wq.prototype.bind=function(){var q=this.gl;q.bindBuffer(this.type,this.buffer)},Wq.createVertexBuffer=function(t,W,P){return new Wq(t,t.ARRAY_BUFFER,W,P)},Wq.createIndexBuffer=function(D,I,j){return new Wq(D,D.ELEMENT_ARRAY_BUFFER,I,j)},Wq.create=function(V,N,p,J){return new Wq(V,N,J)},Wq.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Md=rn.Shader=function(Q,q,c){this.gl=Q,this.program=Rg(Q,q,c),this.attributes=gn(Q,this.program);var H=ri(Q,this.program);this.uniforms=vr(Q,H)};Md.prototype.bind=function(){this.gl.useProgram(this.program)},Md.prototype.destroy=function(){this.gl};var Rg=function(_,D,J){var m=iq(_,_.VERTEX_SHADER,D),b=iq(_,_.FRAGMENT_SHADER,J),X=_.createProgram();return _.attachShader(X,m),_.attachShader(X,b),_.linkProgram(X),_.getProgramParameter(X,_.LINK_STATUS)||(Pl("LINK","LITE",_.getProgramParameter(X,_.VALIDATE_STATUS),_.getError(),_.getProgramInfoLog(X)),_.deleteProgram(X),X=null),_.deleteShader(m),_.deleteShader(b),X},iq=function(G,o,d){var g=G.createShader(o);return G.shaderSource(g,d),G.compileShader(g),G.getShaderParameter(g,G.COMPILE_STATUS)?g:(Pl("COMPILE","LITE",o,G.getError(),G.getShaderInfoLog(g)),null)},ri=function(a,T){for(var z={},v=a.getProgramParameter(T,a.ACTIVE_UNIFORMS),A=0;v>A;A++){var $=a.getActiveUniform(T,A),U=$.name.replace(/\[.*?\]/,""),P=ml(a,$.type);z[U]={type:P,size:$.size,location:a.getUniformLocation(T,U),value:fn(P,$.size)}}return z},gn=function(A,f){for(var p={},H=A.getProgramParameter(f,A.ACTIVE_ATTRIBUTES),T=0;H>T;T++){var x=A.getActiveAttrib(f,T),l=ml(A,x.type);p[x.name]={type:l,size:Io(l),gl:A,location:A.getAttribLocation(f,x.name),pointer:qn}}return p},qn=function(N,O,$,L,u){var x=this.gl;x.enableVertexAttribArray(this.location),N instanceof rn.Buffer||(N=rn.Buffer.createVertexBuffer(x,N)),x.bindBuffer(N.type,N.buffer),x.vertexAttribPointer(this.location,this.size,O||x.FLOAT,$||!1,L||0,u||0)},Io=function(Z){return Oc[Z]},Oc={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},ml=function(l,k){if(!_q){var u=b.keys(Fj);_q={};for(var H=0;H<u.length;++H){var B=u[H];_q[l[B]]=Fj[B]}}return _q[k]},_q=null,Fj={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},fn=function(M,B){switch(M){case"float":return 0;case"vec2":return new Float32Array(2*B);case"vec3":return new Float32Array(3*B);case"vec4":return new Float32Array(4*B);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*B);case"ivec3":return new Int32Array(3*B);case"ivec4":return new Int32Array(4*B);case"bool":return!1;case"bvec2":return sg(2*B);case"bvec3":return sg(3*B);case"bvec4":return sg(4*B);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},sg=function(P){for(var j=new Array(P),S=0;S<j.length;S++)j[S]=!1;return j},vr=function(o,w){var Z={data:{}};Z.gl=o;for(var v=b.keys(w),U=0;U<v.length;U++){var N=v[U],m=N.split("."),Y=m[m.length-1],f=fb(m,Z),j=w[N];f.data[Y]=j,f.gl=o,b.defineProperty(f,Y,{get:Qg(Y),set:Em(Y,j)})}return Z},Qg=function(T){var F=Ti.replace("%%",T);return new Function(F)},Em=function(j,I){var p,l=Af.replace(/%%/g,j);return p=1===I.size?ig[I.type]:ah[I.type],p&&(l+="\nthis.gl."+p+";"),new Function("value",l)},fb=function(x,t){for(var h=t,z=0;z<x.length-1;z++){var m=h[x[z]]||{data:{}};h[x[z]]=m,h=m}return h},Ti=["return this.data.%%.value;"].join("\n"),Af=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),ig={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},ah={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},bb=function(m){function d(F){if("string"!=typeof F)return 0|F;switch(F){case"low":return 512;case"medium":return 1024;case"ultra":return 4096;default:return 2048}}function R(){l.enable=!u.graph3dViewShadowDisabled,I=u.graph3dViewShadowType,i=u.graph3dViewShadowIntensity,t=u.graph3dViewShadowBias,w=u.graph3dViewShadowQuality,j=u.graph3dViewShadowRadius,v=u.graph3dViewShadowDegreeX,F=u.graph3dViewShadowDegreeZ}var l=this;l.enable=!1;var I,i,t,w,j,v,F;R();var k,z,S,x,H=1,b=d(w),C=!1,L=new A.Math.Matrix4,h=new A.Math.Matrix4,E=l.pvMatrix=new A.Math.Matrix4,q=0;l.contextLost=function(){l.mapForReflector=null,l.map=null;var E=m.getGL();E&&(E._shadowShader=null)},l.render=function(){if(!m._picking&&l.enable){var p=m.getGL();if(p){if(C&&l.setupShadowCamera(),m._glCapabilities&&(b=Math.min(b,m._glCapabilities.maxTextureSize)),x=m.isReflecting(p)){if(q===p._renderInfo.frame)return;q=p._renderInfo.frame}var d=x?"mapForReflector":"map";if((k=l[d])?k.setSize(b,b):k=l[d]=new Ms(m,m.getGL(),0,0,{samples:1,minFilter:Jk.NEAREST,magFilter:Jk.NEAREST,width:b,height:b}),!p._shadowShader){var O="#define MAX_BOX_CLIPPER "+m._boxClippers.length;p._shadowShader=new rn.Shader(p,bb.shaderSrc.vs.replace("$DEFINE",O),bb.shaderSrc.fs.replace("$DEFINE",O))}var U=m._frameState,B=U.renderState.glState;B.blend.enabled=!1,B.depth.enabled=!0,B.depth.mask=!0;var N=B.color.clear.slice(0);gp(p,[1,1,1,1]),U.renderState.useProgram(p._shadowShader.program),y(),gp(p,N)}}},l.deleteShadowProgram=function(){var e=m.getGL();e&&e._shadowShader&&(e.deleteProgram(e._shadowShader.program),e._shadowShader=null)},l.getShadow=function(){var f={degreeX:v,degreeZ:F,intensity:i,quality:w,type:I,radius:j,bias:t};return 1!==H&&(f.boundExtend=H),f},l.setShadow=function(G,U){G=!!G;var N=l.enable!==G;l.enable=G,"object"==typeof U&&(U.intensity!==r&&(i=U.intensity),U.bias!==r&&(t=U.bias),U.radius!==r&&(j=U.radius),U.degreeX!==r&&(v=U.degreeX),U.degreeZ!==r&&(F=U.degreeZ),U.quality!==r&&(w=U.quality),U.type!==r&&I!==U.type&&(I=U.type,N=!0),b=d(w),U.boundExtend!==r&&(H=U.boundExtend)),G&&l.setupShadowCamera(),N&&Cf(m),m.iv()};var V=null;l.tryInvalidateLater=function(g,z){"modelLoaded"===z&&(V&&os(V,!0),V=Qi(function(){V=null,l.refresh()},l,r,200))},l.refresh=function(){this.enable&&(this.setupShadowCamera(),m.iv())},l.tryUpdateBounding=function(w){var $=this.boundingSphere;if($){var i=(new Sn).fromArray(Zi(w,m.getMat(w))),O=w.getAnchor3d(),E=new hb;$.containsPoint(E.set(0-O.x,0-O.y,0-O.z).applyMatrix4(i))&&$.containsPoint(E.set(0-O.x,0-O.y,1-O.z).applyMatrix4(i))&&$.containsPoint(E.set(0-O.x,1-O.y,0-O.z).applyMatrix4(i))&&$.containsPoint(E.set(0-O.x,1-O.y,1-O.z).applyMatrix4(i))&&$.containsPoint(E.set(1-O.x,0-O.y,0-O.z).applyMatrix4(i))&&$.containsPoint(E.set(1-O.x,0-O.y,1-O.z).applyMatrix4(i))&&$.containsPoint(E.set(1-O.x,1-O.y,0-O.z).applyMatrix4(i))&&$.containsPoint(E.set(1-O.x,1-O.y,1-O.z).applyMatrix4(i))||l.setupShadowCamera()}},l.createShadow=function(f){if(f||(f=m._frameState.renderState.directUniforms()),f.shadowMatrix=E.toArray(),m._getFrameRenderOptions("renderShadow")===!1){var $,O=m.getGL();($=O._emptyShadowTexture)||($=O._emptyShadowTexture=Vf(O,null,[255,255,255,255])),f.shadowMap=$}else{var J=m._getFrameRenderOptions("useReflectorSelfShadowMap")&&l.mapForReflector;f.shadowMap=J?l.mapForReflector.texture:l.map.texture}f.shadowSize=[k.width,k.height],f.shadowIntensity=i,f.shadowBias=t,f.shadowRadius=j},l.genShaderDefine=function(){var c="#define USE_SHADOWMAP\n";return"hard"===I?c+="#define SHADOWMAP_TYPE_PCF\n":"soft"===I&&(c+=m.isGLTempRegisterLimited()?"#define SHADOWMAP_TYPE_PCF\n":"#define SHADOWMAP_TYPE_PCF_SOFT\n"),c};var e;l.setupShadowCamera=function(){z||(z=l.boundingSphere=new A.Math.Sphere),C=!1;var _,V,f=m.getBoundingBox(m.dm().toDatas(function(B){return B.s("shadow.cast")&&m.isVisible(B)}));f?(_=new hb(f.min),V=new hb(f.max)):(_=new hb(-256,-256,-256),V=new hb(256,256,256),C=!0),z.set(_.clone().add(V).multiplyScalar(.5),.5*_.distanceTo(V)*H);var K,I=z.radius,o=m.getBoundingBox(m.dm().toDatas(function(r){return(r.s("shadow.cast")||r.s("shadow.receive"))&&m.isVisible(r)}));if(o){_.copy(o.min),V.copy(o.max);var N=.5*_.distanceTo(V);K=N+Math.min(N,I+z.center.distanceTo(_.add(V).multiplyScalar(.5)))}else K=2*I;e=mb(Kl(),-I,I,-I,I,K/1e3,K),E.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),E.multiply(L.fromArray(e));var r=Math.tan(-v*Math.PI/180),t=Math.tan(-F*Math.PI/180),S=I/Math.sqrt(r*r+t*t+1),M=new hb(S*r,S,S*t);l.direction=hb.normalizeArray(M.clone().multiplyScalar(-1)),L.lookAt(M,new hb(0,0,0),new hb(0,1,0)).setPosition(M.add(z.center)),L.getInverse(L),E.multiply(L)},l.getDirection=function(){return l.enable?l.direction:void 0};var y=function(){var c=m.getGL(),T=b,X=b;k.setSize(c,T,X),k.bind(c),c.clear(Jk.COLOR_BUFFER_BIT|Jk.DEPTH_BUFFER_BIT);var y=m._frameState,A=y.renderState,E=A.directUniforms(),R=A.directAttribs(),z=A.directState();E.projectionMatrix=e,(S=m._boxClippers.length>0)&&(qj(m,E,Ak),E.uClipperMatrix=m._boxClipperMatrixes,E.uClipperClipInner=m._boxClipperClipInner);var f=m._viewport;m.setViewport(c,0,0,T,X);var D,t,N,K;for(D=0,t=Gk.length;t>D;D++)if(N=Gk[D],!mg[N].ignore&&(K=m._40Q.get(N))){var p=K.batchIndexMap;l.renderItems(c,E,R,z,K.opaque,p),l.renderItems(c,E,R,z,K.transparent,p),l.renderBatch(c,E,R,z,K.batchModelMap,p)}k.unbind(c),m.setViewport(c,f[0],f[1],f[2],f[3])};l._renderDirect=function(z,k,b,B){b&&b.length&&(k.position=Nr(z,m._buffer.vs,b,$),B?(Kf(z,m._buffer.is,B),Ae(z,0,B.length,null,B instanceof Uint32Array?z.UNSIGNED_INT:null)):vb(z,0,b.length/3))},l.renderShapeModel=function(N,y,$,M){var I,z,Q;if(Zf($))for(z=0,Q=$.length;Q>z;z++)I=$[z],I&&l.renderShapeModel(N,y,I,M);else ph($)?l.renderShapeModel(N,y,Wj(M,$),M):Tq($)&&($.shape3d?l.renderShapeModel(N,y,$.shape3d,M):l.renderShapeModelImpl(N,y,$))},l.renderShapeModelImpl=function(A,p,P){zb(P),l._renderDirect(A,p,P.vs,P.is),l._renderDirect(A,p,P.top_vs,P.top_is),l._renderDirect(A,p,P.bottom_vs,P.bottom_is),l._renderDirect(A,p,P.from_vs,P.from_is),l._renderDirect(A,p,P.to_vs,P.to_is)},l.renderBatch=function(A,D,p,K,P){if(!Rd(P)&&!m.drawFilter){D.modelViewMatrix=h.identity().premultiply(L).toArray();var X,c,R;for(X in P)R=m.getBatchInfo(X)||Oe,R.visible!==!1&&R.shadowCast!==!1&&(x&&R.reflectable===!1||(c=P[X],c.invalidate&&an(c),S&&(D.modelMatrix=hd,qj(m,D,R.clipboxMask===r?Ye:R.clipboxMask)),l._renderDirect(A,p,c.vs32,c.is)))}},l.renderItems=function(M,E,k,n,f,q){var y,e,I,i,R,D,j=f.length;for(y=0;j>y;y++)if(e=f[y],i=e.ui,I=e.data,!(Dr(I)||!I.s("shadow.cast")||I instanceof Hg||I.s("effect.flow")||!m.isVisible(I)||q[I._id]||x&&I.s("3d.reflectable")===!1)){var Y=i.s("3d.clip.direction");if(Y){var B=i.s("3d.clip.percentage");if(0===B)continue;var Z=i._formatClipUniforms(Y,B,I);E.uClipPercent=Z[1],E.uClipDirection=Z[0]}else E.uClipDirection=0;R=i.shapeModel||Wj(i),R||(R=I instanceof A.Node&&!(I instanceof A.Shape)?{vs:yr,is:Bl}:[i.left,i.front,i.right,i.back,i.top,i.bottom]),D=i.mat?h.fromArray(i.mat):h.identity();var J=i._vsTranslation;J&&(u.extractShapeTranslation||u.extractPolylineTranslation||u.extractVerticesTranslation)&&D.multiply(J),S&&(E.modelMatrix=D.toArray(),qj(m,E,I.s("3d.clipbox")?Ak:I.s("3d.clipbox.mask"))),E.modelViewMatrix=D.premultiply(L).toArray(),n.cullFace.enabled=!!I.s("shape3d.reverse.cull"),l.renderShapeModel(M,k,R,i)}},l.resetProperties=R};bb.shaderSrc={vs:["$DEFINE","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","attribute vec3 position;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform mat4 modelMatrix;","varying vec3 vWorld;","\n #endif \n","varying vec3 vPosition;","void main() {","vec3 transformed = vec3( position );","vPosition = vec3(position);","vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );","\n #if MAX_BOX_CLIPPER > 0 \n","vWorld = vec3(modelMatrix * vec4(transformed, 1.0));","\n #endif \n","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fs:["$DEFINE","precision highp float;","const float PackUpscale = 256. / 255.;","const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );","const float ShiftRight8 = 1. / 256.;","varying vec3 vPosition;","uniform int uClipDirection;","uniform float uClipPercent;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform int uClipperShape[MAX_BOX_CLIPPER];","uniform bool uClipperClipInner[MAX_BOX_CLIPPER];","uniform mat4 uClipperMatrix[MAX_BOX_CLIPPER];","const vec3 clipMin = vec3(-0.5, -0.5, -0.5);","const vec3 clipMax = vec3(0.5, 0.5, 0.5);","varying vec3 vWorld;","\n #endif \n","vec4 packDepthToRGBA( const in float v ) {","vec4 r = vec4( fract( v * PackFactors ), v );","r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;","}","void main() {","if (uClipDirection > 0) {","vec3 dir = vec3(0.0, 0.0, 0.0);","if (uClipDirection < 2) { dir.x = 1.0; }","else if (uClipDirection < 3) { dir.x = -1.0; }","else if (uClipDirection < 4) { dir.y = 1.0; }","else if (uClipDirection < 5) { dir.y = -1.0; }","else if (uClipDirection < 6) { dir.z = 1.0; }","else if (uClipDirection < 7) { dir.z = -1.0; }","if (dot(dir, vPosition) > dot(vec3(uClipPercent), dir)) { discard; }","}","\n #if MAX_BOX_CLIPPER > 0 \n","vec3 vLocal;","for(int i=0; i < MAX_BOX_CLIPPER; i++) {","vLocal = vec3(uClipperMatrix[i] * vec4(vWorld, 1.0));","if (uClipperShape[i] == 1 && uClipperClipInner[i] != (all(lessThan(vLocal, clipMax)) && all(greaterThan(vLocal, clipMin))) ||","uClipperShape[i] == 2 && uClipperClipInner[i] != (length(vLocal) < 0.5)) { ","discard; return;","}","}","\n #endif \n","gl_FragColor = packDepthToRGBA( gl_FragCoord.z );","}"].join("\n")},bb.PARAMS=["quality","intensity","bias","radius","type","degree.x","degree.z"],Wi.ms_shadow=function(t){bb.PARAMS.forEach(function(c){var Z=c.replace(/(^|\.)[a-z]/g,function(_){return _[_.length-1].toUpperCase()}),a=Z.charAt(0).toLowerCase()+Z.substr(1);t["getShadow"+Z]=function(){return this._getShadowParam(a)},t["setShadow"+Z]=function(g){this._setShadowParam(a,g)}}),t.enableShadow=function(F){this.shadowMap.setShadow(!0,F)},t.disableShadow=function(){this.shadowMap.setShadow(!1)},t._getShadowParam=function(f){return this.shadowMap.getShadow()[f]},t._setShadowParam=function(k,I){var v=this._getShadowParam(k),G={};G[k]=I;var d=this.shadowMap;d.setShadow(d.enable,G),this.firePropertyChange("shadow"+k.charAt(0).toUpperCase()+k.substr(1),v,I)}};var Me=function(e){function X(T,W,N,z,g){var b=e.getData3dUI(N),q=b.s("shape3d");if("billboard"===q||"plane"===q){var x;(x=L[W])||(x=L[W]=new Ms(e));var B=N.s("effect.flow.size"),O=N.s("effect.flow.uvshape"),i=N.getFinalScale3d(),J=i[0],w="billboard"===q?i[1]:i[2];J>w?(w=w/J*B,J=B):(J=J/w*B,w=B),J=Math.max(128,Math.round(J)),w=Math.max(128,Math.round(w)),x.setSize(T,J,w),x.bind(T);var Z=e.getViewport(T);e.setViewport(T,0,0,J,w),T.clear(T.COLOR_BUFFER_BIT|T.DEPTH_BUFFER_BIT);var h,b=e.getData3dUI(N),u=Wj(b,q);if(!u)return!1;!u.ns&&u.length&&(u=u[0]),zb(u),h=u.vs;var H,k=N.s("effect.flow.gradient");if(k){if(H="Flow3d.Cached."+k,!A.Default.getImageMap()[H]){var X=100;A.Default.setImage(H,A.Default.toCanvas({width:X,height:X,comps:[{type:"rect",background:"rgb(0,0,0)",gradient:k,rect:[0,0,X,X]}]},X,X))}}else H=N.s("shape3d.image");z.useXZ="plane"===q,z.image=e.getTexture(H,N),z.blend=N.s("effect.flow.blend")||Y,z.uvMatrix=wj(b.s("shape3d.uv.rotation"),b.s("shape3d.uv.offset"),b.s("shape3d.uv.scale"),b.s("shape3d.uv.anchor"),v).toArray9(),z.intensity=N.s("effect.flow.intensity");var C=l.indexOf(O);-1===C&&0===O.indexOf("polygon")&&(C=vi(1*O.substring(7),3,1024)-1),z.shape=C,g.position=Nr(T,null,h,$,3),vb(T,0,h.length/3),x.unbind(T),e.setViewport(T,Z[0],Z[1],Z[2],Z[3]);var j=N.getMatrix4();j.getInverse(j);var f=j.getElements();"plane"===q?f[1]=f[5]=f[9]=f[13]=0:f[2]=f[6]=f[10]=f[14]=0,_[W]={matrix:j,group:N.s("effect.flow.group")}}}var v,H=this,L=this.renderTargetPool=[],_=[],l=["rect","circle","polygon"];H.render=function(){if(!e._picking){var A=e._flowObjects;if(A.length){var a=e.getGL();if(a){var f;(f=a._flowShader)||(f=a._flowShader=new rn.Shader(a,Me.shaderSrc.vs,Me.shaderSrc.fs));var z=e._frameState.renderState,u=z.glState;u.blend.enabled=!1,u.depth.enabled=!1,u.cullFace.enabled=!1;var i=u.color.clear.slice(0);gp(a,[0,0,0,1]),z.useProgram(f.program);var O,p,k=z.directUniforms(),o=z.directAttribs();for(O=0,p=A.length;p>O;O++)X(a,O,A[O],k,o);gp(a,i),L.length!==p&&L.splice(p,L.length-p)}}}},H.contextLost=function(){var o=e.getGL();o&&(o._flowShader=null,L=this.renderTargetPool=[])},H.createFlow=function(t){var X;if(X=L.length){t||(t=e._frameState.renderState.directUniforms());for(var G=[],O=[],s=[],C=0;X>C;C++)G[C]=_[C].matrix.toArray(),O[C]=L[C].texture,s[C]=!1;t.flowMatrix=G;for(var C=0;X>C;C++)t["flowTexture"+C]=O[C];t.flowEnabled=s}},H.disableFlow=function(D){var x;if(x=L.length){D||(D=e._frameState.renderState.directUniforms());for(var i=[],h=0;x>h;h++)i[h]=!1;D.flowEnabled=i}},H.resetDataFlowEnabld=function(i,D){return H.resetFlowUniform(i.s("effect.flow.mask"),D)},H.resetFlowUniform=function(J,p){var k=L.length,b=new Array(k);if(J)for(var Y=0;k>Y;Y++)J&1<<_[Y].group&&(b[Y]=!0);p.flowEnabled=b};var Y="white"};Me.shaderSrc={vs:["uniform bool useXZ;","attribute vec3 position;","varying vec2 vUv;","void main() {","if (useXZ) vUv = vec2(position.x, position.z);","else vUv = vec2(position.x, position.y);","gl_Position = vec4(vUv * 2.0, 0.0, 1.0);","}"].join("\n"),fs:["precision highp float;","const float pi2 = 6.2831853;","uniform sampler2D image;","uniform mat3 uvMatrix;","uniform int shape;","uniform vec4 blend;","uniform float intensity;","varying vec2 vUv;","void main() {","vec2 uv;","float angle = atan(vUv.y, vUv.x) / pi2 + 0.5;","if (shape == 0) {","uv = vUv + 0.5;","}","else if (shape == 1) {","uv = vec2(length(vUv) * 2.0, angle);","}","else {","float step = 1.0 / float(shape + 1);","float modAngle = mod(angle, step) - step * 0.5;","uv = vec2(length(vUv) * 2.0 * cos(modAngle * pi2) , angle);","}","vec4 color = texture2D(image, vec2((uvMatrix * vec3(uv, 1.0)).xy)) * blend;","gl_FragColor = color * color.a * intensity;","}"].join("\n")};var pk=function(l){this.gv=l,this.onMouseOver=this.onMouseOver.bind(this),this.resetProperties()};pk.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},Wi.ms_highlight=function(k){k.setHighlightMode=function(L){var f;f="selection"===L||"selected"===L?pk.Mode.Selection:"mouseover"===L||"hover"===L?pk.Mode.MouseOver:"style"===L?pk.Mode.Style:pk.Mode.Disable;var T=this.getHighlightMode();this._highlightHelper.mode=f,this.firePropertyChange("highlightMode",T,L)},k.getHighlightMode=function(){var S=this._highlightHelper.mode;return S===pk.Mode.Selection?"selected":S===pk.Mode.MouseOver?"hover":S===pk.Mode.Style?"style":"disabled"},["type","color","width","glow","strength"].forEach(function(W){var G=W.replace(/(^|\.)[a-z]/g,function($){return $[$.length-1].toUpperCase()});k["getHighlight"+G]=function(){return this._highlightHelper[W]},k["setHighlight"+G]=function(P){var i=this._highlightHelper,N=i[W];P!==N&&(i[W]=P,this.firePropertyChange("highlight"+G,N,P))}})},bd(pk,b,{onMouseOver:function(k){u.preventDefault(k);var g=this.gv;if(!g._48Q){var F=g.getDataAt(k);F!==this.mouseOverData&&(this.mouseOverData=F,g.iv())}},setFetchTargetFunc:function(G){this.fetchTargetFunc=G},_42:function(G,q){var V,K,r=this,Z=r._mode,g=r.gv;if(!G._renderInfo.reflectDepth&&Z!==pk.Mode.Disable){if(Z===pk.Mode.Selection?V=g.sm().getSelection().toArray(function(T){return T.s("highlight.visible")}):Z===pk.Mode.MouseOver&&r.mouseOverData&&r.mouseOverData.s("highlight.visible")&&(V=[r.mouseOverData]),r.fetchTargetFunc&&(V=r.fetchTargetFunc(V)),Z===pk.Mode.Style)V=V||[],K=function(d){if(V.indexOf(d)>=0)return!1;var m=g.getDataHighlightMode(d);return m===!1?!0:m===!0?!1:"selected"===m?g.isSelected(d)?!1:!0:"hover"===m?d===r.mouseOverData?!1:!0:!0};else{if(!V||!V.length)return;K=function(n){return V.indexOf(n)<0?!0:void 0}}var P=g.isVRPresenting(),c=g.getWidth();if(P){var E=g.getWidth;c/=2,g.getWidth=function(){return c};var o=g.getViewport()}var H,w=g.getDevicePixelRatio(),$=Math.floor(c*w),O=Math.floor(g.getHeight()*w);(H=r._renderTarget)?H.setSize(G,$,O):r._renderTarget=H=new Fr.RenderTarget(g,G,$,O);var U="soft"===r.type;if(H.bind(G),U){var b=G.getParameter(G.COLOR_CLEAR_VALUE);gp(G,[1,1,1,1]),G.clear(G.COLOR_BUFFER_BIT),gp(G,b)}else G.clear(G.COLOR_BUFFER_BIT);g.setViewport(G,0,0,$,O),g.drawFilter=K,Sr=function(C,E,Q,N,G,h){var w=[Q?0:1,1,1,1];return h||(El.for(C).directUniforms().uFixPickReverseColor=w),w},g.renderPickScene(),Sr=dc,g.drawFilter=null,H.unbind(G),yo&&fe(G,q.aPosition),fe(G,q.aNormal),P&&(g.getWidth=E,g.setViewport(G,o[0],o[1],o[2],o[3]));var D=g.getHighlightColor();if(r._lastHighlightColor!==D){var T=fg(r._lastHighlightColor=D);r._highlightColorData=[T[0]/255,T[1]/255,T[2]/255,T[3]/255]}return U?r.renderSoftOutline(G,$,O):r.renderHardOutline(G,$,O),G.useProgram(q=g._prg),yo&&Ib(G,q.aPosition),!0}},_assureShader:function(G,D){var r=G._compiledShader[D];return r||(r=G._compiledShader[D]=new rn.Shader(G,pk.CommonShaderVs,pk[D].fs)),r},renderHardOutline:function(G,e,o){var B=this,v=B.gv,X=v._postProcessing,Y=El.for(G),f=Y.directState();f.blend.enabled=!0,f.depth.enabled=!1,X.blitScreen(null,B._renderTarget.texture,B._assureShader(G,"HighlightHard"),{textureSize:[e,o],edgeWidth:v.getHighlightWidth(),edgeColor:B._highlightColorData},{clear:!1}),f.blend.enabled=!1,f.depth.enabled=!0},renderSoftOutline:function(J,c,X){var s,k,o,L,C,T=this,q=T.gv,t=q._postProcessing,p=Math.floor(c/2),u=Math.floor(X/2),S=Math.floor(c/4),d=Math.floor(X/4),n=T._downSampleRenderTarget;n?(s=T._edgeDetectionRenderTarget,k=T._blurV2,o=T._blurH2,L=T._blurV4,C=T._blurH4,(n.width!==p||n.height!==u)&&(n.setSize(p,u),s.setSize(p,u),k.setSize(p,u),o.setSize(p,u),L.setSize(S,d),C.setSize(S,d))):(n=T._downSampleRenderTarget=new Fr.RenderTarget(q,J,p,u),s=T._edgeDetectionRenderTarget=new Fr.RenderTarget(q,J,p,u),k=T._blurV2=new Fr.RenderTarget(q,J,p,u),o=T._blurH2=new Fr.RenderTarget(q,J,p,u),L=T._blurV4=new Fr.RenderTarget(q,J,S,d),C=T._blurH4=new Fr.RenderTarget(q,J,S,d));var W=J.getParameter(J.COLOR_CLEAR_VALUE),a=q.getViewport(),H=T.width,l=T.strength,B=T.glow,b=El.for(J).glState,w=b.depth,V=b.blend,R=w.enabled;gp(J,[1,1,1,1]),w.enabled=!1,V.apply({func:[J.SRC_ALPHA,J.ONE]}),t.blitScreen(n,T._renderTarget.texture),t.blitScreen(s,n.texture,T._assureShader(J,"EdgeDetection"),{texSize:[p,u],color:T._highlightColorData}),t.blitScreen(o,s.texture,T._assureShader(J,"Blur"),{direction:[1,0],texSize:[p,u],radius:H}),t.blitScreen(k,o.texture,T._assureShader(J,"Blur"),{direction:[0,1],texSize:[p,u],radius:H}),t.blitScreen(C,k.texture,T._assureShader(J,"Blur"),{direction:[1,0],texSize:[S,d],radius:H}),t.blitScreen(L,C.texture,T._assureShader(J,"Blur"),{direction:[0,1],texSize:[S,d],radius:H}),V.apply({enabled:!0}),q.setViewport(J,a[0],a[1],a[2],a[3]),t.blitScreen(null,T._renderTarget.texture,T._assureShader(J,"BlendTogether"),{edgeTexture1:k.texture,edgeTexture2:L.texture,edgeStrength:l*H,edgeGlow:B},{clear:!1}),V.apply({func:[J.SRC_ALPHA,J.ONE_MINUS_SRC_ALPHA,J.ONE,J.ONE_MINUS_SRC_ALPHA]}),w.enabled=R,gp(J,W)},resetProperties:function(){this.mode=pk.Mode.Style,this.type=x["highlight.type"],this.color=x["highlight.color"],this.width=x["highlight.width"],this.glow=x["highlight.glow"],this.strength=x["highlight.strength"]},contextLost:function(){this._renderTarget=null}}),b.defineProperties(pk.prototype,{mode:{get:function(){return this._mode},set:function(s){var N=this._mode;if(s!==N){this._mode=s;var q=N===pk.Mode.MouseOver||N===pk.Mode.Style,P=s===pk.Mode.MouseOver||s===pk.Mode.Style;P&&q||(q&&I(this.gv.getView(),"mousemove",this.onMouseOver),P&&f(this.gv.getView(),"mousemove",this.onMouseOver))}}}}),pk.CommonShaderVs=["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),pk.HighlightHard={fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},pk.EdgeDetection={fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","uniform vec2 texSize;","uniform vec4 color;","void main() {","vec2 invSize = 1.0 / texSize;","vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);","vec4 c1 = texture2D( image, vUv + uvOffset.xy);","vec4 c2 = texture2D( image, vUv - uvOffset.xy);","vec4 c3 = texture2D( image, vUv + uvOffset.yw);","vec4 c4 = texture2D( image, vUv - uvOffset.yw);","float diff1 = (c1.r - c2.r)*0.5;","float diff2 = (c3.r - c4.r)*0.5;","float d = length( vec2(diff1, diff2) );","gl_FragColor = color * vec4(d);","}"].join("\n")},pk.Blur={fs:["#define MAX_RADIUS 4","precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform vec2 texSize;","uniform vec2 direction;","uniform float radius;","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float weightSum = gaussianPdf(0.0, radius);","vec4 diffuseSum = texture2D( image, vUv) * weightSum;","vec2 delta = direction * invSize * radius/float(MAX_RADIUS);","vec2 uvOffset = delta;","for( int i = 1; i <= MAX_RADIUS; i ++ ) {","float w = gaussianPdf(uvOffset.x, radius);","vec4 sample1 = texture2D( image, vUv + uvOffset);","vec4 sample2 = texture2D( image, vUv - uvOffset);","diffuseSum += ((sample1 + sample2) * w);","weightSum += (2.0 * w);","uvOffset += delta;","}","gl_FragColor = diffuseSum/weightSum;","}"].join("\n")},pk.BlendTogether={fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform sampler2D edgeTexture1;","uniform sampler2D edgeTexture2;","uniform float edgeStrength;","uniform float edgeGlow;","void main() {","vec4 edgeValue1 = texture2D(edgeTexture1, vUv);","vec4 edgeValue2 = texture2D(edgeTexture2, vUv);","vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;","float vv = texture2D(image, vUv).r;","vec4 finalColor = edgeStrength * vv * edgeValue;","gl_FragColor = finalColor;","}"].join("\n")};
var Kr=A.Light=function(){ud(Kr,this),this.s(tr,x[tr]),this.s(lp,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};Mf("Light",Qh,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(o,K,_){Kr.superClass.onStyleChanged.apply(this,arguments),o===tr&&this.s("shape3d.color",_)}});var Ds=Fr.FrameState=function(F,L){this.renderState=El.for(L),this.picking=!1,this.envmapReflectivity=.5,this.cameraPosition=r,this.projectMatrix=r,this.viewMatrix=r,this.view=F,this.defaultProgram=r,this.pickColorMap=r,this._pvStack=[],this._renderStateStack=[]};Ds.prototype.savePV=function(){var J=this.view;this._pvStack.push([bg(this.projectMatrix),bg(this.viewMatrix),J._18Q,bg(J._7O)])},Ds.prototype.restorePV=function(){var K=this._pvStack.pop();if(K){var o=this.view;this.projectMatrix=o._projectMatrix=K[0],this.viewMatrix=o._viewMatrix=K[1],o._18Q=K[2],o._7O=K[3]}},Ds.prototype.setPV=function(g,u){var v=this.view,s=!1;if(g&&(this.projectMatrix=v._projectMatrix=g,s=!0),u&&(this.viewMatrix=v._viewMatrix=u,v._7O=bg(u),s=!0),s){var J=v.getWidth(),r=v.getHeight(),X=bg(this.projectMatrix);v._18Q=fm(X,X,u),v._18Q._wh=J/r}},Ds.prototype.syncEnv=function(Q){var r=this,U=r.view;r.envmapReflectivity=U._envmapReflectivity||.5,r.cameraPosition=U.getEye(),r.projectMatrix=U._projectMatrix,r.viewMatrix=U._viewMatrix,r.pickColorMap=Q,r.picking=U.getGL()._picking},Ds.prototype.setGLState=function(){var l=[0,0,0,0],H=[!0,!0,!0,!0],R=[-1,1],v=[Jk.FUNC_ADD,Jk.FUNC_ADD],g=[Jk.SRC_ALPHA,Jk.ONE_MINUS_SRC_ALPHA,Jk.ONE,Jk.ONE_MINUS_SRC_ALPHA];return function(y,k){var P=this,o=P.renderState.gl,f=P.renderState.glState;f.dither=!1,k?f.color.mask=H:f.color.reset(),f.pixelStore.reset(),f.blend.color=l,f.blend.equation=v,f.blend.func=g,f.cullFace.enabled=!1,f.scissor.enabled=!1,f.depth.enabled=!0,f.depth.clear=1,f.depth.func=o.LEQUAL,f.depth.range=R,f.stencil.enabled=!1,f.polygonOffset.enabled=!1,y?(f.depth.mask=!1,f.blend.enabled=!0):(f.depth.mask=!0,f.blend.enabled=!1)}}(),Ds.prototype.setUniforms=function(X){var A=this,D=A.view,C=A.renderState,W=C.gl,S=C.uniforms;S.uBrightness=1,S.uOpacity=1,S.uPartOpacity=1,S.uPick=A.picking,S.uUseInstance=!1,S.uTexture=!1,S.uBlendTexture=!1,S.uAlphaTest=x.alphaTest,S.uTransparent=!!X,S.uFix=!1,S.uBatchColor=!1,S.uBatchBlend=!1,S.uBatchBrightness=!1,S.uReflectivity=A.envmapReflectivity||.5,S.uCameraPosition=A.cameraPosition,S.uPMatrix=A.projectMatrix,S.uViewMatrix=A.viewMatrix,S.uEnvMap=null,qj(D,S,Ak),S.uClipperMatrix=D._boxClipperMatrixes,S.uClipperClipInner=D._boxClipperClipInner,S.uEnvmapQuat=D._envmapExtraQuaternion,D._envmapRenderer.resetUniformCache(),A.picking||(Uj(D,W,r),D._fogDisabled||(S.uFogColor=D._fogColor,S.uFogDensity=D._fogDensity,S.uFogNear=D._fogNear,S.uFogFar=D._fogFar))},Ds.prototype.drawLayer=function(w){return this.view.renderLayers(w,!0)},Ds.prototype.drawData=function(h,d,z){var _=this.view;if(_.isVisible(h)){var S=this.renderState,N=S.uniforms,u=_.getData3dUI(h);if(u){var i=S.gl,t=i._picking,c=_._picking,p=u._pickId;z&&(u._pickId=z),N.uPick=i._picking=_._picking=!!z,N.uTransparent=!!d,u._42(S.gl,S.program,d?U:q),N.uPick=i._picking=t,_._picking=c,u._pickId=p}}};var Es=Fr.Graph3dView=function(S,M){var Q=this;Q.resetHeadlightProperties(),Q.resetFogProperties(),Q._webGLVersion=1,Q._attributes=M||u.graph3dViewAttributes,Q._25I={},Q._view=Ar(1,Q);var y;Q._attributes&&(y=Q._attributes.canvas)||(y=qc(Q._view)),Q._canvas=y,f(y,"webglcontextlost",function(w){w.preventDefault(),Cf(Q),Q._26I&&(Q._doBufferGC(Q._26I,!0),Kc(Q._canvas,0,0),["_highlightHelper","shadowMap","flowMap","_envmapRenderer","_postProcessing"].forEach(function(B){Q[B].contextLost()}),Q.dm().each(function(o){var P=Q.getData3dUI(o);P.contextLost()})),Q._26I=$,Q._1o.onContextLost(),Q._35O=!0}),f(y,"webglcontextrestored",function(){Q._35O=!1,Q.iv()}),Q._40Q=new Ls(Q),Q._43Q={},Q._44Q=-1,Q._batchIndexMap={},Q._batchModelMap={},Q._wireframeIndexMap={},Q._wireframeModelMap={},Q._wireframeIndexMapSwap={},Q._wireframeModelMapSwap={},Q._polylineIndexMap={},Q._polylineIndexMap={},Q._polylineIndexMapSwap={},Q._polylineIndexMapSwap={},Q._8O=[],Q._7O=Kl(),Q._6O=Kl(),Q._1o=new Vs(Q),Q._30O=new Ys(Q),Q._31O=new Ws(Q),Q._32O=new Xs(Q),Q._raycaster=new ht(Q),Q._highlightHelper=new pk(Q),Q._postProcessing=new rt(Q),Q._41Q=[],Q._42Q=0,Q._frameRenderOptionStack=[],Fr.VR?(Q.vr=new Fr.VR(Q),Q.isVREnabled=function(){return this.vr.enable},Q.isVRPresenting=function(){return this.vr.isPresenting()}):(Q.vr={enable:!1,isPresenting:a},Q.isVREnabled=a,Q.isVRPresenting=a),Q.shadowMap=new bb(Q),Q.flowMap=new Me(Q),Q._33Q=!0,Q._eye=Bf(u.graph3dViewEye),Q._center=Bf(u.graph3dViewCenter),Q._up=Bf(u.graph3dViewUp),Q._lightChanged=!1,Q._59O=[],Q._spots=[],Q._dirs=[],Q._boxClippers=[],Q._flowObjects=[],Q._frameId=0,Q._picking=!1,Q._batchInfoMap={},Q.overlappingBox=new lc(Q),Q.dm(S?S:new Or),Q._coreInteractor=new Wh(this),Q._envmapRenderer=new Fr.EnvmapRenderer(this),Q.setInteractors([new Os(Q)]),Q._initView(),Q._genBatchInstancedArrayFunc()},Fs={fogDisabled:1,fogMode:1,dashDisabled:1,batchColorDisabled:1,batchInstancedDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,flowBlendMode:1,uvClipEnabled:1,ortho:1},Gs={box:1,sphere:2},Hs={addRGB:"FLOW_BLEND_MODE_ADD_RGB",addRGBA:"FLOW_BLEND_MODE_ADD_RGBA",overrideRGBA:"FLOW_BLEND_MODE_OVERRIDE_RGBA",overrideRGB:"FLOW_BLEND_MODE_OVERRIDE_RGB",overrideA:"FLOW_BLEND_MODE_OVERRIDE_A",multiplyRGB:"FLOW_BLEND_MODE_MULTIPLY_RGB",multiplyRGBA:"FLOW_BLEND_MODE_MULTIPLY_RGBA"},Is=0;Kd("Graph3dView",b,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_shadow:1,ms_highlight:1,ms_quickVisible:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",Xe,mh,"firstPersonMode",Vn,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightDirection","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","headlightGroup","ortho","orthoWidth","syncEyeWithOrthoWidth","fovy","near","far",Np,eo,"up","aspect","fogDisabled","fogMode","fogDensity","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","uvClipEnabled","batchColorDisabled","batchInstancedDisabled","batchBlendDisabled","batchBrightnessDisabled","flowBlendMode","hoverDelay","batchInfoMap","rotateMinPhi","rotateMaxPhi","sortable","sortFunc"],_editable:!1,_sortable:u.graph3dViewSortable,_editHelperDisabled:u.graph3dViewEditHelperDisabled,_blockSelectable:u.graph3dViewBlockSelectable,_devicePixelRatio:r,_boundaries:r,_moveStep:u.graph3dViewMoveStep,_rotateStep:u.graph3dViewRotateStep,_rotateMinPhi:u.graph3dViewMinPhi===r?u.graph3dViewRotateMinPhi:u.graph3dViewMinPhi,_rotateMaxPhi:u.graph3dViewMaxPhi===r?u.graph3dViewRotateMaxPhi:u.graph3dViewMaxPhi,_pannable:u.graph3dViewPannable,_rotatable:u.graph3dViewRotatable,_walkable:u.graph3dViewWalkable,_resettable:u.graph3dViewResettable,_zoomable:u.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:u.graph3dViewFirstPersonMode,_mouseRoamable:u.graph3dViewMouseRoamable,_gridVisible:u.graph3dViewGridVisible,_gridSize:u.graph3dViewGridSize,_gridGap:u.graph3dViewGridGap,_gridColor:u.graph3dViewGridColor,_originAxisVisible:u.graph3dViewOriginAxisVisible,_centerAxisVisible:u.graph3dViewCenterAxisVisible,_axisXColor:u.graph3dViewAxisXColor,_axisYColor:u.graph3dViewAxisYColor,_axisZColor:u.graph3dViewAxisZColor,_ortho:u.graph3dViewOrtho,_orthoWidth:u.graph3dViewOrthoWidth,_syncEyeWithOrthoWidth:u.graph3dViewSyncEyeWithOrthoWidth,_fovy:u.graph3dViewFovy,_near:u.graph3dViewNear,_far:u.graph3dViewFar,_rectSelectable:u.graph3dViewRectSelectable,_rectSelectBackground:u.graph3dViewRectSelectBackground,_editSizeColor:u.graph3dViewEditSizeColor,_autoMakeVisible:Rc,_pickerResolution:u.graph3dViewPickerResolution,_dashDisabled:u.graph3dViewDashDisabled,_uvClipEnabled:u.graph3dViewUvClipEnabled,_batchColorDisabled:u.graph3dViewBatchColorDisabled,_batchInstancedDisabled:u.graph3dViewBatchInstancedDisabled,_batchBlendDisabled:u.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:u.graph3dViewBatchBrightnessDisabled,_flowBlendMode:u.graph3dViewFlowBlendMode,addCamera:function(J){var I=this,m=b.freeze({id:I._42Q++,priority:J.priority||0,ignoreInPick:!!J.ignoreInPick,render:J.render});J.switch3DStatus&&(I._43Q[m.id]=!0),I._41Q.push(m),I._41Q.sort(function(u,S){return u.priority!==S.priority?u.priority-S.priority:u.id-S.id})},setEye:function(F,B,K){1===arguments.length&&(B=F[1],K=F[2],F=F[0]);var t=this._eye;t[0]=F,t[1]=B,t[2]=K,this.fp(Np,$,t)},setCenter:function(z,Q,R){1===arguments.length&&(Q=z[1],R=z[2],z=z[0]);var O=this._center;O[0]=z,O[1]=Q,O[2]=R,this.fp(eo,$,O)},setUp:function(b,c,_){1===arguments.length&&(c=b[1],_=b[2],b=b[0]);var M=this._up;M[0]=b,M[1]=c,M[2]=_,this.fp("up",$,M)},getDevicePixelRatio:function(){return this._picking?this._1o._resolution:this._devicePixelRatio||Fd},isTransparentMask:function(X){return X.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var d=this,I=d._aspect;return I?I:(I=d.getWidth()/d.getHeight(),I||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(Y){var K=this,F=K._dataModel,l=K._selectionModel;F!==Y&&(F&&(F.ump(K.handleDataModelPropertyChange,K),F.umm(K.handleDataModelChange,K),F.umd(K.handleDataPropertyChange,K),l||F.sm().ums(K.handleSelectionChange,K)),K._dataModel=Y,Y.mp(K.handleDataModelPropertyChange,K),Y.mm(K.handleDataModelChange,K),Y.md(K.handleDataPropertyChange,K),l?l._21I(Y):Y.sm().ms(K.handleSelectionChange,K),K._postProcessing.handleDataModleChange(F,Y),K._tryInvalidateEnvmap(),K.invalidateAll(!0),K.invalidateLight(),K.invalidateboxClipper(),K.invalidateFlowObjects(),K._49Q(),K.fp(Xm,F,Y),K._canvas.style.background=Y.getBackground()||"")},handleDataModelPropertyChange:function(w){var H=w.property;if("background"===H){var p=this._canvas.style.background,t=w.newValue||"";this._canvas.style.background=t,this.fp("canvasBackground",p,t)}else if("envmapType"===H)this._tryInvalidateEnvmap();else if("envmap"===H){var p=this._shaderUseEnvmapFlag,t=!(!w.newValue||!w.newValue.length);p!==t&&Cf(this),this.iv()}},handleDataPropertyChange:function(H){var M=H.data;this.invalidateData(M);var A=H.property;Dr(M)&&"s:light.type"===A?this.invalidateLight():"s:3d.clipbox"===A?this.invalidateboxClipper(M,!0):"s:effect.flow"===A?this.invalidateFlowObjects(M,!0):"s:shadow.cast"===A?this.shadowMap.tryUpdateBounding(M):"s:3d.visible"===A&&this.invalidateQuickVisible(M)},invalidateboxClipper:function(p,Z){var Y=this._boxClippers,v=Y.length;if(p){var d=!!p.s("3d.clipbox");if(Z=!!Z,d===Z)Y.indexOf(p)<0&&Y.push(p);else{var x=Y.indexOf(p);x>=0&&Y.splice(x,1)}}else Y=this._boxClippers=[],this.dm().each(function(t){t.s("3d.clipbox")&&Y.push(t)});var H=Y.length;v!==H&&(Cf(this),this.shadowMap.deleteShadowProgram(),this._updateBoxClipperMatrix(),qj=H?Ej:rg),this.iv()},_updateBoxClipperMatrix:function(){for(var J,n,g=this._boxClippers,T=this._boxClipperMatrixes=[],w=this._boxClipperClipInner=[],z=this._boxClipperGroups=[],r=this._boxClipperShape=[],X=new Sn,l=0,j=g.length;j>l;l++)J=g[l],J.appendAnchorMatrix3d(n=Zi(J,this.getMat(J))),T.push(X.getInverse(X.fromArray(n)).toArray()),w.push("inner"===J.s("3d.clipbox")),z.push(J.s("3d.clipbox.group")),r.push(Gs[J.s("3d.clipbox.shape")]||1)},_49Q:function(){this._4AQ||this._48Q||this.dm().size()<u.graph3dViewDataNumWarningLine||(this._48Q=!0,console.log("Too many datas so than disable some feature to speed up.\nYou can set global Default.graph3dViewDataNumWarningLine to largeEnoughNum to avoid this, or call graph3dView.quitDataNumWarning() to quit.\n"),this.enableQuickVisibleMode(),this.getHighlightHelper().mouseOverData=null)},quitDataNumWarning:function(){this.disableQuickVisibleMode(),this._48Q=!1,this._4AQ=!0},invalidateFlowObjects:function(O,L){var x=this._flowObjects,g=x.length;if(O){var t=!!O.s("effect.flow");if(L=!!L,t===L)x.indexOf(O)<0&&x.push(O);else{var b=x.indexOf(O);b>=0&&x.splice(b,1)}}else x=this._flowObjects=[],this.dm().each(function(k){k.s("effect.flow")&&x.push(k)});g!==x.length&&Cf(this),this.iv()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(s){var A=this,q=s.property;if(A.iv(),A._18Q=$,"eye"===q)A._33Q=!0;else if("devicePixelRatio"===q)A._42(A.getDevicePixelRatio());else if(Fs[q]&&(Cf(A),"batchInstancedDisabled"===q)){A._genBatchInstancedArrayFunc();var J,M=u.getBatchInfoMap();for(J in M)M[J]&&M[J].instanced&&A.invalidateBatch(J);M=A._batchInfoMap;for(J in M)M[J]&&M[J].instanced&&A.invalidateBatch(J)}},_5O:function(H){var E=H._22Q();return E?new E(this,H):$},getData3dUI:function(w){var i=this._25I[w._id];return i===r&&(i=this._5O(w),this._25I[w._id]=i),i},invalidateAll:function(t,y){var $=this;if(t){for(var m in $._25I){var F=$._25I[m];F&&F.dispose()}$._25I={},$.iv(),As($)}else As($),$.dm().each(function(H){$.invalidateData(H)});$.shadowMap.tryInvalidateLater(t,y)},invalidateSelection:function(){var $=this;$.sm().each(function(e){$.invalidateData(e)})},invalidateData:function($){var E=this,J=E.getData3dUI($);J&&(J.iv(),E.iv()),As(E,$)},getShape3dText:function(r){return r.getStyle("shape3d.text")||this.getLabel(r)},invalidateBatch:function(z){var D=this,k=D._40Q;k.each(function(F){D._invalidateBatch(z,F.batchModelMap,F.batchIndexMap),D._invalidateBatch("T"+z,F.wireframeModelMap,F.wireframeIndexMap),D._invalidateBatch("O"+z,F.wireframeModelMap,F.wireframeIndexMap),F.markBatchInvalid()}),D.iv()},_invalidateBatch:function(N,b,z){var R=this,j=b[N];j&&(j.ds.forEach(function($){var g=R.getData3dUI($);g&&g.iv(),delete z[$._id]}),delete b[N])},handleDataModelChange:function(D){var U=this,w=D.kind,z=D.data;if("add"===w)U.invalidateData(z),Sl(z)&&z.getEdgeGroup()&&z.getEdgeGroup().eachSiblingEdge(U.invalidateData,U),Dr(z)&&U.invalidateLight(),z.s("3d.clipbox")&&U.invalidateboxClipper(z,!0),z.s("effect.flow")&&U.invalidateFlowObjects(z,!0),U._49Q();else if(w===Vc){var _=z._id,C=U._25I[_];C&&(C.dispose(),delete U._25I[_],U.iv()),z===U._currentSubGraph&&U.setCurrentSubGraph($),As(U,z),Dr(z)&&U.invalidateLight(),z.s("3d.clipbox")&&U.invalidateboxClipper(z,!1),z.s("effect.flow")&&U.invalidateFlowObjects(z,!1)}else w===vo&&(U.invalidateAll(!0),U.setCurrentSubGraph($),As(U),U.invalidateLight(),U.invalidateboxClipper(),U.invalidateFlowObjects())},toCanvas:function(l,T,U){var W=this,g=W.getGL();if(W.validate(),l){var E=g.getParameter(g.COLOR_CLEAR_VALUE);gp(g,l)}W._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var n=W.getWidth()||1,D=W.getHeight()||1,V=new Uint8Array(4*n*D),G=qc(),e=G.getContext("2d");g.readPixels(0,0,n,D,g.RGBA,g.UNSIGNED_BYTE,V),Kc(G,n,D,1);for(var F=e.getImageData(0,0,n,D),z=F.data,_=0;_<z.length;_+=4){var j=_/4,q=M(j/n),t=j-q*n;j=4*((D-1-q)*n+t),z[j]=V[_],z[j+1]=V[_+1],z[j+2]=V[_+2],z[j+3]=V[_+3]}if(e.putImageData(F,0,0),l&&gp(g,E),W._42(W.getDevicePixelRatio()),T&&U){var a=qc(),R=a.getContext("2d");return Kc(a,T,U,1),u.drawImage(R,G,0,0,T,U),a}return G},toDataURL:function(z,J){var S=this,Q=S.getGL();if(S.validate(),z){var j=Q.getParameter(Q.COLOR_CLEAR_VALUE);gp(Q,z)}S._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var c=S._canvas.toDataURL(J||"image/png",1);return z&&gp(Q,j),S._42(S.getDevicePixelRatio()),c},isWebGL2:function(){return 2===this._webGLVersion},getGL:function(){var m=this._26I;if(m)return this.acquireProgram(),m;if(!this._35O){var g=this,M=g._canvas,a=g._attributes;if(!a||a.requestWebGL2!==!1)try{m=M.getContext("webgl2",a)||M.getContext("experimental-webgl2",a),m&&(g._webGLVersion=2,g._26I=m)}catch(F){}if(!m)try{m=M.getContext("webgl",a)||M.getContext("experimental-webgl",a)}catch(F){throw new Error("WebGL not supported")}if(!m)throw new Error("WebGL not supported");g._26I=m;var i=g._frameState=new Ds(this,m);g._glExtensions=new Y(m),g._glCapabilities=new V(m,g._glExtensions),g._2O={},m._emptyCubeTexture=sd(m),m._compiledShader={},m._emptyTexture=Vf(m),m._emptyBlendTexture=Vf(m),m._bufPool={},m._id=++Is,m._divisorState=[],i.setGLState(),g._buffer={vs:xp(m),ns:xp(m),is:xp(m),uv:xp(m),batchColor:xp(m),batchBlend:xp(m),batchBrightness:xp(m),lineDistance:xp(m)},g._1O=gs(m);var n=g._cube={vs:xp(m),ns:xp(m),is:xp(m),uv:xp(m)};return Km(m,n.vs,yr),Km(m,n.ns,Th),Km(m,n.uv,Pg),jf(m,n.is,Bl),g.acquireProgram(),g._genBatchInstancedArrayFunc(),m._renderInfo={calls:0,vertices:0,faces:0,lines:0,points:0,textureCache:{time:0,count:0,pixels:0},frame:0,cacheTimeCost:0,reflectDepth:0},m}},getGLCapabilities:function(){var M=this.getGL();return M?this._glCapabilities:void 0},getGLExtensions:function(){var n=this.getGL();return n?this._glExtensions:void 0},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<u.graph3dEnvmapCapabilityRequire?null:this.dm().getEnvmap()},getEnvmapType:function(){var h,l=this.dm();return l&&(h=l.getEnvmapType()),h||"legacy"},setEnvmapExtraQuaternion:function(Z){var K=this._envmapExtraQuaternion;this._envmapExtraQuaternion=Z instanceof ke.Quaternion?Z.clone().inverse().toArray():null,null==K!=(null==Z)&&Cf(this)},invalidateEnvmap:function(b){return this._envmapRenderer.invalidateEnvmap(b)},_setEnvmapByProbeId:function(l,C){return this._envmapRenderer.setEnvmapByProbeId(l,C)},_tryInvalidateEnvmap:function(){var A=this.getEnvmapType();A!==this._lastProgramEnvmapType&&(Cf(this),this.iv())},acquireProgram:function(){var Y=this,W=Y._26I;if(W&&!Y._prg){var B=Y._prg=W.createProgram();if(!B)return $;var z=Y._dirs.length,M=Y._spots.length,w=Y._59O.length,j=Y._boxClippers.length,l=Y._flowObjects.length,d=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uUvMatrix","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogDensity","uFogNear","uFogFar"];z&&d.push("uDirColor","uDirDirection"),M&&d.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),w&&d.push("uPointColor","uPointRange","uPointPosition"),rm||(Fc=Yk(Fc.substring(0,Fc.indexOf("^#"))),Fq=Yk(Fq),rm=!0);var p=Y.getEnvmap(),T=p&&p.length,h=Y.getEnvmapType(),U=["#define MAX_DIR "+z,"#define MAX_SPOT "+M,"#define MAX_POINT "+w,"#define MAX_BOX_CLIPPER "+j,"#define MAX_FLOW_OBJECT "+l,Y._fogDisabled?"":"#define FOG","exp2"===Y.getFogMode()?"#define FOG_EXP2":"",Y._dashDisabled?"":"#define DASH",Y._uvClipEnabled?"#define UV_CLIP":"",null==Y._envmapExtraQuaternion?"":"#define ENVMAP_ROTATE",T?"#define USE_ENVMAP":"","legacy"!==h?"#define ENVMAP_TYPE_CUBE_UV":"",Y.isOrtho()?"#define ORTHOGRAPHIC":"",Y._batchColorDisabled?"":"#define BATCHCOLOR",Y._batchInstancedDisabled?"":"#define BATCHINSTANCE",Y._batchBlendDisabled?"":"#define BATCHBLEND",Y._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS","#define "+(Hs[Y.getFlowBlendMode()]||Hs[u.graph3dViewFlowBlendMode]),Y.shadowMap.enable?Y.shadowMap.genShaderDefine():"",""].join("\n"),J=Nn(W,B,W.VERTEX_SHADER,Fc.replace("#PREFIX",U));W.getShaderParameter(J,W.COMPILE_STATUS)||Pl("COMPILE",W.VERTEX_SHADER,W.getError(),W.getShaderInfoLog(J));var S=Nn(W,B,W.FRAGMENT_SHADER,Fq.replace("#PREFIX",U));if(W.getShaderParameter(S,W.COMPILE_STATUS)||Pl("COMPILE",W.FRAGMENT_SHADER,W.getError(),W.getShaderInfoLog(S)),yo?d.push("aPosition"):(B.aPosition=0,W.bindAttribLocation(B,0,"aPosition")),W.linkProgram(B),!W.getProgramParameter(B,W.LINK_STATUS)){var C=W.getProgramInfoLog(B);return Y._prg=$,C.indexOf("maximum temp register")>=0&&!Y._glTempRegisterLimited?(Y._glTempRegisterLimited=!0,W.deleteProgram(B),Y.acquireProgram()):(Pl("LINK",W.getProgramParameter(B,W.VALIDATE_STATUS),W.getError(),C),W.deleteProgram(B),$)}d.forEach(function(o){B[o]=/^u/.test(o)?W.getUniformLocation(B,o):W.getAttribLocation(B,o)});var s=Y._frameState;s.renderState.program=s.defaultProgram=B,Y._envmapRenderer.changeEnvmapType(Y._lastProgramEnvmapType=h),Y._shaderUseEnvmapFlag=T,W.deleteShader(J),W.deleteShader(S)}},isGLTempRegisterLimited:function(){return this._glTempRegisterLimited},getBrightness:function(y){var d=y.s("brightness"),p=this.isSelected(y)?y.s("select.brightness"):$;return d==$?p:p==$?d:d*p},getDataHighlightMode:function(A){return A.s("highlight.mode")},getWireframe:function(P){var n=P.s("wf.visible"),_=P.s("wf.width");return n===!0||_>0&&"selected"===n&&this.isSelected(P)?{color:P.s("wf.color"),width:_,"short":P.s("wf.short"),mat:P.s("wf.mat")}:void 0},_transformPointToViewSpace:function(C){var q=[C[0],C[1],C[2]];return Vk(q,this._viewMatrix),q},_transformDirectionToViewSpace:function(q,J){var v=q?[q[0],q[1],q[2]]:[0,0,0];Vk(v,this._viewMatrix);var s=J?[J[0],J[1],J[2]]:[0,0,0];Vk(s,this._viewMatrix);var Z=s[0]-v[0],V=s[1]-v[1],T=s[2]-v[2],e=Math.sqrt(Z*Z+V*V+T*T);return e?[Z/e,V/e,T/e]:[Z,V,T]},getWireframeGeometry:function(K){return K.s("wf.geometry")?{color:K.s("wf.color"),width:K.s("wf.width"),mat:K.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(Z){return Z.s("body.color")},getMat:function(V){return V.getMat?V.getMat():V.s("mat")},getFaceMat:function(g,m){return g.getFaceMat?g.getFaceMat(m):g.s(m+".mat")},getFaceBlend:function(g,W){return g.s(W+".blend")||g.s("all.blend")},getFaceColor:function(K,G){return K.s(G+".color")||K.s("all.color")},getFaceImage:function(r,d){return r.s(d+".image")||r.s("all.image")},getFaceBlendImage:function(E,d){return E.s(d+".blend.image")||E.s("all.blend.image")},getFaceDiscardSelectable:function(h,U){var u=h.s(U+".discard.selectable");return u==$?h.s("all.discard.selectable"):u},getFaceUv:function(Q,y){return Q.s(y+".uv")||Q.s("all.uv")},getFaceUvOffset:function(G,o){return G.s(o+".uv.offset")||G.s("all.uv.offset")},getFaceUvScale:function(B,x){return B.s(x+".uv.scale")||B.s("all.uv.scale")},getFaceUvRotation:function(S,B){return S.s(B+".uv.rotation")||S.s("all.uv.rotation")},getFaceUvAnchor:function(V,l){return V.s(l+".uv.anchor")||V.s("all.uv.anchor")},getFaceLight:function(f,P){var o=f.s(P+".light");return o==$?f.s("all.light"):o},getFaceVisible:function(z,y){var r=z.s(y+".visible");return r==$?z.s("all.visible"):r},getFaceOpacity:function(m,E){var O=m.s(E+".opacity");return O==$?m.s("all.opacity"):O},getFaceTransparent:function(r,P){var s=r.s(P+".transparent");return s==$?r.s("all.transparent"):s},getFaceReverseColor:function(T,_){return T.s(_+".reverse.color")||T.s("all.reverse.color")},getFaceReverseFlip:function(z,D){var Q=z.s(D+".reverse.flip");return Q==$?z.s("all.reverse.flip"):Q},getFaceReverseCull:function(n,M){var I=n.s(M+".reverse.cull");return I==$?n.s("all.reverse.cull"):I},getTextureMap:function(){return this._2O},_2Oi:function(N,o,x){x=x||"";var Q;(Q=this._2O[N])||(Q=this._2O[N]={}),Q[x]=o},deleteTexture:function(w){var $=this;if($._2O){var I=$._2O[w];if(I){delete $._2O[w];var j=$.getGL();for(var m in I)j.deleteTexture(I[m])}}},renderPickScene:function(){var R=this.getGL();this.syncRenderState(),this._picking=R._picking=!0,this.renderScene(),this._picking=R._picking=!1},invalidateCachedTexture:function(Y){var p=this.getData3dUI(Y);p.invalidateCachedTexture(this.getGL()),this.invalidateData(Y)},invalidateShape3dCachedImage:function(C){this.invalidateCachedTexture(C)},invalidateCachedGeometry:function(Q){var t=this.getData3dUI(Q);t.invalidateCachedGeometry(),this.invalidateData(Q)},isInteractive:function(l){return l.s("interactive")},getTexture:function(H,M,o,D){if(!H)return $;var e,c,k=this,d=k.getGL(),j=k._2O[H];if(j&&(M&&(c=M.s("texture.mipmap.max")),e=j[c||""]||j.default),!e){var p=Of(H);if(D||(D={}),!p)return d._emptyTexture;if(M){D.mipmapMaxLevel=c=M.s("texture.mipmap.max");var b=M.s("texture.wrap");D.clampToEdge="clampToEdge"===b?!0:"repeat"===b?!1:r}if(p.uuid||(p.uuid=A.Math.generateUUID()),p.tagName){if(p.dynamic)return gs(d,p,k._1O,D);e=gs(d,p,r,D),k._2Oi(H,e,c)}else{var z,m=M&&(M.s("texture.cache")||M.s("shape3d.image.cache")||p.textureCache),Z=k.isVRPresenting();if(Z&&(M._textureUpdateFrame===d._renderInfo.frame?m=!0:M._textureUpdateFrame=d._renderInfo.frame),m&&(z=k.getData3dUI(M),e=z.getCachedTexture(o),e&&z.interactiveInfo&&e.interactiveInfo&&(z.interactiveInfo[e.interactiveInfo.key]=e.interactiveInfo.info)),!e){var G=d._renderInfo.textureCache;if(m){if(G.time>u.graph3dMaxVectorCacheTime)return k.redraw(),d._emptyTexture;if(!Bg(p,M))return d._emptyTexture}var n;M&&(1!==M.s("texture.scale")?n=M.s("texture.scale"):1!==M.s("shape3d.texture.scale")&&(n=M.s("shape3d.texture.scale"))),n||(n=1);var t=M&&(M.s("fixSizeOnScreen")||M.s("shape3d.fixSizeOnScreen")),R=t?d.NEAREST:d.LINEAR;t?"number"==typeof t&&(n*=0>t?1:t):M&&(M.s("vector.dynamic")||M.s("shape3d.vector.dynamic"))&&(z||(z=k.getData3dUI(M)),t=z.getVectorDynamicSize());var q,F,v,S=M&&M.s("shape3d");"billboard"===S?v=M.getTall()/M.getWidth():"plane"===S&&(v=M.getHeight()/M.getWidth());var w=Hn(p,M);if(t){var x;x=m?k._devicePixelRatio||Fd:k.getDevicePixelRatio(),q=t[0]>0?t[0]*x:n*w*x,F=t[1]>0?t[1]*x:n*(v?ks(p,M,k,Math.min(4096,w*v)):ks(p,M))*x}else q=n*w,F=n*(v?ks(p,M,k,Math.min(4096,w*v)):ks(p,M));if(q>=1&&F>=1){var g=0;(m||Z)&&(g=Date.now());var i=k._glCapabilities.maxTextureSize;q=Math.min(q,i),F=Math.min(F,i);var Q=Ap(q,F);if(!z&&M&&(z=k.getData3dUI(M)),z&&z.interactiveInfo){var E=H;"object"==typeof E&&(E=E.uuid||(E.uuid=A.Math.generateUUID()));var U=z.interactiveInfo[E]={};Q.interactiveInfo=U.bodyInfo={compInfos:[],matrix:new Nb,rect:{x:0,y:0,width:q,height:F}}}zm(Q,p,0,0,q,F,M,k),Q.interactiveInfo&&(Q.interactiveInfo=null),Q.restore(),G.count++,G.pixels+=q*F,M?(D.minFilter=$r(M.s("texture.filter.min")||M.s("texture.filter"))||R,D.magFilter=$r(M.s("texture.filter.mag")||M.s("texture.filter"))||R):D.minFilter=D.magFilter=R,m||Z?(e=gs(d,bk,null,D),z.setCachedTexture(e,o),G.time+=Date.now()-g,U&&(e.interactiveInfo={key:E,info:U}),bk=null):e=gs(d,bk,k._1O,D)}}}}return e},redraw:function(){this.iv()},validateImpl:function(){var X=this;if(X._lightChanged){X._lightChanged=!1;var t=[],b=[],f=[];X.dm().each(function(x){if(Dr(x)){var P=x.s("light.type");P===uj?t.push(x):P===Ql?b.push(x):P===cq&&f.push(x)}}),(t.length!==X._59O.length||b.length!==X._spots.length||f.length!==X._dirs.length)&&Cf(X),X._59O=t,X._spots=b,X._dirs=f}var n=X.getAspect();n!==X.__cachedAspect__&&(X._updateSkybox({property:"asceptChanged"}),X.__cachedAspect__=n),X._42(),X._1o.iv()},getRenderInfo:function(){var r=this.getGL();return r?r._renderInfo:void 0},getDebugTip:function(){var y=this,T=y.getRenderInfo();if(T){var e=y.getGL()._validBufCount||0,G="Draw Calls: "+T.calls+"<br/>"+"Vertices: "+T.vertices+"<br/>"+"Faces: "+T.faces+"<br/>"+"Lines: "+T.lines+"<br/>"+(T.points?"Points: "+T.points+"<br/>":"")+"Buffers: "+e+"<br/>"+"Cache Models: "+b.keys(Fp).length+"<br/>"+"Shape3d Models: "+b.keys(us).length;if(y.isVRPresenting()&&(G+="<br/>VR fps: "+y.vr.getFps()),T.textureCache){var j=T.textureCache.count;if(G+="<br/>2D Dynamic Textures: "+T.textureCache.count,j>0){var _,D=T.textureCache.pixels;_=D>1e6?Math.round(D/1e6)+"M":D>1e3?Math.round(D/1e3)+"K":Math.round(D),G+="<br/>2D Dynamic pixels: "+_}}return G}},getFrameState:function(){return this._frameState},isBoundingBoxInView:function(){var T=new A.Math.Box3,k=new A.Math.Matrix4;return function(J){var C=J;if(C instanceof A.Data&&(C=this.getData3dUI(C)),!C.mat)return!0;var i=C.getBoundingBox();T.copy(i).applyMatrix4(k.fromArray(C.mat));var B=this.getFrustum();return B.intersectsBox(T)}}(),updateScene:function(){var h=this;h._81O=$,h.overlappingBox.clear();var W=h._40Q;W.init();var V=h.getGL(),k=h.dm();if(k.isHierarchicalRendering())k.eachByHierarchical(function(p){var M=h.getData3dUI(p);M&&M.update(h,V,W)});else{var T,D,N,i=k.getDatas().getArray(),G=i.length;for(T=0;G>T;T++)D=i[T],N=h.getData3dUI(D),N&&N.update(h,V,W)}this._updateBoxClipperMatrix(),W.onUpdated()},_pushFrameRenderOptions:function(H){this._frameRenderOptionStack.push(this._currentFrameRenderOptions),this._currentFrameRenderOptions=H},_popFrameRenderOptions:function(){this._currentFrameRenderOptions=this._frameRenderOptionStack.pop()},_getFrameRenderOptions:function(H){var B=this._currentFrameRenderOptions;return B&&B[H]},getRenderLists:function(){return this._40Q},renderScene:function(d){function g(b,O){Z.setGLState(b,O),Z.setUniforms(b),Z.renderState.attribs.disable(),y=e.directUniforms(),w=e.directAttribs(),w.disable()}function L(K){for(var u=!1;x>m;m++){var O=V[m];if(!U||!O.ignoreInPick){if(O.priority>=K)break;(!M._43Q[M._44Q=O.id]||Rn[vl.length])&&(O.render(n,M,Z),g(),u=!0)}}return u}var M=this;M._pushFrameRenderOptions(d),M._getFrameRenderOptions("createShadowMap")!==!1&&M.shadowMap.render(),M.flowMap.render();var n=M.getGL();M._envmapRenderer.onBeforeRender(n),M._44Q=-1;var y,w,Z=M._frameState,e=Z.renderState,P=e.glState,G=M._prg;M._projectMatrix=Ck(M),ro(M,M._7O),M._viewMatrix=bg(M._7O),M.isReflecting(n)||fm(M._projScreenMatrix=Kl(),M._projectMatrix,M._viewMatrix),Z.syncEnv(this._picking?this.pickColorMap:r),e.useProgram(G),g(!1,!0),n.clear(n.DEPTH_BUFFER_BIT);var U=M._picking,V=this._41Q,m=0,x=V.length;if(L(u.cameraPriority.skybox),U){var I=P.color.clear.slice(0);gp(n,[0,0,0,0])}else gp(n,[0,0,0,0]),P.blend.enabled=!1,P.depth.enabled=!1,P.depth.mask=!1,M._camera&&M._camera.s("camera.renderSky")===!1||M.drawSky(n,G),M._getFrameRenderOptions("renderReflector")!==!1&&M.drawReflectors(n)&&(M._projectMatrix=Ck(M),ro(M,M._7O),M._viewMatrix=bg(M._7O),Z.syncEnv(),g()),P.blend.enabled=!1,P.depth.enabled=!0,P.depth.mask=!0,y.uTransparent=!1,M._getFrameRenderOptions("renderGrid")!==!1&&M._31O._42(n,G);if(!n.textureBatch||Rn[(ONE_FRAME_TIME-6)/2]){U||(M.shadowMap.enable&&M.shadowMap.createShadow(y),M.flowMap.createFlow(y));for(var R=0,p=Gk.length;p>R;R++){var o=Gk[R],B=mg[o];if(!(!M._camera&&B.ignore||M._camera&&!M._camera.isLayerVisible(o))){var N=B.priority;L(N)&&(U||(M.shadowMap.enable&&M.shadowMap.createShadow(y),M.flowMap.createFlow(y))),this.renderLayer(o)}}L(u.cameraPriority.infinity),U||M.flowMap.disableFlow(y),xs(M,y,0,u.graph3dViewHeadlightAmbientIntensity),y.uHeadlightColor=[1,1,1,0],y.uUseEnvMap=!1,y.uHeadlightDirection=[0,0,0],y.uHeadlightRange=0,P.depth.enabled=!1,y.uTransparent=!1,y.shadowReceive=!1,qj(M,y,Ak),U?M.drawFilter||M._30O._42(n,G):(M._highlightHelper._42(n,G),this._renderAxisAndEditHelper(M._getFrameRenderOptions("renderAxis")!==!1,M._getFrameRenderOptions("renderEdit")!==!1),P.blend.enabled=!1,P.depth.mask=!0),P.depth.enabled=!0,U&&gp(n,I),Km(n,$),jf(n,$),M._44Q=-1,M._popFrameRenderOptions(null)}},_renderAxisAndEditHelper:function(T,u){if(T||u){var G=this,W=G.getGL(),L=G._prg,n=G._frameState,F=n.renderState,r=F.glState,R=F.directUniforms();n.renderState.attribs.disable(),r.depth.enabled=!1,R.uTransparent=!1,R.shadowReceive=!1,r.blend.enabled=!1,r.depth.mask=!0,R.uPick=G._picking;var a=!G._fogDisabled;a&&(R.uFog=!1),T&&G._32O._42(W,L),u&&G._30O._42(W,L),a&&(R.uFog=!0),Km(W,$),jf(W,$)}},renderLayers:function(q,P){P&&(q=bi(q));for(var l=0,Y=q.length;Y>l;l++)this.renderLayer(q[l])},renderSky:function(){var r=this,n=r._frameState,D=n.renderState,C=D.glState,S=r.getGL(),J=r._prg;r._projectMatrix=Ck(r),ro(r,r._7O),r._viewMatrix=bg(r._7O),fm(r._projScreenMatrix=Kl(),r._projectMatrix,r._viewMatrix),n.syncEnv(),D.useProgram(J),n.setGLState(!1,!0),n.setUniforms(!1),n.renderState.attribs.disable(),S.clear(S.DEPTH_BUFFER_BIT),gp(S,[0,0,0,0]),C.blend.enabled=!1,C.depth.enabled=!1,C.depth.mask=!1,r.drawSky(S,J),C.depth.mask=!0,C.depth.enabled=!0,Km(S,$),jf(S,$)
},addRenderLayerListener:function(k,a,o){var q=this;q._renderLayerNotifier||(q._renderLayerNotifier=new lm),q._renderLayerNotifier.add(k,a,o)},removeRenderLayerListener:function(I,T){this._renderLayerNotifier&&this._renderLayerNotifier.remove(I,T)},fireRenderLayerEvent:function(u,Y){var z=this._renderLayerNotifier;z&&z.fire({layer:u,phase:Y})},renderLayer:function(L){var E=this,r=E._picking,p=E._40Q.get(L);if(p){E.fireRenderLayerEvent(L,"prepare");var K=E.getGL(),f=mg[L],S=E._frameState,X=S.renderState,G=X.glState,y=X.directUniforms();!r&&E.isSortable()&&p.sort(E._sortFunc,E._projScreenMatrix);var W,v,l,u=p.opaque,R=p.transparent,A=p.batchModelMap,h=p.polylineModelMap,B=p.wireframeModelMap,K=E.getGL(),m=E._prg;r||(G.blend.enabled=!1,G.depth.enabled=!0,G.depth.mask=!0),y.uTransparent=!1,f.clearDepth!==!1&&K.clear(K.DEPTH_BUFFER_BIT);var M=this.drawFilter;if(M)for(l=u,W=0,v=l.length;v>W;W++)M(l[W].data)!==!0&&l[W].ui._42(K,m,q);else{for(l=u,W=0,v=l.length;v>W;W++)l[W].ui._42(K,m,q);if(r)for(l=R,W=0,v=l.length;v>W;W++)l[W].ui._46Q(K);xk(E,A),Hk(E,h),Hk(E,B)}if(r||(G.blend.enabled=!0,G.depth.mask=!1),E._45Q=y.uTransparent=!0,M)for(l=R,W=0,v=l.length;v>W;W++)M(l[W].data)!==!0&&l[W].ui._42(K,m,U);else{for(l=R,W=0,v=l.length;v>W;W++)l[W].ui._42(K,m,U);xk(E,A,null,!0),Hk(E,h,null,!0),Hk(E,B,null,!0)}E._45Q=null,E.fireRenderLayerEvent(L,"post")}},_42:function(B,d){var q=this;if(!q._35O&&(!Pd||Rn(Pd))){var y=q.getWidth(),I=q.getHeight();if(y&&I){var e=q.getGL();if(e){var D,k=q._canvas;if(B?D=!0:B=q.getDevicePixelRatio(),!q._picking&&(D||y!==k.clientWidth||I!==k.clientHeight)){Kc(k,y,I,B);var r=B;y&&Math.abs(e.drawingBufferWidth-y*B)>1&&(r=Math.min(r,e.drawingBufferWidth/y)),I&&Math.abs(e.drawingBufferHeight-I*B)>1&&(r=Math.min(r,e.drawingBufferHeight/I)),r!==B&&(q.setDevicePixelRatio(B=r),Kc(k,y,I,B)),q._18Q=null}e.clear(e.COLOR_BUFFER_BIT);var f=e._renderInfo;f.calls=0,f.vertices=0,f.faces=0,f.lines=0,f.points=0,f.textureCache={time:0,count:0,pixels:0},f.frame=++q._frameId,f.cacheTimeCost=0,f.reflectDepth=0,y*=B,I*=B,this.syncRenderState();do{if(q.isVREnabled()&&q.vr.render(e,y,I,d))break;if(q.updateScene(),q._postProcessing.render(e,y,I,d))break;q.setViewport(e,0,0,y,I),q.renderScene(d)}while(!1);q._33Q=!1,q.countFrame(),q._doBufferGC(e)}}}},syncRenderState:function(){var Q,Z;(Q=this._frameState)&&(Z=Q.renderState)&&Z.syncLoss()},drawReflectors:function(F){F._renderInfo.reflectDepth++;var E,a,j,p=this,g=p._dataModel.getReflectors(),v=!1;for(E in g)a=g[E],p.isVisible(a)&&(j=p.getData3dUI(a),j&&j.drawReflector&&j.drawReflector(F)&&(v=!0));return F._renderInfo.reflectDepth--,v},isReflecting:function(k){return k._renderInfo.reflectDepth},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(A,V){return this._postProcessing.enableModule(A,V)},getPostProcessingModule:function(V){return this._postProcessing.getModule(V)},getPostProcessingValue:function(J,m){var t=this._postProcessing.getModule(J);return t?t[m]:r},setPostProcessingValue:function(i,W,o){var f=this.getPostProcessingValue(i,W),n=this._postProcessing.getModule(i);n&&f!==o&&("enable"===W?this.enablePostProcessing(i,o):n[W]=o,this.firePropertyChange("postProcessing."+i+"."+W,f,o))},setDofImageFromGraphView:function(T,b,h){return this._postProcessing.getModule("Dof").setImageFromGraphView(T,b,h)},setViewport:function(C,X,G,Y,v){this._viewport=[X,G,Y,v],El.for(C).directState().viewport=this._viewport},getRenderState:function(){return El.for(this._26I)},getViewport:function(){return this._viewport},setBufferGCInterval:function(X){this._bufferGCInterval=X},_doBufferGC:function(S,t){var b,x,P=S._bufPool,o=0,Q=0,g=S._renderInfo.frame,C=this._bufferGCInterval||10;for(b in P)o++,x=P[b],x&&(t||g-x._fid>C?(S.deleteBuffer(x._buf),x._buf=null,P[b]=null):Q++);if(o/2>Q&&o>128){var N={};for(b in P)P[b]&&(N[b]=P[b]);S._bufPool=N}S._validBufCount=Q},_swapLineMap:function(){var h=this;Ui=h._polylineModelMap,h._polylineModelMap=h._polylineModelMapSwap,h._polylineModelMapSwap=Ui,Ui=h._wireframeModelMap,h._wireframeModelMap=h._wireframeModelMapSwap,h._wireframeModelMapSwap=Ui,Ui=h._polylineIndexMap,h._polylineIndexMap=h._polylineIndexMapSwap,h._polylineIndexMapSwap=Ui,Ui=h._wireframeIndexMap,h._wireframeIndexMap=h._wireframeIndexMapSwap,h._wireframeIndexMapSwap=Ui},_updateSkybox:function(Y){if(this._skybox&&Y){var M=Y.property,g=!1,V=this._skybox;if("eye"===M||"forceUpdate"===M){var Q=this._eye;V.p3(Q[0],Q[1],Q[2]),g=!0}if("near"===M||"far"===M||"forceUpdate"===M||"asceptChanged"===M){var x=V.__cachedS3__;x||(x=V.__cachedS3__=V.getFinalScale3d());var R=Math.sqrt(3),G=1/0,A=-1/0;x.forEach(function(J){J/=2,G=O(J,G),A=E(J,A)}),A*=R;var X=this._near,q=this._far,J=Math.tan(this.getFovy()/2)*X,k=this.getAspect()*J,_=1.1*Math.sqrt(k*k+J*J+X*X),j=1;if(_>G)j=_/G;else if(A>=q){var m=q*q/(X+q);j=m/A}if(1!==j){V.__updatingSkybox__=!0;var L=x.map(function(l){return j*l});V.s3(L),V.setScale3d(1,1,1),g=!0,delete V.__updatingSkybox__}}g&&this.invalidateData(V)}},getSkyBox:function(){return this.getSkybox()},setSkyBox:function(_){return this.setSkybox(_)},getSkybox:function(){return this._skybox},setSkybox:function(Q){var c=this._skybox;if(c===Q)return Q&&this._updateSkybox({property:"forceUpdate"}),void 0;if(c&&(this._skyboxStyleMap&&c.setStyleMap(this._skyboxStyleMap),this._skyboxStyleMap=null,this._skyboxAnchor3d&&c.setAnchor3d(this._skyboxAnchor3d),this._skyboxAnchor3d=null,this._skyboxP3&&c.p3(this._skyboxP3),this._skyboxP3=null,this.handleDataModelChange({kind:Vc,data:c})),this._skybox=Q,this.ump(this._updateSkybox,this),Q){Q.dm()&&Q.dm().remove(Q),this._skyboxStyleMap=A.Default.clone(Q.getStyleMap()),this._skyboxAnchor3d=Q.getAnchor3d(),Q.setAnchor3d(.5,.5,.5),this._skyboxP3=Q.p3().slice(0),Q.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1});var G=Q.onPropertyChanged;Q.onPropertyChanged=function(t){G.call(Q,t),!Q.__updatingSkybox__&&["width","height","tall","scale","scaleTall"].indexOf(t.property)>=0&&(Q.__cachedS3__=r)},this.mp(this._updateSkybox,this),this._updateSkybox({property:"forceUpdate"})}this.fp("skybox",c,Q)},drawSky:function(Z,X){var a=this,m=a._skybox;if(m){var h=El.for(Z).directUniforms(),B=a._headlightIntensity,e=th(a._headlightColor),X=a._prg;1!==B&&(e=[e[0]*B,e[1]*B,e[2]*B]),h.uHeadlightColor=[e[0],e[1],e[2],1];var T=a.getData3dUI(m);if(T){var p=a.isOrtho(),N=p||this._computedProjectMatrix;if(N){var x=a._projectMatrix;p&&(a._ortho=!1),h.uPMatrix=a._projectMatrix=Ck(a,!0)}var G=m.p3(),I=this.getEye();(G[0]!==I[0]||G[1]!==I[1]||G[2]!==I[2])&&(m._position.x=I[0],m._54O=I[1],m._position.y=I[2]),T.validate(),T._42(Z,X,Q),N&&(p&&(a._ortho=!0),h.uPMatrix=a._projectMatrix=x)}Z.clear(Z.DEPTH_BUFFER_BIT),h.uHeadlightColor=[e[0],e[1],e[2],a._headlightDisabled?1:0]}},getLogicalPoint:function(i){return Xr(i,this._canvas)},isRectOverlapping:function(E){var t=this.getData3dUI(E);return t._rectOverlapping},getHitFaceInfo:function(W){W.target&&(W=this.lp(W));var f=this.getDataInfoAt(W);if(f){var c=this.intersectObject(W,f.data);if(c)return{data:f.data,face:c.part}}return $},unproject:function(u,X){var y=this,m=y.getWidth(),H=y.getHeight(),x=u.target?y.lp(u):u,P=x.x-m/2,r=x.y-H/2,k=2*(P/m),F=2*(-1*r/H);X=X||0;var h=Kl(),T=Ck(y),l=ro(y);fm(h,T,l),Ed(h);var g=Zh([k,F,X,1],h);return[g[0]/g[3],g[1]/g[3],g[2]/g[3]]},getDataAt:function(f){var T=this.getDataInfoAt(f);return T?T.data:$},getDataInfoAt:function(p,j,X){return p.target&&(p=this.lp(p)),this._1o.get(Vl(p.x,p.y,j),!0,X)},getDatasInRect:function(S,D){return this._1o.get(S,!1,D)},setEditable:function(A){var k=this,w=k._editable;k._editable=A,this.fp(ql,w,A)},isEditable:function(D){var z=this;return D?z._editable?Dk(D)?D.s("3d.editable")?z._editableFunc?z._editableFunc(D):!0:!1:!1:!1:z._editable},isSelectable:function(l){return l.s("3d.selectable")&&this.sm().isSelectable(l)},isMovable:function(v){var p=this;return Sl(v)&&v.getStyle(uf)!==no?!1:v.s("3d.movable")?p._movableFunc?p._movableFunc(v):!0:!1},isSizeEditable:function(A){return Dk(A)?this._sizeEditableFunc?this._sizeEditableFunc(A):!0:!1},isRotationEditable:function(w){return Dk(w)&&w.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(w):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(r){this.setZoom($e,r)},zoomOut:function(L){this.setZoom(1/$e,L)},setZoom:function(){var w=new hb,L=new hb,Q=new hb,G=new hb;return function(u,M){if(1!==u){var R=this;R._14o&&R._14o.stop(!0);var m,V=1/u;w.copy(R.getCenter()),L.copy(R.getEye());var y=R._ortho;if(y){if(m=R._orthoWidth,m<R._moveStep&&u>1)return}else if(w.distanceTo(L)<R._moveStep&&1>V)return;var g=!1;return R._zoomToCenter===!1&&R._lastZoomLP&&(Q.copy(L).sub(w).normalize(),R._81O=null,G.copy(R.getHitPosition(R._lastZoomLP,w.toArray(),Q.toArray())),g=!0,R._lastZoomHit=G),(M=pr(M))?(M.action=function(C){R.fi({kind:R._zooming?"betweenZoom":"beginZoom"}),R._zooming=1;var E=(V-1)*C+1;y&&R.setOrthoWidth(m*E),g?(R.setEye(Q.lerpVectors(G,L,E).toArray()),R.setCenter(Q.lerpVectors(G,w,E).toArray())):y||R.setEye(Q.lerpVectors(w,L,E).toArray())},M._37o=function(){delete R._14o,delete R._zooming,R.fi({kind:"endZoom"}),R.onZoomEnded()},R._14o=ce(M)):(y&&R.setOrthoWidth(m*V),g?(R.setEye(Q.lerpVectors(G,L,V).toArray()),R.setCenter(Q.lerpVectors(G,w,V).toArray())):y||R.setEye(Q.lerpVectors(w,L,V).toArray()),void 0)}}}(),setOrthoZoom:function(U,B){return this.setZoom(U,B)},getPositionInfo:function(n){var G=this,M=G._eye,A=G._center,_=G.getAspect(),q=n?Jn(Ur(A,M,!0),Ur(n,M)):Kj(M,A);if(G._ortho){var J=G._orthoWidth;return{length:q,height:J/_,width:J}}var H=2*Hb(G._fovy/2)*q;return{length:q,height:H,width:H*_}},getCenterInfo:function(){var P=this;return P._81O||(P._81O=P.getPositionInfo()),Bf(P._81O)},rotate:function(Y,H,z,q){var f=this;if(Y||H){q==$&&(q=f._firstPersonMode),f._88O&&f._88O.stop(!0);var T=f._center,x=f._eye,B=f.getCenterInfo().length,t=q?T:x,Q=q?x:T,S=Ur(t,Q),a=ys(S[0],S[2]),G=ys(_(S[0]*S[0]+S[2]*S[2]),S[1]),u=q?eo:Np;return q&&(H=-H),(z=pr(z))?(z.action=function(K){f.fi({kind:f._rotating?"betweenRotate":"beginRotate"}),f._rotating=1;var J=a+Y*K,F=G+H*K;F=q?Z-So(f,Z-F):So(f,F),S[0]=B*X(F)*X(J),S[1]=B*m(F),S[2]=B*X(F)*m(J),t[0]=Q[0]+S[0],t[1]=Q[1]+S[1],t[2]=Q[2]+S[2],f.fp(u,$,t)},z._37o=function(){delete f._88O,delete f._rotating,f.fi({kind:"endRotate"}),f.onRotateEnded()},f._88O=ce(z)):(a+=Y,G+=H,G=q?Z-So(f,Z-G):So(f,G),S[0]=B*X(G)*X(a),S[1]=B*m(G),S[2]=B*X(G)*m(a),t[0]=Q[0]+S[0],t[1]=Q[1]+S[1],t[2]=Q[2]+S[2],f.fp(u,$,t),void 0)}},pan:function(U,j,k,f){if(U||j){var z=this;f==$&&(f=z._firstPersonMode),z._89O&&z._89O.stop(!0);var I=ro(z),s=[I[0]*U,I[4]*U,I[8]*U],w=[I[1]*j,I[5]*j,I[9]*j],t=s[0]+w[0],n=s[1]+w[1],v=s[2]+w[2],F=z._center,m=z._eye;if(f){var q=Ai(z.getBoundaries(),m[0],m[2],m[0]+t,m[2]+v,_(t*t+v*v));t=q[0],v=q[1]}if(k=pr(k)){var O=Bf(m),Q=Bf(F);return k.action=function(Y){z.fi({kind:z._panning?"betweenPan":"beginPan"}),z._panning=1,F[0]=Q[0]+t*Y,F[1]=Q[1]+n*Y,F[2]=Q[2]+v*Y,m[0]=O[0]+t*Y,m[1]=O[1]+n*Y,m[2]=O[2]+v*Y,z.fp(Np,$,m),z.fp(eo,$,F)},k._37o=function(){delete z._89O,delete z._panning,z.fi({kind:"endPan"}),z.onPanEnded()},z._89O=ce(k)}F[0]+=t,F[1]+=n,F[2]+=v,m[0]+=t,m[1]+=n,m[2]+=v,z.fp(Np,$,m),z.fp(eo,$,F)}},walk:function(Q,b,z){if(Q){var i=this;z==$&&(z=i._firstPersonMode),i._90O&&i._90O.stop(!0);var S=i._center,f=i._eye,y=Ur(S,f,!0);if(z){var A=Ai(i.getBoundaries(),f[0],f[2],f[0]+y[0]*Q,f[2]+y[2]*Q,k(Q));if(Q=Kj(A),!Q)return;y=[A[0]/Q,0,A[1]/Q]}if(b=pr(b)){var N=Bf(f),s=Bf(S);return b.action=function(Y){i.fi({kind:i._walking?"betweenWalk":"beginWalk"}),i._walking=1;var Z=Q*Y;f[0]=N[0]+y[0]*Z,f[1]=N[1]+y[1]*Z,f[2]=N[2]+y[2]*Z,S[0]=s[0]+y[0]*Z,S[1]=s[1]+y[1]*Z,S[2]=s[2]+y[2]*Z,i.fp(Np,$,f),i.fp(eo,$,S)},b._37o=function(){delete i._90O,delete i._walking,i.fi({kind:"endWalk"}),i.onWalkEnded()},i._90O=ce(b)}f[0]+=y[0]*Q,f[1]+=y[1]*Q,f[2]+=y[2]*Q,S[0]+=y[0]*Q,S[1]+=y[1]*Q,S[2]+=y[2]*Q,i.fp(Np,$,f),i.fp(eo,$,S)}},handleScroll:function(b,o){Mm(b);var j=this,C=j._moveStep,r=j.getDataInfoAt(b);if(r){var $=r.data;if($&&j.isInteractive($)){var y=j.intersectObject(b,$);if(y){var v=y.part,Q=Of($.s(v+".image")||$.s("shape3d."+v+".image")||$.s("all.image")||$.s("shape3d.image"));if(Q&&Tp(Q.scrollable,$,j))return}}}return j.isFirstPersonMode()?(j.isPannable()&&j.pan(0,o>0?C:-C),void 0):(j.isZoomable()&&(j._lastZoomLP=j.lp(b),j.setZoom(0>o?1/_n:_n),j._lastZoomLP=j._lastZoomHit=null),void 0)},handlePinch:function(d,K){if(this.isZoomable()){if(Math.abs(d-K)<u.pinchZoomThreshold)return;this.setZoom(K>d?1/Hp:Hp)}},reset:function(X){this.setUp(u.graph3dViewUp),this.moveCamera(u.graph3dViewEye,u.graph3dViewCenter,X)},moveSelection:function(w,f,O){var B=this;B.dm().beginTransaction(),xq(this.sm().toSelection(this.isMovable,this),w,f,O),B.dm().endTransaction()},getMoveMode:function(l,X){var G=X.s("3d.move.mode");if(G)return G;var I="88",Q="89",p="90";return Ng(l)||gc[I]&&gc[Q]&&gc[p]?"xyz":gc[I]&&gc[Q]?"xy":gc[I]&&gc[p]?"xz":gc[Q]&&gc[p]?"yz":gc[I]?"x":gc[Q]?"y":gc[p]?"z":"xz"},handleTick:function(){var _=this,e=!1,c=_._moveStep,j=c,G=!1,d=!0,R=_._rotateStep*(d?-1:1);if(_.isWalkable()||(j=0),_.isPannable()||(c=0),_.isRotatable()||(R=0),_._32Q){var w=(ei()-_._32Q)/50;j*=w,c*=w,R*=w}_._31Q&&(os(_._31Q),delete _._31Q,delete _._32Q),Li()&&(e=!0,_.pan(-c,0,G,d)),zg()&&(e=!0,_.pan(c,0,G,d)),xi()&&(e=!0,Ng()?_.pan(0,c,G,d):_.walk(j,G,d)),Ve()&&(e=!0,Ng()?_.pan(0,-c,G,d):_.walk(-j,G,d)),$b()&&(e=!0,_.rotate(-R,0,G,d)),mr()&&(e=!0,_.rotate(R,0,G,d)),Wc()&&(e=!0,_.rotate(0,-R/2,G,d)),Td()&&(e=!0,_.rotate(0,R/2,G,d)),e&&(_._32Q=ei(),_._31Q=Qi(_.handleTick,_))},handleKeyDown:function(k){var t=this;!ao(k)&&jn[k.keyCode]?t.handleTick():Qf(k)?t.selectAll():oc(k)?t.handleDelete(k):An(k)&&this.isResettable()&&t.reset()},checkDoubleClickOnNote:function(D,j,y){var N=this;if(y===sf){if(j.s("note.toggleable"))return j.s(Kg,!j.s(Kg)),N.fi({kind:"toggleNote",event:D,data:j,part:y}),!0}else if(y===_b&&j.s("note2.toggleable"))return j.s(qi,!j.s(qi)),N.fi({kind:"toggleNote2",event:D,data:j,part:y}),!0;return!1},checkDoubleClickOnRotation:function(o,F,i){return i===at?(F.setRotationX(0),!0):i===bt?(F.setRotationY(0),!0):i===ct?(F.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(j){var X=this;if(X.isOrtho())return X.getWidth()/X.getOrthoWidth();var P=X.getCenter(),M=X.getHeight(),v=X.getEye(),x=[P[0]-v[0],P[1]-v[1],P[2]-v[2]],c=[j[0]-v[0],j[1]-v[1],j[2]-v[2]],Y=Math.sqrt(x[0]*x[0]+x[1]*x[1]+x[2]*x[2]),s=1/Math.tan(X.getFovy()/2);return M*Y*s/(c[0]*x[0]+c[1]*x[1]+c[2]*x[2])},inViewSpace:function(s){var V,W=this,Q=W._transformPointToViewSpace(s),D=W.getAspect(),k=W.getNear(),F=W.getFar();return-Q[2]<k||-Q[2]>F?!1:W.isOrtho()?(V=W.getOrthoWidth()/2,Math.abs(Q[0])<=V&&Math.abs(Q[1]*D)<=V):(V=Math.sqrt(Q[0]*Q[0]+Q[1]*Q[1]+Q[2]*Q[2])*Math.tan(W.getFovy()/2),Math.abs(Q[1]<=V)&&Math.abs(Q[0])<=V*D)},getPVMatrix:function(){var J,T=this;return(J=T._18Q)||(J=Ck(T),T._18Q=fm(J,J,ro(T)),T._18Q._wh=T.getWidth()/2/T.getHeight()),J},getFrustum:function(){var s=new Sn,V=new es,C=new Array(16);return function(){for(var e=this.getPVMatrix(),A=!1,R=0;16>R;R++)e[R]!==C[R]&&(A=!0,C[R]=e[R]);return A&&V.setFromMatrix(s.fromArray(e)),V}}(),toViewPosition:function(A){var g=this,C=g.getWidth()/2,Q=g.getHeight()/2,Y=g.getPVMatrix();return A=Zh([A[0],A[1],A[2],1],Y),{x:C+C*A[0]/A[3],y:Q-Q*A[1]/A[3],z:A[2]/A[3]}},getHitPosition:function(P,S,q){var W=this,h=W.getWidth(),Y=W.getHeight(),G=P.target?W.lp(P):P,E=G.x-h/2,B=G.y-Y/2,r=W.getCenterInfo(),C=ro(W);S=S?S:[0,0,0],q=q?q:[0,1,0],E=E/h*r.width,B=-1*B/Y*r.height;var V=[C[0]*E,C[4]*E,C[8]*E],H=[C[1]*B,C[5]*B,C[9]*B],n=[V[0]+H[0],V[1]+H[1],V[2]+H[2]],l=W.getCenter(),L=tg(W,S,q,[n[0]+l[0],n[1]+l[1],n[2]+l[2]]);return L?L:[0,0,0]},intersectObject:function(c,G){return this._raycaster.intersectObject(c,G)},intersectObjects:function(Y,_,i){return this._raycaster.intersectObjects(Y,_,i)},getLineLength:function(W){this.validate();var s=this.getData3dUI(W);if(s&&s.getCache){var u=s.getCache();if(u)return u[u.length-1].length}return 0},getLineOffset:function(p,C){var G=this.getData3dUI(p);if(G&&G.getCache){var g=G.getCache();if(g){var c=Hl(g,C);if(p.s("shape3d")!==ym)return c;var n,O;if(p.getScale3d&&(n=p.getScale3d(),1===n[0]&&1===n[1]&&1===n[2]&&(n=null)),p.r3&&(O=p.r3(),0===O[0]&&0===O[1]&&0===O[2]&&(O=null)),!O&&!n)return c;var Z=new hb(p.p3()),L=new hb(c.point).sub(Z),x=new hb(c.tangent).add(L);if(n&&(n=new hb(n),L.multiply(n),x.multiply(n)),O){var w=(new Ab).setFromEuler(new Mn(O,p.getRotationMode(),!0));L.applyQuaternion(w),x.applyQuaternion(w)}return{point:L.clone().add(Z),tangent:x.sub(L).normalize()}}}return $},_genBatchInstancedArrayFunc:function(){var s=this._glCapabilities&&this._glCapabilities.instancedArray&&!this._batchInstancedDisabled,M=s?Lo:Bn;this.batchInstancedModel=function(Z,O,U,n,$,C,p){M(this,Z,O,U,n,$,C,p)};var t=s?Dn:eq;this.batchInstancedShapeFace=function(a,$,J){t(a,$,J)};var b=s?fo:Ue;this.batchInstancedFace=function(H,i,h,n,U){b(this,H,i,h,n,U)}},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(t,s,V){var y=this,P=y.getEye();P=[P[0],P[1],P[2]];var e=y.getCenter();if(e=[e[0],e[1],e[2]],t||(t=P),s||(s=e),y._flyAnim&&y._flyAnim.stop(!0),V=pr(V),!V)return y.setEye(t[0],t[1],t[2]),y.setCenter(s[0],s[1],s[2]),delete y._flyAnim,!0;var U=[t[0]-P[0],t[1]-P[1],t[2]-P[2]],Y=[s[0]-e[0],s[1]-e[1],s[2]-e[2]];return V.action=function(f){y.setCenter(e[0]+Y[0]*f,e[1]+Y[1]*f,e[2]+Y[2]*f),y.setEye(P[0]+U[0]*f,P[1]+U[1]*f,P[2]+U[2]*f)},V._37o=function(){delete y._flyAnim},y._flyAnim=ce(V)},flyTo:function(){function W(I,v,h){if(h instanceof A.Node){Q.fromArray(Zi(h,v.getMat(h)));var e=h.getAnchor3d();I.push((new hb).set(0-e.x,0-e.y,0-e.z).applyMatrix4(Q)),I.push((new hb).set(0-e.x,0-e.y,1-e.z).applyMatrix4(Q)),I.push((new hb).set(0-e.x,1-e.y,0-e.z).applyMatrix4(Q)),I.push((new hb).set(0-e.x,1-e.y,1-e.z).applyMatrix4(Q)),I.push((new hb).set(1-e.x,0-e.y,0-e.z).applyMatrix4(Q)),I.push((new hb).set(1-e.x,0-e.y,1-e.z).applyMatrix4(Q)),I.push((new hb).set(1-e.x,1-e.y,0-e.z).applyMatrix4(Q)),I.push((new hb).set(1-e.x,1-e.y,1-e.z).applyMatrix4(Q))}}var o=new hb,j=new hb,C=new hb,Y=new hb,e=new hb,Q=new Sn,O=new A.Math.Quaternion,d=new Mn,Z=new Pn;return function(v,F,f){var S=this;"boolean"==typeof F&&(F={animation:F}),F=F||{};var $=F.center,x=F.distance,q=F.direction,m=F.worldDirection,V=f||F.ratio||.8,_=F.xRatio||V,I=F.yRatio||V;(f!==r||F.duration||F.frames)&&(F={animation:F});var Q,g,E=[],p=x===r;if($&&C.fromArray($),!$||p)if(v||(v=S.dm().getDatas()),1===v.length&&(v=mj(v)?v.get(0):v[0]),v instanceof A.Node)$||C.fromArray(v.p3()),p&&(W(E,S,v),Q=E.length);else{if(!v.length)return;if((p||!$)&&(E=[],v.forEach(function(y){W(E,S,y)}),Q=E.length,!Q))return;$||(Z.setFromPoints(E),C.copy(Z.min).add(Z.max).multiplyScalar(.5))}if(S._flyAnim&&S._flyAnim.stop(!0),o.fromArray(S.getEye()),j.fromArray(S.getCenter()),S.setCenter(C.x,C.y,C.z),Y.subVectors(o,j),q||m){!m&&v instanceof A.Node?O.setFromEuler(d.set(v.r3(),v.getRotationMode(),!0)):O.set(0,0,0,1);var X=Y.length();Y.fromArray(m||q).applyQuaternion(O).setLength(X)}var H=new hb(S.getUp()),K=ke.fequal(H.x,0,1e-5)&&ke.fequal(H.z,0,1e-5);if(K&&0===Y.x&&0===Y.z){var h=.001,N=Y.y;Y.y=N*(1-h),Y.z=Math.sign(N)*h}var B=0;if(p){var c,s,l,P=_,M=I;if(e.copy(Y),S.isOrtho()){var w=-1/0;for(S._eye[0]=Y.x+C.x,S._eye[1]=Y.y+C.y,S._eye[2]=Y.z+C.z,c=Ck(S),fm(c,c,ro(S)),g=0;Q>g;g++)l=E[g],s=Zh([l.x,l.y,l.z,1],c),w=Math.max(w,Math.max(Math.abs(s[0])/P,Math.abs(s[1])/M));B=S.getOrthoWidth()*w}else{for(var G,a,z=S.getNear(),D=10;D--;){for(S._eye[0]=Y.x+C.x,S._eye[1]=Y.y+C.y,S._eye[2]=Y.z+C.z,c=Ck(S),fm(c,c,ro(S)),G=!0,a=-1/0,g=0;Q>g;g++){if(l=E[g],s=Zh([l.x,l.y,l.z,1],c),s[3]<z&&D){Y.multiplyScalar(2),G=!1;break}a=Math.max(a,Math.max(Math.abs(s[0])/P,Math.abs(s[1])/M)-s[3])}if(G)break}Y.setLength(a+Y.length())}Y.manhattanLength()<1e-6&&Y.copy(e)}else Y.setLength(x);var t=Y.add(C),b=pr(F.animation);if(b){S.setEye(o.x,o.y,o.z),S.setCenter(j.x,j.y,j.z);var J=t.clone().sub(C),R=J.length();R&&J.multiplyScalar(1/R);var y=o.clone().sub(j),k=y.length();k&&y.multiplyScalar(1/k);var T=(new Sn).lookAtDirection(y,H),U=(new Sn).lookAtDirection(J,H),L=(new Ab).setFromRotationMatrix(T),n=(new Ab).setFromRotationMatrix(U),i=(new hb).subVectors(C,j);if(B)var Mq=S.getOrthoWidth();var Pk=new hb,hd=new hb,mh=new hb,xp=b.action,tg=b._37o,Zk=j.clone();return b.action=function(Q,E){hd.copy(Zk).addScaledVector(i,Q);var Z=L.clone().slerp(n,Q);Pk.set(0,0,1).applyQuaternion(Z).setLength(k+(R-k)*Q).add(hd),mh.set(0,1,0).applyQuaternion(Z),S.setCenter(hd.x,hd.y,hd.z),S.setEye(Pk.x,Pk.y,Pk.z),S.setUp(mh.x,mh.y,mh.z),B&&S.setOrthoWidth((B-Mq)*Q+Mq),xp&&xp(Q,E)},b._37o=function(){delete S._flyAnim;var g=S.getUp(),d=K?u.graph3dViewUp:H.toArray();(g[0]!==d[0]||g[1]!==d[1]||g[2]!==d[2])&&S.setUp(d),tg&&tg()},{lastEye:o,lastCenter:j,eye:t,center:C,orthoWidth:B,animation:S._flyAnim=ce(b)}}return S.setEye(t.x,t.y,t.z),S.setCenter(C.x,C.y,C.z),B&&S.setOrthoWidth(B),delete S._flyAnim,{lastEye:o,lastCenter:j,eye:t,center:C,orthoWidth:B}}}(),getBoundingBox:function(){function Q(I,w,u){d.fromArray(Zi(u,w.getMat(u)));var A=u.getAnchor3d();I.push((new hb).set(0-A.x,0-A.y,0-A.z).applyMatrix4(d)),I.push((new hb).set(0-A.x,0-A.y,1-A.z).applyMatrix4(d)),I.push((new hb).set(0-A.x,1-A.y,0-A.z).applyMatrix4(d)),I.push((new hb).set(0-A.x,1-A.y,1-A.z).applyMatrix4(d)),I.push((new hb).set(1-A.x,0-A.y,0-A.z).applyMatrix4(d)),I.push((new hb).set(1-A.x,0-A.y,1-A.z).applyMatrix4(d)),I.push((new hb).set(1-A.x,1-A.y,0-A.z).applyMatrix4(d)),I.push((new hb).set(1-A.x,1-A.y,1-A.z).applyMatrix4(d))}var d=new Sn;return function(k){if(k=k||this.sm().getSelection(),k instanceof A.Node&&(k=[k]),0===k.length)return $;var t=[];k.forEach(function(e){Dk(e)&&Q(t,this,e)},this);var F=[1/0,1/0,1/0],x=[-1/0,-1/0,-1/0];return t.forEach(function(M){F[0]=Math.min(M.x,F[0]),F[1]=Math.min(M.y,F[1]),F[2]=Math.min(M.z,F[2]),x[0]=Math.max(M.x,x[0]),x[1]=Math.max(M.y,x[1]),x[2]=Math.max(M.z,x[2])}),{min:F,max:x}}}(),setBatchInfo:function(A,h){var R=this._batchInfoMap[A];this._batchInfoMap[A]=h,this.fp("batchInfo",R,h)},getBatchInfo:function(s){return this._batchInfoMap[s]||En[s]},setOrthoWidth:function(k){var u=this._orthoWidth;if(this._orthoWidth=k,this._syncEyeWithOrthoWidth){var h=k/this.getAspect(),P=h/2/Hb(this.getFovy()/2),Q=(new hb).fromArray(this.getEye()),j=(new hb).fromArray(this.getCenter());Q.sub(j).setLength(P).add(j),this.setEye(Q.toArray())}this.fp("orthoWidth",u,k)},getCamera:function(V){var u=this;V||(V=u._mainCamera,V||(V=u._mainCamera=new A.Camera)),V.s({"camera.type":u.isOrtho()?"ortho":"perspective","camera.aspect":u.getAspect(),"camera.fovy":u.getFovy(),"camera.ortho.width":u.getOrthoWidth(),"camera.near":u.getNear(),"camera.far":u.getFar()});var I=u.getEye();return V.p3(I.slice()),V.lookAt(u.getCenter(),u.getUp()),V},resetHeadlightProperties:function(){this._headlightColor=u.graph3dViewHeadlightColor,this._headlightIntensity=u.graph3dViewHeadlightIntensity,this._headlightRange=u.graph3dViewHeadlightRange,this._headlightDirection=u.graph3dViewHeadlightDirection,this._headlightGroup=u.graph3dViewHeadlightGroup,this._headlightAmbientIntensity=u.graph3dViewHeadlightAmbientIntensity,this._headlightDisabled=u.graph3dViewHeadlightDisabled},resetFogProperties:function(){this._fogDisabled=u.graph3dViewFogDisabled,this._fogMode=u.graph3dViewFogMode,this._fogDensity=u.graph3dViewFogDensity,this._fogColor=u.graph3dViewFogColor,this._fogNear=u.graph3dViewFogNear,this._fogFar=u.graph3dViewFogFar}}),function(){function F(q,f,S){var e=q[f];e&&e.releaseTexture(),q[f]=S}function U(){return["\n #ifdef ENVMAP_TYPE_CUBE_UV \n","#define cubeUV_maxMipLevel 8.0 \n","#define cubeUV_minMipLevel 4.0 \n","#define cubeUV_maxTileSize 256.0 \n","#define cubeUV_minTileSize 16.0 \n","float getFace(vec3 direction) {","vec3 absDirection = abs(direction);","float face = - 1.0;","if (absDirection.x > absDirection.z) {","if (absDirection.x > absDirection.y)","face = direction.x > 0.0 ? 0.0 : 3.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","} else {","if (absDirection.z > absDirection.y) ","face = direction.z > 0.0 ? 2.0 : 5.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","}","return face;","} ","vec2 getUV(vec3 direction, float face) {","vec2 uv;","if (face == 0.0) {","uv = vec2(direction.z, direction.y) / abs(direction.x);","} else if (face == 1.0) {","uv = vec2(- direction.x, - direction.z) / abs(direction.y);","} else if (face == 2.0) {","uv = vec2(- direction.x, direction.y) / abs(direction.z);","} else if (face == 3.0) {","uv = vec2(- direction.z, direction.y) / abs(direction.x);","} else if (face == 4.0) {","uv = vec2(- direction.x, direction.z) / abs(direction.y);","} else {","uv = vec2(direction.x, direction.y) / abs(direction.z);","}","return 0.5 * (uv + 1.0);","} ","vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {","float face = getFace(direction);","float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);","mipInt = max(mipInt, cubeUV_minMipLevel);","float faceSize = exp2(mipInt);","float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);","vec2 uv = getUV(direction, face) * (faceSize - 1.0);","vec2 f = fract(uv);","uv += 0.5 - f;","if (face > 2.0) {","uv.y += faceSize;","face -= 3.0;","}","uv.x += face * faceSize;","if (mipInt < cubeUV_maxMipLevel) {","uv.y += 2.0 * cubeUV_maxTileSize;","}","uv.y += filterInt * 2.0 * cubeUV_minTileSize;","uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);","uv *= texelSize;","vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x += texelSize;","vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.y += texelSize;","vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x -= texelSize;","vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","vec3 tm = mix(tl, tr, f.x);","vec3 bm = mix(bl, br, f.x);","return mix(tm, bm, f.y);","}","\n #define r0 1.0 \n","#define v0 0.339 \n","#define m0 - 2.0 \n","#define r1 0.8 \n","#define v1 0.276 \n","#define m1 - 1.0 \n","#define r4 0.4 \n","#define v4 0.046 \n","#define m4 2.0 \n","#define r5 0.305 \n","#define v5 0.016 \n","#define m5 3.0 \n","#define r6 0.21 \n","#define v6 0.0038 \n","#define m6 4.0 \n","float roughnessToMip(float roughness) {","float mip = 0.0;","if (roughness >= r1) {","mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;","} else if (roughness >= r4) {","mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;","} else if (roughness >= r5) {","mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;","} else if (roughness >= r6) {","mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;","} else {","mip = - 2.0 * log2(1.16 * roughness);","}","return mip;","} ","vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {","float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);","float mipF = fract(mip);","float mipInt = floor(mip);","vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);","if (mipF == 0.0) {","return vec4(color0, 1.0);","} else {","vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);","return vec4(mix(color0, color1, mipF), 1.0);","}","} ","\n #endif \n"].join("")}function d(){return["vec4 sRGBToLinear( in vec4 value ) {","return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );","}","vec4 LinearTosRGB( in vec4 value ) {","return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );","}","vec4 inputTexelToLinear( vec4 value ) { return sRGBToLinear( value ); }","vec4 linearToOutputTexel( vec4 value ) { return LinearTosRGB( value ); }","vec4 envMapTexelToLinear( vec4 color ) { return inputTexelToLinear( color ); }"].join("")}function S(){return["precision mediump float;\n","precision mediump int;\n","attribute vec3 position;","attribute vec2 uv;","attribute float faceIndex;","varying vec3 vOutputDirection;","vec3 getDirection( vec2 uv, float face ) {","uv = 2.0 * uv - 1.0;","vec3 direction = vec3( uv, 1.0 );","if ( face == 0.0 ) { direction = direction.zyx; } ","else if ( face == 1.0 ) { direction = direction.xzy; direction.xz *= -1.0; } ","else if ( face == 2.0 ) { direction.x *= -1.0; }","else if ( face == 3.0 ) { direction = direction.zyx; direction.xz *= -1.0; } ","else if ( face == 4.0 ) { direction = direction.xzy; direction.xy *= -1.0; } ","else if ( face == 5.0 ) { direction.z *= -1.0; }","return direction;","}","void main() {","vOutputDirection = getDirection( uv, faceIndex );","gl_Position = vec4( position, 1.0 );","}"].join("")}function j(){return{vs:S(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform samplerCube envMap;\n",d(),"\n void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3(- vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function y(){return{vs:S(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform vec2 texelSize;\n",d(),"\n #define RECIPROCAL_PI 0.3183098861837907 \n","\n #define RECIPROCAL_PI2 0.15915494309189535 \n","vec2 equirectUv( in vec3 dir ) {","float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;","float v = 0.5 - asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI;","return vec2( u, v );","}","void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","vec3 outputDirection = normalize( vOutputDirection );","vec2 uv = equirectUv( outputDirection );","vec2 f = fract( uv / texelSize - 0.5 );","uv -= f * texelSize;","vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x += texelSize.x;","vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.y += texelSize.y;","vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x -= texelSize.x;","vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","vec3 tm = mix( tl, tr, f.x );","vec3 bm = mix( bl, br, f.x );","gl_FragColor.rgb = mix( tm, bm, f.y );","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function B(B){return{vs:S(),fs:["precision mediump float;\n","precision mediump int;\n","#define n "+B+"\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform int samples;","uniform float weights[ n ];","uniform bool latitudinal;","uniform float dTheta;","uniform float mipInt;","uniform vec3 poleAxis; \n",d(),"\n #define ENVMAP_TYPE_CUBE_UV \n",U(),"\n vec3 getSample( float theta, vec3 axis ) {","float cosTheta = cos( theta );","vec3 sampleDirection = vOutputDirection * cosTheta + cross(axis, vOutputDirection) * sin(theta) + axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);","return bilinearCubeUV( envMap, sampleDirection, mipInt );","}","void main() {","vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );","if ( all( equal( axis, vec3( 0.0 ) ) ) ) {","axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );","}","axis = normalize( axis );","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );","for ( int i = 1; i < n; i++ ) {","if ( i >= samples ) { break; }","float theta = dTheta * float( i );","gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );","gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );","}","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}var E=Fr.EnvmapRenderer=function(P){this.gv=P,this._envmaps={},this._envmapHash={},this._probeCaptureTime={},this._pingPongRenderTarget=null,this._equirectShader=null,this._cubemapShader=null,this._blurMaterial=null,this._lastCaptureFrame=0
};E.prototype={},E.prototype.constructor=E,E.prototype.changeEnvmapType=function(V){"legacy"===V?(this.setEnvmapByProbeId=this.setEnvmapLegacy,this.onBeforeRender=this.onBeforeRenderLegacy):(this.setEnvmapByProbeId=this.setEnvmap,this.onBeforeRender=this.onBeforeRenderNew)},E.prototype.invalidateEnvmap=function(R){var A=this.gv;if("legacy"!==A.getEnvmapType()){var r=A.getGL();r&&(R?(delete this._envmapHash[R],delete this._probeCaptureTime[R]):(this._envmapHash={},this._probeCaptureTime={}),A.iv())}},E.prototype.contextLost=function(){var x=this;x._envmaps={},x._envmapHash={},x._pingPongRenderTarget=null,x._equirectShader=x._cubemapShader=x._blurMaterial=null,x._envmapLegacy=null,x._lastLegacyImage=null},E.prototype.onBeforeRenderLegacy=function(n){this.assureTextureLegacy(n)},E.prototype.assureTextureLegacy=function(N){var Q=this,L=Q.gv,r=L.getEnvmap();if(r!==Q._lastLegacyImage){if(Q._envmapLegacy&&(N.deleteTexture(Q._envmapLegacy),Q._envmapLegacy=null),!r)return Q._lastLegacyImage=r,void 0;var S=u.getImage(r);if(S&&S.tagName){S=u.resizeImagePOT(S,!0);var _=Q._envmapLegacy=N.createTexture();N.activeTexture(N.TEXTURE0),N.bindTexture(N.TEXTURE_CUBE_MAP,_),N.texParameteri(N.TEXTURE_CUBE_MAP,N.TEXTURE_MAG_FILTER,N.LINEAR),N.texParameteri(N.TEXTURE_CUBE_MAP,N.TEXTURE_MIN_FILTER,N.LINEAR),N.texImage2D(N.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,S),N.texImage2D(N.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,S),N.texImage2D(N.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,S),N.texImage2D(N.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,S),N.texImage2D(N.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,S),N.texImage2D(N.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,S),N.bindTexture(N.TEXTURE_CUBE_MAP,N._emptyCubeTexture),Q._lastLegacyImage=r}}},E.prototype.setEnvmapLegacy=function(a){a.uEnvMap=this._envmapLegacy},E.prototype.onBeforeRenderNew=function(W){this.assureTextureNew(W),this.resetUniformCache()},E.prototype.assureTextureNew=function(Q){var d=this,c=d.gv,P=c.getEnvmap(),D=d._envmapHash,C=d._envmaps,p=Q._renderInfo.frame;if(!(this._lastCaptureFrame>=p||c._picking))for(var f in P){var B,i=P[f],s=i.type;switch(s){case"sphere":B=i.image,B!==D[f]&&(Lk=u.getImage(B),Lk&&(D[f]=B,F(C,f,d.fromEquirectangular(B))));break;case"cube":var w=i.images;if(w&&6===w.length&&(B=w.join(","),B!==D[f])){for(var x=!0,b=0;6>b;b++)if(!u.getImage(w[b])){x=!1;break}x&&(D[f]=B,F(C,f,d.fromCubemap(w)))}break;case"skybox":var W=c.getSkybox();if(W){var X=W.s("shape3d");if(B="sphere"===X?W._id+"_"+W.s("shape3d.image"):W._id+"_"+W.s("front.image"),B!==D[f]){var x;if("sphere"===X)x=u.getImage(W.s("shape3d.image"));else{x=!0;for(var v=["front","back","left","right","top","bottom"],b=0;6>b;b++)if(!u.getImage(W.s(v[b]+".image"))){x=!1;break}}x&&(D[f]=B,F(C,f,d.fromSkybox()))}}break;case"probe":var r=i.pos,o=i.size;if(B=r[0]+"_"+r[1]+"_"+r[2]+"_"+o,B!==D[f]){var L=this._probeCaptureTime[B],M=Date.now();L||(this._probeCaptureTime[B]=L=M),M-L>u.envmapProbeMinWaitTime&&!vd&&!ad||M-L>u.envmapProbeMaxWaitTime?(delete this._probeCaptureTime[B],D[f]=B,F(C,f,d.fromSceneProbe(r,o,i.filter))):c.iv()}}}},E.prototype.resetUniformCache=function(){this._frameUniformCache={}},E.prototype.setEnvmap=function(U,Y){var R=U.uuid,c=this._frameUniformCache,q=this._envmaps[Y];q&&(q=q.texture),c[R]!==q&&(c[R]=q,U.uEnvMap=q)},E.prototype.fromEquirectangular=function(N){var n=A.Default.getImage(N);return this.rectSize=[1/n.width,1/n.height],N=this.gv.getTexture(N),this.fromTexture(N)},E.prototype.fromCubemap=function(h){var c=this.gv.getGL(),C=c.createTexture();c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_CUBE_MAP,C),c.texParameteri(c.TEXTURE_CUBE_MAP,c.TEXTURE_MAG_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_CUBE_MAP,c.TEXTURE_MIN_FILTER,c.LINEAR);for(var f=[],F=v/3,R=0;6>R;R++)f[R]=u.resizeImage(A.Default.getImage(h[R]),F);return c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,f[0]),c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,f[1]),c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,f[2]),c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,f[3]),c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,f[4]),c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,f[5]),c.bindTexture(c.TEXTURE_CUBE_MAP,c._emptyCubeTexture),this.fromTexture(C,!0)},E.prototype.fromTexture=function(Y,m){var R=this._allocateTargets();this._pingPongRenderTarget||(this._pingPongRenderTarget=this._allocateTargets());var x=this.gv,g=x.getGL(),$=El.for(g).directState(),W=$.depth.enabled;$.scissor.enabled=!0,$.depth.enabled=!1;var c=x.getViewport(g);return this._textureToCubeUV(Y,R,m),this._applyPMREM(R),R.unbind(g),x.setViewport(g,c[0],c[1],c[2],c[3]),$.depth.enabled=W,$.scissor.enabled=!1,R},E.prototype.fromSkybox=function(){return this._fromCamera(function(c){c.s({"camera.onlySky":!0})})},E.prototype.fromScene=function(U){return this._fromCamera(function(S){S.s({"camera.onlySky":!1}),U&&U(S)})},E.prototype.fromNode=function(f){var X=this.gv.getData3dUI(f),H=X._42;X._42=rg;var V=this.gv.getSkybox(),g=f.p3();if(V){var n=V.p3();V.p3(g)}var O=this.fromScene(function(k){k.p3(g)});return X._42=H,V&&V.p3(n),O},E.prototype.fromSceneProbe=function(N,R,K){var U=this.gv,Z=U.getSkybox();if(Z){var G=Z.p3();Z.p3(N)}if(K){var l=U.isVisible;U.isVisible=function(X){var $=K(X);return $!==r?$:l.call(U,X)}}var C=this.fromScene(function(s){s.p3(N),s.s("camera.near",R)});return K&&(U.isVisible=l),Z&&Z.p3(G),C},E.prototype._fromCamera=function(c){var h=this.gv,B=h.getCamera();c&&c(B);var C=new Ms(h,v,v,{cube:!0}),F=h.getGL(),L=h.getViewport(F),u=this.setEnvmapByProbeId,g=this.onBeforeRender;this.setEnvmapByProbeId=function(D){D.envMap=F._emptyTexture},this.onBeforeRender=rg,B.attachRenderTarget(C),B.render(h),B.detachRenderTarget(),this.setEnvmapByProbeId=u,this.onBeforeRender=g,h.setViewport(F,L[0],L[1],L[2],L[3]);var M=this.fromTexture(C.texture,!0);return C.releaseTexture(),M},E.prototype._allocateTargets=function(){return new Ms(this.gv,3*e,3*e,{magFilter:Jk.NEAREST,minFilter:Jk.NEAREST})},E.prototype._textureToCubeUV=function(P,c,S){var I,T=this.gv;S?null==(I=this._cubemapShader)&&(this._cubemapShader=I=this.createShader(j())):null==(I=this._equirectShader)&&(this._equirectShader=I=this.createShader(y()));var u=T.getGL();c.bind(u),this._setViewport(c,0,0,3*e,2*e);var K=T.getRenderState();K.useProgram(I);var v=K.directUniforms(),L=K.directAttribs();v.envMap=P,S||(v.texelSize=this.rectSize);var q=l[0];L.position=Nr(u,null,q.vs,$,3),L.uv=Nr(u,null,q.uv,$,2),L.faceIndex=Nr(u,null,q.faceIs,$,1),vb(u,0,q.vs.length/3)},E.prototype._applyPMREM=function(F){for(var w,c,H,w=1;s>w;w++)c=Math.sqrt(X[w]*X[w]-X[w-1]*X[w-1]),H=T[(w-1)%T.length],this._blur(F,w-1,w,c,H)},E.prototype._setViewport=function(x,B,F,u,c){var U=this.gv;U.setViewport(U.getGL(),B,F,u,c),U.getRenderState().directState().scissor.box=[B,F,u,c]},E.prototype._blur=function(W,V,A,D,h){var n=this._pingPongRenderTarget;this._halfBlur(W,n,V,A,D,"latitudinal",h),this._halfBlur(n,W,A,A,D,"longitudinal",h)},E.prototype.createShader=function(w){var m=this.gv;return m.getPostProcessing().createShader(m.getGL(),w).program},E.prototype._halfBlur=function(q,A,T,V,j,Z,w){var b=this.gv,a=this._blurMaterial;if("latitudinal"===Z||"longitudinal"===Z){a||(this._blurMaterial=a=this.createShader(B(O)));var g=b.getGL();A.bind(g);var C=3,f=b.getRenderState();f.useProgram(a);var h,X,H,F=f.directUniforms(),i=f.directAttribs(),M=n[T]-1,I=isFinite(j)?Math.PI/(2*M):2*Math.PI/(2*O-1),R=j/I,Q=isFinite(j)?1+Math.floor(C*R):O,u=[],t=0;for(h=0;O>h;++h)X=h/R,H=Math.exp(-X*X/2),u.push(H),0==h?t+=H:Q>h&&(t+=2*H);for(h=0;h<u.length;h++)u[h]=u[h]/t;F.envMap=q.texture,F.samples=Q,F.weights=u,F.latitudinal="latitudinal"===Z,w&&(F.poleAxis=w),F.dTheta=I,F.mipInt=L-T;var N=n[V],X=3*Math.max(0,e-2*N),m=(0===V?0:2*e)+2*N*(V>L-p?V-L+p:0);this._setViewport(A,X,m,3*N,2*N);var v=l[V];i.position=Nr(g,null,v.vs,$,3),i.uv=Nr(g,null,v.uv,$,2),i.faceIndex=Nr(g,null,v.faceIs,$,1),vb(g,0,v.vs.length/3),A.unbind(g)}};var p=4,L=8,e=Math.pow(2,L),N=[.125,.215,.35,.446,.526,.582],s=L-p+1+N.length,O=20,i=(1+Math.sqrt(5))/2,M=1/i,T=[new hb(1,1,1),new hb(-1,1,1),new hb(1,1,-1),new hb(-1,1,-1),new hb(0,i,M),new hb(0,i,-M),new hb(M,0,i),new hb(-M,0,i),new hb(i,M,0),new hb(-i,M,0)],I=function(){for(var B=[],t=[],Y=[],F=L,y=0;s>y;y++){var z=Math.pow(2,F);t.push(z);var d=1/z;y>L-p?d=N[y-L+p-1]:0==y&&(d=0),Y.push(d);for(var O=1/(z-1),C=-O/2,E=1+O/2,H=6,c=[],S=[],b=[],Z=0;H>Z;Z++){var D=2*(Z%3)/3-1,Q=Z>2?0:-1;c.push(D,Q,0,D+2/3,Q,0,D+2/3,Q+1,0,D,Q,0,D+2/3,Q+1,0,D,Q+1,0),S.push(C,C,E,C,E,E,C,C,E,E,C,E),b.push(Z,Z,Z,Z,Z,Z)}B.push({vs:new Ki(c),uv:new Ki(S),faceIs:new Ki(b)}),F>p&&F--}return{_lodPlanes:B,_sizeLods:t,_sigmas:Y}}(),l=I._lodPlanes,n=I._sizeLods,X=I._sigmas,v=u.EnvmapTextureSize}();var Js=["left","front","right","back","top","bottom"],Ks=Fr._RenderList=function(K){function B(){V.length=0,A.length=0,W={}}function N(G){var m,F,y,T,A=G.gv,C=G.data,s=G.shapeModel;if(s){var j,e,t,x=C.s("shape3d.transparent")||C.s("points.transparent");for(Zf(s)||(j=Tp(s.transparent,C,A),s=[s]),y=0,T=s.length;T>y;y++)t=s[y],e=Tp(t.transparent,C,A),e===r&&(e=j),e===r&&(e=x),e?F=!0:m=!0}for(y=0,T=Js.length;T>y;y++){var b=G[Js[y]];b&&(b.transparent?F=!0:m=!0)}A.isLabelVisible(C)&&(G.labelInfo&&(C.s(Ni+".transparent")?F=!0:m=!0),G.label2Info&&(C.s(Di+".transparent")?F=!0:m=!0)),A.isNoteVisible(C)&&(G.noteInfo&&(C.s(sf+".transparent")?F=!0:m=!0),G.note2Info&&(C.s(_b+".transparent")?F=!0:m=!0)),G._38o&&(F=m=!0),F||(m=!0),G._renderParams={opaque:m,transparent:F}}function d(g,k){k&&N(g);var d=g.data,H=d._id;if(!W[H]){W[H]=!0;var o=g._renderParams;o&&o.visible!==!1&&(g={ui:g,data:d,z:0,id:H},o.opaque&&V.push(g),o.transparent&&A.push(g))}}function F(c,B){if(A.length>1){for(var k,f,P=[0,0,0,0],D=0,i=A.length;i>D;D++)k=A[D].data,(f=k._position)?(P[0]=f.x,P[1]=k._54O,P[2]=f.y,P[3]=1,Zh(P,B),A[D].z=P[2]/P[3]):A[D].z=0;A.sort(c||v)}}function q(Z){Z?(cf(i,M,Z,K),cf(n,u,Z,K),cf(G,L,Z,K)):(i=this.batchModelMap={},M=this.batchIndexMap={},n=this.polylineModelMap={},u=this.polylineIndexMap={},G=this.wireframeModelMap={},L=this.wireframeIndexMap={}),this.markBatchInvalid()}function s(r){r?cf(i,M,r,K):(i=this.batchModelMap={},M=this.batchIndexMap={}),this.markBatchInvalid()}function S(o){o?cf(n,u,o,K):(n=this.polylineModelMap={},u=this.polylineIndexMap={}),this.markBatchInvalid()}function b(p){p?cf(G,L,p,K):(G=this.wireframeModelMap={},L=this.wireframeIndexMap={}),this.markBatchInvalid()}function Q(){return this._batchInvalid}function f(){this._batchInvalid=!0}function $(){this._batchInvalid=null}var V=[],A=[],i={},M={},n={},u={},G={},L={},W={};return{opaque:V,transparent:A,init:B,push:d,batchModelMap:i,batchIndexMap:M,polylineModelMap:n,polylineIndexMap:u,wireframeModelMap:G,wireframeIndexMap:L,ivBatch:q,ivModelBatch:s,ivPolylineBatch:S,ivWireframeBatch:b,markBatchInvalid:f,isBatchInvalid:Q,onUpdated:$,sort:F}},Ls=Fr._RenderLists=function(M){function p(){for(var A in P)P[A].init()}function R(){for(var F in P)P[F].onUpdated()}function O(H,$){H=H||"main";var u=P[H];return!u&&$&&(u=P[H]=new Ks(M)),u}function u(b,S){var P=b.data.getRenderLayer(),I=O(P,!0);I.push(b,S)}function z(L){for(var Y in P)L(P[Y])}var P={};return{init:p,onUpdated:R,get:O,push:u,each:z,lists:P}},Ms=Fr.RenderTarget=function(O,$,C,D){var J,m=this;null!=$&&$.canvas?(J=$,$=C,C=D,D=arguments[4]):J=O.getGL(),D=D||{},D.cube===!!D.cube,D.samples=D.cube?0:Math.min(O._glCapabilities.maxSamples,D.samples&&D.samples>1&&2===O._webGLVersion?D.samples:0),m.options=D,m.uuid=A.Math.generateUUID(),m.gv=O,m.init(O,J,D),m.format=D.format||Jk.RGBA,m.generateMipmaps=!!D.generateMipmaps,D.samples&&!O._glCapabilities._maxSamplesChecked?m.setSize(J,$||1,C||1):m.setSize(J,$,C)};b.assign(Fr.RenderTarget.prototype,{bind:function(Y,h){var U=this.options;if(U.autoSize){var w=this.gv,P=w.getDevicePixelRatio(),l=w.getWidth()*P,I=w.getHeight()*P;this.setSize(Y,l,I)}U.cube?Xg(Y,this.frame[h]):Xg(Y,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(A){Lp(A),this.options.samples&&(A.bindFramebuffer(A.READ_FRAMEBUFFER,this._MSAAFbo),A.bindFramebuffer(A.DRAW_FRAMEBUFFER,this.frame),A.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,A.COLOR_BUFFER_BIT,A.NEAREST),A.bindFramebuffer(A.READ_FRAMEBUFFER,null),A.bindFramebuffer(A.DRAW_FRAMEBUFFER,null))},isCube:function(){return this.options.cube},init:function(E,L,P){var t=this,v=P.samples,O=P.cube,j=t.texture=L.createTexture(),U=O?Jk.TEXTURE_CUBE_MAP:Jk.TEXTURE_2D;L.activeTexture(L.TEXTURE0),L.bindTexture(U,j),L.texParameteri(U,L.TEXTURE_WRAP_S,P.wrapS||L.CLAMP_TO_EDGE),L.texParameteri(U,L.TEXTURE_WRAP_T,P.wrapT||L.CLAMP_TO_EDGE);var G=v?L.NEAREST:L.LINEAR;if(L.texParameteri(U,L.TEXTURE_MIN_FILTER,P.minFilter||G),L.texParameteri(U,L.TEXTURE_MAG_FILTER,P.magFilter||G),L.bindTexture(U,null),O){t.depth=[],t.frame=[];for(var s=0;6>s;s++)t.depth[s]=L.createRenderbuffer(),t.frame[s]=L.createFramebuffer()}else t.depth=L.createRenderbuffer(),t.frame=L.createFramebuffer();t.assureTexture()},assureTexture:function(){var e=this;e.gv._2Oi(e.uuid,e.texture,"default"),A.Default.setImage(e.uuid,null)},releaseTexture:function(){this.gv.deleteTexture(this.uuid)},setSize:function(K,q,X){var y=this;if(q=Math.round(q),X=Math.round(X),q&&X&&(y.width!==q||y.height!==X)){y.width=q,y.height=X;var e=K.RENDERBUFFER,h=K.FRAMEBUFFER,o=y.options.samples,i=y.options.cube,Q=i?Jk.TEXTURE_CUBE_MAP:Jk.TEXTURE_2D;if(o){var V=y.gv._glCapabilities;if(!V._maxSamplesChecked){for(K.bindRenderbuffer(e,y.depth),K.getError();o>1&&(K.renderbufferStorageMultisample(e,o,K.DEPTH_COMPONENT16,q,X),K.getError());)o=Math.floor(o>>1);1>=o&&(o=0,K.texParameteri(Q,K.TEXTURE_MIN_FILTER,y.options.minFilter||K.LINEAR),K.texParameteri(Q,K.TEXTURE_MAG_FILTER,y.options.magFilter||K.LINEAR),K.renderbufferStorage(e,K.DEPTH_COMPONENT16,q,X)),V._maxSamplesChecked=!0,V.maxSamples=y.options.samples=o,K.bindRenderbuffer(e,$)}}if(o&&(y._MSAAFbo||(y._MSAAFbo=K.createFramebuffer(),y._MSAARbO=K.createRenderbuffer()),K.bindRenderbuffer(e,y._MSAARbO),K.renderbufferStorageMultisample(K.RENDERBUFFER,o,K.RGBA8,q,X),K.bindFramebuffer(h,y._MSAAFbo),K.framebufferRenderbuffer(h,K.COLOR_ATTACHMENT0,e,y._MSAARbO),K.framebufferRenderbuffer(h,K.DEPTH_ATTACHMENT,e,y.depth),K.bindFramebuffer(h,null),K.bindRenderbuffer(e,null)),K.activeTexture(K.TEXTURE0),K.bindTexture(Q,y.texture),i)for(var n=K.TEXTURE_CUBE_MAP_POSITIVE_X,Z=0;6>Z;Z++)y.setupFrameBufferTextureAndDepth(K,y.frame[Z],y.depth[Z],n+Z);else y.setupFrameBufferTextureAndDepth(K,y.frame,y.depth,K.TEXTURE_2D);if(y.generateMipmaps&&(2===gv._webGLVersion||ke.isPOT(q)&&ke.isPOT(X))){K.generateMipmap(Q);var L=y.options.minFilter||(o?K.NEAREST:K.LINEAR);K.texParameteri(Q,K.TEXTURE_MIN_FILTER,L===K.NEAREST?K.NEAREST_MIPMAP_NEAREST:K.LINEAR_MIPMAP_LINEAR)}K.bindTexture(Q,null)}},setupFrameBufferTextureAndDepth:function(j,P,h,G){var V=this,O=V.format;j.texImage2D(G,0,O,this.width,this.height,0,O,j.UNSIGNED_BYTE,null),j.bindFramebuffer(j.FRAMEBUFFER,P),j.framebufferTexture2D(j.FRAMEBUFFER,j.COLOR_ATTACHMENT0,G,V.texture,0),this.setupRenderBufferStorage(j,h),j.bindFramebuffer(j.FRAMEBUFFER,null)},setupRenderBufferStorage:function(K,k){var x=this,z=K.RENDERBUFFER;K.bindRenderbuffer(z,k);var M=x.options.samples;M?K.renderbufferStorageMultisample(z,M,K.DEPTH_COMPONENT16,x.width,x.height):(K.renderbufferStorage(z,K.DEPTH_COMPONENT16,x.width,x.height),K.framebufferRenderbuffer(K.FRAMEBUFFER,K.DEPTH_ATTACHMENT,z,k)),K.bindRenderbuffer(K.RENDERBUFFER,null)},toCanvas:function(){var F=this,X=F.gv.getGL();Xg(X,F.frame);var U=F.width,m=F.height,t=new Uint8Array(4*U*m);X.readPixels(0,0,U,m,F.format,X.UNSIGNED_BYTE,t),Lp(X);var k=G.createElement("canvas");k.width=U,k.height=m;var p=k.getContext("2d"),f=p.createImageData(U,m);return f.data.set(t),p.putImageData(f,0,0),k}});var Ns=Fr.Interactor=function(o){this.gv=this.g3d=o};Kd("Interactor",b,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()},fi:function(g){this.gv.fi(g)},startDragging:function(e){ec(this,e)}});var Os=Fr.DefaultInteractor=function(K){ud(Os,this,[K])};Kd("DefaultInteractor",Ns,{getState:function(){return this._62O},setState:function(Q){this._62O=Q},getDataInfoAt:function(X,j){var Z=this.gv,y=Z.getDataInfoAt(X);if(!Z.isBlockSelectable()||!y||!y.data)return y;if(!j&&Z.isSelected(y.data))return y;for(var l=y.data;(l=l.getParent())&&l instanceof A.Block&&Z.isSelectable(l);){var z=Z.isSelected(l);if(z&&j)break;if(y={data:l,part:y.part},z&&!j)break}return y},handle_contextmenu:function(j){Mm(j)},handle_mousewheel:function(R){this.gv.handleScroll(R,R.wheelDelta/40)},handle_DOMMouseScroll:function(W){2===W.axis&&this.gv.handleScroll(W,-W.detail)},handle_keydown:function(U){this.gv.handleKeyDown(U)},handle_mousedown:function(S){this.handle_touchstart(S)},handle_touchstart:function(f){Mm(f);var V=this,B=V.gv,Y=ok(f),K=V.getDataInfoAt(f),m=K?K.data:$,w=K?K.part:$,e=B.sm(),l=Hh(f),y=ge(f);B.setFocus(f)&&(V._62O=$,V._57I=$,V.pendingClickThrough=$,V.__lastClientPoint__=dj(f),m?ao(f)?e.co(m)?e.rs(m):e.as(m):e.co(m)?m instanceof el&&m.isClickThroughEnabled()&&ok(f)&&(V.pendingClickThrough=dj(f)):e.ss(m):Y&&(ao(f)?B.isRectSelectable()&&(V._62O=tf):V._57I=dj(f)),V._31Q&&(os(V._31Q),delete V._31Q,delete V._32Q),V._62O||(B.isFirstPersonMode()&&(Ng(f)||Tc(f)||y>2?V._62O="pan":B.isMouseRoamable()||hk(f)?(V._62O="roaming",V.foward=l&&ok(f),V._32Q=ei(),V._31Q=Qi(V.tick,V)):Y||(V._62O="roaming")),V._62O||(Y&&l&&gt[w]?(V._62O=w,V.p3=m.p3()):Y&&l&&Dk(m)&&B.isSelected(m)?B.isMovable(m)?(V._62O="move",V.p3=m.p3(),V.movedata=m):B._39Q(m)&&(V._62O="none"):hk(f)&&(y>2?V._62O="pan":2===y&&(V.dist=Kq(f),V._62O="pinch")))),V.point=B.lp(f),ec(V,f),tb(f)?B.handleDoubleClick(f,m,w):B.handleClick(f,m,w))},tick:function(){var R=this,u=R.gv,b=u._moveStep;R.point&&u.isWalkable()&&(R._32Q&&(b*=(ei()-R._32Q)/50),u.walk(R.foward?b:-b),R._32Q=ei(),R._31Q=Qi(R.tick,R))},handle_mouseup:function(O){this.handle_touchend(O)},handle_touchend:function(W){var g=this._57I;if(g&&(Kj(g,dj(W))<=1&&this.gv.sm().cs(),this._57I=$),g=this.pendingClickThrough){if(Kj(g,dj(W))<=1){var J=this.getDataInfoAt(W);J&&J.data instanceof el&&J.data.isClickThroughEnabled()&&(J=this.getDataInfoAt(W,!0),J&&(W.clickThrough=!0,this.gv.sm().ss(J.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(u){this.handleWindowTouchMove(u)},handleWindowTouchMove:function(K){var J,j,D=this,R=D.gv,w=D._62O,$=D.point,Y=R.dm(),E=R.lp(K),L=E.x-$.x,U=E.y-$.y,Z=R.getWidth(),r=R.getHeight();if(Z&&r){var v=dj(K),d=Ln(R,v,D.__lastClientPoint__),i=Kj({x:0,y:0},d),z=-g*L/Z,M=-g*U/r;if("roaming"===w)D.rotate(K,z/2,M/2);else if(w===at||w===bt||w===ct)R._86O||Y.beginTransaction(),R.fi({kind:R._86O?"betweenEditRotation":"beginEditRotation",event:K}),R._86O=1,R.sm().each(function(m){if(Dk(m)&&R.isRotationEditable(m)){var f=k(z)>k(M)?z:M;w===at?m.setRotationX(m.getRotationX()+f):w===bt?m.setRotationY(m.getRotationY()+f):w===ct&&m.setRotationZ(m.getRotationZ()+f)}});else if("move"===w||gt[w]){if(w===dt||w===et||w===ft)R._87O||Y.beginTransaction(),R.fi({kind:R._87O?"betweenEditScale":"beginEditScale",event:K}),R._87O=1;else{if(!R._moving){if(i<u.touchMoveThreshold)return;Y.beginTransaction()}R.fi({kind:R._moving?"betweenMove":"beginMove",event:K}),R._moving=1}var N,_=D.p3,n=R.getPositionInfo(_),C=ro(R);N=w===Zs?"x":w===$s?"y":w===_s?"z":w===dt?"sx":w===et?"sy":w===ft?"sz":R.getMoveMode(K,D.movedata),L=L/Z*n.width,U=-1*U/r*n.height;var o,f,h=[C[0]*L,C[4]*L,C[8]*L],s=[C[1]*U,C[5]*U,C[9]*U],F=h[0]+s[0],x=h[1]+s[1],e=h[2]+s[2],B=[_[0]+F,_[1]+x,_[2]+e],X=Ur(R.getEye(),B,!0);if("xyz"===N?(o=B,R.moveSelection(F,x,e)):"xz"===N?(o=tg(R,_,[0,1,0],B),o&&R.moveSelection(o[0]-_[0],0,o[2]-_[2])):"xy"===N?(o=tg(R,_,[0,0,1],B),o&&R.moveSelection(o[0]-_[0],o[1]-_[1],0)):"yz"===N?(o=tg(R,_,[1,0,0],B),o&&R.moveSelection(0,o[1]-_[1],o[2]-_[2])):"x"===N||"sx"===N?(X[0]=0,o=tg(R,_,X,B),o&&(f=o[0]-_[0],"x"===N?R.moveSelection(f,0,0):R.sm().each(function(l){Dk(l)&&R.isSizeEditable(l)&&(J=l.getScaleX()+f/100,j=J/l.getScaleX(),l.setScaleX(J),Ng(K)&&(l.setScaleY(l.getScaleY()*j),l.setScaleTall(l.getScaleTall()*j)))}))):"y"===N||"sy"===N?(X[1]=0,o=tg(R,_,X,B),o&&(f=o[1]-_[1],"y"===N?R.moveSelection(0,f,0):R.sm().each(function(M){Dk(M)&&R.isSizeEditable(M)&&(J=M.getScaleTall()+f/100,j=J/M.getScaleTall(),M.setScaleTall(J),Ng(K)&&(M.setScaleY(M.getScaleY()*j),M.setScaleX(M.getScaleX()*j)))}))):("z"===N||"sz"===N)&&(X[2]=0,o=tg(R,_,X,B),o&&(f=o[2]-_[2],"z"===N?R.moveSelection(0,0,f):R.sm().each(function(S){Dk(S)&&R.isSizeEditable(S)&&(J=S.getScaleY()+f/100,j=J/S.getScaleY(),S.setScaleY(J),Ng(K)&&(S.setScaleX(S.getScaleX()*j),S.setScaleTall(S.getScaleTall()*j)))}))),!o)return;D.p3=o}else if(w===tf){var G=D.div;G||(G=D.div=Ic(),$p(D.getView(),G),G.op=$,G.style.background=R.getRectSelectBackground()),R.fi({kind:R._rectSelecting?"betweenRectSelect":"beginRectSelect",event:K}),R._rectSelecting=1,G.rect=Tg(G.op,E),Zg(G,G.rect)}else if("pinch"===w&&2===ge(K)){R.fi({kind:R._pinching?"betweenPinch":"beginPinch",event:K}),R._pinching=1;var f=Kq(K);R._lastZoomLP||(R._lastZoomLP=mp(K)),R.handlePinch(f,D.dist),D.dist=f}else"pan"===w||Ng(K)||Tc(K)?D.pan(K,L,U):"none"===w||R.isFirstPersonMode()||D.rotate(K,z,M);D.point=E}},pan:function(C,x,o){var W=this.gv;if(W.isPannable()){var n=W.getWidth(),w=W.getHeight();if(!n||!w)return;var g=W.getCenterInfo(),Q=x/n*g.width,Z=-1*o/w*g.height;W.fi({kind:W._panning?"betweenPan":"beginPan",event:C}),W._panning=1,W.pan(-Q,-Z)}},rotate:function(J,q,d){var a=this.gv;a.isRotatable()&&(a.fi({kind:a._rotating?"betweenRotate":"beginRotate",event:J}),a._rotating=1,a.rotate(q,d))},handleWindowMouseUp:function(A){this.handleWindowTouchEnd(A)},handleWindowTouchEnd:function(V){var j=this,k=j.gv,T=k.dm(),B=j.div;if(B){var f=k.getDatasInRect(B.rect);if(!f.isEmpty()){var K=k.sm(),o=K.toSelection(),u=Ng(V),x=V.altKey;f.each(function(e){K.co(e)?(!u||u&&x)&&o.remove(e):(!x||u&&x)&&o.add(e)}),K.ss(o)}lk(B)}k._moving&&(delete k._moving,k.fi({kind:"endMove",event:V}),k.onMoveEnded(),T.endTransaction()),k._panning&&(delete k._panning,k.fi({kind:"endPan",event:V}),k.onPanEnded()),k._rotating&&(delete k._rotating,k.fi({kind:"endRotate",event:V}),k.onRotateEnded()),k._86O&&(delete k._86O,k.fi({kind:"endEditRotation",event:V}),T.endTransaction()),k._87O&&(delete k._87O,k.fi({kind:"endEditScale",event:V}),T.endTransaction()),k._pinching&&(delete k._pinching,k.fi({kind:"endPinch",event:V}),k.onPinchEnded()),k._rectSelecting&&(delete k._rectSelecting,k.fi({kind:"endRectSelect",event:V}),k.onRectSelectEnded()),k._walking&&(delete k._walking,k.fi({kind:"endWalk",event:V}),k.onWalkEnded()),k._lastZoomLP=k._lastZoomHit=null,j.dist=j.point=j._62O=j.p3=j.movedata=j.div=j._57I=j.pendingClickThrough=j._32Q=j._31Q=j.foward=$,j.__lastClientPoint__=$}});var Ps=Fr.MapInteractor=function(t){ud(Ps,this,[t]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this._minPhi=0,this._maxPhi=5*Math.PI/12};Kd("MapInteractor",Ns,{setUp:function(){Ps.superClass.setUp.call(this);var d=this.gv;this.__oldMinPhi__=d.getRotateMinPhi(),this.__oldMaxPhi__=d.getRotateMaxPhi(),d.setRotateMinPhi(this._minPhi),d.setRotateMaxPhi(this._maxPhi)},tearDown:function(){Ps.superClass.tearDown.call(this);var q=this.gv;q.setRotateMinPhi(this.__oldMinPhi__),q.setRotateMaxPhi(this.__oldMaxPhi__),delete this.__oldMinPhi__,delete this.__oldMaxPhi__},handle_contextmenu:function(u){Mm(u)},handle_mousewheel:function(d){this.gv.handleScroll(d,d.wheelDelta/40)},handle_DOMMouseScroll:function(u){2===u.axis&&this.gv.handleScroll(u,-u.detail)},handle_keydown:function($){this.gv.handleKeyDown($)},handle_mousedown:function(c){this.handle_touchstart(c)},handle_touchstart:function(v){Mm(v);var m=this,l=m.gv;if(l.setFocus(v)){var Y=l.getDataInfoAt(v),b=Y?Y.data:$,c=Y?Y.part:$;m.__lastClientPoint__=dj(v);var y=m.editing={point:l.lp(v),data:b,part:c};hk(v)?y.touch=!0:(y.touch=!1,y.clickLeft=ok(v),y.pan=Tc(v)?!0:"left"===this.panButton===y.clickLeft),b&&l._39Q(b)&&(y.preventDefault=!0),ec(m,v),tb(v)?l.handleDoubleClick(v,b,c):l.handleClick(v,b,c)}},handle_mouseup:function(L){this.handle_touchend(L)},handle_touchend:function(){},handleWindowMouseMove:function(_){this.handleWindowTouchMove(_)},handleWindowTouchMove:function(P){var R=this,f=R.gv,S=R.editing;if(S){var O=f.lp(P),j=S.point,F=O.x-j.x,m=O.y-j.y;if(!S.moved){if(Math.abs(F)<R.threshold&&Math.abs(m)<R.threshold&&!(P.touches&&P.touches.length>1))return;S.moved=!0}if(!S.preventDefault){S.point=O;var v=S.part;if(gt[v]){var z=S.data,K=f.dm(),E=f.getWidth(),U=f.getHeight(),b=-g*F/E,V=-g*m/U;if(v===at||v===bt||v===ct){f._86O||K.beginTransaction(),f.fi({kind:f._86O?"betweenEditRotation":"beginEditRotation",event:P}),f._86O=1;var l=k(b)>k(V)?b:V;f.sm().each(function(s){Dk(s)&&f.isRotationEditable(s)&&(v===at?s.setRotationX(s.getRotationX()+l):v===bt?s.setRotationY(s.getRotationY()+l):v===ct&&s.setRotationZ(s.getRotationZ()+l))})}else{var W=z.p3(),H=f.getPositionInfo(W);F=F/E*H.width,m=-1*m/U*H.height;var M,T=ro(f),i=[T[0]*F,T[4]*F,T[8]*F],o=[T[1]*m,T[5]*m,T[9]*m],e=i[0]+o[0],s=i[1]+o[1],X=i[2]+o[2],A=[W[0]+e,W[1]+s,W[2]+X],Y=Ur(f.getEye(),A,!0);if(v===dt||v===et||v===ft){if(f._87O||K.beginTransaction(),f.fi({kind:f._87O?"betweenEditScale":"beginEditScale",event:P}),f._87O=1,M=tg(f,W,Y,A)){var a,h=0,t=["X","Y","Tall"];v===dt?a="X":v===et?(a="Tall",h=1):v===ft&&(a="Y",h=2),t.splice(t.indexOf(a),1);var y=Ng(P),G=(M[h]-W[h])/100;f.sm().each(function(P){if(Dk(P)&&f.isSizeEditable(P)){var x=P["getScale"+a](),v=x+G;if(P["setScale"+a](v),y){var A=v/x;t.forEach(function(F){P["setScale"+F](P["getScale"+F]()*A)})}}})}}else if(v===Zs||v===$s||v===_s){if(!f._moving){var D=dj(P),B=Ln(f,D,R.__lastClientPoint__),J=Kj({x:0,y:0},B);if(J<u.touchMoveThreshold)return;K.beginTransaction()}f.fi({kind:f._moving?"betweenMove":"beginMove",event:P}),f._moving=1;var h=0;if(v===Zs?h=0:v===$s?h=1:v===_s&&(h=2),Y[h]=0,M=tg(f,W,Y,A)){var G=M[h]-W[h],I=[0,0,0];I[h]=G,f.moveSelection.apply(f,I)}}}}else if(S.touch){var C=P.touches.length;if(2!==C)R.pan(P,F,m);else{if(1>=C)return;var d=P.touches,N={x:d[0].clientX,y:d[0].clientY},n={x:d[1].clientX,y:d[1].clientY},r={x:n.x-N.x,y:n.y-N.y},Q=S.lastCenter,_=Math.atan2(r.y,r.x),L=S.theta,w=0;L==$?L=S.theta=_:(w=_-L,S.thetaStarted||Math.abs(w)>R.touchRotateThreshold?(S.thetaStarted=!0,S.theta=_):w=0);var c=Z*(N.y+n.y)/2/f.getHeight(),x=S.phi,p=0;x==$?x=S.phi=c:(p=c-x,S.phiStarted||Math.abs(p)>R.touchRotateThreshold?(S.phiStarted=!0,S.phi=c):p=0);var q,nk=Math.sqrt(r.x*r.x+r.y*r.y),$d=S.vlen;if($d){var Wo=N.x-Q.x,Zb=N.y-Q.y,Zo=n.x-Q.x,$b=n.y-Q.y,Lr=Math.sqrt(Wo*Wo+Zb*Zb),ob=Math.sqrt(Zo*Zo+$b*$b),wm=$d/2,Pi=R._sign2(Lr-wm),Lg=R._sign2(ob-wm);0>Pi*Lg||0===Pi&&0===Lg?(q=1,S.vlen=nk):(q||(q=nk/$d),S.scaleStarted||Math.abs(q-1)>R.touchScaleThreshold?(S.vlen=nk,S.scaleStarted=!0):q=1)}else $d=S.vlen=nk,q=1;1!==q&&f.setZoom(q),(p||w)&&R.rotate(P,w,-p),S.lastCenter={x:(n.x+N.x)/2,y:(n.y+N.y)/2}}}else if(S.pan)R.pan(P,F,m);else{var E=f.getWidth(),U=f.getHeight();if(!E||!U)return;var b=-g*F/E,V=-g*m/U;R.rotate(P,b,V)}}}},_sign2:function(G){return Math.abs(G)<this._touchScaleCheckAccuracy?0:G>0?1:-1},handleWindowMouseUp:function(X){this.handleWindowTouchEnd(X)},getDataInfoAt:function(J,g){var S=this.gv,W=S.getDataInfoAt(J);if(!S.isBlockSelectable()||!W||!W.data)return W;if(!g&&S.isSelected(W.data))return W;for(var t=W.data,c=W.part;(t=t.getParent())&&t instanceof A.Block&&S.isSelectable(t);){var E=S.isSelected(t);if(E&&g)break;if(W={data:t,part:c},E&&!g)break}return W},handleWindowTouchEnd:function(S){var G=this,F=G.editing;if(G.editing=null,F){var Q=G.gv;if(F.moved||!F.clickLeft&&!F.touch)Q._panning=null,Q._rotating=null,Q.fi({kind:F.pan?"endPan":"endRotate",event:S});else{var L=G.getDataInfoAt(S),V=L&&L.data;V instanceof el&&V.isClickThroughEnabled()&&(L=G.getDataInfoAt(S,!0),L&&(V=L.data)),V?Q.sm().setSelection([V]):Q.sm().clearSelection()}var O=Q.dm();Q._moving&&(delete Q._moving,Q.fi({kind:"endMove",event:S}),Q.onMoveEnded(),O.endTransaction()),Q._86O&&(delete Q._86O,Q.fi({kind:"endEditRotation",event:S}),O.endTransaction()),Q._87O&&(delete Q._87O,Q.fi({kind:"endEditScale",event:S}),O.endTransaction())}},pan:function(u,l,E){var D=this,G=D.gv;if(G.isPannable()){var H=G.getWidth(),T=G.getHeight();if(H&&T){var L=G.getCenterInfo(),B=-l/H*L.width,U=1*E/T*L.height;G.fi({kind:G._panning?"betweenPan":"beginPan",event:u}),G._panning=1;var Y=D.keepHorizon,P=D.editing.touch;if((P&&u.touches&&u.touches.length>1||!P&&Ng(u))&&(Y=!Y),!Y)return G.pan(B,U);if(B||U){var O=ro(G),C=[O[0]*B,O[4]*B,O[8]*B],S=[O[1],0,O[9]],M=Math.sqrt(S[0]*S[0]+S[2]*S[2]);M&&(S=[S[0]/M*U,0,S[2]/M*U]);var a=C[0]+S[0],c=C[1]+S[1],X=C[2]+S[2],J=G._center,F=G._eye;J[0]+=a,J[1]+=c,J[2]+=X,F[0]+=a,F[1]+=c,F[2]+=X,G.fp(Np,$,F),G.fp(eo,$,J)}}}},rotate:function(f,W,L){var G=this,m=G.gv;if(m.isRotatable()){var J=m._center,E=m._eye,q=Ur(E,J),h=ys(_(q[0]*q[0]+q[2]*q[2]),q[1]),X=So(m,h+L);L=X-h,m.fi({kind:m._rotating?"betweenRotate":"beginRotate",event:f}),m._rotating=1,m.rotate(W,L)}}}),b.defineProperties(Ps.prototype,{panButton:{get:function(){return this._panButton},set:function(E){this._panButton=E}},minPhi:{get:function(){return this._minPhi},set:function(i){this.gv.setRotateMinPhi(this._minPhi=i)}},maxPhi:{get:function(){return this._maxPhi},set:function(H){this.gv.setRotateMaxPhi(this._maxPhi=H)}},keepHorizon:{get:function(){return this._keepHorizon},set:function(u){this._keepHorizon=u}},threshold:{get:function(){return this._threshold},set:function(N){this._threshold=N}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(A){this._touchScaleThreshold=A}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(h){this._touchRotateThreshold=h}}});var Qs,Rs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",Ss=32,Ts=Fr.GlobeInteractor=function(O,W){ud(Ts,this,[O]);var L,w=W.radius||6378137,t=this,m=null;Qs||(Qs=Ic(),Qs.style.border="",Qs.style.backgroundImage="url("+Rs+")");
var E=new Ab,T=new hb,k=new hb,u=new hb,q=new Gi,F="number"==typeof w?{x:w,y:w,z:w}:w,z={center:new hb(0,0,0),radius:F},N=function(C){O._81O=null;var s=O.getHitPosition(C,O.getCenter(),T.copy(O.getEye()).sub(k.copy(O.getCenter())).toArray());return q.origin.copy(O.getEye()),q.direction.copy(s).sub(q.origin).normalize(),q.intersectEllipsoid(z)},X=function(Y,s){O._81O=null,q.origin.copy(O.getEye());for(var y,Q,W=O.getCenter(),M=T.copy(O.getEye()).sub(k.copy(O.getCenter())).toArray(),m=1,p=16,c=0,a=1,P={x:0,y:0};p--;){if(P.x=s.x+(Y.x-s.x)*m,P.y=s.y+(Y.y-s.y)*m,y=O.getHitPosition(P,W,M),q.direction.copy(y).sub(q.origin).normalize(),Q=q.intersectEllipsoid(z),Q&&1===m)return{hit:Q};Q?c=m:a=m,m=(c+a)/2}return{hit:Q,out:1>m}},o=function(z,_){if(m){var Z=Date.now();m.deltaTime=m.lastTime?Z-m.lastTime:1e3,m.lastTime=Z,m.lastAxis=z,m.lastAngle=_}_&&(E.setFromAxisAngle(z,_),O.setEye(T.copy(O.getEye()).applyQuaternion(E).toArray()),O.setCenter(T.copy(O.getCenter()).applyQuaternion(E).toArray()),O.setUp(T.copy(O.getUp()).applyQuaternion(E).toArray()))};t._showCrossIcon=function(j){$p(t.getView(),Qs),Zg(Qs,{x:j.clientX-Ss/2,y:j.clientY-Ss/2,width:Ss,height:Ss})},t._hideCrossIcon=function(){lk(Qs)},t._scrollImpl=function(o,e){m={point:O.lp(o),screen:dj(o),hit:N(o),type:"right"},m.hitNormalize=m.hit?m.hit.clone().normalize():new hb;var P={clientX:m.screen.x,clientY:m.screen.y+10*e};t._handleMoveImpl(P),t._endMoveImpl(P)},t._startMoveImpl=function(Q){L&&(L.stop(!0),L=null),m={point:O.lp(Q),screen:dj(Q),hit:N(Q)},m.hitNormalize=m.hit?m.hit.clone().normalize():new hb,hk(Q)?1===Q.touches.length?m.hit&&(m.type="left"):2===Q.touches.length&&(m.type="touch2"):(ok(Q)?m.hit&&(m.type="left"):pi(Q)?m.type="right":Tc(Q)&&m.hit&&(m.type="middle"),!m.hit||"right"!==m.type&&"middle"!==m.type||t._showCrossIcon(Q)),m.type&&ec(t,Q)},t._handleMoveImpl=function(S){if(m)switch(m.type){case"left":return t._handleLeft(S);case"right":return t._handleRight(S);case"middle":return t._handleMiddle(S);case"touch2":return t._handleTouch2(S)}},t._endMoveImpl=function(){if(m){if(this._hideCrossIcon(),"left"===m.type||"middle"===m.type){var B=1e3*(m.lastAngle/(m.deltaTime||30)),b=m.lastAxis,Q=m.lastTime,$=function(){var F=Date.now(),g=(F-Q)/1e3;return Q=F,B*=Math.pow(Math.abs(t.decelerationRate),3*g),Math.abs(B)<.01?(B=0,L&&L.stop(),void 0):(o(b,B*g),void 0)};L=ce({action:function(){$(arguments)},duration:5e3})}m=null}},t._handleLeft=function(q){if(!m.finished){var c=dj(q),W=X(c,m.lastScreen||m.screen);if(m.lastScreen=c,!W.hit)return m.finished=!0,t._endMoveImpl(q),void 0;var A=W.hit;A.normalize();var d=m.hitNormalize,M=Math.acos(A.dot(d)),O=A.cross(d).normalize();o(O,M),W.out&&(m.finished=!0,t._endMoveImpl(q))}},t._handleRight=function(f){var X=m.lastScreen||m.screen,v=X.y;X=m.lastScreen=dj(f);var j=X.y,x=j-v;if(x){var L=Math.min(.5,x*t.scaleSpeed);T.copy(O.getEye());var D=m.hit;D||(D=T.clone().divide(F).normalize().multiply(F)),k.copy(T).lerp(D,L),O.setEye(k.toArray()),T.copy(O.getUp()),k.normalize();var E=T.clone().cross(k).normalize();if(u.copy(O.getCenter()),u.sub(E.multiplyScalar(u.dot(E))),O.setCenter(u.toArray()),m.hit){var h=N(m.screen),I=m.hitNormalize;if(h){h.normalize();var l=Math.acos(h.dot(I)),K=h.cross(I).normalize();l&&o(K,l)}}}};var C=function(M){return Math.abs(M)<.01?0:M>0?1:-1};t._handleTouch2=function(T){var d=T.touches.length;if(2===d){var s=T.touches,r={x:s[0].clientX,y:s[0].clientY},t={x:s[1].clientX,y:s[1].clientY},x={x:t.x-r.x,y:t.y-r.y},A=m.lastCenter,E=Math.atan2(x.y,x.x),q=m.theta,l=0;q==$?q=m.theta=E:(l=E-q,m.thetaStarted||Math.abs(l)>.03?(m.thetaStarted=!0,m.theta=E):l=0);var S,p=Math.sqrt(x.x*x.x+x.y*x.y),h=m.vlen;if(h){var J=r.x-A.x,Y=r.y-A.y,z=t.x-A.x,b=t.y-A.y,W=Math.sqrt(J*J+Y*Y),j=Math.sqrt(z*z+b*b),V=h/2,H=C(W-V),n=C(j-V);0>H*n||0===H&&0===n?(S=1,m.vlen=p):(S||(S=p/h),m.scaleStarted||Math.abs(S-1)>.05?(m.vlen=p,m.scaleStarted=!0):S=1)}else h=m.vlen=p,S=1;var x=k.copy(O.getEye()).clone();1!==S&&O.setEye(x.setLength((x.length()-w)/S+w).toArray()),l&&o(x.normalize(),l),m.lastCenter={x:(t.x+r.x)/2,y:(t.y+r.y)/2}}},t._handleMiddle=function(E){var $=dj(E),I=m.screen;m.screen=$;var P=($.y-I.y)/180*Math.PI*t.rollSpeed;k.copy(O.getCenter()).sub(T.copy(O.getEye())).normalize(),T.copy(O.getUp()).cross(k).normalize(),k.copy(O.getEye()).sub(m.hit).applyAxisAngle(T,P).add(m.hit);var G=k.clone();k.copy(O.getCenter()).sub(m.hit).applyAxisAngle(T,P).add(m.hit);var j=k.clone(),w=k.copy(O.getUp()).applyAxisAngle(T,P).clone(),l=!1;P>0&&(u.copy(w),k.copy(j).sub(G).normalize(),T.copy(G).multiplyScalar(-1).normalize(),T.dot(u)-k.dot(u)>0&&(l=!0)),l||u.copy(m.hit).sub(G).dot(m.hitNormalize)>=0&&(l=!0),l||(O.setEye(G.toArray()),O.setCenter(j.toArray()),O.setUp(w.toArray()));var Y=-($.x-I.x)/180*Math.PI*t.rotateSpeed;o(m.hitNormalize,Y)}};Kd("GlobeInteractor",Ns,{handle_contextmenu:function(c){Mm(c)},handle_mousewheel:function(A){this._scrollImpl(A,A.wheelDelta/40)},handle_DOMMouseScroll:function(K){2===K.axis&&this._scrollImpl(K,-K.detail)},handle_keydown:function(X){this.gv.handleKeyDown(X)},handle_mousedown:function(x){this.handle_touchstart(x)},handle_touchstart:function(s){Mm(s);var T=this.gv;if(T.setFocus(s)){var R=T.getDataInfoAt(s),z=R?R.data:$;z&&T.isInteractive(z)||this._startMoveImpl(s);var u=R?R.part:$;tb(s)?T.handleDoubleClick(s,z,u):T.handleClick(s,z,u)}},handle_mouseup:function(O){this.handle_touchend(O)},handle_touchend:function(){},handleWindowMouseMove:function(P){this.handleWindowTouchMove(P)},handleWindowTouchMove:function(g){this._handleMoveImpl(g)},handleWindowMouseUp:function(r){this.handleWindowTouchEnd(r)},handleWindowTouchEnd:function(U){this._endMoveImpl(U)}}),b.defineProperties(Ts.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(t){this._rotateSpeed=t}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(q){this._rollSpeed=q}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(n){this._scaleSpeed=n}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(z){this._decelerationRate=z}}});var Us=function(n){var x=2147483648|n;return[(255&x>>16)/255,(255&x>>8)/255,(255&x)/255,(255&x>>24)/255]},Vs=function(n){this.gv=n,this.gv.pickColorMap={_pickIdUsed:2e3}};bd(Vs,b,{_iv:!0,iv:function(){this._iv=!0},get:function(n,E,e){this.validate();var p=this,t=p.gv.getGL();if(!t)return $;var V,K,h=p._resolution,b=Math.round(n.x*h),s=Math.ceil(n.width*h),O=Math.ceil(n.height*h),f=p.height-Math.round(n.y*h)-O,J=M(s/2),u=new Uint8Array(4*s*O),D=0,X=u.length,q=E?$:new Od,P=E?$:{};if(Xg(t,p.frame),t.readPixels(b,f,s,O,t.RGBA,t.UNSIGNED_BYTE,u),Lp(t),E){for(;J>=D;D++)for(var i=J-D,R=J+D,v=i;R>=v;v++)for(var I=i;R>=I;I++)if((v===i||v===R||I===i||I===R)&&(V=p.info(u,4*(v*s+I)))){if(e&&e(V)===!1)continue;return V}}else for(;X>D;D+=4)if(V=p.info(u,D)){if(e&&e(V)===!1)continue;K=V.data,P[K._id]||(q.add(K),P[K._id]=K)}return q},info:function(N,j){return this.gv.pickColorMap[(N[j]<<16)+(N[j+1]<<8)+N[j+2]+((127&N[j+3])<<24)]},getResolution:function(){return this._resolution},onContextLost:function(){this.texture=null,this.width=this.height=-1},validate:function(){var L=this,z=L.gv,N=z.getGL();if(N){var R=L._resolution=z._pickerResolution*z.getDevicePixelRatio(),V=Math.round(R*z.getWidth()),O=Math.round(R*z.getHeight()),u=N.RGBA,A=N.TEXTURE_2D,X=N.RENDERBUFFER,o=N.FRAMEBUFFER;if(L.texture||(L.texture=gs(N),L.render=N.createRenderbuffer(),L.frame=N.createFramebuffer()),(L.width!==V||L.height!==O)&&(N.activeTexture(N.TEXTURE0),kf(N,L.texture),N.texImage2D(A,0,u,V,O,0,u,N.UNSIGNED_BYTE,$),he(N,N.TEXTURE_MIN_FILTER,N.LINEAR),N.bindRenderbuffer(X,L.render),N.renderbufferStorage(X,N.DEPTH_COMPONENT16,V,O),Xg(N,L.frame),N.framebufferTexture2D(o,N.COLOR_ATTACHMENT0,A,L.texture,0),N.framebufferRenderbuffer(o,N.DEPTH_ATTACHMENT,X,L.render),kf(N,$),N.bindRenderbuffer(X,$),Lp(N),L.width=V,L.height=O),L._iv){L._iv=!1;var e=!1;z._40Q.each(function(n){!e&&n.isBatchInvalid()&&(e=!0)}),e&&z.updateScene(),Xg(N,L.frame),N.clear(N.COLOR_BUFFER_BIT),z.overlappingBox.clear(),z.setViewport(N,0,0,V,O),z.renderPickScene(),Lp(N)}}}});var Ws=function(e){this.gv=e};bd(Ws,b,{gap:0,size:0,_42:function(Q,v){var C=this,_=C.gv,p=_._gridGap,I=_._gridSize;if(_._gridVisible){if(C.gap!==p||C.size!==I){for(var s=[],K=_._gridSize/2,B=p*K,M=0;2*K+1>M;M++){var y=6*M,e=6*(2*K+1)+y;s[y]=-B,s[y+1]=0,s[y+2]=-B+M*p,s[y+3]=B,s[y+4]=0,s[y+5]=-B+M*p,s[e]=-B+M*p,s[e+1]=0,s[e+2]=-B,s[e+3]=-B+M*p,s[e+4]=0,s[e+5]=B}C.vs=new Ki(s),C.gap=p,C.size=I}sk(_),xm(Q),Mc(Q);var X=!_._fogDisabled;if(X){var P=El.for(Q).directUniforms();P.uFog=!1}pn(Q,v,1,_._gridColor,_._buffer.vs,C.vs),vb(Q,0,C.vs.length/3,Q.LINES),X&&(P.uFog=!0),ni(Q),qf(Q)}else C.vs=C.gap=C.size=$}});var Xs=function(b){this.gv=b};bd(Xs,b,{_42:function(k,n){var y=this.gv,D=y._buffer.vs,L=y._axisXColor,G=y._axisYColor,R=y._axisZColor,r=y._originAxisVisible,F=y._centerAxisVisible;if(r||F){var N=yo?k.TRIANGLES:k.TRIANGLE_FAN,J=k.LINES;if(sk(y),xm(k),Mc(k),r){var H=y.getCenterInfo(),Z=O(H.width,H.height)/5,S=.8*Z,p=.05*Z;pn(k,n,1.5,L,D,new Ki([0,0,0,Z,0,0,S,p,0,S,0,p,S,-p,0,S,0,-p,S,p,0,0,0,0,0,Z,0,p,S,0,0,S,p,-p,S,0,0,S,-p,p,S,0,0,0,0,0,0,Z,p,0,S,0,p,S,-p,0,S,0,-p,S,p,0,S])),vb(k,0,2,J),vb(k,1,6,N),pn(k,n,$,G),vb(k,7,2,J),vb(k,8,6,N),pn(k,n,$,R),vb(k,14,2,J),vb(k,15,6,N)}if(F){var h=y._center,z=h[0],e=h[1],o=h[2],H=y.getPositionInfo(h);Z=O(H.width,H.height)/20,pn(k,n,1.5,L,D,new Ki([z,e,o,z+Z,e,o,z,e,o,z,e+Z,o,z,e,o,z,e,o+Z])),vb(k,0,2,J),pn(k,n,$,G),vb(k,2,2,J),pn(k,n,$,R),vb(k,4,2,J)}ni(k),qf(k)}}});var Ys=function(Q){this.gv=Q},Zs="edit_tx",$s="edit_ty",_s="edit_tz",at="edit_rx",bt="edit_ry",ct="edit_rz",dt="edit_sx",et="edit_sy",ft="edit_sz",gt={};gt[Zs]=101,gt[$s]=102,gt[_s]=103,gt[at]=104,gt[bt]=105,gt[ct]=106,gt[dt]=107,gt[et]=108,gt[ft]=109,bd(Ys,b,{_42:function(d,l,F){var z=this,W=z.gv,N=W.sm().ld();if(N&&W.isEditable(N)&&!W.isEditHelperDisabled()&&Dk(N)&&(!W.isFirstPersonMode()||!W.isMouseRoamable()&&!Ze)){sk(W);var P,p=W.isMovable(N),S=W.isRotationEditable(N),y=W.isSizeEditable(N),Q=W._axisXColor,j=W._axisYColor,K=W._axisZColor,B=W._editSizeColor,U=N.p3();if(W.isOrtho()){var _=W.getCenterInfo();P=O(_.width,_.height)/8}else P=Kj(W.getEye(),U)/10;var h,q,o=P/(F?5:10),D=.7*P,C=.4*D,I=U[0],Z=U[1],R=U[2];h=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],p&&z._17O(d,l,N,F,Zs,Q,h,[I,Z-o,R,I+D,Z-o,R,I+D,Z,R,I+D,Z,R,I,Z,R,I,Z-o,R,I,Z-o,R+o,I+D,Z-o,R+o,I+D,Z-o,R,I+D,Z-o,R,I,Z-o,R,I,Z-o,R+o]),q=I+D,y&&z._17O(d,l,N,F,dt,B,h,[q,Z-o,R,q+C,Z-o,R,q+C,Z,R,q+C,Z,R,q,Z,R,q,Z-o,R,q,Z-o,R+o,q+C,Z-o,R+o,q+C,Z-o,R,q+C,Z-o,R,q,Z-o,R,q,Z-o,R+o]),q+=C,S&&z._17O(d,l,N,F,at,Q,h,[q,Z-o,R,q+C,Z-o,R,q+C,Z,R,q+C,Z,R,q,Z,R,q,Z-o,R,q,Z-o,R+o,q+C,Z-o,R+o,q+C,Z-o,R,q+C,Z-o,R,q,Z-o,R,q,Z-o,R+o]),h=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],p&&z._17O(d,l,N,F,$s,j,h,[I,Z,R,I,Z+D,R,I-o,Z+D,R,I-o,Z+D,R,I-o,Z,R,I,Z,R,I,Z,R,I,Z,R-o,I,Z+D,R-o,I,Z+D,R-o,I,Z+D,R,I,Z,R]),q=Z+D,y&&z._17O(d,l,N,F,et,B,h,[I,q,R,I,q+C,R,I-o,q+C,R,I-o,q+C,R,I-o,q,R,I,q,R,I,q,R,I,q,R-o,I,q+C,R-o,I,q+C,R-o,I,q+C,R,I,q,R]),q+=C,S&&z._17O(d,l,N,F,bt,j,h,[I,q,R,I,q+C,R,I-o,q+C,R,I-o,q+C,R,I-o,q,R,I,q,R,I,q,R,I,q,R-o,I,q+C,R-o,I,q+C,R-o,I,q+C,R,I,q,R]),h=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],p&&z._17O(d,l,N,F,_s,K,h,[I,Z,R,I,Z,R+D,I,Z-o,R+D,I,Z-o,R+D,I,Z-o,R,I,Z,R,I,Z-o,R,I-o,Z-o,R,I-o,Z-o,R+D,I-o,Z-o,R+D,I,Z-o,R+D,I,Z-o,R]),q=R+D,y&&z._17O(d,l,N,F,ft,B,h,[I,Z,q,I,Z,q+C,I,Z-o,q+C,I,Z-o,q+C,I,Z-o,q,I,Z,q,I,Z-o,q,I-o,Z-o,q,I-o,Z-o,q+C,I-o,Z-o,q+C,I,Z-o,q+C,I,Z-o,q]),q+=C,S&&z._17O(d,l,N,F,ct,K,h,[I,Z,q,I,Z,q+C,I,Z-o,q+C,I,Z-o,q+C,I,Z-o,q,I,Z,q,I,Z-o,q,I-o,Z-o,q,I-o,Z-o,q+C,I-o,Z-o,q+C,I,Z-o,q+C,I,Z-o,q])}},_17O:function(v,x,B,e,S,X,u,K){var i=this.gv,n=i._buffer,R=El.for(v),t=R.directUniforms(),y=R.directAttribs();if(i._picking){e=i.pickColorMap;var J=gt[S];e[J]={data:B,part:S},t.uFixPickReverseColor=Us(J)}Gb(v,x,$,!0,$,!0,$,!1),t.uDiffuse=X,y.aPosition=Km(v,n.vs,new Ki(K),$),y.aNormal=Km(v,n.ns,new Ki(u),$),Mc(v),vb(v,0,12),ni(v),pl(v,x)}});var ht=A.Raycaster=function(n){this.gv=n,this.maxTriangleTest=1/0,this.backfaceCulling=!0};Mf("Raycaster",b,{intersect:function(W){var O=this,G=O.gv,a=G.getDataAt(W);return a?O.intersectObject(W,a):null},intersectObjects:function($,m,O){var K,C,q,J,j=this,p=1/0,S=$.origin||(new hb).fromArray(j.gv.getEye()),Z=j.maxTriangleTest,f=[];m.forEach(function($){O&&O($)===!1||$.s("intersect")!==!1&&f.push($)});var c=S.distanceToSquared2([0,0,0]);return f.sort(function(H,F){return(H.p3?S.distanceToSquared2(H.p3()):c)-(F.p3?S.distanceToSquared2(F.p3()):c)}),j.countTriangles=0,f.forEach(function(w){j.countTriangles>Z||(K=j.intersectObject($,w),K&&(C=S.distanceToSquared(K.world),p>C&&(q=w,J=K,p=C)))}),j.countTriangles=0,{data:q,intersect:J}},intersectObjectAndRecordTriangle:function(a,n){this._4GQ=!0;var B=this.intersectObject(a,n);return this._4GQ=!1,B},intersectLastTriangle:function(A,r){var Z=this.getRay(A);Z.applyMatrix4(r.inverseMatrix);var c=Z.intersectPlane(r.plane);if(!c)return null;var T=_k.uvIntersection(c,r.p1,r.p2,r.p3,r.uv1.clone(),r.uv2.clone(),r.uv3.clone());return{world:c.clone().applyMatrix4(r.matrixWorld),local:c.clone(),uv:T}},getRay:function(q){if(q instanceof Gi)return q;var _=this,f=_.gv,D=f.unproject(q),E=new hb,P=f.getEye(),Z=new hb;if(f.isOrtho()){var r=new hb(P);Z.copy(f.getCenter()).sub(r).normalize();var M=E.copy(D).sub(r).dot(Z);E.copy(Z).setLength(-M).add(r.copy(D))}else E.copy(P),Z.copy(D).sub(E).normalize();return new A.Math.Ray(E,Z)},intersectObject:function(f,G){return this._intersectObjectImpl(this.getRay(f),G)},_intersectObjectImpl:function(){function H(){var n=new hb;return n.subVectors(L,o),I.subVectors(j,o),n.cross(I).normalize(),n}var W=new Sn,O=new Sn,z=new Gi,l=new hb,e=new hb,f=new hb,x=new hb,G=new hb,j=new hb,o=new hb,L=new hb,r=new Ho,E=new Ho,S=new Ho,I=new hb,N={vs:yr,is:Bl,uv:Pg},k=gd.slice(0);return k.push("csg"),function(w,q){var n=this.gv.getData3dUI(q),a=q.mat||n.mat;a?W.fromArray(a):W.identity(),O.getInverse(W),z.copy(w).applyMatrix4(O);var Z,I,v,Q="body",X=n.shapeModel;if(!X&&(q instanceof A.Polyline||q instanceof A.Edge)&&n.lineShapeModel&&(X=n.lineShapeModel),X||(X=Wj(n)),X||(A.CSGNode&&q instanceof A.CSGNode||A.CSGShape&&q instanceof A.CSGShape?(v=!0,X=[n.left,n.front,n.right,n.back,n.top,n.bottom,n.csg]):q instanceof A.Node&&!(q instanceof A.Shape)?(Z=!0,X=N):(I=!0,X=[n.left,n.front,n.right,n.back,n.top,n.bottom])),!X)return console.log("Can not find shape model."),null;Zf(X)||(X=[X]);var y,J,P,h,M,s,V,i,T,b,F,K,c,p,U,u,Y=1/0,$=["","top_","bottom_"],D=!1,C=this.backfaceCulling,d=[];for(Cm(X,n,d),y=0,J=d.length;J>y;y++)if(c=d[y])for(P=0,h=$.length;h>P;P++)if(p=$[P],V=c[p+"vs"],i=c[p+"is"],T=c[p+"uv"]||c[p+"tuv"],V){if(U=c[p+"boundingBox"]){var F=z.intersectBox(U);if(!F)continue;if(z.origin.distanceTo(F)>Y)continue;u=!1}else c[p+"boundingBox"]=U=new A.Math.Box3,u=!0;for(M=0,s=i?i.length:V.length/3;s>M;M+=3)this.countTriangles++,i?(e.fromArray(V,3*i[M]),f.fromArray(V,3*i[M+1]),x.fromArray(V,3*i[M+2])):(e.fromArray(V,3*M),f.fromArray(V,3*(M+1)),x.fromArray(V,3*(M+2))),u&&(U.expandByPoint(e),U.expandByPoint(f),U.expandByPoint(x)),b=z.intersectTriangle(e,f,x,C,l),b&&(K=z.origin.distanceTo(b),Y>K&&(Y=K,G.copy(b),j.copy(e),o.copy(f),L.copy(x),""!==p?Q=p.slice(0,-1):Z?Q=gd[Math.floor(M/6)]:I?Q=gd[y]:v&&(Q=k[y]),T&&(D=!0,i?(r.fromArray(T,2*i[M]),E.fromArray(T,2*i[M+1]),S.fromArray(T,2*i[M+2])):(r.fromArray(T,2*M),E.fromArray(T,2*(M+1)),S.fromArray(T,2*(M+2))))))}if(!isFinite(Y))return null;var B,R,m=G.clone().applyMatrix4(W),_=this._4GQ;D&&(_&&(R={inverseMatrix:O.clone(),matrixWorld:W.clone(),p1:j.clone(),p2:o.clone(),p3:L.clone(),uv1:r.clone(),uv2:E.clone(),uv3:S.clone(),plane:(new A.Math.Plane).setFromCoplanarPoints(j,o,L)}),B=_k.uvIntersection(G,j,o,L,r,E,S));var t=H(j,o,L),g=H(j.applyMatrix4(W),o.applyMatrix4(W),L.applyMatrix4(W)),dj=z.direction.dot(t);dj>0&&(t.multiplyScalar(-1),g.multiplyScalar(-1));var mk={world:m,local:G.clone(),worldNormal:g,normal:t,uv:B,part:Q};return R&&(mk.triangleInfo=R),mk}}()});var it=function(z,K){this.gv=z,this.s=function(N,n,f){return n==$&&(n=f),n==$?K.getStyle(N):Tp(n,K,z)},this.data=K};bd(it,b,{I3d:!0,ms_icons:1,_iv:!0,_cacheBoundingBox:r,iv:function(){this._iv=!0},update:function(V,P,_){var I=this,j=I.data;if(V||(V=I.gv,P=V.getGL(),_=V._40Q),!I.needValidate(P)||!V.isVisible(j))return _.push(this,!1),void 0;var R,g,z,c,f,d=j._id,w=j._47Q?null:I.s("batch"),k=j.getRenderLayer(),M=_.get(k,!0),h=M.batchIndexMap,H=M.batchModelMap,G=V.getBrightness(j),i=G!=$&&1!==G;R=Dg(h,H,j,w,V);var E=w?V.getBatchInfo(w)||Oe:$,D=I.validate(R,E);if(R&&(!E.ms||!E.ms.length)&&(g=h[d],z=g.size=R.vs.length/3-g.begin,f=R.rs))for(G=i?G:1,c=0;z>c;c++)f.push(G);var C=V.getWireframeGeometry(j);if(C)Uq(V,j,C);else if(Dk(j)){var J=V.getWireframe(j);J&&Uq(V,j,J)}I.labelInfo=I.label2Info=I.noteInfo=I.note2Info=I._38o=$,I._24O(Ni,"getLabel"),I._24O(Di,"getLabel2"),I._26O(sf,"getNote"),I._26O(_b,"getNote2"),I._15O(),I.interactiveInfo=V.isInteractive(j)?{}:$,M.push(this,!0),D!==!1&&(I._iv=!1)},clearWireframeGeometryCache:function(){var U=this;oi(U),U.data.iv()},_46Q:function(P){var z=this,r=z.data,u=z.gv;if(u.isVisible(r)){var c=r._id,j=u._40Q.get(r._renderLayer,!0),Y=j.batchIndexMap[c],I=j.polylineIndexMap[c],D=j.wireframeIndexMap[c];if(Y||I||D){var X=Sr(P,u.pickColorMap,u.isSelectable(r),z,Ef,!0);X&&(Vm(X,Y,j.batchModelMap,u),Vm(X,I,j.polylineModelMap,u),Vm(X,D,j.wireframeModelMap,u))}}},_42:function(i,e,W){function s(O,G,C){var v=G.getBrightness(C),R=C.s("alphaTest"),r=C.s("envmap"),V=El.for(O),U=V.directUniforms();v!=$&&1!==v&&(U.uBrightness=v),U.uAlphaTest=R,U.uUseEnvMap=r?!0:!1,U.uReflectivity=r||.01,U.roughness=C.s("roughness"),G._setEnvmapByProbeId(U,C.s("envmap.probe")),U.shadowReceive=!Y&&C.s("shadow.receive"),U.shadowCull=!Y&&!!C.s("shadow.cull"),qj(G,U,C.s("3d.clipbox")?Ak:C.s("3d.clipbox.mask"));var P=d.s("3d.clip.direction");if(P){var j=d.s("3d.clip.percentage");0===j&&(J=!1);var X=d._formatClipUniforms(P,j,C);U.uClipPercent=X[1],U.uClipDirection=X[0]}else U.uClipDirection=0;O._blooming&&!C.s("bloom")&&(U.blackout=!0),Y||(G._flowObjects.length&&G.flowMap.resetDataFlowEnabld(C,U),xs(G,U,C.s("light.mask"),C.s("headlight.ambientIntensity")))}var d=this,j=d.data,B=d.gv;if(B.isVisible(j)){var h,Y=B._picking;if(Y)h=B.pickColorMap;else{if(B.isTransparentMask(j)||B.isReflecting(i)&&j.s("3d.reflectable")===!1)return;h=r}if(it.getTitle===r){it.getTitle=0;for(var f in u)if(f.length===Di.length+1&&f[Di.length]===mk[4].toUpperCase()&&f[Di.length-1]===mk[Di.length+1].toUpperCase()){it.getTitle=wg;break}}if(!it.getTitle||Rn[Di.length+2]){if(it.getHead===r){it.getHead=0;for(var f in R){var O="box-sizing";6===f.length&&f[0]===mk[4]&&f[3]===O[0]&&f[4]===O[1]&&f[5]===O[2]&&(it.getHead=up)}}if(!it.getHead||Rn[Di.length]){if(it.getTitle2===r){it.getTitle2=0;for(var f in R){var G="uv";6===f.length&&f[0]===sr[1].toUpperCase()&&f[1]===G[0]&&(it.getTitle2=Pm)}}if(!it.getTitle2||Rn[ap.length]){var n,A,w=j._id,Z=B._40Q.get(j._renderLayer,!0),l=Z.batchIndexMap,X=Z.batchModelMap,k=B.isSelectable(j),L=!1,J=!0,V=l[w];if(Y&&(A=Sr(i,h,k,d,Ef,V),A&&!B._45Q&&(Vm(A,V,X,B),Vm(A,Z.polylineIndexMap[w],Z.polylineModelMap,B),Vm(A,Z.wireframeIndexMap[w],Z.wireframeModelMap,B))),V||(L||(L=!0,s(i,B,j)),J&&d._80o(i,e,W)),B.isLabelVisible(j)&&((n=d.labelInfo)&&(Y&&Sr(i,h,k,d,Ni),L||(L=!0,s(i,B,j)),d._28O(n,Ni,W)),(n=d.label2Info)&&(Y&&Sr(i,h,k,d,Di),L||(L=!0,s(i,B,j)),d._28O(n,Di,W))),B.isNoteVisible(j)&&((n=d.noteInfo)&&(Y&&Sr(i,h,k,d,sf),L||(L=!0,s(i,B,j)),d._29O(n,sf,W)),(n=d.note2Info)&&(Y&&Sr(i,h,k,d,_b),L||(L=!0,s(i,B,j)),d._29O(n,_b,W))),(n=d._38o)&&(L||(L=!0,s(i,B,j)),d._99O(i,e,n,h,k,W)),L){var _=El.for(i).directUniforms();_.uBrightness=1,_.uClipDirection=0,i._blooming&&(_.blackout=!1)}}}}}},_formatClipUniforms:function(x,m,B){switch(x){case"uv.right":x=7;break;case"uv.left":x=8;break;case"left":x=2;break;case"top":x=3;break;case"bottom":x=4;break;case"front":x=5;break;case"back":x=6;break;case"right":default:x=1}if(0===x%2&&(m=1-m),7!==x&&8!==x)if(B instanceof A.Shape){var G=B.s3(),X=B.p3(),Z=B.getAnchor3d();m=3>x?(m-Z.x)*G[0]+X[0]:5>x?(m-Z.y)*G[1]+X[1]:(m-Z.z)*G[2]+X[2]}else m-=.5;return[x,m]},prepare:function(){var q=this,z=q.data;if(!(z instanceof el)){var R,y,L,s,u,E=q.gv,t=E.getGL(),j=z._id,W=q.s("batch"),n=E._batchIndexMap,k=E._batchModelMap,a=E.getBrightness(z),F=a!=$&&1!==a;if(q.needValidate(t)){R=Dg(n,k,z,W,E);var r=W?E.getBatchInfo(W)||Oe:$;if(q.validate(R,r),R&&(!r.ms||!r.ms.length)&&(y=n[j],L=y.size=R.vs.length/3-y.begin,u=R.rs))for(a=F?a:1,s=0;L>s;s++)u.push(a);if(Dk(z)){var T=E.getWireframeGeometry(z);if(T)Uq(E,z,T);else{var d=E.getWireframe(z);d&&Uq(E,z,d)}}q.labelInfo=q.label2Info=q.noteInfo=q.note2Info=q._38o=$,q._24O(Ni,"getLabel"),q._24O(Di,"getLabel2"),q._26O(sf,"getNote"),q._26O(_b,"getNote2"),q._15O(),q.interactiveInfo=E.isInteractive(z)?{}:$,q._iv=!1}}},dispatchBoundingBoxChanged:function(){this._cacheBoundingBox=r},getBoundingBox:function(){var O,c,z,C,s,R;return function(){if(this._cacheBoundingBox)return this._cacheBoundingBox;O||(O={vs:yr,is:Bl,uv:Pg},c=new hb,z=new hb,C=new hb,s=new hb,R=new hb);var E=this,i=E.data,_=E.shapeModel;if(!_&&(i instanceof A.Polyline||i instanceof A.Edge)&&E.lineShapeModel&&(_=E.lineShapeModel),_||(_=Wj(E)),_||(A.CSGNode&&i instanceof A.CSGNode||A.CSGShape&&i instanceof A.CSGShape?(isCSG=!0,_=[E.left,E.front,E.right,E.back,E.top,E.bottom,E.csg]):i instanceof A.Node&&!(i instanceof A.Shape)?_=O:(E.left||E.front||E.right||E.back||E.top||E.bottom)&&(_=[E.left,E.front,E.right,E.back,E.top,E.bottom])),!_)return r;Zf(_)||(_=[_]);var G,q,g,D,k,n,u,d,J,L,Q,x,K=["","top_","bottom_"],X=new A.Math.Box3,o=!1;if(E._needRecoverPosition){s.set.apply(s,i.p3());var l=i.s3();R.set(1/(l[0]||1),1/(l[1]||1),1/(l[2]||1))}else s.set(0,0,0),R.set(1,1,1);var y=[];for(Cm(_,E,y),G=0,q=y.length;q>G;G++)if(J=y[G])for(g=0,D=K.length;D>g;g++)if(L=K[g],u=J[L+"vs"],d=J[L+"is"],u){if(x=L+"boundingBox",Q=J[x],!Q)for(J[x]=Q=new A.Math.Box3,k=0,n=d?d.length:u.length/3;n>k;k+=3)d?(c.fromArray(u,3*d[k]).sub(s).multiply(R),z.fromArray(u,3*d[k+1]).sub(s).multiply(R),C.fromArray(u,3*d[k+2]).sub(s).multiply(R)):(c.fromArray(u,3*k).sub(s).multiply(R),z.fromArray(u,3*(k+1)).sub(s).multiply(R),C.fromArray(u,3*(k+2)).sub(s).multiply(R)),!c.isNaN()&&Q.expandByPoint(c),!z.isNaN()&&Q.expandByPoint(z),!C.isNaN()&&Q.expandByPoint(C);X.expandByBox(Q),o=!0}return o?(this._cacheBoundingBox=X,b.freeze(X),b.freeze(X.min),b.freeze(X.max),As(E.gv,i),X):r}}(),needValidate:function(){return this._iv},validate:function(){},_16O:function(){return Jd},_80o:function(){},dispose:function(){var I=this,h=I._pickId;if(h){var P=I.gv.pickColorMap;P[h]&&delete P[h]}},getBodyColor:function(h){var j=this.data,r=this.gv.getBodyColor(j);return r?r:h?j.getStyle(h):$},contextLost:function(){this._cachedTextures&&this.gv.invalidateCachedTexture(this.data)},getCachedTexture:function(q){var E=this._cachedTextures;return E?E[q||"main"]:null},setCachedTexture:function(P,w){var h=this._cachedTextures;return h||(h=this._cachedTextures={}),h[w||"main"]=P,P},invalidateCachedTexture:function(p){var S=this._cachedTextures;if(S){for(var t in S)p.deleteTexture(S[t]);this._cachedTextures={}}},invalidateCachedGeometry:function(){},_24O:function(R,e){var I=this,v=I.data,l=I.gv,T=I.s,H=l[e](v);if(H!=$){var z=T(R+".scale"),a=T(R+".max"),S=I[R+"Info"]={label:H,textureScale:T(R+".texture.scale"),color:l[e+"Color"](v),font:T(R+".font"),align:T(R+".align"),background:l[e+"Background"](v)},D=S.rect=nn(S,H);a>0&&a<D.width&&(S.labelWidth=D.width,D.width=a),D.x=D.y=0,D.width*=z,D.height*=z,S.mat=I._16O(T(R+".autorotate"),T(R+".position"),D,T(R+".face"),T(R+".t3"),T(R+".r3"),T(R+".rotationMode"));var c=D.width/2,X=D.height/2;S.vs=new Ki([-c,X,0,-c,-X,0,c,-X,0,c,X,0]),D.width/=z,D.height/=z}},_26O:function(x,Y){var F=this,M=F.data,R=F.gv,k=F.s,c=R[Y](M);if(c!=$){var e=k(x+".scale"),q=this[x+"Info"]={note:c,textureScale:k(x+".texture.scale"),expanded:k(x+".expanded"),font:k(x+".font"),color:k(x+".color"),align:k(x+".align"),borderWidth:k(x+".border.width"),borderColor:k(x+".border.color"),background:R[Y+"Background"](M)};if(q.expanded){var W=k(x+".max"),b=nn(q,c);b.width+=6,b.height+=2,W>0&&W<b.width&&(q.labelWidth=b.width,b.width=W);var D={x:-b.width/2,y:-8-b.height,width:b.width,height:b.height+8}}else D={x:-6,y:-18,width:12,height:18};q.mat=F._16O(k(x+".autorotate"),k(x+".position"),$,k(x+".face"),k(x+".t3"),k(x+".r3"),k(x+".rotationMode")),q.rect=D,1!==e&&(D=Bf(D),D.x*=e,D.height*=e,D.y=-D.height,D.width*=e);var f=D.x,g=D.y,B=D.width,v=D.height;q.vs=new Ki([f,-g,0,f,-g-v,0,f+B,-g-v,0,f+B,-g,0])}},eachShapeModel:function(r,T){function $(U){zb(U),U.vs&&r(U.vs,U.is,U.ns,U.uv),U.top_vs&&r(U.top_vs,U.top_is,U.top_ns,U.top_uv),U.bottom_vs&&r(U.bottom_vs,U.bottom_is,U.bottom_ns,U.bottom_uv),U.from_vs&&r(U.from_vs,U.from_is,U.from_ns,U.from_uv),U.to_vs&&r(U.to_vs,U.to_is,U.to_ns,U.to_uv)}function J(U){var P,x,o;if(Zf(U))for(x=0,o=U.length;o>x;x++)P=U[x],P&&J(P);else ph(U)?J(Wj(h,U),h):Tq(U)&&(U.shape3d?J(U.shape3d):$(U))}var h=this,l=h.data,T=T||h.shapeModel||Wj(h);T||(T=l instanceof A.Node&&!(l instanceof A.Shape)?{vs:yr,is:Bl}:[h.left,h.front,h.right,h.back,h.top,h.bottom]),J(T)},_28O:function(D,e,o){if(o(this.s(e+".transparent"))){var X=D.rect,K=D.textureScale,m=X.width*K,w=X.height*K;if(m>=1&&w>=1){var n=Ap(m,w);1!==K&&(n.translate(X.x,X.y),n.scale(K,K),n.translate(-X.x,-X.y)),Ek(n,D),n.restore(),fi(this,e,D.mat,D.vs,!0)}}},_29O:function(t,i,R){if(R(this.s(i+".transparent"))){var X=t.rect,b=t.textureScale,S=X.x,P=X.y,e=X.width*b,D=X.height*b;if(e>=1&&D>=1){X.x=X.y=0;var x=Ap(e,D);1!==b&&x.scale(b,b),ji(x,t),x.restore(),X.x=S,X.y=P,fi(this,i,t.mat,t.vs,!1)}}},_99O:function(t,y,P,Z,j,r){if(P){var g=this,E=g.gv,c=g.data,k=E._buffer,X=E._1O,O=P.icons,_=El.for(t),o=_.directAttribs();for(var q in O){var K=O[q],p=P.rects[q];if(p&&r(Tp(K.transparent,c,E))){E._picking&&Sr(t,Z,j,g,q);var I=Tp(K.shape3d,c,E),V=I?[I]:Tp(K.names,c,E),s=V?V.length:0,u=Tp(K.textureScale,c,E)||1,C=Tp(K.light,c,E);C==$&&(C=I?!0:!1),Gb(t,y,Tp(K.blend,c,E),C,Tp(K.opacity,c,E),Tp(K.reverseFlip,c,E),Tp(K.reverseColor,c,E),Tp(K.reverseCull,c,E));for(var v=0;s>v;v++){var J=V[v],L=p[v];if(gq(g,L.mat),I)Dd(E,c,Wj(g,I),g);else{var U=Of(J);if(U){var F=L.width*u,Q=L.height*u;if(F>=1&&Q>=1){var l=Ap(F,Q);Gp(l,U,Tp(K.stretch,c,E),0,0,F,Q,c,E),l.restore(),gs(t,bk,X),Mc(t,y,X,Tp(K.discardSelectable,c,E),k.uv,Ir),o.aPosition=Km(t,k.vs,L.vs,$),o.aNormal=Nr(t,k.ns,$k,$),Kf(t,k.is,$i),Ae(t,0,$i.length),ni(t,y,X)}}}xl(E)}pl(t,y)}}}}});var jt=function(Q,_){ud(jt,this,[Q,_])};bd(jt,it,{_16O:function(M,$,G,W,Q,f,e,x,H){var O=this.data,s=O.getFinalScale3d(),N=_e($,s,G,W,x,H);if(O.hasOwnProperty("_anchor")||O.hasOwnProperty("_anchorElevation")){var t=O.getAnchor3d();N[0]-=(t.x-.5)*s[0],N[1]-=(t.y-.5)*s[1],N[2]-=(t.z-.5)*s[2]}return nm(Kl(),N,O.p3(),W,Q,f,e,M,O.getFinalRotation3d(),O.getRotationMode())},clear:function(){var m=this;m.faceMat=m.mat=m.shapeModel=m.left=m.right=m.front=m.back=m.top=m.bottom=m.csg=$},needValidate:function(z){if(this._iv)return this._validateFrameId=z._renderInfo.frame,!0;if(this.data._47Q){var v=z._renderInfo.frame;if(this._validateFrameId!==v)return this._validateFrameId=v,!0}return!1},validate:function(j,b){var A=this,Z=A.gv,V=A.data,Y=A.shapeName=A.s(lp),e=Wj(A,Y);if(A._updateAutoRotation(),A._updateFixSize2d(),A._updateOverlapping(),A.dispatchBoundingBoxChanged(),V._47Q){var w=V.getRenderLayer(),X=Z._40Q.get(w);X&&X.ivWireframeBatch(V)}var q=Zi(V,Z.getMat(V),e?A.s("shape3d.scaleable"):!0);if(V.appendAnchorMatrix3d(q),A.clear(),A.mat=V.mat=q,e||!Y)if(A.shapeModel=e,j)if(e)b.instanced?Z.batchInstancedModel(V,e,A,A.getBodyColor(),[q],j):Bn(Z,V,e,A,A.getBodyColor(),[q],j);else{var s=eg(q);b.instanced?Z.batchInstancedFace(V,j,b,q,s):Ue(Z,V,j,b,q,s)}else e||(A._cubeUvs=null,A.vf(sl,0),A.vf(vp,16),A.vf(Er,8),A.vf(yc,24),A.vf(Yd,32),A.vf(gg,40))},_updateAutoRotation:function(){var X=new Mn,j=new Sn,i=new hb,u=new hb,g=new hb;return function(){var q=this,p=q.data,c=q.s("autorotate")||q.s("shape3d.autorotate");if(!c)return p._dynamicRotation&&delete p._dynamicRotation,void 0;var v=q.gv;g.copy(q.s("shape3d.autorotate.up")||v._up);var A;A="string"==typeof c?[c.indexOf("x")<0?v._eye[0]:v._center[0],c.indexOf("y")<0?v._eye[1]:v._center[1],c.indexOf("z")<0?v._eye[2]:v._center[2]]:v._eye;var J=v._center,U=p.p3();i.copy(U),u.set(A[0]-J[0],A[1]-J[1],A[2]-J[2]).add(i),j.lookAt(u,i,g),X.set(0,0,0,p.getRotationMode(),!0).setFromRotationMatrix(j);var z=p._dynamicRotation;z&&Math.abs(z[0]-X.x)<1e-5&&Math.abs(z[1]-X.y)<1e-5&&Math.abs(z[2]-X.z)<1e-5||(p._dynamicRotation=[X.x,X.y,X.z])}}(),_updateFixSize2d:function(){var K=this,y=K.data,C=K.s("fixSizeOnScreen")||K.s("shape3d.fixSizeOnScreen");if(!C)return y._dynamicScale3d&&delete y._dynamicScale3d,void 0;var Q=K.gv,I=Zi(y,Q.getMat(y)),T=Vk([0,0,0],I),Z=Q.toViewPosition(T);if(!isNaN(Z.x)&&!isNaN(Z.y)){var D=Vk([1,0,0],I),k=Q.toViewPosition(D),O=Vk([0,1,0],I),A=Q.toViewPosition(O),b=k.x-Z.x,x=A.y-Z.y;if(b&&x){var E,d,m=y._dynamicScale3d||[1,1,1],F=Of(y.s("shape3d.image"));if(C[0]>0&&(E=C[0]),C[1]>0&&(d=C[1]),!E||!d){var e=C>0?C:1;E||(E=(Hn(F,y)||y.getWidth())*e),d||(d=(ks(F,y)||y.getTall())*e)}var N=Math.abs(b/E),r=Math.abs(x/d);Math.abs(N-1)<.001&&Math.abs(r-1)<.001||(y._dynamicScale3d=[m[0]/N,m[1]/r,m[2]])}}},_updateOverlapping:function(){var F=this,d=F.s("hide.overlapping.group");if(!d)return F._rectOverlapping&&(F._rectOverlapping=r),void 0;var S,j,q,Z=F.gv,u=F.data,E=Zi(u,Z.getMat(u)),b=1/0,D=1/0,H=-1/0,o=-1/0,N=u.getAnchor3d(),V=N.x,T=N.y,Y=N.z;for(S=0;8>S;S++){if(j=Vk([(S>>2)-V,(1&S>>1)-T,(1&S)-Y],E),q=Z.toViewPosition(j),isNaN(q.x)||isNaN(q.y))return;b=Math.min(b,q.x),H=Math.max(H,q.x),D=Math.min(D,q.y),o=Math.max(o,q.y)}var R={x:b,y:D,w:H-b,h:o-D};F._rectOverlapping=Z.overlappingBox.isOverlapping(d,R)},getVectorDynamicSize:function(){var q,O=this,X=O.s("shape3d"),e=O.data;if("billboard"===X||"plane"===X||(q=e._currentCubeElementId)!=$){var w,u,L=O.gv,Y=Zi(e,L.getMat(e)),P=e.getAnchor3d(),N=.5-P.x,t=.5-P.y,c=.5-P.z,m=Math.min(O.s("vector.dynamic.maxsize"),L._glCapabilities.maxTextureSize)/L.getDevicePixelRatio(),W=function(M,E){M[0]+=N,M[1]+=t,M[2]+=c,E[0]+=N,E[1]+=t,E[2]+=c;var O=L.toViewPosition(Vk(M,Y)),i=L.toViewPosition(Vk(E,Y)),u=O.x-i.x,J=O.y-i.y;return Math.min(m,Math.sqrt(u*u+J*J))};if("billboard"===X)w=W([-.5,0,0],[.5,0,0]),u=W([0,-.5,0],[0,.5,0]);else if("plane"===X)w=W([-.5,0,0],[.5,0,0]),u=W([0,0,-.5],[0,0,.5]);else if(e._currentCubeElementId!=$){var B=3*Bl[q+1],p=3*Bl[q],U=3*Bl[q+2];w=W([yr[B],yr[B+1],yr[B+2]],[yr[U],yr[U+1],yr[U+2]]),u=W([yr[B],yr[B+1],yr[B+2]],[yr[p],yr[p+1],yr[p+2]])}return[w,u]}},vf:function(t,p){var Z=this;if(Z.gv.getFaceVisible(Z.data,t)){var C=fd(Z,t);C.mat&&(Z.faceMat=!0);var W=C.uv;if(W){var u=Z._cubeUvs;u||(u=Z._cubeUvs=new Ki([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var b=0;8>b;b++)u[p+b]=W[b]}return C}},_billboardInView:function(){var b=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],k=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],z=new Pn,m=new hb,E=new Sn;return function(N){var R=this;if(!R.mat)return!0;var t=R.gv.getFrustum(),Z="billboard"===N?b:k;z.makeEmpty(),E.fromArray(R.mat);for(var J=0,q=Z.length;q>J;J+=3)z.expandByPoint(m.fromArray(Z,J).applyMatrix4(E));return t.intersectsBox(z)}}(),_80o:function(g,Q,D){var I=this;if(I._rectOverlapping)return!0;var Y=I.shapeModel;if(Y||!I.shapeName){var b=I.s("shape3d");if(("billboard"===b||"plane"===b)&&!I._billboardInView(b))return!0;var J=I.gv,r=I.data,y=J._cube,C=El.for(g),p=C.directAttribs();if(Vq&&!Zk){var i=I.mat;if(i)for(var P=0;P<i.length;P++)I.mat[P]=i[i.length-P-1]}sk(J,I.mat),!g._picking&&I.s("shape3d.reflector")||I.s("effect.flow")||(Y?Dd(J,r,Y,I,I.getBodyColor(),D):(p.aPosition=Km(g,y.vs,$,$),p.aNormal=Km(g,y.ns,$,$),jf(g,y.is),I._18O(g,Q,"left",0,D),I._18O(g,Q,"front",6,D),I._18O(g,Q,"right",12,D),I._18O(g,Q,"back",18,D),I._18O(g,Q,"top",24,D),I._18O(g,Q,"bottom",30,D))),xl(J),I.faceMat&&(I._18O(g,Q,"left",0,D,!0),I._18O(g,Q,"front",6,D,!0),I._18O(g,Q,"right",12,D,!0),I._18O(g,Q,"back",18,D,!0),I._18O(g,Q,"top",24,D,!0),I._18O(g,Q,"bottom",30,D,!0))
}},_18O:function(D,A,k,l,S,f){var L=this[k];if(L){if(!S(L.transparent))return;if(f&&!L.mat||!f&&L.mat)return;var V=this.data.s("polygonOffset");V&&He(D,V),f&&sk(this.gv,L.mat);var E=this,P=E.data,m=El.for(D),T=m.directUniforms();P._currentCubeElementId=l;var n=E.gv,w=n.getTexture(L.texture,P,k),d=L.uv,Z=L.uvScale,h=L.uvOffset,K=L.uvRotation,M=L.uvAnchor,_=L.discardSelectable;w?d?Mc(D,A,w,_,n._buffer.uv,E._cubeUvs,h,Z,K,M):Mc(D,A,w,_,n._cube.uv,$,h,Z,K,M):Mc(D),Gb(D,A,L.blend,L.light,L.opacity,L.reverseFlip,L.reverseColor,L.reverseCull),T.uDiffuse=L.color||x["color.empty"],Ae(D,l,6),pl(D,A),ni(D,A,w),f&&xl(n),V&&Wn(D),P._currentCubeElementId=null}},contextLost:function(){jt.superClass.contextLost.apply(this,arguments),this.data.s("shape3d.reflector")&&(this._reflectorRenderTarget=null,this._reflectNormal=null)},drawReflector:function(){var a=new hb,B=new hb,V=new Mn,i=new Sn,I=new hb,M=new hb,b=new hb,E=new hb,q=new Sn,j=new Sn,R=new Ke,F=new jh,k=new jh,S=function(q,K,y){q[y]=K[0],q[y+1]=K[1],q[y+2]=K[2]},D=function(_,v,V){V=V||0,_[0]=v[V],_[1]=v[V+1],_[2]=v[V+2]},t=function(F,n){S(F,n.getEye(),0),S(F,n.getCenter(),3),S(F,n.getUp(),6)},J=function(g,j){D(j._eye,g,0),D(j._center,g,3),D(j._up,g,6),j._18Q=$;var G=j._skybox;G&&(G.p3([g[0],g[1],g[2]]),j.getData3dUI(G).iv())};return function(v){var Q=this;Q._reflectorInfo=null;var z=Q.data;if(z._reflecting)return!1;var W=Q.gv;if(W._picking)return!1;var P=z instanceof ck,s=Q._reflectorRenderTarget,p=W._canvas.width,f=W._canvas.height;if(s?s.setSize(v,p,f):s=Q._reflectorRenderTarget=new Fr.RenderTarget(W,v,p,f),P){var T=z.getPointsMatrix3d().getElements(),d=z.p3();d[1]+=(1-z.getAnchorElevation())*z.getTall(),a.copy(Vk(d,T))}else a.copy(z.p3());if(B.copy(W.getEye()),i.makeRotationFromEuler(V.set(z.r3(),z.getRotationMode(),!0)),!Q._reflectNormal){var c;if(P&&z.getThickness()<0){if(!Q.shapeModel||!Q.shapeModel.top_vs)return!1;c={vs:Q.shapeModel.top_vs,ns:Q.shapeModel.top_ns}}else{if(c=Wj(Q,Q.s("shape3d")),!c)return!1;!c.ns&&c.length&&(c=c[0])}if(!c.ns||!c.vs)return!1;Q._reflectNormal=[c.ns[0],c.ns[1],c.ns[2]],Q._reflectorVbuffer=rn.Buffer.createVertexBuffer(v,new Float32Array(c.vs))}if(I.copy(Q._reflectNormal),I.applyMatrix4(i),M.subVectors(a,B),M.dot(I)>0)return!1;M.reflect(I).negate(),M.add(a),b.copy(W.getCenter()).negate().add(a),b.reflect(I).negate(),b.add(a),E.copy(W.getUp()),E.reflect(I);var S=[0,0,0,0,0,0,0,0,0];t(S,W),D(W._eye,M.toArray()),D(W._center,b.toArray()),D(W._up,E.toArray()),W._18Q=$;var _=W._skybox;_&&(_.p3(W._eye),W.getData3dUI(_).iv()),Xg(v,s.frame),W.setViewport(v,0,0,s.width,s.height);var m=z.s("shape3d.reflector.background");if(m){var n=v.getParameter(v.COLOR_CLEAR_VALUE);gp(v,m)}else gp(v,[0,0,0,1]);El.for(v).glState.depth.mask=!0,v.clear(v.COLOR_BUFFER_BIT|v.DEPTH_BUFFER_BIT);var O=z.s("shape3d.reflector.clip"),x=O===r?.003:O,U=Ck(W),Y=ro(W);R.setFromNormalAndCoplanarPoint(I,a.add(I.clone().multiplyScalar(x))),R.applyMatrix4(j.fromArray(Y)),F.set(R.normal.x,R.normal.y,R.normal.z,R.constant),j.fromArray(U).getInverse(j),k.set(Math.sign(F.x),Math.sign(F.y),1,1).applyMatrix4(j),F.multiplyScalar(2/F.dot(k)),U[2]=F.x-U[3],U[6]=F.y-U[7],U[10]=F.z-U[11],U[14]=F.w-U[15];var o=W._computedProjectMatrix;W._computedProjectMatrix=U,z._reflecting=!0;var C=z.s("shape3d.reflector.shadow"),X={renderAxis:!1,renderEdit:!1,renderGrid:!1};"disabled"===C?(X.createShadowMap=!1,X.renderShadow=!1):"scene"===C?X.createShadowMap=!1:X.useReflectorSelfShadowMap=!0,W.renderScene(X),W._computedProjectMatrix=o,q.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),q.multiply(j.fromArray(W._projectMatrix)),q.multiply(j.fromArray(W._viewMatrix)),m&&gp(v,n),Lp(v),J(S,W);var h=z.s("shape3d.reflector.blur");if(h){var y=W.getPostProcessingModule("Blur");y&&y.drawImpl(v,s,h,h>=3,z.s("shape3d.reflector.blur.iterations"))}var u=W.getPostProcessingModule("Glitch");u&&u.enable&&u.onlyReflector&&(s=u._42(v,s));var L=v._compiledShader.reflector;L||(L=v._compiledShader.reflector=new rn.Shader(v,tk.Reflector.vs,tk.Reflector.fs)),L.bind(),v.activeTexture(v.TEXTURE0),kf(v,s.texture),L.uniforms.tDiffuse=0,L.uniforms.color=th(z.s("shape3d.reflector.color")||"rgb(128,128,128)"),L.uniforms.textureMatrix=q.toArray(),L.uniforms.modelMatrix=P?T:Zi(z),L.uniforms.viewMatrix=ro(W),L.uniforms.projectionMatrix=Ck(W);var e=Q._reflectorVbuffer;e.upload(),L.attributes.pos.pointer(e);var G=this.s("shape3d.transparent");if(G){var Z=El.for(v).glState,K=Z.depth.mask;Z.depth.mask=!1}return v.drawArrays(v.TRIANGLES,0,e.data.length/3),G&&(Z.depth.mask=K),z._reflecting=!1,v.useProgram(W._prg),kf(v,$),!0}}()}),tk.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );","}"].join("\n")};var kt=function(z,O){ud(kt,this,[z,O])};bd(kt,jt,{_80o:function(){}});var lt=function(K,h){ud(lt,this,[K,h])};bd(lt,it,{_25Q:1,validate:function(j){var N=this;if(!N.s("geometry.cache")||!N.info){var x=N.gv,E=N.data,G=N.s,z=G("edge.width"),M=E._40I,X=E._41I;if(N.shapeModel=N.info=N.lineShapeModel=$,M&&X){var k,W,b,q,c,A,m,F,S,Q,U=E.isLooped(),o=G(uf),C=u.getEdgeType(o);if(C){var g=C(E,Co(N,x,E,U,o),x,N._19Q);if(!g.points||g.points.isEmpty())return;A=N.info={},m=g.segments,c=g.points,F=c.size();for(var n=M.getElevation(),s=X.getElevation(),h=0;F>h;h++){var K=c.get(h);K.e==$&&(K.e=n+(s-n)*h/(F-1))}S=sm(c.get(0)),Q=sm(c.get(F-1));var _=F%2,P=(F-_)/2;A.c1=sm(c.get(P-1)),A.c2=sm(c.get(P)),0!==_&&(A.p3=A.c2),A.s1=S,A.s2=sm(c.get(1)),A.t1=sm(c.get(F-2)),A.t2=Q}else{c=new Od,A=N.info={};var I=G("edge.offset"),D=G("edge.center"),l=G("edge.source.t3"),L=G("edge.target.t3"),y=Jr(x,E,"source"),v=Jr(x,E,"target");if(!y||!v)return x.invalidateData(E),delete N.info,!1;if(l&&(y[0]+=l[0],y[1]+=l[1],y[2]+=l[2]),L&&(v[0]+=L[0],v[1]+=L[1],v[2]+=L[2]),o===no){m=G("edge.segments");var T=A.points=G(sp)||Cs;if(F=T.size()){if(S=sm(T.get(0)),Q=sm(T.get(F-1)),!D&&I){var H=I;b=Ur(S,y,!0),I=O(H,Kj(y,S)),y=[y[0]+b[0]*I,y[1]+b[1]*I,y[2]+b[2]*I],b=Ur(v,Q,!0),I=O(H,Kj(Q,v)),v=[v[0]-b[0]*I,v[1]-b[1]*I,v[2]-b[2]*I]}if(1===F)A.p3=S;else{var _=F%2,P=(F-_)/2;k=sm(T.get(P-1)),W=sm(T.get(P)),0!==_&&(A.p3=W),A.s1=y,A.s2=S,A.t1=Q,A.t2=v}}else!D&&I&&(b=Ur(v,y,!0),q=Kj(y,v),I=_j(I,q),y=[y[0]+b[0]*I,y[1]+b[1]*I,y[2]+b[2]*I],v=[v[0]-b[0]*I,v[1]-b[1]*I,v[2]-b[2]*I]),k=y,W=v;c.add({x:y[0],y:y[2],e:y[1]}),c.addAll(T),c.add({x:v[0],y:v[2],e:v[1]})}else{var r=Co(N,x,E,U,o);if(N._19Q||(r=-r),U){var R=y[0],w=y[1],a=y[2],t=M.getTall()/2+r;k=[R-r,w+t,a],W=[R+r,w+t,a],c.add({x:R-r,y:a,e:w}),c.add({x:R-r,y:a,e:w+t}),c.add({x:R+r,y:a,e:w+t}),c.add({x:R+r,y:a,e:w})}else{b=Ur(v,y,!0),q=Kj(y,v);var d={x:y[0],y:y[2]},f={x:v[0],y:v[2]},Y=_d($,d,f,r),J=Y.x-d.x,B=Y.y-d.y;I=_j(I,q),b[0]*=I,b[1]*=I,b[2]*=I,k=[y[0]+b[0]+J,y[1]+b[1],y[2]+b[2]+B],W=[v[0]-b[0]+J,v[1]-b[1],v[2]-b[2]+B],D?(c.add({x:y[0],y:y[2],e:y[1]}),c.add({x:k[0],y:k[2],e:k[1]}),c.add({x:W[0],y:W[2],e:W[1]}),c.add({x:v[0],y:v[2],e:v[1]})):(c.add({x:k[0],y:k[2],e:k[1]}),c.add({x:W[0],y:W[2],e:W[1]}))}}A.c1=k,A.c2=W}A._lastPointsSegments={points:c,segments:m},A.list=G(lp)===ym?N.createTubeModel(c,m,z/2,j):N.createLineModel(c,m,z,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=$}});var mt=function(l,b){ud(mt,this,[l,b]),this._needRecoverPosition=!0};bd(mt,jt,{_80o:function(T,C,a){var V=this,g=V._matWithExtraction||V.mat;if(g&&(!V.s("shape3d.reflector")||T._picking)){var z=V.gv,_=V.shapeModel;sk(z,g),_?Dd(z,V.data,_,V,V.getBodyColor(),a):(bh(V,T,C,"left",a),bh(V,T,C,"front",a),bh(V,T,C,"right",a),bh(V,T,C,"back",a),bh(V,T,C,"top",a),bh(V,T,C,"bottom",a)),xl(z)}},validate:function(e,Q){var s,r,f=this,h=f.s,G=f.data,b=G._thickness/2,E=G.isClosePath(),x=G.getPoints(),F=G.getSegments(),t=h(pp),H=e&&e.uv;if(f.clear(),f.dispatchBoundingBoxChanged(),u.extractShapeTranslation||u.extractVerticesTranslation){var n=new ke.Vector3(G.p3());x=Bf(x),x.forEach(function(g){g.x-=n.x,g.y-=n.z}),f._vsTranslation=(new ke.Matrix4).setPosition(n);var V=G.getShapeElevation;G.getShapeElevation=function(){return-(this.getTall()||0)*(this._anchorElevation-.5)}}else f._vsTranslation=null;if(0>b){f.s("shape3d.reflector")&&(f._reflectNormal=null);try{var a=h("shape3d.image.projection");if(a&&a[4]){var C=G.p3(),K=C[0],L=C[2];a=[K+a[0],a[1]+L,K+a[2],a[3]+L]}r=f.shapeModel=Un(x,F,h(Ul),h(se),t,h(em),G.getTall(),G.getShapeElevation(),E,a)}catch(A){r=f.shapeModel={}}h(on)?h("shape3d.image")||delete r.uv:(delete r.vs,delete r.ns,delete r.uv),h("shape3d.top.image")||delete r.top_uv,h("shape3d.bottom.image")||delete r.bottom_uv}else if(h(lp)===ym)s=Mp(x,F,t,E),r=f.shapeModel={vs:[]},h("shape3d.image")&&(r.uv=[],r.sum=h(em)||Ud(s)||1,r.len=0),h(Ul)&&!E&&(r.top_vs=[],h("shape3d.top.image")&&(r.top_uv=[])),h(se)&&!E&&(r.bottom_vs=[],h("shape3d.bottom.image")&&(r.bottom_uv=[])),f._12O(s,b);else{var W,i,J,U,S,M,k,X,j,d;if(s=Mp(x,F,t,E),S=f.vf(Er,H,!1,Q),b&&(M=f.vf(yc,H,!1,Q),k=E?$:f.vf(sl,H,!1,Q),X=E?$:f.vf(vp,H,!1,Q),j=f.vf(Yd,H,!1,Q),d=f.vf(gg,H,!1,Q)),b){for(var m=0,D=s.length;D>m;m++)s[m]=f._tryRemoveBezierPoints(s[m],b);f._12O(s,b)}else S&&s.forEach(function(d){if(U=d.length,U>0)for(W=d[0],J=1;U>J;J++)i=d[J],f.addV(S.vs,W,i),W=i});f._20Q(s),e||(S&&(S.ns=kk(S.vs),Zd(S,"vs"),Zd(S,yh)),b&&(M&&(M.ns=kk(M.vs),Zd(M,"vs"),Zd(M,yh)),k&&(k.ns=kk(k.vs),Zd(k,"vs"),Zd(k,yh)),X&&(X.ns=kk(X.vs),Zd(X,"vs"),Zd(X,yh)),j&&(j.ns=kk(j.vs),Zd(j,"vs"),Zd(j,yh)),d&&(d.ns=kk(d.vs),Zd(d,"vs"),Zd(d,yh))))}var p=f.mat=G.getPointsMatrix3d().getElements();f._vsTranslation?p=f._matWithExtraction=(new ke.Matrix4).fromArray(p).multiply(f._vsTranslation).toArray():f._matWithExtraction=null,e&&(yq(f,p,e,r,Q),f.clear()),V!=$&&(G.getShapeElevation=V)},_20Q:function(q){var g,f,G,d,W,u,x,S,p,E,D,r,e,m=this,L=m.front,O=m.back,j=m.top,P=m.bottom,F=L?L.tuv:$,K=O?O.tuv:$,s=j?j.tuv:$,U=P?P.tuv:$,t=0,y={front:0,back:0,top:0,bottom:0};(F||K||s||U)&&(e=m.s(em),g=e||Ud(q)||1,D=m.s("all.uv.union"),q.forEach(function(L){if(f=L.length,f>0){for(E in y)r=m.s(E+".uv.union"),(r===!1||r==$&&D===!1)&&(y[E]=0,e||(g=Ud([L])));for(u=L[0],G=1;f>G;G++){x=L[G],S=Kj(u,x);for(E in y)t=y[E],d=t/g,y[E]=t+=S,W=t/g,"back"===E&&(p=d,d=1-W,W=1-p),m._14O(m[E],d,W);u=x}}}))},_14O:function(Z,p,h){if(Z){var R=Z.uv,g=Z.tuv;if(g){if(R)var L=R[0]+(R[6]-R[0])*p,S=R[1]+(R[7]-R[1])*p,m=R[2]+(R[4]-R[2])*p,J=R[3]+(R[5]-R[3])*p,D=R[2]+(R[4]-R[2])*h,M=R[3]+(R[5]-R[3])*h,A=R[0]+(R[6]-R[0])*h,x=R[1]+(R[7]-R[1])*h;else L=p,S=0,m=p,J=1,D=h,M=1,A=h,x=0;g.push(m,J,D,M,A,x,A,x,L,S,m,J)}}},_13O:function(v){var b=v.uv,R=v.tuv;R&&(b?R.push(b[2],b[3],b[4],b[5],b[6],b[7],b[6],b[7],b[0],b[1],b[2],b[3]):R.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(Q,j){var d=Q.length;if(4>d)return Q;var m,a,L,D,K,i,l=!1,J=function(n){return Q[n]},f=function(N){return Q[d-1-N]};for(K=0;1>=K;K++)for(i=K?f:J,a=i(0),L=i(1),m=2;d-1>m;m++)if(D=i(m),!D.remove)if(D.b){var c=_d(a,L,D,j);c.adjust?(D.remove=!0,l=!0):(a=L,L=D)}else a=L,L=D;if(!l)return Q;var W=[];for(m=0;d>m;m++)Q[m].remove||W.push(Q[m]);return W},_12O:function(G,H){var v,p,h,z,U,t=this.s("shape3d.point.epsilon"),S=this;G.forEach(function(i){if(U=i.length,U>0)for(v={p:i[0],n:!0},z=1;U>z;z++)p=i[z],h=U-1>z?i[z+1]:$,h&&Math.abs(p.x-h.x)<t&&Math.abs(p.y-h.y)<t||S.addPoint(v,p,h,H,i)})},addPoint:function(R,T,f,t,D){var P,y,N,a,G,l,q,j,Y,M=this,U=R.p,A=R.f,H=R.b,V=M.s("shape3d.side")||Mg,b=M.s("shape3d.start.angle"),c=M.s("shape3d.sweep.angle"),C=M.shapeModel,e=M.data.isClosePath();if(R.n&&(R.n=!1,A=e&&D.length>2?_d(D[D.length-2],U,T,t):_d($,U,T,t),H=qg(U,A),C?C.top_vs&&M._10O(H,A,V,b,c,C.top_vs,C.top_uv):(P=M.left)&&(M.addV(P.vs,H,A),M._13O(P))),y=f?_d(U,T,f,t):e&&D.length>2?_d(U,T,D[1],t):_d(U,T,$,t),N=qg(T,y),C){var v,h,X=C.vs,B=C.uv,E=C.sum;for(B&&(v=C.len/E,C.len+=Kj(U,T),h=C.len/E),l=M._9O(H,A,V,b,c),q=M._9O(N,y,V,b,c),j=0;V>j;j++)Y=j+1,di(X,l[Y]),di(X,q[j]),di(X,l[j]),di(X,q[j]),di(X,l[Y]),di(X,q[Y]),B&&(a=j/V,G=Y/V,B.push(v,G,h,a,v,a,h,a,v,G,h,G));!f&&C.bottom_vs&&M._10O(N,y,V,b,c,C.bottom_vs,C.bottom_uv,!0)}else!f&&(P=M.right)&&(M.addV(P.vs,y,N),M._13O(P)),(P=M.front)&&M.addV(P.vs,A,y),(P=M.back)&&M.addV(P.vs,N,H),(P=M.top)&&M.addH(P.vs,A,y,N,H,!0),(P=M.bottom)&&M.addH(P.vs,H,N,y,A);R.p=T,R.f=y,R.b=N},_10O:function(u,$,f,A,Q,U,b,P){var V,a,n=this,R=n.data,l=n._9O(u,$,f,A,Q),H=(u.x+$.x)/2,q=(u.y+$.y)/2,E=R.getShapeElevation(),t=0;for(t=0;f>t;t++)P?(di(U,l[t]),di(U,l[t+1])):(di(U,l[t+1]),di(U,l[t])),di(U,[H,E,q]),b&&(P?(V=g*(t+1)/f+A,a=g*t/f+A):(V=g*t/f+A,a=g*(t+1)/f+A),b.push(.5-.5*m(a),.5-.5*X(a),.5-.5*m(V),.5-.5*X(V),.5,.5))},_9O:function(R,A,j,o,s){var Z,T,f=this,d=f.data,t=[],e=(R.x+A.x)/2,S=(R.y+A.y)/2,p=d.getTall()/2,I=d.getShapeElevation(),v=0;for(s==$&&(s=g);j>=v;v++)Z=s*v/j+o,T=m(Z),t.push([e+(R.x-e)*T,I+p*X(Z),S+(R.y-S)*T]);return t},addV:function(V,E,p){var r=E.x,P=E.y,t=p.x,C=p.y,l=this.data,G=l.getShapeElevation(),K=l.getTall()/2;V.push(r,G-K,P,t,G-K,C,t,G+K,C,t,G+K,C,r,G+K,P,r,G-K,P)},addH:function(f,B,v,b,E,D){var M=this.data,u=M.getTall()/2,F=M.getShapeElevation()+(D?u:-u);f.push(B.x,F,B.y,v.x,F,v.y,b.x,F,b.y,b.x,F,b.y,E.x,F,E.y,B.x,F,B.y)},vf:function(W,j,c,k){var U,S=this,n=S.gv.getFaceVisible(S.data,W);return(c||n)&&(U=fd(S,W,k),U.vs=[],U.tuv=n&&(U.texture||j)?[]:$,U.visible=n),U}});var nt=function(t,d){ud(nt,this,[t,d])},ot={},pt=function(p){return/\.(png|jpg|gif|jpeg|bmp|svg)$/i.test(p)};bd(nt,jt,{validate:function(){var B=this,C=B.gv,G=B.data,g=B.s,m=th(g("points.color")),t=g("points.size"),E=g("points.uv.offset"),S=g("points.image");!S||pt(S)||Dj.test(S)||(ot[S]||(ot[S]=B._createCachedImage(S)),S=ot[S]);var k,l,h=G._modelDirty,c=g("points.model");if(c){if(B._lastShapeModel!==c||!B.shapeModel){var v=Wj(B,c);if(!v)return;var Y=[],d={};B.eachShapeModel(function($){for(var K=0,n=$.length;n>K;K+=3){var e=$[K],l=$[K+1],A=$[K+2],W=""+e+"_"+l+"_"+A;d[W]||(d[W]=!0,Y.push(e,l,A))}},v),B._setShapeModelPoints(new Ki(Y)),B._lastShapeModel=c,h=!0}k=B.shapeModel.vs.length,l=k/3}else{var x=G.getPoints();if(l=k=x.length,h||G._pointsDirty||!B.shapeModel){for(var T=[],O=0;l>O;O++){var e=x[O];e&&T.push(e.x,e.e,e.y)}B._setShapeModelPoints(new Ki(T)),G._pointsDirty=!1,B._lastShapeModel=null,h=!0}}if(B.info={mat:Zi(G),size:t,diffuse:m,opacity:g("points.opacity"),texture:S,alphaTest:g("points.transparent")?0:g("alphaTest"),uvScale:g("points.uv.scale"),uvOffset:E,discardSelectable:g("points.discard.selectable")},h||G._colorsDirty){var s=!1,f=G.getColors();if(f&&f.length>0)for(var q=[],O=0;l>O;O++)for(var D=f[O],A=D?(s=!0,th(D)):m,I=4*O,U=0;4>U;U++)q[I+U]=A[U];B.shapeModel.cs=s?new Ki(q):null,G._colorsDirty=!1}if(h||G._sizesDirty){var R=!1,L=G.getSizes();if(L&&L.length>0)for(var b,n=[],O=0;l>O;O++)b=L[O],b>=0?(n.push(b),R=!0):n.push(t);B.shapeModel.ss=R?new Ki(n):null,G._sizesDirty=!1}if(h||G._offsetsDirty){var p=!1,u=G.getUvoffsets();if(u&&u.length>0)for(var w,i,z,Z=[],O=0;l>O;O++)w=2*O,i=u[w],z=u[w+1],i!=r&&z!=r?(Z.push(i,z),p=!0):Z.push(E[0],E[1]);B.shapeModel.os=p?new Ki(Z):null,G._offsetsDirty=!1}if(h||B._lastPointNumber!==l){this.dispose();var y=C.pickColorMap,$=B._startPickId=y._pickIdUsed;y._pickIdUsed=$+l;for(var T=[],O=0;l>O;O++){var X=$+O,W=Us(X);T.push(W[0],W[1],W[2],W[3]),y[X]||(y[X]={data:G,part:O})}B.shapeModel.ps=new Ki(T),B._lastPointNumber=l}G._modelDirty=!1,this.dispatchBoundingBoxChanged()},_setShapeModelPoints:function(R){var T=this,h=T.shapeModel,f=T.shapeModel={vs:R};if(!h)return f;var N=R.length,$=Math.round(N/3);return h.cs&&h.cs.length==4*$&&(f.cs=h.cs),h.ss&&h.ss.length==$&&(f.ss=h.ss),h.os&&h.os.length==2*$&&(f.os=h.os),h.ps&&h.ps.length==4*$&&(f.ps=h.ps),f},_createCachedImage:function(o){var T=128,c=qc(),W=c.getContext("2d");Kc(c,T,T,1),zm(W,{width:T,height:T,comps:[{type:o,background:"white",borderWidth:0,rect:[0,0,T,T]}]},0,0,T,T);var z=A.Math.generateUUID();return ps[z]=c,z},_80o:function(o,L){var F=this,v=F.gv,U=v._picking;if(!U||v.isSelectable(F.data)){var e=F.shapeModel,r=F.info;if(e&&e.vs&&e.vs.length){var K=El.for(o);K.useProgram(F._asureProgram(o));var a=K.directUniforms(),M=K.directAttribs();a.modelMatrix=r.mat,a.modelViewMatrix=fm([],v._viewMatrix,r.mat),a.projectionMatrix=v._projectMatrix,a.viewMatrix=v._viewMatrix,a.scale=v.getHeight()/2,a.size=r.size,a.diffuse=r.diffuse,a.opacity=r.opacity,a.map=v.getTexture(r.texture,F.data),a.alphaTest=r.alphaTest,a.resolution=v.getDevicePixelRatio(),a.discardSelectable=r.discardSelectable,a.uvScale=r.uvScale,M.uvOffset=!U&&e.os?Nr(o,v._buffer.os,e.os,$):r.uvOffset,a.blackout=o._blooming&&!F.data.s("bloom"),M.position=Nr(o,v._buffer.vs,e.vs,$),U?(a.picking=!0,M.pickColor=Nr(o,v._buffer.ps,e.ps,$),a.useColor=!1,M.color=null):(a.picking=!1,M.pickColor=null,e.cs?(a.useColor=!0,M.color=Nr(o,v._buffer.cs,e.cs,$)):(a.useColor=!1,M.color=null)),e.ss?(a.useSizeArray=!0,M.sizeArray=Nr(o,v._buffer.ss,e.ss,$)):(a.useSizeArray=!1,M.sizeArray=null),vb(o,0,e.vs.length/3,o.POINTS),K.useProgram(L),M.disable(),v.shadowMap.enable&&v.shadowMap.createShadow(),v.flowMap.createFlow(a)}}},_asureProgram:function(H){return H._pointsShader||(H._pointsShader=this.gv._postProcessing.createShader(H,nt.shaderSrc)),H._pointsShader.program},dispose:function(){nt.superClass.dispose.call(this);var b=this._startPickId,k=this._lastPointNumber;if(b&&k){for(var $=this.gv.pickColorMap,e=0;k>e;e++){var X=b+e;$[X]&&delete $[X]}delete this._startPickId,delete this._lastPointNumber}}}),nt.shaderSrc="!!~v!oj<g*p!s{n/!onpbjuu5j!tnppQewfnm!N.b!u0s!jfym<bd!tv!o)j!g>p+s!nf!{njbTuu5o!jnppQe`fmmhW!j*f!xfNwbjuusdjfyq<ts!fvQotjjg!p)s!ng!jn!bu<5*!!q1s/p2k!f.d!u>j>p!o^N!b4u!s]j^y!<3!!]vyojjsgupbsNno!pnjbuud5f!kwpjsfqx!N)b!u>s!jfyw<ju!dvfoqjtgspfsQnt!jg!mmppbpuc!!tdbm~f!<<o!pbjuuuvsmjpctvfusf!!+w!ffd{4j!tq!p>t!jfu{jjpTou<ojp!Qv`omjhg!ps|n!!fctpmpfm!!~v!tf<Doppmjpusv<mp!tbfusu!s+j!czvbusfs!Bwff{dj5t!!d>p!mfp{sj<Tu!owjbpsQz`jmohh!!w|f!d*5z!bwsDspBmfp{sj<Tft!vb)u!ugsjj!cv<uofp!jwufjdt3p!QvwwnP!g+g!tyfjus<ub!Nwobpsjzujdofhk!pwsfqd!3>!!woPpgjgutjftup<Q`m!hv!oj<goppsjnu!jctpppQmw!nq!j+d!lyjjoshu<bN!xbfujuWsmjfcevpunf!!>w!fodp5j!uqjjtdplQDwpnm!ps<<*!1!/v2o!j-gepfsnns!pggmtpobbus!ut!j){5fd<fw!!v>o!jogppjsunj!tgpmQpwbnu!!5sdfftwp!mv<u*j!poop<ju!jvtopjqg!p)s4nd!fcwp!p>m!!evftnfsTpjg{tfoBbsssub!z4<df!wb!uu<s*jucfvtugfg!Pgwmvp)b3ud!ftwj!{>f!Busfstbgzg<Pw!!c~p!pm<!sjptmQpfds!t>q!fsdpumjpwDfwN!bu|s!j*ys)p!mnpbDuf5t!vn)!!*g!j|!f!tsmffu!vs~o!!n<]s!p3m!p^D]l!d4j!q^!!>>!>s!p.m!p2D/w1!<|!!~*ho!jwlpdjjeq!)n!bgjjo!)*|!^#!!~qs~f!dj<tsjppmop!Difjthvigqg!jgem!p>b!us<pm!p$DehfbgsjGo`fm!hV!TF|`!NfBtQmf!!v~o!jg<psspnm!pwDfwd!5>!!esjpgmgpvDthfb<sG!`vmohj!gp<sens!bgdmtpjbeu!!*p1q/b1d!j>u>z!<b/!svpomjpgDpfstnv!gggmjpeb)u!!gbjm!qi|b!U*fhtouj<ldj!qv)o!jggjp!sn<!ecspbpdmt!jvet!f*DuptmfpUsb<iq!mwbb!s=z!jbo/hs!pwmfpdD5f!twvDgpgmjpes)<!gj!!vogjjgeposfn$!!cp~p!m!<q*jwdvl!j-oqhb<n!!)vEo3jfgspvsuny!fcup!p>m+!!esjptmdpbDsfetTvfgmgfjdeu!bc<muff<tgg!Pvwo!j>g,p!swnv!!cp<pfmm!bcdmTbwdvl!p+v!ue<spp!DvuoojjgppQs`nm!hw!f>d!3w!vv!w3Tddfbwm!f<|!!*wfbmsczbjuodhf!mwffTde3s!bwdPtgjgetaf!u}<}!h$ojjgl!dejfqgaj)o!fgej)!!V*T!FQ`BNNB`QF!T*V!!)veofjogjpgsfne!!tgbjn$q!mf~s!3E<!*n!bzqu<jd$bfqope!j+g!b/wfptjveg!gnjbej!o-){*z!y|/f!tjvgg!g)jcem!b)d5ldpfvwu!*>!!|s!phmmp`DGfstbvhgDgpjmep!s!|>!!fwtfmdf5!)~1!/1<-*!!1z/u1j-d!b1q/p1!-+!!2b//1s*p<m!psDfwu!v-s{oz<y!/~spm!pwDfwd!5)!5edjfgwg!v>t!fsDppmmppDsf<tv!gjggj!e)!aq|j!d*lsjpomhp!D%f%t!v";var qt=function(o,x){ud(qt,this,[o,x]),this._needRecoverPosition=!0};bd(qt,it,{_25Q:1,validate:function(f){var s=this,g=s.data,Z=s.s,L=g.getPoints(),R=L.size();s.dispatchBoundingBoxChanged();var k=g.p3(),F=s.mat=Kl();Ph(F,k),zh(F,g.getFinalRotation3d(),g.getRotationMode());var d=g.getScale3d(),A=g._dynamicScale3d;if(A&&(d[0]*=A[0],d[1]*=A[1],d[2]*=A[2]),bp(F,d),Ph(F,Ig(k)),(!s.s("geometry.cache")||!s.shapeModel)&&(s.shapeModel=s.info=s.lineShapeModel=$,R>1)){var y=s.info={},m=g.getSegments(),x=g.getThickness(),Q=sm(L.get(0)),n=sm(L.get(R-1)),c=R%2,M=(R-c)/2;if(y.c1=sm(L.get(M-1)),y.c2=sm(L.get(M)),0!==c&&(y.p3=y.c2),y.s1=Q,y.s2=sm(L.get(1)),y.t1=sm(L.get(R-2)),y.t2=n,Z(lp)===ym){if(u.extractPolylineTranslation||u.extractVerticesTranslation){var k=new ke.Vector3(g.p3());L=Bf(L),L.forEach(function(H){H.x-=k.x,H.e-=k.y,H.y-=k.z}),s._vsTranslation=(new ke.Matrix4).setPosition(k),s._matWithExtraction=(new ke.Matrix4).fromArray(F).multiply(s._vsTranslation).toArray()}else s._vsTranslation=null,s._matWithExtraction=null;y.list=s.createTubeModel(L,m,x/2,f)}else y.list=s.createLineModel(L,m,x,"shape.border","shape.dash")}},invalidateCachedGeometry:function(){this.shapeModel=this.info=this.lineShapeModel=$},_80o:function(P,k,E){var R=this,K=R.shapeModel;if(K){var G=R.mat;(u.extractPolylineTranslation||u.extractVerticesTranslation)&&R._matWithExtraction&&(G=R._matWithExtraction);var h=R.gv;sk(h,G);var U,z=R.s("3d.clip.direction");if(h._uvClipEnabled&&("uv.left"===z||"uv.right"===z)&&(U=R.s("3d.clip.percentage"))<1){var a=!0,T=!0;zb(K);var X=K.top_vs,t=K.bottom_vs,A=K.vs,J=El.for(P),O=J.directUniforms(),d=J.directAttribs();"uv.left"==z?(1>U&&(a=!1),0>=U&&(T=!1)):(1>U&&(T=!1),0>=U&&(a=!1)),K.top_vs=K.bottom_vs=r,d.aUv=Nr(P,h._buffer.uv,K.uv,$,2),Dd(h,R.data,K,R,R.getBodyColor(),E),d.aUv=!1,O.uClipDirection=0,K.vs=r,a&&(K.top_vs=X),T&&(K.bottom_vs=t),Dd(h,R.data,K,R,R.getBodyColor(),E),K.vs=A,K.top_vs=X,K.bottom_vs=t}else Dd(h,R.data,K,R,R.getBodyColor(),E);xl(h)}}});var rt=A.graph3d.PostProcessing=function(s){var Q,M,H,i,I=this,C={},Y=!1,k=!1;!function(){b.keys(rt).forEach(function(i){C[i]=new rt[i](s)})}(),I.getModule=function(j){return j?C[j]:I},I.getModuleList=function(){return b.keys(C)},I._serializable=!0,I.handleDataModleChange=function(E,S){E&&(I._serializable&&E.setPostProcessingData(I.serialize()),E.removeSerializeListener(I.onDataModelSerialize,I)),S&&(S.addSerializeListener(I.onDataModelSerialize,I),I.deserialize(S))},I.onDataModelSerialize=function(l){"serialize"===l.type?I._serializable&&(s.dm()._postProcessingData=I.serialize()):"deserialize"===l.type&&I.deserialize(s.dm())},I.isDeserializeDisabled=function(R){return!I._serializable||R.a("sceneBloom")!==r},I.isSerializable=function(){return I._serializable},I.setSerializable=function(Y){I._serializable=Y,Y||s.dm().setPostProcessingData(r)},I.serialize=function(){var W,$,T,E,h={};for($ in C)if(T=C[$],E=T.serializeProperties){W={},T.enable&&(W.enable=!0);for(var y in E){var I=T[y];I!=E[y]&&(W[y]=I)}b.keys(W).length&&(h[$.toLowerCase()]=W)}return h},I.deserialize=function(u){var W,V,T,J,a,E={},Q={};for(W in C){T=C[W],J=T.serializeProperties;var B={},m="scene"+W,g=u.a(m);g!==r&&(B.enable=g);for(var a in J)g=u.a(m+a[0].toUpperCase()+a.slice(1)),g!==r&&g!==J[a]&&(B[a]=g);Rd(B)||(Q[W[0].toLowerCase()+W.slice(1)]=B)}if(Rd(Q)&&(Q=u.getPostProcessingData()),Q)for(V in Q)if(V&&(W=V[0].toUpperCase()+V.slice(1),T=C[W])){E[W]=!0,J=Q[V];var G=!!J.enable;I.enableModule(W,G),W="scene"+W,u.a(W,G),T.resetProperties&&T.resetProperties();for(a in J)if("enable"!==a){var g=J[a];T[a]=g,u.a(W+a[0].toUpperCase()+a.slice(1),g)}}for(W in C)E[W]||(T=C[W],T.enable=!1,T.resetProperties&&T.resetProperties())},I.getRenderTarget=function(){return Q},I.blitScreen=function(N,L,I,E,b){var y=s.getGL();if(y&&(k||e())){N&&(N.bind(y),s.setViewport(y,0,0,N.width,N.height)),b&&b.clear===!1||y.clear(y.COLOR_BUFFER_BIT|y.DEPTH_BUFFER_BIT),I||(I=M),I.bind(),y.activeTexture(y.TEXTURE0+0),kf(y,L||y._emptyTexture);var w=I.uniforms;w.image=0;var c=1;if(E)for(var C in E){var _=E[C];_ instanceof WebGLTexture&&(y.activeTexture(y.TEXTURE0+c),kf(y,_),_=c,c++),w[C]=_}if(H.upload(),i.upload(),I.attributes.pos.pointer(i),y.drawElements(y.TRIANGLES,6,y.UNSIGNED_SHORT,0),c>1)for(;--c>=0;)y.activeTexture(y.TEXTURE0+c),kf(y,null);else kf(y,null);N&&N.unbind(y)}},I.decodeShader=function(K){var W,L,n,V="",I="";for(n=0;n<K.length;n++)W=K[n],"%"===W?W="'":"a"===W?W='"':"]"===W&&(W="\\"),L=String.fromCharCode(W.charCodeAt(0)-1),n%2?I+=L:V=L+V;return I+V},I.createShader=function(D,W,H){var s,O;if("string"==typeof W){var Q=W.indexOf("^#");s=I.decodeShader(W.substr(0,Q)),O=I.decodeShader(W.substr(Q+2))}else s=W.vs,O=W.fs;if(H){var C=H(s,O);C&&C.vs&&(s=C.vs),C&&C.fs&&(O=C.fs)}return new rn.Shader(D,s,O)},I.enableModule=function(Q,r){var x,d,J,w=Q.split(",");for(x=0,d=w.length;d>x;x++)J=w[x].trim(),C[J]&&(C[J].enable=r);Y=!1;for(J in C)if(C[J].enable){Y=!0;break}};var e=function(){if(k)return!1;var O=s.getGL();return O?(Q=new Fr.RenderTarget(s,O,null,null,{samples:x.renderTextureSamples||1,minFilter:O.LINEAR,magFilter:O.LINEAR}),M=new rn.Shader(O,L.vs,L.fs),H=rn.Buffer.createIndexBuffer(O,new Uint16Array([0,2,1,1,2,3])),i=rn.Buffer.createVertexBuffer(O,new Float32Array([0,0,1,0,0,1,1,1])),k=!0):!1},L=I.blitScreenShaderSrc={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};I.contextLost=function(){k=!1;for(var O in C)C[O].contextLost&&C[O].contextLost()},I.render=function(w,R,g,t){if(Y&&(k||e())){Q.setSize(w,R,g),Q.bind(w);var a=w.getParameter(w.COLOR_CLEAR_VALUE);a&&0===a[0]&&0===a[1]&&0===a[2]&&0===a[3]?a=null:gp(w,[0,0,0,0]),w.clear(w.COLOR_BUFFER_BIT|w.DEPTH_BUFFER_BIT),s.setViewport(w,0,0,R,g),t=t||{};var B=t.renderAxis!==!1,J=t.renderEdit!==!1;t.renderAxis=t.renderEdit=!1,s.renderScene(t),Q.unbind(w);for(var $=0,K=s._glCapabilities.maxAttributes;K>$;$++)w.disableVertexAttribArray($);var T,U=Q;for(T in C)U=C[T]._42(w,U)||U;s.setViewport(w,0,0,R,g),a&&gp(w,a);var E=I.getModule("Fxaa");return E&&E.enable?I.blitScreen(null,U.texture,E.getShader(w),{resolution:[1/R,1/g]}):I.blitScreen(null,U.texture),w.useProgram(s._prg),s._renderAxisAndEditHelper(B,J),!0}}},st=A.graph3d.PostProcessing.HueSaturation=function(s){function v(){var O=s.getGL();return O?(Z=new Fr.RenderTarget(s,O),z=s._postProcessing.createShader(O,st.hueSaturationShader),D=rn.Buffer.createIndexBuffer(O,new Uint16Array([0,2,1,1,2,3])),l=rn.Buffer.createVertexBuffer(O,new Float32Array([0,0,1,0,0,1,1,1])),w=!0):!1}var D,l,z,Z,K=this,V=!1,w=!1,O=[],A=[],u=[];this.serializeProperties={hue:[0,0,0,0,0,0,0],saturation:[0,0,0,0,0,0,0],lightness:[0,0,0,0,0,0,0]},this.resetProperties=function(){var v=this.serializeProperties;for(var t in v)this[t]=v[t]},this.resetProperties(),b.defineProperties(K,{enable:{get:function(){return V},set:function(B){!!V!=!!B&&(V=B,s.iv())}},hue:{get:function(){return O.map(function(w){return M(180*w)})},set:function(E){if(O!==E&&7===E.length){for(var H=0;7>H;H++)O[H]=E[H]/180;s.iv()}}},saturation:{get:function(){return A.map(function(R){return M(100*R)})},set:function(i){if(A!==i&&7===i.length){for(var t=0;7>t;t++)A[t]=i[t]/100;s.iv()}}},lightness:{get:function(){return u.map(function(C){return M(100*C)})},set:function(z){if(u!==z&&7===z.length){for(var w=0;7>w;w++)u[w]=z[w]/100;s.iv()}}}}),K.contextLost=function(){w=!1},K._42=function(h,J){if(V&&(w||v())){var o=J.width,K=J.height;if(o&&K){Z.setSize(h,o,K),Xg(h,Z.frame),s.setViewport(h,0,0,Z.width,Z.height),h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT),z.bind(),h.activeTexture(h.TEXTURE0+0),kf(h,J.texture);var N=z.uniforms;return N.image=0,N.hue=O,N.saturation=A,N.lightness=u,D.upload(),l.upload(),z.attributes.pos.pointer(l),h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0),kf(h,null),Lp(h),Z}}}};st.hueSaturationShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j*txj/psop!mipjdh!i-q*!mgtmip)bcuh<s3!mvtoij)g5pdsfnw!!t>b!nsqpmmfpsD3hEb!sjGn`bmhhf!<<!*w!bs*zfjhoohb!Swtftdf3o!uwiVhwj<m!-!^$1e]ftgtjfoofu!iNhBjYm`!S-B{O/HmFt!i8)t!t$feofugijhojfm!`SqBbOnH!F`-B*MfMh!o1bSo!pvjoujbgspvsunb!tg!m-p^b1u]!oipvjfu]bNsBvYu`bStB!O-HzF/^m<ti!)voopjjgupbssnv!ugbmtp`bqub!nt!bu-v*sfbhuojbpSof]vNiB!Y-`^S1B]OfHvFi^!<-y!/vmotjig)pfsvni!`gqmbpnb!u!)m4jdhfiwu!o>f!tmtt]iN!BY`~S!BO~H!F^<<lbf!sgcm!pb<u^!snfbuqo`vipvdf`)fgvmip]btut!fjoouWibhmjvmf!->!!gfmhpobbuS!titvffoBumimh-j!mg!mp<b^us!fiuvofvSpbdo`hffv*i!]|op!jgumbpsbvuu!bwtb!m>v!ff!h>o!bjSooWpbjmuvbfs!v,u!b)ti!vf<B^msmf!u,o!vipvdf`Sfbvoih]ff*v!i0!!>3!/f1h<obS!fjvgi!!)w|b!m*vffh!o=b!s1!/>1>*!!ssffuuovvspod!`wfbvmiv)f!!g,j!!2/|1!<*,!,fsmftufo!vjpgd!`)fwvbim!v<fF!H?O!B2S/`1Y*B!Ns!f=u!vssfou!owvbpmdv`ff!v.i!!2</11!<>!!sffmutofv!psdf`ufvvsio!!uwobjm)v!fs<pg!!~<!2g!m,p!bfuh!onbbsq!`>t!bfuhvosbbsu!jp<o1)!g>m!pfbhuo!bjso!W*b7m!v>f?-!!fghmopbbsu)!!tgbju!vs~b!uj~p!oB<mlmb-f!sgcm!pb<us!ftubouvvpsdb`ufjvpio!S>b!ofhhfo*b!s|!!|g!m*p6b/u1!!w,b!m*vsff!u>o!vjpodW`bfmvvif)!u+b!p)m2g/!1=!!,i!)t!bgujv!sb|u!j*p,o,Bsmfmu!o,v!ptdb`ufvvsib!u<jFpHoOSBbSo`hYfB*N<!=!!ssffuuvosvop!dd`mfbvniq!)<w1b!m>v!fs-f!u1o/v1p-d!`2f/v1i*!<uo!j~)!!sgpmgp!bu!<nfbhqo`bmSjthtifuooufithtj)mg!m-pfbhuo!bjSooWpbjmuvbfs-v!ugbmtp!b-uf!hmojbhSifuvoif!tutbBpmmmg-!!g<m1p!b>u!!fmhjohbisu!oufotjt!Sb<oehmfp*i!t|fs!igum`pfbvui!!wu!b>p!mmgj!hi<u1o/f7t!t+B!mym/!m,t!im!j>h!iiu!oufbtptmSgb!oh<f*<{z!yj/gs!p)mwp!d=)!m1t/i13*ch!ss!f>u!vmstoi!!j4odWfbwm!vf<!*+w!V)ww!!-,f!h2b/n1j*)<E3!ffsmvtufyf!us!f>u!vsspom!pjdo!W5bdmfvwf!!,|!!)*w)!o+j!b)n2!/e1j!p.w!!joW~b!mv<f**m*!<-t!!~-i!)g4mdpfbwu!!oisvvfu3fssh!c)~g!mp<b1u/!7g!20-!!ig!m>p!biu!!g~3!-!<g1m/p7b!u>!,i!vif!*!||!*!1j/g1!!)=i!vif)!!=g!j1!/1*~!!i<vbfu!m,f>E!d2!/01!<*h!!f.m!tsf)!!j,g!!1)/i5v!f>!!?i!!2/|1!*ft!mifv!f~!!.><!b2u/m1f<Ed!!g0m!p*bsu!!.s!fct)<!,!!j1g/!3)!)>7!/i1!!+|!!i*vyfb*N!d=!!>2>/!1h*)!!gsjf!tf!t>m!fg!2~!!,!<)bgu3m!f.E!dg!20*!!*+c!!7./!1h!)+!!>i!vif!<|!!f*mytbfN!dj!g>!>)!)s3)/!1g!j+!!iv<f***!o=j!N2d/!1,*!y!bsNfdt)!!>.!!g13/<3)!!f0m!tbfu!mjfgE!d)!);4!/*1o!j+N!di!v,f!*y!b=N!d3)/!10*!b!usmfftE!d>!!@g!26!/,1!!)=g!3m!!.>!!gt2!*!+<!o)j)N3d/!1.!!0y!b4N/d1!*>!!.b!uimvffE*d!!+u!b7p/m1g<!!|f!m*tofjN!ds!f?t!!y>b!Ngd2)<!g!js!fuv<s1o/!3s!f0t!<*o!j~Nd!!,w!fydb4N!di)t!m>3!smh!c)w<f*d*4c!!i-thm)*y!b|n!!-wsf)dy4b!ns!h>c!<ybN!dj!gu!b)pimtgm!/z<!*>*>c!!1-/h1)*o!j|n!!-ssh)co!j>n!!w>f!do4j)Nidt!mu/b{p*m<g!!~<!cf/mdt!f>!!|c!!ugbmppmbgu!!g<3h</d!!>j!gh!!)uibtpmm/g{!!=<!s1//d6!*>!!sg!3u!b>p!migt!m/<{1!/+1!!)>2!/m1!!u,b!pimtgm!/z<*1</1!!f>m!ttf!u!bgp3m!g>!!i<t1m//2{.!!,>!!iit!mu/bzp!m.g!!it|m!/*zd!!+4!diftwm)/m{t<i3c!hgsm!p4bduf!wg!2!>~!!3/<1c!h+s!!iotsmv/u{f!s.!!g~3!<<*!*s1h/c4/0s1!/>2!)i!v.f!3ys/hmct)ig!2--3!gg!3--2!gi)tcmh/sy3!f,v!i)!2>/!1c0/4c/h1s*!*<<*!ys/hmct/ih!!->3!gi!v-f23gs)hc";var tt=A.graph3d.PostProcessing.Bloom=function(X){function U(){var c=X.getGL();if(c)for(var G=X._postProcessing,q=0;$>q;q++)k[q]=G.createShader(c,tt._35Q,function(K,P){return{fs:P.replace(/DEFINE_VALUE/g,i[q]).replace("%OVERRIDE_ALPHA_DEFINE%",m?"#define OVERRIDE_ALPHA":"")}})}function W(){var A=X.getWidth(),V=X.getHeight();if(!A||!V)return!1;var r=X.getGL();if(!r)return!1;q=[A,V];var _,s=Math.round(q[0]/2),F=Math.round(q[1]/2);for(C=new Fr.RenderTarget(X,r,s,F),y=[],Z=[],_=0;$>_;_++)y.push(new Fr.RenderTarget(X,r,s,F)),Z.push(new Fr.RenderTarget(X,r,s,F)),s=Math.round(s/2),F=Math.round(F/2);var H=X._postProcessing;return E=H.createShader(r,tt._34Q),U(),l=H.createShader(r,tt._36Q,function(y,M){return{fs:M.replace(/NUM_MIPS/g,$)}
}),R=H.createShader(r,tt.finalShader),M=rn.Buffer.createIndexBuffer(r,new Uint16Array([0,2,1,1,2,3])),T=rn.Buffer.createVertexBuffer(r,new Float32Array([0,0,1,0,0,1,1,1])),G=!0}var F,h,B,m,K,M,T,x,n=this,v=!1,G=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0,selective:!1},this.resetProperties=function(){var k=this.serializeProperties;for(var X in k)this[X]=k[X]},b.defineProperties(n,{enable:{get:function(){return v},set:function(f){!!v!=!!f&&(v=f,X.iv())}},strength:{get:function(){return F},set:function(A){F!==A&&(F=A,X.iv())}},threshold:{get:function(){return h},set:function($){h!==$&&(h=$,X.iv())}},radius:{get:function(){return B},set:function(p){B!==p&&(B=p,X.iv())}},overrideAlpha:{get:function(){return m},set:function(e){!!m!=!!e&&(m=e,G&&U(),X.iv())}},selective:{get:function(){return K},set:function(p){!!K!=!!p&&(K=!!p,X.iv())}}}),this.resetProperties();var C,E,l,R,q=[256,256],y=[],Z=[],$=5,i=[3,5,7,9,11],k=[];n.contextLost=function(){G=!1,x=null},n._42=function(n,b){function U(V,f,A,q){Xg(n,f.frame),X.setViewport(n,0,0,f.width,f.height),q?q(n):n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),Y!==V&&V.bind();var J=0;for(var H in A){var Q=A[H];Q instanceof WebGLTexture&&(n.activeTexture(n.TEXTURE0+J),kf(n,Q),Q=J,J++),V.uniforms[H]=Q}for(Y!==V&&(M.upload(),T.upload(),V.attributes.pos.pointer(T),Y=V),n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0);J--;)n.activeTexture(n.TEXTURE0+J),kf(n,null);Lp(n)}if(v&&(G||W())){var Y;if(K){x||(x=new Fr.RenderTarget(X,n)),x.setSize(n,b.width,b.height),x.bind(n);var s=n.getParameter(n.COLOR_CLEAR_VALUE);s&&0===s[0]&&0===s[1]&&0===s[2]&&1===s[3]?s=null:gp(n,[0,0,0,1]),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),X.setViewport(n,0,0,b.width,b.height),n._blooming=!0,X.syncRenderState(),X.renderScene({renderAxis:!1,renderGrid:!1,renderEdit:!1}),n._blooming=!1,s&&gp(n,s),x.unbind(n)}U(E,C,{smoothWidth:.01,luminosityThreshold:h,tDiffuse:K?x.texture:b.texture});var g,r=C,H=Math.round(q[0]/2),V=Math.round(q[1]/2);for(g=0;$>g;g++)U(k[g],y[g],{colorTexture:r.texture,direction:[1,0],texSize:[H,V]}),U(k[g],Z[g],{colorTexture:y[g].texture,direction:[0,1],texSize:[H,V]}),H=Math.round(H/2),V=Math.round(V/2),r=Z[g];return U(l,y[0],{blurTexture1:Z[0].texture,blurTexture2:Z[1].texture,blurTexture3:Z[2].texture,blurTexture4:Z[3].texture,blurTexture5:Z[4].texture,bloomStrength:F,bloomRadius:B,bloomTintColor:[1,1,1]}),U(R,b,{image:y[0].texture},function(e){El.for(e).glState.blend.apply({enabled:!0,equation:e.FUNC_ADD,func:[e.SRC_ALPHA,e.ONE]})}),El.for(n).glState.blend.apply({equation:n.FUNC_ADD,func:[n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA]}),b}}};tt._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",tt._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",tt._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",tt.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var ut=A.graph3d.PostProcessing.Dof=function(d){function S(){var F=d.getGL();return F?(N=new Fr.RenderTarget(d,F),$=d._postProcessing.createShader(F,ut._38Q),g=rn.Buffer.createIndexBuffer(F,new Uint16Array([0,2,1,1,2,3])),m=rn.Buffer.createVertexBuffer(F,new Float32Array([0,0,1,0,0,1,1,1])),Q=!0):!1}function t(w,R,g,q){n=null;var P=w.getCanvas(),C=P.width,T=P.height;if(g=g||1024,C>g||T>g){var K=g/Math.max(C,T);C=Math.round(C*K),T=Math.round(T*K),V||(V=qc()),P=u.resizeImage(P,C,T,V)}var S=d.getGL();if(G||(G=S.createTexture()),D=gs(S,P,G),L=R||.01,U=!0,d.iv(),q--){if(n)return;n=u.callLater(function(){t(w,R,g,q)})}}var N,$,g,m,D,Z,O,h,V,G,n,X=this,F=!1,Q=!1,L=0,U=!1,w=ke.generateUUID();this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var z=this.serializeProperties;for(var c in z)this[c]=z[c]},b.defineProperties(X,{enable:{get:function(){return F},set:function(W){!!F!=!!W&&(F=W,W||(U=!1),d.iv())}},image:{get:function(){return Z},set:function(k){Z!==k&&(Z=k,U=!1,D&&(d.deleteTexture(w),D=null),d.iv())}},maxblur:{get:function(){return O},set:function(j){O!==j&&(O=j,d.iv())}},aperture:{get:function(){return h},set:function(p){h!==p&&(h=p,d.iv())}}}),this.resetProperties(),X.contextLost=function(){Q=!1,D&&(d.deleteTexture(w),D=null)},X.setImageFromGraphView=function(Q,s,W){this.image=null,t(Q,s,W,2)},X._42=function(e,R){function C(W,p,B,y){Xg(e,p.frame),d.setViewport(e,0,0,p.width,p.height),y?y(e):e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),u!==W&&W.bind();var S=0;for(var a in B){var n=B[a];n instanceof WebGLTexture&&(e.activeTexture(e.TEXTURE0+S),kf(e,n),n=S,S++),W.uniforms[a]=n}for(u!==W&&(g.upload(),m.upload(),W.attributes.pos.pointer(m),u=W),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0);S--;)e.activeTexture(e.TEXTURE0+S),kf(e,null);Lp(e)}if(F&&(Q||S())){var u;if(!D){var o=Of(this.image);if(!o||!o.comps&&!o.tagName)return R;A.Default.setImage(w,o),D=d.getTexture(w)}var n=R.width,O=R.height;if(n&&O)return N.setSize(e,n,O),C($,N,{tColor:R.texture,tDepth:D,aspect:n/O,aperture:this.aperture,maxblur:this.maxblur,useG2d:U,threshold:L}),N}}};ut._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vcupypfmu!!v>t,f!Hm3ped<<v*o!j5gspvsmnc!ggpmep!b+u!!*u!iusdfftsisppmdeu<dfvqotjbg!p+s!n*!!g:m3p/b1u.!!n-b:y3c/m1v.s!<)3vdofjwg!p)s!n,!!gzmyp/bwuV!wb!q-fsspumvpsDfu<!)vEo3jfgspvsuny!fgum!p>b,u!!mopfdbs<D*m!j5qs<vmvcogjpgep!s+n!!*g!mupdbfus!sgpbdsuDdmfjqqt<b!v+o!j*g!p1s/n1!!g-m5p/b1u.!!g)p3ddvftw<!)v!o,j!gzpys/nw!Vgwm!p-bsup!mbptDquf!d)uE<3fdspvoutyuf!ug!m>p,b!um!pVdoq<b*d!l5Espvxmoctgdpbem!f+!!>*!!3u6d6f/s!s0p!d3u6d7f/q<t!b0!0+!!1*/!/:23!/.1?!!-g:s3b/d1u.j!p)o3!d)ffwy!d)m!v,e!jzoyh/!w2V*w!d-psoptmup!Dwuf!d)4E!3QfbsdvluGybfduu!p>s,t!!m>p!dwf<d*4!)5!s3v6m7c/g!p+e!!3+6!7*/!!u+d!f3s6s7p/d-u!d3f6q7t/b!!++!!3*6!75//-1!.3!6-71//!1*!<)3ddpfowt!u)!!w,f!dz5y!/VwoVqwb!d-lsGpbmdpuDpus!t)!E>3!fVsovqubydfluE!p>x,o!tmdpbdmf<!*0!!5wsfvdm5c)g!pQeb!d+l!G*b!duudpfssts-p!d2u/d!f*q<tbg!m+p!b*u!!:v3o/q1b.d!l-S:H3C/B1U!p)E3fdqfuwi!))!!d,p!oztyu/!wjVow!!w-fsdp5m!pwD!u*!!)|E3!fssfvuuvysfou!!e>p,u!)m!pwd-!<V*o!q5bsdvlmGcbgdpuep!s+t!!**!<ud~fsgsmppdbuud!fhqftubE!f+q!u*i!)1!/d1p!o-t5u/!1j!o)!3wdffdw3!!)t!d,s!fzfyo/QwpVtwj!u-jsppom!p*D!u|!)\nEs3ffusvvsuoy!fvuo!q>b,d!lmSpHdCB<U*p!E5fsqvumic)g!puef!y+u!v*s!fu3dEf)s!supEdfuqdufiq-t!bt!d+s!f*f!o:Q3p/t1j!u-j:p3o/!1*!!)*3<df~w!g)m!p,b!uz!yq/fwsVtwq!f-dsupjmwpfDEuf!q)uEi3UfpsWvjufyxf[u)!!>d,p!omtpud!j<o*!!g8mspvbmuc!gjpoew!D+m!j*q![u-d!fdspsoptduu!djfoq!tgbm!p+b!u*!!o5f/b1s!--!1d/p1o!t)u3!djfow!!g)m!p,b!uz!yg/bwsV!w*!!-|sp!mspfDuuv!s)oE!3)f!sovfubysf!u+!!>g,b!sm!p*d!0<!*)!!8)s!vgmbcsg!p.e!!o+f!b*s!!u*d!f+s!sjpodwuDdmfjqqt[b!!.+!!g*b!s:!3*/<1.~!-g:m3p/b1u.!!h)f3udWfjwf!x)[!),!!dzpyo/twuV!wj!o-!sgpmmppbDuu!!e)fEq3ufis!v*u!y|fu\n!s>f,u!vmspod!q<f*s!t8qsfvdmucjgwpfeE!f+q!u*i!UupdWfjsfsxp[d)u!deffqqtubi!-+!!o*f!b1s/D1m!j-q5-/!1g.b!s)D3mdjfqw!!*)<!,~!zwyp/jweV!wn!b-jsop)m*p!D|u!w)fEd33f!sevpugycfmuv!s><,!wmfpdd3!<b*t!q8fsdvumdcpgspsef!d+u!!*>!!uwdffds3s)p!d2u/d1f-q!tbbt!q+f!d*u!!:*3</1j!g-!:)3v/t1f.E!f)q3udif*w!!|)!!,g!mzpyb/uw!Vwwj!f-xs[p!m>p!Dhuf!u)WEj3ffxs[v)u!yhffuu!E>f,q!umip)d!w<V*w!!8*s!v*m<cg!pgem!p+b!u*!!gubddfuspssp!d>u!d)f!qgtpbd!v+t!!*,!!5w/j1f.x![-!1*/<1!!)e3pdgfcwm!v)s!!,>!!zwyf/dw3V!w)!!-dsmpbmnpqD)u!!g)bEd3ufpssv!u+y!fbuq!f>s,u!vmspfd-!<.*n!b8yscvmmvcsg-p!en!b+y!c*m!vusd!f*s!s*p<du~dffqmttbf!!+|!*w!f:d35/!1u.f!y-f:m3!/>1!!u)f3ydufvws!f)3!E,)!!zuyE/fwqVuwi!--!swpfmdp3D)uw!V)wE/3yf-s!v2u/y1f!u.!!>w,V!wm/pzd*!<**<!8gsmvpmbcug!pbem!q+i!b*<!ujdgf!s)svptdfuHd3feq*t!b|!+b!m*q!i1b/!1>!!-t1n5p/p1u!i)t3udffqw)!!)u!i,s!fztyi/pwmVew-!!-usipsmfptDiup!m)eE!3,f!s1v/u1y2f-u!!u>f,y!fmmp/db!<**<!8~s!vfmmctgfp!e|!!+b!m*q!iubd!f>s!supfdyufdmf/qbt<b!!~+!!*e!p:g3c/m1v!s-!:>3!/w1f!d)33!d)f!wd!m)b!n,q!)z!yb/mwqViwb!!-+s!pbmqpfDsuu!v)sEf3-f!s.vnubyyfcum!v>s,-!!mnpbdyc<m*v!s:!s*v!m*c<gp~e!w+f!d*3!!uedpfgscsmpvdsu:d!f>q!tebp!g+c!m*v!s8!4+/!11./!:-<62w/f1d!3)!3edpfgwc!m)v!s,8!!z>y!/ewpVgwc!m-vssp!m+p!D1u/!8)<E3wffsdv3u!yefpug!c>m,v!sm5p!d>!<e*p!g:csmvvmsc!g+p!e1!/+5!<*!wufddf5s!sdppdmu!d>f!qwtfbd!5+)!!*1!/612!/*1<.!d-p8m4!/,1>.!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!16/25/!1*!!-+8!4b/t1q!f)d3uddfpws!s)f!d,u!!z*y!/+w!Vewp!g-csmpvmsp!D*u<!)dEp3mf!s,v>u!yuffuy!u>v,s!fm3pEd)!<u*D!p:mspvsm-c!gwpVew!/+y!z*!!,u!d)f!swsfpdd3u)d!f1q/t2b6!-+!!1*/!4884!/*1!!+-!6b2t/q1f.d!u)d3pdsfswf!d)u!!,*!!z+y!/ewpVgwc!m-vssp!m*p<Dud!p)mE!3,f>s!vuufyyfuuv!s>f,3!Em)p!duD<p*m!p:ss-v!mwcVgwp/ey!z+!!,*!!)u!dwffsds3p)d!u1d/f3q:t-b!!1+/!3*:!!8*4!/+1!.b!t-q6f2d/u1d.p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!6+2!/b1t.q!f-d8u4d/p1s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b6t2q/f1d!u-d8p4s/s1f.d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/:yszv!m,c!g)p!ew!f+d!3*)!!u1d/f4s8s-p!d.u1d/f2q6t!b*!!++!!*b!t8q4f/d1u!d-p6s2s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d1f/s3s:p-d!u.d1f/q3t:b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d.f1s/s2p6d-u!d.f1q/t4b8!!+*!!*+!!:b3t/q1f.d!u-d:p3s/s1f.d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d1f/s1s-p!d.u1d/f5q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!s,v!m)c!gwpfed!3+)!!*.!1u/d2f6s-s!p1d/u4d8f!q*t!b+!!+b!t*q!f1d/u1d!p-s5s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!yszv!m,c!g)p!ew!f+d!3*)!!u.d1f/s3s:p-d!u1d/f3q:t!b*!!++!!*b!t6q2f/d1u!d-p8s4s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfs";var vt=A.graph3d.PostProcessing.Blur=function(o){function v(){var z=o.getGL();return z?(d=new Fr.RenderTarget(o,z),u=o._postProcessing.createShader(z,vt.hBlurShader),I=o._postProcessing.createShader(z,vt.vBlurShader),g=!0):!1}var u,I,d,c,z,w,X,n,x,m=this,q=!1,g=!1;this.serializeProperties={value:0,downSample:!1,iterations:1,layer:"main"},this.resetProperties=function(){var P=this.serializeProperties;for(var J in P)this[J]=P[J]},b.defineProperties(m,{enable:{get:function(){return q},set:function(a){!!q!=!!a&&(q=a,a?o.addRenderLayerListener(S,this):o.removeRenderLayerListener(S,this),o.iv())}},downSample:{get:function(){return X},set:function(g){X!==g&&(X=g,o.iv)}},value:{get:function(){return w},set:function(d){w!==d&&(w=d,o.iv())}},iterations:{get:function(){return n},set:function(E){n!==E&&(n=E,o.iv())}},layer:{get:function(){return x},set:function(z){x!==z&&(x=z,o.iv())}}}),this.resetProperties();var S=function(E){if(q&&E.layer===x&&"post"===E.phase){var $=o.getGL();if(!o._picking&&!o.isReflecting($)){var T=o._postProcessing.getRenderTarget();T.unbind($);for(var g=0,r=o._glCapabilities.maxAttributes;r>g;g++)$.disableVertexAttribArray(g);m.drawImpl($,T),T.bind($),$.useProgram(o._prg)}}};m._42=function(){},m.contextLost=function(){g=!1,c=null},m.drawImpl=function(t,B,x,Q,E){if(g||v()){var P,h;if(B?(P=B.width,h=B.height):(P=o._viewport[2],h=o._viewport[3]),P&&h){var N=o._postProcessing;"boolean"!=typeof Q&&(Q=X),x==$&&(x=w),E==$&&(E=n),E=Math.max(1,Math.round(E));var f=El.for(t).glState.depth,l=f.enabled;if(f.enabled=!1,Q){x/=2;var V=[P,h];P/=2,h/=2,c||(c=new Fr.RenderTarget(o,t),z=N.createShader(t,vt.downSampleShader)),c.setSize(t,P,h),N.blitScreen(c,B.texture,z,{texelSize:[1/V[0],1/V[1]]}),B.setSize(t,P,h)}else c&&c.setSize(0,0);d.setSize(t,P,h);for(var T=[],S=0;E>S;S++)T.push(x),x=Math.max(1,Math.floor(x/2));for(var S=0;E>S;S++){var r=T[E-S-1],O=Q&&0===S?c.texture:B.texture;N.blitScreen(d,O,u,{value:r/P}),Q&&S===E-1&&B.setSize(t,V[0],V[1]),N.blitScreen(B,d.texture,I,{value:r/h})}return f.enabled=l,B}}}};vt.hBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sz3/Ew!Vjwn!b-hffv<mb!ww!b+s!z1j/o5h!!,w!fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!zt/vwnV!w>!!-wffvdm5b)w!!1+/!11!/*4<!,!!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!!.<!655/313!2+/!1w!b+m!v*f!-*!!wzV/ww/Vzw!!*-!f*v!m+b!w1!/+1!612/<3!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!4</214!6+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*f!v+m!b1w/!1+:!219/<2!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!3</414!7+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!!*.!!z2//w1V!w+!!-wfbvm",vt.vBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sf3vEm!bjwn!b+h!f1</5!!w,b!szz/jwoVhw!!w-fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!ftvvmnb!w>!!+w!f1d/54)!!,1!/z1/!w*V<w!-!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!-!<w6V5w3/3z2!/.1!!5+/!1*!!+*!!wfbvmmvbfw!!*+!!*1!/+3!!1,/!1z6/2w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w2/4z6!2./!14!/+1!!*+!!*w!bfmvvmfb!w*!!+*!!1+/!21!/,1!:z2/9w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w4/4z7!2./!13!/+1!!*+!!*w!bzm/vwfV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!-*!!wfVvwm/bzw!!.+!!21/",vt.downSampleShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j1t/j5p!o0!!i*j*h*i1q/!2g!m-p1b/u1<)3!dvfowj!g+p!sfn{!jtTbmnfqymffus!3,E!!wjVnwb!h-ff<hb!nwjb)sEz3jfoshv!uwyffdu3!!w,V!w*<*1!/v2o.j!g-p1s/n1!)w3fddf3w!!u+f!yff{mjTTjm{ffy<fu!!,w!pwjVew!!n-bfjhob)n*j)!E|3f!shvmu`yGfsub!hD,p!m*p*s1!/>1!!)-u1f/y2u.v)s3fd3fEw)!j+n!bfh{fj-T!mwfVywf!u,!!,u!fwyVfwm!T-jf{hfb!n+j!)wEf3df3s)v2u/y1f-u!!1/,1!**";var wt=A.graph3d.PostProcessing.Glitch=function(g){function j(){if(Q&&G){a=Date.now(),s=0,e=1e3*r(G[0],G[1]),B=[];for(var M=1,O=Q.length;O>M;M+=2)B.push((M>1?B[B.length-1]:0)+e*Q[M]/o)}}function V(){g.redraw()}function W(){var $=g.getGL();if(!$)return!1;N=new Fr.RenderTarget(g,$),R=g._postProcessing.createShader($,wt.Shader);for(var V=U*U,c=Ap(U,U),F=c.getImageData(0,0,U,U),M=F.data,B=0;V>B;B++)M[3*B+0]=H(256),M[3*B+1]=H(256),M[3*B+2]=H(256),M[3*B+3]=H(256);return c.putImageData(F,0,0),i=gs($,bk),A=!0}var N,R,e,a,s,B,i,h,G,Q,w=this,I=!1,A=!1,r=ke.randomFloat,H=ke.randomInt,o=0,U=64;this.serializeProperties={onlyReflector:!1,period:[2,3],intensity:[3,.3,1,.1,0,.4]},this.resetProperties=function(){var x=this.serializeProperties;for(var V in x)this[V]=x[V]},b.defineProperties(w,{enable:{get:function(){return I},set:function(o){!!I!=!!o&&(I=o,o&&j(),g.iv())}},onlyReflector:{get:function(){return h},set:function(S){!!h!=!!S&&(h=S,g.iv())}},period:{get:function(){return G},set:function(T){G=T,j(),g.iv()}},intensity:{get:function(){return Q},set:function(K){K||(K=[1,1]),Q=K,o=0;for(var d=1,O=K.length;O>d;d+=2)o+=K[d];j(),g.iv()}}}),this.resetProperties(),w.contextLost=function(){A=!1},w._42=function(w,P){if(I&&(A||W())){var m=!!g.isReflecting(w);if(m===!!h){var v=P.width,q=P.height;if(v&&q){var p=g._postProcessing,c=El.for(w).glState.depth,e=c.enabled;c.enabled=!1,N.setSize(w,v,q);var o,L=Date.now();L-a>B[s]&&(s++,s>=B.length&&j()),o=Q[2*s];var z={seed:Math.random(),byp:o?0:1,tDisp:i};return o&&(z.angle=r(-Math.PI,Math.PI),z.distortion_x=r(0,1),z.distortion_y=r(0,1),z.amount=Math.random()/30*o,z.seed_x=r(-1,1)*o,z.seed_y=r(-1,1)*o),p.blitScreen(N,P.texture,R,z),c.enabled=e,requestAnimationFrame(V),N}}}}};wt.Shader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd~j!tj<p*ow!Viwj!h-ifqh!bgnmjp)b!uE<3f!svvoujygfpus>ns!pjmopuD!hcbzsqG<`m!hv!oj|g!pfstnm!ft!bn~q!mf<sx3pEo!tj!n,bshpfm<pD!hvbosjGg`pmshn!!>t!bsnpqmmpfDsh3bEs!Gu`Emjht!q<<*3!/v1o+j*g*p/s1n6!+gemfpfbtu!!+b!ntpzv-oeuf<ft!!v+o!jtgyp)s3nd!fgwm)peboub!sb)o5hdmffw<+u!ovvopjngbp+s/n1!1g3m!p>b!ux!ptoftf!e5<df!wv!ojfgtpjspno!!gemepbb0u0!!tf<f*eb`/yb<hd!!v-ocj/gcpds!n-!hg/mbphbdu!!-tsf/fsed`)z5<df!wv!o>j!gsppsmnp!DghmbpsbGu`!mehj!tu<p*suufjtpgog`py!<.!!qv!o-jfghpbsnnj!)gEm3pfbsuv!ueyjftuu!p>s!ucjdp!o5`dzf<w!!v<o*jqg!p-sfnh!bgnmjp)bEu3!fdspvmu`ytf<u!>!!wbbhsdz!j5odhf!ww!fd<3*!uwfVtwg<gp!!,d!pqo!t-uf!hgbmnpjb)uE!3VfosqvbudylfEup!x>o!tsddb!m5fd!f>w!!36<6*/*!f0m!h3o6b7)/o<jt!!d-p*oftmuh!owbf)dt4p!dQ)b3ddlfGwb!d+u!pusotv!p>n!bw!f>d!4u)f!t3g6g7p/!!3+d!f3w6!7/s!f+e!b3i6t7!/u-g!j3i6t7!/C!H+S!!3n6p7s/g-!!f3t6b7c/0!0*!<<!*d/p6o0teuf!fwtf)d+5z!`Veofqfbtd+lmGbbndsuppos>t,!z>/!qV!oq<b*d/l6E0pexfofttd)b+myf`!e0f!fwtf+dm5b)n!sQpbod>l,Gyb/dqu!ps~t!-!~2!/!<**<y`!ogpmjpubsup!uvtojqeb!d,l!SyH/CqB)U!p.E!f/q2u!i>)!!yd/pqo!tu|!!jfot!mwff!d5~!!w!<*y!`|op!jsufsupvustoj!ee>pyu/)q!!w-|!*V/o1q?bzd`leGfbfdtu)pgsjt!!*|<!*!e~fft!+gtm`pmbpud!.szb`ooep)jwufsdp3u!tdjpe*?|y/!qs!f%u%v!sto`!mgpsdb,dzu`)otpjjou)seppuut)jdep=/yy/zq!)-gwjf!d3~)!23~/!:9<:z9`-o8p9j/u3s4p4u*t*j*e!!+>!!5z4/8q6!9/|6!5f6t4m*f<!!~~!<!*wzp`joep!jnubsjpou)t*j!e|!,!!jzg/)qc)z!q.=!2/*2!!|>!!zw/fqd!3!|q*!/>1!?wyV`we<ff!tg)mgpjb!u!|y!t*!e>f!fgtm+ptp`sm)phdm.`yG`sobphjDupsppsuet/jye!?0z!/1q/!6%*%<!t!`gmmppdb,uy!`zotp!j>u!sgpmuptpjse)=hzm/`qG)sgbjh!Dp<p*s*ee/fzf!t0+!e1f/f6t*+<q!!-gqmtpjbEuu!)o!pEs3nfbsmv!u>y!fvuo)qibudqlfSEHpCUB";var xt=A.graph3d.PostProcessing.Fxaa=function(z){var K,k=this,v=!1;b.defineProperties(k,{enable:{get:function(){return v},set:function(p){!!v!=!!p&&(v=p,z.iv())}}}),k.contextLost=function(){K=null},k.getShader=function(d){if(K)return K;var T=z.getPostProcessingModule();return K=T.createShader(d,{vs:T.blitScreenShaderSrc.vs,fs:T.decodeShader(xt.ShaderSourceFs)})},k._42=function(){}};xt.ShaderSourceFs="~!!q<sbf/d*jwtVjwp!o-!fihjbhnijq)!Eg3mfpsbvuu<yf!uv>obj/gsppsmnp!DthbbnsqGm`fmsh3!E!<j*n!bh*f1</1!)v5odjfgwp!sn-!1w/f1d!3!-s1f/t1p!mv-u1j/p1o!<-!4w4b9s1z/j1o!h!-w7f7d23/!1w!Vw-<68/!1$!ef-g*j1o/f1!)G5YdBfBw`!RV-B*M1J/U1Z)`5Qd1f!w2!/1-*!1$/e1f)g5jdoffw!!GY-BoBp`jRuVvBmMpJtUfZs`!Q2-!f2h/b6nj!!$e-ffghjbonfj!!GY-BfBh`bRnVjB!MJ-U*Z1`/Q13)!53d/f1w!!$-ewfVgwj!of)!sGfYeBbBi`TRmVfByMjJQUbZb`yQG4>!s5p/m1pD!h$besfGg`jmohf!!G|Y!B*B)`oRjVbBnM!JeUjZp`wQ!5!~2!3/<1*N!b$nevfmg!j-o{fz!yG/y*bNbtCppqp!m-!ycfpup)mqpU!y$feUfbgbjyoGf)!5GuybbpbmGGmbpbbyuG!!gomspvbuufs!!$e<foghjjoTfi!uGhyobfbmG!m+p!byuj3q!cwvfTdu3ft!g$gePfmgfjyojfq!>G,yzb/bNGtmppqb!u*4o!bwqfTd{4sp!i$!e)fggjj!of<!oGhyjbTbiGumhpobfum5!!+w!fydj5qcv!T$uefftggjgoPfm!fGyyjbqb>T,byu/)Nyt*p!qd!m*bonbqq)Ty{-s!p1i/a1)-g!j2!/1<**I!y$jeqfcgvjto!f-!eGpypbHbuUfftyg!gtPbmnfqymjfqs)3yEbn!>$yejfqgcjvoTfu!fGtygbgbPUmffyyUjpqq!)uub-p!mqG*b!buyfGy!uv<s1f/31E!);u!-u!fqt-g!g1P/m1f*yj!q$!e@f!gojboqfT!eGpypbhb>UefpypPHgugf)tug-g!Pqm-f!ypj-q!!su*b!pumfGybubvysGf!3E<)yuj-q!cqv,T)zpu!j+m!bsv*R-b!b1y/g1!*+!!HGyyjbqbcGvmtp>bIuy!jGqycbvbtM!vunbbp)mGGybbbbyGGm!pb<u65/!1s,h*c*bq*d!S|i!ushfoufvMsoob!qsth.c)b!/+z!<u!t~e)!>GuyfbtbgGgmPpmbfuy5j!qG!yubbbpQmjGybfbmyTGi!be<fGsy)jq!cGvytb!b+G!mGpybjuq3c!vqtp>tH-yj!qGcyvbtb!GumbppbmuG5b!bgyyGb!bD<pQootbpqmTfeQpppthQ!p;t!-Oo!bGqyTbebpUpfhy!!@u!fOyo-pj!uGdyfbsbjUef>yo!bgqyTbebpDppho!tmppmpfC4b7b1yUGf!yF<y*qQCujtbet!O-fOhuPtoef)-oj!nG>yubtbeU!fuyb!pgmyGbbbbDypGo!tp<mQfu4t7e1!U=f!yOFuytqeC>jObotpOjfuhdUfxspj-e!!mGpypbCbbGbmypGb!u3<!iguyhbobfRMvobbmqjtu0z1S/d2q>GqsdbSnifu-ho!fGMyobbbqGtm!pubbup5m!GgbybbybGD!po<tppsmff[SUdMqNGbsnbvnmf!P>qau!-*1!/G1y!b=b!GQmepobFub5n!vgmy)b>bQDopboqtTpempfpShd!qmGpspbCnbfbPyqGu!3-<*!OGuytbeb,GQmuptbeu)5>!iguyhbobfDMpoobtqptm!fu4b7p1mSGdbqbGysGb!nf<Ppqsuf3[-UM!NGbynbvbmG!m>pab!u*!1g/y1b!b=R!vObemojFubznTvvmc)q>jOyo-bq!TGeypbpbhG!mmppbpuC!bgbyybGb!Rv<bzm/jNutzpFqe.hzf/UQitspfqt>iQpumtee-!*!oGbyqbTb{Gsmppibau)!ggjy!bb<Rzv/bOmtjpuqz.Fze/hNftUpiqs>fOtuitpem!e*Nojboq-T{!sGpyibab)Ggmjp!bu<!yg/yNbtbpDqp.oyt/pQmtfpFqe>hQfuTtieb!suqbopfmtGtb-by!GG!yb<byG/mOptbpuq!.gyy/bNbtDppqo>tOpumtfeF!euhbfpUmiGsbfbtyiGp!me~-!!~G!yb~b!Gm<p5bQu`!ZgUyJbMbBDVpRo`tBpBmYfGF!e+h!fzU/iQsOfgtgipp>m,ezN/jQot-pq!!G*yQbfboGpmepab)ug5j!!gy<b5bQD`pZoUtJpMmBfV4R7`1BDBpYoGt!u+E!jys/Q!O*g!g|p>!,Gyy/bQbtGpmqp!b*uQ3f!oqppetaN)<gj!!qp<t*NQ/fyo>pqepat)/!y}<}!!*qOpftoNp/eza>)q>pQtO/fzo<pe!!Gy<b5bQG`mZpUbJuM5B!VsRh`cBzBNY>GG!y+b!bzU/fQyOUgpgqp)>u.fzy/-O!tqppqt!N**O<fo!p$eeaf)ggjjo!f!<m5vQn`bZNU!JsMhBcVzRN`/BzBY!GG!y+b!byG/mQpObgug!pm>v.nyb/TO>tGpyqb!b*MOvfnobp)eGay)bgbjU!fy<Pegfgm)budfTyu-o!fqjpetbNs-h!!G>y?b!b*GQmepobFub3n)v!m1)/t1c-b!>2Q/f1o*p-e!!gy<bebfRmvbbdmTjuuozfSjdeqbGsshb!n>f?/!y*zO*e*o<Fb!nGvymb)btGcmbp>bOuf!ompven!bF<>6G/y1b!b+M!vOnObb)nGvymb.bQUefoyFPbgngv)mu>fQye-o!FqbpntvNm-!!*GQyfbobpGemap)bguj3!)!<26//11-!!+1!/O1O*b-n!vgmy.bObeRovFbbmnjvumz>SOdeqoGFsbbnnvfm/!y*zO*f*o<pe!aG)ygbjb!Gm<p*b*uz!ym/vQntbpOq>!G-yybfbuM)vqnpbU)yGfyUbbbbUyfGy)Pbgngv)Mubfbyy-G!>qQpetoNF-b!nGvymb!b*GQmfpobpue3a))!g1j/!1-<.*2*/z1y*/-O!tgpyqb!b-Ryvfbum)jqupzUSydfqUGbsbbynGf)/bynzv*M*b<by!GG>yObeboGFmbpnbvum!!m*vOnfboXp>eGay)bgbjM!vn|b!)*GQyObfboUpfey)Pggjg!)u<f4yQ-`!ZqUpJtMNB-V!RG`yBbBbYGGm!p+b!uz3/)Q.O2g/g1p->!,1z//1Q*t-p!qg!y*bQbfRovpbemaj)ugzjS!dq<G4sQb`nZfU/JyMzB*V*R<`B!BGYyGb!b+G!myp/bQuO!gngbpy>T,Ny>/nQbtyp)qm!v*nQbfTo-p!emav)ngbjN!*<<*!QGfyobpbeGam)p!b}u}!!n*jOofToNp>enaj)o>)QmOvfnobpTe-!!m<v4nQb`NZ*U<JM!BGVyRb`bBGBmYpGb!u+!!nzb/yQFOTgNg>pn>b.yz)/mOvtnpbqF!-*!OnfboypTeNa*)<gj!!Gy<b4bQG`mZpUbJuM!BnVjRo`FBTBNY>Gn!j+o!)ym/vQnObgFg-p!>n.jyo/TONt*p<q!!*GOyfbobpGemap)bguj!!nb<yeXfOm>bndbTyu)omfvjnebbOs-h!!m>v?n!b*XQ*e<oF!bGnyvbmb)Gtmcpbb>uQ!fnojpoeX!O><nejfom)bmdvTnuboOf-j!embvsnhb!X>*?<!*!OGeyobFbbGnmvpmb)ut!csbb>oOhffoNpbey!>n<b6y/)1n!b+y!XOOO-b!nnvbmy.FQTeNo*F<bn!vGmy>bQbeGomFpbbnuv!ms!b*oQhffoNpjeoa>)ngjjo!)n<j6o/X1O!-+!!nOjOobFnTvNm*.<Oe!oGFybbnbvGmm>pObeuo!Fsbbnovhmf!N*bOyfTodpbemaf)eg>js!bo<h*f*Nzbyy/!Q+t!pgqy!b-byRfvub)mqjpuUzyFfeUhbfbUyiGs)fbtnivpMmbeb<yG!>GQyebobFGbmnpvbmu!!*sQbfoohpfe>as)bgojh!fN<b*y*.zsyb/oOhtfpNqj!o-<yf!uG)yqbpbUGymfpUbbub!ysGb)obhnfvNMbbybDymGb>nOqefoeF>bnnbvym)!g*yObfboRpvebam)jgujz!Fe|h!f*UQiOsffotpiep)mgejN!jo<-3!Qs`bZoUhJfMNBbVyRT`dBbBmYfGe!*+<!z!/GQyObgbgCpp>p,mz!/fQbtspmqz!F*yQjfuo>psebao)hgfj!!=!<s3bQo`hZfUNJbMyBDVmRb`nBqBfYeG<!+!!jyg/)QfObgsgmpz>F,yyj/uQ*tp!qs!f*uQvfsoop!esah)cgzjN!<<!*GQyfbobpGemap)b!u}!}m!v*nObfOoXp>eGay)b>bQMOvfnobp)eG!yb<b3UQf`yZPUgJgM)BuVfRy`-B!BqYpGt!N+-!!zG/yQbObgGgmpp>b.uz3/)O.t2p/q1!-*.O2f/o1p*e-a!)ggyjb!bR<v3bQm`jZuUzJSMdBqVGRs`bBnBfY/Gy!z+*!*y</Q!OGgygbpb>G.myp/bOut!pmqv!n*bOTfFo>pGeyab)bgMjv!nb<)eGfymbbbdUTfuyoPfgjge)busfhy!->!?q!p*tQNe-o!FGbynbvbmG)mtpcbbu>3Q)f!o2p/e1!-!<2e/f1m*b-d!TguyobfbjRevbbsmhj!u>z?S!d*qOGesobFnbfn/vymz)*t*c<b>!OGfyobpbeG!mp<b6u/!1m!v+n!bOOOFb>nGvymb.bQMevonFbb)nGvymb>bQUefoyFPbgngv)mu!f*yQ-f!oqppetaN)-g!jG!yb<b6G/m1p!b+u!3O)O!b2n/v1m-..O2e/o1F*b-n!vgmy>bObeRovFbbmnjvumz!S*dOqfGospbenaf)/gyjz!**<<**!zGyy/bQbtGpmqp!b-uy!fmuv)nqbpTUXy>fGUybbbbyMGv)nbbn)vGMybbbbyUGf>yQPegogF)bunfvym-!!*qQpftoNp-e!aG)ygbjb!Gm<p*b*uz3y)/.O2t/p1q-!!-2y/f1u*)-q!pgUyybfbURbvbbymGj)ubznSvdMqbGbsybGn>fO/eyozF*b*n<vm!!G*yObfboGpmepab)ug!jm!vn|b!O*TQ>OmfvonpbeO),gmjv!nb<T2<Q`!ZGUyJbMbBGVmRp`bBuB!YmGv!n+b!XzF/>QmOvgngbpX>,,mzv/nQbtFp<q!!*GQyfbobpGemap)bguj!!tv<c2qQj`yZSUdJqMSBbVoRh`fB>B2Y/G1!0+s!byo/hQfO<gg!pG>y,byb/GQmtppbqu!!*tQvfcoqpjeyaO)TgXjF!>m<v*nQbfOoTp,emav)n!b}X}F!<*O!fGoypbebaG)m>pQbOuf!ofpeeh!fmIpppsC{b2b>y)G.!3/<12!Q+`!ZmUvJnMbBNV*R,`mBvBnYbGO!T+<!z!/GQyObgbgGpm>p.bzu/!Oftephqf!W*fOsfuo2p>e)a.)3g/j1!!+<!2mQv`nZbUNJ*M,BmVvRn`bBXBFY<G!!+G!yyb/bQGOmgpgbpu>!.myv/nObtOpFqT!F*>OmfvonpbeOaF),gmjv!nb<TeFf<mb!dGTyubobfGjmepbbsuh!!m>v?n!b*OQXeOoFF>bmnvvnmb)OtXc,bm>vQnfboOpFe<!m!pGpyCbbbbGymGp!bu<!effemhbfdITpuso{f3j>e)b.s3h/!1>!?+!!*mOvenobFFb*n,vmmv)ntbcObF>TOFf<op!eG!ymbpbpGCmbpbbyuG!!fe<h6f/W1f!s+u!3O>O)b.n3v/m1>!.+Q!emovFnbbnOv*m,!mv<n6b/O1X!O+F!<OO!bGnyvbmb>G.mOpebouF!bmnvvnmb!OX<T1X/>1m!v=n!bNONXb,nmvvmn>bpTsXf<[U!MGNybbnbvGmm!pmbpup!CmbvbnybGT!XT<FF>ymjvqncbvTtX!,+m!vEnybjTqFc<vt!>GGyybjbqGcmvptb!uu!bfpemhGfbIbpysG{!5><)6b/c1t!)+f!eOhOfbInpvsm{.2N*b!n+v!m3>/N1N*b,nbvcmt!)ufbephmfGIbpbsy{G3!*<<1!/G5y0b1b/G2m!p+b!uu!offejhefbWsfhs>ue5f>m)bbdcTtu)offejhefbWsfhs!uu2b*p!m+G!b3b/y1G*!,b<cTtT)bfnevhmf>WOfOsbun3v*m<!*!OGsyjbbbqGam)pgbju!!f<e*h*fQItppsq{!4->y)f.u3)/q1p!U+y!fmUvbnbbyXG*),bmnvvnMbbObXyTGX><Qe!oGFybbnbvGmm!pubbup!mfGebhbfyWGf!su<4D>y)j.q3c/v1t!!++!!mDvynjbqTc*v,tm>vFnybjTqXcTvFt<!u!bGpymbGbbGbmypGb!u!<f*e*hOftIppqs!{->ybfcut))qfpeUhyffIUpbsb{y4G*),bfnevhMfbIbpysG{>5O<eo!FGbynbvbmG!mupbbpum!GfbebhyfGW!fs<u1>/b4c,t*)DfyejhqfcWvfts+u*41*/,3f.e)h)f>WEfysjuq5c<vt!!GuybbpbmGGmbpbbyuG!!tv<c1qQj`yZOUXJTMXBOVFRT`FB>BmYvGn!b+O!XzT/XQ,Omgvgnpb,OzF/TCFt<pq!>Gzy/bQbtGpmqp!bu<!1mQf`oZhUuJiMTBjVhRo`>BgByYbGb!R+v!bym/jQuOzgSgdpq,Gys/bCntfp/qy><y/!QGtypbqb!Cp<pQmt!piqp!s3{uTbqpbmoG>bfbeyhGf!Ip<s1{Q!`?Z>U!JfMeBhVfRW`fBsBuY<G!!+G!yzb/bQGOmgpgbpu.!zt/vCctqpjqy>Bz>/tOvtcpqqj!yO<T1XQF`!Z+U!J3M/B1V,Rt`vBcBqYjGy!O+X!TyX/OQFOTgFg<p.!yj/gC)tapiqp>sy{/TOqtbpoq*!!m<vOntbpOq>!m3vunbbpXm<Gb!bjygG)!ai<p6s/{1T!q+b!oo*h!jmTvinubhTo>fmmv>n,bzF/<Ct!pjqg!)*iopbsq{TT{qsbpoi*!!)mgfjo!hu<i6T/j1h!o+>!goyhbjbTRivubhmojfumz>S,dyq/GCstbpnqf!/*zo<bq!TG{ysbpbiGam)pgbju!!t<vzc/qfjnybCs>G)qtdvSczqujjymBb!v+R!b)b2y/g1!0;2!31//11*!*@.!m*vonbbqNT<{s!pGiy!b)b>Gzm/pQbOug!ghps!be<jyf/ofunOb>smGvqndbSOz.umjvmnbbvNR<bb!yGgy!b;b!G1m/p1b!u@!!h*sobbeqjTf{osupTi>am)v>nyb/TQ.Omgvgnpb!N<<Q!OGgygbpb!G3mupbbpum!GmbvbnybGO!O><mzv/nNbtOp,qm>vzn/bCNt<pq!!Gy<byb/GNmtppbqu>!ym/vCntbpTqT!>m<vCntbpTq,!m3vunbbpNm<Gb!bGyyGb!bC<p*pfmh!oqbbSjqsdOS>ybjcqtc)vhts!b+e!j*fCoyujOq*c!v?t>)!tbccbt))uhbsTbbebjyfGo>uDTy*j<qc!vGty!bubbGpmmpGbbub!yhGs!be<jofhojuT>inubhyo)fbmc.t>)ohhsjbTeijufhooufOm*!-*!Obscjtb)qh)sgbje!jf<o*u*T",hf(u,{accordionViewExpandIcon:up(Fh),accordionViewCollapseIcon:up(Fh,!0),accordionViewLabelColor:Sd,accordionViewLabelFont:jq,accordionViewTitleBackground:Yo,accordionViewSelectBackground:qo,accordionViewSelectWidth:3,accordionViewSeparatorColor:r,splitViewDividerSize:1,splitViewDividerBackground:Yo,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:xj,rect:[2,2,12,12],background:Fh}]},propertyViewLabelColor:ii,propertyViewLabelSelectColor:Sd,propertyViewLabelFont:jq,propertyViewExpandIcon:up(pb),propertyViewCollapseIcon:up(pb,!0),propertyViewBackground:wb,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:wk,propertyViewColumnLineColor:wk,propertyViewSelectBackground:qo,listViewLabelColor:ii,listViewLabelSelectColor:Sd,listViewLabelFont:jq,listViewRowLineVisible:!1,listViewRowLineColor:wk,listViewSelectBackground:qo,treeViewLabelColor:ii,treeViewLabelSelectColor:Sd,treeViewLabelFont:jq,treeViewExpandIcon:up(xc),treeViewCollapseIcon:up(xc,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:wk,treeViewSelectBackground:qo,treeViewDoubleClickToToggle:!0,tableViewLabelColor:ii,tableViewLabelSelectColor:Sd,tableViewLabelFont:jq,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:wk,tableViewColumnLineColor:wk,tableViewSelectBackground:qo,treeTableViewLabelColor:ii,treeTableViewLabelSelectColor:Sd,treeTableViewLabelFont:jq,treeTableViewExpandIcon:up(xc),treeTableViewCollapseIcon:up(xc,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:wk,treeTableViewColumnLineColor:wk,treeTableViewSelectBackground:qo,tableHeaderLabelColor:ii,tableHeaderLabelFont:jq,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Fl,tableHeaderBackground:wb,tableHeaderMoveBackground:Jq,tableHeaderInsertColor:qo,tableHeaderSortDescIcon:hq(pb,!0),tableHeaderSortAscIcon:hq(pb),tabViewTabGap:1,tabViewLabelColor:Sd,tabViewLabelFont:jq,tabViewTabBackground:Yo,tabViewSelectWidth:3,tabViewSelectBackground:qo,tabViewMoveBackground:Jq,tabViewInsertColor:qo,toolbarLabelColor:ii,toolbarLabelSelectColor:Sd,toolbarLabelFont:jq,toolbarBackground:wb,toolbarSelectBackground:qo,toolbarItemGap:8,toolbarSeparatorColor:ip},!0);var yt={translateX:1,sortColumn:1},zt={sortable:1,sortOrder:1,sortFunc:1},At={focusData:1},Bt={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Ct={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Dt=function(a,H){H.add(a),a.hasChildren()&&a.eachChild(function(m){Dt(m,H)
})},Et=function(Q,i,y,B,m,O,f,V,v,Y,o){var D,U=y.getValueType(Y),p=y.getAlign(Y);if(y.getEnumValues(Y)){var W=y.toEnumLabel(i,Y),t=sb||0,E=0,k=O,J=u.getTextSize(B,W).width;return D=Of(y.toEnumIcon(i,Y)),D&&(E=O+sb/2,"center"===p?E+=(V-(t+J))/2:"right"===p&&(E=E+V-(t+J)),Mq(Q,D,E,f+v/2,Y,o),k=E+sb/2),W!=$&&(D?$d(Q,W,B,m,k,f,V-(k-O),v):$d(Q,W,B,m,O,f,V,v,p)),void 0}return i=y.formatValue(i),i!=$?U===pq?(Dc(Q,O,f,V,v,i),void 0):U===kh||!U&&xn(i)?(D=Of(i?Wl:vj),Mq(Q,D,O+V/2,f+v/2,Y,o),void 0):($d(Q,i,B,m,O,f,V,v,p),void 0):void 0},Ft=function(i,G){var b=G.view,o=Al(i),t=G.column||G.property;b.getDataModel().beginTransaction(),G.editor=i,i.info=G,b.setCurrentEditor(i),b.getView().insertBefore(o,b._79O),Zg(i,G.editorRect),i.setFocus?i.setFocus():Qr(i),i.commitValue=function(I,V){i._17Q&&(i=i._17Q),V||b.setValue(G.data,t,i.getValue?i.getValue():i.value),i.close&&i.close(),lk(o)},t.onEditorCreated&&t.onEditorCreated(G)},Gt=function(B,c,I,F,S){var b=We(B,I),i=c.value,r=c.view,D=S.getValueType(c.data);return b.onblur=b.onchange=function(){r.endEditing()},"input"===B?(i=S.formatValue(i),i!=$&&(b.value=i),b.onkeydown=function(e){Yc(e)?r.endEditing():$c(e)&&r.endEditing(!0)},(D===rs||D===zj)&&f(b,wd,u.numberListener)):B===tf&&F.forEach(function(k){var d=G.createElement("option");d.innerHTML=S.toEnumLabel(k),d.value=k,S.isEnumEqual(i,k)&&(d.selected=!0),$p(b,d)}),Ft(b,c),b},Ht=A.widget={},It=function(u,X,L){bd(n+".widget."+u,X,L)};hf(Wi,{ms_value:function(u){u.getValue=function(T){var Q=this.getItemById(T),J=Q.element;return ph(J)?J:J?J.getValue?J.getValue():J.value:Q.selected},u.setValue=function(j,i){var k=this.getItemById(j);if(k){var $=k.element;$&&!ph($)?$.setValue?$.setValue(i):$.value=i:xn(i)?(k.selected=i,this.iv()):(k.element=i,this.iv())}},u.v=function(E,d){var M=this;if(2===arguments.length)M.setValue(E,d);else{if(!Tq(E))return M.getValue(E);for(var S in E)M.setValue(S,E[S])}return M}},_46o:function(c){c._icon=$,c._accessType=$,c._valueType=$,c._editable=!1,c._batchEditable=!0,c._align=sl,c._nullable=!0,c._emptiable=!1,c.setParent=of,c.formatValue=function(M){var q=this,k=q._valueType;return q.getEnumValues()?q.toEnumLabel(M):k===kh?!!M:M!=$&&k===rs?t(M):M},c.setEnum=function(X,r,H,M,A,R,n){var i=this;X&&!Zf(X)&&X.values&&(M=X.editable,H=X.icons,r=X.labels,A=X.strict,R=X.maxHeight,n=X.dropDownWidth,X=X.values),mj(X)&&(X=X._as),mj(r)&&(r=r._as),mj(H)&&(H=H._as),i._enumValues=X,i._enumLabels=r,i._enumIcons=H,i._enumEditable=M,i._enumStrict=A==$?!0:A,i._enumMaxHeight=R,i._enumDropDownWidth=n,X&&X.length&&fl(X[0])&&(i._valueType=zj),i.fp("enum",!1,!0)},c.getEnumDropDownWidth=function(){return this._enumDropDownWidth},c.getEnumMaxHeight=function(){return this._enumMaxHeight},c.isEnumEditable=function(){return this._enumEditable},c.getEnumValues=function(){return this._enumValues},c.getEnumLabels=function(){return this._enumLabels},c.getEnumIcons=function(){return this._enumIcons},c.isEnumStrict=function(){return this._enumStrict},c.isEnumEqual=function(Q,E){return this._enumStrict?Q===E:Q==E},c.toEnumLabel=function(h,x){var s=this,l=s.getEnumValues(x),D=s.getEnumLabels(x);if(l&&D)for(var w=0;w<l.length;w++)if(s.isEnumEqual(h,l[w]))return D[w];return h},c.toEnumIcon=function(O,J){var V=this,H=V.getEnumValues(J),D=V.getEnumIcons(J);if(H&&D)for(var K=0;K<H.length;K++)if(V.isEnumEqual(O,H[K]))return D[K];return r}},_45o:function(V){V._87o=function(Z,F,Q,L,Y,H){if(Z){var W=this,I=W._90I,t=Ic(1);W._columnLineVisible&&(Y-=1),W._rowLineVisible&&(H-=1),0>=Y||0>=H||(W._90I||(I=W._90I={}),I[F]||(I[F]=new Od),Zg(t,W.tx()+Q,W.ty()+L,Y,H),$p(t,Z),W._view.insertBefore(t,W._79O),Z.onParentAdded&&Z.onParentAdded(t),I[F].add(t))}},V._76o=function(){var P=this,g=P._90I;if(g){for(var D in g)g[D].each(function(k){lk(k)});delete P._90I}},V._77o=function(q){var t=this;if(t._90I){var e=t._90I[q];e&&(e.each(function(n){lk(n)}),delete t._90I[q])}}},_47o:function(x){x.getValue=function(y,n){return n.getValue?n.getValue(y,n,this):wg(y,n.getAccessType(),n.getName())},x.setValue=function(c,h,n){if(h.isEmptiable(c)||""!==n||(n=r),h.isNullable(c)||n!=$){var U=this,T=h.getName(c),V=h.getAccessType(c),g=h.getValueType(c);g===rs&&ph(n)?n=rr(n):g===zj&&ph(n)?n=parseFloat(n):g===kh&&ph(n)&&(n="true"===n),U._batchEditable&&h._batchEditable&&U.isSelected(c)?U.sm().each(function(j){h.setValue?h.setValue(j,h,n,U):vn(j,V,T,n)}):h.setValue?h.setValue(c,h,n,U):vn(c,V,T,n)}},x.setCurrentEditor=function(s){this.endEditing(),this._currentEditor=s,this.redraw()},x.isEditing=function(u,G){var f=this,B=f._currentEditor;if(!B)return!1;if(G){var g=B.info;return g?(g.column||g.property)===G&&g.data===u:!1}return!0},x.endEditing=function(n){var X=this,p=X._currentEditor;p&&(delete X._currentEditor,p.commitValue&&p.commitValue(p.info,n),X.redraw(),X.getDataModel().endTransaction())},x.beginEditing=function(u){this.endEditing();var D=this,z=u.column||u.property;if(z.beginEditing)z.beginEditing(u);else{var F=u.data,n=u.value,A=D.getSelectBackground(F),l=z.getEnumValues(F),M=z.getSlider(F),e=z.getColorPicker(F);if(M){var f=Jl(Ht.Slider,M);return f.setValue(n),f.getView().onblur=function(){D.endEditing()},f.isInstant()&&(f.onValueChanged=function(){D.setValue(F,z,f.getValue())}),Ft(f,u),void 0}if(e||z.getValueType(F)===pq){var x=Jl(Ht.ColorPicker,e);return x.setValue(n),x.onClosed=function(){D.endEditing()},x.isInstant()&&(x.onValueChanged=function(R,u){D.setValue(F,z,u)}),Ft(x,u),x.open(),void 0}if(l){if(Ht.ComboBox){var j=new Ht.ComboBox;j.setValue(n),j.setValues(l),j.setLabels(z.getEnumLabels(F)),j.setIcons(z.getEnumIcons(F)),j.setEditable(z.isEnumEditable(F)),j.setStrict(z.isEnumStrict(F)),j.setMaxHeight(z.getEnumMaxHeight(F)),j.setDropDownWidth(z.getEnumDropDownWidth(F)),j.onClosed=function(){D.endEditing()},Ft(j,u),j.open()}else Gt(tf,u,A,l,z);return}var w=z.getValueType(F);if(w===kh||xn(n))return D.setValue(F,z,!n),void 0;if(z.getItemEditor(F)){var p=Bq(z.getItemEditor(F)),H=new p(F,z,D,u),t=H.getView();return t._17Q=H,H.setValue(n),Bp(t),Ft(t,u),H.editBeginning&&H.editBeginning(),void 0}Gt("input",u,A,$,z)}}},_44o:function(J){J.init=function(T){var s=this,W=s.th=new Xt(T),J=s._view=Ar(1,s);s.tv=s._tableView=T,$p(J,W.getView()),$p(J,T.getView()),W.mp(function(t){t.property===Tl&&s.iv()}),s.iv()},J.getTableView=function(){return this.tv},J.getTableHeader=function(){return this.th},J.getDataModel=function(){return this.tv.dm()},J.getColumnModel=function(){return this.tv.getColumnModel()},J.setColumns=function(o){this.tv.setColumns(o)},J.addColumns=function(l){this.tv.addColumns(l)},J.endEditing=function(){this.tv.endEditing()},J.validateImpl=function(){var U=this,g=U.th,s=Lb(g),J={x:0,y:0,width:U.getWidth(),height:s};Zg(g,J),J.y=s,J.height=E(0,U.getHeight()-s),Zg(U.tv,J)}},ms_vs:function(C){C._41o=function(){return this._29I.height<this._59I},C._43o=function(){var Y=this;Y._41o()&&(Y._58I||(Kb(function(){Y._94O()},tj),Y.iv()),Y._58I=new Date)},C._94O=function(){var I=this;if(I._58I){var Z=new Date;Z.getTime()-I._58I.getTime()>=tj?(delete I._58I,I.iv()):Kb(function(){I._94O()},tj)}},C._93I=function(){var I=this,g=I._27I;if(I._58I||!I._autoHideScrollBar){g||$p(I._79O,g=I._27I=Ic());var s=I._29I,H=s.height,A=I._59I,$=I.getScrollBarSize(),P=s.width-$-2,i=H*(-I.ty()/A),F=H*(H/A),E=g.style;A>H?(sc>F&&(i=i+F/2-sc/2,0>i&&(i=0),i+sc>H&&(i=H-sc),F=sc),E.visibility=uo,E.background=I.getScrollBarColor(),E.borderRadius=$/2+en,Zg(g,P,i,$,F)):E.visibility=Rq}else g&&(g.style.visibility=Rq)}},ms_hs:function(B){B._40o=function(){return this._29I.width<this._91I},B._42o=function(){var d=this;d._40o()&&(d._95O||(Kb(function(){d._94I()},tj),d.iv()),d._95O=new Date)},B._94I=function(){var K=this;if(K._95O){var I=new Date;I.getTime()-K._95O.getTime()>=tj?(delete K._95O,K.iv()):Kb(function(){K._94I()},tj)}},B._92I=function(){var l=this,w=l._28I;if(l._95O||!l._autoHideScrollBar){w||$p(l._79O,w=l._28I=Ic());var c=l._29I,i=c.width,e=l._91I,v=l.getScrollBarSize(),m=c.height-v-2,W=i*(-l.tx()/e),X=i*(i/e),_=w.style;e>i?(sc>X&&(W=W+X/2-sc/2,0>W&&(W=0),W+sc>i&&(W=i-sc),X=sc),_.visibility=uo,_.background=l.getScrollBarColor(),_.borderRadius=v/2+en,Zg(w,W,m,X,v)):_.visibility=Rq}else w&&(w.style.visibility=Rq)}}}),Yg(Wl,$l(16,16,[{type:Ne,rect:[1,1,14,14],background:qo},{type:ki,rect:[1,1,14,14],width:1,color:ai},{type:Rr,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),Yg(vj,$l(16,16,{type:ki,rect:[1,1,14,14],width:1,color:ai})),Yg(yl,$l(16,16,[{type:Oq,rect:[2,2,12,12],borderWidth:1,borderColor:ai,background:"#FFF"},{type:Oq,rect:[4,4,8,8],background:qo}])),Yg(rk,$l(16,16,{type:Oq,rect:[2,2,12,12],borderWidth:1,borderColor:ai})),Wi._15Q=function(L){L._29I=ze,L._59I=0,L._91I=0,L._5o=function(e){var i=this;i._30I=new Od,i._rows=new Od,i._rowMap={},i._31I=0,i._14I=0,i._view=Ar(1,i),i._canvas=qc(i._view),$p(i._view,i._79O=Ic()),i.dm(e?e:new Or)},L.getCheckIcon=function(t){var V=this.sm(),k=V.co(t);return V.sg()?Of(k?yl:rk):Of(k?Wl:vj)},L.checkData=function(F){var i=this.sm(),N=i.co(F);i.sg()&&N||(this._32o=1,N?i.rs(F):i.as(F),delete this._32o)},L.getDataAt=function(V){V.target&&(V=this.lp(V));var e=M(V.y/this._rowHeight),I=this._rows;return 0>e||e>=I.size()?$:I.get(e)},L.onDataDoubleClicked=function(){},L.onDataClicked=function(){},L.adjustTranslateX=function(){return 0},L.adjustTranslateY=function(g){var O=this.getHeight()-this._59I;return O>g&&(g=O),g>0?0:t(g)},L.onPropertyChanged=function(K){var c=this,O=K.property;Bt[O]?c.ivm():At[O]||c.redraw(),O===Ld?c._42o():O===dg&&c._43o()},L.getLabel=function(H){return H.toLabel()},L.getLabelFont=function(){return this._labelFont},L.getLabelColor=function(P){var $=this;if($.isCheckMode()){if($._focusData===P)return $._labelSelectColor}else if($.isSelected(P))return $._labelSelectColor;return $._labelColor},L.getStartRowIndex=function(){return this._31I},L.getEndRowIndex=function(){return this._14I},L.getRowDatas=function(){return this._rows},L.getRowIndex=function(D){return this._rowMap[D._id]},L.getRowSize=function(){return this._rows.size()},L.getViewRect=function(){return Bf(this._29I)},L.isVisible=function(E){return this._visibleFunc?this._visibleFunc(E):!0},L.getCurrentSortFunc=function(){return this._sortFunc},L.setDataModel=function(M){var I=this,n=I._dataModel,S=I._selectionModel;n!==M&&(n&&(n.umm(I.handleDataModelChange,I),n.umd(I.handleDataPropertyChange,I),n.umh(I.handleHierarchyChange,I),S||n.sm().ums(I.handleSelectionChange,I)),I._dataModel=M,M.mm(I.handleDataModelChange,I),M.md(I.handleDataPropertyChange,I),M.mh(I.handleHierarchyChange,I),S?S._21I(M):M.sm().ms(I.handleSelectionChange,I),I.fp("dataModel",n,M))},L.validateModel=function(){var m=this;m._rows.clear(),m._rowMap={},m.buildChildren(m._dataModel._roots);var D=m._rows=m._rows.toList(m.isVisible,m),O=0,q=m.getCurrentSortFunc(),R=D.size();for(q&&D.sort(q);R>O;O++)m._rowMap[D.get(O)._id]=O},L.buildChildren=function(F){var R=this;F.each(function(p){R._rows.add(p),R.buildChildren(p._children)})},L.handleDataModelChange=function(){this.ivm()},L.handleDataPropertyChange=function(t){"parent"===t.property?this.ivm():this.invalidateData(t.data)},L.handleHierarchyChange=function(){this.ivm()},L.handleSelectionChange=function(x){x.datas.each(this.invalidateData,this),this.onSelectionChanged(x)},L.onSelectionChanged=function(y){var r=this,m=r.sm();!r.isAutoMakeVisible()||1!==m.size()||"set"!==y.kind&&"append"!==y.kind||r._32o||r.makeVisible(m.ld())},L.handleBackgroundClick=function(S){ok(S)&&!this.isCheckMode()&&this.sm().cs()},L.makeVisible=function(S){S&&(this._23I=S,this.iv())},L.scrollToIndex=function(m){var U=this,k=U._29I,b=k.height,B=U._rowHeight,G=B*m;m>=0&&m<U._rows.size()&&b>0&&(G+B>k.y+b?U.ty(-G+b-B):G<k.y&&U.ty(-G))},L.autoScroll=function(b,P){var g=this,O=g._rowHeight,Z=O,D=O/4,r=g._29I,E=g.lp(b),H={x:g.tx(),y:g.ty()};return O>0&&r&&(E.x-r.x<Z?g.translate(D,0):r.x+r.width-E.x<Z&&g.translate(-D,0),E.y-r.y<Z?g.translate(0,D):r.y+r.height-E.y<Z&&g.translate(0,-D)),H.x=g.tx()-H.x,H.y=g.ty()-H.y,P&&(P.x+=H.x,P.y+=H.y),H},L.getTopRowOrderSelection=function(){var n=this.sm().getTopSelection(),j={},H=new Od;return n.each(function(O){j[O._id]=O}),this._rows.each(function(y){j[y._id]&&H.add(y)}),H},L.getRowOrderSelection=function(){var U=new Od;return this._rows.each(function(r){this.isSelected(r)&&U.add(r)},this),U},L.ivm=function(){this.invalidateModel()},L.invalidateModel=function(){var X=this;X._96I||(X._96I=1,X._32I=1,delete X._24I),X.iv()},L.redraw=function(){var S=this;S._32I||(S._32I=1,delete S._24I,S.iv())},L.invalidateData=function(J){var T=this;gi?T.redraw():T._32I||(T._24I||(T._24I={}),T._24I[J._id]=J,T.iv())},L.getFocusData=function(){return this._focusData},L.setFocusDataById=function(K){this.setFocusData(this.dm().getDataById(K))},L.setFocusData=function(J){var X=this,u=X._focusData;u!==J&&(X._focusData=J,X.fp("focusData",u,J),u&&X.invalidateData(u),J&&(X.invalidateData(J),X.isAutoMakeVisible()&&X.makeVisible(J)))},L.drawRowBackground=function(r,x,$,p,I,q,V){var s=this,U=s.isCheckMode();(x===s._focusData&&U||$&&!U)&&Dc(r,p,I,q,V,s.getSelectBackground(x))},L.drawData=function(W,D,y){var l=this,s=l._rowHeight,X=s*y,G=l._29I,U=G.x,x=G.width;W.save(),W.beginPath(),W.rect(U,X,x,s),W.clip(),l._87o(l.drawRow(W,D,l.isSelected(D),U,X,x,s),y,U,X,x,s),W.restore(),l._rowLineVisible&&Dc(W,U,X+s-1,x,1,l._rowLineColor)},L._12I=function(M){var h=this,O=h._31I,n=h._29I,u=n.x,K=n.y,U=n.width,x=n.height;for(M.beginPath(),M.rect(u,K,U,x),M.clip(),M.clearRect(u,K,U,x),h._76o(),h._93db(M);O<h._14I;O++)h.drawData(M,h._rows.get(O),O);h._92db(M)},L._13I=function(w){for(var K,J=this,v=J._rowHeight,q=J._29I,o=q.x,r=q.width,n=J._31I,l=J._30I;n<J._14I;n++)K=J._rows.get(n),J._24I[K._id]&&l.add({data:K,index:n});l.isEmpty()||(w.beginPath(),l.each(function(t){w.rect(o,t.index*v,r,v)}),w.clip(),l.each(function(f){w.clearRect(o,f.index*v,r,v)}),l.each(function(B){J._77o(B.index)}),J._93db(w),l.each(function(j){J.drawData(w,j.data,j.index)}),J._92db(w),l.clear())},L.preValidateModel=function(){this.endEditing&&this.endEditing()},L.validateImpl=function(){var u=this,V=u._canvas,W=u.getWidth(),_=u.getHeight(),C=u._rowHeight,L=u._32I;(W!==V.clientWidth||_!==V.clientHeight)&&(Kc(V,W,_),L=1),u._96I&&(u.preValidateModel(),u.validateModel());var m=u._29I,r={x:-u.tx(),y:-u.ty(),width:W,height:_},S=u._rows.size(),X=te(V),f=u._23I;L||co(r,m)||(L=1),u._29I=r,u._59I=S*C,u._31I=M(r.y/C),u._14I=l((r.y+r.height)/C),u._31I<0&&(u._31I=0),u._14I>S&&(u._14I=S),u._99I&&L&&u._99I();var e=u.tx(),v=u.ty();(u._40o()||u._41o())&&(u._59I+=u.getScrollBarSize(),u._99I&&L&&(u._91I+=u.getScrollBarSize())),Vq&&!Zk&&(X.save(),Tj(X,W/ym.length,_/ym.length,1)),Tj(X,e,v,1),L?u._12I(X):u._24I&&u._13I(X),u._93I(),u._92I(),X.restore(),u._32I=u._24I=u._96I=$,f&&(u.scrollToIndex(u.getRowIndex(f)),delete u._23I),u.tx(u.tx()),u.ty(u.ty())},L.canHandleSelectMode=function(){return!0}},Wi._48o=function(b){b._rootVisible=!0,b._rootData=$,b._35o=function(){this._expandMap={},this._levelMap={}},b.validateModel=function(){var s=this,c=s._rootData;s._rows.clear(),s._levelMap={},s._rowMap={},s._currentLevel=0,c?s._rootVisible?s.isVisible(c)&&s.buildData(c):s.buildChildren(c):s.buildChildren(),delete s._currentLevel},b.buildData=function(w){var z=this,N=w._id,W=z._rows;z._rowMap[N]=W.size(),W.add(w),z._levelMap[N]=z._currentLevel,z.isExpanded(w)&&(z._currentLevel++,z.buildChildren(w),z._currentLevel--)},b.buildChildren=function(D){var k=this,M=D?D._children:k._dataModel._roots,P=k.getCurrentSortFunc();P&&k.isChildrenSortable(D)?M.toList(k.isVisible,k).sort(P).each(k.buildData,k):M.each(function(D){k.isVisible(D)&&k.buildData(D)})},b.getLevel=function(N){return this._levelMap[N._id]},b.getToggleIcon=function(K){var I=this,_=I._loader,M=I._collapseIcon;return _&&!_.isLoaded(K)?M:K.hasChildren()?I.isExpanded(K)?I._expandIcon:M:$},b.isCheckMode=function(){return this._checkMode!=$},b.isChildrenSortable=function(){return!0},b.handleDataModelChange=function(a){var M=this;a.kind===Vc?delete M._expandMap[a.data._id]:a.kind===vo&&(M._expandMap={}),M.ivm()},b.toggle=function(T){var d=this;d.isExpanded(T)?d.collapse(T):d.expand(T)},b.isExpanded=function($){return 1===this._expandMap[$._id]},b.expand=function(c){var d=this,Y=d._loader;d.isExpanded(c)||(Y&&!Y.isLoaded(c)&&Y.load(c),d._expandMap[c._id]=1,d.ivm(),d.onExpanded(c))},b.onExpanded=function(){},b.collapse=function(j){var O=this;O.isExpanded(j)&&(delete O._expandMap[j._id],O.ivm(),O.onCollapsed(j))},b.onCollapsed=function(){},b.expandAll=function(U){if(U)this.expand(U),U.eachChild(function(l){this.expandAll(l)},this);else{var F=this;F._dataModel.each(function(l){l.hasChildren()&&(F._expandMap[l._id]=1)}),F.ivm()}},b.collapseAll=function(){this._expandMap={},this.ivm()},b.makeVisible=function(p){if(p){var R=this;if(!R._rootData||p.isDescendantOf(R._rootData)){for(var D=p._parent;D;)R.expand(D),D=D._parent;R._23I=p,R.iv()}}},b.checkData=function(f){var e,z=this,N=z._checkMode,x=z.sm(),K=x.co(f);if(!x.sg()||!K){if(z._32o=1,N===de)K?x.rs(f):x.as(f);else if(N===Re)e=new Od(f),e.addAll(f._children);else if("descendant"===N)e=new Od,Dt(f,e);else if("all"===N&&(e=new Od,Dt(f,e),!K))for(var p=f._parent;p;)e.add(p),p=p._parent;e&&(K?x.rs(e):x.as(e)),delete z._32o}},b.drawTree=function(y,H,R,z,v,u,Z){var Q=this,x=Q._indent,L=Q._levelMap[H._id],j=Q.getIconWidth(H),$=Of(Q.getToggleIcon(H));$?(z+=x*L,Mq(y,$,z+x/2,v+Z/2,H,Q),z+=x):z+=x*(L+1),Q._checkMode&&(Mq(y,Q.getCheckIcon(H),z+x/2,v+Z/2,H,Q),z+=x),Q.drawIcon(y,H,z,v,j,Z),Q.drawLabel(y,H,z+j,v,Z)}},Wi._14Q=function(q){q.getIcon=function(M){return M.getIcon()},q.getIconWidth=function($){return this.getIcon($)?this._indent:0},q.drawIcon=function(B,G,Z,o,A,s){if(A){var j=this,M=j.getBodyColor(G),t=Of(j.getIcon(G),M);t&&(s-=j.isRowLineVisible()?1:0,Gp(B,t,Hc,Z,o,A,s,G,j,M),cc(B,j.getBorderColor(G),Z,o,A,s))}},q.drawLabel=function(G,y,E,t,U){var X=this;$d(G,X.getLabel(y),X.getLabelFont(y),X.getLabelColor(y),E,t,0,U)}},Wi._50o=function(z){z._98I=function(){var Z=this,T=Z._39o=new Or;Z._60I=new Od,T.mm(Z._17o,Z),T.md(Z._18o,Z),T.mh(Z._19o,Z)},z.setColumns=function(m){this._39o.clear(),this.addColumns(m)},z.addColumns=function(D){var B=this._39o;D.forEach(function(t){if(!(t instanceof Kt)){var b=Bq(t.className);t=Jl(b?b:Kt,t)}B.add(t)})},z.onColumnClicked=function(){},z.onCheckColumnClicked=function(){},z._3Q=function(t){for(var a,B=0,E=this._60I,N=E.size();N>B;B++)if(a=E.get(B),a.column===t)return a;return $},z.getColumnAt=function(U){var b=this._4Q(U);return b?b.column:$},z._4Q=function(H){for(var K=this,j=H.target?K.lp(H).x:H.x,Z=K._60I,v=0;v<Z.size();v++){var R=Z.get(v),w=R.startX;if(j>=w&&j<w+R.column.getWidth())return R}return $},z.getToolTip=function(E){var c=this,g=c.getDataAt(E),a=c.getColumnAt(E);return g&&a?a.getToolTip(g,c):$},z.adjustTranslateX=function($){var r=this.getWidth()-this._91I;return r>$&&($=r),$>0?0:t($)},z._99I=function(){var l=this,G=l._29I,N=l._60I;N.clear(),l._91I=0,l._39o._roots.each(function(e){if(e.isVisible()){var p=l._91I+e.getWidth();l._91I<=G.x+G.width&&p>=G.x&&N.add({column:e,startX:l._91I}),l._91I=p}})},z.drawData=function(s,Z,v){var o=this,i=o._rowHeight,e=i*v,O=o.isSelected(Z),F=o._29I,E=F.x,C=F.width;o.drawRowBackground(s,Z,O,E,e,C,i),o._60I.each(function(T){var C=T.column,R=T.startX,_=C.getWidth();_>0&&!o.isEditing(Z,C)&&(s.save(),s.beginPath(),s.rect(R,e,_,i),s.clip(),o._87o(o.drawCell(s,Z,O,C,R,e,_,i),v,R,e,_,i),o._columnLineVisible&&Dc(s,R+_-1,e,1,i,o._columnLineColor),s.restore())}),o._rowLineVisible&&Dc(s,E,e+i-1,C,1,o._rowLineColor)},z.drawCell=function(B,$,O,_,n,C,c,o){var D=this;if(_.drawCell)return _.drawCell(B,$,O,_,n,C,c,o,D);var l=D.getValue($,_);Et(B,l,_,D.getLabelFont($,_,l),D.getLabelColor($,_,l),n,C,c,o,$,D)},z.getColumnModel=function(){return this._39o},z._17o=function(){this.redraw()},z._18o=function(e){var C=this;e.data===C._sortColumn&&zt[e.property]?C.ivm():(C._42o(),C.redraw())},z._19o=function(){this.redraw()},z.getCurrentSortFunc=function(){var o=this,Y=o._sortColumn;if(Y&&Y.isSortable()){var a=Y.getSortFunc(),r=Mi===Y.getSortOrder()?1:-1;return a||(a=Hq),function(e,A){return a.call(o,o.getValue(e,Y),o.getValue(A,Y),e,A)*r}}return o._sortFunc},z.isCellEditable=function(d,v,X){return v.isEditable()&&this.isEditable()?v.isCellEditable?v.isCellEditable(d,v,X,this):!0:!1},z._37O=function(m,g){if(ok(g))for(var e=this,t=e.lp(g),M=e._60I,s=e._rowHeight,l=e._29I,A=l.x,y=l.y,R=l.width,k=l.height,S=0;S<M.size();S++){var G=M.get(S),E=G.startX,d=G.column,C=d.getWidth();if(d!==e._31o&&d!==e._4o&&t.x>=E&&t.x<E+C&&e.isCellEditable(m,d,g)){var q={x:E,y:e.getRowIndex(m)*s,width:C,height:s},I={x:q.x+e.tx(),y:q.y+e.ty(),width:q.width,height:q.height},o=0,D=0;return q.x<A?o=q.x-A:q.x+q.width>A+R&&(o=q.x+q.width-A-R),o&&(e.tx(e.tx()-o),I.x-=o),q.y<y?D=q.y-y:q.y+s>y+k&&(D=q.y+s-y-k),D&&(e.ty(e.ty()-D),I.y-=D),e.beginEditing({data:m,column:d,value:e.getValue(m,d),event:g,rect:q,editorRect:I,view:e}),void 0}}}},Ht.BaseItemEditor=function(n,t,J,L){this._data=n,this._column=t,this._master=J,this._editInfo=L},It("BaseItemEditor",b,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Jt=A.Tab=function(){ud(Jt,this)};Mf("Tab",$h,{ms_ac:["view","closable","disabled","visible"],_icon:$,_closable:!1,_disabled:!1,_visible:!0,setParent:of});var Kt=A.Column=function(){ud(Kt,this)};Mf("Column",$h,{_46o:1,ms_ac:["accessType","valueType",uo,ql,zf,Ac,"align",pq,"sortOrder",hm,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Mi,_sortFunc:$,_sortable:!0,_clickable:!0,setWidth:function(Z){16>Z&&(Z=16);var m=this._width;this._width=Z,this.fp(Ac,m,Z)},getToolTip:function(w,W){return this.formatValue(W.getValue(w,this))}});var Lt=A.Property=function(){ud(Lt,this)};Mf("Property",$h,{_46o:1,ms_ac:["accessType","valueType",ql,zf,"categoryName",pq,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:$,getToolTip:function(e,v,S){var n=this;return v?n.formatValue(S.getValue(e,n)):S.getPropertyName(n)}}),Ht.AccordionView=function(){var m=this;m._20o={},m._21o=new Od,m._10o=$,m._9o=$,m._11o=$,m._view=Ar(0,m),m.iv()},It("AccordionView",b,{ms_v:1,ms_fire:1,ms_ac:[Dl,bm,"titleHeight",Mk,nl,"titleBackground","selectWidth",cn,"orientation","separatorColor"],_expandIcon:u.accordionViewExpandIcon,_collapseIcon:u.accordionViewCollapseIcon,_titleHeight:fh,_labelColor:u.accordionViewLabelColor,_labelFont:u.accordionViewLabelFont,_titleBackground:u.accordionViewTitleBackground,_selectBackground:u.accordionViewSelectBackground,_selectWidth:u.accordionViewSelectWidth,_orientation:"v",_separatorColor:u.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(U,R,V,N){var z=this,w=Ic(),$={content:R,div:w,canvas:qc(w),icon:N};if(z._20o[U])throw U+" already exists";var O=$.downEventFunc=function(z){Mm(z)},Y=$.upEventFunc=function(g){Mm(g),ok(g)&&(z._10o===U?z.collapse():z.expand(U))};[wc,yk].forEach(function(B){f(w,B,O)}),[Po,Tm].forEach(function(y){f(w,y,Y)}),w.style.cursor=cd,$p(z._view,w),z._20o[U]=$,z._21o.add(U),V&&z.expand(U),z.iv()},remove:function(u){var O=this,Y=O._20o[u];if(Y){var d=Y.div;lk(d),[wc,yk].forEach(function(f){I(d,f,Y.downEventFunc)}),[Po,Tm].forEach(function(v){I(d,v,Y.upEventFunc)}),delete O._20o[u],O._21o.remove(u),O.iv()}},clear:function(){var u=this;u._21o.toArray().forEach(u.remove,u),u._20o={},u._21o.clear(),u.iv()},isExpanded:function(n){return this._10o===n},expand:function(t){var h=this;h._20o[t]&&h._10o!==t&&(h._10o=t,h.onExpanded(t),h.iv())},onExpanded:function(){},collapse:function(){var E=this;E._10o&&(E.onCollapsed(E._10o),delete E._10o,E.iv())},onCollapsed:function(){},initCanvas:function(F,Z,R){Kc(F,Z,R);var r=te(F);return Tj(r,0,0,1),r.clearRect(0,0,Z,R),r},drawTitle:function(K,O,f,n,r){var F=this,k=Of(r.icon),i=F.isExpanded(O),a=F._titleHeight,T=F._titleBackground,p=F._selectWidth,j=F._separatorColor,B=Of(i?F._expandIcon:F._collapseIcon),G=p+4;Dc(K,0,0,f,n,T),i&&p&&Dc(K,0,0,p,n,F._selectBackground),(i||F._21o.get(F._21o.size()-1)!==O)&&Dc(K,0,n-1,f,1,j?j:bf(T)),k&&(Mq(K,k,G+Hn(k)/2,a/2),G+=Hn(k)+2),$d(K,O,F.getLabelFont(O),F.getLabelColor(O),G,0,0,a),B&&Mq(K,B,f-Hn(B)/2-4,a/2)},validateImpl:function(){var u=this,q=u._view,d=0,K=0,X=u.getWidth(),Q=u.getHeight(),i=u._titleHeight,h=u._21o.size()*i,z=u._11o,v=u._9o;delete u._11o,delete u._9o,u._21o.each(function(p){var s,z,t=u._20o[p],V=t.content,Z=u._10o===p;_g(u)?(Zg(t.div,d,0,i,Q),s=u.initCanvas(t.canvas,i,Q),Ge(s,0,Q),zo(s,-Ce),u.drawTitle(s,p,Q,i,t),s.restore(),Z?(z=E(0,X-h),V&&(u._11o=V,u._9o=Al(V),Zg(V,d+i,0,z,Q)),d+=i+z):d+=i):(Zg(t.div,0,K,X,i),s=u.initCanvas(t.canvas,X,i),u.drawTitle(s,p,X,i,t),s.restore(),Z?(z=E(0,Q-h),V&&(u._11o=V,u._9o=Al(V),Zg(V,0,K+i,X,z)),K+=i+z):K+=i)});var x=u._9o;z&&z!==u._11o&&z.endEditing&&z.endEditing(),x&&x!==v&&$p(q,x),v&&v!==x&&lk(v)}}),Ht.SplitView=function(Q,S,T,Y){var o=this,d=o._dividerDiv=Ic(),E=o._60O=qc(),a=o._61O=qc(),y=E.style,W=a.style;o._view=Ar(1,o),$p(o._view,d),y.msTouchAction=Qc,y.pointerEvents=Qc,y.cursor=cd,W.msTouchAction=Qc,W.pointerEvents=Qc,W.cursor=cd,Q&&o.setLeftView(Q),S&&o.setRightView(S),T&&o.setOrientation(T),Y!=$&&o.setPosition(Y),o.setStatus(id),new Mt(o)},It("SplitView",b,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:u.splitViewDividerSize,_dividerBackground:u.splitViewDividerBackground,_dragOpacity:u.splitViewDragOpacity,_toggleIcon:u.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(I,Y){var J=this,r=J._position;isNaN(I)||(Y||(J._82O=0>I?-1:I>1?1:0),J._position=I,J.fp(zk,r,I))},getLeftView:function(){return this._leftView},setLeftView:function(m){var w=this,s=w._leftView,P=w._view;if(w._leftView!==m){if(s&&s!==w._rightView){var L=Al(s);L.parentNode===P&&lk(L)}if(w._leftView=m,m){var u=Al(m);u.parentNode!==P&&P.insertBefore(u,w._dividerDiv)}w.fp("leftView",s,m)}},getRightView:function(){return this._rightView},setRightView:function(R){var U=this,J=U._rightView,v=U._view;if(U._rightView!==R){if(J&&J!==U._leftView){var C=Al(J);C.parentNode===v&&lk(C)}if(U._rightView=R,R){var M=Al(R);M.parentNode!==v&&v.insertBefore(M,U._dividerDiv)}U.fp("rightView",J,R)}},validateImpl:function(){var v=this,j=v._draggable,b=v._position,V=v.getWidth(),P=v.getHeight(),y=v._dividerSize,Q=v._dividerBackground,o=Ze?18:8,h=v._dividerDiv,f=v._82O,g=v._60O,J=v._61O,T=v._toggleIcon,A=v._status,R=h.style,N=null,z=Ze?20:4,X=T.comps[0];y>=o||0===y?v._coverDiv&&(lk(v._coverDiv),delete v._coverDiv):v._coverDiv||(v._coverDiv=Ic(),yo&&(v._coverDiv.style.background=ld),$p(h,v._coverDiv)),v._togglable?g.parentNode||($p(h,g),$p(h,J)):(lk(g),lk(J));var M=v._coverDiv,n=v._leftView,i=v._rightView;if(_g(v)){if(y>V&&(y=V),A===id)if(1===f)var w=O(b,V),F=E(0,V-y-w);else-1===f?(F=O(-b,V),w=E(0,V-y-F)):(w=t((V-y)*b),F=E(0,V-y-w));else"cl"===A?(w=0,F=E(0,V-y)):"cr"===A&&(F=0,w=E(0,V-y));n&&Zg(n,0,0,w,P),i&&Zg(i,w+y,0,F,P),Zg(h,w,0,y,P),v._22o=w,M&&(Zg(M,y/2-o/2,0,o,P),M.style.cursor=j?Bm:""),h.style.cursor=j?Bm:"";var C=h.clientHeight/2,c=h.clientWidth;Kc(g,c,c),Zg(g,0,C-c-z,c,c),N=te(g),Tj(N,0,0,1),X.rotation=-Ce,zm(N,T,0,0,c,c),N.restore(),Kc(J,c,c),Zg(J,0,C+z,c,c),N=te(J),Tj(N,0,0,1),X.rotation=Ce,zm(N,T,0,0,c,c),N.restore()}else{if(y>P&&(y=P),A===id)if(1===f)var U=O(b,P),B=E(0,P-y-U);else-1===f?(B=O(-b,P),U=E(0,P-y-B)):(U=t((P-y)*b),B=E(0,P-y-U));else"cl"===A?(U=0,B=E(0,P-y)):"cr"===A&&(B=0,U=E(0,P-y));n&&Zg(n,0,0,V,U),i&&Zg(i,0,U+y,V,B),Zg(h,0,U,V,y),v._22o=U,M&&(Zg(M,0,y/2-o/2,V,o),M.style.cursor=j?xr:""),R.cursor=j?xr:"";var r=h.clientWidth/2,c=h.clientHeight;Kc(g,c,c),Zg(g,r-c-z,0,c,c),N=te(g),Tj(N,0,0,1),X.rotation=0,zm(N,T,0,0,c,c),N.restore(),Kc(J,c,c),Zg(J,r+z,0,c,c),N=te(J),Tj(N,0,0,1),X.rotation=Z,zm(N,T,0,0,c,c),N.restore()}R.background=Q}});var Mt=function(R){this.sv=R,this.addListeners()};bd(Mt,b,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(R){var Z=this,O=Z.sv,C=O._dividerDiv,K=O._60O,c=O._61O,$=O._status,t=R.target;if(t===K)$===id?O.setStatus("cl"):"cr"===$&&O.setStatus(id);else if(t===c)$===id?O.setStatus("cr"):"cl"===$&&O.setStatus(id);else if(Hh(R)&&(t===C||t===O._coverDiv)&&(Mm(R),O.isDraggable())){O.getLeftView(),O.getRightView();var M=Z.maskDiv=Ic();if(M.style.left=0,M.style.top=0,M.style.width=O.getWidth()+"px",M.style.height=O.getHeight()+"px",O.getView().appendChild(M),!O.isContinuousLayout()){var s=Z.resizeDiv=Ic();s.style.left=C.style.left,s.style.top=C.style.top,s.style.width=C.style.width,s.style.height=C.style.height,s.style.opacity=O.getDragOpacity(),s.style.background=O.getDividerBackground(),$p(Z.getView(),s)}Z._lastAbsPosition=O._22o,Z._86o=_g(O)?dj(R).x:dj(R).y,ec(Z,R)}},handleWindowTouchMove:function(X){Hh(X)&&this.update(X,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(j){var k=this;k.update(j,!0),k.sv.setStatus(id),k.maskDiv&&lk(k.maskDiv),k.resizeDiv&&lk(k.resizeDiv),k.maskDiv=k.resizeDiv=$},handle_mousedown:function(_){ok(_)&&this.handle_touchstart(_)},handleWindowMouseMove:function(C){this.handleWindowTouchMove(C)},handleWindowMouseUp:function(X){this.handleWindowTouchEnd(X)},update:function(b,T){var m=this,q=m.sv,x=_g(q)?q.getWidth():q.getHeight(),O=q._dividerSize,V=m._lastAbsPosition-m._86o;_g(q)?(V+=dj(b).x,V>x-O&&(V=x-O),0>V&&(V=0),m.resizeDiv&&(m.resizeDiv.style.left=V+en)):(V+=dj(b).y,V>x-O&&(V=x-O),0>V&&(V=0),m.resizeDiv&&(m.resizeDiv.style.top=V+en)),T&&x!==O&&(1===q._82O?q.setPosition(V,1):-1===q._82O?q.setPosition(V-x+O,1):q.setPosition(V/(x-O),1))}}),Ht.TabView=function(){var T=this,B=T._view=Ar(1,T),E=T._91O=Ic(1),o=T._tabModel=new Or,n=o.sm(),v=T.invalidate;T._7o=new Od,T._canvas=qc(E),$p(B,E),$p(B,T._92O=Ic(1)),n.setSelectionMode(Wb),n.ms(T.handleSelectionChange,T),o.mm(v,T),o.mh(v,T),o.md(v,T),T._interactor=new Nt(T),T.iv()},It("TabView",b,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Mk,nl,"tabHPadding","tabBackground","selectWidth",cn,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:Yd,_tabHeight:fh,_tabGap:u.tabViewTabGap,_labelColor:u.tabViewLabelColor,_labelFont:u.tabViewLabelFont,_tabBackground:u.tabViewTabBackground,_selectWidth:u.tabViewSelectWidth,_selectBackground:u.tabViewSelectBackground,_moveBackground:u.tabViewMoveBackground,_insertColor:u.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(f,O,C){var t,P=this._tabModel;return f instanceof Jt?(t=f,O&&t.setView(O)):(t=new Jt,t.setName(f),t.setView(O)),P.add(t),C&&P.sm().ss(t),t},getLabel:function(k){return k.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(O){this._23o=O,this.iv()},get:function(c){var Y=this,E=Y._tabModel;if(fl(c))return E._roots.get(c);if(ph(c)){var G;return E.each(function(O){c===Y.getLabel(O)&&(G=O)}),G}return c instanceof Jt?c:$},select:function(D){this._tabModel.sm().ss(this.get(D))},remove:function(U){var W=this;if(U=W.get(U)){var c=W._tabModel,q=c._roots.indexOf(U);W._tabModel.remove(U),W.selectByIndex(--q)}},getCurrentTab:function(){return this._8o},hideTabView:function(w,H){H.parentNode===this._92O&&(jp(H)?(H.style.display=hh,H._tab_=w):lk(H),Wo())},showTabView:function(G,W){jp(W)&&(W.style.display="block",W._tab_=G),W.parentNode!==this._92O&&($p(this._92O,W),Wo())},_24o:function(){var c,x=this,n=x._8o,J=x._9o,I=x._tabModel.sm().ld();I&&(c=Al(I.getView())),c!==J&&(J&&(n.getView()&&n.getView().endEditing&&n.getView().endEditing(),x.hideTabView(n,J)),c&&x.showTabView(I,c)),x._8o=I,x._9o=c,n!==I&&x.onTabChanged(n,I)
},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(q,y){this.selectByIndex(--y)},selectByIndex:function(d){var r=this,h=r._tabModel,K=h.size();if(K&&!h.sm().ld()){d==$&&(d=0),d>=K&&(d=K-1),0>d&&(d=0);for(var W=d;W>=0;W--){var z=r.get(W);if(!z.isDisabled())return r.select(z),z}for(W=d+1;K>W;W++)if(z=r.get(W),!z.isDisabled())return r.select(z),z}},getTabWidth:function(W){var K=this.getTabHPadding(),N=4+2*K,h=Of(W.getIcon());h&&(N+=Hn(h,W)+4);var w=this.getLabel(W);return w&&(N+=bq(this.getLabelFont(W),w).width+4),W.isClosable()&&(N+=10),N},drawTab:function(i,x,j,g,T,l,Q){var U,X=this,q=X._tabPosition,n=this.getTabHPadding(),N=j+4+n,v=X._selectWidth,b=Of(x.getIcon()),H=x.isDisabled(),f=X.getLabelColor(x),$=X.getLabelFont(x),M=X.getLabel(x),F=X._selectBackground,J=q===sl+"-vertical",Y=q===vp+"-vertical";(J||Y)&&(N=g+4+n),H&&(i.globalAlpha=uh),Dc(i,j,g,T,l,Q),x===X._8o&&v&&(q===Yd?Dc(i,j,g+l-v,T,v,F):q===sl?Dc(i,j+T-v,g,v,l,F):q===vp?Dc(i,j,g,v,l,F):J?Dc(i,j+T-v,g,v,l,F):Y?Dc(i,j,g,v,l,F):Dc(i,j,g,T,v,F));var K=T/2;if(J&&(Ge(i,K,g+l/2),zo(i,Z),Ge(i,-K,-g-l/2)),b){var c=ks(b,x),u=Hn(b,x);if(J||Y){var P=j+T/2,d=N+c/2;Ge(i,P,d),zo(i,Ce),Ge(i,-P,-d),Mq(i,b,j+T/2,N+c/2,x,X),Ge(i,P,d),zo(i,-Ce),Ge(i,-P,-d),N+=c+4}else Mq(i,b,N+u/2,g+l/2,x,X),N+=u+4}return J||Y?(Ge(i,T/2,N+T/2),zo(i,Ce),Ge(i,-T/2,-N-T/2),$d(i,M,$,f,j,N,l,T),Ge(i,T/2,N+T/2),zo(i,-Ce),Ge(i,-T/2,-N-T/2)):$d(i,M,$,f,N,g,T,l),J&&(Ge(i,K,g+l/2),zo(i,-Z),Ge(i,-K,-g-l/2)),x.isClosable()&&(U=Y?{x:j+T-12,y:g+l-12,width:12,height:12}:{x:j+T-12,y:g+2,width:12,height:12},this.drawCloseIcon(x,i,f,U)),H&&(i.globalAlpha=1),U},drawCloseIcon:function(e,J,Q,f){var Y=f.x,$=f.y;J.strokeStyle=Q,J.lineWidth=1,J.beginPath(),J.moveTo(Y+2,$+8),J.lineTo(Y+8,$+2),J.moveTo(Y+8,$+8),J.lineTo(Y+2,$+2),J.stroke()},getTabAt:function($){var U=this._interactor._8Q($);return U?U.tab:null},validateImpl:function(){var v=this;v._24o();var c,P=v._canvas,e=v._tabPosition,q=v._91O,l=v._92O,F=v._tabModel,m=v.getWidth(),w=v.getHeight(),b=v._tabHeight,Y=v._7o,y=v._tabGap,O=e===Yd,f=e===sl,o=e===vp,s=e===sl+"-vertical",X=e===vp+"-vertical",i=v._23o,S=0;if((f||o)&&F._roots.each(function(C){S=E(v.getTabWidth(C),S)}),O?(Zg(q,0,0,m,b),c={x:0,y:b,width:m,height:E(0,w-b)}):f?(Zg(q,0,0,S,w),c={x:S,y:0,width:E(0,m-S),height:w}):o?(Zg(q,m-S,0,S,w),c={x:0,y:0,width:E(0,m-S),height:w}):s?(Zg(q,0,0,b,w),c={x:b,y:0,width:E(0,m-b),height:w}):X?(Zg(q,m-b,0,b,w),c={x:0,y:0,width:E(0,m-b),height:w}):(Zg(q,0,w-b,m,b),c={x:0,y:0,width:m,height:E(0,w-b)}),Zg(l,c),s||X){v._9o&&(c.x=0,Zg(v._8o.getView(),c)),Kc(P,b,w);var d=te(P),j=0;if(Tj(d,0,v.ty(),1),d.clearRect(0,0,b,w),Y.clear(),F._roots.each(function(F){if(F.isVisible()){var O,D=v.getTabWidth(F);if(!i||i.tab!==F){var o=v.getTabBackground(F);O=v.drawTab(d,F,0,j,b,D,o)}Y.add({_75o:O,tab:F,startY:j,endY:j+D,height:D}),j+=D+y}}),v._23Q=E(0,j-y),i){var H=i.position;v.drawTab(d,i.tab,0,i.startY,b,i.height,v._moveBackground),Dc(d,0,H,b,1,v._insertColor)}if(d.restore(),v._selectionChanged){v._selectionChanged=!1;for(var g=v.ty(),K=0;K<Y.size();K++){var B=Y.get(K);if(B.tab===v._8o){if(B.endY+g<0){v.ty(-B.startY);break}if(B.startY+g>w){v.ty(w-B.endY);break}}}}v.ty(v.ty())}else if(f||o){v._9o&&(c.x=0,Zg(v._8o.getView(),c)),Kc(P,S,w);var d=te(P),j=0;if(Tj(d,0,v.ty(),1),d.clearRect(0,0,S,w),Y.clear(),F._roots.each(function(Z){if(Z.isVisible()){var q;if(!i||i.tab!==Z){var M=v.getTabBackground(Z);q=v.drawTab(d,Z,0,j,S,b,M)}Y.add({_75o:q,tab:Z,startY:j,endY:j+b,height:b}),j+=b+y}}),v._23Q=E(0,j-y),i){var H=i.position;v.drawTab(d,i.tab,0,i.startY,S,i.height,v._moveBackground),Dc(d,0,H,S,1,v._insertColor)}if(d.restore(),v._selectionChanged){v._selectionChanged=!1;for(var g=v.ty(),K=0;K<Y.size();K++){var B=Y.get(K);if(B.tab===v._8o){if(B.endY+g<0){v.ty(-B.startY);break}if(B.startY+g>w){v.ty(w-B.endY);break}}}}v.ty(v.ty())}else{v._9o&&(c.y=0,Zg(v._8o.getView(),c)),Kc(P,m,b);var d=te(P),T=0;if(Tj(d,v.tx(),0,1),d.clearRect(0,0,m,b),Y.clear(),F._roots.each(function(L){if(L.isVisible()){var R,w=v.getTabWidth(L);if(!i||i.tab!==L){var u=v.getTabBackground(L);R=v.drawTab(d,L,T,0,w,b,u)}Y.add({_75o:R,tab:L,startX:T,endX:T+w,width:w}),T+=w+y}}),v._64I=E(0,T-y),i){var H=i.position;v.drawTab(d,i.tab,i.startX,0,i.width,b,v._moveBackground),be(d,v._insertColor,H,0,b)}if(d.restore(),v._selectionChanged){v._selectionChanged=!1;for(var A=v.tx(),K=0;K<Y.size();K++){var B=Y.get(K);if(B.tab===v._8o){if(B.endX+A<0){v.tx(-B.startX);break}if(B.startX+A>m){v.tx(m-B.endX);break}}}}v.tx(v.tx())}for(var t=[],u=l.children,K=0;K<u.length;K++){var R=u[K],p=R._tab_;p&&!F.contains(p)&&t.push(R)}t.forEach(function(S){l.removeChild(S)})}});var Nt=function(L){this.tv=L,this.addListeners()};bd(Nt,b,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(i){this.handleScroll(i,10*(i.wheelDelta/40))},handle_DOMMouseScroll:function(V){this.handleScroll(V,10*-V.detail)},handleScroll:function(c,X){Mm(c);var R=this.tv,t=R._tabPosition;!R._40o()||t!==Yd&&t!==gg||R.tx(this.tv.tx()+X),!R._41o()||t!==sl&&t!==vp&&t!==sl+"-vertical"&&t!==vp+"-vertical"||R.ty(this.tv.ty()+X)},_8Q:function(t){var e,S,q=this.tv,M=q._tabPosition,J=q._7o;if(M===Yd||M===gg){var A=q.lp(t).x;for(e=0;e<J.size();e++)if(S=J.get(e),S.startX<=A&&A<=S.endX)return S}else if(M===sl||M===vp||M===sl+"-vertical"||M===vp+"-vertical"){var k=q.lp(t).y;for(e=0;e<J.size();e++)if(S=J.get(e),S.startY<=k&&k<=S.endY)return S}return $},isClickable:function(D){var W=this.tv,M=W._tabPosition,v=this._73o=this._8Q(D);return!W._40o()||M!==Yd&&M!==gg?!W._41o()||M!==sl&&M!==vp&&M!==sl+"-vertical"&&M!==vp+"-vertical"?v&&(!v.tab.isDisabled()||W.isMovable()):!0:!0},handle_mousemove:function(y){var V=this;Iq?V._74o=V._8Q(y):V.getView().style.cursor=V.isClickable(y)?cd:""},handle_mousedown:function(J){this.handle_mousemove(J),this.handle_touchstart(J)},handle_touchstart:function(Y){var U=this,g=U.tv,N=g._tabPosition;Mm(Y),ok(Y)&&U.isClickable(Y)&&(N===Yd||N===gg?(U.x=dj(Y).x,U.lp=g.lp(Y),U.tx=g.tx()):(U.y=dj(Y).y,U.lp=g.lp(Y),U.ty=g.ty()),ec(U,Y))},handle_mouseup:function(W){this.handle_touchend(W)},handle_touchend:function(l){if(Tc(l)){var Q=this._73o;if(!Q)return;var B=this.tv,U=B.getTabModel(),Z=Q.tab;if(!Z.isDisabled()&&Z.isClosable()){var J=function(){var Y=U._roots.indexOf(Z);U.remove(Z),B.onTabClosed(Z,Y)};B.onTabClosing(Z,J)&&J()}}},handleWindowMouseMove:function(V){this.handleWindowTouchMove(V)},handleWindowTouchMove:function(Z){var t,A=this,Y=A.tv,q=Y._tabPosition,i=A._73o;if(q===Yd||q===gg){if(t=dj(Z).x-A.x,!A._25o&&!A.moving&&k(t)>2&&(Y._40o()&&!ao(Z)?A._25o=1:i&&Y.isMovable()&&(A.moving=1)),A._25o)Y.tx(A.tx+t);else if(A.moving){var w=A.lp.x+t,x=Y._tabGap/2;Y._7o.each(function(b){var J=b.endX,U=w-b.startX<J-w;w>=b.startX&&J>=w&&Y._7Q({tab:i.tab,startX:i.startX+t,width:i.width,front:U,insertTab:b.tab,position:U?E(0,b.startX-x):O(Y._64I,J+x)})})}}else if(t=dj(Z).y-A.y,!A._25o&&!A.moving&&k(t)>2&&(Y._41o()&&!ao(Z)?A._25o=1:i&&Y.isMovable()&&(A.moving=1)),A._25o)Y.ty(A.ty+t);else if(A.moving){var Q=A.lp.y+t,x=Y._tabGap/2;Y._7o.each(function(C){var M=C.endY,u=Q-C.startY<M-Q;Q>=C.startY&&M>=Q&&Y._7Q({tab:i.tab,startY:i.startY+t,height:i.height,front:u,insertTab:C.tab,position:u?E(0,C.startY-x):O(Y._23Q,M+x)})})}},handleWindowMouseUp:function(I){this.handleWindowTouchEnd(I)},handleWindowTouchEnd:function(){var K=this,R=K.tv,m=R._tabPosition,l=R.getTabModel(),h=l._roots,r=K._73o;if(K.moving){var p=R._23o;if(p&&p.insertTab!==p.tab){var V=p.tab,T=h.remove(V),s=h.indexOf(p.insertTab);s>=0&&(p.front||s++,s<=h.size()&&(h.add(V,s),l._38I(V,T,s)))}R._7Q($),delete K.moving}else if(!K._25o&&r){V=r.tab;var H=K._74o;if(!H||H.tab===V)if(!V.isDisabled()&&oe(r._75o,K.lp)){var F=function(){var S=h.indexOf(V);l.remove(V),R.onTabClosed(V,S)};R.onTabClosing(V,F)&&F()}else V.isDisabled()||R._8o===V||l.sm().ss(V)}K._25o=K._73o=K._74o=m===Yd||m===gg?K.x=K.lp=K.tx=$:K.y=K.lp=K.ty=$}}),Ht.PropertyView=function(y){var F=this;F._view=Ar(1,F),F._canvas=qc(F._view),$p(F._view,F._79O=Ic()),F._rows=new Od,F._28o=new Od,F._26o={},F._26Q={};var J=F._propertyModel=new Or,E=F.ivm;J.mm(E,F),J.md(E,F),J.mh(E,F),F.dm(y?y:new Or),new Ot(F)},It("PropertyView",b,{ms_ac:[Mk,ye,nl,ql,zf,"categorizable",Zo,hm,Vn,Dl,bm,lo,me,Mj,"selectRowIndex",cn,"background",_i,ed,og,np,mk],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:ze,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:sb,_background:u.propertyViewBackground,_expandIcon:u.propertyViewExpandIcon,_collapseIcon:u.propertyViewCollapseIcon,_scrollBarColor:Si,_scrollBarSize:Tr,_autoHideScrollBar:fp,_selectBackground:u.propertyViewSelectBackground,_rowHeight:Vo,_rowLineVisible:u.propertyViewRowLineVisible,_rowLineColor:u.propertyViewRowLineColor,_10I:.5,_columnLineVisible:u.propertyViewColumnLineVisible,_columnLineColor:u.propertyViewColumnLineColor,_labelColor:u.propertyViewLabelColor,_labelSelectColor:u.propertyViewLabelSelectColor,_labelFont:u.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(_){0>_&&(_=0),_>1&&(_=1);var G=this,l=G._10I;G._10I=_,G.fp("columnPosition",l,_)},getPropertyName:function(l){return l.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(b,U,F){return F===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(V,z){return z===this._selectRowIndex?this._labelSelectColor:V.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(i){var W=this.getHeight()-this._59I;return W>i&&(i=W),i>0?0:t(i)},isExpanded:function(N){if(!N)return!0;var l=this._26o[N];return l?l.isExpanded:!(this._26Q[N]===!1)},toggle:function(i){var N=this;N.isExpanded(i)?N.collapse(i):N.expand(i)},expandAll:function(){this.validate();for(var T in this._26o)this.expand(T)},expand:function(G){if(G&&G!==hh){var e=this,m=e._26o[G];m&&!m.isExpanded&&(m.isExpanded=!0,e.onExpanded(G),e.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var T in this._26o)this.collapse(T)},collapse:function(W){if(W&&W!==hh){var m=this,t=m._26o[W];t&&t.isExpanded&&(t.isExpanded=!1,m.onCollapsed(W),m.ivm())}},onCollapsed:function(){},getCategoryName:function(j){if(!this.isCategorizable())return hh;var k=j.getCategoryName();return k?k:hh},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(r){var q=this,n=q._dataModel;n!==r&&(n&&(n.umd(q.handlePropertyChange,q),q._selectionModel||n.sm().ums(q.handleSelectionChange,q)),q._dataModel=r,r.md(q.handlePropertyChange,q),q._selectionModel?q._selectionModel._21I(r):r.sm().ms(q.handleSelectionChange,q),q.fp(Xm,n,r))},isVisible:function(M){return this._visibleFunc?this._visibleFunc(M):!0},onPropertyChanged:function(s){var C=this,H=s.property;Ct[H]?C.ivm():C.iv(),H===dg&&C._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Cs},handlePropertyChange:function(F){this._27o===F.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var $=this;$._96I||($.setSelectRowIndex(-1),$._96I=1,$.iv())},redraw:function(){this.iv()},validateModel:function(){var W=this,h=W._rows,j=W._28o,d={},O=new Od,S=W._27o;W.updateCurrentData(),S!==W._27o&&W.endEditing(),h.clear(),j.clear(),W.getRawProperties().each(function(_){if(W.isVisible(_)){O.add(_);var F=W.getCategoryName(_);d[F]||(j.add(F,F===hh?0:r),d[F]={isExpanded:W.isExpanded(F),properties:new Od})}}),W._sortFunc&&O.sort(W._sortFunc);for(var L in W._26o)W._26Q[L]=W.isExpanded(L);W._26o=d,j.each(function(S){S!==hh&&h.add(S);var A=d[S];A.isExpanded&&O.each(function(a){W.getCategoryName(a)===S&&(A.properties.add(a),h.add({property:a,data:W._27o}))},W)})},validateImpl:function(){var y=this;y._76o(),y._96I&&(y.validateModel(),delete y._96I);var o=y._canvas,f=y.getWidth(),g=y.getHeight(),u=-y.ty(),H=y._rowHeight,e=y._indent,c=f-e,O=y._rows,w=O.size(),A=y._9I=e+c*y._10I,z=y._59I=w*H;Kc(o,f,g),y._29I={x:0,y:u,width:f,height:g},y._31I=M(u/H),y._14I=l((u+g)/H),y._31I<0&&(y._31I=0),y._14I>w&&(y._14I=w);var N,Y=te(o),k=y._background;Tj(Y,0,-u,1),Y.beginPath(),Y.rect(0,u,f,g),Y.clip(),Y.clearRect(0,u,f,g),y._93db(Y),k&&Dc(Y,0,0,e,z,k);for(var x=y._31I;x<y._14I;x++){var F=O.get(x),u=H*x;if(ph(F))k&&Dc(Y,e,u,c,H,k),N=Of(y.isExpanded(F)?y._expandIcon:y._collapseIcon),N&&Gp(Y,N,Hc,0,u,e,H),Y.save(),Y.beginPath(),Y.rect(e,u,c,H),Y.clip(),y.drawCategoryName(Y,F,x,e,u,c,H),Y.restore();else{var I=F.property,j=F.data,N=Of(I.getIcon()),B=y._selectRowIndex===x?y.getSelectBackground():$;if(N&&Gp(Y,N,Hc,0,u,e,H),B&&Dc(Y,e,u,c,H,B),Y.save(),Y.beginPath(),Y.rect(e,u,A-e,H),Y.clip(),y.drawPropertyName(Y,I,x,e,u,A-e,H),Y.restore(),!y.isEditing(j,I)){var W=A+1,T=f-A-1;Y.save(),Y.beginPath(),Y.rect(W,u,T,H),Y.clip(),y._87o(y.drawPropertyValue(Y,I,y.getValue(j,I),x,W,u,T,H,j),x,W,u,T,H),Y.restore()}}y._rowLineVisible&&Dc(Y,e,u+H-1,c,1,y._rowLineColor)}y._columnLineVisible&&(Dc(Y,A,0,1,z,y._columnLineColor),Dc(Y,f-1,0,1,z)),y._92db(Y),y._93I(),Y.restore(),y.ty(y.ty())},drawCategoryName:function(f,n,D,N,Y,e,d){$d(f,n,this.getCategoryFont(n),this.getCategoryColor(n),N,Y,e,d)},drawPropertyName:function(A,c,P,Z,F,n,d){return c.drawPropertyName?(c.drawPropertyName(A,c,P,Z,F,n,d,this),void 0):($d(A,this.getPropertyName(c),this.getPropertyFont(c,P),this.getPropertyColor(c,P),Z,F,n,d),void 0)},drawPropertyValue:function(z,j,c,Y,_,Q,y,R,t){return j.drawPropertyValue?j.drawPropertyValue(z,j,c,Y,_,Q,y,R,t,this):(Et(z,c,j,this.getLabelFont(j,c,Y),this.getLabelColor(j,c,Y),_,Q,y,R,t,this),void 0)},isPropertyEditable:function(a){return a.isEditable()&&this.isEditable()},setProperties:function(_){this._propertyModel.clear(),this.addProperties(_)},addProperties:function(i){if(i){var U=this._propertyModel;i.forEach(function(f){if(!(f instanceof Lt)){var l=Bq(f.className);f=Jl(l?l:Lt,f)}U.add(f)})}},getRowIndexAt:function(D){var m=this,Q=M(m.lp(D).y/m._rowHeight);return Q>=0&&Q<m._rows.size()?Q:-1},getPropertyAt:function(Y){var k=this,b=k.getRowIndexAt(Y);return b>=0?k._rows.get(b).property:$},getToolTip:function(y){var O=this,J=O.getPropertyAt(y),f=O._27o;return J&&f?J.getToolTip(f,O._9I<O.lp(y).x,O):$}});var Ot=function(T){this.pv=T,this.addListeners()};bd(Ot,b,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(Y){this.getView().style.cursor=Y},clear:function(){var q=this;q._62O=q.cp=q.ty=q.p=$,q.setCursor(de)},handle_mousedown:function(q){this.handle_touchstart(q)},handle_touchstart:function(D){var M=this,f=M.pv;Mm(D),f.setFocus(D)&&(ok(D)?(M.cp=dj(D),M.ty=f.ty(),M.p=f.getColumnPosition(),M.handle_touchmove(D)):f.setSelectRowIndex(f.getRowIndexAt(D)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(u){this.handle_touchend(u)},handle_touchend:function(o){var z=this;if(z.cp&&!z._62O){var j=z.pv,C=j.lp(o),V=C.x,f=C.y,N=j._indent,s=j.getRowIndexAt(o),t=j._9I;if(s>=0){var v=j._rowHeight,x=v*s,H=j._rows.get(s),U=H.property;if(ph(H))Of(j.isExpanded(H)?j._expandIcon:j._collapseIcon)&&V>=0&&N>=V&&f>=x&&x+v>=f?j.toggle(H):tb(o)&&j.toggle(H);else if(V>t&&j.isPropertyEditable(U,o)){var w={x:t+1,y:x,width:j.getWidth()-t-1,height:v},F={x:w.x+j.tx(),y:w.y+j.ty(),width:w.width,height:w.height},d=0,u=j._29I;w.y<u.y?d=w.y-u.y:w.y+v>u.y+u.height&&(d=w.y+v-u.y-u.height),d&&(j.ty(j.ty()-d),F.y-=d),j.beginEditing({data:H.data,property:U,value:j.getValue(H.data,U),event:o,rect:w,editorRect:F,view:j})}}j.setSelectRowIndex(s)}z.clear()},handleWindowMouseMove:function(q){this.handleWindowTouchMove(q)},handleWindowTouchMove:function(O){var k=this,y=k.pv,X=k.ty,T=k.cp,j=dj(O),n=k._62O;if("p"===n)y.setTranslateY(X+j.y-T.y);else if("c"===n){var E=y.getWidth()-y._indent;if(E>16){var I=k.p-(T.x-j.x)/E,Q=16/E;Q>I&&(I=Q),I>1-Q&&(I=1-Q),y.setColumnPosition(I)}}else"s"===n&&y.setTranslateY(X+(T.y-j.y)*y._59I/y._29I.height)},handle_mousemove:function(I){this.handle_touchmove(I)},handle_touchmove:function(n){if(!Iq&&ok(n)){var O=this,b=O.pv,Z=k(b.lp(n).x-b._9I)<=(Ze?8:3);O.cp?O._62O||(Z?(O._62O="c",ec(O,n)):k(dj(n).y-O.cp.y)>=2&&(O._62O=O.isV(n)?"s":"p",ec(O,n))):(Z?O.setCursor(Bm):O.setCursor(de),O.isV(n)&&b._43o())}},isV:function(y){var O=this.pv,T=O._29I;return O._41o()&&T.x+T.width-O.lp(y).x<rq},handle_mousewheel:function(u){this.handleScroll(u,u.wheelDelta/40)},handle_DOMMouseScroll:function(s){2===s.axis&&this.handleScroll(s,-s.detail)},handleScroll:function(X,R){var g=this.pv;Mm(X),g.endEditing(),g.translate(0,R*g.getRowHeight())},handle_keydown:function($){var D=this.pv,r=D._rows.size(),f=D._selectRowIndex+(Wc($)?-1:1);(Wc($)||Td($))&&(0>f&&(f=0),f>=r&&(f=r-1),D.setSelectRowIndex(f))}}),Ht.ListView=function(e){this._5o(e),new Pt(this)},It("ListView",b,{ms_ac:[Mk,ye,nl,_i,Zo,ed,og,hm,Vn,lo,me,Mj,mh,cn],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:sb,_rowHeight:Vo,_rowLineVisible:u.listViewRowLineVisible,_rowLineColor:u.listViewRowLineColor,_scrollBarColor:Si,_scrollBarSize:Tr,_autoMakeVisible:Rc,_autoHideScrollBar:fp,_selectBackground:u.listViewSelectBackground,_labelColor:u.listViewLabelColor,_labelSelectColor:u.listViewLabelSelectColor,_labelFont:u.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(N){var r=this,y=r._checkMode;r._checkMode=N,r.fp(ap,y,N)},drawRow:function(G,V,J,A,l,Q,k){var _=this,Y=0,v=_._indent,R=_.getIconWidth(V);_.drawRowBackground(G,V,J,A,l,Q,k),_._checkMode&&(Mq(G,Of(_.getCheckIcon(V)),Y+v/2,l+k/2,V,_),Y+=v),_.drawIcon(G,V,Y,l,R,k),_.drawLabel(G,V,Y+R,l,k)}});var Pt=function(W){this.list=W,this.addListeners()};bd(Pt,b,{ms_listener:1,getView:function(){return this.list._view},clear:function(K){var q=this,n=q.list;K&&"d"===q._62O&&!q.dragCancel&&n.handleDragAndDrop(K,"end"),n.draggingData&&(n.draggingData=null,n.redraw()),q.dragCancel=q._62O=q._isV=q._isH=q.cp=q.tx=q.ty=$},handle_mousedown:function(_){this.handle_touchstart(_)},handle_touchstart:function(D){var q=this,i=q.list;if(Mm(D),i.setFocus(D)){var V=i.getDataAt(D);q.cp=dj(D),q.tx=i.tx(),q.ty=i.ty(),ok(D)?V&&i.handleDragAndDrop&&!q.isV(D)&&!q.isH(D)&&(i.draggingData=V,i.redraw(),i.handleDragAndDrop(D,"prepare")):(V?q._33o(D,V):this._cancelDataDoubleSelect(),q.clear(D))}},handleWindowMouseUp:function(y){this.clear(y)},handleWindowTouchEnd:function(u){this.clear(u)},handle_mouseup:function(N){this.handle_touchend(N)},handle_touchend:function(Z){var $=this,x=$.list;if(!$._isV&&!$._isH&&$.cp&&!$._62O){var I=x.getDataAt(Z);I?(x.isCheckMode()?$._34o(Z,I):$._33o(Z,I),tb(Z)?x.onDataDoubleClicked(I,Z):x.onDataClicked(I,Z)):($._cancelDataDoubleSelect(),x.handleBackgroundClick(Z))}$.clear(Z)},handleWindowMouseMove:function(O){this.handleWindowTouchMove(O)},handleWindowTouchMove:function(F){var P=this,X=P.list,I=P._62O,b=P.tx,n=P.ty,e=P.cp,i=dj(F),y=X._29I;"p"===I?X.setTranslate(b+i.x-e.x,n+i.y-e.y):"v"===I?X.ty(n+(e.y-i.y)*X._59I/y.height):"h"===I?X.tx(b+(e.x-i.x)*X._91I/y.width):"d"===I&&(P.dragCancel||X.handleDragAndDrop(F,"between"))},handle_mousemove:function(q){this.handle_touchmove(q)},handle_touchmove:function(K){if(!Iq&&ok(K)){var N=this,e=N.list;if(N._isV=N.isV(K),N._isH=N.isH(K),N.cp){if(!N._62O){if(Kj(dj(K),N.cp)<2)return;N._isV?N._62O="v":N._isH?N._62O="h":e.draggingData&&!this.dragCancel?(N._62O="d",e.handleDragAndDrop(K,"begin")):N._62O="p",N._62O&&"d"!==N._62O&&e.draggingData&&(e.draggingData=null,e.redraw()),ec(N,K)}}else N._isV&&e._43o(),N._isH&&e._42o()}},isV:function(v){var C=this.list,h=C._29I;return C._41o()&&h.x+h.width-C.lp(v).x<rq},isH:function(l){var Y=this.list,g=Y._29I;return Y._40o()&&g.y+g.height-Y.lp(l).y<rq},handle_mousewheel:function(Y){this.handleScroll(Y,Y.wheelDelta/40,Y.wheelDelta!==Y.wheelDeltaX)},handle_DOMMouseScroll:function(o){this.handleScroll(o,-o.detail,1)},handleScroll:function(d,X,Z){var r=this.list;Mm(d),r.endEditing&&r.endEditing(),Z&&r._41o()?r.translate(0,X*r.getRowHeight()):r._40o()&&r.translate(10*X,0)},handle_keydown:function(D){if(!u.isInput(D.target)){var X,S=this.list,K=S.sm(),g=S._rows,y=g.size();if(Qf(D))S.selectAll();else if(oc(D))S.handleDelete&&S.handleDelete(D);else if($c(D))"d"!==this._62O||this.dragCancel||(S.handleDragAndDrop(D,"cancel"),this.dragCancel=!0);else if(An(D))S.isCheckMode()&&(X=S.getFocusData(),X&&S.checkData(X));else if(Wc(D)||Td(D)){var C=S.isCheckMode();if(X=C?S.getFocusData():K.ld()){var V=S.getRowIndex(X);V>=0&&(Wc(D)?0!==V&&(X=g.get(V-1),C?S.setFocusData(X):K.ss(X)):V!==y-1&&(X=g.get(V+1),C?S.setFocusData(X):K.ss(X)))}else y>0&&(X=g.get(0),C?S.setFocusData(X):K.ss(X))}}},_34o:function(k,A){var J=this.list,V=J.lp(k).x;return V>=0&&V<=J._indent?(J.checkData(A),void 0):(J.setFocusData(A),void 0)},_33o:function(o,R){var v=this.list,S=v.sm(),s=S.ld();if(!v.canHandleSelectMode(o,R))return this._cancelDataDoubleSelect(),void 0;if(ao(o))v.isSelected(R)?S.rs(R):S.as(R);else if(Ng(o))if(s)for(var q=v.getRowIndex(s),g=v.getRowIndex(R);q!==g;)q+=g>q?1:-1,S.as(v._rows.get(q));else S.ss(R);else ok(o)?(S.contains(R)?v.handleDataDoubleSelect&&(this._handleDataDoubleSelect(o,R),tb(o)&&this._cancelDataDoubleSelect()):this._cancelDataDoubleSelect(),S.ss(R)):S.contains(R)||S.ss(R)},_handleDataDoubleSelect:function(G,E){this._cancelDataDoubleSelect(),this._doubleSelectTimer=Kb(function(){this.list.handleDataDoubleSelect(G,E),this._doubleSelectTimer=r}.bind(this),u.doubleClickSpeed)},_cancelDataDoubleSelect:function(){this._doubleSelectTimer&&(Xi(this._doubleSelectTimer),this._doubleSelectTimer=r)}}),Ht.TreeView=function(c){var b=this;b._35o(),b._5o(c),new Qt(b)},It("TreeView",b,{ms_ac:[Mk,ye,nl,"rootVisible",ap,"rootData",hm,Vn,lo,me,Mj,Zo,_i,ed,og,Dl,bm,mh,cn,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:$,_indent:sb,_rowHeight:Vo,_rowLineVisible:u.treeViewRowLineVisible,_rowLineColor:u.treeViewRowLineColor,_scrollBarColor:Si,_scrollBarSize:Tr,_autoHideScrollBar:fp,_expandIcon:u.treeViewExpandIcon,_collapseIcon:u.treeViewCollapseIcon,_autoMakeVisible:Rc,_selectBackground:u.treeViewSelectBackground,_labelColor:u.treeViewLabelColor,_labelSelectColor:u.treeViewLabelSelectColor,_labelFont:u.treeViewLabelFont,_doubleClickToToggle:u.treeViewDoubleClickToToggle,drawRow:function(V,S,c,t,D,q,k){var N=this;N.drawRowBackground(V,S,c,t,D,q,k),N.drawTree(V,S,c,0,D,q,k)},isOnToggleIcon:function(c){var J=this.getDataAt(c);if(J){var u=this.getIndent(),S=this.lp(c).x;if(Of(this.getToggleIcon(J))){var G=u*this.getLevel(J);if(S>=G&&G+u>=S)return!0}}return!1}});var Qt=function($){ud(Qt,this,[$])};bd(Qt,Pt,{toggle:function(e,G,Y,I){var b=this.list,D=b.lp(e).x;if(Of(b.getToggleIcon(G))){var y=Y*I;if(D>=y&&y+Y>=D)return b.toggle(G),!0}return b.isDoubleClickToToggle()&&tb(e)?(b.toggle(G),!0):!1},_34o:function(j,z){var L=this.list,U=L.lp(j).x,h=L._levelMap[z._id],M=L._indent,X=M*(h+1);return U>=X&&X+M>=U?(L.checkData(z),void 0):(this.toggle(j,z,M,h)||L.setFocusData(z),void 0)},_33o:function(K,v){var m=this,o=m.list;if(!m.toggle(K,v,o._indent,o.getLevel(v)))if(Ng(K)){var x=o.sm();if(x.size()>0){for(var O=o._rows,C=null,B=0,g=O.size();g>B;B++)if(o.isSelected(O.get(B))){C=B;break}for(var k=null,B=O.size()-1;B>=0;B--)if(o.isSelected(O.get(B))){k=B;break}var l,Q,j=o.getRowIndex(v);for(C>j?(l=j-1,Q=C):j>k?(l=k,Q=j):(l=C,Q=k);l!==Q;)l++,x.as(o._rows.get(l))}else x.ss(v)}else Qt.superClass._33o.call(m,K,v)},handle_keydown:function(Q){if($b(Q)||mr(Q)){var q=this.list,e=q._rows,b=q.isCheckMode(),F=q.sm(),D=b?q.getFocusData():F.ld();D?D.hasChildren()&&($b(Q)?q.collapse(D):q.expand(D)):e.size()>0&&(D=e.get(0),b?q.setFocusData(D):F.ss(D))}else Qt.superClass.handle_keydown.call(this,Q)}});var Rt=Ht.TableView=function(R){this._98I(),this._5o(R),new St(this)};It("TableView",b,{ms_ac:[Mk,ye,nl,"sortMode",ql,zf,_i,ed,og,np,mk,"sortColumn",hm,Vn,lo,me,Mj,mh,cn],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:De,_editable:!0,_batchEditable:!1,_rowHeight:Vo,_rowLineVisible:u.tableViewRowLineVisible,_rowLineColor:u.tableViewRowLineColor,_columnLineVisible:u.tableViewColumnLineVisible,_columnLineColor:u.tableViewColumnLineColor,_scrollBarColor:Si,_scrollBarSize:Tr,_autoHideScrollBar:fp,_autoMakeVisible:Rc,_selectBackground:u.tableViewSelectBackground,_labelColor:u.tableViewLabelColor,_labelSelectColor:u.tableViewLabelSelectColor,_labelFont:u.tableViewLabelFont,getCheckColumn:function(){var n=this;if(!n._31o){var d=n._31o=new Kt;d.setEditable(!0),d.setWidth(40),d.getValue=n.getCheckColumValue,d.drawCell=n.drawCheckColumnCell}return n._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(X){var s=this,n=s._39o,A=s.getCheckColumn();X!==s.isCheckMode()&&(X?n.add(A,0):n.remove(A),s.fp(ap,!X,X))},getCheckColumValue:function(N,k,X){return X.isSelected(N)},drawCheckColumnCell:function(p,$,V,F,R,o,v,l,P){Mq(p,P.getCheckIcon($),R+v/2,o+l/2,$,P)}});var St=function(z){ud(St,this,[z])};bd(St,Pt,{_34o:function(z,b){var K=this.list,n=K._31o;if(K.isCellEditable(b,n,z)){var A=K._3Q(n),h=K.lp(z).x;if(A&&h>=A.startX&&h<A.startX+n.getWidth())return K.checkData(b),void 0}K._37O(b,z),K.setFocusData(b)},_33o:function(X,F){this.list._37O(F,X),St.superClass._33o.apply(this,arguments)}});var Tt=Ht.TreeTableView=function(Z){var K=this,G=K._4o=new Kt;K._35o(),K._98I(),K._5o(Z),G.setDisplayName("Name"),G.setEditable(!0),G.setWidth(180),G.drawCell=Ut,G.getValue=Vt,K._39o.add(G),new Wt(K)},Ut=function(m,g,q,O,y,J,U,L,D){D.drawTree(m,g,q,y,J,U,L)},Vt=function(U,z,Y){return Y.getLabel(U)};It("TreeTableView",b,{ms_ac:[Mk,ye,nl,"sortMode",ql,zf,Zo,ap,"rootData","rootVisible",hm,Vn,"sortColumn",Dl,bm,lo,me,Mj,mh,og,_i,ed,np,mk,cn,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:De,_checkMode:$,_editable:!0,_batchEditable:!1,_indent:sb,_rowHeight:Vo,_rowLineVisible:u.treeTableViewRowLineVisible,_rowLineColor:u.treeTableViewRowLineColor,_columnLineVisible:u.treeTableViewColumnLineVisible,_columnLineColor:u.treeTableViewColumnLineColor,_expandIcon:u.treeTableViewExpandIcon,_collapseIcon:u.treeTableViewCollapseIcon,_scrollBarColor:Si,_scrollBarSize:Tr,_autoHideScrollBar:fp,_autoMakeVisible:Rc,_selectBackground:u.treeTableViewSelectBackground,_labelColor:u.treeTableViewLabelColor,_labelSelectColor:u.treeTableViewLabelSelectColor,_labelFont:u.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Wt=function(I){ud(Wt,this,[I])};bd(Wt,Pt,{_34o:function(U,G){var N=this.list,L=N._4o,$=N._3Q(L),l=N.lp(U).x;if($){var M=N._indent,v=$.startX+M*N.getLevel(G);if(Of(N.getToggleIcon(G))&&l>=v&&v+M>=l)return N.toggle(G),void 0;if(N.isCellEditable(G,L)&&(v+=M,l>=v&&v+M>=l))return N.checkData(G),void 0}N._37O(G,U),N.setFocusData(G)},_33o:function(c,X){var x=this.list,O=x.lp(c).x;if(Of(x.getToggleIcon(X))){var Z=x._3Q(x._4o);if(Z){var Q=x._indent,$=Z.startX+Q*x.getLevel(X);if(O>=$&&$+Q>=O)return x.toggle(X),void 0}}x._37O(X,c),Wt.superClass._33o.apply(this,arguments)}});var Xt=Ht.TableHeader=function(y){var b=this,l=b._view=Ar(1,b),n=b._39o=y.getColumnModel(),S=b.iv;b.tv=b._tableView=y,b._60I=new Od,b._canvas=qc(l),l.style.background=u.tableHeaderBackground||"",l.style.height=Cq+en,n.mm(S,b),n.md(S,b),n.mh(S,b),y.mp(function(s){yt[s.property]&&b.iv()},b),new Yt(b),b.iv()};It("TableHeader",b,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Mk,nl,Zo,"moveBackground","insertColor",np,mk,"resizable","movable"],_checkIcon:vj,_movable:!0,_resizable:!0,_labelColor:u.tableHeaderLabelColor,_labelFont:u.tableHeaderLabelFont,_columnLineColor:u.tableHeaderColumnLineColor,_columnLineVisible:u.tableHeaderColumnLineVisible,_sortDescIcon:u.tableHeaderSortDescIcon,_sortAscIcon:u.tableHeaderSortAscIcon,_moveBackground:u.tableHeaderMoveBackground,_insertColor:u.tableHeaderInsertColor,_indent:sb,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(H){return H.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(C){return C.getColor()||this._labelColor},getLabelAlign:function(l){return l._align},onPropertyChanged:function(){this.iv()},_5Q:function(e){this._61I=e,this.iv()},getLogicalPoint:function(O){return Xr(O,this._canvas,this.tv.tx())},validateImpl:function(){var L=this,D=L._canvas,H=L.getWidth(),B=L.getHeight(),A=L.tv,C=L._60I,E=L._61I,k=-A.tx(),n=0;(H!==D.clientWidth||B!==D.clientHeight)&&Kc(D,H,B),C.clear(),L._39o._roots.each(function(N){if(N.isVisible()){var O=n+N.getWidth();k+H>=n&&O>=k&&C.add({column:N,startX:n}),n=O}});var O=te(D);if(Tj(O,-k,0,1),O.beginPath(),O.rect(k,0,H,B),O.clip(),O.clearRect(k,0,H,B),C.each(function(u){var R=u.column,g=u.startX,V=R.getWidth();V>0&&(O.save(),O.beginPath(),O.rect(g,0,V,B),O.clip(),E&&E.column===R||L.drawColumn(O,R,g,0,V,B),L._columnLineVisible&&Dc(O,g+V-1,0,1,B,L._columnLineColor),O.restore())}),E){var $=E.column,n=E.startX,z=E.position,R=$.getWidth();O.save(),O.beginPath(),O.rect(n,0,R,B),O.clip(),O.fillStyle=L._moveBackground,O.fill(),L.drawColumn(O,$,n,0,R,B),O.restore(),be(O,L._insertColor,z,0,B)}O.restore()},_6Q:function(I){var W=this.tv;return W._31o===I&&W.sm().getSelectionMode()===Qj},drawColumn:function(O,V,j,W,E,B){var x=this,b=x.tv,J=Of(V.getIcon()),z=x.getLabelAlign(V);if(x._6Q(V)){var i=Of(x._checkIcon);Mq(O,i,j+E/2,W+B/2,V,x)}else{var Q=x.getLabel(V),R=x.getLabelFont(V),c=x.getLabelColor(V),Y=bq(R,Q).width,I=J?x._indent:0;z===sl?(J&&Gp(O,J,Hc,j,W,I,B),$d(O,Q,R,c,j+I,W,E,B,sl)):z===vp?(J&&Gp(O,J,Hc,j+E-Y-I,W,I,B),$d(O,Q,R,c,j,W,E,B,vp)):(J&&Gp(O,J,Hc,j+(E-Y-I)/2,W,I,B),$d(O,Q,R,c,j+(E-Y+I)/2,W,0,B,sl))}if(V.isSortable()&&b.getSortColumn()===V&&(J=Of(V.getSortOrder()===Mi?x._sortAscIcon:x._sortDescIcon))){var g=Hn(J,V)/2+2;Mq(O,J,z===vp?j+g:j+E-g,W+B/2,V,b)}}});var Yt=function(l){var B=this;B.th=l,B.tv=l._tableView,B.addListeners()};bd(Yt,b,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(h){this.getView().style.cursor=h},handle_mousemove:function(s){if(!Iq){var n=this;delete n._29o,n.setCursor(de);for(var t=n.th,K=t._60I,w=t.lp(s).x,X=K.size()-1;X>=0;X--){var E=K.get(X),q=E.column,m=E.startX+q.getWidth();if(t.isResizable()&&k(m-w)<=(Ze?10:3))return n._29o=E,n.setCursor(Bm),void 0;w>E.startX&&m>w&&(n._29o=E),(q.isClickable()||q.isSortable()||t.isMovable()||n.tv.getCheckColumn&&q===n.tv.getCheckColumn())&&w>E.startX&&m>w&&n.setCursor(cd)}}},handle_mousedown:function(l){this.handle_touchstart(l)},handle_touchstart:function(Q){var r=this;Mm(Q),r.tv.endEditing(),r.handle_mousemove(Q),r._29o&&(r.x=dj(Q).x,r.lx=r.th.lp(Q).x,r.w=r._29o.column.getWidth(),ec(r,Q))},handleWindowMouseMove:function(U){this.handleWindowTouchMove(U)},handleWindowTouchMove:function(_){var p=this,V=p.th,b=p.getView().style.cursor,f=p._29o,r=dj(_).x-p.x;if(p.resizing||p.moving||(b===Bm?p.resizing=1:V.isMovable()&&b===cd&&k(r)>2&&(p.moving=1)),p.resizing)f.column.setWidth(p.w+r);else if(p.moving){var i=p.lx+r;V._60I.each(function(M){var s=M.startX,S=s+M.column.getWidth();if(i>=s&&S>=i){var l={column:f.column,startX:f.startX+r,front:S-i>i-s,insertColumn:M.column};l.position=l.front?s:S,V._5Q(l)}})}},_16Q:function(L,w){var n=this,r=n.tv,k=n.th,_=k._checkIcon;if(k._6Q(L)){var q=Of(_),O=n.lx,l=L.getWidth(),Y=Hn(q,L);if(O>=w+l/2-Y&&w+l/2+Y>=O){k.setCheckIcon(_===Wl?vj:Wl);var E=r.sm(),V=r._rows;return _===Wl?E.rs(V):E.ss(V),r.onCheckColumnClicked(L),!0}}return!1},handleWindowMouseUp:function(z){this.handleWindowTouchEnd(z)},handleWindowTouchEnd:function(H){var w=this,J=w.tv,p=w.th,v=w._29o;
if(w.moving){var c=p._61I;if(c&&c.insertColumn!==c.column){var F=c.column,l=J.getColumnModel()._roots,B=l.remove(F),q=l.indexOf(c.insertColumn);q>=0&&(c.front||q++,q<=l.size()&&(l.add(F,q),J.getColumnModel()._38I(F,B,q)))}p._5Q($),delete w.moving}else if(!w.resizing&&v){F=v.column;var e=p.lp(H).x,f=v.startX,U=!0;if(p.onColumnClicked){var u=p.onColumnClicked(F,H,f);u===!1&&(U=!1)}if(U&&e>=f&&e<=f+F.getWidth()&&!w._16Q(F,f)){if(F.isSortable()){var r=J.getSortMode(),x=F.getSortOrder();r===De?J.getSortColumn()===F?(x===pd&&J.setSortColumn($),F.setSortOrder(x===Mi?pd:Mi)):J.setSortColumn(F):"bistate"===r&&(J.getSortColumn()===F?F.setSortOrder(x===Mi?pd:Mi):J.setSortColumn(F))}J.onColumnClicked(F,H,f)}}w._29o=w.resizing=w.x=w.lx=w.w=$}}),Ht.TablePane=function(n){this.init(new Rt(n))},It("TablePane",b,{ms_v:1,_44o:1}),Ht.TreeTablePane=function(h){this.init(new Tt(h))},It("TreeTablePane",b,{ms_v:1,_44o:1}),Ht.Toolbar=function(b){var G=this,z=G._view=Ar(1,G),K=z.style;K.background=u.toolbarBackground||"",K.height=fh+en,G._canvas=qc(z),G._30o=new Od,G._90I=new Od,G.setItems(b||[]),z.handleGroupSelectedChanged=function(k){if(k.isSelected()){var K=k.getGroupId();null!=K&&G._items.forEach(function(d){var m=d.element;m&&m!==k&&m.setSelected&&m.getGroupId&&m.getGroupId()===K&&m.setSelected(!1)})}},new Zt(G)},It("Toolbar",b,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Jc,Mk,nl,ye,cn,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:u.toolbarLabelColor,_labelSelectColor:u.toolbarLabelSelectColor,_labelFont:u.toolbarLabelFont,_selectBackground:u.toolbarSelectBackground,_itemGap:u.toolbarItemGap,_separatorColor:u.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(G){var Z=this.getItemInfoAt(G);return Z?Z.item.toolTip:$},getLabelColor:function(c){return c&&c.selected&&c.type!==Wl&&c.type!==jb?this._labelSelectColor:this._labelColor},onPropertyChanged:function(c){this.iv(),c.property===Jc&&this._items.forEach(function(y){uc(y)})},redraw:function(){this.iv()},addItem:function(K,V){var M=this._items;V==$?M.push(K):M.splice(V,0,K),this.fp(Jc,$,M)},removeItem:function(e){if(e)for(var B=this._items,s=0;s<B.length;s++)e===B[s]&&(B.splice(s,1),this.fp(Jc,$,B))},removeItemById:function(D){if(D!=$)for(var T=this._items,_=0;_<T.length;_++)if(D===T[_].id){var x=T.splice(_,1)[0];return this.fp(Jc,$,T),x}},getItemById:function(E){if(E!=$)for(var V=this._items,f=0;f<V.length;f++){var s=V[f];if(E===s.id)return s}},setItemVisible:function(E,A){var U=this.getItemById(E);U&&(U.visible=A)},getItemInfos:function(){return this._30o},getItemInfoAt:function(L){var I=this,q=0,R=I._30o,F=I.lp(L),g=F.x,c=F.y;if(c>=0&&c<=I.getHeight())for(;q<R.size();q++){var W=R.get(q);if(W.startX<=g&&g<=W.endX)return W}return $},drawItem:function(N,P,V,Q,q){if(P.visible===!1)return 0;if(Xp(P.visible)&&!P.visible())return 0;var r=this,a=P.disabled;a&&(N.globalAlpha=uh);var c=r.drawItemImpl(N,P,V,Q,q),x=r._itemGap;return a&&(N.globalAlpha=1),this._currentItem!==P||"separator"===P||P.separator===!0||P.unfocusable||cc(N,r._separatorColor,V-x/2,0,c+x,Q),c},drawItemImpl:function(O,K,e,H,p){var V=this,C=V._view,A=V._itemGap,j=H/2,r=K.type,x=K.element,b=K.label;ph(x)&&(b=x,x=$);var Z,J=V.getLabelFont(K),n=V.getLabelColor(K),E=K.selected,g=Of(K.icon),Q=Hn(g,K),m=0,t=Q+(b?bq(J,b).width:0);if("separator"===K||K.separator===!0)return be(O,V._separatorColor,e,H/4,j),1;if(x){g&&Mq(O,g,e+Q/2,j,K,V),$d(O,b,J,n,e+Q,0,0,H);var w=Al(x);p||V._90I.add(w),w.parentNode!==C&&$p(C,w),x.iv&&x.iv(),x.validate&&x.validate();var G=w.getBoundingClientRect(),l=G.width,d=w.style;return Bp(w),d.left=V.tx()+e+t+en,d.top=(H-G.height)/2+en,t+l}return r===jb?Z=Of(E?yl:rk):r===Wl&&(Z=Of(E?Wl:vj)),Z?(m=Hn(Z,K),Mq(O,Z,e+m/2,j,K,V),e+=m,t+=m):E&&Dc(O,e-A/2,0,t+A,H,V.getSelectBackground(K)),g&&Mq(O,g,e+Q/2,j,K,V),$d(O,b,J,n,e+Q,0,0,H),t},validateImpl:function(){var f=this,C=f._canvas,F=f.getWidth(),V=f.getHeight(),j=f._30o,P=f._items;Kc(C,F,V);var z=te(C),Q=f._itemGap,$=Q/2;Tj(z,f.tx(),0,1),z.clearRect(0,0,F,V);var D=f._90I;f._90I=new Od,j.clear(),P.forEach(function(K){var b=f.drawItem(z,K,$,V);j.add({item:K,startX:$,endX:$+b,width:b}),b&&($+=b+Q)}),D.each(function(W){f._90I.contains(W)||lk(W)});var S=f._64I;f._64I=E(0,$-Q/2),z.restore(),f._stickToRight?(f._65O=0,z=te(C),$=F-f._64I+Q/2,Tj(z,0,0,1),z.clearRect(0,0,F,V),j.clear(),P.forEach(function(Y){var i=f.drawItem(z,Y,$,V,!0);j.add({item:Y,startX:$,endX:$+i,width:i}),i&&($+=i+Q)}),z.restore()):f.tx(f.tx()),S!==f._64I&&f.onSumWidthChanged(S,f._64I)},onSumWidthChanged:function(){},handleClick:function(X,o){var U=this,A=X.type,v=X.action,e=X.groupId,C=X.selected;X.disabled||(e!=$?C||(X.selected=!0,this._items.forEach(function(v){v.groupId===e&&X!==v&&(v.selected=!1)}),v&&X.action(X,U,o)):A===Wl||"toggle"===A?(X.selected=!C,v&&X.action(X,U,o)):v&&X.action(X,U,o)),Wo(),U.iv()}});var Zt=function(q){this.tb=q,this.addListeners()};bd(Zt,b,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(T){this.handleScroll(T,10*(T.wheelDelta/40))},handle_DOMMouseScroll:function(k){this.handleScroll(k,10*-k.detail)},handleScroll:function(A,j){Mm(A);var g=this.tb;g.isScrollable()&&!g._stickToRight&&(g.tx(g.tx()+j),pg())},handle_mousemove:function(Q){var U=this;Iq||U.setItem(Q)},handle_mouseout:function(V){var g=this;V.target===g.getView()?g.tb.setCurrentItem($):g.handle_mousemove(V)},handle_mousedown:function(E){this.handle_mousemove(E),this.handle_touchstart(E)},handle_touchstart:function(V){var E=this,C=E.tb,_=V.target;ok(V)&&(_===E.getView()||_===C._canvas)&&(Mm(V),C.setFocus(V)&&(this.setItem(V,!0),(C.isScrollable()||E.info&&!E.info.item.disabled)&&(E.x=dj(V).x,E.tx=C.tx(),ec(E,V))))},handleWindowMouseMove:function(C){this.handleWindowTouchMove(C)},handleWindowTouchMove:function(q){var j=this,T=j.tb;if(!T._stickToRight){var U=dj(q).x-j.x;!j._25o&&k(U)>2&&T.isScrollable()&&(j._25o=1),j._25o&&T.tx(j.tx+U)}},handleWindowMouseUp:function(H){this.handleWindowTouchEnd(H)},handleWindowTouchEnd:function(v){var c=this,q=c.tb,o=c.info,r=c.tb.getItemInfoAt(v);if(!c._25o&&o){var k=o.item;r&&r.item===k&&q.handleClick(k,v)}c._25o=c.x=c.tx=$,c.setItem()},setItem:function(F,s){var V=this,u=V.tb,x=V.info=F?u.getItemInfoAt(F):$,S=x?x.item:$;u.setCurrentItem(S),s&&S&&Xp(S.onDown)&&S.onDown(F)}}),Ht.BorderPane=function(){this._view=Ar(1,this),this.iv()},It("BorderPane",b,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(S,l){this._12o("leftView",S),l!=$&&this.setLeftWidth(l)},getRightView:function(){return this._rightView},setRightView:function(w,x){this._12o("rightView",w),x!=$&&this.setRightWidth(x)},getTopView:function(){return this._topView},setTopView:function(T,u){this._12o("topView",T),u!=$&&this.setTopHeight(u)},getBottomView:function(){return this._bottomView},setBottomView:function(G,s){this._12o("bottomView",G),s!=$&&this.setBottomHeight(s)},getCenterView:function(){return this._centerView},setCenterView:function(Y){this._12o("centerView",Y)},_12o:function(a,x){var K=this,o="_"+a,n=K._view,R=K[o];R!==x&&(R&&(R.getView?lk(R.getView()):lk(R)),K[o]=x,x&&(x.getView?$p(n,x.getView(),1):$p(n,x,1)),K.fp(a,R,x))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var r=this,T=r._topView,P=r._bottomView,n=r._leftView,o=r._rightView,v=r._centerView,S=r.getWidth(),s=r.getHeight(),M=0,b=0,k=S,G=s,d=0,t=0,W=0,F=0;T&&(d=r._topHeight==$?Lb(T):r._topHeight,b=d),P&&(t=r._bottomHeight==$?Lb(P):r._bottomHeight,G=s-t),n&&(W=r._leftWidth==$?rh(n):r._leftWidth,M=W),o&&(F=r._rightWidth==$?rh(o):r._rightWidth,k=S-F);var R=E(0,k-M),c=E(0,G-b);T&&Zg(T,0,0,S,d),P&&Zg(P,0,G,S,t),n&&Zg(n,0,b,W,c),o&&Zg(o,k,b,F,c),v&&Zg(v,M,b,R,c)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);