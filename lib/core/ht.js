!function(M,w,H){"use strict";function C(){this.el=[1,0,0,0,1,0,0,0,1]}function K(o){var $={};return{get:function(x){if($[x]!==H)return $[x];var I;switch(x){case"WEBGL_depth_texture":I=o.getExtension("WEBGL_depth_texture")||o.getExtension("MOZ_WEBGL_depth_texture")||o.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":I=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":I=o.getExtension("WEBGL_compressed_texture_s3tc")||o.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||o.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":I=o.getExtension("WEBGL_compressed_texture_pvrtc")||o.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":I=o.getExtension("WEBGL_compressed_texture_etc1");break;default:I=o.getExtension(x)}return $[x]=I,I}}}function T(R,$,M){function g(){if(K!==H)return K;var S=$.get("EXT_texture_filter_anisotropic");return K=null!==S?R.getParameter(S.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function k(X){if("highp"===X){if(R.getShaderPrecisionFormat(R.VERTEX_SHADER,R.HIGH_FLOAT).precision>0&&R.getShaderPrecisionFormat(R.FRAGMENT_SHADER,R.HIGH_FLOAT).precision>0)return"highp";X="mediump"}return"mediump"===X&&R.getShaderPrecisionFormat(R.VERTEX_SHADER,R.MEDIUM_FLOAT).precision>0&&R.getShaderPrecisionFormat(R.FRAGMENT_SHADER,R.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var K;M=M||{};var a="undefined"!=typeof WebGL2RenderingContext&&R instanceof WebGL2RenderingContext,l=M.precision!==H?M.precision:"highp",w=k(l);w!==l&&(console.warn("WebGL:",l,"not supported, using",w,"instead."),l=w);var B=M.logarithmicDepthBuffer===!0,s=R.getParameter(R.MAX_TEXTURE_IMAGE_UNITS),S=R.getParameter(R.MAX_VERTEX_TEXTURE_IMAGE_UNITS),y=R.getParameter(R.MAX_TEXTURE_SIZE),Y=R.getParameter(R.MAX_CUBE_MAP_TEXTURE_SIZE),r=R.getParameter(R.MAX_VERTEX_ATTRIBS),u=R.getParameter(R.MAX_VERTEX_UNIFORM_VECTORS),W=R.getParameter(R.MAX_VARYING_VECTORS),L=R.getParameter(R.MAX_FRAGMENT_UNIFORM_VECTORS),q=S>0,D=a||!!$.get("OES_texture_float"),A=q&&D,i=a?R.getParameter(R.MAX_SAMPLES):0;return{getMaxAnisotropy:g,getMaxPrecision:k,precision:l,logarithmicDepthBuffer:B,maxTextures:s,maxVertexTextures:S,maxTextureSize:y,maxCubemapSize:Y,maxAttributes:r,maxVertexUniforms:u,maxVaryings:W,maxFragmentUniforms:L,vertexTextures:q,floatFragmentTextures:D,floatVertexTextures:A,maxSamples:i}}var m="ht";if(!M[m]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),M.performance&&M.performance.now||function(){var X=Date.now();M.performance||(M.performance={}),M.performance.now=function(){return Date.now()-X}}();for(var x=Date.now(),p=16,B=["ms","moz","webkit","o"],Q=0;Q<B.length&&!M.requestAnimationFrame;++Q)M.requestAnimationFrame=M[B[Q]+"RequestAnimationFrame"],M.cancelAnimationFrame=M[B[Q]+"CancelAnimationFrame"]||M[B[Q]+"CancelRequestAnimationFrame"];M.requestAnimationFrame||(M.requestAnimationFrame=function($){var e=Date.now(),v=p+x-e;return 0>v&&(v=0),x=e,M.setTimeout(function(){x=Date.now(),$(performance.now())},v)}),M.cancelAnimationFrame||(M.cancelAnimationFrame=function(G){return M.clearTimeout(G)}),w.assign===H&&(w.assign=function(m){if(m===H||null===m)throw new TypeError("Cannot convert undefined or null to object");for(var $=w(m),N=1;N<arguments.length;N++){var o=arguments[N];if(o!==H&&null!==o)for(var P in o)w.prototype.hasOwnProperty.call(o,P)&&($[P]=o[P])}return $})}();var N=M.document,R=null,B=M[m]={},d=M[m+"config"],V=B.Default=d&&d.Default||{},v=B.Style=d&&d.Style||{},O=B.Attr=d&&d.Attr||{},z=B.Color=d&&d.Color||{},x=B.IsGetter=d&&d.IsGetter||{};!function(){var N=!1;try{var R=w.defineProperty({},"passive",{get:function(){N=!0}});M.addEventListener("test",R,R),M.removeEventListener("test",R,R)}catch(x){N=!1}V.passiveSupported=N}();var I,J,P,t,s=V.passiveSupported,A=V.eventListenerOptionsFalse=s?{passive:!1,capture:!1}:!1,u=V.eventListenerOptionsTrue=s?{passive:!1,capture:!0}:!0,h=function(W,V,s,L){W.addEventListener(V,s,L?u:A)},Q=function(x,J,l,h){x.removeEventListener(J,l,h?u:A)},E=Math,U=E.round,f=E.floor,$=E.ceil,y=E.sqrt,D=E.max,k=E.min,q=E.abs,i=E.cos,g=E.acos,n=E.sin,j=E.pow,Z=E.asin,Y=E.exp,e=E.PI,b=2*e,W=e/2,o=E.tan,F=E.atan2,p=E.random,r=E.log,c=!1,S=!1,L=M.parseInt||global.parseInt,G="2020-10-15",a=M.navigator?M.navigator.platform.indexOf("Win")>-1:!1,X=function(f){return f*f},_=M.setTimeout,l=M.clearTimeout,Rj=M.location,Np=M.navigator?M.navigator.userAgent.toLowerCase():"",Xk=function(T){return T.test(Np)},qd=Xk(/msie/),Ro=Xk(/msie/)||Xk(/trident/),Al=Xk(/msie 10/),wg=Xk(/edge/),wl=Xk(/firefox/),Il=Xk(/mac/),Kq=V.isTouchable===H?a?!1:N?"ontouchend"in N:!1:V.isTouchable,jh="default",cr="single",_r="multiple",ck="front",ej="back",_c="left",vk="right",gf="top",fm="bottom",xn="center",kr="eye",Wf="middle",qe="east",Jn="west",Kk="north",Vl="none",bg="px",Yq="absolute",pc="border",nk="triangle",xc="rect",ue="circle",Ri="cylinder",Rd="shape",Ok="items",ge="normal",Zf="remove",rq="clear",ok="width",Sh="height",lh="ingroup",fq="check",Nh="uncheck",Nc="radio",ms="radioOn",Yh="radioOff",_b="points",ul="values",tg="series",Cl="body",yl="label",Xf="label2",si="note",ag="note2",Ch="icons",uq="labelFont",gh="labelColor",ur="labelSelectColor",js="note.expanded",Xn="note2.expanded",Ci="edge.expanded",Kh="edge.points",Po="edge.type",qg="rotation",df="hidden",ch="visible",dp="tuv",$l="no",hf="draw",lg="select",kp="currentSubGraph",Fp="selectBackground",Vd="autoMakeVisible",Hp="autoHideScrollBar",mf="scrollBarColor",Hj="scrollBarSize",Hc="indent",ib="rowHeight",cc="columnLineColor",xb="rowLineColor",De="columnLineVisible",Df="rowLineVisible",Vh="visibleFunc",wo="expandIcon",pm="collapseIcon",or="checkMode",mo="sortFunc",bh="editable",Ol="batchEditable",Li="tristate",Bd="asc",_m="desc",Tj="position",aq="elevation",In="children",mh="translateX",Dm="translateY",Un="dataModel",ac="maxSize",Ek="state",Yk="shape3d",Bh="shape3d.resolution",Gm="shape3d.visible",lc="shape3d.from.visible",Ik="shape3d.to.visible",Kl="shape3d.top.visible",ke="shape3d.bottom.visible",Wn="repeat.uv.length",qf="serializeValue",is="deserializeValue",pr="centerUniform",Gg="uniform",Bb="rgba(255,255,255,0)",Mh="style",Bn="attr",qh="field",af="string",zc="boolean",yg="color",rg="int",Ki="number",Zo="ew-resize",xh="ns-resize",zg="pointer",ab="auto",Fl="mousedown",dl="mousemove",Ml="mouseup",md="mouseout",dg="touchstart",dq="touchmove",zj="touchend",Ui="keydown",Cc="keyup",iq=["DOMMouseScroll","mousewheel"],cl=wl?iq[0]:iq[1],jr=Kq?[dg,dq,zj,Ui,Cc,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[Ui,Cc,"keypress","input",Fl,dl,Ml,md,cl,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],Ao=R,wq=R,hj=R,wp=Ml.length,Gk=function(){hj&&(l(hj.timeout),hj=R)},nf=function(){hj&&Td(hj.e,hj.info)};M.addEventListener&&(Kq||(h(M,md,function(){Gk()}),h(M,cl,function(){Ak()})),h(M,Cc,function(n){91===n.keyCode?Rr={}:delete Rr[n.keyCode]},!0),h(M,Ui,function(n){Rr[n.keyCode]=!0},!0),h(M,"blur",function(){Rr={}}));var Jf,Sl,Je,Om=0,oe=R,rn=function(q,X){var w=_(function(){delete oe[w],bn(oe)&&(oe=R),q()},X);return w},sc=R,bo=R,Hn={},Qq={},un={},vr={},vf={},Rr={},di={},wk={},Yd={},Bo={},ks=/.json$/,kh=/^data:image\/svg\+xml/,Yi={},tr=[],jl={},Qg=R,de=R,so=function(){},wj=function(){throw"Oops!"},Zh=[0,0,0],kl={x:0,y:0,width:0,height:0},Fi=R,Ng=R,pj=R,gc=function(A,k){Qq[A]=k,k&&k.comps&&!k.uuid&&(k.uuid=B.Math.generateUUID()),Sg[A]&&(k.cacheRule=Sg[A],delete Sg[A])},Vq=function(z){Ng&&!z._72O&&(pj||(pj={}),pj[z._72O=Gq()]=z),Jf!=R?Tm()<.05&&t&&!Sl&&(Up=Gk):Up=Ll},Gc=function(y,M,c,f){Ng||(Ng={});var l=Ng[y];if(l){if(l.url===M)return;l.image?(l.image.onload=so,l.image.onerror=so):l.request&&(l.request.onload=so,l.request.onerror=so)}if(ks.test(M)){var x=new ro;if(Ng[y]={request:x,url:M},M=V.beforeLoadURL(M,y),M.data){var g=V.parse(M.data);gm(y,g),V.handleImageLoaded(y,g)}else{x.onload=function(){if(200===this.status||0===this.status){var t=V.parse(x.getResponseText());gm(y,t),V.handleImageLoaded(y,t)}else gm(y,V.handleUnfoundImage(y,M)||R)},x.onerror=function(){gm(y,V.handleUnfoundImage(y,M)||R)};var z={};z.url=encodeURI(M),z.sync=!1,x.send(z)}}else{var g=new Image;Ng[y]={image:g,url:M},/^data:image/.test(M)||(M=V.beforeLoadURL(M,y),M=V.appendTimeStamp(M),M=encodeURI(M),g.crossOrigin=V.crossOrigin),V.convertImageSrc(M,function(W){Ro&&(M.toLowerCase().indexOf(".svg")>0||kh.test(M))?(N.body.appendChild(g),g.style.visibility="hidden",g.onload=function(){_(function(){if(c&&(g.width=c),f&&(g.height=f),!g.width||!g.height){var b=g.width||g.clientWidth,s=g.height||g.clientHeight;g.width=b,g.height=s}V.handleImageLoaded(y,g),gm(y,g),N.body.removeChild(g),g.style.visibility=""},180)},g.onerror=function(){gm(y,V.handleUnfoundImage(y,M)||R),N.body.removeChild(g),g.style.visibility=""}):(g.onload=function(){c&&(g.width=c),f&&(g.height=f),V.handleImageLoaded(y,g),gm(y,g)},g.onerror=function(){gm(y,V.handleUnfoundImage(y,M)||R)}),g.src=W})}},gm=function(N,D){if(gc(N,D),delete Ng[N],bn(Ng)&&(Ng=R,pj)){for(var z in pj){var Y=pj[z];Y._2O&&Y._2O[N]&&(Y.deleteTexture(N),delete Y._2O[N]),Y.invalidateAll&&Y.invalidateAll(H,"imageLoaded",N),Y.redraw&&Y.redraw(),Y.iv(),delete Y._72O}pj=R}if(D&&pj)for(var z in pj){var Y=pj[z];Y.invalidateAll&&Y.invalidateAll(H,"imageLoading",N),Y.redraw&&Y.redraw(),Y.iv()}},Qm=function(){return r=E&&Date,function(){return M.performance&&M.performance.now?M.performance.now():Date.now()}}(),td=function(v,l,g){return{width:v,height:l,comps:hd(g)?g:[g]}},Jd=function(t,K){return{type:ue,rect:[t,K,1.6,1.6],borderWidth:1,borderColor:Xq,gradient:Kn,gradientColor:Ef,background:Xq}},Ar=function(w,U){return td(16,16,{type:nk,rect:[4,4,10,8],background:w,rotation:U?1.57:3.14})},le=function(j,l){return td(16,16,{type:nk,rect:[4,4,8,7],background:j,rotation:l?3.14:0})},mk=function(L){var Y=L._orientation;return"horizontal"===Y||"h"===Y},qk=function(X,y){var T=R||4,d=R||1,Q=R||1;0>T?T=0:T>.25&&(T=.25);var a,$,E,t,o,w,h,B=.5,N=[],c=[],O=[],F=b/Q,s=b/d,l=B-T;for($=0;d>=$;$++)for(t=-e+$*s,w=i(t),o=n(t),a=0;Q>=a;a++)E=a*F,h=l+T*w,N.push(i(E)*h,o*T,-n(E)*h),(J=[X,y])&&c.push(a/Q,1-$/d);for($=0;d>$;$++){var I=$*(Q+1),f=($+1)*(Q+1);for(a=0;Q>a;a++)O.push(I+a,f+a+1,f+a,I+a,I+a+1,f+a+1),sl.z=vd.z=[X,y]}},Ho=function(b){var l=2,m=0;for(var I in b)I.length===l&&L(I,32)===as&&(Qg=de=b[I]),m++;return m},ik=function(Z,k,h,w){return h||(h=Kq?5:3,h/=w||1),{x:Z-h,y:k-h,width:2*h,height:2*h}},pg=function(L,P,E,n){var h=this;P||(P=Kq?5:3,E=20,n=20);var c={x:L,y:P,width:E,height:n};if(E)for(var G=0;E>G;G++)if(3===E)n=20;else for(var O=0;n>O;O++)h=M?M:E;var U={x:e,y:2*e};if(Sm(c,U)){var v=Sh[0]+gf[0]+rq[1]+Bd.length,x=df[0]+Li[0]+rq[1]+Cl.length;al[kr]=[h[v],h[x]],h[v]=Xr[kr],h[x]=Xr[Yk]}},Kp=function(Q){return(/ble$/.test(Q)||/ed$/.test(Q)||x[Q]?"is":"get")+Q.charAt(0).toUpperCase()+Q.slice(1)},Xr=function(T){return"set"+T.charAt(0).toUpperCase()+T.slice(1)},Fc=function(k){return typeof k===af||k instanceof String},Ff=function(n){return typeof n===Ki},Ll=function(h){return typeof h===zc},zh=function(r){return r&&"object"==typeof r},xj=function(Q){return"function"==typeof Q},hd=function(l){return l instanceof Array},cb=function(G){return G instanceof Mf},xq=function(n){return hd(n)?new Mf(n):n},hl=function(f){return f instanceof kk},$k=function(b){return b instanceof Ji},Ke=function(_){return _ instanceof cq},of=function(m,z){if(!(m instanceof B.Group))return!1;if(!z)return m.isExpanded();var X=z.getDataUI(m);return X&&X._88I?!0:!1},ze=function(p){return p instanceof ak},dn=function(e){return e&&"IFRAME"===e.tagName},Bg=function(L){return L==R||V.numberDigits==R?L:parseFloat(L.toFixed(V.numberDigits))},Io=function(P,K,r){var R,W=K.length;if(r)for(var B=0;r>B;B++)if(3===W)P.push(K[0]),P.push(K[1]),P.push(K[2]);else for(R=0;W>R;R++)P.push(K[R]);else if(3===W)P.push(K[0]),P.push(K[1]),P.push(K[2]);else for(R=0;W>R;R++)P.push(K[R])},Pf=function(s){return s?zh(s)?s:{}:!1},vl=function(M,c,L){var h,C=zh(M)?M:M.prototype;for(h in c)L&&h in C?C[h]===H&&console.warn("class",C,"has own undefined property",h,", keep exist!"):C[h]=c[h];return M},tb=function(Z,d){if(!("wheelDelta"in d)){var R=d.deltaMode;d.wheelDelta=R===d.DOM_DELTA_PIXEL?-d.deltaY:R===d.DOM_DELTA_LINE?40*-d.deltaY:120*-d.deltaY}Z.handle_mousewheel(d)},Zi=function(L){return String.fromCharCode(L)},ql=function(k){for(var v,w=0,I="";w<k.length;w++)v=k[k.length-1-w],"%"===v?v="'":"a"===v?v='"':"]"===v&&(v="\\"),I+=Zi(v.charCodeAt(0)-1);return I},Ep=function(O,Y,R){O.superClass.constructor.apply(Y,R)},bn=function(O){for(var A in O)return!1;return!0},cm=function(L){return L?0===L.length:!0},jm=function(){var d="";return[Nh[0],xb[0],yl[0]].forEach(function(E){d+=Xr(E).slice(3)}),Gg=N&&N[d]||pr,function(i,n){return i===n?!0:i.x===n.x&&i.y===n.y&&i.width===n.width&&i.height===n.height}}(),zq=function(a,F,A){return F>a?F:a>A?A:a},bb=function(D){return 0>D?-1:D>0?1:0},Tm=function(){var o=1e4*n(wp++);return o-f(o)},uo=function(K,b,m){return Xe(K.x,K.y,b.x,b.y,m.x,m.y,m.x+m.width,m.y,!0)||Xe(K.x,K.y,b.x,b.y,m.x+m.width,m.y,m.x+m.width,m.y+m.height,!0)||Xe(K.x,K.y,b.x,b.y,m.x+m.width,m.y+m.height,m.x,m.y+m.height,!0)||Xe(K.x,K.y,b.x,b.y,m.x,m.y+m.height,m.x,m.y,!0)},Xe=function(b,F,Q,O,Y,K,w,q,p){var j=(w-Y)*(F-K)-(q-K)*(b-Y),H=(q-K)*(Q-b)-(w-Y)*(O-F);if(0!==H){var e=j/H,I=b+e*(Q-b),U=F+e*(O-F);return p&&(I+no<k(b,Q)||I-no>D(b,Q)||I+no<k(Y,w)||I-no>D(Y,w)||U+no<k(F,O)||U-no>D(F,O)||U+no<k(K,q)||U-no>D(K,q))?R:[I,U]}return R},Nl=function(j,R,I){if(j&&I)if(R){if(R===Mh)return j.getStyle(I);if(R===Bn)return j.getAttr(I);if(R===qh)return j[I]}else if(I=Kp(I),j[I])return j[I]();return H},fs=function(h,J,E,M){if(h&&E)if(J){if(J===Mh)h.s(E,M);else if(J===Bn)h.a(E,M);else if(J===qh){var d=h[E];h[E]=M,h.fp("f:"+E,d,M)}}else E=Xr(E),h[E]&&h[E](M)},nc=function(l,g,u){return g&&"top"!==g?"bottom"===g?{x:l.x,y:l.y,width:l.width,height:l.height*u}:"right"===g?{x:l.x,y:l.y,width:l.width*u,height:l.height}:"left"===g?{x:l.x+l.width*(1-u),y:l.y,width:l.width*u,height:l.height}:void 0:{x:l.x,y:l.y+l.height*(1-u),width:l.width,height:l.height*u}},ss=function(F,V,R,X,$){V&&gi(F,R,X,1,$,V)},Bm=function(r,e,b,j){var w=1-r;return w*w*e+2*r*w*b+r*r*j},sl=function(l,A,u,h,Z){var I=1-l;return I*I*I*A+3*I*I*l*u+3*I*l*l*h+l*l*l*Z},kn=function(F){var K,T,G,w,j=0;return F.forEach(function(J){if(K=J.length,K>0)for(T=J[0],w=1;K>w;w++)G=J[w],j+=Wj(T,G),T=G}),j},rk=function(w,c,U){var S="__"+w,F=function(C){U.disabled||U["handle_"+w](C)};U[S]||(U[S]=F,h(c,w,F))},sk=function(d,t,L){var u="__"+d,y=L[u];y&&(Q(t,d,y),delete L[u])},il=function(w,I){var f="_"+I;w[Kp(I)]=function(){return this[f]},w[Xr(I)]=function(w){var R=this[f];this[f]=w,this.fp(I,R,w)}},Oo=function(G){return w.create(G)},As=function(T){if(!T.element){var p,m;(p=T.textField)?m=$p(id.TextField,p):(p=T.textArea)?m=$p(id.TextArea,p):(p=T.button)?m=$p(id.Button,p):(p=T.comboBox)?m=$p(id.ComboBox,p):(p=T.checkBox)?m=$p(id.CheckBox,p):(p=T.radioButton)?m=$p(id.RadioButton,p):(p=T.slider)?m=$p(id.Slider,p):(p=T.colorPicker)?m=$p(id.ColorPicker,p):(p=T.image)&&(m=$p(id.Image,p)),m&&(T.element=m)}},wn=function(o,D){var k=Fb(o);return k._ht=D,k},hq=M.top===M?M.top:M||M.document,Fb=function(h,M){var r=N.createElement("div"),U=r.style;return r.tabIndex=-1,r.onkeydown=dj,U.msTouchAction=Vl,ai(r,R,0),Kq&&U.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",R),h&&(U.overflow=df),M&&ub(M,r),r},ae=function(W,E){var $=N.createElement("canvas"),c=$.style;return c.msTouchAction=Vl,E||(c.pointerEvents=Vl),ai($,R,0),W&&ub(W,$),$},ai=function(P,a,F){var v=P.style;v.border=a?a+" solid 1px":0,v.outline=0,v.padding=F?"0 "+F+bg:0,ci(P)},ci=function(k){var r=k.style;r.position=Yq,r.margin=0,r.setProperty("box-sizing","border-box",R),r.setProperty("-moz-box-sizing","border-box",R)},Pb=function(Q,h,z,f){f||(f=qm),h!=R&&(Q.width=h*f,Q.style.width=h+bg),z!=R&&(Q.height=z*f,Q.style.height=z+bg)},ub=function(n,l,$){n.appendChild(l),$&&(l.style.position=Yq)},ol=function(f,j){j.split||(j+="");for(var D,s=j.split("\n"),I=0,q=s.length,O=0;q>O;O++){var a=Cb(f.font,s[O]);a.width>I&&(I=a.width),D||(D=a.height)}return f.ss=s,{width:I,height:D*q}},dk=function(L,w,g,K,i,F){var p=w.length;if(1===p)zi(L,w[0],g,K,i);else for(var b=g.height/p,W={x:g.x,y:g.y,width:g.width,height:b},S=0;S<w.length;S++)F?Dq(L,w[S],K,i,W.x,W.y,W.width,W.height,F):zi(L,w[S],W,K,i),W.y+=b},zi=function(Z,v,m,Q,Y){Z.font=Q?Q:Op,Z.fillStyle=Y?Y:os,Z.textAlign=xn,Z.textBaseline=Wf;var s,W;m?m.width===H?(s=m.x,W=m.y):(s=m.x+m.width/2,W=m.y+m.height/2):(s=0,W=0),Z.fillText(v,U(s),U(W))},hk=function(h){h.getView&&(h=h.getView());var k=h.offsetWidth||h.scrollWidth;return!k&&h.style.width&&(k=L(h.style.width)),k},gk=function(t){t.getView&&(t=t.getView());var e=t.offsetHeight||t.scrollHeight;return!e&&t.style.height&&(e=L(t.style.height)),e},Qn=function(w,R,Q){var D=R[0].toUpperCase()+R.substring(1,R.length);w["webkit"+D]=Q,w["moz"+D]=Q,w["ms"+D]=Q,w["o"+D]=Q,w[R]=Q},Pq=function(){var F=function(u){dj(u),u.stopPropagation()},t=function(I){dj(I)},O=Kq?[dg]:[Ui,Fl];return function(k,g){var X=Fb(),R=X.style;return R.backgroundColor=V.disabledBackground,k&&(R.backgroundImage="url("+k+")",R.backgroundPosition="50% 50%",R.backgroundRepeat="no-repeat no-repeat"),g===!1?O.forEach(function(W){h(X,W,t)}):O.forEach(function(x){h(X,x,F)}),X}}(),mr=function(l){var o=l.getContext("2d");return o.save(),o.lineCap=lk,o.lineJoin=li,o},Up=function(T,J,h,q){tl(T,J*qm,h*qm),q*=qm,1!==q&&T.scale(q,q)},tl=function(h,c,R){h.translate(c,R)},pb=function(z,J){J&&z.rotate(J)},Bj=function(A,q,r){q===H&&(q=1),r===H&&(r=1),(1!==q||1!==r)&&A.scale(q,r)},Lm=!1,Y=hq[fq[1]+mh[0]],Pm=function(j){var e=N.activeElement;if(N.activeElement!==j){e&&e.forceOnblur&&e.forceOnblur();for(var f=[],O=j.parentNode;O;)f.push([O,O.scrollLeft,O.scrollTop]),O=O.parentNode;if(!Lm){var w=[],s=[];try{for(var L=M.parent,r=M;L!==r;)w.push([L,L.scrollX,L.scrollY]),r=L,L=M.parent;var P=M.frameElement;if(P)for(var p=P.parentNode;p;)s.push([p,p.scrollLeft,p.scrollTop]),p=p.parentNode}catch(t){Lm=!0}}if(Kq)j.focus();else{var R=rl(),u=R.target;j.focus(),u.scrollLeft=R.left,u.scrollTop=R.top}f.forEach(function(d){d[0].scrollLeft=d[1],d[0].scrollTop=d[2]}),Lm||(w.forEach(function(k){k[0].scrollTo(k[1],k[2])}),s.forEach(function(C){C[0].scrollLeft=C[1],C[0].scrollTop=C[2]}))}},dc=function(t){return t&&t.getView?t.getView():t},nd=function(l,J,o,k,Y){if(2===arguments.length&&(o=J.y,k=J.width,Y=J.height,J=J.x),l.isSelfViewEvent)l.setX(J),l.setY(o),l.setWidth(k),l.setHeight(Y);else{var G=dc(l),P=G.style;if((N.fullscreenElement||N.mozFullScreenElement||N.webkitFullscreenElement||N.msFullscreenElement)!==G)J!==H&&(P.left=J+bg),o!==H&&(P.top=o+bg),k!==H&&(P.width=k+bg),Y!==H&&(P.height=Y+bg);else{var a=V.getWindowInfo();P.left=(J=a.left)+bg,P.top=(o=a.top)+bg,P.width=(k=a.width)+bg,P.height=(Y=a.height)+bg}l.endEditing&&!Kq&&l.endEditing(),l.redraw&&l.redraw(),l.invalidate&&l.invalidate(),l.onLayouted&&l.onLayouted(J,o,k,Y),l.fireViewEvent&&l.fireViewEvent("layout")}},Pg=function(S){if(!S.touches)return S;var A=S.touches[0];return A?A:S.changedTouches[0]},Bf=function(q){return Kq?Pg(q).target:q.target},Wd=function(Z){V.popup&&V.popup.close(),V.popup=Z},Lh=R,hn=function($){Lh.handleWindowTouchMove($)},ud=function(r){Lh.handleWindowTouchEnd(r),Q(M,dq,hn),Q(M,zj,ud),Lh=R},Kb=function(X){Lh.handleWindowMouseMove(X)},an=function(V){Lh.handleWindowMouseUp(V),Q(M,dl,Kb),Q(M,Ml,an),Lh=R},Ze=function(E){return 1===tk(E)},cs=function(C,R){return R?R.keyCode===C:Rr[C]},rd=function(B){return Uc(B)&&cs(65,B)},am=function(t){return cs(46,t)||cs(8,t)},he=function(U){return function(I){return I?I.keyCode===U:Rr[U]}},as=573,bd=[65,83,68,87,37,38,39,40,32,13,27],Qb=he(bd[0]),jo=he(bd[1]),oh=he(bd[2]),Mm=he(bd[3]),Pn=he(bd[4]),Mg=he(bd[5]),zn=he(bd[6]),Xd=he(bd[7]),aj=he(bd[8]),Zl=he(bd[9]),Fj=he(bd[10]),qi={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Pr=[2,2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,5,5,7,53],Jg=R,Mk=R,Vk=function(I,p){Jg||(Jg=ae()),Pb(Jg,I,p,1);var s=mr(Jg);return s.clearRect(0,0,I,p),s},Dc=function(){var $,e={};for(var Y in M){var f=_r.length;if(Y.length==f&&Y[0]===_r[2]&&Y[1]===Vl[1]&&Y[4]===_r[3]&&Y[5]===_r[4]&&Y.substr(f-2)===Vl[1]+Vl[2]){var u=M[Y];for(var y in u)y.length===f&&y.substr(0,3)===vk[3]+Zf[3]+lg[0]&&y.substr(f-2)===_r[0]+si[3]&&(iq=u[y])}}return function(H){var g,K=e[H];return K||($||($=ae(),Pb($,1,1,1)),g=$.getContext("2d"),g.clearRect(0,0,1,1),gi(g,0,0,1,1,H),K=g.getImageData(0,0,1,1).data,K=e[H]=[K[0],K[1],K[2],K[3]]),K}}(),Rb=function(v){if(!Fc(v))return v;var m=Dc(v);return m.CA||(m.CA=[m[0]/255,m[1]/255,m[2]/255,m[3]/255]),m.CA},Uf=function(l,X,b,f,N){var O=ae();O.width=b,O.height=f;var B=O.getContext("2d");B.drawImage(l,0,0,b,f);try{for(var S=B.getImageData(0,0,b,f),g=S.data,D=0,x=g.length;x>D;D+=4){var L=g[D+0],h=g[D+1],K=g[D+2],I=g[D+3];"override_a"===N?g[D+3]=255*X[3]:"override_rgb"===N?(g[D+0]=255*X[0],g[D+1]=255*X[1],g[D+2]=255*X[2]):"override"===N?(g[D+0]=255*X[0],g[D+1]=255*X[1],g[D+2]=255*X[2],g[D+3]=255*X[3]):(g[D+0]=X[0]*L,g[D+1]=X[1]*h,g[D+2]=X[2]*K,g[D+3]=X[3]*I)}B.putImageData(S,0,0)}catch(d){return l}return O},al=function(x,F,O){return F&&(F="miter"===O?8*F+20:F+1,x&&Vp(x,F)),F},lj=function(p,N){if(N){var C=new Fn(N),w=p.width/2,i=p.height/2,X=vo([C.tf(-w,-i),C.tf(w,-i),C.tf(w,i),C.tf(-w,i)]);return X.x+=p.x+w,X.y+=p.y+i,X}return p},Mp=function(l,j,_,r,F,$,V,U){r*=Math.PI/180;var c={x:Math.cos(r)*(l.x-V.x)/2+Math.sin(r)*(l.y-V.y)/2,y:-Math.sin(r)*(l.x-V.x)/2+Math.cos(r)*(l.y-V.y)/2},Y=Math.pow(c.x,2)/Math.pow(j,2)+Math.pow(c.y,2)/Math.pow(_,2);Y>1&&(j*=Math.sqrt(Y),_*=Math.sqrt(Y));var E=(F==$?-1:1)*Math.sqrt((Math.pow(j,2)*Math.pow(_,2)-Math.pow(j,2)*Math.pow(c.y,2)-Math.pow(_,2)*Math.pow(c.x,2))/(Math.pow(j,2)*Math.pow(c.y,2)+Math.pow(_,2)*Math.pow(c.x,2)));isNaN(E)&&(E=0);var a={x:E*j*c.y/_,y:E*-_*c.x/j},L={x:(l.x+V.x)/2+Math.cos(r)*a.x-Math.sin(r)*a.y,y:(l.y+V.y)/2+Math.sin(r)*a.x+Math.cos(r)*a.y},B=function(X){return Math.sqrt(Math.pow(X[0],2)+Math.pow(X[1],2))},b=function(V,E){return(V[0]*E[0]+V[1]*E[1])/(B(V)*B(E))},v=function(C,l){return(C[0]*l[1]<C[1]*l[0]?-1:1)*Math.acos(b(C,l))},A=v([1,0],[(c.x-a.x)/j,(c.y-a.y)/_]),S=[(c.x-a.x)/j,(c.y-a.y)/_],w=[(-c.x-a.x)/j,(-c.y-a.y)/_],Q=v(S,w);b(S,w)<=-1&&(Q=Math.PI),b(S,w)>=1&&(Q=0);var b=j>_?j:_,x=j>_?1:j/_,I=j>_?_/j:1;if(null==U){var d={x:0,y:0,width:0,height:0};Vp(d,b),d.x*=x,d.width*=x,d.y*=I,d.height*=I;var s=new Fn(r);return d=vo([s.tf(d.x,d.y),s.tf(d.x+d.width,d.y),s.tf(d.x+d.width,d.y+d.height),s.tf(d.x,d.y+d.height)]),d.x+=L.x,d.y+=L.y,[{x:d.x,y:d.y},{x:d.x+d.width,y:d.y},{x:d.x+d.width,y:d.y+d.height},{x:d.x,y:d.y+d.height}]}U.translate(L.x,L.y),U.rotate(r),U.scale(x,I),U.arc(0,0,b,A,A+Q,1-$),U.scale(1/x,1/I),U.rotate(-r),U.translate(-L.x,-L.y)},Wi=function(H,o){H&&H.beginPath();for(var U,r,q,W=[],A=function(A){for(var t,c=/(\-{0,1}[\d\.]+)/gi,D=[];t=c.exec(A);)D.push(parseFloat(t[0]));return D},Q=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,Z={x:0,y:0};U=Q.exec(o);){var N=U[0],i=N.substr(0,1);if("M"===i||"m"===i){for(var u=A(N),m=0;m<u.length;m+=2){var I=u[m],S=u[m+1];"m"===i&&(I+=Z.x,S+=Z.y),H&&H.moveTo(I,S),W.push({x:I,y:S}),Z.x=I,Z.y=S}r=q=null}else if("H"===i||"h"===i){for(var u=A(N),m=0;m<u.length;m+=1){var I=u[m];"h"===i&&(I+=Z.x),H&&H.lineTo(I,Z.y),W.push({x:I,y:Z.y}),Z.x=I}r=q=null}else if("C"===i||"c"===i){for(var u=A(N),m=0;m<u.length;m+=6){var J=u[m],D=u[m+1],v=u[m+2],O=u[m+3],I=u[m+4],S=u[m+5];"c"===i&&(J+=Z.x,D+=Z.y,v+=Z.x,O+=Z.y,I+=Z.x,S+=Z.y),H&&H.bezierCurveTo(J,D,v,O,I,S),W.push({x:J,y:D}),W.push({x:v,y:O}),W.push({x:I,y:S}),Z.x=I,Z.y=S}r=[J,D,v,O,I,S],q=null}else if("S"===i||"s"===i){for(var u=A(N),m=0;m<u.length;m+=4){var J,D;r?(J=2*r[4]-r[2],D=2*r[5]-r[3]):(J=Z.x,D=Z.y);var v=u[m],O=u[m+1],I=u[m+2],S=u[m+3];"s"===i&&(v+=Z.x,O+=Z.y,I+=Z.x,S+=Z.y),H&&H.bezierCurveTo(J,D,v,O,I,S),W.push({x:J,y:D}),W.push({x:v,y:O}),W.push({x:I,y:S}),Z.x=I,Z.y=S}r=[J,D,v,O,I,S],q=null}else if("Q"===i||"q"===i){for(var u=A(N),m=0;m<u.length;m+=4){var J=u[m],D=u[m+1],I=u[m+2],S=u[m+3];"q"===i&&(J+=Z.x,D+=Z.y,I+=Z.x,S+=Z.y),H&&H.quadraticCurveTo(J,D,I,S),W.push({x:J,y:D}),W.push({x:I,y:S}),Z.x=I,Z.y=S}r=null,q=[J,D,I,S]}else if("T"===i||"t"===i){for(var u=A(N),m=0;m<u.length;m+=2){var J,D;q?(J=2*q[2]-q[0],D=2*q[3]-q[1]):(J=Z.x,D=Z.y);var I=u[m],S=u[m+1];"t"===i&&(I+=Z.x,S+=Z.y),H&&H.quadraticCurveTo(J,D,I,S),W.push({x:J,y:D}),W.push({x:I,y:S}),Z.x=I,Z.y=S}r=null,q=[J,D,I,S]}else if("V"===i||"v"===i){for(var u=A(N),m=0;m<u.length;m+=1){var S=u[m];"v"===i&&(S+=Z.y),H&&H.lineTo(Z.x,S),W.push({x:Z.x,y:S}),Z.y=S}r=q=null}else if("L"===i||"l"===i){for(var u=A(N),m=0;m<u.length;m+=2){var I=u[m],S=u[m+1];"l"===i&&(I+=Z.x,S+=Z.y),H&&H.lineTo(I,S),W.push({x:I,y:S}),Z.x=I,Z.y=S}r=q=null}else if("A"===i||"a"===i){for(var u=A(N),m=0;m<u.length;m+=7){var C=u[m],_=u[m+1],Y=u[m+2],w=u[m+3],B=u[m+4],I=u[m+5],S=u[m+6];"a"===i&&(I+=Z.x,S+=Z.y);var k=Mp(Z,C,_,Y,w,B,{x:I,y:S},H);k&&(W=W.concat(k)),Z.x=I,Z.y=S}r=q=null}var a=N.substr(N.length-1);("z"===a||"Z"===a)&&H&&H.closePath()}return W},op=function(Q,e){var d,k,n="L"===e[0],Y=e.length;Q.save(),n?(Q.transform(e[5],e[6],e[7],e[8],e[9],e[10]),d=Q.createLinearGradient(e[1],e[2],e[3],e[4]),k=11):(Q.transform(e[7],e[8],e[9],e[10],e[11],e[12]),d=Q.createRadialGradient(e[1],e[2],e[3],e[4],e[5],e[6]),k=13);for(var U=Q.compGray;Y>k;)d.addColorStop(e[k],U?V.toGrayColor(e[k+1]):e[k+1]),k+=2;Q.fillStyle=d},vd=function(N,f){var c=N.s("shape.gradient.pack");if(c){for(var Q=c.length,W=new Array(Q),h=0;Q>h;h++)W[h]=c[h];var y,I,p,M,R,j,D,C,w,a,U,$,F,S="L"===W[0];y=S?5:7,I=W[y],p=W[y+1],M=W[y+2],R=W[y+3],j=W[y+4],D=W[y+5],C=f[0],w=f[1],a=f[2],U=f[3],$=f[4],F=f[5],W[y]=C*I+a*p,W[y+1]=w*I+U*p,W[y+2]=C*M+a*R,W[y+3]=w*M+U*R,W[y+4]=C*j+a*D+$,W[y+5]=w*j+U*D+F,N.s("shape.gradient.pack",W)}},ko=function(q,S,u,$){var b=!1;if(q.beginPath?q.beginPath():b=!0,cb(S)&&(S=S._as),cb(u)&&(u=u._as),u&&u.length){for(var H,Q,G,Y,V=0,N=0,B=u.length;B>N;N++)H=u[N],1===H?(Q=S[V++],q.moveTo(Q.x,b?-Q.y:Q.y)):2===H?(Q=S[V++],q.lineTo(Q.x,b?-Q.y:Q.y)):3===H?(Q=S[V++],G=S[V++],q.quadraticCurveTo(Q.x,b?-Q.y:Q.y,G.x,b?-G.y:G.y)):4===H?(Q=S[V++],G=S[V++],Y=S[V++],q.bezierCurveTo(Q.x,b?-Q.y:Q.y,G.x,b?-G.y:G.y,Y.x,b?-Y.y:Y.y)):5===H&&q.closePath();$&&5!==H&&q.closePath()}else{var x,O,z,W=S.length;if(W>0){for(x=S[0],q.moveTo(x.x,b?-x.y:x.y),O=1;W>O;O++)z=S[O],q.lineTo(z.x,b?-z.y:z.y);$&&q.closePath()}}},ed=function(N,O,V,M){if(cb(N)&&(N=N._as),cb(O)&&(O=O._as),O&&O.length){V=V||up;for(var E,q,v,T,o,D,c,A,J=[],x=R,d=0,L=0,Q=O.length;Q>L;L++)if(E=O[L],1===E)J.push(x=[]),x.push(N[d++]);else if(2===E)x.push(N[d++]);else if(3===E){for(q=x[x.length-1],v=N[d++],T=N[d++],D=1;V>D;D++)c=Bm(D/V,q.x,v.x,T.x),A=Bm(D/V,q.y,v.y,T.y),x.push({x:c,y:A,b:!0});x.push(T)}else if(4===E){for(q=x[x.length-1],v=N[d++],T=N[d++],o=N[d++],D=1;V>D;D++)c=sl(D/V,q.x,v.x,T.x,o.x),A=sl(D/V,q.y,v.y,T.y,o.y),x.push({x:c,y:A,b:!0});x.push(o)}else 5===E&&x.push(x[0]);return M&&5!==E&&x&&x.length>2&&x.push(x[0]),J}return M&&N.length>2&&(N=N.slice(),N.push(N[0])),N?[N]:[]},Eh=function(b,u,s,Q,C,R){var B,t,I,h=Dc(u),Y=Q,E=h[0],N=h[1],g=h[2];if(s){var W=Dc(s);B=W[0]-E,t=W[1]-N,I=W[2]-g}else B=255-E,t=255-N,I=255-g;for(R||(R=Q>10?1:.5,R=1>C?k(R/C,2):R),b.save(),b.shadowOffsetX=0,b.shadowOffsetY=0,b.shadowBlur=0,b.shadowColor=0;(Q-=R)>0;){var i=1-Q/Y,q=E+B*i,M=N+t*i,O=g+I*i;q=k($(q),255),M=k($(M),255),O=k($(O),255),b.strokeStyle="rgb("+q+","+M+","+O+")",b.lineWidth=Q,b.stroke()}b.restore()},gl=function(){var s={};return function(V,t){var e=V+"-"+t,n=s[e];if(n)return n;var G,m,o,O=Dc(V);return 0>t?(t=(100+t)/100,G=$(O[0]*t),m=$(O[1]*t),o=$(O[2]*t)):(t/=100,G=O[0],m=O[1],o=O[2],G+=(255-G)*t,m+=(255-m)*t,o+=(255-o)*t,G=k($(G),255),m=k($(m),255),o=k($(o),255)),s[e]="rgb("+G+","+m+","+o+")"}}(),gi=function(D,q,F,V,H,v){v&&(D.fillStyle=v),D.beginPath(),D.rect(q,F,V,H),D.fill()},Rk=function(k,h,R,N,S,M,P){k.beginPath(),rf[h](k,R.x,R.y,R.width,R.height,N,S,M,P)},rs=function(b,W,q,B,Y){var l=rf[q];b.fillStyle=l?l(b,W,B?B:Ef,Y.x,Y.y,Y.width,Y.height):W},Dg=function(f,E,h,C,$,A){try{if(!E.tagName&&E.comps){E._cacheImage_||(E._cacheImage_={});var y;y="override"===C?"colors_override":"override_rgb"===C?"colors_override_rgb":"override_a"===C?"colors_override_a":"colors",E._cacheImage_[y]||(E._cacheImage_[y]={__count__:0});var S=E._cacheImage_[y][h];S||(E._cacheImage_[y].__count__>V.imageCacheThreshold&&(E._cacheImage_[y]={__count__:0}),S=B.Default.toCanvas(E,gs(E),rr(E),null,$,A,h,null,C),E._cacheImage_[y][h]=S,E._cacheImage_[y].__count__++),E=S}f.fillStyle=f.createPattern(E,"repeat")}catch(g){f.fillStyle="black"}},ui=function(p,W,a,z,$,C,u){p.save(),p.translate(W,a),p.scale(1,u/C),p.arc(0,0,C,z,$),p.restore()},Er=function(B,w,J,r,j,A,R,X){var k,M,u,o,Z,W,C,z,c,G,m;if(q(j)>2*e&&(j=2*e),Z=$(q(j)/(e/4)),k=j/Z,M=-k,u=-r,Z>0){W=w+i(r)*A,C=J+n(-r)*R,X?B.lineTo(W,C):B.moveTo(W,C);for(var s=0;Z>s;s++)u+=M,o=u-M/2,z=w+i(u)*A,c=J+n(u)*R,G=w+i(o)*(A/i(M/2)),m=J+n(o)*(R/i(M/2)),B.quadraticCurveTo(G,m,z,c)}},jc=function(E,V,h,_,t,b,N,z,U){6===arguments.length&&(N=b,z=b,U=b);var w=V+_,k=h+t,o=t>_?2*_:2*t;b=o>b?b:o,N=o>N?N:o,z=o>z?z:o,U=o>U?U:o;var e=.29*U,u=.58*U;E.moveTo(w,k-U),E.quadraticCurveTo(w,k-u,w-e,k-e),E.quadraticCurveTo(w-u,k,w-U,k),e=.29*z,u=.58*z,E.lineTo(V+z,k),E.quadraticCurveTo(V+u,k,V+e,k-e),E.quadraticCurveTo(V,k-u,V,k-z),e=.29*b,u=.58*b,E.lineTo(V,h+b),E.quadraticCurveTo(V,h+u,V+e,h+e),E.quadraticCurveTo(V+u,h,V+b,h),e=.29*N,u=.58*N,E.lineTo(w-N,h),E.quadraticCurveTo(w-u,h,w-e,h+e),E.quadraticCurveTo(w,h+u,w,h+N),E.lineTo(w,k-U)},sb=function(E,B,Q,x,P,b,m){B&&(Q=U(Q),x=U(x),m||(m=1),E.fillStyle=B,E.beginPath(),E.rect(Q,x,m,b),E.rect(Q,x,P,m),b-m>0&&E.rect(Q,x+b-m,P,m),P-m>0&&E.rect(Q+P-m,x,m,b),E.fill())},$o=function(B,e,E,v){var G=v.x,d=v.y,I=v.width,O=v.height;if(!(!e||!E||0>=I||0>=O)){var w,a=ap(e),h=Xl(e),J=E>0;1===E||-1===E?(B.fillStyle=J?a:h,B.beginPath(),B.rect(G,d,1,O),B.rect(G,d,I,1),B.fill(),B.fillStyle=J?h:a,B.beginPath(),B.rect(G,d+O-1,I,1),B.rect(G+I-1,d,1,O),B.fill()):(E=k(q(E),k(I/2,O/2)),w=B.createLinearGradient(G,d,G+E,d),w.addColorStop(0,J?a:h),w.addColorStop(1,e),B.fillStyle=w,B.beginPath(),B.moveTo(G,d),B.lineTo(G+E,d+E),B.lineTo(G+E,d+O-E),B.lineTo(G,d+O),B.lineTo(G,d),B.fill(),w=B.createLinearGradient(G,d,G,d+E),w.addColorStop(0,J?a:h),w.addColorStop(1,e),B.fillStyle=w,B.beginPath(),B.moveTo(G,d),B.lineTo(G+E,d+E),B.lineTo(G+I-E,d+E),B.lineTo(G+I,d),B.lineTo(G,d),B.fill(),w=B.createLinearGradient(G,d+O,G,d+O-E),w.addColorStop(0,J?h:a),w.addColorStop(1,e),B.fillStyle=w,B.beginPath(),B.moveTo(G,d+O),B.lineTo(G+E,d+O-E),B.lineTo(G+I-E,d+O-E),B.lineTo(G+I,d+O),B.lineTo(G,d+O),B.fill(),w=B.createLinearGradient(G+I,d,G+I-E,d),w.addColorStop(0,J?h:a),w.addColorStop(1,e),B.fillStyle=w,B.beginPath(),B.moveTo(G+I,d),B.lineTo(G+I-E,d+E),B.lineTo(G+I-E,d+O-E),B.lineTo(G+I,d+O),B.lineTo(G+I,d),B.fill())}},uf=function(r,J,Q,K,Y,T,B){var h=r.createLinearGradient(K,Y,T,B);return h.addColorStop(0,Q),h.addColorStop(1,J),h},zd=function(h,T,e,B,I,V,M){var z=h.createLinearGradient(B,I,V,M);return z.addColorStop(0,T),z.addColorStop(.5,e),z.addColorStop(1,T),z},Lb=function(k,E,T,x,A,O,B){var i=k.createLinearGradient(x,A,O,B);return i.addColorStop(0,E),i.addColorStop(1/3,T),i.addColorStop(2/3,E),i.addColorStop(1,T),i},Qr=function(p,g,G,U,C,H,A,S,u){var Q=p.createRadialGradient(U+H*S,C+A*u,k(H,A)/24,U+H/2,C+A/2,D(H,A)/2);return Q.addColorStop(0,G),Q.addColorStop(1,g),Q},_q=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],rf={polygon:function(u,_,D,b,f,I){(I==R||3>I)&&(I=6);
for(var O,T,E=k(b,f)/2,o=_+b/2,Q=D+f/2,A=0,Z=2*e/I,W=0;I>W;W++)O=o+i(A)*E,T=Q+n(A)*E,0===W?u.moveTo(O,T):u.lineTo(O,T),A+=Z;u.closePath()},arc:function(t,i,o,H,W,I,Y,c,z){I==R&&(I=e),Y==R&&(Y=b),c==R&&(c=!0);var h=i+H/2,v=o+W/2;c&&t.moveTo(h,v),z?ui(t,h,v,I,Y,H/2,W/2):t.arc(h,v,k(H,W)/2,I,Y),c&&t.closePath()},rect:function(S,U,q,n,c){S.rect(U,q,n,c)},circle:function(F,J,u,U,Z){F.arc(J+U/2,u+Z/2,k(U,Z)/2,0,b,!0)},oval:function(U,y,B,J,W){ui(U,y+J/2,B+W/2,0,b,J/2,W/2)},roundRect:function(I,b,Q,q,z,E){E==R&&(E=k(k(q,z)/4,8)),jc(I,b,Q,q,z,E)},star:function(U,O,X,F,H){var T=2*F,r=2*H,Z=O+F/2,b=X+H/2;U.moveTo(Z-T/4,b-r/12),U.lineTo(O+.306*F,X+.579*H),U.lineTo(Z-T/6,b+r/4),U.lineTo(O+F/2,X+.733*H),U.lineTo(Z+T/6,b+r/4),U.lineTo(O+.693*F,X+.579*H),U.lineTo(Z+T/4,b-r/12),U.lineTo(O+.611*F,X+.332*H),U.lineTo(Z+0,b-r/4),U.lineTo(O+.388*F,X+.332*H),U.closePath()},pentagram:function(e,O,w,f,V){var X=.5*V,T=O+.5*f,i=w+X,A=.5257311121191336*f;A>X&&(A=X);var y=_q,l=0;for(e.moveTo(T+A*y[l++],i+A*y[l++]);20>l;)e.lineTo(T+A*y[l++],i+A*y[l++]);e.closePath()},triangle:function(F,x,z,g,j){F.moveTo(x+g/2,z),F.lineTo(x+g,z+j),F.lineTo(x,z+j),F.closePath()},hexagon:function(j,L,W,F,i){j.moveTo(L,W+i/2),j.lineTo(L+F/4,W+i),j.lineTo(L+3*F/4,+W+i),j.lineTo(L+F,W+i/2),j.lineTo(L+3*F/4,W),j.lineTo(L+F/4,W),j.closePath()},pentagon:function(b,N,K,q,j){var h=2*q,r=2*j,F=N+q/2,l=K+j/2;b.moveTo(F-h/4,l-r/12),b.lineTo(F-h/6,l+r/4),b.lineTo(F+h/6,l+r/4),b.lineTo(F+h/4,l-r/12),b.lineTo(F+0,l-r/4),b.closePath()},diamond:function(t,K,c,J,O){t.moveTo(K+J/2,c),t.lineTo(K,c+O/2),t.lineTo(K+J/2,c+O),t.lineTo(K+J,c+O/2),t.closePath()},rightTriangle:function(Q,N,L,g,i){Q.moveTo(N,L),Q.lineTo(N+g,L+i),Q.lineTo(N,L+i),Q.closePath()},parallelogram:function(R,W,q,i,t){var N=i/4;R.moveTo(W+N,q),R.lineTo(W+i,q),R.lineTo(W+i-N,q+t),R.lineTo(W,q+t),R.closePath()},trapezoid:function(f,o,H,B,E){var g=B/4;f.moveTo(o+g,H),f.lineTo(o+B-g,H),f.lineTo(o+B,H+E),f.lineTo(o,H+E),f.closePath()},"linear.southwest":function(e,y,L,h,N,W,M){return uf(e,y,L,h,N+M,h+W,N)},"linear.southeast":function(C,g,A,N,s,w,z){return uf(C,g,A,N+w,s+z,N,s)},"linear.northwest":function(_,u,C,w,Q,y,X){return uf(_,u,C,w,Q,w+y,Q+X)},"linear.northeast":function(J,i,N,n,O,M,a){return uf(J,i,N,n+M,O,n,O+a)},"linear.north":function(v,O,Y,d,$,U,m){return uf(v,O,Y,d,$,d,$+m)},"linear.south":function(I,z,d,B,U,T,c){return uf(I,z,d,B,U+c,B,U)},"linear.west":function(q,S,f,C,t,J){return uf(q,S,f,C,t,C+J,t)},"linear.east":function(T,W,E,A,m,w){return uf(T,W,E,A+w,m,A,m)},"radial.center":function(L,w,e,U,A,r,s){return Qr(L,w,e,U,A,r,s,.5,.5)},"radial.southwest":function(F,a,S,y,U,Q,$){return Qr(F,a,S,y,U,Q,$,.25,.75)},"radial.southeast":function(b,P,z,i,A,C,H){return Qr(b,P,z,i,A,C,H,.75,.75)},"radial.northwest":function(a,E,F,d,K,Q,X){return Qr(a,E,F,d,K,Q,X,.25,.25)},"radial.northeast":function(M,p,w,h,y,x,A){return Qr(M,p,w,h,y,x,A,.75,.25)},"radial.north":function(Q,U,N,c,R,G,n){return Qr(Q,U,N,c,R,G,n,.5,.25)},"radial.south":function(n,E,w,J,M,S,m){return Qr(n,E,w,J,M,S,m,.5,.75)},"radial.west":function(I,q,P,e,t,g,y){return Qr(I,q,P,e,t,g,y,.25,.5)},"radial.east":function(T,S,f,Z,c,D,K){return Qr(T,S,f,Z,c,D,K,.75,.5)},"spread.horizontal":function(l,v,A,i,h,w){return zd(l,v,A,i,h,i+w,h)},"spread.vertical":function(S,h,Q,p,D,L,q){return zd(S,h,Q,p,D,p,D+q)},"spread.diagonal":function(k,N,O,v,p,m,q){return zd(k,N,O,v+m,p,v,p+q)},"spread.antidiagonal":function(i,P,t,n,O,Q,j){return zd(i,P,t,n,O,n+Q,O+j)},"spread.north":function(O,p,k,M,D,e,o){return Lb(O,p,k,M,D-o/4,M,D+o+o/4)},"spread.south":function(u,o,d,O,B,b,_){return Lb(u,d,o,O,B-_/4,O,B+_+_/4)},"spread.west":function(W,D,o,m,x,g){return Lb(W,D,o,m-g/4,x,m+g+g/4,x)},"spread.east":function(j,U,m,N,h,q){return Lb(j,m,U,N-q/4,h,N+q+q/4,h)}},ir=function(j,s,Z){return new Fn(j).tf(s,Z)},Km=function(C){var u=C.touches[0],o=C.touches[1],z=u.clientX,G=u.clientY,h=o.clientX,f=o.clientY;return y((z-h)*(z-h)+(G-f)*(G-f))},gn=function(T){var B=T.touches[0],u=T.touches[1],S=B.clientX,F=B.clientY,s=u.clientX,e=u.clientY;return{x:(S+s)/2,y:(F+e)/2}},Rq=(function(){for(var w=0,u=_m.split(""),p=0;p<u.length;p++)w=10*L(u[p])+w;return qk(M[as.toString(8*p)+yl.substr(p)+3],M[as.toString(8*p)+yl.substr(p)+4]),w}(),function(U,p,$){for(var i=0;i<$.size();i++){var g=$.get(i);U.co(g)&&p.add(g)}for(i=0;i<$.size();i++)g=$.get(i),Rq(U,p,g._children)}),Rg=function(L,k,g){for(var N=0;N<g.size();N++){var f=g.get(g.size()-1-N);L.co(f)&&k.add(f)}for(N=0;N<g.size();N++)f=g.get(N),Rg(L,k,f._children)},kq=function(o,q,t){for(var T=!1,b=0;b<t.size();b++){var F=t.get(b);o.co(F)?T&&q.add(F):T=1}for(b=0;b<t.size();b++)F=t.get(b),kq(o,q,F._children)},Oj=function(f,_,r){for(var T=!1,u=0;u<r.size();u++){var c=r.get(r.size()-1-u);f.co(c)?T&&_.add(c):T=!0}for(u=0;u<r.size();u++)c=r.get(u),Oj(f,_,c._children)},gb=V.moveDatas=function(Q,P,c,a){var d=a==R;if(0!==P||0!==c||!d&&0!==a){var e=!0,M=[];if(Q.forEach(function(h){e&&(h._69O||Ke(h)||ze(h))&&(e=!1)}),e)M=Q;else{var b={},_={};Q.forEach(function(u){b[u._id]=!0});var A={},T=function(n){var r=n._id;return b[r]?(M.push(n),A[r]=!0):A[r]=!1},C=function(u){var N=u._id;if(_[N])return T(u);var h=A[N];if(h!==H)return h;var $=u._parent;if($&&(ze($)||Ke($))&&C($))return A[N]=!0;var O=u._host;return O&&(_[N]=N,h=C(O),_[N]=H,h)?A[N]=!0:T(u)};Q.forEach(function(K){C(K)})}M.forEach(function(j){if(hl(j))d?j.translate(P,c):j.translate3d(P,c,a);else{var I=j.s(Kh);if(!I||I.isEmpty())return;var X=new Mf;I.each(function(h){h=er(h),d?(h.x+=P,h.y+=c):(h.x+=P,h.y+=a,h.e==R?h.e=c:h.e+=c),X.add(h)}),j.s(Kh,X)}})}},gp=function(){function h(C,t){return t===C.substring(0,t.length)?!0:!1}function O(B){return parseFloat(B)||0}function V(m,k){if(k==H&&(k=new vh),h(m,"matrix3d")){var L=m.substring(9,m.length-1).split(",");L=L.map(O),k.fromArray(L)}else if(h(m,"matrix")){var L=m.substring(7,m.length-1).split(",");L=L.map(O),k.el[0]=L[0],k.el[1]=L[1],k.el[2]=0,k.el[3]=0,k.el[4]=L[2],k.el[5]=L[3],k.el[6]=0,k.el[7]=0,k.el[8]=0,k.el[9]=0,k.el[10]=1,k.el[11]=0,k.el[12]=L[4],k.el[13]=L[5],k.el[14]=0,k.el[15]=1}return k}function a(B,x){x==H&&(x=new Fe);var i=B.split(/\s+/);return i=i.map(O),x.set(i[0]||0,i[1]||0,i[2]||0),x}var Q,k,C,N,Y,A=function(W,E){Q||(Q=new vh,k=new Fe,C=new vh,N=new vh,Y=new vh),E==H&&(E=new vh);var S=getComputedStyle(W);S.transform&&"none"!==S.transform&&(V(S.transform,Q),a(S.transformOrigin,k),N.setPosition(k),k.negate(),Y.setPosition(k),(Ro||"preserve-3d"!==S.transformStyle)&&(Q.el[8]=0,Q.el[9]=0,Q.el[10]=1,Q.el[11]=0),E.multiplyMatrices(Y,E),E.multiplyMatrices(Q,E),E.multiplyMatrices(N,E)),!Ro&&S.perspective&&"none"!==S.perspective&&(C.el[11]=-1/O(S.perspective),a(S.perspectiveOrigin,k),N.setPosition(k),k.negate(),Y.setPosition(k),E.multiplyMatrices(Y,E),E.multiplyMatrices(C,E),E.multiplyMatrices(N,E));for(var n=W.offsetParent,I=W.offsetLeft,v=W.offsetTop,g=W.parentElement;g&&g!==n;){var M=getComputedStyle(g);if("none"!==M.transform||"none"!==M.perspective)break;g=g.parentElement}return g==H&&W!==W.ownerDocument.documentElement&&"fixed"!==S.position&&(g=W.ownerDocument.documentElement),n!=H&&n!==g&&(I-=g.offsetLeft,v-=g.offsetTop),k.set(I,v,0),N.setPosition(k),E.multiplyMatrices(N,E),g&&A(g,E),E};return function(f,K){var v=f.parentElement;if(v){var o=v.updateAppendMatrix;if(o){delete v.updateAppendMatrix;var E=new vh;A(v,E);var O=new vh;O.getInverse(E),v._matrixAppend=O,v._maxrixPreAppend=E}return K?v._matrixAppend:v._maxrixPreAppend}}}(),mp=function(X,r){for(;X&&!X.hasOwnProperty(r);)X=w.getPrototypeOf(X);return X&&w.getOwnPropertyDescriptor(X,r)},fr=w.getPrototypeOf?function(q,k,f){var t=mp(k,f);t&&w.defineProperty(q,f,t)}:function(A,S,c){A[c]=S[c]},eg={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Ph=function(){var k={1:function(u,V){return{x:u.x-V.width/2,y:u.y-V.height/2}},2:function(e,C){return{x:e.x+C.width/2,y:e.y-C.height/2}},3:function(n,m){return{x:n.x+n.width/2,y:n.y-m.height/2}},4:function(e,U){return{x:e.x+e.width-U.width/2,y:e.y-U.height/2}},5:function(L,d){return{x:L.x+L.width+d.width/2,y:L.y-d.height/2}},6:function(c){return{x:c.x,y:c.y}},7:function(g){return{x:g.x+g.width/2,y:g.y}},8:function(M){return{x:M.x+M.width,y:M.y}},9:function(U,q){return{x:U.x-q.width/2,y:U.y+q.height/2}},10:function(i,j){return{x:i.x+j.width/2,y:i.y+j.height/2}},11:function(I,h){return{x:I.x+I.width/2,y:I.y+h.height/2}},12:function(U,G){return{x:U.x-G.width/2+U.width,y:U.y+G.height/2}},13:function(X,I){return{x:X.x+X.width+I.width/2,y:X.y+I.height/2}},14:function(O,u){return{x:O.x-u.width/2,y:O.y+O.height/2}},15:function(Y){return{x:Y.x,y:Y.y+Y.height/2}},16:function(S,e){return{x:S.x+e.width/2,y:S.y+S.height/2}},17:function(n){return{x:n.x+n.width/2,y:n.y+n.height/2}},18:function(W,S){return{x:W.x+W.width-S.width/2,y:W.y+W.height/2}},19:function(l){return{x:l.x+l.width,y:l.y+l.height/2}},20:function(U,E){return{x:U.x+U.width+E.width/2,y:U.y+U.height/2}},21:function(C,s){return{x:C.x-s.width/2,y:C.y+C.height-s.height/2}},22:function(s,O){return{x:s.x+O.width/2,y:s.y+s.height-O.height/2}},23:function(i,I){return{x:i.x+i.width/2,y:i.y+i.height-I.height/2}},24:function(s,Q){return{x:s.x+s.width-Q.width/2,y:s.y+s.height-Q.height/2}},25:function(I,b){return{x:I.x+I.width+b.width/2,y:I.y+I.height-b.height/2}},26:function(K){return{x:K.x,y:K.y+K.height}},27:function(X){return{x:X.x+X.width/2,y:X.y+X.height}},28:function(K){return{x:K.x+K.width,y:K.y+K.height}},29:function(A,d){return{x:A.x-d.width/2,y:A.y+A.height+d.height/2}},30:function(i,h){return{x:i.x+h.width/2,y:i.y+i.height+h.height/2}},31:function(V,X){return{x:V.x+V.width/2,y:V.y+V.height+X.height/2}},32:function(A,m){return{x:A.x+A.width-m.width/2,y:A.y+A.height+m.height/2}},33:function(N,R){return{x:N.x+N.width+R.width/2,y:N.y+N.height+R.height/2}},34:function(i,G){return{x:i.x,y:i.y-G.height/2}},35:function(f,z){return{x:f.x+f.width,y:f.y-z.height/2}},36:function(G,T){return{x:G.x,y:G.y+G.height+T.height/2}},37:function(Q,c){return{x:Q.x+Q.width,y:Q.y+Q.height+c.height/2}},38:function(J,k){return{x:J.x+J.width/4,y:J.y-k.height/2}},39:function(X,N){return{x:X.x+3*X.width/4,y:X.y-N.height/2}},40:function(W){return{x:W.x+W.width/4,y:W.y}},41:function(V){return{x:V.x+3*V.width/4,y:V.y}},42:function(P,T){return{x:P.x+P.width/4,y:P.y+T.height/2}},43:function(D,m){return{x:D.x+3*D.width/4,y:D.y+m.height/2}},44:function(H,q){return{x:H.x+H.width/2,y:H.y+H.height/2-q.height/2}},45:function(p){return{x:p.x+p.width/4,y:p.y+p.height/2}},46:function(k,b){return{x:k.x+k.width/2-b.width/2,y:k.y+k.height/2}},47:function(z,J){return{x:z.x+z.width/2+J.width/2,y:z.y+z.height/2}},48:function(p){return{x:p.x+3*p.width/4,y:p.y+p.height/2}},49:function(u,c){return{x:u.x+u.width/2,y:u.y+u.height/2+c.height/2}},50:function(y,E){return{x:y.x+y.width/4,y:y.y+y.height-E.height/2}},51:function(m,X){return{x:m.x+3*m.width/4,y:m.y+m.height-X.height/2}},52:function(E){return{x:E.x+E.width/4,y:E.y+E.height}},53:function(E){return{x:E.x+3*E.width/4,y:E.y+E.height}},54:function(D,B){return{x:D.x+D.width/4,y:D.y+D.height+B.height/2}},55:function(h,x){return{x:h.x+3*h.width/4,y:h.y+h.height+x.height/2}}};return Ho(M)?function(m,a,e){return k[m](a,e?e:kl)}:void 0}();vl(z,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Di=z.reverse,jf=z.transparent,on=z.rectSelectBackground,hh=z.dash,Bq=z.titleBackground,zm=z.titleIconBackground,$f=z.headerBackground,Gl=z.headerIconBackground,Ym=z.headerSeparator,se=z.headerLine,ij=z.contentIconBackground,Ig=z.contentLine,zf=(z.widgetIconHighlight,z.widgetIconBorder),Xq=(z.widgetIconGradient,z.imageBackground),Ef=z.imageGradient,Of=z.highlight,em=z.label,yn=z.labelSelect;if(G&&!M.shutAlert1){var me=new Date,Jo=G.split("-"),vg=new Date(me.getFullYear(),me.getMonth(),me.getDate()),G=new Date(L(Jo[0],10),L(Jo[1],10)-1,L(Jo[2],10)),yp=vg.getTime(),Ob=G.getTime(),To=m+"_try",_p=M.alert;try{var fb=M.localStorage;if(fb&&_p)if(Ob>yp&&1728e6>Ob-yp){var Cp=(Ob-yp)/864e5;fb&&fb[To]!=Cp&&(fb[To]=Cp,M.htWillExpire?_p(M.htWillExpire.replace("{{day}}",Cp)):_p("HT for Web free trial license will expire in "+Cp+" days, please apply for a new license!"))}else yp>=Ob&&(M.htExpired?_p(M.htExpired):_p("Your free trial of HT for Web has expired!")),fb&&delete fb[To]}catch(cn){}}Math.sign===H&&(Math.sign=function(Y){return 0>Y?-1:Y>0?1:+Y});var qc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Ad={encode:function(I,d){var D,o,$,R,x,s,V,E="",F=0;for(I=Ad._utf8_encode(I);F<I.length;)D=I.charCodeAt(F++),o=I.charCodeAt(F++),$=I.charCodeAt(F++),R=D>>2,x=(3&D)<<4|o>>4,s=(15&o)<<2|$>>6,V=63&$,isNaN(o)?s=V=64:isNaN($)&&(V=64),E=E+d.charAt(R)+d.charAt(x)+d.charAt(s)+d.charAt(V);return E},decode:function(N,t){var k,Y,Q,J,M,R,B,a="",H=0;for(N=N.replace(/[^A-Za-z0-9\+\/\=]/g,"");H<N.length;)J=t.indexOf(N.charAt(H++)),M=t.indexOf(N.charAt(H++)),R=t.indexOf(N.charAt(H++)),B=t.indexOf(N.charAt(H++)),k=J<<2|M>>4,Y=(15&M)<<4|R>>2,Q=(3&R)<<6|B,a+=String.fromCharCode(k),64!=R&&(a+=String.fromCharCode(Y)),64!=B&&(a+=String.fromCharCode(Q));return a=Ad._utf8_decode(a)},_utf8_encode:function(g){g=g.replace(/\r\n/g,"\n");for(var P="",w=0;w<g.length;w++){var c=g.charCodeAt(w);128>c?P+=String.fromCharCode(c):c>127&&2048>c?(P+=String.fromCharCode(192|c>>6),P+=String.fromCharCode(128|63&c)):(P+=String.fromCharCode(224|c>>12),P+=String.fromCharCode(128|63&c>>6),P+=String.fromCharCode(128|63&c))}return P},_utf8_decode:function(h){for(var Q="",p=0,e=0,W=0,N=0;p<h.length;)e=h.charCodeAt(p),128>e?(Q+=String.fromCharCode(e),p++):e>191&&224>e?(W=h.charCodeAt(p+1),Q+=String.fromCharCode((31&e)<<6|63&W),p+=2):(W=h.charCodeAt(p+1),N=h.charCodeAt(p+2),Q+=String.fromCharCode((15&e)<<12|(63&W)<<6|63&N),p+=3);return Q}},If=[],Rf=[],Wm=B.Math={generateUUID:function(){for(var P=[],X=0;256>X;X++)P[X]=(16>X?"0":"")+X.toString(16).toUpperCase();return function(){var t=0|4294967295*Math.random(),v=0|4294967295*Math.random(),w=0|4294967295*Math.random(),G=0|4294967295*Math.random();return P[255&t]+P[255&t>>8]+P[255&t>>16]+P[255&t>>24]+"-"+P[255&v]+P[255&v>>8]+"-"+P[64|15&v>>16]+P[255&v>>24]+"-"+P[128|63&w]+P[255&w>>8]+"-"+P[255&w>>16]+P[255&w>>24]+P[255&G]+P[255&G>>8]+P[255&G>>16]+P[255&G>>24]}}(),clamp:function(o,E,x){return Math.max(E,Math.min(x,o))},generateIncreasingID:function(){var D=0;return function(){return++D}}(),encodeBase64:function(I,F){return Ad.encode(I,F||qc)},decodeBase64:function(B,H){return Ad.decode(B,H||qc)},randomArray:function(y,j){j=j||y.length;for(var _=j-1;_>0;_--){var c=Math.floor(Math.random()*(_+1)),N=y[_];y[_]=y[c],y[c]=N}return y},isPOT:function(B){return B>0&&0===(B-1&B)},nearestPOT:function(P){if(!P)return 1;var Q=P;Q--,Q|=Q>>1,Q|=Q>>2,Q|=Q>>4,Q|=Q>>8,Q|=Q>>16,Q++;var D=Q>>1;return P-D>Q-P?Q:D},requestMatrix4:function(){return If.length>0?If.pop():new Wm.Matrix4},releaseMatrix4:function(x){If.push(x)},requestVector3:function(){return Rf.length>0?Rf.pop():new Wm.Vector3},releaseVector3:function(c){Rf.push(c)}},Rl=B.Matrix=B.Math.Matrix2d=function(y,k,t,l,V){this.setFromTransform(y,k,t,l,V)},Fn=Rl;Rl.prototype={},Rl.prototype.constructor=Rl,Rl.prototype.set=function(e,Y,j,u,L,r){return this.a=e,this.b=Y,this.c=j,this.d=u,this.tx=L,this.ty=r,this},Rl.prototype.setFromTransform=function(x,h,D,c,z){var f=this;if(x===H)return f.a=1,f.b=0,f.c=0,f.d=1,f.tx=0,f.ty=0,void 0;x=x||0;var u=n(x),w=i(x);return c=c||1,z=z||1,f.a=w*c,f.b=u*c,f.c=-u*z,f.d=w*z,f.tx=h||0,f.ty=D||0,f},Rl.prototype.apply=function(B,I){I=I||new zb;var V=B.x,z=B.y;return I.x=this.a*V+this.c*z+this.tx,I.y=this.b*V+this.d*z+this.ty,I},Rl.prototype.applyInverse=function(j,Z){Z=Z||new zb;var S=1/(this.a*this.d+this.c*-this.b),P=j.x,i=j.y;return Z.x=this.d*S*P+-this.c*S*i+(this.ty*this.c-this.tx*this.d)*S,Z.y=this.a*S*i+-this.b*S*P+(-this.ty*this.a+this.tx*this.b)*S,Z},Rl.prototype.translate=function(m,l){return this.tx+=m,this.ty+=l,this},Rl.prototype.scale=function(Q,v){return this.a*=Q,this.d*=v,this.c*=Q,this.b*=v,this.tx*=Q,this.ty*=v,this},Rl.prototype.rotate=function(d){var I=Math.cos(d),W=Math.sin(d),Z=this.a,L=this.c,K=this.tx;return this.a=Z*I-this.b*W,this.b=Z*W+this.b*I,this.c=L*I-this.d*W,this.d=L*W+this.d*I,this.tx=K*I-this.ty*W,this.ty=K*W+this.ty*I,this},Rl.prototype.appendTranslate=function(L,n){return this.tx+=this.a*L+this.c*n,this.ty+=this.b*L+this.d*n,this},Rl.prototype.appendScale=function(D,z){return this.a*=D,this.d*=z,this.c*=z,this.b*=D,this},Rl.prototype.appendRotate=function(N){if(!N)return this;var C=Math.cos(N),P=Math.sin(N),D=this.a,I=this.b;return this.a=D*C+this.c*P,this.b=I*C+this.d*P,this.c=-D*P+this.c*C,this.d=-I*P+this.d*C,this},Rl.prototype.append=function(W){var e=this.a,d=this.b,w=this.c,p=this.d;return this.a=W.a*e+W.b*w,this.b=W.a*d+W.b*p,this.c=W.c*e+W.d*w,this.d=W.c*d+W.d*p,this.tx=W.tx*e+W.ty*w+this.tx,this.ty=W.tx*d+W.ty*p+this.ty,this},Rl.prototype.setTransform=function(D,n,M,w,C,m,p,Q,h){var L,S,$,x,q,i,f,b,a,G;return q=Math.sin(p),i=Math.cos(p),f=Math.cos(h),b=Math.sin(h),a=-Math.sin(Q),G=Math.cos(Q),L=i*C,S=q*C,$=-q*m,x=i*m,this.a=f*L+b*$,this.b=f*S+b*x,this.c=a*L+G*$,this.d=a*S+G*x,this.tx=D+(M*L+w*$),this.ty=n+(M*S+w*x),this},Rl.prototype.prepend=function(o){var A=this.tx;if(1!==o.a||0!==o.b||0!==o.c||1!==o.d){var L=this.a,U=this.c;this.a=L*o.a+this.b*o.c,this.b=L*o.b+this.b*o.d,this.c=U*o.a+this.d*o.c,this.d=U*o.b+this.d*o.d}return this.tx=A*o.a+this.ty*o.c+o.tx,this.ty=A*o.b+this.ty*o.d+o.ty,this},Rl.prototype.transform=Rl.prototype.prepend,Rl.prototype.invert=function(){var o=this.a,Y=this.b,B=this.c,i=this.d,q=this.tx,D=o*i-Y*B;return this.a=i/D,this.b=-Y/D,this.c=-B/D,this.d=o/D,this.tx=(B*this.ty-i*q)/D,this.ty=-(o*this.ty-Y*q)/D,this},Rl.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Rl.prototype.clone=function(){var d=new Rl;return d.a=this.a,d.b=this.b,d.c=this.c,d.d=this.d,d.tx=this.tx,d.ty=this.ty,d},Rl.prototype.copy=function(G){return G.a=this.a,G.b=this.b,G.c=this.c,G.d=this.d,G.tx=this.tx,G.ty=this.ty,G},Rl.prototype.tf=function(Y,B){1===arguments.length&&(B=Y.y,Y=Y.x);var X=this;return{x:X.a*Y+X.c*B+X.tx,y:X.b*Y+X.d*B+X.ty}},Rl.prototype.tfi=function(m,i){1===arguments.length&&(i=m.y,m=m.x);var F=this,$=1/(F.a*F.d+F.c*-F.b);return{x:F.d*$*m+-F.c*$*i+(F.ty*F.c-F.tx*F.d)*$,y:F.a*$*i+-F.b*$*m+(-F.ty*F.a+F.tx*F.b)*$}},Rl.IDENTITY=new Rl,Rl.TEMP_MATRIX=new Rl;var bm=B.Math.Quaternion=function(p,s,r,H){this.set(p,s,r,H)};w.assign(bm.prototype,{set:function(O,n,d,Z){var S=this;return S._x=O||0,S._y=n||0,S._z=d||0,S._w=Z!==H?Z:1,S},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(I){var E=this;return E._x=I._x,E._y=I._y,E._z=I._z,E._w=I._w,E},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(q){return this._x*q._x+this._y*q._y+this._z*q._z+this._w*q._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var X=this.length();return 0===X?(this._x=0,this._y=0,this._z=0,this._w=1):(X=1/X,this._x=this._x*X,this._y=this._y*X,this._z=this._z*X,this._w=this._w*X),this},fromArray:function(U,z){z===H&&(z=0);var k=this;return k._x=U[z],k._y=U[z+1],k._z=U[z+2],k._w=U[z+3],this},slerp:function(c,h){if(0===h)return this;if(1===h)return this.copy(c);var n=this._x,C=this._y,D=this._z,x=this._w,z=x*c._w+n*c._x+C*c._y+D*c._z;if(0>z?(this._w=-c._w,this._x=-c._x,this._y=-c._y,this._z=-c._z,z=-z):this.copy(c),z>=1)return this._w=x,this._x=n,this._y=C,this._z=D,this;var W=Math.sqrt(1-z*z);if(Math.abs(W)<.001)return this._w=.5*(x+this._w),this._x=.5*(n+this._x),this._y=.5*(C+this._y),this._z=.5*(D+this._z),this;var o=Math.atan2(W,z),b=Math.sin((1-h)*o)/W,M=Math.sin(h*o)/W;return this._w=x*b+this._w*M,this._x=n*b+this._x*M,this._y=C*b+this._y*M,this._z=D*b+this._z*M,this},setFromAxisAngle:function(i,y){var T=y/2,k=Math.sin(T);return this._x=i.x*k,this._y=i.y*k,this._z=i.z*k,this._w=Math.cos(T),this},setFromEuler:function(T){var l=T._x,B=T._y,D=T._z,s=T._order,L=Math.cos,w=Math.sin,S=L(l/2),K=L(B/2),p=L(D/2),c=w(l/2),I=w(B/2),o=w(D/2);return"XYZ"===s?(this._x=c*K*p+S*I*o,this._y=S*I*p-c*K*o,this._z=S*K*o+c*I*p,this._w=S*K*p-c*I*o):"YXZ"===s?(this._x=c*K*p+S*I*o,this._y=S*I*p-c*K*o,this._z=S*K*o-c*I*p,this._w=S*K*p+c*I*o):"ZXY"===s?(this._x=c*K*p-S*I*o,this._y=S*I*p+c*K*o,this._z=S*K*o+c*I*p,this._w=S*K*p-c*I*o):"ZYX"===s?(this._x=c*K*p-S*I*o,this._y=S*I*p+c*K*o,this._z=S*K*o-c*I*p,this._w=S*K*p+c*I*o):"YZX"===s?(this._x=c*K*p+S*I*o,this._y=S*I*p+c*K*o,this._z=S*K*o-c*I*p,this._w=S*K*p-c*I*o):"XZY"===s&&(this._x=c*K*p-S*I*o,this._y=S*I*p-c*K*o,this._z=S*K*o+c*I*p,this._w=S*K*p+c*I*o),this},setFromRotationMatrix:function(n){var r,S=n.el,Z=S[0],K=S[4],I=S[8],H=S[1],a=S[5],F=S[9],c=S[2],b=S[6],Q=S[10],q=Z+a+Q;return q>0?(r=.5/Math.sqrt(q+1),this._w=.25/r,this._x=(b-F)*r,this._y=(I-c)*r,this._z=(H-K)*r):Z>a&&Z>Q?(r=2*Math.sqrt(1+Z-a-Q),this._w=(b-F)/r,this._x=.25*r,this._y=(K+H)/r,this._z=(I+c)/r):a>Q?(r=2*Math.sqrt(1+a-Z-Q),this._w=(I-c)/r,this._x=(K+H)/r,this._y=.25*r,this._z=(F+b)/r):(r=2*Math.sqrt(1+Q-Z-a),this._w=(H-K)/r,this._x=(I+c)/r,this._y=(F+b)/r,this._z=.25*r),this},setFromToVectors:function(){var z,n;return function(Z,b){return z===H&&(z=new Fe),n=Z.dot(b)+1,1e-7>n?(n=0,Math.abs(Z.x)>Math.abs(Z.z)?z.set(-Z.y,Z.x,0):z.set(0,-Z.z,Z.y)):z.crossVectors(Z,b),this._x=z.x,this._y=z.y,this._z=z.z,this._w=n,this.normalize()}}(),setFromUnitVectors:function(){var K,W,T=1e-6;return function(v,N){return K===H&&(K=new Fe),W=v.dot(N)+1,T>W?(W=0,Math.abs(v.x)>Math.abs(v.z)?K.set(-v.y,v.x,0):K.set(0,-v.z,v.y)):K.crossVectors(v,N),this._x=K.x,this._y=K.y,this._z=K.z,this._w=W,this.normalize()}}(),multiply:function(O){return this.multiplyQuaternions(this,O)},premultiply:function(h){return this.multiplyQuaternions(h,this)},multiplyQuaternions:function(s,M){var d=s._x,A=s._y,X=s._z,K=s._w,Z=M._x,_=M._y,c=M._z,j=M._w;return this._x=d*j+K*Z+A*c-X*_,this._y=A*j+K*_+X*Z-d*c,this._z=X*j+K*c+d*_-A*Z,this._w=K*j-d*Z-A*_-X*c,this}});var Iq=B.Math.Vector4=function(j,B,k,p){this.x=j||0,this.y=B||0,this.z=k||0,this.w=p!==H?p:1};w.assign(Iq.prototype,{isVector4:!0,set:function(N,m,o,p){return this.x=N,this.y=m,this.z=o,this.w=p,this},setScalar:function(S){return this.x=S,this.y=S,this.z=S,this.w=S,this},setX:function(B){return this.x=B,this},setY:function(D){return this.y=D,this},setZ:function(c){return this.z=c,this},setW:function(Q){return this.w=Q,this},setComponent:function(G,q){switch(G){case 0:this.x=q;break;case 1:this.y=q;break;case 2:this.z=q;break;case 3:this.w=q;break;default:throw new Error("index is out of range: "+G)}return this},getComponent:function(m){switch(m){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+m)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function($){return this.x=$.x,this.y=$.y,this.z=$.z,this.w=$.w!==H?$.w:1,this},add:function(h,e){return e!==H?this.addVectors(h,e):(this.x+=h.x,this.y+=h.y,this.z+=h.z,this.w+=h.w,this)},addScalar:function(j){return this.x+=j,this.y+=j,this.z+=j,this.w+=j,this},addVectors:function(l,r){return this.x=l.x+r.x,this.y=l.y+r.y,this.z=l.z+r.z,this.w=l.w+r.w,this},addScaledVector:function(i,J){return this.x+=i.x*J,this.y+=i.y*J,this.z+=i.z*J,this.w+=i.w*J,this},sub:function(V,W){return W!==H?this.subVectors(V,W):(this.x-=V.x,this.y-=V.y,this.z-=V.z,this.w-=V.w,this)},subScalar:function(h){return this.x-=h,this.y-=h,this.z-=h,this.w-=h,this},subVectors:function(g,Z){return this.x=g.x-Z.x,this.y=g.y-Z.y,this.z=g.z-Z.z,this.w=g.w-Z.w,this},multiplyScalar:function(f){return this.x*=f,this.y*=f,this.z*=f,this.w*=f,this},applyMatrix4:function(y){var Q=this.x,X=this.y,s=this.z,U=this.w,c=y.el;return this.x=c[0]*Q+c[4]*X+c[8]*s+c[12]*U,this.y=c[1]*Q+c[5]*X+c[9]*s+c[13]*U,this.z=c[2]*Q+c[6]*X+c[10]*s+c[14]*U,this.w=c[3]*Q+c[7]*X+c[11]*s+c[15]*U,this},divideScalar:function(o){return this.multiplyScalar(1/o)},setAxisAngleFromQuaternion:function(j){this.w=2*Math.acos(j.w);var X=Math.sqrt(1-j.w*j.w);return 1e-4>X?(this.x=1,this.y=0,this.z=0):(this.x=j.x/X,this.y=j.y/X,this.z=j.z/X),this},setAxisAngleFromRotationMatrix:function(k){var b,l,r,g,x=.01,Y=.1,F=k.el,f=F[0],h=F[4],j=F[8],X=F[1],Z=F[5],U=F[9],S=F[2],s=F[6],P=F[10];if(Math.abs(h-X)<x&&Math.abs(j-S)<x&&Math.abs(U-s)<x){if(Math.abs(h+X)<Y&&Math.abs(j+S)<Y&&Math.abs(U+s)<Y&&Math.abs(f+Z+P-3)<Y)return this.set(1,0,0,0),this;b=Math.PI;var u=(f+1)/2,N=(Z+1)/2,t=(P+1)/2,$=(h+X)/4,I=(j+S)/4,C=(U+s)/4;return u>N&&u>t?x>u?(l=0,r=.707106781,g=.707106781):(l=Math.sqrt(u),r=$/l,g=I/l):N>t?x>N?(l=.707106781,r=0,g=.707106781):(r=Math.sqrt(N),l=$/r,g=C/r):x>t?(l=.707106781,r=.707106781,g=0):(g=Math.sqrt(t),l=I/g,r=C/g),this.set(l,r,g,b),this}var i=Math.sqrt((s-U)*(s-U)+(j-S)*(j-S)+(X-h)*(X-h));return Math.abs(i)<.001&&(i=1),this.x=(s-U)/i,this.y=(j-S)/i,this.z=(X-h)/i,this.w=Math.acos((f+Z+P-1)/2),this},min:function(V){return this.x=Math.min(this.x,V.x),this.y=Math.min(this.y,V.y),this.z=Math.min(this.z,V.z),this.w=Math.min(this.w,V.w),this},max:function(Y){return this.x=Math.max(this.x,Y.x),this.y=Math.max(this.y,Y.y),this.z=Math.max(this.z,Y.z),this.w=Math.max(this.w,Y.w),this},clamp:function(Q,$){return this.x=Math.max(Q.x,Math.min($.x,this.x)),this.y=Math.max(Q.y,Math.min($.y,this.y)),this.z=Math.max(Q.z,Math.min($.z,this.z)),this.w=Math.max(Q.w,Math.min($.w,this.w)),this},clampScalar:function(){var h,c;return function(j,Q){return h===H&&(h=new Iq,c=new Iq),h.set(j,j,j,j),c.set(Q,Q,Q,Q),this.clamp(h,c)}}(),clampLength:function(B,$){var S=this.length();return this.divideScalar(S||1).multiplyScalar(Math.max(B,Math.min($,S)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(b){return this.x*b.x+this.y*b.y+this.z*b.z+this.w*b.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(H){return this.normalize().multiplyScalar(H)},lerp:function(Q,t){return this.x+=(Q.x-this.x)*t,this.y+=(Q.y-this.y)*t,this.z+=(Q.z-this.z)*t,this.w+=(Q.w-this.w)*t,this},lerpVectors:function(R,L,k){return this.subVectors(L,R).multiplyScalar(k).add(R)},equals:function(Z){return Z.x===this.x&&Z.y===this.y&&Z.z===this.z&&Z.w===this.w},fromArray:function(Q,P){return P===H&&(P=0),this.x=Q[P],this.y=Q[P+1],this.z=Q[P+2],this.w=Q[P+3],this},toArray:function(X,q){return X===H&&(X=[]),q===H&&(q=0),X[q]=this.x,X[q+1]=this.y,X[q+2]=this.z,X[q+3]=this.w,X},fromBufferAttribute:function(t,K){return this.x=t.getX(K),this.y=t.getY(K),this.z=t.getZ(K),this.w=t.getW(K),this}});var Fe=B.Math.Vector3=function(b,F,v){b===H?(this.x=0,this.y=0,this.z=0):"object"==typeof b?this.copy(b):this.set(b,F==H?b:F,v==H?b:v)};w.assign(Fe.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(H,s,k){return this.x=H,this.y=s,this.z=k,this},equals:function(H){return H&&this.x===H.x&&this.y===H.y&&this.z===H.z},setScalar:function(f){return this.x=f,this.y=f,this.z=f,this},setX:function(I){return this.x=I,this},setY:function(l){return this.y=l,this},setZ:function(n){return this.z=n,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(r){return r.x===H?(this.x=r[0],this.y=r[1],this.z=r[2]):(this.x=r.x,this.y=r.y,this.z=r.z||0),this},add:function(M){return this.x+=M.x,this.y+=M.y,this.z+=M.z,this},addScalar:function(i){return this.x+=i,this.y+=i,this.z+=i,this},addVectors:function(E,x){return this.x=E.x+x.x,this.y=E.y+x.y,this.z=E.z+x.z,this},addScaledVector:function(L,F){return this.x+=L.x*F,this.y+=L.y*F,this.z+=L.z*F,this},sub:function(b){return this.x-=b.x,this.y-=b.y,this.z-=b.z,this},subScalar:function(c){return this.x-=c,this.y-=c,this.z-=c,this},subVectors:function(P,Y){return this.x=P.x-Y.x,this.y=P.y-Y.y,this.z=P.z-Y.z,this},divide:function(d){return this.x/=d.x,this.y/=d.y,this.z/=d.z,this},multiply:function(x){return this.x*=x.x,this.y*=x.y,this.z*=x.z,this},multiplyScalar:function(P){return this.x*=P,this.y*=P,this.z*=P,this},distanceTo:function(b){return Math.sqrt(this.distanceToSquared(b))},distanceToSquared:function(D){var E=this.x-D.x,U=this.y-D.y,J=this.z-D.z;return E*E+U*U+J*J},distanceToSquared2:function(l){var i=this.x-l[0],w=this.y-l[1],S=this.z-l[2];return i*i+w*w+S*S},divideVectors:function(V,i){return this.x=V.x/i.x,this.y=V.y/i.y,this.z=V.z/i.z,this},multiplyVectors:function(M,p){return this.x=M.x*p.x,this.y=M.y*p.y,this.z=M.z*p.z,this},transformDirection:function(b){var I=this.x,v=this.y,U=this.z,x=b.el;return this.x=x[0]*I+x[4]*v+x[8]*U,this.y=x[1]*I+x[5]*v+x[9]*U,this.z=x[2]*I+x[6]*v+x[10]*U,this.normalize()},applyAxisAngle:function(){var v=new bm;return function(P,B){return this.applyQuaternion(v.setFromAxisAngle(P,B))}}(),applyEuler:function(){var M=new bm;return function(C){return this.applyQuaternion(M.setFromEuler(C))}}(),applyQuaternion:function(N){var l=this.x,b=this.y,P=this.z,m=N._x,H=N._y,j=N._z,u=N._w,i=u*l+H*P-j*b,Q=u*b+j*l-m*P,V=u*P+m*b-H*l,t=-m*l-H*b-j*P;return this.x=i*u+t*-m+Q*-j-V*-H,this.y=Q*u+t*-H+V*-m-i*-j,this.z=V*u+t*-j+i*-H-Q*-m,this},applyMatrix4:function(b){var M=this.x,o=this.y,F=this.z,W=b.el,N=1/(W[3]*M+W[7]*o+W[11]*F+W[15]);return this.x=(W[0]*M+W[4]*o+W[8]*F+W[12])*N,this.y=(W[1]*M+W[5]*o+W[9]*F+W[13])*N,this.z=(W[2]*M+W[6]*o+W[10]*F+W[14])*N,this},applyMatrix3:function(U){var S=this.x,G=this.y,o=this.z,b=U.el;return this.x=b[0]*S+b[3]*G+b[6]*o,this.y=b[1]*S+b[4]*G+b[7]*o,this.z=b[2]*S+b[5]*G+b[8]*o,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var Z=new Fe;return function(m){return this.sub(Z.copy(m).multiplyScalar(2*this.dot(m)))}}(),dot:function(C){return this.x*C.x+this.y*C.y+this.z*C.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)
},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var x=this.length();return x?this.multiplyScalar(1/x):this},setLength:function(G){return this.normalize().multiplyScalar(G)},fromArray:function(x,Y){return Y===H&&(Y=0),this.x=x[Y],this.y=x[Y+1],this.z=x[Y+2],this},toArray:function(w,b){return w===H&&(w=[0,0,0]),b===H&&(b=0),w[b]=this.x,w[b+1]=this.y,w[b+2]=this.z,w},cross:function(u){return this.crossVectors(this,u)},angleTo:function(P){var T=this.dot(P)/Math.sqrt(this.lengthSq()*P.lengthSq());return T>1||-1>T?0:Math.acos(T)},lerp:function(V,Z){return this.x+=(V.x-this.x)*Z,this.y+=(V.y-this.y)*Z,this.z+=(V.z-this.z)*Z,this},lerpVectors:function(Y,_,O){return this.subVectors(_,Y).multiplyScalar(O).add(Y)},crossVectors:function(H,X){var j=H.x,E=H.y,z=H.z,K=X.x,Z=X.y,f=X.z;return this.x=E*f-z*Z,this.y=z*K-j*f,this.z=j*Z-E*K,this},min:function(v){return this.x=Math.min(this.x,v.x),this.y=Math.min(this.y,v.y),this.z=Math.min(this.z,v.z),this},max:function(Z){return this.x=Math.max(this.x,Z.x),this.y=Math.max(this.y,Z.y),this.z=Math.max(this.z,Z.z),this},setFromMatrixPosition:function(R){return this.setFromMatrixColumn(R,3)},setFromMatrixScale:function(H){var G=this.setFromMatrixColumn(H,0).length(),v=this.setFromMatrixColumn(H,1).length(),N=this.setFromMatrixColumn(H,2).length();return this.x=G,this.y=v,this.z=N,this},setFromMatrixColumn:function(d,n){return this.fromArray(d.el,4*n)}});var zb=B.Math.Vector2=function(N,j,r){"object"==typeof N&&(N.x!=H?(j=N.y,N=N.x,r=N.e):(r=N[2],j=N[1],N=N[0])),this.set(N||0,j||0,r)};zb.prototype={},zb.prototype.constructor=zb,w.defineProperties(zb.prototype,{width:{get:function(){return this.x},set:function(G){this.x=G}},height:{get:function(){return this.y},set:function(_){this.y=_}}}),zb.prototype.clone=function(){return new zb(this.x,this.y,this.e)},zb.prototype.copy=function(b){return this.set(b.x,b.y,b.e),this},zb.prototype.equals=function(x){return x.x===this.x&&x.y===this.y},zb.prototype.set=function(V,t,F){return this.x=V||0,this.y=t||(0!==t?this.x:0),F!=H&&(this.e=F),this},zb.prototype.setScalar=function(h){return this.x=h,this.y=h,this},zb.prototype.setX=function(u){return this.x=u||0,this},zb.prototype.setY=function(z){return this.y=z||0,this},zb.prototype.add=function(q){return this.x+=q.x,this.y+=q.y,this},zb.prototype.addVectors=function(i,f){return this.x=i.x+f.x,this.y=i.y+f.y,this},zb.prototype.addScalar=function(O){return this.x+=O,this.y+=O,this},zb.prototype.addScaledVector=function($,Q){return this.x+=$.x*Q,this.y+=$.y*Q,this},zb.prototype.sub=function(Y){return this.x-=Y.x,this.y-=Y.y,this},zb.prototype.subScalar=function($){return this.x-=$,this.y-=$,this},zb.prototype.subVectors=function(L,l){return this.x=L.x-l.x,this.y=L.y-l.y,this},zb.prototype.multiply=function(m){return this.x*=m.x,this.y*=m.y,this},zb.prototype.multiplyScalar=function(K){return this.x*=K,this.y*=K,this},zb.prototype.divide=function(F){return this.x/=F.x,this.y/=F.y,this},zb.prototype.divideScalar=function(h){return this.multiplyScalar(1/h)},zb.prototype.min=function(A){return this.x=Math.min(this.x,A.x),this.y=Math.min(this.y,A.y),this},zb.prototype.max=function(y){return this.x=Math.max(this.x,y.x),this.y=Math.max(this.y,y.y),this},zb.prototype.fromArray=function(T,n){return n===H&&(n=0),this.x=T[n],this.y=T[n+1],this},zb.prototype.clamp=function(M,t){return this.x=Math.max(M.x,Math.min(t.x,this.x)),this.y=Math.max(M.y,Math.min(t.y,this.y)),this},zb.prototype.clampScalar=function(){var l,P;return function(x,N){return l===H&&(l=new zb,P=new zb),l.set(x,x),P.set(N,N),this.clamp(l,P)}}(),zb.prototype.clampLength=function(u,n){var S=this.length();return this.multiplyScalar(Math.max(u,Math.min(n,S))/S)},zb.prototype.dot=function(k){return this.x*k.x+this.y*k.y},zb.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},zb.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},zb.prototype.normalize=function(){return this.divideScalar(this.length())},zb.prototype.angle=function(){var l=Math.atan2(this.y,this.x);return 0>l&&(l+=2*Math.PI),l},zb.prototype.distanceTo=function(D){return Math.sqrt(this.distanceToSquared(D))},zb.prototype.distanceToSquared=function(T){var y=this.x-T.x,K=this.y-T.y;return y*y+K*K},zb.prototype.isNearEnough=function(V){return this.distanceToSquared(V)<1e-8},zb.prototype.setLength=function(G){var O=this.length();return O?this.multiplyScalar(G/O):this},zb.prototype.lerp=function(N,Y){return this.x+=(N.x-this.x)*Y,this.y+=(N.y-this.y)*Y,this},zb.prototype.lerpVectors=function(z,P,o){return this.subVectors(P,z).multiplyScalar(o).add(z)},zb.prototype.rotateAround=function(Y,f){var v=Y?Y.x:0,N=Y?Y.y:0,J=Math.cos(f),X=Math.sin(f),P=this.x-v,q=this.y-N;return this.x=P*J-q*X+v,this.y=P*X+q*J+N,this},w.assign(C.prototype,{isMatrix3:!0,set:function(J,U,n,y,c,e,D,x,$){var W=this.el;return W[0]=J,W[1]=y,W[2]=D,W[3]=U,W[4]=c,W[5]=x,W[6]=n,W[7]=e,W[8]=$,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(F){var q=this.el,o=F.el;return q[0]=o[0],q[1]=o[1],q[2]=o[2],q[3]=o[3],q[4]=o[4],q[5]=o[5],q[6]=o[6],q[7]=o[7],q[8]=o[8],this},setFromMatrix4:function(H){var m=H.el;return this.set(m[0],m[4],m[8],m[1],m[5],m[9],m[2],m[6],m[10]),this},applyToBufferAttribute:function(){var l=new Fe;return function(U){for(var z=0,t=U.count;t>z;z++)l.x=U.getX(z),l.y=U.getY(z),l.z=U.getZ(z),l.applyMatrix3(this),U.setXYZ(z,l.x,l.y,l.z);return U}}(),multiply:function(D){return this.multiplyMatrices(this,D)},premultiply:function(z){return this.multiplyMatrices(z,this)},multiplyMatrices:function(F,l){var H=F.el,q=l.el,e=this.el,o=H[0],Q=H[3],x=H[6],p=H[1],I=H[4],B=H[7],C=H[2],t=H[5],d=H[8],w=q[0],a=q[3],m=q[6],L=q[1],i=q[4],v=q[7],S=q[2],J=q[5],T=q[8];return e[0]=o*w+Q*L+x*S,e[3]=o*a+Q*i+x*J,e[6]=o*m+Q*v+x*T,e[1]=p*w+I*L+B*S,e[4]=p*a+I*i+B*J,e[7]=p*m+I*v+B*T,e[2]=C*w+t*L+d*S,e[5]=C*a+t*i+d*J,e[8]=C*m+t*v+d*T,this},multiplyScalar:function(P){var x=this.el;return x[0]*=P,x[3]*=P,x[6]*=P,x[1]*=P,x[4]*=P,x[7]*=P,x[2]*=P,x[5]*=P,x[8]*=P,this},determinant:function(){var k=this.el,L=k[0],l=k[1],B=k[2],T=k[3],R=k[4],P=k[5],r=k[6],c=k[7],C=k[8];return L*R*C-L*P*c-l*T*C+l*P*r+B*T*c-B*R*r},getInverse:function(l){var X=l.el,o=this.el,T=X[0],g=X[1],K=X[2],u=X[3],t=X[4],w=X[5],D=X[6],A=X[7],I=X[8],k=I*t-w*A,h=w*D-I*u,F=A*u-t*D,b=T*k+g*h+K*F;if(0===b)return this.identity();var $=1/b;return o[0]=k*$,o[1]=(K*A-I*g)*$,o[2]=(w*g-K*t)*$,o[3]=h*$,o[4]=(I*T-K*D)*$,o[5]=(K*u-w*T)*$,o[6]=F*$,o[7]=(g*D-A*T)*$,o[8]=(t*T-g*u)*$,this},transpose:function(){var z,n=this.el;return z=n[1],n[1]=n[3],n[3]=z,z=n[2],n[2]=n[6],n[6]=z,z=n[5],n[5]=n[7],n[7]=z,this},getNormalMatrix:function(n){return this.setFromMatrix4(n).getInverse(this).transpose()},transposeIntoArray:function(X){var P=this.el;return X[0]=P[0],X[1]=P[3],X[2]=P[6],X[3]=P[1],X[4]=P[4],X[5]=P[7],X[6]=P[2],X[7]=P[5],X[8]=P[8],this},setUvTransform:function(K,A,D,V,o,i,B){var P=Math.cos(o),G=Math.sin(o);this.set(D*P,D*G,-D*(P*i+G*B)+i+K,-V*G,V*P,-V*(-G*i+P*B)+B+A,0,0,1)},scale:function(T,f){var $=this.el;return $[0]*=T,$[3]*=T,$[6]*=T,$[1]*=f,$[4]*=f,$[7]*=f,this},rotate:function(R){var p=Math.cos(R),v=Math.sin(R),N=this.el,I=N[0],Q=N[3],C=N[6],J=N[1],u=N[4],s=N[7];return N[0]=p*I+v*J,N[3]=p*Q+v*u,N[6]=p*C+v*s,N[1]=-v*I+p*J,N[4]=-v*Q+p*u,N[7]=-v*C+p*s,this},translate:function(k,Z){var I=this.el;return I[0]+=k*I[2],I[3]+=k*I[5],I[6]+=k*I[8],I[1]+=Z*I[2],I[4]+=Z*I[5],I[7]+=Z*I[8],this},equals:function(i){for(var Q=this.el,Y=i.el,n=0;9>n;n++)if(Q[n]!==Y[n])return!1;return!0},fromArray:function(Q,V){V===H&&(V=0);for(var i=0;9>i;i++)this.el[i]=Q[i+V];return this},toArray:function(E,l){E===H&&(E=[]),l===H&&(l=0);var W=this.el;return E[l]=W[0],E[l+1]=W[1],E[l+2]=W[2],E[l+3]=W[3],E[l+4]=W[4],E[l+5]=W[5],E[l+6]=W[6],E[l+7]=W[7],E[l+8]=W[8],E}});var Xo=B.Math.Plane=function(P,i){this.normal=P!==H?P:new Fe(1,0,0),this.constant=i!==H?i:0};w.assign(Xo.prototype,{set:function(i,N){return this.normal.copy(i),this.constant=N,this},setComponents:function(w,j,i,B){return this.normal.set(w,j,i),this.constant=B,this},setFromNormalAndCoplanarPoint:function(I,b){return this.normal.copy(I),this.constant=-b.dot(this.normal),this},setFromCoplanarPoints:function(){var B=new Fe,V=new Fe;return function($,Z,m){var q=B.subVectors(m,Z).cross(V.subVectors($,Z)).normalize();return this.setFromNormalAndCoplanarPoint(q,$),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(v){return this.normal.copy(v.normal),this.constant=v.constant,this},normalize:function(){var F=1/this.normal.length();return this.normal.multiplyScalar(F),this.constant*=F,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(C){return this.normal.dot(C)+this.constant},distanceToSphere:function(g){return this.distanceToPoint(g.center)-g.radius},projectPoint:function(X,k){return k===H&&(k=new Fe),k.copy(this.normal).multiplyScalar(-this.distanceToPoint(X)).add(X)},intersectLine:function(){var L=new Fe;return function(o,v){v===H&&(v=new Fe);var I=o.delta(L),g=this.normal.dot(I);if(0===g)return 0===this.distanceToPoint(o.start)?v.copy(o.start):H;var h=-(o.start.dot(this.normal)+this.constant)/g;return 0>h||h>1?H:v.copy(I).multiplyScalar(h).add(o.start)}}(),intersectsLine:function(x){var a=this.distanceToPoint(x.start),j=this.distanceToPoint(x.end);return 0>a&&j>0||0>j&&a>0},intersectsBox:function(_){return _.intersectsPlane(this)},intersectsSphere:function(c){return c.intersectsPlane(this)},coplanarPoint:function(U){return U===H&&(U=new Fe),U.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var H=new Fe,n=new C;return function(S,E){var F=E||n.getNormalMatrix(S),P=this.coplanarPoint(H).applyMatrix4(S),R=this.normal.applyMatrix3(F).normalize();return this.constant=-P.dot(R),this}}(),translate:function(E){return this.constant-=E.dot(this.normal),this},equals:function(h){return h.normal.equals(this.normal)&&h.constant===this.constant}});var oi=B.Math.Ray=function(S,G){this.origin=S!==H?S.clone():new Fe,this.direction=G!==H?G.clone():new Fe};w.assign(oi.prototype,{set:function(r,p){return this.origin.copy(r),this.direction.copy(p),this},clone:function(){return(new this.constructor).copy(this)},copy:function(L){return this.origin.copy(L.origin),this.direction.copy(L.direction),this.maxHitLen=L.maxHitLen,this},at:function(l,m){var i=m||new Fe;return i.copy(this.direction).multiplyScalar(l).add(this.origin)},setMaxHitLength:function(K){this.maxHitLen=K},lookAt:function(p){return this.direction.copy(p).sub(this.origin).normalize(),this},applyMatrix4:function(G){var C=this.maxHitLen;if(C){var V=this.direction.clone().multiplyScalar(C).add(this.origin);V.applyMatrix4(G)}return this.origin.applyMatrix4(G),this.direction.transformDirection(G),C&&(this.maxHitLen=this.origin.distanceTo(V)),this},intersectSphere:function(){var W=new Fe;return function($,d){W.subVectors($.center,this.origin);var X=W.dot(this.direction),u=W.dot(W)-X*X,k=$.radius*$.radius;if(u>k)return null;var j=Math.sqrt(k-u),E=X-j,v=X+j;return 0>E&&0>v?null:0>E?this.at(v,d):this.at(E,d)}}(),intersectEllipsoid:function(){var s=new Fe,V=new Fe;return function(d,T){s.subVectors(d.center,this.origin),s.divide(d.radius),V.divideVectors(this.direction,d.radius);var S=V.lengthSq(),K=s.dot(V),Q=s.dot(s)*S-K*K;if(Q>S)return null;var R=Math.sqrt(S-Q),l=(K-R)/S,k=(K+R)/S;return 0>l&&0>k?null:0>l?this.at(k,T):this.at(l,T)}}(),intersectBox:function(V,B){var p,G,t,b,i,K,q=1/this.direction.x,J=1/this.direction.y,e=1/this.direction.z,w=this.origin;if(q>=0?(p=(V.min.x-w.x)*q,G=(V.max.x-w.x)*q):(p=(V.max.x-w.x)*q,G=(V.min.x-w.x)*q),J>=0?(t=(V.min.y-w.y)*J,b=(V.max.y-w.y)*J):(t=(V.max.y-w.y)*J,b=(V.min.y-w.y)*J),p>b||t>G)return null;if((t>p||p!==p)&&(p=t),(G>b||G!==G)&&(G=b),e>=0?(i=(V.min.z-w.z)*e,K=(V.max.z-w.z)*e):(i=(V.max.z-w.z)*e,K=(V.min.z-w.z)*e),p>K||i>G)return null;if((i>p||p!==p)&&(p=i),(G>K||G!==G)&&(G=K),0>G)return null;var U=p>=0?p:G,a=this.maxHitLen;return a&&U>a?null:this.at(U,B)},intersectTriangle:function(){var z=new Fe,u=new Fe,J=new Fe,v=new Fe;return function(H,i,I,R,T){u.subVectors(i,H),J.subVectors(I,H),v.crossVectors(u,J);var c,K=this.direction.dot(v);if(K>0){if(R)return null;c=1}else{if(!(0>K))return null;c=-1,K=-K}z.subVectors(this.origin,H);var W=c*this.direction.dot(J.crossVectors(z,J));if(0>W)return null;var S=c*this.direction.dot(u.cross(z));if(0>S||W+S>K)return null;var b=-c*z.dot(v);if(0>b)return null;var U=b/K,Z=this.maxHitLen;return Z&&U>Z?null:this.at(U,T)}}()});var Dl=B.Math.Box3=function(w,G){this.min=w!==H?w:new Fe(1/0,1/0,1/0),this.max=G!==H?G:new Fe(-1/0,-1/0,-1/0)};w.assign(Dl.prototype,{set:function(D,U){return this.min.copy(D),this.max.copy(U),this},setFromArray:function(d){for(var R=1/0,t=1/0,H=1/0,S=-1/0,A=-1/0,p=-1/0,D=0,T=d.length;T>D;D+=3){var Q=d[D],j=d[D+1],o=d[D+2];R>Q&&(R=Q),t>j&&(t=j),H>o&&(H=o),Q>S&&(S=Q),j>A&&(A=j),o>p&&(p=o)}return this.min.set(R,t,H),this.max.set(S,A,p),this},setFromPoints:function(Q){this.makeEmpty();for(var l=0,U=Q.length;U>l;l++)this.expandByPoint(Q[l]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(r){return r.max.x<this.min.x||r.min.x>this.max.x||r.max.y<this.min.y||r.min.y>this.max.y||r.max.z<this.min.z||r.min.z>this.max.z?!1:!0},copy:function(H){return this.min.copy(H.min),this.max.copy(H.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(H){return this.min.min(H),this.max.max(H),this},expandByBox:function(c){return this.min.min(c.min),this.max.max(c.max),this},applyMatrix4:function(){var k=[new Fe,new Fe,new Fe,new Fe,new Fe,new Fe,new Fe,new Fe];return function(A){return this.isEmpty()?this:(k[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(A),k[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(A),k[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(A),k[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(A),k[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(A),k[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(A),k[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(A),k[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(A),this.setFromPoints(k),this)}}()});var Hh=B.Math.Sphere=function(u,$){this.center=u!==H?u:new Fe,this.radius=$!==H?$:0};w.assign(Hh.prototype,{set:function(f,M){return this.center.copy(f),this.radius=M,this},setFromPoints:function(){var A=new Dl;return function(C,R){var M=this.center;R!==H?M.copy(R):A.setFromPoints(C).getCenter(M);for(var z=0,s=0,U=C.length;U>s;s++)z=Math.max(z,M.distanceToSquared(C[s]));return this.radius=Math.sqrt(z),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(K){return this.center.copy(K.center),this.radius=K.radius,this},empty:function(){return this.radius<=0},containsPoint:function(_){return _.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(m){return m.distanceTo(this.center)-this.radius},intersectsSphere:function(u){var W=this.radius+u.radius;return u.center.distanceToSquared(this.center)<=W*W},intersectsBox:function(x){return x.intersectsSphere(this)},intersectsPlane:function(H){return Math.abs(H.distanceToPoint(this.center))<=this.radius},clampPoint:function(a,z){var O=this.center.distanceToSquared(a);return z===H&&(z=new Fe),z.copy(a),O>this.radius*this.radius&&(z.sub(this.center).normalize(),z.multiplyScalar(this.radius).add(this.center)),z},getBoundingBox:function(w){return w===H&&(w=new Dl),w.set(this.center,this.center),w.expandByScalar(this.radius),w},applyMatrix4:function(B){return this.center.applyMatrix4(B),this.radius=this.radius*B.getMaxScaleOnAxis(),this},translate:function(D){return this.center.add(D),this},equals:function(h){return h.center.equals(this.center)&&h.radius===this.radius}});var Xi=B.Math.Frustum=function(F,c,K,V,M,f){this.planes=[F!==H?F:new Xo,c!==H?c:new Xo,K!==H?K:new Xo,V!==H?V:new Xo,M!==H?M:new Xo,f!==H?f:new Xo]};w.assign(Xi.prototype,{set:function(Y,R,M,i,V,l){var E=this.planes;return E[0].copy(Y),E[1].copy(R),E[2].copy(M),E[3].copy(i),E[4].copy(V),E[5].copy(l),this},clone:function(){return(new this.constructor).copy(this)},copy:function(f){for(var Z=this.planes,w=0;6>w;w++)Z[w].copy(f.planes[w]);return this},setFromMatrix:function(h){var I=this.planes,X=h.el,J=X[0],S=X[1],G=X[2],Y=X[3],d=X[4],V=X[5],x=X[6],u=X[7],C=X[8],P=X[9],k=X[10],D=X[11],y=X[12],H=X[13],g=X[14],v=X[15];return I[0].setComponents(Y-J,u-d,D-C,v-y).normalize(),I[1].setComponents(Y+J,u+d,D+C,v+y).normalize(),I[2].setComponents(Y+S,u+V,D+P,v+H).normalize(),I[3].setComponents(Y-S,u-V,D-P,v-H).normalize(),I[4].setComponents(Y-G,u-x,D-k,v-g).normalize(),I[5].setComponents(Y+G,u+x,D+k,v+g).normalize(),this},intersectsObject:function(){var Y=new Hh;return function(x){var L=x.geometry;return null===L.boundingSphere&&L.computeBoundingSphere(),Y.copy(L.boundingSphere).applyMatrix4(x.matrixWorld),this.intersectsSphere(Y)}}(),intersectsSprite:function(){var u=new Hh;return function(x){return u.center.set(0,0,0),u.radius=.7071067811865476,u.applyMatrix4(x.matrixWorld),this.intersectsSphere(u)}}(),intersectsSphere:function(b){for(var Y=this.planes,r=b.center,t=-b.radius,L=0;6>L;L++){var d=Y[L].distanceToPoint(r);if(t>d)return!1}return!0},intersectsBox:function(){var E=new Fe;return function(K){for(var I=this.planes,W=0;6>W;W++){var m=I[W];if(E.x=m.normal.x>0?K.max.x:K.min.x,E.y=m.normal.y>0?K.max.y:K.min.y,E.z=m.normal.z>0?K.max.z:K.min.z,m.distanceToPoint(E)<0)return!1}return!0}}(),containsPoint:function(T){for(var P=this.planes,q=0;6>q;q++)if(P[q].distanceToPoint(T)<0)return!1;return!0}});var vh=B.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};w.assign(vh.prototype,{set:function(Y,D,K,b,o,J,y,C,O,u,H,Z,$,q,V,S){var e=this.el;return e[0]=Y,e[4]=D,e[8]=K,e[12]=b,e[1]=o,e[5]=J,e[9]=y,e[13]=C,e[2]=O,e[6]=u,e[10]=H,e[14]=Z,e[3]=$,e[7]=q,e[11]=V,e[15]=S,this},clone:function(){return(new vh).fromArray(this.el)},fromArray:function(J,M){M===H&&(M=0);for(var r=this.el,w=0;16>w;w++)r[w]=J[w+M];return this},getElements:function(){return this.el},scale:function(x){var _=this.el,J=x.x,X=x.y,E=x.z;return _[0]*=J,_[4]*=X,_[8]*=E,_[1]*=J,_[5]*=X,_[9]*=E,_[2]*=J,_[6]*=X,_[10]*=E,_[3]*=J,_[7]*=X,_[11]*=E,this},makeRotationFromEuler:function(P){var M=this.el,h=P._x,d=P._y,q=P._z,z=P._order,T=Math.cos(h),$=Math.sin(h),F=Math.cos(d),s=Math.sin(d),o=Math.cos(q),J=Math.sin(q);if("XYZ"===z){var p=T*o,v=T*J,Z=$*o,e=$*J;M[0]=F*o,M[4]=-F*J,M[8]=s,M[1]=v+Z*s,M[5]=p-e*s,M[9]=-$*F,M[2]=e-p*s,M[6]=Z+v*s,M[10]=T*F}else if("YXZ"===z){var I=F*o,w=F*J,n=s*o,j=s*J;M[0]=I+j*$,M[4]=n*$-w,M[8]=T*s,M[1]=T*J,M[5]=T*o,M[9]=-$,M[2]=w*$-n,M[6]=j+I*$,M[10]=T*F}else if("ZXY"===z){var I=F*o,w=F*J,n=s*o,j=s*J;M[0]=I-j*$,M[4]=-T*J,M[8]=n+w*$,M[1]=w+n*$,M[5]=T*o,M[9]=j-I*$,M[2]=-T*s,M[6]=$,M[10]=T*F}else if("ZYX"===z){var p=T*o,v=T*J,Z=$*o,e=$*J;M[0]=F*o,M[4]=Z*s-v,M[8]=p*s+e,M[1]=F*J,M[5]=e*s+p,M[9]=v*s-Z,M[2]=-s,M[6]=$*F,M[10]=T*F}else if("YZX"===z){var R=T*F,O=T*s,C=$*F,t=$*s;M[0]=F*o,M[4]=t-R*J,M[8]=C*J+O,M[1]=J,M[5]=T*o,M[9]=-$*o,M[2]=-s*o,M[6]=O*J+C,M[10]=R-t*J}else if("XZY"===z){var R=T*F,O=T*s,C=$*F,t=$*s;M[0]=F*o,M[4]=-J,M[8]=s*o,M[1]=R*J+t,M[5]=T*o,M[9]=O*J-C,M[2]=C*J-O,M[6]=$*o,M[10]=t*J+R}return M[3]=0,M[7]=0,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,this},makeRotationFromQuaternion:function(P){var e=this.el,v=P._x,g=P._y,J=P._z,R=P._w,f=v+v,t=g+g,B=J+J,K=v*f,j=v*t,M=v*B,X=g*t,A=g*B,T=J*B,w=R*f,b=R*t,H=R*B;return e[0]=1-(X+T),e[4]=j-H,e[8]=M+b,e[1]=j+H,e[5]=1-(K+T),e[9]=A-w,e[2]=M-b,e[6]=A+w,e[10]=1-(K+X),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function($){var N=this.el,r=$.el,n=r[0],o=r[1],S=r[2],G=r[3],d=r[4],m=r[5],U=r[6],z=r[7],B=r[8],b=r[9],f=r[10],q=r[11],X=r[12],x=r[13],R=r[14],H=r[15],V=b*R*z-x*f*z+x*U*q-m*R*q-b*U*H+m*f*H,A=X*f*z-B*R*z-X*U*q+d*R*q+B*U*H-d*f*H,c=B*x*z-X*b*z+X*m*q-d*x*q-B*m*H+d*b*H,g=X*b*U-B*x*U-X*m*f+d*x*f+B*m*R-d*b*R,j=n*V+o*A+S*c+G*g;if(0===j)return this.identity();var Z=1/j;return N[0]=V*Z,N[1]=(x*f*G-b*R*G-x*S*q+o*R*q+b*S*H-o*f*H)*Z,N[2]=(m*R*G-x*U*G+x*S*z-o*R*z-m*S*H+o*U*H)*Z,N[3]=(b*U*G-m*f*G-b*S*z+o*f*z+m*S*q-o*U*q)*Z,N[4]=A*Z,N[5]=(B*R*G-X*f*G+X*S*q-n*R*q-B*S*H+n*f*H)*Z,N[6]=(X*U*G-d*R*G-X*S*z+n*R*z+d*S*H-n*U*H)*Z,N[7]=(d*f*G-B*U*G+B*S*z-n*f*z-d*S*q+n*U*q)*Z,N[8]=c*Z,N[9]=(X*b*G-B*x*G-X*o*q+n*x*q+B*o*H-n*b*H)*Z,N[10]=(d*x*G-X*m*G+X*o*z-n*x*z-d*o*H+n*m*H)*Z,N[11]=(B*m*G-d*b*G-B*o*z+n*b*z+d*o*q-n*m*q)*Z,N[12]=g*Z,N[13]=(B*x*S-X*b*S+X*o*f-n*x*f-B*o*R+n*b*R)*Z,N[14]=(X*m*S-d*x*S-X*o*U+n*x*U+d*o*R-n*m*R)*Z,N[15]=(d*b*S-B*m*S+B*o*U-n*b*U-d*o*f+n*m*f)*Z,this},makeRotationAxis:function(i,T){var p=Math.cos(T),Z=Math.sin(T),o=1-p,M=i.x,w=i.y,C=i.z,W=o*M,f=o*w;return this.set(W*M+p,W*w-Z*C,W*C+Z*w,0,W*w+Z*C,f*w+p,f*C-Z*M,0,W*C-Z*w,f*C+Z*M,o*C*C+p,0,0,0,0,1),this},multiply:function(J){return this.multiplyMatrices(this,J)},premultiply:function(S){return this.multiplyMatrices(S,this)},multiplyMatrices:function(W,F){var h=W.el,A=F.el,Z=this.el,s=h[0],i=h[4],p=h[8],B=h[12],o=h[1],c=h[5],w=h[9],b=h[13],f=h[2],P=h[6],X=h[10],m=h[14],S=h[3],V=h[7],I=h[11],a=h[15],t=A[0],u=A[4],O=A[8],q=A[12],Q=A[1],k=A[5],n=A[9],g=A[13],j=A[2],G=A[6],z=A[10],$=A[14],x=A[3],y=A[7],U=A[11],D=A[15];return Z[0]=s*t+i*Q+p*j+B*x,Z[4]=s*u+i*k+p*G+B*y,Z[8]=s*O+i*n+p*z+B*U,Z[12]=s*q+i*g+p*$+B*D,Z[1]=o*t+c*Q+w*j+b*x,Z[5]=o*u+c*k+w*G+b*y,Z[9]=o*O+c*n+w*z+b*U,Z[13]=o*q+c*g+w*$+b*D,Z[2]=f*t+P*Q+X*j+m*x,Z[6]=f*u+P*k+X*G+m*y,Z[10]=f*O+P*n+X*z+m*U,Z[14]=f*q+P*g+X*$+m*D,Z[3]=S*t+V*Q+I*j+a*x,Z[7]=S*u+V*k+I*G+a*y,Z[11]=S*O+V*n+I*z+a*U,Z[15]=S*q+V*g+I*$+a*D,this},lookAt:function(){var v=new Fe,n=new Fe,_=new Fe;return function(j,O,N){var b=this.el;return _.subVectors(j,O),0===_.lengthSq()&&(_.z=1),_.normalize(),v.crossVectors(N,_),0===v.lengthSq()&&(1===Math.abs(N.z)?_.x+=1e-4:_.z+=1e-4,_.normalize(),v.crossVectors(N,_)),v.normalize(),n.crossVectors(_,v),b[0]=v.x,b[4]=n.x,b[8]=_.x,b[1]=v.y,b[5]=n.y,b[9]=_.y,b[2]=v.z,b[6]=n.z,b[10]=_.z,this}}(),extractScale:function(){var x;return function(n){x===H&&(x=new Fe),n===H&&(n=new Fe);var b=x.setFromMatrixColumn(this,0).length(),Q=x.setFromMatrixColumn(this,1).length(),N=x.setFromMatrixColumn(this,2).length();return n.set(b,Q,N),n}}(),extractRotation:function(){var u;return function(F){u===H&&(u=new Fe),F===H&&(F=new vh);var e=this.el,m=F.el,M=1/u.setFromMatrixColumn(F,0).length(),n=1/u.setFromMatrixColumn(F,1).length(),Y=1/u.setFromMatrixColumn(F,2).length();return e[0]=m[0]*M,e[1]=m[1]*M,e[2]=m[2]*M,e[4]=m[4]*n,e[5]=m[5]*n,e[6]=m[6]*n,e[8]=m[8]*Y,e[9]=m[9]*Y,e[10]=m[10]*Y,this}}(),multiplyScalar:function(P){var I=this.el;return I[0]*=P,I[4]*=P,I[8]*=P,I[12]*=P,I[1]*=P,I[5]*=P,I[9]*=P,I[13]*=P,I[2]*=P,I[6]*=P,I[10]*=P,I[14]*=P,I[3]*=P,I[7]*=P,I[11]*=P,I[15]*=P,this},getPosition:function(b){return b===H&&(b=new Fe),b.setFromMatrixColumn(this,3)},setPosition:function(v){var F=this.el;return F[12]=v.x,F[13]=v.y,F[14]=v.z,this},toArray:function(z,t){z===H&&(z=[]),t===H&&(t=0);var c=this.el;return z[t]=c[0],z[t+1]=c[1],z[t+2]=c[2],z[t+3]=c[3],z[t+4]=c[4],z[t+5]=c[5],z[t+6]=c[6],z[t+7]=c[7],z[t+8]=c[8],z[t+9]=c[9],z[t+10]=c[10],z[t+11]=c[11],z[t+12]=c[12],z[t+13]=c[13],z[t+14]=c[14],z[t+15]=c[15],z},determinant:function(){var h=this.el,N=h[0],B=h[4],b=h[8],L=h[12],u=h[1],W=h[5],Q=h[9],X=h[13],c=h[2],S=h[6],o=h[10],J=h[14],j=h[3],g=h[7],p=h[11],U=h[15];return j*(+L*Q*S-b*X*S-L*W*o+B*X*o+b*W*J-B*Q*J)+g*(+N*Q*J-N*X*o+L*u*o-b*u*J+b*X*c-L*Q*c)+p*(+N*X*S-N*W*J-L*u*S+B*u*J+L*W*c-B*X*c)+U*(-b*W*c-N*Q*S+N*W*o+b*u*S-B*u*o+B*Q*c)},copy:function(B){var U=this.el,C=B.el;return U[0]=C[0],U[1]=C[1],U[2]=C[2],U[3]=C[3],U[4]=C[4],U[5]=C[5],U[6]=C[6],U[7]=C[7],U[8]=C[8],U[9]=C[9],U[10]=C[10],U[11]=C[11],U[12]=C[12],U[13]=C[13],U[14]=C[14],U[15]=C[15],this},compose:function(A,M,S){var F=this.el,a=M._x,h=M._y,m=M._z,I=M._w,n=a+a,y=h+h,j=m+m,g=a*n,q=a*y,W=a*j,L=h*y,H=h*j,c=m*j,P=I*n,E=I*y,_=I*j,s=S.x,z=S.y,U=S.z;return F[0]=(1-(L+c))*s,F[1]=(q+_)*s,F[2]=(W-E)*s,F[3]=0,F[4]=(q-_)*z,F[5]=(1-(g+c))*z,F[6]=(H+P)*z,F[7]=0,F[8]=(W+E)*U,F[9]=(H-P)*U,F[10]=(1-(g+L))*U,F[11]=0,F[12]=A.x,F[13]=A.y,F[14]=A.z,F[15]=1,this},decompose:function(){var s=new Fe,E=new vh;return function(Q,I,y){var Z=this.el,Y=s.set(Z[0],Z[1],Z[2]).length(),p=s.set(Z[4],Z[5],Z[6]).length(),k=s.set(Z[8],Z[9],Z[10]).length(),h=this.determinant();0>h&&(Y=-Y),Q.x=Z[12],Q.y=Z[13],Q.z=Z[14],E.copy(this);var N=1/Y,W=1/p,F=1/k;return E.el[0]*=N,E.el[1]*=N,E.el[2]*=N,E.el[4]*=W,E.el[5]*=W,E.el[6]*=W,E.el[8]*=F,E.el[9]*=F,E.el[10]*=F,I.setFromRotationMatrix(E),y.x=Y,y.y=p,y.z=k,this}}()});var pp=B.Math.Triangle=function(u,o,i){this.a=u!==H?u:new Fe,this.b=o!==H?o:new Fe,this.c=i!==H?i:new Fe};w.assign(pp,{barycoordFromPoint:function(){var B=new Fe,J=new Fe,x=new Fe;return function(s,Z,K,k,V){B.subVectors(k,Z),J.subVectors(K,Z),x.subVectors(s,Z);var l=B.dot(B),N=B.dot(J),h=B.dot(x),w=J.dot(J),b=J.dot(x),d=l*w-N*N,q=V||new Fe;if(0===d)return q.set(-2,-1,-1);var y=1/d,D=(w*h-N*b)*y,Q=(l*b-N*h)*y;return q.set(1-D-Q,Q,D)}}()});var xk=B.Math.Euler=function(s,J,l,S,X){this.set(s,J,l,S,X)};xk.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],xk.DefaultOrder="XYZ",xk.ReverseOrder=function(g){return g=g[2]+g[1]+g[0],g.toUpperCase()},w.defineProperties(xk.prototype,{x:{get:function(){return this._x},set:function(s){this._x=s,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(J){this._y=J,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(o){this._z=o,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(c){this._order=c,this.onChangeCallback()}}}),w.assign(xk.prototype,{set:function(T,G,R,r,f){return hd(T)&&(f=R,r=G,R=T[2],G=T[1],T=T[0]),r?f&&(r=xk.ReverseOrder(r)):r="ZYX",this._x=T||0,this._y=G||0,this._z=R||0,this._order=r||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(m){return this._x=m._x,this._y=m._y,this._z=m._z,this._order=m._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,A,c){var m=B.Math.clamp,p=e.el||e,R=p[0],L=p[4],Y=p[8],x=p[1],X=p[5],D=p[9],E=p[2],q=p[6],Z=p[10];return A=A||this._order,"XYZ"===A?(this._y=Math.asin(m(Y,-1,1)),Math.abs(Y)<.99999?(this._x=Math.atan2(-D,Z),this._z=Math.atan2(-L,R)):(this._x=Math.atan2(q,X),this._z=0)):"YXZ"===A?(this._x=Math.asin(-m(D,-1,1)),Math.abs(D)<.99999?(this._y=Math.atan2(Y,Z),this._z=Math.atan2(x,X)):(this._y=Math.atan2(-E,R),this._z=0)):"ZXY"===A?(this._x=Math.asin(m(q,-1,1)),Math.abs(q)<.99999?(this._y=Math.atan2(-E,Z),this._z=Math.atan2(-L,X)):(this._y=0,this._z=Math.atan2(x,R))):"ZYX"===A?(this._y=Math.asin(-m(E,-1,1)),Math.abs(E)<.99999?(this._x=Math.atan2(q,Z),this._z=Math.atan2(x,R)):(this._x=0,this._z=Math.atan2(-L,X))):"YZX"===A?(this._z=Math.asin(m(x,-1,1)),Math.abs(x)<.99999?(this._x=Math.atan2(-D,X),this._y=Math.atan2(-E,R)):(this._x=0,this._y=Math.atan2(Y,Z))):"XZY"===A?(this._z=Math.asin(-m(L,-1,1)),Math.abs(L)<.99999?(this._x=Math.atan2(q,X),this._y=Math.atan2(Y,R)):(this._x=Math.atan2(-D,Z),this._y=0)):console.warn("unsupported order: "+A),this._order=A,c!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var _=new vh;return function(q,L,P){return _.makeRotationFromQuaternion(q),this.setFromRotationMatrix(_,L,P)}}(),setFromVector3:function(d,q){return this.set(d.x,d.y,d.z,q||this._order)},reorder:function(){var Q=new bm;return function(N){return Q.setFromEuler(this),this.setFromQuaternion(Q,N)}}(),equals:function(H){return H._x===this._x&&H._y===this._y&&H._z===this._z&&H._order===this._order},fromArray:function(J){return this._x=J[0],this._y=J[1],this._z=J[2],J[3]!==H&&(this._order=J[3]),this.onChangeCallback(),this},toArray:function(E,x){return E===H&&(E=[]),x===H&&(x=0),E[x]=this._x,E[x+1]=this._y,E[x+2]=this._z,E[x+3]=this._order,E},toVector3:function(o){return o?o.set(this._x,this._y,this._z):new Fe(this._x,this._y,this._z)},onChange:function(l){return this.onChangeCallback=l,this},onChangeCallback:function(){}});var sp={ms_ac:function(t,V){for(var D=V.ms_ac,w=0;w<D.length;w++)il(t,D[w])},ms_listener:function(D){D.addListeners=function(){for(var S=this,E=0;E<jr.length;E++){var A=jr[E];"wheel"===A&&!S.handle_wheel&&S.handle_mousewheel&&(S.handle_wheel=function(R){tb(S,R)}),S["handle_"+A]&&rk(A,S.getView(),S),!V.isTouchable&&V.mockTouch&&~function(B,s){var I;if("mousedown"===s?I="touchstart":"mouseup"===s?I="touchend":"mousemove"===s&&(I="touchmove"),B.___mockListeners||(B.___mockListeners={}),I&&!B.___mockListeners[I]){var O=function(_){_.stopPropagation(),dj(_);var N=Pg(_),G=new MouseEvent(s,{bubbles:!0,cancelable:!0,clientX:N.clientX,clientY:N.clientY,pageX:N.pageX,pageY:N.pageY});N.target.dispatchEvent(G)};B.___mockListeners[I]=O,B.addEventListener(I,O)}}(S.getView(),A)}},D.removeListeners=function(){for(var q=this,C=0;C<jr.length;C++)q["handle_"+jr[C]]&&sk(jr[C],q.getView(),q)}},ms_fire:function($){$.mp=function(n,D,G){this.addPropertyChangeListener(n,D,G)},$.ump=function(j,N){this.removePropertyChangeListener(j,N)},$.fp=function(i,v,N,O,h){return this.firePropertyChange(i,v,N,O,h)},$.addPropertyChangeListener=function(U,J,L){var k=this;k._62I||(k._62I=new Do),k._62I.add(U,J,L)},$.removePropertyChangeListener=function(r,I){this._62I&&this._62I.remove(r,I)},$.firePropertyChange=function(G,q,D,x,b){if(x){if(x(q,D))return!1}else if(q===D)return!1;var W=this,Z=b||{};return Z.property=G,Z.oldValue=q,Z.newValue=D,Z.source=W,Z.data=W,W._62I&&W._62I.fire(Z),W.onPropertyChanged&&W.onPropertyChanged(Z),!0}},ms_attr:function(t){t.a=function(k,L){var R=this;if(2===arguments.length)R.setAttr(k,L);else{if(!zh(k))return R.getAttr(k);for(var b in k)R.setAttr(b,k[b])}return R},t.getAttr=function(c,l){if(l===H&&(l=1),this._attrObject&&c in this._attrObject)return this._attrObject[c];if(this.getImage){var S=this.getImage();if(Fc(S)&&(S=Qq[S]),zh(S)&&"dataBindings"in S)for(var j=S.dataBindings,T=j.length-1;T>=0;T--){var G=j[T];if(G.attr===c){if("defaultValue"in G)return G.defaultValue;break}}}return l?O[c]:H},t.setAttr=function(o,v){var c=this;c._attrObject||(c._attrObject={});var e=c._attrObject[o];v===H?delete c._attrObject[o]:c._attrObject[o]=v,c.fp&&c.fp("a:"+o,e,v)&&c.onAttrChanged&&c.onAttrChanged(o,e,v)},t.getSerializableAttrs=function(){var C,O={};for(C in this._attrObject)O[C]=1;return O}},ms_bnb:function(m){m.getBodyColor=function(q){return q.s("body.color")},m.getBorderColor=function(R){return R.s("border.color")}},_51o:function(O){O.mi=function(S,O,$){this.addInteractorListener(S,O,$)},O.umi=function(r,t){this.removeInteractorListener(r,t)},O.fi=function(N){this.fireInteractorEvent(N)},O.addInteractorListener=function(O,H,S){var x=this;x._63I||(x._63I=new Do),x._63I.add(O,H,S)},O.removeInteractorListener=function(L,H){this._63I&&this._63I.remove(L,H)},O.fireInteractorEvent=function(e){this._63I&&this._63I.fire(e)},O.setInteractors=function(S){var U=this,x=U._interactors;x&&x.each(function(D){D.tearDown()}),hd(S)&&(S=new Mf(S)),U._interactors=S,S&&S.each(function(E){E.setUp()}),U.fp("interactors",x,S),U.invalidateSelection()},O.getInteractors=function(){return this._interactors}},_49o:function(_){_._44O=R,_._45O=R,_.getTopPainters=function(){return this._44O},_.getBottomPainters=function(){return this._45O},_.addTopPainter=function(F){var b=this;b._44O||(b._44O=new Mf),b._44O.contains(F)||(b._44O.add(F),b.redraw&&b.redraw())},_.removeTopPainter=function(F){var I=this;I._44O&&(I._44O.remove(F),I.redraw&&I.redraw())},_.addBottomPainter=function(F){var w=this;w._45O||(w._45O=new Mf),w._45O.contains(F)||(w._45O.add(F),w.redraw&&w.redraw())},_.removeBottomPainter=function(W){var n=this;n._45O&&(n._45O.remove(W),n.redraw&&n.redraw())},_._93db=function(C,j){var F=this;F._45O&&F._45O.each(function(t){t.draw?t.draw(C,j):t.call(F,C,j)
})},_._92db=function(z,F){var u=this;u._44O&&u._44O.each(function(s){s.draw?s.draw(z,F):s.call(u,z,F)})}},ms_sm:function(x){x.sm=function(){return this.getSelectionModel()},x.setSelectableFunc=function(K){this.sm().setFilterFunc(K)},x.getSelectableFunc=function(){return this.sm().getFilterFunc()},x.getSelectionModel=function(){var f=this;return f._selectionModel?f._selectionModel:f.dm().sm()},x.isSelectionModelShared=function(){return!this._selectionModel},x.setSelectionModelShared=function(S){var _=this,l=!_._selectionModel,u=_.handleSelectionChange,Q=_.dm();l!==S&&(_.invalidateSelection&&_.invalidateSelection(),S?(Q.sm().ms(u,_),_._selectionModel.ums(u,_),_._selectionModel.dispose(),_._selectionModel=R):(Q.sm().ums(u,_),_._selectionModel=new kd(Q),_._selectionModel.ms(u,_)),_.onSelectionModelSharedChanged(),_.fp("selectionModelShared",l,S))},x.onSelectionModelSharedChanged=function(){var $=this;$.redraw(),$.invalidateSelection&&$.invalidateSelection()},x.removeSelection=function(){var z=this.dm();z.beginTransaction(),this.sm().toSelection().each(z.remove,z),z.endTransaction()},x.selectAll=function(){var U=this;U.sm().ss(U.dm().toDatas(function(I){return U.isVisible(I)&&U.isSelectable(I)}))},x.isSelected=function(B){return this.sm().co(B)},x.isSelectedById=function(k){var W=this.dm().getDataById(k);return W?this.isSelected(W):!1},x.isSelectable=function(o){return this.sm().isSelectable(o)}},ms_tx:function(T){T._64I=0,T._65O=0,T.isScrollable=function(){return this.getWidth()<this._64I},T._40o=function(){return this.isScrollable()},T.getLogicalPoint=function(c){return Pd(c,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},T.tx=function(E){return E===H?this.getTranslateX():(this.setTranslateX(E),void 0)},T.getTranslateX=function(){return this._65O},T.setTranslateX=function(g){var Y=this,N=Y.getWidth()-Y._64I;N>g&&(g=N),g>0&&(g=0),g=U(g);var W=Y._65O;Y._65O=g,Y.fp(mh,W,g)}},ms_ty:function(t){t._23Q=0,t._66O=0,t._41o=function(){return this.getHeight()<this._23Q},t.getLogicalPoint=function(A){return Pd(A,this._canvas||this._view,this.tx?this.tx():0,this.ty())},t.ty=function(X){return X===H?this.getTranslateY():(this.setTranslateY(X),void 0)},t.getTranslateY=function(){return this._66O},t.setTranslateY=function(B){var l=this,o=l.getHeight()-l._23Q;o>B&&(B=o),B>0&&(B=0),B=U(B);var m=l._66O;l._66O=B,l.fp(Dm,m,B)}},ms_txy:function(E){E._65O=0,E._66O=0,E.tx=function(P){return P===H?this.getTranslateX():(this.setTranslateX(P),void 0)},E.ty=function(P){return P===H?this.getTranslateY():(this.setTranslateY(P),void 0)},E.onTranslateEnded=function(){},E.setTranslate=function(W,B,r){var X=this;if(r=Pf(r)){X._65I&&X._65I.stop(!0);var _=X.tx(),l=X.ty();r.action=function(K){X.setTranslate(_+(W-_)*K,l+(B-l)*K)},r._37o=function(){delete X._66I,delete X._65I,X.onTranslateEnded()},X._66I=1,X._65I=Pp(r)}else X.tx(W),X.ty(B)},E.getTranslateX=function(){return this._65O},E.setTranslateX=function(a){var F=this;a=F.adjustTranslateX(a);var O=F._65O;F._65O=a,F.fp(mh,O,a)},E.getTranslateY=function(){return this._66O},E.setTranslateY=function(g){var f=this;g=f.adjustTranslateY(g);var r=f._66O;f._66O=g,f.fp(Dm,r,g)},E.adjustTranslateX=function($){return U($)},E.adjustTranslateY=function(n){return U(n)},E.translate=function(o,e,M){this.setTranslate(this.tx()+o,this.ty()+e,M)},E.getLogicalPoint=function(N){var Q=this;return Pd(N,this._canvas||Q._view,Q.tx(),Q.ty())}},ms_dm:function(T){T.dm=function(o){return o?(this.setDataModel(o),void 0):this.getDataModel()},T.getDataModel=function(){return this._dataModel}},ms_lp:function(s){s.lp=function(Y){return this.getLogicalPoint(Y)}},ms_v:function(q){q._disabled=!1,q.setDisabled=function(N,T){var f=this,E=f._disabled;E!==N&&(E&&(hb(f._63O),delete f._63O),N&&(ub(f._view,f._63O=Pq(T)),f.iv()),f._disabled=N,f.fp("disabled",E,N))},q.isDisabled=function(){return this._disabled},q.getDisabledDiv=function(){return this._63O},q.getView=function(){return this._view},q.addToDOM=function(m){var e=this,K=e.getView(),a=K.style;m=m||N.body,m.appendChild(K),a.left="0",a.right="0",a.top="0",a.bottom="0",h(M,"resize",function(){e.iv()}),e.iv()},q.getWidth=function(){return this._view.clientWidth},q.getHeight=function(){return this._view.clientHeight},q.setWidth=function(c){var Y=this;Y._view.style.width=c+bg,Y.iv(),Y.fp&&Y.fp(ok,R,c)},q.setHeight=function(Q){var m=this;m._view.style.height=Q+bg,m.iv(),m.fp&&m.fp(Sh,R,Q)},q.setFocus=function(K){var T=this,u=T._currentEditor;return K&&u&&(u.getView&&(u=u.getView()),u.contains(K.target))?!1:(Pm(T._view),T.endEditing&&T.endEditing(),T.fireViewEvent("focus"),!0)},q.iv=function(f){this.invalidate(f)},q.invalidate=function(f){var F=this;F._68I||(F._68I=1,Ue(F.validate,F,R,f),F.onInvalidated&&F.onInvalidated(),F.fireViewEvent("invalidate"))},q.validate=function(){var s=this,D=s._view;if(s._68I&&(delete s._68I,D.parentNode))if(0===D.offsetWidth&&0===D.offsetHeight&&s._67I!==R)s._67I===H&&(s._67I=V.reinvalidateCount),s._67I>0?s._67I--:s._67I=R,s.iv();else{s.fireViewEvent("beginValidate"),s.validateImpl(),s.onValidated&&s.onValidated(),s.fireViewEvent("validate");var _=s._63O;_&&(D.lastChild!==_&&(hb(_),ub(D,_)),nd(_,0,0,s.getWidth(),s.getHeight())),Vq(s),ek(s),Qi(s)}},q.layout=function(Z,l,G,O){1===arguments.length?nd(this,Z):nd(this,Z,l,G,O)},q.addViewListener=function(Q,c,J){var G=this;G._67O||(G._67O=new Do),G._67O.add(Q,c,J)},q.removeViewListener=function(b,l){this._67O.remove(b,l)},q.fireViewEvent=function(k){var F=this;F._67O&&(Fc(k)&&(k={kind:k}),F._67O.fire(k)),V.viewListener&&V.viewListener(F,k)}},ms_tip:function(p){p.setToolTipEnabled=function(l){var D=this;l?Kq||D._13o||(D.enableToolTip(),D.fp("toolTipEnabled",!1,!0)):D._13o&&(D.disableToolTip(),D.fp("toolTipEnabled",!0,!1))},p.isToolTipEnabled=function(){return!!this._13o},p.enableToolTip=function(){var e=this;if(!Kq&&!e._13o){e._13o=function(Y){var I=e.getToolTip(Y);I!=R?V.toolTipContinual&&V.isToolTipShowing()?Td(Y,I):(Ak(),hj={timeout:_(nf,Zp),e:Y,info:I}):Ak()};var Q=e.getView();h(Q,dl,e._13o),h(Q,"mouseleave",V.hideToolTip)}},p.disableToolTip=function(){var B=this;if(B._13o){var Y=B.getView();Q(Y,dl,B._13o),Q(Y,"mouseleave",V.hideToolTip),delete B._13o}},p.getToolTip=function(e){var b=this;if(b.getDataAt){var L=b.getDataAt(e);return L?L.getToolTip():R}return b.getValue?b.getValue():void 0}},_52o:function(G){G._zoom=1,G._29I=kl,G.zoomIn=function(y,K){this.setZoom(this._zoom*sq,y,K)},G.zoomOut=function(e,u){this.setZoom(this._zoom/sq,e,u)},G.zoomReset=function(O,v){this.setZoom(1,O,v)},G.scrollZoomIn=function(g){this.setZoom(this._zoom*kb,R,g)},G.scrollZoomOut=function(Z){this.setZoom(this._zoom/kb,R,Z)},G.pinchZoomIn=function(S){this.setZoom(this._zoom*qs,R,S)},G.pinchZoomOut=function(s){this.setZoom(this._zoom/qs,R,s)},G.adjustZoom=function(X){return Sr>X?Sr:X>Qp?Qp:X},G.getZoom=function(){return this._zoom},G.setZoom=function(u,b,F){var K=this;if(b=Pf(b)){K._14o&&K._14o.stop(!0);var P=K._zoom;b.action=function(e){K._96O(P+(u-P)*e,F)},b._37o=function(){delete K._zooming,delete K._14o,K.onZoomEnded()},K._zooming=1,K._14o=Pp(b)}else K._96O(u,F)},G._96O=function(W,v){var G=this;if(W=G.adjustZoom(W),W!==G._zoom){G.validate();var $=G._29I,F=G._zoom;0!==$.width&&0!==$.height&&(v=v?v:{x:$.x+$.width/2,y:$.y+$.height/2},G.tx((v.x-$.x)*F-v.x*W),G.ty((v.y-$.y)*F-v.y*W)),G._zoom=W,G.fp("zoom",F,W)}}},ms_edge:function(F){F._2I=function(c){var O=this;O._44I||(O._44I=new Mf),O._42I||(O._42I=new Mf),O._44I.add(c),O._42I.add(c),O._20I()},F._4I=function(U){var K=this;K._44I||(K._44I=new Mf),K._43I||(K._43I=new Mf),K._44I.add(U),K._43I.add(U),K._20I()},F._16I=function(g){var t=this;t._44I.remove(g),t._42I.remove(g),t._44I.isEmpty()&&delete t._44I,t._42I.isEmpty()&&delete t._42I,t._20I()},F._18I=function(x){var N=this;N._44I.remove(x),N._43I.remove(x),N._44I.isEmpty()&&delete N._44I,N._43I.isEmpty()&&delete N._43I,N._20I()},F._20I=function(){var E=this;if(delete E._45I,!E._44I||E._44I.isEmpty())return delete E._70O,void 0;var J;E._44I.each(function(B){B.isLooped()&&(J||(J={}),J[B._id]||(E._45I||(E._45I=new Mf),E._45I.add(B),J[B._id]=B))}),J?(E._70O=new Mf,E._44I.each(function(I){J[I._id]?"A"===J[I._id]||(J[I._id]="A",E._70O.add(I)):E._70O.add(I)})):E._70O=E._44I},F.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},F.getSourceAgentEdges=function(){return this._46I},F.getTargetAgentEdges=function(){return this._47I},F._1I=function(e){var B=this;B._46I||(B._46I=new Mf),B._48I||(B._48I=new Mf),B._46I.add(e),B._48I.add(e),B._19I()},F._3I=function(O){var $=this;$._47I||($._47I=new Mf),$._48I||($._48I=new Mf),$._47I.add(O),$._48I.add(O),$._19I()},F._15I=function(s){var c=this;c._46I.remove(s),c._48I.remove(s),c._46I.isEmpty()&&delete c._46I,c._48I.isEmpty()&&delete c._48I,c._19I()},F._17I=function(W){var q=this;q._47I.remove(W),q._48I.remove(W),q._47I.isEmpty()&&delete q._47I,q._48I.isEmpty()&&delete q._48I,q._19I()},F._19I=function(){var J=this;delete J._49I;var P=J._48I;if(P&&!P.isEmpty()){var o={};P.each(function(U){o[U._id]?J._49I||(J._49I=new Mf):o[U._id]=U}),J._49I?P.each(function(T){o[T._id]&&(J._49I.add(T),delete o[T._id])}):J._49I=P}},F.getLoopedEdges=function(){return this._45I},F.getEdges=function(){return this._70O},F.getAgentEdges=function(){return this._49I},F.getSourceEdges=function(){return this._42I},F.getTargetEdges=function(){return this._43I},F._8I=function(){this._70O&&this._70O.each(function(y){y._7I()})}}};vl(V,{getVersion:function(){return"7.0.8"}},!0),vl(V,{numberDigits:5,crossOrigin:"",baseZIndex:H,isTouchable:Kq,devicePixelRatio:M.devicePixelRatio?M.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:z.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Lh},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],encodeStringKey:null,doubleClickRange:Kq?20:1,animDuration:200,animEasing:function(s){return s*s},labelColor:em,labelSelectColor:yn,labelFont:"12px arial, sans-serif",widgetIndent:Kq?30:20,widgetRowHeight:Kq?30:20,widgetHeaderHeight:Kq?32:22,widgetTitleHeight:Kq?34:24,scrollBarColor:jf,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Kq?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:uo,intersectionLineLine:Xe,isEnter:Zl,isEsc:Fj,isDelete:am,isSpace:aj,isLeft:Pn,isUp:Mg,isRight:zn,isDown:Xd,getTarget:Bf,isString:Fc,isNumber:Ff,isBoolean:Ll,isArray:hd,isSelectAll:rd,isFunction:xj,isObject:zh,getPropertyValue:Nl,setPropertyValue:fs,addMethod:vl,isMobile:function(){var B;return function(){return B!==H?B:(B=!1,function(l){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(l)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(l.substr(0,4)))&&(B=!0)}(navigator.userAgent||navigator.vendor||M.opera),B)}}(),createGradient:function(A,y,X,C,j,M,R,V){var l=rf[y];return l(A,X,C,j,M,R,V)},appendToScreen:function(w){w=w.getView?w.getView():w,(N.fullscreenElement||N.mozFullScreenElement||N.webkitFullscreenElement||N.msFullscreenElement||N.body).appendChild(w)},encodeString:function(i){return B.Math.encodeBase64(i,V.encodeStringKey)},decodeString:function(J){return B.Math.decodeBase64(J,V.encodeStringKey)},findView:function(l){var K=function(S,v){var o=v._ht;o&&S.push(o);var r=v.children,c=r.length;if(c)for(var U=0;c>U;U++)K(S,r[U])},f=[];K(f,N.body);var i=function(B,E){for(var I="2d"===E?gq.GraphView:pe.Graph3dView,l=0,r=B.length;r>l;l++)if(B[l]instanceof I)return f[l];return null};return"all"===l?f:"2d"===l?i(f,"2d"):"3d"===l?i(f,"3d"):i(f,"3d")||i(f,"2d")},toggleFullscreen:function(a){var q=a.getView();if(N.fullscreenElement||N.mozFullScreenElement||N.webkitFullscreenElement||N.msFullscreenElement)N.exitFullscreen?N.exitFullscreen():N.msExitFullscreen?N.msExitFullscreen():N.mozCancelFullScreen?N.mozCancelFullScreen():N.webkitExitFullscreen&&N.webkitExitFullscreen();else{var c=!0;if(a.isSelfViewEvent){var R=a.getX(),D=a.getY(),l=a.getWidth(),V=a.getHeight(),t=q.style.background,r=q.style.backgroundColor;t||r||(q.style.backgroundColor="white"),q.requestFullscreen?q.requestFullscreen():q.msRequestFullscreen?q.msRequestFullscreen():q.mozRequestFullScreen?q.mozRequestFullScreen():q.webkitRequestFullscreen&&q.webkitRequestFullscreen();var m=setInterval(function(){if(q!==(N.fullscreenElement||N.mozFullScreenElement||N.webkitFullscreenElement||N.msFullscreenElement))clearInterval(m),a.setX(R),a.setY(D),a.setWidth(l),a.setHeight(V),a._fullscreen=!1,q.style.oldBackgroundColor=r,a.iv();else{var k=B.Default.getWindowInfo();(c||k.width!==a.getWidth()||k.height!==a.getHeight())&&(a.setX(k.left),a.setY(k.top),a.setWidth(k.width),a.setHeight(k.height),a._fullscreen=!0,a.iv(),c=!1)}},500)}else{var j=q.style.left,x=q.style.top,l=q.style.width,V=q.style.height,t=q.style.background,r=q.style.backgroundColor;t||r||(q.style.backgroundColor="white"),q.requestFullscreen?q.requestFullscreen():q.msRequestFullscreen?q.msRequestFullscreen():q.mozRequestFullScreen?q.mozRequestFullScreen():q.webkitRequestFullscreen&&q.webkitRequestFullscreen();var m=setInterval(function(){if(q!==(N.fullscreenElement||N.mozFullScreenElement||N.webkitFullscreenElement||N.msFullscreenElement))clearInterval(m),q.style.left=j,q.style.top=x,q.style.width=l,q.style.height=V,q.style.oldBackgroundColor=r,a.iv();else{var z=B.Default.getWindowInfo();(c||z.width!==a.getWidth()||z.height!==a.getHeight())&&(nd(a),c=!1)}},500)}}},appendTimeStamp:function(k){return k},setCompType:function(M,H){xj(H)||zh(H)?di[M]=H:_e(M)},getCompType:function(w){var B=di[w];return B===H&&ks.test(w)&&_e(w),B},getCompTypeMap:function(){return di},drawCompType:function(v,j,B,F,m,D){v(j,B,F,m,D)},numberListener:function(){var F={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(v){var z=v.keyCode;F[z]||65===z&&V.isCtrlDown(v)||86===z&&V.isCtrlDown(v)||67===z&&V.isCtrlDown(v)||88===z&&V.isCtrlDown(v)||z>=35&&40>=z||(v.shiftKey||48>z||z>57)&&(96>z||z>105)&&v.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(h){var G=h.target.tagName;("DIV"===G||"CANVAS"===G)&&!(V.ignoreKeyCodes.indexOf(h.keyCode)>=0)&&("keydown"!==h.type||Pn(h)||zn(h)||Mg(h)||Xd(h)||am(h)||65===h.keyCode&&(h.metaKey||h.ctrlKey))&&(h.preventDefault(),h.preventManipulation&&h.preventManipulation())},getWindowInfo:function(){var R=N.documentElement,V=R&&(R.scrollLeft||R.scrollTop)?R:N.body;return{target:V,left:V.scrollLeft,top:V.scrollTop,width:M.innerWidth||V.clientWidth,height:M.innerHeight||V.clientHeight}},isDragging:function(){return!!Lh},isLeftButton:function(u){return Kq?!0:0===u.button},isMiddleButton:function(i){return Kq?!1:i&&(1===i.button||4&(i.buttons||0))},isRightButton:function(a){return Kq?!1:a&&(2===a.button||2&(a.buttons||0))},isInput:function(X){if(!X)return!1;var _=X.tagName;return"INPUT"===_||"TEXTAREA"===_||"SELECT"===_},getTouchCount:function(R){return Kq?R.touches.length:1},isDoubleClick:function(){function X(l){l.details=0,l.timeout=null,l.lastPoint=null}var E={};return sc=new r,bo=sc.getTime(),function(r){if(r.touches&&r.touches.length>1)return!1;var a=r.button==R?"":r.button,C=r.type+a,u=C+"_isDoubleClick",F=E[C];if(F||(F=E[C]={details:0,timeout:null,lastPoint:null}),r[u]===H){r[u]=!0;var Z=zr(r);F.timeout&&(l(F.timeout),F.timeout=null),F.lastPoint&&Wj(F.lastPoint,Z)>V.doubleClickRange&&X(F),F.lastPoint=Z,F.details++,F.timeout=_(function(){X(this)}.bind(F),500)}return 2===F.details}}(),isShiftDown:function(u){return u?u.shiftKey:Rr["16"]},isCtrlDown:function(c){return c?Il?c.metaKey:c.ctrlKey:Il?Rr["91"]:Rr["17"]},getClientPoint:function(d){return Kq&&(d=Pg(d)),{x:d.clientX,y:d.clientY}},isMouseEvent:function(Q){return Q instanceof MouseEvent||0===Q.type.indexOf("mouse")},getTargetElement:function(d){if(V.isMouseEvent(d)||!N.elementFromPoint)return d.target;var e=Sp(d);return N.elementFromPoint(e.x,e.y)},getPagePoint:function(h){return Kq&&(h=Pg(h)),{x:h.pageX,y:h.pageY}},createObject:function(M,H){var b=new M;for(var C in H){var x=H[C];if(xj(x))b[C]=x;else if(0===C.indexOf("s:"))b.s(C.substr(2),H[C]);else if(0===C.indexOf("a:"))b.a(C.substr(2),H[C]);else{var V=Xr(C),x=H[C];b[V]?(b[V](x),"setToolTip"===V&&b.enableToolTip&&b.enableToolTip()):b[C]=x}}return b},setImage:function(m,S,F,a){var T=arguments.length;4===T?Gc(m,a,S,F):2===T?Fc(S)?Gc(m,S):gc(m,S):1===T&&Gc(m,m)},getImage:function(W,L,e){var y;if(W==R)return R;if(zh(W)?y=W:(y=Qq[W],W&&y===H&&(Ng&&Ng[W]||Gc(W,W))),L&&y&&y.tagName){var B;B="override"===e?"colors_override":"override_rgb"===e?"colors_override_rgb":"override_a"===e?"colors_override_a":"colors",y[B]||(y[B]={__count__:0});var c=y[B][L];return c||(y[B].__count__>V.imageCacheThreshold&&(y[B]={__count__:0}),c=Uf(y,Rb(L),y.width,y.height,e),y[B][L]=c,y[B].__count__++),c}return y},isImageComplete:function(R,M,I){var N=Tn(R);if(!N)return!1;if(N.tagName)return N.complete;for(var k,R,b,A=N.comps,a=!0,Q=0,u=A.length;u>Q;Q++)if(k=A[Q],b=k.type,"image"===k.type){R=k.name,R&&R.func&&(R=ie(R,M));var i=Hl(R,M,I);if(!i){a=!1;break}}else if(ks.test(b)&&V.getCompType(b)===H){a=!1,_e(b);break}return a},getId:function(){var Q=1;return function(){return++Q}}(),callLater:function(u,I,R,d){var X=function(){u.apply(I,R)};return d?_(X,d):M.requestAnimationFrame(X)},cancelLater:function(a,f){f?l(a):M.cancelAnimationFrame(a)},clone:function(O){if(null==O||"object"!=typeof O)return O;if(O instanceof Date){var F=new Date;return F.setTime(O.getTime()),F}if(O instanceof Array){for(var F=[],e=0,v=O.length;v>e;e++)F[e]=er(O[e]);return F}if(O instanceof Mf){for(var F=new Mf,e=0,v=O.length;v>e;e++)F.set(e,er(O.get(e)));return F}if(O instanceof uc)return O;if(O instanceof w){var F={};for(var X in O)O.hasOwnProperty(X)&&(F[X]=er(O[X]));return F}return O},callWhenLoaded:function(E,x){x=x||100;var R=rn(E,x);oe||(oe={}),oe[R]={tick:R,cb:E,delay:x}},beforeLoadURL:function(A,I){if(oe){var P={};for(var I in oe){var U=oe[I];l(U.tick);var k=rn(U.cb,U.delay);P[k]={tick:k,delay:U.delay,cb:U.cb}}oe=P}return V.convertURL?V.convertURL(A,I):A},convertURL:function(x){return x},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return V.getImage("default_blank")},resizeImagePOT:function(d,U){if(!d||!d.tagName)return d;var a=d.width,A=d.height;if(!a||!A)return d;if(Wm.isPOT(a)&&Wm.isPOT(A)&&(!U||a===A))return d;var u,J;U?J=u=Wm.nearestPOT(Math.min(a,A)):(u=Wm.nearestPOT(a),J=Wm.nearestPOT(A));var n=ae(),Y=n.getContext("2d");return Pb(n,u,J,1),Y.drawImage(d,0,0,a,A,0,0,u,J),n},sortFunc:function(V,a){if(V===a)return 0;if(V==R&&a!=R)return 1;if(V!=R&&a==R)return-1;if(V==R&&a==R)return 0;var k,A=typeof V,$=typeof a;return A===af&&$===af?k=V.localeCompare(a):A===Ki&&$===Ki&&(k=V-a),k===H&&(k=(""+V).localeCompare(""+a)),k>0?1:0>k?-1:0},getClassMap:function(){return Hn},getClass:function(D){if(Fc(D)){var u,n=Hn[D];if(!n){u=D.split("."),n=M;for(var C=0;C<u.length;C++)n=n[u[C]];Hn[D]=n}return n}return D},def:function(Y,n,K){var L,V,H,c=function(){};if(c.prototype=n.prototype,L=new c,Fc(Y)){if(Hn[Y])throw"'"+Y+"' already defined";H=fk(Y),L.getClassName=function(){return Y}}else H=Y;if(L.constructor=H,L.getClass=function(){return H},L.getSuperClass=function(){return n},K)for(V in K)sp[V]&&sp.hasOwnProperty(V)?sp[V](L,K):fr(L,K,V);H.prototype=L,H.superClass=n.prototype},startAnim:function(){var u=function(V){V.duration&&(V.startTime=Qm()),V.timeId=Ue(V.tick,R,R,V.interval)};return function(c){return c=er(c),c.easing=c.easing||V.animEasing,c.duration||c.frames||(c.duration=V.animDuration),c.t=0,c.duration?c.interval=0:(c.frame=0,c.interval=c.interval||10),c.tick=function(){if(c.duration){var Y=(Qm()-c.startTime)/c.duration;if(Y>1&&(Y=1),c.t=Y,c.action(c.easing(Y),Y),!c.isRunning())return;1===Y?c.stop():c._isPaused||(c.timeId=Ue(c.tick))}else{if(c.frame++,Y=c.t=c.frame/c.frames,c.action(c.easing(Y),Y),!c.isRunning())return;c.frame<c.frames?c._isPaused||(c.timeId=Ue(c.tick,R,R,c.interval)):c.stop()}},c.resume=function(){c._isPaused&&(delete c._isPaused,c.duration?c.t<1&&(c.startTime=Qm()-c.duration*c.t,c.timeId=Ue(c.tick)):c.frame<c.frames&&(c.timeId=Ue(c.tick,R,R,c.interval)))},c.pause=function(){xl(c.timeId,!c.duration),c._isPaused=!0},c.isPaused=function(){return this._isPaused},c.stop=function(i){c.isRunning()&&(xl(c.timeId,!c.duration),delete c.timeId,c.duration?c.t<1&&i&&(c.t=1,c.action(c.easing(1),1)):c.frame<c.frames&&i&&(c.frame=c.frames,c.action(c.easing(1),1)),c._37o&&c._37o(),c.finishFunc&&c.finishFunc())},c.isRunning=function(){return c.timeId!=R},c.delay?Ue(u,R,[c],c.delay):u(c),c}}(),getTextSize:function(){var j={},c=N?ae().getContext("2d"):R;return function(g,X){c.font=g?g:Op;var R=j[c.font];return R||(R=2*c.measureText("e").width+4,j[c.font]=R),{width:c.measureText(X).width+4,height:R}}}(),drawText:function(g,P,i,Q,y,C,j,r,q,V){if(P!=R){var T=Cb(i,P),k={};k.y=V&&V!==Wf?V===gf?C+T.height/2:C+r-T.height/2:C+r/2,k.x=q&&q!==_c?q===vk?y+j-T.width/2:y+j/2:y+T.width/2,zi(g,P,k,i,Q)}},getDistance:function(A,J){var V=A.length;return J?3===V?y(X(A[0]-J[0])+X(A[1]-J[1])+X(A[2]-J[2])):2===V?y(X(A[0]-J[0])+X(A[1]-J[1])):A.z===H?y(X(J.x-A.x)+X(J.y-A.y)):y(X(J.x-A.x)+X(J.y-A.y)+X(J.z-A.z)):3===V?y(X(A[0])+X(A[1])+X(A[2])):2===V?y(X(A[0])+X(A[1])):void 0},brighter:function(S,I){return 0>I&&(I=-I),gl(S,I?I:40)},darker:function(G,W){return W>0&&(W=-W),gl(G,W?W:-40)},unionPoint:function(r,p){if(!r)return R;if(2===arguments.length)return r&&p?{x:k(r.x,p.x),y:k(r.y,p.y),width:q(r.x-p.x),height:q(r.y-p.y)}:R;var v=r;if(v._as&&(v=v._as),v.length===H)return R;var f=v.length;if(0>=f)return R;for(var A=1,b=v[0],d={x:b.x,y:b.y,width:0,height:0};f>A;A++){b=v[A];var W=k(d.x,b.x),u=D(d.x+d.width,b.x),l=k(d.y,b.y),X=D(d.y+d.height,b.y);d.x=W,d.y=l,d.width=u-W,d.height=X-l}return d},unionRect:function(g,M){if(g&&!M)return er(g);if(!g&&M)return er(M);if(g&&M){var S={x:k(g.x,M.x),y:k(g.y,M.y)};return S.width=D(g.x+g.width,M.x+M.width)-S.x,S.height=D(g.y+g.height,M.y+M.height)-S.y,S}return R},containsPoint:function(X,g,c,P){if(P!=R&&1!==P){var M=X.x+X.width/2,h=X.y+X.height/2;X={x:M-X.width/2*P,y:h-X.height/2*P,width:X.width*P,height:X.height*P}}if(c){var _=X.width/2,Z=X.height/2,u=n(-c),l=i(-c),p=g.x-X.x-_,D=g.y-X.y-Z;return g={x:l*p-u*D,y:u*p+l*D},Sm({x:-_,y:-Z,width:X.width,height:X.height},g)}return!(!X||g.x<X.x||g.y<X.y||g.x>X.x+X.width||g.y>X.y+X.height)},containsRect:function(u,R){if(!u||!R)return!1;var v=R.x,Z=R.y,Y=R.width,$=R.height,V=u.width,f=u.height;if(0>(V|f|Y|$))return!1;var t=u.x,w=u.y;if(t>v||w>Z)return!1;if(V+=t,Y+=v,v>=Y){if(V>=t||Y>V)return!1}else if(V>=t&&Y>V)return!1;if(f+=w,$+=Z,Z>=$){if(f>=w||$>f)return!1}else if(f>=w&&$>f)return!1;return!0},intersectsRect:function(G,H){if(!G||!H)return!1;var N=H.width,W=H.height,h=G.width,v=G.height;if(0>=h||0>=v||0>=N||0>=W)return!1;var S=H.x,P=H.y,z=G.x,m=G.y;return h+=z,v+=m,N+=S,W+=P,h>S&&v>P&&N>z&&W>m},intersection:function(x,Z){if(!x||!Z)return R;var h=Z.x,_=Z.y,D=x.x,L=x.y,J=h,o=_,p=D,Q=L;return J+=Z.width,o+=Z.height,p+=x.width,Q+=x.height,D>h&&(h=D),L>_&&(_=L),J>p&&(J=p),o>Q&&(o=Q),J-=h,o-=_,0>=J||0>=o?R:{x:h,y:_,width:J,height:o}},grow:function(y,t,P){P===H&&(P=t),y.x-=t,y.y-=P,y.width=y.width+2*t,y.height=y.height+2*P},getScreenPoint:function(b,B,h,R,M,T,F){var v=h.getBoundingClientRect(),n=b*(T||1)-h.scrollLeft+(R||0),C=B*(F||1)-h.scrollTop+(M||0),H=gp(h,!1);if(H){var l=new Fe(n,C,0);return l.applyMatrix4(H),console.log(l),{x:l.x,y:l.y}}return{x:n+v.left,y:C+v.top}},getLogicalPoint:function(d,J,s,c,Q,M){var E,D,L=J.getBoundingClientRect();d.target?(Uc(d)?Il?Rr["91"]=!0:Rr["17"]=!0:Il?Rr["91"]=!1:Rr["17"]=!1,Rr["16"]=Vf(d)?!0:!1,d=Kq?Pg(d):d,E=d.clientX,D=d.clientY):(E=d.x,D=d.y);var N=gp(J,!0);if(N){var W=new Fe(E,D,0);W.applyMatrix4(N);do{if(Math.abs(W.z)<=1e-6)break;var o=new Fe(E,D,1);if(o.applyMatrix4(matrix),Math.abs(o.z)<=1e-6){W=o;break}if(o.sub(W),Math.abs(o.z)<=1e-6)break;W.addScaledVector(o,-W.z/o.z)}while(!1);return{x:(W.x+J.scrollLeft-(s||0))/(Q||1),y:(W.y+J.scrollTop-(c||0))/(M||1)}}return{x:(E-L.left+J.scrollLeft-(s||0))/(Q||1),y:(D-L.top+J.scrollTop-(c||0))/(M||1)}},removeHTML:function(){var M;return function(G){return G&&G.getView&&(G=G.getView()),G&&G.parentNode?M===G?!0:(M=G,G.parentNode.removeChild(G),M=R,!0):!1}}(),getToolTipDiv:function(){if(!Ao){Ao=Fb(),wq=Fb();var A=Ao.style;V.baseZIndex!=R&&(A.zIndex=L(V.baseZIndex)+3+""),A.whiteSpace="nowrap",A.color=V.toolTipLabelColor,A.background=V.toolTipBackground,A.font=V.toolTipLabelFont,A.padding="5px",A.boxShadow="0px 0px 3px "+V.toolTipShadowColor}return Ao},isToolTipShowing:function(){return Ao&&Ao.parentNode?!0:wq&&wq.parentNode?!0:!1},hideToolTip:function(){hb(Ao),hb(wq),Gk()},showToolTip:function(P,_){if(!P||_==R)return Ak(),void 0;V.getToolTipDiv();var M,x;if(_.html?(_=_.html,M=wq,hb(Ao)):(M=Ao,hb(wq)),x=M.style,M.innerHTML=_,M.parentNode||B.Default.appendToScreen(M),P.target){P=Sp(P);var F=rl(),L=P.x,c=P.y,m=Kq?60:12;if(Kq){var g=M.getBoundingClientRect();x.left=L-g.width/2+bg,x.top=c-g.height-m<F.top?c+m+bg:c-g.height-m+bg}else{x.left=L+m+bg,x.top=c+m+bg;var g=M.getBoundingClientRect();g.left+g.width>F.width&&(x.left=L-m-g.width+bg),g.top+g.height>F.height&&(x.top=c-m-g.height+bg),g.left<0&&(x.left=L+m+bg),g.top<0&&(x.top=c+m+bg)}}else x.left=P.x+bg,x.top=P.y+bg;Gk()},startDragging:function(L,R,S){S==H&&(S=!0),L!==Lh&&(Lh?S&&(Kq?Lh.handleWindowTouchEnd(R):Lh.handleWindowMouseUp(R)):Kq?(h(M,dq,hn),h(M,zj,ud)):(h(M,dl,Kb),h(M,Ml,an)),Lh=L)},getImageMap:function(){return Qq},toBoundaries:function(s,N,E,X){var L=[];return ed(s,N,E,X).forEach(function(w){var h=[];w.forEach(function(O){h.push(O.x,O.y)}),L.push(h)}),L},getCurrentKeyCodeMap:function(){return Rr},drawCenterImage:function(K,R,S,M,w,Q,q,V){!w&&Q&&Q.isSelfViewEvent&&(w=Q);var l=gs(R,w,Q),o=rr(R,w,Q);Fq(K,R,U(S-l/2),U(M-o/2),l,o,w,Q,q,V)},drawStretchImage:function(u,e,i,E,N,a,s,x,O,B,C,t){!x&&O&&O.isSelfViewEvent&&(x=O);var h,J=gs(e,x,O,a),c=rr(e,x,O,s);"uniform"===i?(h=k(a/J,s/c),J*=h,c*=h,E+=U((a-J)/2),N+=U((s-c)/2),a=J,s=c):"centerUniform"===i&&((J>a||c>s)&&(h=k(a/J,s/c),J*=h,c*=h),E+=U((a-J)/2),N+=U((s-c)/2),a=J,s=c);var n=u.interactiveInfo;if(n){var v;if(v="center"===i?{x:E+a/2-J/2,y:N+s/2-c/2,width:J,height:c}:{x:E,y:N,width:a,height:s},n.rect){var g=n.compInfos,T=g.length;T&&(g[T-1].rect.image=e)}else n.rect=v}if("center"===i){var K=C!==!1&&(J>a||c>s);K&&(u.save(),u.beginPath(),u.rect(E,N,a,s),u.clip()),Fq(u,e,E+a/2-J/2,N+s/2-c/2,J,c,x,O,B,t),K&&u.restore()}else Fq(u,e,E,N,a,s,x,O,B,t)},toCanvas:function(v,I,X,N,q,F,D,e,T){v=Tn(v,D),I=I||gs(v,q),X=X||rr(v,q);var c=ae(),M=mr(c);return e?(Pb(c,I,X,e),M.scale(e,e)):Pb(c,I,X,1),Lf(M,v,N,0,0,I,X,q,F,D,T),v&&v.clampToEdge&&(c.clampToEdge=v.clampToEdge),M.restore(),c},toGrayColor:function(z){if(!z)return z;var x=Dc(z),n=U(.299*x[0]+.587*x[1]+.114*x[2]);return"rgba("+n+","+n+","+n+","+x[3]/255+")"},createGradientImage:function(F,G,q,p){for(var S=["L",0,0,F,0,1,0,0,1,0,0],h=0,J=Math.min(G.length,q.length);J>h;h++)S.push(q[h],G[h]);var V=B.Default.toCanvas({width:F,height:F,clampToEdge:!0,comps:[{type:"shape",rotation:p||0,points:[0,0,F,0,F,F,0,F],background:"#ffffff",gradientPack:S}]});return V},createElement:function(D,t,E,y){var k=N.createElement(D);return ai(k,t||z.widgetBorder,2),k.style.font=E?E:Op,y!=R&&(k.value=y),V.onElementCreated&&V.onElementCreated(k),k},containedInView:function(M,J){var Y=dc(J).getBoundingClientRect();return Sm({x:Y.left,y:Y.top,width:Y.width,height:Y.height},zr(M))},isIsolating:function(){return Om>0},setIsolating:function(g){g?Om++:Om--},getMSMap:function(){return sp},stringify:function(x,h,r){var D=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var f=JSON.stringify(x,function(i,g){return"function"==typeof g?"__ht__"+(g.__ht__||g.toString()):Ff(g)?Bg(g):g instanceof B.List?"__ht__list"+(g.__ht__list||V.stringify(g._as)):g},h==R?2:h);return Date.prototype.toJSON=D,r&&(f="__ht__encode"+V.encodeString(f)),f},parse:function(x){return Fc(x)?"__ht__encode"!=x.substr(0,12)||(x=V.decodeString(x.substr(12)),Fc(x))?JSON.parse(x,function(j,$){if(Fc($))if("__ht__function"==$.substr(0,14)){var m=$.indexOf("{")+1,X=$.lastIndexOf("}"),k=$.indexOf("(")+1,M=$.indexOf(")");if(m&&X&&k&&M){var w=new Function($.substring(k,M),$.substring(m,X));return w.__ht__=$.substr(6),w}}else{if("__ht__date"==$.substr(0,10))return new Date(L($.substr(10)));if("__ht__list"===$.substr(0,10))return new Mf(V.parse($.substr(10)))}return $}):x:x},loadJS:function(I,n){n&&I.push(n);var b=I.shift();if(hd(b))I=b.contact(I),V.loadJS(I);else if(xj(b))b(),V.loadJS(I);else if(Fc(b)){var Y=N.createElement("script");Y.onload=function(){V.loadJS(I)},Y.setAttribute("src",b),N.getElementsByTagName("head")[0].appendChild(Y)}else I.length&&V.loadJS(I)},extendClass:function(L,z){var o=L.prototype;for(var W in z)sp[W]&&sp.hasOwnProperty(W)?sp[W](o,z):o[W]=z[W]},toRoundedCorner:function(){function s(p,V,_){p.x=V.x,p.y=V.e||_,p.z=V.y}var V=new Fe,Q=new Fe,R=new Fe,J=new Fe;return function(N,O){var x,v=0;N.getPoints&&(v=N.getElevation(),N=N.getPoints()),x=N instanceof Mf?N:new Mf(N);var A=x.size();if(0>=O)return{points:x};var z=new Mf,c=new Mf,r=x.get(0);s(V,r,v),z.add(r),c.add(1);for(var W=1;A>W;W++)if(A>W+1){var Y=x.get(W),w=x.get(W+1);s(Q,Y,v),s(R,w,v),J.subVectors(V,Q).setLength(Math.min(.99*J.length(),O)).add(Q),Y.e!==H||r.e!==H?z.add({x:J.x,y:J.z,e:J.y}):z.add({x:J.x,y:J.z}),z.add(Y),J.subVectors(R,Q).setLength(Math.min(.99*J.length(),O)).add(Q),Y.e!==H||w.e!==H?z.add(r={x:J.x,y:J.z,e:J.y}):z.add(r={x:J.x,y:J.z}),V.copy(J),c.addAll([2,3])}else z.add(x.get(W)),c.add(2);return{points:z,segments:c}}}(),toColorData:Dc,setCanvas:Pb,createDiv:Fb,createDisabledDiv:Pq,createView:wn,createCanvas:ae,appendChild:ub,initContext:mr,checkLoadingImage:Vq,translateAndScale:Up,layout:nd,getPosition:Ph,drawPoints:ko,drawRoundRect:jc,drawBorder:sb,setFocus:Pm,getter:Kp,setter:Xr,isEmptyObject:bn,cameraPriority:function(){var C={skybox:0,main:1e4,top:1e7};return w.seal(w.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return C.skybox
},set:function(B){if(B>=C.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");C.skybox=Number(B)}},main:{configurable:!1,enumerable:!1,get:function(){return C.main},set:function(L){if(L<=C.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(L>=C.top)throw new RangeError("Main camera must have lower priority than the top camera.");C.main=Number(L)}},top:{configurable:!1,enumerable:!1,get:function(){return C.top},set:function(H){if(H<=C.main)throw new RangeError("Top camera must have higher priority than the main camera.");C.top=Number(H)}}}))}()},!0),vl(x,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Aq=V.disabledOpacity,Zp=V.toolTipDelay,qm=V.devicePixelRatio,Mi=V.autoMakeVisible,kc=V.autoHideScrollBar,Kn=V.imageGradient,Td=V.showToolTip,Ak=V.hideToolTip,_o=V.dashPattern,lk=V.lineCap,li=V.lineJoin,os=V.labelColor,Qh=V.labelSelectColor,Op=V.labelFont,Co=V.widgetIndent,Cj=V.widgetRowHeight,Nn=V.widgetHeaderHeight,_k=V.widgetTitleHeight,vi=V.scrollBarColor,Tf=V.scrollBarSize,$m=V.scrollBarTimeout,tp=V.scrollBarMinLength,jj=V.scrollBarInteractiveSize,sq=V.zoomIncrement,kb=V.scrollZoomIncrement,qs=V.pinchZoomIncrement,Qp=V.zoomMax,Sr=V.zoomMin,$p=V.createObject,dj=V.preventDefault,bc=V.setImage,Tn=V.getImage,Hl=V.isImageComplete,Lo=V.drawCenterImage,Lf=V.drawStretchImage,Gq=V.getId,Ue=V.callLater,xl=V.cancelLater,ip=V.sortFunc,er=V.clone,fk=V.getClass,Pp=V.startAnim,ap=V.brighter,Xl=V.darker,Dq=V.drawText,Cb=V.getTextSize,Ih=V.isLeftButton,tm=V.isMiddleButton,Qj=V.isRightButton,tk=V.getTouchCount,lb=V.isDoubleClick,Vf=V.isShiftDown,Uc=V.isCtrlDown,zr=V.getClientPoint,Sp=V.getPagePoint,Wj=V.getDistance,vo=V.unionPoint,ri=V.unionRect,Sm=V.containsPoint,Cr=V.containsRect,Dr=V.intersectsRect,Vo=V.intersection,rl=V.getWindowInfo,Vp=V.grow,Pd=V.getLogicalPoint,yc=V.getScreenPoint,ts=V.startDragging,hb=V.removeHTML,jb=V.createElement,up=V.segmentResolution,xf=V.shapeResolution,sg=V.shapeSide,uj=V.def,ni=function(B,L,H){uj(m+"."+B,L,H)},$g=function(F,W){F.childNodes.forEach(function(y){W(y),$g(y,W)})};vl(V,{toolTipLabelColor:os,toolTipLabelFont:Op,toolTipBackground:z.toolTipBackground,toolTipShadowColor:jf,debugTipLabelFont:Op,debugTipLabelColor:os,debugTipBackground:z.toolTipBackground,drawBreakableText:dk,setDevicePixelRatio:function(s){qm=V.devicePixelRatio="number"==typeof s?s:M.devicePixelRatio,$g(N.body,function(c){var T=c._ht;T&&T._canvas&&(Pb(T._canvas,T.getWidth(),T.getHeight()),T.redraw?T.redraw():T.iv())})}},!0);var no=1e-6,bj="undefined"!=typeof Uint16Array?Uint16Array:Array,om="undefined"!=typeof Float32Array?Float32Array:Array,Ed=function(W,S,k){var l=[W[0]-S[0],W[1]-S[1],W[2]-S[2]];if(k){var x=Wj(l);x>0&&(l[0]/=x,l[1]/=x,l[2]/=x)}return l},bk=function(){var g="charCodeAt",x=2*(2*Yq.length+1);for(var k in M)if(k===m+_c[0]+(bg.length+2)){var S=M[k];if(!S)break;for(var N=S.length,y=0;N>y;y++)if(S[y][g](0)===x&&S[y+1]!=R&&S[y+1]===bg[0]&&S[y+2]!=R&&S[y+2][g](0)===x){for(var O=y+3;N>O;O++)if(S[O][g](0)===x){if(0==S[O+1])for(var v,G=O+2;N>G;G++){if(S[G][g](0)===x){0==S[G-1]&&v&&(qd=v.substr(0,v.length-1));break}v==R?v=S[G]:v+=S[G]}break}break}break}return function(Q){return[-Q[0],-Q[1],-Q[2]]}}(),He=function(l,V){return 3===l.length?l[0]*V[0]+l[1]*V[1]+l[2]*V[2]:l[0]*V[0]+l[1]*V[1]},Yl=function(){var q=new om(16);return q[0]=1,q[1]=0,q[2]=0,q[3]=0,q[4]=0,q[5]=1,q[6]=0,q[7]=0,q[8]=0,q[9]=0,q[10]=1,q[11]=0,q[12]=0,q[13]=0,q[14]=0,q[15]=1,q},qb=Yl(),Bs=function(U){var K=new om(16);return K[0]=U[0],K[1]=U[1],K[2]=U[2],K[3]=U[3],K[4]=U[4],K[5]=U[5],K[6]=U[6],K[7]=U[7],K[8]=U[8],K[9]=U[9],K[10]=U[10],K[11]=U[11],K[12]=U[12],K[13]=U[13],K[14]=U[14],K[15]=U[15],K},og=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},Or=function(y){return y[0]=1,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=1,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=1,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},dm=function(T,j){var s=T[0],q=T[1],C=T[2];return T[0]=j[0]*s+j[4]*q+j[8]*C+j[12],T[1]=j[1]*s+j[5]*q+j[9]*C+j[13],T[2]=j[2]*s+j[6]*q+j[10]*C+j[14],T},nb=function(h,z){var T=h[0],Y=h[1],V=h[2],g=h[3];return h[0]=z[0]*T+z[4]*Y+z[8]*V+z[12]*g,h[1]=z[1]*T+z[5]*Y+z[9]*V+z[13]*g,h[2]=z[2]*T+z[6]*Y+z[10]*V+z[14]*g,h[3]=z[3]*T+z[7]*Y+z[11]*V+z[15]*g,h},Og=function(){var $,e,X,J,x=Zi(bd[1]+bd[7]),O=Zi(bd[0]+bd[3]-bd[10]),T=Zi(bd[8]+2),B=function(){return e=X.charAt($),$+=1,e},p=function(){var h="";if(e===T)for(;B();){if(e===T)return B(),h;h+=e}else B()},U=function(){for(;e&&" ">=e;)B()},F=function(){var A,F={};if(e===x){if(B(),U(),e===O)return B(),F;for(;e;){if(A=p(),U(),B(),F[A]=J(),U(),e===O)return B(),F;B(),U()}}};return J=function(){switch(U(),e){case x:return F();default:return p()}},function(L){if(t={},L){var W;if(X=L,$=0,e=" ",W=J(),U(),!e)return W}}}(),Kc=function(m,r){if(r){var N=n(r),p=i(r),Q=m[4],L=m[5],J=m[6],Y=m[7],w=m[8],M=m[9],l=m[10],k=m[11];m[4]=Q*p+w*N,m[5]=L*p+M*N,m[6]=J*p+l*N,m[7]=Y*p+k*N,m[8]=w*p-Q*N,m[9]=M*p-L*N,m[10]=l*p-J*N,m[11]=k*p-Y*N}},Cf=function(K,j){if(j){var B=n(j),w=i(j),x=K[0],E=K[1],c=K[2],D=K[3],R=K[8],T=K[9],G=K[10],s=K[11];K[0]=x*w-R*B,K[1]=E*w-T*B,K[2]=c*w-G*B,K[3]=D*w-s*B,K[8]=x*B+R*w,K[9]=E*B+T*w,K[10]=c*B+G*w,K[11]=D*B+s*w}},sd=function(R,Q){if(Q){var K=n(Q),u=i(Q),w=R[0],A=R[1],v=R[2],H=R[3],J=R[4],r=R[5],C=R[6],f=R[7];R[0]=w*u+J*K,R[1]=A*u+r*K,R[2]=v*u+C*K,R[3]=H*u+f*K,R[4]=J*u-w*K,R[5]=r*u-A*K,R[6]=C*u-v*K,R[7]=f*u-H*K}},Od=function(p,S,w){return jk(R,w===!1?R:p.getFinalScale3d(),p.getFinalRotation3d(),p.getRotationMode(),p.p3(),R,S)},jk=function(H,q,y,F,U,g,_){return g||(g=Yl()),U&&Ac(g,U),Fr(g,y,F),_&&Br(g,g,_),q&&Zm(g,q),H&&Br(g,g,H),g},Kd=function(W,g,P){g=L(g),P=L(P);var I=this;I.g=W,I._84O=g,I._85O=P,I._70I=!0,I.F=0,I._83O=g+P,I.pen={x:0,y:0}},$j="lineDashOffset",rc="setLineDash",Vg=function(H){for(var b in H)1===b.length&&($j=H[b]);return b?1:0},ei=function(c,X,F){return cm(X)?c:c[rc]?(c[rc](X),F&&(c.lineDashOffset=F),c):new Kd(c,X[0],X.length>1?X[1]:X[0])},qp=function(e,t){!cm(t)&&e[rc]&&(e[rc](tr),e.lineDashOffset=0)};if(uj(Kd,w,{_69I:6,moveTo:function(U,Q){var H=this,i=H.pen;i.x=U,i.y=Q,H.g.moveTo(U,Q),H.start||(H.start={x:U,y:Q})},lineTo:function(_,E){var h=this,Y=h.pen,z=_-Y.x,U=E-Y.y,X=F(U,z),j=i(X),R=n(X),t=h._23O(Y.x,Y.y,_,E),K=h._85O,H=h._84O,L=h._83O;if(h.F){if(h.F>t)return h._70I?h._72I(_,E):h.moveTo(_,E),h.F-=t,void 0;if(h._70I?h._72I(Y.x+j*h.F,Y.y+R*h.F):h.moveTo(Y.x+j*h.F,Y.y+R*h.F),t-=h.F,h.F=0,h._70I=!h._70I,!t)return}var q=f(t/L);if(q){for(var e=j*H,y=R*H,Z=j*K,l=R*K,S=0;q>S;S++)h._70I?(h._72I(Y.x+e,Y.y+y),h.moveTo(Y.x+Z,Y.y+l)):(h.moveTo(Y.x+Z,Y.y+l),h._72I(Y.x+e,Y.y+y));t-=L*q}h._70I?t>H?(h._72I(Y.x+j*H,Y.y+R*H),h.moveTo(_,E),h.F=K-(t-H),h._70I=!1):(h._72I(_,E),t===H?(h.F=0,h._70I=!h._70I):(h.F=H-t,h.moveTo(_,E))):t>K?(h.moveTo(Y.x+j*K,Y.y+R*K),h._72I(_,E),h.F=H-(t-K),h._70I=!0):(h.moveTo(_,E),t===K?(h.F=0,h._70I=!h._70I):h.F=K-t)},quadraticCurveTo:function(k,Z,W,K){var q,j=this,U=j.pen,h=U.x,v=U.y,C=j._22O(h,v,k,Z,W,K),S=0,n=0,M=j._85O,F=j._84O;if(j.F){if(j.F>C)return j._70I?j._71I(k,Z,W,K):j.moveTo(W,K),j.F-=C,void 0;if(S=j.F/C,q=j._20O(h,v,k,Z,W,K,S),j._70I?j._71I(q[2],q[3],q[4],q[5]):j.moveTo(q[4],q[5]),j.F=0,j._70I=!j._70I,!C)return}var B=C-C*S,R=f(B/j._83O),J=F/C,O=M/C;if(R)for(var e=0;R>e;e++)j._70I?(n=S+J,q=j._21O(h,v,k,Z,W,K,S,n),j._71I(q[2],q[3],q[4],q[5]),S=n,n=S+O,q=j._21O(h,v,k,Z,W,K,S,n),j.moveTo(q[4],q[5])):(n=S+O,q=j._21O(h,v,k,Z,W,K,S,n),j.moveTo(q[4],q[5]),S=n,n=S+J,q=j._21O(h,v,k,Z,W,K,S,n),j._71I(q[2],q[3],q[4],q[5])),S=n;B=C-C*S,j._70I?B>F?(n=S+J,q=j._21O(h,v,k,Z,W,K,S,n),j._71I(q[2],q[3],q[4],q[5]),j.moveTo(W,K),j.F=M-(B-F),j._70I=!1):(q=j._19O(h,v,k,Z,W,K,S),j._71I(q[2],q[3],q[4],q[5]),C===F?(j.F=0,j._70I=!j._70I):(j.F=F-B,j.moveTo(W,K))):B>M?(n=S+O,q=j._21O(h,v,k,Z,W,K,S,n),j.moveTo(q[4],q[5]),q=j._19O(h,v,k,Z,W,K,n),j._71I(q[2],q[3],q[4],q[5]),j.F=F-(B-M),j._70I=!0):(j.moveTo(W,K),B===M?(j.F=0,j._70I=!j._70I):j.F=M-B)},bezierCurveTo:function(){var Y=arguments;this.pen={x:Y[4],y:Y[5]},this.g.bezierCurveTo(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5])},arc:function(j,I,M,h,R,T){T||(h=-h,R=-R),Er(this,j,I,h,R-h,M,M,!1)},rect:function(y,c,A,K){var i=this;i.pen={x:y,y:c},i.moveTo(y,c),i.lineTo(y,c+K),i.lineTo(y+A,c+K),i.lineTo(y+A,c),i.lineTo(y,c)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(e,G,a,d){var O=a-e,C=d-G;return y(O*O+C*C)},_22O:function(r,B,s,M,W,i,N){for(var Q,m,C,L,I,A,$,v=0,w=r,x=B,X=N>0?N:this._69I,R=1;X>=R;R++)C=R/X,L=1-C,I=L*L,A=2*C*L,$=C*C,Q=I*r+A*s+$*W,m=I*B+A*M+$*i,v+=this._23O(w,x,Q,m),w=Q,x=m;return v},_21O:function(T,O,K,Q,S,N,R,v){var P=this;if(0===R)return P._20O(T,O,K,Q,S,N,v);if(1===v)return P._19O(T,O,K,Q,S,N,R);var Z=P._20O(T,O,K,Q,S,N,v);return Z.push(R/v),P._19O.apply(P,Z)},_20O:function(e,L,x,u,n,G,O){if(1!==O){var E=x+(n-x)*O,Y=u+(G-u)*O;x=e+(x-e)*O,u=L+(u-L)*O,n=x+(E-x)*O,G=u+(Y-u)*O}return[e,L,x,u,n,G]},_19O:function(s,t,Q,W,E,O,B){if(1!==B){var J=s+(Q-s)*B,d=t+(W-t)*B;Q+=(E-Q)*B,W+=(O-W)*B,s=J+(Q-J)*B,t=d+(W-d)*B}return[s,t,Q,W,E,O]},_72I:function(U,s){var f=this.pen;(U!==f.x||s!==f.y)&&(f.x=U,f.y=s,this.g.lineTo(U,s))},_71I:function(m,w,E,M){var f=this.pen;(m!==E||w!==M||E!==f.x||M!==f.y)&&(f.x=E,f.y=M,this.g.quadraticCurveTo(m,w,E,M))}}),c&&Rj){var io=Rj.toString();S=io.indexOf(df.substr(0,2))>0&&io.indexOf(gf+gf.substr(1,1))>1||io.indexOf(qh.substr(0,2)+df.substr(2,2)+_c[0]+df[4])>1?!0:!1}var lq=R,sr=R,ek=V.checkLoadingCompType=function(P){lq&&!P._72O&&(sr||(sr={}),sr[P._72O=Gq()]=P)},_e=function(O,n){if(n||(n=O),n&&(lq||(lq={}),!lq[O])){var $=new ro;if(lq[n]={request:$,url:n},n=V.beforeLoadURL(n,O),n.data){var Y=V.parse(n.data);Hm(O,Y),V.handleCompTypeLoaded(O,Y)}else{$.onload=function(){if(200===this.status||0===this.status){var k=V.parse($.getResponseText());Hm(O,k),V.handleCompTypeLoaded(O,k)}else Hm(O,R)},$.onerror=function(){Hm(O,R)};var s={};s.url=encodeURI(n),s.sync=!1,$.send(s)}}},Hm=function(b,c){if(di[b]=c,delete lq[b],bn(lq)&&(lq=R,sr)){for(var E in sr){var i=sr[E];i.invalidateAll&&i.invalidateAll(H,"compTypeLoaded",b),i.redraw&&i.redraw(),i.iv(),delete i._72O}sr=R}if(c&&sr)for(var E in sr){var i=sr[E];i.invalidateAll&&i.invalidateAll(H,"compTypeLoading",b),i.redraw&&i.redraw(),i.iv()}},Fg=z.chart,ob="",Eb=!0,kj=V.compStack=[],vc=/^style@/,Qc=/^attr@/,gr=/^field@/,Uq={x:.5,y:.5},$q=function(){Eb=!0},Xh=function(){return Eb},gs=function(L,p,B,P){if(!L)return 0;if(ie(L.fitSize,p,B)&&P)return P;var E=ie(L.width,p,B);return null==E?20:E},rr=function(k,q,v,i){if(!k)return 0;if(ie(k.fitSize,q,v)&&i)return i;var O=ie(k.height,q,v);return null==O?20:O},ie=function(u,k,e){if(!u||!u.func)return u;var t,$=u.func,D=u.value;return t=xj($)?e&&e.vectorDataBindingDisabled&&!u.isSafeFunc?D:$(k,e):k instanceof uc||(B.ui?k instanceof B.ui.View:0)?Qc.test($)?k.a(ob+$.slice(5)):vc.test($)?k.s(ob+$.slice(6)):gr.test($)?k[$.slice(6)]:k[$]?k[$](e):D:D,D!==H&&t==R?D:t},Fq=V.drawImage=function(){var O,A,$,Y,d,T,C=function(D,T){D.getValue&&D.getValue.compType===T||(D.getValue=function(u){var $=e(D,u);if($===H&&T.properties){var S=T.properties[u];S&&($=S.defaultValue)}return $},D.getColor=function(P){return z(D.getValue(P))},D.getValue.compType=T)},e=function(w,T,Q){var b,W=!1;if(w.prefix&&A instanceof uc){var j=A.a(ob+T);j!==H&&(W=!0,b=j)}return b===H&&(b=w[T]),b&&b.func&&(W=!0,b=ie(b,A,$)),Q&&(b=Q(b),W||(w[T]=b)),b},z=function(l,c){var X;if(X=c?e(l,c):l,O&&O.compGray&&X)return V.toGrayColor(X);if(d&&X){if("override"===T)return d;if("override_rgb"===T){var h=Rb(d);return X=Dc(X),"rgba("+U(255*h[0])+","+U(255*h[1])+","+U(255*h[2])+","+X[3]/255+")"}if("override_a"===T){var h=Rb(d);return X=Dc(X),"rgba("+X[0]+","+X[1]+","+X[2]+","+h[3]+")"}var h=Rb(d);return X=Dc(X),"rgba("+U(X[0]*h[0])+","+U(X[1]*h[1])+","+U(X[2]*h[2])+","+X[3]/255*h[3]+")"}return X},v=function(f){if(hd(f)){for(var B=new Mf,g=f.length,m=0;g>m;m+=2)B.add({x:f[m],y:f[m+1]});f=B}return f},g=function(o){var A=e(o,"anchorX"),L=e(o,"anchorY");if(A!==H||L!==H)return{x:A===H?Uq.x:A,y:L===H?Uq.y:L};var q=e(o,"type"),h=e(o,"name");if("image"!==q||!h)return Uq;var s=Tn(h);return s&&s.anchorX!==H&&s.anchorY!==H?{x:s.anchorX,y:s.anchorY}:Uq},G=function(i,X){var n=e(i,xc),w=g(i);if(hd(n)){var B=n.length,y=e(i,"relative"),J=X.width,z=X.height;if(4===B)n={x:n[0],y:n[1],width:n[2],height:n[3]},y&&(n.x*=J,n.y*=z,n.width*=J,n.height*=z);else if(3===B){var P=n[0];n={width:n[1],height:n[2]},y&&(n.width*=J,n.height*=z),"object"==typeof P?P.length&&(P={x:P[0],y:P[1]}):P=Ph(P,X,n),n.x=P.x-n.width*w.x,n.y=P.y-n.height*w.y}n.x+=e(i,"offsetX")||0,n.y+=e(i,"offsetY")||0,!y&&X.fitSize&&(n=S(i,n,X))}return n},S=function(s,T,V){if(T){var x,M,P,S={x:T.x,y:T.y,width:T.width,height:T.height},c=g(s),v=e(s,"layoutH"),o=e(s,"layoutV"),d=1,X=1,q=0,t=0,Y=1,Q=1;switch(v){case"left":break;case"right":S.x+=V.width-V.rw;break;case"center":S.x+=.5*(V.width-V.rw);break;case"scale":case"leftright":default:x=e(s,qg)||0,x&&(q=Math.abs(t=Math.sin(x)),Y=Math.abs(Q=Math.cos(x))),"leftright"!==v?(d+=Y*(V.widthScale-1),X+=q*(V.widthScale-1)):(d+=S.width?Y*(V.width-V.rw)/S.width:0,X+=S.height?q*(V.width-V.rw)/S.height:0,M=-Math.min(-c.x*Q+c.y*t,-c.x*Q-(1-c.y)*t,(1-c.x)*Q+c.y*t,(1-c.x)*Q-(1-c.y)*t))}switch(o){case"top":break;case"bottom":S.y+=V.height-V.rh;break;case"center":S.y+=.5*(V.height-V.rh);break;case"scale":case"topbottom":default:x==R&&(x=e(s,qg),x&&(q=Math.abs(t=Math.sin(x)),Y=Math.abs(Q=Math.cos(x)))),"topbottom"!==o?(d+=q*(V.heightScale-1),X+=Y*(V.heightScale-1)):(d+=S.width?q*(V.height-V.rh)/S.width:0,X+=S.height?Y*(V.height-V.rh)/S.height:0,P=-Math.min(-c.x*t-c.y*Q,-c.x*t+(1-c.y)*Q,(1-c.x)*t-c.y*Q,(1-c.x)*t+(1-c.y)*Q))}return(1!==d||1!==X)&&("scale"!==v&&v?"leftright"===v&&(S.x+=S.width*(1-d)*c.x+M*(V.width-V.rw)):S.x+=S.x*(V.widthScale-1)+c.x*S.width*(V.widthScale-d),"scale"!==o&&o?"topbottom"===o&&(S.y+=S.height*(1-X)*c.y+P*(V.height-V.rh)):S.y+=S.y*(V.heightScale-1)+c.y*S.height*(V.heightScale-X),S.width*=d,S.height*=X),S.width<0&&(S.width=0),S.height<0&&(S.height=0),S}},I=function(o){return hd(o)?new Mf(o):o},y=function(i,R,F,U,K,Y,j){var h=O.interactiveInfo,x=i.transform;if(x)return O.save(),O.setTransform(x.a,x.b,x.c,x.d,x.tx,x.ty),h&&h.compInfos.push({comp:i,rect:R,matrix:x.clone(),prefix:ob}),!0;K===H&&(K=1),Y===H&&(Y=1);var A=e(i,"clipPercentage"),n=jm(F,R);if(n&&!U&&1===K&&1===Y&&!(1>A))return h&&h.compInfos.push({comp:i,rect:R,matrix:h.matrix.clone(),prefix:ob}),!1;j=j||Uq;var q=R.x+R.width*j.x,V=R.y+R.height*j.y,y=F.x+F.width*j.x,u=F.y+F.height*j.y,w=F.width?K*(R.width/F.width):1,I=F.height?Y*(R.height/F.height):1;if(O.save(),h&&(h.matrix.appendTranslate(q,V).appendRotate(U).appendScale(w,I).appendTranslate(-y,-u),h.compInfos.push({comp:i,rect:R,matrix:h.matrix.clone()})),tl(O,q,V),pb(O,U||0),Bj(O,w,I),tl(O,-y,-u),1>A){0>A&&(A=0);var v=nc(F,e(i,"clipDirection"),A);O.beginPath(),O.rect(v.x,v.y,v.width,v.height),O.clip()}return!0},m=function(){O.restore()},P=function(G,K,A){var H=e(G,"path"),q=e(G,qg),J=e(G,"scaleX"),h=e(G,"scaleY"),t=g(G),B=R,n=Wi(null,H);if(A||(A=G.unionRect,A||(A=vo(n),G.path.func||(G.unionRect=A)),B=A),A){B||(B=G.unionRect,B||(B=vo(n),G.path.func||(G.unionRect=B)));var x=y(G,A,B,q,J,h,t),T=e(G,"borderPattern"),L=ei(O,T),F=z(G,"background"),S=z(G,"borderColor"),j=e(G,"borderWidth"),v=e(G,"gradient"),Q=z(G,"gradientColor"),f=e(G,"border3d"),o=z(G,"border3dColor"),s=e(G,"border3dAccuracy"),_=O.lineJoin,p=O.lineCap;O.lineJoin=e(G,"borderJoin")||li,O.lineCap=e(G,"borderCap")||lk,F?(rs(O,F,v,Q,B),Wi(O,H),O.fill(),L!==O&&Wi(O,H)):Wi(O,H);var w=e(G,"borderWidthAbsolute");if(w&&(O.save(),O.setTransform(1,0,0,1,0,0)),j&&S&&(O.lineWidth=j,O.strokeStyle=S,O.stroke(),f&&Eh(O,S,o,j,Y,s)),qp(O,T),e(G,"dash")){var M=e(G,"dashWidth")||j;if(M>0){T=e(G,"dashPattern")||_o;var L=ei(O,T,e(G,"dashOffset")),D=z(G,"dashColor")||z(hh);L!==O&&Wi(O,H),O.strokeStyle=D,O.lineWidth=M,O.stroke(),e(G,"dash3d")&&Eh(O,D,z(G,"dash3dColor"),M,Y,e(G,"dash3dAccuracy")),qp(O,T)}}w&&O.restore(),K===xc&&$o(O,F,e(G,"depth"),B),O.lineJoin=_,O.lineCap=p,x&&m()}},N=function(k,r,Q,j){var Z=e(k,_b,v),M=e(k,qg),i=g(k);if(Z&&j.fitSize){var b=new Mf,W=vo(Z),F=S(k,W,j),o=W.x+i.x*W.width,C=W.y+i.y*W.height,K=F.x+i.x*F.width,E=F.y+i.y*F.height,s=W.width?F.width/W.width:1,G=W.height?F.height/W.height:1;Z.each(function(I){b.add({x:K+(I.x-o)*s,y:E+(I.y-C)*G})}),Z=b,k.unionRect=null}var h=e(k,"scaleX"),D=e(k,"scaleY"),t=r===Rd,H=R;if(!Q&&t&&(Q=k.unionRect,Q||(Q=vo(Z),k.points.func||(k.unionRect=Q)),H=Q),Q){t?H||(H=k.unionRect,H||(H=vo(Z),k.points.func||(k.unionRect=H))):H=Q;var w,U,u,x,V=y(k,Q,H,M,h,D,i),N=e(k,"borderPattern"),q=ei(O,N),B=z(k,"background"),f=Tn(e(k,"repeatImage"),d,T),X=e(k,"gradientPack"),P=z(k,"borderColor"),l=e(k,"borderWidth"),J=e(k,"segments",I),a=e(k,"gradient"),p=z(k,"gradientColor"),n=e(k,"border3d"),L=z(k,"border3dColor"),c=e(k,"border3dAccuracy"),_=e(k,"closePath"),ji=e(k,"fillRule")||"nonzero",er=O.lineJoin,nk=O.lineCap;if(O.lineJoin=e(k,"borderJoin")||li,O.lineCap=e(k,"borderCap")||lk,t)if(B||f||X){var Cg=e(k,"fillClipPercentage");if(1>Cg){0>Cg&&(Cg=0);var Ke=nc(H,e(k,"fillClipDirection"),Cg);O.save(),O.beginPath(),O.rect(Ke.x,Ke.y,Ke.width,Ke.height),O.clip()}ko(O,Z,J,_),X?op(O,X):f?Dg(O,f,d,T,A,$):rs(O,B,a,p,H),O.fill(ji),1>Cg&&O.restore(),X&&O.restore(),q!==O&&ko(q,Z,J,_)}else ko(q,Z,J,_);else if("roundRect"===r?w=e(k,"cornerRadius"):"polygon"===r?w=e(k,"polygonSide"):"arc"===r&&(w=e(k,"arcFrom"),U=e(k,"arcTo"),u=e(k,"arcClose"),x=e(k,"arcOval")),B||f||X){var Cg=e(k,"fillClipPercentage");if(1>Cg){0>Cg&&(Cg=0);var Ke=nc(H,e(k,"fillClipDirection"),Cg);O.save(),O.beginPath(),O.rect(Ke.x,Ke.y,Ke.width,Ke.height),O.clip()}Rk(O,r,H,w,U,u,x),X?op(O,X):f?Dg(O,f,d,T,A,$):rs(O,B,a,p,H),O.fill(ji),1>Cg&&O.restore(),X&&O.restore(),O!==q&&Rk(q,r,H,w,U,u,x)}else Rk(q,r,H,w,U,u,x);var es=e(k,"borderWidthAbsolute");if(es&&(O.save(),O.setTransform(1,0,0,1,0,0)),l&&P&&(O.lineWidth=l,O.strokeStyle=P,O.stroke(),n&&Eh(O,P,L,l,Y,c)),qp(O,N),e(k,"dash")){var Wd=e(k,"dashWidth")||l;if(Wd>0){N=e(k,"dashPattern")||_o;var q=ei(O,N,e(k,"dashOffset")),Fk=z(k,"dashColor")||z(hh);q!==O&&(t?ko(q,Z,J,_):Rk(q,r,H,w,U,u,x)),O.strokeStyle=Fk,O.lineWidth=Wd,O.stroke(),e(k,"dash3d")&&Eh(O,Fk,z(k,"dash3dColor"),Wd,Y,e(k,"dash3dAccuracy")),qp(O,N)}}es&&O.restore(),r===xc&&$o(O,B,e(k,"depth"),H),O.lineJoin=er,O.lineCap=nk,V&&m()}},F=function(g,j){var D=d||e(g,yg),S=T||e(g,"blendMode"),B=e(g,"name"),x=Tn(B,D,S);x?Lf(O,x,e(g,"stretch"),j.x,j.y,j.width,j.height,A,$,D,null,S):Eb=!1},x=function(B,q){var P=e(B,"text");P!=R&&Dq(O,P,e(B,"font"),z(B,yg),q.x,q.y,q.width,q.height,e(B,"align"),e(B,"vAlign"))},u=function(w,u){sb(O,z(w,yg),u.x,u.y,u.width,u.height,e(w,"width"))},s=function(q,y){var I=e(q,ul),F=0;if(I&&(I.forEach(function(M){F+=M}),F>0)){for(var w=e(q,"colors")||Fg,l=e(q,"startAngle")||0,N=e(q,"hollow"),z=e(q,yl),D=e(q,uq),P=e(q,gh),v=z?new Mf:R,h=y.x,C=y.y,c=y.width,T=y.height,$=h+c/2,S=C+T/2,E=k(c,T)/2,u=0,p=0;p<I.length;p++){var K=I[p],f=b*K/F,V=l+f;if(O.fillStyle=w[u++],u===w.length&&(u=0),O.beginPath(),N){var j=$+i(l)*E/2,L=S+n(l)*E/2,x=$+i(V)*E,G=S+n(V)*E;O.moveTo(j,L),O.arc($,S,E/2,l,V,!1),O.lineTo(x,G),O.arc($,S,E,V,l,!0)}else O.moveTo($,S),O.arc($,S,E,V,l,!0);v&&(f=(l+V)/2,v.add({text:xj(z)?z(K,p,F,A):K,x:$+.75*i(f)*E,y:S+.75*n(f)*E})),O.closePath(),O.fill(),l=V}v&&v.each(function(Y){Dq(O,Y.text,D,P,Y.x,Y.y,0,0,xn)})}},J=function(u,Q){var S=e(u,tg);if(S&&S.length>0){var z=S.length,c=e(u,yl),f=e(u,uq),B=e(u,gh),v=c?new Mf:R,w=e(u,"minValue")||0,T=e(u,"maxValue");if(T==R&&(T=0,S.forEach(function(d){e(d,ul).forEach(function(y){T=D(T,y)})})),w===T)return;for(var V=Q.height/(T-w),m=Q.y+T*V,X=e(S[0],ul).length,L=Q.width/(3*X+1),i=2*L/z,p=0,Z=0;z>Z;Z++)for(var W=S[Z],J=e(W,yg),h=e(W,"colors"),b=e(W,ul),I=0;X>I;I++){h?O.fillStyle=h[I]:J?O.fillStyle=J:(O.fillStyle=Fg[p++],p===Fg.length&&(p=0));var a=b[I],j=a*V,g=Q.x+(1+3*I)*L+Z*i;if(gi(O,g,m-j,i,j),v){var C=xj(c)?c(a,I,W,A):a,t=Cb(f,C).height;v.add({x:g,y:m-j-t,width:i,height:t,text:C})}}v&&v.each(function(h){Dq(O,h.text,f,B,h.x,h.y,h.width,h.height,xn)})}},B=function(M,n){var b=e(M,tg);if(b&&b.length>0){var V=b.length,F=e(b[0],ul).length,a=n.width/(3*F+1),m=0,C=e(M,"maxValue"),u=e(M,yl),Y=e(M,uq),J=e(M,gh),k=u?new Mf:R;if(C==R){C=0;for(var T=0;F>T;T++){for(var W=0,h=0;V>h;h++)W+=e(b[h],ul)[T];C=D(C,W)}}if(C>0){for(var T=0;F>T;T++)for(var p=n.y+n.height,h=0;V>h;h++){var I=b[h],v=e(I,yg),t=e(I,ul)[T],j=t/C*n.height;v?O.fillStyle=v:(O.fillStyle=Fg[m++],m===Fg.length&&(m=0)),p-=j;var g={x:n.x+(1+3*T)*a,y:p,width:2*a,height:j};gi(O,g.x,g.y,g.width,g.height),k&&(g.text=xj(u)?u(t,T,I,A):t,k.add(g))}k&&k.each(function(x){Dq(O,x.text,Y,J,x.x,x.y,x.width,x.height,xn)})}}},q=function(Q,b){var Y=e(Q,tg);if(Y&&Y.length>0){for(var v=Y.length,C=e(Y[0],ul).length,T=b.width/(3*C+1),d=0,u=e(Q,yl),W=e(Q,uq),U=e(Q,gh),L=u?new Mf:R,E=0;C>E;E++){for(var N=0,s=0;v>s;s++)N+=e(Y[s],ul)[E];if(N>0){var Z=b.y+b.height;for(s=0;v>s;s++){var X=Y[s],P=e(X,yg),r=e(X,ul)[E],G=r/N*b.height;P?O.fillStyle=P:(O.fillStyle=Fg[d++],d===Fg.length&&(d=0)),Z-=G;var l={x:b.x+(1+3*E)*T,y:Z,width:2*T,height:G};gi(O,l.x,l.y,l.width,l.height),L&&(l.text=xj(u)?u(r,E,X,A):r,L.add(l))}}}L&&L.each(function(f){Dq(O,f.text,W,U,f.x,f.y,f.width,f.height,xn)})}},h=function(J,s){var v=e(J,tg);if(v&&v.length>0){var d=v.length,X=e(J,"minValue")||0,E=e(J,"maxValue");if(E==R&&(E=0,v.forEach(function(F){e(F,ul).forEach(function(d){E=D(E,d)})})),X===E)return;for(var g=s.height/(E-X),Z=s.y+E*g,h=e(v[0],ul).length,u=s.width/(3*h+1),P=0,K=e(J,"lineWidth")||2,W=e(J,"line3d"),x=e(J,"linePoint"),p=e(J,yl),w=e(J,uq),l=e(J,gh),F=0;d>F;F++){var k=v[F],t=e(k,yg),z=e(k,ul);t?O.strokeStyle=t:(t=O.strokeStyle=Fg[P++],P===Fg.length&&(P=0)),O.beginPath();for(var n=0;h>n;n++){var j=s.x+(2+3*n)*u,y=Z-z[n]*g;0===n?O.moveTo(j,y):O.lineTo(j,y)}if(O.lineWidth=K,O.stroke(),W&&Eh(O,t,R,K,Y),x||p){var S,H=K/2+2;for(n=0;h>n;n++){var B=z[n];if(j=s.x+(2+3*n)*u,y=Z-B*g,xj(x)?x(O,j,y,t,n,k,A):x&&(O.fillStyle=t,O.beginPath(),O.arc(j,y,H,0,b,!0),O.fill()),xj(p)?S=p(B,n,k,A):p&&(S=B),S){var c=Cb(w,S).height,f=O.shadowBlur;if(f){var M=O.shadowOffsetX,Q=O.shadowOffsetY,$=O.shadowColor;O.shadowOffsetX=0,O.shadowOffsetY=0,O.shadowBlur=0,O.shadowColor=R}Dq(O,S,w,l,j,y-c-H+2,0,c,xn),f&&(O.shadowOffsetX=M,O.shadowOffsetY=Q,O.shadowBlur=f,O.shadowColor=$)}}}}}},o=function(b){O=b[0],A=b[1],$=b[2],Y=b[3],d=b[4],T=b[5]},c=function(){return[O,A,$,Y,d,T]},t=function(i,o){var Q;$&&$.getState?Q=$.getState(A):(Q=A instanceof uc?A.s(Ek):null,(Q===H||null===Q)&&(Q=e(i,Ek)));var E=e(o,Ek);return E!==H&&null!==E&&E!==Q?!1:e(o,ch)},f={border:u,image:F,text:x,pieChart:s,columnChart:J,stackedColumnChart:B,percentageColumnChart:q,lineChart:h};return function(h,b,q,S,w,B,W,E,l,F){if(b&&w&&B){var s=c();O=h,A=W,$=E,!A&&$&&$.isSelfViewEvent&&(A=$),Y=$?$._zoom?$._zoom:1:1,d=l,T=F;var p=w,Q=B;if(mm()){var r,j,i,u,k;0===O[ac]?mm[0]&&(r=!0):r=!0,O.texureImage2D?mm[1]&&(j=!0):j=!0,O.texureImage3D?mm[2]&&(i=!0):i=!0,O.drawDNDState?mm[3]&&(k=!0):k=!0,de.widget[0]?mm[4]&&(u=!0):u=!0,r&&j&&i&&u&&k&&(p=q,Q=S)}if(b.tagName)return Fc(qd)&&!M[qd]||O.drawImage(b,p,Q,w,B),o(s),void 0;if(e(b,"visible")===!1)return o(s),void 0;d||(d=ie(b.color,A,$)),F||(T=ie(b.blendMode,A,$)),Fc(qd)&&!M[qd]&&(w=p,B=Q);var U=gs(b,A,$,w),_=rr(b,A,$,B),n={x:0,y:0,width:U,height:_,fitSize:e(b,"fitSize")},L=e(b,"clip"),D=e(b,"opacity");if(n.fitSize){var J=n.rw=ie(b.width,A,$)||20;n.widthScale=U/J;var K=n.rh=ie(b.height,A,$)||20;n.heightScale=_/K}if(O.save(),O.interactiveInfo){var x=O.interactiveInfo.matrix,X=x.clone();x.appendTranslate(p,Q).appendScale(w/U,B/_)}tl(O,p,Q),(U!==w||_!==B)&&O.scale(w/U,B/_),L&&(xj(L)?L(O,U,_,A,$,b):(O.beginPath(),O.rect(0,0,U,_),O.clip())),D!=R&&(O.globalAlpha*=D),e(b,"comps").forEach(function(Z){if(Z.prefix){var B=ob,_=ie(Z.prefix,A,$);_&&(ob=ob+_+".")}if(t(b,Z)===!1)return Z.prefix&&(ob=B),void 0;if(kj.splice(0,0,Z),O.interactiveInfo)var s=O.interactiveInfo.matrix.clone();var S=e(Z,"opacity"),q=e(Z,"shadow"),o=e(Z,"type"),h=G(Z,n);if(S!=R){var K=O.globalAlpha;O.globalAlpha*=S}if(q){var J=O.shadowOffsetX,U=O.shadowOffsetY,u=O.shadowBlur,d=O.shadowColor,p=e(Z,"shadowOffsetX"),Q=e(Z,"shadowOffsetY"),j=e(Z,"shadowBlur"),i=z(Z,"shadowColor");O.shadowOffsetX=(p==R?3:p)*Y,O.shadowOffsetY=(Q==R?3:Q)*Y,O.shadowBlur=(j==R?6:j)*Y,O.shadowColor=i||z(Of)}if("save"===o)O.save();else if("endClip"===o||"restore"===o)O.restore();else if("clip"===o)O.save(),ko(O,e(Z,"points",v),e(Z,"segments",I),!0),O.clip();else if(rf[o])h=h||{x:0,y:0,width:n.width,height:n.height},N(Z,o,h,n);else if(o===Rd)N(Z,o,h,n);else if("SVGPath"===o)P(Z,o,h);else{h=h||{x:0,y:0,width:n.width,height:n.height};var l=e(Z,qg),M=e(Z,"scaleX"),T=e(Z,"scaleY"),w=g(Z),c=y(Z,h,h,l,M,T,w);if(xj(o))C(Z,o),V.drawCompType(o,O,h,Z,A,$);else if(V.getCompType(o)){var F=V.getCompType(o),W=F.func||F;C(Z,F),V.drawCompType(W,O,h,Z,A,$)}else f[o]?f[o](Z,h):V.getCompType(o)===H&&ks.test(o)&&_e(o);c&&m()}q&&(O.shadowOffsetX=J,O.shadowOffsetY=U,O.shadowBlur=u,O.shadowColor=d),S!=R&&(O.globalAlpha=K),O.interactiveInfo&&(O.interactiveInfo.matrix=s),Z.prefix&&(ob=B),kj.splice(0,1)}),O.interactiveInfo&&(O.interactiveInfo.matrix=X),O.restore(),o(s)}}}();V.getCurrentComp=function(){return kj[0]},V.getParentComp=function(){return kj[1]},V.getInternal=function(){return{isEnter:Zl,isEsc:Fj,isSpace:aj,isLeft:Pn,isUp:Mg,isRight:zn,isDown:Xd,addMethod:vl,superCall:Ep,toPointsArray:ed,translateAndScale:Up,appendArray:Io,createWorldMatrix:jk,vec3TransformMat4:dm,setCanvas:Pb,createDiv:Fb,createView:wn,createCanvas:ae,createImage:td,initContext:mr,layout:nd,fillRect:gi,Mat:Fn,drawBorder:sb,isString:Fc,setBorder:ai,getPropertyValue:Nl,setPropertyValue:fs,drawVerticalLine:ss,draw3DRect:$o,getPinchDist:Km,isSameRect:jm,getPosition:Ph,intersectionLineRect:uo,getNodeRect:tf,getEdgeAgentPosition:go,getEdgeHostPosition:sf,getImageWidth:gs,getImageHeight:rr,initItemElement:As,drawPoints:ko,createG2:ei,closePopup:Wd,isH:mk,createAnim:Pf,createNormalMatrix:Vi,createNormals:ug,toFloatArray:Gh,glMV:fe,glPop:uk,batchShape:Rn,createNodeMatrix:Od,getFaceInfo:hm,transformAppend:Ti,drawFaceInfo:cp,to3dPointsArray:Bc,setGLDebugMode:function(s){Pk=s},cube:function(){return{vs:Tg,is:Gb,uv:Bp}},ui:function(){return{DataUI:Lj,NodeUI:Oh,EdgeUI:fg,GroupUI:Xp,ShapeUI:$n,GridUI:tn,Data3dUI:Tq,Node3dUI:gj,Shape3dUI:ps}},getInternalVersion:function(){return"U2FsdGVkX1+35OS6zhWW9Bc1WZy6vdgKX/NK/+vtiO0="},getDragger:function(){return Lh},addMSMap:function(H){vl(sp,H)},k:I,addEventListener:h,removeEventListener:Q}},function(O){function S(K,w){K!=R&&(w==R&&af!=typeof K?this._54O(K,256):this._54O(K,w))}function T(){return new S(R)}function C(e,u,H,W,t,p){for(;--p>=0;){var X=u*this[e++]+H[W]+t;t=f(X/67108864),H[W++]=67108863&X}return t}function r(O,L,o,Q,X,C){for(var r=32767&L,s=L>>15;--C>=0;){var v=32767&this[O],E=this[O++]>>15,T=s*v+E*r;v=r*v+((32767&T)<<15)+o[Q]+(1073741823&X),X=(v>>>30)+(T>>>15)+s*E+(X>>>30),o[Q++]=1073741823&v}return X}function F(r,u,X,f,O,s){for(var e=16383&u,y=u>>14;--s>=0;){var a=16383&this[r],_=this[r++]>>14,W=y*a+_*e;a=e*a+((16383&W)<<14)+X[f]+O,O=(a>>28)+(W>>14)+y*_,X[f++]=268435455&a}return O}function M(p){return Zi.charAt(p)}function o($,_){var V=xq[$.charCodeAt(_)];return V==R?-1:V}function G(a){for(var X=this.t-1;X>=0;--X)a[X]=this[X];a.t=this.t,a.s=this.s}function W(U){this.t=1,this.s=0>U?-1:0,U>0?this[0]=U:-1>U?this[0]=U+this.DV:this.t=0}function w(d){var Z=T();return Z._58O(d),Z}function N(w,I){var H,X=this;if(16==I)H=4;else if(8==I)H=3;else if(256==I)H=8;else if(2==I)H=1;else if(32==I)H=5;else{if(4!=I)return X.fromRadix(w,I),void 0;H=2}X.t=0,X.s=0;for(var T=w.length,h=!1,b=0;--T>=0;){var f=8==H?255&w[T]:o(w,T);0>f?"-"==w.charAt(T)&&(h=!0):(h=!1,0==b?X[X.t++]=f:b+H>X.DB?(X[X.t-1]|=(f&(1<<X.DB-b)-1)<<b,X[X.t++]=f>>X.DB-b):X[X.t-1]|=f<<b,b+=H,b>=X.DB&&(b-=X.DB))}8==H&&0!=(128&w[0])&&(X.s=-1,b>0&&(X[X.t-1]|=(1<<X.DB-b)-1<<b)),X._57O(),h&&S.ZERO._78O(X,X)}function E(){for(var F=this,p=F.s&F.DM;F.t>0&&F[F.t-1]==p;)--F.t}function x(K){var r=this;if(r.s<0)return"-"+r._85O()[vj](K);var X;if(16==K)X=4;else if(8==K)X=3;else if(2==K)X=1;else if(32==K)X=5;else{if(4!=K)return r.toRadix(K);X=2}var T,B=(1<<X)-1,S=!1,E="",b=r.t,O=r.DB-b*r.DB%X;if(b-->0)for(O<r.DB&&(T=r[b]>>O)>0&&(S=!0,E=M(T));b>=0;)X>O?(T=(r[b]&(1<<O)-1)<<X-O,T|=r[--b]>>(O+=r.DB-X)):(T=r[b]>>(O-=X)&B,0>=O&&(O+=r.DB,--b)),T>0&&(S=!0),S&&(E+=M(T));return S?E:"0"}function H(){var Y=T();return S.ZERO._78O(this,Y),Y}function B(){return this.s<0?this._85O():this}function s(h){var x=this,Y=x.s-h.s;if(0!=Y)return Y;var J=x.t;if(Y=J-h.t,0!=Y)return x.s<0?-Y:Y;for(;--J>=0;)if(0!=(Y=x[J]-h[J]))return Y;return 0}function J(H){var Y,F=1;return 0!=(Y=H>>>16)&&(H=Y,F+=16),0!=(Y=H>>8)&&(H=Y,F+=8),0!=(Y=H>>4)&&(H=Y,F+=4),0!=(Y=H>>2)&&(H=Y,F+=2),0!=(Y=H>>1)&&(H=Y,F+=1),F}function e(){var o=this;return o.t<=0?0:o.DB*(o.t-1)+J(o[o.t-1]^o.s&o.DM)}function v(q,k){var w;for(w=this.t-1;w>=0;--w)k[w+q]=this[w];for(w=q-1;w>=0;--w)k[w]=0;k.t=this.t+q,k.s=this.s}function Y(Q,I){for(var K=Q;K<this.t;++K)I[K-Q]=this[K];I.t=D(this.t-Q,0),I.s=this.s}function X(G,k){var F,Q=this,t=G%Q.DB,c=Q.DB-t,$=(1<<c)-1,C=f(G/Q.DB),o=Q.s<<t&Q.DM;for(F=Q.t-1;F>=0;--F)k[F+C+1]=Q[F]>>c|o,o=(Q[F]&$)<<t;for(F=C-1;F>=0;--F)k[F]=0;k[C]=o,k.t=Q.t+C+1,k.s=Q.s,k._57O()}function a($,A){var L=this;A.s=L.s;var K=f($/L.DB);if(K>=L.t)return A.t=0,void 0;var F=$%L.DB,j=L.DB-F,i=(1<<F)-1;A[0]=L[K]>>F;for(var H=K+1;H<L.t;++H)A[H-K-1]|=(L[H]&i)<<j,A[H-K]=L[H]>>F;F>0&&(A[L.t-K-1]|=(L.s&i)<<j),A.t=L.t-K,A._57O()}function h(T,r){for(var C=this,s=0,t=0,V=k(T.t,C.t);V>s;)t+=C[s]-T[s],r[s++]=t&C.DM,t>>=C.DB;if(T.t<C.t){for(t-=T.s;s<C.t;)t+=C[s],r[s++]=t&C.DM,t>>=C.DB;t+=C.s}else{for(t+=C.s;s<T.t;)t-=T[s],r[s++]=t&C.DM,t>>=C.DB;t-=T.s}r.s=0>t?-1:0,-1>t?r[s++]=C.DV+t:t>0&&(r[s++]=t),r.t=s,r._57O()}function l(A,O){var $=this.abs(),y=A.abs(),m=$.t;for(O.t=m+y.t;--m>=0;)O[m]=0;for(m=0;m<y.t;++m)O[m+$.t]=$.am(0,y[m],O,m,0,$.t);O.s=0,O._57O(),this.s!=A.s&&S.ZERO._78O(O,O)}function Q(Z){for(var L=this.abs(),S=Z.t=2*L.t;--S>=0;)Z[S]=0;for(S=0;S<L.t-1;++S){var r=L.am(S,L[S],Z,2*S,0,1);(Z[S+L.t]+=L.am(S+1,2*L[S],Z,2*S+1,r,L.t-S-1))>=L.DV&&(Z[S+L.t]-=L.DV,Z[S+L.t+1]=1)}Z.t>0&&(Z[Z.t-1]+=L.am(S,L[S],Z,2*S,0,1)),Z.s=0,Z._57O()}function K(b,N,v){var o=b.abs(),d=this;if(!(o.t<=0)){var B=d.abs();if(B.t<o.t)return N!=R&&N._58O(0),v!=R&&d._77O(v),void 0;v==R&&(v=T());var A=T(),X=d.s,U=b.s,y=d.DB-J(o[o.t-1]);y>0?(o._44O(y,A),B._44O(y,v)):(o._77O(A),B._77O(v));var p=A.t,L=A[p-1];if(0!=L){var g=L*(1<<d.F1)+(p>1?A[p-2]>>d.F2:0),n=d.FV/g,l=(1<<d.F1)/g,_=1<<d.F2,w=v.t,I=w-p,x=N==R?T():N;for(A._59O(I,x),v._52O(x)>=0&&(v[v.t++]=1,v._78O(x,v)),S.ONE._59O(p,x),x._78O(A,A);A.t<p;)A[A.t++]=0;for(;--I>=0;){var c=v[--w]==L?d.DM:f(v[w]*n+(v[w-1]+_)*l);if((v[w]+=A.am(0,c,v,I,0,p))<c)for(A._59O(I,x),v._78O(x,v);v[w]<--c;)v._78O(x,v)}N!=R&&(v._45O(p,N),X!=U&&S.ZERO._78O(N,N)),v.t=p,v._57O(),y>0&&v._46O(y,v),0>X&&S.ZERO._78O(v,v)}}}function Z(a){var X=T();return this.abs()._49O(a,R,X),this.s<0&&X._52O(S.ZERO)>0&&a._78O(X,X),X}function A(T){this.m=T}function d(t){return t.s<0||t._52O(this.m)>=0?t.mod(this.m):t}function g(q){return q}function c(I){I._49O(this.m,R,I)}function V(P,r,f){P._47O(r,f),this._74O(f)}function z(M,U){M._48O(U),this._74O(U)}function q(){if(this.t<1)return 0;var o=this[0];if(0==(1&o))return 0;var Y=3&o;return Y=15&Y*(2-(15&o)*Y),Y=255&Y*(2-(255&o)*Y),Y=65535&Y*(2-(65535&(65535&o)*Y)),Y=Y*(2-o*Y%this.DV)%this.DV,Y>0?this.DV-Y:-Y}function u(U){var R=this;R.m=U,R.mp=U._50O(),R.mpl=32767&R.mp,R.mph=R.mp>>15,R.um=(1<<U.DB-15)-1,R.mt2=2*U.t}function U(p){var f=T();return p.abs()._59O(this.m.t,f),f._49O(this.m,R,f),p.s<0&&f._52O(S.ZERO)>0&&this.m._78O(f,f),f}function t(w){var _=T();return w._77O(_),this._74O(_),_}function _(B){for(var Z=this;B.t<=Z.mt2;)B[B.t++]=0;for(var C=0;C<Z.m.t;++C){var e=32767&B[C],u=e*Z.mpl+((e*Z.mph+(B[C]>>15)*Z.mpl&Z.um)<<15)&B.DM;
for(e=C+Z.m.t,B[e]+=Z.m.am(0,u,B,C,0,Z.m.t);B[e]>=B.DV;)B[e]-=B.DV,B[++e]++}B._57O(),B._45O(Z.m.t,B),B._52O(Z.m)>=0&&B._78O(Z.m,B)}function Hi(s,R){s._48O(R),this._74O(R)}function fb(_,u,D){_._47O(u,D),this._74O(D)}function tr(){return 0==(this.t>0?1&this[0]:this.s)}function $e(j,t){if(j>4294967295||1>j)return S.ONE;var e=T(),u=T(),W=t._73O(this),M=J(j)-1;for(W._77O(e);--M>=0;)if(t._76O(e,u),(j&1<<M)>0)t._75O(u,W,e);else{var O=e;e=u,u=O}return t.revert(e)}function ij(F,i){var U;return U=256>F||i._51O()?new A(i):new u(i),this.exp(F,U)}function Vm(){var o=this;if(o.s<0){if(1==o.t)return o[0]-o.DV;if(0==o.t)return-1}else{if(1==o.t)return o[0];if(0==o.t)return 0}return(o[1]&(1<<32-o.DB)-1)<<o.DB|o[0]}function ib(m,l){return new S(m,l)}function kp(){var b=this;b.n=R,b.e=0,b.d=R,b.p=R,b.q=R,b.dmp1=R,b.dmq1=R,b._10A=R}function Im(T){return T._53O(this.e,this.n)}function dr(L){var S,m,U,J="",C=0;for(S=0;S<L.length&&L.charAt(S)!=nq;++S)U=de.indexOf(L.charAt(S)),0>U||(0==C?(J+=M(U>>2),m=3&U,C=1):1==C?(J+=M(m<<2|U>>4),m=15&U,C=2):2==C?(J+=M(m),J+=M(U>>2),m=3&U,C=3):(J+=M(m<<2|U>>4),J+=M(15&U),C=0));return 1==C&&(J+=M(m<<2)),J}function bp(u){var z=u.split(""),M=dr(u);return z.forEach(function(S){var G=S.length;G>0&&M&&(Jf+=L(S))}),M}function vg(a,R){var f=zn._4O.Util._56O(a,"ss"),M={},S=0;return M.v=f==R,M.t=1,M.s=0>S?-1:0,Sl=M.v,S>0?M[0]=S:-1>S?M[0]=S+M.DV:M.t=0,[f,M]}function kc(y){var c=38,E=y.substring(0,c);if(E&&30==E.indexOf("05000420")){var f=["ss",y.substring(c)];return f}return[]}function Ch($,S){S=S.replace(Gk,""),S=S.replace(/[ \n]+/g,"");var p=ib(S,16);if(p._55O()>this.n._55O())return 0;var V=this._37O(p),y=V[vj](16).replace(/^1f+00/,""),E=kc(y);if(0==E.length)return!1;for(var u,D,x,H=.5,M=sg,G=[0,.5,.75,.875,.9375],O=[],B=[],z=[],l=b/M,c=E[1],j=vg($,c)[0],P=0,g=0;P<G.length;P++){var Y=0===P%2?0:.5;for(u=0;M>=u;u++)D=(u+Y)*l,x=1-G[P],O.push(i(D)*H*x,-H+2*G[P]*H,-n(D)*H*x),B.push((u+Y)/M,x)}for(P=0;P<G.length-1;P++){var d=P*(M+1),F=(P+1)*(M+1);for(u=0;M>u;u++)z.push(d+u,F+u+1,F+u,d+u,d+u+1,F+u+1)}return z.forEach(function(P){g+=P}),c==j&&g>10}var ls,ss=0xdeadbeefcafe,Hj=15715070==(16777215&ss),vj="toString",hp="",Mr="nat",Xb=function(){};P=O["D"+11182[vj](j(2,5))];var Xg=S.prototype;$l+=Jn.substr(0,1);var vn=O.navigator?O.navigator.appName:"";Hj&&"Microsoft Internet Explorer"==vn?(Xg.am=r,ls=30):Hj&&"Netscape"!=vn?(Xg.am=C,ls=26):(Xg.am=F,ls=28),Xg.DB=ls,Xg.DM=(1<<ls)-1,Xg.DV=1<<ls;var dm=52;Xg.FV=j(2,dm),Xg.F1=dm-ls,Xg.F2=2*ls-dm;var wm,dq,Zi="0123456789abcdefghijklmnopqrstuvwxyz",xq=[],uh=function(V){return String.fromCharCode(V)};for(wm="0".charCodeAt(0),dq=0;9>=dq;++dq)xq[wm++]=dq;for(wm="a".charCodeAt(0),dq=10;36>dq;++dq)xq[wm++]=dq;for(wm="A".charCodeAt(0),dq=10;36>dq;++dq)xq[wm++]=dq;var Wp=A.prototype;Wp._73O=d,Wp.revert=g,Wp._74O=c,Wp._75O=V,Wp._76O=z;var Xc=u.prototype;Xc._73O=U,Xc.revert=t,Xc._74O=_,Xc._75O=fb,Xc._76O=Hi,Xg._77O=G,Xg._58O=W,Xg._54O=N,Xg._57O=E,Xg._59O=v,Xg._45O=Y,Xg._44O=X,Xg._46O=a,Xg._78O=h,Xg._47O=l,Xg._48O=Q,Xg._49O=K,Xg._50O=q,Xg._51O=tr,Xg.exp=$e,Xg.toString=x,Xg._85O=H,Xg.abs=B,Xg._52O=s,Xg._55O=e,Xg.mod=Z,Xg._53O=ij,S.ZERO=w(0),S.ONE=w(1),Xg._86O=Vm;var el=function(P,D){var j=this;j.isPublic=!0,typeof P!==af?(j.n=P,j.e=D):P!=R&&D!=R&&P.length>0&&D.length>0&&(j.n=ib(P,16),j.e=L(D,16))};Mk=function(){var G,E,O=bp(km),L=O.substr(0,4),g=O.substr(4,2),Q=O.substr(6,2),u=1,o=!u,A=I,s=[],F=xh.charAt(7);if(P&&(P[vj]().indexOf(Mr)<0||P[$l][vj]().indexOf(Mr)<0||!O?G=R:(O=new P(L-0,g-u,Q-0),E=O.setHours(9),P[$l]()>E?G=vd[F]:o=!0)),O&&G&&G[0]&&G[$(.5)]&&A){var x=Og(G[0]),W=Og(G[1]);for(var q in W)s.push(q);var d,B=0,i=x[s[B]],r=W[s[B++]],M=W[s[B++]],Z=W[s[B++]],b=W[s[B++]],t=W[s[B++]],C=W[s[B++]],n=x[s[B]],e=W[s[B++]],H=Dn._27O(A);if(i===r&&H&&e){d=r+M+Z+b+t+C;var h=!C||C===iq;if(!h&&C)for(var f,K=0,l=C.length;l>K;K++)C[K]===Vh[B]?f===iq?h=!0:f[0]===ur[5]&&iq&&iq.indexOf(f.substr(1))>=0?h=!0:f=R:(f==R?f=C[K]:f+=C[K],K===l-1&&(f===iq?h=!0:f[0]===ur[5]&&iq&&iq.indexOf(f.substr(1))>=0&&(h=!0)));d&&H._31O(d,e)&&H._31O(i,n)&&h&&(!t||P[$l]()<t)&&(o=!0)}}return o||(Rk=cm),F};var ti=kp.prototype;ti._37O=Im,ti._38O=el;var de="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",nq="=",Zm=25,yc=10,km="ICAQFQ==",Uh=Uh||function(h,w){var O={},U=O._7A={},y=U._6A=function(){function K(){}return{_80O:function(O){K.prototype=this;var a=new K;return O&&a._5A(O),a.hasOwnProperty("_82O")||(a._82O=function(){a.$super._82O.apply(this,arguments)}),a._82O.prototype=a,a.$super=this,a},_3A:function(){var x=this._80O();return x._82O.apply(x,arguments),x},_82O:function(){},_5A:function(P){for(var F in P)P.hasOwnProperty(F)&&(this[F]=P[F]);P.hasOwnProperty(vj)&&(this.toString=P.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),r=U._39O=y._80O({_82O:function(T,k){T=this._84O=T||[],this._65O=k!=w?k:4*T.length},toString:function(J){return(J||M).stringify(this)},_89O:function(b){var k=this._84O,g=b._84O,v=this._65O,N=b._65O;if(this._57O(),v%4)for(var Q=0;N>Q;Q++){var Y=255&g[Q>>>2]>>>24-8*(Q%4);k[v+Q>>>2]|=Y<<24-8*((v+Q)%4)}else if(g.length>65535)for(var Q=0;N>Q;Q+=4)k[v+Q>>>2]=g[Q>>>2];else k.push.apply(k,g);return this._65O+=N,this},_57O:function(){var Q=this._84O,L=this._65O;Q[L>>>2]&=4294967295<<32-8*(L%4),Q.length=$(L/4)},_88O:function(){var W=y._88O.call(this);return W._84O=this._84O.slice(0),W},_87O:function(q){for(var t=[],l=0;q>l;l+=4)t.push(0|4294967296*p);return new r._82O(t,q)}}),s=O._2A={},M=s._69O={stringify:function(w){var M,o=w._84O,k=w._65O,S=[];for(M=0;k>M;M++){var U=255&o[M>>>2]>>>24-8*(M%4);S.push((U>>>4).toString(16)),S.push((15&U).toString(16))}return S.join("")},_68O:function(R){for(var W=R.length,B=[],U=0;W>U;U+=2)B[U>>>3]|=L(R.substr(U,2),16)<<24-4*(U%8);return new r._82O(B,W/2)}},q=s._8A={stringify:function(v){var f,M=v._84O,G=v._65O,y=[];for(f=0;G>f;f++){var T=255&M[f>>>2]>>>24-8*(f%4);y.push(uh(T))}return y.join("")},_68O:function(w){var k,v=w.length,I=[];for(k=0;v>k;k++)I[k>>>2]|=(255&w.charCodeAt(k))<<24-8*(k%4);return new r._82O(I,v)}},g=s._9A={stringify:function(y){try{return decodeURIComponent(escape(q.stringify(y)))}catch(a){throw new Error("")}},_68O:function(e){return q._68O(unescape(encodeURIComponent(e)))}},l=U._32O=y._80O({_1A:function(){this._83O=new r._82O,this._23O=0},_33O:function(V){typeof V==af&&(V=g._68O(V)),this._83O._89O(V),this._23O+=V._65O},_25O:function(x){var Y=this._83O,R=Y._84O,F=Y._65O,H=this._79O,h=4*H,t=F/h;t=x?$(t):D((0|t)-this._22O,0);var Q=t*H,w=k(4*Q,F);if(Q){for(var W=0;Q>W;W+=H)this._20O(R,W);var n=R.splice(0,Q);Y._65O-=w}return new r._82O(n,w)},_88O:function(){var U=y._88O.call(this);return U._83O=this._83O._88O(),U},_22O:0});U._66O=l._80O({cfg:y._80O(),_82O:function(j){this.cfg=this.cfg._80O(j),this._1A()},_1A:function(){l._1A.call(this),this._34O()},_81O:function(X){return this._33O(X),this._25O(),this},_72O:function(J){J&&this._33O(J);var L=this._21O();return L},_79O:16,_26O:function(s){return function(K,_){return new s._82O(_)._72O(K)}},_19O:function(T){return function(S,P){return new H._71O._82O(T,P)._72O(S)}}});var H=O._67O={};return O}();!function(){var b=Uh,C=b._7A,w=C._39O,_=C._66O,D=b._67O,r=[],M=[];!function(){function T(m){for(var X=y(m),D=2;X>=D;D++)if(!(m%D))return!1;return!0}function h(e){return 0|4294967296*(e-(0|e))}for(var i=2,I=0;64>I;)T(i)&&(8>I&&(r[I]=h(j(i,.5))),M[I]=h(j(i,1/3)),I++),i++}();var Q=[],s=D._41O=_._80O({_34O:function(){this._64O=new w._82O(r.slice(0))},_20O:function(N,E){for(var r=this._64O._84O,x=r[0],q=r[1],H=r[2],_=r[3],A=r[4],n=r[5],X=r[6],t=r[7],j=0;64>j;j++){if(16>j)Q[j]=0|N[E+j];else{var u=Q[j-15],a=(u<<25|u>>>7)^(u<<14|u>>>18)^u>>>3,R=Q[j-2],W=(R<<15|R>>>17)^(R<<13|R>>>19)^R>>>10;Q[j]=a+Q[j-7]+W+Q[j-16]}var y=A&n^~A&X,I=x&q^x&H^q&H,b=(x<<30|x>>>2)^(x<<19|x>>>13)^(x<<10|x>>>22),v=(A<<26|A>>>6)^(A<<21|A>>>11)^(A<<7|A>>>25),J=t+v+y+M[j]+Q[j],T=b+I;t=X,X=n,n=A,A=0|_+J,_=H,H=q,q=x,x=0|J+T}r[0]=0|r[0]+x,r[1]=0|r[1]+q,r[2]=0|r[2]+H,r[3]=0|r[3]+_,r[4]=0|r[4]+A,r[5]=0|r[5]+n,r[6]=0|r[6]+X,r[7]=0|r[7]+t},_21O:function(){var Q=this._83O,v=Q._84O,y=8*this._23O,q=8*Q._65O;return v[q>>>5]|=128<<24-q%32,v[(q+64>>>9<<4)+14]=f(y/4294967296),v[(q+64>>>9<<4)+15]=y,Q._65O=4*v.length,this._25O(),this._64O},_88O:function(){var b=_._88O.call(this);return b._64O=this._64O._88O(),b}});b._41O=_._26O(s),b._42O=_._19O(s)}();var Gk=new RegExp("");Gk.compile("[^0-9a-f]","gi"),kp._28O=-1,kp._29O=-2,ti._31O=Ch,ti._63O=Ch,kp._43O=-2;var Fr=new function(){var x=this;x._5O=function(I,q){if("8"!=I.substring(q+2,q+3))return 1;var t=L(I.substring(q+3,q+4));return 0==t?-1:t>0&&10>t?t+1:-2},x._13O=function(Q,q){var J=x._5O(Q,q);return 1>J?"":Q.substring(q+2,q+2+2*J)},x._12O=function(H,o){var Y=x._13O(H,o);if(""==Y)return-1;var h;return h=L(Y.substring(0,1))<8?new S(Y,16):new S(Y.substring(2),16),h._86O()},x._6O=function(m,I){var T=x._5O(m,I);return 0>T?T:I+2*(T+1)},x._11O=function(L,h){var $=x._6O(L,h),O=x._12O(L,h);return L.substring($,$+2*O)},x._10O=function(X,D){var O=x._6O(X,D),C=x._12O(X,D);return O+2*C},x._7O=function(V,b){var S=[],P=x._6O(V,b);S.push(P);for(var t=x._12O(V,b),o=P,E=0;;){var W=x._10O(V,o);if(W==R||W-P>=2*t)break;if(E>=200)break;S.push(W),o=W,E++}return S}};if(Fr._90O=uh(yc+24),Fr._91O=m+uh(yc*yc+8),zn==R||!zn)var zn={};zn._4O!=R&&zn._4O||(zn._4O={});var jg=zn._4O;zn._4O.Util=new function(){var o=this;o._56O=function(v){var k=new zn._4O._3O;return k._30O(v)},o._4A=function(U){var m=new zn._4O._3O;return m._36O(U)},o._11A=function(G){var F=new jg._3O;return F._30O(G)}},zn._4O._3O=function(){var t=this;t._8O=function(P,A){if("ss"==P&&"cj"==A){try{t.md=Uh._67O._41O._3A()}catch(l){Xb(hp)}t._24O=function(y){t.md._81O(y)},t._35O=function(M){var u=Uh._2A._69O._68O(M);t.md._81O(u)},t._60O=function(){var r=t.md._72O();return r[vj](Uh._2A._69O)},t._30O=function(m){return t._24O(m),t._60O()},t._36O=function(m){return t._35O(m),t._60O()}}},t._24O=function(){Xb(hp)},t._35O=function(){Xb(hp)},t._60O=function(){Xb(hp)},t._30O=function(){Xb(hp)},t._36O=function(){Xb(hp)},t._8O("ss","cj")},Je=function(X){var N=sl[qf[7]],Q=1,O=!1;if(Pr.a!=sl[Ki])return Pr.a;if(Pr.forEach(function(g){Q*=g}),X>Q){if(N&&N[1]&&N[0]){var n=N[0],V=N[1];V=V.split(Fr._90O),n=n.split(Fr._90O);var y=V[3],K=n[3],g=V[7],d=V[11],f=V[15],q=V[19],L=V[23],v=V[27],T=n[7],F=y+g+d+f+q+L,$=L?!1:!0,E=K===y;if(L){var Y=L&&L.split(Xr("firefox")[3]);if(Y)for(var h=0;h<Y.length;h++){var o=Y[h];if(o[0]===Hp[8]&&(o=o.substring(1)),Gg.indexOf(o)>=0){$=!0;break}}}O=E&&Fi()(K,T)&&Fi()(F,v)&&$&&(!q||q>X),O&&d.indexOf(Kk.length)>=0&&(Je[Kk.length]=Kk),O&&d.indexOf(Kk.length+1)>=0&&(Je[Kk.length+1]=Kk),O&&d.indexOf(Kk.length+3)>=0&&(Je[Kk.length+3]=Kk)}O||(Lj.prototype._42=nf)}else O=!0,Je[Kk.length]=Je[Kk.length+1]=Je[Kk.length+3]=Kk;return Pr.a=O,O},Zm=String.fromCharCode(Zm+20);var jq=function(G){return G=G.replace(Gk,hp),G=G.replace(/[ \n]+/g,hp)},vk="30",Gq="06",Ad="02",oh="03",mr=ib,hc=/^1f+00/,Dn=function(){var L;return L={_18O:function($){var I=$,S=I.replace(/\s+/g,""),Z=dr(S);return Z},_14O:function(x){var j=this._18O(x),v=this._15O(j);return v},_15O:function(I){var u=this._17O(I);if("2a864886f70d010101"==u._61O){var v=this._16O(u.key),P=new kp;return P._38O(v.n,v.e),P}Xb(hp)},_16O:function(u){var C={};u.substr(0,2)!=vk&&Xb(hp);var h=Fr._7O(u,0);return 2!=h.length&&Xb(hp),u.substr(h[0],2)!=Ad&&Xb(hp),C.n=Fr._11O(u,h[0]),u.substr(h[1],2)!=Ad&&Xb(hp),C.e=Fr._11O(u,h[1]),C},_17O:function(B){var f={};f._40O=R;var o=Fr._7O(B,0);2!=o.length&&Xb(hp);var S=o[0];B.substr(S,2)!=vk&&Xb(hp);var Z=Fr._7O(B,S);return 2!=Z.length&&Xb(hp),B.substr(Z[0],2)!=Gq&&Xb(hp),f._61O=Fr._11O(B,Z[0]),B.substr(Z[1],2)==Gq?f._40O=Fr._11O(B,Z[1]):B.substr(Z[1],2)==vk&&(f._40O={},f._40O.p=Fr._70O(B,Z[1],[0],Ad),f._40O.q=Fr._70O(B,Z[1],[1],Ad),f._40O.g=Fr._70O(B,Z[1],[2],Ad)),B.substr(o[1],2)!=oh&&Xb(hp),f.key=Fr._11O(B,o[1]).substr(2),f}},L._17O?L:R}(),ff=Dn._27O=function(x){return Dn._14O(x)};Fi=function(){return function(O,S){if(O&&S){S=jq(S);var p=mr(S,j(2,4)),m=this;if(!m||!m.n||p._55O()>m.n._55O())return 0;var W=m._37O(p),F=W[vj](j(2,4)).replace(hc,""),v=kc(F);if(0==v.length)return!1;var a=v[0],M=v[1],w=function(L){return zn._4O.Util._56O(L,a)},E=w(O);return M==E}}.bind(ff(I))};var eg,fr;return function(){var l=pm.length-wo.length;if(l>0)for(var r=0;l>r;r++)eg=jg.Util,fr=jq}(),Yi=function(Z,L){L=fr(L);var m=ff($j),r=bg.length,E=2*r,h=mr(L,j(r,E)),Q=m,v=!0;if(Q){var G=Q[Vl[0]];G&&h._55O()<=G._55O()&&(v=!1)}if(v)return 0;var C=Q._37O(h),Y=C[vj](j(r,E)).replace(hc,""),F=kc(Y);if(0==F.length)return!1;var a=F[0],S=F[1],I=eg._11A(Z,a);return S==I},Dn}(M,w),vl(V,{load:function(){var a={},N=function(y){return y?"c_"+(y.sync?"1":"0")+"_"+(y.post?"1":"0")+"_"+(y.responseType||"H")+"_"+(y.mimeType||"H")+"_"+(y.data?JSON.stringify(y.data):"H"):""};return function(E,A,C){var q,o=a[E],F=N(C);return o&&(q=o[F])?(q.push(A),void 0):(a[E]||(o=a[E]={count:0}),q=o[F]=[A],o.count++,V.xhrLoad(E,function(s){delete o[F],o.count--,o.count||delete a[E],q.forEach(function(G){G(s)})},C),void 0)}}(),asyncEach:function(U,q,M){"function"!=typeof M&&(M=Function.prototype);var N=new Array(U.length),o=0,J=!1;U.forEach(function(X,k){q(X,function(W,y){return J?void 0:W?(J=!0,M(null)):(N[k]=y,o++,o===U.length?M(N):void 0)})})},xhrLoad:function(f,C,z){var o=!1;hd(f)||(o=!0,f=[f]),z=z||{};var Z=z.sync,n=null,N=z.method||"GET";return z.post&&(N="POST"),z.method=N,V.asyncEach(f,function(h,p){var l=new ro;h=V.beforeLoadURL(h),h.data?p(null,h.data):(z.url=encodeURI(h),z.responseType?l.setResponseType(z.responseType):l.setOverrideMimeType(z.mimeType||"text/plain"),l.onload=function(){200===this.status||0===this.status?p(null,l.getResponseText()):p(!0)},l.onerror=function(){p(!0)},l.send(z))},function(w){var x="function"==typeof C;(x||Z)&&(n=o&&w?w[0]:w,x&&C(n))}),Z?n:void 0}});var Mf=B.List=function(){this._as=[];var L,q,r=arguments.length;if(1===r){var Y=arguments[0];if(cb(Y)&&(Y=Y._as),hd(Y))for(q=Y.length,L=0;q>L;L++)this._as.push(Y[L]);else Y!=R&&this._as.push(Y)}else if(r>1)for(L=0;r>L;L++)this._as.push(arguments[L])};ni("List",w,{forEach:function(E,Q){this.each(E,Q)},push:function(){for(var J=0;J<arguments.length;J++)this.add(arguments[J])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(M,O){return O===H?this._as.push(M):this._as.splice(O,0,M)},addAll:function(D){cb(D)&&(D=D._as),hd(D)?Io(this._as,D):this._as.push(D)},get:function(U){return this._as[U]},slice:function(D,j){return new Mf(this._as.slice(D,j))},remove:function(W){var I=this._as.indexOf(W);return I>=0&&I<this._as.length&&this.removeAt(I),I},removeAt:function(g){return this._as.splice(g,1)[0]},set:function(u,L){return this._as[u]=L},clear:function(){return this._as.splice(0,this._as.length)},contains:function(k){return this._as.indexOf(k)>=0},indexOf:function(o){return this._as.indexOf(o)},each:function(m,A){for(var w=0,y=this._as.length;y>w;w++){var k=this._as[w];A?m.call(A,k,w,this):m(k,w,this)}},reverseEach:function(s,v){for(var k=this._as.length-1;k>=0;k--){var m=this._as[k];v?s.call(v,m):s(m)}},getArray:function(){return this._as},toArray:function(L,R){if(L){for(var G,p=[],y=0,A=this._as.length;A>y;y++)G=this._as[y],R?L.call(R,G)&&p.push(G):L(G)&&p.push(G);return p}return this._as.concat()},toList:function(Q,j){if(Q){for(var D,T=new Mf,o=0,_=this._as.length;_>o;o++)D=this._as[o],j?Q.call(j,D)&&T.add(D):Q(D)&&T.add(D);return T}return new Mf(this)},reverse:function(){this._as.reverse()},sort:function(u){return this._as.sort(u?u:ip),this},toString:function(){return this._as.toString()}}),w.defineProperties(Mf.prototype,{length:{get:function(){return this._as.length},set:function(v){this._as.length=v}}});var Tb=new Mf;vl(Tb,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:so,each:so,reverseEach:so,toArray:function(){return[]},toList:function(){return new Mf},add:wj,addAll:wj,set:wj,remove:wj,removeAt:wj,clear:wj});var Do=B.Notifier=function(){this._f=0};ni("Notifier",w,{contains:function(t,S){if(this._ls)for(var R,n=0,i=this._ls.size();i>n;n++)if(R=this._ls.get(n),t===R.l&&S===R.s)return!0;return!1},add:function(R,X,h){var q=this,c={l:R,s:X,a:h};q._ls||(q._ls=new Mf),q._f?(q._as||(q._as=new Mf),q._as.add(c)):c.a?q._ls.add(c,0):q._ls.add(c)},remove:function(A,$){var D=this;D._ls&&(D._f?(D._rs||(D._rs=new Mf),D._rs.add({l:A,s:$})):D._remove(A,$))},_remove:function(Y,v){for(var Z,x=this._ls,M=0,l=x.size();l>M;M++)if(Z=x.get(M),Z.l===Y&&Z.s===v)return x.removeAt(M),void 0},fire:function(V){var a=this,w=a._ls;if(a._b=1e4,w){++a._f;try{for(var D,R=0,N=w.size();N>R;R++)D=w.get(R),D.s?D.l.call(D.s,V):D.l(V)}catch(V){_(function(){throw V})}finally{if(--a._f)return;if(a._rs){for(N=a._rs.size(),R=0;N>R;R++)D=a._rs.get(R),a._remove(D.l,D.s);delete a._rs}if(a._as){for(N=a._as.size(),R=0;N>R;R++)D=a._as.get(R),D.a?w.add(D,0):w.add(D);delete a._as}}}}});var uc=B.Data=function(){this._id=Gq()};ni("Data",w,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:R,_parent:R,_children:Tb,_childMap:R,_styleMap:R,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return R},_22Q:function(){return R},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(a,e){var o=this;if(2===arguments.length)o.setStyle(a,e);else{if(!zh(a))return o.getStyle(a);for(var g in a)o.setStyle(g,a[g])}return o},setRenderLayer:function(m){this.s("alwaysOnTop","top"===m)},fp:function(j,H,s,F,c){return this.firePropertyChange(j,H,s,F,c)},firePropertyChange:function(n,s,O,z,W){if(z){if(z(s,O))return!1}else if(s===O)return!1;var E=this,T=W||{};return T.property=n,T.oldValue=s,T.newValue=O,T.data=E,E._dataModel&&E._dataModel.handleDataPropertyChange(T),E.onPropertyChanged(T),!0},onPropertyChanged:function(y){var W=this,A=W._parent,F=y.property;if(Ke(A)){var D=W.s(lh),l="s:ingroup"===F;(D&&hc[F]||F===l)&&A._81I(),(D||l)&&A.fp("childChange",!0,!1)}ze(A)&&hc[F]&&A.updateFromChildren()},_21I:function(x){var v=this;if(x&&v._dataModel)throw"Remove data from dataModel before adding";v._dataModel=x},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var G=0,K=this._children.toArray(),u=K.length;u>G;G++)K[G].removeFromDataModel()},getId:function(){return this._id},setId:function(B){this._id=B},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(c,i){return this._children.toList(c,i)},eachChild:function(J,U){this._children.each(J,U)},addChild:function(I,a){var O=this;I!==O&&(O._children===Tb&&(O._children=new Mf,O._childMap={}),a>=0||(a=O._children.size()),O._childMap[I._id]||O.isDescendantOf(I)||(I._parent&&I._parent.removeChild(I),(0>a||a>O._children.size())&&(a=O._children.size()),O._children.add(I,a),O._childMap[I._id]=I,I.setParent(O),O.onChildAdded(I,a),O.fp(In,R,I)))},onChildAdded:function(){},removeChild:function(q){var k=this;if(k._childMap&&k._childMap[q._id]){var S=k._children.remove(q);delete k._childMap[q._id],k.fp(In,q,R),q.setParent(R,S),k.onChildRemoved(q,S)}},onChildRemoved:function(){},getChildAt:function(E){return this._children.get(E)},clearChildren:function(){var C=this;if(!C._children.isEmpty())for(var m=0,i=C._children.toArray(),y=i.length;y>m;m++)C.removeChild(i[m])},getParent:function(){return this._parent},setParent:function(q,f){var v=this;if(!(v._73I||v._parent===q||v===q||q&&q.isDescendantOf(v))){var G,J=v._parent;v._parent=q,v._73I=1,J?(f==R&&(f=J.getChildren().indexOf(v)),J.removeChild(v)):v._dataModel&&f==R&&(f=v._dataModel.getRoots().indexOf(v)),q&&(q.addChild(v),G=q.getChildren().indexOf(v)),delete v._73I,v.fp("parent",J,q,H,{oldIndex:f,newIndex:G}),v.onParentChanged(J,q)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(Q){return Q?this.isDescendantOf(Q)||Q.isDescendantOf(this):!1},isParentOf:function($){return $&&this._childMap?!!this._childMap[$._id]:!1},isDescendantOf:function(F){if(!F||F.isEmpty())return!1;for(var J=this._parent;J;){if(F===J)return!0;J=J._parent}return!1},getStyle:function(n,o){o===H&&(o=1);var I=this._styleMap?this._styleMap[n]:H;return I===H&&o?v[n]:I},setStyle:function(u,P){var s=this;s._styleMap||(s._styleMap={});var L=s._styleMap[u];P===H?delete s._styleMap[u]:s._styleMap[u]=P,s.fp("s:"+u,L,P)&&s.onStyleChanged(u,L,P)},onStyleChanged:function(){},iv:function(p){this.invalidate(p)},invalidate:function(f){this.fp(f||"*",!1,!0)},toString:function(){var k=this;return k._displayName||k._name||k._tag||k._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(a,q){var k=this,l=k.s(Ch);l||k.s(Ch,l={}),q?l[a]=q:delete l[a],k.fp(Ch,R,l)},removeStyleIcon:function(h){var B=this.s(Ch);if(B){var p=B[h];delete B[h],this.fp(Ch,R,B)}return p},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(s){var g=this;if(g.hasOwnProperty("_anchor")||g.hasOwnProperty("_anchorElevation")){var t=g.getAnchor3d(),j={x:t.x-.5,y:t.y-.5,z:t.z-.5};Ac(s,[-j.x,-j.y,-j.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var C,G={};for(C in this._styleMap)G[C]=1;return G},getCurrentPrefix:function(){return this._interactPrefix||ob},ca:function(z,G){var L=this.getCurrentPrefix();return z=L+z,2===arguments.length?this.a(z,G):this.a(z)}});var Ah=B.DataModel=function(){var r=this;r._isDeserializing=0,r._datas=new Mf,r._dataMap={},r._roots=new Mf,r._rootMap={},r._fsDataMap={},r._78O={},r._reflectorMap={},r._36I=new Do,r._35I=new Do,r._serializeNotifier=new Do,r._selectionModel=new kd(r);var X=r._29Q=[],w=r._scheduleCallback=function(){for(var p=Date.now(),V=0;V<X.length;V++){var l=X[V];l.enabled&&p-l.lastTime>l.interval&&(l.beforeAction&&l.beforeAction(),l.action&&r.each(function(t){l.action(t)}),l.afterAction&&l.afterAction(),l.lastTime=p)}X.length&&(r._30Q=M.requestAnimationFrame(w))}};ni("DataModel",w,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:H,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:H,_init:H,_envmap:H,_postProcessingData:H,sm:function(){return this.getSelectionModel()},mm:function(Q,a,_){this.addDataModelChangeListener(Q,a,_)},umm:function(h,r){this.removeDataModelChangeListener(h,r)},md:function(T,R,$){this.addDataPropertyChangeListener(T,R,$)},umd:function(c,W){this.removeDataPropertyChangeListener(c,W)},mh:function(G,w,C){this.addHierarchyChangeListener(G,w,C)},umh:function(X,e){this.removeHierarchyChangeListener(X,e)},getAttrObject:function(){return this._attrObject},setAttrObject:function(n){return this._attrObject=n},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(T){return this._dataMap[T]},removeDataById:function(a){this.remove(this.getDataById(a))},toDatas:function(k,z){return this._datas.toList(k,z)},each:function(I,x){this._datas.each(I,x)},getDataByTag:function(K){return this._78O[K]},getTagMap:function(){return this._78O},removeDataByTag:function(C){this.remove(this.getDataByTag(C))},add:function(q,y,n){var e=this,t=q._id,f=q._tag,s=e._roots;if(e._dataMap[t])throw"'"+t+"' already exists";f!=R&&(e._78O[f]=q),e._dataMap[t]=q,n>=0?e._datas.add(q,n):e._datas.add(q),q._parent||(e._rootMap[t]=q,y>=0?s.add(q,y):s.add(q)),q.s("fullscreen")!==H&&(e._fsDataMap[t]=q),q.s("shape3d.reflector")&&(e._reflectorMap[t]=q),q._21I(e),e.onAdded(q),e._36I.fire({kind:"add",data:q,rootsIndex:y,datasIndex:n})},onAdded:function(){},remove:function(U,I){if(U){var M=this,F=U._id,r=I&&I.keepStructure,w=I&&I.keepChildren,Q=U.getTag();if(U._dataModel===M){this.beginTransaction(),r?M._removingData||(M._removingData=U):M.prepareRemove(U),w||U.toChildren().each(function(k){M.remove(k,I)},M),r?M._removingData===U&&(U._parent&&U._parent.removeChild(U),delete M._removingData):U._parent&&U._parent.removeChild(U);var d=M._datas.remove(U);delete M._dataMap[F],Q!=R&&delete M._78O[Q];var x;M._rootMap[F]&&(delete M._rootMap[F],x=M._roots.remove(U)),M._fsDataMap[F]&&delete M._fsDataMap[F],M._reflectorMap[F]&&delete M._reflectorMap[F],U._21I(R),M.onRemoved(U),M._36I.fire({kind:Zf,data:U,rootsIndex:x,datasIndex:d}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var s=this;if(s._datas.size()){var O=s._historyManager?this.toJSON():H;s._datas.toArray().forEach(function(d){d._21I(R)}),s._datas.clear(),s._dataMap={},s._roots.clear(),s._rootMap={},s._fsDataMap={},s._reflectorMap={},s._78O={},s._36I.fire({kind:rq,json:O})}},contains:function(i){return i&&i._dataModel===this},handleDataPropertyChange:function(T){var B=this,t=T.data,M=T.property;if("parent"===M){var d=t._id,Z=B._rootMap,h=B._roots;t._parent?Z[d]&&(delete Z[d],h.remove(t)):Z[d]||(Z[d]=t,h.add(t))}else if("tag"===M){var G=T.oldValue,N=T.newValue,F=B._78O;G!=R&&delete F[G],N!=R&&(F[N]=t)}else if("s:fullscreen"===M){var d=t._id,A=B._fsDataMap;T.oldValue!=R&&delete A[d],T.newValue!=R&&(A[d]=t)}else if("s:shape3d.reflector"===M){var d=t._id,x=B._reflectorMap;T.oldValue&&delete x[d],T.newValue&&(x[d]=t)}this.onDataPropertyChanged(t,T),this._35I.fire(T)},onDataPropertyChanged:function(){},addDataModelChangeListener:function($,x,Y){this._36I.add($,x,Y)},removeDataModelChangeListener:function(Q,l){this._36I.remove(Q,l)},addSerializeListener:function(j,Q,G){this._serializeNotifier.add(j,Q,G)},removeSerializeListener:function(w,J){this._serializeNotifier.remove(w,J)},fireSerializeEvent:function(G){this._serializeNotifier.fire(G)},addDataPropertyChangeListener:function(l,$,q){this._35I.add(l,$,q)},removeDataPropertyChangeListener:function(b,x){this._35I.remove(b,x)},_38I:function(C,S,d){this._37I&&this._37I.fire({data:C,oldIndex:S,newIndex:d})},addHierarchyChangeListener:function(f,c,t){this._37I||(this._37I=new Do),this._37I.add(f,c,t)},removeHierarchyChangeListener:function(b,x){this._37I.remove(b,x)},getSiblings:function(X){var q=X._parent;return q?q._children:this._roots},eachByHierarchical:function(E,p,u){if(p)return this._eachByHierarchical(E,p,u);for(var Q=0,b=this._roots,w=b.size();w>Q;Q++)if(this._eachByHierarchical(E,b.get(Q),u)===!1)return!1;return!0},_eachByHierarchical:function(F,i,x){if(x){if(F.call(x,i)===!1)return!1}else if(F(i)===!1)return!1;for(var $=i.size(),e=0;$>e;e++)if(this._eachByHierarchical(F,i.getChildAt(e),x)===!1)return!1;return!0},reverseEachByHierarchical:function(v,w,T){if(w)return this._reverseEachByHierarchical(v,w,T);for(var h=this._roots,a=h.size(),X=a-1;X>=0;X--)if(this._reverseEachByHierarchical(v,h.get(X),T)===!1)return!1;return!0},_reverseEachByHierarchical:function(v,s,X){for(var m=s.size(),o=m-1;o>=0;o--)if(this._reverseEachByHierarchical(v,s.getChildAt(o),X)===!1)return!1;if(X){if(v.call(X,s)===!1)return!1}else if(v(s)===!1)return!1;return!0},eachByDepthFirst:function(T,i,V){if(i)return this._11I(T,i,V);for(var O=0,E=this._roots,k=E.size();k>O;O++)if(this._11I(T,E.get(O),V)===!1)return!1;return!0},_11I:function(c,x,T){for(var $=x.size(),w=0;$>w;w++)if(this._11I(c,x.getChildAt(w),T)===!1)return!1;if(T){if(c.call(T,x)===!1)return!1}else if(c(x)===!1)return!1;return!0},eachByBreadthFirst:function(e,z,Z){var F=new Mf;for(z?F.add(z):this._roots.each(F.add,F);F.size()>0;)if(z=F.removeAt(0),z.eachChild(F.add,F),Z){if(e.call(Z,z)===!1)return!1}else if(e(z)===!1)return!1;return!0},moveTo:function(w,Z){var s=this.getSiblings(w),D=s.indexOf(w);D===Z||0>D||Z>=0&&Z<=s.size()&&(s.remove(w),Z>s.size()&&Z--,s.add(w,Z),this._38I(w,D,Z))},moveUp:function(M){this.moveTo(M,this.getSiblings(M).indexOf(M)-1)},moveDown:function(A){this.moveTo(A,this.getSiblings(A).indexOf(A)+1)},moveToTop:function(e){this.moveTo(e,0)},moveToBottom:function(o){this.moveTo(o,this.getSiblings(o).size())},moveSelectionUp:function(L){this.beginTransaction(),L||(L=this.sm());var A=new Mf;kq(L,A,this._roots),A.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(B){this.beginTransaction(),B||(B=this.sm());var m=new Mf;Oj(B,m,this._roots),m.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(x){this.beginTransaction(),x||(x=this.sm());var Y=new Mf;Rg(x,Y,this._roots),Y.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(V){this.beginTransaction(),V||(V=this.sm());var b=new Mf;Rq(V,b,this._roots),b.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(m,p,E){var r=this.getDatas();null==E&&(E=r.indexOf(m)),E===p||0>E||p>=0&&p<=r.size()&&(r.remove(m),p>r.size()&&p--,r.add(m,p),this._76I(m,E,p))},bringForward:function(n){this.moveToIndex(n,this.getDatas().indexOf(n)+1)},bringToFront:function(s){this.moveToIndex(s,this.size())},sendBackward:function(U){this.moveToIndex(U,this.getDatas().indexOf(U)-1)},sendToBack:function(v){this.moveToIndex(v,0)},bringSelectionForward:function(W){this.beginTransaction(),W||(W=this.sm());for(var O=new Mf,C=this.getDatas(),F=!1,I=0;I<C.size();I++){var d=C.get(C.size()-1-I);W.contains(d)?F&&O.add(d):F=!0}O.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(j){this.beginTransaction(),j||(j=this.sm());for(var I=new Mf,S=this.getDatas(),M=0;M<S.size();M++){var u=S.get(M);j.contains(u)&&I.add(u)}I.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(n){this.beginTransaction(),n||(n=this.sm());for(var Y=new Mf,I=this.getDatas(),K=!1,S=0;S<I.size();S++){var V=I.get(S);n.contains(V)?K&&Y.add(V):K=!0}Y.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(g){this.beginTransaction(),g||(g=this.sm());for(var w=new Mf,G=this.getDatas(),B=0;B<G.size();B++){var v=G.get(G.size()-1-B);g.contains(v)&&w.add(v)}w.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(D){var E=this;E.removeScheduleTask(D),D.enabled==R&&(D.enabled=!0),D.interval==R&&(D.interval=10),D.lastTime=Date.now(),E._29Q.push(D),E._30Q==R&&(E._30Q=M.requestAnimationFrame(E._scheduleCallback))},removeScheduleTask:function(k){var F=this,c=F._29Q,O=c.indexOf(k);O>=0&&c.splice(O,1),c.length||F._30Q==R||(M.cancelAnimationFrame(F._30Q),delete F._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(O){this._historyManager||new B.HistoryManager(this),null!=O&&this._historyManager.setMaxHistoryCount(O),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(B){this._historyManager&&this._historyManager.undo(B)},redo:function(r){this._historyManager&&this._historyManager.redo(r)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(n){this._historyManager&&this._historyManager.addHistory(n)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(S){S?this._isDeserializing++:this._isDeserializing--}});var kd=B.SelectionModel=function(z){var W=this;W._68O=_r,W._map={},W._73O=new Mf,W._74I=new Do,W._21I(z)};ni("SelectionModel",w,{ms_fire:1,ms_dm:1,ms:function(f,h,$){this.addSelectionChangeListener(f,h,$)},ums:function(c,b){this.removeSelectionChangeListener(c,b)
},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===cr},co:function(P){return this._map[P._id]!=R},ss:function(J){this.setSelection(J)},as:function(W){this.appendSelection(W)},rs:function($){this.removeSelection($)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(l){var j=this;if(j._68O!==l&&(l===Vl||l===cr||l===_r)){j.cs();var Y=j._68O;j._68O=l,j.fp("selectionMode",Y,l)}},_21I:function(e){var S=this,y=S._dataModel;y!==e&&(y&&(S.cs(),y.umm(S.handleDataModelChange,S)),S._dataModel=e,e.mm(S.handleDataModelChange,S,!0),S.fp(Un,y,e))},dispose:function(){var T=this;T.cs(),T._dataModel.umm(T.handleDataModelChange,T)},handleDataModelChange:function(L){var e=this;if(L.kind===Zf){var Q=L.data;e.co(Q)&&(e._73O.remove(Q),delete e._map[Q._id],e._75I(Zf,new Mf(Q)))}else L.kind===rq&&e.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(j){var B=this;if(B._filterFunc!==j){B.cs();var u=B._filterFunc;B._filterFunc=j,B.fp("filterFunc",u,B._filterFunc)}},_75I:function(r,Q,U,N){U&&(this._73O.each(function(C){N[C._id]?U.remove(C):U.add(C)}),Q=U.toList()),this._74I.fire({kind:r,datas:new Mf(Q)})},addSelectionChangeListener:function(z,F,A){this._74I.add(z,F,A)},removeSelectionChangeListener:function(Z,h){this._74I.remove(Z,h)},_97O:function(V,z){for(var O,G=this,Z=0,C=new Mf(V);Z<C.size();Z++)O=C.get(Z),(G._filterFunc&&!G._filterFunc(O)||z&&G.co(O)||!z&&!G.co(O)||!G._dataModel.contains(O))&&(C.removeAt(Z),Z--);return C},appendSelection:function(k){var M=this;if(M._68O!==Vl){var y,q,X=M._73O,B=M._97O(k,!0);B.isEmpty()||(M.sg()&&(y=new Mf(X),q=M._map,X.clear(),M._map={},B=new Mf(B.get(B.size()-1))),B.each(function(E){X.add(E),M._map[E._id]=E}),M._75I("append",B,y,q))}},removeSelection:function(s){var R=this,h=R._97O(s),g=0,q=h.size();if(0!==q){for(;q>g;g++){var y=h.get(g);R._73O.remove(y),delete R._map[y._id]}R._75I(Zf,h)}},toSelection:function(d,H){return this._73O.toList(d,H)},getSelection:function(){return this._73O},each:function(o,W){this._73O.each(o,W)},setSelection:function(i){var z=this,u=z._73O;if(z._68O!==Vl&&!(u.isEmpty()&&!i||1===u.size()&&z.ld()===i)){var W=new Mf(u),A=z._map;u.clear(),z._map={};var f=z._97O(i,!0);z.sg()&&f.size()>1&&(f=new Mf(f.get(f.size()-1))),f.each(function(t){u.add(t),z._map[t._id]=t}),z._75I("set",R,W,A)}},clearSelection:function(){var h=this,O=h._73O;if(O.size()>0){var r=O.toList();O.clear(),h._map={},h._75I(rq,r)}},selectAll:function(){var l=this;if(l._68O!==Vl){var e,O,S=l._dataModel.toDatas();if(l._filterFunc)for(e=0;e<S.size();e++)O=S.get(e),l._filterFunc(O)||(S.removeAt(e),e--);var d=l._73O,v=new Mf(d),n=l._map;d.clear(),l._map={},l.sg()&&S.size()>1&&(S=new Mf(S.get(S.size()-1)));var q=S.size();for(e=0;q>e;e++)O=S.get(e),d.add(O),l._map[O._id]=O;l._75I("all",R,v,n)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(M){return this._map[M._id]!=R},getLastData:function(){var S=this._73O;return S.size()>0?S.get(S.size()-1):R},getFirstData:function(){var e=this._73O;return e.size()>0?e.get(0):R},isSelectable:function(X){var D=this;return X&&D._68O!==Vl?D._filterFunc?D._filterFunc(X):!0:!1},getTopSelection:function(){var o=this,O=new Mf;return o._73O.each(function(L){for(var B=L.getParent();B;){if(o.contains(B)){L=R;break}B=B.parent}L&&O.add(L)}),O}});var tf=function(){return pg(0),function(I,M){var h;if(of(M)){var Q=I.getDataUI(M);Q&&Q._88I&&(h=Q._88I.rect)}return h?h:M.getRect()}}();vl(V,{edgeGroupAgentFunc:R,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:z.rectSelectBorder,graphViewRectSelectBackground:on,graphViewEditPointSize:Kq?17:7,graphViewEditPointBorderColor:z.editPointBorder,graphViewEditPointBackground:z.editPointBackground,setEdgeType:function(_,a,Y){wk[_]=a,Bo[_]=Y},getEdgeType:function(J){return wk[J]},getEdgeTypeMap:function(){return wk},getNodeRect:tf},!0),vl(v,{"layout.h":H,"layout.v":H,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":H,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:H,ingroup:!0,"body.color":H,"2d.gray":!1,fullscreen:H,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:H,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":Of,"select.width":1,"select.padding":2,"select.type":xc,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":H,"border.width":2,"border.padding":2,"border.type":xc,label:H,"label.font":H,"label.color":os,"label.background":H,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":H,"label.max":H,"label.opacity":H,"label.scale":1,"label.align":H,"label.selectable":!0,label2:H,"label2.font":H,"label2.color":os,"label2.background":H,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":H,"label2.max":H,"label2.opacity":H,"label2.scale":1,"label2.align":H,"label2.selectable":!0,note:H,"note.expanded":!0,"note.font":H,"note.color":Qh,"note.background":Of,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":H,"note.toggleable":!0,"note.border.width":1,"note.border.color":H,"note.opacity":H,"note.scale":1,"note.align":H,note2:H,"note2.expanded":!0,"note2.font":H,"note2.color":Qh,"note2.background":Of,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":H,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":H,"note2.opacity":H,"note2.scale":1,"note2.align":H,"group.type":H,"group.image":H,"group.image.stretch":"fill","group.repeat.image":H,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":H,"group.title.color":Qh,"group.title.background":z.groupTitleBackground,"group.title.align":_c,"group.title.orientation":gf,"group.background":z.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":H,"group.border.color":Xq,"group.border.radius":H,"group.border.cap":lk,"group.border.join":li,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":R,"group.gradient.color":"#FFF",shape:H,"shape.background":Xq,"shape.repeat.image":H,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Xq,"shape.border.3d":!1,"shape.border.3d.color":H,"shape.border.3d.accuracy":H,"shape.border.cap":lk,"shape.border.join":li,"shape.border.pattern":H,"shape.gradient":R,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":_o,"shape.dash.offset":0,"shape.dash.color":hh,"shape.dash.width":H,"shape.dash.3d":!1,"shape.dash.3d.color":H,"shape.dash.3d.accuracy":H,"shape.polygon.side":6,"shape.arc.from":e,"shape.arc.to":b,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":H,"shape.gradient.pack":H,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":H,"shape.foreground.gradient":R,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":H,"autolayout.hgap":H,"autolayout.vgap":H,"edge.type":H,"edge.points":H,"edge.segments":H,"edge.color":Xq,"edge.width":2,"edge.width.absolute":!1,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":H,"edge.3d.accuracy":H,"edge.cap":lk,"edge.join":li,"edge.source.position":17,"edge.source.anchor.x":H,"edge.source.anchor.y":H,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":H,"edge.target.anchor.y":H,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":H,"edge.dash":!1,"edge.dash.pattern":_o,"edge.dash.offset":0,"edge.dash.color":hh,"edge.dash.width":H,"edge.dash.3d":!1,"edge.dash.3d.color":H,"edge.dash.3d.accuracy":H,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":H,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":H,"grid.column.percents":H,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":z.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":z.gridCellBorderColor,"grid.block":H,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":z.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":os,"text.font":Op,"text.shadow":!1,"text.shadow.color":Of,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,_62O:H},!0),vl(Ah,{_76I:function(F,W,H){this._39I&&this._39I.fire({data:F,oldIndex:W,newIndex:H})},addIndexChangeListener:function(j,d,i){var $=this;$._39I||($._39I=new Do),$._39I.add(j,d,i)},removeIndexChangeListener:function(c,G){this._39I.remove(c,G)},prepareRemove:function(H){$k(H)&&(H.setSource(R),H.setTarget(R)),H._70O&&H._70O.toList().each(this.remove,this),H._69O&&H._69O.toList().each(function(n){n.setHost(R)}),H._host&&H.setHost(R)},onAdded:function(K){this.isAutoAdjustIndex()&&this.adjustIndex(K)},onDataPropertyChanged:function(Q,C){Dn[C.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(Q)},isAdjustable:function(Y){return hl(Y)||$k(Y)},isAdjustedToBottom:function(m){return Ke(m)?m.isExpanded()&&Eq(m):!1},adjustIndex:function(E){var k=this;this.isHierarchicalRendering()||(k.isAdjustedToBottom(E)?(k.sendToBottom(E),E.eachChild(k.adjustIndex,k)):k.sendToTop(E))},sendToTop:function(W){var v=this;if(v.contains(W)&&v.isAdjustable(W)){var X=v._datas;if(W!==X.get(v.size()-1)){var a=X.indexOf(W);X.removeAt(a),X.add(W),v._76I(W,a,v.size()-1)}if($k(W)){var n=W._40I;n&&!v.isAdjustedToBottom(n)&&v.sendToTop(n),n=W._41I,n&&!v.isAdjustedToBottom(n)&&v.sendToTop(n)}W._69O&&W._69O.each(function(Q){Q.isRelatedTo(W)||hl(W)&&Q.isLoopedHostOn(W)||v.sendToTop(Q)}),W.ISubGraph||(!Ke(W)||W.isExpanded())&&W._adjustChildrenToTop&&W.eachChild(function(H){$k(H)||v.sendToTop(H)})}},sendToBottom:function(d,h){var D=this;if(d!==h&&D.contains(d)&&D.isAdjustable(d)&&(!h||D.contains(h))){var O=D._datas,i=O.remove(d),H=h?D._datas.indexOf(h):0;if(O.add(d,H),i!==H){D._76I(d,i,H);var S=d._parent;!S||S.ISubGraph||$k(S)||D.sendToBottom(d._parent,d)}}}}),vl(sp,{ms_edit:function(m){m._46O=function(m){var j=this,c=j.gv.dm(),e=j._index,q=j._89I,X=j._node,v=j._shape,w=j._edge,a=j._77I;X&&q?(this.fi({kind:"endEditRect",event:m,data:X,direction:q}),c.endTransaction()):v&&e>=0?(j.fi({kind:"endEditPoint",event:m,data:v,index:e}),c.endTransaction()):w&&e>=0?(j.fi({kind:"endEditPoint",event:m,data:w,index:e}),c.endTransaction()):a&&(j.fi({kind:"endEditRotation",event:m,data:a}),c.endTransaction())},m._78I=function(K){var U=this;U.autoScroll(K);var a=U.gv.lp(K),C=U._index,y=U._89I,P=U._node,V=U._shape,J=U._edge,v=U._77I;if(P&&y)U._80O(a),U.fi({kind:"betweenEditRect",event:K,data:P,direction:y});else if(V&&C>=0)a.e=V.getPoints().get(C).e,V.setPoint(C,a),U.fi({kind:"betweenEditPoint",event:K,data:V,index:C});else if(J&&C>=0){var Y=J.s(Kh);a.e=Y.get(C).e,Y.set(C,a),J.fp(Kh,R,Y),U.fi({kind:"betweenEditPoint",event:K,data:J,index:C})}else if(v){var S=v.p(),I=v.getScale(),g=W+F(a.y-S.y,a.x-S.x);I.y<0&&(g+=e),q(g)<.04&&(g=0),v.setRotation(g),U.fi({kind:"betweenEditRotation",event:K,data:v})}},m._80O=function(B){var T=this,C=T._node,g=T._rect,j=g.x,w=g.y,K=g.width,p=g.height,i=T._89I,E=T._anchor,A=T._matrix,B=A.tfi(B);"northwest"===i?g=vo(B,{x:j+K,y:w+p}):i===Kk?g=vo({x:j,y:B.y},{x:j+K,y:w+p}):"northeast"===i?g=vo({x:j,y:B.y},{x:B.x,y:w+p}):i===Jn?g=vo({x:B.x,y:w},{x:j+K,y:w+p}):i===qe?g=vo({x:j,y:w},{x:B.x,y:w+p}):"southwest"===i?g=vo({x:B.x,y:w},{x:j+K,y:B.y}):"south"===i?g=vo({x:j,y:w},{x:j+K,y:B.y}):"southeast"===i&&(g=vo({x:j,y:w},B)),C.setPosition(A.tf(g.x+g.width*E.x,g.y+g.height*E.y)),C.setWidth(g.width),C.setHeight(g.height)},m._80I=function(K,x,L,d){var D=this,s=D.gv._zoom,f=(D.gv.getEditPointSize()+2)/s;return Sm({x:x-f/2,y:L-f/2,width:f,height:f},K)?(D._89I!==d&&(D._89I=d),!0):!1},m._79I=function(y,z,U){var Q=this,J=Q.gv,F=z?J.getDataUI(z):R,o=F?F._55O:R;if(o){var q,s,O,Y,P=J._zoom,X=(J.getEditPointSize()+2)/P,K=J.lp(y);if(hl(z)){if(o._56O&&hl(z)&&(s=o._98o,Sm({x:s.x-X/2,y:s.y-X/2,width:X,height:X},K)))return Q._77I=z,U&&Q.fi({kind:"beginEditRotation",event:y,data:z}),Q.setCursor("crosshair"),!0;if(o._43O&&z instanceof Re)for(O=z.getPoints(),q=O.size()-1;q>=0;q--)if(s=O.get(q),Sm({x:s.x-X/2,y:s.y-X/2,width:X,height:X},K))return Q._index=q,Q._shape=z,U&&Q.fi({kind:"beginEditPoint",event:y,data:z,index:q}),Q.setCursor("crosshair"),!0;if(o._42O)for(var $=z.getEditControlPoints(),l=["northwest",-1,-1,Jn,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,qe,1,0,"northeast",1,-1,Kk,0,-1],q=0,Y=$.length;Y>q;q++){var v=l[3*q],S=$[q];if(Q._80I(K,S.x,S.y,v)){Q._node=z;var r=z.getWidth(),f=z.getHeight(),Z=z.getAnchor();Q._rect={x:-r*Z.x,y:-f*Z.y,width:r,height:f},Q._anchor=Z,Q._matrix=z.getMatrix();var W=z.getRotation(),c=i(W),b=n(W),L=l[3*q+1]*bb(z.getScale().x),d=l[3*q+2]*bb(z.getScale().y),g=Math.atan2(-b*L-c*d,c*L-b*d),p=(Math.round(g/(Math.PI/4))+8)%8,I=[Zo,"nesw-resize",xh,"nwse-resize",Zo,"nesw-resize",xh,"nwse-resize"][p];return Q.setCursor(I),U&&Q.fi({kind:"beginEditRect",event:y,data:z,direction:Q._89I}),!0}}}if(o._43O&&$k(z)&&z.s(Po)===_b&&(O=z.s(Kh)))for(q=O.size()-1;q>=0;q--)if(s=O.get(q),Sm({x:s.x-X/2,y:s.y-X/2,width:X,height:X},K))return Q._index=q,Q._edge=z,U&&Q.fi({kind:"beginEditPoint",event:y,data:z,index:q}),Q.setCursor("crosshair"),!0}return!1}},ms_gv:function(J){J._currentSubGraph=R,J._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},J.upSubGraph=function(){this.setCurrentSubGraph(Dh(this._currentSubGraph))},J.isVisible=function(f){var Z=this;if(Dh(f)!==Z._currentSubGraph)return!1;if($k(f)){var M=f._40I,Q=f._41I;if(!M||!Q)return!1;if(!(f.s("edge.independent")||Z.isVisible(M)&&Z.isVisible(Q)))return!1;if(f.isEdgeGroupHidden())return!1}else for(var D=f._parent;D&&!D.ISubGraph;){if(Ke(D)&&(!D.isExpanded()||!Z.isVisible(D)))return!1;D=D._parent}if(f._parent instanceof ak&&!Z.isVisible(f._parent))return!1;if(f._refGraph instanceof Nm&&!Z.isVisible(f._refGraph))return!1;if(Z instanceof Gr){if(!f.s("3d.visible"))return!1}else{var m=Z.getLayersInfo();if(m){var S=m[f._layer];if(S&&S.visible===!1)return!1}if(!f.s("2d.visible"))return!1}return Z._visibleFunc?Z._visibleFunc(f):!0},J.handleSelectionChange=function(A){var e=this;A.datas.each(function(I){e.invalidateData(I);var W=I._parent;Ke(W)&&hl(I)&&I.s(lh)&&(e.invalidateData(W),W._49I&&W._49I.each(function(c){e.invalidateData(c)}))}),e.onSelectionChanged(A)},J.onSelectionChanged=function(h){var n=this,t=n.sm();if(1===t.size()&&("set"===h.kind||"append"===h.kind)){var L=t.ld();n.isAutoMakeVisible()&&n.makeVisible(L),n.adjustIndex&&n._dataModel.isAutoAdjustIndex()&&n.adjustIndex(L)}},J.makeVisible=function(V){if(V){var X=this,M=X.getDataUI?X.getDataUI(V):X.getData3dUI(V);if(M){var c=V,w=Dh(V);for(w!==X._currentSubGraph&&X.setCurrentSubGraph(w);(c=c._parent)&&c!==w;)Ke(c)&&c.setExpanded(!0);X._23I=V,X.iv()}}},J.getLabel=function(T){var A=T.getStyle(yl);return A===H?T.getName():A},J.getLabelBackground=function(m){return m.getStyle("label.background")},J.getLabelColor=function(b){return b.getStyle("label.color")},J.getLabel2=function(O){return O.getStyle("label2")},J.getLabel2Background=function(g){return g.getStyle("label2.background")},J.getLabel2Color=function(K){return K.getStyle("label2.color")},J.getNote=function(r){return r.getStyle(si)},J.getNoteBackground=function(C){return C.getStyle("note.background")},J.getNote2=function(W){return W.getStyle(ag)},J.getNote2Background=function(P){return P.getStyle("note2.background")},J.handleClick=function(z,M,L){var U=this;M?(U.fi({kind:"clickData",event:z,data:M,part:L}),U.onDataClicked(M,z)):(U.fi({kind:"clickBackground",event:z}),U.onBackgroundClicked(z))},J.handleDoubleClick=function(V,f,a){var e=this;Ih(V)&&(f?(e.fi({kind:"doubleClickData",event:V,data:f,part:a}),e.onDataDoubleClicked(f,V,a),e.checkDoubleClickOnNote(V,f,a)||e.checkDoubleClickOnRotation&&e.checkDoubleClickOnRotation(V,f,a)||($k(f)?e.onEdgeDoubleClicked(f,V,a):f.ISubGraph?e.onSubGraphDoubleClicked(f,V,a):Ke(f)?e.onGroupDoubleClicked(f,V,a):f.IDoorWindow?e.onDoorWindowDoubleClicked(f,V,a):f.ICSGBox&&e.onCSGBoxDoubleClicked(f,V,a))):(e.fi({kind:"doubleClickBackground",event:V}),e.onBackgroundDoubleClicked(V)))},J.onSubGraphDoubleClicked=function(z){this.setCurrentSubGraph(z)},J.onEdgeDoubleClicked=function(o,D){this.isEditable(o)||(o.ISubGraph&&!Uc(D)?this.setCurrentSubGraph(o):o.s("edge.toggleable")&&o.toggle())},J._39Q=function(V){return this.isInteractive(V)?this.preventDefaultWhenInteractive(V):!1},J.preventDefaultWhenInteractive=function(V){return V.s("preventDefaultWhenInteractive")},J.onGroupDoubleClicked=function(R){R.s("group.toggleable")&&R.toggle()},J.onDoorWindowDoubleClicked=function(k){k.s("dw.toggleable")&&k.toggle(!0)},J.onCSGBoxDoubleClicked=function(E,z){var j=this;if(j instanceof Gr){var v=j.getHitFaceInfo(z);v&&v.face&&E.s(v.face+".toggleable")&&E.toggleFace(v.face,!0)}},J.onBackgroundClicked=function(){},J.onBackgroundDoubleClicked=function(){this.upSubGraph()},J.onDataClicked=function(){},J.onDataDoubleClicked=function(){},J.onAutoLayoutEnded=function(){},J.onMoveEnded=function(){},J.onPanEnded=function(){},J.onPinchEnded=function(){},J.onRectSelectEnded=function(){},J.onZoomEnded=function(){},J.serialize=function(Y){return this.dm().serialize(Y)},J.toJSON=function(){return this.dm().toJSON()},J.deserialize=function(D,T){var Y=this;T=T instanceof uc?{rootParent:T}:Ll(T)?{setId:T}:xj(T)?{finishFunc:T}:T||{},T.view=Y;var z=Y.dm();return T.__innerHandler__=function(F){if(Ll(z.a("toolTipEnable"))&&(z.a("toolTipEnable")?Y.enableToolTip():Y.disableToolTip()),Y instanceof B.graph.GraphView&&(Ll(z.a("zoomable"))&&Y.setZoomable&&Y.setZoomable(z.a("zoomable")),Ll(z.a("pannable"))&&Y.setPannable&&Y.setPannable(z.a("pannable")),Ll(z.a("rectSelectable"))&&Y.setRectSelectable&&Y.setRectSelectable(z.a("rectSelectable")),z.a("fitContent")===!0&&Y.fitContent&&Y.fitContent(!0,0)),Y instanceof B.graph3d.Graph3dView){var D=F.scene;D&&(D.eye&&Y.setEye(D.eye),D.center&&Y.setCenter(D.center)),Ff(z.a("sceneNear"))&&Y.setNear(z.a("sceneNear")),Ff(z.a("sceneFar"))&&Y.setFar(z.a("sceneFar")),Ll(z.a("sceneDashEnable"))&&Y.setDashDisabled(!z.a("sceneDashEnable")),Ll(z.a("sceneBloom"))&&Y.setPostProcessingValue("Bloom","enable",z.a("sceneBloom")),Ff(z.a("sceneBloomStrength"))&&Y.setPostProcessingValue("Bloom","strength",z.a("sceneBloomStrength")),Ff(z.a("sceneBloomThreshold"))&&Y.setPostProcessingValue("Bloom","threshold",z.a("sceneBloomThreshold")),Ff(z.a("sceneBloomRadius"))&&Y.setPostProcessingValue("Bloom","radius",z.a("sceneBloomRadius")),Ll(z.a("sceneDof"))&&Y.setPostProcessingValue("Dof","enable",z.a("sceneDof")),Ff(z.a("sceneDofAperture"))&&Y.setPostProcessingValue("Dof","aperture",z.a("sceneDofAperture")),Fc(z.a("sceneDofImage"))&&Y.setPostProcessingValue("Dof","image",z.a("sceneDofImage")),Fc(z.a("sceneHighlightMode"))&&Y.setHighlightMode(z.a("sceneHighlightMode")),Ff(z.a("sceneHighlightWidth"))&&Y.setHighlightWidth(z.a("sceneHighlightWidth")),z.a("sceneHighlightColor")&&Y.setHighlightColor(z.a("sceneHighlightColor")),Ll(z.a("sceneHeadlightEnable"))&&Y.setHeadlightDisabled(!z.a("sceneHeadlightEnable")),Ff(z.a("sceneHeadlightRange"))&&Y.setHeadlightRange(z.a("sceneHeadlightRange")),z.a("sceneHeadlightColor")&&Y.setHeadlightColor(z.a("sceneHeadlightColor")),Ff(z.a("sceneHeadlightIntensity"))&&Y.setHeadlightIntensity(z.a("sceneHeadlightIntensity")),Ff(z.a("sceneHeadlightAmbientIntensity"))&&Y.setHeadlightAmbientIntensity(z.a("sceneHeadlightAmbientIntensity")),Ll(z.a("sceneFogEnable"))&&Y.setFogDisabled(!z.a("sceneFogEnable")),z.a("sceneFogColor")&&Y.setFogColor(z.a("sceneFogColor")),Ff(z.a("sceneFogNear"))&&Y.setFogNear(z.a("sceneFogNear")),Ff(z.a("sceneFogFar"))&&Y.setFogFar(z.a("sceneFogFar"))}},z.deserialize(D,T.rootParent,T)},J.isDebugTipShowing=function(){return!!this._debugDiv},J.showDebugTip=function(){var H=this,p=H._debugDiv;if(!p){p=H._debugDiv=N.createElement("div"),p.style.position="absolute",p.style.overflow="hidden",p.style.font=V.debugTipLabelFont,p.style.padding="6px",p.style.backgroundColor=V.debugTipBackground,p.style.color=V.debugTipLabelColor;var A=H.getView();H._79O?A.insertBefore(p,H._79O):A.appendChild(p);var q=function(){H.redraw();var i=H._canvas,S="FPS: "+H._fpsInfo.fps+"<br/>"+"Datas: "+H.dm().getDatas().length+(i?"<br/>Size: "+i.width+" * "+i.height:""),x=H.dm()._historyManager;x&&(S+="<br/>Undoes: "+x.getHistories().length+" index: "+x.getHistoryIndex());var n=H.getDebugTip();n&&(S+="<hr>"+n),p.innerHTML=S,H._isDebugging&&requestAnimationFrame(q)};requestAnimationFrame(q),H._isDebugging=!0}},J.hideDebugTip=function(){var Q=this,r=Q._debugDiv;r&&(delete Q._debugDiv,Q.getView().removeChild(r),Q._isDebugging=!1)},J.updateDOMAppendMatrix=function(){var y=this.getView();y&&(y.updateAppendMatrix=!0)},J.countFrame=function(){if(this._isDebugging){var i=Date.now(),W=this._fpsInfo;i-W.time>1e3?(W.fps=Math.round(1e5*(W.frames+1)/(i-W.time))/100,W.time=i,W.frames=0):W.frames++}}},ms_icons:function(A){A.getRotation=function(b){return b==R?0:b},A._15O=function(){var u=this,A=u.s(Ch);if(A){var U=u,d=u.data||u._data,K=u._38o={icons:A,rects:{}};for(var C in A){var Q=A[C],b=ie(Q.shape3d,d,U);if(!(ie(Q.visible,d,U)===!1||ie(Q.for3d,d,U)&&!u.I3d||b&&!u.I3d)){var E=b?[b]:ie(Q.names,d,U),e=E?E.length:0,S=ie(Q.position,d,U)||3,L=ie(Q.offsetX,d,U)||0,i=ie(Q.offsetY,d,U)||0,t=ie(Q.direction,d,U)||qe,M=ie(Q.gap,d,U),N=M!=R?M:1,F=ie(Q.rotation,d,U),a=ie(Q.keepOrien,d,U),T=ie(Q.rotationFixed,d,U)?F:u.getRotation(F,a,S),z=R,n=K.rects[C]=new Array(e);n.rotation=T;for(var J=0;e>J;J++){var X,H,$,j,P=E[J];if(b)$=0,j=0;else{var f=Tn(P);$=ie(Q.width,d,U),j=ie(Q.height,d,U),$==R&&($=gs(f,d)),j==R&&(j=rr(f,d))}if(z?t===qe?L+=$/2:t===Jn?L-=$/2:t===Kk?i-=j/2:i+=j/2:z={width:$,height:j},u.I3d){var W=-$/2,q=-j/2;H={width:$,height:j,mat:u._16O(ie(Q.autorotate,d,U),S,z,ie(Q.face,d,U)||ck,ie(Q.t3,d,U),ie(Q.r3,d,U),ie(Q.rotationMode,d,U),L,i),vs:new om([W,-q,0,W,-q-j,0,W+$,-q-j,0,W+$,-q,0])}}else X=u.getPosition(S,L,i,z,ie(Q.positionFixed,d,U)),H={x:X.x-$/2,y:X.y-j/2,width:$,height:j},u._68o(H,T);n[J]=H,t===qe?L+=$/2+N:t===Jn?L-=$/2+N:t===Kk?i-=j/2+N:i+=j/2+N}}}}}}});var el={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Lq={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},qn={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Dn={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},hc={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},hs={"edge.type":1,"edge.group":1},ml={rotation:1,rotationX:1,rotationZ:1},Eo={rotation:1,rotationX:1,rotationZ:1,position:1,width:1,height:1,anchor:1,scale:1},Ee={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Qd={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},yi={shape:1,thickness:1,position:1,anchor:1,scale:1},Dh=function(G){if(!G)return R;if($k(G)){var z=G._40I,o=G._41I;if(!z||!o)return R;var U=Dh(z),t=Dh(o);return U===t?U:R}for(var i=G._parent;$k(i)&&!i.ISubGraph;)i=i._parent;return i?i.ISubGraph?i:Dh(i):R},An=function(i,k,M,d){var L=k.getStyle(M)*d;L&&Vp(i,L),L=k.getStyle(M+".left")*d,L&&(i.x-=L,i.width+=L),L=k.getStyle(M+".right")*d,L&&(i.width+=L),L=k.getStyle(M+".top")*d,L&&(i.y-=L,i.height+=L),L=k.getStyle(M+".bottom")*d,L&&(i.height+=L),i.width<0&&(i.width=-i.width,i.x-=i.width),i.height<0&&(i.height=-i.height,i.y-=i.height)},Eq=function(C){for(var b,G=0,A=C.size();A>G;G++)if(b=C.getChildAt(G),hl(b)&&Eq(b))return!0;return C.hasAgentEdges()},Ie=function(Q){if(!Q)return R;for(var T=Q._parent;Ke(T);){if(!Ke(T._parent))return T.isExpanded()?Q:T;T.isExpanded()||(Q=T),T=T._parent}return Q},Dj=function(N,B){if(!N||!B)return R;var J,M,f,v=Dh(N),V=Dh(B);if(v!==V){for(;V&&v!==V;)V=Dh(V);if(v===V)return N;J=new Mf,J.add(N,0);for(var n=N._parent;hl(n)&&!B.isDescendantOf(n);)J.add(n,0),n=n._parent;for(f=J.size(),M=0;f>M;M++){var b=J.get(M);if(Ke(b)&&!b.isExpanded())return b;if(b.ISubGraph)return b}return N}return N},Ni=function(N){if(N.isLooped())return N._source;var l=Ie(N._source),g=Ie(N._target);return l===g?N._source:Dj(l,g)},pl=function(h){if(h.isLooped())return h._target;var g=Ie(h._source),y=Ie(h._target);return g===y?h._target:Dj(y,g)},sf=function(R,$,u){"target"!==u&&(u="source");var k="target"===u?$.getTargetAgent():$.getSourceAgent(),B="edge."+u+".";if($k(k)){var L=R.getDataUI(k);L._79o();var g=$.s(B+"index");if(g>=0){var n=Bl(L);return n[Math.max(0,Math.min(g,n.length-1))]}var x=$.s(B+"percent")||0;x=Math.max(0,Math.min(x,1));var J=bs(L);return nj(J,100*x)}return go(R,k,$.s(B+"position"),$.s(B+"offset.x"),$.s(B+"offset.y"),$.s(B+"anchor.x"),$.s(B+"anchor.y"))},go=function(N,G,g,b,o,s,t){if(!G)return R;var M,k=G.getRotation?G.getRotation():0;if(s!==H||t!==H){s=s===H?.5:s,t=t===H?.5:t;var Q=G.getScale();if(k&&!of(G,N)||Q.x<0||Q.y<0){var r=G.getPosition(),L=G.getWidth(),c=G.getHeight(),E=G.getAnchor(),z=new Fn(k,r.x,r.y,Q.x,Q.y);g=z.tf((s-E.x)*L,(t-E.y)*c)}else M=tf(N,G),g={x:M.x+s*M.width,y:M.y+t*M.height}}else g=Ph(g,tf(N,G));if(k){var p=i(k),P=n(k),a=b*p-o*P;o=b*P+o*p,b=a}return g.x+=b,g.y+=o,g},ad=function(b,L){if(!b||!L)return R;var e,q,m,U,Y,$;if(b===L){if(U=b.getLoopedEdges(),!U)return R;U=new Mf(U)}else{if(Y=b.getAgentEdges(),$=L.getAgentEdges(),!Y||!$)return R;for(q=Y.size(),e=0;q>e;e++)m=Y.get(e),$.contains(m)&&(U||(U=new Mf),U.add(m))}if(U)for(e=0;e<U.size();e++)m=U.get(e),m.getStyle(Po)===_b&&(m._22I(R),U.removeAt(e),e--);return U},us=function(e,b){var A=ad(e,b);if(A&&!A.isEmpty()){if(1===A.size())return A.get(0)._22I(R),void 0;var E=new Mf,q=new Mf;A.each(function(Z){var Q=Z.s("edge.group");E.contains(Q)||E.add(Q)}),E.sort(),E.each(function(U){q.add(new B.EdgeGroup(A.toList(function(h){return U===h.s("edge.group")}),q))}),q.each(function(n){n.each(function(h){h._22I(n)})})}},zs=function(B,C,z){var q=B._canvas;B._zoom;var P=Pd(C,q),E=Pd(z,q);return{x:P.x-E.x,y:P.y-E.y}},Vr=function(K,Q){if(Q){var M=Q.rect,f=Q.color,$=Q.rotation,d=Q.labelWidth,J=Q.background,S=Q.opacity,w=Q.scale,T=w!=R&&1!==w;if(S!=R){var _=K.globalAlpha;K.globalAlpha*=S}if($||T){K.save();var h=M.x+M.width/2,m=M.y+M.height/2;tl(K,h,m),$&&pb(K,$),T&&K.scale(w,w),tl(K,-h,-m)}if(J&&gi(K,M.x,M.y,M.width,M.height,J),d){var C=M.width,A=K.createLinearGradient(M.x,M.y,M.x+C,M.y);A.addColorStop(0,f),A.addColorStop(.9,f),A.addColorStop(1,Bb),f=A,M.width=d}dk(K,Q.ss,M,Q.font,f,Q.align),d&&(M.width=C),($||T)&&K.restore(),S!=R&&(K.globalAlpha=_)}},lp=function(c,X){if(X){var Q=X.rect,N=Q.x,L=Q.y,o=Q.width,M=Q.height,_=X.background,g=X.backgroundImage,f=X.borderWidth,x=X.borderColor,C=X.labelWidth,F=X.opacity,A=X.scale,E=A!=R&&1!==A;if(F!=R){var Y=c.globalAlpha;c.globalAlpha*=F}if(E){c.save();var i=Q.x+Q.width/2,I=Q.y+Q.height/2;tl(c,i,I),c.scale(A,A),tl(c,-i,-I)}if(X.expanded){var q=k(8,o/4),l=L+M-8;if(c.fillStyle=_,c.beginPath(),c.moveTo(N,L),c.lineTo(N,l),c.lineTo(N+o/2,l),c.lineTo(N+o/2,L+M),c.lineTo(N+o/2+q,l),c.lineTo(N+o,l),c.lineTo(N+o,L),c.closePath(),c.fill(),f&&(c.lineWidth=f,c.lineJoin="round",c.lineCap="round",x?(c.strokeStyle=x,c.stroke()):(c.strokeStyle=Xl(_),c.beginPath(),c.moveTo(N+o,L),c.lineTo(N+o,l),c.lineTo(N+o/2+q,l),c.lineTo(N+o/2,L+M),c.stroke(),c.strokeStyle=ap(_),c.beginPath(),c.moveTo(N+o,L),c.lineTo(N,L),c.lineTo(N,l),c.lineTo(N+o/2,l),c.lineTo(N+o/2,L+M),c.stroke())),g)Lf(c,Tn(g),pr,Q.x,Q.y,Q.width,Q.height-8,X.data,X.view);else{if(Q.height-=8,_=X.color,C){var m=o,t=c.createLinearGradient(N,L,N+m,L);t.addColorStop(0,_),t.addColorStop(.9,_),t.addColorStop(1,Bb),_=t,Q.width=C}dk(c,X.ss,Q,X.font,_,X.align),C&&(Q.width=m),Q.height+=8}}else if(X.icon)Fq(c,Tn(X.icon),N,L,o,M,X.data,X.view);else{var a=o/2;f&&(c.lineWidth=f,c.lineJoin="round",c.lineCap="round",c.strokeStyle=x?x:Xl(_),c.beginPath(),c.arc(N+a,L+a,a,W,1.6*e,!0),c.moveTo(N+a,L+M),c.lineTo(N+o-a/5,L+a),c.stroke(),c.strokeStyle=x?x:ap(_),c.beginPath(),c.arc(N+a,L+a,a,1.6*e,W,!0),c.moveTo(N+a,L+M),c.lineTo(N+a/5,L+a),c.stroke()),c.fillStyle=_,c.beginPath(),c.arc(N+a,L+a,a,0,b,!0),c.moveTo(N+a,L+M),c.lineTo(N+o-a/5,L+a),c.lineTo(N+a/5,L+a),c.closePath(),c.fill(),c.fillStyle=X.color,c.beginPath(),c.arc(N+a,L+a,a/3,0,b,!0),c.fill()}E&&c.restore(),F!=R&&(c.globalAlpha=Y)}},Uk=function(I,m){return m>2*I?I:m/2},Mq=function(w,n,N,t){if(!w||!n)return 0;var p=F(n.y-w.y,n.x-w.x);return N||(p=n.x<w.x?p+e:p),p+t},Ii=function(r,z,t,k,e,q,V){V&&(r.x>z.x||r.x===z.x&&r.y>z.y)&&(t=eg[t],e=-e);var K=Ph(t,{x:0,y:0,width:Wj(r,z),height:0},q);return K.x+=k,K.y+=e,K=new Fn(F(z.y-r.y,z.x-r.x)).tf(K),K.x+=r.x,K.y+=r.y,K},Bi=function(t,e,b,f,c){if(t._19Q=!0,!b.getEdgeGroup())return f?b.s("edge.gap"):0;if($k(b.getSourceAgent())||$k(b.getTargetAgent()))return 0;var O,H=0,W=0,J=0;if(b.getEdgeGroup().getSiblings().each(function(s){s.each(function(X){if(e.isVisible(X)&&X.s(Po)==c){var A=X.s("edge.gap");O?(W+=J/2+A/2,J=A):(O=X,J=A),X===b&&(H=W)}})}),f)return W-H+J;var m=H-W/2;return O&&b._40I!==O._40I&&(t._19Q=!1),m},Jp=function(){var L=function(p){var Q=[];return p.forEach(function(J){Q.push({x:J.x,y:J.y}),Q.push({x:J.x+J.width,y:J.y+J.height}),Q.push({x:J.x+J.width,y:J.y}),Q.push({x:J.x,y:J.y+J.height})}),Q};return function($,T,z){if("oval"===$){var w=0,I=z.height/z.width,C=I*I,R=z.x+z.width/2,P=z.y+z.height/2,Z=L(T);Z.forEach(function(H){var L=H.x-R,q=H.y-P,N=L*L+q*q/C;N>w&&(w=N)}),w=y(w);var v=I*w;return{x:R-w,y:P-v,width:2*w,height:2*v}}if("circle"===$){var O=0,R=z.x+z.width/2,P=z.y+z.height/2,Z=L(T);return Z.forEach(function(n){var i=n.x-R,S=n.y-P,Q=i*i+S*S;Q>O&&(O=Q)}),O=y(O),{x:R-O,y:P-O,width:2*O,height:2*O}}return"roundRect"===$?(Vp(z,k(z.width,z.height)/16),z):z}}(),gq=B.graph={},wm=function(Y,i,n){uj(m+".graph."+Y,i,n)};B.layout={};var Sg={},ig=function(p,d,S,G,n,v,P,F){var L=[d.uuid,Math.round(G),Math.round(n),S].join("_");d.cacheRule&&(L+=ie(d.cacheRule,v,P));var f=P._zoom;f!==P._cacheZoom&&(P._cacheZoom=f,P._cacheImage={}),f*=qm;var W=P._cacheImage[L];return W||($q(),W=B.Default.toCanvas(d,Math.ceil(G*f),Math.ceil(n*f),S,v,P,F),Xh()&&(P._cacheImage[L]=W)),W};vl(V,{setImageCacheRule:function(k,$){var g;g=$||"object"!=typeof k?{_image:$}:k;for(var l in g){var M=g[l];Fc(l)?(uj=Tn(l),uj?uj.cacheRule=M:Sg[l]=M):l.cacheRule=M}}});var km={comps:[{type:Rd,points:[85,50,70,115,100,71,86,107,88,49,47,70,116,110,56,56,102,107,52,109,74,57,115,76,115,105,89,77,86,49,112,105,51,49,56,114,110,88,121,70,70,54,52,61],borderWidth:1,borderColor:R}]};if(km[ok]=km[Sh]=160,M.Image){var Nq=new M.Image;Nq.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",bc("default_blank",Nq)
}bc("node_image",td(30,30,[{type:xc,rect:[4,5,22,16],gradient:Kn,gradientColor:Ef,background:Xq},{type:xc,rect:[2,3,26,20],borderWidth:1,borderColor:Xq},{type:xc,rect:[11,23,8,4],background:Xq},{type:xc,rect:[6,27,18,2],background:Xq}])),bc("node_icon",td(16,16,[{type:xc,rect:[2,2,12,10],gradient:Kn,gradientColor:Ef,background:Xq},{type:pc,rect:[2,2,12,10],width:1,color:Xq},{type:xc,rect:[6,12,4,2],background:Xq},{type:xc,rect:[4,14,8,1],background:Xq}])),bc("block_icon",td(16,16,[{type:pc,rect:[1,1,14,14],width:1,color:Xq}])),bc("group_image",td(66,39,[{type:xc,rect:[44.3,18,18.1,12.8],gradient:Kn,gradientColor:Ef,background:Xq},{type:xc,rect:[3.3,17.8,18.1,12.8],gradient:Kn,gradientColor:Ef,background:Xq},{type:xc,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Xq,gradient:Kn,gradientColor:Ef,background:Xq},{type:xc,rect:[26.2,29.4,12.8,4.2],background:Xq},{type:xc,rect:[21.3,33.5,22.5,2.3],background:Xq},{type:xc,rect:[5.3,32.7,14.1,2.1],background:Xq},{type:xc,rect:[9,30.4,6.7,2.4],background:Xq},{type:xc,rect:[50,30.7,6.7,2.4],background:Xq},{type:xc,rect:[46.3,33,14.1,2.1],background:Xq}])),bc("group_icon",td(16,16,[{type:xc,rect:[4,12,4,2],background:Xq},{type:xc,rect:[2,13,8,1],background:Xq},{type:xc,rect:[12,12,2,1],background:Xq},{type:xc,rect:[11,13,4,1],background:Xq},{type:xc,rect:[10,7,6,5],gradient:Kn,gradientColor:Ef,background:Xq},{type:xc,rect:[1,2,10,10],gradient:Kn,gradientColor:Ef,background:Xq},{type:pc,rect:[1,2,10,10],width:1,color:Xq}])),bc("refGraph_icon",td(16,16,[{type:"shape",borderWidth:1,borderColor:Xq,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Xq,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),bc("edge_icon",td(16,16,[{type:xc,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Kn,gradientColor:Ef,background:Xq},{type:xc,rect:[10.8,1,4,4],background:Xq},{type:xc,rect:[1,11,4,4],background:Xq}])),bc("subGraph_image",td(72,45,[{type:Rd,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Kn,gradientColor:Ef,background:Xq},{type:xc,rect:[29.6,30.7,3.6,1.8],background:Xq},{type:xc,rect:[28.4,32.3,6,1.2],background:Xq},{type:xc,rect:[37.3,32,10.8,1.8],background:Xq},{type:xc,rect:[39.1,29.9,7.2,2.3],background:Xq},{type:xc,rect:[26.6,23.7,9.6,7.2],gradient:Kn,gradientColor:Ef,background:Xq},{type:xc,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Xq,gradient:Kn,gradientColor:Ef,background:Xq}])),bc("subGraph_icon",td(17,17,[{type:Rd,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Kn,gradientColor:Ef,background:Xq}])),bc("shape_icon",td(16,16,[{type:Rd,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Xq}])),bc("polyline_icon",td(16,16,[{type:Rd,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Xq},Jd(7.5,.4),Jd(7.5,6.3),Jd(13.6,6.3),Jd(13.6,14),Jd(.7,13.9),Jd(.7,.3)])),bc("grid_icon",td(16,16,[{type:xc,rect:[1,1,4,4],background:Xq,gradient:Kn,gradientColor:Ef},{type:xc,rect:[6,1,4,4],background:Xq,gradient:Kn,gradientColor:Ef},{type:xc,rect:[11,1,4,4],background:Xq,gradient:Kn,gradientColor:Ef},{type:xc,rect:[11,6,4,4],background:Xq,gradient:Kn,gradientColor:Ef},{type:xc,rect:[6,6,4,4],background:Xq,gradient:Kn,gradientColor:Ef},{type:xc,rect:[1,6,4,4],background:Xq,gradient:Kn,gradientColor:Ef},{type:xc,rect:[11,11,4,4],background:Xq,gradient:Kn,gradientColor:Ef},{type:xc,rect:[6,11,4,4],background:Xq,gradient:Kn,gradientColor:Ef},{type:xc,rect:[1,11,4,4],background:Xq,gradient:Kn,gradientColor:Ef}])),bc("light_icon",td(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Xq},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Xq,gradient:Kn,gradientColor:Ef,background:{func:function(J){var g=J?J.s(ef):R;return hd(g)?"rgb("+L(255*g[0])+","+L(255*g[1])+","+L(255*g[2])+")":g||Xq}}}])),bc("text_icon",td(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Xq}])),bc("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),bc("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),bc("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),bc("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var kf=function(R,X,V,T,W,x){var G,Q,$,D,d,F,B,U,w,y,z,a=[];if(Math.abs(T)>2*Math.PI&&(T=2*Math.PI),d=Math.ceil(Math.abs(T)/(Math.PI/4)),G=T/d,Q=-G,$=-V,d>0){F=R+Math.cos(V)*W,B=X+Math.sin(-V)*x,a.push({x:F,y:B});for(var f=0;d>f;f++)$+=Q,D=$-Q/2,U=R+Math.cos($)*W,w=X+Math.sin($)*x,y=R+Math.cos(D)*(W/Math.cos(Q/2)),z=X+Math.sin(D)*(x/Math.cos(Q/2)),a.push({x:y,y:z}),a.push({x:U,y:w})}return a},Ej=function(y){if(y){var $=y._data;if($ instanceof B.Shape)return{points:$.getPoints(),segments:$.getSegments()};var l;if($ instanceof B.Edge&&(l=y._78o)){var Z,T,b=l.type,M=l.points,H=l.segments,L=l.edgeTypeInfo;if(!b||M){var r=l.sourcePoint,n=r.x,j=r.y,X=l.targetPoint,o=X.x,m=X.y;if(b)H?(Z=new Mf({x:n,y:j}),Z.addAll(M),Z.add({x:o,y:m}),T=new Mf(H._as)):(Z=new Mf({x:n,y:j}),M.each(function(r){Z.add(r)}),Z.add({x:o,y:m}));else if(l.looped){Z=new Mf(kf(n,j,0,2*Math.PI,l.radius,l.radius)),T=new Mf([1]);for(var _=0;_<(Z.size()-1)/2;_++)T.add(3)}else Z=new Mf,l.center?(Z.add({x:l.c1.x,y:l.c1.y}),Z.add({x:n,y:j}),Z.add({x:o,y:m}),Z.add({x:l.c2.x,y:l.c2.y})):(Z.add({x:n,y:j}),Z.add({x:o,y:m}))}else L&&(Z=new Mf(L.points._as),L.segments&&(T=new Mf(L.segments._as)));return{points:Z,segments:T}}}},bs=function(q,M,$){if(null==M){var F=Ej(q);if(!F)return;M=F.points,$=F.segments}if(M){if(Array.isArray(M)&&(M=new Mf(M)),"number"==typeof M.get(0)){for(var Y=new B.List,Q=0;Q<M.size();Q+=2)Y.add({x:M.get(Q),y:M.get(Q+1)});M=Y}if(!$){$=[1];for(var v=M.length-1;v>0;v--)$.push(2)}Array.isArray($)&&($=new Mf($));for(var T=ed(M._as,$._as,50),y=T.length,g=[],Q=0;y>Q;Q++){var C=T[Q];C.length>1&&g.push(C)}return g}},Be=function(X){for(var s=0,a=X.length-1,q=0;a>q;q++){var J=X[q],f=X[q+1],Y=f.x-J.x,U=f.y-J.y;s+=Math.sqrt(Y*Y+U*U)}return s},Qo=function(J,H){for(var b=0,i=H.length,V=0;i>V;V++){var M=H[V];if(b+=M,b>J)return V}return Math.min(V,i-1)},ne=function(L,n){for(var y=0,w=0,P=0,z=L.length-1,J=0;z>J;J++){var G=L[J],V=L[J+1],x=V.x-G.x,t=V.y-G.y;if(P=Math.sqrt(x*x+t*t),y+=P,y>n){y-=P,w=J;break}}var j=L[w],K=L[w+1],h=Math.atan2(K.y-j.y,K.x-j.x),e=n-y,t=Math.sin(h)*e,x=Math.cos(h)*e;return{x:j.x+x,y:j.y+t}},nj=function(j,O){if(j){var G;if(0===O)G=j[0][0];else if(100===O)j=j[j.length-1],G=j[j.length-1];else{for(var o=0,Z=[],S=j.length,f=0;S>f;f++){var k=j[f],L=Be(k);o+=L,Z.push(L)}for(var c=o*O/100,E=Qo(c,Z),C=0,W=0;E>W;W++)C+=Z[W];c-=C,G=ne(j[E],c)}return G}},Bl=function(b){var m,S,E,J,r=Ej(b),P=[],l=r.points,j=r.segments,I=-1;for(S=0,E=j?j.length:l.length;E>S;S++){if(m=j?j.get(S):1,3===m)J=2;else if(4===m)J=3;else{if(5===m)continue;J=1}I+=J,P.push(l.get(I))}return P},ar=function(V,Z,C,t){function q(p){if(p>=0&&1>=p){H=Z(p);var L=(V.x-H.x)*(V.x-H.x)+(V.y-H.y)*(V.y-H.y);return N>L?(N=L,m=p,!0):!1}}C=C||100,t=t||1e-5;for(var N=1/0,m=0,H=new zb,l=0;C>l;++l)q(l/C);for(var h=1/(2*C);h>t;)q(m-h)||q(m+h)||(h/=2);return m};vl(V,{_edgeProtectMethod:{getStraightLinePoints:bs,calculateLineLength:Be,calcSegmentIndexByDistance:Qo,calculatePointAlongLine:ne,getPercentPosition:nj,getRealPointsFromDataUI:Bl}});var cj=function(b,h){for(var T=b.vertices,y=0;y<T.length;y++){var J=T[y],P=J.y;J.y=J.z,J.z=-P,h&&(J.y+=h)}},Ib=function(s){for(var J,i,E,k,j,$,v=[],f=[],K=[],P=s.faces,e=0,A=0,G=0,l=P.length;l>e;e++,A+=6,G+=9){var Q=P[e];1===Q.i?(J||(J=[],i=[],E=[]),jn(Q,e,A,G,s,J,E,i)):2===Q.i?(k||(k=[],j=[],$=[]),jn(Q,e,A,G,s,k,$,j)):jn(Q,e,A,G,s,v,K,f)}return{vs:v,uv:f,ns:K,top_vs:J,top_uv:i,top_ns:E,bottom_vs:k,bottom_uv:j,bottom_ns:$}},jn=function(p,f,u,e,G,i,R,k){var n=G.vertices,q=G.faceVertexUvs,v=n[p.a],_=n[p.b],g=n[p.c];i[e]=v.x,i[e+1]=v.y,i[e+2]=v.z,i[e+3]=_.x,i[e+4]=_.y,i[e+5]=_.z,i[e+6]=g.x,i[e+7]=g.y,i[e+8]=g.z;var t=p.vertexNormals;if(3===t.length){var P=t[0],M=t[1],T=t[2];R[e]=P.x,R[e+1]=P.y,R[e+2]=P.z,R[e+3]=M.x,R[e+4]=M.y,R[e+5]=M.z,R[e+6]=T.x,R[e+7]=T.y,R[e+8]=T.z}else{var X=p.normal;R[e]=X.x,R[e+1]=X.y,R[e+2]=X.z,R[e+3]=X.x,R[e+4]=X.y,R[e+5]=X.z,R[e+6]=X.x,R[e+7]=X.y,R[e+8]=X.z}var a=q[0][f][0],D=q[0][f][1],x=q[0][f][2];k[u]=a.x,k[u+1]=a.y,k[u+2]=D.x,k[u+3]=D.y,k[u+4]=x.x,k[u+5]=x.y},yr=function(){function l(t,m){return t.dot(m)>0}function k(p,E,x,z,e,X,G){for(var Z,v,U=[E,x,z],H=[e,X,G],_=[],I=U.length,b=!0;I--&&b;){for(var c=U[I],f=H.length,r=!1;f--;)if(c.equals(H[f])){H.splice(f,1),_.push(c),r=!0;break}if(!r){if(Z){b=!1;break}Z=c}}return b&&2===_.length&&(v=H[0],i.subVectors(Z,_[0]),T.subVectors(v,_[0]),B.subVectors(Z,_[1]),i.x*B.y*T.z+B.x*T.y*i.z+T.x*i.y*B.z-T.x*B.y*i.z-T.y*B.z*i.x-T.z*B.x*i.y<1e-6&&(J.subVectors(v,_[1]),N.subVectors(_[1],_[0]),l(N,i)&&l(N,T)&&(N.negate(),l(N,B)&&l(N,J))))?(p.push(_[1].x,_[1].y,_[1].z),p.push(Z.x,Z.y,Z.z),p.push(Z.x,Z.y,Z.z),p.push(_[0].x,_[0].y,_[0].z),p.push(_[0].x,_[0].y,_[0].z),p.push(v.x,v.y,v.z),p.push(v.x,v.y,v.z),p.push(_[1].x,_[1].y,_[1].z),2):(p.push(E.x,E.y,E.z),p.push(x.x,x.y,x.z),p.push(x.x,x.y,x.z),p.push(z.x,z.y,z.z),p.push(z.x,z.y,z.z),p.push(E.x,E.y,E.z),1)}function e(){this._vertexMap={},this._lineMap={},this._lineList=[]}function Z(U,B,P,n,u,W,I){var x=[P,u];U[0]===n&&x.reverse();var v=[x[0]._key,x[1]._key].join("|"),t=U._triangles[v];t||(U._triangles[v]=t={});var J=[W._key,I._key].join("|");t[J]||(t[J]=[W,I])}function $(v,E,M){var F=v._planes[M._key];if(!F)for(var A in v._planes){var X=v._planes[A];if(X._normal.angleTo(M)<.001){F=X;break}}return F?(F._vertices.indexOf(E)<0&&F._vertices.push(E),void 0):(v._planes[M.key]={_normal:M,_vertices:[E]},void 0)}function X(G){var F=G._ctlineModel;if(F||(G._ctlineModel=F=[]),F[0])return F[0];var t;t=hd(G)?G:[G];var $,f,n,y,X,r,d,j,L,S,w,i,l,x,B,p,Y,Z,u,T=["","top_","bottom_"];for(F=[],$=0,f=t.length;f>$;$++)if(S=t[$])for(im(S),n=0,y=T.length;y>n;n++)if(L=S[T[n]+"lvs"])for(Y=F.length,Z=L.length,F.length=Y+Z,u=0;Z>u;++u,++Y)F[Y]=L[u];else if(d=S[T[n]+"vs"]){j=S[T[n]+"is"],r=j?j.length:d.length/3;for(var X=0;r-1>X;)j?(w=j[X],i=j[X+1],l=j[X+2],x=j[X+3],B=j[X+4],p=j[X+5]):(w=X,i=X+1,l=X+2,x=X+3,B=X+4,p=X+5),V.fromArray(d,3*w),E.fromArray(d,3*i),g.fromArray(d,3*l),A.fromArray(d,3*x),P.fromArray(d,3*B),q.fromArray(d,3*p),X+=3*k(F,V,E,g,A,P,q);r>X&&(j?(w=j[X],i=j[X+1],l=j[X+2]):(w=X,i=X+1,l=X+2),V.fromArray(d,3*w),E.fromArray(d,3*i),g.fromArray(d,3*l),F.push(V.x,V.y,V.z),F.push(E.x,E.y,E.z),F.push(E.x,E.y,E.z),F.push(g.x,g.y,g.z),F.push(g.x,g.y,g.z),F.push(V.x,V.y,V.z))}return G._ctlineModel[0]=F,F}function L(n){var q=n._ctlineModel;if(q||(n._ctlineModel=q=[]),q[1])return q[1];var b;b=hd(n)?n:[n];var U,N,p,k,u,t,r,g,j,C,c,A,X=["","top_","bottom_"],B=new e;for(q=[],U=0,N=b.length;N>U;U++)if(j=b[U])for(im(j),p=0,k=X.length;k>p;p++)if(r=j[X[p]+"vs"]){g=j[X[p]+"is"],t=g?g.length:r.length/3;for(var u=0,u=0;t>u;u+=3)g?(C=g[u],c=g[u+1],A=g[u+2]):(C=u,c=u+1,A=u+2),B._addTriangle(r,H,C,c,A)}return B._toLineVS(q),n._ctlineModel[1]=q,q}function C(J){var i=J._ctlineModel;if(i||(J._ctlineModel=i=[]),i[2])return i[2];var x;x=hd(J)?J:[J];var s,M,f,O,R,L,U,G,T,r,X,C,g,q=["","top_","bottom_"],Q=new e;for(i=[],s=0,M=x.length;M>s;s++)if(r=x[s])for(im(r),f=0,O=q.length;O>f;f++)if(U=r[q[f]+"vs"]){G=r[q[f]+"is"],T=r[q[f]+"ns"],L=G?G.length:U.length/3;for(var R=0,R=0;L>R;R+=3)G?(X=G[R],C=G[R+1],g=G[R+2]):(X=R,C=R+1,g=R+2),Q._addTriangle(U,T,X,C,g)}return Q._toLineVS(i),J._ctlineModel[2]=i,i}var V=new Fe,E=new Fe,g=new Fe,A=new Fe,P=new Fe,q=new Fe,i=new Fe,B=new Fe,T=new Fe,J=new Fe,N=new Fe,d=new Fe;e.prototype._findVertex=function(A,N){d.fromArray(A,3*N);var L=[d.x,d.y,d.z].join(","),Y=this._vertexMap[L];if(!Y){var n=d.clone();n._key=L,this._vertexMap[L]=Y=n}return Y},e.prototype._findLine=function(S,y){var D=[S,y];S._key>y._key&&D.reverse(),D._key=[D[0]._key,D[1]._key].join("|");var L=this._lineMap[D._key];return L||(this._lineMap[D._key]=L=D,D._triangles={},D._planes={},this._lineList.push(D)),L};var p=new Fe,_=new Fe;return e.prototype._addTriangle=function(s,I,y,h,G){var d,v,P,m=this._findVertex(s,y),q=this._findVertex(s,h),w=this._findVertex(s,G),Q=this._findLine(m,q),e=this._findLine(q,w),L=this._findLine(w,m);I?(d=(new Fe).fromArray(I,3*y),d._key=[d.x,d.y,d.z].join("|"),v=(new Fe).fromArray(I,3*h),v._key=[v.x,v.y,v.z].join("|"),P=(new Fe).fromArray(I,3*G),P._key=[P.x,P.y,P.z].join("|"),Z(Q,m,d,q,v,w,P),Z(e,q,v,w,P,m,d),Z(L,w,P,m,d,q,v)):(_.subVectors(w,q),p.subVectors(q,m),d=(new Fe).crossVectors(p,_),d._key=[d.x,d.y,d.z].join("|"),$(Q,w,d),$(e,m,d),$(L,q,d))},e.prototype._toLineVS=function(Y){for(var u=this._lineList,X=0,y=u.length;y>X;++X){var H=u[X],l=!1;for(var b in H._triangles)if(1==w.keys(H._triangles[b]).length){Y.push(H[0].x,H[0].y,H[0].z,H[1].x,H[1].y,H[1].z),l=!0;break}if(!l)for(var L in H._planes)if(1==H._planes[L]._vertices.length){Y.push(H[0].x,H[0].y,H[0].z,H[1].x,H[1].y,H[1].z),l=!0;break}}},[X,L,C]}(),mg=function(s){var r=s._lineModel;if(r)return r;var g;g=hd(s)?s:[s];var f,E,T,U,I,X,K,j,Z,F,W,P,A=["","top_","bottom_"];for(r=[],f=0,E=g.length;E>f;f++)if(Z=g[f])for(T=0,U=A.length;U>T;T++)if(K=Z[A[T]+"vs"]){j=Z[A[T]+"is"],X=j?j.length:K.length/3;for(var I=0;X>I;I+=3)j?(F=j[I],W=j[I+1],P=j[I+2]):(F=I,W=I+1,P=I+2),F*=3,W*=3,P*=3,r.push(K[F],K[F+1],K[F+2],K[W],K[W+1],K[W+2],K[W],K[W+1],K[W+2],K[P],K[P+1],K[P+2],K[P],K[P+1],K[P+2],K[F],K[F+1],K[F+2])}return s._lineModel=r,r},Tr=function(X,Q,x,L,s,O,o,E,j){x==R&&(x=!0),L==R&&(L=!0),o==R&&(o=1),E==R&&(E=0);var G=new ds;return ko(G,X,Q,j),G=G.toShapes(),Ib(new We(G,{top:x,bottom:L,curveSegments:s,amount:o,repeatUVLength:O},-o/2+E))},$r=function(C,f){this.x=C||0,this.y=f||0};$r.prototype={constructor:$r,add:function(R){return this.x+=R.x,this.y+=R.y,this},sub:function(i){return this.x-=i.x,this.y-=i.y,this},equals:function(r){return r.x===this.x&&r.y===this.y},multiplyScalar:function(p){return this.x*=p,this.y*=p,this},distanceTo:function(A){return y(this.distanceToSquared(A))},distanceToSquared:function(T){var $=this.x-T.x,l=this.y-T.y;return $*$+l*l},clone:function(){return new $r(this.x,this.y)}};var Rh=function(K,e,m){this.x=K||0,this.y=e||0,this.z=m||0};Rh.prototype={constructor:Rh,set:function(A,p,U){return this.x=A,this.y=p,this.z=U,this},setY:function(J){return this.y=J,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(v){return this.x+=v.x,this.y+=v.y,this.z+=v.z,this},addVectors:function(K,$){return this.x=K.x+$.x,this.y=K.y+$.y,this.z=K.z+$.z,this},sub:function(o){return this.x-=o.x,this.y-=o.y,this.z-=o.z,this},subVectors:function(i,C){return this.x=i.x-C.x,this.y=i.y-C.y,this.z=i.z-C.z,this},multiplyScalar:function(v){return this.x*=v,this.y*=v,this.z*=v,this},applyMatrix4:function(e){var y=this.x,z=this.y,k=this.z,n=e.elements;return this.x=n[0]*y+n[4]*z+n[8]*k+n[12],this.y=n[1]*y+n[5]*z+n[9]*k+n[13],this.z=n[2]*y+n[6]*z+n[10]*k+n[14],this},divideScalar:function(R){if(0!==R){var y=1/R;this.x*=y,this.y*=y,this.z*=y}else this.x=0,this.y=0,this.z=0;return this},dot:function(B){return this.x*B.x+this.y*B.y+this.z*B.z},length:function(){return y(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(y){var V=this.x,R=this.y,M=this.z;return this.x=R*y.z-M*y.y,this.y=M*y.x-V*y.z,this.z=V*y.y-R*y.x,this},crossVectors:function(P,k){var e=P.x,c=P.y,C=P.z,R=k.x,f=k.y,v=k.z;return this.x=c*v-C*f,this.y=C*R-e*v,this.z=e*f-c*R,this},distanceTo:function(M){return y(this.distanceToSquared(M))},distanceToSquared:function(p){var u=this.x-p.x,G=this.y-p.y,b=this.z-p.z;return u*u+G*G+b*b},clone:function(){return new Rh(this.x,this.y,this.z)}};var qo=function(){this.elements=new Float32Array(16)};qo.prototype={constructor:qo,set:function(G,p,E,H,g,L,u,j,_,C,o,T,O,k,y,F){var m=this.elements;return m[0]=G,m[4]=p,m[8]=E,m[12]=H,m[1]=g,m[5]=L,m[9]=u,m[13]=j,m[2]=_,m[6]=C,m[10]=o,m[14]=T,m[3]=O,m[7]=k,m[11]=y,m[15]=F,this},makeRotationAxis:function(l,w){var z=i(w),g=n(w),R=1-z,Q=l.x,K=l.y,P=l.z,o=R*Q,T=R*K;return this.set(o*Q+z,o*K-g*P,o*P+g*K,0,o*K+g*P,T*K+z,T*P-g*Q,0,o*P-g*K,T*P+g*Q,R*P*P+z,0,0,0,0,1),this}};var ao=function(Y){this.repeatUVLength=Y};ao.prototype={generateTopUV:function(G,j,p,g,l,v,n){var U,L,Z,d,t=G.vertices,$=t[g].x,i=t[g].y,K=t[l].x,m=t[l].y,B=t[v].x,y=t[v].y,r=this.repeatUVLength;if(r)U=0,L=0,Z=r,d=r;else{this._bb||(this._bb=j.getBoundingBox());var C=this._bb;U=C.minX,L=C.minY,Z=C.maxX-U,d=C.maxY-L}return n?[new $r(($-U)/Z,(i-L)/d),new $r((K-U)/Z,(m-L)/d),new $r((B-U)/Z,(y-L)/d)]:[new $r(($-U)/Z,1-(i-L)/d),new $r((K-U)/Z,1-(m-L)/d),new $r((B-U)/Z,1-(y-L)/d)]},generateBottomUV:function(p,a,I,x,R,t){return this.generateTopUV(p,a,I,x,R,t,!0)},generateSideWallUV:function(M,J,f,b,N,E,l,c,e,x,B,S){if(!this._cl){for(var w,X,z=[],A=0,P=f.length,m=0;P>m;m++){w=f[m],X=f[(m+1)%P];var L=w.x-X.x,Z=w.y-X.y,a=y(L*L+Z*Z);z.push(A),A+=a}for(var m=0;P>m;m++)z[m]/=A;this._cl=z}var z=this._cl,g=1-e/x,o=1-(e+1)/x,V=z[B],H=z[S];return H>V&&(V+=1),[new $r(V,g),new $r(H,g),new $r(H,o),new $r(V,o)]}};var Vc=function(M,Z,j,y,E,o){this.a=M,this.b=Z,this.c=j,this.i=o,this.normal=y instanceof Rh?y:new Rh,this.vertexNormals=y instanceof Array?y:[]};Vc.prototype={constructor:Vc};var ym=[-8,14,-7,8,2,6,-3,2,-1],mm=function(){if(mm[kr]!=R)return mm[kr];for(var U=al[kr],Z=ym,G=uc.prototype.getClassName(),b='"',D=0,w="",W=!1,h=+new(M[G.substr(3,3)+Zo[D]]),_=D;_<Z.length;_++){var n=Z.length-_;w+=_%2===D?Z[_]+n+"":Z[_]-n+""}for(var _=D;4>_;_++)w+=D;if(w=w*w.length/w.length,h>w){if(U&&U[D]&&U[4/xc.length]){for(var j,p,u,B,X,q,N,s,z=U[0],L=U[1],r="",k=0,_=0;_<L.length;_++)L[_]===b?s?(s=!1,0!==k%2&&(j==R?j=r:p==R?p=r:u==R?u=r:B==R?B=r:X==R?X=r:q==R?q=r:N==R&&(N=r)),k++,r=""):s=!0:s&&(r+=L[_]);for(var m,F,A,P="",i=0,_=0;_<z.length;_++)z[_]===b?m?(m=!1,0!==i%2&&(F==R?F=P:A==R&&(A=P)),i++,P=""):m=!0:m&&(P+=z[_]);var Y=j+p+u+B+X+q,g=!q||q===iq;if(!g&&q)for(var e,_=0,V=q.length;V>_;_++)q[_]===mo[4]?e===iq?g=ib:e[0]===kp[7]&&iq&&iq.indexOf(e.substr(1))>=0?g=xb:e=R:(e==R?e=q[_]:e+=q[_],_===V-1&&(e===iq?g=ib:e[0]===kp[7]&&iq&&iq.indexOf(e.substr(1))>=0&&(g=xb)));(W=Yi(Y,N)&&Yi(F,A)&&F===j&&g&&(!X||X>h))&&u.indexOf(Zh[0])>=0&&(mm[Zh[0]]=1),W&&u.indexOf(1)>=0&&(mm[1]=1),W&&u.indexOf(3)>=0&&(mm[2]=1),W&&u.indexOf(4)>=0&&(mm[3]=1),W&&u.indexOf(7)>=0&&(mm[4]=1)}}else W=!0,mm[Zh[0]]=mm[1]=mm[2]=mm[3]=mm[4]=1;return mm[kr]=W,W},xs=function(){},Th=xs.prototype;Th.getPointAt=function(O){var s=this.getUtoTmapping(O);return this.getPoint(s)},Th.getPoints=function(C){C||(C=5);var I,O=[];for(I=0;C>=I;I++)O.push(this.getPoint(I/C));return O},Th.getSpacedPoints=function(a){a||(a=5);var D,w=[];for(D=0;a>=D;D++)w.push(this.getPointAt(D/a));return w},Th.getLength=function(){var R=this.getLengths();return R[R.length-1]},Th.getLengths=function(M){if(M||(M=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==M+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var i,Q,_=[],Z=this.getPoint(0),X=0;for(_.push(0),Q=1;M>=Q;Q++)i=this.getPoint(Q/M),X+=i.distanceTo(Z),_.push(X),Z=i;return this.cacheArcLengths=_,_},Th.getUtoTmapping=function($,M){var g,K=this.getLengths(),D=0,v=K.length;g=M?M:$*K[v-1];for(var C,n=0,w=v-1;w>=n;)if(D=f(n+(w-n)/2),C=K[D]-g,0>C)n=D+1;else{if(!(C>0)){w=D;break}w=D-1}if(D=w,K[D]==g){var L=D/(v-1);return L}var y=K[D],O=K[D+1],b=O-y,x=(g-y)/b,L=(D+x)/(v-1);return L},Th.getTangent=function(H){var A=1e-4,L=H-A,o=H+A;0>L&&(L=0),o>1&&(o=1);var Q=this.getPoint(L),_=this.getPoint(o),U=_.clone().sub(Q);return U.normalize()},Th.getTangentAt=function(h){var e=this.getUtoTmapping(h);return this.getTangent(e)},xs.create=function(X,g){return X.prototype=Oo(xs.prototype),X.prototype.getPoint=g,X};var ll=function(){this.curves=[],this.autoClose=!1},xi=ll.prototype=Oo(Th);xi.add=function(s){this.curves.push(s)},xi.closePath=function(){var Q=this.curves[0].getPoint(0),p=this.curves[this.curves.length-1].getPoint(1);Q.equals(p)||this.curves.push(new Jj(p,Q))},xi.getPoint=function(u){for(var $,q,z=u*this.getLength(),h=this.getCurveLengths(),v=0;v<h.length;){if(h[v]>=z){$=h[v]-z,q=this.curves[v];var m=1-$/q.getLength();return q.getPointAt(m)}v++}return null},xi.getLength=function(){var Q=this.getCurveLengths();return Q[Q.length-1]},xi.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var g,v=[],C=0,A=this.curves.length;for(g=0;A>g;g++)C+=this.curves[g].getLength(),v.push(C);return this.cacheLengths=v,v},xi.getTransformedPoints=function(r){return this.getPoints(r)},xi.getBoundingBox=function(){var b,e,i,U,p,Q,L=this.getPoints();b=e=Number.NEGATIVE_INFINITY,U=p=Number.POSITIVE_INFINITY;var f,M,V,D,O=L[0]instanceof Rh;for(D=O?new Rh:new $r,M=0,V=L.length;V>M;M++)f=L[M],f.x>b&&(b=f.x),f.x<U&&(U=f.x),f.y>e&&(e=f.y),f.y<p&&(p=f.y),O&&(f.z>i&&(i=f.z),f.z<Q&&(Q=f.z)),D.add(f);var k={minX:U,minY:p,maxX:b,maxY:e};return O&&(k.maxZ=i,k.minZ=Q),k};var $d=function(w){ll.call(this),this.actions=[],w&&this.fromPoints(w)},Vj=$d.prototype=Oo(ll.prototype),ld="moveTo",eq="lineTo",Te="quadraticCurveTo",ys="bezierCurveTo",Kg="arc",wf="ellipse";Vj.fromPoints=function(K){this.moveTo(K[0].x,K[0].y);for(var l=1,m=K.length;m>l;l++)this.lineTo(K[l].x,K[l].y)},Vj.moveTo=function(){var B=Array.prototype.slice.call(arguments);this.actions.push({action:ld,args:B})},Vj.lineTo=function(Q,L){var c=Array.prototype.slice.call(arguments),J=this.actions[this.actions.length-1].args,U=J[J.length-2],x=J[J.length-1],Y=new Jj(new $r(U,x),new $r(Q,L));this.curves.push(Y),this.actions.push({action:eq,args:c})},Vj.quadraticCurveTo=function(N,J,L,D){var r=Array.prototype.slice.call(arguments),Q=this.actions[this.actions.length-1].args,v=Q[Q.length-2],t=Q[Q.length-1],M=new bi(new $r(v,t),new $r(N,J),new $r(L,D));this.curves.push(M),this.actions.push({action:Te,args:r})},Vj.bezierCurveTo=function(i,w,s,t,k,n){var F=Array.prototype.slice.call(arguments),_=this.actions[this.actions.length-1].args,q=_[_.length-2],G=_[_.length-1],N=new zk(new $r(q,G),new $r(i,w),new $r(s,t),new $r(k,n));this.curves.push(N),this.actions.push({action:ys,args:F})},Vj.arc=function(j,f,u,n,c,k){var H=this.actions[this.actions.length-1].args,h=H[H.length-2],g=H[H.length-1];this.absarc(j+h,f+g,u,n,c,k)},Vj.absarc=function(X,n,u,p,j,W){this.absellipse(X,n,u,u,p,j,W)},Vj.ellipse=function(Q,d,K,z,n,S,u){var I=this.actions[this.actions.length-1].args,O=I[I.length-2],C=I[I.length-1];this.absellipse(Q+O,d+C,K,z,n,S,u)},Vj.absellipse=function(P,n,c,v,s,Y,C){var N=Array.prototype.slice.call(arguments),e=new Am(P,n,c,v,s,Y,C);this.curves.push(e);var Q=e.getPoint(1);N.push(Q.x),N.push(Q.y),this.actions.push({action:wf,args:N})},Vj.getSpacedPoints=function(M){M||(M=40);for(var g=[],q=0;M>q;q++)g.push(this.getPoint(q/M));return g},Vj.getPoints=function($,N){$=$||12;var Q,R,c,C,L,u,X,j,l,B,f,K,x,Y,e,H,o,Z,V=[];for(Q=0,R=this.actions.length;R>Q;Q++)switch(c=this.actions[Q],C=c.action,L=c.args,C){case ld:V.push(new $r(L[0],L[1]));break;case eq:V.push(new $r(L[0],L[1]));break;case Te:for(u=L[2],X=L[3],B=L[0],f=L[1],V.length>0?(Y=V[V.length-1],K=Y.x,x=Y.y):(Y=this.actions[Q-1].args,K=Y[Y.length-2],x=Y[Y.length-1]),e=1;$>=e;e++)H=e/$,o=fh.b2(H,K,B,u),Z=fh.b2(H,x,f,X),V.push(new $r(o,Z));break;case ys:for(u=L[4],X=L[5],B=L[0],f=L[1],j=L[2],l=L[3],V.length>0?(Y=V[V.length-1],K=Y.x,x=Y.y):(Y=this.actions[Q-1].args,K=Y[Y.length-2],x=Y[Y.length-1]),e=1;$>=e;e++)H=e/$,o=fh.b3(H,K,B,j,u),Z=fh.b3(H,x,f,l,X),V.push(new $r(o,Z));break;case Kg:var M,J=L[0],S=L[1],h=L[2],p=L[3],m=L[4],b=!!L[5],k=m-p,y=2*$;for(e=1;y>=e;e++)H=e/y,b||(H=1-H),M=p+H*k,o=J+h*i(M),Z=S+h*n(M),V.push(new $r(o,Z));break;case wf:var M,J=L[0],S=L[1],I=L[2],A=L[3],p=L[4],m=L[5],b=!!L[6],k=m-p,y=2*$;for(e=1;y>=e;e++)H=e/y,b||(H=1-H),M=p+H*k,o=J+I*i(M),Z=S+A*n(M),V.push(new $r(o,Z))}var P,T,d=v["shape3d.point.epsilon"],t=!1;for(R=V.length,Q=0,R=V.length;R>Q;Q++)P=V[Q],T=Q===R-1?V[0]:V[Q+1],P&&T&&q(P.x-T.x)<d&&q(P.y-T.y)<d&&(t=!0,V[Q]=null);if(t){var w=[];for(Q=0;R>Q;Q++)V[Q]&&w.push(V[Q]);V=w}return N&&V.push(V[0]),V},Vj.toShapes=function(E,B){function a(E){var J,m,c,y,x,d=[],H=new $d;for(J=0,m=E.length;m>J;J++)c=E[J],x=c.args,y=c.action,y==ld&&0!=H.actions.length&&(d.push(H),H=new $d),H[y].apply(H,x);return 0!=H.actions.length&&d.push(H),d}function t(v){for(var z=[],K=0,k=v.length;k>K;K++){var H=v[K],r=new ds;r.actions=H.actions,r.curves=H.curves,z.push(r)}return z}function F(G,L){for(var D=1e-10,x=L.length,v=!1,m=x-1,p=0;x>p;m=p++){var s=L[m],T=L[p],d=T.x-s.x,Q=T.y-s.y;if(q(Q)>D){if(0>Q&&(s=L[p],d=-d,T=L[m],Q=-Q),G.y<s.y||G.y>T.y)continue;if(G.y==s.y){if(G.x==s.x)return!0}else{var E=Q*(G.x-s.x)-d*(G.y-s.y);if(0==E)return!0;if(0>E)continue;v=!v}}else{if(G.y!=s.y)continue;if(T.x<=G.x&&G.x<=s.x||s.x<=G.x&&G.x<=T.x)return!0}}return v}var g=a(this.actions);if(0==g.length)return[];if(B===!0)return t(g);var P,J,I,Q=[];if(1==g.length)return J=g[0],I=new ds,I.actions=J.actions,I.curves=J.curves,Q.push(I),Q;var k=!fh.isClockWise(g[0].getPoints());k=E?!k:k;var l,Z=[],x=[],M=[],S=0;x[S]=H,M[S]=[];var X,c;for(X=0,c=g.length;c>X;X++)J=g[X],l=J.getPoints(),P=fh.isClockWise(l),P=E?!P:P,P?(!k&&x[S]&&S++,x[S]={s:new ds,p:l},x[S].s.actions=J.actions,x[S].s.curves=J.curves,k&&S++,M[S]=[]):M[S].push({h:J,p:l[0]});if(!x[0])return t(g);if(x.length>1){for(var u=!1,K=[],W=0,L=x.length;L>W;W++)Z[W]=[];for(var W=0,L=x.length;L>W;W++){x[W];for(var A=M[W],D=0;D<A.length;D++){for(var G=A[D],v=!0,T=0;T<x.length;T++)F(G.p,x[T].p)&&(W!=T&&K.push({froms:W,tos:T,hole:D}),v?(v=!1,Z[T].push(G)):u=!0);v&&Z[W].push(G)}}K.length>0&&(u||(M=Z))}var p,d,w;for(X=0,c=x.length;c>X;X++)for(I=x[X].s,Q.push(I),p=M[X],d=0,w=p.length;w>d;d++)I.holes.push(p[d].h);return Q};var ds=function(){$d.apply(this,arguments),this.holes=[]},Mr=ds.prototype=Oo(Vj);Mr.getPointsHoles=function(n){var s,b=this.holes.length,u=[];for(s=0;b>s;s++)u[s]=this.holes[s].getTransformedPoints(n);return u},Mr.extractAllPoints=function(n){return{shape:this.getTransformedPoints(n),holes:this.getPointsHoles(n)}},Mr.extractPoints=function(F){return this.extractAllPoints(F)};var fh={triangulateShape:function(f,t){function I(o,w,C){return o.x!=w.x?o.x<w.x?o.x<=C.x&&C.x<=w.x:w.x<=C.x&&C.x<=o.x:o.y<w.y?o.y<=C.y&&C.y<=w.y:w.y<=C.y&&C.y<=o.y}function E(t,R,O,J,j){var V=1e-10,P=R.x-t.x,E=R.y-t.y,h=J.x-O.x,r=J.y-O.y,W=t.x-O.x,s=t.y-O.y,_=E*h-P*r,G=E*W-P*s;if(q(_)>V){var w;if(_>0){if(0>G||G>_)return[];if(w=r*W-h*s,0>w||w>_)return[]}else{if(G>0||_>G)return[];if(w=r*W-h*s,w>0||_>w)return[]}if(0==w)return!j||0!=G&&G!=_?[t]:[];if(w==_)return!j||0!=G&&G!=_?[R]:[];if(0==G)return[O];if(G==_)return[J];var o=w/_;return[{x:t.x+o*P,y:t.y+o*E}]}if(0!=G||r*W!=h*s)return[];var Q=0==P&&0==E,Y=0==h&&0==r;if(Q&&Y)return t.x!=O.x||t.y!=O.y?[]:[t];if(Q)return I(O,J,t)?[t]:[];if(Y)return I(t,R,O)?[O]:[];var z,l,u,k,X,m,S,x;return 0!=P?(t.x<R.x?(z=t,u=t.x,l=R,k=R.x):(z=R,u=R.x,l=t,k=t.x),O.x<J.x?(X=O,S=O.x,m=J,x=J.x):(X=J,S=J.x,m=O,x=O.x)):(t.y<R.y?(z=t,u=t.y,l=R,k=R.y):(z=R,u=R.y,l=t,k=t.y),O.y<J.y?(X=O,S=O.y,m=J,x=J.y):(X=J,S=J.y,m=O,x=O.y)),S>=u?S>k?[]:k==S?j?[]:[X]:x>=k?[X,l]:[X,m]:u>x?[]:u==x?j?[]:[z]:x>=k?[z,l]:[z,m]}function J(U,y,R,E){var v=1e-10,c=y.x-U.x,P=y.y-U.y,L=R.x-U.x,H=R.y-U.y,k=E.x-U.x,A=E.y-U.y,l=c*H-P*L,D=c*A-P*k;if(q(l)>v){var p=k*H-A*L;return l>0?D>=0&&p>=0:D>=0||p>=0}return D>0}function y(m,z){function B(A,z){var m=Z.length-1,T=A-1;0>T&&(T=m);var q=A+1;q>m&&(q=0);var u=J(Z[A],Z[T],Z[q],j[z]);if(!u)return!1;var L=j.length-1,K=z-1;0>K&&(K=L);var X=z+1;return X>L&&(X=0),u=J(j[z],j[K],j[X],Z[A]),u?!0:!1}function $(e,X){var I,v,n;for(I=0;I<Z.length;I++)if(v=I+1,v%=Z.length,n=E(e,X,Z[I],Z[v],!0),n.length>0)return!0;return!1}function f(B,m){var s,S,n,T,l;for(s=0;s<o.length;s++)for(S=z[o[s]],n=0;n<S.length;n++)if(T=n+1,T%=S.length,l=E(B,m,S[n],S[T],!0),l.length>0)return!0;return!1}for(var j,c,U,d,t,W,n,N,O,q,s,Z=m.concat(),o=[],p=[],b=0,G=z.length;G>b;b++)o.push(b);for(var P=0,k=2*o.length;o.length>0&&(k--,!(0>k));)for(U=P;U<Z.length;U++){d=Z[U],c=-1;for(var b=0;b<o.length;b++)if(W=o[b],n=d.x+":"+d.y+":"+W,p[n]===H){j=z[W];for(var e=0;e<j.length;e++)if(t=j[e],B(U,e)&&!$(d,t)&&!f(d,t)){c=e,o.splice(b,1),N=Z.slice(0,U+1),O=Z.slice(U),q=j.slice(c),s=j.slice(0,c+1),Z=N.concat(q).concat(s).concat(O),P=U;break}if(c>=0)break;p[n]=!0}if(c>=0)break}return Z}for(var Y,Q,p,N,x,T,_={},W=f.concat(),G=0,U=t.length;U>G;G++)Array.prototype.push.apply(W,t[G]);for(Y=0,Q=W.length;Q>Y;Y++)x=W[Y].x+":"+W[Y].y,_[x]!==H,_[x]=Y;var l=y(f,t),S=Db.Triangulate(l,!1);for(Y=0,Q=S.length;Q>Y;Y++)for(N=S[Y],p=0;3>p;p++)x=N[p].x+":"+N[p].y,T=_[x],T!==H&&(N[p]=T);return S.concat()},isClockWise:function(e){return Db.Triangulate.area(e)<0},b2p0:function(e,E){var I=1-e;return I*I*E},b2p1:function(b,i){return 2*(1-b)*b*i},b2p2:function(E,R){return E*E*R},b2:function(Q,m,u,q){return this.b2p0(Q,m)+this.b2p1(Q,u)+this.b2p2(Q,q)},b3p0:function(F,T){var H=1-F;return H*H*H*T},b3p1:function(Y,h){var L=1-Y;return 3*L*L*Y*h},b3p2:function(O,b){var D=1-O;return 3*D*O*O*b},b3p3:function(B,e){return B*B*B*e},b3:function(w,W,D,N,X){return this.b3p0(w,W)+this.b3p1(w,D)+this.b3p2(w,N)+this.b3p3(w,X)}},Db={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var r=w.keys(this.faces);return r.length?r[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(j){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(P){var G=P.familyName.toLowerCase(),k=this;return k.faces[G]=k.faces[G]||{},k.faces[G][P.cssFontWeight]=k.faces[G][P.cssFontWeight]||{},k.faces[G][P.cssFontWeight][P.cssFontStyle]=P,P},drawText:function(k){var c,r=this.getFace(),E=this.size/r.resolution,T=0,J=String(k).split(""),b=J.length,G=[];for(c=0;b>c;c++){var z=new $d,f=this.extractGlyphPoints(J[c],r,E,T,z);f&&(T+=f.offset*this.spacing,G.push(f.path))}var H=T/2;return{paths:G,offset:H}},extractGlyphPoints:function(o,Y,v,q,u){var x,F,n,s,f,R,d,T,y,E,b,X,e,i,C,B,V,t,O,A=[],J=Y.glyphs[o]||Y.glyphs["?"];if(J){if(J.o)for(s=J._cachedOutline||(J._cachedOutline=J.o.split(" ")),R=s.length,d=v,T=v,x=0;R>x;)switch(f=s[x++]){case"m":y=s[x++]*d+q,E=s[x++]*T,u.moveTo(y,E);break;case"l":y=s[x++]*d+q,E=s[x++]*T,u.lineTo(y,E);break;case"q":if(b=s[x++]*d+q,X=s[x++]*T,C=s[x++]*d+q,B=s[x++]*T,u.quadraticCurveTo(C,B,b,X),O=A[A.length-1])for(e=O.x,i=O.y,F=1,n=this.divisions;n>=F;F++){var D=F/n;
fh.b2(D,e,C,b),fh.b2(D,i,B,X)}break;case"b":if(b=s[x++]*d+q,X=s[x++]*T,C=s[x++]*d+q,B=s[x++]*T,V=s[x++]*d+q,t=s[x++]*T,u.bezierCurveTo(C,B,V,t,b,X),O=A[A.length-1])for(e=O.x,i=O.y,F=1,n=this.divisions;n>=F;F++){var D=F/n;fh.b3(D,e,C,V,b),fh.b3(D,i,B,t,X)}}return{offset:J.ha*v,path:u}}}};Db.generateShapes=function(c,J){J=J||{};var q=J.font;if(q===H&&(q=Db.getDefaultFont(),!q))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var R=J.size!==H?J.size:1,o=J.curveSegments!==H?J.curveSegments:4,d=J.spacing!==H?J.spacing:1,S=J.weight!==H?J.weight:"normal",r=J.style!==H?J.style:"normal";Db.size=R,Db.divisions=o,Db.face=q,Db.weight=S,Db.style=r,Db.spacing=d;for(var s=Db.drawText(c),f=s.paths,p=[],W=0,E=f.length;E>W;W++)Array.prototype.push.apply(p,f[W].toShapes());return p},function(f){var M=1e-10,Y=function(E,x){var X=E.length;if(3>X)return null;var B,m,K,w=[],d=[],S=[];if(u(E)>0)for(m=0;X>m;m++)d[m]=m;else for(m=0;X>m;m++)d[m]=X-1-m;var H=X,g=2*H;for(m=H-1;H>2;){if(g--<=0)return x?S:w;if(B=m,B>=H&&(B=0),m=B+1,m>=H&&(m=0),K=m+1,K>=H&&(K=0),q(E,B,m,K,H,d)){var $,r,P,Q,N;for($=d[B],r=d[m],P=d[K],w.push([E[$],E[r],E[P]]),S.push([d[B],d[m],d[K]]),Q=m,N=m+1;H>N;Q++,N++)d[Q]=d[N];H--,g=2*H}}return x?S:w},u=function(H){for(var k=H.length,t=0,r=k-1,j=0;k>j;r=j++)t+=H[r].x*H[j].y-H[j].x*H[r].y;return.5*t},q=function(C,v,d,J,t,w){var V,_,y,I,N,c,u,E,m;if(_=C[w[v]].x,y=C[w[v]].y,I=C[w[d]].x,N=C[w[d]].y,c=C[w[J]].x,u=C[w[J]].y,M>(I-_)*(u-y)-(N-y)*(c-_))return!1;var X,B,o,e,s,P,G,z,j,Y,Z,n,g,q,H;for(X=c-I,B=u-N,o=_-c,e=y-u,s=I-_,P=N-y,V=0;t>V;V++)if(E=C[w[V]].x,m=C[w[V]].y,!(E===_&&m===y||E===I&&m===N||E===c&&m===u)&&(G=E-_,z=m-y,j=E-I,Y=m-N,Z=E-c,n=m-u,H=X*Y-B*j,g=s*z-P*G,q=o*n-e*Z,H>=-M&&q>=-M&&g>=-M))return!1;return!0};return f.Triangulate=Y,f.Triangulate.area=u,f}(Db),M._typeface_js={faces:Db.faces,loadFace:Db.loadFace};var lm=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},Zn=lm.prototype={constructor:lm,computeFaceNormals:function(){for(var U=new Rh,R=new Rh,j=0,W=this.faces.length;W>j;j++){var L=this.faces[j],J=this.vertices[L.a],o=this.vertices[L.b],B=this.vertices[L.c];U.subVectors(B,o),R.subVectors(J,o),U.cross(R),U.normalize(),L.normal.copy(U)}},computeVertexNormals:function(U){var m,q,f,L,G,Q;for(Q=new Array(this.vertices.length),m=0,q=this.vertices.length;q>m;m++)Q[m]=new Rh;if(U){var I,y,c,w=new Rh,N=new Rh;for(f=0,L=this.faces.length;L>f;f++)G=this.faces[f],I=this.vertices[G.a],y=this.vertices[G.b],c=this.vertices[G.c],w.subVectors(c,y),N.subVectors(I,y),w.cross(N),Q[G.a].add(w),Q[G.b].add(w),Q[G.c].add(w)}else for(f=0,L=this.faces.length;L>f;f++)G=this.faces[f],Q[G.a].add(G.normal),Q[G.b].add(G.normal),Q[G.c].add(G.normal);for(m=0,q=this.vertices.length;q>m;m++)Q[m].normalize();for(f=0,L=this.faces.length;L>f;f++)G=this.faces[f],G.vertexNormals[0]=Q[G.a].clone(),G.vertexNormals[1]=Q[G.b].clone(),G.vertexNormals[2]=Q[G.c].clone()},mergeVertices:function(){var O,R,Q,g,m,I,n,Z,L={},r=[],p=[],N=4,e=j(10,N);for(Q=0,g=this.vertices.length;g>Q;Q++)O=this.vertices[Q],R=U(O.x*e)+"_"+U(O.y*e)+"_"+U(O.z*e),L[R]===H?(L[R]=Q,r.push(this.vertices[Q]),p[Q]=r.length-1):p[Q]=p[L[R]];var C=[];for(Q=0,g=this.faces.length;g>Q;Q++){m=this.faces[Q],m.a=p[m.a],m.b=p[m.b],m.c=p[m.c],I=[m.a,m.b,m.c];for(var y=0;3>y;y++)if(I[y]==I[(y+1)%3]){C.push(Q);break}}for(Q=C.length-1;Q>=0;Q--){var w=C[Q];for(this.faces.splice(w,1),n=0,Z=this.faceVertexUvs.length;Z>n;n++)this.faceVertexUvs[n].splice(w,1)}var f=this.vertices.length-r.length;return this.vertices=r,f}},Am=function($,U,i,f,u,n,B){this.aX=$,this.aY=U,this.xRadius=i,this.yRadius=f,this.aStartAngle=u,this.aEndAngle=n,this.aClockwise=B};Am.prototype=Oo(Th),Am.prototype.getPoint=function(y){var S,J=this.aEndAngle-this.aStartAngle;0>J&&(J+=b),J>b&&(J-=b),S=this.aClockwise===!0?this.aEndAngle+(1-y)*(b-J):this.aStartAngle+y*J;var o=this.aX+this.xRadius*i(S),t=this.aY+this.yRadius*n(S);return new $r(o,t)};var Jj=function(h,S){this.v1=h,this.v2=S},xd=Jj.prototype=Oo(Th);xd.getPoint=function(d){var A=this.v2.clone().sub(this.v1);return A.multiplyScalar(d).add(this.v1),A},xd.getPointAt=function(n){return this.getPoint(n)},xd.getTangent=function(){var Z=this.v2.clone().sub(this.v1);return Z.normalize()};var bi=function(G,h,l){this.v0=G,this.v1=h,this.v2=l};bi.prototype=Oo(Th),bi.prototype.getPoint=function(G){var T,l;return T=fh.b2(G,this.v0.x,this.v1.x,this.v2.x),l=fh.b2(G,this.v0.y,this.v1.y,this.v2.y),new $r(T,l)};var zk=function(w,D,i,$){this.v0=w,this.v1=D,this.v2=i,this.v3=$};zk.prototype=Oo(Th),zk.prototype.getPoint=function(L){var k,j;return k=fh.b3(L,this.v0.x,this.v1.x,this.v2.x,this.v3.x),j=fh.b3(L,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new $r(k,j)},xs.create(function(_,r){this.v1=_,this.v2=r},function(u){var D=new Rh;return D.subVectors(this.v2,this.v1),D.multiplyScalar(u),D.add(this.v1),D});var Md=xs.create(function(R,P,D){this.v0=R,this.v1=P,this.v2=D},function(g){var R,K,m;return R=fh.b2(g,this.v0.x,this.v1.x,this.v2.x),K=fh.b2(g,this.v0.y,this.v1.y,this.v2.y),m=fh.b2(g,this.v0.z,this.v1.z,this.v2.z),new Rh(R,K,m)}),_j=xs.create(function(Y,C,L,D){this.v0=Y,this.v1=C,this.v2=L,this.v3=D},function(i){var p,O,G;return p=fh.b3(i,this.v0.x,this.v1.x,this.v2.x,this.v3.x),O=fh.b3(i,this.v0.y,this.v1.y,this.v2.y,this.v3.y),G=fh.b3(i,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Rh(p,O,G)}),Wq=function(e,h,R,Q,w,J,N,A){lm.call(this),Q=Q!==H?Q:.5,w=w!==H?w:.5,A=A!==H?A:1,e=e||8,J=J||0,N=N||b;var u,E,W=1,k=A/2,x=[],s=[],j=this.vertices,U=this.faces,O=this.faceVertexUvs;for(E=0;W>=E;E++){var G=[],m=[],T=E/W,q=T*(w-Q)+Q;for(u=0;e>=u;u++){var o=u/e,d=new Rh,_=-(o*N+J);d.z=q*n(_),d.y=-T*A+k,d.x=q*i(_),j.push(d),G.push(j.length-1),m.push(new $r(o,T))}x.push(G),s.push(m)}var v,P,p=(w-Q)/A;for(u=0;e>u;u++)for(0!==Q?(v=j[x[0][u]].clone(),P=j[x[0][u+1]].clone()):(v=j[x[1][u]].clone(),P=j[x[1][u+1]].clone()),v.setY(y(v.x*v.x+v.z*v.z)*p).normalize(),P.setY(y(P.x*P.x+P.z*P.z)*p).normalize(),E=0;W>E;E++){var F=x[E][u],K=x[E+1][u],f=x[E+1][u+1],Z=x[E][u+1],X=v.clone(),t=v.clone(),L=P.clone(),z=P.clone(),B=s[E][u].clone(),I=s[E+1][u].clone(),Y=s[E+1][u+1].clone(),D=s[E][u+1].clone();U.push(new Vc(F,K,Z,[X,t,z])),O[0].push([B,I,D]),U.push(new Vc(K,f,Z,[t.clone(),L,z.clone()])),O[0].push([I.clone(),Y,D.clone()])}if(h&&Q>0)for(this.vertices.push(new Rh(0,k,0)),u=0;e>u;u++){var F=x[0][u],K=x[0][u+1],f=this.vertices.length-1,X=new Rh(0,1,0),t=new Rh(0,1,0),L=new Rh(0,1,0),B=s[0][u].clone(),I=s[0][u+1].clone(),Y=new $r(I.x,0);U.push(new Vc(F,K,f,[X,t,L],null,1));var g=u/e*b,l=i(g),M=n(g),C=(u+1)/e*b,c=i(C),r=n(C);O[0].push([new $r(.5+.5*l,.5+.5*M),new $r(.5+.5*c,.5+.5*r),new $r(.5,.5)])}if(R&&w>0)for(this.vertices.push(new Rh(0,-k,0)),u=0;e>u;u++){var F=x[E][u+1],K=x[E][u],f=j.length-1,X=new Rh(0,-1,0),t=new Rh(0,-1,0),L=new Rh(0,-1,0),B=s[E][u+1].clone(),I=s[E][u].clone();U.push(new Vc(F,K,f,[X,t,L],null,2));var g=u/e*b,l=i(g),M=n(g),C=(u+1)/e*b,c=i(C),r=n(C);O[0].push([new $r(.5+.5*c,.5-.5*r),new $r(.5+.5*l,.5-.5*M),new $r(.5,.5)])}};Wq.prototype=Oo(Zn);var Ur=function(j,V,u,B,$,h,x){lm.call(this),x=x||.5,j=j||16,V=V||16,u=(u!==H?u:0)-e,B=B!==H?B:b,$=$!==H?$:0,h=h!==H?h:e;var f,L,s=[],c=[],g=this.vertices,A=this.faces,P=this.faceVertexUvs;for(L=0;V>=L;L++){var a=[],I=[];for(f=0;j>=f;f++){var N=f/j,F=L/V,m=new Rh;m.x=-x*i(u+N*B)*n($+F*h),m.y=x*i($+F*h),m.z=x*n(u+N*B)*n($+F*h),g.push(m),a.push(g.length-1),I.push(new $r(N,F))}s.push(a),c.push(I)}for(L=0;V>L;L++)for(f=0;j>f;f++){var K=s[L][f+1],o=s[L][f],T=s[L+1][f],p=s[L+1][f+1],v=g[K].clone().normalize(),y=g[o].clone().normalize(),X=g[T].clone().normalize(),w=g[p].clone().normalize(),R=c[L][f+1].clone(),t=c[L][f].clone(),J=c[L+1][f].clone(),E=c[L+1][f+1].clone();q(g[K].y)===x?(R.x=(R.x+t.x)/2,A.push(new Vc(K,T,p,[v,X,w])),P[0].push([R,J,E])):q(g[T].y)===x?(J.x=(J.x+E.x)/2,A.push(new Vc(K,o,T,[v,y,X])),P[0].push([R,t,J])):(A.push(new Vc(K,o,p,[v,y,w])),P[0].push([R,t,E]),A.push(new Vc(o,T,p,[y.clone(),X,w.clone()])),P[0].push([t.clone(),J,E.clone()]))}};Ur.prototype=Oo(Zn);var yh=function(R,B,K,g,v,m){lm.call(this),R=R||.33,B=B||.17,g=g||8,K=K||6,v=v||0,m=m||b;for(var N=new Rh,c=[],$=[],J=0;g>=J;J++)for(var Y=J/g*b+e,p=0;K>=p;p++){var W=p/K*m+v;N.x=R*i(W),N.z=-R*n(W);var l=new Rh,d=R+B*i(Y);l.x=d*i(W),l.z=-d*n(W),l.y=B*n(Y),this.vertices.push(l),c.push(new $r(p/K,1-J/g)),$.push(l.clone().sub(N).normalize())}for(var J=1;g>=J;J++)for(var p=1;K>=p;p++){var D=(K+1)*J+p-1,L=(K+1)*(J-1)+p-1,X=(K+1)*(J-1)+p,C=(K+1)*J+p,S=new Vc(D,L,C,[$[D].clone(),$[L].clone(),$[C].clone()]);this.faces.push(S),this.faceVertexUvs[0].push([c[D].clone(),c[L].clone(),c[C].clone()]),S=new Vc(L,X,C,[$[L].clone(),$[X].clone(),$[C].clone()]),this.faces.push(S),this.faceVertexUvs[0].push([c[L].clone(),c[X].clone(),c[C].clone()])}this.computeFaceNormals()};yh.prototype=Oo(Zn);var We=function(B,x,l){return B?(lm.call(this),B=B instanceof Array?B:[B],this.addShapeList(B,x),x.convertYZ!==!1&&cj(this,l),this.computeFaceNormals(),void 0):(B=[],void 0)},Zg=We.prototype=Oo(lm.prototype);Zg.addShapeList=function(I,m){for(var D=I.length,N=0;D>N;N++){var z=I[N];this.addShape(z,m)}},Zg.addShape=function(I,j){function F(){if(j.bottom)for(var U=0;r>U;U++)k=t[U],p(k[2],k[1],k[0],!0);if(j.top)for(U=0;r>U;U++)k=t[U],p(k[0]+l*Q,k[1]+l*Q,k[2]+l*Q,!1)}function W(){var q=0;for($(Y,q),q+=Y.length,e=0,T=i.length;T>e;e++)S=i[e],$(S,q),q+=S.length}function $(N,g){for(var C,U,b=N.length;--b>=0;){C=b,U=b-1,0>U&&(U=N.length-1);var w=0,u=Q;for(w=0;u>w;w++){var K=l*w,T=l*(w+1),Z=g+C+K,i=g+U+K,P=g+U+T,q=g+C+T;_(Z,i,P,q,N,w,u,C,U)}}}function C(W,h,V){U.vertices.push(new Rh(W,h,V))}function p(n,O,e,_){n+=m,O+=m,e+=m,U.faces.push(new Vc(n,O,e,null,null,_?2:1));var B=_?x.generateBottomUV(U,I,j,n,O,e):x.generateTopUV(U,I,j,n,O,e);U.faceVertexUvs[0].push(B)}function _(u,y,f,P,E,p,M,H,L){u+=m,y+=m,f+=m,P+=m,U.faces.push(new Vc(u,y,P)),U.faces.push(new Vc(y,f,P));var S=x.generateSideWallUV(U,I,E,j,u,y,f,P,p,M,H,L);U.faceVertexUvs[0].push([S[0],S[1],S[3]]),U.faceVertexUvs[0].push([S[1],S[2],S[3]])}var f,A,E,M,d,c=j.amount,s=j.curveSegments||xf,Q=j.steps||1,a=j.extrudePath,O=!1,x=new ao(j.repeatUVLength);a&&(f=a.getSpacedPoints(Q),O=!0,A=j.frames!==H?j.frames:new Wp.FrenetFrames(a,Q,!1),E=new Rh,M=new Rh,d=new Rh);var S,e,T,U=this,m=this.vertices.length,V=I.extractPoints(s),q=V.shape,i=V.holes,J=!fh.isClockWise(q);if(J){for(q=q.reverse(),e=0,T=i.length;T>e;e++)S=i[e],fh.isClockWise(S)&&(i[e]=S.reverse());J=!1}var t=fh.triangulateShape(q,i),Y=q;for(e=0,T=i.length;T>e;e++)S=i[e],q=q.concat(S);for(var u,k,l=q.length,r=t.length,B=0;l>B;B++)u=q[B],O?(M.copy(A.normals[0]).multiplyScalar(u.x),E.copy(A.binormals[0]).multiplyScalar(u.y),d.copy(f[0]).add(M).add(E),C(d.x,d.y,d.z)):C(u.x,u.y,0);var n;for(n=1;Q>=n;n++)for(B=0;l>B;B++)u=q[B],O?(M.copy(A.normals[n]).multiplyScalar(u.x),E.copy(A.binormals[n]).multiplyScalar(u.y),d.copy(f[n]).add(M).add(E),C(d.x,d.y,d.z)):C(u.x,u.y,c/Q*n);F(),W()};var Wp=function(c,S,t,y,O){function Z(j,U,f){return V.vertices.push(new Rh(j,U,f))-1}lm.call(this),S=S||64,t=t||1,y=y||8,O=O||!1;var C,l,A,R,K,Q,M,I,$,Y,U,W,e,N,X,P,p,o,J,x,H=[],V=this,v=S+1,w=new Rh,q=new Wp.FrenetFrames(c,S,O),u=q.tangents,z=q.normals,L=q.binormals;for(this.tangents=u,this.normals=z,this.binormals=L,$=0;v>$;$++)for(H[$]=[],R=$/(v-1),I=c.getPointAt(R),C=u[$],l=z[$],A=L[$],Y=0;y>Y;Y++)K=Y/y*b,Q=-t*i(K),M=t*n(K),w.copy(I),w.x+=Q*l.x+M*A.x,w.y+=Q*l.y+M*A.y,w.z+=Q*l.z+M*A.z,H[$][Y]=Z(w.x,w.y,w.z);for($=0;S>$;$++)for(Y=0;y>Y;Y++)U=O?($+1)%S:$+1,W=(Y+1)%y,e=H[$][Y],N=H[U][Y],X=H[U][W],P=H[$][W],p=new $r($/S,Y/y),o=new $r(($+1)/S,Y/y),J=new $r(($+1)/S,(Y+1)/y),x=new $r($/S,(Y+1)/y),this.faces.push(new Vc(e,N,P)),this.faceVertexUvs[0].push([p,o,x]),this.faces.push(new Vc(N,X,P)),this.faceVertexUvs[0].push([o.clone(),J,x.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Wp.prototype=Oo(Zn),Wp.FrenetFrames=function(n,x,f){function l(){t[0]=new Rh,s[0]=new Rh,v=Number.MAX_VALUE,O=q(b[0].x),L=q(b[0].y),d=q(b[0].z),v>=O&&(v=O,Y.set(1,0,0)),v>=L&&(v=L,Y.set(0,1,0)),v>=d&&Y.set(0,0,1),_.crossVectors(b[0],Y).normalize(),t[0].crossVectors(b[0],_),s[0].crossVectors(b[0],t[0])}var u,v,O,L,d,C,c,Y=new Rh,b=[],t=[],s=[],_=new Rh,j=new qo,e=x+1,m=1e-4;for(this.tangents=b,this.normals=t,this.binormals=s,C=0;e>C;C++)c=C/(e-1),b[C]=n.getTangentAt(c),b[C].normalize();for(l(),C=1;e>C;C++)t[C]=t[C-1].clone(),s[C]=s[C-1].clone(),_.crossVectors(b[C-1],b[C]),_.length()>m&&(_.normalize(),u=g(zq(b[C-1].dot(b[C]),-1,1)),t[C].applyMatrix4(j.makeRotationAxis(_,u))),s[C].crossVectors(b[C],t[C]);if(f)for(u=g(zq(t[0].dot(t[e-1]),-1,1)),u/=e-1,b[0].dot(_.crossVectors(t[0],t[e-1]))>0&&(u=-u),C=1;e>C;C++)t[C].applyMatrix4(j.makeRotationAxis(b[C],u*C)),s[C].crossVectors(b[C],t[C])};var Fm=function(M,C,V,z){lm.call(this),C=C||18,V=V||0,z=z==R?b:z;for(var w=1/(M.length-1),O=1/C,Y=0,H=C;H>=Y;Y++)for(var x=V+Y*O*z,B=i(x),j=n(x),U=0,T=M.length;T>U;U++){var P=M[U],l=new Rh;l.x=B*P.x-j*P.y,l.y=j*P.x+B*P.y,l.z=P.z,this.vertices.push(l)}for(var L=M.length,Y=0,H=C;H>Y;Y++)for(var U=0,T=M.length-1;T>U;U++){var J=U+L*Y,g=J,v=J+L,B=J+1+L,F=J+1,N=Y*O,I=U*w,G=N+O,m=I+w;this.faces.push(new Vc(g,F,v)),this.faceVertexUvs[0].push([new $r(N,I),new $r(N,m),new $r(G,I)]),this.faces.push(new Vc(v,F,B)),this.faceVertexUvs[0].push([new $r(G,I),new $r(N,m),new $r(G,m)])}this.mergeVertices(),cj(this),this.computeFaceNormals(),this.computeVertexNormals()};Fm.prototype=Oo(Zn);var eo=function(p,z){z=z||{};var m=Db.generateShapes(p,z);z.amount=z.amount!==H?z.amount:.5,z.convertYZ=!1,z.fill!==!1&&(z.bottom=!0,z.top=!0),We.call(this,m,z)};eo.prototype=Oo(Zg);var kk=B.Node=function(){Ep(kk,this)},Ud={X:Kc,Y:Cf,Z:sd},wh={X:0,Y:1,Z:2},ee={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Eg="xzy",Fr=function(B,h,r){if(h){var a=h[0],k=h[1],v=h[2];"xzy"===r?(Cf(B,k),sd(B,v),Kc(B,a)):"xyz"===r?(sd(B,v),Cf(B,k),Kc(B,a)):"yxz"===r?(sd(B,v),Kc(B,a),Cf(B,k)):"yzx"===r?(Kc(B,a),sd(B,v),Cf(B,k)):"zxy"===r?(Cf(B,k),Kc(B,a),sd(B,v)):"zyx"===r?(Kc(B,a),Cf(B,k),sd(B,v)):(Cf(B,k),sd(B,v),Kc(B,a))}};ni("Node",uc,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Eg,_64O:0,_rotationX:0,_53O:0,_host:R,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Oh},_22Q:function(){return gj},getX:function(){return this.p().x},setX:function(y){this.p(y,this.p().y)},getY:function(){return this.p().y},setY:function(V){this.p(this.p().x,V)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(w){this.setAnchor(w,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(l){this.setAnchor(this.getAnchor().x,l)},getScaleX:function(){return this.getScale().x},setScaleX:function(p){this.setScale(p,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(w){this.setScale(this.getScale().x,w)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(t,D){dm(t,jk(R,R,this.r3(),this.getRotationMode())),this.translate3d(t[0]*D,t[1]*D,t[2]*D)},translateFront:function(M){this.translate3dBy([0,0,1],M)},translateBack:function(I){this.translate3dBy([0,0,-1],I)},translateLeft:function(F){this.translate3dBy([-1,0,0],F)},translateRight:function(v){this.translate3dBy([1,0,0],v)},translateTop:function(i){this.translate3dBy([0,1,0],i)},translateBottom:function(d){this.translate3dBy([0,-1,0],d)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(B,Z,n){1===arguments.length&&(Z=B[1],n=B[2],B=B[0]),this.p(B,n),this.setElevation(Z)},translate3d:function(q,f,J){1===arguments.length&&(f=q[1],J=q[2],q=q[0]),this.translate(q,J),this.setElevation(this._54O+f)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(c,o,U){1===arguments.length&&(o=c[1],U=c[2],c=c[0]),this.setSize(c,U),this.setTall(o)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(i,A,w){1===arguments.length&&(A=i[1],w=i[2],i=i[0]),this.setRotationX(i),this.setRotation(-A),this.setRotationZ(w)},setRotationY:function(X){this.setRotation(-X)},getRotationY:function(){return-this._64O},lookAtDirection:function(E,L){L=L||ck;var A=this,B=Wj(E);L===ck?(A.r3([-Z(E[1]/B),-F(E[2],E[0])+W,0]),A.setRotationMode("xzy")):L===vk?(A.r3(0,-F(E[2],E[0]),Z(E[1]/B)),A.setRotationMode("zyx")):L===_c?(A.r3(0,-F(E[2],E[0])+e,-Z(E[1]/B)),A.setRotationMode("zyx")):L===gf?(A.r3([-Z(E[1]/B)+W,-F(E[2],E[0])+W,0]),A.setRotationMode("xzy")):L===fm&&(A.r3([-Z(E[1]/B)-W,-F(E[2],E[0])+W,0]),A.setRotationMode("xzy")),L===ej&&(A.r3([-Z(E[1]/B)+e,-F(E[2],E[0])+W,e]),A.setRotationMode("zxy"))},lookAt:function(J,o){return this.lookAtDirection(Ed(J,this.p3()),o)},lookAtX:function(){var I=new Fe,C=new Fe,o=new Fe,O=new vh,X=new vh,c=new xk;return function(v,G){var i=Od(this);if(O.fromArray(i),o.copy(this.p3()),I.copy(v).sub(o),!(I.lengthSq()<1e-6)){I.normalize(),G===ck?C.set(0,0,1):G===ej?C.set(0,0,-1):G===_c?C.set(-1,0,0):G===vk?C.set(1,0,0):G===gf?C.set(0,1,0):G===fm&&C.set(0,-1,0),C.applyMatrix4(O).sub(o).normalize();var A=Math.acos(I.dot(C));if(A){var Y=I.clone().cross(C);Y.lengthSq()<1e-6&&(G===gf||G===fm?Y.set(0,0,1).applyMatrix4(O).sub(o):Y.set(0,1,0).applyMatrix4(O).sub(o)),Y.normalize(),c.set(this.r3(),this.getRotationMode(),!0),O.makeRotationFromEuler(c),X.makeRotationAxis(Y,-A),c.setFromRotationMatrix(X.multiply(O)),this.r3([c.x,c.y,c.z])}}}}(),getHost:function(){return this._host},setHost:function(x){var Z=this;if(Z!==x&&Z._host!==x){var o=Z._host;o&&o._removeAttach(Z),Z._host=x,Z._host&&Z._host._addAttach(Z),Z.fp("host",o,x),Z.onHostChanged(o,x)}},getAttaches:function(){return this._69O},_addAttach:function(b){var U=this;U._69O||(U._69O=new Mf),U._69O.add(b),U.fp("attaches",R,b)},_removeAttach:function(m){var L=this;L._69O.remove(m),L._69O.isEmpty()&&delete L._69O,L.fp("attaches",m,R)},getImage:function(){if(this._pendingCheckImageJSON){var W=V.getImage(this._image);W&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Nm&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(d){var l=this,Z=l._image,b=l.getWidth(),N=l.getHeight();l._image=d,l.fp("image",Z,d)&&(null!=d&&(zh(d)||Fc(d)&&/\.json$/i.test(d))&&(this._pendingCheckImageJSON=!0),l.fp(ok,b,l.getWidth()),l.fp(Sh,N,l.getHeight()))},getElevation:function(){return this._54O},setElevation:function(F){var X=this;if(!X._50O){X._50O=1;var v=X._54O;X._54O=F,X.fp(aq,v,F),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(i){var L=this;if(!L._49O){L._49O=1;var d=L._64O;L._64O=i,L.fp(qg,d,i),delete L._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(L){var I=this;if(!I._51O){I._51O=1;var V=I._rotationX;I._rotationX=L,I.fp("rotationX",V,L),delete I._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(X){var o=this;if(!o._52O){o._52O=1;var O=o._53O;o._53O=X,o.fp("rotationZ",O,X),delete o._52O}},getPosition:function(){return this._position},setPosition:function(z,g){var L=this;if(!L._50I){L._50I=1;var t;if(t=2===arguments.length?{x:z,y:g}:z,t.x!==L._position.x||t.y!==L._position.y){var b=L._position;L._position=t,L.fp(Tj,b,t)}delete L._50I}},translate:function(Q,$){var v=this._position;this.p(v.x+Q,v.y+$)},getWidth:function(){var K=this;if(K._width>=0)return K._width;var I=K.getStyle("shape3d");if(I){var $=Jm(I);if($&&$.rawS3)return $.rawS3[0];if("billboard"===I||"plane"===I){var D=Tn(K.getStyle("shape3d.image"));return D?gs(D,K):20}}var D=Tn(K._image);return D?gs(D,K):20},setWidth:function(F){var E=this,k=E._width;E._width=F,E.fp(ok,k,F)},getHeight:function(){var d=this;if(d._height>=0)return d._height;var Y=d.getStyle("shape3d");if(Y){var o=Jm(Y);if(o&&o.rawS3)return o.rawS3[2];if("plane"===Y){var j=Tn(d.getStyle("shape3d.image"));return j?rr(j,d):20}if("billboard"===Y)return 2}var j=Tn(d._image);return j?rr(j,d):20},setHeight:function(o){var e=this,F=e._height;e._height=o,e.fp(Sh,F,o)},getTall:function(){var s=this;if(s._tall>=0)return s._tall;var Q=s.getStyle("shape3d");if(Q){var R=Jm(Q);if(R&&R.rawS3)return R.rawS3[1];if("billboard"===Q){var E=Tn(s.getStyle("shape3d.image"));return E?rr(E,s):20}if("plane"===Q)return 2}return 20},setTall:function(U){var H=this,X=H._tall;H._tall=U,H.fp("tall",X,U)},setSize:function(z,L){var G=this;2===arguments.length?(G.setWidth(z),G.setHeight(L)):(G.setWidth(z.width),G.setHeight(z.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(r,x,P,I,W){var g=this,$=g.getAnchor(),O=g.getScale();arguments.length<=2&&(W=x,x=r.y,P=r.width,I=r.height,r=r.x);var K=W&&O.x<0?1-$.x:$.x,V=W&&O.y<0?1-$.y:$.y;g.p(r+P*K,x+I*V),W&&(P/=Math.abs(O.x),I/=Math.abs(O.y)),g.setWidth(P),g.setHeight(I)},getMatrix:function(){var l=this,F=l._64O,S=l._position,a=l.getScale();return new Fn(F,S.x,S.y,a.x,a.y)},getAnchorRect:function(){var O=this,A=O.getWidth(),r=O.getHeight(),c=O.getAnchor();return{x:-A*c.x,y:-r*c.y,width:A,height:r}},toLocal:function(L){return this.getMatrix().tfi(L)},toGlobal:function(d){return this.getMatrix().tf(d)},getAttachPosition:function(){var E=new Fn;return function(v,T,X,b){X=X||0,b=b||0;var F=this,V=F.getAnchor(),R=F._64O,N=F._position,Z=F.getScale();return E.setFromTransform(R,N.x,N.y).tf({x:X+Z.x*F.getWidth()*(v-V.x),y:b+Z.y*F.getHeight()*(T-V.y)})}}(),isInRect:function(V){V=this.toLocal(V);var n=this.getWidth(),H=this.getHeight();return V.x+=n*this.getAnchorX(),V.y+=H*this.getAnchorY(),!(V.x<0||V.y<0||V.x>n||V.y>H)},getRect:function(){var L=this,g=L.getWidth(),W=L.getHeight(),x=L.getAnchor(),I={x:-g*x.x,y:-W*x.y,width:g,height:W},m=L.getMatrix();return I=vo([m.tf(I.x,I.y),m.tf(I.x+I.width,I.y),m.tf(I.x+I.width,I.y+I.height),m.tf(I.x,I.y+I.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var i=this,n=i.getAnchor(),k=i._anchorElevation;return{x:n.x,y:k,z:n.y}},setAnchorElevation:function(t){var _=this,e=_._anchorElevation;return e!==t?(_._anchorElevation=t,_.fp("anchorElevation",e,t),!0):!1},setAnchor3d:function(N,m,r,F){var e,B=this;"number"==typeof N?e={x:N,y:m,z:r}:(e=N.length?{x:N[0],y:N[1],z:N[2]}:N,F=m);var D=B.getDataModel();D&&D.beginTransaction();var p=B.getAnchor3d(),x=B.setAnchor(e.x,e.z);if(B.setAnchorElevation(e.y)&&(x=!0),x&&F&&!Om){B.getAnchor3d();var s=Od(B),b=dm([e.x-p.x,e.y-p.y,e.z-p.z],s);B.p3(b)}return D&&D.endTransaction(),x},getAnchor:function(){var K=this;if(K.hasOwnProperty("_anchor"))return K._anchor;var I=Tn(K._image);return I&&I.anchorX!==H?{x:I.anchorX,y:I.anchorY}:K._anchor},setAnchor:function(p,W,v){var g,P=this;"number"==typeof p?g={x:p,y:W}:(g=p.length?{x:p[0],y:p[1]}:p,v=W);var u=P.getAnchor();if(u.x!==g.x||u.y!==g.y){var C=P.getDataModel();if(C&&C.beginTransaction(),P._anchor=g,P.fp("anchor",u,g),v&&!Om){var A=P.getPosition(),w=P.getSize(),Y=P.getRotation(),o=P.getScale(),R=-w.width*(u.x-g.x)*o.x,S=-w.height*(u.y-g.y)*o.y,M=n(Y),Z=i(Y);P.setPosition(A.x+Z*R-M*S,A.y+M*R+Z*S)}return C&&C.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(B,u){var Q,A=this;Q=2===arguments.length?{x:B,y:u}:B;var a=A.getScale();(a.x!==Q.x||a.y!==Q.y)&&(A._scale=Q,A.fp("scale",a,Q))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var g=this,N=g._scaleTall,A=g.getScale();return[A.x,N,A.y]},getFinalScale3d:function(){var D=this,n=D.s3(),m=D._dynamicScale3d,N=D.getScale3d();return n&&(N[0]*=n[0],N[1]*=n[1],N[2]*=n[2]),m&&(N[0]*=m[0],N[1]*=m[1],N[2]*=m[2]),N},getFinalRotation3d:function(){var B=this;return B._dynamicRotation||B.r3()},setScaleTall:function(F){var k=this,i=k._scaleTall;i!==F&&(k._scaleTall=F,k.fp("scaleTall",i,F))},setScale3d:function(b,D,Z){var B,v=this;B="number"==typeof b?{x:b,y:D,z:Z}:b.length?{x:b[0],y:b[1],z:b[2]}:b,v.setScaleTall(B.y),v.setScale(B.x,B.z)},getCorners:function(J,A){J==R&&(J=0),A==R&&(A=J);var o=this,X=o.getAnchor(),U=o.getWidth(),P=o.getHeight(),u=-U*X.x-J,j=-P*X.y-A,V=U+2*J,Q=P+2*A,I=o.getMatrix();return[I.tf(u,j),I.tf(u,j+Q),I.tf(u+V,j+Q),I.tf(u+V,j)]},getEditControlPoints:function(P,t,S){t==R&&(t=0),S==R&&(S=t);var n=this,I=n.getAnchor(),u=n.getWidth(),O=n.getHeight(),L=-u*I.x-t,g=-O*I.y-S,W=u+2*t,U=O+2*S;if(P)return[{x:L,y:g},{x:L,y:0},{x:L,y:g+U},{x:0,y:g+U},{x:L+W,y:g+U},{x:L+W,y:0},{x:L+W,y:g},{x:0,y:g}];var D=n.getMatrix();return[D.tf(L,g),D.tf(L,0),D.tf(L,g+U),D.tf(0,g+U),D.tf(L+W,g+U),D.tf(L+W,0),D.tf(L+W,g),D.tf(0,g)]},rotateAt:function(D,X,B){var J=this,K=J._position,O=J._64O,r=new Fn(O,K.x,K.y).tf(D,X),Z=y(D*D+X*X),T=F(K.y-r.y,K.x-r.x)+B;J.setRotation(O+B),J.p(r.x+Z*i(T),r.y+Z*n(T))},onParentChanged:function(){kk.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var B={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(w){B[w]=!0}),function(p){var T=this;kk.superClass.onPropertyChanged.call(T,p),B[p.property]&&!T._layoutUpdating&&T.updateLayoutParameters(null,p.property),T._69O&&T._69O.each(function(E){E.handleHostPropertyChange(p)}),T._49I&&T._49I.each(function(v){v.fp("agentChange",!0,!1)}),"a:layout"===p.property.substring(0,8)&&this.updateAttach()}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(q){this.updateAttach(q)},onStyleChanged:function(X){kk.superClass.onStyleChanged.apply(this,arguments),Qd[X]&&this.updateAttach()},updateAttach:function(g){var E=this;return Om?(E.updateLayoutParameters(),void 0):(E._51I||(E._51I=1,E._71O(g),delete E._51I),void 0)},_71O:function(Y){var S,l,H,U,u,K,X,a,f=this,O=f._host,x=Y?Y.property:R,V=Y?Y.oldValue:R,j=Y?Y.newValue:R;if(O instanceof kk&&(X=Tn(O.getImage()),X&&X.layoutAttach&&(a=X.layoutAttach)),Y&&!Eo[x]&&"a:layout"!==x.substring(0,8)||!a||a(O,this))if(O instanceof B.Grid){if(x===aq)f.setElevation(f._54O+j-V);else if(!Y||Ee[x]){if(S=f.s("attach.row.index"),l=f.s("attach.column.index"),H=O.getCellRect(S,l),!H)return;U=f.s("attach.row.span"),u=f.s("attach.column.span"),(1!==U||1!==u)&&(H=ri(H,O.getCellRect(S+U-1,l+u-1))),An(H,f,"attach.padding",1),f.setRect(H)}}else if(O instanceof Re&&(K=f.s("attach.index"))>=0&&(!Y||yi[x])){var M=f.s("attach.thickness"),N=O.getScale(),I=Math.max(N.x,N.y);M>0&&f.setHeight(O.getThickness()*M*I);var m=f.s("attach.offset"),L=O.getPoints(),C=L.size();if(C>K){var k=O.getPointsMatrix2d(),b=L.get(K),r=C===K+1?L.get(0):L.get(K+1);b=k.apply(b),r=k.apply(r);var p=[r.x-b.x,r.y-b.y],o=Wj(p);if(o){f.s("attach.offset.relative")&&(m*=o),f.s("attach.offset.opposite")&&(m=o-m);var P={x:b.x+p[0]/o*m,y:b.y+p[1]/o*m},q=f.s("attach.gap");q&&(f.s("attach.gap.relative")&&(q*=O.getThickness()*I),P=No(R,P,r,q)),f.p(P),f.setRotation(F(p[1],p[0]))}}}else Y&&(x===Tj?f.translate(j.x-V.x,j.y-V.y):x===aq?f.setElevation(f._54O+j-V):ml[x]?f._11Q(O,x,j-V):("anchor"===x||"width"===x||"height"===x||"scale"===x)&&f.layout(O))},_11Q:function(){var U=new B.Math.Euler,f=B.Math.Euler.ReverseOrder,p=new B.Math.Vector2,G=new B.Math.Vector2;return function(X,k,j){var M=this,t=X.p3(),Q=X.r3(),q=M.p3(),B=M.r3();if(k===qg&&(k="rotationY",j=-j),(k===qg||"rotationY"===k)&&0===B[0]&&0===B[2]&&0===Q[0]&&0===Q[2]&&0===q[1]&&0===t[1])return M.setRotation(-B[1]-j),p.set(q[0],q[2]).rotateAround(G.set(t[0],t[2]),-j),M.p(p.x,p.y),void 0;var u=ee[X.getRotationMode()],g=u[0],K=u[1],C=u[2],R=Ud[g],L=Ud[K],b=Ud[C],s=Yl();k===qg+g?(b(s,Q[wh[C]]),L(s,Q[wh[K]]),R(s,j),L(s,-Q[wh[K]]),b(s,-Q[wh[C]])):k===qg+K?(b(s,Q[wh[C]]),L(s,j),b(s,-Q[wh[C]])):k===qg+C&&b(s,j);var Y=Ed(q,t);dm(Y,s),M.p3(t[0]+Y[0],t[1]+Y[1],t[2]+Y[2]);var e=M.getRotationMode();Fr(s,M.r3(),e),U.setFromRotationMatrix(s,f(e)),M.r3([U.x,U.y,U.z])}}(),isHostOn:function(m){var A=this;if(A._host&&m&&m._69O)for(var V={},u=A._host;u&&u!==A&&!V[u._id];){if(u===m)return!0;V[u._id]=u,u=u._host}return!1},isLoopedHostOn:function(Y){return this.isHostOn(Y)&&Y.isHostOn(this)},getScaledSize:function(){var H=this.getSize(),Z=this.getScale();return H.width*=Math.abs(Z.x),H.height*=Math.abs(Z.y),H},layout:function(D){if(D=D||this.getHost()){var k=this,X=k.s("layout.h")||"center",Y=k.s("layout.v")||"center";if("center"!==X||"center"!==Y){var C=new B.Math.Vector2,E=D.getPosition(),f=D.getAnchor(),I=D.getScaledSize();k.getPosition();var u,T,n,s,j,Z=1,m=1;switch(k._layoutUpdating=!0,X){case"left":C.setX(k._layoutHValue-f.x*I.width);break;case"right":C.setX((1-f.x)*I.width-k._layoutHValue);break;case"leftright":u=I.width-k._layoutHValue[2],n=k.getRotation()-D.getRotation(),s=Math.abs(Math.sin(n)),j=Math.abs(Math.cos(n)),Z+=j*u/k._layoutHValue[3],m+=s*u/k._layoutHValue[4],C.setX(k._layoutHValue[1]+(k._layoutHValue[5]-f.x)*I.width);break;case"center":C.setX((.5-f.x)*I.width-k._layoutHValue);break;case"scale":n=k.getRotation()-D.getRotation(),s=Math.abs(Math.sin(n)),j=Math.abs(Math.cos(n)),C.setX((.5-f.x)*I.width-k._layoutHValue[1]*I.width/k._layoutHValue[0]),T=I.width/k._layoutHValue[2]-1,Z+=j*T,m+=s*T}switch(Y){case"top":C.setY(k._layoutVValue-f.y*I.height);break;case"bottom":C.setY((1-f.y)*I.height-k._layoutVValue);break;case"topbottom":n||(n=k.getRotation()-D.getRotation(),s=Math.abs(Math.sin(n)),j=Math.abs(Math.cos(n))),u=I.height-k._layoutVValue[2],Z+=s*u/k._layoutVValue[3],m+=j*u/k._layoutVValue[4],C.setY(k._layoutVValue[1]+(k._layoutVValue[5]-f.y)*I.height);break;case"center":C.setY((.5-f.y)*I.height-k._layoutVValue);break;case"scale":n||(n=k.getRotation()-D.getRotation(),s=Math.abs(Math.sin(n)),j=Math.abs(Math.cos(n))),C.setY((.5-f.y)*I.height-k._layoutVValue[1]*I.height/k._layoutVValue[0]),T=I.height/k._layoutVValue[2]-1,Z+=s*T,m+=j*T}if("leftright"===X||"scale"===X||"topbottom"===Y||"scale"===Y){var M=this.getScale(),$=Math.abs(M.x),v=Math.abs(M.y);"leftright"===X||"scale"===X?k.setSize(k._layoutHValue[3]*Z/$,k._layoutHValue[4]*m/v):k.setSize(k._layoutVValue[3]*Z/$,k._layoutVValue[4]*m/v)}C.rotateAround(null,D.getRotation()),this.setPosition(C.x+E.x,C.y+E.y),k._layoutUpdating=H}}},updateLayoutParameters:function(C,L){if(C=C||this.getHost()){var a=this,T=a.s("layout.h"),R=a.s("layout.v");if(T||R){var s,_,i,Z,b,g,H=new B.Math.Vector2,U=C.getPosition(),l=C.getAnchor(),P=C.getScaledSize(),I=a.getPosition(),p=a.getScaledSize();switch(H.set(I.x-U.x,I.y-U.y),H.rotateAround(null,-C.getRotation()),T){case"left":a._layoutHValue=H.x+l.x*P.width;break;case"right":a._layoutHValue=-H.x+(1-l.x)*P.width;break;case"center":a._layoutHValue=-H.x+(.5-l.x)*P.width;break;case"leftright":case"scale":"scale"===T?s=-H.x+(.5-l.x)*P.width:(_=a.getAnchor(),i=a.getRotation()-C.getRotation(),Z=Math.cos(i),b=Math.sin(i),g=-Math.min(-_.x*Z+_.y*b,-_.x*Z-(1-_.y)*b,(1-_.x)*Z+_.y*b,(1-_.x)*Z-(1-_.y)*b),s=H.x-(g-l.x)*P.width),"position"===L&&"object"==typeof a._layoutHValue?(a._layoutHValue[0]=P.width,a._layoutHValue[1]=s):a._layoutHValue=[P.width,s,P.width,p.width,p.height,g]}switch(R){case"top":a._layoutVValue=H.y+l.y*P.height;break;case"bottom":a._layoutVValue=-H.y+(1-l.y)*P.height;break;case"center":a._layoutVValue=-H.y+(.5-l.y)*P.height;break;case"topbottom":case"scale":"scale"===R?s=-H.y+(.5-l.y)*P.height:(i||(_=a.getAnchor(),i=a.getRotation()-C.getRotation(),Z=Math.cos(i),b=Math.sin(i)),g=-Math.min(-_.x*b-_.y*Z,-_.x*b+(1-_.y)*Z,(1-_.x)*b-_.y*Z,(1-_.x)*b+(1-_.y)*Z),s=H.y-(g-l.y)*P.height),"position"===L&&"object"==typeof a._layoutVValue?(a._layoutVValue[0]=P.height,a._layoutVValue[1]=s):a._layoutVValue=[P.height,s,P.height,p.width,p.height,g]}}}},getSerializableProperties:function(){var v=kk.superClass.getSerializableProperties.call(this);
return vl(v,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),v}});var Ji=B.Edge=function(H,I){var R=this;Ep(Ji,R),R.setSource(H),R.setTarget(I)};ni("Edge",uc,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return fg},_22Q:function(){return Ip},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(q){if(q===this)return!1;if(hl(q))return!0;for(var W,J,Y,M,R,y=[this],k=-1,G=0;G>k;)if(k++,W=y[k],J=W._44I)for(J=J.getArray(),M=0,R=J.length;R>M;M++)if(Y=J[M],$k(Y)&&!(y.indexOf(Y)>=0)){if(Y===q)return!1;y.push(Y),G++}return!0},setSource:function(p){var f=this;if(f._source!==p&&f.canSetSourceTarget(p)){var h=f._source;f._source=p,h&&h._16I(f),p&&p._2I(f),f._7I(),f.fp("source",h,p)}},setTarget:function(H){var t=this;if(t._target!==H&&t.canSetSourceTarget(H)){var F=t._target;t._target=H,F&&F._18I(t),H&&H._4I(t),t._7I(),t.fp("target",F,H)}},isLooped:function(){var l=this;return l._source===l._target&&hl(l._source)&&hl(l._target)},onPropertyChanged:function(){var Q=this;Q._49I&&Q._49I.each(function(Z){Z.fp("agentChange",!0,!1)})},_7I:function(){var u,V=this,o=Ni(V);V._40I!==o&&(u=this._40I,u&&u._15I(V),V._40I=o,o&&o._1I(V),V.fp("sourceAgent",u,o),us(u,V._41I),us(o,V._41I));var A=pl(V);V._41I!==A&&(u=V._41I,u&&u._17I(V),V._41I=A,A&&A._3I(V),V.fp("targetAgent",u,A),us(u,V._40I),us(A,V._40I))},_22I:function(R){this._52I=R,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var L=this;return L._52I&&L._52I.get(0)!==L&&!L.getStyle(Ci)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var O=this,E=O._52I;return E&&!O.getStyle(Ci)&&E.size()>1&&O===E.get(0)},toggle:function(){this.beginTransaction();var e=this._52I,y=!this.s(Ci);e&&e.size()>1&&(e.each(function(L){L.s(Ci,y)}),e.getSiblings().each(function(b){b!==e&&b.each(function(d){d.fp("edgeGroup",R,b)})})),this.endTransaction()},setStyle:function(v,d){(v===Kh||"edge.segments"===v)&&(d=xq(d)),Ji.superClass.setStyle.call(this,v,d)},onStyleChanged:function(m){Ji.superClass.onStyleChanged.apply(this,arguments),hs[m]&&us(this._41I,this._40I)},getSerializableProperties:function(){var L=Ji.superClass.getSerializableProperties.call(this);return vl(L,{source:1,target:1}),L}});var cq=B.Group=function(){Ep(cq,this)};ni("Group",kk,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Xp},onChildAdded:function(){cq.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){cq.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var R=this;if(!R._54I&&!Om){var c=R.getChildrenRect();c&&(R._53I=1,R.p(Ph(R.s("group.position"),c,R.getSize())),delete R._53I)}},getChildrenRect:function(){var u,m=this;return m.eachChild(function(Z){hl(Z)&&(u=ri(u,m.getChildRect(Z)))}),u},getChildRect:function(u){var h;return hl(u)&&u.s(lh)&&(Ke(u)&&u.isExpanded()&&u.eachChild(function(k){h=ri(h,u.getChildRect(k))}),!h&&u.getRect&&(h=u.getRect())),h},setPosition:function(B,Y){var m=this;if(!m._54I){var T;T=2===arguments.length?{x:B,y:Y}:B,Om||m._53I||(m._54I=1,gb(m._children,T.x-m._position.x,T.y-m._position.y),delete m._54I),cq.superClass.setPosition.call(this,T)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(_){var Y=this;if(Y._57O!==_){var s=Y._57O;Y._57O=_,Y.fp("expanded",s,Y._57O),Y._fireInvalidateDeep(),Y._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(g){Ke(g)?g._fireInvalidateDeep():g.iv()})},_8I:function(){cq.superClass._8I.call(this),this.eachChild(function(L){hl(L)&&L._8I()})},onStyleChanged:function(w){cq.superClass.onStyleChanged.apply(this,arguments),"group.position"===w&&this._81I()},getSerializableProperties:function(){var C=cq.superClass.getSerializableProperties.call(this);return C.expanded=1,C}});var ak=B.Block=function(){Ep(ak,this)};ni("Block",kk,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return fp},onChildAdded:function(){ak.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){ak.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var e=this;if(!Om&&!e._updatingToChildren&&e._syncSize&&!e._freezeSyncFromChildren){var g,c,J,x,l,F=[],L=e.getRotation(),B=1/0,_=-1/0;if(e.eachChild(function(z){if(hl(z)){F.push.apply(F,z.getCorners());var T=z.getTall()*z.getScaleTall(),y=z.getElevation(),g=z.getAnchorElevation(),d=y+T*(1-g),h=y-T*g;B=k(B,d,h),_=D(_,d,h)}}),F.length){e._updatingFromChildren=1;var E=i(-L),Y=n(-L),y=1/0,G=-1/0,f=1/0,R=-1/0;for(x=0,l=F.length;l>x;x++)J=F[x],g=J.x,c=J.y,J.x=E*g-Y*c,J.y=Y*g+E*c,y=k(y,J.x),G=D(G,J.x),f=k(f,J.y),R=D(R,J.y);var a=e.getScale(),W=e.getScaleTall();e.setSize(q((G-y)/a.x),q((R-f)/a.y)),e.setTall(q((_-B)/W));var o;a.x<0&&(o=y,y=G,G=o),a.y<0&&(o=f,f=R,R=o),E=i(L),Y=n(L);var X=e.getAnchor();g=y+(G-y)*X.x,c=f+(R-f)*X.y,e.setPosition(E*g-Y*c,Y*g+E*c);var s=e.getAnchorElevation();e.setElevation(B+(_-B)*(W>0?s:1-s)),delete e._updatingFromChildren}}},setPosition:function(D,G){var s=this;if(!s._updatingToChildren){var A;A=2===arguments.length?{x:D,y:G}:D,Om||s._updatingFromChildren||(s._updatingToChildren=1,gb(s._children,A.x-s._position.x,A.y-s._position.y),delete s._updatingToChildren),ak.superClass.setPosition.call(this,A)}},setWidth:function(D){return this.setSize(D,this.getHeight())},setHeight:function(l){return this.setSize(this.getWidth(),l)},setSize:function(A,o){1>A&&(A=1),1>o&&(o=1);var l=this;if(!l._updatingToChildren){2!==arguments.length&&(o=A.height,A=A.width);var u=l.getWidth(),D=l.getHeight();if(A!==u&&ak.superClass.setWidth.call(l,A),o!==D&&ak.superClass.setHeight.call(l,o),!Om&&!l._updatingFromChildren){l._updatingToChildren=1;var z=A/u,p=o/D;l._adjustChildScaleOrSize(z,p,"size"),delete l._updatingToChildren,l.updateFromChildren()}}},_adjustChildScaleOrSize:function(Z,R,G){var b=this;if(b._syncSize){var O=b.getPosition(),t=b.getRotation();b.getScale(),b.eachChild(function(x){if(hl(x)){var N=x.getPosition(),r=x.getRotation(),Q=x.getWidth(),p=x.getHeight(),I=x.getScale(),g=I.x*Q,V=I.y*p,P=new Fn(r,N.x,N.y,g,V);P.translate(-O.x,-O.y),P.rotate(-t),r=F(P.b*Math.sign(g),P.a*Math.sign(g)),P.scale(Z,R);var K,L,v,A=i(r);if(Math.abs(A)<.001?(K=n(r),L=P.b/K,v=-P.c/K):(L=P.a/A,v=P.d/A),"scale"===G)x.setScale(L/Q,v/p);else if("size"===G){var C=L/I.x,o=v/I.y;x.setScale(bb(L)*Math.abs(I.x),bb(v)*Math.abs(I.y)),x instanceof B.Shape?(x.setWidthForce(Math.max(Math.abs(C),1e-5)),x.setHeightForce(Math.max(Math.abs(o),1e-5))):x.setSize(Math.max(.01,Math.abs(C)),Math.max(.01,Math.abs(o)))}P.rotate(t),P.translate(O.x,O.y),x.setPosition(P.tx,P.ty)}})}},_calcChangeFactor:function(f,I,Y,h){var B,T,u,W;return B=q(f),T=q(Y),u=B>T?B/T:T/B,B=q(I),T=q(h),W=B>T?B/T:T/B,D(u,W)},setElevation:function(g){var j=this;if(!j._updatingToChildren){var r=j.getElevation(),Q=g-r;0!==Q&&(ak.superClass.setElevation.apply(j,arguments),Om||j._updatingFromChildren||!j._syncSize||(j._updatingToChildren=1,gb(j._children,0,Q,0),delete j._updatingToChildren))}},setTall:function(W){var s=this;if(!s._updatingToChildren){1>W&&(W=1);var $=s.getTall();if(W!==$&&ak.superClass.setTall.call(s,W),!Om&&!s._updatingFromChildren){s._updatingToChildren=1;var v=W/$;s._adjustChildTallOrScale(v,"size"),delete s._updatingToChildren,this.updateFromChildren()}}},setScaleTall:function(y){var c=this;if(!c._updatingToChildren){var h=c.getScaleTall();if(q(y)<.01&&(y=.01*(bb(y)||bb(h))),ak.superClass.setScaleTall.call(c,y),!Om&&!c._updatingFromChildren){c._updatingToChildren=1;var m=y/h;c._adjustChildTallOrScale(m,"size"),delete c._updatingToChildren,this.updateFromChildren()}}},_adjustChildTallOrScale:function(G,g){var p=this;if(p._syncSize){var M=p.getElevation();p.eachChild(function(N){if(hl(N))if("size"===g){var t=N.getTall();0>G&&N.setScaleTall(-1*N.getScaleTall()),N.setTall(Math.max(.01,Math.abs(t*G))),N.setElevation(M+(N.getElevation()-M)*G)}else{var u=N.getScaleTall();N.setScaleTall(u*G)}})}},setAnchor:function(){var T=this;if(!T._updatingToChildren){var o=T.getAnchor();if(ak.superClass.setAnchor.apply(T,arguments),!Om&&!T._updatingFromChildren&&T._syncSize){T._updatingToChildren=1;var O=T.getAnchor();T.getPosition();var $=T.getSize(),H=T.getScale(),V=T.getRotation(),Z=-$.width*H.x*(o.x-O.x),h=-$.height*H.y*(o.y-O.y),d=n(V),E=i(V),_=E*Z-d*h,M=d*Z+E*h;T.eachChild(function(f){if(hl(f)){var H=f.getPosition();f.setPosition(H.x-_,H.y-M)}}),delete T._updatingToChildren}}},setAnchorElevation:function(){var u=this;if(!u._updatingToChildren){var G=u.getAnchorElevation();if(ak.superClass.setAnchorElevation.apply(u,arguments),!Om&&!u._updatingFromChildren&&u._syncSize){u._updatingToChildren=1;var Y=u.getAnchorElevation(),o=u.getTall(),K=u.getScaleTall(),S=-o*K*(G-Y);u.eachChild(function(T){if(hl(T)){var e=T.getElevation();T.setElevation(e-S)}}),delete u._updatingToChildren}}},setRotation:function(q){var t=this;if(!t._updatingToChildren){var Z=t.getRotation();if(ak.superClass.setRotation.apply(t,arguments),!Om&&!t._updatingFromChildren){t._updatingToChildren=1;var z=t.getPosition(),w=q-Z;t.eachChild(function(C){if(hl(C)){var B=C.getMatrix();B.translate(-z.x,-z.y),B.rotate(w),B.translate(z.x,z.y);var l=Math.sign(C.getScale().x);C.setRotation(F(B.b*l,B.a*l)),C.setPosition(B.tx,B.ty)}}),delete t._updatingToChildren}}},setScale:function(j,H){var y=this;if(!y._updatingToChildren){null==H&&(H=j.y,j=j.x);var N=y.getScale();if(q(j)<.01&&(j=.01*(bb(j)||bb(N.x))),q(H)<.01&&(H=.01*(bb(H)||bb(N.y))),ak.superClass.setScale.call(y,j,H),!Om&&!y._updatingFromChildren){y._updatingToChildren=1;var f=j/N.x,C=H/N.y;y._adjustChildScaleOrSize(f,C,"size"),delete y._updatingToChildren,y.updateFromChildren()}}},getSerializableProperties:function(){var e=ak.superClass.getSerializableProperties.call(this);return e.clickThroughEnabled=1,e.syncSize=1,e}});var db=B.Grid=function(){Ep(B.Grid,this)};ni("Grid",kk,{IRotatable:!1,_icon:"grid_icon",_image:R,getUIClass:function(){return tn},setRotation:function(){},getCellRect:function(L,k){var c=this,e=c.s("grid.row.count"),W=c.s("grid.column.count");if(0>=e||0>=W||0>L||L>=e||0>k||k>=W)return R;var x,M,m,o=c.getRect(),i=c.s("grid.row.percents"),O=c.s("grid.column.percents");if(An(o,c,"grid.border",-1),i&&i._as&&(i=i._as),O&&O._as&&(O=O._as),i&&i.length===e){for(m=0,x=0;L>x;x++)m+=o.height*i[x];o.y+=m,o.height=o.height*i[L]}else o.height=o.height/e,o.y+=o.height*L;if(O&&O.length===W){for(M=0,x=0;k>x;x++)M+=o.width*O[x];o.x+=M,o.width=o.width*O[k]}else o.width=o.width/W,o.x+=o.width*k;return Vp(o,-c.s("grid.gap")),o}});var Hk=B.Text=function(){Ep(Hk,this),this.setSize(100,50),this.s("text","TEXT")};ni("Text",kk,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return yb},setWidth:function(c){c||(c=.001),Hk.superClass.setWidth.call(this,c)},setHeight:function(v){v||(v=.001),Hk.superClass.setHeight.call(this,v)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),bc("__text__",{width:{value:100,isSafeFunc:!0,func:function(A){return A?A._width:100}},height:{value:50,isSafeFunc:!0,func:function(i){return i?i._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var Re=B.Shape=function(){Ep(Re,this),this._59O=new Mf};Re.__de__=km,ni("Shape",kk,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return $n},_22Q:function(){return ps},getLength:function(H){return kn(ed(this._59O,this._58O,H,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var W=this._58O;return W?new Mf(W._as.slice(0)):W},setSegments:function(S){var Q=this._58O;S=S?hd(S)?new Mf(S.slice(0)):new Mf(S._as.slice(0)):null,(Q&&S&&Q._as.join(",")!==S._as.join(",")||Q!==S)&&(this._58O=S,this.fp("segments",Q,S))},getPoints:function(){return this._59O},toPoints:function(){var v=this._59O;return new Mf(v._as.slice(0))},getPointsMatrix2d:function(){var Y=this,p=new Wm.Matrix2d,X=Y.getPosition(),$=Y.getScale(),O=Y.getRotation();return p.translate(-X.x,-X.y).scale($.x,$.y).rotate(O).translate(X.x,X.y),p},getPointsMatrix3d:function(){return function(){var P=this,Q=new Wm.Matrix4,A=Q.getElements(),y=P.p3();Ac(A,y),Fr(A,P.getFinalRotation3d(),P.getRotationMode());var r=P.getScale3d(),b=P._dynamicScale3d;return b&&(r[0]*=b[0],r[1]*=b[1],r[2]*=b[2]),Zm(A,r),Ac(A,bk(y)),Q}}(),setPoints:function(p,A){var l=this,m=l._59O;p=p?hd(p)?new Mf(p.slice(0)):new Mf(p._as.slice(0)):new Mf;var _,P,w,z,K,V;A&&(_=l.getPosition(),V=new Fn(l.getRotation(),0,0,l.getScale().x,l.getScale().y)),(m&&p&&m._as.join(",")!==p._as.join(",")||m!==p)&&(l._59O=p,l.fs(),l.fp("points",m,p)),A&&(P=l.getPosition(),w=P.x-_.x,z=P.y-_.y,K=V.tf(w,z),l.setPosition(P.x-w+K.x,P.y-z+K.y))},addPoint:function(s,J,v){var S=this.toPoints();S.add(s,J),this.setPoints(S,v)},setPoint:function(I,z,q){var X=this.toPoints();X.set(I,z),this.setPoints(X,q)},removePointAt:function(I){var _=this.toPoints();_.removeAt(I),this.setPoints(_)},setWidthForce:function(s){var L=this;if(!L._55I&&!Om&&L.getWidth()){L._55I=1;var K=L._position.x,S=s/L.getWidth(),V=L.toPoints(),H=new Mf;1!==S&&(V.each(function(C){H.add({x:(C.x-K)*S+K,y:C.y,e:C.e})}),L.setPoints(H),vd(L,[S,0,0,1,K*(1-S),0]),L.fs()),delete L._55I}Re.superClass.setWidth.call(L,s)},setWidth:function(Q){return this.setWidthForce(1>Q?1:Q)},setHeightForce:function(e){var j=this;if(!j._55I&&!Om&&j.getHeight()){j._55I=1;var $=j._position.y,z=e/j.getHeight(),U=j.toPoints(),d=new Mf;1!==z&&(U.each(function(b){d.add({x:b.x,y:(b.y-$)*z+$,e:b.e})}),j.setPoints(d),vd(j,[1,0,0,z,0,$*(1-z)]),j.fs()),delete j._55I}Re.superClass.setHeight.call(j,e)},setHeight:function(W){return this.setHeightForce(1>W?1:W)},setAnchorElevation:function($){var C=this;C._55I=!0;var J=C._updatingAnchor3d,B=!Om&&!J;if(B){var c,S=$,W=C.getAnchorElevation(),R=C.getTall();c=R*(W-S),0!==c&&C.shiftPointsElevation(c)}var f=Re.superClass.setAnchorElevation.apply(C,arguments);return J||delete C._55I,f},getShapeElevation:function(){var E=this,c=E._54O;return c-(E.getTall()||0)*(E._anchorElevation-.5)},setAnchor3d:function(G,p,r,N){var m,M=this;"number"==typeof G?m={x:G,y:p,z:r}:(m=G.length?{x:G[0],y:G[1],z:G[2]}:G,N=p),M._55I=!0,M._updatingAnchor3d=!0;var Q=M.getDataModel();if(Q&&Q.beginTransaction(),!Om){var D=M.getAnchor3d(),a=M.getSize(),S=M.getTall(),t=a.width*(D.x-m.x),g=a.height*(D.z-m.z),E=S*(D.y-m.y);N||M.shiftPoints(t,g,E);var Z=M.p3()}var q=Re.superClass.setAnchor3d.apply(M,arguments);if(!Om&&N){var x=M.p3();M.shiftPoints(x[0]-Z[0]+t,x[2]-Z[2]+g,x[1]-Z[1]+E)}return Q&&Q.endTransaction(),delete M._updatingAnchor3d,delete M._55I,q},setAnchor:function(F,z,I){var W=this;W._55I=!0;var x=W._updatingAnchor3d,l=!Om&&!x;if(l){var Z,u,b;"number"==typeof F?b={x:F,y:z}:(b=F.length?{x:F[0],y:F[1]}:F,I=z);var k=W.getAnchor(),f=W.getSize();Z=f.width*(k.x-b.x),u=f.height*(k.y-b.y),I||W.shiftPoints(Z,u);var Q=W.getPosition()}var U=Re.superClass.setAnchor.apply(W,arguments);if(l){var B=W.getPosition();I&&W.shiftPoints(B.x-Q.x+Z,B.y-Q.y+u)}return x||delete W._55I,U},shiftPoints:function(r,d,L){if(r||d||L){var y=this,W=y.getElevation()||0,S=y.toPoints(),K=new Mf;S.each(function(B){var F=B.e;L&&(F=(F==R?W:F)+L),K.add({x:B.x+r,y:B.y+d,e:F})}),y.setPoints(K),y.fs()}},shiftPointsElevation:function(H){return this.shiftPoints(0,0,H)},setPosition:function(i,g){var n,f=this;if(!f._28Q){if(f._28Q=1,!f._55I&&!Om){n=2===arguments.length?{x:i,y:g}:i;var L=n.x-f._position.x,Z=n.y-f._position.y;if(0===L&&0===Z)return delete f._28Q,void 0;f._55I=1,f.shiftPoints(L,Z),vd(f,[1,0,0,1,L,Z]),delete f._55I}Re.superClass.setPosition.apply(f,arguments),delete f._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var n=this;if(2!==n._59O.size())return!1;var k=n._58O;return k?2===k.size()&&1===k.get(0)&&2===k.get(1)?!0:!1:!0},fireShapeChange:function(){var O=this;if(!O._55I&&!Om){var U=vo(O._59O);U&&(O._55I=1,O.setRect(U),delete O._55I)}O.fp(Rd,!1,!0)},getSerializableProperties:function(){var z=Re.superClass.getSerializableProperties.call(this);return z.segments=1,z.points=1,z.thickness=1,z.closePath=1,z}});var Ir=B.Polyline=function(){Ep(Ir,this),this.s({"shape.background":null,"shape.border.width":2})};ni("Polyline",Re,{_icon:"polyline_icon",_22Q:function(){return Bk},getUIClass:function(){return tc},setClosePath:function(){},setTall:function(G){var U=this,w=U.getDataModel();if(w&&w.beginTransaction(),!U._55I&&!U._24Q&&!Om&&U.getTall()){U._24Q=1;var N=U._54O,H=G/U.getTall();if(1!==H){var B=U.toPoints(),h=new Mf;B.each(function(m){h.add({x:m.x,y:m.y,e:m.e==R?m.e:(m.e-N)*H+N})}),U.setPoints(h),U.fs()}delete U._24Q}Ir.superClass.setTall.call(U,G),w&&w.endTransaction()},setElevation:function(H){var v=this,k=v.getDataModel();if(k&&k.beginTransaction(),!v._55I&&!v._24Q&&!Om){v._24Q=1;var p=H-v._54O;0!==p&&v.shiftPointsElevation(p),delete v._24Q}Ir.superClass.setElevation.apply(v,arguments),k&&k.endTransaction()},fireShapeChange:function(){var o=this,q=o._59O;if(!o._55I&&!o._24Q&&!Om){var Q=q.size();if(Q){var H=1,K=q.get(0),u=o._54O;K.e==R&&(K.e=u);for(var U=K.e,M=0;Q>H;H++){K=q.get(H),K.e==R&&(K.e=u);var x=k(U,K.e),E=D(U+M,K.e);U=x,M=E-x}o._24Q=1,o.setTall(M),o.setElevation(U+M*o._anchorElevation),delete o._24Q}}Ir.superClass.fireShapeChange.apply(o,arguments)}});var Oq=B.SubGraph=function(){Ep(Oq,this)};ni("SubGraph",kk,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Oq.superClass._8I.call(this),this.eachChild(function(p){hl(p)&&p._8I()})}}),V.loadingRefGraph=0;var Nm=B.RefGraph=function(){Ep(Nm,this)};ni("RefGraph",ak,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(i){var w=this._ref;this._ref=i,this.fp("ref",w,i),this.updateRef()},_21I:function(){Nm.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var y=this;if(V.loadingRefGraph++,y.clearChildrenFromDataModel(),V.loadingRefGraph--,y._ref&&y._dataModel){y._xhrLoadHandler&&(y._xhrLoadHandler.cancel=!0);var h=Om,q=y._xhrLoadHandler=function(G){if(G&&y._dataModel){V.loadingRefGraph++;var q=y._pendingUpdateInfo={needToRestore:h};h&&(q.position=y.p(),q.width=y.getWidth(),q.height=y.getHeight(),q.rotation=y.getRotation(),q.anchor=y.getAnchor(),q.scale=y.getScale()),y.p(0,0),y.setAnchor(.5,.5),y.setRotation(0),y.setScale(1,1);var A=V.parse(G),S=y._dataModel.deserialize(A,y,{justDatas:!0});S.each(function(C){C._refGraph=y}),y.checkPendingUpdateInfo(),V.loadingRefGraph--,V.handleRefGraphLoaded(y,S,A)}};q.xhrLoadCalled=!1,V.load(y._ref,function(U){q.cancel||(q.xhrLoadCalled?q(U):Ue(function(){q(U)}))}),q.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var A=this,M=A._pendingUpdateInfo;if(!M)return A.onPendingUpdated&&(V.loadingRefGraph++,A.onPendingUpdated(),V.loadingRefGraph--),void 0;var S=!0;this.eachChild(function(N){(N._pendingCheckImageJSON||N._pendingUpdateInfo)&&(S=!1)}),S&&(V.loadingRefGraph++,A._pendingUpdateInfo=null,A.updateFromChildren(),M.needToRestore&&(A.setSize(M.width,M.height),A.setAnchor(M.anchor),A.setRotation(M.rotation),A.setScale(M.scale),A.p(M.position)),this.getParent()instanceof Nm&&this.getParent().checkPendingUpdateInfo(),A.onPendingUpdated&&A.onPendingUpdated(),V.loadingRefGraph--)},getSerializableProperties:function(){var I=Nm.superClass.getSerializableProperties.call(this);return I.ref=1,I}}),B.EdgeGroup=function(n,S){this._70O=n,this._siblings=S;for(var B,k,H=0,m=n.size(),b=v[Ci];m>H;H++)if(B=n.get(H).getStyle(Ci,!1),B!=R){b=B;break}b==R&&(b=!0);var x=V.edgeGroupAgentFunc;for(x&&(k=x(n),k&&k!==n.get(0)&&(n.remove(k),n.add(k,0))),H=0;m>H;H++)n.get(H).s(Ci,b)},ni("EdgeGroup",w,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(e){return this._70O.get(e)},indexOf:function(U){return this._70O.indexOf(U)},each:function(y,p){this._70O.each(y,p)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(Q,m){this._siblings.each(function(n){n._70O.each(Q,m)})}});var Gp=function(L,y,N){var g=Yd[L]={type:L,action:y};if(N)for(var D in N)g[D]=N[D]};vl(V,{setConnectAction:Gp,getConnectAction:function(t,d){if(!d){if(!t)return null;d=t.getCurrentConnectActionType()}return Yd[d]},doConnectAction:function(k,L,V,$){$=$||k.getCurrentConnectActionType();var c=Yd[$];if(!c)return!1;var q=c.action;return q?(L instanceof ls.Group?k.sm().getSelection().each(function(s){q.call(null,k,s,V)}):q.call(null,k,L,V),!0):!1},doDeleteConnectionAction:function(D,p,Q){Q=Q||D.getCurrentConnectActionType();var n=Yd[Q];if(!n||!n.delete)return!1;var j=n.delete.action;return j?(p instanceof ls.Group?D.sm().getSelection().each(function(A){j.call(null,D,A)}):j.call(null,D,p),!0):!1}});var Zc=B.JSONSerializer=function(Q,Y){this.dm=this._dataModel=Q,this._hierarchical=V.forceHierarchicalSerialization?!0:Y==R?Q.isHierarchicalRendering():Y};ni("JSONSerializer",w,{ms_ac:["hierarchical"],serialize:function(Y){return V.stringify(this.toJSON(),Y)},toJSON:function(){var x=this,o=x.dm,l=o.getRoots(),R=x.json={v:V.getVersion(),p:{},a:{},d:[]},y=o.getSerializableAttrs();o.getInit()&&(R.init=o.getInit()),o.getName()&&(R.p.name=o.getName()),o.getBackground()&&(R.p.background=o.getBackground()),o.getLayers()&&(R.p.layers=o.getLayers()),o.getEnvmap()&&(R.p.envmap=o.getEnvmap()),R.p.autoAdjustIndex=o.isAutoAdjustIndex(),R.p.hierarchicalRendering=o.isHierarchicalRendering();for(var n in y){var $=o.a(n);$!==H&&x[qf](n,$,R.a)}return bn(R.a)&&delete R.a,x._hierarchical?l.each(x.serializeData,this):o.each(function(O){x.serializeData(O)}),o.fireSerializeEvent({type:"serialize",json:R}),o.getPostProcessingData()&&(R.p.postProcessingData=o.getPostProcessingData()),R},isSerializable:function(){return!0},getProperties:function(m){return m.getSerializableProperties()},getStyles:function(T){return T.getSerializableStyles()},getAttrs:function(O){return O.getSerializableAttrs()},serializeData:function(J){var u=this;if(u.isSerializable(J)&&!J._refGraph){var S,x,I,r,H=fk(J.getClassName())||J.getClass(),F=new H,C={c:J.getClassName(),i:J.getId(),p:{},s:{},a:{}};u.json.d.push(C),S=u.getProperties(J);for(x in S)if(/^_/.test(x)){if(I=J[x],!("_width"!==x&&"_height"!==x||I!=R&&-1!==I)){var K;((J.s("layout.h")||J.s("layout.v"))&&J.getHost()||J instanceof B.Node&&(K=J.getParent())&&K instanceof B.Block||J.s("fullscreen"))&&(I=J[x]="_width"===x?J.getWidth():J.getHeight())}I!==F[x]&&u[qf](x.substr(1),I,C.p)}else r=Kp(x),J[r]&&(I=J[r](),I!==F[r]()&&u[qf](x,I,C.p));S=u.getStyles(J);for(x in S)I=J.s(x),I!==F.s(x)&&u[qf](x,I,C.s);S=u.getAttrs(J);for(x in S)I=J.a(x),I!==F.a(x)&&u[qf](x,I,C.a);bn(C.p)&&delete C.p,bn(C.s)&&delete C.s,bn(C.a)&&delete C.a}u._hierarchical&&J.getChildren().each(u.serializeData,u)},serializeValue:function(c,L,Y){cb(L)?L={__a:L._as}:L instanceof uc&&(L={__i:L.getId()}),Y[c]=L},deserialize:function(i,E,N){var n=this;return Fc(i)&&/.json$/.test(i)?(V.xhrLoad(i,function(j){n.deserializeImpl(j,E,N)}),void 0):n.deserializeImpl(i,E,N)},deserializeImpl:function(E,N,h){var Q=this,U=Q.dm;U.setDeserializing(!0),h=Ll(h)?{setId:h}:xj(h)?{finishFunc:h}:h||{},E=Q.json=Fc(E)?V.parse(E):E,!h.justDatas&&E.a&&E.a.onPreDeserialize&&!h.disableOnPreDeserialize&&E.a.onPreDeserialize(E,U,h.view),U.beginTransaction(),Om++,Q._82I={};var i=new Mf,o=new Mf,L=0,a=E.d.length;if(h.justDatas||(!h.disableInit&&xj(E.init)&&E.init(U),U.setInit(E.init)),!h.justDatas){for(var W in E.a)U.a(W,Q[is](E.a[W]));for(var l in E.p)U[Xr(l)](E.p[l])}for(;a>L;L++){var z=E.d[L],K=fk(z.c),s=new K,P=z.i;h.setId&&P!=R&&(s._id=P),Q._82I[P]=s,i.add(s),o.add(z)}for(L=0;a>L;L++)Q.deserializeData(i.get(L),o.get(L));return i.each(function(A){N&&!A.getParent()&&A.setParent(N),U.add(A)}),h.__innerHandler__&&h.__innerHandler__(E,U,h.view,i),U.fireSerializeEvent({type:"deserialize",json:E}),Om--,U.endTransaction(),!h.justDatas&&E.a&&E.a.onPostDeserialize&&!h.disableOnPostDeserialize&&E.a.onPostDeserialize(E,U,h.view,i),h.finishFunc&&h.finishFunc(E,U,h.view,i),U.setDeserializing(!1),i},deserializeData:function(Z,X){for(var s in X.p)Z[Xr(s)](this[is](X.p[s]));for(s in X.s)Z.s(s,this[is](X.s[s]));for(s in X.a)Z.a(s,this[is](X.a[s]))},deserializeValue:function(m){if(zh(m)){var c=m.__i;if(c!=R)return this._82I[c];if(c=m.__a,hd(c))return new Mf(c)}return m}}),vl(Ah,{serialize:function(i,$){return new Zc(this,$).serialize(i)},toJSON:function(V){return new Zc(this,V).toJSON()},deserialize:function(L,K,D){return new Zc(this).deserialize(L,K,D)}});var Sn=B.OverlappingBox=function(B){this.gv=B,this.boxes={}};ni("OverlappingBox",w,{clear:function(){var V,N,Z=this.boxes;for(V in Z)N=Z[V],N.length=0},isOverlapping:function(R,f){var J,v,S=this,V=S.boxes,b=V[R];b?(J=b.rects,v=b.length):b=V[R]={rects:J=[],length:v=0};var m,z,f;for(m=0;v>m;m++)if(z=J[m],z.x<f.x+f.w&&z.x+z.w>f.x&&z.y<f.y+f.h&&z.h+z.y>f.y)return!0;return J.length<=v?(J.push(f),b.length++):J[b.length++]=f,!1}}),vl(V,{fetch:function(J,l){var R="GET",x=!1,E=null,X="";l&&(R=l.method||"GET",x=l.sync,X=l.url,E=l.data||null),J.open(R,X,!x),l.responseType?J.responseType=l.responseType:l.overrideMimeType&&J.overrideMimeType&&J.overrideMimeType(l.overrideMimeType),J.send(E)},convertImageSrc:function(G,K){K&&"function"==typeof K||(K=function(){}),K(G)}});var ro=B.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};ni("Request",w,{_responseType:null,_overrideMimeType:"text/plain",send:function(g){var R=this._xhr,n=this.onload,U=this.onerror;this.getResponseType()?g.responseType=this.getResponseType():this.getOverrideMimeType()&&(g.overrideMimeType=this.getOverrideMimeType()),R.onload=n,R.onerror=U,V.fetch(R,g)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(Q){this._responseType=Q},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(m){this._overrideMimeType=m},getResponseText:function(){var r=this._xhr;return r.response||r.responseText}}),gq.GraphView=function(K){var N=this;N._24I={},N._34I=new Mf,N._25I={},N._56I={},N._view=wn(1,N),N._canvas=ae(N._view),N.dm(K?K:new Ah),this._coreInteractor=new Cd(this),N.setEditable(!1),N.setScrollBarVisible(V.graphViewScrollBarVisible),N._initView()},wm("GraphView",w,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[mf,Hj,Vd,Hp,"resettable","editInteractor",kp,"zoomable","pannable","rectSelectable","autoScrollZone",Vh,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:V.graphViewZoomable,_resettable:V.graphViewResettable,_pannable:V.graphViewPannable,_rectSelectable:V.graphViewRectSelectable,_autoScrollZone:V.graphViewAutoScrollZone,_rectSelectBackground:V.graphViewRectSelectBackground,_rectSelectBorderColor:V.graphViewRectSelectBorderColor,_editPointSize:V.graphViewEditPointSize,_editPointBorderColor:V.graphViewEditPointBorderColor,_editPointBackground:V.graphViewEditPointBackground,_scrollBarColor:vi,_scrollBarSize:Tf,_autoHideScrollBar:kc,_autoMakeVisible:Mi,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(h){this._dataModel.setLayers(h)},setEditable:function(c){var o=this,x=o.__interactorMap__;if(!x){var y=gq.XEditInteractor;x=o.__interactorMap__={scrollBar:new Gn(o),select:new Jr(o),edit:y?new y(o):new cd(o),text:new Mc(o),move:new Jh(o),"default":new mi(o),touch:new Pi(o,{editable:!1})}}c?(o._uieditable=!0,o.setInteractors([x.scrollBar,x.select,x.edit,x.text,x.move,x.default,x.touch])):(o._uieditable=!1,o.setInteractors([x.scrollBar,x.select,x.move,x.default,x.touch]))},getCanvas:function(){return this._canvas},_33I:function(t){var v=t.getUIClass();return v?new v(this,t):R},getDataUI:function(y){var M=this,k=M._25I[y._id];return k===H&&(k=M._33I(y),M._25I[y._id]=k),k},getNodeRect:function(I){return V.getNodeRect(this,I)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(P){var C=this.getDataUI(P);return C?(C._79o(),C._78o):null},getEdgeSourcePosition:function(J){var W=this,g=W.getDataUI(J),V=g.s,m=g._data._40I;return go(W,m,V("edge.source.position"),V("edge.source.offset.x"),V("edge.source.offset.y"),V("edge.source.anchor.x"),V("edge.source.anchor.y"))},getEdgeTargetPosition:function(U){var v=this,h=v.getDataUI(U),M=h.s,G=h._data._41I;return go(v,G,M("edge.target.position"),M("edge.target.offset.x"),M("edge.target.offset.y"),M("edge.target.anchor.x"),M("edge.target.anchor.y"))},invalidateAll:function(c){var t=this;if(c){for(var H in t._25I){var E=t._25I[H];E&&E.dispose()}t._25I={},t._56I={},t._24I={},t._34I.clear(),t.redraw()}else t.dm().each(function(p){t.invalidateData(p)})},invalidateSelection:function(){var C=this;C.sm().each(function(u){C.invalidateData(u)})},invalidateData:function(Y){var P=this;P._24I[Y._id]=Y,P._21Q(Y),P.iv()},_21Q:function(Z){var l=this,N=l._24I;if($k(Z)&&Bo[Z.s(Po)]){var U=Z.getSourceAgent();U&&U.getAgentEdges().each(function(M){N[M._id]=M}),U=Z.getTargetAgent(),U&&U.getAgentEdges().each(function(l){N[l._id]=l}),l.iv()}},redraw:function(K){var k=this;k._32I||(K?k._34I.add(K):(k._32I=1,k._34I.clear()),k.iv())},each:function(j,s){var Z,b,h,e=0,I=this.getLayers(),E=this._dataModel,D=E._datas._as,X=D.length;if(I){for(var C=I.length;C>e;e++)if(h=I[e],zh(h)&&(h=h.name),E.isHierarchicalRendering()){var M=function(f){return f._layer===h?s?j.call(s,f):j(f):void 0};if(this._dataModel.eachByHierarchical(M)===!1)return}else for(var t=0;X>t;t++)if(Z=D[t],Z._layer===h&&(b=s?j.call(s,Z):j(Z),b===!1))return}else if(E.isHierarchicalRendering())this._dataModel.eachByHierarchical(j,null,s);else for(;X>e;e++)if(Z=D[e],b=s?j.call(s,Z):j(Z),b===!1)return},reverseEach:function(U,O){var i,p,K,E,P=this._dataModel,g=P._layers,d=P._datas._as,j=d.length;if(g){for(i=g.length-1;i>=0;i--)if(E=g[i],zh(E)&&(E=E.name),P.isHierarchicalRendering()){var w=function(j){return j._layer===E?O?U.call(O,j):U(j):void 0};if(P.reverseEachByHierarchical(w)===!1)return}else for(var b=j-1;b>=0;b--)if(p=d[b],p._layer===E&&(K=O?U.call(O,p):U(p),K===!1))return}else if(P.isHierarchicalRendering())P.reverseEachByHierarchical(U,null,O);else for(i=j-1;i>=0;i--)if(p=d[i],K=O?U.call(O,p):U(p),K===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var k=this,e=k._84I;if(!e){var a=this.dm().a("width"),g=this.dm().a("height");a>0&&g>0?k._84I={x:0,y:0,width:a,height:g}:(k.each(function(P){k.isVisible(P)&&(e=ri(e,k.getDataUIBounds(P)))}),k._84I=e?e:kl)}return k._84I},getScrollRect:function(){return ri(this.getContentRect(),this._29I)},makeCenter:function(F,c,C){var _=this;if(!_.getWidth()||!_.getHeight())return C||Ue(_.makeCenter,_,[F,c,!0],500),void 0;_.makeVisible(F),_.validate();var i=_.getDataUIBounds(F);if(i){var $=_.getWidth(),V=_.getHeight(),H=i.x+i.width/2,t=i.y+i.height/2,Y=-H*_._zoom+$/2,p=-t*_._zoom+V/2;_.setTranslate(Y,p,c)}},fitData:function(r,X,G,b,K){var C=this;if(!C.getWidth()||!C.getHeight())return K||Ue(C.fitData,C,[r,X,G,b,!0],500),void 0;var F=function(){C.makeVisible(r),C.validate();var F=C.getDataUIBounds(r);
F&&(F=er(F),Vp(F,G==R?20:G),C.fitRect(F,X,b))};X?V.callWhenLoaded(F):F()},fitContent:function(B,m,W,h){var k=this;if(!k.getWidth()||!k.getHeight())return h||Ue(k.fitContent,k,[B,m,W,!0],500),void 0;var l=function(){k.validate();var Q=er(k.getContentRect());Vp(Q,m==R?20:m),k.fitRect(Q,B,W)};B?V.callWhenLoaded(l):l()},fitRect:function(J,Y,g){var B=this,N=B.getWidth(),d=B.getHeight(),M=J.x+J.width/2,q=J.y+J.height/2,f=k(N/J.width,d/J.height),w=B._zoom,K=-M*w+N/2,F=-q*w+d/2;0===f||isNaN(f)||(g&&(f=k(1,f)),Y?(B._65I&&(delete B._65I.finishFunc,B._65I.stop(!0)),B._14o&&B._14o.stop(!0),B.setTranslate(K,F,{finishFunc:function(){B.setZoom(f,Y)}})):(B.setTranslate(K,F),B.setZoom(f)))},fitSelection:function(i,x,o){var l=this,b=l.sm(),Y=null;b.size()&&(b.each(function(v){var m=l.getDataUIBounds(v);Y=Y?ri(m,Y):m}),i&&Vp(Y,i),l.fitRect(Y,x,o))},toCanvas:function(k,s,p){s=s||this._zoom,this.validateImpl();var g=this,A=g.getContentRect();p&&Vp(A,p),A.width||(A.width=10),A.height||(A.height=10);var N=ae(),n=A.x*s,t=A.y*s,C=Math.ceil(A.width*s),K=Math.ceil(A.height*s);Pb(N,C,K,1);var R=mr(N);return k=k||this._dataModel.getBackground(),k&&gi(R,0,0,C,K,k),tl(R,-n,-t),R.scale(s,s),g._42(R),R.restore(),N},toDataURL:function(p,V,J,S){return this.toCanvas(p,J,S).toDataURL(V||"image/png",1)},getClipBounds:function(){return this._74O},_42:function($,J){var C=this,O=C.dm().getBackground();if(O){var I=C.dm().a("width"),q=C.dm().a("height");I>0&&q>0&&gi($,0,0,I,q,O)}var j=C.__htmlOrderList,X=[];if(C._93db($,J),C.each(function(D){var j=C.getDataUI(D);if(j){var U=C._56I[D._id],p=j._htmlView;if(U){var k=j._79o();if(p=j._htmlView,B.HtmlNode&&D instanceof B.HtmlNode)j._42($);else{var v=C.getViewRect(),M=p&&p.layoutHTML;!J||Dr(J,k)?(M&&(p.layoutHTML(),j.__outerLayout&&delete j.__outerLayout),j._42($)):Dr(v,k)||!M||j.__outerLayout||(p.layoutHTML(),j.__outerLayout=!0)}}p&&(X.push(p),p.getView&&(p=p.getView()),p.style.display=U?"block":Vl)}}),j&&X.length>0){var f=!1;if(j.length!==X.length)f=!0;else for(var _=0;_<X.length;_++)if(X[_]!==j[_]){f=!0;break}f&&(X.forEach(function(o){o.autoAdjustIndex!==!1&&C.appendHTML(o,!0)}),this.__htmlOrderList=X)}else this.__htmlOrderList=X;C._92db($,J)},validateImpl:function(){this.tryUpdateRootData();var B,W,M,c,t,r=this,e=r.tx(),C=r.ty(),A=r._zoom,Q=r._canvas,L=this.getWidth(),E=this.getHeight(),k=r._29I,a={x:-e/A,y:-C/A,width:L/A,height:E/A},F={},g=r._34I,m=r._24I,j=r._32I,w=r._23I;r._24I={},(L!==Q.clientWidth||E!==Q.clientHeight)&&(Pb(Q,L,E),j=1),j||jm(a,k)||(j=1),r._29I=a,r.each(function(p){W=p._id;var y=F[W]=r.isVisible(p);y!==r._56I[W]&&(m[W]=p,M=r.getDataUI(m[W]),M&&M._84o(y),r._84o(p,y))},r);for(W in m)M=r.getDataUI(m[W]),M&&(!j&&r._56I[W]&&(t=M._79o(),t&&g.add(t)),M.invalidate()),r._83I=1;if(r._56I=F,!j)for(W in m)F[W]&&(M=r.getDataUI(m[W]),M&&(t=M._79o(),t&&g.add(t)));if(j?c=a:(g.each(function(U){Dr(a,U)&&(c=ri(c,U))}),c&&(Vp(c,D(1,1/A)),c.x=f(c.x*A)/A,c.y=f(c.y*A)/A,c.width=$(c.width*A)/A,c.height=$(c.height*A)/A,c=Vo(a,c))),r._74O=c,c){B=mr(Q);var P=c.x,G=c.y,n=c.width,Y=c.height;P=Math.floor((P*A+e)*qm),G=Math.floor((G*A+C)*qm),n=Math.ceil(n*A*qm)+1,Y=Math.ceil(Y*A*qm)+1,j||(c.x=(P/qm-e)/A,c.y=(G/qm-C)/A,c.width=n/qm/A,c.height=Y/qm/A),B.beginPath(),B.rect(P,G,n,Y),B.clip(),B.clearRect(P,G,n,Y),Up(B,e,C,A),r._42(B,c),B.restore(),delete r._74O}if(g.clear(),delete r._32I,w&&L>0&&E>0){var M=r.getDataUI(w);if(M){var t=M._79o(),v=r._29I,V=v.x,u=v.y,J=v.width,x=v.height,A=r._zoom;t&&!Dr(t,v)&&(t.x+t.width<V&&r.tx(-t.x*A),t.x>V+J&&r.tx(-(t.x+t.width-J)*A),t.y+t.height<u&&r.ty(-t.y*A),t.y>u+x&&r.ty(-(t.y+t.height-x)*A))}delete r._23I}r._83I&&(delete r._83I,delete r._84I),r._98O(),r.countFrame(),bn(r._24I)||Ue(r.iv,r)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var s,m=this.getFullscreenDatas();for(var o in m)s=m[o],this.scaleRootData(s);this._rootDataUpdating=!1}},scaleRootData:function(u){var V=u.s("fullscreen");if("uniform"===V||"fill"===V){u.getRotation()&&u.setRotation(0);var X=u.s("fullscreen.gap")||0,L=this.getWidth(),$=this.getHeight();if(L&&$){var H,p,Z,q=L-2*X,o=$-2*X,m=u.getAnchor(),U=u.getScaledSize(),P=U.width,A=U.height,Q=u.s("fullscreen.lock");if(Q)return"uniform"===V?q/o>P/A?(H=o/A,P=A*q/o):(H=q/P,A=P*o/q):"v"===Q?(H=o/A,P=q/H,u.getWidth()!==P&&u.setWidth(P)):(H=q/P,A=o/H,u.getHeight()!==A&&u.setHeight(A)),this.setZoom(H),p=X-(u.getX()-m.x*P)*H,Z=X-(u.getY()-m.y*A)*H,p!==this.tx()&&this.tx(p),Z!==this.ty()&&this.ty(Z),void 0;p=this.tx(),Z=this.ty(),H=this._zoom;var t={x:(-p+X)/H,y:(-Z+X)/H,width:q/H,height:o/H};if("uniform"===V){var W=P/A,D=Math.min(t.width,t.height*W),k=D/W;t.x+=.5*(t.width-D),t.y+=.5*(t.height-k),t.width=D,t.height=k}q=t.width/u.getScaleX(),o=t.height/u.getScaleY(),(u.getWidth()!=q||u.getHeight()!==o)&&u.setSize(q,o);var b=t.x+m.x*t.width,x=t.y+m.y*t.height,l=u.getPosition();(b!==l.x||x!==l.y)&&u.setPosition(b,x)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(h){var D=this;h!==D.isScrollBarVisible()&&(h?(ub(D._view,D._79O=Fb()),ub(D._79O,D._27I=Fb()),ub(D._79O,D._28I=Fb())):(hb(D._79O),delete D._79O,delete D._27I,delete D._28I),D.fp("scrollBarVisible",!h,h))},getDebugTip:function(){return""},showScrollBar:function(){var G=this;G._79O&&(G._85I||(_(function(){G._86I()},$m),G.iv()),G._85I=new Date)},_86I:function(){var Z=this;if(Z._85I){var V=new Date,m=V.getTime();m-Z._85I.getTime()>=$m?(delete Z._85I,Z.iv()):_(function(){Z._86I()},$m)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var N=this,r=this._27I,C=this._28I;if(N._79O){if(N._autoHideScrollBar&&!N._85I)return r.style.visibility=df,C.style.visibility=df,void 0;var d=N.getScrollBarColor(),g=N._zoom,A=N.getScrollBarSize(),o=N.getViewRect(),j=N.getScrollRect(),H=o.height*g,Z=j.height*g,$=o.width*g-A-2,J=H*((o.y-j.y)*g/Z),Y=H*(H/Z),x=r.style;Z-.5>H?(tp>Y&&(J=J+Y/2-tp/2,0>J&&(J=0),J+tp>H&&(J=H-tp),Y=tp),nd(r,$,J,A,Y),x.visibility=ch,x.background=d,x.borderRadius=A/2+bg):x.visibility=df;var Q=o.width*g,y=j.width*g,J=o.height*g-A-2,$=Q*((o.x-j.x)*g/y),t=Q*(Q/y),x=C.style;y-.5>Q?(tp>t&&($=$+t/2-tp/2,0>$&&($=0),$+tp>Q&&($=Q-tp),t=tp),nd(C,$,J,t,A),x.visibility=ch,x.background=d,x.borderRadius=A/2+bg):x.visibility=df}},setDataModel:function(r){var h=this,v=h._dataModel,U=h._selectionModel;v!==r&&(v&&(v.ump(h.handleDataModelPropertyChange,h),v.umm(h.handleDataModelChange,h),v.umd(h.handleDataPropertyChange,h),v.removeIndexChangeListener(h._75O,h),v.removeHierarchyChangeListener(h.handleHierarchyChange,h),U||v.sm().ums(h.handleSelectionChange,h)),h._dataModel=r,r.mp(h.handleDataModelPropertyChange,h),r.mm(h.handleDataModelChange,h),r.md(h.handleDataPropertyChange,h),r.addIndexChangeListener(h._75O,h),r.addHierarchyChangeListener(h.handleHierarchyChange,h),U?U._21I(r):r.sm().ms(h.handleSelectionChange,h),h.invalidateAll(!0),h.fp(Un,v,r),h.updateBackground())},getLayersInfo:function(){if(this._layersInfo===H){var Q=this.getLayers();Q?(this._layersInfo={},Q.forEach(function(q){var d=zh(q)?q.name:q;this._layersInfo[d]=q},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(S,c,W){var N,y,U=this,Z=U.getDataUI(S),p=bs(Z),x=ar(c,function(d){return nj(p,100*d)},100,.001),K=nj(p,100*x);if(!W){var r=Bl(Z),G=new zb(K.x,K.y),k=49/(U._zoom*U._zoom);for(N=0,y=r.length;y>N;N++)if(G.distanceToSquared(r[N])<k)return{index:N,point:r[N],distance:Math.sqrt((r[N].x-c.x)*(r[N].x-c.x)+(r[N].y-c.y)*(r[N].y-c.y))}}return{percent:x,point:K,distance:Math.sqrt((K.x-c.x)*(K.x-c.x)+(K.y-c.y)*(K.y-c.y))}},calculateAttachPoint:function(){var q=new zb,h=new zb,r=new zb;return function(Q,g){var e=this.getAttachPoints(Q);if(!e||!e.length)return null;r.set(g.x,g.y);for(var k,G,i,P,X,N=1/0,K=0,m=e.length;m>K;K++)i=e[K],h.x=i.x,h.y=i.y,q.x=i.offsetX||0,q.y=i.offsetY||0,P=go(this,Q,0,q.x,q.y,h.x,h.y),G=r.distanceToSquared(P),N>G&&(k=K,N=G,X=P);N=Math.sqrt(N);var R=this.getAttachStyle(Q);if("close"===R){var T=Q.s("attach.close.threshold")/this._zoom;if(N>T)return null}return{index:k,distance:N,info:e[k],point:X}}}(),getAttachPoints:function(w){var i=w.s("attach.points");if(i)return i;var m=Tn(w._image);return m?ie(m.attachPoints,w,this)||null:void 0},getAttachStyle:function(p){var J=p.s("attach.style");if(J)return J;var t=Tn(p._image);return t?ie(t.attachStyle,p,this)||"close":void 0},updateLayers:function(){this._layersInfo=H,this.invalidateSelection(),this.redraw()},updateBackground:function(){var E=this.dm().a("width"),h=this.dm().a("height");this._canvas.style.background=E>0&&h>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(k){if("background"===k.property){var $=this._canvas.style.background,Y=k.newValue||"";this.updateBackground(),this.fp("canvasBackground",$,Y),this.redraw()}else"a:width"===k.property||"a:height"===k.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===k.property?this.updateLayers():"hierarchicalRendering"===k.property&&this.redraw()},handleDataPropertyChange:function(e){this.dm().isHierarchicalRendering()&&"parent"===e.property&&e.data.hasChildren()&&this.redraw(),this.invalidateData(e.data)},onPropertyChanged:function(T){var y=this,c=T.property;if(y.redraw(),"zoom"===c){var D=y.sm().getSelection();D.size()&&D.each(function(m){m.invalidate()})}else"dataModel"===c&&(y._83I=1);qn[c]?y.showScrollBar():c===kp&&y.onCurrentSubGraphChanged(T)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(s){var d=this,U=s.kind,t=s.data;if(d._83I=1,"add"===U)d.invalidateData(t),$k(t)&&t.getEdgeGroup()&&t.getEdgeGroup().eachSiblingEdge(d.invalidateData,d);else if(U===Zf){d._21Q(t);var u=t._id,$=d._25I[u];if($){if(d._56I[u]){var S=$._79o();S&&d.redraw(S)}$.dispose(),delete d._25I[u],delete d._24I[u],delete d._56I[u]}t===d._currentSubGraph&&d.setCurrentSubGraph(R)}else U===rq&&(d.invalidateAll(!0),d.setCurrentSubGraph(R))},_75O:function(e){this.invalidateData(e.data)},handleHierarchyChange:function(Q){this.dm().isHierarchicalRendering()&&Q.data.hasChildren()&&this.redraw(),this.invalidateData(Q.data)},adjustIndex:function(k){var U=this;if(U.isVisible(k)){U.dm().beginTransaction();for(var r=k;r._parent&&U.isVisible(r._parent);)r=r._parent;r&&r!==k&&U._dataModel.adjustIndex(r),U._dataModel.adjustIndex(k),U.dm().endTransaction()}},getImage:function(j){return j.getImage?j.getImage():H},getSelectWidth:function(K){var u=Tn(this.getImage(K));return u&&ie(u.disableSelectedBorder,K,this)?0:K.s("select.width")},getSelectColor:function(y){return y.s("select.color")},isSelectable:function(o,$){if(this.isSelected(o))return!0;if(!$&&o.getParent()instanceof ak&&this.isSelectable(o.getParent(),!0)&&o.getParent().isSyncSize())return!1;var x=this.getLayersInfo();if(x){var I=x[o._layer];if(I&&I.selectable===!1)return!1}return o.s("2d.selectable")&&this.sm().isSelectable(o)},isMovable:function(a){var D=this;if($k(a)&&a.getStyle(Po)!==_b)return!1;var t=this.getLayersInfo();if(t){var h=t[a._layer];if(h&&h.movable===!1)return!1}return a.s("2d.movable")?D._movableFunc?D._movableFunc(a):!0:!1},isEditable:function(h){var t=this;if(B._uiSerializing)return t._uieditable;if(!t._editInteractor||!t.isSelected(h))return!1;if(Ke(h)){var E=t.getDataUI(h);if(!E||E._88I)return!1}if($k(h)&&h.getStyle(Po)!==_b)return!1;var p=this.getLayersInfo();if(p){var F=p[h._layer];if(F&&F.editable===!1)return!1}return h.s("2d.editable")?t._editableFunc?t._editableFunc(h):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(U){return hl(U)&&0!==U.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(U):!0},isRectEditable:function(e){return this._rectEditableFunc?this._rectEditableFunc(e):!0},isAnchorEditable:function(T){return this._anchorEditableFunc?this._anchorEditableFunc(T):!0},isRotationEditable:function(s){return s.setRotation&&s.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(s):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(K){var L=K.getAnchor(),$=K.getScale(),o=this._zoom,y=ir(K.getRotation(),0,-K.getHeight()*$.y*L.y-($.y<0?-1:1)*(Kq?32:16)/o),k=K.p();return y.x+=k.x,y.y+=k.y,y},getLogicalPoint:function(W){var y=this;return Pd(W,y._canvas,y.tx(),y.ty(),y._zoom,y._zoom)},getScreenPoint:function(D,E){var N,g=this;return"object"==typeof D?D.x!==H?(N=D.x,E=D.y):(N=D[0],E=D[1]):N=D,yc(N,E,g._canvas,g.tx(),g.ty(),g._zoom,g._zoom)},getSelectedDataAt:function(h){var B=this;return this.getDataAt(h,function(r){return B.isSelected(r)})},getDataInfoAt:function(b,S,U){var $,C=this.lp(b),g=this.getDataAt(C,S,U);if(g){var L=this.getDataUI(g);$={data:g,ui:L,point:C};var p=L._38o;if(p){var c=p.icons;for(var u in c){var k=c[u],T=p.rects[u];if(T)for(var E=ie(k.names,g,this),f=E?E.length:0,D=T.rotation,o=f-1;o>=0;o--){var z=E[o],n=T[o];if(Sm(n,C,D))return $.part="icons",$.name=u,$.icon=z,$.rect=n,$.index=o,$.rotation=D,$}}}if(this.isNoteVisible(g)){if(L.note2Info&&Sm(L.note2Info.clickRect,C,R,L.note2Info.scale))return $.part="note2",$;if(L.noteInfo&&Sm(L.noteInfo.clickRect,C,R,L.noteInfo.scale))return $.part="note",$}if(this.isLabelVisible(g)){if(L.label2Info&&Sm(L.label2Info.rect,C,L.label2Info.rotation,L.label2Info.scale))return $.part="label2",$;if(L.labelInfo&&Sm(L.labelInfo.rect,C,L.labelInfo.rotation,L.labelInfo.scale))return $.part="label",$}if(g.isInRect&&g.isInRect(C))return $.part="body",$}return $},getDataAt:function(Y,$,V){Y.target&&(Y=this.lp(Y));var R,u=this._zoom;return this.reverseEach(function(N){return($?$(N):this.isSelectable(N))&&this.rectIntersects(N,ik(Y.x,Y.y,V,u))?(R=N,!1):void 0},this),R},getIconInfoAt:function(i,z){var m=this;if(i.target&&(i=m.lp(i)),z||(z=m.getDataAt(i)),z){var p=m.getDataUI(z);if(p&&p._38o){var x,I=p._38o,n=new Mf;for(x in I.icons)n.add(x);for(var G=n.size()-1;G>=0;G--){x=n.get(G);for(var X=I.rects[x],A=X.rotation,S=X.length-1;S>=0;S--){var h=X[S],r=h.width,N=h.height,j={x:i.x-h.x-r/2,y:i.y-h.y-N/2};A!=R&&(j=ir(-A,j.x,j.y));var h={x:-r/2,y:-N/2,width:r,height:N};if(Sm(h,j))return{key:x,index:S,name:I.icons[x].names[S],rect:X[S],point:i,rotation:A,relativeRect:h,relativePoint:j,data:z}}}}}return R},getDatasInRect:function(b,Q,$){$===H&&($=1);var R=this,q=new Mf;return R.reverseEach(function(Z){$&&!R.isSelectable(Z)||(Q?R.rectIntersects(Z,b):R.rectContains(Z,b))&&q.add(Z)}),q},moveSelection:function(s,m){var p=this;p.dm().beginTransaction(),gb(p.sm().toSelection(p.isMovable,p),s,m),p.dm().endTransaction()},moveDatas:function(c,L,n){var X=this;X.dm().beginTransaction(),c instanceof Mf||(c=new Mf(c)),gb(c,L,n),X.dm().endTransaction()},getDataUIBounds:function(P){var C=this.getDataUI(P);return C?C._79o():R},drawData:function(W,V,M){var D=this.getDataUI(V);if(D){var l=D._79o();(!M||Dr(M,l))&&(D._42(W),V instanceof B.Block&&V.eachChild(function(S){this.drawData(W,S,M)},this))}},getBoundsForGroup:function(M){return M.s(lh)?this.getDataUIBounds(M):R},isPixelPerfect:function(W){return W.s("pixelPerfect")},rectIntersects:function(A,x){this.validate();var D=R;if(this._56I[A._id]){var l=this._25I[A._id];if(l){var g=l._79o();if(Cr(x,g))D=!0;else if((x=Vo(x,g))&&(l.rectIntersects&&(D=l.rectIntersects(x)),D==R)){if(!this.isPixelPerfect(A))return!0;var s=x.x,Q=x.y,r=x.width,X=x.height,w=this._zoom,y=V.hitMaxArea,e=r*X*w*w;if(e>y){var o=Math.sqrt(y/e);w*=o}r*=w,X*=w,2>r&&(r=2),2>X&&(X=2),s*=w,Q*=w;var U=Vk(r,X);tl(U,-s,-Q),U.scale(w,w),this._drawForChecking=!0,this.drawData(U,A,x),this._drawForChecking=!1;try{for(var d=0,I=U.getImageData(0,0,r,X).data;d<I.length;d+=4)if(0!==I[d+3]){D=!0;break}U.restore()}catch(i){Jg=R,D=!1}}}}return D?!0:!1},rectContains:function(h,W){if(this._56I[h._id]){var l=this._25I[h._id];if(l)return Cr(W,l._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(t){if(!V.isInput(t.target)){var G=this,q=G._focusData,g=q&&G._25I[q._id],i=0,l=G._dataModel._datas;if(!(q&&q._enabled&&q._editable&&g&&g.onKeyDown&&g.onKeyDown(t)===!0))if(9===t.keyCode&&(q&&(i=l.indexOf(q),Vf(t)?-1===--i&&(i=0):++i===l.size()&&(i=0)),G._focusData=q=l.get(i),G.sm().setSelection(q)),rd(t)?G.selectAll():aj(t)&&G.isResettable()&&G.reset(),G.sm().isEmpty()){if(G._editing)return;var u=G.tx(),d=G.ty(),x=!1,A=Vf()?100:10;Pn(t)&&(u-=A,x=!0),Mg(t)&&(d-=A,x=!0),zn(t)&&(u+=A,x=!0),Xd(t)&&(d+=A,x=!0),x&&G.setTranslate(u,d)}else{am(t)&&G.handleDelete(t);var L=Vf()?10:1;Pn(t)&&(G.moveSelection(-L,0),G.fi({kind:"moveLeft"})),Mg(t)&&(G.moveSelection(0,-L),G.fi({kind:"moveUp"})),zn(t)&&(G.moveSelection(L,0),G.fi({kind:"moveRight"})),Xd(t)&&(G.moveSelection(0,L),G.fi({kind:"moveDown"}))}}},handleScroll:function(g,f){if(dj(g),this.isZoomable()){if(!this.getEditInteractor()){var H=this.getDataAt(g);if(H){var L=Tn(this.getImage(H));if(L&&ie(L.scrollable,H,this))return}}var R=this.lp(g);f>0?this.scrollZoomIn(R):0>f&&this.scrollZoomOut(R)}},handlePinch:function(w,G,c){this.isZoomable()&&(G>c?this.pinchZoomIn(w):this.pinchZoomOut(w))},checkDoubleClickOnNote:function(T,o){var r=this,g=r.lp(T),h=r.getDataUI(o),$=h.note2Info;return $&&o.s("note2.toggleable")&&Sm($.clickRect,g)?(o.s(Xn,!o.s(Xn)),r.fi({kind:"toggleNote2",event:T,data:o}),!0):($=h.noteInfo,$&&o.s("note.toggleable")&&Sm($.clickRect,g)?(o.s(js,!o.s(js)),r.fi({kind:"toggleNote",event:T,data:o}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(K,d){var E=this,W=E.getAutoScrollZone(),n=W/E.getZoom(),q=W/4,R=E._29I,I=E.lp(K),G={x:E.tx(),y:E.ty()};return I&&W>0&&R&&(I.x-R.x<n?E.translate(q,0):R.x+R.width-I.x<n&&E.translate(-q,0),I.y-R.y<n?E.translate(0,q):R.y+R.height-I.y<n&&E.translate(0,-q)),G.x=E.tx()-G.x,G.y=E.ty()-G.y,d&&(d.x+=G.x,d.y+=G.y),G},getMoveMode:function(Y,d){var T=d.s("2d.move.mode");return T?T:Rr["88"]?"x":Rr["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(F,m,t){var A=this;return"currentSubGraph"===m?{__i:F.getId()}:t.serializeProperty(F,m,A)},deserializeProperty:function(c,G,h){var Q=this;if("currentSubGraph"===G){var o=Q.dm(),y=o.__idMap;return y[c.__i]}return h.deserializeProperty(c,G,Q)},setDefaultCursor:function(N,l){this._defaultCursor=N,l!==!1&&this.setCursor(N)},setCursor:function(o){"default"===o&&(o=this._defaultCursor||o);var U=this.getView().style;U.cursor=o,U.cursor="-webkit-"+o,U.cursor="-moz-"+o},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(C){return C===R||V.getConnectAction(null,C)?(this._currentActionType=C,this.redraw(),!0):!1},getEditStyle:function(y){var M=this.getEditInteractor();return M?M.getStyle(y):H},setEditStyle:function(f,u,h){var U=this.getEditInteractor();return U?(U.setStyle(f,u,h),!0):!1},isConnectActionVisible:function(D){var g=V.getConnectAction(this);if(!g)return!1;var l=g.visible;return xj(l)&&(l=l(this,D)),l},isInteractive:function(C){if(this._drawForChecking)return!1;var V=Tn(this.getImage(C));return V&&ie(V.interactive,C,this)?!0:C.s("interactive")},appendHTML:function(H,u){var g=this.getView();if(!(u||H&&H.parentNode!==g))return!1;var b=H.getView&&H.getView();if(!u&&b&&b.parentNode===g)return!1;(H.getView||H.isSelfViewEvent)&&(H=H.getView());var v=this.getEditInteractor();return v&&v._canvas?g.insertBefore(H,v._canvas):this.isScrollBarVisible()?g.insertBefore(H,this.getView().lastChild):ub(g,H),!0},_layoutHTMLImpl:function(F,S,q){if(arguments.length>1){var b,R=this,N=R._zoom;if(S.getView&&(b=S,S=S.getView()),S.style.position="absolute",q){var k=F.getRect();nd(b||S,R.tx()+k.x*N,R.ty()+k.y*N,k.width*N,k.height*N)}else{var x=new Rl,k=F.getAnchorRect(),h=F.getPosition(),d=F.getScale(),C=S.style;nd(b||S,k),x.appendTranslate(R.tx(),R.ty()),x.appendScale(N,N),x.append(new Rl(F.getRotation(),h.x,h.y,d.x,d.y)),Qn(C,"transform","matrix("+x.a.toFixed(5)+", "+x.b.toFixed(5)+", "+x.c.toFixed(5)+",\n    "+x.d.toFixed(5)+", "+x.tx.toFixed(5)+", "+x.ty.toFixed(5)+")"),Qn(C,"transformOrigin",(-k.x).toFixed(5)+"px "+(-k.y).toFixed(5)+"px"),S.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(W){return W instanceof Hk?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(l){var e="state",g=l.s(e);if(g)return g;var R=Tn(l._image);return R?ie(R[e],l,this)||null:void 0},getShape:function($){return $.getStyle(Rd)}}),w.defineProperties(gq.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(u){this._layoutHTML=u}}});var Lj=function(W,P){var L=this;L.gv=W,L.s=function(q){return P.getStyle(q)},L._data=P,L._87I=new Mf};uj(Lj,w,{_6I:R,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var j=this,F=j.gv.isSelected(j._data);return!F||j.isShadowed()?0:j.gv.getSelectWidth(j._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function($){var r=this._data,v=this.gv.getBodyColor(r);return v?v:$?r.getStyle($):R},_2Q:function(U){return this.s(U)},_1Q:function(U,d,a,I){var X=this.s,c=X("2d.gray"),h=X(d+".dash.color");if(c&&(h=V.toGrayColor(h)),U.strokeStyle=h,U.lineWidth=a,U.stroke(),X(d+".dash.3d")){var i=X(d+".dash.3d.color");Eh(U,h,c?V.toGrayColor(i):i,a,this.gv._zoom,X(d+".dash.3d.accuracy"))}qp(U,I)},invalidate:function(){this._6I=R},_79o:function(){var D=this;if(!D._6I){var L=D._data,f=D.gv;D.labelInfo=D.label2Info=D.noteInfo=D.note2Info=D._38o=R,D._87I.clear(),D.interactiveInfo=f.isInteractive(L)?{}:R,D._3O(),D._55O=f.isEditable(L)?{_42O:f.isRectEditable(L),_43O:f.isPointEditable(L),_56O:f.isRotationEditable(L)}:R,D._6I=D._81o()}return D._6I},_3O:function(){},getPosition:function(){return kl},_68o:function(D,I){D&&this._87I.add(lj(D,I))},_81o:function(){var P=this,i=P.s;P._24O(yl,"getLabel"),P._24O(Xf,"getLabel2"),P._26O(si,"getNote"),P._26O(ag,"getNote2"),P._15O(),P._55O&&P._48O();var k;if(P._87I.each(function(u){k=ri(k,u)}),k&&P.isShadowed()){var K=er(k);K.x+=i("shadow.offset.x"),K.y+=i("shadow.offset.y"),Vp(K,i("shadow.blur")),k=ri(k,K)}return P._87I.clear(),k},_42:function(i){var $=this,G=$._data,m=$.gv,D=$.s,o=D("opacity"),L=this.isShadowed();if(L){var F=i.shadowOffsetX,f=i.shadowOffsetY,B=i.shadowBlur,Y=i.shadowColor,d=m.getZoom();i.shadowOffsetX=D("shadow.offset.x")*d,i.shadowOffsetY=D("shadow.offset.y")*d,i.shadowBlur=D("shadow.blur")*d,i.shadowColor=$.getSelectColor()}if(o!=R){var p=i.globalAlpha;i.globalAlpha=o}$._80o(i),m.isLabelVisible(G)&&((!m._drawForChecking||D("label.selectable"))&&Vr(i,$.labelInfo),(!m._drawForChecking||D("label2.selectable"))&&Vr(i,$.label2Info)),m.isNoteVisible(G)&&(lp(i,$.noteInfo),lp(i,$.note2Info)),$._99O(i),o!=R&&(i.globalAlpha=p),L&&(i.shadowOffsetX=F,i.shadowOffsetY=f,i.shadowBlur=B,i.shadowColor=Y)},_80o:function(){},_47O:function(){},_24O:function(g,A){var J=this,_=J._data,s=J.gv,n=J.s,u=s[A](_);if(u!=R){var S=n(g+".scale"),F=n(g+".max"),i=n(g+".position"),V=J[g+"Info"]={label:u,scale:S,color:s[A+"Color"](_),font:n(g+".font"),opacity:n(g+".opacity"),align:n(g+".align"),rotation:J.getRotation(n(g+".rotation"),!1,i),background:s[A+"Background"](_)},b=ol(V,u);F>0&&F<b.width&&(V.labelWidth=b.width,b.width=F),1!==S&&(b.width*=S,b.height*=S);var q=J.getPosition(i,n(g+".offset.x"),n(g+".offset.y"),b,n(g+".position.fixed"));if(b.x=q.x-b.width/2,b.y=q.y-b.height/2,J._68o(V.rect=b,V.rotation),1!==S){var w=b.width/S,X=b.height/S;V.rect={x:q.x-w/2,y:q.y-X/2,width:w,height:X}}}},_26O:function(c,b){var h=this,j=h.gv,N=h._data,o=h.s,D=j[b](N);if(D!=R){var m,C,F=o(c+".scale"),A=h[c+"Info"]={note:D,scale:F,data:N,view:j,expanded:o(c+".expanded"),font:o(c+".font"),color:o(c+".color"),opacity:o(c+".opacity"),align:o(c+".align"),icon:o(c+".icon"),backgroundImage:o(c+".backgroundImage"),borderWidth:o(c+".border.width"),borderColor:o(c+".border.color"),background:j[b+"Background"](N)},H=h.getPosition(o(c+".position"),o(c+".offset.x"),o(c+".offset.y")),_=H.x,a=H.y;if(A.expanded){var W,S=o(c+".max"),M=o(c+".backgroundImage");M?(M=Tn(M),W={width:gs(M,N),height:rr(M,N)}):W=ol(A,D),W.width+=6,W.height+=2,S>0&&S<W.width&&(A.labelWidth=W.width,W.width=S),m=W.width,C=W.height+8,A.clickRect={x:_-m*F/2,y:a-C*F,width:m*F,height:C*F*W.height/C}}else{var E=o(c+".icon");E?(E=Tn(E),m=gs(E,N),C=rr(E,N)):(m=12,C=18),A.clickRect={x:_-m*F/2,y:a-C*F,width:m*F,height:C*F}}A.rect={x:_-m/2,y:a-C*F/2-C/2,width:m,height:C};var B=$(A.borderWidth/2)*F;h._68o({x:_-m*F/2-B,y:a-C*F-B,width:m*F+2*B,height:C*F+2*B})}},_48O:function(){},_99O:function(p){var P=this,Z=P._38o;if(Z){var s=P.gv,K=P._data,i=Z.icons,$=P.interactiveInfo;$&&($._38o={});for(var u in i){var g=i[u],U=Z.rects[u];if(U){$&&($._38o[u]=[]);var z=ie(g.opacity,K,s),e=ie(g.names,K,s),J=e?e.length:0,y=U.rotation;if(z!=R){var o=p.globalAlpha;p.globalAlpha*=z}for(var h=0;J>h;h++){var L=e[h],C=Tn(L),t=U[h];if(y){var c=t.x+t.width/2,H=t.y+t.height/2;p.save(),tl(p,c,H),pb(p,y),tl(p,-c,-H)}$&&$._38o[u].push(p.interactiveInfo={compInfos:[],matrix:y?new Rl(y,c,H).appendTranslate(-c,-H):new Rl}),Lf(p,C,ie(g.stretch,K,s),t.x,t.y,t.width,t.height,P._data,P.gv),p.interactiveInfo=R,y&&p.restore()}z!=R&&(p.globalAlpha=o)}}}}});var Oh=function(X,P){Ep(Oh,this,[X,P])};uj(Oh,Lj,{_checkEmptyRect:!0,_40O:function(U,T){var x=this,I=x.s,g=U.rect;(U.borderColor=x.gv.getBorderColor(x._data))&&(U.borderType=I("border.type"),U.borderWidth=I("border.width"),U.borderPadding=I("border.padding"),T=D(T,U.borderPadding+U.borderWidth/2));var N=x._data.getScale(),p=D(1,D(q(N.x),q(N.y)));if(U.selectWidth=x.getSelectWidth()){var H=x.gv._zoom;U.selectType=I("select.type"),U._97o=x.getSelectColor(),U.selectPadding=I("select.padding"),T=D(T,(U.selectPadding+U.selectWidth/2/H)/p)}T>0&&(T*=p,g=er(g),Vp(g,T)),x._68o(g)},_39O:function(s,d){var u,D=this,y=d.rect;if(d.borderWidth>0&&(u=d.borderPadding,s.strokeStyle=d.borderColor,s.lineWidth=d.borderWidth,Rk(s,d.borderType,{x:y.x-u,y:y.y-u,width:y.width+2*u,height:y.height+2*u}),s.stroke()),d.selectWidth>0){var Q=D.gv._zoom;if(u=d.selectPadding,s.strokeStyle=d._97o,s.lineWidth=d.selectWidth/Q,d.rotation!=R){s.save(),s.translate(d.position.x,d.position.y),s.rotate(d.rotation);var j=D._data,G=j.getWidth(),f=j.getHeight(),L=d.scale,a=d.anchor;y={x:L.x*-G*a.x,y:L.y*-f*a.y,width:L.x*G,height:L.y*f}}Rk(s,d.selectType,{x:y.x-u,y:y.y-u,width:y.width+2*u,height:y.height+2*u}),d.rotation!=R&&s.restore(),s.stroke()}},dispose:function(){var s=this,K=s._htmlView;Oh.superClass._3O.call(s),K&&(K.onHTMLRemoved&&K.onHTMLRemoved(),hb(K))},_3O:function(){var J=this,O=J.s,n=J._data,U=J.gv,H=U.getShape(n),X=J.getBodyColor(),x=J._83o=H?{shape:H,_53o:J.getBodyColor("shape.background"),_27Q:Tn(O("shape.repeat.image"),X),shapeGradientPack:O("shape.gradient.pack"),_54o:O("shape.border.width"),_55o:O("shape.border.color"),_56o:O("shape.border.3d"),_57o:O("shape.border.3d.color"),_58o:O("shape.border.3d.accuracy"),shapeGradient:O("shape.gradient"),_59o:O("shape.gradient.color"),_60o:O("shape.border.pattern"),_61o:O("shape.border.cap"),_62o:O("shape.border.join"),shapeForeground:O("shape.foreground"),bodyColor:X,gray:O("2d.gray")}:{img:Tn(U.getImage(n),X),bodyColor:X,gray:O("2d.gray"),stretch:O("image.stretch")};if(c&&!S);else{var C,a=x.img;a&&a.renderHTML?(J._htmlInfo&&J._htmlInfo.img!==a&&(J._htmlInfo=R),J._htmlInfo||(J._htmlInfo={img:a,cache:{}}),C=a.renderHTML(n,U,J._htmlInfo.cache)):J._htmlInfo=R,J._htmlView&&J._htmlView!==C&&(J._htmlView.onHTMLRemoved&&J._htmlView.onHTMLRemoved(),hb(J._htmlView.getView?J._htmlView.getView():J._htmlView)),(J._htmlView=C)&&U.appendHTML(C)&&(C.onHTMLAddedSync&&C.onHTMLAddedSync(),C.onHTMLAdded&&Ue(C.onHTMLAdded)),x.rect=n.getRect(),x.position=n.p(),x.scale=n.getScale(),x.anchor=n.getAnchor(),x.rotation=n.getRotation(),H===xc&&(x._63o=O("shape.depth"));var N=0;if(H)N=al(R,x._54o/2,x._62o),J.s("shape.dash")&&(N=D(N,(J.s("shape.dash.width")||x._54o)/2));else if(a&&a.boundExtend)if(N=ie(a.boundExtend,n,U),a.boundExtendAbsolute){var L=n.getScale();N/=U._zoom*D(1,D(q(L.x),q(L.y)))}else if(!ie(a.fitSize,n,U)){var I=ie(a.width,n,U),p=ie(a.height,n,U);N*=D(n.getWidth()/I,n.getHeight()/p)}J._40O(x,N);var Z=O("clip.percentage");if(1>Z&&(0>Z&&(Z=0),x.clipRect=nc(n.getAnchorRect(),O("clip.direction"),Z)),H){var B=O("shape.fill.clip.percentage");1>B&&(0>B&&(B=0),x.shapeClipRect=nc(n.getAnchorRect(),O("shape.fill.clip.direction"),B));var m=O("shape.foreground.clip.percentage");1>m&&(0>m&&(m=0),x.shapeForegroundClipRect=nc(n.getAnchorRect(),O("shape.foreground.clip.direction"),m))}}},getPosition:function(x,U,s,i){var X=Ph(x,this._83o.rect,i);return X.x+=U,X.y+=s,X},_80o:function(j){var N=this,E=N.s,H=N.gv,W=N._data,U=N._83o,K=U.rect,_=U.position,O=U.rotation,B=U.anchor,r=U.scale,f=U.shape,w=U.clipRect;if(!N._checkEmptyRect||K.width>0&&K.height>0){var b=W.getSize();if(b.x=-b.width*B.x,b.y=-b.height*B.y,j.save(),tl(j,_.x,_.y),pb(j,O),Bj(j,r.x,r.y),w&&(j.beginPath(),j.rect(w.x,w.y,w.width,w.height),j.clip()),H._drawForChecking&&U.img&&ie(U.img.pixelPerfect,W,H)===!1)gi(j,b.x,b.y,b.width,b.height,"#888888");else if(N.freeDraw)N.freeDraw(j,b,U);else if(f){var n,P,d,k,g=U._60o,i=ei(j,g),e=U._27Q,v=U._54o,G=U.shapeGradientPack,J=U.gray,I=j.lineJoin,X=j.lineCap,D=function(i){return J?V.toGrayColor(i):i};"roundRect"===f?n=E("shape.corner.radius"):"polygon"===f?n=E("shape.polygon.side"):"arc"===f&&(n=E("shape.arc.from"),P=E("shape.arc.to"),d=E("shape.arc.close"),k=E("shape.arc.oval")),j.lineJoin=U._62o,j.lineCap=U._61o;var u=D(U._53o);if(u||e||G){var T=U.shapeClipRect;T&&(j.save(),j.beginPath(),j.rect(T.x,T.y,T.width,T.height),j.clip()),Rk(j,f,b,n,P,d,k),G?op(j,G):e?Dg(j,e,D(U.bodyColor),null,W,H):rs(j,u,U.shapeGradient,D(U._59o),b),j.fill(),T&&j.restore(),G&&j.restore(),j!==i&&Rk(i,f,b,n,P,d,k)}else Rk(i,f,b,n,P,d,k);var Q=U.shapeForeground;if(Q){j.save();var S=U.shapeForegroundClipRect;S&&(j.beginPath(),j.rect(S.x,S.y,S.width,S.height),j.clip()),Rk(j,f,b,n,P,d,k),rs(j,Q,E("shape.foreground.gradient"),D(E("shape.foreground.gradient.color")),b),j.fill(),j.restore()}if(v>0){var h=E("shape.border.width.absolute");h&&(j.save(),j.setTransform(1,0,0,1,0,0)),j.lineWidth=v;var A=D(U._55o);j.strokeStyle=A,j.stroke(),h&&j.restore(),U._56o&&Eh(j,A,D(U._57o),v,H._zoom,U._58o)}if(qp(j,g),E("shape.dash")){var x=E("shape.dash.width")||v;if(x>0){g=E("shape.dash.pattern");var i=ei(j,g,N._2Q("shape.dash.offset"));i!==j&&Rk(i,f,b,n,P,d,k),N._1Q(j,"shape",x,g)}}$o(j,u,U._63o,b),j.lineJoin=I,j.lineCap=X}else{var c=N.interactiveInfo;c&&(j.interactiveInfo=c.bodyInfo={compInfos:[],matrix:new Rl(O,_.x,_.y,r.x,r.y)}),U.gray&&(j.compGray=!0);var q=U.img;q&&q.cacheRule!=R&&(q=ig(j,q,U.stretch,b.width,b.height,W,H,U.bodyColor)),Lf(j,q,U.stretch,b.x,b.y,b.width,b.height,W,H,U.bodyColor),j.compGray=!1,j.interactiveInfo=R}j.restore()}N._39O(j,U)},_48O:function(){},_47O:function(){}});var fg=function(a,E){Ep(fg,this,[a,E])},ah=function(Q,u,m,e){var b=Wj(Q,u);return m=e?k(m,b):Uk(m,b),b?m/=b:m=0,{x:Q.x+(u.x-Q.x)*m,y:Q.y+(u.y-Q.y)*m}};uj(fg,Lj,{_3O:function(){var X,W=this,x=W._data,E=W.gv,q=W.s,a=q(Po),S=x.isLooped(),i=q("edge.width"),y=q("edge.center"),$=q("edge.offset"),Y=E.getBorderColor(x),v=Y?q("border.width"):0,P=W.getSelectWidth(),z=x._40I,f=x._41I,Q=W._78o=z&&f?{looped:S,type:a,width:i,center:y,color:W.getBodyColor("edge.color"),borderColor:Y,borderWidth:v,_97o:P?W.getSelectColor():R,selectWidth:P,pattern:q("edge.pattern"),cap:q("edge.cap"),join:q("edge.join"),is3d:q("edge.3d"),_67o:q("edge.3d.color"),_66o:q("edge.3d.accuracy"),gray:q("2d.gray")}:R;
if(Q){var G=V.getEdgeType(a);if(G){var k=G(x,Bi(W,E,x,S,a),E,W._19Q);k.points&&k.points.size()>1?(Q.edgeTypeInfo=k,X=vo(Q.edgeTypeInfo.points)):k[hf]&&k.rect&&(Q.edgeTypeInfo=k,X=k.rect)}else{var m=q("edge.source.anchor.x"),O=q("edge.source.anchor.y"),b=q("edge.target.anchor.x"),r=q("edge.target.anchor.y"),N=sf(E,x,"source"),B=sf(E,x,"target");if(a===_b){var A=Q.points=q(Kh)||Tb,s=A.size();Q.segments=q("edge.segments");var j=m!==H||O!==H||$k(z),_=b!==H||r!==H||$k(f);if(!y)if($)j||(N=ah(N,s?A.get(0):B,$,s)),_||(B=ah(B,s?A.get(s-1):N,$,s));else{var w;j||(w=uo(N,s?A.get(0):B,tf(E,z)),w&&(N={x:w[0],y:w[1]})),_||(w=uo(s?A.get(s-1):N,B,tf(E,f)),w&&(B={x:w[0],y:w[1]}))}X=ri(vo(Q.points),vo(N,B))}else{var C=Bi(W,E,x,S,a);if(W._19Q||(C=-C),S)N=er(N),N.x=E.getNodeRect(z).x,Q.radius=C,X={x:N.x-C,y:N.y-C,width:2*C,height:2*C};else{var I=Wj(N,B),n=Uk($,I),K={x:n,y:C},t={x:I-n,y:C},U=F(B.y-N.y,B.x-N.x),o=Q.mat=new Fn(U);if(Q.orienAngle=U,Q.angle=B.x<N.x?U+e:U,Q.rect={x:K.x,y:K.y,width:t.x-K.x,height:0},Q.origin=N,K=o.tf(K),K.x+=N.x,K.y+=N.y,t=o.tf(t),t.x+=N.x,t.y+=N.y,y){var l={x:I,y:0};l=o.tf(l),l.x+=N.x,l.y+=N.y,X=vo([N,K,t,l]),Q.c1=N,Q.c2=l}else X=vo(K,t);N=K,B=t}}Q.sourcePoint=N,Q.targetPoint=B,x._lastSourcePoint=N,x._lastTargetPoint=B}var Z=0;q("edge.dash")&&(Z=q("edge.dash.width")||i);var p="square"===Q.cap?.71:.5;al(X,D(Z*p,i*p+v+P),Q.join),W._68o(X)}},getRotation:function(J,t,e){J=J||0;var j=this._78o;if(j){var l,A=j.angle,Z=j.points,V=j.edgeTypeInfo;if(A!=R)return t?j.orienAngle+J:A+J;if(V&&V[hf])return V.getRotation?V.getRotation(this,J,t,e):0;if(V&&V.points){var S=V.points;return l=S.size(),Lq[e]?l&&0===l%2?Mq(S.get(l/2-1),S.get(l/2),t,J):J:el[e]?Mq(S.get(0),S.get(1),t,J):Mq(S.get(l-2),S.get(l-1),t,J)}if(Z)return l=Z.size(),Lq[e]?l&&0===l%2?Mq(Z.get(l/2-1),Z.get(l/2),t,J):J:el[e]?Mq(j.sourcePoint,l?Z.get(0):j.targetPoint,t,J):Mq(l?Z.get(l-1):j.sourcePoint,j.targetPoint,t,J)}return J},getPosition:function(P,f,w,G,t){var q=this._78o;if(q){var N,Z=q.type,z=q.points,S=q.edgeTypeInfo,F=q.sourcePoint,g=q.targetPoint;if(!Z)return q.looped?{x:F.x-q.radius+f,y:F.y+w}:(t&&F&&g&&(F.x>g.x||F.x===g.x&&F.y>g.y)&&(P=eg[P],w=-w),N=Ph(P,q.rect,G),N.x+=f,N.y+=w,N=q.mat.tf(N),N.x+=q.origin.x,N.y+=q.origin.y,N);if(S&&S[hf])return S.getPosition?S.getPosition(this,P,f,w,G,t):{x:(F.x+g.x)/2,y:(F.y+g.y)/2};if(z){var N,T=z.size();if(Lq[P]){if(T){var D=T%2;if(0===D)return Ii(z.get(T/2-1),z.get(T/2),P,f,w,G,t);N=z.get((T-D)/2)}else N={x:(F.x+g.x)/2,y:(F.y+g.y)/2};return N=Ph(P,{x:N.x,y:N.y,width:0,height:0},G),N.x+=f,N.y+=w,N}return el[P]?Ii(F,T?z.get(0):g,P,f,w,G,t):Ii(T?z.get(T-1):F,g,P,f,w,G,t)}if(S){var p=S.points,T=p.size();if(Lq[P]){var D=T%2;return 0===D?Ii(p.get(T/2-1),p.get(T/2),P,f,w,G,t):(N=p.get((T-D)/2),N=Ph(P,{x:N.x,y:N.y,width:0,height:0},G),N.x+=f,N.y+=w,N)}return el[P]?Ii(p.get(0),p.get(1),P,f,w,G,t):Ii(p.get(T-2),p.get(T-1),P,f,w,G,t)}}return kl},_42:function(P){this._78o&&fg.superClass._42.call(this,P)},drawPath:function($,g){$.beginPath();var M=g.type,l=g.points,Z=g.segments,h=g.edgeTypeInfo;if(!M||l){var I=g.sourcePoint,z=I.x,N=I.y,o=g.targetPoint,i=o.x,V=o.y;if(M)if(Z){var q=new Mf({x:z,y:N});q.addAll(l),q.add({x:i,y:V}),ko($,q,Z)}else $.moveTo(z,N),l.each(function(w){$.lineTo(w.x,w.y)}),$.lineTo(i,V);else g.looped?$.arc(z,N,g.radius,0,b,!0):g.center?($.moveTo(g.c1.x,g.c1.y),$.lineTo(z,N),$.lineTo(i,V),$.lineTo(g.c2.x,g.c2.y)):($.moveTo(z,N),$.lineTo(i,V))}else h&&(h.points?ko($,h.points,h.segments):h[hf]&&h[hf]($,h))},_80o:function(_){var i=this,Y=i.s,x=i._78o,z=x.width,G=x.selectWidth,A=x.borderWidth,b=_.lineJoin,S=_.lineCap,B=x.gray,l=x.pattern;_.lineJoin=x.join,_.lineCap=x.cap,i.drawPath(ei(_,l),x);var n=Y("edge.width.absolute");n&&(_.save(),_.setTransform(1,0,0,1,0,0)),G&&(_.strokeStyle=x._97o,_.lineWidth=z+2*(A+G),_.stroke()),A&&(_.strokeStyle=B?V.toGrayColor(x.borderColor):x.borderColor,_.lineWidth=z+2*A,_.stroke());var D=B?V.toGrayColor(x.color):x.color,H=B?V.toGrayColor(x._67o):x._67o;if(_.strokeStyle=D,_.lineWidth=z,_.stroke(),x.is3d&&Eh(_,D,H,z,i.gv._zoom,x._66o),qp(_,l),Y("edge.dash")){l=Y("edge.dash.pattern");var $=ei(_,l,i._2Q("edge.dash.offset"));$!==_&&i.drawPath($,x),i._1Q(_,"edge",Y("edge.dash.width")||z,l)}n&&_.restore(),_.lineJoin=b,_.lineCap=S},_48O:function(){},_47O:function(){}});var Xp=function(z,X){Ep(Xp,this,[z,X])};uj(Xp,Oh,{_3O:function(){var G,T,M=this,r=M.s,p=M._data,J=M.gv;if(M._88I=R,p.isExpanded()&&p.eachChild(function(p){if(hl(p)){var X=J.getBoundsForGroup(p);X&&(T||(T=[]),T.push(X),G=ri(G,X))}}),G){var z=J.getLabel(p),N=r("group.type"),S=r("group.border.width")||0,l=r("group.border.width.absolute"),i=S/2;l&&(S/=J._zoom),G=Jp(N,T,G),An(G,p,"group.padding",1),Vp(G,S);var b=M._88I={type:N,rect:G,_64o:G};if(!N&&z!=R){var u,q=M.labelInfo={label:z,color:r("group.title.color"),font:r("group.title.font"),align:r("group.title.align")},Y=ol(q,z),g=Y.width+S,Z=Y.height+S,W=r("group.title.align"),s=r("group.title.orientation");if(s===gf||s===fm?(G.height+=S,g>G.width&&(G.width=g)):(s===_c||s===vk)&&(G.width+=S,g>G.height&&(G.height=g)),u=W===_c?G.x:W===vk?G.x+G.width-g:G.x+G.width/2-g/2,s===fm)b.titleRect={x:G.x,y:G.y+G.height,width:G.width,height:Z},b.rect={x:G.x,y:G.y,width:G.width,height:G.height+Z},q.rect={x:u,y:G.y+G.height,width:g,height:Z};else if(s===_c){var e=b.titleRect={x:G.x-Z,y:G.y,width:Z,height:G.height};b.rect={x:G.x-Z,y:G.y,width:G.width+Z,height:G.height},q.rect={x:e.x+Z/2-G.height/2,y:e.y+G.height/2-Z/2,width:G.height,height:Z},q.rotation=-Math.PI/2}else if(s===vk){var e=b.titleRect={x:G.x+G.width,y:G.y,width:Z,height:G.height};b.rect={x:G.x,y:G.y,width:G.width+Z,height:G.height},q.rect={x:e.x+Z/2-G.height/2,y:e.y+G.height/2-Z/2,width:G.height,height:Z},q.rotation=Math.PI/2}else b.titleRect={x:G.x,y:G.y-Z,width:G.width,height:Z},b.rect={x:G.x,y:G.y-Z,width:G.width,height:G.height+Z},q.rect={x:u,y:G.y-Z-i,width:g,height:Z+S}}M._40O(b,r("group.border.width")/2)}else Xp.superClass._3O.call(M)},getPosition:function(d,$,N,t){var U=this._88I;if(U){var D=Ph(d,U.rect,t);return D.x+=$,D.y+=N,D}return Xp.superClass.getPosition.apply(this,arguments)},_24O:function(R,f){var Q=this._88I;(!Q||Q.type||"label2"===R)&&Xp.superClass._24O.call(this,R,f)},_80o:function(r){var B=this,u=B._88I;if(u){var q=B._data,K=B.s,i=B.gv,G=u.type,_=u.rect,t=u._64o,f=u.titleRect,h=B.getBodyColor(),k=Tn(K("group.image"),h),z=K("group.image.stretch"),M=B.getBodyColor("group.background"),p=Tn(K("group.repeat.image"),h),Z=K("group.gradient.pack"),d=K("group.gradient"),x=K("group.gradient.color"),O=K("group.border.width"),C=K("group.border.color"),Y=K("group.border.pattern"),n=K("group.title.orientation"),m=K("group.depth"),c=K("group.border.radius"),D=K("group.border.join"),V=K("group.border.cap"),W=K("group.border.width.absolute");if(W&&(O/=i._zoom),G){var U=r.lineJoin,N=r.lineCap;if(r.lineJoin=D,r.lineCap=V,k){if(r.save(),Rk(r,G,_,c),r.clip(),Lf(r,k,z,_.x,_.y,_.width,_.height,q,i,h),r.restore(),O>0){var S=ei(r,Y);Rk(S,G,_,c),r.lineWidth=O,r.strokeStyle=C,r.stroke(),qp(r,Y)}}else{var S=ei(r,Y);M||p||Z?(Rk(r,G,_,c),Z?op(r,Z):p?Dg(r,p,h,null,q,i):rs(r,M,d,x,_),r.fill(),Z&&r.restore(),r!==S&&Rk(S,G,_,c)):Rk(S,G,_,c),O>0&&(r.lineWidth=O,r.strokeStyle=K("group.border.color"),r.stroke()),qp(r,Y),G===xc&&$o(r,M,m,_)}r.lineJoin=U,r.lineCap=N}else{var Q=K("group.title.background");if((!c||0>c)&&(c=0),k)Lf(r,k,z,t.x,t.y,t.width,t.height,q,i,B.getBodyColor());else if(M||p)if(p?Dg(r,p,h,null,q,i):rs(r,M,d,x,t),0===O)Rk(r,xc,t),r.fill(),$o(r,M,m,t);else{switch(r.beginPath(),n){case fm:jc(r,t.x,t.y,t.width,t.height,c,c,0,0);break;case _c:jc(r,t.x,t.y,t.width,t.height,0,c,0,c);break;case vk:jc(r,t.x,t.y,t.width,t.height,c,0,c,0);break;case gf:jc(r,t.x,t.y,t.width,t.height,0,0,c,c)}r.fill()}if(f&&Q)if(0===O)gi(r,f.x,f.y,f.width,f.height,Q),$o(r,Q,m,f);else{switch(r.beginPath(),r.fillStyle=Q,n){case fm:jc(r,f.x,f.y,f.width,f.height,0,0,c,c);break;case _c:jc(r,f.x,f.y,f.width,f.height,c,0,c,0);break;case vk:jc(r,f.x,f.y,f.width,f.height,0,c,0,c);break;case gf:jc(r,f.x,f.y,f.width,f.height,c,c,0,0)}r.fill()}if(O>0){var S=ei(r,Y);if(Rk(S,"roundRect",_,c),r.save(),r.lineWidth=O,r.strokeStyle=C,r.lineJoin=D,r.lineCap=V,r.closePath(),r.stroke(),f&&K("group.splitLine")){var w=f.x,T=f.y,l=f.width,y=f.height;r.beginPath(),n===fm?(r.moveTo(w,T),r.lineTo(w+l,T)):n===_c?(r.moveTo(w+l,T),r.lineTo(w+l,T+y)):n===vk?(r.moveTo(w,T),r.lineTo(w,T+y)):(r.moveTo(w,T+y),r.lineTo(w+l,T+y))}r.stroke(),r.restore(),qp(S,Y)}}B._39O(r,u)}else Xp.superClass._80o.call(B,r)}});var fp=function(G,J){Ep(fp,this,[G,J])};uj(fp,Oh,{_80o:function(b){this._39O(b,this._83o)}});var $n=function(n,x){Ep($n,this,[n,x])};uj($n,Oh,{_3O:function(){var c=this,I=c._data,S=c.s,m=c.gv,X=I.getPoints(),b=m.getBorderColor(I),C=b?S("border.width"):0,k=c.getSelectWidth(),x=S("shape.border.width"),u=I.getRect(),O=I.getAnchorRect(),A=m.getBodyColor(I),v=c._99o=X.isEmpty()?R:{rect:u,rotation:I.getRotation(),fillRule:S("shape.fill.rule"),scale:I.getScale(),position:I.p(),points:X,segments:I.getSegments(),bodyColor:A,borderColor:b,borderWidth:C,_94o:S("shape.border.3d"),_95o:S("shape.border.3d.color"),_96o:S("shape.border.3d.accuracy"),_97o:k?c.getSelectColor():R,selectWidth:k,_53o:S("shape.background"),_27Q:Tn(S("shape.repeat.image"),A),shapeGradientPack:S("shape.gradient.pack"),_54o:x,_55o:S("shape.border.color"),shapeGradient:S("shape.gradient"),_59o:S("shape.gradient.color"),_60o:S("shape.border.pattern"),_61o:S("shape.border.cap"),_62o:S("shape.border.join"),shapeForeground:S("shape.foreground"),gray:S("2d.gray")};if(v){O.x+=v.position.x,O.y+=v.position.y,v.gradientRect=O;var P=I.getScale(),_=D(1,D(q(P.x),q(P.y)));S("shape.dash")&&S("shape.dash.width")>x&&(x=S("shape.dash.width"));var U,Q=S("shape.border.width.absolute");U=Q?(x+C+k)/c.gv._zoom/_:x*("square"===v._61o?.71:.5)+C+k/c.gv._zoom/_,U&&(U*=_,u=er(u),al(u,U,v._62o)),c._68o(u);var z=S("clip.percentage");1>z&&(0>z&&(z=0),v.clipRect=nc(I.getAnchorRect(),S("clip.direction"),z));var n=S("shape.fill.clip.percentage");1>n&&(0>n&&(n=0),v.shapeClipRect=nc(I.getAnchorRect(),S("shape.fill.clip.direction"),n));var e=S("shape.foreground.clip.percentage");1>e&&(0>e&&(e=0),v.shapeForegroundClipRect=nc(I.getAnchorRect(),S("shape.foreground.clip.direction"),e))}},getPosition:function(h,a,G,c){var u=this._99o;if(u){var M=Ph(h,u.rect,c);return M.x+=a,M.y+=G,M}return kl},_42:function(C){this._99o&&$n.superClass._42.call(this,C)},_80o:function(z){var x,Y=this,F=Y.s,e=Y._99o,o=e.position,m=e.scale,W=e.rotation,I=e.borderWidth,Q=e.selectWidth/Y.gv._zoom,J=e._27Q,u=e.shapeGradientPack,K=e._54o,R=e.clipRect,L=e.shapeClipRect,C=e.points,p=e.segments,D=Y._data.isClosePath(),g=e.fillRule,t=e.gray,X=function(o){return t?V.toGrayColor(o):o},$=X(e._53o),H=$||J||u;z.save(),tl(z,o.x,o.y),pb(z,W),Bj(z,m.x,m.y),R&&(z.beginPath(),z.rect(R.x,R.y,R.width,R.height),z.clip()),H&&L&&(z.save(),z.beginPath(),z.rect(L.x,L.y,L.width,L.height),z.clip()),tl(z,-o.x,-o.y);var w=e._60o,A=ei(z,w),U=z.lineJoin,S=z.lineCap;z.lineJoin=e._62o,z.lineCap=e._61o;var G=X(e.bodyColor);H?(ko(z,C,p,D),u?op(z,u):J?Dg(z,J,G,null,Y._data,Y.gv):(x=G?G:$,rs(z,x,e.shapeGradient,X(e._59o),e.gradientRect)),z.fill(g),L&&(z.restore(),tl(z,-o.x,-o.y)),u&&z.restore(),A!==z&&ko(A,C,p,D)):ko(A,C,p,D);var q=e.shapeForeground;if(q){z.save();var P=e.shapeForegroundClipRect;P&&(tl(z,o.x,o.y),z.beginPath(),z.rect(P.x,P.y,P.width,P.height),z.clip(),tl(z,-o.x,-o.y)),ko(z,C,p,D),rs(z,q,F("shape.foreground.gradient"),X(F("shape.foreground.gradient.color")),e.gradientRect),z.fill(g),z.restore()}var i=F("shape.border.width.absolute");if(i&&(z.save(),z.setTransform(1,0,0,1,0,0)),Q&&(z.strokeStyle=e._97o,z.lineWidth=K+2*(I+Q),z.stroke()),I&&(z.strokeStyle=X(e.borderColor),z.lineWidth=K+2*I,z.stroke()),K&&(x=X(e._55o),!$&&G&&(x=G),z.strokeStyle=x,z.lineWidth=K,z.stroke(),e._94o&&Eh(z,x,X(e._95o),K,Y.gv._zoom,e._96o)),qp(z,w),F("shape.dash")){var T=F("shape.dash.width")||K;if(T>0){w=F("shape.dash.pattern");var A=ei(z,w,Y._2Q("shape.dash.offset"));A!==z&&ko(A,C,p,D),Y._1Q(z,"shape",T,w)}}i&&z.restore(),z.lineJoin=U,z.lineCap=S,z.restore()},_48O:function(){},_47O:function(){}});var tc=function(f,S){Ep(tc,this,[f,S])};uj(tc,$n,{getRotation:function(k,f,U){k=k||0;var $=this._data.getPoints(),z=$.size();return z>1?Lq[U]?z&&0===z%2?Mq($.get(z/2-1),$.get(z/2),f,k):k:el[U]?Mq($.get(0),$.get(1),f,k):Mq($.get(z-2),$.get(z-1),f,k):k},getPosition:function(u,I,z,N,K){var V=this._data.getPoints(),W=V.size();if(W>1){if(Lq[u]){var D=W%2;if(0===D)return Ii(V.get(W/2-1),V.get(W/2),u,I,z,N,K);var w=V.get((W-D)/2),Y={x:w.x,y:w.y,width:0,height:0};return w=Ph(u,Y,N),w.x+=I,w.y+=z,w}return el[u]?Ii(V.get(0),V.get(1),u,I,z,N,K):Ii(V.get(W-2),V.get(W-1),u,I,z,N,K)}return kl}});var tn=function(f,P){Ep(tn,this,[f,P])};uj(tn,Oh,{_3O:function(){var S=this;tn.superClass._3O.call(S);var P=S.s,i=S._83o;S._82o=i.img||i.shape?R:{background:S.getBodyColor("grid.background"),depth:P("grid.depth"),rect:i.rect,_88o:P("grid.cell.depth"),cellBorderColor:P("grid.cell.border.color"),_89o:P("grid.row.count"),_90o:P("grid.column.count"),block:P("grid.block"),_91o:P("grid.block.color"),_92o:P("grid.block.padding"),_93o:P("grid.block.width")}},_80o:function(j){var h=this,m=h._82o;if(!m)return tn.superClass._80o.call(h,j),void 0;var z,Y,U=h._data,k=m.background,Q=m.rect,a=m.block,f=m._91o,N=m._92o,X=m._93o,v=m._88o,J=m.cellBorderColor,r=m._89o,D=m._90o;if(k)if(gi(j,Q.x,Q.y,Q.width,Q.height,k),$o(j,k,m.depth,Q),v)for(z=0;r>z;z++)for(Y=0;D>Y;Y++)Q=U.getCellRect(z,Y),Q&&$o(j,k,v,Q);else if(J){for(j.beginPath(),z=0;r>z;z++)for(Y=0;D>Y;Y++)Q=U.getCellRect(z,Y),Q&&j.rect(Q.x,Q.y,Q.width,Q.height);j.strokeStyle=J,j.lineWidth=1,j.stroke()}if("h"===a)for(z=0;r>z;z++)Q=ri(U.getCellRect(z,0),U.getCellRect(z,D-1)),Vp(Q,N),sb(j,f,Q.x,Q.y,Q.width,Q.height,X);else if("v"===a)for(Y=0;D>Y;Y++)Q=ri(U.getCellRect(0,Y),U.getCellRect(r-1,Y)),Vp(Q,N),sb(j,f,Q.x,Q.y,Q.width,Q.height,X);h._39O(j,h._83o)}});var yb=function(m,k){Ep(yb,this,[m,k])};uj(yb,Oh,{_checkEmptyRect:!1,_81o:function(){var z=this._data,E=yb.superClass._81o.call(this),b=z.s("text");if(b!=R){var _,g,f=z.s("text.font"),l=z.s("text.align"),d=z.s("text.vAlign"),u=Cb(f,b),e=u.width,s=u.height,m=z.getAnchor(),t=z.getWidth(),c=z.getHeight();"left"===l?_=-t*m.x:"center"===l?_=-t*m.x+(t-e)/2:"right"===l&&(_=t*(1-m.x)-u.width),"top"===d?g=-c*m.y:"middle"===d?g=-c*m.y+(c-s)/2:"bottom"===d&&(g=c*(1-m.y)-u.height);var n,G=z.getMatrix();if(n=vo([G.tf(_,g),G.tf(_+e,g),G.tf(_+e,g+s),G.tf(_,g+s)]),E=ri(E,n),E&&z.s("text.shadow")){var y=er(E);y.x+=z.s("text.shadow.offset.x"),y.y+=z.s("text.shadow.offset.y"),Vp(y,z.s("text.shadow.blur")),E=ri(E,y)}}return E}});var Mo=gq.Interactor=function(o){this.gv=this._graphView=o};wm("Interactor",w,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(v){this.gv.fi(v)},setCursor:function(B){Kq||this.gv.setCursor(B)},startDragging:function(c){var d=this;d._lastClientPoint=zr(c),d._lastLogicalPoint=d.gv.lp(c),ts(d,c)},clearDragging:function(){var n=this;n._lastClientPoint=n._lastLogicalPoint=n._logicalPoint=R},autoScroll:function(x){return this.gv.autoScroll(x,this._lastClientPoint)}});var hg=R,Nb=function(D){hg.handleWindowTouchMove(D)},Hg=function(r){hg.handleWindowTouchEnd(r),Q(M,dq,Nb),Q(M,zj,Hg),hg=R},je=function(N){hg.handleWindowMouseMove(N)},Ec=function(e){hg.handleWindowMouseUp(e),Q(M,dl,je),Q(M,Ml,Ec),hg=R},Ce=function(F,A){F!==hg&&(hg?Kq?hg.handleWindowTouchEnd(A):hg.handleWindowMouseUp(A):Kq?(h(M,dq,Nb),h(M,zj,Hg)):(h(M,dl,je),h(M,Ml,Ec)),hg=F)},Cd=function(g){var f=this;f.gv=g,f._is2d=g instanceof gq.GraphView,f._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",cl,"wheel"].forEach(function(R){f.addListener(R)}),f.initImageResource()};uj(Cd,Mo,{enableVR:function(f){var v=this;if(!!v._vrEnable!==f)if(v._vrEnable=f,f)v.gv.vr.mp(v.onVRControllerChange,v);else if(v.gv.vr.ump(v.onVRControllerChange,v),v._vrRayPolyline){var b=v.gv.dm();b.remove(v._vrRayPolyline),b.remove(v._vrRayHitPoint),v._vrRayPolyline=H,v._vrRayHitPoint=H}},onVRControllerChange:function(C){var N=this,k=C.property,E=C.newValue,n=N.gv.vr.getController(E.id),q=n.getRay();q&&("gamepad.button.trigger"===k?"down"===E._62O?N.handle_mousedown(q):N.handleWindowMouseUp(q):"gamepad.pose"===k&&(N.handle_mousemove(q),N.handleWindowMouseMove(q)))},drawVRRay:function(Y,c,x){var o,H=this,R=H.gv,L=H._vrRayPolyline,p=!1;if(L)o=H._vrRayHitPoint;else{var E=R.dm();H._vrRayPolyline=L=new B.Polyline,H._vrRayHitPoint=o=new B.Node,o.s({shape3d:"billboard","shape3d.transparent":!0,"texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),o.setAnchor3d(.5,.5,.499);var T=.2/R.vr.measureOflength;o.s3(T,T,T),L.s("intersect",!1),o.s("intersect",!1),E.add(L),E.add(o),p=!0}if(c){var w=x.world,A=x.worldNormal,$=w.x,i=w.y,G=w.z;L.s("shape.border.color","red"),L.setPoints([{x:Y.origin.x,y:Y.origin.z,e:Y.origin.y},{x:$,y:G,e:i}]),o.s("3d.visible",!0),o.p3($,i,G),o.lookAtDirection([A.x,A.y,A.z],"front")}else{L.s("shape.border.color","blue");var O=new B.Math.Vector3;O.copy(Y.direction).setLength(1e3/H.gv.vr.measureOflength).add(Y.origin),L.setPoints([{x:Y.origin.x,y:Y.origin.z,e:Y.origin.y},{x:O.x,y:O.z,e:O.y}]),o.s("3d.visible",!1)}R.fi({kind:"vrRayIntersect",ray:Y,data:c,intersect:x,polyline:L,hitNode:o,begin:p})},setPreventEventDefault:function(v,U){var E=this,D=E._eventListeners[v];D?D._prevent=U:E._eventListeners[v]=D={_removal:H,_prevent:U}},removeListener:function(R){var G=this,B=G._eventListeners[R];B&&B._removal&&(B._removal(),B._removal=H)},addListener:function(s){var W=this,E=W._eventListeners[s];if(E||(W._eventListeners[s]=E={_removal:H,_prevent:!0}),!E||!E._removal){var P=function($){E._prevent&&V.preventDefault($),W.disabled||("wheel"===s?tb(W,$):W["handle_"+s]($))};h(W.gv.getView(),s,P),E._removal=function(){Q(W.gv.getView(),s,P)}}},handleWindowTouchMove:function(b){this.handleWindowMouseMove(b)},handleWindowMouseMove:function(r){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",r):(this.handleDownInfo("onBeginDrag",r),this.isDragging=!0))},handleWindowTouchEnd:function(k){this.handleWindowMouseUp(k)},handleWindowMouseUp:function(h){if(this.isDragging&&(this.handleDownInfo("onEndDrag",h),this.isDragging=!1),this.downInfo){var g=this.handle("onUp",h);if(g&&g.data===this.downInfo.data){this.handleMissingUp(h);var A=this,F=2===h.button?"onContextMenu":"onClick";if(!A._dbclickTimer)return A._dbclickTimer=_(function(){delete A._dbclickTimer,A.handleClick(h,F,g),this.downInfo=R},V.clickDelay),void 0;l(A._dbclickTimer),delete A._dbclickTimer,F="onDoubleClick",A.handleClick(h,F,g)}else this.handleDownInfo("onUp",h);this.downInfo=R}},handle_mouseleave:function(z){var x=this,h=x.gv,E=x.currentInfo?x.currentInfo.data:R;if(E){E.s("onLeave")&&E.s("onLeave")(z,E,h),x.fire("data","onLeave",z,E);var y=x.currentInfo?x.currentInfo.hits:R;if(y)for(var n in y)x.handleLeave(z,n);x.currentInfo=R}},handle_mousewheel:function(d){d.scrollDelta=d.wheelDelta/40,this.handle("onScroll",d)},handle_DOMMouseScroll:function(a){a.scrollDelta=2===a.axis?-a.detail:0,this.handle("onScroll",a)},handle_touchstart:function(K){this.handle_mousedown(K)},handle_touchmove:function(E){this.handle("onMove",E)},handle_mousedown:function(g){this.isDragging&&(this.handleDownInfo("onEndDrag",g),this.isDragging=!1),this.downInfo=this.handle("onDown",g),this.downInfo&&Ce(this,g)},handle_mousemove:function(t){var Y=this,P=Y.gv;Y._hoverTimer&&(l(Y._hoverTimer),delete Y._hoverTimer);var f,s,Z,r=Y.handle("onMove",t),N=this.currentInfo?this.currentInfo.data:R,q=this.currentInfo?this.currentInfo.hits:R;if(r&&(s=r.data,Z=r.hits,Y._hoverTimer=_(function(){l(Y._hoverTimer),delete Y._hoverTimer,Y.handle("onHover",t,r)},P.getHoverDelay()||V.hoverDelay)),s!==N){if(N&&(N.s("onLeave")&&N.s("onLeave")(t,N,P),this.fire("data","onLeave",t,N)),s&&(s.s("onEnter")&&s.s("onEnter")(t,s,P),this.fire("data","onEnter",t,s)),q)for(f in q)this.handleLeave(t,f);if(Z)for(f in Z){var C=Z[f],O=s._interactPrefix=C.prefix,J=O&&s.a(O+"onEnter")||C.target.onEnter;J&&J.call(C.target,t,s,P,C.point,C.width,C.height),this.fire(C.type,"onEnter",C.event,C.data,C.image,C.comp,C.point,C),s._interactPrefix=null}}else{if(q)for(f in q)Z&&Z[f]||this.handleLeave(t,f);if(Z)for(f in Z)if(!q||!q[f]){var C=Z[f],O=s._interactPrefix=C.prefix,J=O&&s.a(O+"onEnter")||C.target.onEnter;J&&J.call(C.target,t,s,P,C.point,C.width,C.height),this.fire(C.type,"onEnter",C.event,C.data,C.image,C.comp,C.point,C),s._interactPrefix=null}}this.currentInfo=r},handle:function(L,M,V){var w,T=this,R=T.gv;if(T._is2d){if(V=V||R.getDataInfoAt(M),!V||!R.isInteractive(V.data))return;if(w=V.ui.interactiveInfo){var s,C=V.data;if(C.s(L)&&C.s(L)(M,C,R),this.fire("data",L,M,C),"body"===V.part&&w.bodyInfo)s="body",V.hits=this.handleImage(s,R.getImage(C),L,M,C,V.point,w.bodyInfo);else if("icons"===V.part&&w._38o){var N=w._38o[V.name];N&&N[V.index]&&(s="icons|"+V.name+"|"+V.index,V.hits=this.handleImage(s,V.icon,L,M,C,V.point,N[V.index]))}}return V}var C,O;if(!V)if(M&&M instanceof B.Math.Ray){var q=R.vr.intersectWorld(M);if(C=q.data,O=q.intersect,T.drawVRRay(M,C,O),!C)return;var E=R.getData3dUI(C);if(w=E.interactiveInfo,!w)return;V={data:C,part:O.part,ui:E}}else{if(V=R.getDataInfoAt(M),!V)return;V&&(V={data:V.data,part:V.part})}if(R.isInteractive(V.data)){if(!O){C=V.data;var E=R.getData3dUI(C);if(V.ui=E,w=E.interactiveInfo,!w)return V;if(O=R.intersectObject(M,C),!O)return}C.s(L)&&C.s(L)(M,C,R),this.fire("data",L,M,C);var h,D=O.part;return"body"!==D&&(h=C.s(D+".image")||C.s("shape3d."+D+".image")),h||(h=C.s("all.image")||C.s("shape3d.image")),w="object"==typeof h?w[h.uuid]:w[h],w&&w.bodyInfo?(V.part="body",V.interactiveInfo=w,V.point=this._convertUVToPoint(O.uv,w),V.image=h,V.hits=this.handleImage("body",h,L,M,C,V.point,w.bodyInfo),V):V}},_handleLeaveOrMissing:function(t,z,S){var U="leave"===t?this.currentInfo:this.downInfo;if(U){var G=U.interactiveInfo||U.ui.interactiveInfo;if(G){var y,W,k=U.data;if(this._is2d){if(W=this.gv.lp(z),"body"===U.part&&G.bodyInfo)y="body","leave"===t?this.handleLeaveImage(S,y,this.gv.getImage(k),z,k,W,G.bodyInfo):this.handleMissingUpImage(y,this.gv.getImage(k),z,k,W,G.bodyInfo);else if("icons"===U.part&&G._38o){var V=G._38o[U.name];V&&V[U.index]&&(y="icons|"+U.name+"|"+U.index,"leave"===t?this.handleLeaveImage(S,y,U.icon,z,k,W,V[U.index]):this.handleMissingUpImage(y,U.icon,z,k,W,V[U.index]))}}else{if(!G.bodyInfo)return;var g=this.gv.intersectObject(z,k);W=g&&g.uv?this._convertUVToPoint(g.uv,G):{x:1/0,y:1/0},"leave"===t?this.handleLeaveImage(S,"body",U.image,z,k,W,G.bodyInfo):this.handleMissingUpImage("body",U.image,z,k,W,G.bodyInfo)}}}},handleClick:function(v,P,e){var O=this,g=this.downInfo;if(g&&e){var o,S=e.interactiveInfo||e.ui.interactiveInfo,t=e.data,m=this.gv;if(t.s(P)&&t.s(P)(v,t,m),O.fire("data",P,v,t),S)if(this._is2d){if(g.part===e.part){var T=m.lp(v);"body"===e.part&&S.bodyInfo&&(o="body",this.handleClickImage(o,m.getImage(t),P,v,t,T,S.bodyInfo,e))}}else{if(!S.bodyInfo)return;var B=m.intersectObject(v,t);if(!B)return;T=this._convertUVToPoint(B.uv,S),this.handleClickImage("body",g.image,P,v,t,T,S.bodyInfo,e)}}},handleDownInfo:function(q,M){if(this.downInfo){var $=this.downInfo,Q=this.gv,Y=$.interactiveInfo||$.ui.interactiveInfo;if(Y){var w,s=$.data;if(s.s(q)&&s.s(q)(M,s,Q),this.fire("data",q,M,s),this._is2d){var p=Q.lp(M);if("body"===$.part&&Y.bodyInfo)w="body",this.handleDownInfoImage(w,Q.getImage(s),q,M,s,p,Y.bodyInfo);else if("icons"===$.part&&Y._38o){var x=Y._38o[$.name];x&&x[$.index]&&(w="icons|"+$.name+"|"+$.index,this.handleDownInfoImage(w,$.icon,q,M,s,p,x[$.index]))}}else{if(!Y.bodyInfo)return;var A=Q.intersectObject(M,s);if(!A)return;p=this._convertUVToPoint(A.uv,Y),this.handleDownInfoImage("body",$.image,q,M,s,p,Y.bodyInfo)}}}},fire:function(S,y,Q,d,h,E,L,C){this.gv.fi({kind:y,type:S,event:Q,data:d,image:h,comp:E,view:this.gv,point:L,width:C?C.width:H,height:C?C.height:H})},handleImage:function(C,x,O,p,l,Y,F){var b={};if(x&&(x=Tn(x))){var h=this.gv,u=F.rect,f=this.convertPoint(Y,F);f.inRect&&(x[O]&&x[O](p,l,h,f,u.width,u.height),this.fire("image",O,p,l,x,H,f,u),b[C+"|image"]={target:x,type:"image",image:x,data:l,event:p,point:f,width:u.width,height:u.height});for(var E=F.compInfos,U=x,S=E.length-1;S>=0;S--){var y=E[S],M=y.comp;if(f=this.convertPoint(Y,y,U,M,h,l),f.inRect){u=y.rect;var r=l._interactPrefix=y.prefix,I=r&&l.a(r+O)||M[O];I&&I.call(M,p,l,h,f,u.width,u.height),this.fire("comp",O,p,l,x,M,f,u),(x=u.image)&&(x[O]&&x[O](p,l,h,f,u.width,u.height),this.fire("image",O,p,l,x,H,f,u)),l._interactPrefix=null,b[C+"|"+S]={target:M,type:"comp",comp:M,image:x,data:l,event:p,point:f,width:u.width,height:u.height,prefix:r},x&&(b[C+"|"+S+"|image"]={target:x,type:"image",image:x,data:l,event:p,point:f,width:u.width,height:u.height,prefix:r})}}}return b},handleLeave:function(Z,Q){return this._handleLeaveOrMissing("leave",Z,Q)},handleMissingUp:function(m){return this._handleLeaveOrMissing("missing",m)},handleLeaveImage:function(P,I,G,z,Z,f,e){if(G&&(G=Tn(G))){var W=this.gv,V=e.rect,n=this.convertPoint(f,e);P===I+"|image"&&(G.onLeave&&G.onLeave(z,Z,W,n,V.width,V.height),this.fire("image","onLeave",z,Z,G,H,n,V));for(var M=e.compInfos,R=G,k=M.length-1;k>=0;k--){var u=M[k],S=u.comp;n=this.convertPoint(f,u,R,S,W,Z),V=u.rect;var q=Z._interactPrefix=u.prefix;if(P===I+"|"+k){var i=q&&Z.a(q+"onLeave")||S.onLeave;i&&i.call(S,z,Z,W,n,V.width,V.height),this.fire("comp","onLeave",z,Z,G,S,n,V)}(G=V.image)&&P===I+"|"+k+"|image"&&(G.onLeave&&G.onLeave(z,Z,W,n,V.width,V.height),this.fire("image","onLeave",z,Z,G,H,n,V)),Z._interactPrefix=null}}},handleMissingUpImage:function(W,f,k,q,o,g){var s="onUp",r=this.downInfo.hits;if(r&&f&&(f=Tn(f))){var G=this.gv,v=g.rect,I=this.convertPoint(o,g);!I.inRect&&r[W+"|image"]&&(f[s]&&f[s](k,q,G,I,v.width,v.height),this.fire("image",s,k,q,f,H,I,v));for(var M=g.compInfos,L=f,j=M.length-1;j>=0;j--){var S=M[j],a=S.comp;if(I=this.convertPoint(o,S,L,a,G,q),!I.inRect){v=S.rect;var y=q._interactPrefix=S.prefix;if(r[W+"|"+j]){var U=y&&q.a(y+s)||a[s];U&&U.call(a,k,q,G,I,v.width,v.height),this.fire("comp",s,k,q,f,a,I,v)}(f=v.image)&&r[W+"|"+j+"|image"]&&(f[s]&&f[s](k,q,G,I,v.width,v.height),this.fire("image",s,k,q,f,H,I,v)),q._interactPrefix=null}}}},handleDownInfoImage:function(b,P,d,e,n,C,Z){var o=this.downInfo.hits;if(o&&P&&(P=Tn(P))){var K=this.gv,p=Z.rect,$=this.convertPoint(C,Z);o[b+"|image"]&&(P[d]&&P[d](e,n,K,$,p.width,p.height),this.fire("image",d,e,n,P,H,$,p));for(var j=Z.compInfos,_=P,D=j.length-1;D>=0;D--){var X=j[D],f=X.comp;$=this.convertPoint(C,X,_,f,K,n),p=X.rect;var N=n._interactPrefix=X.prefix;if(o[b+"|"+D]){var v=N&&n.a(N+d)||f[d];v&&v.call(f,e,n,K,$,p.width,p.height),this.fire("comp",d,e,n,P,f,$,p)}(P=p.image)&&o[b+"|"+D+"|image"]&&(P[d]&&P[d](e,n,K,$,p.width,p.height),this.fire("image",d,e,n,P,H,$,p)),n._interactPrefix=null}}},handleClickImage:function(Q,g,u,d,l,B,X,A){var s=this.downInfo.hits,e=A.hits;if(s&&g&&(g=Tn(g))){var P=this.gv,v=X.rect,K=this.convertPoint(B,X);s[Q+"|image"]&&(g[u]&&g[u](d,l,P,K,v.width,v.height),this.fire("image",u,d,l,g,H,K,v));for(var y=X.compInfos,S=g,i=y.length-1;i>=0;i--){var T=y[i],O=T.comp;K=this.convertPoint(B,T,S,O,P,l),v=T.rect;var f=l._interactPrefix=T.prefix;if(s[Q+"|"+i]&&e[Q+"|"+i]){var M=f&&l.a(f+u)||O[u];M&&M.call(O,d,l,P,K,v.width,v.height),this.fire("comp",u,d,l,g,O,K,v)}(g=v.image)&&s[Q+"|"+i+"|image"]&&(g[u]&&g[u](d,l,P,K,v.width,v.height),this.fire("image",u,d,l,g,H,K,v)),l._interactPrefix=null}}},initImageResource:function(){V.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(M,u){if(!M)return{x:1/0,y:1/0};var $=u.bodyInfo.rect,d=M.clone(),U=M.multiply({x:$.width,y:$.height});return U.local=d,U},convertPoint:function(e,$,s,N,o,K){var I=$.rect,Z=$.matrix.applyInverse(e).sub(I),O=Z.x>=0&&Z.y>=0&&Z.x<=I.width&&Z.y<=I.height;if(!O)return Z;if(N&&ie(N.pixelPerfect,K,o)){var I,w=1;this._is2d?(w=o.getZoom(),I=ik(e.x,e.y,H,w)):I=ik(e.x,e.y);var k=!1,U=I.x,P=I.y,l=I.width,Q=I.height,S=V.hitMaxArea,W=l*Q*w*w;if(W>S){var v=Math.sqrt(S/W);w*=v}l*=w,Q*=w,2>l&&(l=2),2>Q&&(Q=2),U*=w,P*=w;var C=Vk(l,Q);if(o._drawForChecking=!0,tl(C,-U,-P),C.scale(w,w),this._is2d){var Y=o.getDataUI(K),u=Y.interactiveInfo;Y.interactiveInfo=null;var F=s.comps;s.comps=[N],o.drawData(C,K),s.comps=F,Y.interactiveInfo=u}else{var F=s.comps;s.comps=[N];var Y=o.getData3dUI(K);Fq(C,s,0,0,e.x/e.local.x,e.y/e.local.y,K,o),s.comps=F}o._drawForChecking=!1;try{for(var g=0,M=C.getImageData(0,0,l,Q).data;g<M.length;g+=4)if(0!==M[g+3]){k=!0;break}C.restore()}catch(y){Jg=R,k=!1}Z.inRect=k}else Z.inRect=!0;return Z}});var mi=gq.DefaultInteractor=function(c){Ep(mi,this,[c])};wm("DefaultInteractor",Mo,{handle_mousedown:function(x){dj(x);var w=this,W=w.gv,q=W.getDataAt(x);if(W.setFocus(x)&&!W._editing&&!W._scrolling){lb(x)?W.handleDoubleClick(x,q):W.handleClick(x,q);var p=tm(x);!aj()&&!p&&q&&(W.isMovable(q)||W._39Q(q))||!W.isPannable()||!Ih(x)&&!p||Uc(x)||(w._tx=W.tx(),w._ty=W.ty(),w.startDragging(x))}},handleWindowMouseUp:function(F){var g=this,l=g.gv;l._panning&&(delete l._panning,l.onPanEnded(),g.fi({kind:"endPan",event:F})),delete g._tx,delete g._ty,g.clearDragging()},handle_mousemove:function(m){var C=this,Y=C.gv;C._hoverTimer&&(l(C._hoverTimer),delete C._hoverTimer),C._hoverTimer=_(function(){C.fi({kind:"hover",event:m}),l(C._hoverTimer),delete C._hoverTimer},Y.getHoverDelay()||V.hoverDelay)},handle_touchmove:function(l){this.handle_mousemove(l)},handleWindowMouseMove:function(s){var y=this,e=y.gv;y.fi({kind:e._panning?"betweenPan":"beginPan",event:s}),e._panning=1;var l=zs(e,s,y._lastClientPoint);e.setTranslate(y._tx+l.x,y._ty+l.y)},handle_mousewheel:function(N){this.gv.handleScroll(N,N.wheelDelta)},handle_DOMMouseScroll:function(K){2===K.axis&&this.gv.handleScroll(K,-K.detail)},handle_keydown:function(u){this.gv.handleKeyDown(u)}});var Jr=gq.SelectInteractor=function(E){Ep(Jr,this,[E])};wm("SelectInteractor",Mo,{_42:function(){var t=this,C=t.gv,Z=C.getZoom(),z=t.mark,x=t.div;x||(x=t.div=Fb(),ub(t.getView(),x));var v={};v.x=z.x*Z+C.tx(),v.y=z.y*Z+C.ty(),v.width=z.width*Z,v.height=z.height*Z,nd(x,v),this.intersects()?(x.style.border="",x.style.background=C.getRectSelectBackground()):(x.style.background="",x.style.border="1px solid "+C.getRectSelectBorderColor())},handle_mousedown:function(J){var G=this,O=G.gv;if(G._57I=R,G.pendingClickThrough=R,!(O._editing||O._scrolling||aj()||tm(J))){var M=O.getDataAt(J),j=O.sm();M?Uc(J)?j.co(M)?j.rs(M):j.as(M):j.co(M)?M instanceof ak&&M.isClickThroughEnabled()&&Ih(J)&&(G.pendingClickThrough=zr(J)):j.ss(M):Uc(J)||!O.isPannable()?Ih(J)&&(Uc(J)||j.cs(),O.isRectSelectable()&&(G.startDragging(J),O._77O=1)):Ih(J)&&(G._57I=zr(J))}},handle_mouseup:function($){var E=this,J=E.gv,w=E._57I;if(w&&(Wj(w,zr($))<=1&&J.sm().cs(),E._57I=R),E.pendingClickThrough){if(Wj(E.pendingClickThrough,zr($))<=1){var M=J.getDataAt($);if(M instanceof ak&&M.isClickThroughEnabled()){var D=J.getDataAt($,function(g){var Y=g.getParent()===M&&J.isSelectable(g,!0);return Y});D&&($.clickThrough=!0,J.sm().ss(D))}}E.pendingClickThrough=R}},handleWindowMouseUp:function($){this.clear($)},handleWindowMouseMove:function(U){var e=this,R=e.gv;e._logicalPoint=R.lp(U),e.mark?(e.fi({kind:"betweenRectSelect",event:U}),R.isPannable()&&e.autoScroll(U),e.redraw()):e.fi({kind:"beginRectSelect",event:U}),e.mark=vo(e._lastLogicalPoint,e._logicalPoint),e.redraw()},intersects:function(){var O=this,P=O._lastLogicalPoint,D=O._logicalPoint;return P.x>D.x||P.y>D.y},clear:function($){var w=this,S=w.gv,T=w.mark;if(w._57I=R,w.pendingClickThrough=R,w._lastLogicalPoint){if(T){if(0!==T.width&&0!==T.height){var C=S.getDatasInRect(T,w.intersects());
if(!C.isEmpty()){var V=S.sm(),F=V.toSelection();C.each(function(i){V.co(i)?F.remove(i):F.add(i)}),V.ss(F)}}hb(w.div),delete w.div,delete w.mark,w.redraw(),w.fi({kind:"endRectSelect",event:$}),S.onRectSelectEnded()}w.clearDragging(),delete S._77O}},redraw:function(){var j=this;j._draw||(j._draw=1,_(function(){j.mark&&j._42(),delete j._draw},16))}});var Jh=gq.MoveInteractor=function(M){Ep(Jh,this,[M])};wm("MoveInteractor",Mo,{handle_mousedown:function(h){var p=this,m=p.gv;if(Ih(h)&&!m._editing&&!m._scrolling&&!aj()){var F=m.getSelectedDataAt(h);!F||m._39Q(F)&&!m.isMovable(F)?m._focusData=R:(p._data=F,m.handleMouseDown&&m.handleMouseDown(h,F),p.startDragging(h),m.isMovable(F)&&(m._moving=1))}},handleWindowMouseUp:function(p){var K=this,y=K.gv;y.handleMouseUp&&y.handleMouseUp(p,K._data),K.clear(p)},handleWindowMouseMove:function(z){var U=this,A=U._data,h=U.gv;if((!h._93O||!h._93O(z,A))&&h._moving){U._logicalPoint||U.fi({kind:"prepareMove",event:z});var g=U._logicalPoint?"betweenMove":"beginMove",j={kind:g,event:z},S=U._logicalPoint=h.lp(z);"beginMove"!==g||U._alreadyBeginTransaction||(U._alreadyBeginTransaction=!0,h.getDataModel().beginTransaction());var E=U._calcShift(g,z),N=E.x,Z=E.y,v=U.gv.getMoveMode(z,A);v&&("x"===v?Z=0:"y"===v?N=0:"xy"!==v&&(N=Z=0)),h.moveSelection(N,Z),U._lastLogicalPoint=S,U.autoScroll(z),U.fi(j)}},_calcShift:function(){var S=this,i=S._logicalPoint,G=S._lastLogicalPoint,F=i.x-G.x,o=i.y-G.y;return{x:F,y:o}},clear:function(l){var W=this,r=W.gv;W._lastLogicalPoint&&(W._lastLogicalPoint=W._data=r._moving=R,W._logicalPoint&&(W.fi({kind:"endMove",event:l}),r.onMoveEnded()),W.clearDragging()),W._alreadyBeginTransaction&&(W._alreadyBeginTransaction=!1,r.getDataModel().endTransaction())}});var Mc=gq.TextEditInteractor=function(Z){Ep(Mc,this,[Z]),this.init()};wm("TextEditInteractor",Mo,{init:function(){var p=this,W=this.input=N.createElement("input"),y=W.style;W.text="text",y.border="1px solid #d8d8d8",y.position="absolute",y.padding="2px 3px",y.outline="none",y.marginLeft="-90px",y.marginTop="-16px",y.backgroundColor="rgba(255,255,255, 0.9)",y.fontSize="14px",y.width="180px",y.height="32px",y.boxShadow="0 0 13px rgba(16,142,233, 0.5)",y.textAlign="center",y.boxSizing="border-box",h(W,"keyup",function(C){Zl(C)&&p.endTextEdit()}),h(W,"focus",function(){W.select()});var H=this.textarea=N.createElement("textarea"),T=this.wrap=N.createElement("div");T.appendChild(H),y=H.style,y.margin=0,y.padding="4px",y.overflow="hidden",y.boxSizing="border-box",y.position="absolute",y.outline="none",y.backgroundColor="transparent",y.resize="none",y.textAlign="center",y.fontSize="14px",y.border="none",y.borderWidth=0,y.width="100%",y.top="50%",y=T.style,y.boxSizing="border-box",y.margin=0,y.padding=0,y.position="absolute",y.boxShadow="0 0 13px rgba(16,142,233, 0.5)",y.border="1px solid #d8d8d8",y.backgroundColor="rgba(255,255,255, 0.9)",y.width="180px",y.marginLeft="-90px",h(H,"keydown",function($){return(Vf()||Uc())&&Zl($)?(p.endTextEdit(),void 0):(p.calculateTextareaHeight(String.fromCharCode($.keyCode)),void 0)}),h(H,"focus",function(){H.select()});var A=function(h){h.stopPropagation()};h(W,"mousedown",A),h(W,"touchstart",A),h(H,"mousedown",A),h(H,"touchstart",A),p.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],p.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",p.handleWindowClick=function(G){var h=p._editingDOM;if(h){var W=h.getBoundingClientRect(),a=zr(G);Sm(W,a)||p.endTextEdit()}}},handle_mousedown:function(q){var Q=this,R=Q.gv;if(lb(q)&&!R._editing){var x=R.getDataAt(q);if(x){var S=R.getTextEditInfo(x);S&&(this._editInfo=S,this._editTarget=x,R._editing=!0,S.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var W=this,A=W.gv,P=W._editTarget,e=W.getTargetValue(),d=W.textarea,X=W.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===e||e===H)&&(e=""),d.value=e,W._editingDOM=d,A.getView().appendChild(X),this.layoutHTML(X,P),this.calculateTextareaHeight(),_(function(){d.focus(),h(M,"mousedown",W.handleWindowClick),h(M,"touchstart",W.handleWindowClick)},10)},handleTextEdit:function(){var w=this,j=w.gv,e=w._editTarget,q=w.getTargetValue(),O=w.input;(null===q||q===H)&&(q=""),O.value=q,w._editingDOM=O,j.getView().appendChild(O),this.layoutHTML(O,e),_(function(){O.focus(),h(M,"mousedown",w.handleWindowClick),h(M,"touchstart",w.handleWindowClick)},10)},layoutHTML:function(O,F){var A=this.gv,h=A.getZoom();if(F instanceof B.Node){var _=F.getRect();O.style.left=(_.x+_.width/2)*h+A.tx()+"px",O.style.top=(_.y+_.height/2)*h+A.ty()+"px"}else if(F instanceof B.Edge){var u=A.getDataUI(F),_=u._6I;O.style.left=(_.x+_.width/2)*h+A.tx()+"px",O.style.top=(_.y+_.height/2)*h+A.ty()+"px"}},endTextEdit:function(){var a=this,T=a._editInfo.isMultiline?a.wrap:a.input,I=a._editInfo.isMultiline?a.textarea:a.input;a.setTargetValue(I.value),a.gv.getView().removeChild(T),a.gv._editing=!1,delete a._editingDOM,Q(M,"mousedown",a.handlelick),Q(M,"touchstart",a.handleWindowClick)},setTargetValue:function(s){var G=this,L=G._editTarget,P=G._editInfo,d=P.accessType,x=P.name;if(x&&d||(d="p",x="name"),"p"===d){var v=B.Default.setter(x);L[v](s)}else"a"===d?L.a(x,s):L.s(x,s)},getTargetValue:function(){var V=this,w=V._editTarget,y=V._editInfo,Q=y.accessType,z=y.name;if(z&&Q||(Q="p",z="name"),"p"===Q){var g=B.Default.getter(z);return w[g]()}return"a"===Q?w.a(z):w.s(z)},createHiddenTextarea:function(){this.hiddenTextarea=N.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(E,Q){if(Q&&this.computedStyleCache)return this.computedStyleCache;var c=this,T=M.getComputedStyle(E),U=T.getPropertyValue("box-sizing")||T.getPropertyValue("-moz-box-sizing")||T.getPropertyValue("-webkit-box-sizing"),W=parseFloat(T.getPropertyValue("padding-bottom"))+parseFloat(T.getPropertyValue("padding-top")),g=parseFloat(T.getPropertyValue("border-bottom-width"))+parseFloat(T.getPropertyValue("border-top-width")),A=c.SIZING_STYLE.map(function(G){return G+":"+T.getPropertyValue(G)}).join(";"),B={sizingStyle:A,paddingSize:W,borderSize:g,boxSizing:U};return Q&&(this.computedStyleCache=B),B},calculateTextareaHeight:function(S){S=S||"";var j=this,z=j.textarea,X=j.hiddenTextarea,r=j.wrap,D=32,f=j.calculateHTMLStyle(z,!1),b=f.paddingSize,T=f.borderSize,P=f.boxSizing,a=f.sizingStyle;X.setAttribute("style",a+";"+j.HIDDEN_TEXTAREA_STYLE),X.value=z.value+S;var k=X.scrollHeight;"border-box"===P?k+=T:"content-box"===P&&(k-=b),z.style.height=k+"px",z.style.marginTop=0-.5*k+"px",r.style.height=Math.max(k,D)+"px",r.style.marginTop=k*-.5+"px"}});var Gn=gq.ScrollBarInteractor=function(l){Ep(Gn,this,[l])};wm("ScrollBarInteractor",Mo,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(l){var W=this.gv.getViewRect();return this._41o()&&(W.x+W.width-this.gv.lp(l).x)*this.gv.getZoom()<jj},isH:function(j){var m=this.gv.getViewRect();return this._40o()&&(m.y+m.height-this.gv.lp(j).y)*this.gv.getZoom()<jj},handle_mousemove:function(r){this.handle_touchmove(r)},handle_touchmove:function(F){if(!Lh&&Ih(F)&&this.gv.isScrollBarVisible()){var W=this,b=W.isV(F),g=W.isH(F);(b||g)&&W.gv.showScrollBar(),W.gv._scrolling=b||g}},handleWindowMouseUp:function(P){this.handleWindowTouchEnd(P)},handleWindowTouchEnd:function(C){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=R,this.fi({kind:"endScroll",event:C})},handle_mousedown:function(m){this.handle_touchstart(m)},handle_touchstart:function(z){var k=this;if(k.gv.setFocus(z),dj(z),k.handle_touchmove(z),!(tk(z)>1)&&k.gv._scrolling&&k.gv.isScrollBarVisible()){k._cp=zr(z),k._tx=k.gv.tx(),k._ty=k.gv.ty();var W=k.isV(z);k._state=W?"vScroll":"hScroll",ts(k,z),k.fi({kind:"beginScroll",event:z})}},handleWindowMouseMove:function(W){this.handleWindowTouchMove(W)},handleWindowTouchMove:function(p){var O=zr(p),f=this.gv.getViewRect(),E=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-O.y)*E.height/f.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-O.x)*E.width/f.width),this.fi({kind:"betweenScroll",event:p})}});var Pi=gq.TouchInteractor=function(S,O){O=O||{},O.selectable===H&&(O.selectable=!0),O.movable===H&&(O.movable=!0),O.pannable===H&&(O.pannable=!0),O.pinchable===H&&(O.pinchable=!0),O.editable===H&&(O.editable=!0),this.params=O,Ep(Pi,this,[S])};wm("TouchInteractor",Mo,{ms_edit:1,setUp:function(){var E=this;Pi.superClass.setUp.call(E),Kq&&E.params.editable&&E.gv.setEditInteractor(E)},tearDown:function(){var e=this;Pi.superClass.tearDown.call(e),Kq&&e.params.editable&&e.gv.setEditInteractor(R)},clear:function(k){var h=this,P=h.gv;P._moving&&(h.fi({kind:"endMove",event:k}),delete P._moving,P.onMoveEnded(),P.dm().endTransaction()),P._panning&&(h.fi({kind:"endPan",event:k}),delete P._panning,P.onPanEnded()),P._pinching&&(h.fi({kind:"endPinch",event:k}),delete P._pinching,P.onPinchEnded()),P._editing&&(h._46O(k),h._77I=h._node=h._edge=h._shape=h._rect=h._89I=h._index=P._editing=R),h._moving=h._panning=h._pinching=h._editing=h._57I=h._data=h._beginHistory=R,h.clearDragging()},handle_touchstart:function(F){var g=this;if(!g.gv._editing){dj(F),g._57I=R;var e=g.params,q=g.gv,w=q.sm(),L=q.getDataAt(F),B=tk(F);if(1===B){if(lb(F))return q.handleDoubleClick(F,L),void 0;q.handleClick(F,L),L&&(q.handleMouseDown&&q.handleMouseDown(F,L),g._data=L),e.selectable||(L=R),L&&(w.co(L)||w.ss(L),e.editable&&q.isEditable(L)&&g._79I(F,L,!0)?(g._editing=1,g.startDragging(F)):e.movable&&q.isMovable(L)&&(g._moving=1,g.startDragging(F))),L&&q.isMovable(L)||(g._57I=zr(F),e.pannable&&q.isPannable()&&(g._panning=1,g.startDragging(F),g._translate={x:q.tx(),y:q.ty()}))}else if(e.pinchable&&2===B){if(L&&q._39Q(L))return;g._pinching=1,g.startDragging(F);var V=q.getView(),$=q.getZoom(),O=V.getBoundingClientRect(),G=F.touches[0],k=F.touches[1],c={x:(G.clientX+k.clientX)/2-O.left,y:(G.clientY+k.clientY)/2-O.top};c.x-=q.tx(),c.y-=q.ty(),c.x/=$,c.y/=$,g._p=c,g._d=Km(F)}}},handle_touchend:function($){var J=this,P=J.gv,Q=J._57I,H=J._data;Q&&(Wj(Q,zr($))<=1&&!P.getDataAt($)&&P.sm().cs(),J._57I=R),H&&P.handleMouseUp&&P.handleMouseUp($,H)},handleWindowTouchEnd:function(r){this.clear(r)},handleWindowTouchMove:function(e){var i=this,c=i.gv,Z=tk(e);if(1===Z){if(i._editing&&(i._beginHistory||(i._beginHistory=1,c.dm().beginTransaction()),c._editing=1,i._78I(e)),i._moving)i._beginHistory||(i._beginHistory=1,c.dm().beginTransaction()),i.handleMove(e);else if(i._panning){var O=zr(e),F=zs(c,O,i._lastClientPoint);c.setTranslate(i._translate.x+F.x,i._translate.y+F.y),i.fi({kind:c._panning?"betweenPan":"beginPan",event:e}),c._panning=1}}else if(2===Z&&i._pinching){var N=Km(e);c.handlePinch(i._p,N,i._d),i._d=N,i.fi({kind:c._pinching?"betweenPinch":"beginPinch",event:e}),c._pinching=1}},handleMove:function(P){var y=this,Z=y.gv,d=Z.lp(P);Z._93O&&Z._93O(P,y._data)||(Z.moveSelection(d.x-y._lastLogicalPoint.x,d.y-y._lastLogicalPoint.y),y._lastLogicalPoint=d,y.autoScroll(P),y.fi({kind:Z._moving?"betweenMove":"beginMove",event:P}),Z._moving=1)}});var B=M.ht,ls=B.graph._editor={Math:B.Math,Guide:{}};ls.getStyle=function(k){var Y,M=ls.StyleMap;return M&&(Y=M[k],Y!==H)?Y:ls.DefaultStyleMap[k]},ls.setStyle=function(D,r){var L=ls.StyleMap;L||(L=ls.StyleMap={}),L[D]=r},ls.inEdit=function(F){return F._inXEdit===!0},ls.startEdit=function(l){l._inXEdit=!0,ls.Inject.doInject(l)},ls._46O=function(q){q._inXEdit=!1,ls.Inject.undoInject(q)},ls.toScreenPosition=function(E,C){var o=E.tx(),J=E.ty(),u=E._zoom;return new ls.Math.Vector2(C.x*u+o,C.y*u+J)},ls.checkHit=function(X,h,A){return X.distanceTo(h)<A?!0:!1},ls.toWorldPosition=function(O,S){var x=O.tx(),C=O.ty(),Z=O._zoom;return{x:(S.x-x)/Z,y:(S.y-C)/Z}},ls.setAntialias=function(k,u){for(var W,F=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],D=0,V=F.length;V>D&&(W=F[D],!(W in k));D++);k[W],k[W]=u},ls.getTargetCornersOnScreen=function(Z,T){if(!T)return null;var o,v=[];if(of(T,Z)){var G=tf(Z,T);o=[{x:G.x,y:G.y},{x:G.x+G.width,y:G.y},{x:G.x+G.width,y:G.y+G.height},{x:G.x,y:G.y+G.height}]}else{if(!T.getCorners)return null;o=T.getCorners()}return o.forEach(function(U){var P=ls.toScreenPosition(Z,U);v.push(P.x,P.y)}),v},ls.log=function(){};var Dd=ls.Inject={_modules:[]};Dd.registAsModule=function(C,$){var E={},S={};for(var A in C){var w=$.prototype[A];E[A]=w}C.getBackup=function(S){return E[S]},C.getBackups=function(){return E},S.doInject=function(){for(var D in C)"getBackup"!==D&&($.prototype[D]=C[D])},S.undoInject=function(){for(var x in C)"getBackup"!==x&&($.prototype[x]=E[x])},Dd._modules.push(S)},Dd.doInject=function(D){for(var p,W=Dd._modules,u=0,U=W.length;U>u;u++)p=W[u],p.doInject(D)},Dd.undoInject=function(A){for(var S,k=Dd._modules,Z=0,z=k.length;z>Z;Z++)S=k[Z],S.undoInject(A)};var Mo=B.graph.EditInteractor=function(D){var A=this,S=N.createElement("canvas");S.className="editCanvas",S.style.position="absolute",A._styleMap={},A._canvas=S,A._context=S.getContext("2d"),Mo.superClass.constructor.call(A,D),this._editDetail=!1,ls.setAntialias(A._context,!1),A._subModules=[new ls.Anchor(A),new ls.RotateX(A),new ls.MoveDummy(A),new ls.Rect(A),new ls.Curve(A),new ls.MoveHelper(A)],A._gridGuide=new ls.Guide.Grid(A),A._rectGuide=new ls.Guide.Rect(A),A._hoverGuide=new ls.Guide.Hover(A)},cd=Mo;B.Default.def(Mo,B.graph.Interactor,{ms_edit:1,ms_fire:1}),w.defineProperties(Mo.prototype,{editDetail:{get:function(){var g=!!this._editDetail;return g},set:function(F){var U=this,z=U._editDetail;z!==F&&(U._editDetail=F,U.gv._editing=F,U.fp("editDetail",z,F),U.fp("pointsEditingMode",z,F),U.fi({kind:F?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(R){(!this._editDetail||R)&&(this.gv._editing=R,R||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(W){this._editing=W,this.gvEditing=W}},pointsEditingMode:{get:function(){return this.editDetail},set:function(V){var K=this;K.editDetail!==V&&(V?K._tryEnterEditDetailMode():K._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var p=this._gridEnabled;if(!p)return!1;var R=this.gv;return R?!0:!0},set:function(p){p!==this._gridEnabled&&(this._gridEnabled=p,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(r){r!==this._agEnabled&&(this._agEnabled=r,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),Mo.prototype.getSubModule=function(f){var U,C,H,J=this._subModules;for(C=0,H=J.length;H>C;C++)if(U=J[C],U.catalog===f)return U},Mo.prototype.invokeSubModule=function(W,o){var f=this,R=f._subModules;if(R)for(var w,O,K,k=Array.prototype.slice.call(arguments,2),q=0,$=R.length;$>q;q++)if(w=R[q],O=w[W],O&&(K=O.apply(w,k),K!=H&&o))return w},Mo.prototype.invokeSubModuleInverse=function(p,U){var Y=this,q=Y._subModules;if(q)for(var V,v,R,t=Array.prototype.slice.call(arguments,2),$=q.length-1;$>=0;$--)if(V=q[$],v=V[p],v&&(R=v.apply(V,t),R!=H&&U))return V},Mo.prototype.setUp=function(){ls.log("setUp");var S=this,p=S.gv,m=p.getView(),w=S._canvas;Mo.superClass.setUp.call(S),p.setEditInteractor(S),p._79O?m.insertBefore(w,p._79O):m.appendChild(w),ls.startEdit(p),S.invokeSubModule("setUp"),p.dm().mm(S._onDataModelChanged,S),p.dm().md(S._onDataPropertyChanged,S)},Mo.prototype.tearDown=function(){ls.log("tearDown");var L=this,Z=L.gv,T=Z.getView();L._resetCustomCursorStyle(),Mo.superClass.tearDown.call(L),Z.dm().umm(L._onDataModelChanged,L),Z.dm().umd(L._onDataPropertyChanged,L),Z.setEditInteractor(null),T.removeChild(L._canvas),L._drawTimer&&(l(L._drawTimer),L._drawTimer=null),ls._46O(Z),L.invokeSubModule("tearDown")},Mo.prototype._onDataModelChanged=function(k){var F=this;("clear"===k.kind||"remove"===k.kind&&F.editDetail&&k.data===F.getSubModule("Curve").target)&&(F.editDetail=!1,F._42())},Mo.prototype._onDataPropertyChanged=function(k){var f=this;if(f.editDetail){var V=f.getSubModule("Curve"),v=k.data;v===V.target&&(v._writing||V._handleDataChanged(k))}},Mo.prototype.clear=function(){ls.log("clear")},Mo.prototype.redraw=function(){this._42()},Mo.prototype._42=function(){var V=this;V._drawTimer||(V._drawTimer=_(function(){V._drawTimer=null,V.drawImpl()},0))},Mo.prototype.drawImpl=function(){var x;for(x in{_42:!0})break;return function(){var c=this,e=c._canvas,Y=c.gv,W=Y.getWidth(),r=Y.getHeight(),f=c._context,o=B.Default.getInternal(),T=M.devicePixelRatio;(e.width!==W||e.height!==r)&&o.setCanvas(e,W,r,T),f.clearRect(0,0,e.width,e.height);var _=c._getValidSelection();f.save(),f.scale(T,T),c._gridGuide._42(),c.invokeSubModuleInverse(x,!1,f,Y,_),c._rectGuide._42(),c._hoverGuide._42(),f.restore()}}(),Mo.prototype._getValidSelection=function(){var g=this,U=g.gv,w=U.sm().getSelection(),j=[];return w.each(function(L){U.isVisible(L)&&U.isEditable(L)&&j.push(L)}),j},Mo.prototype.handle_touchmove=function(c){return this.handle_mousemove(c)},Mo.prototype.handle_mousemove=function(M){if(!B.Default.isDragging()){var J=this;if((J.editDetail||!aj()&&!tm(M))&&!J.gv._externalEditing)if(J.gvEditing=!1,J._checkEdit(M))J.gvEditing=!0;else{if(!J.getStyle("hoverGuideVisible"))return;J.hoverData=J.gv.getDataAt(M),J._42()}}},Mo.prototype.handle_touchstart=function(V){return this.handle_mousedown(V)},Mo.prototype.handle_mousedown=function(o){dj(o);var N=this;if((N.editDetail||!aj()&&!tm(o))&&!N.gv._externalEditing){if(lb(o)&&!o.clickThrough){if(N.editDetail){if(N._tryQuitEditDetailMode(o))return}else if(N._tryEnterEditDetailMode())return;N.gv.dm().beginTransaction();var W=N.invokeSubModule("handleDoubleClick",!0,o);if(N.gv.dm().endTransaction(),W)return}var j=N._checkEdit(o);j&&(N._downPosition=N._getLogicalPoint(o),N.gv.dm().beginTransaction(),j.startEdit(N,o),N.editing=!0)}},Mo.prototype._checkEdit=function(e){var J=this,S=J.gv,f=J._getLogicalPoint(e),v=J.invokeSubModule("check",!0,S,e,f)||null;return J._editMod=v,v},Mo.prototype.handleWindowTouchMove=function(J){return this.handleWindowMouseMove(J)},Mo.prototype.handleWindowMouseMove=function(W){var i=this,C=i._downPosition;if(C){var q=i._getLogicalPoint(W);if(q.distanceTo(C)<i.getStyle("moveSensitivity"))return;delete i._downPosition}var c=i._editMod;c&&c.handleEdit(i.gv,W)},Mo.prototype._getLogicalPoint=function(Q){var G=this,p=B.Default.getLogicalPoint(Q,G._canvas);return new ls.Math.Vector2(p)},Mo.prototype.handleWindowTouchEnd=function(X){return this.handleWindowMouseUp(X)},Mo.prototype.handleWindowMouseUp=function(){var N;for(N in{_46O:!0})break;return function(d){var C=this;C.editing=!1,C.setCursor("default"),C.invokeSubModule(N,!1,d),C._42(),C.gv.dm().endTransaction()}}(),Mo.prototype.handle_mousewheel=function(S){var Q=this;dj(S),Q.invokeSubModule("preHandleScroll",!0)||Q.gv.handleScroll(S,S.wheelDelta)},Mo.prototype.handleDelete=function(){var R=this;if(!R.editDetail){R.gv.dm().beginTransaction();var j=R.invokeSubModule("handleNormalStateDelete",!0);return R.gv.dm().endTransaction(),j||R.gv.removeSelection(),void 0}R.gv.dm().beginTransaction(),R.invokeSubModule("handleDelete",!0),R.gv.dm().endTransaction(),R._42()},Mo.prototype.handle_keydown=function(x){var Y=this;if((x.metaKey||x.ctrlKey)&&Y._42(),aj(x)&&!Y.editing)return Y.gvEditing=!1,Y.setCursor("default"),Y._42(),void 0;var m=Zl(x);return Y.editDetail?((m||Fj(x))&&(Y.editDetail=!1,Y._42()),Y.gv.dm().beginTransaction(),Y.invokeSubModule("handle_keydown",!0,x),Y.gv.dm().endTransaction(),void 0):(Y.gv.dm().beginTransaction(),Y.invokeSubModule("handleNormalStateKeyDown",!0,x),Y.gv.dm().endTransaction(),m&&Y._tryEnterEditDetailMode(),void 0)},Mo.prototype.handle_keyup=function(r){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,r),this.gv.dm().endTransaction()},Mo.prototype._tryEnterEditDetailMode=function(){var H=this;return!H.editDetail&&H.invokeSubModule("canEnterEditDetailMode",!0)&&1===H._getValidSelection().length?(H.editDetail=!0,H._42(),!0):void 0},Mo.prototype._tryQuitEditDetailMode=function(g){var J=this;return J.editDetail?!g||J.invokeSubModule("canQuitEditDetailMode",!0,g)?(J.editDetail=!1,J._42(),!0):!1:!1},Mo.prototype.setStyle=function(n,p,O){var m=this;O?ls.setStyle(n,p):m._styleMap[n]=p,"baseColor"===n&&(pd=p),m.fp("styleChanged",null,{key:n,value:p,base:O}),m._42()},Mo.prototype.getStyle=function(Y){var c=this,x=c._styleMap[Y];return x!==H?x:ls.getStyle(Y)},Mo.prototype.setCursor=function(D){this._resetCustomCursorStyle(),B.graph.EditInteractor.superClass.setCursor.call(this,D)},Mo.prototype._drawHostGuide=function(E){var W=this,b=W._context,Q=W.gv;ls.Icons.DrawIcon(W,b,ls.Icons.NodeHoverGuide,E.corners);var e=E.host;if(e){var H=Q.getAttachPoints(e);if(H&&H.length)for(var o=0,p=H.length;p>o;o++){var w=H[o],F=go(Q,e,0,w.offsetX||0,w.offsetY||0,w.x,w.y);F=ls.toScreenPosition(Q,F),F.isAttach=E.attach===o,ls.Icons.DrawIcon(W,b,ls.Icons.AttachPoint,F)}}},Mo.prototype._resetCustomCursorStyle=function(){var K=this;if(K._customStyle){var s=this.gv.getView();s.classList&&s.classList.remove&&s.classList.remove(K._customStyle),K._customStyle=null}},Mo.prototype._setRotateCursor=function(O){var D=this,J=D._cursorFactory;J||(J=D._cursorFactory=new ls.CursorFactory(D));var o=J.getRotateCursor(O),m=D.gv.getView();D._resetCustomCursorStyle(),D._customStyle=o,m.classList&&m.classList.add&&m.classList.add(o)};var Mn=ls.Group=function(N){var L=this;L._entities=N,L._64O=0,L._position={x:0,y:0},L._scale={x:1,y:1},L._anchor={x:.5,y:.5},L._anchor2={x:.5,y:.5}};Mn.prototype={},Mn.prototype.constructor=Mn;var Hq=null;Mn.findOrCreateGroup=function(i){if(Hq&&Hq.checkIsMe(i))return Hq;var J=new ls.Group(i);return J.getKeyOb()?(Hq=J,J):void 0},Mn.prototype.checkIsMe=function(d){var a=this._entities;if(a.length!==d.length)return!1;var W,$={},Q=d.length;for(W=0;Q>W;W++)$[d[W]._id]=!0;for(W=0;Q>W;W++)if(!$[a[W]._id])return!1;return!0},Mn.prototype.getRotation=function(){return this._64O},Mn.prototype.getPosition=function(){return this._position},Mn.prototype.getAnchor=function(){return this._anchor},Mn.prototype.getWidth=function(){return this._width},Mn.prototype.getScale=function(){return this._scale},Mn.prototype.getSize=function(){return{width:this._width,height:this._height}},Mn.prototype.getHeight=function(){return this._height},Mn.prototype.getKeyOb=function(){for(var u=this._entities,D=u.length-1;D>=0;D--){var Q=u[D];if(this.isNode(Q))return Q}},Mn.prototype.getAnchor2=function(){var w=this,y=w.rotateCenter;if(y)return y;var N=w.getKeyOb();if(!N)return w._anchor;var E=w._anchor2,J=N.getMatrix();return J.tf({x:N.getWidth()*(E.x-N.getAnchor().x),y:N.getHeight()*(E.y-N.getAnchor().y)})},Mn.prototype.setAnchor2=function(L,M){var S=this,u=S.getKeyOb();if(u){var y,m=u.getMatrix();y="number"==typeof L?{x:L,y:M}:L;var J=m.tfi(y);S._anchor2={x:u.getAnchor().x+J.x/u.getWidth(),y:u.getAnchor().y+J.y/u.getHeight()}}},Mn.prototype.setRotation=function(){},Mn.prototype.beginRotate=function(u){this.rotateCenter=u.pos,this.rotateMode=u.groupRotateMode},Mn.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Mn.prototype.addRotation=function(q,o,G){return"batch"===o?this._addRotationInBatchMode(q,G):"block"===o?this._addRotationInBlockMode(q,G):void 0},Mn.prototype._addRotationInBlockMode=function(x,l){var t=this,u=t.rotateCenter||t.getPosition();t._entities.forEach(function(J){if(t.isNode(J)&&(!l||l(J))){var y=J.getMatrix();y.translate(-u.x,-u.y),y.rotate(x),y.translate(u.x,u.y);var I=Math.sign(J.getScale().x);J.setRotation(F(y.b*I,y.a*I)),J.setPosition(y.tx,y.ty)}})},Mn.prototype._addRotationInBatchMode=function(u){var Z=this,c=Z._anchor2;Z._entities.forEach(function(o){if(Z.isNode(o)&&(!filter||filter(o))){var Y=o.getAnchor(),R=o.getMatrix(),n=R.tf({x:o.getWidth()*(c.x-Y.x),y:o.getHeight()*(c.y-Y.y)}),N=new ls.Math.Matrix2d;N.set(R.a,R.b,R.c,R.d,R.tx,R.ty),N.translate(-n.x,-n.y),N.rotate(u),N.translate(n.x,n.y);var O=Math.sign(o.getScale().x);o.setRotation(F(N.b*O,N.a*O)),o.setPosition(N.tx,N.ty)}})},Mn.prototype.setPosition=function(H){var V,w,x,X,E=this,c=E._position,W=H.x-c.x,Z=H.y-c.y,i=E._entities;for(w=0,x=i.length;x>w;w++)V=i[w],hl(V)&&(X=V.getPosition(),V.setPosition(X.x+W,X.y+Z));E._position=H},Mn.prototype.setScale=function(q,Q){var _=this,I=q/_._scale.x,M=Q/_._scale.y;_._adjustChildScaleOrSize(I,M,"size"),_._scale={x:q,y:Q}},Mn.prototype.getRect=function(){var C=this,P=C._position,T=C._width,L=C._height;return{x:P.x-T/2,y:P.y-L/2,width:T,height:L}},Mn.prototype.setSize=function(j,C){var W=this,j=Math.max(1,j),C=Math.max(1,C),L=j/W._width,_=C/W._height;W._adjustChildScaleOrSize(L,_,"size"),W._width=j,W._height=C},Mn.prototype._adjustChildScaleOrSize=function(u,g,K){var J,p,a,j,s,m,W,O,l,n,y,I,R,Y,L=this,V=L._position,z=L._entities,_=new ls.Math.Matrix2d;for(p=0,a=z.length;a>p;p++)if(J=z[p],L.isNode(J)){if(j=J.getPosition(),s=J.getRotation(),m=J.getWidth(),W=J.getHeight(),O=J.getScale(),y=O.x*m,I=O.y*W,_.identity().scale(y,I).rotate(s).translate(j.x,j.y).translate(-V.x,-V.y).rotate(-L._64O),s=F(_.b*Math.sign(y),_.a*Math.sign(y)),_.scale(u,g),l=Math.cos(s),n=Math.sin(s),Math.abs(l)<.001?(R=_.b/n,Y=-_.c/n):(R=_.a/l,Y=_.d/l),"scale"===K)J.setScale(R/m,Y/W);else if("size"===K){var t=R/O.x,o=Y/O.y;J.setScale(bb(R)*Math.abs(O.x),bb(Y)*Math.abs(O.y)),J.setSize(Math.max(.1,Math.abs(t)),Math.max(.1,Math.abs(o)))}_.rotate(L._64O).translate(V.x,V.y),J.setPosition(_.tx,_.ty)}},Mn.prototype.getMatrix=function(){var Z=this,v=Z._position,l=B.Default.getInternal(),d=Z._scale;return new l.Mat(Z._64O,v.x,v.y,d.x,d.y)},Mn.prototype.toGlobal=function(I){return this.getMatrix().tf(I)},Mn.prototype.getCorners=function(){var J=this,T=J._width,d=J._height,F=J._anchor,Z=-T*F.x,M=-d*F.y,L=J.getMatrix();return[L.tf(Z,M),L.tf(Z,M+d),L.tf(Z+T,M+d),L.tf(Z+T,M)]},Mn.prototype.calcInfo=function(){var m,w,L,k,C,Z,I=this,y=[],T=I._entities,B=I._64O;for(k=0,C=T.length;C>k;k++)Z=T[k],I.isNode(Z)&&Z.getCorners&&y.push.apply(y,Z.getCorners());if(y.length){var h=Math.cos(-B),d=Math.sin(-B),j=1/0,K=-1/0,a=1/0,Y=-1/0;for(k=0,C=y.length;C>k;k++)L=y[k],m=L.x,w=L.y,L.x=h*m-d*w,L.y=d*m+h*w,j=Math.min(j,L.x),K=Math.max(K,L.x),a=Math.min(a,L.y),Y=Math.max(Y,L.y);I._width=(K-j)/I._scale.x,I._height=(Y-a)/I._scale.y,h=Math.cos(B),d=Math.sin(B);var J=I._anchor;m=j+(K-j)*J.x,w=a+(Y-a)*J.y,I._position={x:h*m-d*w,y:d*m+h*w}}},Mn.prototype.isNode=function(n){return hl(n)?of(n)?n.size()?!1:!0:!0:!1},Mn.prototype._42=function(q,r,I){var T,L,B,D,c,p,A,Z,i=this,R=i._entities,G=i.rotateMode;for("batch"===G&&(Z=i.getKeyOb()),T=0,L=R.length;L>T;T++)B=R[T],i.isNode(B)&&(p=B.getRect(),D=ls.toScreenPosition(I,{x:p.x,y:p.y}),c=ls.toScreenPosition(I,{x:p.x+p.width,y:p.y+p.height}),A={min:D,max:c},B===Z&&(A.isKeyOb=!0),ls.Icons.DrawIcon(q,r,ls.Icons.GroupSubEntityRect,A))};var Ql=ls.CurveActiving=function(x,T){this._curve=x,this._interactor=x._interactor,this.silent=!0;for(var r in T)this[r]=T[r];delete this.silent};Ql.prototype={},Ql.prototype.constructor=Ql,w.defineProperties(Ql.prototype,{point:{get:function(){return this._point},set:function(q){var x=this;x._point=q,x.editingCtrl||x.silent||x._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(e){var A=this;A._pairs=e,A.editingCtrl&&!A.silent&&A._firePointChange()}}}),Ql.prototype._firePointChange=function(){var x=this,N=x.getCurrentEditingPoint(),T=x._interactor;if(!N)return T.fi({kind:"selectPoint"}),void 0;var D=this._curve.target;if(D){var S=ls.getDataMatrix(D).invert(),n=N.e;N=S.apply(ls.toWorldPosition(T.gv,N)),N.e=n;var G=x._lastFirePoint;G&&Math.abs(N.x-G.x)<1e-5&&Math.abs(N.y-G.y)<1e-5&&(N.e==H&&G.e==H||Math.abs(N.e-G.e)<1e-5)||(x._lastFirePoint=N,T.fi({kind:"selectPoint",x:N.x,y:N.y,e:N.e}))}},Ql.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Ql.prototype.getCurrentEditingPoint=function(){var z=this,N=z.editingCtrl;if(N){var i=z.pairs;if(i){var e=i[N.pairId];if(e){var M=e[N.type];if(M)return M}}}return z._point};var Ab=ls.CursorFactory=function(T){var o=this;o._interactor=T,o._rotateCursorStyles={}};Ab.prototype={},Ab.prototype.constructor=Ab,Ab.prototype.getRotateCursor=function(z){var W=this;0>z&&(z+=2*Math.PI);var M=W._interactor,E=M.getStyle("rotateCursorSize"),m=M.getStyle("rotateCursorRound"),u=Math.round(180*(z/Math.PI)/m);u*m>=360&&(u=0);var S=W._rotateCursorStyles,d="htCustomRotateStyle_"+E+"_"+m+"_"+u;return S[d]||(W._produceRotateCursor(d,E,m,u),S[d]=!0),d},Ab.prototype._produceRotateCursor=function(P,$,Q,F){var z=this;z._interactor;var v=z._canvas;v||(v=z._canvas=N.createElement("canvas")),v.width=v.height=$*devicePixelRatio,v.style.width=v.style.height=$+" px";var C=v.getContext("2d");ls.setAntialias(C,!1),C.scale(devicePixelRatio,devicePixelRatio);var O,h,k,o,B,W=Math.round($/2),f=""+W+" "+W+",auto !important;",J=4;O=Math.PI/180*F*Q,C.clearRect(0,0,$,$),C.save(),C.scale($/32,$/32),C.translate(16,15),C.rotate(O+Math.PI/2),C.beginPath(),C.moveTo(-8,0),C.lineTo(-8,J),C.lineTo(-8+J,J),C.moveTo(8,0),C.lineTo(8,J),C.lineTo(8-J,J),C.moveTo(-8,J),C.quadraticCurveTo(0,-6,8,J),C.restore(),C.lineCap="round",C.lineJoin="miter",C.strokeStyle="white",C.lineWidth=4,C.stroke(),C.strokeStyle="black",C.lineWidth=2,C.stroke(),h=JSON.stringify(v.toDataURL()),o="cursor:url("+h+")"+f,1!==devicePixelRatio&&(k='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+$+'px" height="'+$+'px"><image xlink:href='+h+' width="'+$+'" height="'+$+'"/></svg>',o+="cursor:url(data:image/svg+xml;base64,"+btoa(k)+")"+f,o+="cursor:-webkit-image-set(url("+h+")"+devicePixelRatio+"x,url("+h+")1x)"+f),B=N.createElement("style"),B.textContent="body."+P+" *, ."+P+"{"+o+"}",N.head.appendChild(B)};var db=ls.Guide.Grid=function(g){var i=this;i._interactor=g,i._alignmentGuideId=0,i._xAlignmentGuide=[],i._yAlignmentGuide=[]};db.prototype={},db.prototype.constructor=db,w.defineProperties(db.prototype,{gridBlockSize:{get:function(){var x=this;return x._gridBlockSize||x._interactor.getStyle("gridBlockSize")},set:function(g){this._gridBlockSize=g,this._interactor._42()}},gridThickLinesEvery:{get:function(){var M=this;return M._gridThickLinesEvery||M._interactor.getStyle("gridThickLinesEvery")},set:function(t){this._gridThickLinesEvery=t,this._interactor._42()}},gridEnabled:{get:function(){var n=this,x=n._interactor;return x.gridEnabled&&n.isValidGrid()}}}),db.prototype._42=function(){var R=this,b=R._interactor;R.gridEnabled&&R.drawGrid(),b.alignmentGuideEnabled&&R.drawAlignmentGuide()},db.prototype.makeMatrix=function(){var B=this,i=B._interactor.getStyle("gridAngle"),n=B._interactor.getStyle("gridRotation"),q=new ls.Math.Matrix2d,L=Math.sin(i),d=Math.cos(i);return q.set(1,0,d,L,0,0),q.rotate(n),q},db.prototype.isValidGrid=function(){var i=this,e=Math.PI,$=i._interactor,c=$.gv;if(c._zoom<$.getStyle("gridZoomThreshold"))return!1;var S=$.getStyle("gridAngle"),f=Math.abs(180*(S%e/e)),v=1-1e-8;return v>f||f>180-v?!1:!0},db.prototype.drawAlignmentGuide=function(){var B=this,Q=B._interactor,o=Q.gv,P=Q._canvas,k=Q._context,y=P.width,s=P.height,g=o.tx(),V=o.ty(),e=o._zoom;k.beginPath(),k.strokeStyle=Q.getStyle("gridAlignmentGuideColor"),k.lineWidth=1,B._xAlignmentGuide.forEach(function(b){var O=b.p*e+g;k.moveTo(O,0),k.lineTo(O,s)}),B._yAlignmentGuide.forEach(function(s){var R=s.p*e+V;k.moveTo(0,R),k.lineTo(y,R)}),k.stroke()},db.prototype.drawGrid=function(){function M(X,w,O,N){var E=ls.toScreenPosition(j,G.apply({x:X,y:w})),u=ls.toScreenPosition(j,G.apply({x:O,y:N}));
g.moveTo(E.x,E.y),g.lineTo(u.x,u.y)}var K=this,J=K._interactor,e=K.gridBlockSize,V=K.gridThickLinesEvery,b=J.getStyle("gridThickColor"),O=J.getStyle("gridLightColor"),j=J.gv,W=J._canvas,g=J._context,m=W.width,d=W.height,G=K.makeMatrix(),t=G.applyInverse(ls.toWorldPosition(j,{x:0,y:0})),S=G.applyInverse(ls.toWorldPosition(j,{x:m,y:0})),v=G.applyInverse(ls.toWorldPosition(j,{x:0,y:d})),u=G.applyInverse(ls.toWorldPosition(j,{x:m,y:d})),X=Math.min(t.x,S.x,v.x,u.x),L=Math.max(t.x,S.x,v.x,u.x),Q=Math.min(t.y,S.y,v.y,u.y),w=Math.max(t.y,S.y,v.y,u.y);m=L-X,d=w-Q;var n=Math.ceil(X/e),B=Math.floor(L/e),k=Math.ceil(Q/e),U=Math.floor(w/e);j.tx(),j.ty(),j._zoom;var C,y,z;for(g.save(),g.lineWidth=1,g.beginPath(),g.strokeStyle=b,z=Math.ceil(n/V)*V;B>=z;z+=V)C=z*e,M(C,Q,C,w);for(z=Math.ceil(k/V)*V;U>=z;z+=V)y=z*e,M(X,y,L,y);for(g.stroke(),g.beginPath(),g.strokeStyle=O,z=n;B>=z;z++)0!==z%V&&(C=z*e,M(C,Q,C,w));for(z=k;U>=z;z++)0!==z%V&&(y=z*e,M(X,y,L,y));g.stroke(),g.restore()},db.prototype.getAlignmentGuides=function(){var R=this;return{x:R._xAlignmentGuide,y:R._yAlignmentGuide}},db.prototype.addAlignmentGuide=function(Y,f,g){var S=this,p="x"===Y?S._xAlignmentGuide:S._yAlignmentGuide,g=g?g:++S._alignmentGuideId,v={p:f,id:g};if(p.length){var y=S._findClosestAlignmentGuide(v.p,p);y.dis<0?p.splice(y.index+1,0,v):p.splice(y.index,0,v)}else p.push(v);return S._interactor._42(),g},db.prototype.findClosest=function(D,e,q){var H=this,l=H._interactor,J=l.gv;q&&(D=ls.toWorldPosition(J,D));var p,a,j,A=1/0,h=1/0,X=D.x,U=D.y;if(H.gridEnabled){var y=H.gridBlockSize,P=H.makeMatrix(),f=P.applyInverse(D);f=P.apply({x:Math.round(f.x/y)*y,y:Math.round(f.y/y)*y}),A=f.x-X,h=f.y-U,j=!0}if(l.alignmentGuideEnabled&&(p=H._findClosestAlignmentGuide(X,H._xAlignmentGuide).dis,a=H._findClosestAlignmentGuide(U,H._yAlignmentGuide).dis,Math.abs(p)<Math.abs(A)&&(A=p,j=!0),Math.abs(a)<Math.abs(h)&&(h=a,j=!0)),j){j=!1;var R=J._zoom,M=l.getStyle("smartGuideThreshold")/R,F={};if(Math.abs(A)<M&&"y"!==e&&(F.x=q?A*R:A,j=!0),Math.abs(h)<M&&"x"!==e&&(F.y=q?h*R:h,j=!0),j)return F}},db.prototype._findClosestAlignmentGuide=function($,Z){if(!Z.length)return{dis:1/0};for(var o,G=0,R=Z.length-1;R-G>1;)o=Math.floor((G+R)/2),Z[o].p<$?G=o:R=o;var _=Z[G].p-$,O=Z[R].p-$;return Math.abs(_)<=Math.abs(O)?{line:Z[G],dis:_,index:G}:{line:Z[R],dis:O,index:R}},db.prototype.removeAllAlignmentGuide=function(y){var J=this;"y"!==y&&(J._xAlignmentGuide=[]),"x"!==y&&(J._yAlignmentGuide=[]),J._interactor._42()},db.prototype.removeAlignmentGuide=function(n){for(var b,y,K,U=this,W=U._xAlignmentGuide,r=0;2>r;r++)for(W=0===r?U._xAlignmentGuide:U._yAlignmentGuide,b=0,y=W.length;y>b;b++)if(K=W[b],K.id===n)return W.splice(b,1),U._interactor._42(),{axis:0===r?"x":"y",position:K.p};return!1},db.prototype.adjustAlignmentGuide=function(g,H){var m=this,u=m.removeAlignmentGuide(g);return u?(m.addAlignmentGuide(u.axis,H,g),!0):!1};var nh=ls.Guide.Rect=function(H){var G=this;G._interactor=H};nh.prototype={},nh.prototype.constructor=nh,nh.prototype.gatherRects=function(){var Z,t,N,U,n=this,I=n._interactor.gv,K=[],o=[],H={x:K,y:o},D={},M=I.getDataModel(),E=M.a("width"),V=M.a("height");E&&V&&(Z=0,t=0,N=E,U=V,K.push({node:M,type:0,p:Z},{node:M,type:1,p:Z+N/2},{node:M,type:2,p:Z+N}),o.push({node:M,type:0,p:t},{node:M,type:1,p:t+U/2},{node:M,type:2,p:t+U}),D[M._id||0]={x:Z,y:t,width:N,height:U}),M.each(function(Q){if(hl(Q)&&!I.isSelected(Q)&&I.isVisible(Q)&&I.isValidGuideLineSource(Q)){var i=!1;if(I.sm().getSelection().each(function(k){i||(Q.isHostOn(k)?i=!0:Q.isDescendantOf(k)&&(i=!0))}),!i){var P=Q.getRect();Z=P.x,t=P.y,N=P.width,U=P.height,K.push({node:Q,type:0,p:Z},{node:Q,type:1,p:Z+N/2},{node:Q,type:2,p:Z+N}),o.push({node:Q,type:0,p:t},{node:Q,type:1,p:t+U/2},{node:Q,type:2,p:t+U}),D[Q._id]=P}}}),K.sort(function(Q,L){return Q.p-L.p}),o.sort(function(y,u){return y.p-u.p}),n._grid=H,n._87I=D},nh.prototype.gatherLines=function(E,$,D){var v,T,g,n,Q,R,z,y,b,m,Z,f,q=this,K=[q.findClosest({x:E.x,y:E.y},$),q.findClosest({x:E.x+E.w/2,y:E.y+E.h/2},$),q.findClosest({x:E.x+E.w,y:E.y+E.h},$)],i={},A=q._87I;D=D||255;var t,j;for(q._guideLine=[],v=0;2>v;v++)for(i={},0===v?(n="y",y=E.x,b=y+E.w):(n="x",y=E.y,b=y+E.h),T=0;3>T;T++)Q=K[T],Q&&isFinite(Q[n])&&(t=1<<3*v+T,D&t&&(R=Q[n+"Line"],z=R.node,j=z._id||0,i[j]||(i[j]=!0,f=A[j],"y"===n?(m=f.x,Z=f.x+f.width):(m=f.y,Z=f.y+f.height),g=R.p,q._guideLine.push({type:n,a:y,b:b,c:m,d:Z,p:g,center:1===R.type}))))},nh.prototype._binarySearchClosest=function(v,Z){if(!Z.length)return{dis:1/0};for(var X,D=0,d=Z.length-1;d-D>1;)X=Math.floor((D+d)/2),Z[X].p<v?D=X:d=X;var o=Z[D].p-v,b=Z[d].p-v;return Math.abs(o)<=Math.abs(b)?{line:Z[D],dis:o}:{line:Z[d],dis:b}},nh.prototype.findClosest=function(x,N,P){var B=this,z=B._interactor,b=z.gv,l=B._grid;P&&(x=ls.toWorldPosition(b,x));var q,w=B._binarySearchClosest(x.x,l.x),s=B._binarySearchClosest(x.y,l.y),W=w.dis,y=s.dis,j=b._zoom,h=z.getStyle("smartGuideThreshold")/j,D={};return Math.abs(W)<h&&"y"!==N&&(D.x=P?W*j:W,D.xLine=w.line,q=!0),Math.abs(y)<h&&"x"!==N&&(D.y=P?y*j:y,D.yLine=s.line,q=!0),q?D:void 0},nh.prototype._42=function(){var s=this,C=s._guideLine;if(C&&!B.Default.isCtrlDown()){var O=s._interactor;if(O.getStyle("guideLineVisible")){var Z,F,n,Y,h,I,c,i,f,y,z,q,t,V,r,M,j,Q=O.gv,k=O._context,D=Q.tx(),l=Q.ty(),H=Q._zoom,N=O.getStyle("guideLineTextSpacing");for(Z=0,F=C.length;F>Z;Z++)n=C[Z],i=n.type,f=n.p,y=n.a,z=n.b,q=n.c,t=n.d,V=Math.min(y,q),r=Math.max(z,t),"x"===i?(Y=f*H+D,h=V*H+l,I=Y,c=r*H+l):(Y=V*H+D,h=f*H+l,I=r*H+D,c=h),ls.Icons.DrawIcon(O,k,ls.Icons.MoveLineGuide,{rect:[Y,h,I,c],center:n.center}),t>=y&&z>=q||(V=y>t?t:z,r=y>t?y:q,j=r-V,"x"===i?(n.center2center||(Y-=N,I=Y),h=V*H+l,c=r*H+l,M=ls.Icons.MoveLineGuideDistanceV):"y"===i&&(n.center2center||(h-=N,c=h),Y=V*H+D,I=r*H+D,M=ls.Icons.MoveLineGuideDistanceH),ls.Icons.DrawIcon(O,k,M,{x0:Y,y0:h,x1:I,y1:c,dis:j}))}}},nh.prototype.clear=function(){this._guideLine=null};var eb=ls.Guide.Hover=function(Q){var m=this;m._interactor=Q};eb.prototype={},eb.prototype.constructor=eb,w.defineProperties(eb.prototype,{}),eb.prototype._42=function(){var D=this._interactor;if(D.getStyle("hoverGuideVisible")&&!D.gvEditing){var A=D.hoverData,K=D.gv;if(!hl(A)||K.isSelected(A))return D.hoverData=null,void 0;var t=tf(K,A),r=ls.toScreenPosition(K,{x:t.x,y:t.y}),Y=ls.toScreenPosition(K,{x:t.x+t.width,y:t.y+t.height});ls.Icons.DrawIcon(D,D._context,ls.Icons.HoverDataRect,{min:r,max:Y,color:D.getStyle("hoverGuideColor")||D.getStyle("baseColor")})}},ls.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var zl=ls.Icons={},Ic=1e4,Vb=null,pd=ls.DefaultStyleMap.baseColor,Pc="rgb(183,232,135)",Uo="rgb(255,204,153)",qq=6;B.Default.setImage("Icons.RectPoint",{width:qq,height:qq,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return pd}},rect:[0,0,qq,qq]}]}),zl.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var r=zl.GroupSubEntityRect.data;if(!r)return[];var C=r.min,c=r.max;return[C.x,C.y,C.x,c.y,c.x,c.y,c.x,C.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return zl.GroupSubEntityRect.data.isKeyOb?pd:pd}}}]};var Sf=4;zl.HoverDataRect={comps:[{type:"shape",points:{func:function(){var F=zl.HoverDataRect.data;if(!F)return[];var D=F.min,m=F.max,A=Sf;return D.x-=A,D.y-=A,m.x+=A,m.y+=A,[D.x,D.y,D.x,m.y,m.x,m.y,m.x,D.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return zl.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},zl.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[zl.Line.data.P1.x,zl.Line.data.P1.y],qq,qq]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[zl.Line.data.P2.x,zl.Line.data.P2.y],qq,qq]}}}]},zl.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return zl.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},zl.Rect={comps:[{type:"shape",points:{func:function(){var Z=zl.Rect.data;if(!Z)return[];var N=Z.LT,B=Z.LB,v=Z.RB,g=Z.RT;return[N.x,N.y,B.x,B.y,v.x,v.y,g.x,g.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return pd}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return zl.Rect.data.rotation}},rect:{func:function(){return[[zl.Rect.data.LT.x,zl.Rect.data.LT.y],qq,qq]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return zl.Rect.data.rotation}},rect:{func:function(){return[[zl.Rect.data.LB.x,zl.Rect.data.LB.y],qq,qq]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return zl.Rect.data.rotation}},rect:{func:function(){return[[zl.Rect.data.RB.x,zl.Rect.data.RB.y],qq,qq]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return zl.Rect.data.rotation}},rect:{func:function(){return[[zl.Rect.data.RT.x,zl.Rect.data.RT.y],qq,qq]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return zl.Rect.data.rotation}},visible:{func:function(){return zl.Rect.data.L?!0:!1}},rect:{func:function(){return[[zl.Rect.data.L.x,zl.Rect.data.L.y],qq,qq]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return zl.Rect.data.rotation}},visible:{func:function(){return zl.Rect.data.R?!0:!1}},rect:{func:function(){return[[zl.Rect.data.R.x,zl.Rect.data.R.y],qq,qq]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return zl.Rect.data.rotation}},visible:{func:function(){return zl.Rect.data.T?!0:!1}},rect:{func:function(){return[[zl.Rect.data.T.x,zl.Rect.data.T.y],qq,qq]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return zl.Rect.data.rotation}},visible:{func:function(){return zl.Rect.data.B?!0:!1}},rect:{func:function(){return[[zl.Rect.data.B.x,zl.Rect.data.B.y],qq,qq]}}}]};var pq=16;B.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return pd}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return pd}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),zl.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[zl.Anchor.data.POS.x,zl.Anchor.data.POS.y],pq,pq]}}}]},zl.TipShiftX=12,zl.TipShiftY=12;var Cm=[8,28];zl.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[zl.TipHelper.data.helperPos.x,zl.TipHelper.data.helperPos.y,Cm[0]*zl.TipHelper.data.size,Cm[1]]}},background:{func:function(){return Vb.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return zl.TipHelper.data.text}},rect:{func:function(){return[zl.TipHelper.data.helperPos.x,zl.TipHelper.data.helperPos.y,Cm[0]*zl.TipHelper.data.size,Cm[1]]}},color:{func:function(){return Vb.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var Pj=7;zl.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!zl.ShapePoint.data.dynamicVisible}},rect:{func:function(){var N=zl.ShapePoint.data.point,t=zl.ShapePoint.data.size||Pj;return[N,t+10,t+10]}},background:{func:function(){var d=Date.now(),f=zl.ShapePoint.data.dynamicPeriod||1500,E=Math.sin(d%f/f*Math.PI);return"rgba(27,124,22,"+.5*E+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var z=zl.ShapePoint.data.point,c=zl.ShapePoint.data.size||Pj;return[z,c,c]}},background:{func:function(){var J=zl.ShapePoint.data.isEnd;return J?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return zl.ShapePoint.data.color||pd}}},{type:"rect",visible:{func:function(){return!!zl.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return pd}},rect:{func:function(){var x=5;return[zl.ShapePoint.data.point,x,x]}}}]},zl.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!zl.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return zl.ShapeBgCurve.data.P}},segments:{func:function(){return zl.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var y=Date.now(),c=zl.ShapeBgCurve.data.dynamicPeriod||1500,f=Math.sin(y%c/c*Math.PI);return"rgba(27,124,22,"+.3*f+")"}}},{type:"shape",points:{func:function(){return zl.ShapeBgCurve.data.P}},segments:{func:function(){return zl.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return zl.ShapeBgCurve.data.color||pd}}}]};var Se=8;zl.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var r=zl.ShapeHighlighPoint.data;return[[r.x,r.y],Se,Se]}},background:{func:function(){return Vb.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var nn=10;zl.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var v=zl.ShapeHighlighRealPoint.data;return[[v.x,v.y],nn,nn]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return pd}}}]};var dd=8;zl.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var g=zl.ShapeHighlighCtrlPoint.data,J=g.x,N=g.y,n=dd/2;return[J-n,N-n,J-n,N+n,J+n,N+n,J+n,N-n]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Vb.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Vb.getStyle("shapeCtrlPointBorderColor")||pd}}}]};var _n=3;zl.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return zl.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:_n,borderColor:{func:function(){return Vb.getStyle("curveHighlightColor")}}}]},zl.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return zl.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},zl.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return zl.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return zl.MoveLineGuide.data.center?Pc:Uo}}}]};var rm=5;zl.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var q=zl.MoveLineGuideDistanceH.data,i=q.x0,I=q.y0;return[i,I-rm,i,I+rm]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Uo},{type:"shape",points:{func:function(){var A=zl.MoveLineGuideDistanceH.data,x=A.x1,G=A.y1;return[x,G-rm,x,G+rm]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Uo},{type:"text",text:{func:function(){return Math.round(zl.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var y=zl.MoveLineGuideDistanceH.data;return[[(y.x0+y.x1)/2,y.y0-10],20,20]}},color:Uo,font:"12px Arial",align:"center"}]},zl.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var C=zl.MoveLineGuideDistanceV.data,h=C.x0,n=C.y0;return[h-rm,n,h+rm,n]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Uo},{type:"shape",points:{func:function(){var z=zl.MoveLineGuideDistanceV.data,_=z.x1,V=z.y1;return[_-rm,V,_+rm,V]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Uo},{type:"text",text:{func:function(){return Math.round(zl.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var L=zl.MoveLineGuideDistanceV.data;return[[L.x0-10,(L.y0+L.y1)/2],20,20]}},color:Uo,font:"12px Arial",align:"center"}]},B.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),zl.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var z=zl.EdgeElevationGuide.data,h=z.x,y=z.y,o=Vb.getStyle("curveElevationIntersectSize"),J=Vb.getStyle("curveElevationGuideShift");return h+=J[0],y+=J[1],[h-o,y-o,2*o,2*o]}}}]},B.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),B.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),zl.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return zl.ConnectGuide.data.rotation}},rect:{func:function(){var J=zl.ConnectGuide.data.connect;J.x,J.y;var D=Vb.getStyle("connectGuideIntersectSize");return[[J.x,J.y],2*D,2*D]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var V=zl.ConnectGuide.data.cursorPos||zl.ConnectGuide.data.connect,X=Vb.getStyle("connectGuideIntersectSize");return[[V.x,V.y],2*X-2,2*X-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var k=zl.ConnectGuide.data.connect,M=zl.ConnectGuide.data.cursorPos||k;return[k.x,k.y,k.x+.5*(M.x-k.x),k.y,M.x+.5*(k.x-M.x),M.y,M.x,M.y]}}}]},B.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),B.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),zl.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var L=zl.ConnectGuideGarbage.data.hover;return L?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var D=zl.ConnectGuideGarbage.data,c=Vb.getStyle("connectGuideGarbageIntersectsize");return D.hover&&(c+=5),[[D.x,D.y],2*c,2*c]}}}]};var fd=6;zl.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return zl.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var $=zl.ShapeActivingCtrl.data;return[$.point.x,$.point.y,$.c1.x,$.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return pd}}},{type:"shape",visible:{func:function(){return zl.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var q=zl.ShapeActivingCtrl.data;return[q.point.x,q.point.y,q.c2.x,q.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return pd}}},{type:"shape",visible:{func:function(){return zl.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var V=zl.ShapeActivingCtrl.data.c1,P=V.x,C=V.y,L=fd/2;return"c1"===zl.ShapeActivingCtrl.data.hl&&(L+=.5),[P-L,C-L,P-L,C+L,P+L,C+L,P+L,C-L]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Vb.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===zl.ShapeActivingCtrl.data.hl?Vb.getStyle("shapeCtrlPointHighlightBorder")||pd:Vb.getStyle("shapeCtrlPointBorderColor")||pd}}},{type:"shape",visible:{func:function(){return zl.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var u=zl.ShapeActivingCtrl.data.c2,p=u.x,v=u.y,d=fd/2;return"c2"===zl.ShapeActivingCtrl.data.hl&&(d+=.5),[p-d,v-d,p-d,v+d,p+d,v+d,p+d,v-d]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Vb.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===zl.ShapeActivingCtrl.data.hl?Vb.getStyle("shapeCtrlPointHighlightBorder")||pd:Vb.getStyle("shapeCtrlPointBorderColor")||pd}}}]},zl.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return pd}},rect:{func:function(){return[[zl.RoundPoint.data.x,zl.RoundPoint.data.y],qq,qq]}}}]},zl.AttachPoint={comps:[{type:"rect",background:{func:function(){return zl.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return pd}},rect:{func:function(){var j=zl.AttachPoint.data.isAttach?qq+4:qq;return[[zl.AttachPoint.data.x,zl.AttachPoint.data.y],j,j]}}}]},zl.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return zl.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return zl.SimpleRect.data.color||pd}},rect:{func:function(){var P=zl.SimpleRect.data;return[P.x,P.y,P.width,P.height]}}}]},B.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),zl.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var O=zl.MoveDummy.data;return[[O.pos.x,O.pos.y],2*O.size,2*O.size]}}}]},ls.Icons.DrawIcon=function(H,m,p,i){p.width=p.height=Ic,p.data=i,Vb=H,B.Default.drawImage(m,p,0,0,Ic,Ic)},ls.Icons.MapPoints=function(g,k){for(var l=0,c=g.length;c>l;l++)g[l]/=k},ls.roundTo=function(y,p,c){var z=Math.abs(y%p);return c>z||c>p-z?p*Math.round(y/p):y},ls.toFixed=function(v){return Math.round(100*v)/100},ls.getDataMatrix=function($){if($ instanceof B.Shape){var y=new B.Math.Matrix2d,i=$.getPosition();return y.translate(-i.x,-i.y).scale($.getScale().x,$.getScale().y).rotate($.getRotation()).translate(i.x,i.y),y}return $.getMatrix?$.getMatrix():new B.Math.Matrix2d};var Dk=ls.Math.Curve=function(){this._curves=[]};Dk.prototype={},Dk.prototype.constructor=Dk,Dk.prototype.createFromHtShape=function(x,i,T){i instanceof B.List&&(i=i.toArray());var R,u,b,E,v,l,G,z=this,L=null,D=null,V=0,o=ls.Math.Vector2,Q=ls.Math.CubicBezier,N=function(v){return new o(x[v],x[v+1],T?T[v/2]:H)};for(u=0,b=i.length;b>u;u++){switch(E=i[u],v=null,E){case 1:D=N(V),L=D,V+=2;break;case 2:R=N(V),V+=2,v=new Q(D,D.clone(),R.clone(),R),D=R;break;case 3:l=N(V),R=N(V+2),V+=4,v=new Q(D,l.clone().sub(D).multiplyScalar(2/3).add(D),l.clone().sub(R).multiplyScalar(2/3).add(R),R),D=R;break;case 4:l=N(V),G=N(V+2),R=N(V+4),V+=6,v=new Q(D,l,G,R),D=R;break;case 5:if(!L)break;v=new Q(D,D.clone(),L.clone(),L),D=null,L=null}v&&(v._index=z._curves.length,z._curves.push(v))}},Dk.prototype.checkPoint=function(g,Q){var I,C,v,V,X,R=this,j=R._curves;for(I=0,C=j.length;C>I;I++)if(V=j[I],X=V.intersectRect(g,Q,Q),X.length)return v=0,X.forEach(function($){v+=$.t}),v/=X.length,g=V.getPointAt(v),g.t=v,{bezier:V,intersection:g}},Dk.prototype.insertKnot=function(l,$){var C=l.insertKnot($),e=this,m=e._curves;m.splice(l._index,1,C[0],C[1])},Dk.prototype._isCloseEnough=function(s,F){return Math.abs(s.x-F.x)<1e-6&&Math.abs(s.y-F.y)<1e-6},Dk.prototype._isSamePoint=function(C,x){return C===x},Dk.prototype.moveRealPoint=function(u,b){var m=this,p=m._curves,e=b.clone().sub(u);p.forEach(function(x){var O=x._p1;x._p2,x._p3;var d=x._p4;m._isSamePoint(O,u)&&(x._p2.add(e),x._p1=b),m._isSamePoint(d,u)&&(x._p3.add(e),x._p4=b)})},Dk.prototype.moveCtrlDueToRealPointMovement=function(J,N){var E=this,U=E._curves,Q=function(g){g.add(N),g.e&&N.e&&(g.e+=N.e)};U.forEach(function(H){var T=H._p1;H._p2,H._p3;var v=H._p4;E._isSamePoint(T,J)&&Q(H._p2),E._isSamePoint(v,J)&&Q(H._p3)})},Dk.prototype.moveCtrlPoint=function(m,A,L){var E=m[L];if(E){E.e!==H&&(A.e=E.e);var T=this,K=T._curves;A.clone().sub(E),K.forEach(function(a){var x;"c2"===L?x="_p2":"c1"===L&&(x="_p3"),T._isSamePoint(a[x],E)&&(a[x]=A)}),m[L]=A}},Dk.prototype.deleteRealPoint=function(i,m){var b,r,e,W,h,j,S,M=this,V=M._curves,Z={},s=[],Q=ls.Math.CubicBezier;for(r=0,e=V.length;e>r;r++)b=V[r],W=b._p1,h=b._p2,j=b._p3,S=b._p4,(Z[r]||!M._isSamePoint(W,i))&&(M._isSamePoint(S,i)?e>r+1&&M._isSamePoint(V[r+1]._p1,i)&&(m||s.push(new Q(W,h,V[r+1]._p3,V[r+1]._p4))):s.push(b));M._curves=s},Dk.prototype.findPairs=function(M,B){var y,m,x,q,W,O,u,$,l=this,F=l._curves,Z={},E=[];for(m=0,x=F.length;x>m;m++)y=F[m],q=y._p1,W=y._p2,O=y._p3,u=y._p4,!Z[m]&&l._isSamePoint(q,M)&&(B?E.push({point:q,r2:u}):E.push({point:q,c2:W})),l._isSamePoint(u,M)&&($=B?{point:u,r1:q}:{point:u,c1:O},x>m+1&&l._isSamePoint(F[m+1]._p1,M)&&(B?$.r2=F[m+1]._p4:$.c2=F[m+1]._p2,Z[m+1]=!0),E.push($));return E},Dk.prototype.toHtShape=function(){var M=this,p=M._curves,Q=[],m=[],b={x:1/0,y:1/0};return p.forEach(function(O){var B=O._p1,W=O._p2,P=O._p3,e=O._p4;return M._isCloseEnough(B,b)||(Q.push(1),m.push(B.clone())),b=e,M._isCloseEnough(B,W)&&M._isCloseEnough(P,e)?(Q.push(2),m.push(e.clone()),void 0):(Q.push(4),m.push(W.clone(),P.clone(),e.clone()),void 0)}),{segments:Q,points:m}};var Hb=ls.Math.CubicBezier=function(V,U,b,L){var P=this;P._id=ls.Math.CubicBezier._globalId++,P._p1=V,P._p2=U,P._p3=b,P._p4=L};Hb._globalId=1,Hb.prototype={},Hb.prototype.constructor=Hb,Hb.prototype.toString=function(){return this._id},Hb.prototype.intersectRect=function(v,t,L){var W=t/2,g=L/2,b=v.x,H=v.y,T=ls.Math.Vector2,I=new T(-W+b,-g+H),x=new T(W+b,g+H),P=new T(x.x,I.y),O=new T(I.x,x.y),k=this,G=k.intersectLine(I,P),j=k.intersectLine(P,x),c=k.intersectLine(x,O),K=k.intersectLine(O,I),Y=G.concat(j).concat(c).concat(K);return Y},Hb.prototype.intersectLine=function(c,S){var m,t,p,D,A,K,i,a,R,s,X,g,v,h=this,G=c.clone().min(S),I=c.clone().max(S);D=h._p1,A=h._p2,K=h._p3,i=h._p4,m=D.clone().multiplyScalar(-1),t=A.clone().multiplyScalar(3),p=K.clone().multiplyScalar(-3),X=m.add(t).add(p).add(i),m=D.clone().multiplyScalar(3),t=A.clone().multiplyScalar(-6),p=K.clone().multiplyScalar(3),s=m.add(t).add(p),m=D.clone().multiplyScalar(-3),t=A.clone().multiplyScalar(3),R=m.add(t),a=D.clone(),v=new ls.Math.Vector2(c.y-S.y,S.x-c.x),g=c.x*S.y-S.x*c.y;for(var Z=h.getRoots(v.dot(X),v.dot(s),v.dot(R),v.dot(a)+g),l=new Array,j=0,y=Z.length;y>j;j++){var J=Z[j];if(!(0>J||J>1)){var P=D.clone().lerp(A,J),B=A.clone().lerp(K,J),U=K.clone().lerp(i,J),q=P.lerp(B,J),Q=B.lerp(U,J),_=q.lerp(Q,J);_.t=J,c.x==S.x?G.y<=_.y&&_.y<=I.y&&l.push(_):c.y==S.y?G.x<=_.x&&_.x<=I.x&&l.push(_):_.x>=G.x&&_.y>=G.y&&_.x<=I.x&&_.y<=I.y&&l.push(_)}}return l},Hb.prototype.solveTForPoint=function(L){var c,B,S,n,_=this;c=_._p1.x-L.x,B=_._p2.x-L.x,S=_._p3.x-L.x,n=_._p4.x-L.x;for(var k=_.getRoots(n-3*S+3*B-c,3*S-6*B+3*c,3*B-3*c,c),z=H,f=1/0,Q=0,I=k.length;I>Q;Q++){var y=k[Q];if(!(0>y||y>1)){var J=_._p1.clone().lerp(_._p2,y),g=_._p2.clone().lerp(_._p3,y),h=_._p3.clone().lerp(_._p4,y),u=J.lerp(g,y),C=g.lerp(h,y),o=u.lerp(C,y);o.t=y;var r=Math.abs(o.y-L.y);f>r&&(f=r,z=o)}}return z
},Hb.prototype.getPointAt=function(X){var x=this,T=x._p1,r=x._p2,L=x._p3,h=x._p4,q=T.clone().lerp(r,X),K=r.clone().lerp(L,X),C=L.clone().lerp(h,X),g=q.lerp(K,X),Q=K.lerp(C,X);return g.lerp(Q,X)},Hb.prototype.getRoots=function(X,A,t,u){var o,R,H,l,B,O=new Array;if(Math.abs(X)<1e-6){var o=A,R=t/o,H=u/o,l=R*R-4*H;if(l>0){var B=Math.sqrt(l);O.push(.5*(-R+B)),O.push(.5*(-R-B))}else 0==l&&O.push(.5*-R)}A/=X,t/=X,u/=X,o=(3*t-A*A)/3,R=(2*A*A*A-9*t*A+27*u)/27;var g=A/3,C=R*R/4+o*o*o/27,E=R/2;if(Math.abs(C)<=1e-6&&(C=0),C>0){var G,b,B=Math.sqrt(C);G=-E+B,b=G>=0?Math.pow(G,1/3):-Math.pow(-G,1/3),G=-E-B,G>=0?b+=Math.pow(G,1/3):b-=Math.pow(-G,1/3),O.push(b-g)}else if(0>C){var J=Math.sqrt(-o/3),P=Math.atan2(Math.sqrt(-C),-E)/3,w=Math.cos(P),y=Math.sin(P),L=Math.sqrt(3);O.push(2*J*w-g),O.push(-J*(w+L*y)-g),O.push(-J*(w-L*y)-g)}else{var G;G=E>=0?-Math.pow(E,1/3):Math.pow(-E,1/3),O.push(2*G-g),O.push(-G-g)}return O},Hb.prototype._70I=function(){var A=this;return A._p1.distanceToSquared(A._p2)<1e-10&&A._p3.distanceToSquared(A._p4)<1e-10},Hb.prototype.insertKnot=function(q){var J=this,$=J._p1,F=J._p2,Z=J._p3,T=J._p4,V=$.clone().lerp(F,q),s=F.clone().lerp(Z,q),I=Z.clone().lerp(T,q),H=V.clone().lerp(s,q),j=s.clone().lerp(I,q),w=H.clone().lerp(j,q);return J._70I()?($.clone().lerp(T,q),[new ls.Math.CubicBezier($,$.clone(),w.clone(),w),new ls.Math.CubicBezier(w,w.clone(),T.clone(),T)]):[new ls.Math.CubicBezier($,V,H,w),new ls.Math.CubicBezier(w,j,I,T)]};var fg=B.Default.getInternal().ui().EdgeUI,So={_47O:function(j){var B=this,K=So.getBackups()._47O;ls.inEdit(B.gv)||K.call(B,j)}};ls.Inject.registAsModule(So,fg);var Oh=B.Default.getInternal().ui().NodeUI,Yf={_47O:function(e){var p=this,j=Yf.getBackups()._47O;ls.inEdit(p.gv)||j.call(p,e)},getSelectWidth:function(){var M=this,v=M.gv,e=M._data;if(v.isEditable(e)&&ls.inEdit(v))return 0;var q=Yf.getBackup("getSelectWidth");return q.call(M)}};ls.Inject.registAsModule(Yf,Oh);var br=B.graph.GraphView,Rm={_editPointSize:function(){var J=B.Default.isTouchable,Y=ls.getStyle("pointSize");return Y[J?0:1]}(),isPointEditable:function(l){var G=this;if(ls.inEdit(G))return G._pointEditableFunc?G._pointEditableFunc(l):!0;var c=Rm.getBackup("isPointEditable");c.call(G,l)},isEditable:function(r){var L,d=this,Y=Rm.getBackup("isEditable");if(L=r instanceof ls.Group?!0:Y.call(d,r),!ls.inEdit(d))return L;if(!(r instanceof B.Edge))return L;if(!r.s("2d.editable"))return!1;var u=d.getEditableFunc();return u?u(r):!0},_42:function(J,I){var C=this,P=Rm.getBackups()._42;if(P.call(C,J,I),ls.inEdit(C)){var Y=C.getEditInteractor();Y.drawImpl()}}};ls.Inject.registAsModule(Rm,br);var $n=B.Default.getInternal().ui().ShapeUI,Gd={_47O:function(d){var e=this,Y=Gd.getBackups()._47O;ls.inEdit(e.gv)||Y.call(e,d)}};ls.Inject.registAsModule(Gd,$n);var mi=B.graph.DefaultInteractor,Nr={handle_mousewheel:function(R){var z=this,q=Nr.getBackup("handle_mousewheel");ls.inEdit(z.gv)||q.call(z,R)}};ls.Inject.registAsModule(Nr,mi);var Jh=B.graph.MoveInteractor,oc={_calcShift:function(X,k){var L=this,V=oc.getBackup("_calcShift"),N=L.gv;if(!ls.inEdit(N))return V.call(L,X,k);var S=N.getEditInteractor(),D=S.getSubModule("Move").calcShift(X,k,L);return D||V.call(L,X,k)},clear:function(p){var t=this,G=oc.getBackup("clear");G.call(t,p);var Y=t.gv;if(ls.inEdit(Y)){var N=Y.getEditInteractor();N.getSubModule("Move").clear(p)}}};ls.Inject.registAsModule(oc,Jh);var nh=ls.Rect=function(W){this.catalog="Rect",this._interactor=W};nh.prototype={},nh.prototype.constructor=nh,nh.prototype.gatherInfo=function(u,G){var m=this;if(1===G.length){var q=G[0];return q instanceof B.Shape&&q._70I()?m.gatherLine(u,q):of(q,u)?!1:m.gatherSingleTarget(u,q)}return G.length>1?m.gatherMultiTargets(u,G):!1},nh.prototype.gatherSingleTarget=function(B,P){if(P.getCorners){var n,F=this,L=F.info;F.target=P,n=F.screenInfo={};var x=P.getCorners();L.LT=new ls.Math.Vector2(x[0]),L.LB=new ls.Math.Vector2(x[1]),L.RB=new ls.Math.Vector2(x[2]),L.RT=new ls.Math.Vector2(x[3]),L.T=L.LT.clone().add(L.RT).divideScalar(2),L.B=L.LB.clone().add(L.RB).divideScalar(2),L.L=L.LT.clone().add(L.LB).divideScalar(2),L.R=L.RT.clone().add(L.RB).divideScalar(2);for(var c in L)n[c]=ls.toScreenPosition(B,L[c]);var M=F._interactor,N=M.getStyle("checkSize"),A=function(l,I,A){var q=I.clone().sub(l).setLength(-N),o=A.clone().sub(l).setLength(-N),n=q.add(o).add(l);return n};return n.rotLT=A(n.LT,n.RT,n.LB),n.rotLB=A(n.LB,n.LT,n.RB),n.rotRB=A(n.RB,n.LB,n.RT),n.rotRT=A(n.RT,n.LT,n.RB),n.rotT=n.rotLT.clone().add(n.rotRT).divideScalar(2),n.rotB=n.rotLB.clone().add(n.rotRB).divideScalar(2),n.rotL=n.rotLT.clone().add(n.rotLB).divideScalar(2),n.rotR=n.rotRT.clone().add(n.rotRB).divideScalar(2),n.rotation=P.getRotation(),F.gatherConnectInfo(),!0}},nh.prototype.gatherConnectInfo=function(){var b=this,o=b.target,R=b._interactor,P=b.screenInfo,N=R.gv;if(N.isConnectActionVisible(o)&&R.getStyle("connectGuideVisible")){var Y;o.s&&(Y=o.s("connectGuideShift")),Y||(Y=R.getStyle("connectGuideShift"));var K=o.getAnchor(),X=o.getSize(),Q=o.toGlobal({x:X.width*(Y[0]-K.x),y:X.height*(Y[1]-K.y)});Q=ls.toScreenPosition(N,Q),P.P1?Q.add(P.P2.clone().sub(P.P1).setLength(Y[2])):(Q.add(P.RT.clone().sub(P.LT).setLength(Y[2])),Q.add(P.LB.clone().sub(P.LT).setLength(Y[3]))),P.connect=Q}},nh.prototype.gatherMultiTargets=function(m,g){var x=ls.Group.findOrCreateGroup(g);if(!x)return!1;var V=this;return V.editing&&"rotate"!==V.editing.mode||x.calcInfo(),V.gatherSingleTarget(m,x)},nh.prototype.gatherLine=function(C,f){this.target=f;var m=this.screenInfo={},X=f.getPoints(),Y=ls.getDataMatrix(f);return m.P1=ls.toScreenPosition(C,Y.apply(X.get(0))),m.P2=ls.toScreenPosition(C,Y.apply(X.get(1))),this.gatherConnectInfo(),!0},nh.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],nh.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],nh.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],nh.prototype.check=function(H,K,M){if(B.Default.isLeftButton(K)){var m=this;if(m.editing=null,m.tipInfo=null,m.screenInfo){var f=m.target,V=H.isEditable(f),O=m.screenInfo;if(V&&O.connect){var d=m._checkConnect(M);if(d)return d}if(O.P1)return m._checkLine(M);var h,p,t,x=null,e=m._interactor,u=e.getStyle("checkSize");if(V&&H.isRectEditable(f))for(p=0;p<ls.Rect.ResizeKeys.length;p++)if(t=ls.Rect.ResizeKeys[p],ls.checkHit(M,O[t],u)){x=t,h="resize";break}if(!x&&V&&H.isRotationEditable(f)&&!e.getStyle("rotateAsClock")){var G=e.getStyle("rotateCheckSize");for(p=0;p<ls.Rect.RotateKeys.length;p++)if(t=ls.Rect.RotateKeys[p],ls.checkHit(M,O[t],G)){x=t,h="rotate";break}}if(!x)return e.setCursor("default"),void 0;if("rotate"===h){var v,$=H.lp(K);if(f instanceof ls.Group){var y=e.getStyle("groupRotateModeKey");"string"==typeof y&&(y=[y]);for(var o=!1,Z=0,U=y.length;U>Z;Z++)if(K[y[Z]]){o=!0;break}var R=e.getStyle("groupRotateModeDefault");v=o?"batch"===R?"block":"batch":R}var E="batch"===v?f.getAnchor2():f.getPosition(),F=Math.atan2($.y-E.y,$.x-E.x);e._setRotateCursor(F),m.editing={mode:h,key:x,pos:E,flipY:f.getScale().y<0,rotation:f.getRotation(),hitRot:F},v&&(m.editing.groupRotateMode=v)}else{var L=ls.Rect.ResizeKeys.indexOf(x),g=ls.Rect.ResizeDirection[L],a=Math.cos(f.getRotation()),r=Math.sin(f.getRotation()),q=g.x*Math.sign(f.getScale().x),D=g.y*Math.sign(f.getScale().y),A=Math.atan2(-r*q-a*D,a*q-r*D),N=(Math.round(A/(Math.PI/4))+8)%8,n=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][N];this._interactor.setCursor(n);var w=f.getWidth(),P=f.getHeight(),l=f.getAnchor();m.editing={mode:h,key:x,rect:{x:-w*l.x,y:-P*l.y,width:w,height:P},anchor:l,matrix:f.getMatrix()}}return x}}},nh.prototype._checkLine=function(x){var m=this;m.screenInfo;var Z,n=m._interactor.getStyle("checkSize");if(ls.checkHit(x,m.screenInfo.P1,n))Z="P1";else{if(!ls.checkHit(x,m.screenInfo.P2,n))return this._interactor.setCursor("default"),void 0;Z="P2"}return m.editing={mode:"line",key:Z},Z},nh.prototype._checkConnect=function(O){var o=this,v=o.screenInfo,H=o._interactor,R=H.getStyle("connectGuideIntersectSize"),h=v.connect,z=O.x,F=h.x;if(F>z&&R>F-z&&Math.abs(h.y-O.y)<R||z>=F&&ls.checkHit(O,h,R)){var u="connect",k=V.getConnectAction(H.gv);if(o.editing={mode:u},k&&k.delete)if(o.target instanceof ls.Group){var E=!0;H.gv.sm().getSelection().each(function(g){k.delete.visible.call(null,H.gv,g)||(E=!1)}),o.editing.hasDeleteAction=E}else k.delete.visible.call(null,H.gv,o.target)&&(o.editing.hasDeleteAction=!0);return H.setCursor("default"),u}},nh.prototype._fireEditEvent=function(O,d){var Q=this._interactor,B=this.editing;if(B){var g=B.mode;g="rotate"===g?"Rotation":"connect"===g?"Connection":"resize"===g?"Rect":g[0].toUpperCase()+g.slice(1),Q.fi({kind:O+"Edit"+g,event:d})}},nh.prototype.startEdit=function(p,N){p.startDragging(N);var G=this;G._interactor.fi({kind:"prepareEdit",event:N});var q=G.editing,v=G.target;if(q){if(G._fireEditEvent("begin",N),"rotate"===q.mode)return q.groupRotateMode&&v.beginRotate(q),void 0;if("connect"!==q.mode)("line"===q.mode||v&&0===v.getRotation())&&(G._inSmartGuide=!0,G._interactor.rectGuide.gatherRects());else if(q.hasDeleteAction){var B=p.gv,c=G._interactor.getStyle("connectGuideGarbageShift");q.garbageInfo={x:B.getWidth()*c[0]+c[2],y:B.getHeight()*c[1]+c[3],size:G._interactor.getStyle("connectGuideGarbageIntersectsize")},p._42()}}},nh.prototype._46O=function(y){var r,t,M=this,K=M.editing,O=M.target;if(K){if("connect"===K.mode&&!K.canceled&&!K.deleted)try{K.garbageInfo&&K.garbageInfo.hover?V.doDeleteConnectionAction(M._interactor.gv,O):V.doConnectAction(M._interactor.gv,O,K.target)}catch(Q){console.error(Q)}t=K.freezeFlag,r=M.editing.groupRotateMode,M._fireEditEvent("end",y),M.editing=null}M.tipInfo=null,M._inSmartGuide&&(M._interactor.rectGuide.clear(),M._inSmartGuide=!1),r&&O&&O.endRotate(),O instanceof B.Block&&(t===H?delete O._freezeSyncFromChildren:O._freezeSyncFromChildren=t,O.updateFromChildren())},nh.prototype.handleNormalStateDelete=function(){var t=this,z=t.editing;if(z&&"connect"===z.mode&&!z.canceled&&!z.deleted){if(z.garbageInfo){try{V.doDeleteConnectionAction(t._interactor.gv,t.target)}catch(e){console.error(e)}z.garbageInfo=null}return z.cursorPos=null,z.targetCorners=null,z.deleted=!0,t._interactor._42(),!0}},nh.prototype.handleNormalStateKeyDown=function(G){var P=this,e=P.editing;return!e||"connect"!==e.mode||e.canceled||e.deleted?void 0:B.Default.isEsc(G)?(e.cursorPos=null,e.targetCorners=null,e.canceled=!0,P._interactor._42(),!0):void 0},nh.prototype.handleEdit=function(e,N){var f=this,J=f.editing;if(J){var x,W,u,Z,q,U=f.target,V=J.key,C=J.mode,v=e.lp(N),R=f._interactor;if("connect"===C){if(J.canceled)return;if(J.deleted)return;J.cursorPos=R._getLogicalPoint(N);var $=J.garbageInfo;return $&&ls.checkHit(J.cursorPos,$,$.size)?($.hover=!0,J.target=null,J.targetCorners=null):($&&($.hover=!1),J.target=e.getDataAt(v,function(P){return e.isSelectable(P)?hl(P)?!0:!1:!1})||null,J.targetCorners=ls.getTargetCornersOnScreen(e,J.target)),R._42(),void 0}if("rotate"===C){var D,y,o=J.pos,w=Math.atan2(v.y-o.y,v.x-o.x);if(J.groupRotateMode?y=w-J.hitRot:(D=w-J.hitRot,y=J.rotation+D),y%=2*Math.PI,0>y&&(y+=2*Math.PI),!B.Default.isCtrlDown(N)){var j,t;Vf(N)?(j=R.getStyle("shiftRotateRound"),t=j/2):(j=R.getStyle("rotateRound"),t=R.getStyle("rotateSensitivity")),y=ls.roundTo(y,j,t)}J.groupRotateMode?(D=y-(J.lastRotation||0),0!==D&&(U.addRotation(D,J.groupRotateMode,function(u){return e.isRotationEditable(u)}),J.lastRotation=y)):U.setRotation(y),R._setRotateCursor(w),y>Math.PI&&(y-=2*Math.PI);var F=180*(y/Math.PI);F=F.toFixed(2),x=""+F+""}else if("resize"===C){var m=J.rect;u=m.x,Z=m.y;var T,z=m.width,c=m.height,h=J.anchor,X=J.matrix,k=U.s&&U.s("keepAspectRatio")||R.getStyle("keepAspectRatio");Vf(N)&&(k=!k);var E=f._unionPointMode1,L=f._unionPointMode2;if(f._inSmartGuide&&!B.Default.isCtrlDown(N)&&!k){var b;"L"===V||"R"===V?b="x":("T"===V||"B"===V)&&(b="y"),f._adsorbedToClosest(v,b),q=!0}T=X.tfi(v);var G;"LT"===V?(m=E(T,{x:u+z,y:Z+c},z,c,k),G=9):"T"===V?(m=L({x:u,y:T.y},{x:u+z,y:Z+c},z,c,k,"v"),G=1):"RT"===V?(m=E(T,{x:u,y:Z+c},z,c,k),G=33):"L"===V?(m=L({x:T.x,y:Z},{x:u+z,y:Z+c},z,c,k,"h"),G=8):"R"===V?(m=L({x:u,y:Z},{x:T.x,y:Z+c},z,c,k,"h"),G=32):"LB"===V?(m=E(T,{x:u+z,y:Z},z,c,k),G=12):"B"===V?(m=L({x:u,y:Z},{x:u+z,y:T.y},z,c,k,"v"),G=4):"RB"===V&&(m=E(T,{x:u,y:Z},z,c,k),G=36);var s=X.tf(m.x+m.width*h.x,m.y+m.height*h.y);U instanceof B.Block&&(J.hasOwnProperty("freezeFlag")||(J.freezeFlag=U._freezeSyncFromChildren,U._freezeSyncFromChildren=!0)),U.setPosition(s),U.setSize(m.width,m.height),q&&(W=U.getRect(),R.rectGuide.gatherLines({node:U,x:W.x,y:W.y,w:W.width,h:W.height},b,G)),x=""+Math.round(m.width)+" * "+Math.round(m.height)}else if("line"===C){if(Vf(N)){var p=U.getPoints(),r="P1"===V?p.get(1):p.get(0),_={x:v.x-r.x,y:v.y-r.y},l=R.getStyle("shiftLineRotateRound"),a=f._shiftDirList;if(!a||f._shiftRotateRound!==l){f._shiftRotateRound=l,f._shiftDirList=a=[];for(var I=0;I<Math.PI;I+=l)a.push({x:n(I),y:i(I)})}for(var M,Q=0,H=0,g=a.length;g>H;H++){var K=a[H],P=K.x*_.x+K.y*_.y;Math.abs(P)>Math.abs(Q)&&(Q=P,M=K)}v={x:r.x+M.x*Q,y:r.y+M.y*Q},R.rectGuide.clear()}else f._inSmartGuide&&!B.Default.isCtrlDown(N)&&(f._adsorbedToClosest(v),q=!0);var d=ls.getDataMatrix(U).applyInverse(v);U.setPoint("P1"===V?0:1,d,!0);var S=U.getPoints(),A=S.get(0),O=S.get(1);u=A.x-O.x,Z=A.y-O.y,x=" "+Math.round(Math.sqrt(u*u+Z*Z))+" ",q&&(W=U.getRect(),R.rectGuide.gatherLines({node:U,x:W.x,y:W.y,w:W.width,h:W.height}))}if(x){var Y=B.Default.getLogicalPoint(N,R._canvas);Y.x+=ls.Icons.TipShiftX,Y.y+=ls.Icons.TipShiftY,f.tipInfo={helperPos:Y,text:x,size:x.length}}f._fireEditEvent("between",N)}},nh.prototype._unionPointMode1=function(Y,M,z,X,V){if(V&&z&&X){var e=Y.x-M.x,N=Y.y-M.y;Math.abs(e*X)<Math.abs(N*z)?(N=Math.sign(N)*Math.abs(e*X/z),Y.y=M.y+N):(e=Math.sign(e)*Math.abs(N*z/X),Y.x=M.x+e)}return B.Default.unionPoint(Y,M)},nh.prototype._unionPointMode2=function(r,i,c,X,P,l){var d=B.Default.unionPoint(r,i);if(P&&c&&X){var v;"v"===l?(v=d.x+d.width/2,d.width=c*d.height/X,d.x=v-d.width/2):(v=d.y+d.height/2,d.height=X*d.width/c,d.y=v-d.height/2)}return d},nh.prototype._adsorbedToClosest=function(q,K){var x=this,f=x._interactor,g=f.rectGuide.findClosest(q,K),k=f.gridGuide.findClosest(q,K),C=1/0,I=1/0;g&&(isFinite(g.x)&&(C=g.x),isFinite(g.y)&&(I=g.y)),k&&(isFinite(k.x)&&Math.abs(k.x)<Math.abs(C)&&(C=k.x),isFinite(k.y)&&Math.abs(k.y)<Math.abs(I)&&(I=k.y)),isFinite(C)&&(q.x+=C),isFinite(I)&&(q.y+=I)},nh.prototype._42=function(b,O,d){var Z=this;Z.info={},Z.screenInfo=null;var M=Z._interactor;if(!M.editDetail&&Z.gatherInfo(O,d)){var j=Z.editing,m=j?j.groupRotateMode:null,l=Z.screenInfo;if("block"!==m){if(l.P1?ls.Icons.DrawIcon(M,b,ls.Icons.Line,l):ls.Icons.DrawIcon(M,b,ls.Icons.Rect,l),l.connect&&(ls.Icons.DrawIcon(M,b,ls.Icons.ConnectGuide,{rotation:l.rotation,connect:l.connect,cursorPos:j?j.cursorPos:null}),j)){if(j.targetCorners){for(var T={x:1/0,y:1/0},i={x:-1/0,y:-1/0},o=0,J=j.targetCorners.length;J>o;o+=2)T.x=Math.min(T.x,j.targetCorners[o]),i.x=Math.max(i.x,j.targetCorners[o]),T.y=Math.min(T.y,j.targetCorners[o+1]),i.y=Math.max(i.y,j.targetCorners[o+1]);ls.Icons.DrawIcon(M,b,ls.Icons.HoverDataRect,{min:T,max:i,color:M.getStyle("hoverGuideColor")||M.getStyle("baseColor")})}j.garbageInfo&&ls.Icons.DrawIcon(M,b,ls.Icons.ConnectGuideGarbage,j.garbageInfo)}Z.tipInfo&&ls.Icons.DrawIcon(M,b,ls.Icons.TipHelper,Z.tipInfo)}Z.target instanceof ls.Group&&Z.target._42(M,b,O)}};var Vm=ls.Anchor=function(H){this.catalog="Anchor",this._interactor=H};Vm.prototype={},Vm.prototype.constructor=Vm,Vm.prototype.gatherInfo=function(L,C){var c=this;if(1===C.length){var X=C[0];if(!X.getAnchor)return;if(X instanceof B.Shape&&X._70I())return;if(of(X,L))return;return c.gatherSingleTarget(L,C[0])}return C.length>1?c.gatherMultiTargets(L,C):!1},Vm.prototype.gatherSingleTarget=function(z,F){var P=this;return P.info.POS=F.getPosition(),P.screenInfo.POS=ls.toScreenPosition(z,P.info.POS),P.target=F,!0},Vm.prototype.gatherMultiTargets=function(t,I){var r=this,M=ls.Group.findOrCreateGroup(I);return M?(r.screenInfo.POS=ls.toScreenPosition(t,M.getAnchor2()),r.target=M,!0):!1},Vm.prototype.isVisible=function(){var S=this,x=S._interactor;if(x.getStyle("anchorVisible")===!1)return!1;var C=S.target;if(C){if(this.editing)return!0;var V=C.getAnchor(),e=x.getStyle("anchorOutsideVisibleThreshold");if(V.x<-e||V.x>1+e||V.y<-e||V.y>1+e)return!0;var I=C.getSize(),$=C.getScale(),s=Math.min(Math.abs(I.width*$.x),Math.abs(I.height*$.y));if(s*x.gv._zoom<x.getStyle("anchorHideThreshold"))return!1}return!0},Vm.prototype.check=function(Z,W,P){if(B.Default.isLeftButton(W)){var C=this,y=C._interactor;if(C.isVisible()&&y.getStyle("anchorMovable")!==!1){C.editing=null,C.tipInfo=null;var n=C.target;if(n&&Z.isAnchorEditable(n)&&Z.isEditable(n)){var m;if(C.screenInfo&&(m=C.screenInfo.POS)&&ls.checkHit(P,new ls.Math.Vector2(m),y.getStyle("checkSize"))){if(n instanceof ls.Group)return C.editing={},!0;var S=n.getWidth(),J=n.getHeight(),E=n.getAnchor();return C.editing={rect:{x:-S*E.x,y:-J*E.y,width:S,height:J},anchor:E,matrix:n.getMatrix()},!0}}}}},Vm.prototype.startEdit=function(a,B){a.startDragging(B),a.fi({kind:"beginEditAnchor",event:B})},Vm.prototype._46O=function(M){var s=this;s.editing&&(s.editing=null,s._interactor.fi({kind:"endEditAnchor",event:M})),s.tipInfo=null},Vm.prototype.handleEdit=function(O,A){var J=this,n=J.target;if(n){var G=J.editing;if(G){var z=O.lp(A),D=J._interactor;if(n instanceof ls.Group)return n.setAnchor2(z),D._42(),void 0;var F=G.matrix,y=F.tfi(z),L=G.rect,p=(y.x-L.x)/L.width,$=(y.y-L.y)/L.height;if(!B.Default.isCtrlDown(A)){var e=D.getStyle("anchorRound"),f=D.getStyle("anchorSensitivity");p=ls.roundTo(p,e,f),$=ls.roundTo($,e,f)}n.setAnchor(p,$,!0);var l=B.Default.getLogicalPoint(A,D._canvas);l.x+=ls.Icons.TipShiftX,l.y+=ls.Icons.TipShiftY;var _=""+p.toFixed(2)+", "+$.toFixed(2);J.tipInfo={helperPos:l,text:_,size:_.length},D.fi({kind:"betweenEditAnchor",event:A})}}},Vm.prototype._42=function(N,t,A){var W=this;W.info={},W.screenInfo={};var L=W._interactor;L.editDetail||W.gatherInfo(t,A)&&W.isVisible()&&(ls.Icons.DrawIcon(L,N,ls.Icons.Anchor,W.screenInfo),W.tipInfo&&ls.Icons.DrawIcon(L,N,ls.Icons.TipHelper,W.tipInfo))};var Kf=ls.MoveDummy=function(Z){this.catalog="MoveDummy",this._interactor=Z};Kf.prototype={},Kf.prototype.constructor=Kf,Kf.prototype.gatherInfo=function(){var g=this,d=this._interactor.getSubModule("Rect");if(d){var S=d.screenInfo;if(S){var l=g._interactor,P=g.getMovableTarget(d.target);if(P){var J=l.getStyle("moveDummyThreshold");if(J!==!1){var $=S.LT||S.P1,m=S.RT||S.P2,z=S.LB||$;if($){var B=S.P1,V=Math.min($.distanceTo(z),$.distanceTo(m));if(!(J!==!0&&V>J)){var U=l.getStyle("moveDummyPosition"),I=m.clone().sub($),L=z.clone().sub($),v=U[2],h=U[3];if(B){var K=l.getStyle("moveDummyLineExtraShift");K&&(v+=K[0],h+=K[1])}var E=$.clone().add(I.clone().multiplyScalar(U[0])).add(I.setLength(v)).add(L.clone().multiplyScalar(U[1])).add(L.setLength(h));return g.screenInfo.pos=E,g.screenInfo.size=l.getStyle("moveDummySensitivity"),!0}}}}}}},Kf.prototype.getMovableTarget=function(W){var S=this._interactor.gv;if(hl(W)){if(S.isMovable(W))return W}else if(W instanceof ls.Group)for(var z=W._entities,M=z.length-1;M>=0;M--){var y=z[M];if(hl(y)&&S.isMovable(y))return y}return null},Kf.prototype.getMoveInteractor=function(){for(var h,u,F,X=this._interactor.gv,B=X.getInteractors(),h=0,u=B.length;u>h;h++)if(F=B.get(h),F instanceof Jh)return F},Kf.prototype.startEdit=function(F,d){F.startDragging(d);var W=this.getMoveInteractor();if(W){var T=this.selectedTarget,p=F.gv;p._moving=1,W._data=T,p.handleMouseDown&&p.handleMouseDown(d,T)}},Kf.prototype._46O=function(W){var C=this,E=C.getMoveInteractor();E&&(E.handleWindowMouseUp(W),C.selectedTarget=null)},Kf.prototype.handleEdit=function(i,E){var P=this.getMoveInteractor();P&&P.handleWindowMouseMove(E)},Kf.prototype.check=function(Y,y,z){if(this.selectedTarget=null,B.Default.isLeftButton(y)&&!Y._scrolling&&!aj()){var X=this;if(X.screenInfo){var j=X.screenInfo.pos;if(j&&!(z.distanceTo(j)>X.screenInfo.size)){var J=X._interactor;return X.selectedTarget=X.getMovableTarget(J.getSubModule("Rect").target),J.setCursor("default"),!0}}}},Kf.prototype._42=function(V,R,M){var D=this;D.screenInfo={};var r=D._interactor;r.editDetail||D.gatherInfo(R,M)&&(!r.editing||D.selectedTarget)&&ls.Icons.DrawIcon(r,V,ls.Icons.MoveDummy,D.screenInfo)};var ji=ls.RotateX=function(Z){this.catalog="RotateX",this._interactor=Z};ji.prototype={},ji.prototype.constructor=ji,ji.prototype.gatherInfo=function(F,M){var T=this;if(1===M.length){var E=M[0];return E instanceof B.Shape&&E._70I()||of(E,F)?!1:T.gatherSingleTarget(F,E)}return M.length>1?T.gatherMultiTargets(F,M):!1},ji.prototype.gatherSingleTarget=function(){var A=new B.Math.Vector2,N=new B.Math.Vector2,p=new B.Math.Vector2,l=new B.Math.Vector2,C=function(j,O){var f=j.x-O.x,h=j.y-O.y;return f*f+h*h};return function(v,u){if(u.getCorners){var M=this,R=u.getCorners(),a=15,o=u.getPosition();A.copy(R[0]),p.copy(R[1]),l.copy(R[3]),N.copy(A).add(l).divideScalar(2).add(A.sub(p).setLength(a/v.getZoom()));var Z=Math.max(C(o,R[0]),C(o,R[1]),C(o,R[2]),C(o,R[3]));return M.info.POS=N.clone(),M.screenInfo.POS=ls.toScreenPosition(v,M.info.POS),M.screenInfo.LEN=Math.sqrt(Z)*v.getZoom()+a,M.screenInfo.CENTER=ls.toScreenPosition(v,o),M.target=u,!0}}}(),ji.prototype.gatherMultiTargets=function(V,F){var k=this,A=ls.Group.findOrCreateGroup(F);if(!A)return!1;var k=this;return k.gatherSingleTarget(V,A)},ji.prototype.isVisible=function(){var Q=this._interactor;if(!Q.getStyle("rotateAsClock"))return!1;var $=this.target;if(!$)return!0;var T=Q.gv;return T.isEditable($)&&T.isRotationEditable($)?!0:!1},ji.prototype.check=function(K,O,L){var y=this,D=y._checkImpl(K,O,L);return(D||y._clockPainted)&&y._interactor._42(),D},ji.prototype._checkImpl=function(G,J,Q){if(B.Default.isLeftButton(J)){var o=this;o.editing=null,o.tipInfo=null;var V;if(o.screenInfo&&(V=o.screenInfo.POS)&&o.isVisible()){var S=o._interactor;if(ls.checkHit(Q,V,S.getStyle("checkSize"))){var i=o.target,E=G.lp(J),s=i.getPosition(),f=Math.atan2(E.y-s.y,E.x-s.x);return S._setRotateCursor(f),o.editing={pos:s,rotation:i.getRotation(),hitRot:f,groupRotateMode:"block",screenInfo:{CENTER:o.screenInfo.CENTER,LEN:o.screenInfo.LEN}},!0}}}},ji.prototype.startEdit=function(t,K){t.startDragging(K),t.fi({kind:"beginEditRotation",event:K}),this.target instanceof ls.Group&&this.target.beginRotate(this.editing)},ji.prototype._46O=function(A){var F=this;F.editing&&(F.editing=null,F._interactor.fi({kind:"endEditRotation",event:A})),F.target instanceof ls.Group&&F.target.endRotate(),F.tipInfo=null},ji.prototype.handleEdit=function(D,f){var _=this,r=_.editing;if(r){var j,p,z=_.target,A=D.lp(f),F=_._interactor,L=r.pos,W=Math.atan2(A.y-L.y,A.x-L.x),U=z instanceof ls.Group;if(U?p=W-r.hitRot:(j=W-r.hitRot,p=r.rotation+j),p%=2*Math.PI,0>p&&(p+=2*Math.PI),!B.Default.isCtrlDown(f)){var C,Z;Vf(f)?(C=F.getStyle("shiftRotateRound"),Z=C/2):(C=F.getStyle("rotateRound"),Z=F.getStyle("rotateSensitivity")),p=ls.roundTo(p,C,Z)}U?(j=p-(r.lastRotation||0),0!==j&&(z.addRotation(j,r.groupRotateMode,function(z){return D.isRotationEditable(z)}),r.lastRotation=p)):z.setRotation(p),F._setRotateCursor(W),p>Math.PI&&(p-=2*Math.PI);var i=180*(p/Math.PI),M=""+i.toFixed(2)+"",Q=B.Default.getLogicalPoint(f,F._canvas);Q.x+=ls.Icons.TipShiftX,Q.y+=ls.Icons.TipShiftY,_.tipInfo={helperPos:Q,text:M,size:M.length},F.fi({kind:"betweenEditRotation",event:f})}},ji.prototype._42=function(L,c,e){var y=this;y._clockPainted=!1,y.info={},y.screenInfo={};var R=y._interactor;R.editDetail||y.gatherInfo(c,e)&&y.isVisible()&&(ls.Icons.DrawIcon(R,L,ls.Icons.RoundPoint,y.screenInfo.POS),y.tipInfo&&ls.Icons.DrawIcon(R,L,ls.Icons.TipHelper,y.tipInfo),y.editing&&y.drawClock(L))},ji.prototype.drawClock=function(Y){Y.save();var V=this;V._clockPainted=!0;var y=V.editing||{},R=y.screenInfo||V.screenInfo,z=R.LEN,l=z+8,v=z+18;Y.save(),Y.translate(R.CENTER.x,R.CENTER.y),Y.beginPath(),Y.strokeStyle="rgb(150, 150, 150)";for(var H,u,d,Q,k,t=0;360>t;t++)H=t*Math.PI/180,0===t%5&&(u=i(H)*z,d=n(H)*z,Q=i(H)*l,k=n(H)*l,Y.moveTo(u,d),Y.lineTo(Q,k)),0===t%45&&(u=i(H)*z,d=n(H)*z,Q=i(H)*v,k=n(H)*v,Y.moveTo(u,d),Y.lineTo(Q,k));Y.stroke(),Y.rotate(-W);var b=y.lastRotation||V.target.getRotation();Y.beginPath(),Y.fillStyle="rgba(255, 0, 0, 0.1)",Y.strokeStyle="rgb(157, 157, 157)",Y.moveTo(0,0),Y.arc(0,0,v,0,b,!1),Y.fill(),Y.beginPath(),Y.moveTo(0+v,0),Y.arc(0,0,v,0,b,!1),Y.stroke(),Y.restore()};var Dk=ls.Curve=function(m){this.catalog="Curve",this._interactor=m};Dk.prototype={},Dk.prototype.constructor=Dk,w.defineProperties(Dk.prototype,{activing:{get:function(){return this._activing},set:function(C){var $=this;if(C)$._activing=new ls.CurveActiving(this,C),$._activing._firePointChange();else{var U=$._activing;U&&U.dispose(),$._activing=null}}}}),Dk.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Dk.prototype.setUp=function(){var d=this,t=d._interactor;t&&t.gv.mp(d._onGraphviewPropertyChanged,d)},Dk.prototype._onGraphviewPropertyChanged=function(j){("zoom"===j.property||"translateX"===j.property||"translateY"===j.property)&&this._handleDataChanged()},Dk.prototype.tearDown=function(){var l=this,e=l._interactor;e&&e.gv.ump(l._onGraphviewPropertyChanged,l)},Dk.prototype.canEnterEditDetailMode=function(){var T=this,E=T._interactor,P=E._getValidSelection();if(1===P.length){var n=P[0],F=n instanceof B.Edge;if(n instanceof B.Shape||F){if(F){var L=n.s("edge.type");if(L&&"points"!==L)return}var R=E.gv;if(R.isPointEditable(n)&&R.isEditable(n))return T.target=n,!0}}},Dk.prototype.canQuitEditDetailMode=function(B){var G=this,s=G._interactor._getLogicalPoint(B);return G._checkEditRealPoint(s)?void 0:G._interactor.gv.getDataAt(B)!==G.target?!0:void 0},Dk.prototype.preHandleScroll=function(){var f=this.editing;return f&&f.inEdit?!0:void 0},Dk.prototype.getCurrentSelectintStatus=function(){var P=this;if(P.activing&&!P.activing.selections){if(P.activing.status!=H)return P.activing.status;var E=function(x){var i=P.activing.status;P.activing.status=x,P._interactor.fp("shapePointStatus",i,x)},X=ls.Curve.PointType,g=P.activing.point,Q=P.activing.pairs;if(!Q||1!==Q.length)return E(X.Mirrored);var O=Q[0],$=O.c1&&O.c1.isNearEnough(g),I=O.c2&&O.c2.isNearEnough(g);if(!O.c1||!O.c2)return $||I?E(X.Straight):E(X.Disconnected);if($&&I)return E(X.Straight);if($||I)return E(X.Asymmetric);var e=O.c1.clone().sub(g),h=O.c2.clone().sub(g);return Math.abs(e.x*h.y-e.y*h.x)>1e-5||e.x*h.x>0?E(X.Disconnected):Math.abs(e.length()-h.length())>1e-5?E(X.Asymmetric):E(X.Mirrored)}},Dk.prototype.handle_keydown=function(E){var n=this;if(n._interactor.editDetail){var X=ls.Curve.PointType;"1"===E.key?n._setCurrentSelectionStatus(X.Straight):"2"===E.key?n._setCurrentSelectionStatus(X.Mirrored):"3"===E.key?n._setCurrentSelectionStatus(X.Disconnected):"4"===E.key&&n._setCurrentSelectionStatus(X.Asymmetric)}},Dk.prototype.setCurrentSelectionStatus=function(L){var D=this,R=D._interactor;if(R){var h=R.gv;h.dm().beginTransaction(),this._setCurrentSelectionStatus(L),h.dm().endTransaction()}},Dk.prototype._setCurrentSelectionStatus=function(F){var Z=this,I=Z.activing;if(I){var S=Z.getCurrentSelectintStatus();if(null!==S&&S!==F){I.status=F;var o=Z.activing.point,K=Z.activing.pairs;if(K&&1===K.length){var b=K[0],u=Z.screenInfo.curve,H=ls.Curve.PointType,x=Z._interactor,Q=function(){Z._writeToHt(),x.fp("shapePointStatus",S,F),Z.check(x.gv,null,new ls.Math.Vector2(x._lastLogicalPoint))};if(F===H.Straight)return u.moveCtrlPoint(b,o,"c1"),u.moveCtrlPoint(b,o,"c2"),Q(),void 0;if(S===H.Straight){var T=u.findPairs(o,!0),c=T[0],y=c.r1||o,U=c.r2||o,Y=U.clone().sub(y).multiplyScalar(.25);return u.moveCtrlPoint(b,o.clone().sub(Y),"c1"),u.moveCtrlPoint(b,o.clone().add(Y),"c2"),Q(),void 0}var D=b.c1,f=b.c2;if(D&&f){if(F===H.Mirrored)return u.moveCtrlPoint(b,o.clone().multiplyScalar(2).sub(f),"c1"),Q(),void 0;if(F===H.Asymmetric&&S===H.Disconnected){var R=D.clone().sub(o).length(),Y=o.clone().sub(f).setLength(R).add(o);return u.moveCtrlPoint(b,Y,"c1"),Q(),void 0}}I._firePointChange(),x.fp("shapePointStatus",S,F),Z.check(x.gv,null,new ls.Math.Vector2(x._lastLogicalPoint))}}}},Dk.prototype._handleDataChanged=function(){var g="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(l){var H=this;if(H.screenInfo&&H.target){if(l&&g.indexOf(l.property)<0)return;var s=H._interactor;H.gatherSingleTarget(s.gv,H.target,!0),H.check(s.gv,null,new ls.Math.Vector2(s._lastLogicalPoint)),s._42()}}}(),Dk.prototype.gatherSingleTarget=function(K,X,Z){var $,s,U=this;U.screenInfo&&U.screenInfo.curve&&(s=U.screenInfo.curve._curves);var c=U.editing;$=c?U.screenInfo:U.screenInfo={};var h,t,i=X instanceof B.Edge;i?(h=X.s("edge.segments"),t=X.s("edge.points")||new B.List):(h=X._58O,t=X._59O),$.S=h;var F,M=$.P=[],Y=ls.getDataMatrix(X);if(X instanceof B.Polyline||X instanceof B.Edge&&U._interactor.getStyle("edgeElevationEditable"))F=X.getElevation&&X.getElevation()||0,$.E=[];else{var l=!1;t.each(function(W){W.e!==H&&(l=!0)}),l&&($.E=[])}if(t.each(function(G){$.E&&$.E.push(G.e!=H?G.e:F),G=Y.apply(G);var O=ls.toScreenPosition(K,G);M.push(O.x,O.y)}),i){var I=M.length,a=ls.toScreenPosition(K,X._lastSourcePoint||(I?{x:M[0],y:M[1]}:{x:0,y:0})),G=ls.toScreenPosition(K,X._lastTargetPoint||(I?{x:M[I-2],y:M[I-1]}:{x:0,y:0}));M.splice(0,0,a.x,a.y),M.push(G.x,G.y),$.E&&($.E.splice(0,0,"head"),$.E.push("tail"))}if(!$.S||!$.S.size()){$.S=new B.List,$.S.add(1);for(var N=0;N<M.length/2-1;N++)$.S.add(2)}if((!c||Z)&&U.convertToCubicBezier(s),U.activing&&(Z||!U.editing||"realPoint"===U.editing.type)){var g=$.curve.findPairs(U.activing.point);U.activing.pairs=g}},Dk.prototype._convertToNewPoint=function(r,Z,c,u){var K,a,D;for(K=0,a=Z.length;a>K;K++){if(D=Z[K],D._p1.isNearEnough(r)&&(!u||u.indexOf(D._p1)<0))return D._p1;if(D._p4.isNearEnough(r)&&(!u||u.indexOf(D._p4)<0))return D._p4}if(c)for(K=0,a=Math.min(c.length,a);a>K;K++){if(D=c[K],D._p1===r&&(!u||u.indexOf(Z[K]._p1)<0))return Z[K]._p1;if(D._p4===r&&(!u||u.indexOf(Z[K]._p4)<0))return Z[K]._p4}},Dk.prototype.convertToCubicBezier=function(F){var O,i,U=this,v=new ls.Math.Curve,J=U.screenInfo;if(v.createFromHtShape(J.P,J.S,J.E),J.curve=v,U.activing){var g=v._curves;O=U.activing.point,i=U._convertToNewPoint(O,g,F);var p=[];if(i&&(U.activing.point=i,p.push(i)),U.activing.selections){var x=-1,c=U.activing.selections;c.forEach(function(e){x++,i=U._convertToNewPoint(e,g,F,p),i&&(c[x]=i,p.push(i))})}}},Dk.prototype.check=function(_,G,c){if(!G||Ih(G)||tm(G)){var W=this;if(W._interactor.setCursor("default"),W.editing=null,W.highlight=null,W.tipInfo=null,W.edgeEditResult=null,W.screenInfo){if(aj()||tm(G))return W._interactor._42(),!0;if(W._checkEditCtrlPoint(c))return W._interactor._42(),!0;if(W._checkEditRealPoint(c))return W._interactor._42(),!0;if(W._checkEditElevation(c))return W._interactor._42(),!0;var I=W.screenInfo.curve,q=I.checkPoint(c,W._interactor.getStyle("curveIntersectSize"));if(q){var X=W.highlight={};X.type="insertKnot",X.bezier=q.bezier,X.point=q.intersection}return W._interactor._42(),!0}}},Dk.prototype._checkEditRealPoint=function(y){var N,l,r,F,k,Y,c=this,p=c.screenInfo.curve._curves,G=c._interactor.getStyle("curvePointIntersectSize"),j=1/0;for(G*=G,r=0,F=p.length;F>r;r++)N=p[r],k=N._p1,Y=y.distanceToSquared(k),j>Y&&(j=Y,l=k),k=N._p4,Y=y.distanceToSquared(k),j>Y&&(j=Y,l=k);if(j>G)return!1;var h=c.highlight={};return h.type="changeRealPoint",h.point=l,c.editing={type:"realPoint",point:l,shiftGuide:{point:l.clone(),dir:"x",limit:0}},c._interactor.setCursor("crosshair"),!0},Dk.prototype._checkEditElevation=function(N){var D=this;if(!D._interactor.getStyle("curveElevationVisible"))return!1;var v=D.target;if(v instanceof B.Edge&&!D._interactor.getStyle("edgeElevationEditable"))return!1;var o=D.activing;if(!o)return!1;var Y=o.getCurrentEditingPoint();if(!Y)return!1;var _=D._interactor,O=_.getStyle("curveElevationGuideShift"),R=_.getStyle("curveElevationIntersectSize"),h=N.distanceToSquared({x:Y.x+O[0],y:Y.y+O[1]});
if(!(h>R*R)){var S=D.highlight={};S.type="elevation";var i=new ls.Math.Vector2(N.x,N.y,Y.e);return D.editing={type:"elevation",startPoint:i},D._interactor.setCursor("crosshair"),!0}},Dk.prototype._checkEditCtrlPoint=function(m){var g=this;if(g.activing&&!g.activing.selections){var n=g.getCurrentSelectintStatus();if(n!==ls.Curve.PointType.Straight){var y=g.activing.pairs;if(y){var w=g._interactor.getStyle("curvePointIntersectSize");w*=w;var C,E,X,S,f,j,q,R,p,K=1/0;for(q=0,p=y.length;p>q;q++)for(S=y[q],R=0;2>R;R++)f=0===R?"c1":"c2",S[f]&&(j=m.distanceToSquared(S[f]),K>j&&(K=j,C=S,E=q,X=f));if(K>w)return!1;g.activing.hlpair=C,g.activing.hltype=X;var k=g.highlight={};return k.type="changeCtrlPoint",k.point=C[X],g.editing={type:"ctrlPoint",pair:C,pairId:E,ctrlType:X,direction:C[X].clone().sub(g.activing.point).normalize()},g._interactor.setCursor("crosshair"),!0}}}},Dk.prototype.startEdit=function(C,o){C.startDragging(o);var U=this;U.highlight&&"insertKnot"===U.highlight.type&&(U.insertKnot(),U.gatherSingleTarget(U._interactor.gv,U.target),U.activing=null,U._checkEditRealPoint(U._interactor._getLogicalPoint(o)));var J=U._activing;if(J){var Q=U.editing?U.editing.type:null;"ctrlPoint"===Q?J.editingCtrl={pairId:U.editing.pairId,type:J.hltype}:"realPoint"===Q&&(J.editingCtrl=!1)}var m=U.highlight,j=B.Default.isCtrlDown(o);if(!m||aj()||tm(o)){var K=U._interactor.gv;if(!K.setFocus(o)||K._scrolling)return;return j?U._multiSelect={startPoint:K.lp(o)}:K.isPannable()&&(Ih(o)||tm(o))&&(U._pan={tx:K.tx(),ty:K.ty()},C.fi({kind:"beginPan",event:o})),void 0}if("changeRealPoint"===m.type){var z,y=U.activing?U.activing.point:null,Z=U.activing?U.activing.selections:null;if(j&&U.activing)y===m.point?(Z?(U.activing={point:Z[0]},Z.length>1&&(Z.splice(0,1),U.activing.selections=Z)):U.activing=null,U.editing=null):Z&&(z=Z.indexOf(m.point))>=0?(Z.length>1?Z.splice(z,1):delete U.activing.selections,U.editing=null):Z?(Z.push(y),U.activing={point:m.point,selections:Z}):U.activing={point:m.point,selections:[y]};else if(Z)y===m.point||((z=Z.indexOf(m.point))>=0?(Z.splice(z,1,y),U.activing={point:m.point,selections:Z}):U.activing={point:m.point});else{var e;y===m.point&&(e=U.activing.status),U.activing={point:m.point},e&&(U.activing.status=e)}C.fi({kind:"beginEditPoint",event:o})}},Dk.prototype.insertKnot=function(){var B=this,S=B.highlight,k=B.screenInfo.curve;k.insertKnot(S.bezier,S.point.t),B._writeToHt()},Dk.prototype._writeToHt=function(){var s,K,d=this,J=d.screenInfo.curve,G=J.toHtShape(),w=G.points,D=[],C=G.segments,P=d._interactor.gv;P.dm().beginTransaction();var x,v,o=d.target,Q=o instanceof B.Edge,t=ls.getDataMatrix(o).invert();v=o instanceof B.Polyline||o instanceof B.Edge&&d._interactor.getStyle("edgeElevationEditable"),v&&(x=o.getElevation&&o.getElevation()||0);for(var m=0,X=w.length;X>m;m++)s=w[m],K=ls.toWorldPosition(P,s),K=t.apply(K),isFinite(s.e)&&s.e!==x&&(K.e=s.e),D.push(K);if(o._writing=!0,Q){o.s("edge.type","points"),o.setStyle("edge.segments",C),o.setStyle("edge.points",D.slice(1,D.length-1)),o.setStyle("edge.source.offset.x",0),o.setStyle("edge.source.offset.y",0),o.setStyle("edge.target.offset.x",0),o.setStyle("edge.target.offset.y",0);var e=d._nextChangeEdgeHost;delete d._nextChangeEdgeHost,e&&("source"===e.type?o.setSource(e.host):o.setTarget(e.host)),d._writeEdgeHostAnchor("source",D[0]),d._writeEdgeHostAnchor("target",D[D.length-1])}else D.length?(o.setSegments(C),o.setPoints(D,!0)):o.removeFromDataModel();P.dm().endTransaction(),delete o._writing},Dk.prototype._writeEdgeHostAnchor=function(m,F){var G=this,p=G.target,f=G._calcHostAnchor(p,m,F);f.index!==H?(p.setStyle("edge."+m+".index",f.index),p.setStyle("edge."+m+".percent",H),p.setStyle("edge."+m+".anchor.x",H),p.setStyle("edge."+m+".anchor.y",H)):f.percent!==H?(p.setStyle("edge."+m+".percent",f.percent),p.setStyle("edge."+m+".index",H),p.setStyle("edge."+m+".anchor.x",H),p.setStyle("edge."+m+".anchor.y",H)):(p.s("edge."+m+".anchor.x",f.x),p.s("edge."+m+".anchor.y",f.y),f.offsetX||f.offsetY?(p.s("edge."+m+".offset.x",f.offsetX),p.s("edge."+m+".offset.y",f.offsetY)):(p.s("edge."+m+".offset.x",0),p.s("edge."+m+".offset.y",0)))},Dk.prototype._calcHostAnchor=function(V,Z,v,C){C||(C="source"===Z?V.getSource():V.getTarget());var j=this._interactor.gv,W=j.calculateAttachPoint(C,v);if(W)return W.info;if($k(C)){var S=j.calculateEdgePosition(C,v);return S}var N=C.getRotation(),H=C.getAnchor();of(C,j)&&(N=0);var $=C.getScale();if(N||$.x<0||$.y<0){var R=C.getMatrix(),U=R.tfi(v),c=C.getSize();return{x:U.x/c.width+H.x,y:U.y/c.height+H.y}}var l=tf(j,C),h={x:(v.x-l.x)/l.width,y:(v.y-l.y)/l.height};return h},Dk.prototype._handlePanning=function(J){var j=this,g=j._pan;if(g){g.started=!0;var b=j._interactor,B=b.gv,Z=b._lastClientPoint,t=zr(J),u=zs(B,t,Z);B.setTranslate(g.tx+u.x,g.ty+u.y),j.gatherSingleTarget(b.gv,j.target),b._42(),b.fi({kind:"betweenPan",event:J})}},Dk.prototype.handleEdit=function(M,t){var N=this,V=N.editing;if(N._pan)return N._handlePanning(t),void 0;if(N._multiSelect)return N._multiSelect.endPoint=M.lp(t),N._interactor.redraw(),void 0;if(V){V.inEdit=!0;var U,a,Z,O=N._interactor._getLogicalPoint(t),X=B.Default.isCtrlDown(t),i=B.Default.isShiftDown(t),E=V.type,o=N.activing;if(N._guideInfo=null,"ctrlPoint"===E&&i){var r=N.editing.direction.clone();U=o.point;var l=r.dot(O.clone().sub(U));O=r.setLength(l).add(U)}else if("ctrlPoint"===E||"realPoint"===E){var r;if("realPoint"===E&&i){var s=N.editing.shiftGuide;a=s.point;var S=Math.abs(O.x-a.x),h=Math.abs(O.y-a.y);S>h&&S>s.limit&&"y"===s.dir&&(s.dir="x"),h>S&&h>s.limit&&"x"===s.dir&&(s.dir="y"),r=s.dir,"x"===r?(O.y=a.y,s.limit=Math.max(s.limit,S)):"y"===r&&(O.x=a.x,s.limit=Math.max(s.limit,h))}var k=N._isEditEdgeSourceTarget();if(k){var c=N._editEdgeSourceTarget(k,O,X);c&&(N.edgeEditResult=c,Z=c.tipText)}else if(!X){var T=N._guidingToEdit(O,r),n="realPoint"===E?N._interactor.gridGuide.findClosest(O,r,!0):null,Q=1/0,w=1/0;n&&(n.x&&(Q=n.x),n.y&&(w=n.y));var W=!1;T&&(T.xList&&(Math.abs(T.x)<=Math.abs(Q)?(W=!0,Q=T.x):delete T.xList),T.yList&&(Math.abs(T.y)<=Math.abs(w)?(W=!0,w=T.y):delete T.yList),W&&(N._guideInfo=T)),isFinite(Q)&&(O.x+=Q),isFinite(w)&&(O.y+=w),W&&(T.v=O)}}var z=N.screenInfo.curve;if("realPoint"===V.type){U=V.point,U.e!==H&&(O.e=U.e),z.moveRealPoint(U,O),V.point=O,N.highlight.point=O;var p=o.status,v=o.selections;if(N.activing={point:O,status:p},v){var L=O.clone().sub(U),I=0;v.forEach(function(k){var y=k.clone().add(L);z.moveRealPoint(k,y),v[I++]=y}),N.activing.selections=v}}else if("ctrlPoint"===V.type){var d=o.pairs,J=d[V.pairId];z.moveCtrlPoint(J,O,V.ctrlType);var Y=o.status,A=ls.Curve.PointType;if((Y===A.Mirrored||Y===A.Asymmetric)&&J.c1&&J.c2){var U=new ls.Math.Vector2(o.point),b="c1"===V.ctrlType?"c2":"c1";if(Y===ls.Curve.PointType.Mirrored)z.moveCtrlPoint(J,U.clone().multiplyScalar(2).sub(O),b);else if(Y===A.Asymmetric){var l=J[b].clone().sub(U).length(),D=U.clone().sub(J[V.ctrlType]).setLength(l).add(U);isNaN(D.x)||z.moveCtrlPoint(J,D,b)}}o._firePointChange()}else if("elevation"===V.type){a=V.startPoint;var C=a.e+(a.y-O.y)/M._zoom;N._setCurrentPointImpl("e",C),o._firePointChange(),Z="E: "+ls.toFixed(C)}var x=B.Default.getLogicalPoint(t,N._interactor._canvas);if(x.x+=ls.Icons.TipShiftX,x.y+=ls.Icons.TipShiftY,!Z){var F=ls.toWorldPosition(M,O);Z=""+ls.toFixed(F.x)+", "+ls.toFixed(F.y)}N.tipInfo={helperPos:x,text:Z,size:Z.length},N._writeToHt(),N._interactor.fi({kind:"betweenEditPoint",event:t})}},Dk.prototype._setCurrentPointImpl=function(u,i){var r=this,L=r._activing;if(!L)return!1;var m=r.target;if(!m)return!1;var B=L.getCurrentEditingPoint();if(!B)return!1;var X=L.editingCtrl;if(!X)var I=B.clone();if("e"===u)B.e=i;else{var M;if("x"===u||"y"===u){var h=L._lastFirePoint;M="x"===u?{x:i,y:h?h.y:0}:{x:h?h.x:0,y:i}}else"object"==typeof u?(M=u,u.e!==H&&(B.e=u.e)):(M={x:arguments[0],y:arguments[1]},arguments[2]!==H&&(B.e=arguments[2]));var Z=ls.getDataMatrix(m);M=ls.toScreenPosition(r._interactor.gv,Z.apply(M)),B.x=M.x,B.y=M.y}if(!X){var z=I.multiplyScalar(-1).add(B);B.e&&I.e&&(z.e=B.e-I.e);var t=r.screenInfo.curve;t.moveCtrlDueToRealPointMovement(B,z);var x=L.selections;if(x){var k=0;x.forEach(function(P){var n=P.clone().add(z);isFinite(z.e)&&(n.e=(isFinite(P.e)?P.e:m.getElevation()||0)+z.e),t.moveRealPoint(P,n),x[k++]=n}),L.selections=x}}return!0},Dk.prototype.setCurrentPoint=function(r,V){return this._setCurrentPointImpl(r,V)?(this._writeToHt(),!0):!1},Dk.prototype._isEditEdgeSourceTarget=function(){var X=this,r=X.target;if(!(r instanceof B.Edge))return!1;var e=X.editing.point,v=X.screenInfo.curve._curves;return e===v[0]._p1?"source":e===v[v.length-1]._p4?"target":!1},Dk.prototype._editEdgeSourceTarget=function(R,l,t){var n,s=this,X=s.target;if(n="source"===R?X.getSource():X.getTarget()){var D,Y=s._interactor.gv,y=ls.toWorldPosition(Y,l),I=s._calcHostAnchor(X,R,y,n);if(D=I.index!==H||I.percent!==H?I.distance*Y.getZoom()>s._interactor.getStyle("edgeHostEdgeMaxDistance"):s._interactor.getStyle("edgeHostDetectPerFrame")?!0:I.x<0||I.x>1||I.y<0||I.y>1?!0:!1){var K=Y.getDataAt(y,function(Q){return Y.isSelectable(Q)?Y.isSourceTargetEditable(X,Q,R)?X.canSetSourceTarget(Q,R)?!0:!1:!1:!1});if(K){var L=s._calcHostAnchor(X,R,y,K);n=K,s._nextChangeEdgeHost={type:R,host:K},I=L}}var v,P,c;if(t||I.x===H)(I.percent!==H||I.index!==H)&&(P=I.point);else{var Q=s._interactor.getStyle("anchorRound"),J=s._interactor.getStyle("anchorSensitivity");v=Y.calculateAttachPoint(n,y),v?I=v.info:(I.x=ls.roundTo(I.x,Q,J),I.y=ls.roundTo(I.y,Q,J)),P=go(Y,n,0,I.offsetX||0,I.offsetY||0,I.x,I.y)}P&&(c=ls.toScreenPosition(Y,P),l.x=c.x,l.y=c.y),s._edgeHostGuideInfo={corners:ls.getTargetCornersOnScreen(Y,n),attach:v?v.index:-1,host:n};var z;return I.percent!==H?z="percent: "+I.percent.toFixed(2):I.index!==H?z="index: "+I.index:(z=""+I.x.toFixed(2)+", "+I.y.toFixed(2),(I.offsetX||I.offsetY)&&(z+=" offset: "+I.offsetX.toFixed(2)+", "+I.offsetY.toFixed(2))),{host:n,anchor:I,tipText:z}}},Dk.prototype._guidingToEdit=function(v,N){var K,t,J=this;if(K=J.screenInfo.curve){t=K._curves;var X,m,r,p,i,l,W,n,U=1/0,C=1/0,Z=[];for(J.editing&&"realPoint"===J.editing.type&&(n=J.editing.point),i=0,l=2*t.length;l>i;i++)W=t[Math.floor(i/2)][i%2?"_p4":"_p1"],Z.indexOf(W)>=0||(Z.push(W),n&&n===W||(r=W.x-v.x,p=W.y-v.y,Math.abs(r)<Math.abs(U)?(U=r,X=[W]):r===U&&X.push(W),Math.abs(p)<Math.abs(C)?(C=p,m=[W]):p===C&&m.push(W)));var z=J._interactor.getStyle("smartGuideThreshold");if((Math.abs(U)>z||"y"===N)&&(X=null),(Math.abs(C)>z||"x"===N)&&(m=null),X||m){var S=!1,h={};if(X&&(S=!0,h.xList=X,h.x=U),m&&(S=!0,h.yList=m,h.y=C),S)return h}}},Dk.prototype._46O=function(L){var O=this;O.editing&&(O.editing=null,O._interactor.fi({kind:"endEditPoint",event:L})),O._guideInfo=null,O._edgeHostGuideInfo=null,O._pan&&(O._pan=null,O._interactor.fi({kind:"endPan",event:L})),O._multiSelect&&(O._handleMultiSelect(O._multiSelect),O._multiSelect=null),O.tipInfo=null,O.edgeEditResult=null},Dk.prototype._handleMultiSelect=function(z){if(z.startPoint&&z.endPoint){var U,s,S,V,K,x=this,p=x._interactor,w=p.gv,J=ls.toScreenPosition(w,z.startPoint),Z=ls.toScreenPosition(w,z.endPoint),X=B.Default.unionPoint(J,Z),$=x.screenInfo.curve._curves,D=[],m=function(x){x.x>=X.x&&x.y>=X.y&&x.x<=X.x+X.width&&x.y<=X.y+X.height&&D.indexOf(x)<0&&D.push(x)};for(U=0,s=$.length;s>U;U++)K=$[U],m(K._p1),m(K._p4);if(D.length){var i=x.activing||{},a=i.selections||[];for(i.point&&a.push(i.point),U=0,s=a.length;s>U;U++)S=a[U],V=D.indexOf(S),V>=0?D[V]=H:D.push(S);var E=D;for(D=[],U=0,s=E.length;s>U;U++)E[U]&&D.push(E[U]);s=D.length,0===s?x.activing=null:1===s?x.activing={point:D[0]}:(S=D[s-1],x.activing={point:S,selections:D.splice(0,s-1)}),p.redraw()}}},Dk.prototype._canDeletePoint=function(R,j){var c=this.target;if(!(c instanceof B.Edge))return!0;var h=R._curves[0],o=R._curves[R._curves.length-1];return h._p1===j||o._p4===j?!1:!0},Dk.prototype.handleDelete=function(){var u=this;if(u.activing&&u.screenInfo){var A=B.Default.isShiftDown(),x=u.screenInfo.curve;u._canDeletePoint(x,u.activing.point)&&x.deleteRealPoint(u.activing.point,A),u.activing.selections&&u.activing.selections.forEach(function(d){u._canDeletePoint(x,d)&&x.deleteRealPoint(d,A)}),u.activing=null,delete u.editing,delete u.tipInfo,delete u.edgeEditResult,delete u._pan,delete u._multiSelect,u._writeToHt(),u._interactor.fp("deleteShapePoint",!1,!0)}},Dk.prototype.handleDoubleClick=function(g){var k=this,d=k._interactor._getLogicalPoint(g);if(k.screenInfo&&k._checkEditRealPoint(d)){var j=k.getCurrentSelectintStatus(),N=ls.Curve.PointType;return j=j===N.Mirrored?N.Straight:N.Mirrored,k._setCurrentSelectionStatus(j),k._interactor._42(),!0}},Dk.prototype._drawHighlight=function(k){var Y=this,g=Y.highlight;if(g){var x=g.bezier,m=Y._interactor;x&&ls.Icons.DrawIcon(m,k,ls.Icons.ShapeHighlightCurve,[x._p1.x,x._p1.y,x._p2.x,x._p2.y,x._p3.x,x._p3.y,x._p4.x,x._p4.y]);var L=g.point;L&&"insertKnot"===g.type&&ls.Icons.DrawIcon(m,k,ls.Icons.ShapeHighlighPoint,L)}},Dk.prototype._drawGuide=function(l){var I=this,u=I._guideInfo;if(u){var k,F,S,W,O=u.v;for(k=0;2>k;k++)if(W=0===k?u.xList:u.yList)for(F=0,S=W.length;S>F;F++)ls.Icons.DrawIcon(I._interactor,l,ls.Icons.ShapeGuideLine,[O.x,O.y,W[F].x,W[F].y])}},Dk.prototype._drawCurrentPoint=function(s){var N=this;if(N.activing){var H=N.activing,y=N.getCurrentSelectintStatus(),C=N._interactor;if(y!==ls.Curve.PointType.Straight){var K=H.pairs;H.hlpair,H.hltype;var E=H.selections,B=H.editingCtrl;if(K&&!E){var v,O,z;for(O=0,z=K.length;z>O;O++)v=K[O],B&&O===B.pairId&&v[B.type]?ls.Icons.DrawIcon(C,s,ls.Icons.ShapeActivingCtrl,{point:v.point,c1:v.c1,c2:v.c2,hl:B.type}):ls.Icons.DrawIcon(C,s,ls.Icons.ShapeActivingCtrl,v)}}ls.Icons.DrawIcon(C,s,ls.Icons.ShapeHighlighRealPoint,N.activing.point),E&&E.forEach(function(K){ls.Icons.DrawIcon(C,s,ls.Icons.ShapeHighlighRealPoint,K)})}},Dk.prototype.clear=function(){var b=this;b.editing=null,b._guideInfo=null,b.activing=null,b.highlight=null},Dk.prototype._42=function(G){var O=this;O.info={},O.editing||(O.screenInfo=null);var P=O._interactor;if(!P.editDetail)return O.clear(),void 0;var A=P.gv;if(!O.target||!A.isSelected(O.target)||!A.isVisible(O.target))return P.editDetail=!1,O.clear(),void 0;if(O.gatherSingleTarget(A,O.target),ls.Icons.DrawIcon(P,G,ls.Icons.ShapeBgCurve,O.screenInfo),O._interactor.getStyle("curveElevationVisible")&&(O.target instanceof B.Polyline||O.target instanceof B.Edge&&O._interactor.getStyle("edgeElevationEditable"))&&O.activing){var q=O.activing.getCurrentEditingPoint();q&&"string"!=typeof q.e&&ls.Icons.DrawIcon(P,G,ls.Icons.EdgeElevationGuide,q)}if(O._drawHighlight(G),O._drawCurrentPoint(G),O._getRealPoint().forEach(function(F){ls.Icons.DrawIcon(P,G,ls.Icons.ShapePoint,F)}),O._drawGuide(G),O.tipInfo&&O._interactor.getStyle("curveTipVisible")&&ls.Icons.DrawIcon(P,G,ls.Icons.TipHelper,O.tipInfo),O._edgeHostGuideInfo&&P._drawHostGuide(O._edgeHostGuideInfo),O.edgeEditResult&&O._drawEdgeHostHighlight(G,O.edgeEditResult.host,O.edgeEditResult.anchor),O._multiSelect&&O._multiSelect.endPoint){var z=B.Default.unionPoint(ls.toScreenPosition(A,O._multiSelect.startPoint),ls.toScreenPosition(A,O._multiSelect.endPoint));z.color=A.getRectSelectBorderColor(),G.save(),G.setTransform(1,0,0,1,0,0);var H=M.devicePixelRatio,v=z.borderWidth=Math.round(H);v/=2,z.x=Math.round(z.x*H)+v,z.y=Math.round(z.y*H)+v,z.width=Math.round(z.width*H),z.height=Math.round(z.height*H),ls.Icons.DrawIcon(P,G,ls.Icons.SimpleRect,z),G.restore()}},Dk.prototype._drawEdgeHostHighlight=function(E,M,T){this.drawEdgeHostHighlight(E,M,T),this._interactor.redraw()},Dk.prototype.drawEdgeHostHighlight=function(K,z,y){if($k(z)){var Y,G,m,t,O=this,s=O._interactor,d=s.gv,I=d.getDataUI(z),F=Ej(I),Q=[];for(m=0,t=F.points.length;t>m;m++)G=ls.toScreenPosition(d,F.points.get(m)),Q.push(G.x,G.y);F.segments&&(Y=F.segments.toArray());var h=s.getStyle("edgeHostHighlighPeriod"),C=s.getStyle("edgeHostEdgeHighlighColor");ls.Icons.DrawIcon(s,K,ls.Icons.ShapeBgCurve,{P:Q,S:Y,color:C,dynamicVisible:y.index===H,dynamicPeriod:h}),C=s.getStyle("edgeHostPointHighlighColor");var b=Bl(I);for(m=0,t=b.length;t>m;m++){var P=b[m],_=ls.toScreenPosition(d,P);ls.Icons.DrawIcon(s,K,ls.Icons.ShapePoint,{point:{x:_.x,y:_.y},color:C,size:12,dynamicVisible:m===y.index,dynamicPeriod:h})}}},Dk.prototype._getRealPoint=function(){var u,$=this.screenInfo,c=$.P,O=$.S,k=-1,Z=[],D=-1,y=O.length;return O.each(function(o){D++;var r=1;if(3===o)r=2;else if(4===o)r=3;else if(5===o)return;k+=r,u=D+1>=y?!0:1===O.get(D+1)?!0:!1,Z.push({point:{x:c[2*k],y:c[2*k+1]},segmentIndex:D,pointIndex:k,isEnd:u})}),Z},Dk.prototype.getEditingPointsInfo=function(v){var F=this,G=F.activing;if(!G)return!1;var t=G.point;if(!t)return!1;var T=this._getRealPoint(),$=[{screen:t}];G.selections&&G.selections.forEach(function(N){$.push({screen:N})});var d,H,P=T.length;return $.forEach(function(G){for(d=0;P>d;d++)if(H=T[d],G.screen.isNearEnough(H.point)){G.segmentIndex=H.segmentIndex,G.pointIndex=H.pointIndex,G.point=F.target.getPoints().get(H.pointIndex);break}}),v&&$.sort(function(E,O){return E.segmentIndex-O.segmentIndex}),$};var zo=ls.MoveHelper=function(l){var $=this;$.catalog="Move",$._interactor=l};zo.prototype={},zo.prototype.constructor=zo,zo.prototype.calcShift=function(I,$,l){var A,w,R=this,G=R._interactor.gv,m=G.lp($);if("beginMove"===I&&R._gatherGridInfo(l._lastLogicalPoint||m),A=R._target){var V=A.downPosition;if(V){var Q=R._interactor.getStyle("moveSensitivity")/G._zoom;if(V.distanceTo(m)<Q)return{x:0,y:0};delete A.downPosition}var v;w=B.Default.isShiftDown($),w&&(m=R._dealShiftDown(m),v=A.shiftGuide.dir);var i,C=A.rawPos={x:A.pos.x+m.x-A.lp.x,y:A.pos.y+m.y-A.lp.y};if(B.Default.isCtrlDown($)){if(i=R._calcShiftByAddon(),R._target.node instanceof ls.Group){var M=R._target.node;M._position.x+=i.x,M._position.y+=i.y}return i}var L=R._interactor.rectGuide;if(A.node instanceof B.Data&&A.node.s("2d.attachable")){var h=R._calcAttachNodeShift(A.node,C);if(L.clear(),h)return h}for(var t,k=A.x+C.x,S=A.y+C.y,o={x:k,y:S},N={x:k+A.w/2,y:S+A.h/2},O={x:k+A.w,y:S+A.h},F=R._interactor.gridGuide,r=[L.findClosest(o,v),L.findClosest(N,v),L.findClosest(O,v),F.findClosest(o,v),F.findClosest(N,v),F.findClosest(O,v)],_=1/0,D=1/0,x=0,W=r.length;W>x;x++)t=r[x],t&&(k=t.x,S=t.y,isFinite(k)&&Math.abs(k)<Math.abs(_)&&(_=k),isFinite(S)&&Math.abs(S)<Math.abs(D)&&(D=S));if(isFinite(_)||(_=0),isFinite(D)||(D=0),i=R._calcShiftByAddon(_,D),R._target.node instanceof ls.Group){var M=R._target.node;M._position.x+=i.x,M._position.y+=i.y}var s=A.node;if(!of(s,G)){var T=C.x+_,d=C.y+D;R._interactor.rectGuide.gatherLines({node:s,x:A.x+T,y:A.y+d,w:A.w,h:A.h},v)}return i}},zo.prototype._calcShiftByAddon=function(N,j){var E=this._target,_=E.rawPos,L=E.node.getPosition();return N=N||0,j=j||0,{x:_.x-L.x+N,y:_.y-L.y+j}},zo.prototype._dealShiftDown=function(Q){var R=this,b=R._target.shiftGuide,$=R._target.lp,P=Math.abs(Q.x-$.x),q=Math.abs(Q.y-$.y);P>q&&P>b.limit&&"y"===b.dir&&(b.dir="x"),q>P&&q>b.limit&&"x"===b.dir&&(b.dir="y");var W=b.dir;return"x"===W?(Q.y=$.y,b.limit=Math.max(b.limit,P)):"y"===W&&(Q.x=$.x,b.limit=Math.max(b.limit,q)),Q},zo.prototype._isAttachableLineShape=function(i){if(!i.getSegments)return!1;var r=i.getSegments();if(!r)return!0;r instanceof B.List&&(r=r.getArray());for(var u=1,x=r.length;x>u;u++)if(2!==r[u])return!1;return!0},zo.prototype._calcAttachNodeShift=function(){var t=new zb,l=new zb,S=new zb,j=new zb;return function(_,Z){var n=this._interactor.gv,V=_.getHost(),B=n.getDataAt(Z,function(m){return m.s("2d.hostable")?!0:!1});if(B&&V!==B&&_.setHost(B),!B)return this._edgeHostGuideInfo=null,_.setHost(null);var m=this._edgeHostGuideInfo={corners:ls.getTargetCornersOnScreen(n,B),host:B,attach:-1};if(this._isAttachableLineShape(B)){for(var q,F,T,I,f,P,s=B.getPoints(),L=s.size(),r=B.getPointsMatrix2d(),O=1/0,K=0;L>K&&(K!==L-1||B.isClosePath());K++)0!==K?l.copy(S):r.apply(s.get(K),l),r.apply(K===L-1?s.get(0):s.get(K+1),S),t.copy(Z).sub(l),j.copy(S).sub(l),q=j.length(),j.divideScalar(q),F=t.dot(j),0>F?F=0:F>q&&(F=q),j.multiplyScalar(F).add(l),T=t.copy(Z).sub(j).lengthSq(),O>T&&(O=T,P=K,I=F,f=q);return Math.sqrt(O)*n.getZoom()>this._interactor.getStyle("attachThreshold")?(_.s({"attach.index":-1}),_.setHost(null),void 0):(_.s("attach.offset.opposite")&&(I=f-I),_.s({"attach.index":P,"attach.offset":_.s("attach.offset.relative")?I/f:I}),{x:0,y:0})}var J=n.calculateAttachPoint(B,Z);if(J){var x=J.point;return m.attach=J.index,this._calcShiftByAddon(x.x-Z.x,x.y-Z.y)}}}(),zo.prototype._gatherGridInfo=function(B){var p,k=this,z=k._interactor,i=z._getValidSelection();if(i.length){if(1===i.length){if(p=i[0],!p.getRect)return k._target=null,void 0}else if(p=ls.Group.findOrCreateGroup(i),!p)return k._target=null,void 0}else{var i=z.gv.sm().getSelection();if(i.length&&(p=i.get(0),!p.getRect))return k._target=null,void 0}if(p){var d=p.getPosition(),E=p.getRect();k._target={node:p,x:E.x-d.x,y:E.y-d.y,w:E.width,h:E.height,lp:{x:B.x,y:B.y},pos:{x:d.x,y:d.y},shiftGuide:{dir:"x",limit:0},downPosition:new ls.Math.Vector2(B)},z.rectGuide.gatherRects()}},zo.prototype.clear=function(){var H=this;H._edgeHostGuideInfo=null,H._interactor.rectGuide.clear(),H._interactor._42()},zo.prototype._42=function(){var Y=this._edgeHostGuideInfo;Y&&this._interactor._drawHostGuide(Y)};var xm="directional",Fk="point",en="spot",ef="light.color",Gj={},Mj=function(I,M){Fc(M)&&ks.test(M)?Tc(I,M):zh(M)&&M.modelType?xe(I,M):M===H?delete vr[I]:vr[I]=M},wb=function(G){return G},Jm=function(z){z=V.convertShape3dModelName(z);var p;if(zh(z)){if(z.modelType){if(z.uuid){if(p=vr[z.uuid])return p}else z.uuid=B.Math.generateUUID();return xe(z.uuid,z),H}return z}return p=vr[z],z&&p===H&&ks.test(z)&&(bf&&bf[z]||Tc(z,z)),p},gd=function(s,c){s.frameStack?s.frameStack.push(c):s.frameStack=[c],s.bindFramebuffer(s.FRAMEBUFFER,c)},Id=function(z){var e=z.frameStack;if(e){if(e.pop(),e.length)return z.bindFramebuffer(z.FRAMEBUFFER,e[e.length-1]),void 0;z.frameStack=null}z.bindFramebuffer(z.FRAMEBUFFER,null)};vl(V,{graph3dViewAttributes:R,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:e/60,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:on,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewMaxPhi:e,graph3dViewMinPhi:0,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:e/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,setShape3dModel:Mj,getShape3dModel:Jm,convertShape3dModelName:wb,getShape3dModelMap:function(){return vr},getCachedShape3dModelMap:function(){return vf},createMatrix:function(w,T){hd(w)||(w=[w]);for(var W=w.length-1;W>=0;W--){var G=w[W];T=jk(G.mat,G.s3,G.r3,G.rotationMode,G.t3,T)}return T},transformVec:function(k,v){return dm(k,v)},glBindFrame:gd,glUnbindFrame:Id,createBoxModel:function(){return{vs:Tg,ns:lf,uv:Bp,is:Gb}},createRoundRectModel:function(J,Z){return Sc.roundRect(J,Z)},createStarModel:function($,x){return Sc.star($,x)},createRectModel:function(Z,h){return Sc.rect(Z,h)},createTriangleModel:function(v,O){return Sc.triangle(v,O)},createRightTriangleModel:function(B,y){return Sc.rightTriangle(B,y)},createParallelogramModel:function(v,F){return Sc.parallelogram(v,F)},createTrapezoidModel:function(d,u){return Sc.trapezoid(d,u)},createSmoothSphereModel:function(C,h,i,B,A,G,j){return Ib(new Ur(C,h,i,B,A,G,j))},createSphereModel:function(A,E,M,B,u,b,e){return A?Qe(A,E,M,B,u,b,e):V.createSmoothSphereModel()},createSmoothConeModel:function(T,m,o,b,L){return El(T,m,o,b,L)},createConeModel:function(r,Q,M,D,Z,J){return r?Ub(r,Q,M,D,Z,J):El(J)},createSmoothCylinderModel:function(_,W,O,d,c,Q,f,R){return Ib(new Wq(_,W,O,d,c,Q,f,R))},createCylinderModel:function(M,Q,h,P,R,G,I,b){return M?Rp(M,Q,h,P,R,G,I,b):Qk(G,I)},createSmoothTorusModel:function(c,Q,M,r,Y,s){return Ib(new yh(c,Q,M,r,Y,s))},createTorusModel:function(C,Q,y,m,q,k,r,X){return C?Gf(C,Q,y,m,q,k,r,X):Rc(k,r)},createExtrusionModel:function(V,w,P,S,s,d,r,C){return vm(V,w,P,S,s,d,r,C)},createSmoothRingModel:function(X,c,I,r,C,G){for(var Z=[],S=0;S<X.length-1;S+=2)Z.push({x:X[S],y:X[S+1]});for(X=ed(Z,c,I)[0],Z=[],S=0;S<X.length;S++){var V=X[S];Z.push(new Rh(V.x,0,V.y))}return Ib(new Fm(Z,G,r,C))},createTextGeometry:function(j,x){return Ib(new eo(j,x))},loadFontFace:function(i,J){V.xhrLoad(i,function(A){if(!A)return J();var $;try{$=JSON.parse(A)}catch(S){$=JSON.parse(A.substring(65,A.length-2))}Db.loadFace($),J&&J($.familyName.toLowerCase())},J?null:{sync:!0})},createRingModel:function(w,p,W,Z,j,F,s,G,a,m){for(var o=[],Y=0;Y<w.length-1;Y+=2)o.push({x:w[Y],y:w[Y+1]});F=F||V.shapeSide,s=s||0,G=G||F;var x,C,r,T,J,E,U,y,B,M,Y,P,h,$,k,c,H,D,X=[],z=[],t=a?[]:R,d=a?[]:R,L=m?[]:R,u=m?[]:R,f=Z?[]:R,N=Z?[]:R,g=j?[]:R,S=j?[]:R,w=ed(o,p,W),I=kn(w),l=0,A=2*Math.PI/F;return w.forEach(function(W){if(r=W.length,r>1){if(T=W[0],Z)for(E=T.x,y=T.y,Y=s;G>Y;Y++)P=Y+1,h=Y*A,$=P*A,k=i(h),c=n(h),H=i($),D=n($),f.push(k*E,y,-c*E,H*E,y,-D*E,0,y,0),N.push(.5-.5*k,.5-.5*c,.5-.5*H,.5-.5*D,.5,.5);for(M=0;r>M;M++){for(J=W[M],E=T.x,U=J.x,y=T.y,B=J.y,x=l/I,l+=Wj(T,J),C=l/I,Y=s;G>Y;Y++)P=Y+1,h=Y*A,$=P*A,k=i(h),c=n(h),H=i($),D=n($),X.push(k*U,B,-c*U,H*U,B,-D*U,k*E,y,-c*E,H*U,B,-D*U,H*E,y,-D*E,k*E,y,-c*E),z.push(Y/F,C,P/F,C,Y/F,x,P/F,C,P/F,x,Y/F,x),a&&Y===s&&(t.push(0,y,0,0,B,0,k*U,B,-c*U,k*U,B,-c*U,k*E,y,-c*E,0,y,0),d.push(0,.5-y,0,.5-B,2*U,.5-B,2*U,.5-B,2*E,.5-y,0,.5-y)),m&&P===G&&(L.push(0,y,0,H*U,B,-D*U,0,B,0,H*U,B,-D*U,0,y,0,H*E,y,-D*E),u.push(1,.5-y,1-2*U,.5-B,1,.5-B,1-2*U,.5-B,1,.5-y,1-2*E,.5-y));T=J}if(j)for(E=T.x,y=T.y,Y=s;G>Y;Y++)P=Y+1,h=Y*A,$=P*A,k=i(h),c=n(h),H=i($),D=n($),g.push(H*E,y,-D*E,k*E,y,-c*E,0,y,0),S.push(.5-.5*H,.5+.5*D,.5-.5*k,.5+.5*c,.5,.5)}}),{vs:X,uv:z,bottom_vs:g,bottom_uv:S,top_vs:f,top_uv:N,from_vs:t,from_uv:d,to_vs:L,to_uv:u}}},!0),vl(v,{"3d.move.mode":H,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"shape.border.gradient.color":H,"edge.gradient.color":H,"edge.source.t3":H,"edge.target.t3":H,"light.type":Fk,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":e/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":Of,"wf.short":!1,"wf.mat":H,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:H,"transparent.mask":!1,brightness:H,"select.brightness":.7,"repeat.uv.length":H,envmap:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,alwaysOnTop:!1,"texture.cache":!1,"hide.overlapping.group":H,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"label.face":ck,"label.t3":H,"label.r3":H,"label.texture.scale":2,"label.rotationMode":Eg,"label.light":!1,"label.blend":H,"label.reverse.flip":!1,"label.reverse.color":Di,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":ck,"label2.t3":H,"label2.r3":H,"label2.texture.scale":2,"label2.rotationMode":Eg,"label2.light":!1,"label2.blend":H,"label2.reverse.flip":!1,"label2.reverse.color":Di,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":ck,"note.t3":H,"note.r3":H,"note.texture.scale":2,"note.rotationMode":Eg,"note.light":!1,"note.blend":H,"note.reverse.flip":!1,"note.reverse.color":Di,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":ck,"note2.t3":H,"note2.r3":H,"note2.texture.scale":2,"note2.rotationMode":Eg,"note2.light":!1,"note2.blend":H,"note2.reverse.flip":!1,"note2.reverse.color":Di,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:H,"shape3d.color":Xq,"shape3d.top.color":H,"shape3d.bottom.color":H,"shape3d.from.color":H,"shape3d.to.color":H,"shape3d.image":H,"shape3d.top.image":H,"shape3d.bottom.image":H,"shape3d.from.image":H,"shape3d.to.image":H,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":H,"shape3d.side.to":H,"shape3d.smooth":H,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":H,"shape3d.opacity":H,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Di,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":H,"shape3d.uv.scale":H,"shape3d.top.uv.offset":H,"shape3d.top.uv.scale":H,"shape3d.bottom.uv.offset":H,"shape3d.bottom.uv.scale":H,"shape3d.from.uv.offset":H,"shape3d.from.uv.scale":H,"shape3d.to.uv.offset":H,"shape3d.to.uv.scale":H,"shape3d.top.cap":H,"shape3d.bottom.cap":H,"shape3d.start.angle":0,"shape3d.sweep.angle":b,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":!1,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"shape3d.vector.dynamic":!1,"shape3d.texture.scale":1,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.clip":.003,"texture.mipmap.max":H,"texture.filter":H,"texture.filter.min":H,"texture.filter.mag":H,"all.light":!0,"all.visible":!0,"all.color":Xq,"all.image":H,"all.blend":H,"all.opacity":H,"all.reverse.flip":!1,"all.reverse.color":Di,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":H,"all.uv.offset":H,"all.uv.scale":H,"all.discard.selectable":!0,mat:H,"left.mat":H,"right.mat":H,"top.mat":H,"bottom.mat":H,"front.mat":H,"back.mat":H},!0);var Pk,Lc=!1,Ko=[0,0,0,0],Jk={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:_c,2:vk,3:gf,4:fm,5:ck,6:ej}},Sd=function(E,A,u,y){if(A.getFaceVisible(E,u)){var Q=Od(E,A.getFaceMat(E,u)||A.getMat(E));E.appendAnchorMatrix3d(Q),fe(A,Q);var t=A._26I;A.getFaceReverseCull(E,u)?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),ws(t,A._prg.uFixPickReverseColor,Jk[u]),wc(t),Hd(t,y,6),Le(t),uk(A)}},po=function(I){return I instanceof Fh},rp=function(R){return[R.x,R.e||0,R.y]},we=function(B,K,y){for(var K=Rb(K),X=K[0],l=K[1],W=K[2];y--;)B.push(X,l,W)},_g=function($,C,w){for(var C=Rb(C),M=C[0],p=C[1],E=C[2],W=C[3];w--;)$.push(M,p,E,W)},Ti=function(c,X,i){if(X)for(var H,J,Y,P=X[0],h=X[1],O=X[2],B=X[4],z=X[5],$=X[6],R=X[8],k=X[9],s=X[10],p=X[12],Z=X[13],b=X[14],l=i.length,T=0,T=0;l>T;T+=3)H=i[T],J=i[T+1],Y=i[T+2],c.push(P*H+B*J+R*Y+p,h*H+z*J+k*Y+Z,O*H+$*J+s*Y+b);else Io(c,i)},Ck=function(W,a){var d=a.s("light.intensity"),L=Rb(a.s(ef)),c=L[0],O=L[1],p=L[2];1!==d&&(c*=d,O*=d,p*=d),W.push(c,O,p,a.s("light.disabled")?1:0)},ep=function(N,q,X){ws(q,X.uHeadlightRange,N._headlightRange),ws(q,X.uHeadlightAmbientIntensity,N._headlightAmbientIntensity);var y=N._headlightIntensity,w=Rb(N._headlightColor);1!==y&&(w=[w[0]*y,w[1]*y,w[2]*y]),ws(q,X.uHeadlightColor,[w[0],w[1],w[2],N._headlightDisabled?1:0]);var r=N._59O,h=N._spots,t=N._dirs;if(r.length){var l=[],Y=[],E=[];r.forEach(function(B){Ck(l,B),Io(Y,N._transformPointToViewSpace(B.p3())),E.push(B.s("light.range"))
}),q.uniform4fv(X.uPointColor,l),q.uniform1fv(X.uPointRange,E),q.uniform3fv(X.uPointPosition,Y)}if(h.length){var U=[],d=[],a=[],G=[],W=[],C=[];h.forEach(function(D){Ck(U,D),Io(d,N._transformPointToViewSpace(D.p3())),Io(W,N._transformDirectionToViewSpace(D.p3(),D.s("light.center"))),a.push(D.s("light.range")),G.push(i(D.s("light.angle")/2)),C.push(D.s("light.exponent"))}),q.uniform4fv(X.uSpotColor,U),q.uniform1fv(X.uSpotRange,a),q.uniform1fv(X.uSpotAngle,G),q.uniform1fv(X.uSpotExponent,C),q.uniform3fv(X.uSpotPosition,d),q.uniform3fv(X.uSpotDirection,W)}if(t.length){var p=[],c=[];t.forEach(function(j){Ck(p,j),Io(c,N._transformDirectionToViewSpace(j.p3()))}),q.uniform4fv(X.uDirColor,p),q.uniform3fv(X.uDirDirection,c)}},ti=function(v){return Math.max(V.graph3dViewMinPhi+no,Math.min(V.graph3dViewMaxPhi-no,v))},vq=function(){return.05+p()/2},xg=function(U,G,H,L){var u,F=U.getEye();return U.isOrtho()?(u=Ed(U.getCenter(),F),u[0]+=L[0],u[1]+=L[1],u[2]+=L[2]):u=F,Ne(G,H,L,u)},Ne=function(Q,S,i,O){var Z=He(Q,S),p=Ed(O,i,!0),t=He(p,S);if(q(t)<no)return R;var r=(Z-He(i,S))/t;return[i[0]+p[0]*r,i[1]+p[1]*r,i[2]+p[2]*r]},Yj=function(G,H){return{x:2*G.x-H.x,y:2*G.y-H.y}},No=function(d,l,w,p){var f,M;if(!d)return f=F(l.y-w.y,w.x-l.x),{x:l.x+p*n(f),y:l.y+p*i(f)};if(!w)return f=F(d.y-l.y,l.x-d.x),{x:l.x+p*n(f),y:l.y+p*i(f)};var A=Ed([d.x,d.y,0],[l.x,l.y,0],!0),$=Ed([w.x,w.y,0],[l.x,l.y,0],!0),S=-(A[0]+$[0])/2,X=-(A[1]+$[1])/2,G=y(S*S+X*X);if(no>G)return f=F(d.y-l.y,l.x-d.x),{x:l.x+p*n(f),y:l.y+p*i(f)};var _=d.x-l.x,J=d.y-l.y,m=w.x-l.x,z=w.y-l.y,b=y(_*_+J*J),v=y(m*m+z*z);f=g(He(A,$))/2,M=A[1]*$[0]-A[0]*$[1]>0?-1:1,S/=G,X/=G;var C=p/n(f),I=D(b,v)/i(f);G=Math.min(C,I);var u={x:l.x+M*G*S,y:l.y+M*G*X};return w.b&&C>v/i(f)&&(u.adjust=!0),u},to=function(w){var F=w[1],H=w[2],b=w[3],f=w[6],N=w[7],A=w[11];w[1]=w[4],w[2]=w[8],w[3]=w[12],w[4]=F,w[6]=w[9],w[7]=w[13],w[8]=H,w[9]=f,w[11]=w[14],w[12]=b,w[13]=N,w[14]=A},Ge=function(p){var s=p[0],L=p[1],l=p[2],Y=p[3],X=p[4],V=p[5],w=p[6],o=p[7],$=p[8],F=p[9],y=p[10],P=p[11],G=p[12],r=p[13],d=p[14],Z=p[15],m=s*V-L*X,j=s*w-l*X,h=s*o-Y*X,I=L*w-l*V,A=L*o-Y*V,k=l*o-Y*w,f=$*r-F*G,C=$*d-y*G,g=$*Z-P*G,b=F*d-y*r,B=F*Z-P*r,U=y*Z-P*d,W=m*U-j*B+h*b+I*g-A*C+k*f;return W?(W=1/W,p[0]=(V*U-w*B+o*b)*W,p[1]=(l*B-L*U-Y*b)*W,p[2]=(r*k-d*A+Z*I)*W,p[3]=(y*A-F*k-P*I)*W,p[4]=(w*g-X*U-o*C)*W,p[5]=(s*U-l*g+Y*C)*W,p[6]=(d*h-G*k-Z*j)*W,p[7]=($*k-y*h+P*j)*W,p[8]=(X*B-V*g+o*f)*W,p[9]=(L*g-s*B-Y*f)*W,p[10]=(G*A-r*h+Z*m)*W,p[11]=(F*h-$*A-P*m)*W,p[12]=(V*C-X*b-w*f)*W,p[13]=(s*b-L*C+l*f)*W,p[14]=(r*j-G*I-d*m)*W,p[15]=($*I-F*j+y*m)*W,void 0):R},Ac=function(i,Q){if(Q){var n=Q[0],w=Q[1],x=Q[2];i[12]=i[0]*n+i[4]*w+i[8]*x+i[12],i[13]=i[1]*n+i[5]*w+i[9]*x+i[13],i[14]=i[2]*n+i[6]*w+i[10]*x+i[14],i[15]=i[3]*n+i[7]*w+i[11]*x+i[15]}},Zm=function(l,y){if(y){var b=y[0],o=y[1],p=y[2];l[0]=l[0]*b,l[1]=l[1]*b,l[2]=l[2]*b,l[3]=l[3]*b,l[4]=l[4]*o,l[5]=l[5]*o,l[6]=l[6]*o,l[7]=l[7]*o,l[8]=l[8]*p,l[9]=l[9]*p,l[10]=l[10]*p,l[11]=l[11]*p}},Br=function(g,i,X){var M=i[0],d=i[1],q=i[2],G=i[3],s=i[4],U=i[5],Q=i[6],T=i[7],z=i[8],A=i[9],H=i[10],c=i[11],Z=i[12],K=i[13],b=i[14],_=i[15],x=X[0],F=X[1],n=X[2],I=X[3];return g[0]=x*M+F*s+n*z+I*Z,g[1]=x*d+F*U+n*A+I*K,g[2]=x*q+F*Q+n*H+I*b,g[3]=x*G+F*T+n*c+I*_,x=X[4],F=X[5],n=X[6],I=X[7],g[4]=x*M+F*s+n*z+I*Z,g[5]=x*d+F*U+n*A+I*K,g[6]=x*q+F*Q+n*H+I*b,g[7]=x*G+F*T+n*c+I*_,x=X[8],F=X[9],n=X[10],I=X[11],g[8]=x*M+F*s+n*z+I*Z,g[9]=x*d+F*U+n*A+I*K,g[10]=x*q+F*Q+n*H+I*b,g[11]=x*G+F*T+n*c+I*_,x=X[12],F=X[13],n=X[14],I=X[15],g[12]=x*M+F*s+n*z+I*Z,g[13]=x*d+F*U+n*A+I*K,g[14]=x*q+F*Q+n*H+I*b,g[15]=x*G+F*T+n*c+I*_,g},cf=function(p,J,Z,L){var t,g,m,M,u,d,C,S,c,I,v=J[0],b=J[1],z=J[2],r=L[0],l=L[1],$=L[2],f=Z[0],Q=Z[1],i=Z[2];return q(v-f)<no&&q(b-Q)<no&&q(z-i)<no?Or(p):(C=v-f,S=b-Q,c=z-i,I=1/y(C*C+S*S+c*c),C*=I,S*=I,c*=I,t=l*c-$*S,g=$*C-r*c,m=r*S-l*C,I=y(t*t+g*g+m*m),I?(I=1/I,t*=I,g*=I,m*=I):(t=0,g=0,m=0),M=S*m-c*g,u=c*t-C*m,d=C*g-S*t,I=y(M*M+u*u+d*d),I?(I=1/I,M*=I,u*=I,d*=I):(M=0,u=0,d=0),p[0]=t,p[1]=M,p[2]=C,p[3]=0,p[4]=g,p[5]=u,p[6]=S,p[7]=0,p[8]=m,p[9]=d,p[10]=c,p[11]=0,p[12]=-(t*v+g*b+m*z),p[13]=-(M*v+u*b+d*z),p[14]=-(C*v+S*b+c*z),p[15]=1,p)},Sk=function(N,q,F,L,H){var J=1/o(q/2),D=1/(L-H);return N[0]=J/F,N[1]=0,N[2]=0,N[3]=0,N[4]=0,N[5]=J,N[6]=0,N[7]=0,N[8]=0,N[9]=0,N[10]=(H+L)*D,N[11]=-1,N[12]=0,N[13]=0,N[14]=2*H*L*D,N[15]=0,N},Go=function(F,$,y,s,k,K,a){var p=1/($-y),d=1/(s-k),O=1/(K-a);return F[0]=-2*p,F[1]=0,F[2]=0,F[3]=0,F[4]=0,F[5]=-2*d,F[6]=0,F[7]=0,F[8]=0,F[9]=0,F[10]=2*O,F[11]=0,F[12]=($+y)*p,F[13]=(k+s)*d,F[14]=(a+K)*O,F[15]=1,F},fo=function(X,v){var h=v[0],R=v[1],K=v[2],D=v[3],$=h*h+R*R+K*K+D*D,J=$?1/$:0;return X[0]=-h*J,X[1]=-R*J,X[2]=-K*J,X[3]=D*J,X},$h=function(f,u){var h=u[0]+u[5]+u[10],U=0;return h>0?(U=2*Math.sqrt(h+1),f[3]=.25*U,f[0]=(u[6]-u[9])/U,f[1]=(u[8]-u[2])/U,f[2]=(u[1]-u[4])/U):u[0]>u[5]&u[0]>u[10]?(U=2*Math.sqrt(1+u[0]-u[5]-u[10]),f[3]=(u[6]-u[9])/U,f[0]=.25*U,f[1]=(u[1]+u[4])/U,f[2]=(u[8]+u[2])/U):u[5]>u[10]?(U=2*Math.sqrt(1+u[5]-u[0]-u[10]),f[3]=(u[8]-u[2])/U,f[0]=(u[1]+u[4])/U,f[1]=.25*U,f[2]=(u[6]+u[9])/U):(U=2*Math.sqrt(1+u[10]-u[0]-u[5]),f[3]=(u[1]-u[4])/U,f[0]=(u[8]+u[2])/U,f[1]=(u[6]+u[9])/U,f[2]=.25*U),f},sh=function(b,e,s){var O=e[0],f=e[1],T=e[2],E=e[3],J=O+O,A=f+f,M=T+T,S=O*J,Z=O*A,v=O*M,$=f*A,d=f*M,q=T*M,G=E*J,F=E*A,y=E*M;return b[0]=1-($+q),b[1]=Z+y,b[2]=v-F,b[3]=0,b[4]=Z-y,b[5]=1-(S+q),b[6]=d+G,b[7]=0,b[8]=v+F,b[9]=d-G,b[10]=1-(S+$),b[11]=0,b[12]=s[0],b[13]=s[1],b[14]=s[2],b[15]=1,b},rj=function(e,j){if(e.vr.enable){var X=e.vr.getViewMatrix(j);if(X)return X}return cf(j?j:Yl(),e._eye,e._center,e._up)},Fd=function(H,I){if(H.vr.enable){var e=H.vr.getProjectMatrix();if(e)return e}if(!I&&H._computedProjectMatrix)return Bs(H._computedProjectMatrix);var S=H.getAspect(),A=H._near,j=H._far,Q=Yl();if(H._ortho){var V=H._orthoWidth/2,Y=V/S;Go(Q,-V,V,-Y,Y,A,j)}else Sk(Q,H._fovy,S,A,j);return Q},ug=function(T,$){if(!T)return R;var Y=0,K=1,V=2,r=[],S=0,z=T.length,e=z/3;if($){for(;z>S;S++)r[S]=0;for(S=0;S<$.length;S+=3){var h=[],x=[],N=[];h[Y]=T[3*$[S+1]+Y]-T[3*$[S]+Y],h[K]=T[3*$[S+1]+K]-T[3*$[S]+K],h[V]=T[3*$[S+1]+V]-T[3*$[S]+V],x[Y]=T[3*$[S+2]+Y]-T[3*$[S+1]+Y],x[K]=T[3*$[S+2]+K]-T[3*$[S+1]+K],x[V]=T[3*$[S+2]+V]-T[3*$[S+1]+V],N[Y]=h[K]*x[V]-h[V]*x[K],N[K]=h[V]*x[Y]-h[Y]*x[V],N[V]=h[Y]*x[K]-h[K]*x[Y];for(var m=0;3>m;m++)r[3*$[S+m]+Y]+=N[Y],r[3*$[S+m]+K]+=N[K],r[3*$[S+m]+V]+=N[V]}}else for(S=0;e>S;S+=3){var h=[],x=[],N=[];h[Y]=T[3*(S+1)+Y]-T[3*S+Y],h[K]=T[3*(S+1)+K]-T[3*S+K],h[V]=T[3*(S+1)+V]-T[3*S+V],x[Y]=T[3*(S+2)+Y]-T[3*(S+1)+Y],x[K]=T[3*(S+2)+K]-T[3*(S+1)+K],x[V]=T[3*(S+2)+V]-T[3*(S+1)+V],N[Y]=h[K]*x[V]-h[V]*x[K],N[K]=h[V]*x[Y]-h[Y]*x[V],N[V]=h[Y]*x[K]-h[K]*x[Y];for(var m=0;3>m;m++)r[3*(S+m)+Y]=N[Y],r[3*(S+m)+K]=N[K],r[3*(S+m)+V]=N[V]}for(S=0;z>S;S+=3){var t=[];t[Y]=r[S+Y],t[K]=r[S+K],t[V]=r[S+V];var b=y(t[Y]*t[Y]+t[K]*t[K]+t[V]*t[V]);0===b&&(b=no),t[Y]=t[Y]/b,t[K]=t[K]/b,t[V]=t[V]/b,r[S+Y]=t[Y],r[S+K]=t[K],r[S+V]=t[V]}return new om(r)},Yr=function(K,e,Y,q){if(Y||(Y=K.createTexture()),e){var Q=K.TEXTURE_2D,O=K.REPEAT,x=K.CLAMP_TO_EDGE,I=K.TEXTURE_MIN_FILTER;q=q||jl;var m=q.minFilter||q.filter||K.LINEAR,X=q.magFilter||q.filter||K.LINEAR;eh(K,Y),K.texImage2D(Q,0,K.RGBA,K.RGBA,K.UNSIGNED_BYTE,e),Yb(K,K.TEXTURE_MAG_FILTER,X);var g=e.naturalWidth||e.width,V=e.naturalHeight||e.height;Wm.isPOT(g)&&Wm.isPOT(V)&&!e.clampToEdge?(Yb(K,K.TEXTURE_WRAP_S,O),Yb(K,K.TEXTURE_WRAP_T,O),Yb(K,I,m===K.NEAREST?K.NEAREST_MIPMAP_NEAREST:K.LINEAR_MIPMAP_LINEAR),q.mipmapMaxLevel!==H&&Yb(K,K.TEXTURE_MAX_LEVEL,q.mipmapMaxLevel),K.generateMipmap(Q)):(Yb(K,K.TEXTURE_WRAP_S,x),Yb(K,K.TEXTURE_WRAP_T,x),Yb(K,I,m)),eh(K,R)}return Y},Ai=function(B,G){var m=new Uint8Array(4);return G=G||B.createTexture(),eh(B,G),Yb(B,B.TEXTURE_MIN_FILTER,B.LINEAR),B.texImage2D(B.TEXTURE_2D,0,B.RGBA,1,1,0,B.RGBA,B.UNSIGNED_BYTE,m),G},Oi=function(u){u._26I&&u._prg&&(u._26I.deleteProgram(u._prg),u._prg=R)},vp=function(F,g,p,o){var W=F.createShader(p);return F.shaderSource(W,o),F.compileShader(W),F.attachShader(g,W),W},yd=function(R){return R.createBuffer()},eh=function(A,V){A.bindTexture(A.TEXTURE_2D,V)},Yb=function(s,D,Y){s.texParameteri(s.TEXTURE_2D,D,Y)},yk=function(U,p){U.enable(U.POLYGON_OFFSET_FILL),U.polygonOffset(p[0],p[1])},ho=function(m){m.disable(m.POLYGON_OFFSET_FILL)},Oe=function(F,z){if(z){var z=Rb(z);F.clearColor(z[0],z[1],z[2],z[3])}},Lg=function(W,E){ws(W,E.uFix,!0),Wk(W,E.aNormal)},Ei=function(o,B){ws(o,B.uFix,!1),Nd(o,B.aNormal)},$i=function(d,S,F,g,w,s,A,_){d._picking||(F?(ws(d,S.uBlend,!0),ws(d,S.uBlendColor,F)):ws(d,S.uBlend,!1),ws(d,S.uLight,g==R?!0:g),Ff(w)&&1!==w&&ws(d,S.uPartOpacity,w),ws(d,S.uReverseFlip,s==R?!1:s),ws(d,S.uFixPickReverseColor,A||Di)),_?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE)},ii=function($,d){$._picking||ws($,d.uPartOpacity,1)},wc=function(){var k=[0,0,1,1];return function(X,u,T,I,s,G,i,l,Y){return T?(ws(X,u.uTexture,!0),ws(X,u.uDiscardSelectable,Ll(I)?I:!0),Nd(X,u.aUv),Lp(X,s,G,u.aUv,2),Y?(ws(X,u.uBlendTexture,!0),X.activeTexture(X.TEXTURE1),eh(X,Y),X.uniform1i(u.uBlendSampler,1)):(ws(X,u.uBlendTexture,!1),X.activeTexture(X.TEXTURE1),eh(X,X._emptyBlendTexture)),X.activeTexture(X.TEXTURE0),eh(X,T),X.uniform1i(u.uSampler,0),i?(k[0]=i[0],k[1]=i[1]):(k[0]=0,k[1]=0),l?(k[2]=l[0],k[3]=l[1]):(k[2]=1,k[3]=1),ws(X,u.uOffsetScale,k),void 0):(X.activeTexture(X.TEXTURE0),eh(X,X._emptyTexture),X.activeTexture(X.TEXTURE1),eh(X,X._emptyBlendTexture),void 0)}}(),Le=function($,V,L){$.activeTexture($.TEXTURE0),eh($,R),$.activeTexture($.TEXTURE1),eh($,R),L&&(Wk($,V.aUv),ws($,V.uTexture,!1),ws($,V.uBlendTexture,!1))},Wr=function(y,c,p,v,V,P){!p||Ro||wg||y.lineWidth(p),v&&!y._picking&&ws(y,c.uFixPickReverseColor,v),V&&Lp(y,V,P,c.aPosition)},Hi=function(n,K,X,o){Pk&&(o=n[Pk]),n.drawArrays(o==R?n.TRIANGLES:o,K,X);var Y=n._renderInfo;Y&&(Y.calls++,Y.vertices+=X,(o==R||o===n.TRIANGLES)&&(Y.faces+=X/3),o===n.LINES&&(Y.lines+=X/2))},Hd=function(h,J,I,K){Pk&&(K=h[Pk]),h.drawElements(K==R?h.TRIANGLES:K,I,h.UNSIGNED_SHORT,J==R?0:2*J);var i=h._renderInfo;i&&(i.calls++,i.vertices+=I,(K==R||K===h.TRIANGLES)&&(i.faces+=I/3),K===h.LINES&&(i.lines+=I/2))},qr=function(o,X,l,f,B){var j=o.ARRAY_BUFFER;o.bindBuffer(j,X),l&&o.bufferData(j,l,o.STATIC_DRAW),f!=R&&o.vertexAttribPointer(f,B?B:3,o.FLOAT,!1,0,0)},Lp=function(a,i,Q,X,u){return Q?(Hr(a,a.ARRAY_BUFFER,i,Q),X!=R&&a.vertexAttribPointer(X,u?u:3,a.FLOAT,!1,0,0),void 0):qr(a,i,Q,X,u)},Xg=function(p,k,O){var c=p.ELEMENT_ARRAY_BUFFER;p.bindBuffer(c,k),O&&p.bufferData(c,O,p.STATIC_DRAW)},yq=function(k,l,P){Hr(k,k.ELEMENT_ARRAY_BUFFER,l,P)},Hr=function(f,E,X,P){var m=P._bufId;m||(m=P._bufId=B.Math.generateIncreasingID());var X,s=f._bufPool;(X=s[m])&&X._buf?f.bindBuffer(E,X._buf):(X=s[m]={_buf:yd(f)},f.bindBuffer(E,X._buf),f.bufferData(E,P,f.STATIC_DRAW)),X._fid=f._renderInfo.frame},ws=function(j,G,p){if(p!=R&&G!=R){p=Rb(p);var v=p.length;3===v?j.uniform3fv(G,p):4===v?j.uniform4fv(G,p):16===v?j.uniformMatrix4fv(G,!1,p):Ll(p)?j.uniform1i(G,p?1:0):2===v?j.uniform2fv(G,p):j.uniform1f(G,p)}},Nd=function(_,P){P!=R&&P>=0&&_.enableVertexAttribArray(P)},Wk=function(E,U){U!=R&&U>=0&&E.disableVertexAttribArray(U)},uk=function(J,g){var r=J.getGL(),b=J._prg;J._7O=J._8O.pop(),g&&(ws(r,b.uMVMatrix,J._7O),J._6O=g,ws(r,b.uNMatrix,g))},Vi=function(A,k){return k||(k=Yl()),og(k,A),Ge(k),to(k),k},fe=function(d,a){var f=d.getGL(),I=d._prg,p=d._7O;a&&(d._8O.push(Bs(p)),ws(f,I.uMMatrix,a),Br(p,p,a),d._7O=p),ws(f,I.uMVMatrix,p),ws(f,I.uNMatrix,Vi(p,d._6O))},nr=function(q,F,J,m,k,I){if(J){if(m){var Y=J.value++,V=2147483648|Y,L=[(255&V>>16)/255,(255&V>>8)/255,(255&V)/255,(255&V>>24)/255];J[Y]={data:k,part:I}}else L=Ko;return ws(q,F.uFixPickReverseColor,L),L}},mn=function(h,K,I){"target"!==I&&(I="source");var m="target"===I?K.getTargetAgent():K.getSourceAgent(),g="edge."+I+".";if(hl(m)){var C=K.s(g+"anchor.x"),L=K.s(g+"anchor.elevation"),Z=K.s(g+"anchor.y"),r=Od(m,h.getMat(m)),M=m.getAnchor3d();return dm([(C===H?.5:C)-M.x,(L===H?.5:L)-M.y,(Z===H?.5:Z)-M.z],r)}var G=K.s(g+"index"),u=h.getData3dUI(m);if(!u.info||!u.info.list)return!1;if(G>=0){var W,n,p,y,X,c=u.info._lastPointsSegments,S=c.points,U=c.segments,w=-1,_=-1;for(p=0,y=U?U.length:S.length;y>p;p++){if(n=U?U.get(p):1,3===n)X=2;else if(4===n)X=3;else{if(5===n)continue;X=1}if(w+=X,_++,_===G){W=S.get(w);break}}return W||(W=S.get(S.length-1)),[W.x,W.e||0,W.y]}var R=K.s(g+"percent")||.5;if(R=Math.max(0,Math.min(R,1)),!u||!u.getCache)return!1;var A=u.getCache(),y=A[A.length-1].length,c=h.getLineOffset(m,R*y),Q=c.point;return[Q.x,Q.y,Q.z]},mq=function(){var L={center:function(j,R,M,t,I){var i=-R[1]/2,x={x:-R[0]/2,y:i,width:R[0],height:R[1]},r=Ph(j,x,M);return[r.x+t,-r.y-I,vq()]},front:function(c,V,v,Y,H){var m=-V[1]/2,E={x:-V[0]/2,y:m,width:V[0],height:V[1]},U=Ph(c,E,v);return[U.x+Y,-U.y-H,V[2]/2+vq()]},back:function(Y,$,Q,K,c){var k=-$[0]/2,m=-$[1]/2,E={x:k,y:m,width:$[0],height:$[1]},D=Ph(Y,E,Q);return[-D.x-K,-D.y-c,-$[2]/2-vq()]},left:function(T,N,w,C,D){var h=-N[1]/2,O={x:-N[2]/2,y:h,width:N[2],height:N[1]},m=Ph(T,O,w);return[-N[0]/2-vq(),-m.y-D,m.x+C]},right:function(c,m,k,I,B){var n=-m[2]/2,W=-m[1]/2,J={x:n,y:W,width:m[2],height:m[1]},t=Ph(c,J,k);return[m[0]/2+vq(),-t.y-B,-t.x-I]},top:function(U,D,Q,c,P){var i={x:-D[0]/2,y:-D[2]/2,width:D[0],height:D[2]},w=Ph(U,i,Q);return[w.x+c,D[1]/2+vq(),w.y+P]},bottom:function(I,A,m,u,N){var G=-A[2]/2,k={x:-A[0]/2,y:G,width:A[0],height:A[2]},n=Ph(I,k,m);return[n.x+u,-A[1]/2-vq(),-n.y-N]}};return function(n,v,b,E,Q,F){return L[E](n,v,b,Q||0,F||0)}}(),Pe=function(Q,o,F,k,w,p,D,x,d,i){if(w&&(o[0]+=w[0],o[1]+=w[1],o[2]+=w[2]),Ac(Q,F),x){var Z=Yl();if(Fr(Z,d,i),dm(o,Z),Ac(Q,o),Q.auto=x,Q.pos=dm([0,0,0],Q),p){var T=Q.mat2=Yl();Fr(T,p,D)}}else Fr(Q,d,i),Ac(Q,o),k===_c?Cf(Q,-W):k===vk?Cf(Q,W):k===gf?Kc(Q,-W):k===fm?Kc(Q,W):k===ej&&Cf(Q,e),Fr(Q,p,D);return Q},jg=function(G,T){var t=T.auto,w=T.mat2,l=G.gv;if(t){var m,n=Yl(),M=[0,0,0,0];m="string"==typeof t?[t.indexOf("x")<0?l._eye[0]:l._center[0],t.indexOf("y")<0?l._eye[1]:l._center[1],t.indexOf("z")<0?l._eye[2]:l._center[2]]:l._eye,$h(M,cf(Yl(),m,l._center,l._up)),sh(n,fo(M,M),T.pos),w&&Br(n,n,w),fe(l,n)}else fe(l,T)},dr=function(l,N,L,u,w){var O=l.s,H=l.gv,D=H.getGL(),h=H._prg,Y=H._buffer,r=H._1O;Yr(D,Jg,r),jg(l,L),$i(D,h,O(N+".blend"),O(N+".light"),O(N+".opacity"),O(N+".reverse.flip"),O(N+".reverse.color"),O(N+".reverse.cull")),wc(D,h,r,w,Y.uv,yj),Lp(D,Y.vs,u,h.aPosition),Lp(D,Y.ns,uh,h.aNormal),yq(D,Y.is,mj),Hd(D,0,mj.length),Le(D,h,r),ii(D,h),uk(H)},hm=function(h,z,g){var p=h.gv,x=h.data,y=h[z]={blend:p.getBodyColor(x)||p.getFaceBlend(x,z),light:p.getFaceLight(x,z),color:p.getFaceColor(x,z),opacity:p.getFaceOpacity(x,z),transparent:p.getFaceTransparent(x,z),reverseFlip:p.getFaceReverseFlip(x,z),reverseColor:p.getFaceReverseColor(x,z),reverseCull:p.getFaceReverseCull(x,z),texture:p.getFaceImage(x,z),blendTexture:p.getFaceBlendImage(x,z),discardSelectable:p.getFaceDiscardSelectable(x,z)};if("csg"!==z){y.uv=p.getFaceUv(x,z)||g&&g[z+"Uv"],y.uvScale=p.getFaceUvScale(x,z)||g&&g[z+"UvScale"],y.uvOffset=p.getFaceUvOffset(x,z)||g&&g[z+"UvOffset"];var t=p.getFaceMat(x,z);if(t){var Z=Od(x,t);x.appendAnchorMatrix3d(Z),y.mat=Z}}return y},cp=function(c,e,t,u,l){var D=c[u];if(D){if(!l(D.transparent))return;var $=c.data,N=c.gv,M=N._buffer,O=N.getTexture(D.texture,$,u),j=N.getTexture(D.blendTexture,$);wc(e,t,O,D.discardSelectable,M.uv,D.tuv,D.uvOffset,D.uvScale,j),$i(e,t,D.blend,D.light,D.opacity,D.reverseFlip,D.reverseColor,D.reverseCull),ws(e,t.uDiffuse,D.color||v["color.empty"]),Lp(e,M.vs,D.vs,t.aPosition),Lp(e,M.ns,D.ns,t.aNormal),Hi(e,0,D.vs.length/3),ii(e,t),Le(e,t,O)}},Jc=function(J,h,$,Z,x,H){var j,g,Y,z,G,O,D,l,C,X,A,B=[Z-h,x-$],T=J?J.length:0;for(Y=0;T>Y;Y++){for(z=2,j=J[Y],G=j[0],O=j[1];z+1<j.length;){if(D=j[z],l=j[z+1],g=Xe(h,$,Z,x,G,O,D,l,!0)){C=[D-G,l-O],X=Wj(C),C[0]/=X,C[1]/=X,X=He(B,C),X=X>0?H:-H,A=[C[0]*X,C[1]*X];break}G=D,O=l,z+=2}if(A)break}if(A)for(Z=h+A[0],x=$+A[1],Y=0;T>Y;Y++)for(z=2,j=J[Y],G=j[0],O=j[1];z+1<j.length;){if(D=j[z],l=j[z+1],g=Xe(h,$,Z,x,G,O,D,l,!0))return[0,0];G=D,O=l,z+=2}return A?A:[Z-h,x-$]},pe=B.graph3d={},Wh=function(G,D,s){uj(m+".graph3d."+G,D,s)},Jq="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",ih="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";vl(V,{setBatchInfo:function(L,W){un[L]=W},getBatchInfo:function(L){return un[L]}},!0);var xo=[1,1,1],oo=[1,0,0,0,0,1,0,1,1,1,1,0],Uj=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Tl=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Mb=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Zr=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],ph=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],rb=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Nk=function(F,A){te(F,A,"_batchModelMap","_batchIndexMap"),Ap(F,A,"_wireframeModelMap","_wireframeIndexMap"),Ap(F,A,"_polylineModelMap","_polylineIndexMap"),Ap(F,A,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),Ap(F,A,"_polylineModelMapSwap","_polylineIndexMapSwap")},te=function(E,k,h,Z){if(!k)return E[h]={},E[Z]={},void 0;var B=k._id,e=E[Z],R=e[B];if(R){var P=E[h],c=R.batch,m=P[c],$=m.ds,I=R.index;if(m.invalidate=!0,delete e[B],$.splice(I,1),cm($))return delete P[c],void 0;for(var K=R.begin,F=R.size,U=3*K,G=3*F,H=4*K,Y=4*F,o=m.vs,w=m.ps,D=m.uv,L=m.cs,X=m.bs,W=m.rs,N=m.ns,p=m.ls;I<$.length;I++)R=e[$[I]._id],R.index--,R.begin-=F;o.splice(U,G),w.splice(H,Y),D&&D.splice(2*K,2*F),L&&L.splice(H,Y),X&&X.splice(U,G),W&&W.splice(K,F),N&&N.splice(U,G),p&&p.splice(K,F)}},Ap=te,On=function(U,s,A,L){if(!L)return R;var v=s[L];if(!v){var E=un[L]||jl,Q=E.image?[]:R;v=s[L]={vs:[],ns:[],uv:Q,cs:Q?R:E.color?R:[],bs:E.blend?[]:R,ps:[],rs:E.brightness?[]:R,ds:[]}}return v.invalidate=!0,U[A._id]={index:v.ds.length,begin:v.vs.length/3,batch:L},v.ds.push(A),v},ve=function(m,g){return g!=R&&1!==g?[m[0]*g,m[1]*g,m[2]*g,m[3]]:m},qj=function(){var M;return function(r,p,k){var s=r.getData3dUI(p),G=s.shapeModel;G||(G=pi(s));var N,u=p.s("wf.combineTriangle");if(k.geometry){if(!G&&(p instanceof B.Node&&!(p instanceof B.Shape)?(M||(M={vs:Tg,is:Gb,uv:Bp}),G=M):G=[s.left,s.front,s.right,s.back,s.top,s.bottom],!G))return H;if(u?(u=0|Math.min(3,Math.max(1,isNaN(u)?1:u)),N=yr[u-1](G)):N=mg(G),!N||0===N.length)return}else N=k.short?Lk:hr;var X=r.getBrightness(p),Y=Rb(k.color||"white"),i=Y[3]<1,J=Math.ceil(k.width)||1,R=(i?"T":"O")+J,D=r._wireframeIndexMap,L=r._wireframeModelMap,v=L[R];v||(v=L[R]={vs:[],cs:[],ps:[],ds:[],T:i,W:J}),v.invalidate=!0;var f=v.vs,$=v.cs,C=v.ds,j=D[p._id]={index:C.length,begin:f.length/3,batch:R};C.push(p);var m=s.mat;p instanceof B.Edge||!(!m||!k.geometry&&p instanceof B.Shape)||(m=Od(p,k.mat),p.appendAnchorMatrix3d(m)),Ti(f,m,N);var o=j.size=f.length/3-j.begin;_g($,ve(Y,X),o)}}(),Wc=function(l,H,J,F,M,x,W,Z,G){var T=l.getBrightness(H);T==R&&(T=1);var K=ve(Rb(F),T),m=K[3]<1;x=Math.ceil(x)||1;var I=(m?"T":"O")+x;if(W){var S=W[0],d=(W[1]||S)+S;I+="-"+S+"-"+d,G&&(I+="-"+Dc(G)+"-"+T,G=ve(Rb(G),T))}var U=l._polylineIndexMap,Y=l._polylineModelMap,b=Y[I];b||(b=Y[I]={vs:[],cs:[],ps:[],ds:[],ls:W?[]:R,T:m,W:x},W&&(b.D=S,b.G=d,b.A=G)),b.invalidate=!0;var X,B=b.vs,g=b.cs,o=b.ds,e=b.ls,z=U[H._id]={index:o.length,begin:B.length/3,batch:I};o.push(H),Io(B,J);var O,n=z.size=B.length/3-z.begin,A=J.length,D=0,a=[];if(W||M)for(X=0;A>X;X+=6)O=Wj([J[X],J[X+1],J[X+2]],[J[X+3],J[X+4],J[X+5]]),a.push(O),D+=O;if(D&&M){var r,u=ve(Rb(M),T),i=[u[0]-K[0],u[1]-K[1],u[2]-K[2],u[3]-K[3]],V=0;for(X=0;A>X;X+=6)r=V/D,_g(g,[K[0]+i[0]*r,K[1]+i[1]*r,K[2]+i[2]*r,K[3]+i[3]*r],1),V+=a[X/6],r=V/D,_g(g,[K[0]+i[0]*r,K[1]+i[1]*r,K[2]+i[2]*r,K[3]+i[3]*r],1)}else _g(g,K,n);if(W)for(V=Z||0,X=0;A>X;X+=6)e.push(V),V+=a[X/6],e.push(V)},Dp=function(s,l,p){if(l)for(var Y=4*l.begin,J=p[l.batch].ps,T=0;T<l.size;T++)J[Y++]=s[0],J[Y++]=s[1],J[Y++]=s[2],J[Y++]=s[3]},Wb=function(o,g){var Z=g+["32"],h=o[g],Q=o[Z];h?Q&&Q.length===h.length?(Q.set(h),Q._bufId=null):o[Z]=new om(h):delete o[Z]},Em=function(V,N,h,d,a,E,u,F,T){if(hd(h))h.forEach(function(B){Em(V,N,B,d,a,E,u,F,T)});else if(Fc(h))Em(V,N,pi(d,h),d,a,E,u,F,T);else if(zh(h)){var v,G=ie(h.mat,N,V),R=ie(h.s3,N,V),c=ie(h.t3,N,V),t=ie(h.r3,N,V);if((R||t||c||G)&&(v=jk(G,R,t,ie(h.rotationMode,N,V),c),E.push(v)),h.shape3d)Em(V,N,h.shape3d,d,a,E,u,F,h);else{var w=d.s;T=T||jl;var _=E[0],f=E.length,Y=w("shape3d.color",h.color,T.color);if(a||(a=w("shape3d.blend",h.blend,T.blend)),f>1){_=Bs(_);for(var p=1;f>p;p++)Br(_,_,E[p])}h.vs&&w(Gm,h.visible,T.visible)&&Nj(_,u,F,h.vs,h.uv,h.is,a,Y),h.top_vs&&w(Kl,h.topVisible,T.topVisible)&&Nj(_,u,F,h.top_vs,h.top_uv,h.top_is,a,w("shape3d.top.color",h.topColor,T.topColor)||Y),h.bottom_vs&&w(ke,h.bottomVisible,T.bottomVisible)&&Nj(_,u,F,h.bottom_vs,h.bottom_uv,h.bottom_is,a,w("shape3d.bottom.color",h.bottomColor,T.bottomColor)||Y),h.from_vs&&w(lc,h.fromVisible,T.fromVisible)&&Nj(_,u,F,h.from_vs,h.from_uv,h.from_is,a,w("shape3d.from.color",h.fromColor,T.fromColor)||Y),h.to_vs&&w(Ik,h.toVisible,T.toVisible)&&Nj(_,u,F,h.to_vs,h.to_uv,h.to_is,a,w("shape3d.to.color",h.toColor,T.toColor)||Y)}v&&E.pop()}},Nj=function(m,H,Y,y,n,I,b,w){var r,T=H.cs,O=H.uv,i=H.bs;if(I){r=I.length;for(var g=0;r>g;g++){var B=I[g];Ti(Y,m,[y[3*B],y[3*B+1],y[3*B+2]]),O&&Io(O,[n[2*B],n[2*B+1]])}}else r=y.length/3,Ti(Y,m,y),O&&Io(O,n);T&&_g(T,w,r),i&&(b?we(i,b,r):Io(i,xo,r))},Rn=function(G,i,E,Q){var l=[];Q?Em(G.gv,G.data,Q,G,G.getBodyColor(),[i],E,l):(co(G,_c,i,E,l),co(G,vk,i,E,l),co(G,ck,i,E,l),co(G,ej,i,E,l),co(G,gf,i,E,l),co(G,fm,i,E,l),co(G,"csg",i,E,l)),l.length&&(Io(E.vs,l),Io(E.ns,ug(l)))},co=function(L,G,O,C,Q){var B=L[G];if(B){var h=B.tuv;if(h){var q,J,t,A,n=B.uvScale,p=B.uvOffset;if(n)for(q=h.length,J=n[0],t=n[1],A=0;q>A;A+=2)h[A]*=J,h[A+1]*=t;if(p)for(q=h.length,J=p[0],t=p[1],A=0;q>A;A+=2)h[A]+=J,h[A+1]+=t}Nj(O,C,Q,B.vs,h,R,B.blend,B.color)}},ff=function(U,t,s,f,g,Q,o,$){var I,j=s.cs,R=s.uv,W=s.bs;if(U.getFaceVisible(t,Q)){var l=U.getFaceMat(t,Q);if(l&&(g=Od(t,l)),Ti(o,g,$),j&&_g(j,U.getFaceColor(t,Q),6),R){var b=U.getFaceUv(t,Q)||f[Q+"Uv"],C=U.getFaceUvScale(t,Q)||f[Q+"UvScale"],H=U.getFaceUvOffset(t,Q)||f[Q+"UvOffset"];b=b?[b[6],b[7],b[0],b[1],b[2],b[3],b[2],b[3],b[4],b[5],b[6],b[7]]:oo;var K=b[0],F=b[1],N=b[2],i=b[3],y=b[4],p=b[5],r=b[6],X=b[7],A=b[8],M=b[9],u=b[10],q=b[11];if(C){var c=C[0],D=C[1];K*=c,F*=D,N*=c,i*=D,y*=c,p*=D,r*=c,X*=D,A*=c,M*=D,u*=c,q*=D}if(H){var e=H[0],a=H[1];K+=e,F+=a,N+=e,i+=a,y+=e,p+=a,r+=e,X+=a,A+=e,M+=a,u+=e,q+=a}R.push(K,F,N,i,y,p,r,X,A,M,u,q)}W&&(I=U.getBodyColor(t)||U.getFaceBlend(t,Q),I?we(W,I,6):Io(W,xo,6))}},tq=function(m,g,Q,A){var U=m.getGL(),P=m._prg,x=m._buffer;if(!m.drawFilter&&!bn(g)){fe(m),Lg(U,P);for(var o in g){var l=g[o];if(!(A&&!l.T||!A&&l.T)){l.invalidate?(l.invalidate=!1,Wb(l,"vs"),Wb(l,"cs"),Wb(l,"ls"),Wb(l,"ps")):Q&&Wb(l,"ps");var G=l.vs32,_=Q?l.ps32:l.cs32;Wr(U,P,l.W,R,x.vs,G);var r=l.D,c=!m._dashDisabled&&r;ws(U,P.uAlphaTest,v.alphaTest),c&&(ws(U,P.uDash,!0),ws(U,P.uDashDistance,r),ws(U,P.uDashGapDistance,l.G),Nd(U,P.aLineDistance),Lp(U,x.lineDistance,l.ls32,P.aLineDistance,1),ws(U,P.uDiffuse,l.A||v["color.empty"]));var S=!m._batchColorDisabled;S&&(ws(U,P.uBatchColor,!0),Nd(U,P.aBatchColor),Lp(U,x.batchColor,_,P.aBatchColor,4)),wc(U),Hi(U,0,G.length/3,U.LINES),Le(U),S&&(ws(U,P.uBatchColor,!1),Wk(U,P.aBatchColor)),c&&(ws(U,P.uDash,!1),Wk(U,P.aLineDistance))}}Ei(U,P)}},rh=function(Q,l,q){var _,n,r,E,m,X,Z,f,a,s,N,W=Q.getGL(),D=Q._prg,d=Q._buffer,b=Q._batchModelMap;if(!bn(b)&&!Q.drawFilter){fe(Q);for(_ in b)if(n=un[_]||jl,!(q&&!n.transparent||!q&&n.transparent)&&(r=b[_],l||!n.transparentMask)){var j=q&&n.autoSort!==!1&&(Q._33Q||r.invalidate);if(r.invalidate?(r.invalidate=!1,Wb(r,"vs"),Wb(r,"ns"),Wb(r,"cs"),Wb(r,"rs"),Wb(r,"ps"),Wb(r,"bs"),Wb(r,"uv")):l&&Wb(r,"ps"),m=r.vs32,X=l?r.ps32:r.cs32,a=r.uv32,Z=r.bs32,f=r.rs32,N=m.length/3,j&&(r.is=ng(m,Q.getEye())),N){E=n.light,s=Q.getTexture(n.image),$i(W,D,R,n.light,n.opacity,n.reverseFlip,n.reverseColor,n.reverseCull),X?Q._batchColorDisabled||(ws(W,D.uBatchColor,!0),Nd(W,D.aBatchColor),Lp(W,d.batchColor,X,D.aBatchColor,4)):ws(W,D.uDiffuse,n.color||v["color.empty"]);
var M=n.alphaTest;ws(W,D.uAlphaTest,M===H?v.alphaTest:M),n.envmap!==H?(ws(W,D.uUseEnvMap,!0),ws(W,D.uReflectivity,n.envmap)):(ws(W,D.uUseEnvMap,!1),ws(W,D.uReflectivity,0));var t=Z&&!Q._batchBlendDisabled;t&&(ws(W,D.uBatchBlend,!0),Nd(W,D.aBatchBlend),Lp(W,d.batchBlend,Z,D.aBatchBlend));var P=f&&!Q._batchBrightnessDisabled;P&&(ws(W,D.uBatchBrightness,!0),Nd(W,D.aBatchBrightness),Lp(W,d.batchBrightness,f,D.aBatchBrightness,1)),a?wc(W,D,s,n.discardSelectable,d.uv,a,n.uvOffset,n.uvScale):wc(W),Lp(W,d.vs,m,D.aPosition),Lp(W,d.ns,r.ns32,D.aNormal),r.is?(Xg(W,d.is,r.is),Hd(W,0,N)):Hi(W,0,N),a?Le(W,D,s):Le(W),X&&!Q._batchColorDisabled&&(ws(W,D.uBatchColor,!1),Wk(W,D.aBatchColor)),t&&(ws(W,D.uBatchBlend,!1),Wk(W,D.aBatchBlend)),P&&(ws(W,D.uBatchBrightness,!1),Wk(W,D.aBatchBrightness)),ii(W,D)}}}},ng=function(U,x){for(var K=U.length/3,J=new Array(K),V=K/3,u=new Array(V),Z=0;V>Z;Z++)u[Z]=Z;u.sort(function(P,M){var l=9*P,p=[(U[l]+U[l+3]+2*U[l+6])/4,(U[l+1]+U[l+4]+2*U[l+7])/4,(U[l+2]+U[l+5]+2*U[l+8])/4];l=9*M;var F=[(U[l]+U[l+3]+2*U[l+6])/4,(U[l+1]+U[l+4]+2*U[l+7])/4,(U[l+2]+U[l+5]+2*U[l+8])/4],z=Wj(x,p)-Wj(x,F);return z>0?-1:0>z?1:0});for(var Z=0;V>Z;Z++){var P=3*Z,Q=3*u[Z];J[P]=Q,J[P+1]=Q+1,J[P+2]=Q+2}return new bj(J)},mb={obj:function(Z,S){var E={mat:Z.mat,s3:Z.s3,r3:Z.r3,rotationMode:Z.rotationMode,t3:Z.t3,cube:Z.cube==R?!0:Z.cube,center:Z.center==R?!0:Z.center,ignoreMtls:Z.ignoreMtls,ignoreTransparent:Z.ignoreTransparent,ignoreColor:Z.ignoreColor,ignoreImage:Z.ignoreImage,ignoreNormal:Z.ignoreNormal,prefix:Z.prefix,flipY:Z.flipY,flipFace:Z.flipFace,reverseFlipMtls:Z.reverseFlipMtls,finishFunc:function(D,s){if(D){var s=[];for(var V in D){var U=D[V];s.rawS3=U.rawS3,s.push(U),Z.eachModel&&Z.eachModel(V,U)}s.json=Z,S(s)}else S()}};V.loadObj(Z.obj,Z.mtl,E)}};V.getModelTypeHandlers=function(){return mb},V.setModelTypeHandler=function(x,N){mb[x]=N},V.getModelTypeHandler=function(N){return mb[N]},V.handleModelLoaded=function(){},V.handleUnfoundModel=function(){};var bf=R,ye=R,Qi=function(M){bf&&!M._loadingModelView_&&(ye||(ye={}),ye[M._loadingModelView_=Gq()]=M)},Tc=function(A,c){bf||(bf={});var z=bf[A];if(z){if(z.url===c)return;z.request.onload=so,z.request.onerror=so}var r=new ro;if(bf[A]={request:r,url:c},c=V.beforeLoadURL(c),c.data){var x=V.parse(c.data);xe(A,x,c)}else{r.onload=function(){if(200===this.status||0===this.status){delete bf[A];var B=V.parse(r.getResponseText());xe(A,B,c)}else ns(A,V.handleUnfoundModel(A,c)||R)},r.onerror=function(){ns(A,V.handleUnfoundModel(A,c)||R)};var l={};l.url=encodeURI(c),l.sync=!1,r.send(l)}},xe=function(F,N,L){var W=N.modelType;if(!W)return ns(F,N),V.handleModelLoaded(F,N),void 0;var n=V.getModelTypeHandler(W);if(n){if(bf||(bf={}),bf[F])return;bf[F]=!0;var $=function(v){v?(ns(F,v),V.handleModelLoaded(F,v)):ns(F,V.handleUnfoundModel(F,L)||R)};n(N,$)}else ns(F,V.handleUnfoundModel(F,L)||R)},ns=function(c,A){if(delete bf[c],Fc(A)&&ks.test(A))return Tc(c,A),void 0;if(vr[c]=A,bn(bf)&&(bf=R,ye)){for(var p in ye){var O=ye[p];O.invalidateAll&&O.invalidateAll(H,"modelLoaded",c),O.redraw&&O.redraw(),O.iv(),delete O._loadingModelView_}ye=R}if(A&&ye)for(var p in ye){var O=ye[p];O.invalidateAll&&O.invalidateAll(H,"modelLoading",c),O.redraw&&O.redraw(),O.iv()}},yj=new om([0,0,0,1,1,1,1,0]),uh=new om([0,0,1,0,0,1,0,0,1,0,0,1]),mj=new bj([0,1,2,2,3,0]),Tg=new om([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Gb=new bj([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Bp=new om([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),lf=ug(Tg,Gb),Fo=(new om([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new bj([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[_c,ck,vk,ej,gf,fm]),hr=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Lk=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Qe=function(y,V,k,d,g,K,O){K=K||16,y=y||16,V=V||0,k=k||y;var L,$,a,l,X,E,G,w,p,A=.5,D=[],t=[],f=b/y,U=e/K;for(L=0;K>L;L++)for(E=L+1,l=L*U,p=E*U,$=V;k>$;$++)G=$+1,a=$*f,w=G*f,D.push(A*n(l)*i(a),A*i(l),-A*n(l)*n(a),A*n(p)*i(w),A*i(p),-A*n(p)*n(w),A*n(l)*i(w),A*i(l),-A*n(l)*n(w),A*n(l)*i(a),A*i(l),-A*n(l)*n(a),A*n(p)*i(a),A*i(p),-A*n(p)*n(a),A*n(p)*i(w),A*i(p),-A*n(p)*n(w)),t.push($/y,L/K,G/y,E/K,G/y,L/K,$/y,L/K,$/y,E/K,G/y,E/K);if(O){var s=[];for(L=0,X=D.length;X>L;L+=3)s.push(2*D[L],2*D[L+1],2*D[L+2])}if(d){var C=[],q=[];for(a=V*f,L=0;K>L;L++)E=L+1,l=L*U,p=E*U,C.push(0,0,0,A*n(p)*i(a),A*i(p),-A*n(p)*n(a),A*n(l)*i(a),A*i(l),-A*n(l)*n(a)),q.push(0,.5,V/y,E/K,V/y,L/K)}if(g){var m=[],Z=[];for(a=k*f,L=0;K>L;L++)E=L+1,l=L*U,p=E*U,m.push(0,0,0,A*n(l)*i(a),A*i(l),-A*n(l)*n(a),A*n(p)*i(a),A*i(p),-A*n(p)*n(a)),Z.push(1,.5,k/y,L/K,k/y,E/K)}var v={vs:D,uv:t,from_vs:C,from_uv:q,to_vs:m,to_uv:Z};return O&&(v.ns=s),v},Rc=function(m,g,I){m=m||.17,g=g||12,I=I||18,0>m?m=0:m>.25&&(m=.25);var u,D,G,Z,K,T,X,N=.5,S=[],W=[],F=[],M=b/I,B=b/g,v=N-m;for(D=0;g>=D;D++)for(Z=-e+D*B,T=i(Z),K=n(Z),u=0;I>=u;u++)G=u*M,X=v+m*T,S.push(i(G)*X,K*m,-n(G)*X),W.push(u/I,1-D/g);for(D=0;g>D;D++){var h=D*(I+1),q=(D+1)*(I+1);for(u=0;I>u;u++)F.push(h+u,q+u+1,q+u,h+u,h+u+1,q+u+1)}return{vs:S,uv:W,is:F}},Gf=function(P,O,J,c,E,u,B,N){B=B||12,P=P||18,O=O||0,J=J||P,u=u||.17,0>u?u=0:u>.25&&(u=.25);var _,K,Y,T,Z,F,t,j,f,V,o=.5,W=[],g=[],k=b/P,X=b/B,r=o-u,L=N?[]:H;for(Y=0;B>Y;Y++)for(T=Y+1,t=-e+Y*X,j=-e+T*X,_=O;J>_;_++)K=_+1,Z=_*k,F=K*k,f=r+u*i(t),V=r+u*i(j),W.push(i(Z)*f,n(t)*u,-n(Z)*f,i(F)*f,n(t)*u,-n(F)*f,i(F)*V,n(j)*u,-n(F)*V,i(Z)*f,n(t)*u,-n(Z)*f,i(F)*V,n(j)*u,-n(F)*V,i(Z)*V,n(j)*u,-n(Z)*V),g.push(_/P,1-Y/B,K/P,1-Y/B,K/P,1-T/B,_/P,1-Y/B,K/P,1-T/B,_/P,1-T/B),N&&L.push(i(Z)*i(t),n(t),-n(Z)*i(t),i(F)*i(t),n(t),-n(F)*i(t),i(F)*i(j),n(j),-n(F)*i(j),i(Z)*i(t),n(t),-n(Z)*i(t),i(F)*i(j),n(j),-n(F)*i(j),i(Z)*i(j),n(j),-n(Z)*i(j));if(c){var Q=[],p=[];for(Y=0;B>Y;Y++)T=Y+1,t=-e+Y*X,j=-e+T*X,Z=O*k,f=r+u*i(t),V=r+u*i(j),Q.push(i(Z)*f,n(t)*u,-n(Z)*f,i(Z)*V,n(j)*u,-n(Z)*V,i(Z)*r,0,-n(Z)*r),p.push(.5+.5*i(t),.5-.5*n(t),.5+.5*i(j),.5-.5*n(j),.5,.5)}if(E){var z=[],R=[];for(Y=0;B>Y;Y++)T=Y+1,t=-e+Y*X,j=-e+T*X,Z=J*k,f=r+u*i(t),V=r+u*i(j),z.push(i(Z)*f,n(t)*u,-n(Z)*f,i(Z)*r,0,-n(Z)*r,i(Z)*V,n(j)*u,-n(Z)*V),R.push(.5-.5*i(t),.5-.5*n(t),.5,.5,.5-.5*i(j),.5-.5*n(j))}var m={vs:W,uv:g,from_vs:Q,from_uv:p,to_vs:z,to_uv:R};return N&&(m.ns=L),m},Qk=function(t,e){for(var k,D,c,l=.5,O=16,H=[],Z=[],K=[],G=b/O,j=0;O>=j;j++)k=j*G,D=i(k)*l,c=n(k)*l,H.push(D,-l,c,D,l,c),Z.push(1-j/O,1,1-j/O,0);for(j=0;O>j;j++)K.push(2*j,2*j+1,2*j+3,2*j,2*j+3,2*j+2);if(e){var A=[],L=[],I=[];for(A.push(0,-l,0),L.push(.5,.5),j=0;O>=j;j++)k=j*G,D=i(k),c=n(k),A.push(D*l,-l,-c*l),L.push(.5+.5*D,.5+.5*c);for(j=0;O>j;j++)I.push(0,j+2,j+1)}if(t){var _=[],Q=[],y=[];for(_.push(0,l,0),Q.push(.5,.5),j=0;O>=j;j++)k=j*G,D=i(k),c=n(k),_.push(D*l,l,-c*l),Q.push(.5+.5*D,.5-.5*c);for(j=0;O>j;j++)y.push(0,j+1,j+2)}return{vs:H,uv:Z,is:K,bottom_vs:A,bottom_uv:L,bottom_is:I,top_vs:_,top_uv:Q,top_is:y}},Rp=function(l,y,m,g,L,h,E,z){l=l||12,y=y||0,m=m||l;for(var C,D,G,O,k,o,Q,p,A,Y=.5,x=[],P=[],f=b/l,M=y;m>M;M++)C=M+1,D=M*f,G=C*f,O=i(D)*Y,k=n(D)*Y,o=i(G)*Y,Q=n(G)*Y,x.push(O,-Y,-k,o,-Y,-Q,O,Y,-k,o,-Y,-Q,o,Y,-Q,O,Y,-k),P.push(M/l,1,C/l,1,M/l,0,C/l,1,C/l,0,M/l,0);if(z){var r=[];for(M=0,A=x.length;A>M;M+=3)r.push(2*x[M],0,2*x[M+2])}if(E){var K=[],H=[];for(M=y;m>M;M++)D=f*M,G=f*(M+1),O=i(D),k=n(D),o=i(G),Q=n(G),K.push(O*Y,-Y,-k*Y,0,-Y,0,o*Y,-Y,-Q*Y),H.push(.5+.5*O,.5+.5*k,.5,.5,.5+.5*o,.5+.5*Q)}if(h){var I=[],U=[];for(M=y;m>M;M++)D=f*M,G=f*(M+1),O=i(D),k=n(D),o=i(G),Q=n(G),I.push(O*Y,Y,-k*Y,o*Y,Y,-Q*Y,0,Y,0),U.push(.5+.5*O,.5-.5*k,.5+.5*o,.5-.5*Q,.5,.5)}if(g){var j=[],s=[];D=f*y,O=i(D)*Y,k=n(D)*Y,p=y/l,j.push(0,Y,0,0,-Y,0,O,-Y,-k,O,-Y,-k,O,Y,-k,0,Y,0),s.push(0,0,0,1,p,1,p,1,p,0,0,0)}if(L){var _=[],R=[];D=f*m,O=i(D)*Y,k=n(D)*Y,p=m/l,_.push(0,-Y,0,0,Y,0,O,Y,-k,O,Y,-k,O,-Y,-k,0,-Y,0),R.push(1,1,1,0,p,0,p,0,p,1,1,1)}var S={vs:x,uv:P,bottom_vs:K,bottom_uv:H,top_vs:I,top_uv:U,from_vs:j,from_uv:s,to_vs:_,to_uv:R};return z&&(S.ns=r),S},El=function(P,K,Y,F,A){K=K||18,Y=Y||0,F=F==R?b:F,A=A==R?.5:A;for(var T,x,C,W,Z,E,N=[0,.5,.75,.875,.9375],V=[],g=[],m=[],r=F/K,l=0;l<N.length;l++){var d=0===l%2?0:.5;for(T=0;K>=T;T++)x=(T+d)*r+Y,C=1-N[l],V.push(i(x)*A*C,-A+2*N[l]*A,-n(x)*A*C),g.push((T+d)/K,C)}for(l=0;l<N.length-1;l++){var X=l*(K+1),S=(l+1)*(K+1);for(T=0;K>T;T++)m.push(X+T,S+T+1,S+T,X+T,X+T+1,S+T+1)}for(E=V.length/3-(K+1),T=0;K>T;T++)V.push(0,A,0),g.push((T+.5)/K,0);for(T=0;K>T;T++)m.push(E+T,E+T+1,E+(K+1)+T);if(P){var j=[],y=[],O=[];for(j.push(0,-A,0),y.push(.5,.5),T=0;K>=T;T++)x=T*r+Y,W=i(x),Z=n(x),j.push(W*A,-A,-Z*A),y.push(.5+.5*W,.5+.5*Z);for(T=0;K>T;T++)O.push(0,T+2,T+1)}return{vs:V,uv:g,is:m,bottom_vs:j,bottom_uv:y,bottom_is:O}},Ub=function(a,S,y,k,u,Y){a=a||16,S=S||0,y=y||a;for(var U=.5,N=[],P=[],t=b/a,l=S;y>l;l++){var G=l+1,J=t*l,E=t*G;N.push(i(J)*U,-U,-n(J)*U,i(E)*U,-U,-n(E)*U,0,U,0),P.push(l/a,1,G/a,1,(l+G)/2/a,0)}if(Y){var $=[],K=[];for(l=S;y>l;l++){J=t*l,E=t*(l+1);var m=i(J),D=n(J),I=i(E),W=n(E);$.push(m*U,-U,-D*U,0,-U,0,I*U,-U,-W*U),K.push(.5+.5*m,.5+.5*D,.5,.5,.5+.5*I,.5+.5*W)}}if(k){var d=[],O=[];J=t*S,d.push(0,U,0,0,-U,0,i(J)*U,-U,-n(J)*U),O.push(0,0,0,1,S/a,1)}if(u){var F=[],g=[];J=t*y,F.push(0,-U,0,0,U,0,i(J)*U,-U,-n(J)*U),g.push(1,1,1,0,y/a,1)}return{vs:N,uv:P,bottom_vs:$,bottom_uv:K,from_vs:d,from_uv:O,to_vs:F,to_uv:g}},vm=function(f,_,Y,n,T,E,G,L){for(var k=[],P=0;P<f.length-1;P+=2)k.push({x:f[P],y:f[P+1]});return Tr(k,_,Y,n,T,E,G,L,!1)},Sc={roundRect:function(A,r){return vm([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],A,r,3)},star:function(U,J){return vm([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],U,J)},rect:function(c,K){return vm([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],c,K)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(J,g){return vm([0,-.5,.5,.5,-.5,.5],[1,2,2,5],J,g)},rightTriangle:function(J,L){return vm([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],J,L)},parallelogram:function(U,J){return vm([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],U,J)},trapezoid:function(Y,K){return vm([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],Y,K)}},En={sphere:1,cylinder:1,cone:1,torus:1},cg={torus:1,sphere:1},vs=vl(er(Sc),{cylinder:1}),od=vl(er(Sc),{cylinder:1,cone:1}),wr=function(f,D,C){var a,X=ie(f.anchor3d,C,D),V=ie(f.mat,C,D),m=ie(f.s3,C,D),R=ie(f.t3,C,D),o=ie(f.r3,C,D),j=m||o||R||V;if(X||j){a=Bs(D._6O);var k=j?jk(V,m,o,ie(f.rotationMode,C,D),R):Yl();X&&Ac(k,[.5-X[0],.5-X[1],.5-X[2]]),fe(D,k)}return a},tj=function(s,a,R,j,I,q,g){if(hd(R))R.forEach(function(l){tj(s,a,l,j,I,q,g)});else if(Fc(R))tj(s,a,pi(j,R),j,I,q,g);else if(zh(R))if(R.shape3d){var O=wr(R,s,a);tj(s,a,R.shape3d,j,I,q,R),O&&uk(s,O)}else Sj(s,a,R,j.s,I,q,g)},Sj=function(c,w,C,T,m,i,Q){if(Q=Q||jl,!i||i(T("shape3d.transparent",C.transparent,Q.transparent))){var j=wr(C,c,w);im(C);var X=c._26I,o=c._prg,s=c._buffer,B=T("shape3d.color",C.color,Q.color);m||(m=T("shape3d.blend",C.blend,Q.blend));var V,D=C.opacity==R?Q.opacity:C.opacity,J=T("shape3d.opacity");V=J!=R&&D!=R?D*J:D!=R?D:J,$i(X,o,m,T("shape3d.light",C.light,Q.light),V,T("shape3d.reverse.flip",C.reverseFlip,Q.reverseFlip),T("shape3d.reverse.color",C.reverseColor,Q.reverseColor),T("shape3d.reverse.cull",C.reverseCull,Q.reverseCull));var H=T("polygonOffset",C.polygonOffset,Q.polygonOffset);C.vs&&T(Gm,C.visible,Q.visible)&&Tk(X,o,s,B,c.getTexture(T("shape3d.image",C.image,Q.image),w),T("shape3d.discard.selectable",C.discardSelectable,Q.discardSelectable),C.vs,C.uv,C.ns,C.is,T("shape3d.uv.offset",C.uvOffset,Q.uvOffset),T("shape3d.uv.scale",C.uvScale,Q.uvScale),H),C.top_vs&&T(Kl,C.topVisible,Q.topVisible)&&Tk(X,o,s,T("shape3d.top.color",C.topColor,Q.topColor)||B,c.getTexture(T("shape3d.top.image",C.topImage,Q.topImage),w,"top"),T("shape3d.top.discard.selectable",C.topDiscardSelectable,Q.topDiscardSelectable),C.top_vs,C.top_uv,C.top_ns,C.top_is,T("shape3d.top.uv.offset",C.topUvOffset,Q.topUvOffset),T("shape3d.top.uv.scale",C.topUvScale,Q.topUvScale),H),C.bottom_vs&&T(ke,C.bottomVisible,Q.bottomVisible)&&Tk(X,o,s,T("shape3d.bottom.color",C.bottomColor,Q.bottomColor)||B,c.getTexture(T("shape3d.bottom.image",C.bottomImage,Q.bottomImage),w,"bottom"),T("shape3d.bottom.discard.selectable",C.bottomDiscardSelectable,Q.bottomDiscardSelectable),C.bottom_vs,C.bottom_uv,C.bottom_ns,C.bottom_is,T("shape3d.bottom.uv.offset",C.bottomUvOffset,Q.bottomUvOffset),T("shape3d.bottom.uv.scale",C.bottomUvScale,Q.bottomUvScale),H),C.from_vs&&T(lc,C.fromVisible,Q.fromVisible)&&Tk(X,o,s,T("shape3d.from.color",C.fromColor,Q.fromColor)||B,c.getTexture(T("shape3d.from.image",C.fromImage,Q.fromImage),w,"from"),T("shape3d.from.discard.selectable",C.fromDiscardSelectable,Q.fromDiscardSelectable),C.from_vs,C.from_uv,C.from_ns,C.from_is,T("shape3d.from.uv.offset",C.fromUvOffset,Q.fromUvOffset),T("shape3d.from.uv.scale",C.fromUvScale,Q.fromUvScale),H),C.to_vs&&T(Ik,C.toVisible,Q.toVisible)&&Tk(X,o,s,T("shape3d.to.color",C.toColor,Q.toColor)||B,c.getTexture(T("shape3d.to.image",C.toImage,Q.toImage),w,"to"),T("shape3d.to.discard.selectable",C.toDiscardSelectable,Q.toDiscardSelectable),C.to_vs,C.to_uv,C.to_ns,C.to_is,T("shape3d.to.uv.offset",C.toUvOffset,Q.toUvOffset),T("shape3d.to.uv.scale",C.toUvScale,Q.toUvScale),H),ii(X,o),j&&uk(c,j)}},Tk=function(x,J,i,Z,W,o,Q,d,q,c,H,j,O){Q&&(O&&yk(x,O),ws(x,J.uDiffuse,Z||v["color.empty"]),d?wc(x,J,W,o,i.uv,d,H,j):wc(x),Lp(x,i.vs,Q,J.aPosition),Lp(x,i.ns,q,J.aNormal),c?(yq(x,i.is,c),Hd(x,0,c.length)):Hi(x,0,Q.length/3),d?Le(x,J,W):Le(x),O&&ho(x))},pi=function(M,k){var G=M.s;if(k||(k=G(Yk)),!k)return R;var i=Jm(k);if(i)return i;if("text"===k){var W={amount:G("shape3d.text.amount"),size:G("shape3d.text.size"),font:G("shape3d.text.font"),style:G("shape3d.text.style"),weight:G("shape3d.text.weight"),fill:G("shape3d.text.fill"),curveSegments:G("shape3d.text.curveSegments"),spacing:G("shape3d.text.spacing")},y=M.gv.getShape3dText(M.data),b=y;for(var d in W)b+="_"+(W[d]===H?"U":W[d]);return M._cachedTextKey===b?M._cachedTextGeometry:(M._cachedTextKey=b,M._cachedTextGeometry=V.createTextGeometry(y,W))}var d=k;if(En[k]){var N=G("shape3d.side"),g=G("shape3d.side.from"),t=G("shape3d.side.to"),F=G(lc),c=G(Ik);3>N?(N=0,g=0,t=0,F=!1,c=!1):((g==R||0>g)&&(g=0),(t==R||t>N)&&(t=N),0===g&&t===N&&(F=!1,c=!1));var Y="cone"===k?!1:G("shape3d.smooth");d+="-"+N+"-"+g+"-"+t+"-"+F+"-"+c+(Y?1:0)}if(vs[k]){var E=G(Kl);d+="-"+E}if(od[k]){var O=G(ke);d+="-"+O}if("torus"===k){var B=G("shape3d.torus.radius");0>B?B=0:B>.25&&(B=.25),d+="-"+B}if(cg[k]){var u=G(Bh);d+="-"+u}return i=vf[d],i||("box"===k?i=V.createBoxModel():Sc[k]?i=Sc[k](E,O):"sphere"===k?i=V.createSphereModel(N,g,t,F,c,u,Y):k===Ri?i=V.createCylinderModel(N,g,t,F,c,E,O,Y):"cone"===k?i=V.createConeModel(N,g,t,F,c,O):"torus"===k&&(i=V.createTorusModel(N,g,t,F,c,B,u,Y)),vf[d]=i),i},im=function(){var l=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],f=["is","top_is","bottom_is","from_is","to_is"];return I=ql(Jq.substr(Jq.indexOf("^#")+2)),Vg(V[Kp(rg+l[15]+"n"+l[16])]())&&Mk()?function(R){R&&!R._complete_&&(R._complete_=!0,R.vs&&cm(R.ns)&&(R.ns=ug(R.vs,R.is)),R.top_vs&&cm(R.top_ns)&&(R.top_ns=ug(R.top_vs,R.top_is)),R.bottom_vs&&cm(R.bottom_ns)&&(R.bottom_ns=ug(R.bottom_vs,R.bottom_is)),R.from_vs&&cm(R.from_ns)&&(R.from_ns=ug(R.from_vs,R.from_is)),R.to_vs&&cm(R.to_ns)&&(R.to_ns=ug(R.to_vs,R.to_is)),l.forEach(function(S){var p=R[S];hd(p)&&(R[S]=new om(p))}),f.forEach(function(J){var $=R[J];hd($)&&(R[J]=new bj($))}))}:void 0}(),Gh=function(X,z){var u=X[z];hd(u)&&(X[z]=new om(u))};vl(sp,{_25Q:function(g){g._16O=function(M,s,v,d,P,E,R,W,f){var B=this.info;if(B){var _,G,N,z,r,X,V=Yl();if(Lq[s]?(_=B.p3,G=B.c1,N=B.c2):el[s]?(G=B.s1||B.c1,N=B.s2||B.c2):(G=B.t1||B.c1,N=B.t2||B.c2),_)X=mq(s,Zh,v,d,W,f);else{var i=Ed(N,G),Y=Wj(G,N);z=[0,-F(i[2],i[0]),Z(i[1]/Y)],r="zyx",_=[(G[0]+N[0])/2,(G[1]+N[1])/2,(G[2]+N[2])/2],X=mq(s,[Y,0,0],v,d,W,f)}return Pe(V,X,_,d,P,E,R,M,z,r)}return qb},g._80o=function(Z,O,X){var G=this,o=G.shapeModel;if(o){var c=G.gv;fe(c),tj(c,G.data,o,G,G.getBodyColor(),X)}},g.createLineModel=function(P,S,D,j,F){for(var v=this,_=v.s,l=Bc(P,S,_(Bh)),w=[],Y=0;Y<l.length;Y++){var g=l[Y],O=g.length;if(O>1){var p=g[0];w.push(p.x,p.y,p.z);for(var Q=1;O-1>Q;Q++)p=g[Q],w.push(p.x,p.y,p.z),w.push(p.x,p.y,p.z);p=g[O-1],w.push(p.x,p.y,p.z)}}var V,$,s,B=_(j+".color"),b=_(F),y=0;return b&&($=_(F+".color"),V=_(F+".pattern"),y=_(F+".offset"),s=B),Wc(v.gv,v.data,w,$||B,s?R:_(j+".gradient.color"),D,V||_(j+".pattern"),y,s),l},g.createTubeModel=function(E,F,j,d){for(var U=this,K=U.s,B=K("shape3d.side")||sg,t=K("shape3d.start.angle"),T=K("shape3d.sweep.angle"),h=K(Kl)?K("shape3d.top.cap"):R,o=K(ke)?K("shape3d.bottom.cap"):R,y="flat"===h,Y="flat"===o,X=y&&(d?d.uv:K("shape3d.top.image")),Q=Y&&(d?d.uv:K("shape3d.bottom.image")),P=d?d.uv:K("shape3d.image"),f={vs:[],uv:P?[]:R,top_vs:y?[]:R,top_uv:X?[]:R,bottom_vs:Y?[]:R,bottom_uv:Q?[]:R},O=Bc(E,F,K(Bh),j),G=0,L=O.length;L>G;G++)pn(f,O[G],K(Wn),j,B,t,T,h,o);if(d){var m=[];Em(U.gv,U.data,f,U,U.getBodyColor(),[],d,m),m.length&&(Io(d.vs,m),Io(d.ns,ug(m)))}else U.shapeModel=f;return O},g.getCache=function(){var p=this.info;if(p){var J=p.list;if(J){var P=p.cache;return P||(P=p.cache=Ve(J)),P}}return R}}});var dh=function(P,k){for(var o,v=0,$=P.length,W=0,G=$-1;G>=W;)if(v=f(W+(G-W)/2),o=P[v].length-k,0>o)W=v+1;else{if(!(o>0)){G=v;break}G=v-1}v=G;var M=P[v],V=M.point;return v===$-1||M.length===k||(V=(new Rh).subVectors(P[v+1].point,V).normalize().multiplyScalar(k-M.length).add(V)),{point:V,tangent:M.tangent}},Ve=function(b){for(var Q,U,E=[],z=0,I=0;I<b.length;I++){for(var h=b[I],R=0;R<h.length;R++){Q=h[R],U&&(z+=U.distanceTo(Q));var e=new Rh,v=h[R+1];v?e.subVectors(v,Q):U?e.subVectors(Q,U):e.x=1,e.normalize(),E.push({point:Q,length:z,tangent:e}),U=Q}U=null}return E},Bc=function(g,Z,O,w){O=O||up;for(var G=[],H=0,y=g.size();y>H;H++){var X=g.get(H);G.push(new Rh(X.x,X.e||0,X.y))}Z&&(cb(Z)&&(Z=Z._as),Z.length||(Z=null));for(var i,T,h,m,s,p=[],n=0,e=0,I=Z?Z.length:y;I>e;e++)if(s=Z?Z[e]:0===e?1:2,1===s)p.push(h=[]),h.push(G[n++]);else if(2===s||5===s)if(m=2===s?G[n++]:h[0],w){var d=Z?Z[e+1]:I>e+1?2:R;if(2===d||5===d){var o=h[h.length-1],c=2===d?G[n]:h[0],L=(new Rh).subVectors(o,m),j=(new Rh).subVectors(c,m),N=L.length(),t=j.length();if(N&&t)if(w>N/2&&w>t/2)h.push(m);else for(L.multiplyScalar(k(w,N/2)/N).add(m),j.multiplyScalar(k(w,t/2)/t).add(m),i=new Md(L,m,j).getPoints(O),T=0;O>=T;T++)h.push(i[T])}else h.push(m)}else h.push(m);else if(3===s)for(i=new Md(h[h.length-1],G[n++],G[n++]).getPoints(O),T=1;O>=T;T++)h.push(i[T]);else if(4===s)for(i=new _j(h[h.length-1],G[n++],G[n++],G[n++]).getPoints(O),T=1;O>=T;T++)h.push(i[T]);return p},_f=function(b){for(var S,Q,E=new Rh,H=[],K=[],C=[],Z=0,e=b.length;e>Z;Z++)S=b[Z],Q=b[Z+1],Q?E.subVectors(Q,S):E.subVectors(S,b[Z-1]),H.push(E.normalize().clone());var Y,f,F,m,d=new Rh,R=new Rh,J=new qo,z=1e-4,w=Number.MAX_VALUE,k=H[0],P=K[0]=new Rh,l=C[0]=new Rh;for(f=q(k.x),F=q(k.y),m=q(k.z),w>=f&&(w=f,d.set(1,0,0)),w>=F&&(w=F,d.set(0,1,0)),w>=m&&d.set(0,0,1),R.crossVectors(k,d).normalize(),P.crossVectors(k,R),l.crossVectors(k,P),Z=1;e>Z;Z++)K[Z]=K[Z-1].clone(),C[Z]=C[Z-1].clone(),R.crossVectors(H[Z-1],H[Z]),R.length()>z&&(R.normalize(),Y=g(zq(H[Z-1].dot(H[Z]),-1,1)),K[Z].applyMatrix4(J.makeRotationAxis(R,Y))),C[Z].crossVectors(H[Z],K[Z]);return{B:C,T:H,N:K}},pn=function(){var A=function(D){for(var s=1;s<arguments.length;s++){var O=arguments[s];D.push(O.x,O.y,O.z)}},f=function(J){for(var A=1;A<arguments.length;A++){var C=arguments[A].uv;J.push(C[0],C[1])}},j=function(F,t,B,S,d){var K=-S*i(d),Z=S*n(d);return new Rh(F.x+K*B.x+Z*t.x,F.y+K*B.y+Z*t.y,F.z+K*B.z+Z*t.z)},r=function(T,z,D,e,Y,h,L,K){L=L||b;for(var y=[],P=L/Y,Q=0;Y>=Q;Q++){var J=j(T,z,D,e,Q*P+h);y.push(J),K!=R&&(J.uv=[K,1-Q/Y])}return y},l=function(Q,C,J,d,B,D,o,P,a){a=a||b;var L=C?Q.top_vs:Q.bottom_vs;if(L)for(var w=C?Q.top_uv:Q.bottom_uv,N=a/o,r=0;o>r;r++){var q,c;C?(q=r*N+P,c=(r+1)*N+P):(c=r*N+P,q=(r+1)*N+P),A(L,j(J,d,B,D,q),j(J,d,B,D,c),J),w&&w.push(.5-.5*i(q),.5-.5*n(q),.5-.5*i(c),.5-.5*n(c),.5,.5)}};return function(E,S,h,Z,O,V,g,p,B){var K=S.length;if(K>1){var m,T,c,X,v,N,u,t=_f(S),L=t.T,s=t.N,P=t.B;"flat"===p&&l(E,!0,S[0],P[0],s[0],Z,O,V,g),"flat"===B&&l(E,!1,S[K-1],P[K-1],s[K-1],Z,O,V,g);var n,k,x=[],J=$(O/2),F="round"===p,Q="round"===B,o=S[0],W=L[0],Y=P[0],M=s[0],a=S[K-1],d=L[K-1],C=P[K-1],z=s[K-1];if(F){for(c=1;J>=c;c++)s.splice(0,0,M),P.splice(0,0,Y),L.splice(0,0,W),k=-c/J*Z,S.splice(0,0,W.clone().multiplyScalar(k).add(o)),x[J-c]=y(Z*Z-k*k);K+=J}if(Q){for(c=1;J>=c;c++)s.push(z),P.push(C),L.push(d),k=c/J*Z,S.push(d.clone().multiplyScalar(k).add(a)),x[S.length-1]=y(Z*Z-k*k);K+=J}if(E.uv){var e=0,w=0,U=[];for(h&&(e=h),v=S[0],U[0]=0,c=1;K>c;c++)X=S[c],U[c]=v.distanceTo(X),v=X,h||(e+=U[c]);for(n=[],c=0;K>c;c++)w+=U[c],n[c]=e?w/e:0}for(c=0;K>c;c++){if(X=S[c],N=P[c],u=s[c],m=r(X,N,u,x[c]===H?Z:x[c],O,V,g,n?n[c]:R),T)for(var q=0;O>q;q++){var I=T[q],_=T[q+1]||T[0],j=m[q],b=m[q+1]||m[0];A(E.vs,_,I,j,j,b,_),E.uv&&f(E.uv,_,I,j,j,b,_)}T=m}}}}();vl(V,{getLineLength:function(s){return s[s.length-1].length},getLineOffset:function(C,r){return dh(C,r)},getLineCacheInfo:function(P,t,K,l){return Ve(Bc(P,t,K,l))}});var nq=B.graph3d.RenderLite={},zp=new Array(0),jp=nq.Buffer=function(v,W,d,O){this.gl=v,this.buffer=v.createBuffer(),this.type=W||v.ARRAY_BUFFER,this.drawType=O||v.STATIC_DRAW,this.data=zp,d&&this.upload(d)};jp.prototype.upload=function(C,O,E){E||this.bind();var b=this.gl;C=C||this.data,O=O||0,this.data.byteLength>=C.byteLength?b.bufferSubData(this.type,O,C):b.bufferData(this.type,C,this.drawType),this.data=C},jp.prototype.bind=function(){var h=this.gl;h.bindBuffer(this.type,this.buffer)},jp.createVertexBuffer=function(F,J,E){return new jp(F,F.ARRAY_BUFFER,J,E)},jp.createIndexBuffer=function(J,Z,L){return new jp(J,J.ELEMENT_ARRAY_BUFFER,Z,L)},jp.create=function(R,P,L,f){return new jp(R,P,f)},jp.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var pf=nq.Shader=function(p,J,U){this.gl=p,this.program=Tp(p,J,U),this.attributes=Wl(p,this.program);var I=$b(p,this.program);this.uniforms=vb(p,I)};pf.prototype.bind=function(){this.gl.useProgram(this.program)},pf.prototype.destroy=function(){this.gl};var Tp=function(h,R,U){var M=$e(h,h.VERTEX_SHADER,R),u=$e(h,h.FRAGMENT_SHADER,U);h.getShaderParameter(u,h.COMPILE_STATUS)||console.error(h.getError());var z=h.createProgram();return h.attachShader(z,M),h.attachShader(z,u),h.linkProgram(z),h.getProgramParameter(z,h.LINK_STATUS)||(console.error("Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",h.getProgramParameter(z,h.VALIDATE_STATUS)),console.error("gl.getError()",h.getError()),""!==h.getProgramInfoLog(z)&&console.warn("Warning: gl.getProgramInfoLog()",h.getProgramInfoLog(z)),h.deleteProgram(z),z=null),h.deleteShader(M),h.deleteShader(u),z},$e=function(p,j,T){var q=p.createShader(j);return p.shaderSource(q,T),p.compileShader(q),p.getShaderParameter(q,p.COMPILE_STATUS)?q:(console.log(p.getShaderInfoLog(q)),null)},$b=function(E,U){for(var _={},V=E.getProgramParameter(U,E.ACTIVE_UNIFORMS),L=0;V>L;L++){var h=E.getActiveUniform(U,L),O=h.name.replace(/\[.*?\]/,""),r=mc(E,h.type);_[O]={type:r,size:h.size,location:E.getUniformLocation(U,O),value:kg(r,h.size)}}return _},Wl=function(J,G){for(var k={},Q=J.getProgramParameter(G,J.ACTIVE_ATTRIBUTES),M=0;Q>M;M++){var H=J.getActiveAttrib(G,M),U=mc(J,H.type);k[H.name]={type:U,size:fl(U),gl:J,location:J.getAttribLocation(G,H.name),pointer:Yn}}return k},Yn=function(V,N,m,F,K){var w=this.gl;w.enableVertexAttribArray(this.location),V instanceof nq.Buffer||(V=nq.Buffer.createVertexBuffer(w,V)),w.bindBuffer(V.type,V.buffer),w.vertexAttribPointer(this.location,this.size,N||w.FLOAT,m||!1,F||0,K||0)},fl=function(P){return $c[P]},$c={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},mc=function(a,t){if(!ec){var R=w.keys(Zd);ec={};for(var X=0;X<R.length;++X){var F=R[X];ec[a[F]]=Zd[F]}}return ec[t]},ec=null,Zd={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},kg=function(t,A){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*A);case"vec3":return new Float32Array(3*A);case"vec4":return new Float32Array(4*A);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*A);case"ivec3":return new Int32Array(3*A);case"ivec4":return new Int32Array(4*A);case"bool":return!1;case"bvec2":return xp(2*A);case"bvec3":return xp(3*A);case"bvec4":return xp(4*A);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},xp=function(F){for(var w=new Array(F),v=0;v<w.length;v++)w[v]=!1;return w},vb=function(P,Q){var E={data:{}};E.gl=P;for(var y=w.keys(Q),U=0;U<y.length;U++){var z=y[U],F=z.split("."),p=F[F.length-1],X=Wg(F,E),b=Q[z];X.data[p]=b,X.gl=P,w.defineProperty(X,p,{get:Ag(p),set:ic(p,b)})}return E},Ag=function(y){var a=Xc.replace("%%",y);return new Function(a)},ic=function(W,g){var w,t=wi.replace(/%%/g,W);return w=1===g.size?Aj[g.type]:oq[g.type],w&&(t+="\nthis.gl."+w+";"),new Function("value",t)},Wg=function(U,j){for(var m=j,C=0;C<U.length-1;C++){var M=m[U[C]]||{data:{}};m[U[C]]=M,m=M}return m},Xc=["return this.data.%%.value;"].join("\n"),wi=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),Aj={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},oq={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},Fh=B.Light=function(){Ep(Fh,this),this.s(ef,v[ef]),this.s(Yk,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};ni("Light",kk,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(n,p,d){Fh.superClass.onStyleChanged.apply(this,arguments),n===ef&&this.s("shape3d.color",d)}});var Gr=pe.Graph3dView=function(g,f){var $=this;$._webGLVersion=1,$._attributes=f||V.graph3dViewAttributes,$._25I={},$._view=wn(1,$);var J=$._canvas=ae($._view);h(J,"webglcontextlost",function(V){V.preventDefault(),Oi($),$._26I&&$._doBufferGC($._26I,!0),$._26I=R,$._1o.texture=R,$._35O=!0}),h(J,"webglcontextrestored",function(){$._35O=!1,$.iv()}),$._batchIndexMap={},$._batchModelMap={},$._wireframeIndexMap={},$._wireframeModelMap={},$._wireframeIndexMapSwap={},$._wireframeModelMapSwap={},$._polylineIndexMap={},$._polylineIndexMap={},$._polylineIndexMapSwap={},$._polylineIndexMapSwap={},$._8O=[],$._7O=Yl(),$._6O=Yl(),$._1o=new Gi($),$._30O=new Xj($),$._31O=new ce($),$._32O=new Ld($),$._raycaster=new Sq($),$._highlightHelper=new Ij($),$._postProcessing=new Hf($),$._cameras=[],$._cameraId=0,$.vr=new Kj($),$._33Q=!0,$._eye=er(V.graph3dViewEye),$._center=er(V.graph3dViewCenter),$._up=er(V.graph3dViewUp),$._lightChanged=!1,$._59O=[],$._spots=[],$._dirs=[],$._frameId=0,$.overlappingBox=new Sn($),$.dm(g?g:new Ah),$._coreInteractor=new Cd(this),$.setInteractors([new Ae($)]),$._initView()},Um={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},Me=function(V,Q,p,n){V.clearColor(0,0,0,0),V.clearDepth(1),V.enable(V.DEPTH_TEST),V.depthFunc(V.LEQUAL),V.disable(V.CULL_FACE),V.enable(V.BLEND),V.blendFuncSeparate(V.SRC_ALPHA,V.ONE_MINUS_SRC_ALPHA,V.ONE,V.ONE_MINUS_SRC_ALPHA),V.useProgram(p),ws(V,p.uBrightness,1),ws(V,p.uOpacity,1),ws(V,p.uPartOpacity,1),ws(V,p.uPick,n._picking),ws(V,p.uTexture,!1),ws(V,p.uBlendTexture,!1),ws(V,p.uAlphaTest,v.alphaTest),ws(V,p.uTransparent,!1),ws(V,p.uFix,!1),ws(V,p.uBatchColor,!1),ws(V,p.uBatchBlend,!1),ws(V,p.uBatchBrightness,!1),ws(V,p.uReflectivity,n._envmapReflectivity),ws(V,p.uCameraPosition,Q.getEye()),ws(V,p.uPMatrix,n._projectMatrix),ws(V,p.uViewMatrix,n._viewMatrix),Q.bindEnvMap(V),n._picking||(ep(Q,V,p),Q._fogDisabled||(ws(V,p.uFogColor,Q._fogColor),ws(V,p.uFogNear,Q._fogNear),ws(V,p.uFogFar,Q._fogFar))),Nd(V,p.aPosition),Nd(V,p.aNormal),Wk(V,p.aUv),Wk(V,p.aBatchColor),Wk(V,p.aBatchBlend),Wk(V,p.aBatchBrightness),Wk(V,p.aLineDistance),V.depthMask(!0)},Wo=0;Wh("Graph3dView",w,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",kp,Vd,"firstPersonMode",Vh,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",kr,xn,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:V.graph3dViewEditHelperDisabled,_blockSelectable:V.graph3dViewBlockSelectable,_devicePixelRatio:H,_boundaries:H,_moveStep:V.graph3dViewMoveStep,_rotateStep:V.graph3dViewRotateStep,_pannable:V.graph3dViewPannable,_rotatable:V.graph3dViewRotatable,_walkable:V.graph3dViewWalkable,_resettable:V.graph3dViewResettable,_zoomable:V.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:V.graph3dViewFirstPersonMode,_mouseRoamable:V.graph3dViewMouseRoamable,_gridVisible:V.graph3dViewGridVisible,_gridSize:V.graph3dViewGridSize,_gridGap:V.graph3dViewGridGap,_gridColor:V.graph3dViewGridColor,_originAxisVisible:V.graph3dViewOriginAxisVisible,_centerAxisVisible:V.graph3dViewCenterAxisVisible,_axisXColor:V.graph3dViewAxisXColor,_axisYColor:V.graph3dViewAxisYColor,_axisZColor:V.graph3dViewAxisZColor,_ortho:V.graph3dViewOrtho,_orthoWidth:V.graph3dViewOrthoWidth,_fovy:V.graph3dViewFovy,_near:V.graph3dViewNear,_far:V.graph3dViewFar,_headlightColor:V.graph3dViewHeadlightColor,_headlightIntensity:V.graph3dViewHeadlightIntensity,_headlightRange:V.graph3dViewHeadlightRange,_headlightAmbientIntensity:V.graph3dViewHeadlightAmbientIntensity,_headlightDisabled:V.graph3dViewHeadlightDisabled,_rectSelectable:V.graph3dViewRectSelectable,_rectSelectBackground:V.graph3dViewRectSelectBackground,_editSizeColor:V.graph3dViewEditSizeColor,_autoMakeVisible:Mi,_fogDisabled:V.graph3dViewFogDisabled,_fogColor:V.graph3dViewFogColor,_fogNear:V.graph3dViewFogNear,_fogFar:V.graph3dViewFogFar,_pickerResolution:V.graph3dViewPickerResolution,_dashDisabled:V.graph3dViewDashDisabled,_batchColorDisabled:V.graph3dViewBatchColorDisabled,_batchBlendDisabled:V.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:V.graph3dViewBatchBrightnessDisabled,addCamera:function(u){var Y=w.freeze({id:this._cameraId++,priority:u.priority||0,ignoreInPick:!!u.ignoreInPick,useDefaultProgram:!!u.useDefaultProgram,render:u.render});
this._cameras.push(Y),this._cameras.sort(function(L,K){return L.priority!==K.priority?L.priority-K.priority:L.id-K.id})},setEye:function(n,o,X){1===arguments.length&&(o=n[1],X=n[2],n=n[0]);var U=this._eye;U[0]=n,U[1]=o,U[2]=X,this.fp(kr,R,U)},setCenter:function(z,F,d){1===arguments.length&&(F=z[1],d=z[2],z=z[0]);var s=this._center;s[0]=z,s[1]=F,s[2]=d,this.fp(xn,R,s)},setUp:function($,S,v){1===arguments.length&&(S=$[1],v=$[2],$=$[0]);var F=this._up;F[0]=$,F[1]=S,F[2]=v,this.fp("up",R,F)},getDevicePixelRatio:function(){return this._devicePixelRatio||qm},isTransparentMask:function(C){return C.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var t=this,$=t._aspect;return $?$:($=t.getWidth()/t.getHeight(),$||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(i){var W=this,d=W._dataModel,s=W._selectionModel;d!==i&&(d&&(d.ump(W.handleDataModelPropertyChange,W),d.umm(W.handleDataModelChange,W),d.umd(W.handleDataPropertyChange,W),s||d.sm().ums(W.handleSelectionChange,W)),W._dataModel=i,i.mp(W.handleDataModelPropertyChange,W),i.mm(W.handleDataModelChange,W),i.md(W.handleDataPropertyChange,W),s?s._21I(i):i.sm().ms(W.handleSelectionChange,W),W._postProcessing.handleDataModleChange(d,i),W.invalidateAll(!0),W.invalidateLight(),W.fp(Un,d,i),W._canvas.style.background=i.getBackground()||"")},handleDataModelPropertyChange:function(M){if("background"===M.property){var k=this._canvas.style.background,r=M.newValue||"";this._canvas.style.background=r,this.fp("canvasBackground",k,r)}else"envmap"===M.property&&this.iv()},handleDataPropertyChange:function(v){var m=v.data;this.invalidateData(m),po(m)&&"s:light.type"===v.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(G){var v=this,O=G.property;v.iv(),v._18Q=R,"eye"===O?v._33Q=!0:"devicePixelRatio"===O?v._42(R,v.getDevicePixelRatio()):Um[O]&&Oi(v)},_5O:function(n){var I=n._22Q();return I?new I(this,n):R},getData3dUI:function(u){var P=this._25I[u._id];return P===H&&(P=this._5O(u),this._25I[u._id]=P),P},invalidateAll:function($){var F=this;if($){for(var u in F._25I){var M=F._25I[u];M&&M.dispose()}F._25I={},F.iv(),Nk(F)}else Nk(F),F.dm().each(function(m){F.invalidateData(m)})},invalidateSelection:function(){var Q=this;Q.sm().each(function(k){Q.invalidateData(k)})},invalidateData:function(V){var c=this,U=c.getData3dUI(V);U&&(U.iv(),c.iv()),Nk(c,V)},getShape3dText:function(E){return E.getStyle("shape3d.text")||this.getLabel(E)},invalidateBatch:function(u){var p=this,b=p._batchModelMap,O=b[u],e=[],C={};if(O){O.ds.forEach(function(D){var Z=p.getData3dUI(D);Z&&Z.iv(),delete p._batchIndexMap[D._id],e.push(D._id)}),delete b[u];for(var o,V,B,c,S,z,g,f,v,x=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],T=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],R=0;R<x.length;R++){var k=p[x[R]],d=p[T[R]];for(C={},f=0;f<e.length;f++){var i=d[e[f]];if(i){delete d[e[f]],v=i.batch,o=k[v];var J=i.begin,U=i.size,q=3*J,m=3*U,W=4*J,I=4*U;for(V=o.ds,B=o.vs,c=o.cs,S=o.ps,z=o.ls,g=i.index,o.invalidate=!0,V[g]=H,g=q;q+m>g;g++)B[g]=H;for(g=W;W+I>g;g++)c[g]=H;for(g=W;W+I>g;g++)S[g]=H;if(z)for(g=q;q+m>g;g++)z[g]=H;C[v]=!0}}for(v in C){o=k[v],V=o.ds,B=o.vs,c=o.cs,S=o.ps,z=o.ls;var $=[];for(g=0;g<V.length;g++)V[g]!==H&&$.push(V[g]);if(0===$.length)delete k[v];else{for(o.ds=$,$=[],g=0;g<B.length;g++)B[g]!==H&&$.push(B[g]);for(o.vs=$,$=[],g=0;g<c.length;g++)c[g]!==H&&$.push(c[g]);for(o.cs=$,$=[],g=0;g<S.length;g++)S[g]!==H&&$.push(S[g]);if(o.ps=$,z){for($=[],g=0;g<z.length;g++)z[g]!==H&&$.push(z[g]);o.ls=$}}}}p.iv()}},handleDataModelChange:function(y){var K=this,r=y.kind,g=y.data;if("add"===r)K.invalidateData(g),$k(g)&&g.getEdgeGroup()&&g.getEdgeGroup().eachSiblingEdge(K.invalidateData,K),po(g)&&K.invalidateLight();else if(r===Zf){var X=g._id,Q=K._25I[X];Q&&(Q.dispose(),delete K._25I[X],K.iv()),g===K._currentSubGraph&&K.setCurrentSubGraph(R),Nk(K,g),po(g)&&K.invalidateLight()}else r===rq&&(K.invalidateAll(!0),K.setCurrentSubGraph(R),Nk(K),K.invalidateLight())},toCanvas:function(W,X,N){var q=this,a=q.getGL();if(q.validate(),W){var m=a.getParameter(a.COLOR_CLEAR_VALUE);Oe(a,W)}q._42(R,1);var C=q.getWidth(),$=q.getHeight(),T=new Uint8Array(4*C*$),v=ae(),Q=v.getContext("2d");a.readPixels(0,0,C,$,a.RGBA,a.UNSIGNED_BYTE,T),Pb(v,C,$,1);for(var U=Q.getImageData(0,0,C,$),o=U.data,h=0;h<o.length;h+=4){var b=h/4,w=f(b/C),_=b-w*C;b=4*(($-1-w)*C+_),o[b]=T[h],o[b+1]=T[h+1],o[b+2]=T[h+2],o[b+3]=T[h+3]}if(Q.putImageData(U,0,0),W&&Oe(a,m),q._42(R,q.getDevicePixelRatio()),X&&N){var F=ae(),u=F.getContext("2d");return X=X,N=N,Pb(F,X,N,1),V.drawImage(u,v,0,0,X,N),F}return v},toDataURL:function(M,c){var $=this,d=$.getGL();if($.validate(),M){var N=d.getParameter(d.COLOR_CLEAR_VALUE);Oe(d,M)}$._42(R,1);var y=$._canvas.toDataURL(c||"image/png",1);return M&&Oe(d,N),$._42(R,$.getDevicePixelRatio()),y},getGL:function(){var b=this._26I;if(b)return this.acquireProgram(),b;var F=this,O=F._canvas,B=F._attributes;try{b=O.getContext("webgl2",B)||O.getContext("experimental-webgl2",B),b&&(F._webGLVersion=2,F._26I=b)}catch(C){}if(!b)try{b=O.getContext("webgl",B)||O.getContext("experimental-webgl",B)}catch(C){throw new Error("WebGL not supported")}if(!b)throw new Error("WebGL not supported");F._26I=b,F._glExtensions=new K(b),F._glCapabilities=new T(b,F._glExtensions),F._2O={},b._compiledShader={},b._emptyTexture=Ai(b),b._emptyBlendTexture=Ai(b),b._bufPool={},b._id=++Wo,F._buffer={vs:yd(b),ns:yd(b),is:yd(b),uv:yd(b),batchColor:yd(b),batchBlend:yd(b),batchBrightness:yd(b),lineDistance:yd(b)},F._1O=Yr(b);var r=F._cube={vs:yd(b),ns:yd(b),is:yd(b),uv:yd(b)};return qr(b,r.vs,Tg),qr(b,r.ns,lf),qr(b,r.uv,Bp),Xg(b,r.is,Gb),F.acquireProgram(),b},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<16?null:this.dm().getEnvmap()},acquireProgram:function(){var L=this,N=L._26I;if(N){var f=V.getImage(L.getEnvmap()),M=f&&f.tagName?!0:!1,e=L._prg&&L._prg.envMapFlag?!0:!1;if(!L._prg||M!==e){var d=L._prg=N.createProgram();if(!d)return R;d.envMapFlag=M;var U=L._dirs.length,b=L._spots.length,w=L._59O.length,H=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogNear","uFogFar"];U&&H.push("uDirColor","uDirDirection"),b&&H.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),w&&H.push("uPointColor","uPointRange","uPointPosition"),Oe(N,[0,0,0,0]),N.clearDepth(1),N.enable(N.DEPTH_TEST),N.depthFunc(N.LEQUAL),N.enable(N.BLEND),N.blendFuncSeparate(N.SRC_ALPHA,N.ONE_MINUS_SRC_ALPHA,N.ONE,N.ONE_MINUS_SRC_ALPHA),Lc||(Jq=ql(Jq.substring(0,Jq.indexOf("^#"))),ih=ql(ih),Lc=!0);var n=["#define MAX_DIR "+U,"#define MAX_SPOT "+b,"#define MAX_POINT "+w,L._fogDisabled?"":"#define FOG",L._dashDisabled?"":"#define DASH",M?"#define USE_ENVMAP":"",L.isOrtho()?"#define ORTHOGRAPHIC":"",L._batchColorDisabled?"":"#define BATCHCOLOR",L._batchBlendDisabled?"":"#define BATCHBLEND",L._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),A=vp(N,d,N.VERTEX_SHADER,Jq.replace("PREFIX",n));N.getShaderParameter(A,N.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",N.getShaderInfoLog(A));var m=vp(N,d,N.FRAGMENT_SHADER,ih.replace("PREFIX",n));N.getShaderParameter(m,N.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",N.getShaderInfoLog(m)),Ro?H.push("aPosition"):(d.aPosition=0,N.bindAttribLocation(d,0,"aPosition")),N.linkProgram(d),H.forEach(function(j){d[j]=/^u/.test(j)?N.getUniformLocation(d,j):N.getAttribLocation(d,j)}),N.useProgram(d),N.deleteShader(A),N.deleteShader(m)}}},getBrightness:function(B){var M=B.s("brightness"),D=this.isSelected(B)?B.s("select.brightness"):R;return M==R?D:D==R?M:M*D},setHighlightMode:function(T){var $;$="selection"===T||"selected"===T?Ij.Mode.Selection:"mouseover"===T||"hover"===T?Ij.Mode.MouseOver:"style"===T?Ij.Mode.Style:Ij.Mode.Disable;var p=this._highlightHelper.mode;this._highlightHelper.mode=$,this.firePropertyChange("highlightMode",p,$)},getHighlightMode:function(){var p=this._highlightHelper.mode;return p===Ij.Mode.Selection?"selected":p===Ij.Mode.MouseOver?"hover":p===Ij.Mode.Style?"style":"disabled"},getHighlightColor:function(){return this._highlightHelper.color||v["highlight.color"]},setHighlightColor:function(q){var A=this._highlightHelper.color;this._highlightHelper.color=q,this.firePropertyChange("highlightColor",A,q)},getHighlightWidth:function(){return this._highlightHelper.width||v["highlight.width"]},setHighlightWidth:function(e){var M=this._highlightHelper.width;this._highlightHelper.width=e,this.firePropertyChange("highlightWidth",M,e)},bindEnvMap:function(e){var H=this,F=H._prg,B=5,a=H.getEnvmap(),l=V.getImage(a);if(l&&l.tagName){if(a!==H._lastEnvMap){l=V.resizeImagePOT(l,!0),H._envMapTexture&&e.deleteTexture(H._envMapTexture);var p=H._envMapTexture=e.createTexture();e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_CUBE_MAP,p),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,l),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,l),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,l),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,l),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,l),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,l),e.bindTexture(e.TEXTURE_CUBE_MAP,null),H._lastEnvMap=a}e.activeTexture(e.TEXTURE0+B),e.bindTexture(e.TEXTURE_CUBE_MAP,H._envMapTexture),e.uniform1i(F.uEnvMap,B)}},getWireframe:function(j){var u=j.s("wf.visible"),W=j.s("wf.width");return u===!0||W>0&&"selected"===u&&this.isSelected(j)?{color:j.s("wf.color"),width:W,"short":j.s("wf.short"),mat:j.s("wf.mat")}:void 0},_transformPointToViewSpace:function(u){var m=[u[0],u[1],u[2]];return dm(m,this._viewMatrix),m},_transformDirectionToViewSpace:function(G,Q){var W=[G[0],G[1],G[2]];dm(W,this._viewMatrix);var r=Q?[Q[0],Q[1],Q[2]]:[0,0,0];dm(r,this._viewMatrix);var $=r[0]-W[0],L=r[1]-W[1],C=r[2]-W[2],Z=Math.sqrt($*$+L*L+C*C);return Z?[$/Z,L/Z,C/Z]:[$,L,C]},getWireframeGeometry:function(J){return J.s("wf.geometry")?{color:J.s("wf.color"),width:J.s("wf.width"),mat:J.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(Y){return Y.s("body.color")},getMat:function(d){return d.getMat?d.getMat():d.s("mat")},getFaceMat:function(Y,R){return Y.getFaceMat?Y.getFaceMat(R):Y.s(R+".mat")},getFaceBlend:function(x,q){return x.s(q+".blend")||x.s("all.blend")},getFaceColor:function(T,k){return T.s(k+".color")||T.s("all.color")},getFaceImage:function(x,u){return x.s(u+".image")||x.s("all.image")},getFaceBlendImage:function(r,Q){return r.s(Q+".blend.image")||r.s("all.blend.image")},getFaceDiscardSelectable:function(t,e){var h=t.s(e+".discard.selectable");return h==R?t.s("all.discard.selectable"):h},getFaceUv:function(K,Q){return K.s(Q+".uv")||K.s("all.uv")},getFaceUvOffset:function(O,N){return O.s(N+".uv.offset")||O.s("all.uv.offset")},getFaceUvScale:function(t,X){return t.s(X+".uv.scale")||t.s("all.uv.scale")},getFaceLight:function(M,O){var p=M.s(O+".light");return p==R?M.s("all.light"):p},getFaceVisible:function(m,E){var C=m.s(E+".visible");return C==R?m.s("all.visible"):C},getFaceOpacity:function(y,I){var d=y.s(I+".opacity");return d==R?y.s("all.opacity"):d},getFaceTransparent:function(u,Y){var g=u.s(Y+".transparent");return g==R?u.s("all.transparent"):g},getFaceReverseColor:function(B,_){return B.s(_+".reverse.color")||B.s("all.reverse.color")},getFaceReverseFlip:function(F,Q){var G=F.s(Q+".reverse.flip");return G==R?F.s("all.reverse.flip"):G},getFaceReverseCull:function(Z,u){var Y=Z.s(u+".reverse.cull");return Y==R?Z.s("all.reverse.cull"):Y},getTextureMap:function(){return this._2O},deleteTexture:function($){var Q=this,w=Q._2O[$];w&&(delete Q._2O[$],Q.getGL().deleteTexture(w))},invalidateCachedTexture:function(P){var N=this.getData3dUI(P);N.invalidateCachedTexture(this.getGL()),this.invalidateData(P)},invalidateShape3dCachedImage:function(F){this.invalidateCachedTexture(F)},invalidateCachedGeometry:function(k){var G=this.getData3dUI(k);G.invalidateCachedGeometry(),this.invalidateData(k)},isInteractive:function(e){return e.s("interactive")},getTexture:function(t,x,q){if(!t)return R;var A=this,w=A.getGL(),b=A._2O[t];if(!b){var Y=Tn(t),s={mipmapMaxLevel:x?x.s("texture.mipmap.max"):H};if(!Y)return w._emptyTexture;if(Y.uuid||(Y.uuid=B.Math.generateUUID()),Y.tagName){if(Y.dynamic)return Yr(w,Y,A._1O,s);b=A._2O[t]=Yr(w,Y,H,s)}else{var u,l=x&&(x.s("texture.cache")||x.s("shape3d.image.cache")||Y.textureCache),J=A.vr.isPresenting();if(J&&(x._textureUpdateFrame===w._renderInfo.frame?l=!0:x._textureUpdateFrame=w._renderInfo.frame),l&&(u=A.getData3dUI(x),b=u.getCachedTexture(q)),!b){var e=w._renderInfo.textureCache;if(l){if(e.time>V.graph3dMaxVectorCacheTime)return A.redraw(),w._emptyTexture;if(!Hl(Y,x))return w._emptyTexture}var S;x&&(1!==x.s("texture.scale")?S=x.s("texture.scale"):1!==x.s("shape3d.texture.scale")&&(S=x.s("shape3d.texture.scale"))),S||(S=1);var L=x&&(x.s("fixSizeOnScreen")||x.s("shape3d.fixSizeOnScreen"));L?"number"==typeof L&&(S*=0>L?1:L):x&&(x.s("vector.dynamic")||x.s("shape3d.vector.dynamic"))&&(u||(u=A.getData3dUI(x)),L=u.getVectorDynamicSize());var Q,z,p,U=x&&x.s("shape3d");"billboard"===U?p=x.getTall()/x.getWidth():"plane"===U&&(p=x.getHeight()/x.getWidth());var i=gs(Y,x);if(L){var y=A.getDevicePixelRatio();Q=L[0]>0?L[0]*y:S*i*y,z=L[1]>0?L[1]*y:S*(p?rr(Y,x,A,Math.min(4096,i*p)):rr(Y,x))*y}else Q=S*i,z=S*(p?rr(Y,x,A,Math.min(4096,i*p)):rr(Y,x));if(Q>=1&&z>=1){var K=0;(l||J)&&(K=Date.now());var k=Vk(Q,z);if(!u&&x&&(u=A.getData3dUI(x)),u&&u.interactiveInfo){var d=t;"object"==typeof d&&(d=d.uuid||(d.uuid=B.Math.generateUUID()));var F=u.interactiveInfo[d]={};k.interactiveInfo=F.bodyInfo={compInfos:[],matrix:new Rl,rect:{x:0,y:0,width:Q,height:z}}}Fq(k,Y,0,0,Q,z,x,A),k.interactiveInfo&&(k.interactiveInfo=null),k.restore(),e.count++,e.pixels+=Q*z;var j=L?w.NEAREST:w.LINEAR;s.minFilter=x.s("texture.filter.min")||x.s("texture.filter")||j,s.magFilter=x.s("texture.filter.mag")||x.s("texture.filter")||j,l||J?(b=Yr(w,Jg,null,s),u.setCachedTexture(b,q),e.time+=Date.now()-K,Jg=null):b=Yr(w,Jg,A._1O,s)}}}}return b},redraw:function(){this.iv()},validateImpl:function(){var D=this;if(D._lightChanged){D._lightChanged=!1;var P=[],k=[],c=[];D.dm().each(function(Z){if(po(Z)){var h=Z.s("light.type");h===Fk?P.push(Z):h===en?k.push(Z):h===xm&&c.push(Z)}}),(P.length!==D._59O.length||k.length!==D._spots.length||c.length!==D._dirs.length)&&Oi(D),D._59O=P,D._spots=k,D._dirs=c}D._42(),D._1o.iv()},getRenderInfo:function(){var A=this.getGL();return A?A._renderInfo:void 0},getDebugTip:function(){var V=this,P=V.getRenderInfo();if(P){var m=V.getGL()._validBufCount||0,H="Draw Calls: "+P.calls+"<br/>"+"Vertices: "+P.vertices+"<br/>"+"Faces: "+P.faces+"<br/>"+"Lines: "+P.lines+"<br/>"+"Buffers: "+m+"<br/>"+"Cache Models: "+w.keys(vf).length+"<br/>"+"Shape3d Models: "+w.keys(vr).length;V.vr.isPresenting()&&(H+="<br/>VR fps: "+V.vr.getFps());var T=P.textureCache.count;if(H+="<br/>2D Dynamic Textures: "+P.textureCache.count,T>0){var U,y=P.textureCache.pixels;U=y>1e6?Math.round(y/1e6)+"M":y>1e3?Math.round(y/1e3)+"K":Math.round(y),H+="<br/>2D Dynamic pixels: "+U}return H}},_42:function(P,L){var V=this;if(!V._35O&&(!bo||Je(bo))){var K,T;P&&(P instanceof kk?T=P:K=P);var W=V._canvas,b=V.getGL(),M=V._prg;if(b){var s=V.getWidth(),c=V.getHeight();if(s&&c){L?P||Pb(W,s,c,L):(L=V.getDevicePixelRatio(),P||s===W.clientWidth&&c===W.clientHeight||(Pb(W,s,c,L),s&&Math.abs(b.drawingBufferWidth-s*L)>1&&(V.setDevicePixelRatio(L=b.drawingBufferWidth/s),Pb(W,s,c,L)))),b.clear(b.COLOR_BUFFER_BIT),V.drawFilter||(b._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:P?V._frameId:++V._frameId,textureCache:{time:0,count:0,pixels:0},reflectDepth:0});var O,k=this._cameras,S=0,f=k.length,Z=!1,I=B.Default.cameraPriority.skybox,d=B.Default.cameraPriority.main,D=B.Default.cameraPriority.top,$=s*L,m=c*L,J=function(){V.overlappingBox.clear(),V._81O=R,b.clear(b.DEPTH_BUFFER_BIT),b._picking=!!P;var C={_picking:!!P,_envmapReflectivity:V._envmapReflectivity||.5,_projectMatrix:V._projectMatrix=Fd(V),_viewMatrix:rj(V,V._7O)};if(V._viewMatrix=Bs(V._7O),T){Me(b,V,M,C);var G=b.getParameter(b.COLOR_CLEAR_VALUE);b.clearColor(0,0,0,0),b.disable(b.BLEND),Wk(b,M.aNormal),qr(b,V._cube.vs,R,M.aPosition),Xg(b,V._cube.is),Sd(T,V,_c,0),Sd(T,V,ck,6),Sd(T,V,vk,12),Sd(T,V,ej,18),Sd(T,V,gf,24),Sd(T,V,fm,30),Nd(b,M.aNormal),Oe(b,G)}else if(K){for(K.value=2;f>S;S++)if(O=k[S],!O.ignoreInPick){if(O.priority>=d)break;O.useDefaultProgram&&Me(b,V,M,C),O.render(b,V,K)}Me(b,V,M,C);var G=b.getParameter(b.COLOR_CLEAR_VALUE);for(b.clearColor(0,0,0,0),b.disable(b.BLEND),b.textureBatch&&!Je[(ONE_FRAME_TIME-6)/2]||V._95I(b,M,K),rh(V,K),tq(V,V._polylineModelMap,K),tq(V,V._wireframeModelMap,K),ws(b,M.uTransparent,!0),V._95I(b,M,K,!0),rh(V,K,!0),tq(V,V._polylineModelMap,K,!0),tq(V,V._wireframeModelMap,K,!0),ws(b,M.uTransparent,!1);f>S;S++)if(O=k[S],!O.ignoreInPick){if(O.priority>=D)break;O.useDefaultProgram&&Me(b,V,M,C),O.render(b,V,K),Z=!0}for(Z&&(Me(b,V,M,C),Z=!1),b.clear(b.DEPTH_BUFFER_BIT),V._swapLineMap(),V._95I(b,M,K,!1,!0),tq(V,V._polylineModelMap,K),tq(V,V._wireframeModelMap,K),V._swapLineMap(),V._swapLineMap(),V._95I(b,M,K,!1,!0),tq(V,V._polylineModelMap,K),tq(V,V._wireframeModelMap,K),ws(b,M.uTransparent,!0),V._95I(b,M,K,!0,!0),tq(V,V._polylineModelMap,K,!0),tq(V,V._wireframeModelMap,K,!0),ws(b,M.uTransparent,!1),V._swapLineMap(),b.disable(b.DEPTH_TEST),V.drawFilter||V._30O._42(b,M,K),b.enable(b.DEPTH_TEST);f>S;S++)O=k[S],O.ignoreInPick||(O.useDefaultProgram&&Me(b,V,M,C),O.render(b,V,K));Oe(b,G)}else{for(;f>S&&(O=k[S],!(O.priority>=I));S++)O.useDefaultProgram&&Me(b,V,M,C),O.render(b,V);for(Me(b,V,M,C),b.disable(b.BLEND),V.drawSky(b,M),V.drawReflectors(b,$,m,J,P)&&(C._projectMatrix=V._projectMatrix=Fd(V),C._viewMatrix=rj(V,V._7O),V._viewMatrix=Bs(V._7O),Me(b,V,M,C));f>S&&(O=k[S],!(O.priority>=d));S++)O.useDefaultProgram&&Me(b,V,M,C),O.render(b,V),Z=!0;for(Z&&(Me(b,V,M,C),Z=!1),V._31O._42(b,M),V._95I(b,M),rh(V),tq(V,V._polylineModelMap),tq(V,V._wireframeModelMap),b.enable(b.BLEND),b.depthMask(!1),ws(b,M.uTransparent,!0),V._95I(b,M,R,!0),rh(V,R,!0),tq(V,V._polylineModelMap,R,!0),tq(V,V._wireframeModelMap,R,!0),b.depthMask(!0),ws(b,M.uTransparent,!1);f>S&&(O=k[S],!(O.priority>=D));S++)O.useDefaultProgram&&Me(b,V,M,C),O.render(b,V),Z=!0;for(Z&&(Me(b,V,M,C),Z=!1),b.clear(b.DEPTH_BUFFER_BIT),V._swapLineMap(),b.disable(b.BLEND),V._95I(b,M,R,!1,!0),tq(V,V._polylineModelMap),tq(V,V._wireframeModelMap),b.enable(b.BLEND),ws(b,M.uTransparent,!0),b.depthMask(!1),V._95I(b,M,R,!0,!0),tq(V,V._polylineModelMap,R,!0),tq(V,V._wireframeModelMap,R,!0),b.depthMask(!0),ws(b,M.uTransparent,!1),V._swapLineMap(),b.disable(b.DEPTH_TEST),b.disable(b.BLEND),V._32O._42(b,M),V._30O._42(b,M),V._highlightHelper._42(b,M),b.enable(b.DEPTH_TEST);f>S;S++)O=k[S],O.useDefaultProgram&&Me(b,V,M,C),O.render(b,V)}qr(b,R),Xg(b,R)},h=!1,q=V.vr;q.enable&&q._42(b,$,m,J)&&(h=!0);var z=V.envRenderer;z&&z.enable&&z._42(b,$,m,J)&&(h=!0);var e=V._postProcessing;e._42(b,$,m,J,P)&&(h=!0),h||(V.setViewport(b,0,0,s*L,c*L),J()),V._33Q=!1,V.drawFilter||V.countFrame(),V._doBufferGC(b)}}}},drawReflectors:function(y,w,q,Y,x){y._renderInfo.reflectDepth++;var _,W,i,O=this,n=O._dataModel.getReflectors(),o=!1;for(_ in n)W=n[_],O.isVisible(W)&&(i=O.getData3dUI(W),i&&i.drawReflector(y,w,q,Y,x)&&(o=!0));return y._renderInfo.reflectDepth--,o},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(D,S){return this._postProcessing.enableModule(D,S)},getPostProcessingModule:function(A){return this._postProcessing.getModule(A)},getPostProcessingValue:function(i,M){var p=this._postProcessing.getModule(i);return p?p[M]:H},setPostProcessingValue:function(N,_,l){var B=this.getPostProcessingValue(N),c=this._postProcessing.getModule(N,_);c&&B!==l&&("enable"===_?this.enablePostProcessing(N,l):c[_]=l,this.firePropertyChange("postProcessing."+N+"."+_,B,l))},setViewport:function(N,R,r,U,J){this._viewport=[R,r,U,J],N.viewport(R,r,U,J)},getViewport:function(){return this._viewport},setBufferGCInterval:function(H){this._bufferGCInterval=H},_doBufferGC:function(n,e){var T,W,m=n._bufPool,V=0,J=0,K=n._renderInfo.frame,k=this._bufferGCInterval||10;for(T in m)V++,W=m[T],W&&(e||K-W._fid>k?(n.deleteBuffer(W._buf),W._buf=null,m[T]=null):J++);if(V/2>J&&V>128){var B={};for(T in m)m[T]&&(B[T]=m[T]);n._bufPool=B}n._validBufCount=J},_swapLineMap:function(){var w=this;Np=w._polylineModelMap,w._polylineModelMap=w._polylineModelMapSwap,w._polylineModelMapSwap=Np,Np=w._wireframeModelMap,w._wireframeModelMap=w._wireframeModelMapSwap,w._wireframeModelMapSwap=Np,Np=w._polylineIndexMap,w._polylineIndexMap=w._polylineIndexMapSwap,w._polylineIndexMapSwap=Np,Np=w._wireframeIndexMap,w._wireframeIndexMap=w._wireframeIndexMapSwap,w._wireframeIndexMapSwap=Np},_updateSkyBox:function(K){if(this._skyBox&&K){var j=K.property,U=!1,f=this._skyBox;if("eye"===j||"forceUpdate"===j){var m=this._eye;f.p3(m[0],m[1],m[2]),U=!0}if("near"===j||"far"===j||"forceUpdate"===j){var Z=this._near,T=this._far,q=f.getFinalScale3d();if(q[0]/=2,q[1]/=2,q[2]/=2,q[0]<=Z||q[0]>=T||q[1]<=Z||q[1]>=T||q[2]<=Z||q[2]>=T){var P=2*Z*T/(Z+T),$=Math.min(q[0],q[1],q[2]),n=P/$,E=f.getScale3d();f.setScale3d(E[0]*n,E[1]*n,E[2]*n),U=!0}}U&&this.invalidateData(f)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(u){var n=this._skyBox;n&&(this._skyBoxStyleMap&&n.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&n.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&n.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=u,this.ump(this._updateSkyBox,this),u&&(u.dm()&&u.dm().remove(u),this._skyBoxStyleMap=B.Default.clone(u.getStyleMap()),this._skyBoxAnchor3d=u.getAnchor3d(),u.setAnchor3d(.5,.5,.5),this._skyBoxP3=u.p3().slice(0),u.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",n,u)},drawSky:function(S,f,d){var U=this,L=U._skyBox;if(L){var C=U._headlightIntensity,B=Rb(U._headlightColor),f=U._prg;1!==C&&(B=[B[0]*C,B[1]*C,B[2]*C]),ws(S,f.uHeadlightColor,[B[0],B[1],B[2],1]);var a=U.getData3dUI(L);if(a){var h,Q=U.isOrtho(),v=Q||this._computedProjectMatrix;v&&(h=U._projectMatrix,Q&&(U._ortho=!1),ws(S,f.uPMatrix,U._projectMatrix=Fd(U,!0)));var m=L.p3(),A=this._eye;(m[0]!==A[0]||m[1]!==A[1]||m[2]!==A[2])&&(L._position.x=A[0],L._54O=A[1],L._position.y=A[2]),a._42(S,f,d,function(){return!0}),v&&(Q&&(U._ortho=!0),ws(S,f.uPMatrix,U._projectMatrix=h))}S.clear(S.DEPTH_BUFFER_BIT),ws(S,f.uHeadlightColor,[B[0],B[1],B[2],U._headlightDisabled?1:0])}},_95I:function(B,R,l,j,N){function J(F){if(!(!F.s("alwaysOnTop")&&!F.s("shape3d.alwaysOnTop"))==!!N&&E.isVisible(F)&&(!c||S)){if(!l&&E.isTransparentMask(F))return;var X=E.getData3dUI(F);X&&X._42(B,R,l,C)}}var E=this,C=function(r){return j?r:!r};E.sky&&B.clear(B.DEPTH_BUFFER_BIT);var q=E.drawFilter;q?E.dm().each(function(G){q(G)||J(G)}):E.dm().each(function(y){J(y)})},getLogicalPoint:function(M){return Pd(M,this._canvas)},isRectOverlapping:function(N){var J=this.getData3dUI(N);return J._rectOverlapping},getHitFaceInfo:function(E){E.target&&(E=this.lp(E));var D=this.getDataInfoAt(E);if(D){var d=this._1o.face(D.data,ik(E.x,E.y));if(d)return{data:D.data,face:d}}return R},unproject:function(j,H){var _=this,E=_.getWidth(),t=_.getHeight(),G=j.target?_.lp(j):j,u=G.x-E/2,X=G.y-t/2,y=2*(u/E),Y=2*(-1*X/t);H=H||0;var k=Yl(),A=Fd(_),Q=rj(_);Br(k,A,Q),Ge(k);var I=nb([y,Y,H,1],k);return[I[0]/I[3],I[1]/I[3],I[2]/I[3]]},getDataAt:function(b){var u=this.getDataInfoAt(b);return u?u.data:R},getDataInfoAt:function(L,t){return L.target&&(L=this.lp(L)),this._1o.get(ik(L.x,L.y,t),!0)},getDatasInRect:function(E){return this._1o.get(E)},setEditable:function(p){var $=this,x=$._editable;$._editable=p,this.fp(bh,x,p)},isEditable:function(m){var Z=this;return Z._editable?hl(m)?m.s("3d.editable")?Z._editableFunc?Z._editableFunc(m):!0:!1:!1:!1},isSelectable:function(E){return E.s("3d.selectable")&&this.sm().isSelectable(E)},isMovable:function(c){var g=this;return $k(c)&&c.getStyle(Po)!==_b?!1:c.s("3d.movable")?g._movableFunc?g._movableFunc(c):!0:!1},isSizeEditable:function(V){return hl(V)?this._sizeEditableFunc?this._sizeEditableFunc(V):!0:!1},isRotationEditable:function(C){return hl(C)&&C.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(C):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(I){this.setZoom(sq,I)},zoomOut:function(Y){this.setZoom(1/sq,Y)},setZoom:function(){var z=new Fe,O=new Fe,Z=new Fe,g=new Fe;return function(A,L){if(1!==A){var H=this;H._14o&&H._14o.stop(!0);var k,D=1/A;z.copy(H.getCenter()),O.copy(H.getEye());var q=H._ortho;if(q){if(k=H._orthoWidth,k<H._moveStep&&A>1)return}else if(z.distanceTo(O)<H._moveStep&&1>D)return;var l=!1;return H._zoomToCenter===!1&&H._lastZoomLP&&(Z.copy(O).sub(z).normalize(),H._81O=null,g.copy(H.getHitPosition(H._lastZoomLP,z.toArray(),Z.toArray())),l=!0,H._lastZoomHit=g),(L=Pf(L))?(L.action=function(U){H.fi({kind:H._zooming?"betweenZoom":"beginZoom"}),H._zooming=1;var V=(D-1)*U+1;q&&H.setOrthoWidth(k*V),l?(H.setEye(Z.lerpVectors(g,O,V).toArray()),H.setCenter(Z.lerpVectors(g,z,V).toArray())):q||H.setEye(Z.lerpVectors(z,O,V).toArray())},L._37o=function(){delete H._14o,delete H._zooming,H.fi({kind:"endZoom"}),H.onZoomEnded()},H._14o=Pp(L)):(q&&H.setOrthoWidth(k*D),l?(H.setEye(Z.lerpVectors(g,O,D).toArray()),H.setCenter(Z.lerpVectors(g,z,D).toArray())):q||H.setEye(Z.lerpVectors(z,O,D).toArray()),void 0)}}}(),setOrthoZoom:function(N,Z){return this.setZoom(N,Z)},getPositionInfo:function(W){var U=this,s=U._eye,u=U._center,z=U.getAspect(),b=W?He(Ed(u,s,!0),Ed(W,s)):Wj(s,u);if(U._ortho){var g=U._orthoWidth;return{length:b,height:g/z,width:g}}var F=2*o(U._fovy/2)*b;return{length:b,height:F,width:F*z}},getCenterInfo:function(){var c=this;return c._81O||(c._81O=c.getPositionInfo()),er(c._81O)},rotate:function(N,m,Q,$){var r=this;if(N||m){$==R&&($=r._firstPersonMode),r._88O&&r._88O.stop(!0);var b=r._center,p=r._eye,k=r.getCenterInfo().length,G=$?b:p,s=$?p:b,S=Ed(G,s),U=F(S[0],S[2]),l=F(y(S[0]*S[0]+S[2]*S[2]),S[1]),O=$?xn:kr;return $&&(m=-m),(Q=Pf(Q))?(Q.action=function(x){r.fi({kind:r._rotating?"betweenRotate":"beginRotate"}),r._rotating=1;var b=U+N*x,o=l+m*x;o=$?e-ti(e-o):ti(o),S[0]=k*n(o)*n(b),S[1]=k*i(o),S[2]=k*n(o)*i(b),G[0]=s[0]+S[0],G[1]=s[1]+S[1],G[2]=s[2]+S[2],r.fp(O,R,G)},Q._37o=function(){delete r._88O,delete r._rotating,r.fi({kind:"endRotate"}),r.onRotateEnded()},r._88O=Pp(Q)):(U+=N,l+=m,l=$?e-ti(e-l):ti(l),S[0]=k*n(l)*n(U),S[1]=k*i(l),S[2]=k*n(l)*i(U),G[0]=s[0]+S[0],G[1]=s[1]+S[1],G[2]=s[2]+S[2],r.fp(O,R,G),void 0)}},pan:function(W,h,L,i){if(W||h){var q=this;i==R&&(i=q._firstPersonMode),q._89O&&q._89O.stop(!0);var x=rj(q),g=[x[0]*W,x[4]*W,x[8]*W],Q=[x[1]*h,x[5]*h,x[9]*h],o=g[0]+Q[0],e=g[1]+Q[1],b=g[2]+Q[2],j=q._center,u=q._eye;if(i){var V=Jc(q.getBoundaries(),u[0],u[2],u[0]+o,u[2]+b,y(o*o+b*b));o=V[0],b=V[1]}if(L=Pf(L)){var P=er(u),O=er(j);return L.action=function(H){q.fi({kind:q._panning?"betweenPan":"beginPan"}),q._panning=1,j[0]=O[0]+o*H,j[1]=O[1]+e*H,j[2]=O[2]+b*H,u[0]=P[0]+o*H,u[1]=P[1]+e*H,u[2]=P[2]+b*H,q.fp(kr,R,u),q.fp(xn,R,j)},L._37o=function(){delete q._89O,delete q._panning,q.fi({kind:"endPan"}),q.onPanEnded()},q._89O=Pp(L)}j[0]+=o,j[1]+=e,j[2]+=b,u[0]+=o,u[1]+=e,u[2]+=b,q.fp(kr,R,u),q.fp(xn,R,j)}},walk:function(L,g,a){if(L){var B=this;a==R&&(a=B._firstPersonMode),B._90O&&B._90O.stop(!0);var H=B._center,p=B._eye,J=Ed(H,p,!0);if(a){var U=Jc(B.getBoundaries(),p[0],p[2],p[0]+J[0]*L,p[2]+J[2]*L,q(L));if(L=Wj(U),!L)return;J=[U[0]/L,0,U[1]/L]}if(g=Pf(g)){var w=er(p),P=er(H);return g.action=function(U){B.fi({kind:B._walking?"betweenWalk":"beginWalk"}),B._walking=1;var D=L*U;p[0]=w[0]+J[0]*D,p[1]=w[1]+J[1]*D,p[2]=w[2]+J[2]*D,H[0]=P[0]+J[0]*D,H[1]=P[1]+J[1]*D,H[2]=P[2]+J[2]*D,B.fp(kr,R,p),B.fp(xn,R,H)},g._37o=function(){delete B._90O,delete B._walking,B.fi({kind:"endWalk"}),B.onWalkEnded()},B._90O=Pp(g)}p[0]+=J[0]*L,p[1]+=J[1]*L,p[2]+=J[2]*L,H[0]+=J[0]*L,H[1]+=J[1]*L,H[2]+=J[2]*L,B.fp(kr,R,p),B.fp(xn,R,H)}},handleScroll:function(v,u){v.preventDefault();var i=this,V=i._moveStep,S=i.getDataInfoAt(v);if(S){var A=S.data;if(A&&i.isInteractive(A)){var Z=i.intersectObject(v,A);if(Z){var k=Z.part,P=Tn(A.s(k+".image")||A.s("shape3d."+k+".image")||A.s("all.image")||A.s("shape3d.image"));if(P&&ie(P.scrollable,A,i))return}}}return i.isFirstPersonMode()?(i.isPannable()&&i.pan(0,u>0?V:-V),void 0):(i.isZoomable()&&(i._lastZoomLP=i.lp(v),i.setZoom(0>u?1/kb:kb),i._lastZoomLP=i._lastZoomHit=null),void 0)},handlePinch:function(X,S){this.isZoomable()&&this.setZoom(S>X?1/qs:qs)},reset:function(){this.setCenter(V.graph3dViewCenter),this.setEye(V.graph3dViewEye),this.setUp(V.graph3dViewUp)},moveSelection:function(L,N,U){var T=this;T.dm().beginTransaction(),gb(this.sm().toSelection(this.isMovable,this),L,N,U),T.dm().endTransaction()},getMoveMode:function(r,K){var m=K.s("3d.move.mode");if(m)return m;var D="88",g="89",y="90";return Vf(r)||Rr[D]&&Rr[g]&&Rr[y]?"xyz":Rr[D]&&Rr[g]?"xy":Rr[D]&&Rr[y]?"xz":Rr[g]&&Rr[y]?"yz":Rr[D]?"x":Rr[g]?"y":Rr[y]?"z":"xz"},handleTick:function(){var n=this,V=!1,k=n._moveStep,l=k,s=!1,P=!0,W=n._rotateStep*(P?-1:1);if(n.isWalkable()||(l=0),n.isPannable()||(k=0),n.isRotatable()||(W=0),n._32Q){var Q=(Qm()-n._32Q)/50;l*=Q,k*=Q,W*=Q}n._31Q&&(xl(n._31Q),delete n._31Q,delete n._32Q),Qb()&&(V=!0,n.pan(-k,0,s,P)),oh()&&(V=!0,n.pan(k,0,s,P)),Mm()&&(V=!0,Vf()?n.pan(0,k,s,P):n.walk(l,s,P)),jo()&&(V=!0,Vf()?n.pan(0,-k,s,P):n.walk(-l,s,P)),Pn()&&(V=!0,n.rotate(-W,0,s,P)),zn()&&(V=!0,n.rotate(W,0,s,P)),Mg()&&(V=!0,n.rotate(0,-W/2,s,P)),Xd()&&(V=!0,n.rotate(0,W/2,s,P)),V&&(n._32Q=Qm(),n._31Q=Ue(n.handleTick,n))},handleKeyDown:function(o){var h=this;!Uc(o)&&qi[o.keyCode]?h.handleTick():rd(o)?h.selectAll():am(o)?h.handleDelete(o):aj(o)&&this.isResettable()&&h.reset()},checkDoubleClickOnNote:function(b,K,t){var O=this;if(t===si){if(K.s("note.toggleable"))return K.s(js,!K.s(js)),O.fi({kind:"toggleNote",event:b,data:K,part:t}),!0}else if(t===ag&&K.s("note2.toggleable"))return K.s(Xn,!K.s(Xn)),O.fi({kind:"toggleNote2",event:b,data:K,part:t}),!0;return!1},checkDoubleClickOnRotation:function(P,F,d){return d===Ul?(F.setRotationX(0),!0):d===Zk?(F.setRotationY(0),!0):d===re?(F.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(E){var C=this;if(C.isOrtho())return C.getWidth()/C.getOrthoWidth();var f=C.getCenter(),S=C.getHeight(),k=C.getEye(),B=[f[0]-k[0],f[1]-k[1],f[2]-k[2]],V=[E[0]-k[0],E[1]-k[1],E[2]-k[2]],i=Math.sqrt(B[0]*B[0]+B[1]*B[1]+B[2]*B[2]),t=1/Math.tan(C.getFovy()/2);
return S*i*t/(V[0]*B[0]+V[1]*B[1]+V[2]*B[2])},inViewSpace:function(f){var y,i=this,s=i._transformPointToViewSpace(f),K=i.getAspect(),D=i.getNear(),b=i.getFar();return-s[2]<D||-s[2]>b?!1:i.isOrtho()?(y=i.getOrthoWidth()/2,Math.abs(s[0])<=y&&Math.abs(s[1]*K)<=y):(y=Math.sqrt(s[0]*s[0]+s[1]*s[1]+s[2]*s[2])*Math.tan(i.getFovy()/2),Math.abs(s[1]<=y)&&Math.abs(s[0])<=y*K)},getPVMatrix:function(){var k=this,j=k.getWidth()/2,C=k.getHeight()/2,U=k._18Q;return U&&U._wh===j/C||(U=Fd(k),k._18Q=Br(U,U,rj(k)),k._18Q._wh=j/C),U},getFrustum:function(){var T=new vh,M=new Xi,r=new Array(16);return function(){for(var K=this.getPVMatrix(),$=!1,k=0;16>k;k++)K[k]!==r[k]&&($=!0,r[k]=K[k]);return $&&M.setFromMatrix(T.fromArray(K)),M}}(),toViewPosition:function(N){var L=this,G=L.getWidth()/2,x=L.getHeight()/2,F=L.getPVMatrix();return N=nb([N[0],N[1],N[2],1],F),{x:G+G*N[0]/N[3],y:x-x*N[1]/N[3],z:N[2]/N[3]}},getHitPosition:function(v,X,c){var B=this,R=B.getWidth(),J=B.getHeight(),$=v.target?B.lp(v):v,T=$.x-R/2,b=$.y-J/2,x=B.getCenterInfo(),O=rj(B);X=X?X:[0,0,0],c=c?c:[0,1,0],T=T/R*x.width,b=-1*b/J*x.height;var V=[O[0]*T,O[4]*T,O[8]*T],h=[O[1]*b,O[5]*b,O[9]*b],W=[V[0]+h[0],V[1]+h[1],V[2]+h[2]],_=B.getCenter(),C=xg(B,X,c,[W[0]+_[0],W[1]+_[1],W[2]+_[2]]);return C?C:[0,0,0]},intersectObject:function(u,c){return this._raycaster.intersectObject(u,c)},intersectObjects:function(j,Y,Q){return this._raycaster.intersectObjects(j,Y,Q)},getLineLength:function(y){this.validate();var w=this.getData3dUI(y);if(w&&w.getCache){var X=w.getCache();if(X)return X[X.length-1].length}return 0},getLineOffset:function(C,J){var Y=this.getData3dUI(C);if(Y&&Y.getCache){var G=Y.getCache();if(G){var Z=dh(G,J);if(!C.r3)return Z;var n=C.r3();if(0===n[0]&&0===n[1]&&0===n[2])return Z;var T=new Fe(C.p3()),a=new Fe(Z.point).sub(T),U=new Fe(Z.tangent).add(a),e=(new bm).setFromEuler(new xk(n,C.getRotationMode(),!0));return a.applyQuaternion(e),U.applyQuaternion(e),{point:a.add(T),tangent:U.sub(a).normalize()}}}return R},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(o,n,J){var F=this,B=F.getEye();B=[B[0],B[1],B[2]];var g=F.getCenter();if(g=[g[0],g[1],g[2]],o||(o=B),n||(n=g),F._flyAnim&&F._flyAnim.stop(!0),J=Pf(J),!J)return F.setEye(o[0],o[1],o[2]),F.setCenter(n[0],n[1],n[2]),delete F._flyAnim,!0;var Y=[o[0]-B[0],o[1]-B[1],o[2]-B[2]],W=[n[0]-g[0],n[1]-g[1],n[2]-g[2]];return J.action=function(T){F.setCenter(g[0]+W[0]*T,g[1]+W[1]*T,g[2]+W[2]*T),F.setEye(B[0]+Y[0]*T,B[1]+Y[1]*T,B[2]+Y[2]*T)},J._37o=function(){delete F._flyAnim},F._flyAnim=Pp(J)},flyTo:function(){function R(N,s,z){if(z instanceof B.Node){f.fromArray(Od(z,s.getMat(z)));var r=z.getAnchor3d();N.push((new Fe).set(0-r.x,0-r.y,0-r.z).applyMatrix4(f)),N.push((new Fe).set(0-r.x,0-r.y,1-r.z).applyMatrix4(f)),N.push((new Fe).set(0-r.x,1-r.y,0-r.z).applyMatrix4(f)),N.push((new Fe).set(0-r.x,1-r.y,1-r.z).applyMatrix4(f)),N.push((new Fe).set(1-r.x,0-r.y,0-r.z).applyMatrix4(f)),N.push((new Fe).set(1-r.x,0-r.y,1-r.z).applyMatrix4(f)),N.push((new Fe).set(1-r.x,1-r.y,0-r.z).applyMatrix4(f)),N.push((new Fe).set(1-r.x,1-r.y,1-r.z).applyMatrix4(f))}}var l=new Fe,W=new Fe,Y=new Fe,j=new Fe,f=new vh,T=new B.Math.Quaternion,O=new xk;return function(t,F,o){var K=this;if(o!==H)F={animation:F,ratio:o};else{var v=typeof F;("boolean"===v||"object"===v&&F.duration)&&(F={animation:F})}F=F||{},l.fromArray(K.getEye()),W.fromArray(K.getCenter());var m,k,U=[],y=F.center,Q=F.distance===H;if(y&&Y.fromArray(y),t instanceof B.Node)y||Y.fromArray(t.p3()),Q&&(R(U,K,t),m=U.length);else{if(t||(t=K.dm().getDatas()),!t.length)return;if((Q||!y)&&(U=[],t.forEach(function(g){R(U,K,g)}),m=U.length,!m))return;if(!y){for(Y.set(0,0,0),k=0;m>k;k++)Y.add(U[k]);Y.multiplyScalar(1/m)}}if(K.setCenter(Y.x,Y.y,Y.z),j.subVectors(l,W),F.direction||F.worldDirection){!F.worldDirection&&t instanceof B.Node?T.setFromEuler(O.set(t.r3(),t.getRotationMode(),!0)):T.set(0,0,0,1);var N=j.length();j.fromArray(F.worldDirection||F.direction).applyQuaternion(T).setLength(N)}var C=0;if(Q){var r,z,p,o=F.ratio||.8,X=F.xRatio||o,L=F.yRatio||o;if(K.isOrtho()){var V=-1/0;for(K._eye[0]=j.x+Y.x,K._eye[1]=j.y+Y.y,K._eye[2]=j.z+Y.z,r=Fd(K),Br(r,r,rj(K)),k=0;m>k;k++)p=U[k],z=nb([p.x,p.y,p.z,1],r),V=Math.max(V,Math.max(Math.abs(z[0])/X,Math.abs(z[1])/L));C=K.getOrthoWidth()*V,j.add(Y)}else{for(var Z,D,A=K.getNear(),a=10;a--;){for(K._eye[0]=j.x+Y.x,K._eye[1]=j.y+Y.y,K._eye[2]=j.z+Y.z,r=Fd(K),Br(r,r,rj(K)),Z=!0,D=-1/0,k=0;m>k;k++){if(p=U[k],z=nb([p.x,p.y,p.z,1],r),z[3]<A&&a){j.multiplyScalar(2),Z=!1;break}D=Math.max(D,Math.max(Math.abs(z[0])/X,Math.abs(z[1])/L)-z[3])}if(Z)break}j.setLength(D+j.length()).add(Y)}}else j.setLength(F.distance).add(Y);K._flyAnim&&K._flyAnim.stop(!0);var G=Pf(F.animation);if(G){K.setEye(l.x,l.y,l.z),K.setCenter(W.x,W.y,W.z);var M=(new Fe).subVectors(j,l),g=(new Fe).subVectors(Y,W);if(C)var s=K.getOrthoWidth();var e=new Fe,h=new Fe,d=G.action,x=G._37o;return G.action=function(f,_){e.copy(l).addScaledVector(M,f),h.copy(W).addScaledVector(g,f),K.setCenter(h.x,h.y,h.z),K.setEye(e.x,e.y,e.z),C&&K.setOrthoWidth((C-s)*f+s),d&&d(f,_)},G._37o=function(){delete K._flyAnim,x&&x()},{lastEye:l,lastCenter:W,eye:j,center:Y,orthoWidth:C,animation:K._flyAnim=Pp(G)}}return K.setEye(j.x,j.y,j.z),C&&K.setOrthoWidth(C),delete K._flyAnim,{lastEye:l,lastCenter:W,eye:j,center:Y,orthoWidth:C}}}(),getBoundingBox:function(){function Y(c,Y,v){r.fromArray(Od(v,Y.getMat(v)));var $=v.getAnchor3d();c.push((new Fe).set(0-$.x,0-$.y,0-$.z).applyMatrix4(r)),c.push((new Fe).set(0-$.x,0-$.y,1-$.z).applyMatrix4(r)),c.push((new Fe).set(0-$.x,1-$.y,0-$.z).applyMatrix4(r)),c.push((new Fe).set(0-$.x,1-$.y,1-$.z).applyMatrix4(r)),c.push((new Fe).set(1-$.x,0-$.y,0-$.z).applyMatrix4(r)),c.push((new Fe).set(1-$.x,0-$.y,1-$.z).applyMatrix4(r)),c.push((new Fe).set(1-$.x,1-$.y,0-$.z).applyMatrix4(r)),c.push((new Fe).set(1-$.x,1-$.y,1-$.z).applyMatrix4(r))}var r=new vh;return function($){if($=$||this.sm().getSelection(),$ instanceof B.Node&&($=[$]),0===$.length)return R;var M=[];$.forEach(function(R){Y(M,this,R)},this);var V=[1/0,1/0,1/0],m=[-1/0,-1/0,-1/0];return M.forEach(function(F){V[0]=Math.min(F.x,V[0]),V[1]=Math.min(F.y,V[1]),V[2]=Math.min(F.z,V[2]),m[0]=Math.max(F.x,m[0]),m[1]=Math.max(F.y,m[1]),m[2]=Math.max(F.z,m[2])}),{min:V,max:m}}}()}),pe.RenderEnv=function(x){this.gv=x,this.enable=!1},w.defineProperties(pe.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(v){this._debugOn=v,this.capture&&this.capture()}}}),w.assign(pe.RenderEnv.prototype,{renderEnvToCube:function(Y,N,V,p){var q=this,_=q.gv;if(!Y||!N||!V)return q.enable=!1,q._42=null,void 0;q.enable=!0;var k=Math.floor(p/Y*N),T=_.getGL(),m=q._renderTargets;m?m.length<V&&(m=q._renderTargets=m.concat(new Array(V-m.length))):m=q._renderTargets=new Array(V);for(var c=0;V>c;c++)m[c]?m[c].setSize(T,p,k):m[c]=new pe.RenderTarget(_,T,p,k);var f=!1;q.capture=function(){f=!0,_._42(),f=!1};var x=new Fe,o=new Fe,b=new Fe,y=new Fe,r=(new Fe).setY(0),K=2*Math.PI/V,z=Y/2/Math.tan(Math.PI/V),g=2*Math.atan2(N/2,z),d=Y/N;q._42=function(Q,X,c,R){var w=q._debugOn;if(!f&&!w)return!1;x.copy(_.getEye()),y.copy(_.getCenter()).sub(x);var C=Math.atan2(y.z,y.x),J=_.getNear(),a=_.getFovy(),U=_.getAspect();o.copy(_.getCenter());for(var Y,N=0;V>N;N++)if(Y=m[N],r.setZ(Math.cos(C)).setX(Math.sin(C)).multiplyScalar(z),C-=K,b.addVectors(x,r),_.setNear(z),_.setCenter([b.x,b.y,b.z]),_.setFovy(g),_.setAspect(d),w){var M=Math.round(X/V);Q.viewport(M*N,0,M,c),R()}else gd(Q,Y.frame),Q.viewport(0,0,Y.width,Y.height),Q.clear(Q.COLOR_BUFFER_BIT),R(),Id(Q),Y.assureTexture();return _.setNear(J),_.setCenter([o.x,o.y,o.z]),_.setFovy(a),_.setAspect(U),!0},q.capture()},getTextureInfo:function(F){var s=this._renderTargets;if(!s)return null;var R=this._renderTargets[F];return R?{index:F,texture:R.texture,textureName:R.uuid}:null}}),w.assign(pe.Graph3dView.prototype,{renderEnvToCube:function(I,T,A,X){var C=this;C.envRenderer||(C.envRenderer=new pe.RenderEnv(C)),C.envRenderer.renderEnvToCube(I,T,A,X)}}),pe.RenderTarget=function(o,P,q,g,D){var O=this;D=D||{},D.samples=Math.min(o._glCapabilities.maxSamples,D.samples&&D.samples>1&&2===o._webGLVersion?D.samples:0),O.options=D,O.uuid=B.Math.generateUUID(),O.gv=o,O.init(o,P,D),D.samples&&!o._glCapabilities._maxSamplesChecked?O.setSize(P,q||1,g||1):O.setSize(P,q,g)},w.assign(pe.RenderTarget.prototype,{bind:function(E){gd(E,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(h){Id(h),this.options.samples&&(h.bindFramebuffer(h.READ_FRAMEBUFFER,this._MSAAFbo),h.bindFramebuffer(h.DRAW_FRAMEBUFFER,this.frame),h.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,h.COLOR_BUFFER_BIT,h.NEAREST),h.bindFramebuffer(h.READ_FRAMEBUFFER,null),h.bindFramebuffer(h.DRAW_FRAMEBUFFER,null))},init:function(P,Y,b){var w=this,o=w.texture=Y.createTexture();Y.activeTexture(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,o);var D=b.samples,e=D?Y.NEAREST:Y.LINEAR;Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,b.minFilter||e),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,b.magFilter||e),Y.bindTexture(Y.TEXTURE_2D,null),w.render=Y.createRenderbuffer(),w.frame=Y.createFramebuffer(),P._2O[w.uuid]=o},assureTexture:function(){var h=this,L=h.uuid,r=h.gv._2O;r[L]||(r[L]=h.texture)},setSize:function(O,Q,v){var h=this;if(Q&&v&&(h.width!==Q||h.height!==v)){var N=O.RGBA,Y=O.TEXTURE_2D,e=O.RENDERBUFFER,l=O.FRAMEBUFFER,U=h.options.samples;if(eh(O,h.texture),O.texImage2D(Y,0,N,Q,v,0,N,O.UNSIGNED_BYTE,R),Wm.isPOT(Q)&&Wm.isPOT(v)&&!h.options.clampToEdge?(O.texParameteri(O.TEXTURE_2D,O.TEXTURE_WRAP_S,O.REPEAT),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_WRAP_S,O.REPEAT)):(O.texParameteri(O.TEXTURE_2D,O.TEXTURE_WRAP_S,O.CLAMP_TO_EDGE),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_WRAP_T,O.CLAMP_TO_EDGE)),O.bindRenderbuffer(e,h.render),U){var t=h.gv._glCapabilities;if(t._maxSamplesChecked)O.renderbufferStorageMultisample(e,U,O.DEPTH_COMPONENT16,Q,v);else{for(O.getError();U>1&&(O.renderbufferStorageMultisample(e,U,O.DEPTH_COMPONENT16,Q,v),O.getError());)U=Math.floor(U>>1);1>=U&&(U=0,O.texParameteri(O.TEXTURE_2D,O.TEXTURE_MIN_FILTER,h.options.minFilter||O.LINEAR),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_MAG_FILTER,h.options.magFilter||O.LINEAR),O.renderbufferStorage(e,O.DEPTH_COMPONENT16,Q,v)),t._maxSamplesChecked=!0,t.maxSamples=h.options.samples=U}}else O.renderbufferStorage(e,O.DEPTH_COMPONENT16,Q,v);U&&!h._MSAAFbo&&(h._MSAAFbo=O.createFramebuffer(),h._MSAARbO=O.createRenderbuffer()),gd(O,h.frame),O.framebufferTexture2D(l,O.COLOR_ATTACHMENT0,Y,h.texture,0),U||O.framebufferRenderbuffer(l,O.DEPTH_ATTACHMENT,e,h.render),Id(O),U&&(O.bindRenderbuffer(O.RENDERBUFFER,h._MSAARbO),O.renderbufferStorageMultisample(O.RENDERBUFFER,U,O.RGBA8,Q,v),gd(O,h._MSAAFbo),O.framebufferRenderbuffer(O.FRAMEBUFFER,O.COLOR_ATTACHMENT0,O.RENDERBUFFER,h._MSAARbO),O.framebufferRenderbuffer(l,O.DEPTH_ATTACHMENT,e,h.render),Id(O)),eh(O,R),O.bindRenderbuffer(e,R),h.width=Q,h.height=v}},toCanvas:function(){var l=this,Z=l.gv.getGL();gd(Z,l.frame);var c=l.width,t=l.height,j=new Uint8Array(4*c*t);Z.readPixels(0,0,c,t,Z.RGBA,Z.UNSIGNED_BYTE,j),Id(Z);var e=N.createElement("canvas");e.width=c,e.height=t;var x=e.getContext("2d"),q=x.createImageData(c,t);return q.data.set(j),x.putImageData(q,0,0),e}});var bl=pe.Interactor=function(M){this.gv=M};Wh("Interactor",w,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Ae=pe.DefaultInteractor=function(L){Ep(Ae,this,[L])};Wh("DefaultInteractor",bl,{getDataInfoAt:function(U,H){var I=this.gv,Z=I.getDataInfoAt(U);if(!I.isBlockSelectable()||!Z||!Z.data)return Z;if(!H&&I.isSelected(Z.data))return Z;for(var X=Z.data;(X=X.getParent())&&X instanceof B.Block&&I.isSelectable(X);){var f=I.isSelected(X);if(f&&H)break;if(Z={data:X,part:Z},f&&!H)break}return Z},handle_contextmenu:function(W){dj(W)},handle_mousewheel:function(Q){this.gv.handleScroll(Q,Q.wheelDelta/40)},handle_DOMMouseScroll:function(O){2===O.axis&&this.gv.handleScroll(O,-O.detail)},handle_keydown:function(P){this.gv.handleKeyDown(P)},handle_mousedown:function(T){this.handle_touchstart(T)},handle_touchstart:function(Z){dj(Z);var T=this,H=T.gv,G=Ih(Z),V=T.getDataInfoAt(Z),s=V?V.data:R,E=V?V.part:R,K=H.sm(),f=Ze(Z),$=tk(Z);H.setFocus(Z)&&(T._62O=R,T._57I=R,T.pendingClickThrough=R,s?Uc(Z)?K.co(s)?K.rs(s):K.as(s):K.co(s)?s instanceof ak&&s.isClickThroughEnabled()&&Ih(Z)&&(T.pendingClickThrough=zr(Z)):K.ss(s):G&&(Uc(Z)?H.isRectSelectable()&&(T._62O=lg):T._57I=zr(Z)),T._31Q&&(xl(T._31Q),delete T._31Q,delete T._32Q),T._62O||(H.isFirstPersonMode()&&(Vf(Z)||tm(Z)||$>2?T._62O="pan":H.isMouseRoamable()||Kq?(T._62O="roaming",T.foward=f&&Ih(Z),T._32Q=Qm(),T._31Q=Ue(T.tick,T)):G||(T._62O="roaming")),T._62O||(G&&f&&Sb[E]?(T._62O=E,T.p3=s.p3()):G&&f&&hl(s)&&H.isSelected(s)?H.isMovable(s)?(T._62O="move",T.p3=s.p3(),T.movedata=s):H._39Q(s)&&(T._62O="none"):Kq&&($>2?T._62O="pan":2===$&&(T.dist=Km(Z),T._62O="pinch")))),T.point=H.lp(Z),ts(T,Z),lb(Z)?H.handleDoubleClick(Z,s,E):H.handleClick(Z,s,E))},tick:function(){var p=this,V=p.gv,r=V._moveStep;p.point&&V.isWalkable()&&(p._32Q&&(r*=(Qm()-p._32Q)/50),V.walk(p.foward?r:-r),p._32Q=Qm(),p._31Q=Ue(p.tick,p))},handle_mouseup:function(b){this.handle_touchend(b)},handle_touchend:function(X){var r=this._57I;if(r&&(Wj(r,zr(X))<=1&&this.gv.sm().cs(),this._57I=R),r=this.pendingClickThrough){if(Wj(r,zr(X))<=1){var E=this.getDataInfoAt(X);E&&E.data instanceof ak&&E.data.isClickThroughEnabled()&&(E=this.getDataInfoAt(X,!0),E&&(X.clickThrough=!0,this.gv.sm().ss(E.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(f){this.handleWindowTouchMove(f)},handleWindowTouchMove:function(w){var P,p,L=this,j=L.gv,G=L._62O,K=L.point,Z=j.dm(),g=j.lp(w),h=g.x-K.x,$=g.y-K.y,u=j.getWidth(),s=j.getHeight();if(u&&s){var V=-b*h/u,Y=-b*$/s;if("roaming"===G)L.rotate(w,V/2,Y/2);else if(G===Ul||G===Zk||G===re)j._86O||Z.beginTransaction(),j.fi({kind:j._86O?"betweenEditRotation":"beginEditRotation",event:w}),j._86O=1,j.sm().each(function(m){if(hl(m)&&j.isRotationEditable(m)){var t=q(V)>q(Y)?V:Y;G===Ul?m.setRotationX(m.getRotationX()+t):G===Zk?m.setRotationY(m.getRotationY()+t):G===re&&m.setRotationZ(m.getRotationZ()+t)}});else if("move"===G||Sb[G]){G===Nf||G===sn||G===nm?(j._87O||Z.beginTransaction(),j.fi({kind:j._87O?"betweenEditScale":"beginEditScale",event:w}),j._87O=1):(j._moving||Z.beginTransaction(),j.fi({kind:j._moving?"betweenMove":"beginMove",event:w}),j._moving=1);var R,x=L.p3,n=j.getPositionInfo(x),O=rj(j);R=G===xr?"x":G===um?"y":G===Im?"z":G===Nf?"sx":G===sn?"sy":G===nm?"sz":j.getMoveMode(w,L.movedata),h=h/u*n.width,$=-1*$/s*n.height;var W,I,N=[O[0]*h,O[4]*h,O[8]*h],C=[O[1]*$,O[5]*$,O[9]*$],k=N[0]+C[0],M=N[1]+C[1],S=N[2]+C[2],d=[x[0]+k,x[1]+M,x[2]+S],T=Ed(j.getEye(),d,!0);if("xyz"===R?(W=d,j.moveSelection(k,M,S)):"xz"===R?(W=xg(j,x,[0,1,0],d),W&&j.moveSelection(W[0]-x[0],0,W[2]-x[2])):"xy"===R?(W=xg(j,x,[0,0,1],d),W&&j.moveSelection(W[0]-x[0],W[1]-x[1],0)):"yz"===R?(W=xg(j,x,[1,0,0],d),W&&j.moveSelection(0,W[1]-x[1],W[2]-x[2])):"x"===R||"sx"===R?(T[0]=0,W=xg(j,x,T,d),W&&(I=W[0]-x[0],"x"===R?j.moveSelection(I,0,0):j.sm().each(function(J){hl(J)&&j.isSizeEditable(J)&&(P=J.getScaleX()+I/100,p=P/J.getScaleX(),J.setScaleX(P),Vf(w)&&(J.setScaleY(J.getScaleY()*p),J.setScaleTall(J.getScaleTall()*p)))}))):"y"===R||"sy"===R?(T[1]=0,W=xg(j,x,T,d),W&&(I=W[1]-x[1],"y"===R?j.moveSelection(0,I,0):j.sm().each(function(O){hl(O)&&j.isSizeEditable(O)&&(P=O.getScaleTall()+I/100,p=P/O.getScaleTall(),O.setScaleTall(P),Vf(w)&&(O.setScaleY(O.getScaleY()*p),O.setScaleX(O.getScaleX()*p)))}))):("z"===R||"sz"===R)&&(T[2]=0,W=xg(j,x,T,d),W&&(I=W[2]-x[2],"z"===R?j.moveSelection(0,0,I):j.sm().each(function(F){hl(F)&&j.isSizeEditable(F)&&(P=F.getScaleY()+I/100,p=P/F.getScaleY(),F.setScaleY(P),Vf(w)&&(F.setScaleX(F.getScaleX()*p),F.setScaleTall(F.getScaleTall()*p)))}))),!W)return;L.p3=W}else if(G===lg){var _=L.div;_||(_=L.div=Fb(),ub(L.getView(),_),_.op=K,_.style.background=j.getRectSelectBackground()),j.fi({kind:j._rectSelecting?"betweenRectSelect":"beginRectSelect",event:w}),j._rectSelecting=1,_.rect=vo(_.op,g),nd(_,_.rect)}else if("pinch"===G&&2===tk(w)){j.fi({kind:j._pinching?"betweenPinch":"beginPinch",event:w}),j._pinching=1;var I=Km(w);j._lastZoomLP||(j._lastZoomLP=gn(w)),j.handlePinch(I,L.dist),L.dist=I}else"pan"===G||Vf(w)||tm(w)?L.pan(w,h,$):"none"===G||j.isFirstPersonMode()||L.rotate(w,V,Y);L.point=g}},pan:function(p,X,v){var b=this.gv;if(b.isPannable()){var u=b.getWidth(),A=b.getHeight();if(!u||!A)return;var U=b.getCenterInfo(),q=X/u*U.width,$=-1*v/A*U.height;b.fi({kind:b._panning?"betweenPan":"beginPan",event:p}),b._panning=1,b.pan(-q,-$)}},rotate:function(P,V,o){var Y=this.gv;Y.isRotatable()&&(Y.fi({kind:Y._rotating?"betweenRotate":"beginRotate",event:P}),Y._rotating=1,Y.rotate(V,o))},handleWindowMouseUp:function(R){this.handleWindowTouchEnd(R)},handleWindowTouchEnd:function(k){var z=this,E=z.gv,x=E.dm(),J=z.div;if(J){var g=E.getDatasInRect(J.rect);if(!g.isEmpty()){var T=E.sm(),s=T.toSelection();g.each(function(H){T.co(H)?s.remove(H):s.add(H)}),T.ss(s)}hb(J)}E._moving&&(delete E._moving,E.fi({kind:"endMove",event:k}),E.onMoveEnded(),x.endTransaction()),E._panning&&(delete E._panning,E.fi({kind:"endPan",event:k}),E.onPanEnded()),E._rotating&&(delete E._rotating,E.fi({kind:"endRotate",event:k}),E.onRotateEnded()),E._86O&&(delete E._86O,E.fi({kind:"endEditRotation",event:k}),x.endTransaction()),E._87O&&(delete E._87O,E.fi({kind:"endEditScale",event:k}),x.endTransaction()),E._pinching&&(delete E._pinching,E.fi({kind:"endPinch",event:k}),E.onPinchEnded()),E._rectSelecting&&(delete E._rectSelecting,E.fi({kind:"endRectSelect",event:k}),E.onRectSelectEnded()),E._walking&&(delete E._walking,E.fi({kind:"endWalk",event:k}),E.onWalkEnded()),E._lastZoomLP=E._lastZoomHit=null,z.dist=z.point=z._62O=z.p3=z.movedata=z.div=z._57I=z.pendingClickThrough=z._32Q=z._31Q=z.foward=R}});var Cg=pe.MapInteractor=function(b){Ep(Cg,this,[b]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this.maxPhi=5*Math.PI/12};Wh("MapInteractor",bl,{handle_contextmenu:function(a){dj(a)},handle_mousewheel:function(k){this.gv.handleScroll(k,k.wheelDelta/40)},handle_DOMMouseScroll:function(l){2===l.axis&&this.gv.handleScroll(l,-l.detail)},handle_keydown:function(h){this.gv.handleKeyDown(h)},handle_mousedown:function(M){this.handle_touchstart(M)},handle_touchstart:function(o){dj(o);var S=this,h=S.gv;if(h.setFocus(o)){var b=h.getDataInfoAt(o),N=b?b.data:R,G=b?b.part:R,K=S.editing={point:h.lp(o)};Kq?K.touch=!0:(K.touch=!1,K.clickLeft=Ih(o),K.pan=tm(o)?!0:"left"===this.panButton===K.clickLeft),N&&h._39Q(N)&&(K.preventDefault=!0),ts(S,o),lb(o)?h.handleDoubleClick(o,N,G):h.handleClick(o,N,G)}},handle_mouseup:function(d){this.handle_touchend(d)},handle_touchend:function(){},handleWindowMouseMove:function(_){this.handleWindowTouchMove(_)},handleWindowTouchMove:function(P){var o=this,L=o.gv,T=o.editing;if(T){var g=L.lp(P),$=T.point,O=g.x-$.x,U=g.y-$.y;if(!T.moved){if(Math.abs(O)<o.threshold&&Math.abs(U)<o.threshold&&!(P.touches&&P.touches.length>1))return;T.moved=!0}if(!T.preventDefault)if(T.point=g,T.touch){var K=P.touches.length;if(2!==K)o.pan(P,O,U);else{if(1>=K)return;var N=P.touches,m={x:N[0].clientX,y:N[0].clientY},w={x:N[1].clientX,y:N[1].clientY},f={x:w.x-m.x,y:w.y-m.y},Y=T.lastCenter,x=Math.atan2(f.y,f.x),E=T.theta,n=0;E==R?E=T.theta=x:(n=x-E,T.thetaStarted||Math.abs(n)>o.touchRotateThreshold?(T.thetaStarted=!0,T.theta=x):n=0);var F=e*(m.y+w.y)/2/L.getHeight(),D=T.phi,p=0;D==R?D=T.phi=F:(p=F-D,T.phiStarted||Math.abs(p)>o.touchRotateThreshold?(T.phiStarted=!0,T.phi=F):p=0);var Z,j=Math.sqrt(f.x*f.x+f.y*f.y),h=T.vlen;if(h){var H=m.x-Y.x,B=m.y-Y.y,c=w.x-Y.x,S=w.y-Y.y,i=Math.sqrt(H*H+B*B),M=Math.sqrt(c*c+S*S),r=h/2,t=o._sign2(i-r),z=o._sign2(M-r);0>t*z||0===t&&0===z?(Z=1,T.vlen=j):(Z||(Z=j/h),T.scaleStarted||Math.abs(Z-1)>o.touchScaleThreshold?(T.vlen=j,T.scaleStarted=!0):Z=1)}else h=T.vlen=j,Z=1;1!==Z&&L.setZoom(Z),(p||n)&&o.rotate(P,n,-p),T.lastCenter={x:(w.x+m.x)/2,y:(w.y+m.y)/2}}}else if(T.pan)o.pan(P,O,U);else{var v=L.getWidth(),d=L.getHeight();if(!v||!d)return;var Q=-b*O/v,u=-b*U/d;o.rotate(P,Q,u)}}},_sign2:function(a){return Math.abs(a)<this._touchScaleCheckAccuracy?0:a>0?1:-1},handleWindowMouseUp:function(U){this.handleWindowTouchEnd(U)},handleWindowTouchEnd:function(n){var s=this,f=s.editing;if(s.editing=null,f){var M=s.gv;if(f.moved||!f.clickLeft&&!f.touch)M._panning=null,M._rotating=null,M.fi({kind:f.pan?"endPan":"endRotate",event:n});else{var O=M.getDataAt(n);O?M.sm().setSelection([O]):M.sm().clearSelection()}}},pan:function(k,i,v){var $=this,h=$.gv;if(h.isPannable()){var o=h.getWidth(),M=h.getHeight();if(o&&M){var Y=h.getCenterInfo(),C=-i/o*Y.width,T=1*v/M*Y.height;h.fi({kind:h._panning?"betweenPan":"beginPan",event:k}),h._panning=1;var S=$.keepHorizon,U=$.editing.touch;if((U&&k.touches&&k.touches.length>1||!U&&Vf(k))&&(S=!S),!S)return h.pan(C,T);if(C||T){var y=rj(h),K=[y[0]*C,y[4]*C,y[8]*C],w=[y[1],0,y[9]],s=Math.sqrt(w[0]*w[0]+w[2]*w[2]);s&&(w=[w[0]/s*T,0,w[2]/s*T]);var I=K[0]+w[0],d=K[1]+w[1],O=K[2]+w[2],u=h._center,x=h._eye;u[0]+=I,u[1]+=d,u[2]+=O,x[0]+=I,x[1]+=d,x[2]+=O,h.fp(kr,R,x),h.fp(xn,R,u)}}}},rotate:function(x,z,g){var d=this,D=d.gv;if(D.isRotatable()){var B=D._center,M=D._eye,K=Ed(M,B),k=F(y(K[0]*K[0]+K[2]*K[2]),K[1]),f=ti(k+g);g=f-k,D.fi({kind:D._rotating?"betweenRotate":"beginRotate",event:x}),D._rotating=1,D.rotate(z,g)}}}),w.defineProperties(Cg.prototype,{panButton:{get:function(){return this._panButton},set:function(s){this._panButton=s}},minPhi:{get:function(){return V.graph3dViewMinPhi},set:function(W){V.graph3dViewMinPhi=W}},maxPhi:{get:function(){return V.graph3dViewMaxPhi},set:function(n){V.graph3dViewMaxPhi=n}},keepHorizon:{get:function(){return this._keepHorizon},set:function(H){this._keepHorizon=H}},threshold:{get:function(){return this._threshold},set:function(j){this._threshold=j}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(T){this._touchScaleThreshold=T}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(q){this._touchRotateThreshold=q}}});var hi,ln="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",th=32,Si=pe.GlobeInteractor=function(r,o){Ep(Si,this,[r]);var N,j=o.radius||6378137,d=this,T=null;hi||(hi=Fb(),hi.style.border="",hi.style.backgroundImage="url("+ln+")");var U=new bm,k=new Fe,s=new Fe,p=new Fe,F=new oi,l="number"==typeof j?{x:j,y:j,z:j}:j,Q={center:new Fe(0,0,0),radius:l},V=function(H){r._81O=null;var o=r.getHitPosition(H,r.getCenter(),k.copy(r.getEye()).sub(s.copy(r.getCenter())).toArray());return F.origin.copy(r.getEye()),F.direction.copy(o).sub(F.origin).normalize(),F.intersectEllipsoid(Q)},J=function(Y,B){r._81O=null,F.origin.copy(r.getEye());for(var E,N,w=r.getCenter(),$=k.copy(r.getEye()).sub(s.copy(r.getCenter())).toArray(),b=1,O=16,T=0,f=1,Z={x:0,y:0};O--;){if(Z.x=B.x+(Y.x-B.x)*b,Z.y=B.y+(Y.y-B.y)*b,E=r.getHitPosition(Z,w,$),F.direction.copy(E).sub(F.origin).normalize(),N=F.intersectEllipsoid(Q),N&&1===b)return{hit:N};N?T=b:f=b,b=(T+f)/2}return{hit:N,out:1>b}},q=function(Z,l){if(T){var R=Date.now();T.deltaTime=T.lastTime?R-T.lastTime:1e3,T.lastTime=R,T.lastAxis=Z,T.lastAngle=l}l&&(U.setFromAxisAngle(Z,l),r.setEye(k.copy(r.getEye()).applyQuaternion(U).toArray()),r.setCenter(k.copy(r.getCenter()).applyQuaternion(U).toArray()),r.setUp(k.copy(r.getUp()).applyQuaternion(U).toArray()))};d._showCrossIcon=function(S){ub(d.getView(),hi),nd(hi,{x:S.clientX-th/2,y:S.clientY-th/2,width:th,height:th})},d._hideCrossIcon=function(){hb(hi)},d._scrollImpl=function(w,U){T={point:r.lp(w),screen:zr(w),hit:V(w),type:"right"},T.hitNormalize=T.hit?T.hit.clone().normalize():new Fe;var k={clientX:T.screen.x,clientY:T.screen.y+10*U};d._handleMoveImpl(k),d._endMoveImpl(k)},d._startMoveImpl=function(Y){N&&(N.stop(!0),N=null),T={point:r.lp(Y),screen:zr(Y),hit:V(Y)},T.hitNormalize=T.hit?T.hit.clone().normalize():new Fe,Kq?1===Y.touches.length?T.hit&&(T.type="left"):2===Y.touches.length&&(T.type="touch2"):(Ih(Y)?T.hit&&(T.type="left"):Qj(Y)?T.type="right":tm(Y)&&T.hit&&(T.type="middle"),!T.hit||"right"!==T.type&&"middle"!==T.type||d._showCrossIcon(Y)),T.type&&ts(d,Y)},d._handleMoveImpl=function(B){if(T)switch(T.type){case"left":return d._handleLeft(B);case"right":return d._handleRight(B);case"middle":return d._handleMiddle(B);case"touch2":return d._handleTouch2(B)}},d._endMoveImpl=function(){if(T){if(this._hideCrossIcon(),"left"===T.type||"middle"===T.type){var R=1e3*(T.lastAngle/(T.deltaTime||30)),K=T.lastAxis,E=T.lastTime,y=function(){var Z=Date.now(),u=(Z-E)/1e3;return E=Z,R*=Math.pow(Math.abs(d.decelerationRate),3*u),Math.abs(R)<.01?(R=0,N&&N.stop(),void 0):(q(K,R*u),void 0)};N=Pp({action:function(){y(arguments)},duration:5e3})}T=null}},d._handleLeft=function(w){if(!T.finished){var H=zr(w),O=J(H,T.lastScreen||T.screen);if(T.lastScreen=H,!O.hit)return T.finished=!0,d._endMoveImpl(w),void 0;var B=O.hit;B.normalize();var _=T.hitNormalize,F=Math.acos(B.dot(_)),E=B.cross(_).normalize();q(E,F),O.out&&(T.finished=!0,d._endMoveImpl(w))}},d._handleRight=function(P){var g=T.lastScreen||T.screen,_=g.y;g=T.lastScreen=zr(P);var J=g.y,H=J-_;if(H){var u=Math.min(.5,H*d.scaleSpeed);k.copy(r.getEye());var F=T.hit;F||(F=k.clone().divide(l).normalize().multiply(l)),s.copy(k).lerp(F,u),r.setEye(s.toArray()),k.copy(r.getUp()),s.normalize();var z=k.clone().cross(s).normalize();if(p.copy(r.getCenter()),p.sub(z.multiplyScalar(p.dot(z))),r.setCenter(p.toArray()),T.hit){var E=V(T.screen),X=T.hitNormalize;if(E){E.normalize();var A=Math.acos(E.dot(X)),n=E.cross(X).normalize();A&&q(n,A)}}}};var Z=function(b){return Math.abs(b)<.01?0:b>0?1:-1};d._handleTouch2=function(M){var w=M.touches.length;if(2===w){var B=M.touches,m={x:B[0].clientX,y:B[0].clientY},I={x:B[1].clientX,y:B[1].clientY},U={x:I.x-m.x,y:I.y-m.y},n=T.lastCenter,G=Math.atan2(U.y,U.x),e=T.theta,g=0;e==R?e=T.theta=G:(g=G-e,T.thetaStarted||Math.abs(g)>.03?(T.thetaStarted=!0,T.theta=G):g=0);var _,X=Math.sqrt(U.x*U.x+U.y*U.y),Q=T.vlen;if(Q){var u=m.x-n.x,O=m.y-n.y,D=I.x-n.x,N=I.y-n.y,Y=Math.sqrt(u*u+O*O),b=Math.sqrt(D*D+N*N),A=Q/2,E=Z(Y-A),c=Z(b-A);0>E*c||0===E&&0===c?(_=1,T.vlen=X):(_||(_=X/Q),T.scaleStarted||Math.abs(_-1)>.05?(T.vlen=X,T.scaleStarted=!0):_=1)}else Q=T.vlen=X,_=1;var U=s.copy(r.getEye()).clone();1!==_&&r.setEye(U.setLength((U.length()-j)/_+j).toArray()),g&&q(U.normalize(),g),T.lastCenter={x:(I.x+m.x)/2,y:(I.y+m.y)/2}}},d._handleMiddle=function(Z){var N=zr(Z),A=T.screen;T.screen=N;var o=(N.y-A.y)/180*Math.PI*d.rollSpeed;s.copy(r.getCenter()).sub(k.copy(r.getEye())).normalize(),k.copy(r.getUp()).cross(s).normalize(),s.copy(r.getEye()).sub(T.hit).applyAxisAngle(k,o).add(T.hit);var b=s.clone();s.copy(r.getCenter()).sub(T.hit).applyAxisAngle(k,o).add(T.hit);var c=s.clone(),G=s.copy(r.getUp()).applyAxisAngle(k,o).clone(),H=!1;o>0&&(p.copy(G),s.copy(c).sub(b).normalize(),k.copy(b).multiplyScalar(-1).normalize(),k.dot(p)-s.dot(p)>0&&(H=!0)),H||p.copy(T.hit).sub(b).dot(T.hitNormalize)>=0&&(H=!0),H||(r.setEye(b.toArray()),r.setCenter(c.toArray()),r.setUp(G.toArray()));var V=-(N.x-A.x)/180*Math.PI*d.rotateSpeed;q(T.hitNormalize,V)}};Wh("GlobeInteractor",bl,{handle_contextmenu:function(u){dj(u)},handle_mousewheel:function(v){this._scrollImpl(v,v.wheelDelta/40)},handle_DOMMouseScroll:function(k){2===k.axis&&this._scrollImpl(k,-k.detail)},handle_keydown:function(t){this.gv.handleKeyDown(t)},handle_mousedown:function(_){this.handle_touchstart(_)},handle_touchstart:function(u){dj(u);var e=this.gv;if(e.setFocus(u)){var I=e.getDataInfoAt(u),v=I?I.data:R;v&&e.isInteractive(v)||this._startMoveImpl(u);var K=I?I.part:R;lb(u)?e.handleDoubleClick(u,v,K):e.handleClick(u,v,K)}},handle_mouseup:function(q){this.handle_touchend(q)},handle_touchend:function(){},handleWindowMouseMove:function(o){this.handleWindowTouchMove(o)},handleWindowTouchMove:function($){this._handleMoveImpl($)},handleWindowMouseUp:function(d){this.handleWindowTouchEnd(d)},handleWindowTouchEnd:function(V){this._endMoveImpl(V)}}),w.defineProperties(Si.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(a){this._rotateSpeed=a}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(g){this._rollSpeed=g}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(W){this._scaleSpeed=W}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(M){this._decelerationRate=M}}});var Gi=function(Y){this.gv=Y};uj(Gi,w,{_iv:!0,iv:function(){this._iv=!0},face:function(L,h){var G=this,y=G.gv.getGL();if(!y||!hl(L))return R;var P=G._resolution,X=Math.round(h.x*P),J=Math.ceil(h.width*P),Z=Math.ceil(h.height*P),C=G.height-Math.round(h.y*P)-Z,V=f(J/2),u=new Uint8Array(4*J*Z),F=0;for(G.iv(),G.validate(L),gd(y,G.frame),y.readPixels(X,C,J,Z,y.RGBA,y.UNSIGNED_BYTE,u),Id(y),G.iv();V>=F;F++)for(var W=V-F,x=V+F,H=W;x>=H;H++)for(var g=W;x>=g;g++)if(H===W||H===x||g===W||g===x){var T=Jk.m[u[4*(H*J+g)]];if(T)return T}},get:function(l,W){this.validate();var Y=this,L=Y.gv.getGL();if(!L)return R;var Z,N,u=Y._resolution,G=Math.round(l.x*u),k=Math.ceil(l.width*u),w=Math.ceil(l.height*u),y=Y.height-Math.round(l.y*u)-w,s=f(k/2),S=new Uint8Array(4*k*w),p=0,J=S.length,c=W?R:new Mf,d=W?R:{};if(gd(L,Y.frame),L.readPixels(G,y,k,w,L.RGBA,L.UNSIGNED_BYTE,S),Id(L),W){for(;s>=p;p++)for(var v=s-p,j=s+p,z=v;j>=z;z++)for(var X=v;j>=X;X++)if((z===v||z===j||X===v||X===j)&&(Z=Y.info(S,4*(z*k+X))))return Z}else for(;J>p;p+=4)Z=Y.info(S,p),Z&&(N=Z.data,d[N._id]||(c.add(N),d[N._id]=N));return c},info:function(x,N){return this.colorMap[(x[N]<<16)+(x[N+1]<<8)+x[N+2]+((127&x[N+3])<<24)]},validate:function(k){var X=this,l=X.gv,y=l.getGL();if(y){var J=X._resolution=l._pickerResolution*l.getDevicePixelRatio(),Z=Math.round(J*l.getWidth()),A=Math.round(J*l.getHeight()),e=y.RGBA,v=y.TEXTURE_2D,T=y.RENDERBUFFER,c=y.FRAMEBUFFER;X.texture||(X.texture=Yr(y),X.render=y.createRenderbuffer(),X.frame=y.createFramebuffer()),(X.width!==Z||X.height!==A)&&(eh(y,X.texture),y.texImage2D(v,0,e,Z,A,0,e,y.UNSIGNED_BYTE,R),Yb(y,y.TEXTURE_MIN_FILTER,y.LINEAR),y.bindRenderbuffer(T,X.render),y.renderbufferStorage(T,y.DEPTH_COMPONENT16,Z,A),gd(y,X.frame),y.framebufferTexture2D(c,y.COLOR_ATTACHMENT0,v,X.texture,0),y.framebufferRenderbuffer(c,y.DEPTH_ATTACHMENT,T,X.render),eh(y,R),y.bindRenderbuffer(T,R),Id(y),X.width=Z,X.height=A),X._iv&&(X._iv=!1,gd(y,X.frame),l._42(k||(X.colorMap={}),J),Id(y))
}}});var ce=function(a){this.gv=a};uj(ce,w,{gap:0,size:0,_42:function(T,P){var c=this,C=c.gv,y=C._gridGap,u=C._gridSize;if(C._gridVisible){if(c.gap!==y||c.size!==u){for(var E=[],S=C._gridSize/2,L=y*S,d=0;2*S+1>d;d++){var e=6*d,o=6*(2*S+1)+e;E[e]=-L,E[e+1]=0,E[e+2]=-L+d*y,E[e+3]=L,E[e+4]=0,E[e+5]=-L+d*y,E[o]=-L+d*y,E[o+1]=0,E[o+2]=-L,E[o+3]=-L+d*y,E[o+4]=0,E[o+5]=L}c.vs=new om(E),c.gap=y,c.size=u}fe(C),Lg(T,P),wc(T),Wr(T,P,1,C._gridColor,C._buffer.vs,c.vs),Hi(T,0,c.vs.length/3,T.LINES),Le(T),Ei(T,P)}else c.vs=c.gap=c.size=R}});var Ld=function(s){this.gv=s};uj(Ld,w,{_42:function(W,J){var q=this.gv,h=q._buffer.vs,l=q._axisXColor,i=q._axisYColor,o=q._axisZColor,x=q._originAxisVisible,r=q._centerAxisVisible;if(x||r){var p=Ro?W.TRIANGLES:W.TRIANGLE_FAN,C=W.LINES;if(fe(q),Lg(W,J),wc(W),x){var I=q.getCenterInfo(),m=k(I.width,I.height)/5,$=.8*m,z=.05*m;Wr(W,J,1.5,l,h,new om([0,0,0,m,0,0,$,z,0,$,0,z,$,-z,0,$,0,-z,$,z,0,0,0,0,0,m,0,z,$,0,0,$,z,-z,$,0,0,$,-z,z,$,0,0,0,0,0,0,m,z,0,$,0,z,$,-z,0,$,0,-z,$,z,0,$])),Hi(W,0,2,C),Hi(W,1,6,p),Wr(W,J,R,i),Hi(W,7,2,C),Hi(W,8,6,p),Wr(W,J,R,o),Hi(W,14,2,C),Hi(W,15,6,p)}if(r){var f=q._center,j=f[0],H=f[1],Y=f[2],I=q.getPositionInfo(f);m=k(I.width,I.height)/20,Wr(W,J,1.5,l,h,new om([j,H,Y,j+m,H,Y,j,H,Y,j,H+m,Y,j,H,Y,j,H,Y+m])),Hi(W,0,2,C),Wr(W,J,R,i),Hi(W,2,2,C),Wr(W,J,R,o),Hi(W,4,2,C)}Le(W),Ei(W,J)}}});var Ij=function(d){this.gv=d,this.onMouseOver=this.onMouseOver.bind(this),this.mode=Ij.Mode.Style,this.color=H,this.width=H};Ij.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},uj(Ij,w,{onMouseOver:function(H){V.preventDefault(H);var C=this.gv.getDataAt(H);C!==this.mouseOverData&&(this.mouseOverData=C,this.gv.iv())},setFetchTargetFunc:function(z){this.fetchTargetFunc=z},_42:function(t,X){var M,T,r=this,S=r._mode;if(!t._renderInfo.reflectDepth&&S!==Ij.Mode.Disable){if(S===Ij.Mode.Selection?M=r.gv.sm().getSelection().toArray(function(b){return b.s("highlight.visible")}):S===Ij.Mode.MouseOver&&r.mouseOverData&&r.mouseOverData.s("highlight.visible")&&(M=[r.mouseOverData]),r.fetchTargetFunc&&(M=r.fetchTargetFunc(M)),S===Ij.Mode.Style)M=M||[],T=function(k){if(M.indexOf(k)>=0)return!1;var F=k.s("highlight.mode");return F===!1?!0:F===!0?!1:"selected"===F?r.gv.isSelected(k)?!1:!0:"hover"===F?k===r.mouseOverData?!1:!0:!0};else{if(!M||!M.length)return;T=function(p){return M.indexOf(p)<0?!0:void 0}}var O=r.gv,e=O.vr.isPresenting(),v=O.getWidth();if(e){var V=O.getWidth;v/=2,O.getWidth=function(){return v};var J=O.getViewport()}var o,c=O.getDevicePixelRatio(),j=v*c,s=O.getHeight()*c;(o=r._renderTarget)?o.setSize(t,j,s):r._renderTarget=o=new pe.RenderTarget(O,t,j,s),gd(t,o.frame),O.drawFilter=T,O._42({}),O.drawFilter=null,Id(t),Ro&&Wk(t,X.aPosition),Wk(t,X.aNormal),e&&(O.getWidth=V,O.setViewport(t,J[0],J[1],J[2],J[3]));var h=t._compiledShader.highlight;h||(h=t._compiledShader.highlight=new nq.Shader(t,Jl.vs,Jl.fs)),h.bind(),t.enable(t.BLEND),t.activeTexture(t.TEXTURE0+0),t.bindTexture(t.TEXTURE_2D,o.texture),h.uniforms.image=0,h.uniforms.textureSize=[j,s],h.uniforms.edgeWidth=O.getHighlightWidth();var L=O.getHighlightColor();if(r._lastHighlightColor!==L){var w=Dc(r._lastHighlightColor=L);r._highlightColorData=[w[0]/255,w[1]/255,w[2]/255,w[3]/255]}h.uniforms.edgeColor=r._highlightColorData,r.ibuffer?(r.ibuffer.upload(),r.vbuffer.upload()):(r.ibuffer=nq.Buffer.createIndexBuffer(t,new Uint16Array([0,2,1,1,2,3])),r.vbuffer=nq.Buffer.createVertexBuffer(t,new Float32Array([0,0,1,0,0,1,1,1]))),h.attributes.pos.pointer(r.vbuffer),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),t.disable(t.BLEND),t.bindTexture(t.TEXTURE_2D,null),t.useProgram(X),Ro&&Nd(t,X.aPosition)}}}),w.defineProperties(Ij.prototype,{mode:{get:function(){return this._mode},set:function(i){var f=this._mode;i!==f&&(this._mode=i,i===Ij.Mode.MouseOver||i===Ij.Mode.Style?h(this.gv.getView(),"mousemove",this.onMouseOver):(f===Ij.Mode.MouseOver||f===Ij.Mode.Style)&&Q(this.gv.getView(),"mousemove",this.onMouseOver))}}});var Jl={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},Xj=function(c){this.gv=c},xr="edit_tx",um="edit_ty",Im="edit_tz",Ul="edit_rx",Zk="edit_ry",re="edit_rz",Nf="edit_sx",sn="edit_sy",nm="edit_sz",Sb={};Sb[xr]=1,Sb[um]=1,Sb[Im]=1,Sb[Ul]=1,Sb[Zk]=1,Sb[re]=1,Sb[Nf]=1,Sb[sn]=1,Sb[nm]=1,uj(Xj,w,{_42:function(E,j,c){var O=this,J=O.gv,t=J.sm().ld();if(t&&J.isEditable(t)&&!J.isEditHelperDisabled()&&hl(t)&&(!J.isFirstPersonMode()||!J.isMouseRoamable()&&!Kq)){fe(J);var R,$,b=J.isMovable(t),Q=J.isRotationEditable(t),g=J.isSizeEditable(t),u=J._axisXColor,h=J._axisYColor,V=J._axisZColor,H=J._editSizeColor,d=t.p3(),_=Wj(J.getEye(),d)/10,K=_/(c?5:10),r=.7*_,y=.4*r,Y=d[0],k=d[1],D=d[2];R=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],b&&O._17O(E,j,t,c,xr,u,R,[Y,k-K,D,Y+r,k-K,D,Y+r,k,D,Y+r,k,D,Y,k,D,Y,k-K,D,Y,k-K,D+K,Y+r,k-K,D+K,Y+r,k-K,D,Y+r,k-K,D,Y,k-K,D,Y,k-K,D+K]),$=Y+r,g&&O._17O(E,j,t,c,Nf,H,R,[$,k-K,D,$+y,k-K,D,$+y,k,D,$+y,k,D,$,k,D,$,k-K,D,$,k-K,D+K,$+y,k-K,D+K,$+y,k-K,D,$+y,k-K,D,$,k-K,D,$,k-K,D+K]),$+=y,Q&&O._17O(E,j,t,c,Ul,u,R,[$,k-K,D,$+y,k-K,D,$+y,k,D,$+y,k,D,$,k,D,$,k-K,D,$,k-K,D+K,$+y,k-K,D+K,$+y,k-K,D,$+y,k-K,D,$,k-K,D,$,k-K,D+K]),R=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],b&&O._17O(E,j,t,c,um,h,R,[Y,k,D,Y,k+r,D,Y-K,k+r,D,Y-K,k+r,D,Y-K,k,D,Y,k,D,Y,k,D,Y,k,D-K,Y,k+r,D-K,Y,k+r,D-K,Y,k+r,D,Y,k,D]),$=k+r,g&&O._17O(E,j,t,c,sn,H,R,[Y,$,D,Y,$+y,D,Y-K,$+y,D,Y-K,$+y,D,Y-K,$,D,Y,$,D,Y,$,D,Y,$,D-K,Y,$+y,D-K,Y,$+y,D-K,Y,$+y,D,Y,$,D]),$+=y,Q&&O._17O(E,j,t,c,Zk,h,R,[Y,$,D,Y,$+y,D,Y-K,$+y,D,Y-K,$+y,D,Y-K,$,D,Y,$,D,Y,$,D,Y,$,D-K,Y,$+y,D-K,Y,$+y,D-K,Y,$+y,D,Y,$,D]),R=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],b&&O._17O(E,j,t,c,Im,V,R,[Y,k,D,Y,k,D+r,Y,k-K,D+r,Y,k-K,D+r,Y,k-K,D,Y,k,D,Y,k-K,D,Y-K,k-K,D,Y-K,k-K,D+r,Y-K,k-K,D+r,Y,k-K,D+r,Y,k-K,D]),$=D+r,g&&O._17O(E,j,t,c,nm,H,R,[Y,k,$,Y,k,$+y,Y,k-K,$+y,Y,k-K,$+y,Y,k-K,$,Y,k,$,Y,k-K,$,Y-K,k-K,$,Y-K,k-K,$+y,Y-K,k-K,$+y,Y,k-K,$+y,Y,k-K,$]),$+=y,Q&&O._17O(E,j,t,c,re,V,R,[Y,k,$,Y,k,$+y,Y,k-K,$+y,Y,k-K,$+y,Y,k-K,$,Y,k,$,Y,k-K,$,Y-K,k-K,$,Y-K,k-K,$+y,Y-K,k-K,$+y,Y,k-K,$+y,Y,k-K,$])}},_17O:function(p,V,b,g,o,u,L,J){var Z=this.gv._buffer;nr(p,V,g,!0,b,o),$i(p,V,R,!0,R,!0,R,!1),ws(p,V.uDiffuse,u),qr(p,Z.vs,new om(J),V.aPosition),qr(p,Z.ns,new om(L),V.aNormal),wc(p),Hi(p,0,12),Le(p),ii(p,V)}});var Sq=B.Raycaster=function($){this.gv=$,this.maxTriangleTest=1/0,this.backfaceCulling=!0};ni("Raycaster",w,{intersect:function(v){var E=this,n=E.gv,M=n.getDataAt(v);return M?E.intersectObject(v,M):null},intersectObjects:function(Z,v,n){var y,W,f,R,D=this,p=1/0,o=Z.origin||(new Fe).fromArray(D.gv.getEye()),d=D.maxTriangleTest,_=[];return v.forEach(function(G){n&&n(G)===!1||G.s("intersect")!==!1&&_.push(G)}),_.sort(function(Z,b){return o.distanceToSquared2(Z.p3())-o.distanceToSquared2(b.p3())}),D.countTriangles=0,_.forEach(function(Y){D.countTriangles>d||(y=D.intersectObject(Z,Y),y&&(W=o.distanceToSquared(y.world),p>W&&(f=Y,R=y,p=W)))}),D.countTriangles=0,{data:f,intersect:R}},intersectObject:function(h,u){if(h instanceof oi)return this._intersectObjectImpl(h,u);var z=this,Y=z.gv,H=Y.unproject(h),Q=new Fe,Z=Y.getEye(),f=new Fe;if(Y.isOrtho()){var o=new Fe(Z);f.copy(Y.getCenter()).sub(o).normalize();var P=Q.copy(H).sub(o).dot(f);Q.copy(f).setLength(-P).add(o.copy(H))}else Q.copy(Z),f.copy(H).sub(Q).normalize();var G=new B.Math.Ray(Q,f);return z._intersectObjectImpl(G,u)},_intersectObjectImpl:function(){function X(){var p=new Fe;return p.subVectors(y,s),r.subVectors(Y,s),p.cross(r).normalize(),p}function E(j,F,c,J,X,h,V){return pp.barycoordFromPoint(j,F,c,J,$),X.multiplyScalar($.x),h.multiplyScalar($.y),V.multiplyScalar($.z),X.add(h).add(V),X.clone()}function e(M,h,m){hd(M)?M.forEach(function(J){e(J,h,m)}):Fc(M)?e(pi(h,M),h,m):zh(M)&&(M.shape3d?e(M.shape3d,h,m):m.push(M))}var w=new vh,N=new vh,d=new oi,u=new Fe,M=new Fe,G=new Fe,P=new Fe,f=new Fe,Y=new Fe,s=new Fe,y=new Fe,k=new zb,W=new zb,g=new zb,r=new Fe,V={vs:Tg,is:Gb,uv:Bp},$=new Fe;return function(h,a){var R=this.gv.getData3dUI(a),I=a.mat||R.mat;if(I){w.fromArray(I),N.getInverse(w),d.copy(h).applyMatrix4(N);var U,q,x="body",J=R.shapeModel;if(J||(J=pi(R)),J||(a instanceof B.Node&&!(a instanceof B.Shape)?(U=!0,J=V):(q=!0,J=[R.left,R.front,R.right,R.back,R.top,R.bottom])),!J)return console.log("Can not find shape model."),null;hd(J)||(J=[J]);var L,l,i,m,D,C,b,j,c,o,H,_,t,O,Q,S,p=1/0,$=["","top_","bottom_"],F=!1,v=this.backfaceCulling,n=[];for(e(J,R,n),L=0,l=n.length;l>L;L++)if(t=n[L])for(i=0,m=$.length;m>i;i++)if(O=$[i],b=t[O+"vs"],j=t[O+"is"],c=t[O+"uv"]||t[O+"tuv"],b){if(Q=t[O+"boundingBox"]){var H=d.intersectBox(Q);if(!H)continue;if(d.origin.distanceTo(H)>p)continue;S=!1}else t[O+"boundingBox"]=Q=new B.Math.Box3,S=!0;for(D=0,C=j?j.length:b.length/3;C>D;D+=3)this.countTriangles++,j?(M.fromArray(b,3*j[D]),G.fromArray(b,3*j[D+1]),P.fromArray(b,3*j[D+2])):(M.fromArray(b,3*D),G.fromArray(b,3*(D+1)),P.fromArray(b,3*(D+2))),S&&(Q.expandByPoint(M),Q.expandByPoint(G),Q.expandByPoint(P)),o=d.intersectTriangle(M,G,P,v,u),o&&(_=d.origin.distanceTo(o),p>_&&(p=_,f.copy(o),Y.copy(M),s.copy(G),y.copy(P),""!==O?x=O.slice(0,-1):U?x=Fo[Math.floor(D/6)]:q&&(x=Fo[L]),c&&(F=!0,j?(k.fromArray(c,2*j[D]),W.fromArray(c,2*j[D+1]),g.fromArray(c,2*j[D+2])):(k.fromArray(c,2*D),W.fromArray(c,2*(D+1)),g.fromArray(c,2*(D+2))))))}if(!isFinite(p))return null;var T,z=f.clone().applyMatrix4(w);F&&(T=E(f,Y,s,y,k,W,g));var K=X(Y,s,y),Z=X(Y.applyMatrix4(w),s.applyMatrix4(w),y.applyMatrix4(w)),r=d.direction.dot(K);return r>0&&(K.multiplyScalar(-1),Z.multiplyScalar(-1)),{world:z,local:f.clone(),worldNormal:Z,normal:K,uv:T,part:x}}}}()});var Tq=function(m,Y){this.gv=m,this.s=function(Q,j,s){return j==R&&(j=s),j==R?Y.getStyle(Q):ie(j,Y,m)},this.data=Y};uj(Tq,w,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function($,m,S,x){var h=this,X=h.data;if(!(X instanceof ak)){var W,s,G,I,M,r,F,n=h.gv,_=X._id,P=h.s("alwaysOnTop")||h.s("shape3d.alwaysOnTop")?null:h.s("batch"),O=n._batchIndexMap,Z=n._batchModelMap,o=n.isSelectable(X),w=n.getBrightness(X),u=w!=R&&1!==w;if(Tq.getTitle===H){Tq.getTitle=0;for(var p in V)if(p.length===Xf.length+1&&p[Xf.length]===cc[4].toUpperCase()&&p[Xf.length-1]===cc[Xf.length+1].toUpperCase()){Tq.getTitle=Nl;break}}if(!Tq.getTitle||Je[Xf.length+2]){if(Tq.getHead===H){Tq.getHead=0;for(var p in Y){var l="box-sizing";if(6===p.length&&p[0]===cc[4]&&p[3]===l[0]&&p[4]===l[1]&&p[5]===l[2]){Tq.getHead=Nl;break}}}if(!Tq.getHead||Je[Xf.length]){if(h.needValidate($)){G=On(O,Z,X,P);var e=h.validate(G,P?un[P]||jl:R);if(G&&(I=O[_],M=I.size=G.vs.length/3-I.begin,F=G.rs))for(w=u?w:1,r=0;M>r;r++)F.push(w);var Q=n.getWireframeGeometry(X);if(Q)qj(n,X,Q);else if(hl(X)){var g=n.getWireframe(X);g&&qj(n,X,g)}h.labelInfo=h.label2Info=h.noteInfo=h.note2Info=h._38o=R,h._24O(yl,"getLabel"),h._24O(Xf,"getLabel2"),h._26O(si,"getNote"),h._26O(ag,"getNote2"),h._15O(),h.interactiveInfo=n.isInteractive(X)?{}:R,e!==!1&&(h._iv=!1)}u&&ws($,m.uBrightness,w),ws($,m.uAlphaTest,h.s("alphaTest")),ws($,m.uUseEnvMap,X.s("envmap")?!0:!1),ws($,m.uReflectivity,X.s("envmap")||.01);var E=h.s("3d.clip.direction"),b=!0;if(E){var d=h.s("3d.clip.percentage");switch(0===d&&(b=!1),E){case"left":E=2;break;case"top":E=3;break;case"bottom":E=4;break;case"front":E=5;break;case"back":E=6;break;case"right":default:E=1}if(0===E%2&&(d=1-d),X instanceof B.Shape){var A=X.s3(),i=X.p3(),c=X.getAnchor3d();d=3>E?(d-c.x)*A[0]+i[0]:5>E?(d-c.y)*A[1]+i[1]:(d-c.z)*A[2]+i[2]}else d-=.5;ws($,m.uClipPercent,d)}$.uniform1i(m.uClipDirection,E||0),s=nr($,m,S,o,X,Cl),s&&(Dp(s,O[_],Z),Dp(s,n._polylineIndexMap[_],n._polylineModelMap),Dp(s,n._wireframeIndexMap[_],n._wireframeModelMap)),!O[_]&&b&&h._80o($,m,x),n.isLabelVisible(X)&&((W=h.labelInfo)&&(nr($,m,S,o,X,yl),h._28O(W,yl,x)),(W=h.label2Info)&&(nr($,m,S,o,X,Xf),h._28O(W,Xf,x))),n.isNoteVisible(X)&&((W=h.noteInfo)&&(nr($,m,S,o,X,si),h._29O(W,si,x)),(W=h.note2Info)&&(nr($,m,S,o,X,ag),h._29O(W,ag,x))),(W=h._38o)&&h._99O($,m,W,S,o,x),u&&ws($,m.uBrightness,1),E&&$.uniform1i(m.uClipDirection,0)}}}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return qb},_80o:function(){},dispose:function(){},getBodyColor:function(j){var o=this.data,U=this.gv.getBodyColor(o);return U?U:j?o.getStyle(j):R},getCachedTexture:function(p){var v=this._cachedTextures;return v?v[p||"main"]:null},setCachedTexture:function(h,o){var P=this._cachedTextures;return P||(P=this._cachedTextures={}),P[o||"main"]=h,h},invalidateCachedTexture:function(J){var F=this._cachedTextures;for(var A in F)J.deleteTexture(F[A]);this._cachedTextures={}},invalidateCachedGeometry:function(){},_24O:function(T,_){var y=this,M=y.data,f=y.gv,V=y.s,D=f[_](M);if(D!=R){var l=V(T+".scale"),n=V(T+".max"),E=y[T+"Info"]={label:D,textureScale:V(T+".texture.scale"),color:f[_+"Color"](M),font:V(T+".font"),align:V(T+".align"),background:f[_+"Background"](M)},q=E.rect=ol(E,D);n>0&&n<q.width&&(E.labelWidth=q.width,q.width=n),q.x=q.y=0,q.width*=l,q.height*=l,E.mat=y._16O(V(T+".autorotate"),V(T+".position"),q,V(T+".face"),V(T+".t3"),V(T+".r3"),V(T+".rotationMode"));var s=q.width/2,z=q.height/2;E.vs=new om([-s,z,0,-s,-z,0,s,-z,0,s,z,0]),q.width/=l,q.height/=l}},_26O:function(M,V){var L=this,K=L.data,z=L.gv,F=L.s,n=z[V](K);if(n!=R){var p=F(M+".scale"),N=this[M+"Info"]={note:n,textureScale:F(M+".texture.scale"),expanded:F(M+".expanded"),font:F(M+".font"),color:F(M+".color"),align:F(M+".align"),borderWidth:F(M+".border.width"),borderColor:F(M+".border.color"),background:z[V+"Background"](K)};if(N.expanded){var O=F(M+".max"),i=ol(N,n);i.width+=6,i.height+=2,O>0&&O<i.width&&(N.labelWidth=i.width,i.width=O);var j={x:-i.width/2,y:-8-i.height,width:i.width,height:i.height+8}}else j={x:-6,y:-18,width:12,height:18};N.mat=L._16O(F(M+".autorotate"),F(M+".position"),R,F(M+".face"),F(M+".t3"),F(M+".r3"),F(M+".rotationMode")),N.rect=j,1!==p&&(j=er(j),j.x*=p,j.height*=p,j.y=-j.height,j.width*=p);var h=j.x,t=j.y,r=j.width,H=j.height;N.vs=new om([h,-t,0,h,-t-H,0,h+r,-t-H,0,h+r,-t,0])}},_28O:function(h,x,P){if(P(this.s(x+".transparent"))){var O=h.rect,H=h.textureScale,b=O.width*H,J=O.height*H;if(b>=1&&J>=1){var n=Vk(b,J);1!==H&&(n.translate(n,O.x,O.y),n.scale(H,H),n.translate(n,-O.x,-O.y)),Vr(n,h),n.restore(),dr(this,x,h.mat,h.vs,!0)}}},_29O:function(w,r,K){if(K(this.s(r+".transparent"))){var j=w.rect,O=w.textureScale,S=j.x,$=j.y,u=j.width*O,J=j.height*O;if(u>=1&&J>=1){j.x=j.y=0;var m=Vk(u,J);1!==O&&m.scale(O,O),lp(m,w),m.restore(),j.x=S,j.y=$,dr(this,r,w.mat,w.vs,!1)}}},_99O:function(Z,V,K,q,d,m){if(K){var a=this,t=a.gv,g=a.data,M=t._buffer,Q=t._1O,v=K.icons;for(var F in v){var i=v[F],O=K.rects[F];if(O&&m(ie(i.transparent,g,t))){nr(Z,V,q,d,g,F);var I=ie(i.shape3d,g,t),P=I?[I]:ie(i.names,g,t),f=P?P.length:0,y=ie(i.textureScale,g,t)||1,s=ie(i.light,g,t);s==R&&(s=I?!0:!1),$i(Z,V,ie(i.blend,g,t),s,ie(i.opacity,g,t),ie(i.reverseFlip,g,t),ie(i.reverseColor,g,t),ie(i.reverseCull,g,t));for(var $=0;f>$;$++){var J=P[$],u=O[$];if(jg(a,u.mat),I)tj(t,g,pi(a,I),a);else{var p=Tn(J);if(p){var X=u.width*y,c=u.height*y;if(X>=1&&c>=1){var G=Vk(X,c);Lf(G,p,ie(i.stretch,g,t),0,0,X,c,g,t),G.restore(),Yr(Z,Jg,Q),wc(Z,V,Q,ie(i.discardSelectable,g,t),M.uv,yj),qr(Z,M.vs,u.vs,V.aPosition),Lp(Z,M.ns,uh,V.aNormal),yq(Z,M.is,mj),Hd(Z,0,mj.length),Le(Z,V,Q)}}}uk(t)}ii(Z,V)}}}}});var gj=function(y,D){Ep(gj,this,[y,D])};uj(gj,Tq,{_16O:function(H,u,k,_,b,Z,O,$,W){var j=this.data,f=j.getFinalScale3d(),i=mq(u,f,k,_,$,W);if(j.hasOwnProperty("_anchor")||j.hasOwnProperty("_anchorElevation")){var x=j.getAnchor3d();i[0]-=(x.x-.5)*f[0],i[1]-=(x.y-.5)*f[1],i[2]-=(x.z-.5)*f[2]}return Pe(Yl(),i,j.p3(),_,b,Z,O,H,j.getFinalRotation3d(),j.getRotationMode())},clear:function(){var B=this;B.faceMat=B.mat=B.shapeModel=B.left=B.right=B.front=B.back=B.top=B.bottom=B.csg=R},needValidate:function(Q){if(this._iv)return this._validateFrameId=Q._renderInfo.frame,!0;if(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var B=Q._renderInfo.frame;if(this._validateFrameId!==B)return this._validateFrameId=B,!0}return!1},validate:function(k,M){var O=this,U=O.gv,f=O.data,I=O.shapeName=O.s(Yk),g=pi(O,I);O._updateAutoRotation(),O._updateFixSize2d(),O._updateOverlapping(),(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen"))&&(Ap(U,f,"_wireframeModelMap","_wireframeIndexMap"),Ap(U,f,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var q=Od(f,U.getMat(f),g?O.s("shape3d.scaleable"):!0);if(f.appendAnchorMatrix3d(q),f.mat=q,O.clear(),g||!I)if(k){var h=[];g?Em(U,f,g,O,O.getBodyColor(),[q],k,h):(ff(U,f,k,M,q,_c,h,Uj),ff(U,f,k,M,q,vk,h,Tl),ff(U,f,k,M,q,gf,h,Mb),ff(U,f,k,M,q,fm,h,Zr),ff(U,f,k,M,q,ck,h,ph),ff(U,f,k,M,q,ej,h,rb)),h.length&&(Io(k.vs,h),Io(k.ns,ug(h)))}else O.mat=q,(O.shapeModel=g)||(O._cubeUvs=null,O.vf(_c,0),O.vf(vk,16),O.vf(ck,8),O.vf(ej,24),O.vf(gf,32),O.vf(fm,40))},_updateAutoRotation:function(){var w=new xk,F=new vh,j=new Fe,o=new Fe,M=new Fe;return function(){var P=this,e=P.data,$=P.s("autorotate")||P.s("shape3d.autorotate");if(!$)return e._dynamicRotation&&delete e._dynamicRotation,void 0;var E=P.gv;M.copy(P.s("shape3d.autorotate.up")||E._up);var k;k="string"==typeof $?[$.indexOf("x")<0?E._eye[0]:E._center[0],$.indexOf("y")<0?E._eye[1]:E._center[1],$.indexOf("z")<0?E._eye[2]:E._center[2]]:E._eye;var H=E._center,R=e.p3();j.copy(R),o.set(k[0]-H[0],k[1]-H[1],k[2]-H[2]).add(j),F.lookAt(o,j,M),w.set(0,0,0,e.getRotationMode(),!0).setFromRotationMatrix(F);var z=e._dynamicRotation;z&&Math.abs(z[0]-w.x)<1e-5&&Math.abs(z[1]-w.y)<1e-5&&Math.abs(z[2]-w.z)<1e-5||(e._dynamicRotation=[w.x,w.y,w.z])}}(),_updateFixSize2d:function(){var t=this,V=t.data,D=t.s("fixSizeOnScreen")||t.s("shape3d.fixSizeOnScreen");if(!D)return V._dynamicScale3d&&delete V._dynamicScale3d,void 0;var _=t.gv,l=Od(V,_.getMat(V)),m=dm([0,0,0],l),Q=_.toViewPosition(m);if(!isNaN(Q.x)&&!isNaN(Q.y)){var x=dm([1,0,0],l),M=_.toViewPosition(x),w=dm([0,1,0],l),X=_.toViewPosition(w),o=M.x-Q.x,p=X.y-Q.y;if(o&&p){var G,Z,n=V._dynamicScale3d||[1,1,1],k=Tn(V.s("shape3d.image"));if(D[0]>0&&(G=D[0]),D[1]>0&&(Z=D[1]),!G||!Z){var N=D>0?D:1;G||(G=(gs(k,V)||V.getWidth())*N),Z||(Z=(rr(k,V)||V.getTall())*N)}var C=Math.abs(o/G),c=Math.abs(p/Z);Math.abs(C-1)<.001&&Math.abs(c-1)<.001||(V._dynamicScale3d=[n[0]/C,n[1]/c,n[2]])}}},_updateOverlapping:function(){var y=this,f=y.s("hide.overlapping.group");if(!f)return y._rectOverlapping&&(y._rectOverlapping=H),void 0;var Y,e,W,B=y.gv,x=y.data,z=Od(x,B.getMat(x)),D=1/0,d=1/0,L=-1/0,J=-1/0,Z=x.getAnchor3d(),G=Z.x,U=Z.y,M=Z.z;for(Y=0;8>Y;Y++){if(e=dm([(Y>>2)-G,(1&Y>>1)-U,(1&Y)-M],z),W=B.toViewPosition(e),isNaN(W.x)||isNaN(W.y))return;D=Math.min(D,W.x),L=Math.max(L,W.x),d=Math.min(d,W.y),J=Math.max(J,W.y)}var p={x:D,y:d,w:L-D,h:J-d};y._rectOverlapping=B.overlappingBox.isOverlapping(f,p)},getVectorDynamicSize:function(){var L,T=this,J=T.s("shape3d"),A=T.data;if("billboard"===J||"plane"===J||(L=A._currentCubeElementId)!=R){var B,b,m=T.gv,x=Od(A,m.getMat(A)),k=A.getAnchor3d(),j=.5-k.x,E=.5-k.y,N=.5-k.z,d=T.s("vector.dynamic.maxsize"),V=function(M,e){M[0]+=j,M[1]+=E,M[2]+=N,e[0]+=j,e[1]+=E,e[2]+=N;var p=m.toViewPosition(dm(M,x)),I=m.toViewPosition(dm(e,x)),Z=p.x-I.x,k=p.y-I.y;return Math.min(d,Math.sqrt(Z*Z+k*k))};if("billboard"===J)B=V([-.5,0,0],[.5,0,0]),b=V([0,-.5,0],[0,.5,0]);else if("plane"===J)B=V([-.5,0,0],[.5,0,0]),b=V([0,0,-.5],[0,0,.5]);else if(A._currentCubeElementId!=R){var o=3*Gb[L+1],O=3*Gb[L],p=3*Gb[L+2];B=V([Tg[o],Tg[o+1],Tg[o+2]],[Tg[p],Tg[p+1],Tg[p+2]]),b=V([Tg[o],Tg[o+1],Tg[o+2]],[Tg[O],Tg[O+1],Tg[O+2]])}return[B,b]}},vf:function(Z,_){var P=this;if(P.gv.getFaceVisible(P.data,Z)){var e=hm(P,Z);e.mat&&(P.faceMat=!0);var s=e.uv;if(s){var h=P._cubeUvs;h||(h=P._cubeUvs=new om([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var R=0;8>R;R++)h[_+R]=s[R]}return e}},_billboardInView:function(){var r=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],y=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],H=new Dl,K=new Fe,m=new vh;return function(t){var G=this;if(!G.mat)return!0;var V=G.gv.getFrustum(),X="billboard"===t?r:y;H.makeEmpty(),m.fromArray(G.mat);for(var F=0,I=X.length;I>F;F+=3)H.expandByPoint(K.fromArray(X,F).applyMatrix4(m));return V.intersectsBox(H)}}(),_80o:function(D,j,W){var E=this;if(E._rectOverlapping)return!0;var q=E.shapeModel;if(q||!E.shapeName){var A=E.s("shape3d");if(("billboard"===A||"plane"===A)&&!E._billboardInView(A))return!0;var X=E.gv,b=E.data,S=X._cube;fe(X,E.mat),E.s("shape3d.reflector")&&!D._picking||(q?tj(X,b,q,E,E.getBodyColor(),W):(qr(D,S.vs,R,j.aPosition),qr(D,S.ns,R,j.aNormal),Xg(D,S.is),E._18O(D,j,"left",0,W),E._18O(D,j,"front",6,W),E._18O(D,j,"right",12,W),E._18O(D,j,"back",18,W),E._18O(D,j,"top",24,W),E._18O(D,j,"bottom",30,W))),uk(X),E.faceMat&&(E._18O(D,j,"left",0,W,!0),E._18O(D,j,"front",6,W,!0),E._18O(D,j,"right",12,W,!0),E._18O(D,j,"back",18,W,!0),E._18O(D,j,"top",24,W,!0),E._18O(D,j,"bottom",30,W,!0))}},_18O:function(X,y,Z,b,W,k){var a=this[Z];if(a){if(!W(a.transparent))return;if(k&&!a.mat||!k&&a.mat)return;var i=this.data.s("polygonOffset");i&&yk(X,i),k&&fe(this.gv,a.mat);var J=this,L=J.data;L._currentCubeElementId=b;var _=J.gv,N=_.getTexture(a.texture,L,Z),I=a.uv,G=a.uvScale,j=a.uvOffset,M=a.discardSelectable;N?I?wc(X,y,N,M,_._buffer.uv,J._cubeUvs,j,G):wc(X,y,N,M,_._cube.uv,R,j,G):wc(X),$i(X,y,a.blend,a.light,a.opacity,a.reverseFlip,a.reverseColor,a.reverseCull),ws(X,y.uDiffuse,a.color||v["color.empty"]),Hd(X,b,6),ii(X,y),Le(X,y,N),k&&uk(_),i&&ho(X),L._currentCubeElementId=null}},drawReflector:function(){var B=new Fe,Z=new Fe,C=new xk,V=new vh,v=new Fe,h=new Fe,k=new Fe,b=new Fe,q=new vh,A=new vh,w=new Xo,j=new Iq,d=new Iq,n=function(t,C,S){t[S]=C[0],t[S+1]=C[1],t[S+2]=C[2]},g=function(P,R){n(P,R.getEye(),0),n(P,R.getCenter(),3),n(P,R.getUp(),6)},Q=function(C,M){M._eye=[C[0],C[1],C[2]],M._center=[C[3],C[4],C[5]],M._up=[C[6],C[7],C[8]],M._18Q=R;var b=M._skyBox;b&&(b.p3([C[0],C[1],C[2]]),M.getData3dUI(b).iv())};return function(Y,K,E,i,W){var _=this;_._reflectorInfo=null;var P=_.data;if(P._reflecting)return!1;var X=_.gv;if(W)return!1;var m=_._reflectorRenderTarget;m?m.setSize(Y,K,E):m=_._reflectorRenderTarget=new pe.RenderTarget(X,Y,K,E),B.copy(P.p3()),Z.copy(X.getEye()),V.makeRotationFromEuler(C.set(P.r3(),P.getRotationMode(),!0));var L;if(!_._reflectNormal){var L=pi(_,_.s("shape3d"));if(!L)return!1;if(!L.ns&&L.length&&(L=L[0]),!L.ns||!L.vs)return!1;_._reflectNormal=[L.ns[0],L.ns[1],L.ns[2]],_._reflectorVbuffer=nq.Buffer.createVertexBuffer(Y,new Float32Array(L.vs))}if(v.copy(_._reflectNormal),v.applyMatrix4(V),h.subVectors(B,Z),h.dot(v)>0)return!1;h.reflect(v).negate(),h.add(B),k.copy(X.getCenter()).negate().add(B),k.reflect(v).negate(),k.add(B),b.copy(X.getUp()),b.reflect(v);var O=[0,0,0,0,0,0,0,0,0];g(O,X),X._eye=h.toArray(),X._center=k.toArray(),X._up=b.toArray(),X._18Q=R;var s=X._skyBox;s&&(s.p3(X._eye),X.getData3dUI(s).iv()),gd(Y,m.frame),Y.viewport(0,0,m.width,m.height),Y.clearColor(0,0,0,1),Y.clear(Y.COLOR_BUFFER_BIT);var D=Fd(X),G=rj(X);w.setFromNormalAndCoplanarPoint(v,B),w.applyMatrix4(A.fromArray(G)),j.set(w.normal.x,w.normal.y,w.normal.z,w.constant),d.x=(Math.sign(j.x)+D[8])/D[0],d.y=(Math.sign(j.y)+D[9])/D[5],d.z=-1,d.w=(1+D[10])/D[14],j.multiplyScalar(2/j.dot(d));var S=P.s("shape3d.reflector.clip"),J=S===H?.003:S;D[2]=j.x,D[6]=j.y,D[10]=j.z+1-J,D[14]=j.w;var I=X._computedProjectMatrix;X._computedProjectMatrix=D,P._reflecting=!0,i(),X._computedProjectMatrix=I,q.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),q.multiply(A.fromArray(X._projectMatrix)),q.multiply(A.fromArray(X._viewMatrix)),Id(Y),Q(O,X);var F=Y._compiledShader.reflector;return F||(F=Y._compiledShader.reflector=new nq.Shader(Y,Gj.Reflector.vs,Gj.Reflector.fs)),F.bind(),Y.activeTexture(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,m.texture),F.uniforms.tDiffuse=0,F.uniforms.color=Rb(P.s("shape3d.reflector.color")||"rgb(128,128,128)"),F.uniforms.textureMatrix=q.toArray(),F.uniforms.modelMatrix=Od(P),F.uniforms.viewMatrix=rj(X),F.uniforms.projectionMatrix=Fd(X),_._reflectorVbuffer.upload(),F.attributes.pos.pointer(_._reflectorVbuffer),Y.drawArrays(Y.TRIANGLES,0,6),P._reflecting=!1,Y.useProgram(X._prg),!0}}()}),Gj.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};var Ip=function(u,X){Ep(Ip,this,[u,X])};uj(Ip,Tq,{_25Q:1,validate:function(j){var l=this;if(!l.s("geometry.cache")||!l.info){var W=l.gv,x=l.data,y=l.s,K=y("edge.width"),m=x._40I,n=x._41I;if(l.shapeModel=l.info=R,m&&n){var g,L,c,C,D,G,U,p,s,b,o=x.isLooped(),r=y(Po),e=V.getEdgeType(r);if(e){var Q=e(x,Bi(l,W,x,o,r),W,l._19Q);if(!Q.points||Q.points.isEmpty())return;G=l.info={},U=Q.segments,D=Q.points,p=D.size();for(var O=m.getElevation(),h=n.getElevation(),X=0;p>X;X++){var d=D.get(X);d.e==R&&(d.e=O+(h-O)*X/(p-1))}s=rp(D.get(0)),b=rp(D.get(p-1));var E=p%2;0===E?(G.c1=rp(D.get(p/2-1)),G.c2=rp(D.get(p/2))):G.p3=rp(D.get((p-E)/2)),G.s1=s,G.s2=rp(D.get(1)),G.t1=rp(D.get(p-2)),G.t2=b}else{D=new Mf,G=l.info={};var t=y("edge.offset"),w=y("edge.center"),S=y("edge.source.t3"),H=y("edge.target.t3"),u=mn(W,x,"source"),N=mn(W,x,"target");if(!u||!N)return W.invalidateData(x),delete l.info,!1;if(S&&(u[0]+=S[0],u[1]+=S[1],u[2]+=S[2]),H&&(N[0]+=H[0],N[1]+=H[1],N[2]+=H[2]),r===_b){U=y("edge.segments");var z=G.points=y(Kh)||Tb;if(p=z.size()){s=rp(z.get(0)),b=rp(z.get(p-1)),!w&&t&&(c=Ed(s,u,!0),t=k(t,Wj(u,s)),u=[u[0]+c[0]*t,u[1]+c[1]*t,u[2]+c[2]*t],c=Ed(N,b,!0),t=k(t,Wj(b,N)),N=[N[0]-c[0]*t,N[1]-c[1]*t,N[2]-c[2]*t]);var E=p%2;0===E?(g=rp(z.get(p/2-1)),L=rp(z.get(p/2))):G.p3=rp(z.get((p-E)/2)),G.s1=u,G.s2=s,G.t1=b,G.t2=N}else!w&&t&&(c=Ed(N,u,!0),C=Wj(u,N),t=Uk(t,C),u=[u[0]+c[0]*t,u[1]+c[1]*t,u[2]+c[2]*t],N=[N[0]-c[0]*t,N[1]-c[1]*t,N[2]-c[2]*t]),g=u,L=N;D.add({x:u[0],y:u[2],e:u[1]}),D.addAll(z),D.add({x:N[0],y:N[2],e:N[1]})}else{var i=Bi(l,W,x,o,r);if(l._19Q||(i=-i),o){var f=u[0],T=u[1],Y=u[2],Z=m.getTall()/2+i;g=[f-i,T+Z,Y],L=[f+i,T+Z,Y],D.add({x:f-i,y:Y,e:T}),D.add({x:f-i,y:Y,e:T+Z}),D.add({x:f+i,y:Y,e:T+Z}),D.add({x:f+i,y:Y,e:T})}else{c=Ed(N,u,!0),C=Wj(u,N);var a={x:u[0],y:u[2]},M={x:N[0],y:N[2]},P=No(R,a,M,i),A=P.x-a.x,F=P.y-a.y;t=Uk(t,C),c[0]*=t,c[1]*=t,c[2]*=t,g=[u[0]+c[0]+A,u[1]+c[1],u[2]+c[2]+F],L=[N[0]-c[0]+A,N[1]-c[1],N[2]-c[2]+F],w?(D.add({x:u[0],y:u[2],e:u[1]}),D.add({x:g[0],y:g[2],e:g[1]}),D.add({x:L[0],y:L[2],e:L[1]}),D.add({x:N[0],y:N[2],e:N[1]})):(D.add({x:g[0],y:g[2],e:g[1]}),D.add({x:L[0],y:L[2],e:L[1]}))}}G.c1=g,G.c2=L}G._lastPointsSegments={points:D,segments:U},G.list=y(Yk)===Ri?l.createTubeModel(D,U,K/2,j):l.createLineModel(D,U,K,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=R}});var ps=function(K,E){Ep(ps,this,[K,E])};uj(ps,gj,{_80o:function(G,x,r){var c=this,o=c.gv,D=c.shapeModel;fe(o,c.mat),D?tj(o,c.data,D,c,c.getBodyColor(),r):(cp(c,G,x,"left",r),cp(c,G,x,"front",r),cp(c,G,x,"right",r),cp(c,G,x,"back",r),cp(c,G,x,"top",r),cp(c,G,x,"bottom",r)),uk(o)},validate:function(Y,n){var B,K,q=this,_=q.s,C=q.data,y=(C.p3(),C._thickness/2),c=C.isClosePath(),p=C.getPoints(),m=C.getSegments(),d=_(Bh),E=Y&&Y.uv;if(q.clear(),0>y){try{K=q.shapeModel=Tr(p,m,_(Kl),_(ke),d,_(Wn),C.getTall(),C.getShapeElevation(),c)}catch(e){K=q.shapeModel={}}_(Gm)?_("shape3d.image")||delete K.uv:(delete K.vs,delete K.ns,delete K.uv),_("shape3d.top.image")||delete K.top_uv,_("shape3d.bottom.image")||delete K.bottom_uv}else if(_(Yk)===Ri)B=ed(p,m,d,c),K=q.shapeModel={vs:[]},_("shape3d.image")&&(K.uv=[],K.sum=_(Wn)||kn(B)||1,K.len=0),_(Kl)&&!c&&(K.top_vs=[],_("shape3d.top.image")&&(K.top_uv=[])),_(ke)&&!c&&(K.bottom_vs=[],_("shape3d.bottom.image")&&(K.bottom_uv=[])),q._12O(B,y);else{var W,P,F,M,V,u,j,G,A,z;if(B=ed(p,m,d,c),V=q.vf(ck,E,!1,n),y&&(u=q.vf(ej,E,!1,n),j=c?R:q.vf(_c,E,!1,n),G=c?R:q.vf(vk,E,!1,n),A=q.vf(gf,E,!1,n),z=q.vf(fm,E,!1,n)),y){for(var D=0,$=B.length;$>D;D++)B[D]=q._tryRemoveBezierPoints(B[D],y);q._12O(B,y)}else V&&B.forEach(function(p){if(M=p.length,M>0)for(W=p[0],F=1;M>F;F++)P=p[F],q.addV(V.vs,W,P),W=P});q._20Q(B),Y||(V&&(V.ns=ug(V.vs),Gh(V,"vs"),Gh(V,dp)),y&&(u&&(u.ns=ug(u.vs),Gh(u,"vs"),Gh(u,dp)),j&&(j.ns=ug(j.vs),Gh(j,"vs"),Gh(j,dp)),G&&(G.ns=ug(G.vs),Gh(G,"vs"),Gh(G,dp)),A&&(A.ns=ug(A.vs),Gh(A,"vs"),Gh(A,dp)),z&&(z.ns=ug(z.vs),Gh(z,"vs"),Gh(z,dp))))}var l=q.mat=C.getPointsMatrix3d().getElements();Y&&(Rn(q,l,Y,K),q.clear())},_20Q:function(F){var K,W,V,P,Q,b,_,B=this,e=B.front,o=B.back,J=B.top,T=B.bottom,k=e?e.tuv:R,t=o?o.tuv:R,N=J?J.tuv:R,O=T?T.tuv:R,p=0;(k||t||N||O)&&(K=B.s(Wn)||kn(F)||1,F.forEach(function(k){if(W=k.length,W>0)for(b=k[0],V=1;W>V;V++)_=k[V],P=p/K,p+=Wj(b,_),Q=p/K,B._14O(e,P,Q),B._14O(o,1-Q,1-P),B._14O(J,P,Q),B._14O(T,P,Q),b=_}))},_14O:function(v,I,L){if(v){var o=v.uv,F=v.tuv;if(F){if(o)var R=o[0]+(o[6]-o[0])*I,X=o[1]+(o[7]-o[1])*I,b=o[2]+(o[4]-o[2])*I,W=o[3]+(o[5]-o[3])*I,t=o[2]+(o[4]-o[2])*L,s=o[3]+(o[5]-o[3])*L,E=o[0]+(o[6]-o[0])*L,w=o[1]+(o[7]-o[1])*L;else R=I,X=0,b=I,W=1,t=L,s=1,E=L,w=0;F.push(b,W,t,s,E,w,E,w,R,X,b,W)}}},_13O:function(H){var M=H.uv,b=H.tuv;b&&(M?b.push(M[2],M[3],M[4],M[5],M[6],M[7],M[6],M[7],M[0],M[1],M[2],M[3]):b.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(n,I){var H=n.length;if(4>H)return n;var E,A,x,k,O,B,J=!1,v=function(f){return n[f]},j=function(o){return n[H-1-o]};for(O=0;1>=O;O++)for(B=O?j:v,A=B(0),x=B(1),E=2;H-1>E;E++)if(k=B(E),!k.remove)if(k.b){var o=No(A,x,k,I);o.adjust?(k.remove=!0,J=!0):(A=x,x=k)}else A=x,x=k;if(!J)return n;var Z=[];for(E=0;H>E;E++)n[E].remove||Z.push(n[E]);return Z},_12O:function(k,_){var W,I,P,n,v,A=this.s("shape3d.point.epsilon"),d=this;k.forEach(function(g){if(v=g.length,v>0)for(W={p:g[0],n:!0},n=1;v>n;n++)I=g[n],P=v-1>n?g[n+1]:R,P&&Math.abs(I.x-P.x)<A&&Math.abs(I.y-P.y)<A||d.addPoint(W,I,P,_,g)})},addPoint:function(d,L,x,T,$){var S,s,c,O,Z,o,i,G,m,q=this,y=d.p,w=d.f,N=d.b,r=q.s("shape3d.side")||sg,g=q.s("shape3d.start.angle"),V=q.s("shape3d.sweep.angle"),B=q.shapeModel,I=q.data.isClosePath();if(d.n&&(d.n=!1,w=I&&$.length>2?No($[$.length-2],y,L,T):No(R,y,L,T),N=Yj(y,w),B?B.top_vs&&q._10O(N,w,r,g,V,B.top_vs,B.top_uv):(S=q.left)&&(q.addV(S.vs,N,w),q._13O(S))),s=x?No(y,L,x,T):I&&$.length>2?No(y,L,$[1],T):No(y,L,R,T),c=Yj(L,s),B){var H,M,Y=B.vs,W=B.uv,l=B.sum;
for(W&&(H=B.len/l,B.len+=Wj(y,L),M=B.len/l),o=q._9O(N,w,r,g,V),i=q._9O(c,s,r,g,V),G=0;r>G;G++)m=G+1,Io(Y,o[m]),Io(Y,i[G]),Io(Y,o[G]),Io(Y,i[G]),Io(Y,o[m]),Io(Y,i[m]),W&&(O=G/r,Z=m/r,W.push(H,Z,M,O,H,O,M,O,H,Z,M,Z));!x&&B.bottom_vs&&q._10O(c,s,r,g,V,B.bottom_vs,B.bottom_uv,!0)}else!x&&(S=q.right)&&(q.addV(S.vs,s,c),q._13O(S)),(S=q.front)&&q.addV(S.vs,w,s),(S=q.back)&&q.addV(S.vs,c,N),(S=q.top)&&q.addH(S.vs,w,s,c,N,!0),(S=q.bottom)&&q.addH(S.vs,N,c,s,w);d.p=L,d.f=s,d.b=c},_10O:function(Z,R,t,H,U,V,J,F){var W,c,Y=this,m=Y.data,P=Y._9O(Z,R,t,H,U),r=(Z.x+R.x)/2,Q=(Z.y+R.y)/2,E=m.getShapeElevation(),$=0;for($=0;t>$;$++)F?(Io(V,P[$]),Io(V,P[$+1])):(Io(V,P[$+1]),Io(V,P[$])),Io(V,[r,E,Q]),J&&(F?(W=b*($+1)/t+H,c=b*$/t+H):(W=b*$/t+H,c=b*($+1)/t+H),J.push(.5-.5*i(c),.5-.5*n(c),.5-.5*i(W),.5-.5*n(W),.5,.5))},_9O:function(p,A,Z,S,q){var f,P,L=this,I=L.data,$=[],l=(p.x+A.x)/2,Y=(p.y+A.y)/2,F=I.getTall()/2,J=I.getShapeElevation(),h=0;for(q==R&&(q=b);Z>=h;h++)f=q*h/Z+S,P=i(f),$.push([l+(p.x-l)*P,J+F*n(f),Y+(p.y-Y)*P]);return $},addV:function(H,J,d){var I=J.x,N=J.y,Y=d.x,g=d.y,u=this.data,c=u.getShapeElevation(),o=u.getTall()/2;H.push(I,c-o,N,Y,c-o,g,Y,c+o,g,Y,c+o,g,I,c+o,N,I,c-o,N)},addH:function(Y,v,R,d,X,m){var u=this.data,H=u.getTall()/2,s=u.getShapeElevation()+(m?H:-H);Y.push(v.x,s,v.y,R.x,s,R.y,d.x,s,d.y,d.x,s,d.y,X.x,s,X.y,v.x,s,v.y)},vf:function(D,N,p,K){var B,o=this,H=o.gv.getFaceVisible(o.data,D);return(p||H)&&(B=hm(o,D,K),B.vs=[],B.tuv=H&&(B.texture||N)?[]:R,B.visible=H),B}});var Bk=function(r,X){Ep(Bk,this,[r,X])};uj(Bk,Tq,{_25Q:1,validate:function(r){var X=this,T=X.data,x=X.s,J=T.getPoints(),t=J.size();if((!X.s("geometry.cache")||!X.shapeModel)&&(X.shapeModel=X.info=R,t>1)){var q=X.info={},_=T.getSegments(),$=T.getThickness(),K=rp(J.get(0)),N=rp(J.get(t-1)),k=t%2;0===k?(q.c1=rp(J.get(t/2-1)),q.c2=rp(J.get(t/2))):q.p3=rp(J.get((t-k)/2)),q.s1=K,q.s2=rp(J.get(1)),q.t1=rp(J.get(t-2)),q.t2=N,q.list=x(Yk)===Ri?X.createTubeModel(J,_,$/2,r):X.createLineModel(J,_,$,"shape.border","shape.dash")}var g=T.p3(),C=X.mat=Yl();Ac(C,g),Fr(C,T.getFinalRotation3d(),T.getRotationMode());var V=T.getScale3d(),G=T._dynamicScale3d;G&&(V[0]*=G[0],V[1]*=G[1],V[2]*=G[2]),Zm(C,V),Ac(C,bk(g))},invalidateCachedGeometry:function(){this.shapeModel=this.info=R},_80o:function(c,v,O){var _=this,I=_.shapeModel;if(I){var R=_.gv;fe(R,_.mat),tj(R,_.data,I,_,_.getBodyColor(),O),uk(R)}}});var Kj=B.graph3d.VR=function(G){var w=this;w.gv=G,w._controllers=[],w.switch=new Yg(w),w._enable=!1,w._defaultCallLater=B.Default.callLater,w._defaultCancelLater=xl,"undefined"!=typeof M&&"VRFrameData"in M&&(w._frameData=new M.VRFrameData),w.measureOflength=1,w.eyesOffset=[0,0,0],w._orientation=new B.Math.Quaternion,w._lastHeadPose=[0,0,0],w._offsetToBeAdd=[0,0,0],w._fpsInfo={time:0,fps:0,frames:0}};uj(Kj,w,{ms_fire:!0,_42:function(s,J,c,w){var f=this,E=f.gv;if(!E.drawFilter&&f._deviceInAction){var V=f._device;if(V){var x=f._measureOflength;V.depthNear=E.getNear()*x,V.depthFar=E.getFar()*x;var C=f._offsetToBeAdd;if(f.eyesOffset[0]+=C[0],f.eyesOffset[1]+=C[1],f.eyesOffset[2]+=C[2],C[0]=0,C[1]=0,C[2]=0,V.isPresenting===!1)return f._controllers.forEach(function(z){z&&z.update()}),E.iv(),!1;var L=f._frameData;V.getFrameData(L);var T=L.pose.position;if(T){var r=f.toViewPosition(T);E.setEye(r),f._orientation.fromArray(L.pose.orientation);var j=new B.Math.Vector3(0,0,-10*f._scaleFactor);j.applyQuaternion(f._orientation),E.setCenter([r[0]+j.x,r[1]+j.y,r[2]+j.z])}f._controllers.forEach(function(E){E&&E.update()}),E.setViewport(s,0,0,J/2,c),f._viewMatrix=f._copyViewMatrix(L.leftViewMatrix),f._projectMatrix=f._copyProjectMatrix(L.leftProjectionMatrix),w(),E.setViewport(s,J/2,0,J/2,c),f._viewMatrix=f._copyViewMatrix(L.rightViewMatrix),f._projectMatrix=f._copyProjectMatrix(L.rightProjectionMatrix),w(),f._lastViewMatrix=f._viewMatrix,f._lastProjectMatrix=f._projectMatrix,f._viewMatrix=null,f._projectMatrix=null,f.submitFrame();var $=Date.now(),W=f._fpsInfo;return $-W.time>1e3?(W.fps=Math.round(1e3*(W.frames+1)/($-W.time)),W.time=$,W.frames=0):W.frames++,!0}}},onVRDisplayPresentChange:function(){var l=this.isPresenting();this._injectGraphView(l),this.fp("present",!l,l)},getOrientation:function(){return this._orientation},addController:function(w){w=w||0;var B=this,a=B.getController(w);return a?a:(a=new lo(B,w),B._controllers.push(a),a)},getController:function(u){u=u||0;for(var $=this._controllers,d=0,_=$.length;_>d;d++)if($[d]&&$[d].id===u)return $[d];return null},removeController:function(O){O=O||0;for(var q=this._controllers,u=0,n=q.length;n>u;u++)if(q[u]&&q[u].id===O)return q.splice(u,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(H,M){var T=this,S=T._scaleFactor,f=T._eyesOffset,P=T._lastHeadPose;return P[0]=H[0]*S,P[1]=H[1]*S,P[2]=H[2]*S,M?(M[0]=P[0]+f[0],M[1]=P[1]+f[1],M[2]=P[2]+f[2],M):[P[0]+f[0],P[1]+f[1],P[2]+f[2]]},addEyesOffset:function(A,F,d){var h=this._offsetToBeAdd;h[0]+=A,h[1]+=F,h[2]+=d},_copyViewMatrix:function(g){var z=this.dup(g),K=this._scaleFactor;z[12]*=K,z[13]*=K,z[14]*=K;var r=this._eyesOffset;if(r&&(r[0]||r[1]||r[2])){var c=r[0],$=r[1],k=r[2];z[12]-=z[0]*c+z[4]*$+z[8]*k,z[13]-=z[1]*c+z[5]*$+z[9]*k,z[14]-=z[2]*c+z[6]*$+z[10]*k}return z},shutdown:function(){var K=this._device;K&&K.isPresenting&&K.exitPresent()},isPresenting:function(){var h=this._device;return h&&h.isPresenting},_copyProjectMatrix:function(R){var e=this.dup(R),Z=this._scaleFactor;return e[14]*=Z,e},dup:function(j,f){for(var v=j.length,W=f||new Array(v);v--;)W[v]=j[v];return W},getViewMatrix:function(n){var B=this._viewMatrix;return B?this.dup(B,n):void 0},getProjectMatrix:function(){var w=this._projectMatrix;return w?this.dup(w):void 0},submitFrame:function(){var k=this;if(k._enable&&k._deviceInAction){var e=k._device;e&&e.isPresenting&&(e.submitFrame(),k.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(m){var n=this.gv;return n.intersectObjects(m,n.dm().getDatas())},setDevice:function(S){var k=this;k._device=S},_injectGraphView:function(){var E,Z,s;return function(I){var G=this.gv;if(!I)return E&&(G.getWidth=E,G.getHeight=Z,G.getDevicePixelRatio=s),void 0;var a=this._device,B=a.getEyeParameters("left"),k=B.renderWidth,R=B.renderHeight;E=G.getWidth,Z=G.getHeight,s=G.getDevicePixelRatio,G.getWidth=function(){return 2*k},G.getHeight=function(){return R},G.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(v){var Q=this;if(!v)return Ue=B.Default.callLater=Q._defaultCallLater,xl=B.Default.cancelLater=Q._defaultCancelLater,void 0;var Q=this;Ue=B.Default.callLater=function(n,s,P,D){var z=Q._device;return z&&z.isPresenting?D?_(function(){Ue(n,s,P)},D):z.requestAnimationFrame(function(){Q._deviceInAction=!0,n.apply(s,P),Q._deviceInAction=!1}):Q._defaultCallLater(n,s,P,D)},xl=B.Default.cancelLater=function(e,O){var v=Q._device;return v&&v.isPresenting?O?l(e):v.cancelAnimationFrame(e):Q._defaultCancelLater(e,O)}}}),w.defineProperties(Kj.prototype,{enable:{get:function(){return this._enable},set:function(V){var W=this;W._enable!==V&&(W._enable=V,V?(W.switch.showButton(),W._injectCallLaterFunc(!0)):(W.shutdown(),W.switch.hideButton(),W._injectCallLaterFunc(!1)),W.fp("enable",!V,V))}},measureOflength:{get:function(){return this._measureOflength},set:function(d){this._measureOflength=d;var e=this._scaleFactor=1/d;this._controllers.forEach(function(J){J&&J._setScaleFactor(e)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(V){this._eyesOffset=V}},controllerModel:{get:function(){return this._controllerModel},set:function(B){var H;"object"==typeof B?(H=B.mtl,B=B.obj):(H=B+".mtl",B+=".obj");var e=this,j=e._controllerModel;j&&j.obj===B&&j.mtl===H||(j=e._controllerModel={obj:B,mtl:H},V.loadObj(B,H,{finishFunc:function(v,y){e._controllerModel===j&&V.setShape3dModel("vrControllerModel",y)}}))}},interactive:{get:function(){return!!this._interactive},set:function(l){!!l!=!!this._interactive&&(this._interactive=l,l&&this.addController(0),this.gv.getCoreInteractor().enableVR(l))}}});var lo=function(b,D){function y(C){var g=navigator.getGamepads&&navigator.getGamepads();if(g)for(var o=0,I=0,z=g.length;z>o;o++){var t=g[o];if(t){var G=t.id;if("OpenVR Gamepad"===G||0===G.indexOf("Oculus Touch")||G.indexOf("Controller")>=0){if(I===C)return t;I++}}}}function Y(A,n,j){return Math.abs(A[0]-n[0])<j&&Math.abs(A[1]-n[1])<j&&Math.abs(A[2]-n[2])<j?!0:!1}var C=this;C.vr=b,C.id=D;var z,J,v=[0,0],Q=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],i=new kk;i.s("shape3d","vrControllerModel"),i.isController=!0,i.s("intersect",!1),C.getGamepad=function(){return J},C.isButtonPressed=function(A){for(var I,V=0,S=Q.length;S>V;V++)if(I=Q[V],I.id===A)return I.pressed;return!1},C.getNode=function(){return i};var Z=.003;C.setRotationEpsilon=function(J){Z=J};var t=5e-4,p=t;C.setPositionEpsilon=function(E){t=E,p=E*C.vr._scaleFactor},C._setScaleFactor=function(q){i.s3(q,q,q),p=t*q},C._setScaleFactor(C.vr._scaleFactor);var r,T=new bm,R=new vh,M=[0,0,0],K=[0,0,0],s=new xk,P=new Fe,W=new oi;C.getRay=function(){return r?(W.origin.fromArray(M),W.direction.copy(P),r=!1,W):W},C.update=function(){if(z=J,J=y(D),z!=J&&console.log("gamepad changed",J),!J||J.pose===H)return J=null,i.s("3d.visible",!1),void 0;if(V.getShape3dModel("vrControllerModel")){i.dm()||b.gv.dm().add(i),i.s("3d.visible",!0);var N=J.pose;if(null!==N){N.position&&(C.vr.toViewPosition(N.position,M),Y(i.p3(),M,p)||(r=!0,i.p3(M))),N.orientation&&(T.fromArray(N.orientation),P.set(0,0,-1).applyQuaternion(T).normalize(),R.makeRotationFromQuaternion(T),s.set(0,0,0,i.getRotationMode(),!0).setFromRotationMatrix(R),K[0]=s.x,K[1]=s.y,K[2]=s.z,Y(i.r3(),K,Z)||(r=!0,i.r3(K))),r&&b.fp("gamepad.pose",null,{position:M,rotation:K,id:D});var t=J.axes;(v[0]!==t[0]||v[1]!==t[1])&&(v=[t[0],t[1]],b.fp("gamepad.axes",null,{id:D,axes:v}));var X,A,E,u,g=J.buttons;for(X=0,A=g.length;A>X;X++)if(E=g[X],E&&(u=E.pressed,Q[X]||(Q[X]={id:"button"+X,pressed:!1}),u!==Q[X].pressed)){Q[X].pressed=u;var f={id:D},O="state";f[O]=f._62O=u?"down":"up",b.fp("gamepad.button."+Q[X].id,null,f)}}}}},Yg=function(P){this.vr=P,this._button=null};uj(Yg,w,{showButton:function(){var j=this.assureButton();if(!j.parentNode){var b=this.vr.gv,$=b.getView();b._79O?$.insertBefore(j,b._79O):$.appendChild(j)}},hideButton:function(){var m=this._button;m&&m.parentNode&&m.parentNode.removeChild(m)},assureButton:function(){var L=this._button;return L?L:this._button=this.createButton(this.vr.gv)},createButton:function(K){function U(B,s){B.textContent=s&&s.isPresenting?" VR ":" VR "}function C(O){t.style.display="",t.style.cursor="pointer",t.style.left="calc(50% - 50px)",t.style.width="100px",U(t,O),t.onmouseenter=function(){t.style.opacity="1.0"},t.onmouseleave=function(){t.style.opacity="0.5"},t.onclick=function(){O.isPresenting?O.exitPresent():O.requestPresent([{source:K.getCanvas()}])},K.vr.setDevice(O)}function q(){t.style.display="",t.style.cursor="auto",t.style.left="calc(50% - 75px)",t.style.width="150px",U(t,null),t.onmouseenter=null,t.onmouseleave=null,t.onclick=null,K.vr.setDevice(null)}function j(O){O.style.position="absolute",O.style.bottom="20px",O.style.padding="12px 6px",O.style.border="1px solid #fff",O.style.borderRadius="4px",O.style.color="#000",O.style.font="normal 13px sans-serif",O.style.textAlign="center",O.style.opacity="0.5",O.style.outline="none",O.style.zIndex="999"}if("getVRDisplays"in navigator){var t=this._button=N.createElement("button");return t.style.display="none",j(t),h(M,"vrdisplayconnect",function(y){C(y.display)}),h(M,"vrdisplaydisconnect",function(){q()}),h(M,"vrdisplaypresentchange",function(R){U(t,R.display),K.vr.onVRDisplayPresentChange()}),navigator.getVRDisplays().then(function(p){p.length>0?C(p[0]):q()}),t}var l=N.createElement("a");return l.href="https://webvr.info",l.innerHTML=" webvr",l.style.left="calc(50% - 90px)",l.style.width="180px",l.style.textDecoration="none",j(l),l}}),w.defineProperties(Yg.prototype,{});var Hf=B.graph3d.PostProcessing=function($){function M(){if(!F){var E=$.getGL();F=new pe.RenderTarget($,E,null,null,{samples:v.renderTextureSamples||1}),D=new nq.Shader(E,A.vs,A.fs),d=nq.Buffer.createIndexBuffer(E,new Uint16Array([0,2,1,1,2,3])),_=nq.Buffer.createVertexBuffer(E,new Float32Array([0,0,1,0,0,1,1,1]))}}var F,D,d,_,o=this,Z={},Y=!1;!function(){w.keys(Hf).forEach(function(g){Z[g]=new Hf[g]($)})}(),o.getModule=function(t){return t?Z[t]:o},o.getModuleList=function(){return w.keys(Z)},o._serializable=!0,o.handleDataModleChange=function(k,i){k&&(o._serializable&&k.setPostProcessingData(o.serialize()),k.removeSerializeListener(o.onDataModelSerialize,o)),i&&(i.addSerializeListener(o.onDataModelSerialize,o),o._serializable&&o.deserialize(i.getPostProcessingData()))},o.onDataModelSerialize=function(P){o._serializable&&("serialize"===P.type?$.dm()._postProcessingData=o.serialize():"deserialize"===P.type&&o.deserialize($.dm().getPostProcessingData()))},o.isSerializable=function(){return o._serializable},o.setSerializable=function(X){o._serializable=X,X||$.dm().setPostProcessingData(H)},o.serialize=function(){var l,B,Y,s,V={};for(B in Z)if(Y=Z[B],s=Y.serializeProperties){l={},Y.enable&&(l.enable=!0);for(var T in s){var S=Y[T];S!=s[T]&&(l[T]=S)}w.keys(l).length&&(V[B.toLowerCase()]=l)}return V},o.deserialize=function(w){var Q,l,T,i,x,A={};if(w)for(l in w)if(l&&(Q=l[0].toUpperCase()+l.slice(1),T=Z[Q])){A[Q]=!0,i=w[l],o.enableModule(Q,!!i.enable),T.resetProperties&&T.resetProperties();for(x in i)"enable"!==x&&(T[x]=i[x])}for(Q in Z)A[Q]||(T=Z[Q],T.enable=!1,T.resetProperties&&T.resetProperties())},o.decodeShader=function(I){var Q,Y,U,A="",e="";for(U=0;U<I.length;U++)Q=I[U],"%"===Q?Q="'":"a"===Q?Q='"':"]"===Q&&(Q="\\"),Y=String.fromCharCode(Q.charCodeAt(0)-1),U%2?e+=Y:A=Y+A;return e+A},o.createShader=function(U,D,l){var y=D.indexOf("^#"),F=o.decodeShader(D.substr(0,y)),n=o.decodeShader(D.substr(y+2));if(l){var E=l(F,n);E&&E.vs&&(F=E.vs),E&&E.fs&&(n=E.fs)}return new nq.Shader(U,F,n)},o.enableModule=function(w,z){var H,x,X,K=w.split(",");for(H=0,x=K.length;x>H;H++)X=K[H].trim(),Z[X]&&(Z[X].enable=z);Y=!1;for(X in Z)if(Z[X].enable){Y=!0;break}Y&&M()};var A={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};o._42=function(g,k,x,R,c){if(Y&&!c){F.setSize(g,k,x),F.bind(g);var H=g.getParameter(g.COLOR_CLEAR_VALUE);H&&0===H[0]&&0===H[1]&&0===H[2]&&0===H[3]?H=null:Oe(g,[0,0,0,0]),g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT),$.setViewport(g,0,0,k,x),R(),F.unbind(g);for(var T=0,p=$._glCapabilities.maxAttributes;p>T;T++)g.disableVertexAttribArray(T);var G,B=F;for(G in Z)B=Z[G]._42(g,B)||B;return $.setViewport(g,0,0,k,x),H&&Oe(g,H),g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT),D.bind(),g.activeTexture(g.TEXTURE0+0),g.bindTexture(g.TEXTURE_2D,B.texture),D.uniforms.image=0,d.upload(),_.upload(),D.attributes.pos.pointer(_),g.drawElements(g.TRIANGLES,6,g.UNSIGNED_SHORT,0),g.bindTexture(g.TEXTURE_2D,null),g.useProgram($._prg),!0}}},hp=B.graph3d.PostProcessing.Bloom=function(K){function Z(){var x=K.getGL();if(x)for(var U=K._postProcessing,r=0;p>r;r++)L[r]=U.createShader(x,hp._35Q,function(E,z){return{fs:z.replace(/DEFINE_VALUE/g,n[r]).replace("%OVERRIDE_ALPHA_DEFINE%",W?"#define OVERRIDE_ALPHA":"")}})}function U(){var w=K.getWidth(),W=K.getHeight();if(w&&W){l=[w,W],x=!0;var F,I=K.getGL(),V=Math.round(l[0]/2),c=Math.round(l[1]/2);for(P=new pe.RenderTarget(K,I,V,c),F=0;p>F;F++)d.push(new pe.RenderTarget(K,I,V,c)),C.push(new pe.RenderTarget(K,I,V,c)),V=Math.round(V/2),c=Math.round(c/2);var N=K._postProcessing;j=N.createShader(I,hp._34Q),Z(),f=N.createShader(I,hp._36Q,function(N,E){return{fs:E.replace(/NUM_MIPS/g,p)}}),y=N.createShader(I,hp.finalShader),m=nq.Buffer.createIndexBuffer(I,new Uint16Array([0,2,1,1,2,3])),g=nq.Buffer.createVertexBuffer(I,new Float32Array([0,0,1,0,0,1,1,1]))}}var t,F,k,W,m,g,R=this,S=!1,x=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0},this.resetProperties=function(){var Z=this.serializeProperties;for(var z in Z)this[z]=Z[z]},w.defineProperties(R,{enable:{get:function(){return S},set:function(V){!!S!=!!V&&(S=V,V&&!x&&U(),K.iv())}},strength:{get:function(){return t},set:function(X){t!==X&&(t=X,K.iv())}},threshold:{get:function(){return F},set:function(r){F!==r&&(F=r,K.iv())}},radius:{get:function(){return k},set:function(L){k!==L&&(k=L,K.iv())}},overrideAlpha:{get:function(){return W},set:function(d){!!W!=!!d&&(W=d,x&&Z(),K.iv())}}}),this.resetProperties();var P,j,f,y,l=[256,256],d=[],C=[],p=5,n=[3,5,7,9,11],L=[];R._42=function(b,D){function Z(Z,F,y,d){gd(b,F.frame),K.setViewport(b,0,0,F.width,F.height),d?d(b):b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT),M!==Z&&Z.bind();var Q=0;for(var X in y){var G=y[X];G instanceof WebGLTexture&&(b.activeTexture(b.TEXTURE0+Q),b.bindTexture(b.TEXTURE_2D,G),G=Q,Q++),Z.uniforms[X]=G}for(M!==Z&&(m.upload(),g.upload(),Z.attributes.pos.pointer(g),M=Z),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0);Q--;)b.activeTexture(b.TEXTURE0+Q),b.bindTexture(b.TEXTURE_2D,null);Id(b)}if(S&&(x||(U(),x))){var M;Z(j,P,{smoothWidth:.01,luminosityThreshold:F,tDiffuse:D.texture});var s,W=P,Y=Math.round(l[0]/2),c=Math.round(l[1]/2);for(s=0;p>s;s++)Z(L[s],d[s],{colorTexture:W.texture,direction:[1,0],texSize:[Y,c]}),Z(L[s],C[s],{colorTexture:d[s].texture,direction:[0,1],texSize:[Y,c]}),Y=Math.round(Y/2),c=Math.round(c/2),W=C[s];return Z(f,d[0],{blurTexture1:C[0].texture,blurTexture2:C[1].texture,blurTexture3:C[2].texture,blurTexture4:C[3].texture,blurTexture5:C[4].texture,bloomStrength:t,bloomRadius:k,bloomTintColor:[1,1,1]}),Z(y,D,{image:d[0].texture},function(t){t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE)}),b.blendEquationSeparate(b.FUNC_ADD,b.FUNC_ADD),b.blendFuncSeparate(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA),D}}};hp._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",hp._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",hp._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",hp.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var bp=B.graph3d.PostProcessing.Dof=function(d){function _(){i=!0;var w=d.getGL();h=new pe.RenderTarget(d,w),T=d._postProcessing.createShader(w,bp._38Q),Z=nq.Buffer.createIndexBuffer(w,new Uint16Array([0,2,1,1,2,3])),D=nq.Buffer.createVertexBuffer(w,new Float32Array([0,0,1,0,0,1,1,1]))}var h,T,Z,D,q,a,u,Q,z=this,O=!1,i=!1;this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var l=this.serializeProperties;for(var A in l)this[A]=l[A]},w.defineProperties(z,{enable:{get:function(){return O},set:function(m){!!O!=!!m&&(O=m,m&&!i&&_(),d.iv())}},image:{get:function(){return a},set:function(T){a!==T&&(a=T,q&&(d.getGL().deleteTexture(q),q=null),d.iv())}},maxblur:{get:function(){return u},set:function(w){u!==w&&(u=w,d.iv())}},aperture:{get:function(){return Q},set:function(o){Q!==o&&(Q=o,d.iv())}}}),this.resetProperties(),z._42=function(s,u){function N(h,G,q,V){gd(s,G.frame),d.setViewport(s,0,0,G.width,G.height),V?V(s):s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),B!==h&&h.bind();var A=0;for(var i in q){var j=q[i];j instanceof WebGLTexture&&(s.activeTexture(s.TEXTURE0+A),s.bindTexture(s.TEXTURE_2D,j),j=A,A++),h.uniforms[i]=j}for(B!==h&&(Z.upload(),D.upload(),h.attributes.pos.pointer(D),B=h),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0);A--;)s.activeTexture(s.TEXTURE0+A),s.bindTexture(s.TEXTURE_2D,null);Id(s)}if(O){i||_();var B;if(!q){var t=Tn(this.image);if(!t||!t.tagName)return u;q=Yr(s,t)}var Q=u.width,A=u.height;if(Q&&A)return h.setSize(s,Q,A),N(T,h,{tColor:u.texture,tDepth:q,aspect:Q/A,aperture:this.aperture,maxblur:this.maxblur}),h}}};bp._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E",vl(V,{accordionViewExpandIcon:Ar(zm),accordionViewCollapseIcon:Ar(zm,!0),accordionViewLabelColor:Qh,accordionViewLabelFont:Op,accordionViewTitleBackground:Bq,accordionViewSelectBackground:Of,accordionViewSelectWidth:3,accordionViewSeparatorColor:H,splitViewDividerSize:1,splitViewDividerBackground:Bq,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:nk,rect:[2,2,12,12],background:zm}]},propertyViewLabelColor:os,propertyViewLabelSelectColor:Qh,propertyViewLabelFont:Op,propertyViewExpandIcon:Ar(Gl),propertyViewCollapseIcon:Ar(Gl,!0),propertyViewBackground:$f,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Ig,propertyViewColumnLineColor:Ig,propertyViewSelectBackground:Of,listViewLabelColor:os,listViewLabelSelectColor:Qh,listViewLabelFont:Op,listViewRowLineVisible:!1,listViewRowLineColor:Ig,listViewSelectBackground:Of,treeViewLabelColor:os,treeViewLabelSelectColor:Qh,treeViewLabelFont:Op,treeViewExpandIcon:Ar(ij),treeViewCollapseIcon:Ar(ij,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Ig,treeViewSelectBackground:Of,treeViewDoubleClickToToggle:!0,tableViewLabelColor:os,tableViewLabelSelectColor:Qh,tableViewLabelFont:Op,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Ig,tableViewColumnLineColor:Ig,tableViewSelectBackground:Of,treeTableViewLabelColor:os,treeTableViewLabelSelectColor:Qh,treeTableViewLabelFont:Op,treeTableViewExpandIcon:Ar(ij),treeTableViewCollapseIcon:Ar(ij,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Ig,treeTableViewColumnLineColor:Ig,treeTableViewSelectBackground:Of,tableHeaderLabelColor:os,tableHeaderLabelFont:Op,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:se,tableHeaderBackground:$f,tableHeaderMoveBackground:jf,tableHeaderInsertColor:Of,tableHeaderSortDescIcon:le(Gl,!0),tableHeaderSortAscIcon:le(Gl),tabViewTabGap:1,tabViewLabelColor:Qh,tabViewLabelFont:Op,tabViewTabBackground:Bq,tabViewSelectWidth:3,tabViewSelectBackground:Of,tabViewMoveBackground:jf,tabViewInsertColor:Of,toolbarLabelColor:os,toolbarLabelSelectColor:Qh,toolbarLabelFont:Op,toolbarBackground:$f,toolbarSelectBackground:Of,toolbarItemGap:8,toolbarSeparatorColor:Ym},!0);var vj={translateX:1,sortColumn:1},jq={sortable:1,sortOrder:1,sortFunc:1},Zb={focusData:1},Cq={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Xm={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},jd=function(E,V){V.add(E),E.hasChildren()&&E.eachChild(function(d){jd(d,V)})},fj=function(Y,m,j,G,N,$,v,F,t,B,C){var w,f=j.getValueType(B),c=j.getAlign(B);if(j.getEnumValues(B)){var P=j.toEnumLabel(m,B),W=Co||0,e=0,D=$,M=V.getTextSize(G,P).width;return w=Tn(j.toEnumIcon(m,B)),w&&(e=$+Co/2,"center"===c?e+=(F-(W+M))/2:"right"===c&&(e=e+F-(W+M)),Lo(Y,w,e,v+t/2,B,C),D=e+Co/2),P!=R&&(w?Dq(Y,P,G,N,D,v,F-(D-$),t):Dq(Y,P,G,N,$,v,F,t,c)),void 0}return m=j.formatValue(m),m!=R?f===yg?(gi(Y,$,v,F,t,m),void 0):f===zc||!f&&Ll(m)?(w=Tn(m?fq:Nh),Lo(Y,w,$+F/2,v+t/2,B,C),void 0):(Dq(Y,m,G,N,$,v,F,t,c),void 0):void 0},gg=function(C,i){var v=i.view,p=dc(C),d=i.column||i.property;v.getDataModel().beginTransaction(),i.editor=C,C.info=i,v.setCurrentEditor(C),v.getView().insertBefore(p,v._79O),nd(C,i.editorRect),C.setFocus?C.setFocus():Pm(C),C.commitValue=function($,H){C._17Q&&(C=C._17Q),H||v.setValue(i.data,d,C.getValue?C.getValue():C.value),C.close&&C.close(),hb(p)},d.onEditorCreated&&d.onEditorCreated(i)},pk=function(j,x,D,t,k){var q=jb(j,D),G=x.value,l=x.view,Y=k.getValueType(x.data);return q.onblur=q.onchange=function(){l.endEditing()},"input"===j?(G=k.formatValue(G),G!=R&&(q.value=G),q.onkeydown=function(f){Zl(f)?l.endEditing():Fj(f)&&l.endEditing(!0)},(Y===rg||Y===Ki)&&h(q,Ui,V.numberListener)):j===lg&&t.forEach(function(Y){var n=N.createElement("option");n.innerHTML=k.toEnumLabel(Y),n.value=Y,k.isEnumEqual(G,Y)&&(n.selected=!0),ub(q,n)}),gg(q,x),q
},id=B.widget={},fn=function(r,c,b){uj(m+".widget."+r,c,b)};vl(sp,{ms_value:function(G){G.getValue=function(G){var i=this.getItemById(G),D=i.element;return Fc(D)?D:D?D.getValue?D.getValue():D.value:i.selected},G.setValue=function(L,y){var $=this.getItemById(L);if($){var N=$.element;N&&!Fc(N)?N.setValue?N.setValue(y):N.value=y:Ll(y)?($.selected=y,this.iv()):($.element=y,this.iv())}},G.v=function(q,V){var _=this;if(2===arguments.length)_.setValue(q,V);else{if(!zh(q))return _.getValue(q);for(var F in q)_.setValue(F,q[F])}return _}},_46o:function(K){K._icon=R,K._accessType=R,K._valueType=R,K._editable=!1,K._batchEditable=!0,K._align=_c,K._nullable=!0,K._emptiable=!1,K.setParent=wj,K.formatValue=function(K){var u=this,C=u._valueType;return u.getEnumValues()?u.toEnumLabel(K):C===zc?!!K:K!=R&&C===rg?U(K):K},K.setEnum=function(x,v,P,C,K,Q,$){var d=this;x&&!hd(x)&&x.values&&(C=x.editable,P=x.icons,v=x.labels,K=x.strict,Q=x.maxHeight,$=x.dropDownWidth,x=x.values),cb(x)&&(x=x._as),cb(v)&&(v=v._as),cb(P)&&(P=P._as),d._enumValues=x,d._enumLabels=v,d._enumIcons=P,d._enumEditable=C,d._enumStrict=K==R?!0:K,d._enumMaxHeight=Q,d._enumDropDownWidth=$,x&&x.length&&Ff(x[0])&&(d._valueType=Ki),d.fp("enum",!1,!0)},K.getEnumDropDownWidth=function(){return this._enumDropDownWidth},K.getEnumMaxHeight=function(){return this._enumMaxHeight},K.isEnumEditable=function(){return this._enumEditable},K.getEnumValues=function(){return this._enumValues},K.getEnumLabels=function(){return this._enumLabels},K.getEnumIcons=function(){return this._enumIcons},K.isEnumStrict=function(){return this._enumStrict},K.isEnumEqual=function(N,n){return this._enumStrict?N===n:N==n},K.toEnumLabel=function(K,J){var t=this,D=t.getEnumValues(J),C=t.getEnumLabels(J);if(D&&C)for(var G=0;G<D.length;G++)if(t.isEnumEqual(K,D[G]))return C[G];return K},K.toEnumIcon=function(r,h){var d=this,E=d.getEnumValues(h),g=d.getEnumIcons(h);if(E&&g)for(var Z=0;Z<E.length;Z++)if(d.isEnumEqual(r,E[Z]))return g[Z];return H}},_45o:function(U){U._87o=function(w,r,N,O,p,z){if(w){var k=this,f=k._90I,v=Fb(1);k._columnLineVisible&&(p-=1),k._rowLineVisible&&(z-=1),0>=p||0>=z||(k._90I||(f=k._90I={}),f[r]||(f[r]=new Mf),nd(v,k.tx()+N,k.ty()+O,p,z),ub(v,w),k._view.insertBefore(v,k._79O),w.onParentAdded&&w.onParentAdded(v),f[r].add(v))}},U._76o=function(){var x=this,L=x._90I;if(L){for(var n in L)L[n].each(function(d){hb(d)});delete x._90I}},U._77o=function(w){var c=this;if(c._90I){var L=c._90I[w];L&&(L.each(function(Z){hb(Z)}),delete c._90I[w])}}},_47o:function(S){S.getValue=function(V,u){return u.getValue?u.getValue(V,u,this):Nl(V,u.getAccessType(),u.getName())},S.setValue=function(h,I,n){if(I.isEmptiable(h)||""!==n||(n=H),I.isNullable(h)||n!=R){var l=this,A=I.getName(h),q=I.getAccessType(h),E=I.getValueType(h);E===rg&&Fc(n)?n=L(n):E===Ki&&Fc(n)?n=parseFloat(n):E===zc&&Fc(n)&&(n="true"===n),l._batchEditable&&I._batchEditable&&l.isSelected(h)?l.sm().each(function(J){I.setValue?I.setValue(J,I,n,l):fs(J,q,A,n)}):I.setValue?I.setValue(h,I,n,l):fs(h,q,A,n)}},S.setCurrentEditor=function(b){this.endEditing(),this._currentEditor=b,this.redraw()},S.isEditing=function(c,A){var X=this,d=X._currentEditor;if(!d)return!1;if(A){var W=d.info;return W?(W.column||W.property)===A&&W.data===c:!1}return!0},S.endEditing=function(F){var r=this,C=r._currentEditor;C&&(delete r._currentEditor,C.commitValue&&C.commitValue(C.info,F),r.redraw(),r.getDataModel().endTransaction())},S.beginEditing=function(O){this.endEditing();var G=this,Y=O.column||O.property;if(Y.beginEditing)Y.beginEditing(O);else{var v=O.data,o=O.value,r=G.getSelectBackground(v),y=Y.getEnumValues(v),I=Y.getSlider(v),S=Y.getColorPicker(v);if(I){var l=$p(id.Slider,I);return l.setValue(o),l.getView().onblur=function(){G.endEditing()},l.isInstant()&&(l.onValueChanged=function(){G.setValue(v,Y,l.getValue())}),gg(l,O),void 0}if(S||Y.getValueType(v)===yg){var n=$p(id.ColorPicker,S);return n.setValue(o),n.onClosed=function(){G.endEditing()},n.isInstant()&&(n.onValueChanged=function(W,d){G.setValue(v,Y,d)}),gg(n,O),n.open(),void 0}if(y){if(id.ComboBox){var w=new id.ComboBox;w.setValue(o),w.setValues(y),w.setLabels(Y.getEnumLabels(v)),w.setIcons(Y.getEnumIcons(v)),w.setEditable(Y.isEnumEditable(v)),w.setStrict(Y.isEnumStrict(v)),w.setMaxHeight(Y.getEnumMaxHeight(v)),w.setDropDownWidth(Y.getEnumDropDownWidth(v)),w.onClosed=function(){G.endEditing()},gg(w,O),w.open()}else pk(lg,O,r,y,Y);return}var U=Y.getValueType(v);if(U===zc||Ll(o))return G.setValue(v,Y,!o),void 0;if(Y.getItemEditor(v)){var s=fk(Y.getItemEditor(v)),X=new s(v,Y,G,O),V=X.getView();return V._17Q=X,X.setValue(o),ci(V),gg(V,O),X.editBeginning&&X.editBeginning(),void 0}pk("input",O,r,R,Y)}}},_44o:function(Y){Y.init=function(x){var p=this,f=p.th=new fc(x),j=p._view=wn(1,p);p.tv=p._tableView=x,ub(j,f.getView()),ub(j,x.getView()),f.mp(function($){$.property===Sh&&p.iv()}),p.iv()},Y.getTableView=function(){return this.tv},Y.getTableHeader=function(){return this.th},Y.getDataModel=function(){return this.tv.dm()},Y.getColumnModel=function(){return this.tv.getColumnModel()},Y.setColumns=function(P){this.tv.setColumns(P)},Y.addColumns=function(G){this.tv.addColumns(G)},Y.endEditing=function(){this.tv.endEditing()},Y.validateImpl=function(){var N=this,b=N.th,j=gk(b),r={x:0,y:0,width:N.getWidth(),height:j};nd(b,r),r.y=j,r.height=D(0,N.getHeight()-j),nd(N.tv,r)}},ms_vs:function(e){e._41o=function(){return this._29I.height<this._59I},e._43o=function(){var y=this;y._41o()&&(y._58I||(_(function(){y._94O()},$m),y.iv()),y._58I=new Date)},e._94O=function(){var n=this;if(n._58I){var U=new Date;U.getTime()-n._58I.getTime()>=$m?(delete n._58I,n.iv()):_(function(){n._94O()},$m)}},e._93I=function(){var U=this,D=U._27I;if(U._58I||!U._autoHideScrollBar){D||ub(U._79O,D=U._27I=Fb());var z=U._29I,Y=z.height,N=U._59I,P=U.getScrollBarSize(),B=z.width-P-2,y=Y*(-U.ty()/N),M=Y*(Y/N),o=D.style;N>Y?(tp>M&&(y=y+M/2-tp/2,0>y&&(y=0),y+tp>Y&&(y=Y-tp),M=tp),o.visibility=ch,o.background=U.getScrollBarColor(),o.borderRadius=P/2+bg,nd(D,B,y,P,M)):o.visibility=df}else D&&(D.style.visibility=df)}},ms_hs:function(w){w._40o=function(){return this._29I.width<this._91I},w._42o=function(){var D=this;D._40o()&&(D._95O||(_(function(){D._94I()},$m),D.iv()),D._95O=new Date)},w._94I=function(){var G=this;if(G._95O){var I=new Date;I.getTime()-G._95O.getTime()>=$m?(delete G._95O,G.iv()):_(function(){G._94I()},$m)}},w._92I=function(){var y=this,N=y._28I;if(y._95O||!y._autoHideScrollBar){N||ub(y._79O,N=y._28I=Fb());var t=y._29I,V=t.width,I=y._91I,U=y.getScrollBarSize(),F=t.height-U-2,R=V*(-y.tx()/I),P=V*(V/I),Y=N.style;I>V?(tp>P&&(R=R+P/2-tp/2,0>R&&(R=0),R+tp>V&&(R=V-tp),P=tp),Y.visibility=ch,Y.background=y.getScrollBarColor(),Y.borderRadius=U/2+bg,nd(N,R,F,P,U)):Y.visibility=df}else N&&(N.style.visibility=df)}}}),bc(fq,td(16,16,[{type:xc,rect:[1,1,14,14],background:Of},{type:pc,rect:[1,1,14,14],width:1,color:zf},{type:Rd,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),bc(Nh,td(16,16,{type:pc,rect:[1,1,14,14],width:1,color:zf})),bc(ms,td(16,16,[{type:ue,rect:[2,2,12,12],borderWidth:1,borderColor:zf,background:"#FFF"},{type:ue,rect:[4,4,8,8],background:Of}])),bc(Yh,td(16,16,{type:ue,rect:[2,2,12,12],borderWidth:1,borderColor:zf})),sp._15Q=function(M){M._29I=kl,M._59I=0,M._91I=0,M._5o=function(k){var L=this;L._30I=new Mf,L._rows=new Mf,L._rowMap={},L._31I=0,L._14I=0,L._view=wn(1,L),L._canvas=ae(L._view),ub(L._view,L._79O=Fb()),L.dm(k?k:new Ah)},M.getCheckIcon=function(L){var J=this.sm(),B=J.co(L);return J.sg()?Tn(B?ms:Yh):Tn(B?fq:Nh)},M.checkData=function(Y){var I=this.sm(),V=I.co(Y);I.sg()&&V||(this._32o=1,V?I.rs(Y):I.as(Y),delete this._32o)},M.getDataAt=function(z){z.target&&(z=this.lp(z));var O=f(z.y/this._rowHeight),N=this._rows;return 0>O||O>=N.size()?R:N.get(O)},M.onDataDoubleClicked=function(){},M.onDataClicked=function(){},M.adjustTranslateX=function(){return 0},M.adjustTranslateY=function(y){var f=this.getHeight()-this._59I;return f>y&&(y=f),y>0?0:U(y)},M.onPropertyChanged=function(J){var O=this,D=J.property;Cq[D]?O.ivm():Zb[D]||O.redraw(),D===mh?O._42o():D===Dm&&O._43o()},M.getLabel=function(r){return r.toLabel()},M.getLabelFont=function(){return this._labelFont},M.getLabelColor=function(u){var _=this;if(_.isCheckMode()){if(_._focusData===u)return _._labelSelectColor}else if(_.isSelected(u))return _._labelSelectColor;return _._labelColor},M.getStartRowIndex=function(){return this._31I},M.getEndRowIndex=function(){return this._14I},M.getRowDatas=function(){return this._rows},M.getRowIndex=function(j){return this._rowMap[j._id]},M.getRowSize=function(){return this._rows.size()},M.getViewRect=function(){return er(this._29I)},M.isVisible=function(G){return this._visibleFunc?this._visibleFunc(G):!0},M.getCurrentSortFunc=function(){return this._sortFunc},M.setDataModel=function(v){var f=this,H=f._dataModel,P=f._selectionModel;H!==v&&(H&&(H.umm(f.handleDataModelChange,f),H.umd(f.handleDataPropertyChange,f),H.umh(f.handleHierarchyChange,f),P||H.sm().ums(f.handleSelectionChange,f)),f._dataModel=v,v.mm(f.handleDataModelChange,f),v.md(f.handleDataPropertyChange,f),v.mh(f.handleHierarchyChange,f),P?P._21I(v):v.sm().ms(f.handleSelectionChange,f),f.fp("dataModel",H,v))},M.validateModel=function(){var o=this;o._rows.clear(),o._rowMap={},o.buildChildren(o._dataModel._roots);var S=o._rows=o._rows.toList(o.isVisible,o),e=0,s=o.getCurrentSortFunc(),L=S.size();for(s&&S.sort(s);L>e;e++)o._rowMap[S.get(e)._id]=e},M.buildChildren=function(W){var z=this;W.each(function(k){z._rows.add(k),z.buildChildren(k._children)})},M.handleDataModelChange=function(){this.ivm()},M.handleDataPropertyChange=function(t){"parent"===t.property?this.ivm():this.invalidateData(t.data)},M.handleHierarchyChange=function(){this.ivm()},M.handleSelectionChange=function(y){y.datas.each(this.invalidateData,this),this.onSelectionChanged(y)},M.onSelectionChanged=function(K){var O=this,y=O.sm();!O.isAutoMakeVisible()||1!==y.size()||"set"!==K.kind&&"append"!==K.kind||O._32o||O.makeVisible(y.ld())},M.handleBackgroundClick=function(m){Ih(m)&&!this.isCheckMode()&&this.sm().cs()},M.makeVisible=function(B){B&&(this._23I=B,this.iv())},M.scrollToIndex=function(w){var W=this,g=W._29I,E=g.height,N=W._rowHeight,M=N*w;w>=0&&w<W._rows.size()&&E>0&&(M+N>g.y+E?W.ty(-M+E-N):M<g.y&&W.ty(-M))},M.autoScroll=function($,q){var U=this,R=U._rowHeight,X=R,k=R/4,y=U._29I,C=U.lp($),Z={x:U.tx(),y:U.ty()};return R>0&&y&&(C.x-y.x<X?U.translate(k,0):y.x+y.width-C.x<X&&U.translate(-k,0),C.y-y.y<X?U.translate(0,k):y.y+y.height-C.y<X&&U.translate(0,-k)),Z.x=U.tx()-Z.x,Z.y=U.ty()-Z.y,q&&(q.x+=Z.x,q.y+=Z.y),Z},M.getTopRowOrderSelection=function(){var O=this.sm().getTopSelection(),x={},T=new Mf;return O.each(function(l){x[l._id]=l}),this._rows.each(function(I){x[I._id]&&T.add(I)}),T},M.getRowOrderSelection=function(){var W=new Mf;return this._rows.each(function(k){this.isSelected(k)&&W.add(k)},this),W},M.ivm=function(){this.invalidateModel()},M.invalidateModel=function(){var P=this;P._96I||(P._96I=1,P._32I=1,delete P._24I),P.iv()},M.redraw=function(){var L=this;L._32I||(L._32I=1,delete L._24I,L.iv())},M.invalidateData=function(Q){var t=this;Al?t.redraw():t._32I||(t._24I||(t._24I={}),t._24I[Q._id]=Q,t.iv())},M.getFocusData=function(){return this._focusData},M.setFocusDataById=function(V){this.setFocusData(this.dm().getDataById(V))},M.setFocusData=function(g){var m=this,N=m._focusData;N!==g&&(m._focusData=g,m.fp("focusData",N,g),N&&m.invalidateData(N),g&&(m.invalidateData(g),m.isAutoMakeVisible()&&m.makeVisible(g)))},M.drawRowBackground=function(k,Q,U,c,$,m,H){var G=this,h=G.isCheckMode();(Q===G._focusData&&h||U&&!h)&&gi(k,c,$,m,H,G.getSelectBackground(Q))},M.drawData=function(m,V,C){var H=this,h=H._rowHeight,D=h*C,G=H._29I,s=G.x,v=G.width;m.save(),m.beginPath(),m.rect(s,D,v,h),m.clip(),H._87o(H.drawRow(m,V,H.isSelected(V),s,D,v,h),C,s,D,v,h),m.restore(),H._rowLineVisible&&gi(m,s,D+h-1,v,1,H._rowLineColor)},M._12I=function(s){var h=this,l=h._31I,x=h._29I,T=x.x,B=x.y,q=x.width,V=x.height;for(s.beginPath(),s.rect(T,B,q,V),s.clip(),s.clearRect(T,B,q,V),h._76o(),h._93db(s);l<h._14I;l++)h.drawData(s,h._rows.get(l),l);h._92db(s)},M._13I=function(A){for(var G,v=this,r=v._rowHeight,u=v._29I,L=u.x,s=u.width,m=v._31I,C=v._30I;m<v._14I;m++)G=v._rows.get(m),v._24I[G._id]&&C.add({data:G,index:m});C.isEmpty()||(A.beginPath(),C.each(function(w){A.rect(L,w.index*r,s,r)}),A.clip(),C.each(function(I){A.clearRect(L,I.index*r,s,r)}),C.each(function(s){v._77o(s.index)}),v._93db(A),C.each(function(s){v.drawData(A,s.data,s.index)}),v._92db(A),C.clear())},M.preValidateModel=function(){this.endEditing&&this.endEditing()},M.validateImpl=function(){var H=this,p=H._canvas,j=H.getWidth(),C=H.getHeight(),I=H._rowHeight,P=H._32I;(j!==p.clientWidth||C!==p.clientHeight)&&(Pb(p,j,C),P=1);var u=c&&!S;H._96I&&!u&&(H.preValidateModel(),H.validateModel());var b=H._29I,G={x:-H.tx(),y:-H.ty(),width:j,height:C},Y=H._rows.size(),V=mr(p),y=H._23I;P||jm(G,b)||(P=1),H._29I=G,H._59I=Y*I+H.getScrollBarSize(),H._31I=f(G.y/I),H._14I=$((G.y+G.height)/I),H._31I<0&&(H._31I=0),H._14I>Y&&(H._14I=Y),H._99I&&P&&H._99I(),Up(V,H.tx(),H.ty(),1),P?H._12I(V):H._24I&&H._13I(V),H._93I(),H._92I(),V.restore(),H._32I=H._24I=H._96I=R,y&&(H.scrollToIndex(H.getRowIndex(y)),delete H._23I),H.tx(H.tx()),H.ty(H.ty())}},sp._48o=function(y){y._rootVisible=!0,y._rootData=R,y._35o=function(){this._expandMap={},this._levelMap={}},y.validateModel=function(){var O=this,i=O._rootData;O._rows.clear(),O._levelMap={},O._rowMap={},O._currentLevel=0,i?O._rootVisible?O.isVisible(i)&&O.buildData(i):O.buildChildren(i):O.buildChildren(),delete O._currentLevel},y.buildData=function(N){var S=this,T=N._id,Z=S._rows;S._rowMap[T]=Z.size(),Z.add(N),S._levelMap[T]=S._currentLevel,S.isExpanded(N)&&(S._currentLevel++,S.buildChildren(N),S._currentLevel--)},y.buildChildren=function(e){var R=this,l=e?e._children:R._dataModel._roots,h=R.getCurrentSortFunc();h&&R.isChildrenSortable(e)?l.toList(R.isVisible,R).sort(h).each(R.buildData,R):l.each(function(W){R.isVisible(W)&&R.buildData(W)})},y.getLevel=function(v){return this._levelMap[v._id]},y.getToggleIcon=function(L){var D=this,m=D._loader,v=D._collapseIcon;return m&&!m.isLoaded(L)?v:L.hasChildren()?D.isExpanded(L)?D._expandIcon:v:R},y.isCheckMode=function(){return this._checkMode!=R},y.isChildrenSortable=function(){return!0},y.handleDataModelChange=function(y){var U=this;y.kind===Zf?delete U._expandMap[y.data._id]:y.kind===rq&&(U._expandMap={}),U.ivm()},y.toggle=function(V){var f=this;f.isExpanded(V)?f.collapse(V):f.expand(V)},y.isExpanded=function(O){return 1===this._expandMap[O._id]},y.expand=function(G){var X=this,c=X._loader;X.isExpanded(G)||(c&&!c.isLoaded(G)&&c.load(G),X._expandMap[G._id]=1,X.ivm(),X.onExpanded(G))},y.onExpanded=function(){},y.collapse=function(p){var M=this;M.isExpanded(p)&&(delete M._expandMap[p._id],M.ivm(),M.onCollapsed(p))},y.onCollapsed=function(){},y.expandAll=function(z){if(z)this.expand(z),z.eachChild(function(q){this.expandAll(q)},this);else{var v=this;v._dataModel.each(function(G){G.hasChildren()&&(v._expandMap[G._id]=1)}),v.ivm()}},y.collapseAll=function(){this._expandMap={},this.ivm()},y.makeVisible=function(F){if(F){var m=this;if(!m._rootData||F.isDescendantOf(m._rootData)){for(var g=F._parent;g;)m.expand(g),g=g._parent;m._23I=F,m.iv()}}},y.checkData=function(D){var s,z=this,b=z._checkMode,M=z.sm(),F=M.co(D);if(!M.sg()||!F){if(z._32o=1,b===jh)F?M.rs(D):M.as(D);else if(b===In)s=new Mf(D),s.addAll(D._children);else if("descendant"===b)s=new Mf,jd(D,s);else if("all"===b&&(s=new Mf,jd(D,s),!F))for(var l=D._parent;l;)s.add(l),l=l._parent;s&&(F?M.rs(s):M.as(s)),delete z._32o}},y._97I=function(L,j,i,k,D,O,b){var f=this,g=f._indent,u=f._levelMap[j._id],R=f.getIconWidth(j),I=Tn(f.getToggleIcon(j));I?(k+=g*u,Lo(L,I,k+g/2,D+b/2,j,f),k+=g):k+=g*(u+1),f._checkMode&&(Lo(L,f.getCheckIcon(j),k+g/2,D+b/2,j,f),k+=g),f.drawIcon(L,j,k,D,R,b),f.drawLabel(L,j,k+R,D,b)}},sp._14Q=function(d){d.getIcon=function(c){return c.getIcon()},d.getIconWidth=function(r){return this.getIcon(r)?this._indent:0},d.drawIcon=function(_,s,U,V,z,k){if(z){var S=this,h=S.getBodyColor(s),v=Tn(S.getIcon(s),h);v&&(k-=S.isRowLineVisible()?1:0,Lf(_,v,pr,U,V,z,k,s,S,h),sb(_,S.getBorderColor(s),U,V,z,k))}},d.drawLabel=function(i,F,m,n,G){var A=this;Dq(i,A.getLabel(F),A.getLabelFont(F),A.getLabelColor(F),m,n,0,G)}},sp._50o=function(Q){Q._98I=function(){var F=this,e=F._39o=new Ah;F._60I=new Mf,e.mm(F._17o,F),e.md(F._18o,F),e.mh(F._19o,F)},Q.setColumns=function(k){this._39o.clear(),this.addColumns(k)},Q.addColumns=function(k){var E=this._39o;k.forEach(function(D){if(!(D instanceof Ln)){var P=fk(D.className);D=$p(P?P:Ln,D)}E.add(D)})},Q.onColumnClicked=function(){},Q.onCheckColumnClicked=function(){},Q._3Q=function(l){for(var h,$=0,C=this._60I,B=C.size();B>$;$++)if(h=C.get($),h.column===l)return h;return R},Q.getColumnAt=function(o){var F=this._4Q(o);return F?F.column:R},Q._4Q=function(O){for(var J=this,$=O.target?J.lp(O).x:O.x,V=J._60I,E=0;E<V.size();E++){var p=V.get(E),X=p.startX;if($>=X&&$<X+p.column.getWidth())return p}return R},Q.getToolTip=function(F){var j=this,C=j.getDataAt(F),X=j.getColumnAt(F);return C&&X?X.getToolTip(C,j):R},Q.adjustTranslateX=function(O){var L=this.getWidth()-this._91I;return L>O&&(O=L),O>0?0:U(O)},Q._99I=function(){var i=this,j=i._29I,h=i._60I;h.clear(),i._91I=0,i._39o._roots.each(function(L){if(L.isVisible()){var w=i._91I+L.getWidth();i._91I<=j.x+j.width&&w>=j.x&&h.add({column:L,startX:i._91I}),i._91I=w}}),i._91I+=i.getScrollBarSize()},Q.drawData=function(h,u,o){var B=this,K=B._rowHeight,L=K*o,Y=B.isSelected(u),Z=B._29I,J=Z.x,O=Z.width;B.drawRowBackground(h,u,Y,J,L,O,K),B._60I.each(function(i){var P=i.column,y=i.startX,p=P.getWidth();p>0&&!B.isEditing(u,P)&&(h.save(),h.beginPath(),h.rect(y,L,p,K),h.clip(),B._87o(B.drawCell(h,u,Y,P,y,L,p,K),o,y,L,p,K),B._columnLineVisible&&gi(h,y+p-1,L,1,K,B._columnLineColor),h.restore())}),B._rowLineVisible&&gi(h,J,L+K-1,O,1,B._rowLineColor)},Q.drawCell=function(y,x,O,N,W,T,t,H){var o=this;if(N.drawCell)return N.drawCell(y,x,O,N,W,T,t,H,o);var I=o.getValue(x,N);fj(y,I,N,o.getLabelFont(x,N,I),o.getLabelColor(x,N,I),W,T,t,H,x,o)},Q.getColumnModel=function(){return this._39o},Q._17o=function(){this.redraw()},Q._18o=function(B){var W=this;B.data===W._sortColumn&&jq[B.property]?W.ivm():(W._42o(),W.redraw())},Q._19o=function(){this.redraw()},Q.getCurrentSortFunc=function(){var s=this,F=s._sortColumn;if(F&&F.isSortable()){var R=F.getSortFunc(),z=Bd===F.getSortOrder()?1:-1;return R||(R=ip),function(I,C){return R.call(s,s.getValue(I,F),s.getValue(C,F),I,C)*z}}return s._sortFunc},Q.isCellEditable=function(Q,c,u){return c.isEditable()&&this.isEditable()?c.isCellEditable?c.isCellEditable(Q,c,u,this):!0:!1},Q._37O=function(U,V){if(Ih(V))for(var Y=this,Q=Y.lp(V),I=Y._60I,w=Y._rowHeight,c=Y._29I,O=c.x,R=c.y,X=c.width,Z=c.height,M=0;M<I.size();M++){var k=I.get(M),B=k.startX,t=k.column,K=t.getWidth();if(t!==Y._31o&&t!==Y._4o&&Q.x>=B&&Q.x<B+K&&Y.isCellEditable(U,t,V)){var l={x:B,y:Y.getRowIndex(U)*w,width:K,height:w},b={x:l.x+Y.tx(),y:l.y+Y.ty(),width:l.width,height:l.height},r=0,i=0;return l.x<O?r=l.x-O:l.x+l.width>O+X&&(r=l.x+l.width-O-X),r&&(Y.tx(Y.tx()-r),b.x-=r),l.y<R?i=l.y-R:l.y+w>R+Z&&(i=l.y+w-R-Z),i&&(Y.ty(Y.ty()-i),b.y-=i),Y.beginEditing({data:U,column:t,value:Y.getValue(U,t),event:V,rect:l,editorRect:b,view:Y}),void 0}}}},id.BaseItemEditor=function(z,k,D,V){this._data=z,this._column=k,this._master=D,this._editInfo=V},fn("BaseItemEditor",w,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var es=B.Tab=function(){Ep(es,this)};ni("Tab",uc,{ms_ac:["view","closable","disabled","visible"],_icon:R,_closable:!1,_disabled:!1,_visible:!0,setParent:wj});var Ln=B.Column=function(){Ep(Ln,this)};ni("Column",uc,{_46o:1,ms_ac:["accessType","valueType",ch,bh,Ol,ok,"align",yg,"sortOrder",mo,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Bd,_sortFunc:R,_sortable:!0,_clickable:!0,setWidth:function(x){16>x&&(x=16);var I=this._width;this._width=x,this.fp(ok,I,x)},getToolTip:function(w,P){return this.formatValue(P.getValue(w,this))}});var sm=B.Property=function(){Ep(sm,this)};ni("Property",uc,{_46o:1,ms_ac:["accessType","valueType",bh,Ol,"categoryName",yg,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:R,getToolTip:function(Q,K,W){var U=this;return K?U.formatValue(W.getValue(Q,U)):W.getPropertyName(U)}}),id.AccordionView=function(){var P=this;P._20o={},P._21o=new Mf,P._10o=R,P._9o=R,P._11o=R,P._view=wn(0,P),P.iv()},fn("AccordionView",w,{ms_v:1,ms_fire:1,ms_ac:[wo,pm,"titleHeight",gh,uq,"titleBackground","selectWidth",Fp,"orientation","separatorColor"],_expandIcon:V.accordionViewExpandIcon,_collapseIcon:V.accordionViewCollapseIcon,_titleHeight:_k,_labelColor:V.accordionViewLabelColor,_labelFont:V.accordionViewLabelFont,_titleBackground:V.accordionViewTitleBackground,_selectBackground:V.accordionViewSelectBackground,_selectWidth:V.accordionViewSelectWidth,_orientation:"v",_separatorColor:V.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(e,i,U,z){var j=this,f=Fb();if(j._20o[e])throw e+" already exists";f.onmousedown=dj,f.style.cursor=zg,h(f,Kq?dg:Fl,function($){dj($)}),h(f,Kq?zj:Ml,function(N){dj(N),Ih(N)&&(j._10o===e?j.collapse():j.expand(e))}),ub(j._view,f),j._20o[e]={content:i,div:f,canvas:ae(f),icon:z},j._21o.add(e),U&&j.expand(e),j.iv()},remove:function(W){var U=this,t=U._20o[W];t&&(hb(t.div),delete U._20o[W],U._21o.remove(W),U.iv())},clear:function(){var L=this;L._21o.toArray().forEach(L.remove,L),L._20o={},L._21o.clear(),L.iv()},isExpanded:function(u){return this._10o===u},expand:function(Z){var z=this;z._20o[Z]&&z._10o!==Z&&(z._10o=Z,z.onExpanded(Z),z.iv())},onExpanded:function(){},collapse:function(){var c=this;c._10o&&(c.onCollapsed(c._10o),delete c._10o,c.iv())},onCollapsed:function(){},initCanvas:function(Z,b,z){Pb(Z,b,z);var L=mr(Z);return Up(L,0,0,1),L.clearRect(0,0,b,z),L},drawTitle:function(m,q,H,E,a){var u=this,N=Tn(a.icon),g=u.isExpanded(q),$=u._titleHeight,O=u._titleBackground,l=u._selectWidth,W=u._separatorColor,j=Tn(g?u._expandIcon:u._collapseIcon),p=l+4;gi(m,0,0,H,E,O),g&&l&&gi(m,0,0,l,E,u._selectBackground),(g||u._21o.get(u._21o.size()-1)!==q)&&gi(m,0,E-1,H,1,W?W:ap(O)),N&&(Lo(m,N,p+gs(N)/2,$/2),p+=gs(N)+2),Dq(m,q,u.getLabelFont(q),u.getLabelColor(q),p,0,0,$),j&&Lo(m,j,H-gs(j)/2-4,$/2)},validateImpl:function(){var l=this,t=l._view,M=0,C=0,S=l.getWidth(),R=l.getHeight(),N=l._titleHeight,Z=l._21o.size()*N,H=l._11o,y=l._9o;delete l._11o,delete l._9o,l._21o.each(function(P){var b,j,T=l._20o[P],i=T.content,z=l._10o===P;mk(l)?(nd(T.div,M,0,N,R),b=l.initCanvas(T.canvas,N,R),tl(b,0,R),pb(b,-W),l.drawTitle(b,P,R,N,T),b.restore(),z?(j=D(0,S-Z),i&&(l._11o=i,l._9o=dc(i),nd(i,M+N,0,j,R)),M+=N+j):M+=N):(nd(T.div,0,C,S,N),b=l.initCanvas(T.canvas,S,N),l.drawTitle(b,P,S,N,T),b.restore(),z?(j=D(0,R-Z),i&&(l._11o=i,l._9o=dc(i),nd(i,0,C+N,S,j)),C+=N+j):C+=N)});var q=l._9o;H&&H!==l._11o&&H.endEditing&&H.endEditing(),q&&q!==y&&ub(t,q),y&&y!==q&&hb(y)}}),id.SplitView=function(Q,n,O,j){var N=this,k=N._dividerDiv=Fb(),E=N._60O=ae(),r=N._61O=ae(),U=E.style,W=r.style;N._view=wn(1,N),ub(N._view,k),U.msTouchAction=ab,U.pointerEvents=ab,U.cursor=zg,W.msTouchAction=ab,W.pointerEvents=ab,W.cursor=zg,Q&&N.setLeftView(Q),n&&N.setRightView(n),O&&N.setOrientation(O),j!=R&&N.setPosition(j),N.setStatus(ge),new be(N)},fn("SplitView",w,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:V.splitViewDividerSize,_dividerBackground:V.splitViewDividerBackground,_dragOpacity:V.splitViewDragOpacity,_toggleIcon:V.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(C,H){var x=this,L=x._position;isNaN(C)||(H||(x._82O=0>C?-1:C>1?1:0),x._position=C,x.fp(Tj,L,C))},getLeftView:function(){return this._leftView},setLeftView:function(d){var y=this,a=y._leftView,B=y._view;if(y._leftView!==d){if(a&&a!==y._rightView){var X=dc(a);X.parentNode===B&&hb(X)}if(y._leftView=d,d){var Z=dc(d);Z.parentNode!==B&&B.insertBefore(Z,y._dividerDiv)}y.fp("leftView",a,d)}},getRightView:function(){return this._rightView},setRightView:function(j){var _=this,w=_._rightView,Y=_._view;if(_._rightView!==j){if(w&&w!==_._leftView){var N=dc(w);N.parentNode===Y&&hb(N)}if(_._rightView=j,j){var U=dc(j);U.parentNode!==Y&&Y.insertBefore(U,_._dividerDiv)}_.fp("rightView",w,j)}},validateImpl:function(){var R=this,g=R._draggable,S=R._position,X=R.getWidth(),G=R.getHeight(),c=R._dividerSize,P=R._dividerBackground,o=Kq?18:8,L=R._dividerDiv,t=R._82O,_=R._60O,s=R._61O,z=R._toggleIcon,Y=R._status,K=L.style,v=null,q=Kq?20:4,M=z.comps[0];c>=o||0===c?R._coverDiv&&(hb(R._coverDiv),delete R._coverDiv):R._coverDiv||(R._coverDiv=Fb(),Ro&&(R._coverDiv.style.background=Bb),ub(L,R._coverDiv)),R._togglable?_.parentNode||(ub(L,_),ub(L,s)):(hb(_),hb(s));var x=R._coverDiv,r=R._leftView,u=R._rightView;if(mk(R)){if(c>X&&(c=X),Y===ge)if(1===t)var h=k(S,X),Q=D(0,X-c-h);else-1===t?(Q=k(-S,X),h=D(0,X-c-Q)):(h=U((X-c)*S),Q=D(0,X-c-h));else"cl"===Y?(h=0,Q=D(0,X-c)):"cr"===Y&&(Q=0,h=D(0,X-c));r&&nd(r,0,0,h,G),u&&nd(u,h+c,0,Q,G),nd(L,h,0,c,G),R._22o=h,x&&(nd(x,c/2-o/2,0,o,G),x.style.cursor=g?Zo:""),L.style.cursor=g?Zo:"";var J=L.clientHeight/2,H=L.clientWidth;Pb(_,H,H),nd(_,0,J-H-q,H,H),v=mr(_),Up(v,0,0,1),M.rotation=-W,Fq(v,z,0,0,H,H),v.restore(),Pb(s,H,H),nd(s,0,J+q,H,H),v=mr(s),Up(v,0,0,1),M.rotation=W,Fq(v,z,0,0,H,H),v.restore()}else{if(c>G&&(c=G),Y===ge)if(1===t)var p=k(S,G),I=D(0,G-c-p);else-1===t?(I=k(-S,G),p=D(0,G-c-I)):(p=U((G-c)*S),I=D(0,G-c-p));else"cl"===Y?(p=0,I=D(0,G-c)):"cr"===Y&&(I=0,p=D(0,G-c));r&&nd(r,0,0,X,p),u&&nd(u,0,p+c,X,I),nd(L,0,p,X,c),R._22o=p,x&&(nd(x,0,c/2-o/2,X,o),x.style.cursor=g?xh:""),K.cursor=g?xh:"";var b=L.clientWidth/2,H=L.clientHeight;Pb(_,H,H),nd(_,b-H-q,0,H,H),v=mr(_),Up(v,0,0,1),M.rotation=0,Fq(v,z,0,0,H,H),v.restore(),Pb(s,H,H),nd(s,b+q,0,H,H),v=mr(s),Up(v,0,0,1),M.rotation=e,Fq(v,z,0,0,H,H),v.restore()}K.background=P}});var be=function(l){this.sv=l,this.addListeners()};uj(be,w,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(y){var c=this,N=c.sv,X=N._dividerDiv,H=N._60O,L=N._61O,v=N._status,r=y.target;if(r===H)v===ge?N.setStatus("cl"):"cr"===v&&N.setStatus(ge);else if(r===L)v===ge?N.setStatus("cr"):"cl"===v&&N.setStatus(ge);else if(Ze(y)&&(r===X||r===N._coverDiv)&&(dj(y),N.isDraggable())){N.getLeftView(),N.getRightView();var V=c.maskDiv=Fb();if(V.style.left=0,V.style.top=0,V.style.width=N.getWidth()+"px",V.style.height=N.getHeight()+"px",N.getView().appendChild(V),!N.isContinuousLayout()){var w=c.resizeDiv=Fb();w.style.left=X.style.left,w.style.top=X.style.top,w.style.width=X.style.width,w.style.height=X.style.height,w.style.opacity=N.getDragOpacity(),w.style.background=N.getDividerBackground(),ub(c.getView(),w)}c._lastAbsPosition=N._22o,c._86o=mk(N)?zr(y).x:zr(y).y,ts(c,y)}},handleWindowTouchMove:function(F){Ze(F)&&this.update(F,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(X){var P=this;P.update(X,!0),P.sv.setStatus(ge),P.maskDiv&&hb(P.maskDiv),P.resizeDiv&&hb(P.resizeDiv),P.maskDiv=P.resizeDiv=R},handle_mousedown:function(D){Ih(D)&&this.handle_touchstart(D)},handleWindowMouseMove:function(n){this.handleWindowTouchMove(n)},handleWindowMouseUp:function(t){this.handleWindowTouchEnd(t)},update:function(t,b){var S=this,s=S.sv,l=mk(s)?s.getWidth():s.getHeight(),F=s._dividerSize,R=S._lastAbsPosition-S._86o;mk(s)?(R+=zr(t).x,R>l-F&&(R=l-F),0>R&&(R=0),S.resizeDiv&&(S.resizeDiv.style.left=R+bg)):(R+=zr(t).y,R>l-F&&(R=l-F),0>R&&(R=0),S.resizeDiv&&(S.resizeDiv.style.top=R+bg)),b&&l!==F&&(1===s._82O?s.setPosition(R,1):-1===s._82O?s.setPosition(R-l+F,1):s.setPosition(R/(l-F),1))}}),id.TabView=function(){var d=this,v=d._view=wn(1,d),R=d._91O=Fb(1),I=d._tabModel=new Ah,B=I.sm(),X=d.invalidate;d._7o=new Mf,d._canvas=ae(R),ub(v,R),ub(v,d._92O=Fb(1)),B.setSelectionMode(cr),B.ms(d.handleSelectionChange,d),I.mm(X,d),I.mh(X,d),I.md(X,d),d._interactor=new _i(d),d.iv()},fn("TabView",w,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",gh,uq,"tabHPadding","tabBackground","selectWidth",Fp,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:gf,_tabHeight:_k,_tabGap:V.tabViewTabGap,_labelColor:V.tabViewLabelColor,_labelFont:V.tabViewLabelFont,_tabBackground:V.tabViewTabBackground,_selectWidth:V.tabViewSelectWidth,_selectBackground:V.tabViewSelectBackground,_moveBackground:V.tabViewMoveBackground,_insertColor:V.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(m,j,Y){var t,s=this._tabModel;return m instanceof es?(t=m,j&&t.setView(j)):(t=new es,t.setName(m),t.setView(j)),s.add(t),Y&&s.sm().ss(t),t},getLabel:function(W){return W.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(x){this._23o=x,this.iv()},get:function(Y){var e=this,B=e._tabModel;if(Ff(Y))return B._roots.get(Y);if(Fc(Y)){var X;return B.each(function(k){Y===e.getLabel(k)&&(X=k)}),X}return Y instanceof es?Y:R},select:function(s){this._tabModel.sm().ss(this.get(s))},remove:function(h){var M=this;if(h=M.get(h)){var Y=M._tabModel,x=Y._roots.indexOf(h);M._tabModel.remove(h),M.selectByIndex(--x)}},getCurrentTab:function(){return this._8o},hideTabView:function(K,x){x.parentNode===this._92O&&(dn(x)?(x.style.display=Vl,x._tab_=K):hb(x),Ak())},showTabView:function(m,j){dn(j)&&(j.style.display="block",j._tab_=m),j.parentNode!==this._92O&&(ub(this._92O,j),Ak())},_24o:function(){var U,z=this,F=z._8o,j=z._9o,p=z._tabModel.sm().ld();p&&(U=dc(p.getView())),U!==j&&(j&&(F.getView()&&F.getView().endEditing&&F.getView().endEditing(),z.hideTabView(F,j)),U&&z.showTabView(p,U)),z._8o=p,z._9o=U,F!==p&&z.onTabChanged(F,p)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(y,U){this.selectByIndex(--U)},selectByIndex:function(I){var m=this,f=m._tabModel,l=f.size();if(l&&!f.sm().ld()){I==R&&(I=0),I>=l&&(I=l-1),0>I&&(I=0);for(var J=I;J>=0;J--){var A=m.get(J);if(!A.isDisabled())return m.select(A),A}for(J=I+1;l>J;J++)if(A=m.get(J),!A.isDisabled())return m.select(A),A}},getTabWidth:function(N){var p=this.getTabHPadding(),C=4+2*p,l=Tn(N.getIcon());l&&(C+=gs(l,N)+4);var K=this.getLabel(N);return K&&(C+=Cb(this.getLabelFont(N),K).width+4),N.isClosable()&&(C+=10),C},drawTab:function(d,c,o,T,i,I,j){var m,R=this,x=R._tabPosition,h=this.getTabHPadding(),Y=o+4+h,K=R._selectWidth,X=Tn(c.getIcon()),M=c.isDisabled(),y=R.getLabelColor(c),g=R.getLabelFont(c),q=R.getLabel(c),r=R._selectBackground,b=x===_c+"-vertical",Z=x===vk+"-vertical";(b||Z)&&(Y=T+4+h),M&&(d.globalAlpha=Aq),gi(d,o,T,i,I,j),c===R._8o&&K&&(x===gf?gi(d,o,T+I-K,i,K,r):x===_c?gi(d,o+i-K,T,K,I,r):x===vk?gi(d,o,T,K,I,r):b?gi(d,o+i-K,T,K,I,r):Z?gi(d,o,T,K,I,r):gi(d,o,T,i,K,r));var C=i/2;if(b&&(tl(d,C,T+I/2),pb(d,e),tl(d,-C,-T-I/2)),X){var O=rr(X,c),_=gs(X,c);if(b||Z){var v=o+i/2,k=Y+O/2;tl(d,v,k),pb(d,W),tl(d,-v,-k),Lo(d,X,o+i/2,Y+O/2,c,R),tl(d,v,k),pb(d,-W),tl(d,-v,-k),Y+=O+4}else Lo(d,X,Y+_/2,T+I/2,c,R),Y+=_+4}return b||Z?(tl(d,i/2,Y+i/2),pb(d,W),tl(d,-i/2,-Y-i/2),Dq(d,q,g,y,o,Y,I,i),tl(d,i/2,Y+i/2),pb(d,-W),tl(d,-i/2,-Y-i/2)):Dq(d,q,g,y,Y,T,i,I),b&&(tl(d,C,T+I/2),pb(d,-e),tl(d,-C,-T-I/2)),c.isClosable()&&(m=Z?{x:o+i-12,y:T+I-12,width:12,height:12}:{x:o+i-12,y:T+2,width:12,height:12},this.drawCloseIcon(c,d,y,m)),M&&(d.globalAlpha=1),m},drawCloseIcon:function(s,B,t,c){var l=c.x,e=c.y;
B.strokeStyle=t,B.lineWidth=1,B.beginPath(),B.moveTo(l+2,e+8),B.lineTo(l+8,e+2),B.moveTo(l+8,e+8),B.lineTo(l+2,e+2),B.stroke()},getTabAt:function(b){var p=this._interactor._8Q(b);return p?p.tab:null},validateImpl:function(){var G=this;G._24o();var O,h=G._canvas,q=G._tabPosition,P=G._91O,d=G._92O,f=G._tabModel,E=G.getWidth(),u=G.getHeight(),X=G._tabHeight,b=G._7o,L=G._tabGap,s=q===gf,A=q===_c,J=q===vk,t=q===_c+"-vertical",F=q===vk+"-vertical",g=G._23o,S=0;if((A||J)&&f._roots.each(function(w){S=D(G.getTabWidth(w),S)}),s?(nd(P,0,0,E,X),O={x:0,y:X,width:E,height:D(0,u-X)}):A?(nd(P,0,0,S,u),O={x:S,y:0,width:D(0,E-S),height:u}):J?(nd(P,E-S,0,S,u),O={x:0,y:0,width:D(0,E-S),height:u}):t?(nd(P,0,0,X,u),O={x:X,y:0,width:D(0,E-X),height:u}):F?(nd(P,E-X,0,X,u),O={x:0,y:0,width:D(0,E-X),height:u}):(nd(P,0,u-X,E,X),O={x:0,y:0,width:E,height:D(0,u-X)}),nd(d,O),t||F){G._9o&&(O.x=0,nd(G._8o.getView(),O)),Pb(h,X,u);var z=mr(h),y=0;if(Up(z,0,G.ty(),1),z.clearRect(0,0,X,u),b.clear(),f._roots.each(function(k){if(k.isVisible()){var O,r=G.getTabWidth(k);g&&g.tab===k||(O=G.drawTab(z,k,0,y,X,r,G._tabBackground)),b.add({_75o:O,tab:k,startY:y,endY:y+r,height:r}),y+=r+L}}),G._23Q=D(0,y-L),g){var T=g.position;G.drawTab(z,g.tab,0,g.startY,X,g.height,G._moveBackground),gi(z,0,T,X,1,G._insertColor)}if(z.restore(),G._selectionChanged){G._selectionChanged=!1;for(var Y=G.ty(),o=0;o<b.size();o++){var j=b.get(o);if(j.tab===G._8o){if(j.endY+Y<0){G.ty(-j.startY);break}if(j.startY+Y>u){G.ty(u-j.endY);break}}}}G.ty(G.ty())}else if(A||J){G._9o&&(O.x=0,nd(G._8o.getView(),O)),Pb(h,S,u);var z=mr(h),y=0;if(Up(z,0,G.ty(),1),z.clearRect(0,0,S,u),b.clear(),f._roots.each(function(u){if(u.isVisible()){var k;g&&g.tab===u||(k=G.drawTab(z,u,0,y,S,X,G._tabBackground)),b.add({_75o:k,tab:u,startY:y,endY:y+X,height:X}),y+=X+L}}),G._23Q=D(0,y-L),g){var T=g.position;G.drawTab(z,g.tab,0,g.startY,S,g.height,G._moveBackground),gi(z,0,T,S,1,G._insertColor)}if(z.restore(),G._selectionChanged){G._selectionChanged=!1;for(var Y=G.ty(),o=0;o<b.size();o++){var j=b.get(o);if(j.tab===G._8o){if(j.endY+Y<0){G.ty(-j.startY);break}if(j.startY+Y>u){G.ty(u-j.endY);break}}}}G.ty(G.ty())}else{G._9o&&(O.y=0,nd(G._8o.getView(),O)),Pb(h,E,X);var z=mr(h),c=0;if(Up(z,G.tx(),0,1),z.clearRect(0,0,E,X),b.clear(),f._roots.each(function(n){if(n.isVisible()){var h,i=G.getTabWidth(n);g&&g.tab===n||(h=G.drawTab(z,n,c,0,i,X,G._tabBackground)),b.add({_75o:h,tab:n,startX:c,endX:c+i,width:i}),c+=i+L}}),G._64I=D(0,c-L),g){var T=g.position;G.drawTab(z,g.tab,g.startX,0,g.width,X,G._moveBackground),ss(z,G._insertColor,T,0,X)}if(z.restore(),G._selectionChanged){G._selectionChanged=!1;for(var v=G.tx(),o=0;o<b.size();o++){var j=b.get(o);if(j.tab===G._8o){if(j.endX+v<0){G.tx(-j.startX);break}if(j.startX+v>E){G.tx(E-j.endX);break}}}}G.tx(G.tx())}for(var K=[],I=d.children,o=0;o<I.length;o++){var $=I[o],Z=$._tab_;Z&&!f.contains(Z)&&K.push($)}K.forEach(function(F){d.removeChild(F)})}});var _i=function(q){this.tv=q,this.addListeners()};uj(_i,w,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(z){this.handleScroll(z,10*(z.wheelDelta/40))},handle_DOMMouseScroll:function(O){this.handleScroll(O,10*-O.detail)},handleScroll:function(I,E){dj(I);var e=this.tv,y=e._tabPosition;!e._40o()||y!==gf&&y!==fm||e.tx(this.tv.tx()+E),!e._41o()||y!==_c&&y!==vk&&y!==_c+"-vertical"&&y!==vk+"-vertical"||e.ty(this.tv.ty()+E)},_8Q:function(o){var m,h,Q=this.tv,e=Q._tabPosition,F=Q._7o;if(e===gf||e===fm){var S=Q.lp(o).x;for(m=0;m<F.size();m++)if(h=F.get(m),h.startX<=S&&S<=h.endX)return h}else if(e===_c||e===vk||e===_c+"-vertical"||e===vk+"-vertical"){var b=Q.lp(o).y;for(m=0;m<F.size();m++)if(h=F.get(m),h.startY<=b&&b<=h.endY)return h}return R},isClickable:function(s){var r=this.tv,e=r._tabPosition,P=this._73o=this._8Q(s);return!r._40o()||e!==gf&&e!==fm?!r._41o()||e!==_c&&e!==vk&&e!==_c+"-vertical"&&e!==vk+"-vertical"?P&&(!P.tab.isDisabled()||r.isMovable()):!0:!0},handle_mousemove:function(B){var w=this;Lh?w._74o=w._8Q(B):w.getView().style.cursor=w.isClickable(B)?zg:""},handle_mousedown:function(J){this.handle_mousemove(J),this.handle_touchstart(J)},handle_touchstart:function(k){var X=this,x=X.tv,H=x._tabPosition;dj(k),Ih(k)&&X.isClickable(k)&&(H===gf||H===fm?(X.x=zr(k).x,X.lp=x.lp(k),X.tx=x.tx()):(X.y=zr(k).y,X.lp=x.lp(k),X.ty=x.ty()),ts(X,k))},handleWindowMouseMove:function(C){this.handleWindowTouchMove(C)},handleWindowTouchMove:function(B){var t,O=this,z=O.tv,j=z._tabPosition,J=O._73o;if(j===gf||j===fm){if(t=zr(B).x-O.x,!O._25o&&!O.moving&&q(t)>2&&(z._40o()&&!Uc(B)?O._25o=1:J&&z.isMovable()&&(O.moving=1)),O._25o)z.tx(O.tx+t);else if(O.moving){var p=O.lp.x+t,E=z._tabGap/2;z._7o.each(function(n){var G=n.endX,X=p-n.startX<G-p;p>=n.startX&&G>=p&&z._7Q({tab:J.tab,startX:J.startX+t,width:J.width,front:X,insertTab:n.tab,position:X?D(0,n.startX-E):k(z._64I,G+E)})})}}else if(t=zr(B).y-O.y,!O._25o&&!O.moving&&q(t)>2&&(z._41o()&&!Uc(B)?O._25o=1:J&&z.isMovable()&&(O.moving=1)),O._25o)z.ty(O.ty+t);else if(O.moving){var b=O.lp.y+t,E=z._tabGap/2;z._7o.each(function(h){var F=h.endY,N=b-h.startY<F-b;b>=h.startY&&F>=b&&z._7Q({tab:J.tab,startY:J.startY+t,height:J.height,front:N,insertTab:h.tab,position:N?D(0,h.startY-E):k(z._23Q,F+E)})})}},handleWindowMouseUp:function(x){this.handleWindowTouchEnd(x)},handleWindowTouchEnd:function(){var s=this,X=s.tv,b=X._tabPosition,l=X.getTabModel(),L=l._roots,j=s._73o;if(s.moving){var Y=X._23o;if(Y&&Y.insertTab!==Y.tab){var E=Y.tab,G=L.remove(E),S=L.indexOf(Y.insertTab);S>=0&&(Y.front||S++,S<=L.size()&&(L.add(E,S),l._38I(E,G,S)))}X._7Q(R),delete s.moving}else if(!s._25o&&j){E=j.tab;var K=s._74o;if(!K||K.tab===E)if(!E.isDisabled()&&Sm(j._75o,s.lp)){var I=function(){var F=L.indexOf(E);l.remove(E),X.onTabClosed(E,F)};X.onTabClosing(E,I)&&I()}else E.isDisabled()||X._8o===E||l.sm().ss(E)}s._25o=s._73o=s._74o=b===gf||b===fm?s.x=s.lp=s.tx=R:s.y=s.lp=s.ty=R}}),id.PropertyView=function(g){var s=this;s._view=wn(1,s),s._canvas=ae(s._view),ub(s._view,s._79O=Fb()),s._rows=new Mf,s._28o=new Mf,s._26o={},s._26Q={};var t=s._propertyModel=new Ah,R=s.ivm;t.mm(R,s),t.md(R,s),t.mh(R,s),s.dm(g?g:new Ah),new Cs(s)},fn("PropertyView",w,{ms_ac:[gh,ur,uq,bh,Ol,"categorizable",Hc,mo,Vh,wo,pm,mf,Hj,Hp,"selectRowIndex",Fp,"background",ib,Df,xb,De,cc],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:kl,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Co,_background:V.propertyViewBackground,_expandIcon:V.propertyViewExpandIcon,_collapseIcon:V.propertyViewCollapseIcon,_scrollBarColor:vi,_scrollBarSize:Tf,_autoHideScrollBar:kc,_selectBackground:V.propertyViewSelectBackground,_rowHeight:Cj,_rowLineVisible:V.propertyViewRowLineVisible,_rowLineColor:V.propertyViewRowLineColor,_10I:.5,_columnLineVisible:V.propertyViewColumnLineVisible,_columnLineColor:V.propertyViewColumnLineColor,_labelColor:V.propertyViewLabelColor,_labelSelectColor:V.propertyViewLabelSelectColor,_labelFont:V.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(P){0>P&&(P=0),P>1&&(P=1);var M=this,v=M._10I;M._10I=P,M.fp("columnPosition",v,P)},getPropertyName:function(d){return d.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(K,Q,V){return V===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(E,h){return h===this._selectRowIndex?this._labelSelectColor:E.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(o){var S=this.getHeight()-this._59I;return S>o&&(o=S),o>0?0:U(o)},isExpanded:function(d){if(!d)return!0;var x=this._26o[d];return x?x.isExpanded:!(this._26Q[d]===!1)},toggle:function(S){var Y=this;Y.isExpanded(S)?Y.collapse(S):Y.expand(S)},expandAll:function(){this.validate();for(var x in this._26o)this.expand(x)},expand:function(F){if(F&&F!==Vl){var q=this,U=q._26o[F];U&&!U.isExpanded&&(U.isExpanded=!0,q.onExpanded(F),q.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var D in this._26o)this.collapse(D)},collapse:function(M){if(M&&M!==Vl){var x=this,U=x._26o[M];U&&U.isExpanded&&(U.isExpanded=!1,x.onCollapsed(M),x.ivm())}},onCollapsed:function(){},getCategoryName:function(A){if(!this.isCategorizable())return Vl;var X=A.getCategoryName();return X?X:Vl},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(S){var B=this,d=B._dataModel;d!==S&&(d&&(d.umd(B.handlePropertyChange,B),B._selectionModel||d.sm().ums(B.handleSelectionChange,B)),B._dataModel=S,S.md(B.handlePropertyChange,B),B._selectionModel?B._selectionModel._21I(S):S.sm().ms(B.handleSelectionChange,B),B.fp(Un,d,S))},isVisible:function(W){return this._visibleFunc?this._visibleFunc(W):!0},onPropertyChanged:function(Y){var D=this,h=Y.property;Xm[h]?D.ivm():D.iv(),h===Dm&&D._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Tb},handlePropertyChange:function(O){this._27o===O.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var t=this;t._96I||(t.setSelectRowIndex(-1),t._96I=1,t.iv())},redraw:function(){this.iv()},validateModel:function(){var Y=this,j=Y._rows,k=Y._28o,X={},c=new Mf,h=Y._27o;Y.updateCurrentData(),h!==Y._27o&&Y.endEditing(),j.clear(),k.clear(),Y.getRawProperties().each(function(e){if(Y.isVisible(e)){c.add(e);var W=Y.getCategoryName(e);X[W]||(k.add(W,W===Vl?0:H),X[W]={isExpanded:Y.isExpanded(W),properties:new Mf})}}),Y._sortFunc&&c.sort(Y._sortFunc);for(var K in Y._26o)Y._26Q[K]=Y.isExpanded(K);Y._26o=X,k.each(function(R){R!==Vl&&j.add(R);var b=X[R];b.isExpanded&&c.each(function(_){Y.getCategoryName(_)===R&&(b.properties.add(_),j.add({property:_,data:Y._27o}))},Y)})},validateImpl:function(){var d=this;d._76o(),d._96I&&(d.validateModel(),delete d._96I);var k=d._canvas,o=d.getWidth(),g=d.getHeight(),t=-d.ty(),U=d._rowHeight,q=d._indent,I=o-q,Z=d._rows,K=Z.size(),D=d._9I=q+I*d._10I,m=d._59I=K*U;Pb(k,o,g),d._29I={x:0,y:t,width:o,height:g},d._31I=f(t/U),d._14I=$((t+g)/U),d._31I<0&&(d._31I=0),d._14I>K&&(d._14I=K);var v,y=mr(k),z=d._background;Up(y,0,-t,1),y.beginPath(),y.rect(0,t,o,g),y.clip(),y.clearRect(0,t,o,g),d._93db(y),z&&gi(y,0,0,q,m,z);for(var s=d._31I;s<d._14I;s++){var w=Z.get(s),t=U*s;if(Fc(w))z&&gi(y,q,t,I,U,z),v=Tn(d.isExpanded(w)?d._expandIcon:d._collapseIcon),v&&Lf(y,v,pr,0,t,q,U),y.save(),y.beginPath(),y.rect(q,t,I,U),y.clip(),d.drawCategoryName(y,w,s,q,t,I,U),y.restore();else{var B=w.property,r=w.data,v=Tn(B.getIcon()),A=d._selectRowIndex===s?d.getSelectBackground():R;if(v&&Lf(y,v,pr,0,t,q,U),A&&gi(y,q,t,I,U,A),y.save(),y.beginPath(),y.rect(q,t,D-q,U),y.clip(),d.drawPropertyName(y,B,s,q,t,D-q,U),y.restore(),!d.isEditing(r,B)){var x=D+1,c=o-D-1;y.save(),y.beginPath(),y.rect(x,t,c,U),y.clip(),d._87o(d.drawPropertyValue(y,B,d.getValue(r,B),s,x,t,c,U,r),s,x,t,c,U),y.restore()}}d._rowLineVisible&&gi(y,q,t+U-1,I,1,d._rowLineColor)}d._columnLineVisible&&(gi(y,D,0,1,m,d._columnLineColor),gi(y,o-1,0,1,m)),d._92db(y),d._93I(),y.restore(),d.ty(d.ty())},drawCategoryName:function(v,n,p,D,s,b,G){Dq(v,n,this.getCategoryFont(n),this.getCategoryColor(n),D,s,b,G)},drawPropertyName:function(x,b,y,q,F,L,u){return b.drawPropertyName?(b.drawPropertyName(x,b,y,q,F,L,u,this),void 0):(Dq(x,this.getPropertyName(b),this.getPropertyFont(b,y),this.getPropertyColor(b,y),q,F,L,u),void 0)},drawPropertyValue:function(l,f,K,g,o,c,G,M,e){return f.drawPropertyValue?f.drawPropertyValue(l,f,K,g,o,c,G,M,e,this):(fj(l,K,f,this.getLabelFont(f,K,g),this.getLabelColor(f,K,g),o,c,G,M,e,this),void 0)},isPropertyEditable:function($){return $.isEditable()&&this.isEditable()},setProperties:function(L){this._propertyModel.clear(),this.addProperties(L)},addProperties:function(R){if(R){var c=this._propertyModel;R.forEach(function(E){if(!(E instanceof sm)){var x=fk(E.className);E=$p(x?x:sm,E)}c.add(E)})}},getRowIndexAt:function(g){var h=this,z=f(h.lp(g).y/h._rowHeight);return z>=0&&z<h._rows.size()?z:-1},getPropertyAt:function(X){var D=this,r=D.getRowIndexAt(X);return r>=0?D._rows.get(r).property:R},getToolTip:function(g){var e=this,U=e.getPropertyAt(g),B=e._27o;return U&&B?U.getToolTip(B,e._9I<e.lp(g).x,e):R}});var Cs=function(p){this.pv=p,this.addListeners()};uj(Cs,w,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(b){this.getView().style.cursor=b},clear:function(){var A=this;A._62O=A.cp=A.ty=A.p=R,A.setCursor(jh)},handle_mousedown:function(m){this.handle_touchstart(m)},handle_touchstart:function(W){var K=this,S=K.pv;dj(W),S.setFocus(W)&&(Ih(W)?(K.cp=zr(W),K.ty=S.ty(),K.p=S.getColumnPosition(),K.handle_touchmove(W)):S.setSelectRowIndex(S.getRowIndexAt(W)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(B){this.handle_touchend(B)},handle_touchend:function(w){var J=this;if(J.cp&&!J._62O){var i=J.pv,X=i.lp(w),W=X.x,q=X.y,R=i._indent,K=i.getRowIndexAt(w),N=i._9I;if(K>=0){var g=i._rowHeight,z=g*K,l=i._rows.get(K),G=l.property;if(Fc(l))Tn(i.isExpanded(l)?i._expandIcon:i._collapseIcon)&&W>=0&&R>=W&&q>=z&&z+g>=q?i.toggle(l):lb(w)&&i.toggle(l);else if(W>N&&i.isPropertyEditable(G,w)){var A={x:N+1,y:z,width:i.getWidth()-N-1,height:g},V={x:A.x+i.tx(),y:A.y+i.ty(),width:A.width,height:A.height},F=0,P=i._29I;A.y<P.y?F=A.y-P.y:A.y+g>P.y+P.height&&(F=A.y+g-P.y-P.height),F&&(i.ty(i.ty()-F),V.y-=F),i.beginEditing({data:l.data,property:G,value:i.getValue(l.data,G),event:w,rect:A,editorRect:V,view:i})}}i.setSelectRowIndex(K)}J.clear()},handleWindowMouseMove:function(Y){this.handleWindowTouchMove(Y)},handleWindowTouchMove:function(c){var n=this,N=n.pv,L=n.ty,o=n.cp,i=zr(c),T=n._62O;if("p"===T)N.setTranslateY(L+i.y-o.y);else if("c"===T){var F=N.getWidth()-N._indent;if(F>16){var P=n.p-(o.x-i.x)/F,h=16/F;h>P&&(P=h),P>1-h&&(P=1-h),N.setColumnPosition(P)}}else"s"===T&&N.setTranslateY(L+(o.y-i.y)*N._59I/N._29I.height)},handle_mousemove:function(p){this.handle_touchmove(p)},handle_touchmove:function(H){if(!Lh&&Ih(H)){var k=this,M=k.pv,m=q(M.lp(H).x-M._9I)<=(Kq?8:3);k.cp?k._62O||(m?(k._62O="c",ts(k)):q(zr(H).y-k.cp.y)>=2&&(k._62O=k.isV(H)?"s":"p",ts(k))):(m?k.setCursor(Zo):k.setCursor(jh),k.isV(H)&&M._43o())}},isV:function(J){var p=this.pv,e=p._29I;return p._41o()&&e.x+e.width-p.lp(J).x<jj},handle_mousewheel:function(z){this.handleScroll(z,z.wheelDelta/40)},handle_DOMMouseScroll:function(E){2===E.axis&&this.handleScroll(E,-E.detail)},handleScroll:function(l,Z){var O=this.pv;dj(l),O.endEditing(),O.translate(0,Z*O.getRowHeight())},handle_keydown:function(y){var _=this.pv,R=_._rows.size(),V=_._selectRowIndex+(Mg(y)?-1:1);(Mg(y)||Xd(y))&&(0>V&&(V=0),V>=R&&(V=R-1),_.setSelectRowIndex(V))}}),id.ListView=function(U){this._5o(U),new bq(this)},fn("ListView",w,{ms_ac:[gh,ur,uq,ib,Hc,Df,xb,mo,Vh,mf,Hj,Hp,Vd,Fp],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Co,_rowHeight:Cj,_rowLineVisible:V.listViewRowLineVisible,_rowLineColor:V.listViewRowLineColor,_scrollBarColor:vi,_scrollBarSize:Tf,_autoMakeVisible:Mi,_autoHideScrollBar:kc,_selectBackground:V.listViewSelectBackground,_labelColor:V.listViewLabelColor,_labelSelectColor:V.listViewLabelSelectColor,_labelFont:V.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(d){var Q=this,P=Q._checkMode;Q._checkMode=d,Q.fp(or,P,d)},drawRow:function(d,W,z,M,N,Y,s){var R=this,m=0,T=R._indent,x=R.getIconWidth(W);R.drawRowBackground(d,W,z,M,N,Y,s),R._checkMode&&(Lo(d,Tn(R.getCheckIcon(W)),m+T/2,N+s/2,W,R),m+=T),R.drawIcon(d,W,m,N,x,s),R.drawLabel(d,W,m+x,N,s)}});var bq=function(D){this.list=D,this._lastSelectDataTime=Qm(),this.addListeners()};uj(bq,w,{ms_listener:1,getView:function(){return this.list._view},clear:function(z){var k=this,F=k.list;z&&"d"===k._62O&&!k.dragCancel&&F.handleDragAndDrop(z,"end"),F.draggingData&&(F.draggingData=null,F.redraw()),k.dragCancel=k._62O=k._isV=k._isH=k.cp=k.tx=k.ty=R},handle_mousedown:function(E){this.handle_touchstart(E)},handle_touchstart:function($){var X=this,D=X.list;if(dj($),D.setFocus($)){var Y=D.getDataAt($);X.cp=zr($),X.tx=D.tx(),X.ty=D.ty(),Ih($)?Y&&D.handleDragAndDrop&&!X.isV($)&&!X.isH($)&&(D.draggingData=Y,D.redraw(),D.handleDragAndDrop($,"prepare")):(Y&&X._33o($,Y),X.clear($))}},handleWindowMouseUp:function(k){this.clear(k)},handleWindowTouchEnd:function(x){this.clear(x)},handle_mouseup:function(P){this.handle_touchend(P)},handle_touchend:function(e){var B=this,O=B.list;if(!B._isV&&!B._isH&&B.cp&&!B._62O){var x=O.getDataAt(e);x?(O.isCheckMode()?B._34o(e,x):B._33o(e,x),lb(e)?O.onDataDoubleClicked(x,e):O.onDataClicked(x,e)):O.handleBackgroundClick(e)}B.clear(e)},handleWindowMouseMove:function(r){this.handleWindowTouchMove(r)},handleWindowTouchMove:function(j){var n=this,J=n.list,V=n._62O,Q=n.tx,O=n.ty,U=n.cp,s=zr(j),x=J._29I;"p"===V?J.setTranslate(Q+s.x-U.x,O+s.y-U.y):"v"===V?J.ty(O+(U.y-s.y)*J._59I/x.height):"h"===V?J.tx(Q+(U.x-s.x)*J._91I/x.width):"d"===V&&(n.dragCancel||J.handleDragAndDrop(j,"between"))},handle_mousemove:function(B){this.handle_touchmove(B)},handle_touchmove:function(u){if(!Lh&&Ih(u)){var d=this,t=d.list;if(d._isV=d.isV(u),d._isH=d.isH(u),d.cp){if(!d._62O){if(Wj(zr(u),d.cp)<2)return;d._isV?d._62O="v":d._isH?d._62O="h":t.draggingData&&!this.dragCancel?(d._62O="d",t.handleDragAndDrop(u,"begin")):d._62O="p",d._62O&&"d"!==d._62O&&t.draggingData&&(t.draggingData=null,t.redraw()),ts(d)}}else d._isV&&t._43o(),d._isH&&t._42o()}},isV:function(X){var H=this.list,F=H._29I;return H._41o()&&F.x+F.width-H.lp(X).x<jj},isH:function(E){var K=this.list,t=K._29I;return K._40o()&&t.y+t.height-K.lp(E).y<jj},handle_mousewheel:function(e){this.handleScroll(e,e.wheelDelta/40,e.wheelDelta!==e.wheelDeltaX)},handle_DOMMouseScroll:function(w){this.handleScroll(w,-w.detail,1)},handleScroll:function(V,u,W){var Z=this.list;dj(V),Z.endEditing&&Z.endEditing(),W&&Z._41o()?Z.translate(0,u*Z.getRowHeight()):Z._40o()&&Z.translate(10*u,0)},handle_keydown:function(Z){if(!V.isInput(Z.target)){var j,c=this.list,O=c.sm(),Y=c._rows,l=Y.size();if(rd(Z))c.selectAll();else if(am(Z))c.handleDelete&&c.handleDelete(Z);else if(Fj(Z))"d"!==this._62O||this.dragCancel||(c.handleDragAndDrop(Z,"cancel"),this.dragCancel=!0);else if(aj(Z))c.isCheckMode()&&(j=c.getFocusData(),j&&c.checkData(j));else if(Mg(Z)||Xd(Z)){var I=c.isCheckMode();if(j=I?c.getFocusData():O.ld()){var d=c.getRowIndex(j);d>=0&&(Mg(Z)?0!==d&&(j=Y.get(d-1),I?c.setFocusData(j):O.ss(j)):d!==l-1&&(j=Y.get(d+1),I?c.setFocusData(j):O.ss(j)))}else l>0&&(j=Y.get(0),I?c.setFocusData(j):O.ss(j))}}},_34o:function(Q,F){var y=this.list,W=y.lp(Q).x;return W>=0&&W<=y._indent?(y.checkData(F),void 0):(y.setFocusData(F),void 0)},_33o:function(A,R){var l=this.list,P=l.sm(),y=P.ld();if(Uc(A))l.isSelected(R)?P.rs(R):P.as(R);else if(Vf(A))if(y)for(var k=l.getRowIndex(y),b=l.getRowIndex(R);k!==b;)k+=b>k?1:-1,P.as(l._rows.get(k));else P.ss(R);else if(Ih(A)){var e=Qm();if(P.contains(R)){var D=e-this._lastSelectDataTime;l.handleDataDoubleSelect&&D>500&&1500>D&&l.handleDataDoubleSelect(A,R)}P.ss(R),this._lastSelectDataTime=e}else P.contains(R)||P.ss(R)}}),id.TreeView=function(O){var p=this;p._35o(),p._5o(O),new Oc(p)},fn("TreeView",w,{ms_ac:[gh,ur,uq,"rootVisible",or,"rootData",mo,Vh,mf,Hj,Hp,Hc,ib,Df,xb,wo,pm,Vd,Fp,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:R,_indent:Co,_rowHeight:Cj,_rowLineVisible:V.treeViewRowLineVisible,_rowLineColor:V.treeViewRowLineColor,_scrollBarColor:vi,_scrollBarSize:Tf,_autoHideScrollBar:kc,_expandIcon:V.treeViewExpandIcon,_collapseIcon:V.treeViewCollapseIcon,_autoMakeVisible:Mi,_selectBackground:V.treeViewSelectBackground,_labelColor:V.treeViewLabelColor,_labelSelectColor:V.treeViewLabelSelectColor,_labelFont:V.treeViewLabelFont,_doubleClickToToggle:V.treeViewDoubleClickToToggle,drawRow:function(R,B,m,J,n,e,f){var Q=this;Q.drawRowBackground(R,B,m,J,n,e,f),Q._97I(R,B,m,0,n,e,f)},isOnToggleIcon:function(l){var M=this.getDataAt(l);if(M){var K=this.getIndent(),c=this.lp(l).x;if(Tn(this.getToggleIcon(M))){var X=K*this.getLevel(M);if(c>=X&&X+K>=c)return!0}}return!1}});var Oc=function(R){Ep(Oc,this,[R])};uj(Oc,bq,{toggle:function(f,w,u,D){var r=this.list,A=r.lp(f).x;if(Tn(r.getToggleIcon(w))){var h=u*D;if(A>=h&&h+u>=A)return r.toggle(w),!0}return r.isDoubleClickToToggle()&&lb(f)?(r.toggle(w),!0):!1},_34o:function(R,$){var J=this.list,D=J.lp(R).x,Q=J._levelMap[$._id],d=J._indent,T=d*(Q+1);return D>=T&&T+d>=D?(J.checkData($),void 0):(this.toggle(R,$,d,Q)||J.setFocusData($),void 0)},_33o:function(L,x){var r=this,R=r.list;if(!r.toggle(L,x,R._indent,R.getLevel(x)))if(Vf(L)){var A=R.sm();if(A.size()>0){for(var s=R._rows,d=null,f=0,m=s.size();m>f;f++)if(R.isSelected(s.get(f))){d=f;break}for(var v=null,f=s.size()-1;f>=0;f--)if(R.isSelected(s.get(f))){v=f;break}var y,M,b=R.getRowIndex(x);for(d>b?(y=b-1,M=d):b>v?(y=v,M=b):(y=d,M=v);y!==M;)y++,A.as(R._rows.get(y))}else A.ss(x)}else Oc.superClass._33o.call(r,L,x)},handle_keydown:function(n){if(Pn(n)||zn(n)){var g=this.list,J=g._rows,Z=g.isCheckMode(),e=g.sm(),k=Z?g.getFocusData():e.ld();k?k.hasChildren()&&(Pn(n)?g.collapse(k):g.expand(k)):J.size()>0&&(k=J.get(0),Z?g.setFocusData(k):e.ss(k))}else Oc.superClass.handle_keydown.call(this,n)}});var lr=id.TableView=function(v){this._98I(),this._5o(v),new Uh(this)};fn("TableView",w,{ms_ac:[gh,ur,uq,"sortMode",bh,Ol,ib,Df,xb,De,cc,"sortColumn",mo,Vh,mf,Hj,Hp,Vd,Fp],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Li,_editable:!0,_batchEditable:!1,_rowHeight:Cj,_rowLineVisible:V.tableViewRowLineVisible,_rowLineColor:V.tableViewRowLineColor,_columnLineVisible:V.tableViewColumnLineVisible,_columnLineColor:V.tableViewColumnLineColor,_scrollBarColor:vi,_scrollBarSize:Tf,_autoHideScrollBar:kc,_autoMakeVisible:Mi,_selectBackground:V.tableViewSelectBackground,_labelColor:V.tableViewLabelColor,_labelSelectColor:V.tableViewLabelSelectColor,_labelFont:V.tableViewLabelFont,getCheckColumn:function(){var A=this;if(!A._31o){var T=A._31o=new Ln;T.setEditable(!0),T.setWidth(40),T.getValue=A.getCheckColumValue,T.drawCell=A.drawCheckColumnCell}return A._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(B){var G=this,N=G._39o,a=G.getCheckColumn();B!==G.isCheckMode()&&(B?N.add(a,0):N.remove(a),G.fp(or,!B,B))},getCheckColumValue:function(D,s,W){return W.isSelected(D)},drawCheckColumnCell:function(X,A,i,c,L,V,w,j,t){Lo(X,t.getCheckIcon(A),L+w/2,V+j/2,A,t)}});var Uh=function(B){Ep(Uh,this,[B])};uj(Uh,bq,{_34o:function(D,a){var g=this.list,P=g._31o;if(g.isCellEditable(a,P,D)){var N=g._3Q(P),X=g.lp(D).x;if(N&&X>=N.startX&&X<N.startX+P.getWidth())return g.checkData(a),void 0}g._37O(a,D),g.setFocusData(a)},_33o:function(N,X){this.list._37O(X,N),Uh.superClass._33o.apply(this,arguments)}});var _l=id.TreeTableView=function(T){var R=this,M=R._4o=new Ln;R._35o(),R._98I(),R._5o(T),M.setDisplayName("Name"),M.setEditable(!0),M.setWidth(180),M.drawCell=sj,M.getValue=Xb,R._39o.add(M),new Ug(R)},sj=function(_,a,C,f,O,S,x,i,y){y._97I(_,a,C,O,S,x,i)},Xb=function(g,V,U){return U.getLabel(g)};fn("TreeTableView",w,{ms_ac:[gh,ur,uq,"sortMode",bh,Ol,Hc,or,"rootData","rootVisible",mo,Vh,"sortColumn",wo,pm,mf,Hj,Hp,Vd,xb,ib,Df,De,cc,Fp,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Li,_checkMode:R,_editable:!0,_batchEditable:!1,_indent:Co,_rowHeight:Cj,_rowLineVisible:V.treeTableViewRowLineVisible,_rowLineColor:V.treeTableViewRowLineColor,_columnLineVisible:V.treeTableViewColumnLineVisible,_columnLineColor:V.treeTableViewColumnLineColor,_expandIcon:V.treeTableViewExpandIcon,_collapseIcon:V.treeTableViewCollapseIcon,_scrollBarColor:vi,_scrollBarSize:Tf,_autoHideScrollBar:kc,_autoMakeVisible:Mi,_selectBackground:V.treeTableViewSelectBackground,_labelColor:V.treeTableViewLabelColor,_labelSelectColor:V.treeTableViewLabelSelectColor,_labelFont:V.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Ug=function($){Ep(Ug,this,[$])};uj(Ug,bq,{_34o:function(w,W){var C=this.list,g=C._4o,j=C._3Q(g),I=C.lp(w).x;if(j){var T=C._indent,V=j.startX+T*C.getLevel(W);if(Tn(C.getToggleIcon(W))&&I>=V&&V+T>=I)return C.toggle(W),void 0;if(C.isCellEditable(W,g)&&(V+=T,I>=V&&V+T>=I))return C.checkData(W),void 0}C._37O(W,w),C.setFocusData(W)},_33o:function(P,u){var D=this.list,H=D.lp(P).x;if(Tn(D.getToggleIcon(u))){var J=D._3Q(D._4o);if(J){var o=D._indent,B=J.startX+o*D.getLevel(u);if(H>=B&&B+o>=H)return D.toggle(u),void 0}}D._37O(u,P),Ug.superClass._33o.apply(this,arguments)}});var fc=id.TableHeader=function(s){var k=this,y=k._view=wn(1,k),U=k._39o=s.getColumnModel(),B=k.iv;k.tv=k._tableView=s,k._60I=new Mf,k._canvas=ae(y),y.style.background=V.tableHeaderBackground||"",y.style.height=Nn+bg,U.mm(B,k),U.md(B,k),U.mh(B,k),s.mp(function(l){vj[l.property]&&k.iv()},k),new Zq(k),k.iv()};fn("TableHeader",w,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",gh,uq,Hc,"moveBackground","insertColor",De,cc,"resizable","movable"],_checkIcon:Nh,_movable:!0,_resizable:!0,_labelColor:V.tableHeaderLabelColor,_labelFont:V.tableHeaderLabelFont,_columnLineColor:V.tableHeaderColumnLineColor,_columnLineVisible:V.tableHeaderColumnLineVisible,_sortDescIcon:V.tableHeaderSortDescIcon,_sortAscIcon:V.tableHeaderSortAscIcon,_moveBackground:V.tableHeaderMoveBackground,_insertColor:V.tableHeaderInsertColor,_indent:Co,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(j){return j.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(c){return c.getColor()||this._labelColor},getLabelAlign:function(q){return q._align},onPropertyChanged:function(){this.iv()},_5Q:function(C){this._61I=C,this.iv()},getLogicalPoint:function(d){return Pd(d,this._canvas,this.tv.tx())},validateImpl:function(){var y=this,n=y._canvas,X=y.getWidth(),o=y.getHeight(),E=y.tv,W=y._60I,q=y._61I,V=-E.tx(),K=0;(X!==n.clientWidth||o!==n.clientHeight)&&Pb(n,X,o),W.clear(),y._39o._roots.each(function(w){if(w.isVisible()){var J=K+w.getWidth();V+X>=K&&J>=V&&W.add({column:w,startX:K}),K=J}});var i=mr(n);if(Up(i,-V,0,1),i.beginPath(),i.rect(V,0,X,o),i.clip(),i.clearRect(V,0,X,o),W.each(function(f){var L=f.column,j=f.startX,u=L.getWidth();u>0&&(i.save(),i.beginPath(),i.rect(j,0,u,o),i.clip(),q&&q.column===L||y.drawColumn(i,L,j,0,u,o),y._columnLineVisible&&gi(i,j+u-1,0,1,o,y._columnLineColor),i.restore())}),q){var x=q.column,K=q.startX,M=q.position,m=x.getWidth();i.save(),i.beginPath(),i.rect(K,0,m,o),i.clip(),i.fillStyle=y._moveBackground,i.fill(),y.drawColumn(i,x,K,0,m,o),i.restore(),ss(i,y._insertColor,M,0,o)}i.restore()},_6Q:function(X){var Q=this.tv;return Q._31o===X&&Q.sm().getSelectionMode()===_r},drawColumn:function(K,y,m,x,B,g){var s=this,L=s.tv,D=Tn(y.getIcon()),J=s.getLabelAlign(y);if(s._6Q(y)){var E=Tn(s._checkIcon);Lo(K,E,m+B/2,x+g/2,y,s)}else{var M=s.getLabel(y),r=s.getLabelFont(y),h=s.getLabelColor(y),w=Cb(r,M).width,k=D?s._indent:0;J===_c?(D&&Lf(K,D,pr,m,x,k,g),Dq(K,M,r,h,m+k,x,B,g,_c)):J===vk?(D&&Lf(K,D,pr,m+B-w-k,x,k,g),Dq(K,M,r,h,m,x,B,g,vk)):(D&&Lf(K,D,pr,m+(B-w-k)/2,x,k,g),Dq(K,M,r,h,m+(B-w+k)/2,x,0,g,_c))}if(y.isSortable()&&L.getSortColumn()===y&&(D=Tn(y.getSortOrder()===Bd?s._sortAscIcon:s._sortDescIcon))){var F=gs(D,y)/2+2;Lo(K,D,J===vk?m+F:m+B-F,x+g/2,y,L)}}});var Zq=function(g){var $=this;$.th=g,$.tv=g._tableView,$.addListeners()};uj(Zq,w,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(M){this.getView().style.cursor=M},handle_mousemove:function(h){if(!Lh){var O=this;delete O._29o,O.setCursor(jh);for(var e=O.th,D=e._60I,S=e.lp(h).x,G=D.size()-1;G>=0;G--){var y=D.get(G),m=y.column,a=y.startX+m.getWidth();if(e.isResizable()&&q(a-S)<=(Kq?10:3))return O._29o=y,O.setCursor(Zo),void 0;S>y.startX&&a>S&&(O._29o=y),(m.isClickable()||m.isSortable()||e.isMovable()||O.tv.getCheckColumn&&m===O.tv.getCheckColumn())&&S>y.startX&&a>S&&O.setCursor(zg)}}},handle_mousedown:function(m){this.handle_touchstart(m)},handle_touchstart:function(i){var W=this;dj(i),W.tv.endEditing(),W.handle_mousemove(i),W._29o&&(W.x=zr(i).x,W.lx=W.th.lp(i).x,W.w=W._29o.column.getWidth(),ts(W,i))},handleWindowMouseMove:function($){this.handleWindowTouchMove($)},handleWindowTouchMove:function(O){var H=this,o=H.th,k=H.getView().style.cursor,z=H._29o,y=zr(O).x-H.x;if(H.resizing||H.moving||(k===Zo?H.resizing=1:o.isMovable()&&k===zg&&q(y)>2&&(H.moving=1)),H.resizing)z.column.setWidth(H.w+y);else if(H.moving){var Y=H.lx+y;o._60I.each(function(s){var m=s.startX,$=m+s.column.getWidth();if(Y>=m&&$>=Y){var M={column:z.column,startX:z.startX+y,front:$-Y>Y-m,insertColumn:s.column};M.position=M.front?m:$,o._5Q(M)}})}},_16Q:function(M,t){var y=this,K=y.tv,F=y.th,c=F._checkIcon;if(F._6Q(M)){var I=Tn(c),u=y.lx,Z=M.getWidth(),r=gs(I,M);if(u>=t+Z/2-r&&t+Z/2+r>=u){F.setCheckIcon(c===fq?Nh:fq);var R=K.sm(),Q=K._rows;return c===fq?R.rs(Q):R.ss(Q),K.onCheckColumnClicked(M),!0}}return!1},handleWindowMouseUp:function(V){this.handleWindowTouchEnd(V)},handleWindowTouchEnd:function(D){var L=this,G=L.tv,J=L.th,p=L._29o;if(L.moving){var r=J._61I;if(r&&r.insertColumn!==r.column){var P=r.column,q=G.getColumnModel()._roots,C=q.remove(P),U=q.indexOf(r.insertColumn);U>=0&&(r.front||U++,U<=q.size()&&(q.add(P,U),G.getColumnModel()._38I(P,C,U)))}J._5Q(R),delete L.moving}else if(!L.resizing&&p){P=p.column;var T=J.lp(D).x,j=p.startX,b=!0;if(J.onColumnClicked){var F=J.onColumnClicked(P,D,j);F===!1&&(b=!1)}if(b&&T>=j&&T<=j+P.getWidth()&&!L._16Q(P,j)){if(P.isSortable()){var v=G.getSortMode(),O=P.getSortOrder();v===Li?G.getSortColumn()===P?(O===_m&&G.setSortColumn(R),P.setSortOrder(O===Bd?_m:Bd)):G.setSortColumn(P):"bistate"===v&&(G.getSortColumn()===P?P.setSortOrder(O===Bd?_m:Bd):G.setSortColumn(P))}G.onColumnClicked(P,D,j)}}L._29o=L.resizing=L.x=L.lx=L.w=R}}),id.TablePane=function(u){this.init(new lr(u))},fn("TablePane",w,{ms_v:1,_44o:1}),id.TreeTablePane=function(U){this.init(new _l(U))},fn("TreeTablePane",w,{ms_v:1,_44o:1}),id.Toolbar=function(F){var K=this,p=K._view=wn(1,K),H=p.style;H.background=V.toolbarBackground||"",H.height=_k+bg,K._canvas=ae(p),K._30o=new Mf,K._90I=new Mf,K.setItems(F||[]),p.handleGroupSelectedChanged=function(I){if(I.isSelected()){var k=I.getGroupId();null!=k&&K._items.forEach(function(O){var Z=O.element;Z&&Z!==I&&Z.setSelected&&Z.getGroupId&&Z.getGroupId()===k&&Z.setSelected(!1)})}},new yf(K)},fn("Toolbar",w,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Ok,gh,uq,ur,Fp,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:V.toolbarLabelColor,_labelSelectColor:V.toolbarLabelSelectColor,_labelFont:V.toolbarLabelFont,_selectBackground:V.toolbarSelectBackground,_itemGap:V.toolbarItemGap,_separatorColor:V.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(V){var x=this.getItemInfoAt(V);return x?x.item.toolTip:R},getLabelColor:function(U){return U&&U.selected&&U.type!==fq&&U.type!==Nc?this._labelSelectColor:this._labelColor},onPropertyChanged:function(J){this.iv(),J.property===Ok&&this._items.forEach(function(V){As(V)})},redraw:function(){this.iv()},addItem:function(M,G){var y=this._items;G==R?y.push(M):y.splice(G,0,M),this.fp(Ok,R,y)},removeItem:function(x){if(x)for(var Z=this._items,f=0;f<Z.length;f++)x===Z[f]&&(Z.splice(f,1),this.fp(Ok,R,Z))},removeItemById:function(U){if(U!=R)for(var a=this._items,F=0;F<a.length;F++)if(U===a[F].id){var k=a.splice(F,1)[0];return this.fp(Ok,R,a),k}},getItemById:function(q){if(q!=R)for(var A=this._items,h=0;h<A.length;h++){var v=A[h];
if(q===v.id)return v}},setItemVisible:function(r,X){var A=this.getItemById(r);A&&(A.visible=X)},getItemInfos:function(){return this._30o},getItemInfoAt:function(k){var N=this,M=0,V=N._30o,n=N.lp(k),K=n.x,a=n.y;if(a>=0&&a<=N.getHeight())for(;M<V.size();M++){var C=V.get(M);if(C.startX<=K&&K<=C.endX)return C}return R},drawItem:function(e,L,c,E,N){if(L.visible===!1)return 0;if(xj(L.visible)&&!L.visible())return 0;var O=this,d=L.disabled;d&&(e.globalAlpha=Aq);var D=O.drawItemImpl(e,L,c,E,N),_=O._itemGap;return d&&(e.globalAlpha=1),this._currentItem!==L||"separator"===L||L.separator===!0||L.unfocusable||sb(e,O._separatorColor,c-_/2,0,D+_,E),D},drawItemImpl:function(D,E,s,p,Z){var z=this,u=z._view,O=z._itemGap,$=p/2,q=E.type,Q=E.element,N=E.label;Fc(Q)&&(N=Q,Q=R);var X,B=z.getLabelFont(E),L=z.getLabelColor(E),m=E.selected,S=Tn(E.icon),d=gs(S,E),c=0,h=d+(N?Cb(B,N).width:0);if("separator"===E||E.separator===!0)return ss(D,z._separatorColor,s,p/4,$),1;if(Q){S&&Lo(D,S,s+d/2,$,E,z),Dq(D,N,B,L,s+d,0,0,p);var o=dc(Q);Z||z._90I.add(o),o.parentNode!==u&&ub(u,o),Q.iv&&Q.iv(),Q.validate&&Q.validate();var C=o.getBoundingClientRect(),U=C.width,M=o.style;return ci(o),M.left=z.tx()+s+h+bg,M.top=(p-C.height)/2+bg,h+U}return q===Nc?X=Tn(m?ms:Yh):q===fq&&(X=Tn(m?fq:Nh)),X?(c=gs(X,E),Lo(D,X,s+c/2,$,E,z),s+=c,h+=c):m&&gi(D,s-O/2,0,h+O,p,z.getSelectBackground(E)),S&&Lo(D,S,s+d/2,$,E,z),Dq(D,N,B,L,s+d,0,0,p),h},validateImpl:function(){var S=this,T=S._canvas,Q=S.getWidth(),u=S.getHeight(),x=S._30o,A=S._items;Pb(T,Q,u);var Z=mr(T),y=S._itemGap,L=y/2;Up(Z,S.tx(),0,1),Z.clearRect(0,0,Q,u);var b=S._90I;S._90I=new Mf,x.clear(),A.forEach(function(b){var Q=S.drawItem(Z,b,L,u);x.add({item:b,startX:L,endX:L+Q,width:Q}),Q&&(L+=Q+y)}),b.each(function(y){S._90I.contains(y)||hb(y)});var z=S._64I;S._64I=D(0,L),Z.restore(),S._stickToRight?(S._65O=0,Z=mr(T),L=Q-S._64I+y,Up(Z,0,0,1),Z.clearRect(0,0,Q,u),x.clear(),A.forEach(function(D){var e=S.drawItem(Z,D,L,u,!0);x.add({item:D,startX:L,endX:L+e,width:e}),e&&(L+=e+y)}),Z.restore()):S.tx(S.tx()),z!==S._64I&&S.onSumWidthChanged(z,S._64I)},onSumWidthChanged:function(){},handleClick:function(I,r){var H=this,Z=I.type,O=I.action,q=I.groupId,W=I.selected;I.disabled||(q!=R?W||(I.selected=!0,this._items.forEach(function(T){T.groupId===q&&I!==T&&(T.selected=!1)}),O&&I.action(I,H,r)):Z===fq||"toggle"===Z?(I.selected=!W,O&&I.action(I,H,r)):O&&I.action(I,H,r)),Ak(),H.iv()}});var yf=function(U){this.tb=U,this.addListeners()};uj(yf,w,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(b){this.handleScroll(b,10*(b.wheelDelta/40))},handle_DOMMouseScroll:function(Q){this.handleScroll(Q,10*-Q.detail)},handleScroll:function(C,j){dj(C);var F=this.tb;F.isScrollable()&&!F._stickToRight&&(F.tx(F.tx()+j),Wd())},handle_mousemove:function($){var J=this;Lh||J.setItem($)},handle_mouseout:function(z){var g=this;z.target===g.getView()?g.tb.setCurrentItem(R):g.handle_mousemove(z)},handle_mousedown:function(O){this.handle_mousemove(O),this.handle_touchstart(O)},handle_touchstart:function(O){var m=this,H=m.tb,x=O.target;Ih(O)&&(x===m.getView()||x===H._canvas)&&(dj(O),H.setFocus(O)&&(this.setItem(O,!0),(H.isScrollable()||m.info&&!m.info.item.disabled)&&(m.x=zr(O).x,m.tx=H.tx(),ts(m,O))))},handleWindowMouseMove:function(y){this.handleWindowTouchMove(y)},handleWindowTouchMove:function(B){var K=this,k=K.tb;if(!k._stickToRight){var P=zr(B).x-K.x;!K._25o&&q(P)>2&&k.isScrollable()&&(K._25o=1),K._25o&&k.tx(K.tx+P)}},handleWindowMouseUp:function(F){this.handleWindowTouchEnd(F)},handleWindowTouchEnd:function(F){var U=this,y=U.tb,W=U.info,q=U.tb.getItemInfoAt(F);if(!U._25o&&W){var e=W.item;q&&q.item===e&&y.handleClick(e,F)}U._25o=U.x=U.tx=R,U.setItem()},setItem:function(d,y){var F=this,W=F.tb,n=F.info=d?W.getItemInfoAt(d):R,J=n?n.item:R;W.setCurrentItem(J),y&&J&&xj(J.onDown)&&J.onDown(d)}}),id.BorderPane=function(){this._view=wn(1,this),this.iv()},fn("BorderPane",w,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(D,a){this._12o("leftView",D),a!=R&&this.setLeftWidth(a)},getRightView:function(){return this._rightView},setRightView:function(I,U){this._12o("rightView",I),U!=R&&this.setRightWidth(U)},getTopView:function(){return this._topView},setTopView:function(N,J){this._12o("topView",N),J!=R&&this.setTopHeight(J)},getBottomView:function(){return this._bottomView},setBottomView:function(_,K){this._12o("bottomView",_),K!=R&&this.setBottomHeight(K)},getCenterView:function(){return this._centerView},setCenterView:function(p){this._12o("centerView",p)},_12o:function(o,d){var f=this,k="_"+o,L=f._view,q=f[k];q!==d&&(q&&(q.getView?hb(q.getView()):hb(q)),f[k]=d,d&&(d.getView?ub(L,d.getView(),1):ub(L,d,1)),f.fp(o,q,d))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var w=this,s=w._topView,x=w._bottomView,y=w._leftView,W=w._rightView,c=w._centerView,v=w.getWidth(),B=w.getHeight(),V=0,p=0,J=v,H=B,$=0,X=0,K=0,F=0;s&&($=w._topHeight==R?gk(s):w._topHeight,p=$),x&&(X=w._bottomHeight==R?gk(x):w._bottomHeight,H=B-X),y&&(K=w._leftWidth==R?hk(y):w._leftWidth,V=K),W&&(F=w._rightWidth==R?hk(W):w._rightWidth,J=v-F);var j=D(0,J-V),m=D(0,H-p);s&&nd(s,0,0,v,$),x&&nd(x,0,H,v,X),y&&nd(y,0,p,K,m),W&&nd(W,J,p,F,m),c&&nd(c,V,p,j,m)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);