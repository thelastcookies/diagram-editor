!function(i,g,c){"use strict";function N(y,P){if("function"!=typeof P&&null!==P)throw new TypeError("Super expression must either be null or a function");y.prototype=g.create(P&&P.prototype,{constructor:{value:y,writable:!0,configurable:!0}}),P&&ed(y,P)}function K(C){var X=g.prototype.toString.call(C);return"Array]"===X.substring(X.length-6)}function o(Q,O,r,G,R,$){O=O||[],r=r||[],G=G||[];try{O.push(Q);var y=Function.apply(0,O);return r[r.length]="return "+y,Function.apply(0,r).apply(0,G)}catch(J){return $&&$(J),R}}function l(K){var p={};return{get:function(w){if(p[w]!==c)return p[w];var d;switch(w){case"WEBGL_depth_texture":d=K.getExtension("WEBGL_depth_texture")||K.getExtension("MOZ_WEBGL_depth_texture")||K.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":d=K.getExtension("EXT_texture_filter_anisotropic")||K.getExtension("MOZ_EXT_texture_filter_anisotropic")||K.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":d=K.getExtension("WEBGL_compressed_texture_s3tc")||K.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||K.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":d=K.getExtension("WEBGL_compressed_texture_pvrtc")||K.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":d=K.getExtension("WEBGL_compressed_texture_etc1");break;default:d=K.getExtension(w)}return p[w]=d,d}}}function $(I,e,u){function g(){if(l!==c)return l;var s=e.get("EXT_texture_filter_anisotropic");return l=null!==s?I.getParameter(s.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function P(L){if("highp"===L){if(I.getShaderPrecisionFormat(I.VERTEX_SHADER,I.HIGH_FLOAT).precision>0&&I.getShaderPrecisionFormat(I.FRAGMENT_SHADER,I.HIGH_FLOAT).precision>0)return"highp";L="mediump"}return"mediump"===L&&I.getShaderPrecisionFormat(I.VERTEX_SHADER,I.MEDIUM_FLOAT).precision>0&&I.getShaderPrecisionFormat(I.FRAGMENT_SHADER,I.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var l;u=u||{};var C="undefined"!=typeof WebGL2RenderingContext&&I instanceof WebGL2RenderingContext,J=u.precision!==c?u.precision:"highp",z=P(J);z!==J&&(console.warn("WebGL:",J,"not supported, using",z,"instead."),J=z);var k=u.logarithmicDepthBuffer===!0,j=I.getParameter(I.MAX_TEXTURE_IMAGE_UNITS),r=I.getParameter(I.MAX_VERTEX_TEXTURE_IMAGE_UNITS),i=I.getParameter(I.MAX_TEXTURE_SIZE),Q=I.getParameter(I.MAX_CUBE_MAP_TEXTURE_SIZE),O=I.getParameter(I.MAX_VERTEX_ATTRIBS),Z=I.getParameter(I.MAX_VERTEX_UNIFORM_VECTORS),n=I.getParameter(I.MAX_VARYING_VECTORS),F=I.getParameter(I.MAX_FRAGMENT_UNIFORM_VECTORS),R=r>0,E=C||!!e.get("OES_texture_float"),o=(C||!!e.get("OES_element_index_uint"))&&"undefined"!=typeof Uint32Array,K=R&&E,Y=C?I.getParameter(I.MAX_SAMPLES):0;return{getMaxAnisotropy:g,getMaxPrecision:P,precision:J,logarithmicDepthBuffer:k,maxTextures:j,maxVertexTextures:r,maxTextureSize:i,maxCubemapSize:Q,maxAttributes:O,maxVertexUniforms:Z,maxVaryings:n,maxFragmentUniforms:F,vertexTextures:R,floatFragmentTextures:E,elementTypeUint:o,floatVertexTextures:K,maxSamples:Y}}function e(S,g){return S.z!==g.z?g.z-S.z:S.id-g.id}var s="ht";if(!i[s]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),i.performance&&i.performance.now||function(){var m=Date.now();i.performance||(i.performance={}),i.performance.now=function(){return Date.now()-m}}();for(var s=Date.now(),Y=16,e=["ms","moz","webkit","o"],N=0;N<e.length&&!i.requestAnimationFrame;++N)i.requestAnimationFrame=i[e[N]+"RequestAnimationFrame"],i.cancelAnimationFrame=i[e[N]+"CancelAnimationFrame"]||i[e[N]+"CancelRequestAnimationFrame"];i.requestAnimationFrame||(i.requestAnimationFrame=function(V){var S=Date.now(),o=Y+s-S;return 0>o&&(o=0),s=S,i.setTimeout(function(){s=Date.now(),V(performance.now())},o)}),i.cancelAnimationFrame||(i.cancelAnimationFrame=function(r){return i.clearTimeout(r)}),g.assign===c&&(g.assign=function(n){if(n===c||null===n)throw new TypeError("Cannot convert undefined or null to object");for(var $=g(n),a=1;a<arguments.length;a++){var q=arguments[a];if(q!==c&&null!==q)for(var m in q)g.prototype.hasOwnProperty.call(q,m)&&($[m]=q[m])}return $}),i.btoa===c&&(i.btoa=function(D){for(var u,v,f=String(D),k=0,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",R="";f.charAt(0|k)||(l="=",k%1);R+=l.charAt(63&u>>8-8*(k%1))){if(v=f.charCodeAt(k+=.75),v>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");u=u<<8|v}return R})}();var u,I,J,w,V=i.location,X=V&&i.document,U=null,L=c,C=i[s]={},f=i[s+"config"],G=C.Default=f&&f.Default||{},Y=C.Style=f&&f.Style||{},T=C.Attr=f&&f.Attr||{},E=function(){return!0},R=function(){return!1},M=function(O){return O},D=function(T){return!T},P=C.Color=f&&f.Color||{},r=C.IsGetter=f&&f.IsGetter||{};!function(){var y=!1;try{var C=g.defineProperty({},"passive",{get:function(){return y=!0,c}});V&&(J=u=V)&&i.addEventListener("test",C,C),V&&(w=I=V)&&i.removeEventListener("test",C,C)}catch(A){y=!1}G.passiveSupported=y}();var Z,H,p,m,W=G.passiveSupported,v=G.eventListenerOptionsFalse=W?{passive:!1,capture:!1}:!1,q=G.eventListenerOptionsTrue=W?{passive:!1,capture:!0}:!0,d=function(N,m,X,R){N.addEventListener(m,X,R?q:v)},h=function(W,T,E,z){W.removeEventListener(T,E,z?q:v)},n=Math,O=n.round,A=n.floor,Q=n.ceil,j=n.sqrt,B=n.max,x=n.min,k=n.abs,b=n.cos,z=n.acos,_=n.sin,a=n.pow,F=n.asin,y=n.exp,S=n.PI,t=2*S,Cg=S/2,nm=n.tan,dj=n.atan2,Al=n.random,Si=n.log,xl=function(_,g,L){return Math.max(g,Math.min(L,_))},Xj=a(2,1),Wi=!1,Ob=i.parseInt||global.parseInt,_c="2021-12-15",gm=V&&(i.navigator?i.navigator.platform.indexOf("Win")>-1:!1),Eq=function(B){return B*B},xq=V&&i.setTimeout,rj=V&&i.clearTimeout,ii=V&&(i.navigator?i.navigator.userAgent.toLowerCase():""),op=function(e){return e.test(ii)},Ue=op(/msie/),ze=op(/msie/)||op(/trident/),nk=op(/msie 10/),dq=op(/edge/),ym=op(/firefox/),Un=op(/mac/),le=op(/mscAndroid/),jg=G.isTouchable===c?gm?!1:X?"ontouchend"in X:!1:G.isTouchable,fg="default",uo="single",Jo="multiple",Sl="front",Em="back",Ld="left",fk="right",vc="top",Ol="bottom",Rp="center",wi="eye",os="middle",No="east",rh="west",hf="north",Jj="none",Cm="px",Cq="absolute",Uq="border",ai="triangle",co="rect",He="circle",pn="cylinder",gs="shape",cf="items",Lb="normal",Db="remove",ke="clear",Vr="width",Jb="height",mo="ingroup",il="check",Zb="uncheck",Wd="radio",Oq="radioOn",Mn="radioOff",vn="points",Fl="values",Pg="series",Dj="body",Np="label",Kq="label2",oj="note",ok="note2",Lc="icons",Kl="labelFont",Lr="labelColor",qr="labelSelectColor",Ep="note.expanded",zf="note2.expanded",tn="edge.expanded",tg="edge.points",Hk="edge.type",ee="rotation",Mc="hidden",Uk="visible",ts="tuv",ae="no",Tg="draw",$e="select",oq="currentSubGraph",Bd="selectBackground",_m="autoMakeVisible",ne="autoHideScrollBar",Bm="scrollBarColor",uk="scrollBarSize",Bo="indent",Bj="rowHeight",wl="columnLineColor",ro="rowLineColor",pg="columnLineVisible",gh="rowLineVisible",Wm="visibleFunc",Of="expandIcon",wg="collapseIcon",yl="checkMode",Nl="sortFunc",kl="editable",ck="batchEditable",nh="tristate",qk="asc",Yj="desc",Pc="position",Ll="__",Dq="elevation",Xb="children",mc="translateX",yd="translateY",ln="dataModel",bf="maxSize",dg="enc",Nf="state",Ac=dg+"o"+"de",_q="shape3d",Vk="shape3d.resolution",Yr="shape3d.visible",Bp="shape3d.from.visible",pe="shape3d.to.visible",qb="shape3d.top.visible",Kk="shape3d.bottom.visible",ge="repeat.uv.length",gc="serializeValue",Yg="deserializeValue",gf="centerUniform",Aq="uniform",ji="rgba(255,255,255,0)",qq="style",rk="attr",Vm="field",Dl="string",Gh="boolean",oi="color",mk="int",dm="number",Sm="ew-resize",Sg="ns-resize",vp="pointer",zj="auto",qf="mousedown",hr="mousemove",wf="mouseup",bo="mouseout",Wr="touchstart",Yh="touchmove",Wn="touchend",Zl="keydown",Pk="keyup",bq=["DOMMouseScroll","mousewheel"],Ri=ym?bq[0]:bq[1],Vi=Ll+s+Ll+Ac,zb=[Wr,Yh,Wn],Eh=[qf,hr,wf,bo,Ri,"wheel","mouseenter","mouseleave","mouseover"],Hq=[Zl,Pk,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],nc=jg?zb.concat(Hq):Eh.concat(Hq),Gk=U,ff=U,Ik=U,xn=U,ah=!1,gp=wf.length,qm=function(){Ik&&(rj(Ik.timeout),Ik=U)},Ne=function(){Ik&&nn(Ik.e,Ik.info)};i.addEventListener&&(L=V)&&(jg||(d(i,bo,function(){qm()}),d(i,Ri,function(){ho()})),d(i,Pk,function(Y){91===Y.keyCode?Dk={}:delete Dk[Y.keyCode]},!0),d(i,Zl,function(l){Dk[l.keyCode]=!0},!0),d(i,"blur",function(){Dk={}}));var qh,$q,vd,Hc=0,Rc=U,sf=function(F,V){var x=xq(function(){delete Rc[x],bi(Rc)&&(Rc=U),F()},V);return x},Pb=U,db=U,Bl={},$r={},Be={},fb={},Jm={},Dk={},Dh={},Kb={},$n={},Ko={},Gl=/.json$/,Ch=/\.(json|bin)$/,pd=/^data:image\/svg\+xml/,Mp={},Ln=[],oc={},kg=U,Tq=U,cp=function(){},Cn=function(){throw"Oops!"},Ff=[0,0,0],Ki={x:0,y:0,width:0,height:0},qj=U,Pe=U,Oj=U,rr=function(n,r){$r[n]=r,r&&r.comps&&!r.uuid&&(r.uuid=C.Math.generateUUID()),ob[n]&&(r.cacheRule=ob[n],delete ob[n])},hd=function(J){Pe&&!J._72O&&(Oj||(Oj={}),Oj[J._72O=uh()]=J),qh!=U?Vc()<.05&&m&&!$q&&(id=qm):id=Nj},wn=function(q,T,g,f){Pe||(Pe={});var a=Pe[q];if(a){if(a.url===T)return;a.image?(a.image.onload=cp,a.image.onerror=cp):a.request&&(a.request.onload=cp,a.request.onerror=cp)}if(Gl.test(T)){var A=new Wh;if(Pe[q]={request:A,url:T},T=G.beforeLoadURL(T,q),T.data){var u=G.parse(T.data);iq(q,u),G.handleImageLoaded(q,u)}else{A.onload=function(){if(200===this.status||0===this.status){var a=G.parse(A.getResponseText());iq(q,a),G.handleImageLoaded(q,a)}else iq(q,G.handleUnfoundImage(q,T)||U)},A.onerror=function(){iq(q,G.handleUnfoundImage(q,T)||U)};var J={};J.url=encodeURI(T),J.sync=!1,A.send(J)}}else{var u=new Image;Pe[q]={image:u,url:T},/^data:image/.test(T)||(T=G.beforeLoadURL(T,q),T=G.appendTimeStamp(T),T=encodeURI(T),u.crossOrigin=G.crossOrigin),G.convertImageSrc(T,function(s){ze&&(T.toLowerCase().indexOf(".svg")>0||pd.test(T))?(X.body.appendChild(u),u.style.visibility="hidden",u.onload=function(){xq(function(){if(g&&(u.width=g),f&&(u.height=f),!u.width||!u.height){var l=u.width||u.clientWidth,v=u.height||u.clientHeight;u.width=l,u.height=v}G.handleImageLoaded(q,u),iq(q,u),X.body.removeChild(u),u.style.visibility=""},180)},u.onerror=function(){iq(q,G.handleUnfoundImage(q,T)||U),X.body.removeChild(u),u.style.visibility=""}):(u.onload=function(){g&&(u.width=g),f&&(u.height=f),G.handleImageLoaded(q,u),iq(q,u)},u.onerror=function(){iq(q,G.handleUnfoundImage(q,T)||U)}),u.src=s})}},iq=function(O,f){if(rr(O,f),delete Pe[O],bi(Pe)&&(Pe=U,Oj)){for(var S in Oj){var r=Oj[S];r._2O&&r._2O[O]&&(r.deleteTexture(O),delete r._2O[O]),r.invalidateAll&&r.invalidateAll(c,"imageLoaded",O),r.redraw&&r.redraw(),r.iv(),f&&f.layoutAttach&&kk(r.dm)&&r.dm().updateLayoutAttach(O),delete r._72O}Oj=U}if(f&&Oj)for(var S in Oj){var r=Oj[S];r.invalidateAll&&r.invalidateAll(c,"imageLoading",O),r.redraw&&r.redraw(),r.iv(),f.layoutAttach&&kk(r.dm)&&r.dm().updateLayoutAttach(O)}},rq=function(){return Si=n&&Date,function(){return i.performance&&i.performance.now?i.performance.now():Date.now()}}(),pr=function(b,l,E){return{width:b,height:l,comps:zo(E)?E:[E]}},kf=function(z,m){return{type:He,rect:[z,m,1.6,1.6],borderWidth:1,borderColor:Xp,gradient:nd,gradientColor:Nh,background:Xp}},ab=function(r,F){return pr(16,16,{type:ai,rect:[4,4,10,8],background:r,rotation:F?1.57:3.14})},uc=function(k,K){return pr(16,16,{type:ai,rect:[4,4,8,7],background:k,rotation:K?3.14:0})},ui=function(S){var t=S._orientation;return"horizontal"===t||"h"===t},wp=function(L,i){var R=U||4,z=U||1,p=U||1;0>R?R=0:R>.25&&(R=.25);var J,V,Z,c,e,G,C,A=.5,W=[],B=[],q=[],Y=t/p,m=t/z,X=A-R;for(V=0;z>=V;V++)for(c=-S+V*m,G=b(c),e=_(c),J=0;p>=J;J++)Z=J*Y,C=X+R*G,W.push(b(Z)*C,e*R,-_(Z)*C),(H=[L,i])&&B.push(J/p,1-V/z);for(V=0;z>V;V++){var h=V*(p+1),M=(V+1)*(p+1);for(J=0;p>J;J++)q.push(h+J,M+J+1,M+J,h+J,h+J+1,M+J+1),pb.z=sh.z=[L,i]}},Gi=function(z){var L=2,E=0;for(var K in z)K.length===L&&Ob(K,32)===gq&&(kg=Tq=z[K]),E++;return E},Yn=function(G,T,u,h){return u||(u=jg?5:3,u/=h||1),{x:G-u,y:T-u,width:2*u,height:2*u}},Nd=function(M,t,u,s){var C=this;t||(t=jg?5:3,u=20,s=20);var o={x:M,y:t,width:u,height:s};if(u)for(var N=0;u>N;N++)if(3===u)s=20;else for(var y=0;s>y;y++)C=i?i:u;var Q={x:S,y:2*S};if(Qn(o,Q)){var X=Jb[0]+vc[0]+ke[1]+qk.length,c=Mc[0]+nh[0]+ke[1]+Dj.length;Fk[wi]=[C[X],C[c]],C[X]=Iq[wi],C[c]=Iq[_q]}},rs=function(F){return(/ble$/.test(F)||/ed$/.test(F)||r[F]?"is":"get")+F.charAt(0).toUpperCase()+F.slice(1)},Iq=function(s){return"set"+s.charAt(0).toUpperCase()+s.slice(1)},ak=function(v){return typeof v===Dl||v instanceof String},Bk=function(z){return typeof z===dm},Nj=function(Z){return typeof Z===Gh},jb=function(l){return l&&"object"==typeof l},kk=function(s){return"function"==typeof s},zo=function(H){return H instanceof Array},gg=function(G){return G instanceof Vo},Nm=function(b){return zo(b)?new Vo(b):b},Je=function(O){return O instanceof Hh},hq=function(P){return P instanceof Fb},Di=function(f){return f instanceof bc},tm=function(G,X){if(!(G instanceof C.Group))return!1;if(!X)return G.isExpanded();var J=X.getDataUI(G);return J&&J._88I?!0:!1},qs=function(u){return u instanceof af},ie=function(G){return G&&"IFRAME"===G.tagName},Or=function(H){return H==U||G.numberDigits==U?H:parseFloat(H.toFixed(G.numberDigits))},kq=function(Y,S,H){var p,g=S.length;if(H)for(var Q=0;H>Q;Q++)if(3===g)Y.push(S[0]),Y.push(S[1]),Y.push(S[2]);else for(p=0;g>p;p++)Y.push(S[p]);else if(3===g)Y.push(S[0]),Y.push(S[1]),Y.push(S[2]);else for(p=0;g>p;p++)Y.push(S[p])},Li=function(T){return T?jb(T)?T:{}:!1},hn=function(x,V,U){var A,w=jb(x)?x:x.prototype;for(A in V)U&&A in w?w[A]===c&&console.warn("class",w,"has own undefined property",A,", keep exist!"):w[A]=V[A];return x},Op=function(O,e){if(!("wheelDelta"in e)){var T=e.deltaMode;e.wheelDelta=T===e.DOM_DELTA_PIXEL?-e.deltaY:T===e.DOM_DELTA_LINE?40*-e.deltaY:120*-e.deltaY}O.handle_mousewheel(e)},Yo=function(O){return String.fromCharCode(O)},Tf=function($){for(var j,e=0,W="";e<$.length;e++)j=$[$.length-1-e],"%"===j?j="'":"a"===j?j='"':"]"===j&&(j="\\"),W+=Yo(j.charCodeAt(0)-1);return W},Zn=function(m,c,b){m.superClass.constructor.apply(c,b)},bi=function($){for(var G in $)return!1;return!0},$d=function(W){return W?0===W.length:!0},Gn=function(){var g="";return[Zb[0],ro[0],Np[0]].forEach(function(v){g+=Iq(v).slice(3)}),Aq=X&&X[g]||gf,function(H,m){return H===m?!0:H.x===m.x&&H.y===m.y&&H.width===m.width&&H.height===m.height}}(),If=function(F,Y,K){return Y>F?Y:F>K?K:F},ki=function(E){return 0>E?-1:E>0?1:0},Vc=function(){var y=1e4*_(gp++);return y-A(y)},wc=function(Y,H,T){return ik(Y.x,Y.y,H.x,H.y,T.x,T.y,T.x+T.width,T.y,!0)||ik(Y.x,Y.y,H.x,H.y,T.x+T.width,T.y,T.x+T.width,T.y+T.height,!0)||ik(Y.x,Y.y,H.x,H.y,T.x+T.width,T.y+T.height,T.x,T.y+T.height,!0)||ik(Y.x,Y.y,H.x,H.y,T.x,T.y+T.height,T.x,T.y,!0)},ik=function(C,y,j,t,i,W,u,$,f){var k=(u-i)*(y-W)-($-W)*(C-i),N=($-W)*(j-C)-(u-i)*(t-y);if(0!==N){var r=k/N,G=C+r*(j-C),a=y+r*(t-y);return f&&(G+Rr<x(C,j)||G-Rr>B(C,j)||G+Rr<x(i,u)||G-Rr>B(i,u)||a+Rr<x(y,t)||a-Rr>B(y,t)||a+Rr<x(W,$)||a-Rr>B(W,$))?U:[G,a]}return U},go=function(u,e,O){if(u&&O)if(e){if(e===qq)return u.getStyle(O);if(e===rk)return u.getAttr(O);if(e===Vm)return u[O]}else if(O=rs(O),u[O])return u[O]();return c},Eo=function($,N,X,j){if($&&X)if(N){if(N===qq)$.s(X,j);else if(N===rk)$.a(X,j);else if(N===Vm){var Q=$[X];$[X]=j,$.fp("f:"+X,Q,j)}}else X=Iq(X),$[X]&&$[X](j)},Qe=function(w,c){var t,X,P,F=!1;return(go(w,qq,"shadow")||c&&"shadow"===go(w,qq,"select.type"))&&(t=go(w,qq,"shadow.offset.x")||0,X=go(w,qq,"shadow.offset.y")||0,P=go(w,qq,"shadow.blur")||0,F=!0),!F&&go(w,qq,"shadow2")&&(t=go(w,qq,"shadow2.offset.x")||0,X=go(w,qq,"shadow2.offset.y")||0,P=go(w,qq,"shadow2.blur")||0,F=!0),F?1.5*P+Math.max(t,X):0},rd=function(x,M,L,d){return d=0===L?0:d||0,M&&"top"!==M?"bottom"===M?{x:x.x-d,y:x.y-d,width:x.width+2*d,height:x.height*L+d}:"right"===M?{x:x.x-d,y:x.y-d,width:x.width*L+d,height:x.height+2*d}:"left"===M?{x:x.x+x.width*(1-L),y:x.y-d,width:x.width*L+d,height:x.height+2*d}:void 0:{x:x.x-d,y:x.y+x.height*(1-L),width:x.width+2*d,height:x.height*L+d}},vq=function(w,q,d,F,r){q&&om(w,d,F,1,r,q)},ur=function(j,v,C,O){var o=1-j;return o*o*v+2*j*o*C+j*j*O},pb=function(i,p,X,l,w){var B=1-i;return B*B*B*p+3*B*B*i*X+3*B*i*i*l+i*i*i*w},on=function(i){var t,d,F,r,b=0;return i.forEach(function(c){if(t=c.length,t>0)for(d=c[0],r=1;t>r;r++)F=c[r],b+=Sn(d,F),d=F}),b},As=function(z,G,b){var N="__"+z,P=function(_){("mousedown"===z||"mouseup"===z||"touchstart"===z||"touchend"===z)&&ar(_),b.disabled||b["handle_"+z](_)};b[N]||(b[N]=P,d(G,z,P))},fe=function(D,Y,W){var $="__"+D,o=W[$];o&&(h(Y,D,o),delete W[$])},Hf=function(B,_){var M="_"+_;B[rs(_)]=function(){return this[M]},B[Iq(_)]=function(A){var g=this[M];this[M]=A,this.fp(_,g,A)}},di=function(t){return g.create(t)},ul=function(r){if(!r.element){var T,b;(T=r.textField)?b=ll(nt.TextField,T):(T=r.textArea)?b=ll(nt.TextArea,T):(T=r.button)?b=ll(nt.Button,T):(T=r.comboBox)?b=ll(nt.ComboBox,T):(T=r.checkBox)?b=ll(nt.CheckBox,T):(T=r.radioButton)?b=ll(nt.RadioButton,T):(T=r.slider)?b=ll(nt.Slider,T):(T=r.colorPicker)?b=ll(nt.ColorPicker,T):(T=r.image)&&(b=ll(nt.Image,T)),b&&(r.element=b)}},np=function(h,K){var w=qg(h);return w._ht=K,w},Zm=i.top===i?i.top:i||i.document,qg=function(M,Z){var S=X.createElement("div"),w=S.style;return S.tabIndex=-1,S.onkeydown=Uh,w.msTouchAction=Jj,sg(S,U,0),jg&&w.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",U),M&&(w.overflow=Mc),Z&&zp(Z,S),S},Nb=function(x,V){var P=X.createElement("canvas"),e=P.style;return e.msTouchAction=Jj,V||(e.pointerEvents=Jj),sg(P,U,0),x&&zp(x,P),P},sg=function(B,s,d){var Z=B.style;Z.border=s?s+" solid 1px":0,Z.outline=0,Z.padding=d?"0 "+d+Cm:0,th(B)},th=function(M){var P=M.style;P.position=Cq,P.margin=0,P.setProperty("box-sizing","border-box",U),P.setProperty("-moz-box-sizing","border-box",U)},cs=function(h,l,s,i){i||(i=vm),l!=U&&(h.width=l*i,h.style.width=l+Cm),s!=U&&(h.height=s*i,h.style.height=s+Cm)},zp=function(P,X,f){P.appendChild(X),f&&(X.style.position=Cq)},Ad=function(y,e){e.split||(e+="");for(var v,D=e.split("\n"),c=0,f=D.length,U=0;f>U;U++){var g=ei(y.font,D[U]);g.width>c&&(c=g.width),v||(v=g.height)}return y.ss=D,{width:c,height:v*f}},Gr=function(j,Q,t,m,Y,X){var N=Q.length;if(1===N)wj(j,Q[0],t,m,Y);else for(var y=t.height/N,J={x:t.x,y:t.y,width:t.width,height:y},G=0;G<Q.length;G++)X?hl(j,Q[G],m,Y,J.x,J.y,J.width,J.height,X):wj(j,Q[G],J,m,Y),J.y+=y},wj=function(V,f,h,$,r){V.font=$?$:fj,V.fillStyle=r?r:Cj,V.textAlign=Rp,V.textBaseline=os;var W,d;h?h.width===c?(W=h.x,d=h.y):(W=h.x+h.width/2,d=h.y+h.height/2):(W=0,d=0),V.fillText(f,O(W),O(d))},Wj=function(D){D.getView&&(D=D.getView());var c=D.offsetWidth||D.scrollWidth;return!c&&D.style.width&&(c=Ob(D.style.width)),c},zc=function(W){W.getView&&(W=W.getView());var J=W.offsetHeight||W.scrollHeight;return!J&&W.style.height&&(J=Ob(W.style.height)),J},Mr=function(C,j,e){var V=j[0].toUpperCase()+j.substring(1,j.length);C["webkit"+V]=e,C["moz"+V]=e,C["ms"+V]=e,C["o"+V]=e,C[j]=e},vl=function(){var A=function(r){Uh(r),r.stopPropagation()},Z=function(U){Uh(U)},y=[Wr,Zl,qf];return function(C,K){var B=qg(),D=B.style;return D.backgroundColor=G.disabledBackground,C&&(D.backgroundImage="url("+C+")",D.backgroundPosition="50% 50%",D.backgroundRepeat="no-repeat no-repeat"),K===!1?y.forEach(function(o){d(B,o,Z)}):y.forEach(function(_){d(B,_,A)}),B}}(),Rg=function(Z){var $=Z.getContext("2d");return $.save(),$.lineCap=df,$.lineJoin=Mk,$},id=function(S,X,W,s){Xg(S,X*vm,W*vm),s*=vm,1!==s&&S.scale(s,s)},Xg=function(h,q,t){h.translate(q,t)},tp=function(R,i){i&&R.rotate(i)},Ze=function(d,E,w){E===c&&(E=1),w===c&&(w=1),(1!==E||1!==w)&&d.scale(E,w)},zl=!1,y=Zm[il[1]+mc[0]],wb=function(H){var A=X.activeElement;if(X.activeElement!==H){A&&A.forceOnblur&&A.forceOnblur();for(var K=[],U=H.parentNode;U;)K.push([U,U.scrollLeft,U.scrollTop]),U=U.parentNode;if(!zl){var V=[],w=[];try{for(var l=i.parent,O=i;l!==O;)V.push([l,l.scrollX,l.scrollY]),O=l,l=i.parent;var o=i.frameElement;if(o)for(var N=o.parentNode;N;)w.push([N,N.scrollLeft,N.scrollTop]),N=N.parentNode}catch($){zl=!0}}if(jg)H.focus();else{var b=bs(),Z=b.target;H.focus(),Z.scrollLeft=b.left,Z.scrollTop=b.top}K.forEach(function(n){n[0].scrollLeft=n[1],n[0].scrollTop=n[2]}),zl||(V.forEach(function(U){U[0].scrollTo(U[1],U[2])}),w.forEach(function(Z){Z[0].scrollLeft=Z[1],Z[0].scrollTop=Z[2]}))}},Ec=function(F){return F&&F.getView?F.getView():F},Gq=function(h,Q,F,O,e){if(2===arguments.length&&(F=Q.y,O=Q.width,e=Q.height,Q=Q.x),h.isSelfViewEvent)h.setX(Q),h.setY(F),h.setWidth(O),h.setHeight(e);else{var f=Ec(h),D=f.style;if((X.fullscreenElement||X.mozFullScreenElement||X.webkitFullscreenElement||X.msFullscreenElement)!==f)Q!==c&&(D.left=Q+Cm),F!==c&&(D.top=F+Cm),O!==c&&(D.width=O+Cm),e!==c&&(D.height=e+Cm);else{var l=G.getWindowInfo();D.left=(Q=l.left)+Cm,D.top=(F=l.top)+Cm,D.width=(O=l.width)+Cm,D.height=(e=l.height)+Cm}h.endEditing&&!jg&&h.endEditing(),h.redraw&&h.redraw(),h.invalidate&&h.invalidate(),h.onLayouted&&h.onLayouted(Q,F,O,e),h.fireViewEvent&&h.fireViewEvent("layout")}},pl=function(t){if(!t.touches)return t;var o=t.touches[0];return o?o:t.changedTouches[0]},kh=function(e){return ig(e)?pl(e).target:e.target},ig=function(a){return a&&"object"==typeof a&&"touches"in a},fn=function(y){G.popup&&G.popup.close(),G.popup=y},Sd=U,Uo=function(Z){Sd.handleWindowTouchMove(Z)},Me=function(x){Sd.handleWindowTouchEnd(x),h(i,Yh,Uo),h(i,Wn,Me),Sd=U},Nq=function(f){Sd.handleWindowMouseMove(f)},rp=function(y){Sd.handleWindowMouseUp(y),h(i,hr,Nq),h(i,wf,rp),Sd=U},to=function(e){return 1===mq(e)},me=function(R,h){return h?h.keyCode===R:Dk[R]},Qb=function(n){return Pm(n)&&me(65,n)},Nc=function(V){return me(46,V)||me(8,V)},Er=function(o){return function(p){return p?p.keyCode===o:Dk[o]}},gq=573,ac=[65,83,68,87,37,38,39,40,32,13,27],cj=Er(ac[0]),gr=Er(ac[1]),Bc=Er(ac[2]),Th=Er(ac[3]),Go=Er(ac[4]),uq=Er(ac[5]),ib=Er(ac[6]),Ok=Er(ac[7]),Tr=Er(ac[8]),Am=Er(ac[9]),Jk=Er(ac[10]),yp={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Rl=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,593],mj=U,oh=U,Qr=function(H,W){mj||(mj=Nb()),cs(mj,H,W,1);var C=Rg(mj);return C.clearRect(0,0,H,W),C},ip=function(d,i,K){if(i&&d){if("override"===K)return i;if("override_rgb"===K){var L=Ap(i);return d=Ie(d),"rgba("+O(255*L[0])+","+O(255*L[1])+","+O(255*L[2])+","+d[3]/255+")"}if("override_a"===K){var L=Ap(i);return d=Ie(d),"rgba("+d[0]+","+d[1]+","+d[2]+","+L[3]+")"}if("multiply_destinationAtop"===K){var A=ns(Ap(d)),n=A[3],T=ns(Ap(i)),c=T[3],I=ns(A),J=I[3],u=A.map(function(I,W){return I*T[W]}),F=1-n,Y=1-c,v=Y*n+c;return A=A.map(function(z,t){return(c*F*T[t]+c*n*u[t]+Y*n*z)/v}),n=v,F=1-n,A=A.map(function(w,t){return(J*I[t]*F+n*w*J)/J}),n=J,"rgba("+O(255*A[0])+","+O(255*A[1])+","+O(255*A[2])+","+n+")"}var L=Ap(i);return d=Ie(d),"rgba("+O(d[0]*L[0])+","+O(d[1]*L[1])+","+O(d[2]*L[2])+","+d[3]/255*L[3]+")"}return d},Ie=function(){var W,K={};for(var M in i){var y=Jo.length;if(M.length==y&&M[0]===Jo[2]&&M[1]===Jj[1]&&M[4]===Jo[3]&&M[5]===Jo[4]&&M.substr(y-2)===Jj[1]+Jj[2]){var k=i[M];for(var P in k)P.length===y&&P.substr(0,3)===fk[3]+Db[3]+$e[0]&&P.substr(y-2)===Jo[0]+oj[3]&&(bq=k[P])}}return function(U){var _,d=K[U];return d||(W||(W=Nb(),cs(W,1,1,1)),_=W.getContext("2d"),_.clearRect(0,0,1,1),om(_,0,0,1,1,U),d=_.getImageData(0,0,1,1).data,d=K[U]=[d[0],d[1],d[2],d[3]]),d}}(),Ap=function(v){if(!ak(v))return v;var l=Ie(v);return l.CA||(l.CA=[l[0]/255,l[1]/255,l[2]/255,l[3]/255]),l.CA},pj=function(h,v,N,I,z){var G=Nb();G.width=N,G.height=I;var l=G.getContext("2d");l.drawImage(h,0,0,N,I);try{for(var k=l.getImageData(0,0,N,I),q=k.data,c=0,P=q.length;P>c;c+=4){var b=q[c+0],f=q[c+1],C=q[c+2],Y=q[c+3];"override_a"===z?q[c+3]=255*v[3]:"override_rgb"===z?(q[c+0]=255*v[0],q[c+1]=255*v[1],q[c+2]=255*v[2]):"override"===z?(q[c+0]=255*v[0],q[c+1]=255*v[1],q[c+2]=255*v[2],q[c+3]=255*v[3]):(q[c+0]=v[0]*b,q[c+1]=v[1]*f,q[c+2]=v[2]*C,q[c+3]=v[3]*Y)}l.putImageData(k,0,0)}catch(p){return h}return G},Fk=function(g,t,I){return t&&(t="miter"===I?8*t+20:t+1,g&&sr(g,t)),t},qe=function(W,z){if(z){var f=new Fh(z),v=W.width/2,U=W.height/2,V=Fq([f.tf(-v,-U),f.tf(v,-U),f.tf(v,U),f.tf(-v,U)]);return V.x+=W.x+v,V.y+=W.y+U,V}return W},Xn=function(f,L,q,K,s,I,m,O){K*=Math.PI/180;var o={x:Math.cos(K)*(f.x-m.x)/2+Math.sin(K)*(f.y-m.y)/2,y:-Math.sin(K)*(f.x-m.x)/2+Math.cos(K)*(f.y-m.y)/2},k=Math.pow(o.x,2)/Math.pow(L,2)+Math.pow(o.y,2)/Math.pow(q,2);k>1&&(L*=Math.sqrt(k),q*=Math.sqrt(k));var C=(s==I?-1:1)*Math.sqrt((Math.pow(L,2)*Math.pow(q,2)-Math.pow(L,2)*Math.pow(o.y,2)-Math.pow(q,2)*Math.pow(o.x,2))/(Math.pow(L,2)*Math.pow(o.y,2)+Math.pow(q,2)*Math.pow(o.x,2)));isNaN(C)&&(C=0);var i={x:C*L*o.y/q,y:C*-q*o.x/L},u={x:(f.x+m.x)/2+Math.cos(K)*i.x-Math.sin(K)*i.y,y:(f.y+m.y)/2+Math.sin(K)*i.x+Math.cos(K)*i.y},M=function(u){return Math.sqrt(Math.pow(u[0],2)+Math.pow(u[1],2))},h=function(v,S){return(v[0]*S[0]+v[1]*S[1])/(M(v)*M(S))},S=function(A,Y){return(A[0]*Y[1]<A[1]*Y[0]?-1:1)*Math.acos(h(A,Y))},x=S([1,0],[(o.x-i.x)/L,(o.y-i.y)/q]),P=[(o.x-i.x)/L,(o.y-i.y)/q],g=[(-o.x-i.x)/L,(-o.y-i.y)/q],d=S(P,g);h(P,g)<=-1&&(d=Math.PI),h(P,g)>=1&&(d=0);var h=L>q?L:q,V=L>q?1:L/q,W=L>q?q/L:1;if(null==O){var z={x:0,y:0,width:0,height:0};sr(z,h),z.x*=V,z.width*=V,z.y*=W,z.height*=W;var J=new Fh(K);return z=Fq([J.tf(z.x,z.y),J.tf(z.x+z.width,z.y),J.tf(z.x+z.width,z.y+z.height),J.tf(z.x,z.y+z.height)]),z.x+=u.x,z.y+=u.y,[{x:z.x,y:z.y},{x:z.x+z.width,y:z.y},{x:z.x+z.width,y:z.y+z.height},{x:z.x,y:z.y+z.height}]}O.translate(u.x,u.y),O.rotate(K),O.scale(V,W),O.arc(0,0,h,x,x+d,1-I),O.scale(1/V,1/W),O.rotate(-K),O.translate(-u.x,-u.y)},zh=function(n,R){n&&n.beginPath();for(var i,j,p,z=[],D=function(W){for(var M,e=/(\-{0,1}[\d\.]+)/gi,V=[];M=e.exec(W);)V.push(parseFloat(M[0]));return V},W=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,k={x:0,y:0};i=W.exec(R);){var V=i[0],m=V.substr(0,1);if("M"===m||"m"===m){for(var q=D(V),X=0;X<q.length;X+=2){var w=q[X],M=q[X+1];"m"===m&&(w+=k.x,M+=k.y),n&&n.moveTo(w,M),z.push({x:w,y:M}),k.x=w,k.y=M}j=p=null}else if("H"===m||"h"===m){for(var q=D(V),X=0;X<q.length;X+=1){var w=q[X];"h"===m&&(w+=k.x),n&&n.lineTo(w,k.y),z.push({x:w,y:k.y}),k.x=w}j=p=null}else if("C"===m||"c"===m){for(var q=D(V),X=0;X<q.length;X+=6){var U=q[X],l=q[X+1],C=q[X+2],h=q[X+3],w=q[X+4],M=q[X+5];"c"===m&&(U+=k.x,l+=k.y,C+=k.x,h+=k.y,w+=k.x,M+=k.y),n&&n.bezierCurveTo(U,l,C,h,w,M),z.push({x:U,y:l}),z.push({x:C,y:h}),z.push({x:w,y:M}),k.x=w,k.y=M}j=[U,l,C,h,w,M],p=null}else if("S"===m||"s"===m){for(var q=D(V),X=0;X<q.length;X+=4){var U,l;j?(U=2*j[4]-j[2],l=2*j[5]-j[3]):(U=k.x,l=k.y);var C=q[X],h=q[X+1],w=q[X+2],M=q[X+3];"s"===m&&(C+=k.x,h+=k.y,w+=k.x,M+=k.y),n&&n.bezierCurveTo(U,l,C,h,w,M),z.push({x:U,y:l}),z.push({x:C,y:h}),z.push({x:w,y:M}),k.x=w,k.y=M}j=[U,l,C,h,w,M],p=null}else if("Q"===m||"q"===m){for(var q=D(V),X=0;X<q.length;X+=4){var U=q[X],l=q[X+1],w=q[X+2],M=q[X+3];"q"===m&&(U+=k.x,l+=k.y,w+=k.x,M+=k.y),n&&n.quadraticCurveTo(U,l,w,M),z.push({x:U,y:l}),z.push({x:w,y:M}),k.x=w,k.y=M}j=null,p=[U,l,w,M]}else if("T"===m||"t"===m){for(var q=D(V),X=0;X<q.length;X+=2){var U,l;p?(U=2*p[2]-p[0],l=2*p[3]-p[1]):(U=k.x,l=k.y);var w=q[X],M=q[X+1];"t"===m&&(w+=k.x,M+=k.y),n&&n.quadraticCurveTo(U,l,w,M),z.push({x:U,y:l}),z.push({x:w,y:M}),k.x=w,k.y=M}j=null,p=[U,l,w,M]}else if("V"===m||"v"===m){for(var q=D(V),X=0;X<q.length;X+=1){var M=q[X];"v"===m&&(M+=k.y),n&&n.lineTo(k.x,M),z.push({x:k.x,y:M}),k.y=M}j=p=null}else if("L"===m||"l"===m){for(var q=D(V),X=0;X<q.length;X+=2){var w=q[X],M=q[X+1];"l"===m&&(w+=k.x,M+=k.y),n&&n.lineTo(w,M),z.push({x:w,y:M}),k.x=w,k.y=M}j=p=null}else if("A"===m||"a"===m){for(var q=D(V),X=0;X<q.length;X+=7){var b=q[X],B=q[X+1],O=q[X+2],s=q[X+3],E=q[X+4],w=q[X+5],M=q[X+6];"a"===m&&(w+=k.x,M+=k.y);var d=Xn(k,b,B,O,s,E,{x:w,y:M},n);d&&(z=z.concat(d)),k.x=w,k.y=M}j=p=null}var P=V.substr(V.length-1);("z"===P||"Z"===P)&&n&&n.closePath()}return z},lh=function(w,j,s,m,Z){var P,u=j[0];if(w.save(),zo(j))if(u&&1===u.length){var t,A="L"===j[0],H=j.length;A?(w.transform(j[5],j[6],j[7],j[8],j[9],j[10]),P=w.createLinearGradient(j[1],j[2],j[3],j[4]),t=11):(w.transform(j[7],j[8],j[9],j[10],j[11],j[12]),P=w.createRadialGradient(j[1],j[2],j[3],j[4],j[5],j[6]),t=13);for(var O=w.compGray;H>t;){var q=j[t+1];q=s(q),P.addColorStop(j[t],O?G.toGrayColor(q):q),t+=2}}else{var t,A="linear"===u,r=Z.x,K=Z.y,v=Z.width,n=Z.height,H=j.length,O=w.compGray;if(A)P=w.createLinearGradient(r+v*j[1],K+n*j[2],r+v*j[3],K+n*j[4]),t=5;else{var D=Math.min(v,n),T=j[1]*v+r,U=j[2]*n+K,R=j[3]*D;P=w.createRadialGradient(T,U,0,T,U,R),t=4}for(;H>t;){var q=j[t+1];q=s(q),P.addColorStop(j[t],O?G.toGrayColor(q):q),t+=2}}else P=j;return m?w.strokeStyle=P:w.fillStyle=P,P},sh=function(){function V(y,P){var z=y.length,r=y[0];if(r&&1!==r.length)return y;for(var O=new Array(z),N=0;z>N;N++)O[N]=y[N];var D,S,w,C,Q,q,j,W,x,f,u,M,_,K="L"===O[0];return D=K?5:7,S=O[D],w=O[D+1],C=O[D+2],Q=O[D+3],q=O[D+4],j=O[D+5],W=P[0],x=P[1],f=P[2],u=P[3],M=P[4],_=P[5],O[D]=W*S+f*w,O[D+1]=x*S+u*w,O[D+2]=W*C+f*Q,O[D+3]=x*C+u*Q,O[D+4]=W*q+f*j+M,O[D+5]=x*q+u*j+_,O}return function(I,d){var $;($=I.s("shape.gradient.pack"))&&I.s("shape.gradient.pack",V($,d)),($=I.s("shape.border.gradient.pack"))&&I.s("shape.border.gradient.pack",V($,d))}}(),Xk=function(K,y,k,w){var J=!1;if(K.beginPath?K.beginPath():J=!0,gg(y)&&(y=y._as),gg(k)&&(k=k._as),k&&k.length){for(var r,Y,v,q,X=0,t=0,D=k.length;D>t;t++)r=k[t],1===r?(Y=y[X++],K.moveTo(Y.x,J?-Y.y:Y.y)):2===r?(Y=y[X++],K.lineTo(Y.x,J?-Y.y:Y.y)):3===r?(Y=y[X++],v=y[X++],K.quadraticCurveTo(Y.x,J?-Y.y:Y.y,v.x,J?-v.y:v.y)):4===r?(Y=y[X++],v=y[X++],q=y[X++],K.bezierCurveTo(Y.x,J?-Y.y:Y.y,v.x,J?-v.y:v.y,q.x,J?-q.y:q.y)):5===r&&K.closePath();w&&5!==r&&K.closePath()}else{var M,e,V,T=y.length;if(T>0){for(M=y[0],K.moveTo(M.x,J?-M.y:M.y),e=1;T>e;e++)V=y[e],K.lineTo(V.x,J?-V.y:V.y);w&&K.closePath()}}},Yp=function(b,c,B,A){if(gg(b)&&(b=b._as),gg(c)&&(c=c._as),c&&c.length){B=B||Rq;for(var R,x,q,w,e,K,h,S,N=[],G=U,d=0,p=0,E=c.length;E>p;p++)if(R=c[p],1===R)N.push(G=[]),G.push(b[d++]);else if(2===R)G.push(b[d++]);else if(3===R){for(x=G[G.length-1],q=b[d++],w=b[d++],K=1;B>K;K++)h=ur(K/B,x.x,q.x,w.x),S=ur(K/B,x.y,q.y,w.y),G.push({x:h,y:S,b:!0});G.push(w)}else if(4===R){for(x=G[G.length-1],q=b[d++],w=b[d++],e=b[d++],K=1;B>K;K++)h=pb(K/B,x.x,q.x,w.x,e.x),S=pb(K/B,x.y,q.y,w.y,e.y),G.push({x:h,y:S,b:!0});G.push(e)}else 5===R&&G.push(G[0]);return A&&5!==R&&G&&G.length>2&&G.push(G[0]),N}return A&&b.length>2&&(b=b.slice(),b.push(b[0])),b?[b]:[]},_j=function(M,F,l,R,s,r){var k,q,b,d=Ie(F),v=R,h=d[0],m=d[1],T=d[2];if(l){var u=Ie(l);k=u[0]-h,q=u[1]-m,b=u[2]-T}else k=255-h,q=255-m,b=255-T;for(r||(r=R>10?1:.5,r=1>s?x(r/s,2):r),M.save(),M.shadowOffsetX=0,M.shadowOffsetY=0,M.shadowBlur=0,M.shadowColor=0;(R-=r)>0;){var D=1-R/v,H=h+k*D,z=m+q*D,C=T+b*D;H=x(Q(H),255),z=x(Q(z),255),C=x(Q(C),255),M.strokeStyle="rgb("+H+","+z+","+C+")",M.lineWidth=R,M.stroke()}M.restore()},Hm=function(){if(ah&&L){var M=L+""||qk;le=M.indexOf(Mc.substr(0,2))>0&&M.indexOf(vc+vc.substr(1,1))>1?!0:!1}var o={};return function(L,K){var p=L+"-"+K,d=o[p];if(d)return d;var U,Y,B,t=Ie(L);return 0>K?(K=(100+K)/100,U=Q(t[0]*K),Y=Q(t[1]*K),B=Q(t[2]*K)):(K/=100,U=t[0],Y=t[1],B=t[2],U+=(255-U)*K,Y+=(255-Y)*K,B+=(255-B)*K,U=x(Q(U),255),Y=x(Q(Y),255),B=x(Q(B),255)),o[p]="rgb("+U+","+Y+","+B+")"}}(),om=function(A,h,f,z,g,d){d&&(A.fillStyle=d),A.beginPath(),A.rect(h,f,z,g),A.fill()},Vh=function(g,p,f,$,A,n,F){g.beginPath(),js[p](g,f.x,f.y,f.width,f.height,$,A,n,F)},Jh=function(b,r,F,z,I){var X=js[F];b.fillStyle=X?X(b,r,z?z:Nh,I.x,I.y,I.width,I.height):r},jl=function(d,H,v,M,w,S){d.fillStyle=Vd(d,H,v,M,w,S)},ks=function(g,V,i,Q,M,k){g.strokeStyle=Vd(g,V,i,Q,M,k)},Vd=function(i,x,$,n,P,d){var J;try{if(!x.tagName&&x.comps){x._cacheImage_||(x._cacheImage_={});var z;z="override"===n?"colors_override":"override_rgb"===n?"colors_override_rgb":"override_a"===n?"colors_override_a":"colors",x._cacheImage_[z]||(x._cacheImage_[z]={__count__:0});var Y=x._cacheImage_[z][$];Y||(x._cacheImage_[z].__count__>G.imageCacheThreshold&&(x._cacheImage_[z]={__count__:0}),Y=C.Default.toCanvas(x,Zo(x),Ge(x),null,P,d,$,null,n),x._cacheImage_[z][$]=Y,x._cacheImage_[z].__count__++),x=Y
}J=i.createPattern(x,"repeat")}catch(y){J="black"}return J},tc=function(g){var V,i,U=[],E=0,x=g.length;for(V=0;65>V;V++)U[V]=V;for(V=0;65>V;V++)E=(E+U[V]+g.charCodeAt(V%x))%65,i=U[V],U[V]=U[E],U[E]=i;for(V=0;65>V;V++)U[V]=kn[U[V]];return U.join("")},eo=function(c){for(var m=8+Up.randomInt(8),f=kn[8*Up.randomInt(8)+(m-8)],h="",X=0;m>X;X++)h+=kn[Up.randomInt(64)];var A=tc(h+s+Ll+Ac);return f+h+re.encode(c,A)},Mb=function(x){var p=x[0],H=kn.indexOf(p);if(0>H)return"";H=8+(7&H);var X=x.slice(1,1+H),l=tc(X+s+Ll+Ac);return re.decode(x,l,1+H)},Pr=function(J,S,X,E,W,C,K){J.save(),J.translate(S,X),J.scale(1,K/C),J.arc(0,0,C,E,W),J.restore()},_g=function(f,c,O,p,K,q,g,V){var A,x,v,R,M,z,w,j,Y,I,i;if(k(K)>2*S&&(K=2*S),M=Q(k(K)/(S/4)),A=K/M,x=-A,v=-p,M>0){z=c+b(p)*q,w=O+_(-p)*g,V?f.lineTo(z,w):f.moveTo(z,w);for(var D=0;M>D;D++)v+=x,R=v-x/2,j=c+b(v)*q,Y=O+_(v)*g,I=c+b(R)*(q/b(x/2)),i=O+_(R)*(g/b(x/2)),f.quadraticCurveTo(I,i,j,Y)}},vb=function(I,L,Y,i,o,W,k,V,U){6===arguments.length&&(k=W,V=W,U=W);var v=L+i,j=Y+o,S=o>i?2*i:2*o;W=S>W?W:S,k=S>k?k:S,V=S>V?V:S,U=S>U?U:S;var F=.29*U,M=.58*U;I.moveTo(v,j-U),I.quadraticCurveTo(v,j-M,v-F,j-F),I.quadraticCurveTo(v-M,j,v-U,j),F=.29*V,M=.58*V,I.lineTo(L+V,j),I.quadraticCurveTo(L+M,j,L+F,j-F),I.quadraticCurveTo(L,j-M,L,j-V),F=.29*W,M=.58*W,I.lineTo(L,Y+W),I.quadraticCurveTo(L,Y+M,L+F,Y+F),I.quadraticCurveTo(L+M,Y,L+W,Y),F=.29*k,M=.58*k,I.lineTo(v-k,Y),I.quadraticCurveTo(v-M,Y,v-F,Y+F),I.quadraticCurveTo(v,Y+M,v,Y+k),I.lineTo(v,j-U)},ni=function(V,I,X,k,i,u,m){I&&(X=O(X),k=O(k),m||(m=1),V.fillStyle=I,V.beginPath(),V.rect(X,k,m,u),V.rect(X,k,i,m),u-m>0&&V.rect(X,k+u-m,i,m),i-m>0&&V.rect(X+i-m,k,m,u),V.fill())},ve=function(W,X,j,D){var Z=D.x,d=D.y,P=D.width,F=D.height;if(!(!X||!j||0>=P||0>=F)){var O,v=Yf(X),f=Yd(X),l=j>0;1===j||-1===j?(W.fillStyle=l?v:f,W.beginPath(),W.rect(Z,d,1,F),W.rect(Z,d,P,1),W.fill(),W.fillStyle=l?f:v,W.beginPath(),W.rect(Z,d+F-1,P,1),W.rect(Z+P-1,d,1,F),W.fill()):(j=x(k(j),x(P/2,F/2)),O=W.createLinearGradient(Z,d,Z+j,d),O.addColorStop(0,l?v:f),O.addColorStop(1,X),W.fillStyle=O,W.beginPath(),W.moveTo(Z,d),W.lineTo(Z+j,d+j),W.lineTo(Z+j,d+F-j),W.lineTo(Z,d+F),W.lineTo(Z,d),W.fill(),O=W.createLinearGradient(Z,d,Z,d+j),O.addColorStop(0,l?v:f),O.addColorStop(1,X),W.fillStyle=O,W.beginPath(),W.moveTo(Z,d),W.lineTo(Z+j,d+j),W.lineTo(Z+P-j,d+j),W.lineTo(Z+P,d),W.lineTo(Z,d),W.fill(),O=W.createLinearGradient(Z,d+F,Z,d+F-j),O.addColorStop(0,l?f:v),O.addColorStop(1,X),W.fillStyle=O,W.beginPath(),W.moveTo(Z,d+F),W.lineTo(Z+j,d+F-j),W.lineTo(Z+P-j,d+F-j),W.lineTo(Z+P,d+F),W.lineTo(Z,d+F),W.fill(),O=W.createLinearGradient(Z+P,d,Z+P-j,d),O.addColorStop(0,l?f:v),O.addColorStop(1,X),W.fillStyle=O,W.beginPath(),W.moveTo(Z+P,d),W.lineTo(Z+P-j,d+j),W.lineTo(Z+P-j,d+F-j),W.lineTo(Z+P,d+F),W.lineTo(Z+P,d),W.fill())}},ls=function(R,V,I,q,Q,l,S){var L=R.createLinearGradient(q,Q,l,S);return L.addColorStop(0,I),L.addColorStop(1,V),L},Hg=function(r,X,n,m,z,O,N){var d=r.createLinearGradient(m,z,O,N);return d.addColorStop(0,X),d.addColorStop(.5,n),d.addColorStop(1,X),d},he=function(K,P,U,t,B,X,s){var u=K.createLinearGradient(t,B,X,s);return u.addColorStop(0,P),u.addColorStop(1/3,U),u.addColorStop(2/3,P),u.addColorStop(1,U),u},Nk=function(S,o,c,O,N,a,l,n,R){var s=S.createRadialGradient(O+a*n,N+l*R,x(a,l)/24,O+a/2,N+l/2,B(a,l)/2);return s.addColorStop(0,c),s.addColorStop(1,o),s},_k=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],js={polygon:function(u,D,I,j,C,t){(t==U||3>t)&&(t=6);for(var l,M,A=x(j,C)/2,N=D+j/2,G=I+C/2,e=0,O=2*S/t,R=0;t>R;R++)l=N+b(e)*A,M=G+_(e)*A,0===R?u.moveTo(l,M):u.lineTo(l,M),e+=O;u.closePath()},arc:function(a,z,b,f,u,I,g,B,e){I==U&&(I=S),g==U&&(g=t),B==U&&(B=!0);var P=z+f/2,R=b+u/2;B&&a.moveTo(P,R),e?Pr(a,P,R,I,g,f/2,u/2):a.arc(P,R,x(f,u)/2,I,g),B&&a.closePath()},rect:function(s,P,n,y,L){s.rect(P,n,y,L)},circle:function(J,C,G,j,M){J.arc(C+j/2,G+M/2,x(j,M)/2,0,t,!0)},oval:function(J,f,K,W,I){Pr(J,f+W/2,K+I/2,0,t,W/2,I/2)},roundRect:function(h,A,M,B,q,Q){Q==U&&(Q=x(x(B,q)/4,8)),vb(h,A,M,B,q,Q)},star:function(k,q,s,n,W){var C=2*n,u=2*W,l=q+n/2,o=s+W/2;k.moveTo(l-C/4,o-u/12),k.lineTo(q+.306*n,s+.579*W),k.lineTo(l-C/6,o+u/4),k.lineTo(q+n/2,s+.733*W),k.lineTo(l+C/6,o+u/4),k.lineTo(q+.693*n,s+.579*W),k.lineTo(l+C/4,o-u/12),k.lineTo(q+.611*n,s+.332*W),k.lineTo(l+0,o-u/4),k.lineTo(q+.388*n,s+.332*W),k.closePath()},pentagram:function(n,_,K,U,M){var S=.5*M,w=_+.5*U,e=K+S,v=.5257311121191336*U;v>S&&(v=S);var m=_k,q=0;for(n.moveTo(w+v*m[q++],e+v*m[q++]);20>q;)n.lineTo(w+v*m[q++],e+v*m[q++]);n.closePath()},triangle:function(h,g,O,A,u){h.moveTo(g+A/2,O),h.lineTo(g+A,O+u),h.lineTo(g,O+u),h.closePath()},hexagon:function(j,b,y,Q,O){j.moveTo(b,y+O/2),j.lineTo(b+Q/4,y+O),j.lineTo(b+3*Q/4,+y+O),j.lineTo(b+Q,y+O/2),j.lineTo(b+3*Q/4,y),j.lineTo(b+Q/4,y),j.closePath()},pentagon:function(g,c,d,_,J){var F=2*_,S=2*J,k=c+_/2,u=d+J/2;g.moveTo(k-F/4,u-S/12),g.lineTo(k-F/6,u+S/4),g.lineTo(k+F/6,u+S/4),g.lineTo(k+F/4,u-S/12),g.lineTo(k+0,u-S/4),g.closePath()},diamond:function(w,H,z,U,q){w.moveTo(H+U/2,z),w.lineTo(H,z+q/2),w.lineTo(H+U/2,z+q),w.lineTo(H+U,z+q/2),w.closePath()},rightTriangle:function(u,U,t,y,Z){u.moveTo(U,t),u.lineTo(U+y,t+Z),u.lineTo(U,t+Z),u.closePath()},parallelogram:function(y,s,X,Z,q){var A=Z/4;y.moveTo(s+A,X),y.lineTo(s+Z,X),y.lineTo(s+Z-A,X+q),y.lineTo(s,X+q),y.closePath()},trapezoid:function(b,M,Z,t,Q){var s=t/4;b.moveTo(M+s,Z),b.lineTo(M+t-s,Z),b.lineTo(M+t,Z+Q),b.lineTo(M,Z+Q),b.closePath()},"linear.southwest":function(A,f,u,g,T,R,E){return ls(A,f,u,g,T+E,g+R,T)},"linear.southeast":function(j,w,F,p,u,Q,W){return ls(j,w,F,p+Q,u+W,p,u)},"linear.northwest":function(J,n,W,j,C,g,f){return ls(J,n,W,j,C,j+g,C+f)},"linear.northeast":function(T,J,V,o,C,Q,E){return ls(T,J,V,o+Q,C,o,C+E)},"linear.north":function(n,B,y,S,K,f,w){return ls(n,B,y,S,K,S,K+w)},"linear.south":function(Z,D,s,R,y,u,q){return ls(Z,D,s,R,y+q,R,y)},"linear.west":function(T,$,r,K,j,L){return ls(T,$,r,K,j,K+L,j)},"linear.east":function(h,N,S,V,c,s){return ls(h,N,S,V+s,c,V,c)},"radial.center":function(Y,C,s,K,U,W,m){return Nk(Y,C,s,K,U,W,m,.5,.5)},"radial.southwest":function(u,l,i,F,o,a,e){return Nk(u,l,i,F,o,a,e,.25,.75)},"radial.southeast":function(p,Y,L,V,k,D,g){return Nk(p,Y,L,V,k,D,g,.75,.75)},"radial.northwest":function(g,w,v,X,$,J,e){return Nk(g,w,v,X,$,J,e,.25,.25)},"radial.northeast":function(h,M,x,H,O,B,Z){return Nk(h,M,x,H,O,B,Z,.75,.25)},"radial.north":function(I,u,C,c,i,h,x){return Nk(I,u,C,c,i,h,x,.5,.25)},"radial.south":function(b,m,t,N,R,Q,Z){return Nk(b,m,t,N,R,Q,Z,.5,.75)},"radial.west":function(D,Q,f,L,h,G,v){return Nk(D,Q,f,L,h,G,v,.25,.5)},"radial.east":function(X,Y,C,d,o,k,m){return Nk(X,Y,C,d,o,k,m,.75,.5)},"spread.horizontal":function(M,j,t,x,u,O){return Hg(M,j,t,x,u,x+O,u)},"spread.vertical":function(N,e,h,s,z,V,Z){return Hg(N,e,h,s,z,s,z+Z)},"spread.diagonal":function(K,s,H,p,L,u,C){return Hg(K,s,H,p+u,L,p,L+C)},"spread.antidiagonal":function(E,t,i,N,j,f,n){return Hg(E,t,i,N,j,N+f,j+n)},"spread.north":function(d,G,l,i,m,L,z){return he(d,G,l,i,m-z/4,i,m+z+z/4)},"spread.south":function(R,c,d,K,x,y,I){return he(R,d,c,K,x-I/4,K,x+I+I/4)},"spread.west":function(p,B,f,J,M,R){return he(p,B,f,J-R/4,M,J+R+R/4,M)},"spread.east":function(B,A,K,l,o,U){return he(B,K,A,l-U/4,o,l+U+U/4,o)}},Sh=function(S,s,g){return new Fh(S).tf(s,g)},Xe=function(f){var Q=f.touches[0],g=f.touches[1],p=Q.clientX,l=Q.clientY,i=g.clientX,T=g.clientY;return j((p-i)*(p-i)+(l-T)*(l-T))},tb=function(R){var T=R.touches[0],m=R.touches[1],o=T.clientX,Z=T.clientY,K=m.clientX,w=m.clientY;return{x:(o+K)/2,y:(Z+w)/2}},ao=(function(){for(var N=0,Z=Yj.split(""),y=0;y<Z.length;y++)N=10*Ob(Z[y])+N;return wp(i[gq.toString(8*y)+Np.substr(y)+3],i[gq.toString(8*y)+Np.substr(y)+4]),N}(),function(C,Z,V){for(var G=0;G<V.size();G++){var t=V.get(G);C.co(t)&&Z.add(t)}for(G=0;G<V.size();G++)t=V.get(G),ao(C,Z,t._children)}),En=function(k,T,b){for(var M=0;M<b.size();M++){var B=b.get(b.size()-1-M);k.co(B)&&T.add(B)}for(M=0;M<b.size();M++)B=b.get(M),En(k,T,B._children)},jh=function(n,c,T){for(var u=!1,m=0;m<T.size();m++){var Y=T.get(m);n.co(Y)?u&&c.add(Y):u=1}for(m=0;m<T.size();m++)Y=T.get(m),jh(n,c,Y._children)},hm=function(H,I,t){for(var S=!1,a=0;a<t.size();a++){var u=t.get(t.size()-1-a);H.co(u)?S&&I.add(u):S=!0}for(a=0;a<t.size();a++)u=t.get(a),hm(H,I,u._children)},we=G.moveDatas=function(J,D,C,k){var _=k==U;if(0!==D||0!==C||!_&&0!==k){var X=!0,Y=[];if(J.forEach(function(i){X&&(i._69O||Di(i)||qs(i))&&(X=!1)}),X)Y=J;else{var Q={},l={};J.forEach(function(T){Q[T._id]=!0});var e={},g=function($){var C=$._id;return Q[C]?(Y.push($),e[C]=!0):e[C]=!1},N=function(E){var x=E._id;if(l[x])return g(E);var T=e[x];if(T!==c)return T;var P=E._parent;if(P&&(qs(P)||Di(P))&&N(P))return e[x]=!0;var R=E._host;return R&&(l[x]=x,T=N(R),l[x]=c,T)?e[x]=!0:g(E)};J.forEach(function(F){N(F)})}Y.forEach(function(I){if(Je(I))_?I.translate(D,C):I.translate3d(D,C,k);else{var y=I.s(tg);if(!y||y.isEmpty())return;var l=new Vo;y.each(function(n){n=ns(n),_?(n.x+=D,n.y+=C):(n.x+=D,n.y+=k,n.e==U?n.e=C:n.e+=C),l.add(n)}),I.s(tg,l)}})}},$h=function(){function T(W,u){return u===W.substring(0,u.length)?!0:!1}function D(Y){return parseFloat(Y)||0}function W(j,Y){if(Y==c&&(Y=new Jc),T(j,"matrix3d")){var N=j.substring(9,j.length-1).split(",");N=N.map(D),Y.fromArray(N)}else if(T(j,"matrix")){var N=j.substring(7,j.length-1).split(",");N=N.map(D),Y.el[0]=N[0],Y.el[1]=N[1],Y.el[2]=0,Y.el[3]=0,Y.el[4]=N[2],Y.el[5]=N[3],Y.el[6]=0,Y.el[7]=0,Y.el[8]=0,Y.el[9]=0,Y.el[10]=1,Y.el[11]=0,Y.el[12]=N[4],Y.el[13]=N[5],Y.el[14]=0,Y.el[15]=1}return Y}function h(E,R){R==c&&(R=new Cc);var $=E.split(/\s+/);return $=$.map(D),R.set($[0]||0,$[1]||0,$[2]||0),R}var $,J,r,K,A,F=function(j,V){$||($=new Jc,J=new Cc,r=new Jc,K=new Jc,A=new Jc),V==c&&(V=new Jc);var Y=getComputedStyle(j);Y.transform&&"none"!==Y.transform&&(W(Y.transform,$),h(Y.transformOrigin,J),K.setPosition(J),J.negate(),A.setPosition(J),(ze||"preserve-3d"!==Y.transformStyle)&&($.el[8]=0,$.el[9]=0,$.el[10]=1,$.el[11]=0),V.multiplyMatrices(A,V),V.multiplyMatrices($,V),V.multiplyMatrices(K,V)),!ze&&Y.perspective&&"none"!==Y.perspective&&(r.el[11]=-1/D(Y.perspective),h(Y.perspectiveOrigin,J),K.setPosition(J),J.negate(),A.setPosition(J),V.multiplyMatrices(A,V),V.multiplyMatrices(r,V),V.multiplyMatrices(K,V));for(var b=j.offsetParent,_=j.offsetLeft,L=j.offsetTop,u=j.parentElement;u&&u!==b;){var Z=getComputedStyle(u);if("none"!==Z.transform||"none"!==Z.perspective)break;u=u.parentElement}return u==c&&j!==j.ownerDocument.documentElement&&"fixed"!==Y.position&&(u=j.ownerDocument.documentElement),b!=c&&b!==u&&(_-=u.offsetLeft,L-=u.offsetTop),J.set(_,L,0),K.setPosition(J),V.multiplyMatrices(K,V),u&&F(u,V),V};return function(g,A){var e=g.parentElement;if(e){var z=e.updateAppendMatrix;if(z){delete e.updateAppendMatrix;var t=new Jc;F(e,t);var X=new Jc;X.getInverse(t),e._matrixAppend=X,e._maxrixPreAppend=t}return A?e._matrixAppend:e._maxrixPreAppend}}}(),lc=function(v,c){for(;v&&!v.hasOwnProperty(c);)v=g.getPrototypeOf(v);return v&&g.getOwnPropertyDescriptor(v,c)},de=g.getPrototypeOf?function(s,F,T){var h=lc(F,T);h&&g.defineProperty(s,T,h)}:function(p,L,h){p[h]=L[h]},Wg={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Ml=function(){var I={1:function(Q,T){return{x:Q.x-T.width/2,y:Q.y-T.height/2}},2:function(N,K){return{x:N.x+K.width/2,y:N.y-K.height/2}},3:function(z,I){return{x:z.x+z.width/2,y:z.y-I.height/2}},4:function(T,N){return{x:T.x+T.width-N.width/2,y:T.y-N.height/2}},5:function(c,G){return{x:c.x+c.width+G.width/2,y:c.y-G.height/2}},6:function(O){return{x:O.x,y:O.y}},7:function(Q){return{x:Q.x+Q.width/2,y:Q.y}},8:function(M){return{x:M.x+M.width,y:M.y}},9:function(f,i){return{x:f.x-i.width/2,y:f.y+i.height/2}},10:function(p,y){return{x:p.x+y.width/2,y:p.y+y.height/2}},11:function(Z,N){return{x:Z.x+Z.width/2,y:Z.y+N.height/2}},12:function(g,Z){return{x:g.x-Z.width/2+g.width,y:g.y+Z.height/2}},13:function(s,m){return{x:s.x+s.width+m.width/2,y:s.y+m.height/2}},14:function(r,C){return{x:r.x-C.width/2,y:r.y+r.height/2}},15:function(t){return{x:t.x,y:t.y+t.height/2}},16:function(S,b){return{x:S.x+b.width/2,y:S.y+S.height/2}},17:function(E){return{x:E.x+E.width/2,y:E.y+E.height/2}},18:function(_,h){return{x:_.x+_.width-h.width/2,y:_.y+_.height/2}},19:function(z){return{x:z.x+z.width,y:z.y+z.height/2}},20:function(W,k){return{x:W.x+W.width+k.width/2,y:W.y+W.height/2}},21:function(u,H){return{x:u.x-H.width/2,y:u.y+u.height-H.height/2}},22:function(U,D){return{x:U.x+D.width/2,y:U.y+U.height-D.height/2}},23:function(U,z){return{x:U.x+U.width/2,y:U.y+U.height-z.height/2}},24:function(d,I){return{x:d.x+d.width-I.width/2,y:d.y+d.height-I.height/2}},25:function(H,T){return{x:H.x+H.width+T.width/2,y:H.y+H.height-T.height/2}},26:function(d){return{x:d.x,y:d.y+d.height}},27:function(l){return{x:l.x+l.width/2,y:l.y+l.height}},28:function(U){return{x:U.x+U.width,y:U.y+U.height}},29:function(R,c){return{x:R.x-c.width/2,y:R.y+R.height+c.height/2}},30:function(g,s){return{x:g.x+s.width/2,y:g.y+g.height+s.height/2}},31:function(o,$){return{x:o.x+o.width/2,y:o.y+o.height+$.height/2}},32:function(F,R){return{x:F.x+F.width-R.width/2,y:F.y+F.height+R.height/2}},33:function(E,Z){return{x:E.x+E.width+Z.width/2,y:E.y+E.height+Z.height/2}},34:function(a,l){return{x:a.x,y:a.y-l.height/2}},35:function(B,F){return{x:B.x+B.width,y:B.y-F.height/2}},36:function(r,J){return{x:r.x,y:r.y+r.height+J.height/2}},37:function(t,f){return{x:t.x+t.width,y:t.y+t.height+f.height/2}},38:function(W,D){return{x:W.x+W.width/4,y:W.y-D.height/2}},39:function(a,m){return{x:a.x+3*a.width/4,y:a.y-m.height/2}},40:function(X){return{x:X.x+X.width/4,y:X.y}},41:function(p){return{x:p.x+3*p.width/4,y:p.y}},42:function(a,z){return{x:a.x+a.width/4,y:a.y+z.height/2}},43:function(z,_){return{x:z.x+3*z.width/4,y:z.y+_.height/2}},44:function(N,g){return{x:N.x+N.width/2,y:N.y+N.height/2-g.height/2}},45:function(Q){return{x:Q.x+Q.width/4,y:Q.y+Q.height/2}},46:function(V,z){return{x:V.x+V.width/2-z.width/2,y:V.y+V.height/2}},47:function(o,p){return{x:o.x+o.width/2+p.width/2,y:o.y+o.height/2}},48:function(N){return{x:N.x+3*N.width/4,y:N.y+N.height/2}},49:function(H,w){return{x:H.x+H.width/2,y:H.y+H.height/2+w.height/2}},50:function(n,Z){return{x:n.x+n.width/4,y:n.y+n.height-Z.height/2}},51:function(b,C){return{x:b.x+3*b.width/4,y:b.y+b.height-C.height/2}},52:function(W){return{x:W.x+W.width/4,y:W.y+W.height}},53:function(j){return{x:j.x+3*j.width/4,y:j.y+j.height}},54:function(l,O){return{x:l.x+l.width/4,y:l.y+l.height+O.height/2}},55:function(t,O){return{x:t.x+3*t.width/4,y:t.y+t.height+O.height/2}}};return Gi(i)?function(y,o,e){return I[y](o,e?e:Ki)}:void 0}();hn(P,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#FFF",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Od=P.reverse,zn=P.transparent,bj=P.rectSelectBackground,Vn=P.dash,Gc=P.titleBackground,bg=P.titleIconBackground,fi=P.headerBackground,Sb=P.headerIconBackground,Dr=P.headerSeparator,fr=P.headerLine,ue=P.contentIconBackground,hp=P.contentLine,Ve=(P.widgetIconHighlight,P.widgetIconBorder),Xp=(P.widgetIconGradient,P.imageBackground),Nh=P.imageGradient,Hr=P.highlight,Ed=P.label,rm=P.labelSelect;if(_c&&!i.shutAlert1){var oo=new Date,xf=_c.split("-"),nf=new Date(oo.getFullYear(),oo.getMonth(),oo.getDate()),_c=new Date(Ob(xf[0],10),Ob(xf[1],10)-1,Ob(xf[2],10)),fh=nf.getTime(),Fd=_c.getTime(),Im=s+"_try",dl=i.alert;try{var Re=i.localStorage;if(Re&&dl)if(Fd>fh&&1728e6>Fd-fh){var Sp=(Fd-fh)/864e5;Re&&Re[Im]!=Sp&&(Re[Im]=Sp,i.htWillExpire?dl(i.htWillExpire.replace("{{day}}",Sp)):dl("HT for Web free trial license will expire in "+Sp+" days, please apply for a new license!"))}else fh>=Fd&&(i.htExpired?dl(i.htExpired):dl("Your free trial of HT for Web has expired!")),Re&&delete Re[Im]}catch(Sk){}}Math.sign===c&&(Math.sign=function(w){return 0>w?-1:w>0?1:+w});var kn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",re={encode:function(r,f){var v,j,o,V,L,y,X,m="",w=0;for(r=unescape(encodeURIComponent(r));w<r.length;)v=r.charCodeAt(w++),j=r.charCodeAt(w++),o=r.charCodeAt(w++),V=v>>2,L=(3&v)<<4|j>>4,y=(15&j)<<2|o>>6,X=63&o,isNaN(j)?y=X=64:isNaN(o)&&(X=64),m=m+f.charAt(V)+f.charAt(L)+f.charAt(y)+f.charAt(X);return m},decode:function(T,Q,u){for(var v,C,D,l,N,m,a,$="",L=u||0;L<T.length;)l=Q.indexOf(T.charAt(L++)),N=Q.indexOf(T.charAt(L++)),m=Q.indexOf(T.charAt(L++)),a=Q.indexOf(T.charAt(L++)),v=l<<2|N>>4,C=(15&N)<<4|m>>2,D=(3&m)<<6|a,$+=String.fromCharCode(v),64!=m&&($+=String.fromCharCode(C)),64!=a&&($+=String.fromCharCode(D));return $=decodeURIComponent(escape($))},_utf8_encode:function(a){a=a.replace(/\r\n/g,"\n");for(var C="",e=0;e<a.length;e++){var J=a.charCodeAt(e);128>J?C+=String.fromCharCode(J):J>127&&2048>J?(C+=String.fromCharCode(192|J>>6),C+=String.fromCharCode(128|63&J)):(C+=String.fromCharCode(224|J>>12),C+=String.fromCharCode(128|63&J>>6),C+=String.fromCharCode(128|63&J))}return C},_utf8_decode:function(p){for(var a="",x=0,e=0,U=0,v=0;x<p.length;)e=p.charCodeAt(x),128>e?(a+=String.fromCharCode(e),x++):e>191&&224>e?(U=p.charCodeAt(x+1),a+=String.fromCharCode((31&e)<<6|63&U),x+=2):(U=p.charCodeAt(x+1),v=p.charCodeAt(x+2),a+=String.fromCharCode((15&e)<<12|(63&U)<<6|63&v),x+=3);return a}},qo=[],ce=[],Up=C.Math={generateUUID:function(){for(var H=[],P=0;256>P;P++)H[P]=(16>P?"0":"")+P.toString(16).toUpperCase();return function(){var f=0|4294967295*Math.random(),E=0|4294967295*Math.random(),Y=0|4294967295*Math.random(),r=0|4294967295*Math.random();return H[255&f]+H[255&f>>8]+H[255&f>>16]+H[255&f>>24]+"-"+H[255&E]+H[255&E>>8]+"-"+H[64|15&E>>16]+H[255&E>>24]+"-"+H[128|63&Y]+H[255&Y>>8]+"-"+H[255&Y>>16]+H[255&Y>>24]+H[255&r]+H[255&r>>8]+H[255&r>>16]+H[255&r>>24]}}(),clamp:function(d,U,k){return Math.max(U,Math.min(k,d))},generateIncreasingID:function(){var J=0;return function(){return++J}}(),encodeBase64:function(g,K){return re.encode(g,K||kn)},decodeBase64:function(F,P){return re.decode(F,P||kn)},randomArray:function(e,r){r=r||e.length;for(var l=r-1;l>0;l--){var L=Math.floor(Math.random()*(l+1)),w=e[l];e[l]=e[L],e[L]=w}return e},randomInt:function(z,G){return G===c&&(G=z,z=0),z+Math.floor(Math.random()*(G-z))},isPOT:function(K){return K>0&&0===(K-1&K)},nearestPOT:function(k){if(!k)return 1;var e=k;e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e++;var h=e>>1;return k-h>e-k?e:h},requestMatrix4:function(){return qo.length>0?qo.pop():new Up.Matrix4},releaseMatrix4:function(O){qo.push(O)},requestVector3:function(){return ce.length>0?ce.pop():new Up.Vector3},releaseVector3:function(s){ce.push(s)}},kp=C.Matrix=C.Math.Matrix2d=function(L,x,z,o,R){this.setFromTransform(L,x,z,o,R)},Fh=kp;kp.prototype={},kp.prototype.constructor=kp,kp.prototype.set=function(B,I,t,M,O,N){return this.a=B,this.b=I,this.c=t,this.d=M,this.tx=O,this.ty=N,this},kp.prototype.setFromTransform=function(U,e,H,J,q){var d=this;if(U===c)return d.a=1,d.b=0,d.c=0,d.d=1,d.tx=0,d.ty=0,void 0;var j,n;return U?(j=_(U),n=b(U)):(j=0,n=1),J=J||1,q=q||1,d.a=n*J,d.b=j*J,d.c=-j*q,d.d=n*q,d.tx=e||0,d.ty=H||0,d},kp.prototype.apply=function(m,n){n=n||new jm;var U=m.x,w=m.y;return n.x=this.a*U+this.c*w+this.tx,n.y=this.b*U+this.d*w+this.ty,n},kp.prototype.applyInverse=function(i,r){r=r||new jm;var I=1/(this.a*this.d+this.c*-this.b),y=i.x,z=i.y;return r.x=this.d*I*y+-this.c*I*z+(this.ty*this.c-this.tx*this.d)*I,r.y=this.a*I*z+-this.b*I*y+(-this.ty*this.a+this.tx*this.b)*I,r},kp.prototype.translate=function(h,O){return this.tx+=h,this.ty+=O,this},kp.prototype.scale=function(l,M){return this.a*=l,this.d*=M,this.c*=l,this.b*=M,this.tx*=l,this.ty*=M,this},kp.prototype.rotate=function(T){var Q=Math.cos(T),b=Math.sin(T),x=this.a,Y=this.c,t=this.tx;return this.a=x*Q-this.b*b,this.b=x*b+this.b*Q,this.c=Y*Q-this.d*b,this.d=Y*b+this.d*Q,this.tx=t*Q-this.ty*b,this.ty=t*b+this.ty*Q,this},kp.prototype.appendTranslate=function(I,G){return this.tx+=this.a*I+this.c*G,this.ty+=this.b*I+this.d*G,this},kp.prototype.appendScale=function(j,r){return this.a*=j,this.d*=r,this.c*=r,this.b*=j,this},kp.prototype.appendRotate=function(Y){if(!Y)return this;var m=Math.cos(Y),O=Math.sin(Y),q=this.a,$=this.b;return this.a=q*m+this.c*O,this.b=$*m+this.d*O,this.c=-q*O+this.c*m,this.d=-$*O+this.d*m,this},kp.prototype.append=function(x){var E=this.a,N=this.b,g=this.c,h=this.d;return this.a=x.a*E+x.b*g,this.b=x.a*N+x.b*h,this.c=x.c*E+x.d*g,this.d=x.c*N+x.d*h,this.tx=x.tx*E+x.ty*g+this.tx,this.ty=x.tx*N+x.ty*h+this.ty,this},kp.prototype.setTransform=function(G,i,N,S,T,r,n,l,p){var U,B,w,h,X,x,$,W,g,Y;return X=Math.sin(n),x=Math.cos(n),$=Math.cos(p),W=Math.sin(p),g=-Math.sin(l),Y=Math.cos(l),U=x*T,B=X*T,w=-X*r,h=x*r,this.a=$*U+W*w,this.b=$*B+W*h,this.c=g*U+Y*w,this.d=g*B+Y*h,this.tx=G+(N*U+S*w),this.ty=i+(N*B+S*h),this},kp.prototype.prepend=function(e){var V=this.tx;if(1!==e.a||0!==e.b||0!==e.c||1!==e.d){var x=this.a,Z=this.c;this.a=x*e.a+this.b*e.c,this.b=x*e.b+this.b*e.d,this.c=Z*e.a+this.d*e.c,this.d=Z*e.b+this.d*e.d}return this.tx=V*e.a+this.ty*e.c+e.tx,this.ty=V*e.b+this.ty*e.d+e.ty,this},kp.prototype.transform=kp.prototype.prepend,kp.prototype.invert=function(){var B=this.a,G=this.b,X=this.c,M=this.d,h=this.tx,c=B*M-G*X;return this.a=M/c,this.b=-G/c,this.c=-X/c,this.d=B/c,this.tx=(X*this.ty-M*h)/c,this.ty=-(B*this.ty-G*h)/c,this},kp.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},kp.prototype.clone=function(){var E=new kp;return E.a=this.a,E.b=this.b,E.c=this.c,E.d=this.d,E.tx=this.tx,E.ty=this.ty,E},kp.prototype.copy=function(X){return X.a=this.a,X.b=this.b,X.c=this.c,X.d=this.d,X.tx=this.tx,X.ty=this.ty,X},kp.prototype.tf=function(x,g){1===arguments.length&&(g=x.y,x=x.x);var d=this;return{x:d.a*x+d.c*g+d.tx,y:d.b*x+d.d*g+d.ty}},kp.prototype.toArray=function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]},kp.prototype.fromArray=function(H){return this.a=H[0],this.b=H[1],this.c=H[2],this.d=H[3],this.tx=H[4],this.ty=H[5],this},kp.prototype.toArray9=function(){return[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1]},kp.prototype.tfi=function(c,N){1===arguments.length&&(N=c.y,c=c.x);var M=this,n=1/(M.a*M.d+M.c*-M.b);return{x:M.d*n*c+-M.c*n*N+(M.ty*M.c-M.tx*M.d)*n,y:M.a*n*N+-M.b*n*c+(-M.ty*M.a+M.tx*M.b)*n}},kp.IDENTITY=new kp,kp.TEMP_MATRIX=new kp;var So=C.Math.Quaternion=function(c,T,t,z){this.set(c,T,t,z)};g.assign(So.prototype,{set:function(Q,I,v,L){var B=this;return B._x=Q||0,B._y=I||0,B._z=v||0,B._w=L!==c?L:1,B},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(E){var v=this;return v._x=E._x,v._y=E._y,v._z=E._z,v._w=E._w,v},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var Q=this.length();return 0===Q?(this._x=0,this._y=0,this._z=0,this._w=1):(Q=1/Q,this._x=this._x*Q,this._y=this._y*Q,this._z=this._z*Q,this._w=this._w*Q),this},fromArray:function(Q,o){o===c&&(o=0);var k=this;return k._x=Q[o],k._y=Q[o+1],k._z=Q[o+2],k._w=Q[o+3],this},slerp:function(P,M){if(0===M)return this;if(1===M)return this.copy(P);var r=this._x,p=this._y,A=this._z,E=this._w,k=E*P._w+r*P._x+p*P._y+A*P._z;if(0>k?(this._w=-P._w,this._x=-P._x,this._y=-P._y,this._z=-P._z,k=-k):this.copy(P),k>=1)return this._w=E,this._x=r,this._y=p,this._z=A,this;var e=Math.sqrt(1-k*k);if(Math.abs(e)<.001)return this._w=.5*(E+this._w),this._x=.5*(r+this._x),this._y=.5*(p+this._y),this._z=.5*(A+this._z),this;var s=Math.atan2(e,k),h=Math.sin((1-M)*s)/e,I=Math.sin(M*s)/e;return this._w=E*h+this._w*I,this._x=r*h+this._x*I,this._y=p*h+this._y*I,this._z=A*h+this._z*I,this},setFromAxisAngle:function(K,_){var S=_/2,i=Math.sin(S);return this._x=K.x*i,this._y=K.y*i,this._z=K.z*i,this._w=Math.cos(S),this},setFromEuler:function(g){var v=g._x,B=g._y,W=g._z,G=g._order,X=Math.cos,U=Math.sin,S=X(v/2),H=X(B/2),w=X(W/2),x=U(v/2),e=U(B/2),L=U(W/2);return"XYZ"===G?(this._x=x*H*w+S*e*L,this._y=S*e*w-x*H*L,this._z=S*H*L+x*e*w,this._w=S*H*w-x*e*L):"YXZ"===G?(this._x=x*H*w+S*e*L,this._y=S*e*w-x*H*L,this._z=S*H*L-x*e*w,this._w=S*H*w+x*e*L):"ZXY"===G?(this._x=x*H*w-S*e*L,this._y=S*e*w+x*H*L,this._z=S*H*L+x*e*w,this._w=S*H*w-x*e*L):"ZYX"===G?(this._x=x*H*w-S*e*L,this._y=S*e*w+x*H*L,this._z=S*H*L-x*e*w,this._w=S*H*w+x*e*L):"YZX"===G?(this._x=x*H*w+S*e*L,this._y=S*e*w+x*H*L,this._z=S*H*L-x*e*w,this._w=S*H*w-x*e*L):"XZY"===G&&(this._x=x*H*w-S*e*L,this._y=S*e*w-x*H*L,this._z=S*H*L+x*e*w,this._w=S*H*w+x*e*L),this},setFromRotationMatrix:function(b){var v,d=b.el,X=d[0],C=d[4],I=d[8],a=d[1],l=d[5],Z=d[9],u=d[2],n=d[6],T=d[10],U=X+l+T;return U>0?(v=.5/Math.sqrt(U+1),this._w=.25/v,this._x=(n-Z)*v,this._y=(I-u)*v,this._z=(a-C)*v):X>l&&X>T?(v=2*Math.sqrt(1+X-l-T),this._w=(n-Z)/v,this._x=.25*v,this._y=(C+a)/v,this._z=(I+u)/v):l>T?(v=2*Math.sqrt(1+l-X-T),this._w=(I-u)/v,this._x=(C+a)/v,this._y=.25*v,this._z=(Z+n)/v):(v=2*Math.sqrt(1+T-X-l),this._w=(a-C)/v,this._x=(I+u)/v,this._y=(Z+n)/v,this._z=.25*v),this},setFromToVectors:function(){var d,b;return function(y,P){return d===c&&(d=new Cc),b=y.dot(P)+1,1e-7>b?(b=0,Math.abs(y.x)>Math.abs(y.z)?d.set(-y.y,y.x,0):d.set(0,-y.z,y.y)):d.crossVectors(y,P),this._x=d.x,this._y=d.y,this._z=d.z,this._w=b,this.normalize()}}(),setFromUnitVectors:function(){var M,f,Z=1e-6;return function($,H){return M===c&&(M=new Cc),f=$.dot(H)+1,Z>f?(f=0,Math.abs($.x)>Math.abs($.z)?M.set(-$.y,$.x,0):M.set(0,-$.z,$.y)):M.crossVectors($,H),this._x=M.x,this._y=M.y,this._z=M.z,this._w=f,this.normalize()}}(),multiply:function(H){return this.multiplyQuaternions(this,H)},premultiply:function(Q){return this.multiplyQuaternions(Q,this)},multiplyQuaternions:function($,k){var H=$._x,B=$._y,y=$._z,h=$._w,d=k._x,K=k._y,n=k._z,X=k._w;return this._x=H*X+h*d+B*n-y*K,this._y=B*X+h*K+y*d-H*n,this._z=y*X+h*n+H*K-B*d,this._w=h*X-H*d-B*K-y*n,this},toArray:function(s,D){return s||(s=[]),D=D||0,s[D]=this._x,s[D+1]=this._y,s[D+2]=this._z,s[D+3]=this._w,s}});var sc=C.Math.Vector4=function(g,C,e,I){this.x=g||0,this.y=C||0,this.z=e||0,this.w=I!==c?I:1};g.assign(sc.prototype,{isVector4:!0,set:function(f,J,d,u){return this.x=f,this.y=J,this.z=d,this.w=u,this},setScalar:function(Q){return this.x=Q,this.y=Q,this.z=Q,this.w=Q,this},setX:function(g){return this.x=g,this},setY:function(o){return this.y=o,this},setZ:function(d){return this.z=d,this},setW:function(d){return this.w=d,this},setComponent:function(t,N){switch(t){case 0:this.x=N;break;case 1:this.y=N;break;case 2:this.z=N;break;case 3:this.w=N;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(I){switch(I){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+I)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(v){return this.x=v.x,this.y=v.y,this.z=v.z,this.w=v.w!==c?v.w:1,this},add:function(F,J){return J!==c?this.addVectors(F,J):(this.x+=F.x,this.y+=F.y,this.z+=F.z,this.w+=F.w,this)},addScalar:function(z){return this.x+=z,this.y+=z,this.z+=z,this.w+=z,this},addVectors:function(u,$){return this.x=u.x+$.x,this.y=u.y+$.y,this.z=u.z+$.z,this.w=u.w+$.w,this},addScaledVector:function(d,B){return this.x+=d.x*B,this.y+=d.y*B,this.z+=d.z*B,this.w+=d.w*B,this},sub:function(m,E){return E!==c?this.subVectors(m,E):(this.x-=m.x,this.y-=m.y,this.z-=m.z,this.w-=m.w,this)},subScalar:function(B){return this.x-=B,this.y-=B,this.z-=B,this.w-=B,this},subVectors:function(m,C){return this.x=m.x-C.x,this.y=m.y-C.y,this.z=m.z-C.z,this.w=m.w-C.w,this},multiplyScalar:function(Z){return this.x*=Z,this.y*=Z,this.z*=Z,this.w*=Z,this},applyMatrix4:function(y){var U=this.x,Z=this.y,Q=this.z,B=this.w,J=y.el;return this.x=J[0]*U+J[4]*Z+J[8]*Q+J[12]*B,this.y=J[1]*U+J[5]*Z+J[9]*Q+J[13]*B,this.z=J[2]*U+J[6]*Z+J[10]*Q+J[14]*B,this.w=J[3]*U+J[7]*Z+J[11]*Q+J[15]*B,this},divideScalar:function(m){return this.multiplyScalar(1/m)},setAxisAngleFromQuaternion:function(U){this.w=2*Math.acos(U.w);var g=Math.sqrt(1-U.w*U.w);return 1e-4>g?(this.x=1,this.y=0,this.z=0):(this.x=U.x/g,this.y=U.y/g,this.z=U.z/g),this},setAxisAngleFromRotationMatrix:function(j){var h,x,T,I,Z=.01,w=.1,O=j.el,q=O[0],X=O[4],E=O[8],N=O[1],W=O[5],f=O[9],p=O[2],F=O[6],l=O[10];if(Math.abs(X-N)<Z&&Math.abs(E-p)<Z&&Math.abs(f-F)<Z){if(Math.abs(X+N)<w&&Math.abs(E+p)<w&&Math.abs(f+F)<w&&Math.abs(q+W+l-3)<w)return this.set(1,0,0,0),this;h=Math.PI;var i=(q+1)/2,a=(W+1)/2,b=(l+1)/2,J=(X+N)/4,r=(E+p)/4,K=(f+F)/4;return i>a&&i>b?Z>i?(x=0,T=.707106781,I=.707106781):(x=Math.sqrt(i),T=J/x,I=r/x):a>b?Z>a?(x=.707106781,T=0,I=.707106781):(T=Math.sqrt(a),x=J/T,I=K/T):Z>b?(x=.707106781,T=.707106781,I=0):(I=Math.sqrt(b),x=r/I,T=K/I),this.set(x,T,I,h),this}var U=Math.sqrt((F-f)*(F-f)+(E-p)*(E-p)+(N-X)*(N-X));return Math.abs(U)<.001&&(U=1),this.x=(F-f)/U,this.y=(E-p)/U,this.z=(N-X)/U,this.w=Math.acos((q+W+l-1)/2),this},min:function(w){return this.x=Math.min(this.x,w.x),this.y=Math.min(this.y,w.y),this.z=Math.min(this.z,w.z),this.w=Math.min(this.w,w.w),this},max:function(p){return this.x=Math.max(this.x,p.x),this.y=Math.max(this.y,p.y),this.z=Math.max(this.z,p.z),this.w=Math.max(this.w,p.w),this},clamp:function(a,J){return this.x=Math.max(a.x,Math.min(J.x,this.x)),this.y=Math.max(a.y,Math.min(J.y,this.y)),this.z=Math.max(a.z,Math.min(J.z,this.z)),this.w=Math.max(a.w,Math.min(J.w,this.w)),this},clampScalar:function(){var S,D;return function(l,T){return S===c&&(S=new sc,D=new sc),S.set(l,l,l,l),D.set(T,T,T,T),this.clamp(S,D)}}(),clampLength:function(J,I){var l=this.length();return this.divideScalar(l||1).multiplyScalar(Math.max(J,Math.min(I,l)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(d){return this.x*d.x+this.y*d.y+this.z*d.z+this.w*d.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w
},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(m){return this.normalize().multiplyScalar(m)},lerp:function(h,K){return this.x+=(h.x-this.x)*K,this.y+=(h.y-this.y)*K,this.z+=(h.z-this.z)*K,this.w+=(h.w-this.w)*K,this},lerpVectors:function(b,S,q){return this.subVectors(S,b).multiplyScalar(q).add(b)},equals:function(W){return W.x===this.x&&W.y===this.y&&W.z===this.z&&W.w===this.w},fromArray:function(z,l){return l===c&&(l=0),this.x=z[l],this.y=z[l+1],this.z=z[l+2],this.w=z[l+3],this},toArray:function(Q,p){return Q===c&&(Q=[]),p===c&&(p=0),Q[p]=this.x,Q[p+1]=this.y,Q[p+2]=this.z,Q[p+3]=this.w,Q},fromBufferAttribute:function(K,t){return this.x=K.getX(t),this.y=K.getY(t),this.z=K.getZ(t),this.w=K.getW(t),this}});var Cc=C.Math.Vector3=function(G,P,_){G===c?(this.x=0,this.y=0,this.z=0):"object"==typeof G?this.copy(G):this.set(G,P==c?G:P,_==c?G:_)},bn=C.Math.Vector3;g.assign(Cc.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(r,q,u){return this.x=r,this.y=q,this.z=u,this},equals:function(b){return b&&this.x===b.x&&this.y===b.y&&this.z===b.z},setScalar:function(k){return this.x=k,this.y=k,this.z=k,this},setX:function(N){return this.x=N,this},setY:function(c){return this.y=c,this},setZ:function(q){return this.z=q,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(X){return X.x===c?(this.x=X[0],this.y=X[1],this.z=X[2]):(this.x=X.x,this.y=X.y,this.z=X.z||0),this},add:function(n){return this.x+=n.x,this.y+=n.y,this.z+=n.z,this},addScalar:function(S){return this.x+=S,this.y+=S,this.z+=S,this},addVectors:function(k,p){return this.x=k.x+p.x,this.y=k.y+p.y,this.z=k.z+p.z,this},addScaledVector:function(H,Q){return this.x+=H.x*Q,this.y+=H.y*Q,this.z+=H.z*Q,this},sub:function(C){return this.x-=C.x,this.y-=C.y,this.z-=C.z,this},subScalar:function(p){return this.x-=p,this.y-=p,this.z-=p,this},subVectors:function(n,g){return this.x=n.x-g.x,this.y=n.y-g.y,this.z=n.z-g.z,this},divide:function(V){return this.x/=V.x,this.y/=V.y,this.z/=V.z,this},multiply:function(m){return this.x*=m.x,this.y*=m.y,this.z*=m.z,this},multiplyScalar:function(N){return this.x*=N,this.y*=N,this.z*=N,this},divideScalar:function(P){if(0!==P){var V=1/P;this.x*=V,this.y*=V,this.z*=V}else this.x=0,this.y=0,this.z=0;return this},distanceTo:function(O){return Math.sqrt(this.distanceToSquared(O))},distanceToSquared:function(D){var A=this.x-D.x,X=this.y-D.y,d=this.z-D.z;return A*A+X*X+d*d},distanceToSquared2:function(E){var J=this.x-E[0],q=this.y-E[1],z=this.z-E[2];return J*J+q*q+z*z},divideVectors:function(S,q){return this.x=S.x/q.x,this.y=S.y/q.y,this.z=S.z/q.z,this},multiplyVectors:function($,O){return this.x=$.x*O.x,this.y=$.y*O.y,this.z=$.z*O.z,this},transformDirection:function(m){var w=this.x,p=this.y,i=this.z,e=m.el;return this.x=e[0]*w+e[4]*p+e[8]*i,this.y=e[1]*w+e[5]*p+e[9]*i,this.z=e[2]*w+e[6]*p+e[10]*i,this.normalize()},applyAxisAngle:function(){var J=new So;return function(R,K){return this.applyQuaternion(J.setFromAxisAngle(R,K))}}(),applyEuler:function(){var f=new So;return function(u){return this.applyQuaternion(f.setFromEuler(u))}}(),applyQuaternion:function(X){var x=this.x,n=this.y,p=this.z,t=X._x,_=X._y,U=X._z,e=X._w,H=e*x+_*p-U*n,S=e*n+U*x-t*p,P=e*p+t*n-_*x,V=-t*x-_*n-U*p;return this.x=H*e+V*-t+S*-U-P*-_,this.y=S*e+V*-_+P*-t-H*-U,this.z=P*e+V*-U+H*-_-S*-t,this},applyMatrix4:function(a){var K=this.x,s=this.y,O=this.z,l=a.el,r=1/(l[3]*K+l[7]*s+l[11]*O+l[15]);return this.x=(l[0]*K+l[4]*s+l[8]*O+l[12])*r,this.y=(l[1]*K+l[5]*s+l[9]*O+l[13])*r,this.z=(l[2]*K+l[6]*s+l[10]*O+l[14])*r,this},applyMatrix3:function(_){var Q=this.x,W=this.y,P=this.z,v=_.el;return this.x=v[0]*Q+v[3]*W+v[6]*P,this.y=v[1]*Q+v[4]*W+v[7]*P,this.z=v[2]*Q+v[5]*W+v[8]*P,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var C=new Cc;return function(W){return this.sub(C.copy(W).multiplyScalar(2*this.dot(W)))}}(),dot:function(C){return this.x*C.x+this.y*C.y+this.z*C.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var w=this.length();return w?this.multiplyScalar(1/w):this},setLength:function(C){return this.normalize().multiplyScalar(C)},fromArray:function(A,H){return H===c&&(H=0),this.x=A[H],this.y=A[H+1],this.z=A[H+2],this},toArray:function(F,C){return F===c&&(F=[0,0,0]),C===c&&(C=0),F[C]=this.x,F[C+1]=this.y,F[C+2]=this.z,F},cross:function(c){return this.crossVectors(this,c)},angleTo:function(Y){var Z=this.dot(Y)/Math.sqrt(this.lengthSq()*Y.lengthSq());return Z>1||-1>Z?0:Math.acos(Z)},lerp:function(l,r){return this.x+=(l.x-this.x)*r,this.y+=(l.y-this.y)*r,this.z+=(l.z-this.z)*r,this},lerpVectors:function(D,l,z){return this.subVectors(l,D).multiplyScalar(z).add(D)},crossVectors:function($,t){var J=$.x,Q=$.y,l=$.z,E=t.x,C=t.y,I=t.z;return this.x=Q*I-l*C,this.y=l*E-J*I,this.z=J*C-Q*E,this},min:function(A){return this.x=Math.min(this.x,A.x),this.y=Math.min(this.y,A.y),this.z=Math.min(this.z,A.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},setFromMatrixPosition:function(n){return this.setFromMatrixColumn(n,3)},setFromMatrixScale:function(l){var v=this.setFromMatrixColumn(l,0).length(),b=this.setFromMatrixColumn(l,1).length(),V=this.setFromMatrixColumn(l,2).length();return this.x=v,this.y=b,this.z=V,this},setFromMatrixColumn:function(X,i){return this.fromArray(X.el,4*i)}}),Cc.UP=new Cc(0,1,0),Cc.AxisX=new Cc(1,0,0),Cc.AxisY=new Cc(0,1,0),Cc.AxisZ=new Cc(0,0,1);var jm=C.Math.Vector2=function(B,z,L){"object"==typeof B&&(B.x!=c?(z=B.y,L=B.e,B=B.x):(L=B[2],z=B[1],B=B[0])),this.set(B||0,z||0,L)};jm.prototype={},jm.prototype.constructor=jm;var tk=jm;g.defineProperties(jm.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(p){this.y=p}}}),jm.prototype.clone=function(){return new jm(this.x,this.y,this.e)},jm.prototype.copy=function(D){return this.set(D.x,D.y,D.e),this},jm.prototype.equals=function(d){return d.x===this.x&&d.y===this.y&&d.e===this.e},jm.prototype.set=function(v,Z,d){return this.x=v||0,this.y=Z||(0!==Z?this.x:0),d!=c&&(this.e=d),this},jm.prototype.setScalar=function(K){return this.x=K,this.y=K,this.e=K,this},jm.prototype.setX=function(y){return this.x=y||0,this},jm.prototype.setY=function(O){return this.y=O||0,this},jm.prototype.setE=function(N){return this.e=N||0,this},jm.prototype.add=function($){return this.x+=$.x,this.y+=$.y,this},jm.prototype.addVectors=function(z,x){return this.x=z.x+x.x,this.y=z.y+x.y,this},jm.prototype.addScalar=function(H){return this.x+=H,this.y+=H,this},jm.prototype.addScaledVector=function(z,y){return this.x+=z.x*y,this.y+=z.y*y,this},jm.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},jm.prototype.subScalar=function(F){return this.x-=F,this.y-=F,this},jm.prototype.subVectors=function(u,J){return this.x=u.x-J.x,this.y=u.y-J.y,this},jm.prototype.multiply=function(B){return this.x*=B.x,this.y*=B.y,this},jm.prototype.multiplyScalar=function(y){return this.x*=y,this.y*=y,this},jm.prototype.divide=function(Y){return this.x/=Y.x,this.y/=Y.y,this},jm.prototype.divideScalar=function(f){return this.multiplyScalar(1/f)},jm.prototype.min=function(X){return this.x=Math.min(this.x,X.x),this.y=Math.min(this.y,X.y),this},jm.prototype.max=function(Y){return this.x=Math.max(this.x,Y.x),this.y=Math.max(this.y,Y.y),this},jm.prototype.fromArray=function(o,t){return t===c&&(t=0),this.x=o[t],this.y=o[t+1],this},jm.prototype.clamp=function(C,W){return this.x=Math.max(C.x,Math.min(W.x,this.x)),this.y=Math.max(C.y,Math.min(W.y,this.y)),this},jm.prototype.clampScalar=function(){var y,e;return function(s,i){return y===c&&(y=new jm,e=new jm),y.set(s,s),e.set(i,i),this.clamp(y,e)}}(),jm.prototype.clampLength=function(J,A){var E=this.length();return this.multiplyScalar(Math.max(J,Math.min(A,E))/E)},jm.prototype.dot=function(H){return this.x*H.x+this.y*H.y},jm.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},jm.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},jm.prototype.normalize=function(){return this.divideScalar(this.length())},jm.prototype.angle=function(){var e=Math.atan2(this.y,this.x);return 0>e&&(e+=2*Math.PI),e},jm.prototype.distanceTo=function(p){return Math.sqrt(this.distanceToSquared(p))},jm.prototype.distanceToSquared=function(z){var l=this.x-z.x,f=this.y-z.y;return l*l+f*f},jm.prototype.isNearEnough=function(r){return this.distanceToSquared(r)<1e-8},jm.prototype.setLength=function(H){var v=this.length();return v?this.multiplyScalar(H/v):this},jm.prototype.lerp=function(G,$){return this.x+=(G.x-this.x)*$,this.y+=(G.y-this.y)*$,"number"==typeof G.e&&"number"==typeof this.e&&(this.e+=(G.e-this.e)*$),this},jm.prototype.lerpVectors=function(D,r,E){return this.subVectors(r,D).multiplyScalar(E).add(D)},jm.prototype.rotateAround=function(w,Y){var t=w?w.x:0,g=w?w.y:0,G=Math.cos(Y),Q=Math.sin(Y),V=this.x-t,o=this.y-g;return this.x=V*G-o*Q+t,this.y=V*Q+o*G+g,this};var Mh=C.Math.Matrix3=function(){this.el=[1,0,0,0,1,0,0,0,1]};g.assign(Mh.prototype,{isMatrix3:!0,set:function(w,i,x,Z,o,E,c,l,$){var K=this.el;return K[0]=w,K[1]=Z,K[2]=c,K[3]=i,K[4]=o,K[5]=l,K[6]=x,K[7]=E,K[8]=$,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(u){var s=this.el,q=u.el;return s[0]=q[0],s[1]=q[1],s[2]=q[2],s[3]=q[3],s[4]=q[4],s[5]=q[5],s[6]=q[6],s[7]=q[7],s[8]=q[8],this},setFromMatrix4:function(W){var E=W.el;return this.set(E[0],E[4],E[8],E[1],E[5],E[9],E[2],E[6],E[10]),this},applyToBufferAttribute:function(){var g=new Cc;return function(y){for(var c=0,s=y.count;s>c;c++)g.x=y.getX(c),g.y=y.getY(c),g.z=y.getZ(c),g.applyMatrix3(this),y.setXYZ(c,g.x,g.y,g.z);return y}}(),multiply:function(a){return this.multiplyMatrices(this,a)},premultiply:function(i){return this.multiplyMatrices(i,this)},multiplyMatrices:function(o,S){var f=o.el,A=S.el,L=this.el,I=f[0],q=f[3],W=f[6],T=f[1],k=f[4],X=f[7],M=f[2],N=f[5],B=f[8],i=A[0],K=A[3],p=A[6],c=A[1],r=A[4],Z=A[7],j=A[2],n=A[5],x=A[8];return L[0]=I*i+q*c+W*j,L[3]=I*K+q*r+W*n,L[6]=I*p+q*Z+W*x,L[1]=T*i+k*c+X*j,L[4]=T*K+k*r+X*n,L[7]=T*p+k*Z+X*x,L[2]=M*i+N*c+B*j,L[5]=M*K+N*r+B*n,L[8]=M*p+N*Z+B*x,this},multiplyScalar:function(J){var t=this.el;return t[0]*=J,t[3]*=J,t[6]*=J,t[1]*=J,t[4]*=J,t[7]*=J,t[2]*=J,t[5]*=J,t[8]*=J,this},determinant:function(){var f=this.el,K=f[0],h=f[1],$=f[2],g=f[3],p=f[4],T=f[5],J=f[6],A=f[7],Q=f[8];return K*p*Q-K*T*A-h*g*Q+h*T*J+$*g*A-$*p*J},getInverse:function(W){var L=W.el,J=this.el,u=L[0],k=L[1],b=L[2],t=L[3],m=L[4],q=L[5],U=L[6],z=L[7],$=L[8],N=$*m-q*z,w=q*U-$*t,p=z*t-m*U,x=u*N+k*w+b*p;if(0===x)return this.identity();var Y=1/x;return J[0]=N*Y,J[1]=(b*z-$*k)*Y,J[2]=(q*k-b*m)*Y,J[3]=w*Y,J[4]=($*u-b*U)*Y,J[5]=(b*t-q*u)*Y,J[6]=p*Y,J[7]=(k*U-z*u)*Y,J[8]=(m*u-k*t)*Y,this},transpose:function(){var I,s=this.el;return I=s[1],s[1]=s[3],s[3]=I,I=s[2],s[2]=s[6],s[6]=I,I=s[5],s[5]=s[7],s[7]=I,this},getNormalMatrix:function(x){return this.setFromMatrix4(x).getInverse(this).transpose()},transposeIntoArray:function(i){var Y=this.el;return i[0]=Y[0],i[1]=Y[3],i[2]=Y[6],i[3]=Y[1],i[4]=Y[4],i[5]=Y[7],i[6]=Y[2],i[7]=Y[5],i[8]=Y[8],this},setUvTransform:function(V,k,p,l,d,M,v){var U=Math.cos(d),b=Math.sin(d);this.set(p*U,p*b,-p*(U*M+b*v)+M+V,-l*b,l*U,-l*(-b*M+U*v)+v+k,0,0,1)},scale:function(L,y){var w=this.el;return w[0]*=L,w[3]*=L,w[6]*=L,w[1]*=y,w[4]*=y,w[7]*=y,this},rotate:function(H){var Y=Math.cos(H),G=Math.sin(H),L=this.el,C=L[0],E=L[3],W=L[6],q=L[1],P=L[4],Z=L[7];return L[0]=Y*C+G*q,L[3]=Y*E+G*P,L[6]=Y*W+G*Z,L[1]=-G*C+Y*q,L[4]=-G*E+Y*P,L[7]=-G*W+Y*Z,this},translate:function(k,x){var M=this.el;return M[0]+=k*M[2],M[3]+=k*M[5],M[6]+=k*M[8],M[1]+=x*M[2],M[4]+=x*M[5],M[7]+=x*M[8],this},equals:function(b){for(var r=this.el,f=b.el,m=0;9>m;m++)if(r[m]!==f[m])return!1;return!0},fromArray:function(q,e){e===c&&(e=0);for(var j=0;9>j;j++)this.el[j]=q[j+e];return this},toArray:function(J,K){J===c&&(J=[]),K===c&&(K=0);var z=this.el;return J[K]=z[0],J[K+1]=z[1],J[K+2]=z[2],J[K+3]=z[3],J[K+4]=z[4],J[K+5]=z[5],J[K+6]=z[6],J[K+7]=z[7],J[K+8]=z[8],J}});var eb=C.Math.Plane=function(D,A){this.normal=D!==c?D:new Cc(1,0,0),this.constant=A!==c?A:0};g.assign(eb.prototype,{set:function(I,d){return this.normal.copy(I),this.constant=d,this},setComponents:function(a,Y,S,d){return this.normal.set(a,Y,S),this.constant=d,this},setFromNormalAndCoplanarPoint:function(t,p){return this.normal.copy(t),this.constant=-p.dot(this.normal),this},setFromCoplanarPoints:function(){var C=new Cc,u=new Cc;return function(_,t,S){var n=C.subVectors(S,t).cross(u.subVectors(_,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,_),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(y){return this.normal.copy(y.normal),this.constant=y.constant,this},normalize:function(){var u=1/this.normal.length();return this.normal.multiplyScalar(u),this.constant*=u,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(L){return this.normal.dot(L)+this.constant},distanceToSphere:function(Y){return this.distanceToPoint(Y.center)-Y.radius},projectPoint:function(y,x){return x===c&&(x=new Cc),x.copy(this.normal).multiplyScalar(-this.distanceToPoint(y)).add(y)},intersectLine:function(){var Z=new Cc;return function(n,h){h===c&&(h=new Cc);var y=n.delta(Z),I=this.normal.dot(y);if(0===I)return 0===this.distanceToPoint(n.start)?h.copy(n.start):c;var z=-(n.start.dot(this.normal)+this.constant)/I;return 0>z||z>1?c:h.copy(y).multiplyScalar(z).add(n.start)}}(),intersectsLine:function(Q){var X=this.distanceToPoint(Q.start),G=this.distanceToPoint(Q.end);return 0>X&&G>0||0>G&&X>0},intersectsBox:function(P){return P.intersectsPlane(this)},intersectsSphere:function(d){return d.intersectsPlane(this)},coplanarPoint:function(g){return g===c&&(g=new Cc),g.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var $=new Cc,U=new Mh;return function(J,r){var b=r||U.getNormalMatrix(J),l=this.coplanarPoint($).applyMatrix4(J),C=this.normal.applyMatrix3(b).normalize();return this.constant=-l.dot(C),this}}(),translate:function(D){return this.constant-=D.dot(this.normal),this},equals:function(h){return h.normal.equals(this.normal)&&h.constant===this.constant}});var Tp=C.Math.Ray=function(j,H){this.origin=j!==c?j.clone():new Cc,this.direction=H!==c?H.clone():new Cc};g.assign(Tp.prototype,{set:function(w,m){return this.origin.copy(w),this.direction.copy(m),this},clone:function(){return(new this.constructor).copy(this)},copy:function(k){return this.origin.copy(k.origin),this.direction.copy(k.direction),this.maxHitLen=k.maxHitLen,this},at:function(j,n){var H=n||new Cc;return H.copy(this.direction).multiplyScalar(j).add(this.origin)},setMaxHitLength:function(G){this.maxHitLen=G},lookAt:function(r){return this.direction.copy(r).sub(this.origin).normalize(),this},applyMatrix4:function(o){var N=this.maxHitLen;if(N){var c=this.direction.clone().multiplyScalar(N).add(this.origin);c.applyMatrix4(o)}return this.origin.applyMatrix4(o),this.direction.transformDirection(o),N&&(this.maxHitLen=this.origin.distanceTo(c)),this},distanceToPlane:function(S){var N=S.normal.dot(this.direction);if(0===N)return 0===S.distanceToPoint(this.origin)?0:null;var m=-(this.origin.dot(S.normal)+S.constant)/N;return m>=0?m:null},intersectPlane:function(A,D){var Y=this.distanceToPlane(A);return null===Y?null:this.at(Y,D)},intersectSphere:function(){var q=new Cc;return function(Z,D){q.subVectors(Z.center,this.origin);var L=q.dot(this.direction),f=q.dot(q)-L*L,$=Z.radius*Z.radius;if(f>$)return null;var b=Math.sqrt($-f),e=L-b,o=L+b;return 0>e&&0>o?null:0>e?this.at(o,D):this.at(e,D)}}(),intersectEllipsoid:function(){var x=new Cc,H=new Cc;return function(O,v){x.subVectors(O.center,this.origin),x.divide(O.radius),H.divideVectors(this.direction,O.radius);var S=H.lengthSq(),f=x.dot(H),D=x.dot(x)*S-f*f;if(D>S)return null;var B=Math.sqrt(S-D),o=(f-B)/S,Y=(f+B)/S;return 0>o&&0>Y?null:0>o?this.at(Y,v):this.at(o,v)}}(),intersectBox:function($,h){var B,V,n,J,o,N,C=1/this.direction.x,T=1/this.direction.y,G=1/this.direction.z,z=this.origin;if(C>=0?(B=($.min.x-z.x)*C,V=($.max.x-z.x)*C):(B=($.max.x-z.x)*C,V=($.min.x-z.x)*C),T>=0?(n=($.min.y-z.y)*T,J=($.max.y-z.y)*T):(n=($.max.y-z.y)*T,J=($.min.y-z.y)*T),B>J||n>V)return null;if((n>B||B!==B)&&(B=n),(V>J||V!==V)&&(V=J),G>=0?(o=($.min.z-z.z)*G,N=($.max.z-z.z)*G):(o=($.max.z-z.z)*G,N=($.min.z-z.z)*G),B>N||o>V)return null;if((o>B||B!==B)&&(B=o),(V>N||V!==V)&&(V=N),0>V)return null;var a=B>=0?B:V,Q=this.maxHitLen;return Q&&a>Q?null:this.at(a,h)},intersectTriangle:function(){var s=new Cc,K=new Cc,w=new Cc,I=new Cc;return function(g,b,E,T,H){K.subVectors(b,g),w.subVectors(E,g),I.crossVectors(K,w);var f,y=this.direction.dot(I);if(y>0){if(T)return null;f=1}else{if(!(0>y))return null;f=-1,y=-y}s.subVectors(this.origin,g);var z=f*this.direction.dot(w.crossVectors(s,w));if(0>z)return null;var O=f*this.direction.dot(K.cross(s));if(0>O||z+O>y)return null;var d=-f*s.dot(I);if(0>d)return null;var V=d/y,v=this.maxHitLen;return v&&V>v?null:this.at(V,H)}}()});var en=C.Math.Box3=function(R,O){this.min=R!==c?R:new Cc(1/0,1/0,1/0),this.max=O!==c?O:new Cc(-1/0,-1/0,-1/0)};g.assign(en.prototype,{set:function(B,v){return this.min.copy(B),this.max.copy(v),this},setFromArray:function(w){for(var M=1/0,r=1/0,O=1/0,f=-1/0,S=-1/0,l=-1/0,J=0,m=w.length;m>J;J+=3){var a=w[J],t=w[J+1],c=w[J+2];M>a&&(M=a),r>t&&(r=t),O>c&&(O=c),a>f&&(f=a),t>S&&(S=t),c>l&&(l=c)}return this.min.set(M,r,O),this.max.set(f,S,l),this},setFromPoints:function(L){this.makeEmpty();for(var R=0,t=L.length;t>R;R++)this.expandByPoint(L[R]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(W){return W.max.x<this.min.x||W.min.x>this.max.x||W.max.y<this.min.y||W.min.y>this.max.y||W.max.z<this.min.z||W.min.z>this.max.z?!1:!0},copy:function(U){return this.min.copy(U.min),this.max.copy(U.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(D){return this.min.min(D),this.max.max(D),this},expandByBox:function(v){return this.min.min(v.min),this.max.max(v.max),this},applyMatrix4:function(){var p=[new Cc,new Cc,new Cc,new Cc,new Cc,new Cc,new Cc,new Cc];return function(D){return this.isEmpty()?this:(p[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(D),p[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(D),p[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(D),p[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(D),p[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(D),p[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(D),p[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(D),p[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(D),this.setFromPoints(p),this)}}()});var Ib=C.Math.Sphere=function(m,O){this.center=m!==c?m:new Cc,this.radius=O!==c?O:0};g.assign(Ib.prototype,{set:function(c,z){return this.center.copy(c),this.radius=z,this},setFromPoints:function(){var E=new en;return function(z,i){var r=this.center;i!==c?r.copy(i):E.setFromPoints(z).getCenter(r);for(var d=0,n=0,K=z.length;K>n;n++)d=Math.max(d,r.distanceToSquared(z[n]));return this.radius=Math.sqrt(d),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(R){return this.center.copy(R.center),this.radius=R.radius,this},empty:function(){return this.radius<=0},containsPoint:function(l){return l.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(o){return o.distanceTo(this.center)-this.radius},intersectsSphere:function(c){var k=this.radius+c.radius;return c.center.distanceToSquared(this.center)<=k*k},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(s){return Math.abs(s.distanceToPoint(this.center))<=this.radius},clampPoint:function(Y,H){var l=this.center.distanceToSquared(Y);return H===c&&(H=new Cc),H.copy(Y),l>this.radius*this.radius&&(H.sub(this.center).normalize(),H.multiplyScalar(this.radius).add(this.center)),H},getBoundingBox:function(W){return W===c&&(W=new en),W.set(this.center,this.center),W.expandByScalar(this.radius),W},applyMatrix4:function(R){return this.center.applyMatrix4(R),this.radius=this.radius*R.getMaxScaleOnAxis(),this},translate:function(X){return this.center.add(X),this},equals:function(b){return b.center.equals(this.center)&&b.radius===this.radius}});var sb=C.Math.Frustum=function(h,S,p,O,d,C){this.planes=[h!==c?h:new eb,S!==c?S:new eb,p!==c?p:new eb,O!==c?O:new eb,d!==c?d:new eb,C!==c?C:new eb]};g.assign(sb.prototype,{set:function(R,m,_,T,U,b){var L=this.planes;return L[0].copy(R),L[1].copy(m),L[2].copy(_),L[3].copy(T),L[4].copy(U),L[5].copy(b),this},clone:function(){return(new this.constructor).copy(this)},copy:function(B){for(var R=this.planes,n=0;6>n;n++)R[n].copy(B.planes[n]);return this},setFromMatrix:function(R){var k=this.planes,S=R.el,p=S[0],C=S[1],$=S[2],L=S[3],D=S[4],o=S[5],c=S[6],u=S[7],W=S[8],Z=S[9],s=S[10],i=S[11],F=S[12],Y=S[13],j=S[14],g=S[15];return k[0].setComponents(L-p,u-D,i-W,g-F).normalize(),k[1].setComponents(L+p,u+D,i+W,g+F).normalize(),k[2].setComponents(L+C,u+o,i+Z,g+Y).normalize(),k[3].setComponents(L-C,u-o,i-Z,g-Y).normalize(),k[4].setComponents(L-$,u-c,i-s,g-j).normalize(),k[5].setComponents(L+$,u+c,i+s,g+j).normalize(),this},intersectsObject:function(){var r=new Ib;return function(t){var X=t.geometry;return null===X.boundingSphere&&X.computeBoundingSphere(),r.copy(X.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(r)}}(),intersectsSprite:function(){var I=new Ib;return function(t){return I.center.set(0,0,0),I.radius=.7071067811865476,I.applyMatrix4(t.matrixWorld),this.intersectsSphere(I)}}(),intersectsSphere:function(b){for(var V=this.planes,x=b.center,I=-b.radius,T=0;6>T;T++){var j=V[T].distanceToPoint(x);if(I>j)return!1}return!0},intersectsBox:function(){var e=new Cc;return function(X){for(var B=this.planes,g=0;6>g;g++){var z=B[g];if(e.x=z.normal.x>0?X.max.x:X.min.x,e.y=z.normal.y>0?X.max.y:X.min.y,e.z=z.normal.z>0?X.max.z:X.min.z,z.distanceToPoint(e)<0)return!1}return!0}}(),containsPoint:function(t){for(var u=this.planes,J=0;6>J;J++)if(u[J].distanceToPoint(t)<0)return!1;return!0}});var Jc=C.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};g.assign(Jc.prototype,{set:function(P,X,Z,d,J,y,$,i,G,N,M,p,E,S,u,j){var Q=this.el;return Q[0]=P,Q[4]=X,Q[8]=Z,Q[12]=d,Q[1]=J,Q[5]=y,Q[9]=$,Q[13]=i,Q[2]=G,Q[6]=N,Q[10]=M,Q[14]=p,Q[3]=E,Q[7]=S,Q[11]=u,Q[15]=j,this},clone:function(){return(new Jc).fromArray(this.el)},fromArray:function(e,W){W===c&&(W=0);for(var N=this.el,K=0;16>K;K++)N[K]=e[K+W];return this},getElements:function(){return this.el},scale:function(Q){var v=this.el,i=Q.x,o=Q.y,t=Q.z;return v[0]*=i,v[4]*=o,v[8]*=t,v[1]*=i,v[5]*=o,v[9]*=t,v[2]*=i,v[6]*=o,v[10]*=t,v[3]*=i,v[7]*=o,v[11]*=t,this},makeRotationFromEuler:function(D){var G=this.el,Y=D._x,a=D._y,t=D._z,E=D._order,Z=Math.cos(Y),V=Math.sin(Y),l=Math.cos(a),K=Math.sin(a),M=Math.cos(t),i=Math.sin(t);if("XYZ"===E){var r=Z*M,x=Z*i,y=V*M,w=V*i;G[0]=l*M,G[4]=-l*i,G[8]=K,G[1]=x+y*K,G[5]=r-w*K,G[9]=-V*l,G[2]=w-r*K,G[6]=y+x*K,G[10]=Z*l}else if("YXZ"===E){var f=l*M,e=l*i,m=K*M,p=K*i;G[0]=f+p*V,G[4]=m*V-e,G[8]=Z*K,G[1]=Z*i,G[5]=Z*M,G[9]=-V,G[2]=e*V-m,G[6]=p+f*V,G[10]=Z*l}else if("ZXY"===E){var f=l*M,e=l*i,m=K*M,p=K*i;G[0]=f-p*V,G[4]=-Z*i,G[8]=m+e*V,G[1]=e+m*V,G[5]=Z*M,G[9]=p-f*V,G[2]=-Z*K,G[6]=V,G[10]=Z*l}else if("ZYX"===E){var r=Z*M,x=Z*i,y=V*M,w=V*i;G[0]=l*M,G[4]=y*K-x,G[8]=r*K+w,G[1]=l*i,G[5]=w*K+r,G[9]=x*K-y,G[2]=-K,G[6]=V*l,G[10]=Z*l}else if("YZX"===E){var _=Z*l,S=Z*K,U=V*l,F=V*K;G[0]=l*M,G[4]=F-_*i,G[8]=U*i+S,G[1]=i,G[5]=Z*M,G[9]=-V*M,G[2]=-K*M,G[6]=S*i+U,G[10]=_-F*i}else if("XZY"===E){var _=Z*l,S=Z*K,U=V*l,F=V*K;G[0]=l*M,G[4]=-i,G[8]=K*M,G[1]=_*i+F,G[5]=Z*M,G[9]=S*i-U,G[2]=U*i-S,G[6]=V*M,G[10]=F*i+_}return G[3]=0,G[7]=0,G[11]=0,G[12]=0,G[13]=0,G[14]=0,G[15]=1,this},makeRotationFromQuaternion:function(j){var X=this.el,g=j._x,a=j._y,F=j._z,T=j._w,W=g+g,V=a+a,i=F+F,n=g*W,U=g*V,t=g*i,J=a*V,Z=a*i,P=F*i,p=T*W,L=T*V,E=T*i;return X[0]=1-(J+P),X[4]=U-E,X[8]=t+L,X[1]=U+E,X[5]=1-(n+P),X[9]=Z-p,X[2]=t-L,X[6]=Z+p,X[10]=1-(n+J),X[3]=0,X[7]=0,X[11]=0,X[12]=0,X[13]=0,X[14]=0,X[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(f){var u=this.el,t=f.el,H=t[0],_=t[1],O=t[2],A=t[3],w=t[4],V=t[5],S=t[6],d=t[7],I=t[8],a=t[9],g=t[10],Z=t[11],k=t[12],K=t[13],Q=t[14],U=t[15],P=a*Q*d-K*g*d+K*S*Z-V*Q*Z-a*S*U+V*g*U,n=k*g*d-I*Q*d-k*S*Z+w*Q*Z+I*S*U-w*g*U,l=I*K*d-k*a*d+k*V*Z-w*K*Z-I*V*U+w*a*U,v=k*a*S-I*K*S-k*V*g+w*K*g+I*V*Q-w*a*Q,T=H*P+_*n+O*l+A*v;if(0===T)return this.identity();var Y=1/T;return u[0]=P*Y,u[1]=(K*g*A-a*Q*A-K*O*Z+_*Q*Z+a*O*U-_*g*U)*Y,u[2]=(V*Q*A-K*S*A+K*O*d-_*Q*d-V*O*U+_*S*U)*Y,u[3]=(a*S*A-V*g*A-a*O*d+_*g*d+V*O*Z-_*S*Z)*Y,u[4]=n*Y,u[5]=(I*Q*A-k*g*A+k*O*Z-H*Q*Z-I*O*U+H*g*U)*Y,u[6]=(k*S*A-w*Q*A-k*O*d+H*Q*d+w*O*U-H*S*U)*Y,u[7]=(w*g*A-I*S*A+I*O*d-H*g*d-w*O*Z+H*S*Z)*Y,u[8]=l*Y,u[9]=(k*a*A-I*K*A-k*_*Z+H*K*Z+I*_*U-H*a*U)*Y,u[10]=(w*K*A-k*V*A+k*_*d-H*K*d-w*_*U+H*V*U)*Y,u[11]=(I*V*A-w*a*A-I*_*d+H*a*d+w*_*Z-H*V*Z)*Y,u[12]=v*Y,u[13]=(I*K*O-k*a*O+k*_*g-H*K*g-I*_*Q+H*a*Q)*Y,u[14]=(k*V*O-w*K*O-k*_*S+H*K*S+w*_*Q-H*V*Q)*Y,u[15]=(w*a*O-I*V*O+I*_*S-H*a*S-w*_*g+H*V*g)*Y,this},makeRotationAxis:function(U,E){var b=Math.cos(E),x=Math.sin(E),j=1-b,K=U.x,f=U.y,B=U.z,N=j*K,J=j*f;return this.set(N*K+b,N*f-x*B,N*B+x*f,0,N*f+x*B,J*f+b,J*B-x*K,0,N*B-x*f,J*B+x*K,j*B*B+b,0,0,0,0,1),this},multiply:function(P){return this.multiplyMatrices(this,P)},premultiply:function(s){return this.multiplyMatrices(s,this)},multiplyMatrices:function(K,C){var S=K.el,L=C.el,G=this.el,v=S[0],R=S[4],x=S[8],M=S[12],P=S[1],J=S[5],w=S[9],i=S[13],j=S[2],N=S[6],k=S[10],q=S[14],E=S[3],D=S[7],a=S[11],O=S[15],z=L[0],W=L[4],c=L[8],p=L[12],d=L[1],y=L[5],u=L[9],U=L[13],l=L[2],g=L[6],$=L[10],o=L[14],n=L[3],V=L[7],_=L[11],F=L[15];return G[0]=v*z+R*d+x*l+M*n,G[4]=v*W+R*y+x*g+M*V,G[8]=v*c+R*u+x*$+M*_,G[12]=v*p+R*U+x*o+M*F,G[1]=P*z+J*d+w*l+i*n,G[5]=P*W+J*y+w*g+i*V,G[9]=P*c+J*u+w*$+i*_,G[13]=P*p+J*U+w*o+i*F,G[2]=j*z+N*d+k*l+q*n,G[6]=j*W+N*y+k*g+q*V,G[10]=j*c+N*u+k*$+q*_,G[14]=j*p+N*U+k*o+q*F,G[3]=E*z+D*d+a*l+O*n,G[7]=E*W+D*y+a*g+O*V,G[11]=E*c+D*u+a*$+O*_,G[15]=E*p+D*U+a*o+O*F,this},lookAt:function(){var V=new Cc;return function(N,w,z){return V.subVectors(N,w),this.lookAtDirection(V,z)}}(),lookAtDirection:function(){var N=new Cc,Y=new Cc,p=new Cc;return function(u,P){var z=this.el;return p.copy(u),0===p.lengthSq()&&(p.z=1),p.normalize(),N.crossVectors(P,p),0===N.lengthSq()&&(1===Math.abs(P.z)?p.x+=1e-4:p.z+=1e-4,p.normalize(),N.crossVectors(P,p)),N.normalize(),Y.crossVectors(p,N),z[0]=N.x,z[4]=Y.x,z[8]=p.x,z[1]=N.y,z[5]=Y.y,z[9]=p.y,z[2]=N.z,z[6]=Y.z,z[10]=p.z,this}}(),extractScale:function(){var m;return function(P){m===c&&(m=new Cc),P===c&&(P=new Cc);var n=m.setFromMatrixColumn(this,0).length(),a=m.setFromMatrixColumn(this,1).length(),H=m.setFromMatrixColumn(this,2).length();return P.set(n,a,H),P}}(),extractRotation:function(){var X;return function(j){X===c&&(X=new Cc),j===c&&(j=new Jc);var i=this.el,Q=j.el,D=1/X.setFromMatrixColumn(j,0).length(),p=1/X.setFromMatrixColumn(j,1).length(),S=1/X.setFromMatrixColumn(j,2).length();return i[0]=Q[0]*D,i[1]=Q[1]*D,i[2]=Q[2]*D,i[4]=Q[4]*p,i[5]=Q[5]*p,i[6]=Q[6]*p,i[8]=Q[8]*S,i[9]=Q[9]*S,i[10]=Q[10]*S,this}}(),multiplyScalar:function(U){var A=this.el;return A[0]*=U,A[4]*=U,A[8]*=U,A[12]*=U,A[1]*=U,A[5]*=U,A[9]*=U,A[13]*=U,A[2]*=U,A[6]*=U,A[10]*=U,A[14]*=U,A[3]*=U,A[7]*=U,A[11]*=U,A[15]*=U,this},getPosition:function(D){return D===c&&(D=new Cc),D.setFromMatrixColumn(this,3)},setPosition:function(G){var M=this.el;return M[12]=G.x,M[13]=G.y,M[14]=G.z,this},toArray:function(k,b){k===c&&(k=[]),b===c&&(b=0);var i=this.el;return k[b]=i[0],k[b+1]=i[1],k[b+2]=i[2],k[b+3]=i[3],k[b+4]=i[4],k[b+5]=i[5],k[b+6]=i[6],k[b+7]=i[7],k[b+8]=i[8],k[b+9]=i[9],k[b+10]=i[10],k[b+11]=i[11],k[b+12]=i[12],k[b+13]=i[13],k[b+14]=i[14],k[b+15]=i[15],k},determinant:function(){var u=this.el,G=u[0],m=u[4],R=u[8],W=u[12],e=u[1],V=u[5],v=u[9],F=u[13],L=u[2],E=u[6],g=u[10],D=u[14],h=u[3],j=u[7],o=u[11],y=u[15];return h*(+W*v*E-R*F*E-W*V*g+m*F*g+R*V*D-m*v*D)+j*(+G*v*D-G*F*g+W*e*g-R*e*D+R*F*L-W*v*L)+o*(+G*F*E-G*V*D-W*e*E+m*e*D+W*V*L-m*F*L)+y*(-R*V*L-G*v*E+G*V*g+R*e*E-m*e*g+m*v*L)},copy:function(H){var h=this.el,P=H.el;return h[0]=P[0],h[1]=P[1],h[2]=P[2],h[3]=P[3],h[4]=P[4],h[5]=P[5],h[6]=P[6],h[7]=P[7],h[8]=P[8],h[9]=P[9],h[10]=P[10],h[11]=P[11],h[12]=P[12],h[13]=P[13],h[14]=P[14],h[15]=P[15],this},compose:function(K,P,$){var g=this.el,q=P._x,w=P._y,Z=P._z,m=P._w,r=q+q,v=w+w,X=Z+Z,t=q*r,i=q*v,J=q*X,d=w*v,N=w*X,M=Z*X,D=m*r,s=m*v,k=m*X,Q=$.x,F=$.y,B=$.z;return g[0]=(1-(d+M))*Q,g[1]=(i+k)*Q,g[2]=(J-s)*Q,g[3]=0,g[4]=(i-k)*F,g[5]=(1-(t+M))*F,g[6]=(N+D)*F,g[7]=0,g[8]=(J+s)*B,g[9]=(N-D)*B,g[10]=(1-(t+d))*B,g[11]=0,g[12]=K.x,g[13]=K.y,g[14]=K.z,g[15]=1,this},decompose:function(){var A=new Cc,Q=new Jc;return function(w,Y,J){var I=this.el,B=A.set(I[0],I[1],I[2]).length(),x=A.set(I[4],I[5],I[6]).length(),m=A.set(I[8],I[9],I[10]).length(),u=this.determinant();0>u&&(B=-B),w.x=I[12],w.y=I[13],w.z=I[14],Q.copy(this);var Z=1/B,F=1/x,W=1/m;return Q.el[0]*=Z,Q.el[1]*=Z,Q.el[2]*=Z,Q.el[4]*=F,Q.el[5]*=F,Q.el[6]*=F,Q.el[8]*=W,Q.el[9]*=W,Q.el[10]*=W,Y.setFromRotationMatrix(Q),J.x=B,J.y=x,J.z=m,this}}()});var _f=C.Math.Triangle=function(H,N,d){this.a=H!==c?H:new Cc,this.b=N!==c?N:new Cc,this.c=d!==c?d:new Cc};g.assign(_f,{barycoordFromPoint:function(){var M=new Cc,i=new Cc,g=new Cc;return function(w,V,K,A,T){M.subVectors(A,V),i.subVectors(K,V),g.subVectors(w,V);var j=M.dot(M),C=M.dot(i),I=M.dot(g),p=i.dot(i),q=i.dot(g),v=j*p-C*C,L=T||new Cc;if(0===v)return L.set(-2,-1,-1);var W=1/v,x=(p*I-C*q)*W,c=(j*q-C*I)*W;return L.set(1-x-c,c,x)}}()});var od=C.Math.Euler=function(V,A,O,Y,E){this.set(V,A,O,Y,E)};od.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],od.DefaultOrder="XYZ",od.ReverseOrder=function(){var R={xyz:"ZYX",xzy:"YZX",yxz:"ZXY",yzx:"XZY",zxy:"YXZ",zyx:"XYZ"};return function(B){return R[B]}}(),g.defineProperties(od.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(X){this._y=X,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(c){this._z=c,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(s){this._order=s,this.onChangeCallback()}}}),g.assign(od.prototype,{set:function(Z,q,$,p,b){return zo(Z)&&(b=$,p=q,$=Z[2],q=Z[1],Z=Z[0]),p?b&&(p=od.ReverseOrder(p)):p="ZYX",this._x=Z||0,this._y=q||0,this._z=$||0,this._order=p||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(J){return this._x=J._x,this._y=J._y,this._z=J._z,this._order=J._order,this.onChangeCallback(),this},setFromRotationMatrix:function(H,i,L){var Y=C.Math.clamp,O=H.el||H,s=O[0],A=O[4],h=O[8],W=O[1],X=O[5],U=O[9],N=O[2],F=O[6],J=O[10];return i=i||this._order,"XYZ"===i?(this._y=Math.asin(Y(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(-U,J),this._z=Math.atan2(-A,s)):(this._x=Math.atan2(F,X),this._z=0)):"YXZ"===i?(this._x=Math.asin(-Y(U,-1,1)),Math.abs(U)<.99999?(this._y=Math.atan2(h,J),this._z=Math.atan2(W,X)):(this._y=Math.atan2(-N,s),this._z=0)):"ZXY"===i?(this._x=Math.asin(Y(F,-1,1)),Math.abs(F)<.99999?(this._y=Math.atan2(-N,J),this._z=Math.atan2(-A,X)):(this._y=0,this._z=Math.atan2(W,s))):"ZYX"===i?(this._y=Math.asin(-Y(N,-1,1)),Math.abs(N)<.99999?(this._x=Math.atan2(F,J),this._z=Math.atan2(W,s)):(this._x=0,this._z=Math.atan2(-A,X))):"YZX"===i?(this._z=Math.asin(Y(W,-1,1)),Math.abs(W)<.99999?(this._x=Math.atan2(-U,X),this._y=Math.atan2(-N,s)):(this._x=0,this._y=Math.atan2(h,J))):"XZY"===i?(this._z=Math.asin(-Y(A,-1,1)),Math.abs(A)<.99999?(this._x=Math.atan2(F,X),this._y=Math.atan2(h,s)):(this._x=Math.atan2(-U,J),this._y=0)):console.warn("unsupported order: "+i),this._order=i,L!==!1&&this.onChangeCallback(),this
},setFromQuaternion:function(){var u=new Jc;return function(q,B,w){return u.makeRotationFromQuaternion(q),this.setFromRotationMatrix(u,B,w)}}(),setFromVector3:function(J,F){return this.set(J.x,J.y,J.z,F||this._order)},reorder:function(){var O=new So;return function(e){return O.setFromEuler(this),this.setFromQuaternion(O,e)}}(),equals:function(R){return R._x===this._x&&R._y===this._y&&R._z===this._z&&R._order===this._order},fromArray:function(I){return this._x=I[0],this._y=I[1],this._z=I[2],I[3]!==c&&(this._order=I[3]),this.onChangeCallback(),this},toArray:function(k,G){return k===c&&(k=[]),G===c&&(G=0),k[G]=this._x,k[G+1]=this._y,k[G+2]=this._z,k[G+3]=this._order,k},toVector3:function(Y){return Y?Y.set(this._x,this._y,this._z):new Cc(this._x,this._y,this._z)},onChange:function(z){return this.onChangeCallback=z,this},onChangeCallback:function(){}});var Gg={ms_ac:function(i,S){for(var V=S.ms_ac,d=0;d<V.length;d++)Hf(i,V[d])},ms_listener:function(D){D.addListeners=function(){var O=this,r=nc;G.mockTouch&&(r=zb.concat(Eh).concat(Hq)),O.__events__=r;for(var u=0,b=r.length;b>u;u++){var K=r[u];"wheel"===K&&!O.handle_wheel&&O.handle_mousewheel&&(O.handle_wheel=function(g){Op(O,g)}),O["handle_"+K]&&As(K,O.getView(),O)}},D.removeListeners=function(){var L=this,k=L.__events__;if(k){L.__events__=c;for(var M=0,g=k.length;g>M;M++)L["handle_"+k[M]]&&fe(k[M],L.getView(),L)}}},ms_fire:function(S){S.mp=function(H,i,w){this.addPropertyChangeListener(H,i,w)},S.ump=function(v,t){this.removePropertyChangeListener(v,t)},S.fp=function(Q,z,F,Z,o){return this.firePropertyChange(Q,z,F,Z,o)},S.addPropertyChangeListener=function(R,K,i){var W=this;W._62I||(W._62I=new Ce),W._62I.add(R,K,i)},S.removePropertyChangeListener=function(S,d){this._62I&&this._62I.remove(S,d)},S.firePropertyChange=function(k,s,v,T,Z){if(T){if(T(s,v))return!1}else if(s===v)return!1;var p=this,j=Z||{};return j.property=k,j.oldValue=s,j.newValue=v,j.source=p,j.data=p,p._62I&&p._62I.fire(j),p.onPropertyChanged&&p.onPropertyChanged(j),!0}},ms_attr:function(f){f.a=function(B,v){var T=this;if(2===arguments.length)T.setAttr(B,v);else{if(!jb(B))return T.getAttr(B);for(var b in B)T.setAttr(b,B[b])}return T},f.getAttr=function(y,v){if(v===c&&(v=1),this._attrObject&&y in this._attrObject)return this._attrObject[y];if(this.getImage){var u=this.getImage();if(ak(u)&&(u=$r[u]),jb(u)&&"dataBindings"in u)for(var $=u.dataBindings,X=$.length-1;X>=0;X--){var s=$[X];if(s.attr===y){if("defaultValue"in s)return s.defaultValue;break}}}return v?T[y]:c},f.setAttr=function(K,A){var B=this;B._attrObject||(B._attrObject={});var y=B._attrObject[K];A===c?delete B._attrObject[K]:B._attrObject[K]=A,B.fp&&B.fp("a:"+K,y,A)&&B.onAttrChanged&&B.onAttrChanged(K,y,A)},f.getSerializableAttrs=function(){var D,F={};for(D in this._attrObject)F[D]=1;return F}},ms_bnb:function(L){L.getBodyColor=function(z){return z.s("body.color")},L.getBorderColor=function(O){return O.s("border.color")}},_51o:function(M){M.mi=function(y,z,x){this.addInteractorListener(y,z,x)},M.umi=function(o,h){this.removeInteractorListener(o,h)},M.fi=function(L){this.fireInteractorEvent(L)},M.addInteractorListener=function(G,c,$){var J=this;J._63I||(J._63I=new Ce),J._63I.add(G,c,$)},M.removeInteractorListener=function(a,E){this._63I&&this._63I.remove(a,E)},M.fireInteractorEvent=function(P){this._63I&&this._63I.fire(P)},M.setInteractors=function(q){var t=this,k=t._interactors;k&&k.each(function(j){j.tearDown()}),zo(q)&&(q=new Vo(q)),t._interactors=q,q&&q.each(function(O){O.setUp()}),t.fp("interactors",k,q),t.invalidateSelection()},M.getInteractors=function(){return this._interactors}},_49o:function(Z){Z._44O=U,Z._45O=U,Z.getTopPainters=function(){return this._44O},Z.getBottomPainters=function(){return this._45O},Z.addTopPainter=function(z){var g=this;g._44O||(g._44O=new Vo),g._44O.contains(z)||(g._44O.add(z),g.redraw&&g.redraw())},Z.removeTopPainter=function(O){var D=this;D._44O&&(D._44O.remove(O),D.redraw&&D.redraw())},Z.addBottomPainter=function(N){var c=this;c._45O||(c._45O=new Vo),c._45O.contains(N)||(c._45O.add(N),c.redraw&&c.redraw())},Z.removeBottomPainter=function(Q){var E=this;E._45O&&(E._45O.remove(Q),E.redraw&&E.redraw())},Z._93db=function(S,C){var K=this;K._45O&&K._45O.each(function(x){x.draw?x.draw(S,C):x.call(K,S,C)})},Z._92db=function(t,Y){var R=this;R._44O&&R._44O.each(function(z){z.draw?z.draw(t,Y):z.call(R,t,Y)})}},ms_sm:function(L){L.sm=function(){return this.getSelectionModel()},L.setSelectableFunc=function(K){this.sm().setFilterFunc(K)},L.getSelectableFunc=function(){return this.sm().getFilterFunc()},L.getSelectionModel=function(){var n=this;return n._selectionModel?n._selectionModel:n.dm().sm()},L.isSelectionModelShared=function(){return!this._selectionModel},L.setSelectionModelShared=function(_){var D=this,I=D.sm(),l=!D._selectionModel,j=D.handleSelectionChange,m=D.dm();l!==_&&(D.invalidateSelection&&D.invalidateSelection(),_?(m.sm().ms(j,D),D._selectionModel.ums(j,D),D._selectionModel.dispose(),D._selectionModel=U):(m.sm().ums(j,D),D._selectionModel=new pq(m),D._selectionModel.ms(j,D)),D.onSelectionModelSharedChanged(),D.fp("selectionModelShared",l,_),D.fireViewEvent({kind:"selectionModelSharedChange",oldValue:l,newValue:_,oldSelectionModel:I,newSelectionModel:D.sm()}))},L.onSelectionModelSharedChanged=function(){var h=this;h.redraw(),h.invalidateSelection&&h.invalidateSelection()},L.removeSelection=function(){var o=this.dm();o.beginTransaction(),this.sm().toSelection().each(o.remove,o),o.endTransaction()},L.selectAll=function(){var j=this;j.sm().ss(j.dm().toDatas(function(r){return j.isVisible(r)&&j.isSelectable(r)}))},L.isSelected=function(S){return this.sm().co(S)},L.isSelectedById=function(E){var x=this.dm().getDataById(E);return x?this.isSelected(x):!1},L.isSelectable=function(e){return this.sm().isSelectable(e)}},ms_tx:function(r){r._64I=0,r._65O=0,r.isScrollable=function(){return this.getWidth()<this._64I},r._40o=function(){return this.isScrollable()},r.getLogicalPoint=function(d){return Ag(d,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},r.tx=function(p){return p===c?this.getTranslateX():(this.setTranslateX(p),void 0)},r.getTranslateX=function(){return this._65O},r.setTranslateX=function(z){var R=this,C=R.getWidth()-R._64I;C>z&&(z=C),z>0&&(z=0),z=O(z);var K=R._65O;R._65O=z,R.fp(mc,K,z)}},ms_ty:function(e){e._23Q=0,e._66O=0,e._41o=function(){return this.getHeight()<this._23Q},e.getLogicalPoint=function(k){return Ag(k,this._canvas||this._view,this.tx?this.tx():0,this.ty())},e.ty=function(s){return s===c?this.getTranslateY():(this.setTranslateY(s),void 0)},e.getTranslateY=function(){return this._66O},e.setTranslateY=function(q){var H=this,L=H.getHeight()-H._23Q;L>q&&(q=L),q>0&&(q=0),q=O(q);var D=H._66O;H._66O=q,H.fp(yd,D,q)}},ms_txy:function(x){x._65O=0,x._66O=0,x.tx=function(w){return w===c?this.getTranslateX():(this.setTranslateX(w),void 0)},x.ty=function(B){return B===c?this.getTranslateY():(this.setTranslateY(B),void 0)},x.onTranslateEnded=function(){},x.setTranslate=function(D,F,a){var Z=this;if(a=Li(a)){Z._65I&&Z._65I.stop(!0);var r=Z.tx(),B=Z.ty();a.action=function(P){Z.setTranslate(r+(D-r)*P,B+(F-B)*P)},a._37o=function(){delete Z._66I,delete Z._65I,Z.onTranslateEnded()},Z._66I=1,Z._65I=Jn(a)}else Z.tx(D),Z.ty(F)},x.getTranslateX=function(){return this._65O},x.setTranslateX=function(j){var V=this;j=V.adjustTranslateX(j);var e=V._65O;V._65O=j,V.fp(mc,e,j)},x.getTranslateY=function(){return this._66O},x.setTranslateY=function(m){var x=this;m=x.adjustTranslateY(m);var W=x._66O;x._66O=m,x.fp(yd,W,m)},x.adjustTranslateX=function(B){return O(B)},x.adjustTranslateY=function(z){return O(z)},x.translate=function(g,k,q){this.setTranslate(this.tx()+g,this.ty()+k,q)},x.getLogicalPoint=function(x){var j=this;return Ag(x,this._canvas||j._view,j.tx(),j.ty())}},ms_dm:function(n){n.dm=function(J){return J?(this.setDataModel(J),void 0):this.getDataModel()},n.getDataModel=function(){return this._dataModel}},ms_lp:function(y){y.lp=function(f){return this.getLogicalPoint(f)}},ms_v:function(A){A._disabled=!1,A.setDisabled=function(z,u){var A=this,R=A._disabled;R!==z&&(R&&(Oi(A._63O),delete A._63O),z&&(zp(A._view,A._63O=vl(u)),A.iv()),A._disabled=z,A.fp("disabled",R,z))},A.isDisabled=function(){return this._disabled},A.getDisabledDiv=function(){return this._63O},A.getView=function(){return this._view},A.addToDOM=function(N){var s=this,O=s.getView(),n=O.style;N=N||X.body,N.appendChild(O),n.left="0",n.right="0",n.top="0",n.bottom="0",d(i,"resize",function(){s.iv()}),s.iv()},A.setCursor=function(l){"default"===l&&(l=this._defaultCursor||l);var A=this.getView().style;A.cursor=l,A.cursor="-webkit-"+l,A.cursor="-moz-"+l},A.getWidth=function(){return this._view.clientWidth},A.getHeight=function(){return this._view.clientHeight},A.setWidth=function(X){var c=this;c._view.style.width=X+Cm,c.iv(),c.fp&&c.fp(Vr,U,X)},A.setHeight=function(K){var J=this;J._view.style.height=K+Cm,J.iv(),J.fp&&J.fp(Jb,U,K)},A.setFocus=function(K){var x=this,X=x._currentEditor;return K&&X&&(X.getView&&(X=X.getView()),X.contains(K.target))?!1:(wb(x._view),x.endEditing&&x.endEditing(),x.fireViewEvent("focus"),!0)},A.iv=function($){this.invalidate($)},A.invalidate=function(B){var M=this;M._68I||(M._68I=1,xk(M.validate,M,U,B),M.onInvalidated&&M.onInvalidated(),M.fireViewEvent("invalidate"))},A.validate=function(){var x=this,g=x._view;if(x._68I&&(delete x._68I,g.parentNode))if(0===g.offsetWidth&&0===g.offsetHeight&&x._67I!==U)x._67I===c&&(x._67I=G.reinvalidateCount),x._67I>0?x._67I--:x._67I=U,x.iv();else{x.fireViewEvent("beginValidate"),x.validateImpl(),x.onValidated&&x.onValidated(),x.fireViewEvent("validate");var L=x._63O;L&&(g.lastChild!==L&&(Oi(L),zp(g,L)),Gq(L,0,0,x.getWidth(),x.getHeight())),hd(x),Hp(x),Hj(x)}},A.layout=function(H,b,g,s){1===arguments.length?Gq(this,H):Gq(this,H,b,g,s)},A.addViewListener=function(B,l,Z){var T=this;T._67O||(T._67O=new Ce),T._67O.add(B,l,Z)},A.removeViewListener=function(g,u){this._67O.remove(g,u)},A.fireViewEvent=function(E){var X=this;X._67O&&(ak(E)&&(E={kind:E}),X._67O.fire(E)),G.viewListener&&G.viewListener(X,E)}},ms_tip:function(c){c.setToolTipEnabled=function(N){var E=this;N?jg||E._13o||(E.enableToolTip(),E.fp("toolTipEnabled",!1,!0)):E._13o&&(E.disableToolTip(),E.fp("toolTipEnabled",!0,!1))},c.isToolTipEnabled=function(){return!!this._13o},c.enableToolTip=function(){var r=this;if(!jg&&!r._13o){r._13o=function(u){var i=r.getToolTip(u);i!=U?(G.toolTipContinual&&G.isToolTipShowing()?nn(u,i):(ho(),Ik={timeout:xq(Ne,On),e:u,info:i}),xn={e:u,view:r}):ho()};var c=r.getView();d(c,hr,r._13o),d(c,"mouseleave",G.hideToolTip)}},c.disableToolTip=function(){var i=this;if(i._13o){var p=i.getView();h(p,hr,i._13o),h(p,"mouseleave",G.hideToolTip),delete i._13o}},c.getToolTip=function(V){var Z=this;if(Z.getDataAt){var a=Z.getDataAt(V);return a?a.getToolTip():U}return Z.getValue?Z.getValue():void 0}},_52o:function(M){M._zoom=1,M._29I=Ki,M.zoomIn=function(R,b){this.setZoom(this._zoom*lb,R,b)},M.zoomOut=function(E,w){this.setZoom(this._zoom/lb,E,w)},M.zoomReset=function(f,v){this.setZoom(1,f,v)},M.scrollZoomIn=function(p){this.setZoom(this._zoom*ug,U,p)},M.scrollZoomOut=function(T){this.setZoom(this._zoom/ug,U,T)},M.pinchZoomIn=function(H){this.setZoom(this._zoom*Qg,U,H)},M.pinchZoomOut=function(e){this.setZoom(this._zoom/Qg,U,e)},M.adjustZoom=function(L){return Mq>L?Mq:L>ss?ss:L},M.getZoom=function(){return this._zoom},M.setZoom=function(X,g,o){var e=this;if(g=Li(g)){e._14o&&e._14o.stop(!0);var K=e._zoom;g.action=function(B){e._96O(K+(X-K)*B,o)},g._37o=function(){delete e._zooming,delete e._14o,e.onZoomEnded()},e._zooming=1,e._14o=Jn(g)}else e._96O(X,o)},M._96O=function(v,J){var n=this;if(v=n.adjustZoom(v),v!==n._zoom){n.validate();var L=n._29I,X=n._zoom;0!==L.width&&0!==L.height&&(J=J?J:{x:L.x+L.width/2,y:L.y+L.height/2},n.tx((J.x-L.x)*X-J.x*v),n.ty((J.y-L.y)*X-J.y*v)),n._zoom=v,n.fp("zoom",X,v)}}},ms_edge:function(X){X._2I=function(g){var V=this;V._44I||(V._44I=new Vo),V._42I||(V._42I=new Vo),V._44I.add(g),V._42I.add(g),V._20I()},X._4I=function(O){var r=this;r._44I||(r._44I=new Vo),r._43I||(r._43I=new Vo),r._44I.add(O),r._43I.add(O),r._20I()},X._16I=function(z){var i=this;i._44I.remove(z),i._42I.remove(z),i._44I.isEmpty()&&delete i._44I,i._42I.isEmpty()&&delete i._42I,i._20I()},X._18I=function(U){var X=this;X._44I.remove(U),X._43I.remove(U),X._44I.isEmpty()&&delete X._44I,X._43I.isEmpty()&&delete X._43I,X._20I()},X._20I=function(){var k=this;if(delete k._45I,!k._44I||k._44I.isEmpty())return delete k._70O,void 0;var R;k._44I.each(function(B){B.isLooped()&&(R||(R={}),R[B._id]||(k._45I||(k._45I=new Vo),k._45I.add(B),R[B._id]=B))}),R?(k._70O=new Vo,k._44I.each(function(q){R[q._id]?"A"===R[q._id]||(R[q._id]="A",k._70O.add(q)):k._70O.add(q)})):k._70O=k._44I},X.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},X.getSourceAgentEdges=function(){return this._46I},X.getTargetAgentEdges=function(){return this._47I},X._1I=function(J){var D=this;D._46I||(D._46I=new Vo),D._48I||(D._48I=new Vo),D._46I.add(J),D._48I.add(J),D._19I()},X._3I=function(X){var E=this;E._47I||(E._47I=new Vo),E._48I||(E._48I=new Vo),E._47I.add(X),E._48I.add(X),E._19I()},X._15I=function(q){var E=this;E._46I.remove(q),E._48I.remove(q),E._46I.isEmpty()&&delete E._46I,E._48I.isEmpty()&&delete E._48I,E._19I()},X._17I=function(G){var D=this;D._47I.remove(G),D._48I.remove(G),D._47I.isEmpty()&&delete D._47I,D._48I.isEmpty()&&delete D._48I,D._19I()},X._19I=function(){var h=this;delete h._49I;var V=h._48I;if(V&&!V.isEmpty()){var A={};V.each(function(z){A[z._id]?h._49I||(h._49I=new Vo):A[z._id]=z}),h._49I?V.each(function(j){A[j._id]&&(h._49I.add(j),delete A[j._id])}):h._49I=V}},X.getLoopedEdges=function(){return this._45I},X.getEdges=function(){return this._70O},X.getAgentEdges=function(){return this._49I},X.getSourceEdges=function(){return this._42I},X.getTargetEdges=function(){return this._43I},X._8I=function(){this._70O&&this._70O.each(function(J){J._7I()})}},ms_shadow:function(p){Id.PARAMS.forEach(function(u){var e=u.replace(/(^|\.)[a-z]/g,function(w){return w[w.length-1].toUpperCase()}),h=e.charAt(0).toLowerCase()+e.substr(1);p["getShadow"+e]=function(){return this._getShadowParam(h)},p["setShadow"+e]=function(K){this._setShadowParam(h,K)}}),p.enableShadow=function(p){this.shadowMap.setShadow(!0,p)},p.disableShadow=function(){this.shadowMap.setShadow(!1)},p._getShadowParam=function(r){return this.shadowMap.getShadow()[r]},p._setShadowParam=function(h,Z){var g=this._getShadowParam(h),f={};f[h]=Z;var b=this.shadowMap;b.setShadow(b.enable,f),this.firePropertyChange("shadow"+h.charAt(0).toUpperCase()+h.substr(1),g,Z)}}};hn(G,{getVersion:function(){return"7.2.5"}},!0),hn(G,{numberDigits:5,crossOrigin:"",baseZIndex:c,isTouchable:jg,mockTouch:!0,devicePixelRatio:i.devicePixelRatio?i.devicePixelRatio:i.screen?i.screen.deviceXDPI/i.screen.logicalXDPI:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:P.disabledBackground,forceHierarchicalSerialization:!0,extractBatchTranslation:!1,extractShapeTranslation:!1,envmapProbeMinWaitTime:300,envmapProbeMaxWaitTime:25e3,EnvmapTextureSize:1024,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Sd},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],blockMinSize:1,textExtraWidth:4,encodeStringKey:null,doubleClickSpeed:500,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(x){return x*x},labelColor:Ed,labelSelectColor:rm,labelFont:"12px arial, sans-serif",widgetIndent:jg?30:20,widgetRowHeight:jg?30:20,widgetHeaderHeight:jg?32:22,widgetTitleHeight:jg?34:24,scrollBarColor:zn,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:jg?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:wc,intersectionLineLine:ik,isEnter:Am,isEsc:Jk,isDelete:Nc,isSpace:Tr,isLeft:Go,isUp:uq,isRight:ib,isDown:Ok,isTouchEvent:ig,getTarget:kh,isString:ak,isNumber:Bk,isBoolean:Nj,isArray:zo,isSelectAll:Qb,isFunction:kk,isObject:jb,getPropertyValue:go,setPropertyValue:Eo,addMethod:hn,createGradient:function(h,w,k,u,v,Y,R,S){var K=js[w];return K(h,k,u,v,Y,R,S)},appendToScreen:function(A){A=A.getView?A.getView():A,(X.fullscreenElement||X.mozFullScreenElement||X.webkitFullscreenElement||X.msFullscreenElement||X.body).appendChild(A)},encodeString:function(u){return C.Math.encodeBase64(u,G.encodeStringKey)},decodeString:function(D){return C.Math.decodeBase64(D,G.encodeStringKey)},findView:function(H){var A=function(y,t){var E=t._ht;E&&y.push(E);var p=t.children,q=p.length;if(q)for(var u=0;q>u;u++)A(y,p[u])},$=[];A($,X.body);var b=function(x,G){for(var f="2d"===G?Ui.GraphView:Vf.Graph3dView,D=0,o=x.length;o>D;D++)if(x[D]instanceof f)return $[D];return null};return"all"===H?$:"2d"===H?b($,"2d"):"3d"===H?b($,"3d"):b($,"3d")||b($,"2d")},toggleFullscreen:function(G){var Z=G.getView();if(X.fullscreenElement||X.mozFullScreenElement||X.webkitFullscreenElement||X.msFullscreenElement)X.exitFullscreen?X.exitFullscreen():X.msExitFullscreen?X.msExitFullscreen():X.mozCancelFullScreen?X.mozCancelFullScreen():X.webkitExitFullscreen&&X.webkitExitFullscreen();else{var A=!0;if(G.isSelfViewEvent){var r=G.getX(),P=G.getY(),R=G.getWidth(),y=G.getHeight(),e=Z.style.background,T=Z.style.backgroundColor;e||T||(Z.style.backgroundColor="white"),Z.requestFullscreen?Z.requestFullscreen():Z.msRequestFullscreen?Z.msRequestFullscreen():Z.mozRequestFullScreen?Z.mozRequestFullScreen():Z.webkitRequestFullscreen&&Z.webkitRequestFullscreen();var g=setInterval(function(){if(Z!==(X.fullscreenElement||X.mozFullScreenElement||X.webkitFullscreenElement||X.msFullscreenElement))clearInterval(g),G.setX(r),G.setY(P),G.setWidth(R),G.setHeight(y),G._fullscreen=!1,Z.style.oldBackgroundColor=T,G.iv();else{var h=C.Default.getWindowInfo();(A||h.width!==G.getWidth()||h.height!==G.getHeight())&&(G.setX(h.left),G.setY(h.top),G.setWidth(h.width),G.setHeight(h.height),G._fullscreen=!0,G.iv(),A=!1)}},500)}else{var z=Z.style.left,o=Z.style.top,R=Z.style.width,y=Z.style.height,e=Z.style.background,T=Z.style.backgroundColor;e||T||(Z.style.backgroundColor="white"),Z.requestFullscreen?Z.requestFullscreen():Z.msRequestFullscreen?Z.msRequestFullscreen():Z.mozRequestFullScreen?Z.mozRequestFullScreen():Z.webkitRequestFullscreen&&Z.webkitRequestFullscreen();var g=setInterval(function(){if(Z!==(X.fullscreenElement||X.mozFullScreenElement||X.webkitFullscreenElement||X.msFullscreenElement))clearInterval(g),Z.style.left=z,Z.style.top=o,Z.style.width=R,Z.style.height=y,Z.style.oldBackgroundColor=T,G.iv();else{var w=C.Default.getWindowInfo();(A||w.width!==G.getWidth()||w.height!==G.getHeight())&&(Gq(G),A=!1)}},500)}}},appendTimeStamp:function(Y){return Y},setCompType:function(d,x){ak(x)&&x.substr(0,12)==Vi&&(x=G.parse(x)),kk(x)||jb(x)?Dh[d]=x:Sr(d)},getCompType:function($){var b=Dh[$];return b===c&&Gl.test($)&&Sr($),b},getCompTypeMap:function(){return Dh},drawCompType:function(k,W,g,l,m,y){k(W,g,l,m,y)},numberListener:function(){var H={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(P){var t=P.keyCode;H[t]||65===t&&G.isCtrlDown(P)||86===t&&G.isCtrlDown(P)||67===t&&G.isCtrlDown(P)||88===t&&G.isCtrlDown(P)||t>=35&&40>=t||(P.shiftKey||48>t||t>57)&&(96>t||t>105)&&P.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(Y){var l=Y.target.tagName;("DIV"===l||"CANVAS"===l)&&!(G.ignoreKeyCodes.indexOf(Y.keyCode)>=0)&&("keydown"!==Y.type||Go(Y)||ib(Y)||uq(Y)||Ok(Y)||Nc(Y)||65===Y.keyCode&&(Y.metaKey||Y.ctrlKey))&&Y.cancelable===!0&&(Y.preventDefault(),Y.preventManipulation&&Y.preventManipulation())},getWindowInfo:function(){var U=X.documentElement,s=U&&(U.scrollLeft||U.scrollTop)?U:X.body;return{target:s,left:s.scrollLeft,top:s.scrollTop,width:i.innerWidth||s.clientWidth,height:i.innerHeight||s.clientHeight}},isDragging:function(){return!!Sd},isLeftButton:function(l){return ig(l)?!0:0===l.button},isMiddleButton:function(k){return ig(k)?!1:k&&(1===k.button||4&(k.buttons||0))},isRightButton:function(F){return ig(F)?!1:F&&(2===F.button||2&(F.buttons||0))},isInput:function(z){if(!z)return!1;var r=z.tagName;return"INPUT"===r||"TEXTAREA"===r||"SELECT"===r},getTouchCount:function(A){return ig(A)?A.touches.length:1},isDoubleClick:function(){function I(H){H.details=0,H.timeout=null,H.lastPoint=null}var M={};return Pb=new Si,db=Pb.getTime(),function(H){if(mq(H)>1)return!1;var k=H.button==U?"":H.button,t=H.type+k,g=t+"_isDoubleClick",z=M[t];if(z||(z=M[t]={details:0,timeout:null,lastPoint:null}),H[g]===c){H[g]=!0;var Z=Ae(H);z.timeout&&(rj(z.timeout),z.timeout=null);var Q=ig(H)?G.doubleTouchRange:G.doubleClickRange;z.lastPoint&&Sn(z.lastPoint,Z)>Q&&I(z),z.lastPoint=Z,z.details++,z.timeout=xq(function(){I(this)}.bind(z),G.doubleClickSpeed)}return 2===z.details}}(),isShiftDown:function(D){return D?D.shiftKey:Dk["16"]},isCtrlDown:function(G){return G?Un?G.metaKey:G.ctrlKey:Un?Dk["91"]:Dk["17"]},getClientPoint:function(w){return ig(w)&&(w=pl(w)),{x:w.clientX,y:w.clientY}},isMouseEvent:function(H){return H instanceof MouseEvent||0===H.type.indexOf("mouse")},getTargetElement:function(p){var K,Y=Ul(p);if(K=G.isMouseEvent(p)||!X.elementFromPoint?p.target:X.elementFromPoint(Y.x,Y.y),ze&&X.elementFromPoint){for(var y=[],_=[];"none"===K.style.pointerEvents;)y.push(K),_.push(K.style.display||""),K.style.display="none",K=X.elementFromPoint(Y.x,Y.y);y.forEach(function(S,r){S.style.display=_[r]})}return K},getPagePoint:function(Q){return ig(Q)&&(Q=pl(Q)),{x:Q.pageX,y:Q.pageY}},createObject:function(U,T){var t=new U;for(var o in T){var f=T[o];if(kk(f))t[o]=f;else if(0===o.indexOf("s:"))t.s(o.substr(2),T[o]);else if(0===o.indexOf("a:"))t.a(o.substr(2),T[o]);else{var I=Iq(o),f=T[o];t[I]?(t[I](f),"setToolTip"===I&&t.enableToolTip&&t.enableToolTip()):t[o]=f}}return t},setImage:function($,o,a,n){var C=arguments.length;4===C?wn($,n,o,a):2===C?ak(o)?o.substr(0,12)==Vi?rr($,G.parse(o)):wn($,o):rr($,o):1===C&&wn($,$)},getImage:function(f,W,b){var t;if(f==U)return U;if(jb(f)?t=f:(t=$r[f],f&&t===c&&(Pe&&Pe[f]||wn(f,f))),W&&t&&t.tagName){var z;z="override"===b?"colors_override":"override_rgb"===b?"colors_override_rgb":"override_a"===b?"colors_override_a":"colors",t[z]||(t[z]={__count__:0});var N=t[z][W];return N||(t[z].__count__>G.imageCacheThreshold&&(t[z]={__count__:0}),N=pj(t,Ap(W),t.width,t.height,b),t[z][W]=N,t[z].__count__++),N}return t},isImageComplete:function(N,Q,m){var j=Kj(N);if(!j)return!1;if(j.tagName)return j.complete;for(var A,N,s,P=j.comps,U=!0,Z=0,T=P.length;T>Z;Z++)if(A=P[Z],s=A.type,"image"===A.type){N=A.name,N&&N.func&&(N=zi(N,Q));var Y=lr(N,Q,m);if(!Y){U=!1;break}}else if(Gl.test(s)&&G.getCompType(s)===c){U=!1,Sr(s);break}return U},getId:function(){var K=1;return function(){return++K}}(),callLater:function(U,h,Y,K){var u=function(){U.apply(h,Y)};return K?xq(u,K):i.requestAnimationFrame(u)},cancelLater:function(x,Q){Q?rj(x):i.cancelAnimationFrame(x)},clone:function(K){if(null==K||"object"!=typeof K)return K;if(K instanceof Date){var c=new Date;return c.setTime(K.getTime()),c}if(K instanceof Array){for(var c=[],v=0,q=K.length;q>v;v++)c[v]=ns(K[v]);return c}if(K instanceof Vo){for(var c=new Vo,v=0,q=K.length;q>v;v++)c.set(v,ns(K.get(v)));return c}if(K instanceof Cb)return K;if(K instanceof sm){var c=new sm;return c.deserialize(K.serialize()),c}if(K instanceof g){var c={};for(var s in K)K.hasOwnProperty(s)&&(c[s]=ns(K[s]));return c}return K},callWhenLoaded:function(e,J){J=J||100;var N=sf(e,J);Rc||(Rc={}),Rc[N]={tick:N,cb:e,delay:J}},beforeLoadURL:function(I,q){if(Rc){var T={};for(var q in Rc){var D=Rc[q];rj(D.tick);var w=sf(D.cb,D.delay);T[w]={tick:w,delay:D.delay,cb:D.cb}}Rc=T}return G.convertURL?G.convertURL(I,q):I},convertURL:function(E){return E},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return G.getImage("default_blank")},resizeImage:function(v,Y,M){M||(M=Y);var W=Nb(),p=W.getContext("2d");return cs(W,Y,M,1),p.drawImage(v,0,0,Y,M),W},resizeImagePOT:function(p,h){if(!p||!p.tagName)return p;var $=p.width,F=p.height;if(!$||!F)return p;if(Up.isPOT($)&&Up.isPOT(F)&&(!h||$===F))return p;var V,R;return h?R=V=Up.nearestPOT(Math.min($,F)):(V=Up.nearestPOT($),R=Up.nearestPOT(F)),G.resizeImage(p,V,R)},sortFunc:function(z,p){if(z===p)return 0;if(z==U&&p!=U)return 1;if(z!=U&&p==U)return-1;if(z==U&&p==U)return 0;var m,B=typeof z,I=typeof p;return B===Dl&&I===Dl?m=z.localeCompare(p):B===dm&&I===dm&&(m=z-p),m===c&&(m=(""+z).localeCompare(""+p)),m>0?1:0>m?-1:0},getClassMap:function(){return Bl},getClass:function(O){if(ak(O)){var F,D=Bl[O];if(!D){F=O.split("."),D=i;for(var C=0;C<F.length;C++)D=D[F[C]];Bl[O]=D}return D}return O},def:function(A,r,R){var B,M,f,j=function(){};if(j.prototype=r.prototype,B=new j,ak(A)){if(Bl[A])throw"'"+A+"' already defined";f=Ef(A),B.getClassName=function(){return A}}else f=A;if(B.constructor=f,B.getClass=function(){return f},B.getSuperClass=function(){return r},R)for(M in R)Gg[M]&&Gg.hasOwnProperty(M)?Gg[M](B,R):de(B,R,M);f.prototype=B,f.superClass=r.prototype},startAnim:function(){var e=function(D){D.duration&&(D.startTime=rq()),D.timeId=xk(D.tick,U,U,D.interval)};return function(m){return m=ns(m),m.easing=m.easing||G.animEasing,m.duration||m.frames||(m.duration=G.animDuration),m.t=0,m.duration?m.interval=0:(m.frame=0,m.interval=m.interval||10),m.tick=function(){if(m.duration){var E=(rq()-m.startTime)/m.duration;if(E>1&&(E=1),m.t=E,m.action(m.easing(E),E),!m.isRunning())return;1===E?m.stop():m._isPaused||(m.timeId=xk(m.tick))}else{if(m.frame++,E=m.t=m.frame/m.frames,m.action(m.easing(E),E),!m.isRunning())return;m.frame<m.frames?m._isPaused||(m.timeId=xk(m.tick,U,U,m.interval)):m.stop()}},m.resume=function(){m._isPaused&&(delete m._isPaused,m.duration?m.t<1&&(m.startTime=rq()-m.duration*m.t,m.timeId=xk(m.tick)):m.frame<m.frames&&(m.timeId=xk(m.tick,U,U,m.interval)))},m.pause=function(){An(m.timeId,!m.duration),m._isPaused=!0},m.isPaused=function(){return this._isPaused},m.stop=function(J){m.isRunning()&&(An(m.timeId,!m.duration),delete m.timeId,m.duration?m.t<1&&J&&(m.t=1,m.action(m.easing(1),1)):m.frame<m.frames&&J&&(m.frame=m.frames,m.action(m.easing(1),1)),m._37o&&m._37o(),m.finishFunc&&m.finishFunc())},m.isRunning=function(){return m.timeId!=U},m.delay?xk(e,U,[m],m.delay):e(m),m}}(),getTextSize:function(){var R={},O=X?Nb().getContext("2d"):U;return function(d,D){O.font=d?d:fj;var y=R[O.font];return y||(y=2*O.measureText("e").width+4,R[O.font]=y),{width:O.measureText(D).width+G.textExtraWidth,height:y}}}(),drawText:function(l,y,h,P,s,q,k,V,$,W,C){if(y!=U){var p=ei(h,y),H={};if(H.y=W&&W!==os?W===vc?q+p.height/2:q+V-p.height/2:q+V/2,H.x=$&&$!==Ld?$===fk?s+k-p.width/2:s+k/2:s+p.width/2,wj(l,y,H,h,P),C){l.font=h;var e=l.measureText(y);l.beginPath(),l.strokeStyle=P,"underline"===C?(l.moveTo(H.x-p.width/2,H.y+e.actualBoundingBoxDescent+1),l.lineTo(H.x+p.width/2,H.y+e.actualBoundingBoxDescent+1)):"strikethrough"===C?(l.moveTo(H.x-p.width/2,H.y),l.lineTo(H.x+p.width/2,H.y)):"overline"===C&&(l.moveTo(H.x-p.width/2,H.y-e.fontBoundingBoxAscent),l.lineTo(H.x+p.width/2,H.y-e.fontBoundingBoxAscent)),l.stroke()}}},getDistance:function(e,q){var d=e.length;return q?3===d?j(Eq(e[0]-q[0])+Eq(e[1]-q[1])+Eq(e[2]-q[2])):2===d?j(Eq(e[0]-q[0])+Eq(e[1]-q[1])):e.z===c?j(Eq(q.x-e.x)+Eq(q.y-e.y)):j(Eq(q.x-e.x)+Eq(q.y-e.y)+Eq(q.z-e.z)):3===d?j(Eq(e[0])+Eq(e[1])+Eq(e[2])):2===d?j(Eq(e[0])+Eq(e[1])):void 0},brighter:function(g,X){return 0>X&&(X=-X),Hm(g,X?X:40)},darker:function(W,V){return V>0&&(V=-V),Hm(W,V?V:-40)},unionPoint:function(M,w){if(!M)return U;if(2===arguments.length)return M&&w?{x:x(M.x,w.x),y:x(M.y,w.y),width:k(M.x-w.x),height:k(M.y-w.y)}:U;var J=M;if(J._as&&(J=J._as),J.length===c)return U;var j=J.length;if(0>=j)return U;for(var O=1,r=J[0],A={x:r.x,y:r.y,width:0,height:0};j>O;O++){r=J[O];var b=x(A.x,r.x),h=B(A.x+A.width,r.x),g=x(A.y,r.y),o=B(A.y+A.height,r.y);A.x=b,A.y=g,A.width=h-b,A.height=o-g}return A},unionRect:function(h,F){if(h&&!F)return ns(h);if(!h&&F)return ns(F);if(h&&F){var W={x:x(h.x,F.x),y:x(h.y,F.y)};return W.width=B(h.x+h.width,F.x+F.width)-W.x,W.height=B(h.y+h.height,F.y+F.height)-W.y,W}return U},containsPoint:function(E,R,o,N){if(N!=U&&1!==N){var I=E.x+E.width/2,x=E.y+E.height/2;E={x:I-E.width/2*N,y:x-E.height/2*N,width:E.width*N,height:E.height*N}}if(o){var a=E.width/2,V=E.height/2,k=_(-o),w=b(-o),H=R.x-E.x-a,z=R.y-E.y-V;return R={x:w*H-k*z,y:k*H+w*z},Qn({x:-a,y:-V,width:E.width,height:E.height},R)}return!(!E||R.x<E.x||R.y<E.y||R.x>E.x+E.width||R.y>E.y+E.height)},containsRect:function(y,M){if(!y||!M)return!1;var n=M.x,G=M.y,b=M.width,l=M.height,L=y.width,o=y.height;if(0>(L|o|b|l))return!1;var H=y.x,A=y.y;if(H>n||A>G)return!1;if(L+=H,b+=n,n>=b){if(L>=H||b>L)return!1}else if(L>=H&&b>L)return!1;if(o+=A,l+=G,G>=l){if(o>=A||l>o)return!1}else if(o>=A&&l>o)return!1;return!0},intersectsRect:function(s,C){if(!s||!C)return!1;var M=C.width,u=C.height,U=s.width,o=s.height;if(0>=U||0>=o||0>=M||0>=u)return!1;var F=C.x,V=C.y,A=s.x,d=s.y;return U+=A,o+=d,M+=F,u+=V,U>F&&o>V&&M>A&&u>d},intersection:function(m,v){if(!m||!v)return U;var c=v.x,b=v.y,M=m.x,s=m.y,j=c,S=b,$=M,E=s;return j+=v.width,S+=v.height,$+=m.width,E+=m.height,M>c&&(c=M),s>b&&(b=s),j>$&&(j=$),S>E&&(S=E),j-=c,S-=b,0>=j||0>=S?U:{x:c,y:b,width:j,height:S}},grow:function(B,S,M){M===c&&(M=S),B.x-=S,B.y-=M,B.width=B.width+2*S,B.height=B.height+2*M},getScreenPoint:function(o,t,K,r,e,V,E){var $=K.getBoundingClientRect(),O=o*(V||1)-K.scrollLeft+(r||0),c=t*(E||1)-K.scrollTop+(e||0),d=$h(K,!1);if(d){var C=new Cc(O,c,0);return C.applyMatrix4(d),console.log(C),{x:C.x,y:C.y}}return{x:O+$.left,y:c+$.top}},getLogicalPoint:function(Y,V,Z,H,R,$){var T,X,q=V.getBoundingClientRect();Y.target?(Pm(Y)?Un?Dk["91"]=!0:Dk["17"]=!0:Un?Dk["91"]=!1:Dk["17"]=!1,Dk["16"]=zm(Y)?!0:!1,Y=ig(Y)?pl(Y):Y,T=Y.clientX,X=Y.clientY):(T=Y.x,X=Y.y);var l=$h(V,!0);if(l){var h=new Cc(T,X,0);h.applyMatrix4(l);do{if(Math.abs(h.z)<=1e-6)break;var i=new Cc(T,X,1);if(i.applyMatrix4(matrix),Math.abs(i.z)<=1e-6){h=i;break}if(i.sub(h),Math.abs(i.z)<=1e-6)break;h.addScaledVector(i,-h.z/i.z)}while(!1);return{x:(h.x+V.scrollLeft-(Z||0))/(R||1),y:(h.y+V.scrollTop-(H||0))/($||1)}}return{x:(T-q.left+V.scrollLeft-(Z||0))/(R||1),y:(X-q.top+V.scrollTop-(H||0))/($||1)}},removeHTML:function(){var s;return function(C){return C&&C.getView&&(C=C.getView()),C&&C.parentNode?s===C?!0:(s=C,C.parentNode.removeChild(C),s=U,!0):!1}}(),getToolTipDiv:function(){if(!Gk){Gk=qg(),ff=qg();var B=Gk.style;G.baseZIndex!=U&&(B.zIndex=Ob(G.baseZIndex)+3+""),B.whiteSpace="nowrap",B.color=G.toolTipLabelColor,B.background=G.toolTipBackground,B.font=G.toolTipLabelFont,B.padding="5px",B.boxShadow="0px 0px 3px "+G.toolTipShadowColor}return Gk},isToolTipShowing:function(){return Gk&&Gk.parentNode?!0:ff&&ff.parentNode?!0:!1},updateToolTipContent:function(E,C){if(G.isToolTipShowing()&&(C||(C=xn&&xn.view),E===c&&C&&xn.e&&(E=C.getToolTip(xn.e)),E!=U)){var T;E.html?(E=E.html,T=ff):T=Gk,T.innerHTML=E}},hideToolTip:function(){if(G.isToolTipShowing()){Oi(Gk),Oi(ff),qm();var K=xn&&xn.view;K&&K.onHideToolTip&&K.onHideToolTip(),xn=U}},showToolTip:function(q,D,A){if(!q||D==U)return ho(),void 0;G.getToolTipDiv();var K,T;if(D.html?(D=D.html,K=ff,Oi(Gk)):(K=Gk,Oi(ff)),T=K.style,K.innerHTML=D,K.parentNode||C.Default.appendToScreen(K),q.target){q=Ul(q);var W=bs(),X=q.x,$=q.y,E=jg?60:12;if(jg){var m=K.getBoundingClientRect();T.left=X-m.width/2+Cm,T.top=$-m.height-E<W.top?$+E+Cm:$-m.height-E+Cm}else{T.left=X+E+Cm,T.top=$+E+Cm;var m=K.getBoundingClientRect();m.left+m.width>W.width&&(T.left=X-E-m.width+Cm),m.top+m.height>W.height&&(T.top=$-E-m.height+Cm),m.left<0&&(T.left=X+E+Cm),m.top<0&&(T.top=$+E+Cm)}}else T.left=q.x+Cm,T.top=q.y+Cm;qm(),A===c?A=xn&&xn.view:xn={e:q,view:A},A&&A.onShowToolTip&&A.onShowToolTip()
},startDragging:function(D,E,h){h==c&&(h=!0),D!==Sd&&(Sd?h&&(ig(E)?Sd.handleWindowTouchEnd(E):Sd.handleWindowMouseUp(E)):ig(E)?(d(i,Yh,Uo),d(i,Wn,Me)):(d(i,hr,Nq),d(i,wf,rp)),Sd=D)},getImageMap:function(){return $r},toBoundaries:function(V,Z,v,B){var S=[];return Yp(V,Z,v,B).forEach(function(E){var d=[];E.forEach(function(Z){d.push(Z.x,Z.y)}),S.push(d)}),S},getCurrentKeyCodeMap:function(){return Dk},drawCenterImage:function(U,K,A,j,z,G,D,l){!z&&G&&G.isSelfViewEvent&&(z=G);var H=Zo(K,z,G),d=Ge(K,z,G);kc(U,K,O(A-H/2),O(j-d/2),H,d,z,G,D,l)},drawStretchImage:function(e,h,W,g,K,N,F,I,$,b,T,t){!I&&$&&$.isSelfViewEvent&&(I=$);var v,E=Zo(h,I,$,N),B=Ge(h,I,$,F);"uniform"===W?(v=x(N/E,F/B),E*=v,B*=v,g+=O((N-E)/2),K+=O((F-B)/2),N=E,F=B):"centerUniform"===W&&((E>N||B>F)&&(v=x(N/E,F/B),E*=v,B*=v),g+=O((N-E)/2),K+=O((F-B)/2),N=E,F=B);var d=e.interactiveInfo;if(d){var X;if(X="center"===W?{x:g+N/2-E/2,y:K+F/2-B/2,width:E,height:B}:{x:g,y:K,width:N,height:F},d.rect){var J=d.compInfos,H=J.length;H&&(J[H-1].rect.image=h)}else d.rect=X}if("center"===W){var U=T!==!1&&(E>N||B>F);U&&(e.save(),e.beginPath(),e.rect(g,K,N,F),e.clip()),kc(e,h,g+N/2-E/2,K+F/2-B/2,E,B,I,$,b,t),U&&e.restore()}else kc(e,h,g,K,N,F,I,$,b,t)},toCanvas:function(_,B,h,i,V,Z,M,G,j){_=Kj(_,M),B=B||Zo(_,V),h=h||Ge(_,V);var I=Nb(),P=Rg(I);return G?(cs(I,B,h,G),P.scale(G,G)):cs(I,B,h,1),bl(P,_,i,0,0,B,h,V,Z,M,j),_&&_.clampToEdge&&(I.clampToEdge=_.clampToEdge),P.restore(),I},toGrayColor:function(_){if(!_)return _;var E=Ie(_),w=O(.299*E[0]+.587*E[1]+.114*E[2]);return"rgba("+w+","+w+","+w+","+E[3]/255+")"},createGradientImage:function(q,F,Z,E){for(var p=["L",0,0,q,0,1,0,0,1,0,0],e=0,L=Math.min(F.length,Z.length);L>e;e++)p.push(Z[e],F[e]);var D=C.Default.toCanvas({width:q,height:q,clampToEdge:!0,comps:[{type:"shape",rotation:E||0,points:[0,0,q,0,q,q,0,q],background:"#ffffff",gradientPack:p}]});return D},createElement:function(p,s,y,E){var A=X.createElement(p);return sg(A,s||P.widgetBorder,2),A.style.font=y?y:fj,E!=U&&(A.value=E),G.onElementCreated&&G.onElementCreated(A),A},containedInView:function(Z,w){var t=Ec(w).getBoundingClientRect();return Qn({x:t.left,y:t.top,width:t.width,height:t.height},Ae(Z))},isIsolating:function(){return Hc>0},setIsolating:function(K){K?Hc++:Hc--},getMSMap:function(){return Gg},stringify:function(a,b,y){var J=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var z=sm.prototype.toJSON;sm.prototype.toJSON=function(){return"__ht__dataModel"+this.serialize(0)},b=y?0:b==U?2:b;var F=JSON.stringify(a,function(A,R){return"function"==typeof R?"__ht__"+(R.__ht__||R.toString()):Bk(R)?Or(R):R instanceof C.List?"__ht__list"+(R.__ht__list||G.stringify(R._as)):R},b);return Date.prototype.toJSON=J,sm.prototype.toJSON=z,y&&(F=Vi+eo(F)),F},parse:function(s,u){return ak(s)?s.substr(0,12)!=Vi||(s=Mb(s.substr(12)),ak(s))?(u=u||{},JSON.parse(s,function(S,d){if(ak(d))if(u.ignoreFunction||"__ht__function"!=d.substr(0,14)){if(!u.ignoreDate&&"__ht__date"==d.substr(0,10))return new Date(Ob(d.substr(10)));if("__ht__list"===d.substr(0,10))return new Vo(G.parse(d.substr(10)));if(!u.ignoreDataModel&&"__ht__dataModel"===d.substr(0,15)){var N=new sm;return N.deserialize(G.parse(d.substr(15))),N}}else{var Q=d.indexOf("{")+1,b=d.lastIndexOf("}"),O=d.indexOf("(")+1,k=d.indexOf(")");if(Q&&b&&O&&k)try{var V=new Function(d.substring(O,k),d.substring(Q,b));return V.__ht__=d.substr(6),V}catch(g){throw console.info("=== SyntaxError ===\n",d),g}}return d})):s:s},loadJS:function(M,n){n&&M.push(n);var l=M.shift();if(zo(l))M=l.contact(M),G.loadJS(M);else if(kk(l))l(),G.loadJS(M);else if(ak(l)){var v=X.createElement("script");v.onload=function(){G.loadJS(M)},v.setAttribute("src",l),X.getElementsByTagName("head")[0].appendChild(v)}else M.length&&G.loadJS(M)},extendClass:function(p,m){var V=p.prototype;for(var _ in m)Gg[_]&&Gg.hasOwnProperty(_)?Gg[_](V,m):V[_]=m[_]},toRoundedCorner:function(){function y(A,K,g){A.x=K.x,A.y=K.e||g,A.z=K.y}var m=new Cc,R=new Cc,M=new Cc,A=new Cc;return function(Z,n){var $,U=0;Z.getPoints&&(U=Z.getElevation(),Z=Z.getPoints()),$=Z instanceof Vo?Z:new Vo(Z);var G=$.size();if(0>=n)return{points:$};var Y=new Vo,j=new Vo,I=$.get(0);y(m,I,U),Y.add(I),j.add(1);for(var S=1;G>S;S++)if(G>S+1){var l=$.get(S),v=$.get(S+1);y(R,l,U),y(M,v,U),A.subVectors(m,R).setLength(Math.min(.99*A.length(),n)).add(R),l.e!==c||I.e!==c?Y.add({x:A.x,y:A.z,e:A.y}):Y.add({x:A.x,y:A.z}),Y.add(l),A.subVectors(M,R).setLength(Math.min(.99*A.length(),n)).add(R),l.e!==c||v.e!==c?Y.add(I={x:A.x,y:A.z,e:A.y}):Y.add(I={x:A.x,y:A.z}),m.copy(A),j.addAll([2,3])}else Y.add($.get(S)),j.add(2);return{points:Y,segments:j}}}(),toColorData:Ie,setCanvas:cs,createDiv:qg,createDisabledDiv:vl,createView:np,createCanvas:Nb,appendChild:zp,initContext:Rg,checkLoadingImage:hd,translateAndScale:id,layout:Gq,getPosition:Ml,drawPoints:Xk,drawRoundRect:vb,drawBorder:ni,setFocus:wb,getter:rs,setter:Iq,isEmptyObject:bi,cameraPriority:function(){var N={skybox:0,main:1e4,top:1e7,infinity:1/0};return g.seal(g.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return N.skybox},set:function($){if($>=N.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");N.skybox=Number($)}},main:{configurable:!1,enumerable:!1,get:function(){return N.main},set:function(w){if(w<=N.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(w>=N.top)throw new RangeError("Main camera must have lower priority than the top camera.");N.main=Number(w)}},top:{configurable:!1,enumerable:!1,get:function(){return N.top},set:function(n){if(n<=N.main)throw new RangeError("Top camera must have higher priority than the main camera.");N.top=Number(n)}}}))}()},!0),hn(r,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var _r=G.disabledOpacity,On=G.toolTipDelay,vm=G.devicePixelRatio,ud=G.autoMakeVisible,gn=G.autoHideScrollBar,nd=G.imageGradient,nn=G.showToolTip,ho=G.hideToolTip,qc=G.dashPattern,df=G.lineCap,Mk=G.lineJoin,Cj=G.labelColor,ag=G.labelSelectColor,fj=G.labelFont,Yk=G.widgetIndent,uj=G.widgetRowHeight,bm=G.widgetHeaderHeight,pi=G.widgetTitleHeight,vi=G.scrollBarColor,Ud=G.scrollBarSize,dh=G.scrollBarTimeout,Cs=G.scrollBarMinLength,sj=G.scrollBarInteractiveSize,lb=G.zoomIncrement,ug=G.scrollZoomIncrement,Qg=G.pinchZoomIncrement,ss=G.zoomMax,Mq=G.zoomMin,ll=G.createObject,Uh=G.preventDefault,or=G.setImage,Kj=G.getImage,lr=G.isImageComplete,Gf=G.drawCenterImage,bl=G.drawStretchImage,uh=G.getId,xk=G.callLater,An=G.cancelLater,Dd=G.sortFunc,ns=G.clone,Ef=G.getClass,Jn=G.startAnim,Yf=G.brighter,Yd=G.darker,hl=G.drawText,ei=G.getTextSize,dr=G.isLeftButton,Ni=G.isMiddleButton,Ug=G.isRightButton,mq=G.getTouchCount,ar=G.isDoubleClick,zm=G.isShiftDown,Pm=G.isCtrlDown,Ae=G.getClientPoint,Ul=G.getPagePoint,Sn=G.getDistance,Fq=G.unionPoint,Pj=G.unionRect,Qn=G.containsPoint,Hn=G.containsRect,$f=G.intersectsRect,Wp=G.intersection,bs=G.getWindowInfo,sr=G.grow,Ag=G.getLogicalPoint,sk=G.getScreenPoint,Ir=G.startDragging,Oi=G.removeHTML,Ci=G.createElement,Rq=G.segmentResolution,Hb=G.shapeResolution,kj=G.shapeSide,Bb=G.def,ub=function(h,Y,Z){Bb(s+"."+h,Y,Z)},ri=function(x,f){x.childNodes.forEach(function(D){f(D),ri(D,f)})};hn(G,{toolTipLabelColor:Cj,toolTipLabelFont:fj,toolTipBackground:P.toolTipBackground,toolTipShadowColor:zn,debugTipLabelFont:fj,debugTipLabelColor:Cj,debugTipBackground:P.toolTipBackground,drawBreakableText:Gr,setDevicePixelRatio:function(l){vm=G.devicePixelRatio="number"==typeof l?l:i.screen?i.screen.deviceXDPI/i.screen.logicalXDPI:1,ri(X.body,function(X){var v=X._ht;v&&v._canvas&&(cs(v._canvas,v.getWidth(),v.getHeight()),v.redraw?v.redraw():v.iv())})}},!0);var Rr=1e-6,dn="undefined"!=typeof Uint16Array?Uint16Array:Array,Ek="undefined"!=typeof Float32Array?Float32Array:Array,Wc=function(R,U,Q){var x=[R[0]-U[0],R[1]-U[1],R[2]-U[2]];if(Q){var o=Sn(x);o>0&&(x[0]/=o,x[1]/=o,x[2]/=o)}return x},fc=function(){var p="charCodeAt",I=2*(2*Cq.length+1);for(var l in i)if(l===s+Ld[0]+(Cm.length+2)){var v=i[l];if(!v)break;for(var m=v.length,$=0;m>$;$++)if(v[$][p](0)===I&&v[$+1]!=U&&v[$+1]===Cm[0]&&v[$+2]!=U&&v[$+2][p](0)===I){for(var Y=$+3;m>Y;Y++)if(v[Y][p](0)===I){if(0==v[Y+1])for(var J,K=Y+2;m>K;K++){if(v[K][p](0)===I){0==v[K-1]&&J&&(Ue=J.substr(0,J.length-1));break}J==U?J=v[K]:J+=v[K]}break}break}break}return function(n){return[-n[0],-n[1],-n[2]]}}(),hk=function(z,P){return 3===z.length?z[0]*P[0]+z[1]*P[1]+z[2]*P[2]:z[0]*P[0]+z[1]*P[1]},Tj=function(){var Y=new Array(16);return Y[0]=1,Y[1]=0,Y[2]=0,Y[3]=0,Y[4]=0,Y[5]=1,Y[6]=0,Y[7]=0,Y[8]=0,Y[9]=0,Y[10]=1,Y[11]=0,Y[12]=0,Y[13]=0,Y[14]=0,Y[15]=1,Y},Zf=Tj(),md=function(A){var H=new Array(16);return H[0]=A[0],H[1]=A[1],H[2]=A[2],H[3]=A[3],H[4]=A[4],H[5]=A[5],H[6]=A[6],H[7]=A[7],H[8]=A[8],H[9]=A[9],H[10]=A[10],H[11]=A[11],H[12]=A[12],H[13]=A[13],H[14]=A[14],H[15]=A[15],H},bd=function(r,F){return r[0]=F[0],r[1]=F[1],r[2]=F[2],r[3]=F[3],r[4]=F[4],r[5]=F[5],r[6]=F[6],r[7]=F[7],r[8]=F[8],r[9]=F[9],r[10]=F[10],r[11]=F[11],r[12]=F[12],r[13]=F[13],r[14]=F[14],r[15]=F[15],r},is=function(k){return k[0]=1,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=1,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[10]=1,k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,k},lp=function(g,q){var j=g[0],r=g[1],s=g[2];return g[0]=q[0]*j+q[4]*r+q[8]*s+q[12],g[1]=q[1]*j+q[5]*r+q[9]*s+q[13],g[2]=q[2]*j+q[6]*r+q[10]*s+q[14],g},je=function(r,s){var c=r[0],v=r[1],U=r[2],H=r[3];return r[0]=s[0]*c+s[4]*v+s[8]*U+s[12]*H,r[1]=s[1]*c+s[5]*v+s[9]*U+s[13]*H,r[2]=s[2]*c+s[6]*v+s[10]*U+s[14]*H,r[3]=s[3]*c+s[7]*v+s[11]*U+s[15]*H,r},mf=function(){var u,e,b,A,P=Yo(ac[1]+ac[7]),d=Yo(ac[0]+ac[3]-ac[10]),W=Yo(ac[8]+2),y=function(){return e=b.charAt(u),u+=1,e},S=function(){var c="";if(e===W)for(;y();){if(e===W)return y(),c;c+=e}else y()},D=function(){for(;e&&" ">=e;)y()},O=function(){var Y,r={};if(e===P){if(y(),D(),e===d)return y(),r;for(;e;){if(Y=S(),D(),y(),r[Y]=A(),D(),e===d)return y(),r;y(),D()}}};return A=function(){switch(D(),e){case P:return O();default:return S()}},function(k){if(m={},k){var o;if(b=k,u=0,e=" ",o=A(),D(),!e)return o}}}(),Oo=function(h,d){if(d){var M=_(d),a=b(d),g=h[4],t=h[5],T=h[6],C=h[7],i=h[8],y=h[9],m=h[10],X=h[11];h[4]=g*a+i*M,h[5]=t*a+y*M,h[6]=T*a+m*M,h[7]=C*a+X*M,h[8]=i*a-g*M,h[9]=y*a-t*M,h[10]=m*a-T*M,h[11]=X*a-C*M}},Tk=function(n,y){if(y){var l=_(y),V=b(y),I=n[0],K=n[1],e=n[2],x=n[3],C=n[8],M=n[9],S=n[10],G=n[11];n[0]=I*V-C*l,n[1]=K*V-M*l,n[2]=e*V-S*l,n[3]=x*V-G*l,n[8]=I*l+C*V,n[9]=K*l+M*V,n[10]=e*l+S*V,n[11]=x*l+G*V}},Xd=function(K,p){if(p){var i=_(p),C=b(p),V=K[0],r=K[1],j=K[2],t=K[3],E=K[4],U=K[5],A=K[6],k=K[7];K[0]=V*C+E*i,K[1]=r*C+U*i,K[2]=j*C+A*i,K[3]=t*C+k*i,K[4]=E*C-V*i,K[5]=U*C-r*i,K[6]=A*C-j*i,K[7]=k*C-t*i}},Jl=function(q,o,V){return Ak(U,V===!1?U:q.getFinalScale3d(),q.getFinalRotation3d(),q.getRotationMode(),q.p3(),U,o)},Ak=function(z,c,f,p,w,h,K){return h||(h=Tj()),w&&Ic(h,w),rb(h,f,p),K&&Lo(h,h,K),c&&$j(h,c),z&&Lo(h,h,z),h},Pp=function(n,X,U){X=Ob(X),U=Ob(U);var h=this;h.g=n,h._84O=X,h._85O=U,h._70I=!0,h.F=0,h._83O=X+U,h.pen={x:0,y:0}},vk="lineDashOffset",Pl="setLineDash",Yc=function(N){for(var w in N)1===w.length&&(vk=N[w]);return w?1:0},rl=function(y,Q,j){return $d(Q)?y:y[Pl]?(y[Pl](Q),j&&(y.lineDashOffset=j),y):new Pp(y,Q[0],Q.length>1?Q[1]:Q[0])},of=function(v,M){!$d(M)&&v[Pl]&&(v[Pl](Ln),v.lineDashOffset=0)};Bb(Pp,g,{_69I:6,moveTo:function(k,a){var L=this,x=L.pen;x.x=k,x.y=a,L.g.moveTo(k,a),L.start||(L.start={x:k,y:a})},lineTo:function(t,V){var g=this,Y=g.pen,F=t-Y.x,Q=V-Y.y,C=dj(Q,F),v=b(C),B=_(C),$=g._23O(Y.x,Y.y,t,V),s=g._85O,j=g._84O,w=g._83O;if(g.F){if(g.F>$)return g._70I?g._72I(t,V):g.moveTo(t,V),g.F-=$,void 0;if(g._70I?g._72I(Y.x+v*g.F,Y.y+B*g.F):g.moveTo(Y.x+v*g.F,Y.y+B*g.F),$-=g.F,g.F=0,g._70I=!g._70I,!$)return}var I=A($/w);if(I){for(var U=v*j,E=B*j,X=v*s,l=B*s,p=0;I>p;p++)g._70I?(g._72I(Y.x+U,Y.y+E),g.moveTo(Y.x+X,Y.y+l)):(g.moveTo(Y.x+X,Y.y+l),g._72I(Y.x+U,Y.y+E));$-=w*I}g._70I?$>j?(g._72I(Y.x+v*j,Y.y+B*j),g.moveTo(t,V),g.F=s-($-j),g._70I=!1):(g._72I(t,V),$===j?(g.F=0,g._70I=!g._70I):(g.F=j-$,g.moveTo(t,V))):$>s?(g.moveTo(Y.x+v*s,Y.y+B*s),g._72I(t,V),g.F=j-($-s),g._70I=!0):(g.moveTo(t,V),$===s?(g.F=0,g._70I=!g._70I):g.F=s-$)},quadraticCurveTo:function(O,E,u,s){var G,f=this,t=f.pen,l=t.x,z=t.y,r=f._22O(l,z,O,E,u,s),w=0,Y=0,Q=f._85O,a=f._84O;if(f.F){if(f.F>r)return f._70I?f._71I(O,E,u,s):f.moveTo(u,s),f.F-=r,void 0;if(w=f.F/r,G=f._20O(l,z,O,E,u,s,w),f._70I?f._71I(G[2],G[3],G[4],G[5]):f.moveTo(G[4],G[5]),f.F=0,f._70I=!f._70I,!r)return}var h=r-r*w,e=A(h/f._83O),$=a/r,k=Q/r;if(e)for(var K=0;e>K;K++)f._70I?(Y=w+$,G=f._21O(l,z,O,E,u,s,w,Y),f._71I(G[2],G[3],G[4],G[5]),w=Y,Y=w+k,G=f._21O(l,z,O,E,u,s,w,Y),f.moveTo(G[4],G[5])):(Y=w+k,G=f._21O(l,z,O,E,u,s,w,Y),f.moveTo(G[4],G[5]),w=Y,Y=w+$,G=f._21O(l,z,O,E,u,s,w,Y),f._71I(G[2],G[3],G[4],G[5])),w=Y;h=r-r*w,f._70I?h>a?(Y=w+$,G=f._21O(l,z,O,E,u,s,w,Y),f._71I(G[2],G[3],G[4],G[5]),f.moveTo(u,s),f.F=Q-(h-a),f._70I=!1):(G=f._19O(l,z,O,E,u,s,w),f._71I(G[2],G[3],G[4],G[5]),r===a?(f.F=0,f._70I=!f._70I):(f.F=a-h,f.moveTo(u,s))):h>Q?(Y=w+k,G=f._21O(l,z,O,E,u,s,w,Y),f.moveTo(G[4],G[5]),G=f._19O(l,z,O,E,u,s,Y),f._71I(G[2],G[3],G[4],G[5]),f.F=a-(h-Q),f._70I=!0):(f.moveTo(u,s),h===Q?(f.F=0,f._70I=!f._70I):f.F=Q-h)},bezierCurveTo:function(){var R=arguments;this.pen={x:R[4],y:R[5]},this.g.bezierCurveTo(R[0],R[1],R[2],R[3],R[4],R[5])},arc:function(D,Y,r,l,S,U){U||(l=-l,S=-S),_g(this,D,Y,l,S-l,r,r,!1)},rect:function(i,U,Y,K){var H=this;H.pen={x:i,y:U},H.moveTo(i,U),H.lineTo(i,U+K),H.lineTo(i+Y,U+K),H.lineTo(i+Y,U),H.lineTo(i,U)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(n,H,V,v){var G=V-n,P=v-H;return j(G*G+P*P)},_22O:function(a,e,S,G,u,O,z){for(var s,F,y,T,$,P,E,A=0,o=a,h=e,j=z>0?z:this._69I,x=1;j>=x;x++)y=x/j,T=1-y,$=T*T,P=2*y*T,E=y*y,s=$*a+P*S+E*u,F=$*e+P*G+E*O,A+=this._23O(o,h,s,F),o=s,h=F;return A},_21O:function(O,g,i,s,V,U,Q,v){var H=this;if(0===Q)return H._20O(O,g,i,s,V,U,v);if(1===v)return H._19O(O,g,i,s,V,U,Q);var N=H._20O(O,g,i,s,V,U,v);return N.push(Q/v),H._19O.apply(H,N)},_20O:function(Q,l,D,u,L,z,W){if(1!==W){var G=D+(L-D)*W,v=u+(z-u)*W;D=Q+(D-Q)*W,u=l+(u-l)*W,L=D+(G-D)*W,z=u+(v-u)*W}return[Q,l,D,u,L,z]},_19O:function(v,m,p,f,N,R,V){if(1!==V){var M=v+(p-v)*V,o=m+(f-m)*V;p+=(N-p)*V,f+=(R-f)*V,v=M+(p-M)*V,m=o+(f-o)*V}return[v,m,p,f,N,R]},_72I:function(N,I){var Z=this.pen;(N!==Z.x||I!==Z.y)&&(Z.x=N,Z.y=I,this.g.lineTo(N,I))},_71I:function(T,f,x,p){var g=this.pen;(T!==x||f!==p||x!==g.x||p!==g.y)&&(g.x=x,g.y=p,this.g.quadraticCurveTo(T,f,x,p))}}),Gg.ms_quickVisible=function(q){q._4BQ=!1,q._4CQ=function(f){var b=f._4EQ;return b!==c?b:b=f._4EQ=this._4FQ(f)},q._4DQ=function($){if(!$)return this.dm().each(function(I){I._4EQ=c}),void 0;$._4EQ=c;var S=this;if($ instanceof af||Di($)||$ instanceof qn||$.ISubGraph)$.eachChild(function(c){S.invalidateQuickVisible(c)});else if($.getEdges){var C=$.getEdges();C&&C.each(function(F){S.invalidateQuickVisible(F)})}},q.enableQuickVisibleMode=function(){this._4BQ||(this._4BQ=!0,this._4FQ=this.isVisible,this.isVisible=this._4CQ,this.invalidateQuickVisible=this._4DQ)},q.disableQuickVisibleMode=function(){this._4BQ&&(this._4BQ=!1,this.isVisible=this._4FQ,this.invalidateQuickVisible=cp)},q.isQuickVisibleMode=function(){return this._4BQ},q.invalidateQuickVisible=cp},Wi=Al()+1,Xj&&i.console&&Wi&&!1&&(i.navigator&&i.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?i.console.log.apply(console,["Hightopo - Version："+C.Default.getVersion()+" - %cTrial：http://hightopo.com/request.html","color: #f00;"]):i.console.log("Hightopo - Version："+C.Default.getVersion()+" - Trial：http://hightopo.com/request.html"));var wd=U,Zj=U,Hp=G.checkLoadingCompType=function(e){wd&&!e._72O_&&(Zj||(Zj={}),Zj[e._72O_=uh()]=e)},Sr=function(g,Q){if(Q||(Q=g),Q&&(wd||(wd={}),!wd[g])){var v=new Wh;if(wd[Q]={request:v,url:Q},Q=G.beforeLoadURL(Q,g),Q.data){var j=G.parse(Q.data);Jp(g,j),G.handleCompTypeLoaded(g,j)}else{v.onload=function(){if(200===this.status||0===this.status){var I=G.parse(v.getResponseText());Jp(g,I),G.handleCompTypeLoaded(g,I)}else Jp(g,U)},v.onerror=function(){Jp(g,U)};var C={};C.url=encodeURI(Q),C.sync=!1,v.send(C)}}},Jp=function(O,_){if(Dh[O]=_,delete wd[O],bi(wd)&&(wd=U,Zj)){for(var J in Zj){var R=Zj[J];R.invalidateAll&&R.invalidateAll(c,"compTypeLoaded",O),R.redraw&&R.redraw(),R.iv(),delete R._72O_}Zj=U}if(_&&Zj)for(var J in Zj){var R=Zj[J];R.invalidateAll&&R.invalidateAll(c,"compTypeLoading",O),R.redraw&&R.redraw(),R.iv()}},Mo=P.chart,Ng="",jr=!0,cg=G.compStack=[],_d=/^style@/,Gd=/^attr@/,ml=/^field@/,Fi={x:.5,y:.5},ps=function(){jr=!0},fp=function(){return jr},Zo=function(E,K,f,b){if(!E)return 0;if(zi(E.fitSize,K,f)&&b)return b;var m=zi(E.width,K,f);return null==m?20:m},Ge=function(s,P,Q,e){if(!s)return 0;if(zi(s.fitSize,P,Q)&&e)return e;var q=zi(s.height,P,Q);return null==q?20:q},zi=function(g,Z,X){if(!g||!g.func)return g;var N,A=g.func,I=g.value;return N=kk(A)?X&&X.vectorDataBindingDisabled&&!g.isSafeFunc?I:A(Z,X):Z instanceof Cb||(C.ui?Z instanceof C.ui.View:0)?Gd.test(A)?Z.a(Ng+A.slice(5)):_d.test(A)?Z.s(Ng+A.slice(6)):ml.test(A)?Z[A.slice(6)]:Z[A]?Z[A](X):I:I,I!==c&&N==U?I:N},kc=G.drawImage=function(){var j,M,p,Z,$,N,m=3,S=6,z=function(q){var L,o,i,u=!1;return f(q,"shadow")&&(L=f(q,"shadowOffsetX")||m,o=f(q,"shadowOffsetY")||m,i=f(q,"shadowBlur")||S,u=!0),!u&&M instanceof Cb&&((go(M,qq,"shadow")||"shadow"===go(M,qq,"select.type")&&p&&p.isSelected&&p.isSelected(M))&&(L=go(M,qq,"shadow.offset.x")||0,o=go(M,qq,"shadow.offset.y")||0,i=go(M,qq,"shadow.blur")||0,u=!0),!u&&go(M,qq,"shadow2")&&(L=go(M,qq,"shadow2.offset.x")||0,o=go(M,qq,"shadow2.offset.y")||0,i=go(M,qq,"shadow2.blur")||0,u=!0)),u?1.5*i+Math.max(L,o):0},n=function(t,Z){t.getValue&&t.getValue.compType===Z||(t.getValue=function(o){var w=f(t,o);if(w===c&&Z.properties){var s=Z.properties[o];s&&(w=s.defaultValue)}return w},t.getColor=function(Y,x){return x===!0?V(Y):V(t.getValue(Y))},t.getValue.compType=Z)},f=function(Z,j,A){var f,s=!1;if(Z.prefix&&M instanceof Cb){var Q=M.a(Ng+j);Q!==c&&(s=!0,f=Q)}return f===c&&(f=Z[j]),f&&f.func&&(s=!0,f=zi(f,M,p)),A&&(f=A(f),s||(Z[j]=f)),f},V=function(B,u){var M;return M=u?f(B,u):B,j&&j.compGray&&M?G.toGrayColor(M):$&&M?ip(M,$,N):M},u=function(P){if(zo(P)){for(var C=new Vo,w=P.length,p=0;w>p;p+=2)C.add({x:P[p],y:P[p+1]});P=C}return P},J=function(H){var x=f(H,"anchorX"),E=f(H,"anchorY");if(x!==c||E!==c)return{x:x===c?Fi.x:x,y:E===c?Fi.y:E};var C=f(H,"type"),t=f(H,"name");if("image"!==C||!t)return Fi;var b=Kj(t);return b&&b.anchorX!==c&&b.anchorY!==c?{x:b.anchorX,y:b.anchorY}:Fi},R=function(q,D){var P=f(q,co),M=J(q);if(zo(P)){var I=P.length,V=f(q,"relative"),d=D.width,H=D.height;if(4===I)P={x:P[0],y:P[1],width:P[2],height:P[3]},V&&(P.x*=d,P.y*=H,P.width*=d,P.height*=H);else if(3===I){var p=P[0];P={width:P[1],height:P[2]},V&&(P.width*=d,P.height*=H),"object"==typeof p?p.length&&(p={x:p[0],y:p[1]}):p=Ml(p,D,P),P.x=p.x-P.width*M.x,P.y=p.y-P.height*M.y}P.x+=f(q,"offsetX")||0,P.y+=f(q,"offsetY")||0,!V&&D.fitSize&&(P=E(q,P,D))}return P},E=function(P,k,E){if(k){var D,r,b,V={x:k.x,y:k.y,width:k.width,height:k.height},S=J(P),Z=f(P,"layoutH"),a=f(P,"layoutV"),o=1,F=1,g=0,q=0,t=1,x=1;switch(Z){case"left":break;case"right":V.x+=E.width-E.rw;break;case"center":V.x+=.5*(E.width-E.rw);break;case"scale":case"leftright":default:D=f(P,ee)||0,D&&(g=Math.abs(q=Math.sin(D)),t=Math.abs(x=Math.cos(D))),"leftright"!==Z?(o+=t*(E.widthScale-1),F+=g*(E.widthScale-1)):(o+=V.width?t*(E.width-E.rw)/V.width:0,F+=V.height?g*(E.width-E.rw)/V.height:0,r=-Math.min(-S.x*x+S.y*q,-S.x*x-(1-S.y)*q,(1-S.x)*x+S.y*q,(1-S.x)*x-(1-S.y)*q))}switch(a){case"top":break;case"bottom":V.y+=E.height-E.rh;break;case"center":V.y+=.5*(E.height-E.rh);break;case"scale":case"topbottom":default:D==U&&(D=f(P,ee),D&&(g=Math.abs(q=Math.sin(D)),t=Math.abs(x=Math.cos(D)))),"topbottom"!==a?(o+=g*(E.heightScale-1),F+=t*(E.heightScale-1)):(o+=V.width?g*(E.height-E.rh)/V.width:0,F+=V.height?t*(E.height-E.rh)/V.height:0,b=-Math.min(-S.x*q-S.y*x,-S.x*q+(1-S.y)*x,(1-S.x)*q-S.y*x,(1-S.x)*q+(1-S.y)*x))}return(1!==o||1!==F)&&("scale"!==Z&&Z?"leftright"===Z&&(V.x+=V.width*(1-o)*S.x+r*(E.width-E.rw)):V.x+=V.x*(E.widthScale-1)+S.x*V.width*(E.widthScale-o),"scale"!==a&&a?"topbottom"===a&&(V.y+=V.height*(1-F)*S.y+b*(E.height-E.rh)):V.y+=V.y*(E.heightScale-1)+S.y*V.height*(E.heightScale-F),V.width*=o,V.height*=F),V.width<0&&(V.width=0),V.height<0&&(V.height=0),V}},r=function(T){return zo(T)?new Vo(T):T},F=function(d,n,I,B,C,x,F){var L=j.interactiveInfo,X=d.transform;if(X)return j.save(),j.setTransform(X.a,X.b,X.c,X.d,X.tx,X.ty),L&&L.compInfos.push({comp:d,rect:n,matrix:X.clone(),prefix:Ng,refRect:L.refRect}),!0;C===c&&(C=1),x===c&&(x=1);var Q=f(d,"clipPercentage"),e=Gn(I,n);if(e&&!B&&1===C&&1===x&&!(1>Q))return L&&L.compInfos.push({comp:d,rect:n,matrix:L.matrix.clone(),prefix:Ng,refRect:L.refRect}),!1;F=F||Fi;var o=n.x+n.width*F.x,K=n.y+n.height*F.y,p=I.x+I.width*F.x,u=I.y+I.height*F.y,S=I.width?C*(n.width/I.width):1,G=I.height?x*(n.height/I.height):1;if(j.save(),L&&(L.matrix.appendTranslate(o,K).appendRotate(B).appendScale(S,G).appendTranslate(-p,-u),L.compInfos.push({comp:d,rect:n,matrix:L.matrix.clone(),prefix:Ng,refRect:L.refRect})),Xg(j,o,K),tp(j,B||0),Ze(j,S,G),Xg(j,-p,-u),1>Q){0>Q&&(Q=0);var T=rd(I,f(d,"clipDirection"),Q,z(d));j.beginPath(),j.rect(T.x,T.y,T.width,T.height),j.clip()}return!0},K=function(){j.restore()},D=function(h,$,r){var w=f(h,"path"),A=f(h,ee),Q=f(h,"scaleX"),L=f(h,"scaleY"),t=J(h),o=U,y=zh(null,w);if(r||(r=h.unionRect,r||(r=Fq(y),h.path.func||(h.unionRect=r)),o=r),r){o||(o=h.unionRect,o||(o=Fq(y),h.path.func||(h.unionRect=o)));var b=F(h,r,o,A,Q,L,t),E=f(h,"borderPattern"),g=rl(j,E),H=V(h,"background"),k=V(h,"borderColor"),N=f(h,"borderWidth"),Y=f(h,"gradient"),n=V(h,"gradientColor"),m=f(h,"border3d"),C=V(h,"border3dColor"),R=f(h,"border3dAccuracy"),q=j.lineJoin,O=j.lineCap;j.lineJoin=f(h,"borderJoin")||Mk,j.lineCap=f(h,"borderCap")||df,H?(Jh(j,H,Y,n,o),zh(j,w),j.fill(),g!==j&&zh(j,w)):zh(j,w);var W=f(h,"borderWidthAbsolute");if(W&&(j.save(),j.setTransform(1,0,0,1,0,0)),N&&k&&(j.lineWidth=N,j.strokeStyle=k,j.stroke(),m&&_j(j,k,C,N,Z,R)),of(j,E),f(h,"dash")){var d=f(h,"dashWidth")||N;if(d>0){E=f(h,"dashPattern")||qc;var g=rl(j,E,f(h,"dashOffset")),v=V(h,"dashColor")||V(Vn);g!==j&&zh(j,w),j.strokeStyle=v,j.lineWidth=d,j.stroke(),f(h,"dash3d")&&_j(j,v,V(h,"dash3dColor"),d,Z,f(h,"dash3dAccuracy")),of(j,E)}}W&&j.restore(),$===co&&ve(j,H,f(h,"depth"),o),j.lineJoin=q,j.lineCap=O,b&&K()}},o=function(_,A,b,X){var S=f(_,vn,u),Q=f(_,ee),O=J(_);if(S&&X.fitSize){var t=new Vo,d=Fq(S),v=E(_,d,X),D=d.x+O.x*d.width,x=d.y+O.y*d.height,P=v.x+O.x*v.width,o=v.y+O.y*v.height,W=d.width?v.width/d.width:1,Y=d.height?v.height/d.height:1;S.each(function(u){t.add({x:P+(u.x-D)*W,y:o+(u.y-x)*Y})}),S=t,_.unionRect=null}var y=f(_,"scaleX"),H=f(_,"scaleY"),i=A===gs,C=U;if(!b&&i&&(b=_.unionRect,b||(b=Fq(S),_.points.func||(_.unionRect=b)),C=b),b){i?C||(C=_.unionRect,C||(C=Fq(S),_.points.func||(_.unionRect=C))):C=b;var m,R,e,L,h=F(_,b,C,Q,y,H,O),s=f(_,"borderPattern"),g=rl(j,s),G=V(_,"background"),I=Kj(f(_,"repeatImage"),$,N),l=f(_,"gradientPack"),T=f(_,"borderGradientPack"),k=V(_,"borderColor"),n=f(_,"borderWidth"),w=Kj(f(_,"borderRepeatImage"),$,N),c=f(_,"segments",r),B=f(_,"gradient"),q=V(_,"gradientColor"),a=f(_,"border3d"),un=V(_,"border3dColor"),bj=f(_,"border3dAccuracy"),ws=f(_,"closePath"),Yp=f(_,"fillRule")||"nonzero",dn=j.lineJoin,$e=j.lineCap,nl=z(_);if(j.lineJoin=f(_,"borderJoin")||Mk,j.lineCap=f(_,"borderCap")||df,i)if(G||I||l){var ob=f(_,"fillClipPercentage");if(1>ob){0>ob&&(ob=0);var Pi=rd(C,f(_,"fillClipDirection"),ob,nl);j.save(),j.beginPath(),j.rect(Pi.x,Pi.y,Pi.width,Pi.height),j.clip()}Xk(j,S,c,ws),l?lh(j,l,V,!1,b):I?jl(j,I,$,N,M,p):Jh(j,G,B,q,C),j.fill(Yp),l&&j.restore(),1>ob&&j.restore(),g!==j&&Xk(g,S,c,ws)}else Xk(g,S,c,ws);else if("roundRect"===A?m=f(_,"cornerRadius"):"polygon"===A?m=f(_,"polygonSide"):"arc"===A&&(m=f(_,"arcFrom"),R=f(_,"arcTo"),e=f(_,"arcClose"),L=f(_,"arcOval")),G||I||l){var ob=f(_,"fillClipPercentage");if(1>ob){0>ob&&(ob=0);var Pi=rd(C,f(_,"fillClipDirection"),ob,nl);j.save(),j.beginPath(),j.rect(Pi.x,Pi.y,Pi.width,Pi.height),j.clip()}Vh(j,A,C,m,R,e,L),l?lh(j,l,V,!1,b):I?jl(j,I,$,N,M,p):Jh(j,G,B,q,C),j.fill(Yp),l&&j.restore(),1>ob&&j.restore(),j!==g&&Vh(g,A,C,m,R,e,L)}else Vh(g,A,C,m,R,e,L);var tj=f(_,"borderWidthAbsolute");if(tj&&(j.save(),j.setTransform(1,0,0,1,0,0)),n&&(k||w||T)&&(j.lineWidth=n,T?lh(j,T,V,!0,b):w?ks(j,w,$,N,M,p):j.strokeStyle=k,j.stroke(),T&&j.restore(),a&&_j(j,k,un,n,Z,bj)),of(j,s),f(_,"dash")){var Bk=f(_,"dashWidth")||n;if(Bk>0){s=f(_,"dashPattern")||qc;var g=rl(j,s,f(_,"dashOffset")),ci=V(_,"dashColor")||V(Vn);g!==j&&(i?Xk(g,S,c,ws):Vh(g,A,C,m,R,e,L)),j.strokeStyle=ci,j.lineWidth=Bk,j.stroke(),f(_,"dash3d")&&_j(j,ci,V(_,"dash3dColor"),Bk,Z,f(_,"dash3dAccuracy")),of(j,s)}}tj&&j.restore(),A===co&&ve(j,G,f(_,"depth"),C),j.lineJoin=dn,j.lineCap=$e,h&&K()}},O=function(d,m){var Z=$||f(d,oi),i=N||f(d,"blendMode"),W=f(d,"name"),X=Kj(W,Z,i);X&&X.cacheRule!=U&&(X=yo(j,X,f(d,"stretch"),m.width,m.height,M,p,Z)),X?bl(j,X,f(d,"stretch"),m.x,m.y,m.width,m.height,M,p,Z,null,i):jr=!1},a=function(Y,W){var z=f(Y,"text");if(z!=U){var i,c=f(Y,"gradientPack"),o=f(Y,"gradient"),D=V(Y,"gradientColor"),C=f(Y,"font"),m=f(Y,"vertical"),b=f(Y,"verticalGap"),d=f(Y,"align"),E=f(Y,"vAlign"),A=f(Y,"decoration");if(i=c?lh(j,c,V,!1,W):V(Y,oi),!c&&o&&(i=G.createGradient(j,o,i||G.labelColor,D||P.imageGradient,W.x,W.y,W.width,W.height)),m){null==b&&(b=1);var l,x,y=z.length,R=0,T=(y-1)*b,O=[];j.textBaseline=vc,j.font=C;for(var u=0;y>u;u++){var w=j.measureText(z[u]);O.push(w),T+=w.fontBoundingBoxDescent,R=B(R,w.width)}x=E&&E!==os?E===vc?W.y:W.y+W.height-T:W.y+(W.height-T)/2,l=d&&d!==Ld?d===fk?W.x+W.width-R:W.x+(W.width-R)/2:W.x;for(var u=0;y>u;u++){var a=z[u],w=O[u];hl(j,a,C,i,l,x,R,w.fontBoundingBoxDescent,Rp,os,A),x+=w.fontBoundingBoxDescent+b}}else hl(j,z,C,i,W.x,W.y,W.width,W.height,d,E,A);c&&j.restore()}},l=function(E,q){ni(j,V(E,oi),q.x,q.y,q.width,q.height,f(E,"width"))},C=function(Q,m){var P=f(Q,Fl),D=0;if(P&&(P.forEach(function(u){D+=u}),D>0)){for(var I=f(Q,"colors")||Mo,X=f(Q,"startAngle")||0,g=f(Q,"hollow"),z=f(Q,Np),v=f(Q,Kl),L=f(Q,Lr),N=z?new Vo:U,A=m.x,p=m.y,y=m.width,Y=m.height,$=A+y/2,S=p+Y/2,F=x(y,Y)/2,s=0,w=0;w<P.length;w++){var R=P[w],k=t*R/D,c=X+k;if(j.fillStyle=I[s++],s===I.length&&(s=0),j.beginPath(),g){var l=$+b(X)*F/2,T=S+_(X)*F/2,e=$+b(c)*F,W=S+_(c)*F;j.moveTo(l,T),j.arc($,S,F/2,X,c,!1),j.lineTo(e,W),j.arc($,S,F,c,X,!0)}else j.moveTo($,S),j.arc($,S,F,c,X,!0);N&&(k=(X+c)/2,N.add({text:kk(z)?z(R,w,D,M):R,x:$+.75*b(k)*F,y:S+.75*_(k)*F})),j.closePath(),j.fill(),X=c}N&&N.each(function(s){hl(j,s.text,v,L,s.x,s.y,0,0,Rp)})}},X=function(K,F){var E=f(K,Pg);if(E&&E.length>0){var b=E.length,J=f(K,Np),w=f(K,Kl),i=f(K,Lr),O=J?new Vo:U,y=f(K,"minValue")||0,g=f(K,"maxValue");if(g==U&&(g=0,E.forEach(function(N){f(N,Fl).forEach(function(G){g=B(g,G)})})),y===g)return;for(var G=F.height/(g-y),t=F.y+g*G,m=f(E[0],Fl).length,L=F.width/(3*m+1),_=2*L/b,e=0,S=0;b>S;S++)for(var W=E[S],k=f(W,oi),H=f(W,"colors"),l=f(W,Fl),d=0;m>d;d++){H?j.fillStyle=H[d]:k?j.fillStyle=k:(j.fillStyle=Mo[e++],e===Mo.length&&(e=0));var N=l[d],x=N*G,D=F.x+(1+3*d)*L+S*_;if(om(j,D,t-x,_,x),O){var n=kk(J)?J(N,d,W,M):N,P=ei(w,n).height;O.add({x:D,y:t-x-P,width:_,height:P,text:n})}}O&&O.each(function(y){hl(j,y.text,w,i,y.x,y.y,y.width,y.height,Rp)})}},s=function(W,Y){var P=f(W,Pg);if(P&&P.length>0){var c=P.length,m=f(P[0],Fl).length,q=Y.width/(3*m+1),S=0,R=f(W,"maxValue"),C=f(W,Np),T=f(W,Kl),t=f(W,Lr),D=C?new Vo:U;if(R==U){R=0;for(var w=0;m>w;w++){for(var F=0,$=0;c>$;$++)F+=f(P[$],Fl)[w];R=B(R,F)}}if(R>0){for(var w=0;m>w;w++)for(var I=Y.y+Y.height,$=0;c>$;$++){var x=P[$],v=f(x,oi),p=f(x,Fl)[w],r=p/R*Y.height;v?j.fillStyle=v:(j.fillStyle=Mo[S++],S===Mo.length&&(S=0)),I-=r;var h={x:Y.x+(1+3*w)*q,y:I,width:2*q,height:r};om(j,h.x,h.y,h.width,h.height),D&&(h.text=kk(C)?C(p,w,x,M):p,D.add(h))}D&&D.each(function(a){hl(j,a.text,T,t,a.x,a.y,a.width,a.height,Rp)})}}},L=function(H,t){var x=f(H,Pg);if(x&&x.length>0){for(var q=x.length,G=f(x[0],Fl).length,N=t.width/(3*G+1),X=0,c=f(H,Np),I=f(H,Kl),K=f(H,Lr),A=c?new Vo:U,J=0;G>J;J++){for(var Q=0,s=0;q>s;s++)Q+=f(x[s],Fl)[J];if(Q>0){var n=t.y+t.height;for(s=0;q>s;s++){var y=x[s],B=f(y,oi),R=f(y,Fl)[J],w=R/Q*t.height;B?j.fillStyle=B:(j.fillStyle=Mo[X++],X===Mo.length&&(X=0)),n-=w;var W={x:t.x+(1+3*J)*N,y:n,width:2*N,height:w};om(j,W.x,W.y,W.width,W.height),A&&(W.text=kk(c)?c(R,J,y,M):R,A.add(W))}}}A&&A.each(function(o){hl(j,o.text,I,K,o.x,o.y,o.width,o.height,Rp)})}},Y=function(H,G){var e=f(H,Pg);if(e&&e.length>0){var a=e.length,D=f(H,"minValue")||0,p=f(H,"maxValue");if(p==U&&(p=0,e.forEach(function(G){f(G,Fl).forEach(function(W){p=B(p,W)})})),D===p)return;for(var x=G.height/(p-D),J=G.y+p*x,A=f(e[0],Fl).length,P=G.width/(3*A+1),Y=0,s=f(H,"lineWidth")||2,b=f(H,"line3d"),T=f(H,"linePoint"),q=f(H,Np),l=f(H,Kl),F=f(H,Lr),r=0;a>r;r++){var v=e[r],W=f(v,oi),N=f(v,Fl);W?j.strokeStyle=W:(W=j.strokeStyle=Mo[Y++],Y===Mo.length&&(Y=0)),j.beginPath();for(var O=0;A>O;O++){var k=G.x+(2+3*O)*P,X=J-N[O]*x;0===O?j.moveTo(k,X):j.lineTo(k,X)}if(j.lineWidth=s,j.stroke(),b&&_j(j,W,U,s,Z),T||q){var g,S=s/2+2;for(O=0;A>O;O++){var u=N[O];if(k=G.x+(2+3*O)*P,X=J-u*x,kk(T)?T(j,k,X,W,O,v,M):T&&(j.fillStyle=W,j.beginPath(),j.arc(k,X,S,0,t,!0),j.fill()),kk(q)?g=q(u,O,v,M):q&&(g=u),g){var n=ei(l,g).height,K=j.shadowBlur;if(K){var o=j.shadowOffsetX,m=j.shadowOffsetY,h=j.shadowColor;j.shadowOffsetX=0,j.shadowOffsetY=0,j.shadowBlur=0,j.shadowColor=U}hl(j,g,l,F,k,X-n-S+2,0,n,Rp),K&&(j.shadowOffsetX=o,j.shadowOffsetY=m,j.shadowBlur=K,j.shadowColor=h)}}}}}},g=function(A){j=A[0],M=A[1],p=A[2],Z=A[3],$=A[4],N=A[5]},v=function(){return[j,M,p,Z,$,N]},A=function($,E){var K;p&&p.getDrawableState?K=p.getDrawableState(M):p&&p.getState?K=p.getState(M):(K=M instanceof Cb?M.s(Nf):null,(K===c||null===K)&&(K=f($,Nf)));var I=f(E,Nf);return I!==c&&null!==I&&I!==K?!1:f(E,Uk)},k={border:l,image:O,text:a,pieChart:C,columnChart:X,stackedColumnChart:s,percentageColumnChart:L,lineChart:Y};return function(Q,T,b,w,E,L,q,h,C,B){if(T&&E&&L){var y=v();j=Q,M=q,p=h,!M&&p&&p.isSelfViewEvent&&(M=p),Z=p?p._zoom?p._zoom:1:1,$=C,N=B;var Y=E,W=L;if(Ij()){var H,s,x,z,e;0===j[bf]?Ij[0]&&(H=!0):H=!0,j.texureImage2D?Ij[1]&&(s=!0):s=!0,j.texureImage3D?Ij[2]&&(x=!0):x=!0,j.drawDNDState?Ij[3]&&(e=!0):e=!0,Tq.widget[0]?Ij[4]&&(z=!0):z=!0,H&&s&&x&&z&&e&&(Y=b,W=w)}if(T.tagName)return ak(Ue)&&!i[Ue]||j.drawImage(T,Y,W,E,L),g(y),void 0;if(0==f(T,"visible"))return g(y),void 0;$||($=zi(T.color,M,p)),B||(N=zi(T.blendMode,M,p)),ak(Ue)&&!i[Ue]&&(E=Y,L=W);var O=Zo(T,M,p,E),_=Ge(T,M,p,L),d={x:0,y:0,width:O,height:_,fitSize:f(T,"fitSize")},I=f(T,"clip"),l=f(T,"opacity");if(d.fitSize){var t=d.rw=zi(T.width,M,p)||20;d.widthScale=O/t;var P=d.rh=zi(T.height,M,p)||20;d.heightScale=_/P}if(j.save(),j.interactiveInfo){var X=j.interactiveInfo.matrix,a=X.clone();X.appendTranslate(Y,W).appendScale(E/O,L/_),j.interactiveInfo.refRect=d}Xg(j,Y,W),(O!==E||_!==L)&&j.scale(E/O,L/_),I&&(kk(I)?I(j,O,_,M,p,T):(j.beginPath(),j.rect(0,0,O,_),j.clip())),l!=U&&(j.globalAlpha*=l),f(T,"comps").forEach(function(w){if(w.prefix){var x=Ng,Q=zi(w.prefix,M,p);Q&&(Ng=Ng+Q+".")}if(0==A(T,w))return w.prefix&&(Ng=x),void 0;if(cg.splice(0,0,w),j.interactiveInfo)var y=j.interactiveInfo.matrix.clone();var E=f(w,"opacity"),e=f(w,"shadow"),z=f(w,"type"),H=f(w,"refRect")||d,$=R(w,H);if(E!=U){var v=j.globalAlpha;j.globalAlpha*=E}if(e){var C=Z*G.devicePixelRatio,W=j.shadowOffsetX,B=j.shadowOffsetY,h=j.shadowBlur,P=j.shadowColor,q=f(w,"shadowOffsetX"),X=f(w,"shadowOffsetY"),a=f(w,"shadowBlur"),b=V(w,"shadowColor");j.shadowOffsetX=(q==U?m:q)*C,j.shadowOffsetY=(X==U?m:X)*C,j.shadowBlur=(a==U?S:a)*C,j.shadowColor=b||V(Hr)}if("save"===z)j.save();else if("endClip"===z||"restore"===z)j.restore();
else if("clip"===z)j.save(),Xk(j,f(w,"points",u),f(w,"segments",r),!0),j.clip();else if(js[z])$=$||{x:0,y:0,width:H.width,height:H.height},o(w,z,$,H);else if(z===gs)o(w,z,$,H);else if("SVGPath"===z)D(w,z,$);else{$=$||{x:0,y:0,width:H.width,height:H.height};var t=f(w,ee),g=f(w,"scaleX"),s=f(w,"scaleY"),I=J(w),N=F(w,$,$,t,g,s,I);if(kk(z))n(w,z),G.drawCompType(z,j,$,w,M,p);else if(G.getCompType(z)){var L=G.getCompType(z),l=L.func||L;n(w,L),G.drawCompType(l,j,$,w,M,p)}else k[z]?k[z](w,$):G.getCompType(z)===c&&Gl.test(z)&&(Sr(z),jr=!1);N&&K()}e&&(j.shadowOffsetX=W,j.shadowOffsetY=B,j.shadowBlur=h,j.shadowColor=P),E!=U&&(j.globalAlpha=v),j.interactiveInfo&&(j.interactiveInfo.matrix=y),w.prefix&&(Ng=x),cg.splice(0,1)}),j.interactiveInfo&&(j.interactiveInfo.matrix=a),j.restore(),g(y)}}}();G.getCurrentComp=function(){return cg[0]},G.getParentComp=function(){return cg[1]},G.getInternal=function(){return{isEnter:Am,isEsc:Jk,isSpace:Tr,isLeft:Go,isUp:uq,isRight:ib,isDown:Ok,addMethod:hn,superCall:Zn,toPointsArray:Yp,translateAndScale:id,appendArray:kq,createWorldMatrix:Ak,vec3TransformMat4:lp,setCanvas:cs,createDiv:qg,createView:np,createCanvas:Nb,createImage:pr,initContext:Rg,layout:Gq,fillRect:om,Mat:Fh,drawBorder:ni,isString:ak,setBorder:sg,getPropertyValue:go,setPropertyValue:Eo,drawVerticalLine:vq,draw3DRect:ve,getPinchDist:Xe,isSameRect:Gn,getPosition:Ml,intersectionLineRect:wc,getNodeRect:Zc,getEdgeAgentPosition:Kd,getEdgeHostPosition:xe,getImageWidth:Zo,getImageHeight:Ge,initItemElement:ul,drawPoints:Xk,createG2:rl,closePopup:fn,isH:ui,createAnim:Li,createNormalMatrix:Le,toColorArray:Ap,createNormals:Cp,toFloatArray:eg,glMV:Mg,glPop:Vg,batchShape:Wb,createNodeMatrix:Jl,getShapeModel:Bq,getFaceInfo:Ej,transformAppend:pp,drawFaceInfo:ng,glUploadData:og,glUploadElementData:yn,glDrawArray:Kg,glDrawElement:Ke,glBindTexture:Qf,pickValueToColor:se,to3dPointsArray:Fe,setGLDebugMode:function(A){_l=A},cube:function(){return{vs:cd,is:Tn,uv:zr}},ui:function(){return{DataUI:li,NodeUI:up,EdgeUI:tr,GroupUI:um,ShapeUI:Gj,GridUI:Jf,Data3dUI:Rs,Node3dUI:Ss,Shape3dUI:Vs}},getInternalVersion:function(){return"U2FsdGVkX19ZLaOQGVn1+fEZhEM74IpCw/mzOeSoND4="},getDragger:function(){return Sd},addMSMap:function($){hn(Gg,$)},k:Z,overrideTimerFunc:function(L,F){xk=C.Default.callLater=L,An=C.Default.cancelLater=F},canEnterEditDetailMode:io,addEventListener:d,removeEventListener:h}},function(n){function D(V,i){V!=U&&(i==U&&Dl!=typeof V?this._54O(V,256):this._54O(V,i))}function X(){return new D(U)}function O(G,P,x,C,U,r){for(;--r>=0;){var V=P*this[G++]+x[C]+U;U=A(V/67108864),x[C++]=67108863&V}return U}function f(H,M,G,U,m,w){for(var g=32767&M,j=M>>15;--w>=0;){var t=32767&this[H],X=this[H++]>>15,l=j*t+X*g;t=g*t+((32767&l)<<15)+G[U]+(1073741823&m),m=(t>>>30)+(l>>>15)+j*X+(m>>>30),G[U++]=1073741823&t}return m}function J(l,H,X,G,I,E){for(var c=16383&H,S=H>>14;--E>=0;){var e=16383&this[l],V=this[l++]>>14,$=S*e+V*c;e=c*e+((16383&$)<<14)+X[G]+I,I=(e>>28)+($>>14)+S*V,X[G++]=268435455&e}return I}function k(T){return vo.charAt(T)}function i(J,l){var w=Tq[J.charCodeAt(l)];return w==U?-1:w}function r(n){for(var $=this.t-1;$>=0;--$)n[$]=this[$];n.t=this.t,n.s=this.s}function $(d){this.t=1,this.s=0>d?-1:0,d>0?this[0]=d:-1>d?this[0]=d+this.DV:this.t=0}function F(L){var N=X();return N._58O(L),N}function I(N,L){var j,O=this;if(16==L)j=4;else if(8==L)j=3;else if(256==L)j=8;else if(2==L)j=1;else if(32==L)j=5;else{if(4!=L)return O.fromRadix(N,L),void 0;j=2}O.t=0,O.s=0;for(var T=N.length,I=!1,S=0;--T>=0;){var g=8==j?255&N[T]:i(N,T);0>g?"-"==N.charAt(T)&&(I=!0):(I=!1,0==S?O[O.t++]=g:S+j>O.DB?(O[O.t-1]|=(g&(1<<O.DB-S)-1)<<S,O[O.t++]=g>>O.DB-S):O[O.t-1]|=g<<S,S+=j,S>=O.DB&&(S-=O.DB))}8==j&&0!=(128&N[0])&&(O.s=-1,S>0&&(O[O.t-1]|=(1<<O.DB-S)-1<<S)),O._57O(),I&&D.ZERO._78O(O,O)}function P(){for(var e=this,c=e.s&e.DM;e.t>0&&e[e.t-1]==c;)--e.t}function K(N){var g=this;if(g.s<0)return"-"+g._85O()[Wi](N);var Y;if(16==N)Y=4;else if(8==N)Y=3;else if(2==N)Y=1;else if(32==N)Y=5;else{if(4!=N)return g.toRadix(N);Y=2}var v,u=(1<<Y)-1,X=!1,x="",V=g.t,h=g.DB-V*g.DB%Y;if(V-->0)for(h<g.DB&&(v=g[V]>>h)>0&&(X=!0,x=k(v));V>=0;)Y>h?(v=(g[V]&(1<<h)-1)<<Y-h,v|=g[--V]>>(h+=g.DB-Y)):(v=g[V]>>(h-=Y)&u,0>=h&&(h+=g.DB,--V)),v>0&&(X=!0),X&&(x+=k(v));return X?x:"0"}function m(){var R=X();return D.ZERO._78O(this,R),R}function g(){return this.s<0?this._85O():this}function z(j){var O=this,R=O.s-j.s;if(0!=R)return R;var L=O.t;if(R=L-j.t,0!=R)return O.s<0?-R:R;for(;--L>=0;)if(0!=(R=O[L]-j[L]))return R;return 0}function o(A){var X,e=1;return 0!=(X=A>>>16)&&(A=X,e+=16),0!=(X=A>>8)&&(A=X,e+=8),0!=(X=A>>4)&&(A=X,e+=4),0!=(X=A>>2)&&(A=X,e+=2),0!=(X=A>>1)&&(A=X,e+=1),e}function S(){var d=this;return d.t<=0?0:d.DB*(d.t-1)+o(d[d.t-1]^d.s&d.DM)}function c(E,l){var O;for(O=this.t-1;O>=0;--O)l[O+E]=this[O];for(O=E-1;O>=0;--O)l[O]=0;l.t=this.t+E,l.s=this.s}function M(V,n){for(var t=V;t<this.t;++t)n[t-V]=this[t];n.t=B(this.t-V,0),n.s=this.s}function W(s,l){var d,g=this,J=s%g.DB,S=g.DB-J,U=(1<<S)-1,v=A(s/g.DB),b=g.s<<J&g.DM;for(d=g.t-1;d>=0;--d)l[d+v+1]=g[d]>>S|b,b=(g[d]&U)<<J;for(d=v-1;d>=0;--d)l[d]=0;l[v]=b,l.t=g.t+v+1,l.s=g.s,l._57O()}function H(L,k){var T=this;k.s=T.s;var I=A(L/T.DB);if(I>=T.t)return k.t=0,void 0;var $=L%T.DB,q=T.DB-$,E=(1<<$)-1;k[0]=T[I]>>$;for(var p=I+1;p<T.t;++p)k[p-I-1]|=(T[p]&E)<<q,k[p-I]=T[p]>>$;$>0&&(k[T.t-I-1]|=(T.s&E)<<q),k.t=T.t-I,k._57O()}function l(p,G){for(var o=this,O=0,g=0,Y=x(p.t,o.t);Y>O;)g+=o[O]-p[O],G[O++]=g&o.DM,g>>=o.DB;if(p.t<o.t){for(g-=p.s;O<o.t;)g+=o[O],G[O++]=g&o.DM,g>>=o.DB;g+=o.s}else{for(g+=o.s;O<p.t;)g-=p[O],G[O++]=g&o.DM,g>>=o.DB;g-=p.s}G.s=0>g?-1:0,-1>g?G[O++]=o.DV+g:g>0&&(G[O++]=g),G.t=O,G._57O()}function Y(c,G){var H=this.abs(),M=c.abs(),d=H.t;for(G.t=d+M.t;--d>=0;)G[d]=0;for(d=0;d<M.t;++d)G[d+H.t]=H.am(0,M[d],G,d,0,H.t);G.s=0,G._57O(),this.s!=c.s&&D.ZERO._78O(G,G)}function V(Z){for(var i=this.abs(),t=Z.t=2*i.t;--t>=0;)Z[t]=0;for(t=0;t<i.t-1;++t){var M=i.am(t,i[t],Z,2*t,0,1);(Z[t+i.t]+=i.am(t+1,2*i[t],Z,2*t+1,M,i.t-t-1))>=i.DV&&(Z[t+i.t]-=i.DV,Z[t+i.t+1]=1)}Z.t>0&&(Z[Z.t-1]+=i.am(t,i[t],Z,2*t,0,1)),Z.s=0,Z._57O()}function L(l,V,e){var a=l.abs(),G=this;if(!(a.t<=0)){var j=G.abs();if(j.t<a.t)return V!=U&&V._58O(0),e!=U&&G._77O(e),void 0;e==U&&(e=X());var P=X(),Q=G.s,h=l.s,R=G.DB-o(a[a.t-1]);R>0?(a._44O(R,P),j._44O(R,e)):(a._77O(P),j._77O(e));var Z=P.t,n=P[Z-1];if(0!=n){var f=n*(1<<G.F1)+(Z>1?P[Z-2]>>G.F2:0),K=G.FV/f,J=(1<<G.F1)/f,q=1<<G.F2,C=e.t,d=C-Z,Y=V==U?X():V;for(P._59O(d,Y),e._52O(Y)>=0&&(e[e.t++]=1,e._78O(Y,e)),D.ONE._59O(Z,Y),Y._78O(P,P);P.t<Z;)P[P.t++]=0;for(;--d>=0;){var I=e[--C]==n?G.DM:A(e[C]*K+(e[C-1]+q)*J);if((e[C]+=P.am(0,I,e,d,0,Z))<I)for(P._59O(d,Y),e._78O(Y,e);e[C]<--I;)e._78O(Y,e)}V!=U&&(e._45O(Z,V),Q!=h&&D.ZERO._78O(V,V)),e.t=Z,e._57O(),R>0&&e._46O(R,e),0>Q&&D.ZERO._78O(e,e)}}}function e(H){var g=X();return this.abs()._49O(H,U,g),this.s<0&&g._52O(D.ZERO)>0&&H._78O(g,g),g}function y(j){this.m=j}function u(p){return p.s<0||p._52O(this.m)>=0?p.mod(this.m):p}function C(f){return f}function E(L){L._49O(this.m,U,L)}function N(G,y,P){G._47O(y,P),this._74O(P)}function v(X,s){X._48O(s),this._74O(s)}function q(){if(this.t<1)return 0;var R=this[0];if(0==(1&R))return 0;var D=3&R;return D=15&D*(2-(15&R)*D),D=255&D*(2-(255&R)*D),D=65535&D*(2-(65535&(65535&R)*D)),D=D*(2-R*D%this.DV)%this.DV,D>0?this.DV-D:-D}function R(o){var E=this;E.m=o,E.mp=o._50O(),E.mpl=32767&E.mp,E.mph=E.mp>>15,E.um=(1<<o.DB-15)-1,E.mt2=2*o.t}function d(Q){var v=X();return Q.abs()._59O(this.m.t,v),v._49O(this.m,U,v),Q.s<0&&v._52O(D.ZERO)>0&&this.m._78O(v,v),v}function G(f){var p=X();return f._77O(p),this._74O(p),p}function w(D){for(var k=this;D.t<=k.mt2;)D[D.t++]=0;for(var r=0;r<k.m.t;++r){var e=32767&D[r],l=e*k.mpl+((e*k.mph+(D[r]>>15)*k.mpl&k.um)<<15)&D.DM;for(e=r+k.m.t,D[e]+=k.m.am(0,l,D,r,0,k.m.t);D[e]>=D.DV;)D[e]-=D.DV,D[++e]++}D._57O(),D._45O(k.m.t,D),D._52O(k.m)>=0&&D._78O(k.m,D)}function h(I,s){I._48O(s),this._74O(s)}function T(Q,e,t){Q._47O(e,t),this._74O(t)}function Mi(){return 0==(this.t>0?1&this[0]:this.s)}function Sd(O,V){if(O>4294967295||1>O)return D.ONE;var J=X(),N=X(),b=V._73O(this),$=o(O)-1;for(b._77O(J);--$>=0;)if(V._76O(J,N),(O&1<<$)>0)V._75O(N,b,J);else{var m=J;J=N,N=m}return V.revert(J)}function ei(l,O){var w;return w=256>l||O._51O()?new y(O):new R(O),this.exp(l,w)}function xb(){var A=this;if(A.s<0){if(1==A.t)return A[0]-A.DV;if(0==A.t)return-1}else{if(1==A.t)return A[0];if(0==A.t)return 0}return(A[1]&(1<<32-A.DB)-1)<<A.DB|A[0]}function Sf(U,M){return new D(U,M)}function hq(){var F=this;F.n=U,F.e=0,F.d=U,F.p=U,F.q=U,F.dmp1=U,F.dmq1=U,F._10A=U}function Fc(q){return q._53O(this.e,this.n)}function sg(G){var p,T,q,H="",E=0;for(p=0;p<G.length&&G.charAt(p)!=aj;++p)q=bi.indexOf(G.charAt(p)),0>q||(0==E?(H+=k(q>>2),T=3&q,E=1):1==E?(H+=k(T<<2|q>>4),T=15&q,E=2):2==E?(H+=k(T),H+=k(q>>2),T=3&q,E=3):(H+=k(T<<2|q>>4),H+=k(15&q),E=0));return 1==E&&(H+=k(T<<2)),H}function ui(R){var l=R.split(""),E=sg(R);return l.forEach(function(f){var M=f.length;M>0&&E&&(qh+=Ob(f))}),E}function Ak(y,L){var Y=dg._4O.Util._56O(y,"ss"),x={},I=0;return x.v=Y==L,x.t=1,x.s=0>I?-1:0,$q=x.v,I>0?x[0]=I:-1>I?x[0]=I+x.DV:x.t=0,[Y,x]}function bf(k){var d=38,m=k.substring(0,d);if(m&&30==m.indexOf("05000420")){var $=["ss",k.substring(d)];return $}return[]}function Id(k,q){q=q.replace(Kg,""),q=q.replace(/[ \n]+/g,"");var d=Sf(q,16);if(d._55O()>this.n._55O())return 0;var Y=this._37O(d),W=Y[Wi](16).replace(/^1f+00/,""),r=bf(W);if(0==r.length)return!1;for(var K,N,O,M=.5,u=kj,m=[0,.5,.75,.875,.9375],X=[],B=[],h=[],V=t/u,I=r[1],H=Ak(k,I)[0],F=0,x=0;F<m.length;F++){var z=0===F%2?0:.5;for(K=0;u>=K;K++)N=(K+z)*V,O=1-m[F],X.push(b(N)*M*O,-M+2*m[F]*M,-_(N)*M*O),B.push((K+z)/u,O)}for(F=0;F<m.length-1;F++){var e=F*(u+1),l=(F+1)*(u+1);for(K=0;u>K;K++)h.push(e+K,l+K+1,l+K,e+K,e+K+1,l+K+1)}return h.forEach(function(p){x+=p}),I==H&&x>10}var ih,Gm=0xdeadbeefcafe,yh=15715070==(16777215&Gm),Wi="toString",Gh="",Bp="nat",Wp=function(){};p=n["D"+11182[Wi](a(2,5))];var gr=D.prototype;ae+=rh.substr(0,1);var Bc=n.navigator?n.navigator.appName:"";yh&&"Microsoft Internet Explorer"==Bc?(gr.am=f,ih=30):yh&&"Netscape"!=Bc?(gr.am=O,ih=26):(gr.am=J,ih=28),gr.DB=ih,gr.DM=(1<<ih)-1,gr.DV=1<<ih;var Ai=52;gr.FV=a(2,Ai),gr.F1=Ai-ih,gr.F2=2*ih-Ai;var Nq,_r,vo="0123456789abcdefghijklmnopqrstuvwxyz",Tq=[],Xl=function(n){return String.fromCharCode(n)};for(Nq="0".charCodeAt(0),_r=0;9>=_r;++_r)Tq[Nq++]=_r;for(Nq="a".charCodeAt(0),_r=10;36>_r;++_r)Tq[Nq++]=_r;for(Nq="A".charCodeAt(0),_r=10;36>_r;++_r)Tq[Nq++]=_r;var dl=y.prototype;dl._73O=u,dl.revert=C,dl._74O=E,dl._75O=N,dl._76O=v;var cb=R.prototype;cb._73O=d,cb.revert=G,cb._74O=w,cb._75O=T,cb._76O=h,gr._77O=r,gr._58O=$,gr._54O=I,gr._57O=P,gr._59O=c,gr._45O=M,gr._44O=W,gr._46O=H,gr._78O=l,gr._47O=Y,gr._48O=V,gr._49O=L,gr._50O=q,gr._51O=Mi,gr.exp=Sd,gr.toString=K,gr._85O=m,gr.abs=g,gr._52O=z,gr._55O=S,gr.mod=e,gr._53O=ei,D.ZERO=F(0),D.ONE=F(1),gr._86O=xb;var Fh=function(l,C){var b=this;b.isPublic=!0,typeof l!==Dl?(b.n=l,b.e=C):l!=U&&C!=U&&l.length>0&&C.length>0&&(b.n=Sf(l,16),b.e=Ob(C,16))};oh=function(){var E,X,k=ui(Vj),q=k.substr(0,4),N=k.substr(4,2),v=k.substr(6,2),B=1,J=!B,h=Z,r=[],j=Sg.charAt(7);if(p&&(p[Wi]().indexOf(Bp)<0||p[ae][Wi]().indexOf(Bp)<0||!k?E=U:(k=new p(q-0,N-B,v-0),X=k.setHours(9),p[ae]()>X?E=sh[j]:J=!0)),k&&E&&E[0]&&E[Q(.5)]&&h){var o=mf(E[0]),x=mf(E[1]);for(var M in x)r.push(M);var T,g=0,H=o[r[g]],s=x[r[g++]],i=x[r[g++]],I=x[r[g++]],_=x[r[g++]],G=x[r[g++]],a=x[r[g++]],d=o[r[g]],D=x[r[g++]],C=im._27O(h);if(H===s&&C&&D){T=s+i+I+_+G+a;var Y=!a||a===bq;if(!Y&&a)for(var u,F=0,e=a.length;e>F;F++)a[F]===Wm[g]?u===bq?Y=!0:u[0]===qr[5]&&bq&&bq.indexOf(u.substr(1))>=0?Y=!0:u=U:(u==U?u=a[F]:u+=a[F],F===e-1&&(u===bq?Y=!0:u[0]===qr[5]&&bq&&bq.indexOf(u.substr(1))>=0&&(Y=!0)));T&&C._31O(T,D)&&C._31O(H,d)&&Y&&(!G||p[ae]()<G)&&(J=!0)}}return J||(Vh=$d),j};var rq=hq.prototype;rq._37O=Fc,rq._38O=Fh;var bi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",aj="=",Kp=25,vc=10,Vj="ICESFQ==",nm=nm||function(i,c){var E={},v=E._7A={},j=v._6A=function(){function O(){}return{_80O:function(Z){O.prototype=this;var d=new O;return Z&&d._5A(Z),d.hasOwnProperty("_82O")||(d._82O=function(){d.$super._82O.apply(this,arguments)}),d._82O.prototype=d,d.$super=this,d},_3A:function(){var O=this._80O();return O._82O.apply(O,arguments),O},_82O:function(){},_5A:function(B){for(var a in B)B.hasOwnProperty(a)&&(this[a]=B[a]);B.hasOwnProperty(Wi)&&(this.toString=B.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),$=v._39O=j._80O({_82O:function(Q,M){Q=this._84O=Q||[],this._65O=M!=c?M:4*Q.length},toString:function(i){return(i||n).stringify(this)},_89O:function(Q){var B=this._84O,o=Q._84O,L=this._65O,n=Q._65O;if(this._57O(),L%4)for(var C=0;n>C;C++){var I=255&o[C>>>2]>>>24-8*(C%4);B[L+C>>>2]|=I<<24-8*((L+C)%4)}else if(o.length>65535)for(var C=0;n>C;C+=4)B[L+C>>>2]=o[C>>>2];else B.push.apply(B,o);return this._65O+=n,this},_57O:function(){var d=this._84O,b=this._65O;d[b>>>2]&=4294967295<<32-8*(b%4),d.length=Q(b/4)},_88O:function(){var Y=j._88O.call(this);return Y._84O=this._84O.slice(0),Y},_87O:function(H){for(var c=[],p=0;H>p;p+=4)c.push(0|4294967296*Al);return new $._82O(c,H)}}),y=E._2A={},n=y._69O={stringify:function(b){var Q,g=b._84O,c=b._65O,O=[];for(Q=0;c>Q;Q++){var L=255&g[Q>>>2]>>>24-8*(Q%4);O.push((L>>>4).toString(16)),O.push((15&L).toString(16))}return O.join("")},_68O:function(u){for(var V=u.length,t=[],j=0;V>j;j+=2)t[j>>>3]|=Ob(u.substr(j,2),16)<<24-4*(j%8);return new $._82O(t,V/2)}},F=y._8A={stringify:function(j){var u,T=j._84O,i=j._65O,N=[];for(u=0;i>u;u++){var E=255&T[u>>>2]>>>24-8*(u%4);N.push(Xl(E))}return N.join("")},_68O:function(X){var u,v=X.length,C=[];for(u=0;v>u;u++)C[u>>>2]|=(255&X.charCodeAt(u))<<24-8*(u%4);return new $._82O(C,v)}},O=y._9A={stringify:function(q){try{return decodeURIComponent(escape(F.stringify(q)))}catch(M){throw new Error("")}},_68O:function(H){return F._68O(unescape(encodeURIComponent(H)))}},A=v._32O=j._80O({_1A:function(){this._83O=new $._82O,this._23O=0},_33O:function(V){typeof V==Dl&&(V=O._68O(V)),this._83O._89O(V),this._23O+=V._65O},_25O:function(z){var J=this._83O,v=J._84O,F=J._65O,C=this._79O,b=4*C,P=F/b;P=z?Q(P):B((0|P)-this._22O,0);var N=P*C,Z=x(4*N,F);if(N){for(var O=0;N>O;O+=C)this._20O(v,O);var E=v.splice(0,N);J._65O-=Z}return new $._82O(E,Z)},_88O:function(){var A=j._88O.call(this);return A._83O=this._83O._88O(),A},_22O:0});v._66O=A._80O({cfg:j._80O(),_82O:function(d){this.cfg=this.cfg._80O(d),this._1A()},_1A:function(){A._1A.call(this),this._34O()},_81O:function(x){return this._33O(x),this._25O(),this},_72O:function(g){g&&this._33O(g);var Y=this._21O();return Y},_79O:16,_26O:function(W){return function(t,m){return new W._82O(m)._72O(t)}},_19O:function(n){return function(B,H){return new P._71O._82O(n,H)._72O(B)}}});var P=E._67O={};return E}();!function(){var C=nm,r=C._7A,J=r._39O,d=r._66O,N=C._67O,m=[],H=[];!function(){function p(v){for(var P=j(v),t=2;P>=t;t++)if(!(v%t))return!1;return!0}function A(w){return 0|4294967296*(w-(0|w))}for(var U=2,x=0;64>x;)p(U)&&(8>x&&(m[x]=A(a(U,.5))),H[x]=A(a(U,1/3)),x++),U++}();var o=[],X=N._41O=d._80O({_34O:function(){this._64O=new J._82O(m.slice(0))},_20O:function(B,G){for(var v=this._64O._84O,z=v[0],Q=v[1],O=v[2],f=v[3],b=v[4],q=v[5],D=v[6],V=v[7],c=0;64>c;c++){if(16>c)o[c]=0|B[G+c];else{var W=o[c-15],Y=(W<<25|W>>>7)^(W<<14|W>>>18)^W>>>3,$=o[c-2],a=($<<15|$>>>17)^($<<13|$>>>19)^$>>>10;o[c]=Y+o[c-7]+a+o[c-16]}var r=b&q^~b&D,s=z&Q^z&O^Q&O,e=(z<<30|z>>>2)^(z<<19|z>>>13)^(z<<10|z>>>22),N=(b<<26|b>>>6)^(b<<21|b>>>11)^(b<<7|b>>>25),X=V+N+r+H[c]+o[c],x=e+s;V=D,D=q,q=b,b=0|f+X,f=O,O=Q,Q=z,z=0|X+x}v[0]=0|v[0]+z,v[1]=0|v[1]+Q,v[2]=0|v[2]+O,v[3]=0|v[3]+f,v[4]=0|v[4]+b,v[5]=0|v[5]+q,v[6]=0|v[6]+D,v[7]=0|v[7]+V},_21O:function(){var M=this._83O,J=M._84O,_=8*this._23O,u=8*M._65O;return J[u>>>5]|=128<<24-u%32,J[(u+64>>>9<<4)+14]=A(_/4294967296),J[(u+64>>>9<<4)+15]=_,M._65O=4*J.length,this._25O(),this._64O},_88O:function(){var j=d._88O.call(this);return j._64O=this._64O._88O(),j}});C._41O=d._26O(X),C._42O=d._19O(X)}();var Kg=new RegExp("");Kg.compile("[^0-9a-f]","gi"),hq._28O=-1,hq._29O=-2,rq._31O=Id,rq._63O=Id,hq._43O=-2;var Ld=new function(){var x=this;x._5O=function(v,L){if("8"!=v.substring(L+2,L+3))return 1;var e=Ob(v.substring(L+3,L+4));return 0==e?-1:e>0&&10>e?e+1:-2},x._13O=function(X,M){var h=x._5O(X,M);return 1>h?"":X.substring(M+2,M+2+2*h)},x._12O=function(f,N){var t=x._13O(f,N);if(""==t)return-1;var w;return w=Ob(t.substring(0,1))<8?new D(t,16):new D(t.substring(2),16),w._86O()},x._6O=function(n,u){var r=x._5O(n,u);return 0>r?r:u+2*(r+1)},x._11O=function(c,X){var R=x._6O(c,X),Z=x._12O(c,X);return c.substring(R,R+2*Z)},x._10O=function(w,t){var m=x._6O(w,t),o=x._12O(w,t);return m+2*o},x._7O=function(Q,B){var Y=[],Z=x._6O(Q,B);Y.push(Z);for(var D=x._12O(Q,B),e=Z,v=0;;){var c=x._10O(Q,e);if(c==U||c-Z>=2*D)break;if(v>=200)break;Y.push(c),e=c,v++}return Y}};if(Ld._90O=Xl(vc+24),Ld._91O=s+Xl(vc*vc+8),dg==U||!dg)var dg={};dg._4O!=U&&dg._4O||(dg._4O={});var Xm=dg._4O;dg._4O.Util=new function(){var j=this;j._56O=function(S){var K=new dg._4O._3O;return K._30O(S)},j._4A=function(R){var B=new dg._4O._3O;return B._36O(R)},j._11A=function(z){var B=new Xm._3O;return B._30O(z)}},dg._4O._3O=function(){var Z=this;Z._8O=function(z,Q){if("ss"==z&&"cj"==Q){try{Z.md=nm._67O._41O._3A()}catch(a){Wp(Gh)}Z._24O=function(u){Z.md._81O(u)},Z._35O=function(N){var x=nm._2A._69O._68O(N);Z.md._81O(x)},Z._60O=function(){var f=Z.md._72O();return f[Wi](nm._2A._69O)},Z._30O=function(V){return Z._24O(V),Z._60O()},Z._36O=function(h){return Z._35O(h),Z._60O()}}},Z._24O=function(){Wp(Gh)},Z._35O=function(){Wp(Gh)},Z._60O=function(){Wp(Gh)},Z._30O=function(){Wp(Gh)},Z._36O=function(){Wp(Gh)},Z._8O("ss","cj")},vd=function(a){var R=pb[gc[7]],D=1,J=!1;if(Rl.a!=pb[dm])return Rl.a;if(Rl.forEach(function(K){D*=K}),a>D){if(R&&R[1]&&R[0]){var N=R[0],$=R[1];$=$.split(Ld._90O),N=N.split(Ld._90O);var K=$[3],G=N[3],O=$[7],v=$[11],Z=$[15],m=$[19],L=$[23],x=$[27],X=N[7],Q=K+O+v+Z+m+L,P=L?!1:!0,q=G===K;if(L){var _=L&&L.split(Iq("firefox")[3]);if(_)for(var t=0;t<_.length;t++){var i=_[t];if(i[0]===ne[8]&&(i=i.substring(1)),Aq.indexOf(i)>=0){P=!0;break}}}J=q&&qj()(G,X)&&qj()(Q,x)&&P&&(!m||m>a),J&&v.indexOf(hf.length)>=0&&(vd[hf.length]=hf),J&&v.indexOf(hf.length+1)>=0&&(vd[hf.length+1]=hf),J&&v.indexOf(hf.length+3)>=0&&(vd[hf.length+3]=hf)}J||(li.prototype._42=Ne)}else J=!0,vd[hf.length]=vd[hf.length+1]=vd[hf.length+3]=hf;return Rl.a=J,J},Kp=String.fromCharCode(Kp+20);var es=function(W){return W=W.replace(Kg,Gh),W=W.replace(/[ \n]+/g,Gh)},Rq="30",Kk="06",yi="02",Yg="03",$f=Sf,ac=/^1f+00/,im=function(){var k;return k={_18O:function(s){var N=s,D=N.replace(/\s+/g,""),L=sg(D);return L},_14O:function(A){var F=this._18O(A),L=this._15O(F);return L},_15O:function(s){var H=this._17O(s);if("2a864886f70d010101"==H._61O){var w=this._16O(H.key),t=new hq;return t._38O(w.n,w.e),t}Wp(Gh)},_16O:function(B){var M={};B.substr(0,2)!=Rq&&Wp(Gh);var y=Ld._7O(B,0);return 2!=y.length&&Wp(Gh),B.substr(y[0],2)!=yi&&Wp(Gh),M.n=Ld._11O(B,y[0]),B.substr(y[1],2)!=yi&&Wp(Gh),M.e=Ld._11O(B,y[1]),M},_17O:function(S){var O={};O._40O=U;var G=Ld._7O(S,0);2!=G.length&&Wp(Gh);var H=G[0];S.substr(H,2)!=Rq&&Wp(Gh);var h=Ld._7O(S,H);return 2!=h.length&&Wp(Gh),S.substr(h[0],2)!=Kk&&Wp(Gh),O._61O=Ld._11O(S,h[0]),S.substr(h[1],2)==Kk?O._40O=Ld._11O(S,h[1]):S.substr(h[1],2)==Rq&&(O._40O={},O._40O.p=Ld._70O(S,h[1],[0],yi),O._40O.q=Ld._70O(S,h[1],[1],yi),O._40O.g=Ld._70O(S,h[1],[2],yi)),S.substr(G[1],2)!=Yg&&Wp(Gh),O.key=Ld._11O(S,G[1]).substr(2),O}},k._17O?k:U}(),am=im._27O=function(s){return im._14O(s)};qj=function(){return function(K,s){if(K&&s){s=es(s);var u=$f(s,a(2,4)),l=this;if(!l||!l.n||u._55O()>l.n._55O())return 0;var D=l._37O(u),Z=D[Wi](a(2,4)).replace(ac,""),m=bf(Z);if(0==m.length)return!1;var y=m[0],S=m[1],h=function(o){return dg._4O.Util._56O(o,y)},$=h(K);return S==$}}.bind(am(Z))};var hs,Ri;return function(){var c=wg.length-Of.length;if(c>0)for(var Z=0;c>Z;Z++)hs=Xm.Util,Ri=es}(),Mp=function(Q,S){S=Ri(S);var o=am(vk),O=Cm.length,T=2*O,g=$f(S,a(O,T)),z=o,U=!0;if(z){var J=z[Jj[0]];J&&g._55O()<=J._55O()&&(U=!1)}if(U)return 0;var H=z._37O(g),Y=H[Wi](a(O,T)).replace(ac,""),f=bf(Y);if(0==f.length)return!1;var A=f[0],E=f[1],s=hs._11A(Q,A);return E==s},im}(i,g),hn(G,{load:function(){var U={},c=function(D){return D?"c_"+(D.sync?"1":"0")+"_"+(D.post?"1":"0")+"_"+(D.responseType||"H")+"_"+(D.mimeType||"H")+"_"+(D.data?JSON.stringify(D.data):"H"):""};return function(j,B,C){var N,z=U[j],V=c(C);return z&&(N=z[V])?(N.push(B),void 0):(U[j]||(z=U[j]={count:0}),N=z[V]=[B],z.count++,G.xhrLoad(j,function(r){delete z[V],z.count--,z.count||delete U[j],N.forEach(function(W){W(r)})},C),void 0)}}(),asyncEach:function(j,V,e){"function"!=typeof e&&(e=Function.prototype);var S=new Array(j.length),u=0,d=!1;j.forEach(function(W,I){V(W,function(M,l){return d?void 0:M?(d=!0,e(null)):(S[I]=l,u++,u===j.length?e(S):void 0)})})},xhrLoad:function(Q,z,O){var H=!1;zo(Q)||(H=!0,Q=[Q]),O=O||{};var B=O.sync,K=null,m=O.method||"GET";return O.post&&(m="POST"),O.method=m,G.asyncEach(Q,function(x,o){var B=new Wh;x=G.beforeLoadURL(x),x.data?o(null,x.data):(O.url=encodeURI(x),O.responseType?B.setResponseType(O.responseType):B.setOverrideMimeType(O.mimeType||"text/plain"),B.onload=function(){200===this.status||0===this.status?o(null,B.getResponseText()):o(!0)},B.onerror=function(){o(!0)},B.send(O))},function(o){var t="function"==typeof z;(t||B)&&(K=H&&o?o[0]:o,t&&z(K))}),B?K:void 0}});var ed=g.setPrototypeOf||function(z,K){return z.__proto__=K,z},Rk=g.getPrototypeOf||function(Y){return Y.__proto__},nq=g.freeze;g.isFrozen;var es=function(){var z=function(h){return h};return function(x){return x&&x.length?new Function("o",["return o['",x.join("']['"),"'];"].join("")):z}}(),sd=function(){var g=function(F,f){return F=f};return function(c){return c&&c.length?new Function("o","v",["return o['",c.join("']['"),"'] = v;"].join("")):g}}();!function(){function E(Y){var R=[];if(Y)for(var f;(f=O.exec(Y))!=c;)R.push(f[1]);return R}function s(q,i){var c=b.exec(i);this._cell=q,this._key=c[1],this._format=c[2],this._style=E(c[3])}function C(G){for(var D=this._cellList=[],x=this._paramList=[],V=G.split(r),W=0,I=V.length;I>W;++W){var Y=V[W];if("{{"!==Y)for(var N=Y.split(z),h=0,U=N.length;U>h;++h){var O=N[h];z.test(O)?(x.push(new s(D.length,O)),D.push(c)):O.length>0&&D.push(O)}else D.push("{")}this._formatList=this._cellList.slice(0)}var h={},Q={},r=/(\{\{)/,z=/(\{\w+(?:\:\w+(?:\&[\w\.])*)?\})/,b=/\{(\w+)(?:\:(\w+)((?:\&[\w\.])*))?\}/,O=/\&([\w\.]*)/g;C.prototype._73O=function(N){for(var X=this._paramList.length;X--;){var G=this._paramList[X],c=N[Ob(G._key)+1],s=Q[G._format];s&&(c=s(c,G._style)),this._formatList[G._cell]=c}return this._formatList.join("")},C.prototype._map=function(t){for(var V=this._paramList.length;V--;){var l=this._paramList[V],f=t[l._key],X=Q[l._format];X&&(f=X(f,l._style)),this._formatList[l._cell]=f}return this._formatList.join("")};var w=function(e){var S=h[e];return S||(h[e]=S=new C(e)),S._73O(arguments)};return w.map=function(z,Q){var p=h[z];return p||(h[z]=p=new C(z)),p._map(Q)},w.setValueFormat=function(w,u){Q[w]=u},w.gc=function(){h.length=0},w.__parsed=h,w}();var xp=function(){function D(b,M,S,H){var t=b?b.path.slice(0):[];M&&t.push(M),this.desc=S,this.name=M,this.path=nq(t),this.getter=es(t),this.setter=sd(t),this.isLeaf=H,this.parent=b,this.children=[],this.childMap={}}return D.create=function(){function o($,b,j,r){var i=r(j),W=new D($,b,j,i);if(!i){for(var h=W.children,G=W.childMap,t=g.keys(j),w=0,M=t.length;M>w;++w){var Y=t[w],L=o(W,Y,j[Y],r);h.push(L),G[L.name]=L}W.children=nq(h),W.childMap=nq(G)}return nq(W),W}return function(q,i){return o(c,c,q,i)}}(),D.prototype.forEach=function(S,Z){for(var A=this.children,X=0,s=A.length;s>X;++X){var o=A[X];S(o,Z)}},D}(),nq=g.freeze,In={main:{mask:1,priority:G.cameraPriority.main,clearDepth:!1,ignore:!1},top:{mask:2,priority:G.cameraPriority.top,ignore:!1}},wq="main",jf=In[wq].mask,Bh=function(E,t){E=E||0;var s;if(t in In)s=In[t].mask;else{if(!(32>gd))throw new Error("Only 31 render layer can be defined.");In[t]={mask:1<<gd++,priority:In[wq].priority},s=In[t].mask,Lq=Bg(g.keys(In)),gd=Lq.length}return E|=s},Aj=function(m){var z=0;if("string"==typeof m)z=Bh(z,m);else for(var k=0,Q=m.length;Q>k;++k)z=Bh(z,m[k]);return z},al=function(B,r){return B&&r&&B&r},Bg=function(x){return x.sort(function(c,h){return In[c].priority-In[h].priority})},Lq=Bg(g.keys(In)),gd=Lq.length;hn(G,{setRenderLayerInfo:function(L,H){if(Bh(0,L),H)for(var s in H)In[L][s]=H[s]},getRenderLayerInfo:function(b){return In[b]}},!0);var Vo=C.List=function(){this._as=[];var x,L,v=arguments.length;if(1===v){var K=arguments[0];if(gg(K)&&(K=K._as),zo(K))for(L=K.length,x=0;L>x;x++)this._as.push(K[x]);else K!=U&&this._as.push(K)}else if(v>1)for(x=0;v>x;x++)this._as.push(arguments[x])};ub("List",g,{forEach:function(h,q){this.each(h,q)},push:function(){for(var U=0;U<arguments.length;U++)this.add(arguments[U])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(y,l){return l===c?this._as.push(y):this._as.splice(l,0,y)},addAll:function(h){gg(h)&&(h=h._as),zo(h)?kq(this._as,h):this._as.push(h)},get:function(H){return this._as[H]},slice:function(F,R){return new Vo(this._as.slice(F,R))},remove:function(r){var m=this._as.indexOf(r);return m>=0&&m<this._as.length&&this.removeAt(m),m},removeAt:function(K){return this._as.splice(K,1)[0]},set:function(Q,s){return this._as[Q]=s},clear:function(){return this._as.splice(0,this._as.length)},contains:function(w){return this._as.indexOf(w)>=0},indexOf:function(F){return this._as.indexOf(F)},each:function(x,g){for(var N=0,n=this._as.length;n>N;N++){var X=this._as[N];g?x.call(g,X,N,this):x(X,N,this)}},reverseEach:function(S,a){for(var b=this._as.length-1;b>=0;b--){var e=this._as[b];a?S.call(a,e):S(e)}},getArray:function(){return this._as},toArray:function(V,t){if(V){for(var g,P=[],U=0,u=this._as.length;u>U;U++)g=this._as[U],t?V.call(t,g)&&P.push(g):V(g)&&P.push(g);return P}return this._as.concat()},toList:function(D,l){if(D){for(var j,J=new Vo,C=0,N=this._as.length;N>C;C++)j=this._as[C],l?D.call(l,j)&&J.add(j):D(j)&&J.add(j);return J}return new Vo(this)},reverse:function(){this._as.reverse()},sort:function(i){return this._as.sort(i?i:Dd),this},toString:function(){return this._as.toString()}}),g.defineProperties(Vo.prototype,{length:{get:function(){return this._as.length},set:function(F){this._as.length=F}}});var am=new Vo;hn(am,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:cp,each:cp,reverseEach:cp,toArray:function(){return[]},toList:function(){return new Vo},add:Cn,addAll:Cn,set:Cn,remove:Cn,removeAt:Cn,clear:Cn});var Ce=C.Notifier=function(){this._f=0};ub("Notifier",g,{contains:function(L,A){if(this._ls)for(var z,_=0,j=this._ls.size();j>_;_++)if(z=this._ls.get(_),L===z.l&&A===z.s)return!0;return!1},add:function(B,W,r){var u=this,T={l:B,s:W,a:r};u._ls||(u._ls=new Vo),u._f?(u._as||(u._as=new Vo),u._as.add(T)):T.a?u._ls.add(T,0):u._ls.add(T)},remove:function(_,r){var S=this;S._ls&&(S._f?(S._rs||(S._rs=new Vo),S._rs.add({l:_,s:r})):S._remove(_,r))},_remove:function(E,f){for(var e,W=this._ls,u=0,j=W.size();j>u;u++)if(e=W.get(u),e.l===E&&e.s===f)return W.removeAt(u),void 0},fire:function(H){var z=this,G=z._ls;if(z._b=1e4,G){++z._f;try{for(var x,I=0,n=G.size();n>I;I++)x=G.get(I),x.s?x.l.call(x.s,H):x.l(H)}catch(H){xq(function(){throw H})}finally{if(--z._f)return;if(z._rs){for(n=z._rs.size(),I=0;n>I;I++)x=z._rs.get(I),z._remove(x.l,x.s);delete z._rs}if(z._as){for(n=z._as.size(),I=0;n>I;I++)x=z._as.get(I),x.a?G.add(x,0):G.add(x);delete z._as}}}}});var Cb=C.Data=function(){this._id=uh()};ub("Data",g,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:U,_parent:U,_children:am,_childMap:U,_styleMap:U,_layer:"0",_renderLayer:wq,_renderLayerMask:jf,_adjustChildrenToTop:!1,getRenderLayerMask:function(){return this._renderLayerMask||jf},getRenderLayer:function(){return this._renderLayer||wq},setRenderLayer:function(f){var y=this,Q=Bh(0,f);y._renderLayerMask=Q;var w=y._renderLayer;y._renderLayer=f,y.fp("renderLayer",w,y._renderLayer)},testRenderLayer:function(w){var B=In[w];return B&&al(this._renderLayerMask,In[w].mask)},getUIClass:function(){return U},_22Q:function(){return U},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(F,L){var a=this;if(2===arguments.length)a.setStyle(F,L);else{if(!jb(F))return a.getStyle(F);for(var l in F)a.setStyle(l,F[l])}return a},fp:function(Y,G,e,O,K){return this.firePropertyChange(Y,G,e,O,K)},firePropertyChange:function(p,k,A,B,m){if(B){if(B(k,A))return!1}else if(k===A)return!1;var q=this,R=m||{};return R.property=p,R.oldValue=k,R.newValue=A,R.data=q,q._dataModel&&q._dataModel.handleDataPropertyChange(R),q.onPropertyChanged(R),!0},onPropertyChanged:function(I){var r=this,b=r._parent,z=I.property;if(Di(b)){var m=r.s(mo),t="s:ingroup"===z;(m&&yh[z]||z===t)&&b._81I(),(m||t)&&b.fp("childChange",!0,!1)}qs(b)&&(yh[z]||"elevation"===z||pf[z]||"scaleTall"===z||"tall"===z)&&b.updateFromChildren(),("s:alwaysOnTop"===z||"s:shape3d.alwaysOnTop"===z)&&(I.newValue?this.setRenderLayer("top"):this.setRenderLayer(c))},_21I:function(F){var T=this;if(F&&T._dataModel)throw"Remove data from dataModel before adding";T._dataModel=F},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var h=0,D=this._children.toArray(),B=D.length;B>h;h++)D[h].removeFromDataModel()},getId:function(){return this._id},setId:function(M){this._id=M},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(y,n){return this._children.toList(y,n)},eachChild:function(h,A){this._children.each(h,A)},addChild:function(A,l){var E=this;A!==E&&(E._children===am&&(E._children=new Vo,E._childMap={}),l>=0||(l=E._children.size()),E._childMap[A._id]||E.isDescendantOf(A)||(A._parent&&A._parent.removeChild(A),(0>l||l>E._children.size())&&(l=E._children.size()),E._children.add(A,l),E._childMap[A._id]=A,A.setParent(E),E.onChildAdded(A,l),E.fp(Xb,U,A)))},onChildAdded:function(){},removeChild:function(W){var i=this;if(i._childMap&&i._childMap[W._id]){var L=i._children.remove(W);delete i._childMap[W._id],i.fp(Xb,W,U),W.setParent(U,L),i.onChildRemoved(W,L)}},onChildRemoved:function(){},getChildAt:function(j){return this._children.get(j)},clearChildren:function(){var c=this;if(!c._children.isEmpty())for(var v=0,n=c._children.toArray(),l=n.length;l>v;v++)c.removeChild(n[v])},getParent:function(){return this._parent},setParent:function(v,N){var x=this;if(!(x._73I||x._parent===v||x===v||v&&v.isDescendantOf(x))){var g,V=x._parent;x._parent=v,x._73I=1,V?(N==U&&(N=V.getChildren().indexOf(x)),V.removeChild(x)):x._dataModel&&N==U&&(N=x._dataModel.getRoots().indexOf(x)),v&&(v.addChild(x),g=v.getChildren().indexOf(x)),delete x._73I,x.fp("parent",V,v,c,{oldIndex:N,newIndex:g}),x.onParentChanged(V,v)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(I){return I?this.isDescendantOf(I)||I.isDescendantOf(this):!1},isParentOf:function(g){return g&&this._childMap?!!this._childMap[g._id]:!1},isDescendantOf:function(i){if(!i||i.isEmpty())return!1;for(var c=this._parent;c;){if(i===c)return!0;c=c._parent}return!1},getStyle:function(Q,O){O===c&&(O=1);var L=this._styleMap?this._styleMap[Q]:c;return L===c&&O?Y[Q]:L},setStyle:function(W,Y){var a=this;a._styleMap||(a._styleMap={});var y=a._styleMap[W];Y===c?delete a._styleMap[W]:a._styleMap[W]=Y,a.fp("s:"+W,y,Y)&&a.onStyleChanged(W,y,Y)
},onStyleChanged:function(){},iv:function(N){this.invalidate(N)},invalidate:function(i){this.fp(i||"*",!1,!0)},toString:function(){var R=this;return R._displayName||R._name||R._tag||R._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(f,W){var z=this,R=z.s(Lc);z.beginTransaction(),R||z.s(Lc,R={}),W?R[f]=W:delete R[f],z.fp(Lc,U,R),z.endTransaction()},removeStyleIcon:function(L){var N=this.s(Lc);if(N){var w=N[L];delete N[L],this.fp(Lc,U,N)}return w},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(E){var R=this;if(R.hasOwnProperty("_anchor")||R.hasOwnProperty("_anchorElevation")){var q=R.getAnchor3d(),N={x:q.x-.5,y:q.y-.5,z:q.z-.5};Ic(E,[-N.x,-N.y,-N.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,renderLayer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var h,g={};for(h in this._styleMap)g[h]=1;return g},getCurrentPrefix:function(){return this._interactPrefix||Ng},ca:function(h,A){var K=this.getCurrentPrefix();return h=K+h,2===arguments.length?this.a(h,A):this.a(h)}});var sm=C.DataModel=function(){var u=this;u._isDeserializing=0,u._datas=new Vo,u._dataMap={},u._roots=new Vo,u._rootMap={},u._fsDataMap={},u._78O={},u._reflectorMap={},u._36I=new Ce,u._35I=new Ce,u._serializeNotifier=new Ce,u._selectionModel=new pq(u);var A=u._29Q=[],m=u._scheduleCallback=function(){for(var w=Date.now(),X=0;X<A.length;X++){var x=A[X];x.enabled&&w-x.lastTime>x.interval&&(x.beforeAction&&x.beforeAction(),x.action&&u.each(function(c){x.action(c)}),x.afterAction&&x.afterAction(),x.lastTime=w)}A.length&&(u._30Q=i.requestAnimationFrame(m))}};ub("DataModel",g,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmapType","envmap","postProcessingData","init"],_name:c,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:c,_init:c,_envmap:c,_envmapType:c,_postProcessingData:c,sm:function(){return this.getSelectionModel()},mm:function(Q,t,X){this.addDataModelChangeListener(Q,t,X)},umm:function(R,z){this.removeDataModelChangeListener(R,z)},md:function(E,c,n){this.addDataPropertyChangeListener(E,c,n)},umd:function(K,W){this.removeDataPropertyChangeListener(K,W)},mh:function(D,d,j){this.addHierarchyChangeListener(D,d,j)},umh:function(d,y){this.removeHierarchyChangeListener(d,y)},getAttrObject:function(){return this._attrObject},setAttrObject:function(j){return this._attrObject=j},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(Z){return this._dataMap[Z]},removeDataById:function(c){this.remove(this.getDataById(c))},toDatas:function(X,Y){return this._datas.toList(X,Y)},each:function(D,l){this._datas.each(D,l)},getDataByTag:function(s){return this._78O[s]},getTagMap:function(){return this._78O},removeDataByTag:function(x){this.remove(this.getDataByTag(x))},add:function(h,I,P){var H=this,n=h._id,R=h._tag,G=H._roots;if(H._dataMap[n])throw"'"+n+"' already exists";R!=U&&(H._78O[R]=h),H._dataMap[n]=h,P>=0?H._datas.add(h,P):H._datas.add(h),h._parent||(H._rootMap[n]=h,I>=0?G.add(h,I):G.add(h)),h.s("fullscreen")!==c&&(H._fsDataMap[n]=h),h.s("shape3d.reflector")&&(H._reflectorMap[n]=h),h._21I(H),H.onAdded(h),H._36I.fire({kind:"add",data:h,rootsIndex:I,datasIndex:P})},onAdded:function(){},remove:function(s,o){if(s){var r=this,p=s._id,$=o&&o.keepStructure,X=o&&o.keepChildren,n=s.getTag();if(s._dataModel===r){var O=s instanceof af;O&&G.setIsolating(!0),this.beginTransaction(),$?r._removingData||(r._removingData=s):r.prepareRemove(s),X||s.toChildren().each(function(J){r.remove(J,o)},r),$?r._removingData===s&&(s._parent&&s._parent.removeChild(s),delete r._removingData):s._parent&&s._parent.removeChild(s);var K=r._datas.remove(s);delete r._dataMap[p],n!=U&&delete r._78O[n];var Z;r._rootMap[p]&&(delete r._rootMap[p],Z=r._roots.remove(s)),r._fsDataMap[p]&&delete r._fsDataMap[p],r._reflectorMap[p]&&delete r._reflectorMap[p],s._21I(U),r.onRemoved(s),r._36I.fire({kind:Db,data:s,rootsIndex:Z,datasIndex:K}),this.endTransaction(),O&&G.setIsolating(!1)}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var W=this;if(W._datas.size()){var B=W._historyManager?this.toJSON():c;W._datas.toArray().forEach(function(l){l._21I(U)}),W._datas.clear(),W._dataMap={},W._roots.clear(),W._rootMap={},W._fsDataMap={},W._reflectorMap={},W._78O={},W._36I.fire({kind:ke,json:B})}},contains:function(T){return T&&T._dataModel===this},handleDataPropertyChange:function(p){var _=this,M=p.data,n=p.property;if("parent"===n){var C=M._id,r=_._rootMap,A=_._roots;M._parent?r[C]&&(delete r[C],A.remove(M)):r[C]||(r[C]=M,A.add(M))}else if("tag"===n){var c=p.oldValue,x=p.newValue,G=_._78O;c!=U&&delete G[c],x!=U&&(G[x]=M)}else if("s:fullscreen"===n){var C=M._id,Q=_._fsDataMap;p.oldValue!=U&&delete Q[C],p.newValue!=U&&(Q[C]=M)}else if("s:shape3d.reflector"===n){var C=M._id,w=_._reflectorMap;p.oldValue&&delete w[C],p.newValue&&(w[C]=M)}this.onDataPropertyChanged(M,p),this._35I.fire(p)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(U,K,o){this._36I.add(U,K,o)},removeDataModelChangeListener:function(x,c){this._36I.remove(x,c)},addSerializeListener:function(x,c,N){this._serializeNotifier.add(x,c,N)},removeSerializeListener:function(B,m){this._serializeNotifier.remove(B,m)},fireSerializeEvent:function(F){this._serializeNotifier.fire(F)},addDataPropertyChangeListener:function(i,L,Q){this._35I.add(i,L,Q)},removeDataPropertyChangeListener:function(P,D){this._35I.remove(P,D)},_38I:function(G,z,w){this._37I&&this._37I.fire({data:G,oldIndex:z,newIndex:w})},addHierarchyChangeListener:function(V,r,k){this._37I||(this._37I=new Ce),this._37I.add(V,r,k)},removeHierarchyChangeListener:function(k,S){this._37I.remove(k,S)},getSiblings:function(x){var C=x._parent;return C?C._children:this._roots},eachByHierarchical:function(O,w,n){if(w)return this._eachByHierarchical(O,w,n);for(var A=0,o=this._roots,z=o.size();z>A;A++)if(this._eachByHierarchical(O,o.get(A),n)===!1)return!1;return!0},_eachByHierarchical:function(Q,E,M){if(M){if(Q.call(M,E)===!1)return!1}else if(Q(E)===!1)return!1;for(var F=E.size(),R=0;F>R;R++)if(this._eachByHierarchical(Q,E.getChildAt(R),M)===!1)return!1;return!0},reverseEachByHierarchical:function(P,O,i){if(O)return this._reverseEachByHierarchical(P,O,i);for(var d=this._roots,t=d.size(),X=t-1;X>=0;X--)if(this._reverseEachByHierarchical(P,d.get(X),i)===!1)return!1;return!0},_reverseEachByHierarchical:function(n,i,A){for(var e=i.size(),D=e-1;D>=0;D--)if(this._reverseEachByHierarchical(n,i.getChildAt(D),A)===!1)return!1;if(A){if(n.call(A,i)===!1)return!1}else if(n(i)===!1)return!1;return!0},eachByDepthFirst:function(e,f,j){if(f)return this._11I(e,f,j);for(var u=0,C=this._roots,E=C.size();E>u;u++)if(this._11I(e,C.get(u),j)===!1)return!1;return!0},_11I:function(g,N,d){for(var T=N.size(),B=0;T>B;B++)if(this._11I(g,N.getChildAt(B),d)===!1)return!1;if(d){if(g.call(d,N)===!1)return!1}else if(g(N)===!1)return!1;return!0},eachByBreadthFirst:function(d,Q,h){var H=new Vo;for(Q?H.add(Q):this._roots.each(H.add,H);H.size()>0;)if(Q=H.removeAt(0),Q.eachChild(H.add,H),h){if(d.call(h,Q)===!1)return!1}else if(d(Q)===!1)return!1;return!0},moveTo:function(f,G){var r=this.getSiblings(f),M=r.indexOf(f);M===G||0>M||G>=0&&G<=r.size()&&(r.remove(f),G>r.size()&&G--,r.add(f,G),this._38I(f,M,G))},moveUp:function($){this.moveTo($,this.getSiblings($).indexOf($)-1)},moveDown:function(w){this.moveTo(w,this.getSiblings(w).indexOf(w)+1)},moveToTop:function(N){this.moveTo(N,0)},moveToBottom:function(a){this.moveTo(a,this.getSiblings(a).size())},moveSelectionUp:function(X){this.beginTransaction(),X||(X=this.sm());var q=new Vo;jh(X,q,this._roots),q.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(j){this.beginTransaction(),j||(j=this.sm());var L=new Vo;hm(j,L,this._roots),L.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(i){this.beginTransaction(),i||(i=this.sm());var h=new Vo;En(i,h,this._roots),h.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(w){this.beginTransaction(),w||(w=this.sm());var D=new Vo;ao(w,D,this._roots),D.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(o,w,b){var K=this.getDatas();null==b&&(b=K.indexOf(o)),b===w||0>b||w>=0&&w<=K.size()&&(K.remove(o),w>K.size()&&w--,K.add(o,w),this._76I(o,b,w))},bringForward:function(U){this.moveToIndex(U,this.getDatas().indexOf(U)+1)},bringToFront:function(H){this.moveToIndex(H,this.size())},sendBackward:function(X){this.moveToIndex(X,this.getDatas().indexOf(X)-1)},sendToBack:function(R){this.moveToIndex(R,0)},bringSelectionForward:function(K){this.beginTransaction(),K||(K=this.sm());for(var N=new Vo,j=this.getDatas(),q=!1,G=0;G<j.size();G++){var Y=j.get(j.size()-1-G);K.contains(Y)?q&&N.add(Y):q=!0}N.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(u){this.beginTransaction(),u||(u=this.sm());for(var o=new Vo,U=this.getDatas(),d=0;d<U.size();d++){var P=U.get(d);u.contains(P)&&o.add(P)}o.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(K){this.beginTransaction(),K||(K=this.sm());for(var t=new Vo,l=this.getDatas(),I=!1,W=0;W<l.size();W++){var R=l.get(W);K.contains(R)?I&&t.add(R):I=!0}t.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(J){this.beginTransaction(),J||(J=this.sm());for(var m=new Vo,M=this.getDatas(),p=0;p<M.size();p++){var z=M.get(M.size()-1-p);J.contains(z)&&m.add(z)}m.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(r){var l=this;l.removeScheduleTask(r),r.enabled==U&&(r.enabled=!0),r.interval==U&&(r.interval=10),r.lastTime=Date.now(),l._29Q.push(r),l._30Q==U&&(l._30Q=i.requestAnimationFrame(l._scheduleCallback))},removeScheduleTask:function(Q){var T=this,R=T._29Q,w=R.indexOf(Q);w>=0&&R.splice(w,1),R.length||T._30Q==U||(i.cancelAnimationFrame(T._30Q),delete T._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(H){this._historyManager||new C.HistoryManager(this),null!=H&&this._historyManager.setMaxHistoryCount(H),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(g){this._historyManager&&this._historyManager.undo(g)},redo:function(j){this._historyManager&&this._historyManager.redo(j)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(j){this._historyManager&&this._historyManager.addHistory(j)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(X){X?this._isDeserializing++:this._isDeserializing--},updateLayoutAttach:function(G){this.each(function(J){J instanceof Hh&&J.getImage()===G&&J.updateLayoutAttaches()})},isCubicEnvmap:function(){return!1},setCubicEnvmap:function(){}});var pq=C.SelectionModel=function(N){var x=this;x._68O=Jo,x._map={},x._73O=new Vo,x._74I=new Ce,x._21I(N)};ub("SelectionModel",g,{ms_fire:1,ms_dm:1,ms:function(c,v,u){this.addSelectionChangeListener(c,v,u)},ums:function(O,w){this.removeSelectionChangeListener(O,w)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===uo},co:function(i){return this._map[i._id]!=U},ss:function(u){this.setSelection(u)},as:function(a){this.appendSelection(a)},rs:function(n){this.removeSelection(n)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(O){var b=this;if(b._68O!==O&&(O===Jj||O===uo||O===Jo)){b.cs();var M=b._68O;b._68O=O,b.fp("selectionMode",M,O)}},_21I:function(W){var i=this,x=i._dataModel;x!==W&&(x&&(i.cs(),x.umm(i.handleDataModelChange,i)),i._dataModel=W,W.mm(i.handleDataModelChange,i,!0),i.fp(ln,x,W))},dispose:function(){var Z=this;Z.cs(),Z._dataModel.umm(Z.handleDataModelChange,Z)},handleDataModelChange:function(f){var L=this;if(f.kind===Db){var u=f.data;L.co(u)&&(L._73O.remove(u),delete L._map[u._id],L._75I(Db,new Vo(u)))}else f.kind===ke&&L.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(B){var h=this;if(h._filterFunc!==B){h.cs();var $=h._filterFunc;h._filterFunc=B,h.fp("filterFunc",$,h._filterFunc)}},_75I:function(E,h,L,B){L&&(this._73O.each(function(J){B[J._id]?L.remove(J):L.add(J)}),h=L.toList()),this._74I.fire({kind:E,datas:new Vo(h)})},addSelectionChangeListener:function(i,J,x){this._74I.add(i,J,x)},removeSelectionChangeListener:function(e,Z){this._74I.remove(e,Z)},_97O:function(n,D){for(var e,W=this,J=0,E=new Vo(n);J<E.size();J++)e=E.get(J),(W._filterFunc&&!W._filterFunc(e)||D&&W.co(e)||!D&&!W.co(e)||!W._dataModel.contains(e))&&(E.removeAt(J),J--);return E},appendSelection:function(x){var P=this;if(P._68O!==Jj){var _,k,y=P._73O,T=P._97O(x,!0);T.isEmpty()||(P.sg()&&(_=new Vo(y),k=P._map,y.clear(),P._map={},T=new Vo(T.get(T.size()-1))),T.each(function(f){y.add(f),P._map[f._id]=f}),P._75I("append",T,_,k))}},removeSelection:function(L){var w=this,c=w._97O(L),H=0,F=c.size();if(0!==F){for(;F>H;H++){var q=c.get(H);w._73O.remove(q),delete w._map[q._id]}w._75I(Db,c)}},toSelection:function(j,e){return this._73O.toList(j,e)},getSelection:function(){return this._73O},each:function(q,K){this._73O.each(q,K)},setSelection:function(m){var v=this,L=v._73O;if(v._68O!==Jj&&!(L.isEmpty()&&!m||1===L.size()&&v.ld()===m)){var f=new Vo(L),w=v._map;L.clear(),v._map={};var b=v._97O(m,!0);v.sg()&&b.size()>1&&(b=new Vo(b.get(b.size()-1))),b.each(function(q){L.add(q),v._map[q._id]=q}),v._75I("set",U,f,w)}},clearSelection:function(){var l=this,g=l._73O;if(g.size()>0){var s=g.toList();g.clear(),l._map={},l._75I(ke,s)}},selectAll:function(){var O=this;if(O._68O!==Jj){var $,m,i=O._dataModel.toDatas();if(O._filterFunc)for($=0;$<i.size();$++)m=i.get($),O._filterFunc(m)||(i.removeAt($),$--);var B=O._73O,R=new Vo(B),g=O._map;B.clear(),O._map={},O.sg()&&i.size()>1&&(i=new Vo(i.get(i.size()-1)));var a=i.size();for($=0;a>$;$++)m=i.get($),B.add(m),O._map[m._id]=m;O._75I("all",U,R,g)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(T){return this._map[T._id]!=U},getLastData:function(){var W=this._73O;return W.size()>0?W.get(W.size()-1):U},getFirstData:function(){var T=this._73O;return T.size()>0?T.get(0):U},isSelectable:function(v){var R=this;return v&&R._68O!==Jj?R._filterFunc?R._filterFunc(v):!0:!1},getTopSelection:function(){var w=this,o=new Vo;return w._73O.each(function(n){for(var A=n.getParent();A;){if(w.contains(A)){n=U;break}A=A.parent}n&&o.add(n)}),o}});var Zc=function(){return Nd(0),function(E,G){var N;if(tm(G)){var Y=E.getDataUI(G);Y&&Y._88I&&(N=Y._88I.rect)}return N?N:G.getRect()}}();hn(G,{edgeGroupAgentFunc:U,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:P.rectSelectBorder,graphViewRectSelectBackground:bj,graphViewEditPointSize:jg?17:7,graphViewEditPointBorderColor:P.editPointBorder,graphViewEditPointBackground:P.editPointBackground,setEdgeType:function($,e,t){Kb[$]=e,Ko[$]=t},getEdgeType:function(T){return Kb[T]},getEdgeTypeMap:function(){return Kb},getNodeRect:Zc},!0);var qp={"layout.h":c,"layout.v":c,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":c,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:c,ingroup:!0,"body.color":c,"2d.gray":!1,fullscreen:c,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:c,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":Hr,"select.width":1,"select.padding":2,"select.type":co,"shadow.interactable":!0,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,shadow2:!1,"shadow2.color":Hr,"shadow2.blur":6,"shadow2.offset.x":3,"shadow2.offset.y":3,"border.color":c,"border.width":2,"border.padding":2,"border.type":co,label:c,"label.font":c,"label.color":Cj,"label.background":c,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":c,"label.max":c,"label.opacity":c,"label.scale":1,"label.align":c,"label.selectable":!0,label2:c,"label2.font":c,"label2.color":Cj,"label2.background":c,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":c,"label2.max":c,"label2.opacity":c,"label2.scale":1,"label2.align":c,"label2.selectable":!0,note:c,"note.expanded":!0,"note.font":c,"note.color":ag,"note.background":Hr,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":c,"note.toggleable":!0,"note.border.width":1,"note.border.color":c,"note.opacity":c,"note.scale":1,"note.align":c,note2:c,"note2.expanded":!0,"note2.font":c,"note2.color":ag,"note2.background":Hr,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":c,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":c,"note2.opacity":c,"note2.scale":1,"note2.align":c,"group.type":c,"group.image":c,"group.image.stretch":"fill","group.repeat.image":c,"group.border.repeat.image":c,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":c,"group.title.color":ag,"group.title.background":P.groupTitleBackground,"group.title.align":Ld,"group.title.orientation":vc,"group.background":P.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":c,"group.border.color":Xp,"group.border.radius":c,"group.border.cap":df,"group.border.join":Mk,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":U,"group.gradient.color":"#FFF",shape:c,"shape.background":Xp,"shape.repeat.image":c,"shape.border.repeat.image":c,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Xp,"shape.border.3d":!1,"shape.border.3d.color":c,"shape.border.3d.accuracy":c,"shape.border.cap":df,"shape.border.join":Mk,"shape.border.pattern":c,"shape.gradient":U,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":qc,"shape.dash.offset":0,"shape.dash.color":Vn,"shape.dash.width":c,"shape.dash.3d":!1,"shape.dash.3d.color":c,"shape.dash.3d.accuracy":c,"shape.polygon.side":6,"shape.arc.from":S,"shape.arc.to":t,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":c,"shape.gradient.pack":c,"shape.border.gradient.pack":c,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":c,"shape.foreground.gradient":U,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":c,"autolayout.hgap":c,"autolayout.vgap":c,"edge.type":c,"edge.points":c,"edge.segments":c,"edge.color":Xp,"edge.width":2,"edge.width.absolute":!1,"edge.repeat.image":null,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":c,"edge.3d.accuracy":c,"edge.cap":df,"edge.join":Mk,"edge.source.position":17,"edge.source.anchor.x":c,"edge.source.anchor.y":c,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":c,"edge.target.anchor.y":c,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":c,"edge.dash":!1,"edge.dash.pattern":qc,"edge.dash.offset":0,"edge.dash.color":Vn,"edge.dash.width":c,"edge.dash.3d":!1,"edge.dash.3d.color":c,"edge.dash.3d.accuracy":c,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":c,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":c,"grid.column.percents":c,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":P.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":P.gridCellBorderColor,"grid.block":c,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":P.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Cj,"text.gradient.pack":c,"text.font":fj,"text.shadow":!1,"text.shadow.color":Hr,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,"text.gradient":c,"text.gradient.color":"#FFF","text.decoration":c,"text.vertical":!1,"text.vertical.gap":1,keepPosition:!0};qp[Nf]=c,hn(Y,qp,!0),hn(sm,{_76I:function(u,H,E){this._39I&&this._39I.fire({data:u,oldIndex:H,newIndex:E})},addIndexChangeListener:function(K,b,z){var x=this;x._39I||(x._39I=new Ce),x._39I.add(K,b,z)},removeIndexChangeListener:function(d,X){this._39I.remove(d,X)},prepareRemove:function(N){hq(N)&&(N.setSource(U),N.setTarget(U)),N._70O&&N._70O.toList().each(this.remove,this),N._69O&&N._69O.toList().each(function(T){T.setHost(U)}),N._host&&N.setHost(U)},onAdded:function(S){this.isAutoAdjustIndex()&&this.adjustIndex(S)},onDataPropertyChanged:function(Q,Z){Zg[Z.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(Q)},isAdjustable:function(D){return Je(D)||hq(D)},isAdjustedToBottom:function(h){return Di(h)?h.isExpanded()&&cn(h):!1},adjustIndex:function(M){var g=this;this.isHierarchicalRendering()||(g.isAdjustedToBottom(M)?(g.sendToBottom(M),M.eachChild(g.adjustIndex,g)):g.sendToTop(M))},sendToTop:function(A){var s=this;if(s.contains(A)&&s.isAdjustable(A)){var h=s._datas;if(A!==h.get(s.size()-1)){var X=h.indexOf(A);h.removeAt(X),h.add(A),s._76I(A,X,s.size()-1)}if(hq(A)){var M=A._40I;M&&!s.isAdjustedToBottom(M)&&s.sendToTop(M),M=A._41I,M&&!s.isAdjustedToBottom(M)&&s.sendToTop(M)}A._69O&&A._69O.each(function(X){X.isRelatedTo(A)||Je(A)&&X.isLoopedHostOn(A)||s.sendToTop(X)}),A.ISubGraph||(!Di(A)||A.isExpanded())&&A._adjustChildrenToTop&&A.eachChild(function(u){hq(u)||s.sendToTop(u)})}},sendToBottom:function(G,N){var o=this;if(G!==N&&o.contains(G)&&o.isAdjustable(G)&&(!N||o.contains(N))){var e=o._datas,c=e.remove(G),L=N?o._datas.indexOf(N):0;if(e.add(G,L),c!==L){o._76I(G,c,L);var g=G._parent;!g||g.ISubGraph||hq(g)||o.sendToBottom(G._parent,G)}}}}),hn(Gg,{ms_edit:function(h){h._46O=function(p){var E=this,Y=E.gv.dm(),c=E._index,P=E._89I,N=E._node,A=E._shape,M=E._edge,Q=E._77I;N&&P?(this.fi({kind:"endEditRect",event:p,data:N,direction:P}),Y.endTransaction()):A&&c>=0?(E.fi({kind:"endEditPoint",event:p,data:A,index:c}),Y.endTransaction()):M&&c>=0?(E.fi({kind:"endEditPoint",event:p,data:M,index:c}),Y.endTransaction()):Q&&(E.fi({kind:"endEditRotation",event:p,data:Q}),Y.endTransaction())},h._78I=function(m){var h=this;h.autoScroll(m);var Y=h.gv.lp(m),q=h._index,L=h._89I,u=h._node,z=h._shape,c=h._edge,K=h._77I;if(u&&L)h._80O(Y),h.fi({kind:"betweenEditRect",event:m,data:u,direction:L});else if(z&&q>=0)Y.e=z.getPoints().get(q).e,z.setPoint(q,Y),h.fi({kind:"betweenEditPoint",event:m,data:z,index:q});else if(c&&q>=0){var p=c.s(tg);Y.e=p.get(q).e,p.set(q,Y),c.fp(tg,U,p),h.fi({kind:"betweenEditPoint",event:m,data:c,index:q})}else if(K){var V=K.p(),P=K.getScale(),d=Cg+dj(Y.y-V.y,Y.x-V.x);P.y<0&&(d+=S),k(d)<.04&&(d=0),K.setRotation(d),h.fi({kind:"betweenEditRotation",event:m,data:K})}},h._80O=function(Q){var d=this,m=d._node,N=d._rect,P=N.x,b=N.y,n=N.width,H=N.height,l=d._89I,Z=d._anchor,S=d._matrix,Q=S.tfi(Q);"northwest"===l?N=Fq(Q,{x:P+n,y:b+H}):l===hf?N=Fq({x:P,y:Q.y},{x:P+n,y:b+H}):"northeast"===l?N=Fq({x:P,y:Q.y},{x:Q.x,y:b+H}):l===rh?N=Fq({x:Q.x,y:b},{x:P+n,y:b+H}):l===No?N=Fq({x:P,y:b},{x:Q.x,y:b+H}):"southwest"===l?N=Fq({x:Q.x,y:b},{x:P+n,y:Q.y}):"south"===l?N=Fq({x:P,y:b},{x:P+n,y:Q.y}):"southeast"===l&&(N=Fq({x:P,y:b},Q)),m.setPosition(S.tf(N.x+N.width*Z.x,N.y+N.height*Z.y)),m.setWidth(N.width),m.setHeight(N.height)},h._80I=function(k,M,G,z){var r=this,t=r.gv._zoom,I=(r.gv.getEditPointSize()+2)/t;return Qn({x:M-I/2,y:G-I/2,width:I,height:I},k)?(r._89I!==z&&(r._89I=z),!0):!1},h._79I=function(x,F,E){var $=this,Y=$.gv,z=F?Y.getDataUI(F):U,B=z?z._55O:U;if(B){var n,S,Q,f,q=Y._zoom,W=(Y.getEditPointSize()+2)/q,A=Y.lp(x);if(Je(F)){if(B._56O&&Je(F)&&(S=B._98o,Qn({x:S.x-W/2,y:S.y-W/2,width:W,height:W},A)))return $._77I=F,E&&$.fi({kind:"beginEditRotation",event:x,data:F}),$.setCursor("crosshair"),!0;if(B._43O&&F instanceof ys)for(Q=F.getPoints(),n=Q.size()-1;n>=0;n--)if(S=Q.get(n),Qn({x:S.x-W/2,y:S.y-W/2,width:W,height:W},A))return $._index=n,$._shape=F,E&&$.fi({kind:"beginEditPoint",event:x,data:F,index:n}),$.setCursor("crosshair"),!0;if(B._42O)for(var r=F.getEditControlPoints(),u=["northwest",-1,-1,rh,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,No,1,0,"northeast",1,-1,hf,0,-1],n=0,f=r.length;f>n;n++){var s=u[3*n],L=r[n];if($._80I(A,L.x,L.y,s)){$._node=F;var Z=F.getWidth(),T=F.getHeight(),t=F.getAnchor();$._rect={x:-Z*t.x,y:-T*t.y,width:Z,height:T},$._anchor=t,$._matrix=F.getMatrix();var D=F.getRotation(),e=b(D),H=_(D),K=u[3*n+1]*ki(F.getScale().x),y=u[3*n+2]*ki(F.getScale().y),X=Math.atan2(-H*K-e*y,e*K-H*y),o=(Math.round(X/(Math.PI/4))+8)%8,g=[Sm,"nesw-resize",Sg,"nwse-resize",Sm,"nesw-resize",Sg,"nwse-resize"][o];return $.setCursor(g),E&&$.fi({kind:"beginEditRect",event:x,data:F,direction:$._89I}),!0}}}if(B._43O&&hq(F)&&F.s(Hk)===vn&&(Q=F.s(tg)))for(n=Q.size()-1;n>=0;n--)if(S=Q.get(n),Qn({x:S.x-W/2,y:S.y-W/2,width:W,height:W},A))return $._index=n,$._edge=F,E&&$.fi({kind:"beginEditPoint",event:x,data:F,index:n}),$.setCursor("crosshair"),!0}return!1}},ms_gv:function(R){R._currentSubGraph=U,R._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},R.upSubGraph=function(){this.setCurrentSubGraph(bk(this._currentSubGraph))},R.isVisible=function(o){var n=this;if(bk(o)!==n._currentSubGraph)return!1;if(hq(o)){var v=o._40I,d=o._41I;if(!v||!d)return!1;if(!(o.s("edge.independent")||n.isVisible(v)&&n.isVisible(d)))return!1;if(o.isEdgeGroupHidden())return!1}else for(var P=o._parent;P&&!P.ISubGraph;){if(Di(P)&&(!P.isExpanded()||!n.isVisible(P)))return!1;P=P._parent}if(o._parent instanceof af&&!n.isVisible(o._parent))return!1;if(o._refGraph instanceof qn&&!n.isVisible(o._refGraph))return!1;if(n instanceof Qm){if(!o.s("3d.visible"))return!1}else{var E=n.getLayersInfo();if(E){var i=E[o._layer];if(i&&i.visible===!1)return!1}if(!o.s("2d.visible"))return!1}return n._visibleFunc?n._visibleFunc(o):!0},R.handleSelectionChange=function(a){var s=this;a.datas.each(function(R){s.invalidateData(R);var r=R._parent;Di(r)&&Je(R)&&R.s(mo)&&(s.invalidateData(r),r._49I&&r._49I.each(function(i){s.invalidateData(i)}))}),s.onSelectionChanged(a)},R.onSelectionChanged=function(J){var U=this,f=U.sm();if(1===f.size()&&("set"===J.kind||"append"===J.kind)){var o=f.ld();U.isAutoMakeVisible()&&U.makeVisible(o),U.adjustIndex&&U._dataModel.isAutoAdjustIndex()&&U.adjustIndex(o)}},R.makeVisible=function(g){if(g){var H=this,O=H.getDataUI?H.getDataUI(g):H.getData3dUI(g);if(O){var R=g,L=bk(g);for(L!==H._currentSubGraph&&H.setCurrentSubGraph(L);(R=R._parent)&&R!==L;)Di(R)&&R.setExpanded(!0);H._23I=g,H.iv()}}},R.getLabel=function(l){var J=l.getStyle(Np);return J===c?l.getName():J},R.getLabelBackground=function(u){return u.getStyle("label.background")},R.getLabelColor=function(t){return t.getStyle("label.color")},R.getLabel2=function(S){return S.getStyle("label2")},R.getLabel2Background=function(X){return X.getStyle("label2.background")},R.getLabel2Color=function(T){return T.getStyle("label2.color")},R.getNote=function(K){return K.getStyle(oj)},R.getNoteBackground=function(B){return B.getStyle("note.background")},R.getNote2=function(H){return H.getStyle(ok)},R.getNote2Background=function(g){return g.getStyle("note2.background")},R.handleClick=function(w,H,I){var m=this;H?(m.fi({kind:"clickData",event:w,data:H,part:I}),m.onDataClicked(H,w)):(m.fi({kind:"clickBackground",event:w}),m.onBackgroundClicked(w))},R.handleDoubleClick=function(F,X,k){var Z=this;dr(F)&&(X?(Z.fi({kind:"doubleClickData",event:F,data:X,part:k}),Z.onDataDoubleClicked(X,F,k),Z.checkDoubleClickOnNote(F,X,k)||Z.checkDoubleClickOnRotation&&Z.checkDoubleClickOnRotation(F,X,k)||(hq(X)?Z.onEdgeDoubleClicked(X,F,k):X.ISubGraph?Z.onSubGraphDoubleClicked(X,F,k):Di(X)?Z.onGroupDoubleClicked(X,F,k):X.IDoorWindow?Z.onDoorWindowDoubleClicked(X,F,k):X.ICSGBox&&Z.onCSGBoxDoubleClicked(X,F,k))):(Z.fi({kind:"doubleClickBackground",event:F}),Z.onBackgroundDoubleClicked(F)))},R.onSubGraphDoubleClicked=function(g){this.setCurrentSubGraph(g)},R.onEdgeDoubleClicked=function(J,X){this.isEditable(J)||(J.ISubGraph&&!Pm(X)?this.setCurrentSubGraph(J):J.s("edge.toggleable")&&J.toggle())},R._39Q=function(B){return this.isInteractive(B)?this.preventDefaultWhenInteractive(B):!1},R.preventDefaultWhenInteractive=function(o){return o.s("preventDefaultWhenInteractive")},R.onGroupDoubleClicked=function(v){v.s("group.toggleable")&&v.toggle()},R.onDoorWindowDoubleClicked=function(V){V.s("dw.toggleable")&&V.toggle(!0)},R.onCSGBoxDoubleClicked=function(s,H){var f=this;if(f instanceof Qm){var J=f.intersectObject(H,s);J&&s.s(J.part+".toggleable")&&s.toggleFace(J.part,!0)}},R.onBackgroundClicked=function(){},R.onBackgroundDoubleClicked=function(){this.upSubGraph()},R.onDataClicked=function(){},R.onDataDoubleClicked=function(){},R.onAutoLayoutEnded=function(){},R.onMoveEnded=function(){},R.onPanEnded=function(){},R.onPinchEnded=function(){},R.onRectSelectEnded=function(){},R.onZoomEnded=function(){},R.serialize=function(x){return this.dm().serialize(x)},R.toJSON=function(){return this.dm().toJSON()},R.deserialize=function(m,n){var N=this;n=n instanceof Cb?{rootParent:n}:Nj(n)?{setId:n}:kk(n)?{finishFunc:n}:n||{},n.view=N;var v=N.dm();return n.__innerHandler__=function(o){if(Nj(v.a("toolTipEnable"))&&(v.a("toolTipEnable")?N.enableToolTip():N.disableToolTip()),N instanceof C.graph.GraphView&&(Nj(v.a("zoomable"))&&N.setZoomable&&N.setZoomable(v.a("zoomable")),Nj(v.a("pannable"))&&N.setPannable&&N.setPannable(v.a("pannable")),Nj(v.a("rectSelectable"))&&N.setRectSelectable&&N.setRectSelectable(v.a("rectSelectable")),v.a("fitContent")===!0&&N.fitContent&&N.fitContent(!0,0)),N instanceof C.graph3d.Graph3dView){var r=o.scene;r&&r.shadow!=U&&N.shadowMap.setShadow(r.shadow,r.shadowParams);var h=v.a("sceneContext");h?(h.eye&&N.setEye(h.eye),h.center&&N.setCenter(h.center),Bk(h.far)&&N.setFar(h.far),Bk(h.near)&&N.setNear(h.near)):(Bk(v.a("sceneNear"))&&N.setNear(v.a("sceneNear")),Bk(v.a("sceneFar"))&&N.setFar(v.a("sceneFar")),r&&(r.eye&&N.setEye(r.eye),r.center&&N.setCenter(r.center))),Nj(v.a("sceneShadowEnabled"))&&(v.a("sceneShadowEnabled")?N.enableShadow():N.disableShadow()),Bk(v.a("sceneShadowDegreeX"))&&N.setShadowDegreeX(v.a("sceneShadowDegreeX")),Bk(v.a("sceneShadowDegreeZ"))&&N.setShadowDegreeZ(v.a("sceneShadowDegreeZ")),Bk(v.a("sceneShadowIntensity"))&&N.setShadowIntensity(v.a("sceneShadowIntensity")),v.a("sceneShadowQuality")!=U&&N.setShadowQuality(v.a("sceneShadowQuality")),v.a("sceneShadowType")&&N.setShadowType(v.a("sceneShadowType")),Bk(v.a("sceneShadowRadius"))&&N.setShadowRadius(v.a("sceneShadowRadius")),Bk(v.a("sceneShadowBias"))&&N.setShadowBias(v.a("sceneShadowBias")),Nj(v.a("sceneDashEnable"))&&N.setDashDisabled(!v.a("sceneDashEnable")),ak(v.a("sceneHighlightMode"))&&N.setHighlightMode(v.a("sceneHighlightMode")),Bk(v.a("sceneHighlightWidth"))&&N.setHighlightWidth(v.a("sceneHighlightWidth")),v.a("sceneHighlightColor")&&N.setHighlightColor(v.a("sceneHighlightColor")),v.a("sceneHighlightType")&&N.setHighlightType(v.a("sceneHighlightType")),v.a("sceneHighlightGlow")&&N.setHighlightGlow(v.a("sceneHighlightGlow")),v.a("sceneHighlightStrength")&&N.setHighlightStrength(v.a("sceneHighlightStrength")),Nj(v.a("sceneHeadlightEnable"))&&N.setHeadlightDisabled(!v.a("sceneHeadlightEnable")),Bk(v.a("sceneHeadlightRange"))&&N.setHeadlightRange(v.a("sceneHeadlightRange")),v.a("sceneHeadlightColor")&&N.setHeadlightColor(v.a("sceneHeadlightColor")),Bk(v.a("sceneHeadlightIntensity"))&&N.setHeadlightIntensity(v.a("sceneHeadlightIntensity")),Bk(v.a("sceneHeadlightAmbientIntensity"))&&N.setHeadlightAmbientIntensity(v.a("sceneHeadlightAmbientIntensity")),Bk(v.a("sceneHeadlightGroup"))&&N.setHeadlightGroup(v.a("sceneHeadlightGroup")),Nj(v.a("sceneFogEnable"))&&N.setFogDisabled(!v.a("sceneFogEnable")),v.a("sceneFogMode")&&N.setFogMode(v.a("sceneFogMode")),Bk(v.a("sceneFogDensity"))&&N.setFogDensity(v.a("sceneFogDensity")),v.a("sceneFogColor")&&N.setFogColor(v.a("sceneFogColor")),Bk(v.a("sceneFogNear"))&&N.setFogNear(v.a("sceneFogNear")),Bk(v.a("sceneFogFar"))&&N.setFogFar(v.a("sceneFogFar")),Nj(v.a("sceneBatchBrightnessDisabled"))&&N.setBatchBrightnessDisabled(v.a("sceneBatchBrightnessDisabled")),Nj(v.a("sceneBatchBlendDisabled"))&&N.setBatchBlendDisabled(v.a("sceneBatchBlendDisabled")),Nj(v.a("sceneBatchColorDisabled"))&&N.setBatchColorDisabled(v.a("sceneBatchColorDisabled")),v.a("sceneBatchInfoMap")&&N.setBatchInfoMap(v.a("sceneBatchInfoMap")),Bk(v.a("sceneMoveStep"))&&N.setMoveStep(v.a("sceneMoveStep")),Bk(v.a("sceneRotateStep"))&&N.setRotateStep(v.a("sceneRotateStep")),Nj(v.a("sceneSortable"))&&N.setSortable(v.a("sceneSortable")),kk(v.a("sceneSortFunc"))&&N.setSortFunc(v.a("sceneSortFunc"));
var E=v.a("sceneSkyboxType")||"sphere";if(E!=U){var F={},M=!1;if("sphere"===E){F.shape3d=E;var T=v.a("sceneSkyboxImage");T&&(F["shape3d.image"]=T,M=!0)}else F.shape3d=c,["front","back","left","right","top","bottom"].forEach(function(G){var Y=G+".image",d=G.charAt(0).toUpperCase()+G.slice(1),L=v.a("sceneSkybox"+d+"Image");L&&(F[Y]=L,M=!0)});if(M){var t=new Hh,i=v.a("sceneSkyboxDiameter");Bk(i)?t.s3(i,i,i):t.s3(20,20,20),F["body.color"]=v.a("sceneSkyboxBodyColor"),F.envmap=v.a("sceneSkyboxEnvmap"),F["envmap.probe"]=v.a("sceneSkyboxEnvmapProbe"),F.roughness=v.a("sceneSkyboxRoughness"),F["shape3d.light"]=F["all.light"]=v.a("sceneSkyboxLight"),F["light.mask"]=v.a("sceneSkyboxLightMask"),F["texture.wrap"]="clampToEdge",F["3d.clipbox.enabled"]=!1,t.s(F),["X","Y","Z"].forEach(function($){var K=v.a("sceneSkyboxRotation"+$);Bk(K)&&t["setRotation"+$](K)}),N.setSkybox(t)}}}},v.deserialize(m,n.rootParent,n)},R.isDebugTipShowing=function(){return!!this._debugDiv},R.showDebugTip=function(){var c=this,A=c._debugDiv;if(!A){A=c._debugDiv=X.createElement("div"),A.style.position="absolute",A.style.overflow="hidden",A.style.font=G.debugTipLabelFont,A.style.padding="6px",A.style.backgroundColor=G.debugTipBackground,A.style.color=G.debugTipLabelColor;var J=c.getView();c._79O?J.insertBefore(A,c._79O):J.appendChild(A);var h=function(){c.redraw();var Y=c._canvas,l="FPS: "+c._fpsInfo.fps+"<br/>"+"Datas: "+c.dm().getDatas().length+(Y?"<br/>Size: "+Y.width+" * "+Y.height:""),K=c.dm()._historyManager;K&&(l+="<br/>Undoes: "+K.getHistories().length+" index: "+K.getHistoryIndex());var S=c.getDebugTip();S&&(l+="<hr>"+S),A.innerHTML=l,c._isDebugging&&requestAnimationFrame(h)};requestAnimationFrame(h),c._isDebugging=!0}},R.hideDebugTip=function(){var o=this,M=o._debugDiv;M&&(delete o._debugDiv,o.getView().removeChild(M),o._isDebugging=!1)},R.updateDOMAppendMatrix=function(){var K=this.getView();K&&(K.updateAppendMatrix=!0)},R.countFrame=function(){if(this._isDebugging){var k=Date.now(),q=this._fpsInfo;k-q.time>1e3?(q.fps=Math.round(1e5*(q.frames+1)/(k-q.time))/100,q.time=k,q.frames=0):q.frames++}}},ms_icons:function(R){R.getRotation=function(a){return a==U?0:a},R._15O=function(){var C=this,s=C.s(Lc);if(s){var a=C,J=C.data||C._data,p=C._38o={icons:s,rects:{}};for(var g in s){var v=s[g],O=zi(v.shape3d,J,a);if(!(zi(v.visible,J,a)===!1||zi(v.for3d,J,a)&&!C.I3d||O&&!C.I3d)){var $=O?[O]:zi(v.names,J,a),z=$?$.length:0,M=zi(v.position,J,a)||3,q=zi(v.offsetX,J,a)||0,m=zi(v.offsetY,J,a)||0,i=zi(v.direction,J,a)||No,T=zi(v.gap,J,a),u=T!=U?T:1,Z=zi(v.rotation,J,a),F=zi(v.keepOrien,J,a),w=zi(v.rotationFixed,J,a)?Z:C.getRotation(Z,F,M),f=U,N=p.rects[g]=new Array(z);N.rotation=w;for(var Q=0;z>Q;Q++){var d,R,L,x,n=$[Q];if(O)L=0,x=0;else{var G=Kj(n);L=zi(v.width,J,a),x=zi(v.height,J,a),L==U&&(L=Zo(G,J)),x==U&&(x=Ge(G,J))}if(f?i===No?q+=L/2:i===rh?q-=L/2:i===hf?m-=x/2:m+=x/2:f={width:L,height:x},C.I3d){var W=-L/2,X=-x/2;R={width:L,height:x,mat:C._16O(zi(v.autorotate,J,a),M,f,zi(v.face,J,a)||Sl,zi(v.t3,J,a),zi(v.r3,J,a),zi(v.rotationMode,J,a),q,m),vs:new Ek([W,-X,0,W,-X-x,0,W+L,-X-x,0,W+L,-X,0])}}else d=C.getPosition(M,q,m,f,zi(v.positionFixed,J,a)),R={x:d.x-L/2,y:d.y-x/2,width:L,height:x},C._68o(R,w);N[Q]=R,i===No?q+=L/2+u:i===rh?q-=L/2+u:i===hf?m-=x/2+u:m+=x/2+u}}}}}}});var Uc={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},fq={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},bp={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Zg={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},yh={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},zd={"edge.type":1,"edge.group":1},pf={rotation:1,rotationX:1,rotationZ:1,rotation3d:1},Rh={rotation:1,position:1,width:1,height:1,anchor:1,scale:1,host:1},Kc={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Tm={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Ai={shape:1,thickness:1,position:1,anchor:1,scale:1},bk=function(A){if(!A)return U;if(hq(A)){var j=A._40I,$=A._41I;if(!j||!$)return U;var u=bk(j),K=bk($);return u===K?u:U}for(var i=A._parent;hq(i)&&!i.ISubGraph;)i=i._parent;return i?i.ISubGraph?i:bk(i):U},Ip=function(M,q,B,r){var t=q.getStyle(B)*r;t&&sr(M,t),t=q.getStyle(B+".left")*r,t&&(M.x-=t,M.width+=t),t=q.getStyle(B+".right")*r,t&&(M.width+=t),t=q.getStyle(B+".top")*r,t&&(M.y-=t,M.height+=t),t=q.getStyle(B+".bottom")*r,t&&(M.height+=t),M.width<0&&(M.width=-M.width,M.x-=M.width),M.height<0&&(M.height=-M.height,M.y-=M.height)},cn=function(O){for(var _,h=0,H=O.size();H>h;h++)if(_=O.getChildAt(h),Je(_)&&cn(_))return!0;return O.hasAgentEdges()},Xr=function(R){if(!R)return U;for(var j=R._parent;Di(j);){if(!Di(j._parent))return j.isExpanded()?R:j;j.isExpanded()||(R=j),j=j._parent}return R},uf=function(l,x){if(!l||!x)return U;var w,m,f,J=bk(l),E=bk(x);if(J!==E){for(;E&&J!==E;)E=bk(E);if(J===E)return l;w=new Vo,w.add(l,0);for(var a=l._parent;Je(a)&&!x.isDescendantOf(a);)w.add(a,0),a=a._parent;for(f=w.size(),m=0;f>m;m++){var q=w.get(m);if(Di(q)&&!q.isExpanded())return q;if(q.ISubGraph)return q}return l}return l},mp=function(J){if(J.isLooped())return J._source;var e=Xr(J._source),Y=Xr(J._target);return e===Y?J._source:uf(e,Y)},Wq=function(I){if(I.isLooped())return I._target;var d=Xr(I._source),T=Xr(I._target);return d===T?I._target:uf(T,d)},xe=function(d,Q,I){"target"!==I&&(I="source");var M="target"===I?Q.getTargetAgent():Q.getSourceAgent(),e="edge."+I+".";if(hq(M)){var c=d.getDataUI(M);c._79o();var w=Q.s(e+"index");if(w>=0){var h=Td(c);return h[Math.max(0,Math.min(w,h.length-1))]}var E=Q.s(e+"percent")||0;E=Math.max(0,Math.min(E,1));var N=Xf(c);return $g(N,100*E)}return Kd(d,M,Q.s(e+"position"),Q.s(e+"offset.x"),Q.s(e+"offset.y"),Q.s(e+"anchor.x"),Q.s(e+"anchor.y"))},Kd=function(k,P,m,S,J,z,W){if(!P)return U;var H,M=P.getRotation?P.getRotation():0;if(z!==c||W!==c){z=z===c?.5:z,W=W===c?.5:W;var G=P.getScale();if(M&&!tm(P,k)||G.x<0||G.y<0){var L=P.getPosition(),e=P.getWidth(),N=P.getHeight(),C=P.getAnchor(),w=new Fh(M,L.x,L.y,G.x,G.y);m=w.tf((z-C.x)*e,(W-C.y)*N)}else H=Zc(k,P),m={x:H.x+z*H.width,y:H.y+W*H.height}}else m=Ml(m,Zc(k,P));if(M){var r=b(M),V=_(M),g=S*r-J*V;J=S*V+J*r,S=g}return m.x+=S,m.y+=J,m},Rf=function(D,J){if(!D||!J)return U;var n,_,e,Y,i,w;if(D===J){if(Y=D.getLoopedEdges(),!Y)return U;Y=new Vo(Y)}else{if(i=D.getAgentEdges(),w=J.getAgentEdges(),!i||!w)return U;for(_=i.size(),n=0;_>n;n++)e=i.get(n),w.contains(e)&&(Y||(Y=new Vo),Y.add(e))}if(Y)for(n=0;n<Y.size();n++)e=Y.get(n),e.getStyle(Hk)===vn&&(e._22I(U),Y.removeAt(n),n--);return Y},Gm=function(e,K){var p=Rf(e,K);if(p&&!p.isEmpty()){if(1===p.size())return p.get(0)._22I(U),void 0;var F=new Vo,$=new Vo;p.each(function(m){var y=m.s("edge.group");F.contains(y)||F.add(y)}),F.sort(),F.each(function(i){$.add(new C.EdgeGroup(p.toList(function(t){return i===t.s("edge.group")}),$))}),$.each(function($){$.each(function(o){o._22I($)})})}},Mm=function(V,o,l){var D=V._canvas;V._zoom;var h=Ag(o,D),k=Ag(l,D);return{x:h.x-k.x,y:h.y-k.y}},hj=function(R,A){if(A){var N=A.rect,i=A.color,m=A.rotation,K=A.labelWidth,P=A.background,B=A.opacity,g=A.scale,x=g!=U&&1!==g;if(B!=U){var h=R.globalAlpha;R.globalAlpha*=B}if(m||x){R.save();var r=N.x+N.width/2,k=N.y+N.height/2;Xg(R,r,k),m&&tp(R,m),x&&R.scale(g,g),Xg(R,-r,-k)}if(P&&om(R,N.x,N.y,N.width,N.height,P),K){var d=N.width,p=R.createLinearGradient(N.x,N.y,N.x+d,N.y);p.addColorStop(0,i),p.addColorStop(.9,i),p.addColorStop(1,ji),i=p,N.width=K}Gr(R,A.ss,N,A.font,i,A.align),K&&(N.width=d),(m||x)&&R.restore(),B!=U&&(R.globalAlpha=h)}},gi=function(K,E){if(E){var g=E.rect,L=g.x,m=g.y,v=g.width,k=g.height,n=E.background,V=E.backgroundImage,a=E.borderWidth,b=E.borderColor,W=E.labelWidth,y=E.opacity,B=E.scale,Q=B!=U&&1!==B;if(y!=U){var F=K.globalAlpha;K.globalAlpha*=y}if(Q){K.save();var P=g.x+g.width/2,i=g.y+g.height/2;Xg(K,P,i),K.scale(B,B),Xg(K,-P,-i)}if(E.expanded){var q=x(8,v/4),$=m+k-8;if(K.fillStyle=n,K.beginPath(),K.moveTo(L,m),K.lineTo(L,$),K.lineTo(L+v/2,$),K.lineTo(L+v/2,m+k),K.lineTo(L+v/2+q,$),K.lineTo(L+v,$),K.lineTo(L+v,m),K.closePath(),K.fill(),a&&(K.lineWidth=a,K.lineJoin="round",K.lineCap="round",b?(K.strokeStyle=b,K.stroke()):(K.strokeStyle=Yd(n),K.beginPath(),K.moveTo(L+v,m),K.lineTo(L+v,$),K.lineTo(L+v/2+q,$),K.lineTo(L+v/2,m+k),K.stroke(),K.strokeStyle=Yf(n),K.beginPath(),K.moveTo(L+v,m),K.lineTo(L,m),K.lineTo(L,$),K.lineTo(L+v/2,$),K.lineTo(L+v/2,m+k),K.stroke())),V)bl(K,Kj(V),gf,g.x,g.y,g.width,g.height-8,E.data,E.view);else{if(g.height-=8,n=E.color,W){var A=v,o=K.createLinearGradient(L,m,L+A,m);o.addColorStop(0,n),o.addColorStop(.9,n),o.addColorStop(1,ji),n=o,g.width=W}Gr(K,E.ss,g,E.font,n,E.align),W&&(g.width=A),g.height+=8}}else if(E.icon)kc(K,Kj(E.icon),L,m,v,k,E.data,E.view);else{var s=v/2;a&&(K.lineWidth=a,K.lineJoin="round",K.lineCap="round",K.strokeStyle=b?b:Yd(n),K.beginPath(),K.arc(L+s,m+s,s,Cg,1.6*S,!0),K.moveTo(L+s,m+k),K.lineTo(L+v-s/5,m+s),K.stroke(),K.strokeStyle=b?b:Yf(n),K.beginPath(),K.arc(L+s,m+s,s,1.6*S,Cg,!0),K.moveTo(L+s,m+k),K.lineTo(L+s/5,m+s),K.stroke()),K.fillStyle=n,K.beginPath(),K.arc(L+s,m+s,s,0,t,!0),K.moveTo(L+s,m+k),K.lineTo(L+v-s/5,m+s),K.lineTo(L+s/5,m+s),K.closePath(),K.fill(),K.fillStyle=E.color,K.beginPath(),K.arc(L+s,m+s,s/3,0,t,!0),K.fill()}Q&&K.restore(),y!=U&&(K.globalAlpha=F)}},xb=function(N,t){return t>2*N?N:t/2},Rm=function(T,x,E,C){if(!T||!x)return 0;var J=dj(x.y-T.y,x.x-T.x);return E||(J=x.x<T.x?J+S:J),J+C},Fo=function($,r,e,R,t,U,M){M&&($.x>r.x||$.x===r.x&&$.y>r.y)&&(e=Wg[e],t=-t);var i=Ml(e,{x:0,y:0,width:Sn($,r),height:0},U);return i.x+=R,i.y+=t,i=new Fh(dj(r.y-$.y,r.x-$.x)).tf(i),i.x+=$.x,i.y+=$.y,i},ch=function(K,$,c,A,t){if(K._19Q=!0,!c.getEdgeGroup())return A?c.s("edge.gap"):0;if(hq(c.getSourceAgent())||hq(c.getTargetAgent()))return 0;var i,N=0,b=0,Z=0;if(c.getEdgeGroup().getSiblings().each(function(L){L.each(function(k){if($.isVisible(k)&&k.s(Hk)==t){var e=k.s("edge.gap");i?(b+=Z/2+e/2,Z=e):(i=k,Z=e),k===c&&(N=b)}})}),A)return b-N+Z;var G=N-b/2;return i&&c._40I!==i._40I&&(K._19Q=!1),G},io=function(a){var Y=a._getValidSelection();if(1===Y.length){var R=Y[0],q=R instanceof C.Edge;if(R instanceof C.Shape||q){if(q){var V=R.s("edge.type");if(V&&"points"!==V)return}var J=a.gv;if((!J.isPointEditable||J.isPointEditable(R))&&J.isEditable(R))return R}}},Df=function(){var H=function(N){var D=[];return N.forEach(function(M){D.push({x:M.x,y:M.y}),D.push({x:M.x+M.width,y:M.y+M.height}),D.push({x:M.x+M.width,y:M.y}),D.push({x:M.x,y:M.y+M.height})}),D};return function(K,f,B){if("oval"===K){var R=0,r=B.height/B.width,p=r*r,O=B.x+B.width/2,Z=B.y+B.height/2,v=H(f);v.forEach(function(x){var i=x.x-O,z=x.y-Z,C=i*i+z*z/p;C>R&&(R=C)}),R=j(R);var L=r*R;return{x:O-R,y:Z-L,width:2*R,height:2*L}}if("circle"===K){var b=0,O=B.x+B.width/2,Z=B.y+B.height/2,v=H(f);return v.forEach(function(h){var P=h.x-O,S=h.y-Z,d=P*P+S*S;d>b&&(b=d)}),b=j(b),{x:O-b,y:Z-b,width:2*b,height:2*b}}return"roundRect"===K?(sr(B,x(B.width,B.height)/16),B):B}}(),Ui=C.graph={},_n=function(i,u,P){Bb(s+".graph."+i,u,P)};C.layout={};var ob={},yo=function(k,y,b,f,S,x,q,L){var p=q._zoom;if(p!==q._cacheZoom&&(q._cacheZoom=p,q._cacheImage={}),p*=vm,f=Math.ceil(f),S=Math.ceil(S),f*p>2048||S*p>2048)return y;var X=[y.uuid,f,S,b].join("_");if(y.cacheRule){var h;h=kk(y.cacheRule)?y.cacheRule(x,q):zi(y.cacheRule,x,q),X+="_"+h}var $,Z=1;S>=f&&Z>f*p?($=S/f,f=Z/p,S=f*$):f>=S&&Z>S*p&&($=f/S,S=Z/p,f=S*$),f=Math.ceil(f),S=Math.ceil(S);var l=q._cacheImage[X];if(!l){if(ps(),l=C.Default.toCanvas(y,f,S,b,x,q,L,p),!fp())return y;q._cacheImage[X]=l}return l};hn(G,{setImageCacheRule:function(E,H){var i;H||"object"!=typeof E?(i={},i[E]=H):i=E;for(var Q in i){var J=i[Q];ak(Q)?(Bb=Kj(Q),Bb?Bb.cacheRule=J:ob[Q]=J):Q.cacheRule=J}}});var lm={comps:[{type:gs,points:[85,50,70,115,100,71,86,107,88,49,47,119,109,100,97,82,112,53,53,50,100,50,48,76,114,114,103,105,113,65,43,74,76,71,110,98,103,53,104,48,51,118,89,61],borderWidth:1,borderColor:U}]};if(lm[Vr]=lm[Jb]=160,i.Image){var yb=new i.Image;yb.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",or("default_blank",yb)}or("node_image",pr(30,30,[{type:co,rect:[4,5,22,16],gradient:nd,gradientColor:Nh,background:Xp},{type:co,rect:[2,3,26,20],borderWidth:1,borderColor:Xp},{type:co,rect:[11,23,8,4],background:Xp},{type:co,rect:[6,27,18,2],background:Xp}])),or("node_icon",pr(16,16,[{type:co,rect:[2,2,12,10],gradient:nd,gradientColor:Nh,background:Xp},{type:Uq,rect:[2,2,12,10],width:1,color:Xp},{type:co,rect:[6,12,4,2],background:Xp},{type:co,rect:[4,14,8,1],background:Xp}])),or("block_icon",pr(16,16,[{type:Uq,rect:[1,1,14,14],width:1,color:Xp}])),or("group_image",pr(66,39,[{type:co,rect:[44.3,18,18.1,12.8],gradient:nd,gradientColor:Nh,background:Xp},{type:co,rect:[3.3,17.8,18.1,12.8],gradient:nd,gradientColor:Nh,background:Xp},{type:co,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Xp,gradient:nd,gradientColor:Nh,background:Xp},{type:co,rect:[26.2,29.4,12.8,4.2],background:Xp},{type:co,rect:[21.3,33.5,22.5,2.3],background:Xp},{type:co,rect:[5.3,32.7,14.1,2.1],background:Xp},{type:co,rect:[9,30.4,6.7,2.4],background:Xp},{type:co,rect:[50,30.7,6.7,2.4],background:Xp},{type:co,rect:[46.3,33,14.1,2.1],background:Xp}])),or("group_icon",pr(16,16,[{type:co,rect:[4,12,4,2],background:Xp},{type:co,rect:[2,13,8,1],background:Xp},{type:co,rect:[12,12,2,1],background:Xp},{type:co,rect:[11,13,4,1],background:Xp},{type:co,rect:[10,7,6,5],gradient:nd,gradientColor:Nh,background:Xp},{type:co,rect:[1,2,10,10],gradient:nd,gradientColor:Nh,background:Xp},{type:Uq,rect:[1,2,10,10],width:1,color:Xp}])),or("refGraph_icon",pr(16,16,[{type:"shape",borderWidth:1,borderColor:Xp,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Xp,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),or("edge_icon",pr(16,16,[{type:co,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:nd,gradientColor:Nh,background:Xp},{type:co,rect:[10.8,1,4,4],background:Xp},{type:co,rect:[1,11,4,4],background:Xp}])),or("subGraph_image",pr(72,45,[{type:gs,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:nd,gradientColor:Nh,background:Xp},{type:co,rect:[29.6,30.7,3.6,1.8],background:Xp},{type:co,rect:[28.4,32.3,6,1.2],background:Xp},{type:co,rect:[37.3,32,10.8,1.8],background:Xp},{type:co,rect:[39.1,29.9,7.2,2.3],background:Xp},{type:co,rect:[26.6,23.7,9.6,7.2],gradient:nd,gradientColor:Nh,background:Xp},{type:co,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Xp,gradient:nd,gradientColor:Nh,background:Xp}])),or("subGraph_icon",pr(17,17,[{type:gs,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:nd,gradientColor:Nh,background:Xp}])),or("shape_icon",pr(16,16,[{type:gs,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Xp}])),or("polyline_icon",pr(16,16,[{type:gs,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Xp},kf(7.5,.4),kf(7.5,6.3),kf(13.6,6.3),kf(13.6,14),kf(.7,13.9),kf(.7,.3)])),or("grid_icon",pr(16,16,[{type:co,rect:[1,1,4,4],background:Xp,gradient:nd,gradientColor:Nh},{type:co,rect:[6,1,4,4],background:Xp,gradient:nd,gradientColor:Nh},{type:co,rect:[11,1,4,4],background:Xp,gradient:nd,gradientColor:Nh},{type:co,rect:[11,6,4,4],background:Xp,gradient:nd,gradientColor:Nh},{type:co,rect:[6,6,4,4],background:Xp,gradient:nd,gradientColor:Nh},{type:co,rect:[1,6,4,4],background:Xp,gradient:nd,gradientColor:Nh},{type:co,rect:[11,11,4,4],background:Xp,gradient:nd,gradientColor:Nh},{type:co,rect:[6,11,4,4],background:Xp,gradient:nd,gradientColor:Nh},{type:co,rect:[1,11,4,4],background:Xp,gradient:nd,gradientColor:Nh}])),or("light_icon",pr(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Xp},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Xp,gradient:nd,gradientColor:Nh,background:{func:function(e){var l=e?e.s(Bf):U;return zo(l)?"rgb("+Ob(255*l[0])+","+Ob(255*l[1])+","+Ob(255*l[2])+")":l||Xp}}}])),or("text_icon",pr(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Xp}])),or("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),or("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),or("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),or("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var zk=function(B,a,j,R,n,o){var X,A,V,I,y,F,L,D,h,x,Z,_=[];if(Math.abs(R)>2*Math.PI&&(R=2*Math.PI),y=Math.ceil(Math.abs(R)/(Math.PI/4)),X=R/y,A=-X,V=-j,y>0){F=B+Math.cos(j)*n,L=a+Math.sin(-j)*o,_.push({x:F,y:L});for(var Q=0;y>Q;Q++)V+=A,I=V-A/2,D=B+Math.cos(V)*n,h=a+Math.sin(V)*o,x=B+Math.cos(I)*(n/Math.cos(A/2)),Z=a+Math.sin(I)*(o/Math.cos(A/2)),_.push({x:x,y:Z}),_.push({x:D,y:h})}return _},xs=function(t){if(t){var Z=t._data;if(Z instanceof C.Shape)return{points:Z.getPoints(),segments:Z.getSegments()};var M;if(Z instanceof C.Edge&&(M=t._78o)){var r,w,v=M.type,l=M.points,K=M.segments,c=M.edgeTypeInfo;if(!v||l){var S=M.sourcePoint,p=S.x,I=S.y,Q=M.targetPoint,n=Q.x,j=Q.y;if(v)K?(r=new Vo({x:p,y:I}),r.addAll(l),r.add({x:n,y:j}),w=new Vo(K._as)):(r=new Vo({x:p,y:I}),l.each(function(e){r.add(e)}),r.add({x:n,y:j}));else if(M.looped){r=new Vo(zk(p,I,0,2*Math.PI,M.radius,M.radius)),w=new Vo([1]);for(var d=0;d<(r.size()-1)/2;d++)w.add(3)}else r=new Vo,M.center?(r.add({x:M.c1.x,y:M.c1.y}),r.add({x:p,y:I}),r.add({x:n,y:j}),r.add({x:M.c2.x,y:M.c2.y})):(r.add({x:p,y:I}),r.add({x:n,y:j}))}else c&&(r=new Vo(c.points._as),c.segments&&(w=new Vo(c.segments._as)));return{points:r,segments:w}}}},Xf=function(D,$,h){if(null==$){var w=xs(D);if(!w)return;$=w.points,h=w.segments}if($){if(Array.isArray($)&&($=new Vo($)),"number"==typeof $.get(0)){for(var m=new C.List,U=0;U<$.size();U+=2)m.add({x:$.get(U),y:$.get(U+1)});$=m}if(!h){h=[1];for(var p=$.length-1;p>0;p--)h.push(2)}Array.isArray(h)&&(h=new Vo(h));for(var X=Yp($._as,h._as,50),y=X.length,d=[],U=0;y>U;U++){var Y=X[U];Y.length>1&&d.push(Y)}return d}},mr=function(b){for(var s=0,p=b.length-1,Q=0;p>Q;Q++){var B=b[Q],R=b[Q+1],w=R.x-B.x,V=R.y-B.y;s+=Math.sqrt(w*w+V*V)}return s},Vj=function(k,U){for(var F=0,s=U.length,h=0;s>h;h++){var t=U[h];if(F+=t,F>k)return h}return Math.min(h,s-1)},Oh=function(R,l){for(var B=0,k=0,V=0,j=R.length-1,v=0;j>v;v++){var p=R[v],i=R[v+1],N=i.x-p.x,b=i.y-p.y;if(V=Math.sqrt(N*N+b*b),B+=V,B>l){B-=V,k=v;break}}var A=R[k],L=R[k+1],T=Math.atan2(L.y-A.y,L.x-A.x),H=l-B,b=Math.sin(T)*H,N=Math.cos(T)*H;return{x:A.x+N,y:A.y+b}},$g=function(O,R){if(O){var Z;if(0===R)Z=O[0][0];else if(100===R)O=O[O.length-1],Z=O[O.length-1];else{for(var I=0,A=[],p=O.length,z=0;p>z;z++){var a=O[z],G=mr(a);I+=G,A.push(G)}for(var f=I*R/100,M=Vj(f,A),$=0,n=0;M>n;n++)$+=A[n];f-=$,Z=Oh(O[M],f)}return Z}},Td=function(q){var I,e,c,E,i=xs(q),v=[],A=i.points,C=i.segments,N=-1;for(e=0,c=C?C.length:A.length;c>e;e++){if(I=C?C.get(e):1,3===I)E=2;else if(4===I)E=3;else{if(5===I)continue;E=1}N+=E,v.push(A.get(N))}return v},hi=function(l,t,h,i){function U(J){if(J>=0&&1>=J){W=t(J);var u=(l.x-W.x)*(l.x-W.x)+(l.y-W.y)*(l.y-W.y);return g>u?(g=u,x=J,!0):!1}}h=h||100,i=i||1e-5;for(var g=1/0,x=0,W=new jm,B=0;h>B;++B)U(B/h);for(var r=1/(2*h);r>i;)U(x-r)||U(x+r)||(r/=2);return x};hn(G,{_edgeProtectMethod:{getStraightLinePoints:Xf,calculateLineLength:mr,calcSegmentIndexByDistance:Vj,calculatePointAlongLine:Oh,getPercentPosition:$g,getRealPointsFromDataUI:Td}});var lg=function(e,M){for(var y=e.vertices,n=0;n<y.length;n++){var g=y[n],p=g.y;g.y=g.z,g.z=-p,M&&(g.y+=M)}},kd=function(L){for(var A,w,q,n,i,B,k=[],H=[],e=[],V=L.faces,o=0,T=0,j=0,m=V.length;m>o;o++,T+=6,j+=9){var b=V[o];1===b.i?(A||(A=[],w=[],q=[]),_h(b,o,T,j,L,A,q,w)):2===b.i?(n||(n=[],i=[],B=[]),_h(b,o,T,j,L,n,B,i)):_h(b,o,T,j,L,k,e,H)}return{vs:k,uv:H,ns:e,top_vs:A,top_uv:w,top_ns:q,bottom_vs:n,bottom_uv:i,bottom_ns:B}},_h=function(p,M,P,f,u,Y,r,C){var I=u.vertices,q=u.faceVertexUvs,z=I[p.a],L=I[p.b],w=I[p.c];Y.push(z.x,z.y,z.z,L.x,L.y,L.z,w.x,w.y,w.z);var Z,l,b,A=p.vertexNormals;3===A.length?(Z=A[0],l=A[1],b=A[2]):Z=l=b=p.normal,r.push(Z.x,Z.y,Z.z,l.x,l.y,l.z,b.x,b.y,b.z);var J=q[0][M][0],E=q[0][M][1],B=q[0][M][2];C.push(J.x,J.y,E.x,E.y,B.x,B.y)},ek=function(){function b(L,o){return L.dot(o)>0}function S(P,K,e,U,l,q,g){for(var a,k,N=[K,e,U],t=[l,q,g],R=[],F=N.length,j=!0;F--&&j;){for(var i=N[F],n=t.length,v=!1;n--;)if(i.equals(t[n])){t.splice(n,1),R.push(i),v=!0;break}if(!v){if(a){j=!1;break}a=i}}return j&&2===R.length&&(k=t[0],h.subVectors(a,R[0]),V.subVectors(k,R[0]),r.subVectors(a,R[1]),h.x*r.y*V.z+r.x*V.y*h.z+V.x*h.y*r.z-V.x*r.y*h.z-V.y*r.z*h.x-V.z*r.x*h.y<1e-6&&(M.subVectors(k,R[1]),T.subVectors(R[1],R[0]),b(T,h)&&b(T,V)&&(T.negate(),b(T,r)&&b(T,M))))?(P.push(R[1].x,R[1].y,R[1].z),P.push(a.x,a.y,a.z),P.push(a.x,a.y,a.z),P.push(R[0].x,R[0].y,R[0].z),P.push(R[0].x,R[0].y,R[0].z),P.push(k.x,k.y,k.z),P.push(k.x,k.y,k.z),P.push(R[1].x,R[1].y,R[1].z),2):(P.push(K.x,K.y,K.z),P.push(e.x,e.y,e.z),P.push(e.x,e.y,e.z),P.push(U.x,U.y,U.z),P.push(U.x,U.y,U.z),P.push(K.x,K.y,K.z),1)}function l(){this._vertexMap={},this._lineMap={},this._lineList=[]}function O(C,M,w,V,z,A,Z){var X=[w,z];C[0]===V&&X.reverse();var B=[X[0]._key,X[1]._key].join("|"),S=C._triangles[B];S||(C._triangles[B]=S={});var p=[A._key,Z._key].join("|");S[p]||(S[p]=[A,Z])}function u(t,_,Y){var e=t._planes[Y._key];if(!e)for(var R in t._planes){var n=t._planes[R];if(n._normal.angleTo(Y)<.001){e=n;break}}return e?(e._vertices.indexOf(_)<0&&e._vertices.push(_),void 0):(t._planes[Y._key]={_normal:Y,_vertices:[_]},void 0)}function X(z,D){return 0===D?"0|0|0":1/0===Math.abs(D)?[z.x,z.y,z.z].join("|"):[Math.round(j.angleTo(z)*D),Math.round(B.angleTo(z)*D),Math.round(d.angleTo(z)*D)].join("|")}function K(z,X){var Y=z._ctlineModel;if(Y||(z._ctlineModel=Y=[]),Y[0])return Y[0];var k;k=zo(z)?z:[z];var D,I,V,t,q,N,y,v,c,w,K,s,O,m,f,E,_,L,r,b=["","top_","bottom_"];Y=[];var R=[];for(Lm(k,X,R),D=0,I=R.length;I>D;D++)if(w=R[D])for(Tl(w),V=0,t=b.length;t>V;V++)if(c=w[b[V]+"lvs"])for(_=Y.length,L=c.length,Y.length=_+L,r=0;L>r;++r,++_)Y[_]=c[r];else if(y=w[b[V]+"vs"]){v=w[b[V]+"is"],N=v?v.length:y.length/3;for(var q=0;N-1>q;)v?(K=v[q],s=v[q+1],O=v[q+2],m=v[q+3],f=v[q+4],E=v[q+5]):(K=q,s=q+1,O=q+2,m=q+3,f=q+4,E=q+5),H.fromArray(y,3*K),U.fromArray(y,3*s),W.fromArray(y,3*O),A.fromArray(y,3*m),o.fromArray(y,3*f),p.fromArray(y,3*E),q+=3*S(Y,H,U,W,A,o,p);N>q&&(v?(K=v[q],s=v[q+1],O=v[q+2]):(K=q,s=q+1,O=q+2),H.fromArray(y,3*K),U.fromArray(y,3*s),W.fromArray(y,3*O),Y.push(H.x,H.y,H.z),Y.push(U.x,U.y,U.z),Y.push(U.x,U.y,U.z),Y.push(W.x,W.y,W.z),Y.push(W.x,W.y,W.z),Y.push(H.x,H.y,H.z))}return z._ctlineModel[0]=Y,Y}function x(j,z,G){var H=j._ctlineModel;H||(j._ctlineModel=H=[]);var o=H[1];if(o&&o.epsilon===G)return o;o=[],o.epsilon=G;var y;y=zo(j)?j:[j];var w,f,m,E,N,e,$,p,g,P,S,W,L=["","top_","bottom_"],F=new l,D=[];for(Lm(y,z,D),w=0,f=D.length;f>w;w++)if(g=D[w])for(Tl(g),m=0,E=L.length;E>m;m++)if($=g[L[m]+"vs"]){p=g[L[m]+"is"],e=p?p.length:$.length/3;for(var N=0,N=0;e>N;N+=3)p?(P=p[N],S=p[N+1],W=p[N+2]):(P=N,S=N+1,W=N+2),F._addTriangle($,c,P,S,W,G)}return F._toLineVS(o),j._ctlineModel[1]=o,o}function Y(Q,G,$){var n=Q._ctlineModel;n||(Q._ctlineModel=n=[]);var V=n[2];if(V&&V.epsilon===$)return V;V=[],V.epsilon=$;var H;H=zo(Q)?Q:[Q];var I,t,Z,J,k,p,d,F,C,b,s,R,A,N=["","top_","bottom_"],U=new l,L=[];for(Lm(H,G,L),I=0,t=L.length;t>I;I++)if(b=L[I])for(Tl(b),Z=0,J=N.length;J>Z;Z++)if(d=b[N[Z]+"vs"]){F=b[N[Z]+"is"],C=b[N[Z]+"ns"],p=F?F.length:d.length/3;for(var k=0,k=0;p>k;k+=3)F?(s=F[k],R=F[k+1],A=F[k+2]):(s=k,R=k+1,A=k+2),U._addTriangle(d,C,s,R,A,$)}return U._toLineVS(V),Q._ctlineModel[2]=V,V}var H=new Cc,U=new Cc,W=new Cc,A=new Cc,o=new Cc,p=new Cc,h=new Cc,r=new Cc,V=new Cc,M=new Cc,T=new Cc,y=new Cc;l.prototype._findVertex=function(I,Y){y.fromArray(I,3*Y);var g=[y.x,y.y,y.z].join(","),C=this._vertexMap[g];if(!C){var G=y.clone();G._key=g,this._vertexMap[g]=C=G}return C},l.prototype._findLine=function(I,$){var s=[I,$];I._key>$._key&&s.reverse(),s._key=[s[0]._key,s[1]._key].join("|");var D=this._lineMap[s._key];return D||(this._lineMap[s._key]=D=s,s._triangles={},s._planes={},this._lineList.push(s)),D};var j=new Cc(1,0,0),B=new Cc(0,1,0),d=new Cc(0,0,1),G=new Cc,i=new Cc;return l.prototype._addTriangle=function(h,N,F,H,Y,I){var g,f,c,a=this._findVertex(h,F),x=this._findVertex(h,H),P=this._findVertex(h,Y),o=this._findLine(a,x),j=this._findLine(x,P),q=this._findLine(P,a);N?(g=(new Cc).fromArray(N,3*F),g._key=X(g,I),f=(new Cc).fromArray(N,3*H),f._key=X(f,I),c=(new Cc).fromArray(N,3*Y),c._key=X(c,I),O(o,a,g,x,f,P,c),O(j,x,f,P,c,a,g),O(q,P,c,a,g,x,f)):(i.subVectors(P,x),G.subVectors(x,a),g=(new Cc).crossVectors(G,i),g._key=X(g,I),u(o,P,g),u(j,a,g),u(q,x,g))},l.prototype._toLineVS=function(U){for(var E=this._lineList,H=0,o=E.length;o>H;++H){var e=E[H],P=!1;for(var N in e._triangles)if(1==g.keys(e._triangles[N]).length){U.push(e[0].x,e[0].y,e[0].z,e[1].x,e[1].y,e[1].z),P=!0;break}if(!P)for(var h in e._planes)if(1==e._planes[h]._vertices.length){U.push(e[0].x,e[0].y,e[0].z,e[1].x,e[1].y,e[1].z),P=!0;break}}},[K,x,Y]}(),mn=function(Q,I){var f=Q._lineModel;if(f)return f;var E;E=zo(Q)?Q:[Q];var Y,P,F,L,S,k,v,$,e,o,a,D,O=["","top_","bottom_"];f=[];var A=[];for(Lm(Q,I,A),Y=0,P=A.length;P>Y;Y++)if(e=A[Y])for(F=0,L=O.length;L>F;F++)if(v=e[O[F]+"vs"]){$=e[O[F]+"is"],k=$?$.length:v.length/3;for(var S=0;k>S;S+=3)$?(o=$[S],a=$[S+1],D=$[S+2]):(o=S,a=S+1,D=S+2),o*=3,a*=3,D*=3,f.push(v[o],v[o+1],v[o+2],v[a],v[a+1],v[a+2],v[a],v[a+1],v[a+2],v[D],v[D+1],v[D+2],v[D],v[D+1],v[D+2],v[o],v[o+1],v[o+2])}return Q._lineModel=f,f},Tc=function(j,k,V,M,F,p,_,t,a,g){V==U&&(V=!0),M==U&&(M=!0),_==U&&(_=1),t==U&&(t=0);var b=new $l;Xk(b,j,k,a),b=b.toShapes();var T=c;return g&&(g.length?T={minX:g[0],minY:g[1],maxX:g[2],maxY:g[3]}:(T={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},b.forEach(function(F){var E=F.getBoundingBox();T.minX=x(E.minX,T.minX),T.minY=x(E.minY,T.minY),T.maxX=B(E.maxX,T.maxX),T.maxY=B(E.maxY,T.maxY)}))),kd(new dd(b,{top:V,bottom:M,curveSegments:F,amount:_,repeatUVLength:p,boundingBox:T},-_/2+t))},gl=function(R,J){this.repeatUVLength=R,this._bb=J};gl.prototype={generateTopUV:function(N,r,W,w,P,o,g){var L,y,i,t,m=N.vertices,I=m[w].x,n=m[w].y,l=m[P].x,z=m[P].y,s=m[o].x,T=m[o].y,q=this.repeatUVLength;if(q)L=0,y=0,i=q,t=q;else{this._bb||(this._bb=r.getBoundingBox());var U=this._bb;L=U.minX,y=U.minY,i=U.maxX-L,t=U.maxY-y}return g?[new tk((I-L)/i,(n-y)/t),new tk((l-L)/i,(z-y)/t),new tk((s-L)/i,(T-y)/t)]:[new tk((I-L)/i,1-(n-y)/t),new tk((l-L)/i,1-(z-y)/t),new tk((s-L)/i,1-(T-y)/t)]},generateBottomUV:function(M,f,m,g,T,O){return this.generateTopUV(M,f,m,g,T,O,!0)},generateSideWallUV:function(K,r,S,D,U,B,q,t,J,V,G,d){if(!this._cl){for(var y,T,H=[],s=0,_=S.length,u=0;_>u;u++){y=S[u],T=S[(u+1)%_];var n=y.x-T.x,v=y.y-T.y,m=j(n*n+v*v);H.push(s),s+=m}for(var u=0;_>u;u++)H[u]/=s;this._cl=H}var H=this._cl,h=1-J/V,g=1-(J+1)/V,p=H[G],$=H[d];return $>p&&(p+=1),[new tk(p,h),new tk($,h),new tk($,g),new tk(p,g)]}};var Sf=function(L,k,x,B,O,l){this.a=L,this.b=k,this.c=x,this.i=l,this.normal=B instanceof bn?B:new bn,this.vertexNormals=B instanceof Array?B:[]};Sf.prototype={constructor:Sf};var jj=[-8,14,-4,15,0,6,3,6,-1],Ij=function(){if(Ij[wi]!=U)return Ij[wi];for(var I=Fk[wi],N=jj,C=Cb.prototype.getClassName(),e='"',x=0,S="",L=!1,l=+new(i[C.substr(3,3)+Sm[x]]),M=x;M<N.length;M++){var X=N.length-M;S+=M%2===x?N[M]+X+"":N[M]-X+""}for(var M=x;4>M;M++)S+=x;if(S=S*S.length/S.length,l>S){if(I&&I[x]&&I[4/co.length]){for(var R,T,K,P,m,n,Z,F,H=I[0],r=I[1],Q="",O=0,M=0;M<r.length;M++)r[M]===e?F?(F=!1,0!==O%2&&(R==U?R=Q:T==U?T=Q:K==U?K=Q:P==U?P=Q:m==U?m=Q:n==U?n=Q:Z==U&&(Z=Q)),O++,Q=""):F=!0:F&&(Q+=r[M]);for(var W,z,f,b="",_=0,M=0;M<H.length;M++)H[M]===e?W?(W=!1,0!==_%2&&(z==U?z=b:f==U&&(f=b)),_++,b=""):W=!0:W&&(b+=H[M]);var G=R+T+K+P+m+n,B=!n||n===bq;if(!B&&n)for(var w,M=0,g=n.length;g>M;M++)n[M]===Nl[4]?w===bq?B=Bj:w[0]===oq[7]&&bq&&bq.indexOf(w.substr(1))>=0?B=ro:w=U:(w==U?w=n[M]:w+=n[M],M===g-1&&(w===bq?B=Bj:w[0]===oq[7]&&bq&&bq.indexOf(w.substr(1))>=0&&(B=ro)));(L=Mp(G,Z)&&Mp(z,f)&&z===R&&B&&(!m||m>l))&&K.indexOf(Ff[0])>=0&&(Ij[Ff[0]]=1),L&&K.indexOf(1)>=0&&(Ij[1]=1),L&&K.indexOf(3)>=0&&(Ij[2]=1),L&&K.indexOf(4)>=0&&(Ij[3]=1),L&&K.indexOf(7)>=0&&(Ij[4]=1)}}else L=!0,Ij[Ff[0]]=Ij[1]=Ij[2]=Ij[3]=Ij[4]=1;return Ij[wi]=L,L},jn=function(){},Wl=jn.prototype;Wl.getPointAt=function(P){var U=this.getUtoTmapping(P);return this.getPoint(U)},Wl.getPoints=function(t){t||(t=5);var Y,U=[];for(Y=0;t>=Y;Y++)U.push(this.getPoint(Y/t));return U},Wl.getSpacedPoints=function(d){d||(d=5);var I,n=[];for(I=0;d>=I;I++)n.push(this.getPointAt(I/d));return n},Wl.getLength=function(){var h=this.getLengths();return h[h.length-1]},Wl.getLengths=function(G){if(G||(G=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==G+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var v,$,V=[],Y=this.getPoint(0),g=0;for(V.push(0),$=1;G>=$;$++)v=this.getPoint($/G),g+=v.distanceTo(Y),V.push(g),Y=v;return this.cacheArcLengths=V,V},Wl.getUtoTmapping=function(O,x){var s,D=this.getLengths(),R=0,V=D.length;s=x?x:O*D[V-1];for(var z,t=0,E=V-1;E>=t;)if(R=A(t+(E-t)/2),z=D[R]-s,0>z)t=R+1;else{if(!(z>0)){E=R;break}E=R-1}if(R=E,D[R]==s){var F=R/(V-1);return F}var Q=D[R],B=D[R+1],J=B-Q,l=(s-Q)/J,F=(R+l)/(V-1);return F},Wl.getTangent=function(X){var z=1e-4,g=X-z,H=X+z;0>g&&(g=0),H>1&&(H=1);var t=this.getPoint(g),p=this.getPoint(H),W=p.clone().sub(t);return W.normalize()},Wl.getTangentAt=function(O){var w=this.getUtoTmapping(O);return this.getTangent(w)},jn.create=function(s,c){return s.prototype=di(jn.prototype),s.prototype.getPoint=c,s};var yi=function(){this.curves=[],this.autoClose=!1},xr=yi.prototype=di(Wl);
xr.add=function(a){this.curves.push(a)},xr.closePath=function(){var H=this.curves[0].getPoint(0),C=this.curves[this.curves.length-1].getPoint(1);H.equals(C)||this.curves.push(new Qk(C,H))},xr.getPoint=function(p){for(var S,A,V=p*this.getLength(),T=this.getCurveLengths(),d=0;d<T.length;){if(T[d]>=V){S=T[d]-V,A=this.curves[d];var g=1-S/A.getLength();return A.getPointAt(g)}d++}return null},xr.getLength=function(){var s=this.getCurveLengths();return s[s.length-1]},xr.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var y,_=[],p=0,Z=this.curves.length;for(y=0;Z>y;y++)p+=this.curves[y].getLength(),_.push(p);return this.cacheLengths=_,_},xr.getTransformedPoints=function(x){return this.getPoints(x)},xr.getBoundingBox=function(){var M,G,h,C,V,n,O=this.getPoints();M=G=Number.NEGATIVE_INFINITY,C=V=Number.POSITIVE_INFINITY;var U,f,F,t,w=O[0]instanceof bn;for(t=w?new bn:new tk,f=0,F=O.length;F>f;f++)U=O[f],U.x>M&&(M=U.x),U.x<C&&(C=U.x),U.y>G&&(G=U.y),U.y<V&&(V=U.y),w&&(U.z>h&&(h=U.z),U.z<n&&(n=U.z)),t.add(U);var i={minX:C,minY:V,maxX:M,maxY:G};return w&&(i.maxZ=h,i.minZ=n),i};var yq=function(j){yi.call(this),this.actions=[],j&&this.fromPoints(j)},un=yq.prototype=di(yi.prototype),Zi="moveTo",Ig="lineTo",im="quadraticCurveTo",Ah="bezierCurveTo",er="arc",eh="ellipse";un.fromPoints=function(f){this.moveTo(f[0].x,f[0].y);for(var F=1,r=f.length;r>F;F++)this.lineTo(f[F].x,f[F].y)},un.moveTo=function(){var f=Array.prototype.slice.call(arguments);this.actions.push({action:Zi,args:f})},un.lineTo=function(s,m){var $=Array.prototype.slice.call(arguments),K=this.actions[this.actions.length-1].args,G=K[K.length-2],u=K[K.length-1],H=new Qk(new tk(G,u),new tk(s,m));this.curves.push(H),this.actions.push({action:Ig,args:$})},un.quadraticCurveTo=function(U,R,x,f){var c=Array.prototype.slice.call(arguments),J=this.actions[this.actions.length-1].args,d=J[J.length-2],F=J[J.length-1],E=new cq(new tk(d,F),new tk(U,R),new tk(x,f));this.curves.push(E),this.actions.push({action:im,args:c})},un.bezierCurveTo=function(Z,r,X,N,G,i){var m=Array.prototype.slice.call(arguments),J=this.actions[this.actions.length-1].args,S=J[J.length-2],L=J[J.length-1],I=new xj(new tk(S,L),new tk(Z,r),new tk(X,N),new tk(G,i));this.curves.push(I),this.actions.push({action:Ah,args:m})},un.arc=function(O,R,Q,S,y,b){var t=this.actions[this.actions.length-1].args,c=t[t.length-2],o=t[t.length-1];this.absarc(O+c,R+o,Q,S,y,b)},un.absarc=function(x,p,J,A,g,a){this.absellipse(x,p,J,J,A,g,a)},un.ellipse=function(_,g,Z,i,v,N,c){var p=this.actions[this.actions.length-1].args,h=p[p.length-2],q=p[p.length-1];this.absellipse(_+h,g+q,Z,i,v,N,c)},un.absellipse=function(r,k,d,O,w,A,y){var x=Array.prototype.slice.call(arguments),Y=new Oe(r,k,d,O,w,A,y);this.curves.push(Y);var s=Y.getPoint(1);x.push(s.x),x.push(s.y),this.actions.push({action:eh,args:x})},un.getSpacedPoints=function(i){i||(i=40);for(var q=[],C=0;i>C;C++)q.push(this.getPoint(C/i));return q},un.getPoints=function(T,p){T=T||12;var X,Z,a,c,f,F,R,$,t,w,s,M,g,e,m,H,J,r,A=[];for(X=0,Z=this.actions.length;Z>X;X++)switch(a=this.actions[X],c=a.action,f=a.args,c){case Zi:A.push(new tk(f[0],f[1]));break;case Ig:A.push(new tk(f[0],f[1]));break;case im:for(F=f[2],R=f[3],w=f[0],s=f[1],A.length>0?(e=A[A.length-1],M=e.x,g=e.y):(e=this.actions[X-1].args,M=e[e.length-2],g=e[e.length-1]),m=1;T>=m;m++)H=m/T,J=ef.b2(H,M,w,F),r=ef.b2(H,g,s,R),A.push(new tk(J,r));break;case Ah:for(F=f[4],R=f[5],w=f[0],s=f[1],$=f[2],t=f[3],A.length>0?(e=A[A.length-1],M=e.x,g=e.y):(e=this.actions[X-1].args,M=e[e.length-2],g=e[e.length-1]),m=1;T>=m;m++)H=m/T,J=ef.b3(H,M,w,$,F),r=ef.b3(H,g,s,t,R),A.push(new tk(J,r));break;case er:var I,B=f[0],l=f[1],O=f[2],D=f[3],n=f[4],Q=!!f[5],K=n-D,h=2*T;for(m=1;h>=m;m++)H=m/h,Q||(H=1-H),I=D+H*K,J=B+O*b(I),r=l+O*_(I),A.push(new tk(J,r));break;case eh:var I,B=f[0],l=f[1],i=f[2],W=f[3],D=f[4],n=f[5],Q=!!f[6],K=n-D,h=2*T;for(m=1;h>=m;m++)H=m/h,Q||(H=1-H),I=D+H*K,J=B+i*b(I),r=l+W*_(I),A.push(new tk(J,r))}var j,L,G=Y["shape3d.point.epsilon"],P=!1;for(Z=A.length,X=0,Z=A.length;Z>X;X++)j=A[X],L=X===Z-1?A[0]:A[X+1],j&&L&&k(j.x-L.x)<G&&k(j.y-L.y)<G&&(P=!0,A[X]=null);if(P){var d=[];for(X=0;Z>X;X++)A[X]&&d.push(A[X]);A=d}return p&&A.push(A[0]),A},un.toShapes=function(j,P){function s(Y){var H,v,l,f,a,u=[],M=new yq;for(H=0,v=Y.length;v>H;H++)l=Y[H],a=l.args,f=l.action,f==Zi&&0!=M.actions.length&&(u.push(M),M=new yq),M[f].apply(M,a);return 0!=M.actions.length&&u.push(M),u}function w(q){for(var h=[],y=0,v=q.length;v>y;y++){var A=q[y],X=new $l;X.actions=A.actions,X.curves=A.curves,h.push(X)}return h}function I(T,m){for(var C=1e-10,y=m.length,r=!1,I=y-1,S=0;y>S;I=S++){var j=m[I],O=m[S],n=O.x-j.x,o=O.y-j.y;if(k(o)>C){if(0>o&&(j=m[S],n=-n,O=m[I],o=-o),T.y<j.y||T.y>O.y)continue;if(T.y==j.y){if(T.x==j.x)return!0}else{var U=o*(T.x-j.x)-n*(T.y-j.y);if(0==U)return!0;if(0>U)continue;r=!r}}else{if(T.y!=j.y)continue;if(O.x<=T.x&&T.x<=j.x||j.x<=T.x&&T.x<=O.x)return!0}}return r}var X=s(this.actions);if(0==X.length)return[];if(P===!0)return w(X);var o,t,v,$=[];if(1==X.length)return t=X[0],v=new $l,v.actions=t.actions,v.curves=t.curves,$.push(v),$;var h=!ef.isClockWise(X[0].getPoints());h=j?!h:h;var S,y=[],C=[],U=[],A=0;C[A]=c,U[A]=[];var x,J;for(x=0,J=X.length;J>x;x++)t=X[x],S=t.getPoints(),o=ef.isClockWise(S),o=j?!o:o,o?(!h&&C[A]&&A++,C[A]={s:new $l,p:S},C[A].s.actions=t.actions,C[A].s.curves=t.curves,h&&A++,U[A]=[]):U[A].push({h:t,p:S[0]});if(!C[0])return w(X);if(C.length>1){for(var B=!1,i=[],l=0,u=C.length;u>l;l++)y[l]=[];for(var l=0,u=C.length;u>l;l++){C[l];for(var q=U[l],T=0;T<q.length;T++){for(var Q=q[T],r=!0,e=0;e<C.length;e++)I(Q.p,C[e].p)&&(l!=e&&i.push({froms:l,tos:e,hole:T}),r?(r=!1,y[e].push(Q)):B=!0);r&&y[l].push(Q)}}i.length>0&&(B||(U=y))}var m,Y,a;for(x=0,J=C.length;J>x;x++)for(v=C[x].s,$.push(v),m=U[x],Y=0,a=m.length;a>Y;Y++)v.holes.push(m[Y].h);return $};var $l=function(){yq.apply(this,arguments),this.holes=[]},cl=$l.prototype=di(un);cl.getPointsHoles=function(Y){var d,V=this.holes.length,E=[];for(d=0;V>d;d++)E[d]=this.holes[d].getTransformedPoints(Y);return E},cl.extractAllPoints=function(L){return{shape:this.getTransformedPoints(L),holes:this.getPointsHoles(L)}},cl.extractPoints=function(y){return this.extractAllPoints(y)};var ef={triangulateShape:function(m,I){function S(B,N,Z){return B.x!=N.x?B.x<N.x?B.x<=Z.x&&Z.x<=N.x:N.x<=Z.x&&Z.x<=B.x:B.y<N.y?B.y<=Z.y&&Z.y<=N.y:N.y<=Z.y&&Z.y<=B.y}function Y(x,e,K,J,O){var R=1e-10,w=e.x-x.x,g=e.y-x.y,d=J.x-K.x,l=J.y-K.y,C=x.x-K.x,m=x.y-K.y,c=g*d-w*l,T=g*C-w*m;if(k(c)>R){var t;if(c>0){if(0>T||T>c)return[];if(t=l*C-d*m,0>t||t>c)return[]}else{if(T>0||c>T)return[];if(t=l*C-d*m,t>0||c>t)return[]}if(0==t)return!O||0!=T&&T!=c?[x]:[];if(t==c)return!O||0!=T&&T!=c?[e]:[];if(0==T)return[K];if(T==c)return[J];var L=t/c;return[{x:x.x+L*w,y:x.y+L*g}]}if(0!=T||l*C!=d*m)return[];var q=0==w&&0==g,F=0==d&&0==l;if(q&&F)return x.x!=K.x||x.y!=K.y?[]:[x];if(q)return S(K,J,x)?[x]:[];if(F)return S(x,e,K)?[K]:[];var D,M,V,h,G,B,Y,Z;return 0!=w?(x.x<e.x?(D=x,V=x.x,M=e,h=e.x):(D=e,V=e.x,M=x,h=x.x),K.x<J.x?(G=K,Y=K.x,B=J,Z=J.x):(G=J,Y=J.x,B=K,Z=K.x)):(x.y<e.y?(D=x,V=x.y,M=e,h=e.y):(D=e,V=e.y,M=x,h=x.y),K.y<J.y?(G=K,Y=K.y,B=J,Z=J.y):(G=J,Y=J.y,B=K,Z=K.y)),Y>=V?Y>h?[]:h==Y?O?[]:[G]:Z>=h?[G,M]:[G,B]:V>Z?[]:V==Z?O?[]:[D]:Z>=h?[D,M]:[D,B]}function $(c,S,R,O){var T=1e-10,M=S.x-c.x,w=S.y-c.y,e=R.x-c.x,$=R.y-c.y,P=O.x-c.x,x=O.y-c.y,i=M*$-w*e,G=M*x-w*P;if(k(i)>T){var l=P*$-x*e;return i>0?G>=0&&l>=0:G>=0||l>=0}return G>0}function W(m,v){function U(s,_){var J=Q.length-1,C=s-1;0>C&&(C=J);var o=s+1;o>J&&(o=0);var A=$(Q[s],Q[C],Q[o],t[_]);if(!A)return!1;var P=t.length-1,X=_-1;0>X&&(X=P);var V=_+1;return V>P&&(V=0),A=$(t[_],t[X],t[V],Q[s]),A?!0:!1}function x(x,O){var A,M,$;for(A=0;A<Q.length;A++)if(M=A+1,M%=Q.length,$=Y(x,O,Q[A],Q[M],!0),$.length>0)return!0;return!1}function W(i,X){var l,O,c,b,u;for(l=0;l<h.length;l++)for(O=v[h[l]],c=0;c<O.length;c++)if(b=c+1,b%=O.length,u=Y(i,X,O[c],O[b],!0),u.length>0)return!0;return!1}for(var t,Z,B,V,H,f,R,G,d,K,p,Q=m.concat(),h=[],l=[],L=0,q=v.length;q>L;L++)h.push(L);for(var y=0,r=2*h.length;h.length>0&&(r--,!(0>r));)for(B=y;B<Q.length;B++){V=Q[B],Z=-1;for(var L=0;L<h.length;L++)if(f=h[L],R=V.x+":"+V.y+":"+f,l[R]===c){t=v[f];for(var e=0;e<t.length;e++)if(H=t[e],U(B,e)&&!x(V,H)&&!W(V,H)){Z=e,h.splice(L,1),G=Q.slice(0,B+1),d=Q.slice(B),K=t.slice(Z),p=t.slice(0,Z+1),Q=G.concat(K).concat(p).concat(d),y=B;break}if(Z>=0)break;l[R]=!0}if(Z>=0)break}return Q}for(var b,H,r,g,q,z,p={},n=m.concat(),i=0,j=I.length;j>i;i++)Array.prototype.push.apply(n,I[i]);for(b=0,H=n.length;H>b;b++)q=n[b].x+":"+n[b].y,p[q]!==c,p[q]=b;var A=W(m,I),Z=Ao.Triangulate(A,!1);for(b=0,H=Z.length;H>b;b++)for(g=Z[b],r=0;3>r;r++)q=g[r].x+":"+g[r].y,z=p[q],z!==c&&(g[r]=z);return Z.concat()},isClockWise:function(h){return Ao.Triangulate.area(h)<0},b2p0:function(J,b){var v=1-J;return v*v*b},b2p1:function(B,T){return 2*(1-B)*B*T},b2p2:function(E,z){return E*E*z},b2:function(o,b,F,D){return this.b2p0(o,b)+this.b2p1(o,F)+this.b2p2(o,D)},b3p0:function(n,l){var A=1-n;return A*A*A*l},b3p1:function(E,O){var T=1-E;return 3*T*T*E*O},b3p2:function(O,S){var c=1-O;return 3*c*O*O*S},b3p3:function(B,K){return B*B*B*K},b3:function(x,H,V,r,O){return this.b3p0(x,H)+this.b3p1(x,V)+this.b3p2(x,r)+this.b3p3(x,O)}},Ao={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var d=g.keys(this.faces);return d.length?d[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(X){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(M){var y=M.familyName.toLowerCase(),t=this;return t.faces[y]=t.faces[y]||{},t.faces[y][M.cssFontWeight]=t.faces[y][M.cssFontWeight]||{},t.faces[y][M.cssFontWeight][M.cssFontStyle]=M,M},drawText:function(R){var T,A=this.getFace(),F=this.size/A.resolution,s=0,Q=String(R).split(""),S=Q.length,Z=[];for(T=0;S>T;T++){var V=new yq,D=this.extractGlyphPoints(Q[T],A,F,s,V);D&&(s+=D.offset*this.spacing,Z.push(D.path))}var P=s/2;return{paths:Z,offset:P}},extractGlyphPoints:function(z,K,H,o,w){var u,q,J,l,S,E,I,f,R,k,B,x,F,r,T,$,X,h,C,G=[],p=K.glyphs[z]||K.glyphs["?"];if(p){if(p.o)for(l=p._cachedOutline||(p._cachedOutline=p.o.split(" ")),E=l.length,I=H,f=H,u=0;E>u;)switch(S=l[u++]){case"m":R=l[u++]*I+o,k=l[u++]*f,w.moveTo(R,k);break;case"l":R=l[u++]*I+o,k=l[u++]*f,w.lineTo(R,k);break;case"q":if(B=l[u++]*I+o,x=l[u++]*f,T=l[u++]*I+o,$=l[u++]*f,w.quadraticCurveTo(T,$,B,x),C=G[G.length-1])for(F=C.x,r=C.y,q=1,J=this.divisions;J>=q;q++){var n=q/J;ef.b2(n,F,T,B),ef.b2(n,r,$,x)}break;case"b":if(B=l[u++]*I+o,x=l[u++]*f,T=l[u++]*I+o,$=l[u++]*f,X=l[u++]*I+o,h=l[u++]*f,w.bezierCurveTo(T,$,X,h,B,x),C=G[G.length-1])for(F=C.x,r=C.y,q=1,J=this.divisions;J>=q;q++){var n=q/J;ef.b3(n,F,T,X,B),ef.b3(n,r,$,h,x)}}return{offset:p.ha*H,path:w}}}};Ao.generateShapes=function(T,p){p=p||{};var $=p.font;if($===c&&($=Ao.getDefaultFont(),!$))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var t=p.size!==c?p.size:1,e=p.curveSegments!==c?p.curveSegments:4,j=p.spacing!==c?p.spacing:1,Z=p.weight!==c?p.weight:"normal",x=p.style!==c?p.style:"normal";Ao.size=t,Ao.divisions=e,Ao.face=$,Ao.weight=Z,Ao.style=x,Ao.spacing=j;for(var r=Ao.drawText(T),g=r.paths,P=[],U=0,D=g.length;D>U;U++)Array.prototype.push.apply(P,g[U].toShapes());return P},function(I){var j=1e-10,u=function(t,P){var q=t.length;if(3>q)return null;var d,S,B,w=[],e=[],s=[];if(K(t)>0)for(S=0;q>S;S++)e[S]=S;else for(S=0;q>S;S++)e[S]=q-1-S;var T=q,h=2*T;for(S=T-1;T>2;){if(h--<=0)return P?s:w;if(d=S,d>=T&&(d=0),S=d+1,S>=T&&(S=0),B=S+1,B>=T&&(B=0),F(t,d,S,B,T,e)){var g,X,j,k,z;for(g=e[d],X=e[S],j=e[B],w.push([t[g],t[X],t[j]]),s.push([e[d],e[S],e[B]]),k=S,z=S+1;T>z;k++,z++)e[k]=e[z];T--,h=2*T}}return P?s:w},K=function(Y){for(var $=Y.length,w=0,s=$-1,Q=0;$>Q;s=Q++)w+=Y[s].x*Y[Q].y-Y[Q].x*Y[s].y;return.5*w},F=function(i,q,n,m,w,k){var f,V,r,Z,A,e,X,b,B;if(V=i[k[q]].x,r=i[k[q]].y,Z=i[k[n]].x,A=i[k[n]].y,e=i[k[m]].x,X=i[k[m]].y,j>(Z-V)*(X-r)-(A-r)*(e-V))return!1;var S,Y,G,u,J,E,a,x,Q,K,v,T,$,y,M;for(S=e-Z,Y=X-A,G=V-e,u=r-X,J=Z-V,E=A-r,f=0;w>f;f++)if(b=i[k[f]].x,B=i[k[f]].y,!(b===V&&B===r||b===Z&&B===A||b===e&&B===X)&&(a=b-V,x=B-r,Q=b-Z,K=B-A,v=b-e,T=B-X,M=S*K-Y*Q,$=J*x-E*a,y=G*T-u*v,M>=-j&&y>=-j&&$>=-j))return!1;return!0};return I.Triangulate=u,I.Triangulate.area=K,I}(Ao),i._typeface_js={faces:Ao.faces,loadFace:Ao.loadFace};var tj=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},xo=tj.prototype={constructor:tj,computeFaceNormals:function(){for(var J=new bn,p=new bn,o=0,M=this.faces.length;M>o;o++){var N=this.faces[o],T=this.vertices[N.a],C=this.vertices[N.b],E=this.vertices[N.c];J.subVectors(E,C),p.subVectors(T,C),J.cross(p),J.normalize(),N.normal.copy(J)}},computeVertexNormals:function(Z){var I,u,R,r,l,Q;for(Q=new Array(this.vertices.length),I=0,u=this.vertices.length;u>I;I++)Q[I]=new bn;if(Z){var W,y,G,N=new bn,f=new bn;for(R=0,r=this.faces.length;r>R;R++)l=this.faces[R],W=this.vertices[l.a],y=this.vertices[l.b],G=this.vertices[l.c],N.subVectors(G,y),f.subVectors(W,y),N.cross(f),Q[l.a].add(N),Q[l.b].add(N),Q[l.c].add(N)}else for(R=0,r=this.faces.length;r>R;R++)l=this.faces[R],Q[l.a].add(l.normal),Q[l.b].add(l.normal),Q[l.c].add(l.normal);for(I=0,u=this.vertices.length;u>I;I++)Q[I].normalize();for(R=0,r=this.faces.length;r>R;R++)l=this.faces[R],l.vertexNormals[0]=Q[l.a].clone(),l.vertexNormals[1]=Q[l.b].clone(),l.vertexNormals[2]=Q[l.c].clone()},mergeVertices:function(){var Y,P,i,o,A,r,D,y,z={},E=[],L=[],W=4,_=a(10,W);for(i=0,o=this.vertices.length;o>i;i++)Y=this.vertices[i],P=O(Y.x*_)+"_"+O(Y.y*_)+"_"+O(Y.z*_),z[P]===c?(z[P]=i,E.push(this.vertices[i]),L[i]=E.length-1):L[i]=L[z[P]];var e=[];for(i=0,o=this.faces.length;o>i;i++){A=this.faces[i],A.a=L[A.a],A.b=L[A.b],A.c=L[A.c],r=[A.a,A.b,A.c];for(var $=0;3>$;$++)if(r[$]==r[($+1)%3]){e.push(i);break}}for(i=e.length-1;i>=0;i--){var x=e[i];for(this.faces.splice(x,1),D=0,y=this.faceVertexUvs.length;y>D;D++)this.faceVertexUvs[D].splice(x,1)}var T=this.vertices.length-E.length;return this.vertices=E,T}},Oe=function(b,g,o,W,B,w,X){this.aX=b,this.aY=g,this.xRadius=o,this.yRadius=W,this.aStartAngle=B,this.aEndAngle=w,this.aClockwise=X};Oe.prototype=di(Wl),Oe.prototype.getPoint=function(N){var j,W=this.aEndAngle-this.aStartAngle;0>W&&(W+=t),W>t&&(W-=t),j=this.aClockwise===!0?this.aEndAngle+(1-N)*(t-W):this.aStartAngle+N*W;var w=this.aX+this.xRadius*b(j),V=this.aY+this.yRadius*_(j);return new tk(w,V)};var Qk=function(d,C){this.v1=d,this.v2=C},kb=Qk.prototype=di(Wl);kb.getPoint=function(Y){var f=this.v2.clone().sub(this.v1);return f.multiplyScalar(Y).add(this.v1),f},kb.getPointAt=function(i){return this.getPoint(i)},kb.getTangent=function(){var v=this.v2.clone().sub(this.v1);return v.normalize()};var cq=function(X,W,S){this.v0=X,this.v1=W,this.v2=S};cq.prototype=di(Wl),cq.prototype.getPoint=function(m){var B,L;return B=ef.b2(m,this.v0.x,this.v1.x,this.v2.x),L=ef.b2(m,this.v0.y,this.v1.y,this.v2.y),new tk(B,L)};var xj=function(p,k,a,c){this.v0=p,this.v1=k,this.v2=a,this.v3=c};xj.prototype=di(Wl),xj.prototype.getPoint=function(O){var $,y;return $=ef.b3(O,this.v0.x,this.v1.x,this.v2.x,this.v3.x),y=ef.b3(O,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new tk($,y)},jn.create(function(e,H){this.v1=e,this.v2=H},function(j){var K=new bn;return K.subVectors(this.v2,this.v1),K.multiplyScalar(j),K.add(this.v1),K});var Qd=jn.create(function(f,O,F){this.v0=f,this.v1=O,this.v2=F},function(N){var k,f,q;return k=ef.b2(N,this.v0.x,this.v1.x,this.v2.x),f=ef.b2(N,this.v0.y,this.v1.y,this.v2.y),q=ef.b2(N,this.v0.z,this.v1.z,this.v2.z),new bn(k,f,q)}),Yb=jn.create(function(P,R,v,j){this.v0=P,this.v1=R,this.v2=v,this.v3=j},function(l){var N,C,B;return N=ef.b3(l,this.v0.x,this.v1.x,this.v2.x,this.v3.x),C=ef.b3(l,this.v0.y,this.v1.y,this.v2.y,this.v3.y),B=ef.b3(l,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new bn(N,C,B)}),To=function(S,F,x,L,A,n,T,a){tj.call(this),L=L!==c?L:.5,A=A!==c?A:.5,a=a!==c?a:1,S=S||8,n=n||0,T=T||t;var m,d,z=1,V=a/2,C=[],i=[],q=this.vertices,h=this.faces,s=this.faceVertexUvs;for(d=0;z>=d;d++){var l=[],f=[],U=d/z,v=U*(A-L)+L;for(m=0;S>=m;m++){var D=m/S,B=new bn,H=-(D*T+n);B.z=v*_(H),B.y=-U*a+V,B.x=v*b(H),q.push(B),l.push(q.length-1),f.push(new tk(D,U))}C.push(l),i.push(f)}var P,w,G=(A-L)/a;for(m=0;S>m;m++)for(0!==L?(P=q[C[0][m]].clone(),w=q[C[0][m+1]].clone()):(P=q[C[1][m]].clone(),w=q[C[1][m+1]].clone()),P.setY(j(P.x*P.x+P.z*P.z)*G).normalize(),w.setY(j(w.x*w.x+w.z*w.z)*G).normalize(),d=0;z>d;d++){var y=C[d][m],E=C[d+1][m],X=C[d+1][m+1],I=C[d][m+1],Z=P.clone(),o=P.clone(),e=w.clone(),g=w.clone(),R=i[d][m].clone(),u=i[d+1][m].clone(),J=i[d+1][m+1].clone(),Y=i[d][m+1].clone();h.push(new Sf(y,E,I,[Z,o,g])),s[0].push([R,u,Y]),h.push(new Sf(E,X,I,[o.clone(),e,g.clone()])),s[0].push([u.clone(),J,Y.clone()])}if(F&&L>0)for(this.vertices.push(new bn(0,V,0)),m=0;S>m;m++){var y=C[0][m],E=C[0][m+1],X=this.vertices.length-1,Z=new bn(0,1,0),o=new bn(0,1,0),e=new bn(0,1,0),R=i[0][m].clone(),u=i[0][m+1].clone(),J=new tk(u.x,0);h.push(new Sf(y,E,X,[Z,o,e],null,1));var M=m/S*t,r=b(M),p=_(M),k=(m+1)/S*t,N=b(k),W=_(k);s[0].push([new tk(.5+.5*r,.5+.5*p),new tk(.5+.5*N,.5+.5*W),new tk(.5,.5)])}if(x&&A>0)for(this.vertices.push(new bn(0,-V,0)),m=0;S>m;m++){var y=C[d][m+1],E=C[d][m],X=q.length-1,Z=new bn(0,-1,0),o=new bn(0,-1,0),e=new bn(0,-1,0),R=i[d][m+1].clone(),u=i[d][m].clone();h.push(new Sf(y,E,X,[Z,o,e],null,2));var M=m/S*t,r=b(M),p=_(M),k=(m+1)/S*t,N=b(k),W=_(k);s[0].push([new tk(.5+.5*N,.5-.5*W),new tk(.5+.5*r,.5-.5*p),new tk(.5,.5)])}};To.prototype=di(xo);var We=function(Q,r,W,l,y,a,n){tj.call(this),n=n||.5,Q=Q||16,r=r||16,W=(W!==c?W:0)-S,l=l!==c?l:t,y=y!==c?y:0,a=a!==c?a:S;var Y,w,h=[],p=[],H=this.vertices,g=this.faces,J=this.faceVertexUvs;for(w=0;r>=w;w++){var A=[],$=[];for(Y=0;Q>=Y;Y++){var V=Y/Q,T=w/r,I=new bn;I.x=-n*b(W+V*l)*_(y+T*a),I.y=n*b(y+T*a),I.z=n*_(W+V*l)*_(y+T*a),H.push(I),A.push(H.length-1),$.push(new tk(V,T))}h.push(A),p.push($)}for(w=0;r>w;w++)for(Y=0;Q>Y;Y++){var N=h[w][Y+1],v=h[w][Y],m=h[w+1][Y],G=h[w+1][Y+1],X=H[N].clone().normalize(),s=H[v].clone().normalize(),f=H[m].clone().normalize(),Z=H[G].clone().normalize(),i=p[w][Y+1].clone(),L=p[w][Y].clone(),j=p[w+1][Y].clone(),M=p[w+1][Y+1].clone();k(H[N].y)===n?(i.x=(i.x+L.x)/2,g.push(new Sf(N,m,G,[X,f,Z])),J[0].push([i,j,M])):k(H[m].y)===n?(j.x=(j.x+M.x)/2,g.push(new Sf(N,v,m,[X,s,f])),J[0].push([i,L,j])):(g.push(new Sf(N,v,G,[X,s,Z])),J[0].push([i,L,M]),g.push(new Sf(v,m,G,[s.clone(),f,Z.clone()])),J[0].push([L.clone(),j,M.clone()]))}};We.prototype=di(xo);var vf=function(a,D,e,I,h,d){tj.call(this),a=a||.33,D=D||.17,I=I||8,e=e||6,h=h||0,d=d||t;for(var L=new bn,w=[],j=[],T=0;I>=T;T++)for(var z=T/I*t+S,r=0;e>=r;r++){var x=r/e*d+h;L.x=a*b(x),L.z=-a*_(x);var Y=new bn,X=a+D*b(z);Y.x=X*b(x),Y.z=-X*_(x),Y.y=D*_(z),this.vertices.push(Y),w.push(new tk(r/e,1-T/I)),j.push(Y.clone().sub(L).normalize())}for(var T=1;I>=T;T++)for(var r=1;e>=r;r++){var W=(e+1)*T+r-1,R=(e+1)*(T-1)+r-1,f=(e+1)*(T-1)+r,i=(e+1)*T+r,G=new Sf(W,R,i,[j[W].clone(),j[R].clone(),j[i].clone()]);this.faces.push(G),this.faceVertexUvs[0].push([w[W].clone(),w[R].clone(),w[i].clone()]),G=new Sf(R,f,i,[j[R].clone(),j[f].clone(),j[i].clone()]),this.faces.push(G),this.faceVertexUvs[0].push([w[R].clone(),w[f].clone(),w[i].clone()])}this.computeFaceNormals()};vf.prototype=di(xo);var dd=function(m,_,s){return m?(tj.call(this),m=m instanceof Array?m:[m],this.addShapeList(m,_),_.convertYZ!==!1&&lg(this,s),this.computeFaceNormals(),void 0):(m=[],void 0)},Ho=dd.prototype=di(tj.prototype);Ho.addShapeList=function(M,x){for(var $=M.length,y=0;$>y;y++){var T=M[y];this.addShape(T,x)}},Ho.addShape=function(l,n){function L(){if(n.bottom)for(var o=0;U>o;o++)B=w[o],X(B[2],B[1],B[0],!0);if(n.top)for(o=0;U>o;o++)B=w[o],X(B[0]+e*W,B[1]+e*W,B[2]+e*W,!1)}function P(){var W=0;for(d(I,W),W+=I.length,a=0,K=O.length;K>a;a++)C=O[a],d(C,W),W+=C.length}function d(j,S){for(var n,X,B=j.length;--B>=0;){n=B,X=B-1,0>X&&(X=j.length-1);var f=0,O=W;for(f=0;O>f;f++){var H=e*f,J=e*(f+1),k=S+n+H,u=S+X+H,v=S+X+J,G=S+n+J;s(k,u,v,G,j,f,O,n,X)}}}function r(F,i,j){h.vertices.push(new bn(F,i,j))}function X(S,s,p,g){S+=Z,s+=Z,p+=Z,h.faces.push(new Sf(S,s,p,null,null,g?2:1));var u=g?V.generateBottomUV(h,l,n,S,s,p):V.generateTopUV(h,l,n,S,s,p);h.faceVertexUvs[0].push(u)}function s(z,I,C,O,T,$,i,R,M){z+=Z,I+=Z,C+=Z,O+=Z,h.faces.push(new Sf(z,I,O)),h.faces.push(new Sf(I,C,O));var t=V.generateSideWallUV(h,l,T,n,z,I,C,O,$,i,R,M);h.faceVertexUvs[0].push([t[0],t[1],t[3]]),h.faceVertexUvs[0].push([t[1],t[2],t[3]])}var i,Y,t,z,p,u=n.amount,S=n.curveSegments||Hb,W=n.steps||1,j=n.extrudePath,M=!1,V=new gl(n.repeatUVLength,n.boundingBox);j&&(i=j.getSpacedPoints(W),M=!0,Y=n.frames!==c?n.frames:new _i.FrenetFrames(j,W,!1),t=new bn,z=new bn,p=new bn);var C,a,K,h=this,Z=this.vertices.length,o=l.extractPoints(S),k=o.shape,O=o.holes,E=!ef.isClockWise(k);if(E){for(k=k.reverse(),a=0,K=O.length;K>a;a++)C=O[a],ef.isClockWise(C)&&(O[a]=C.reverse());E=!1}var w=ef.triangulateShape(k,O),I=k;for(a=0,K=O.length;K>a;a++)C=O[a],k=k.concat(C);for(var y,B,e=k.length,U=w.length,g=0;e>g;g++)y=k[g],M?(z.copy(Y.normals[0]).multiplyScalar(y.x),t.copy(Y.binormals[0]).multiplyScalar(y.y),p.copy(i[0]).add(z).add(t),r(p.x,p.y,p.z)):r(y.x,y.y,0);var Q;for(Q=1;W>=Q;Q++)for(g=0;e>g;g++)y=k[g],M?(z.copy(Y.normals[Q]).multiplyScalar(y.x),t.copy(Y.binormals[Q]).multiplyScalar(y.y),p.copy(i[Q]).add(z).add(t),r(p.x,p.y,p.z)):r(y.x,y.y,u/W*Q);L(),P()};var _i=function(d,N,o,f,P){function Q(V,F,q){return m.vertices.push(new bn(V,F,q))-1}tj.call(this),N=N||64,o=o||1,f=f||8,P=P||!1;var B,w,p,O,c,e,r,A,Y,Z,D,M,K,H,l,k,u,g,n,s,J=[],m=this,R=N+1,j=new bn,h=new _i.FrenetFrames(d,N,P),I=h.tangents,V=h.normals,C=h.binormals;for(this.tangents=I,this.normals=V,this.binormals=C,Y=0;R>Y;Y++)for(J[Y]=[],O=Y/(R-1),A=d.getPointAt(O),B=I[Y],w=V[Y],p=C[Y],Z=0;f>Z;Z++)c=Z/f*t,e=-o*b(c),r=o*_(c),j.copy(A),j.x+=e*w.x+r*p.x,j.y+=e*w.y+r*p.y,j.z+=e*w.z+r*p.z,J[Y][Z]=Q(j.x,j.y,j.z);for(Y=0;N>Y;Y++)for(Z=0;f>Z;Z++)D=P?(Y+1)%N:Y+1,M=(Z+1)%f,K=J[Y][Z],H=J[D][Z],l=J[D][M],k=J[Y][M],u=new tk(Y/N,Z/f),g=new tk((Y+1)/N,Z/f),n=new tk((Y+1)/N,(Z+1)/f),s=new tk(Y/N,(Z+1)/f),this.faces.push(new Sf(K,H,k)),this.faceVertexUvs[0].push([u,g,s]),this.faces.push(new Sf(H,l,k)),this.faceVertexUvs[0].push([g.clone(),n,s.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};_i.prototype=di(xo),_i.FrenetFrames=function(d,q,x){function e(){l[0]=new bn,y[0]=new bn,J=Number.MAX_VALUE,s=k(R[0].x),V=k(R[0].y),D=k(R[0].z),J>=s&&(J=s,b.set(1,0,0)),J>=V&&(J=V,b.set(0,1,0)),J>=D&&b.set(0,0,1),M.crossVectors(R[0],b).normalize(),l[0].crossVectors(R[0],M),y[0].crossVectors(R[0],l[0])}var S,J,s,V,D,O,A,b=new bn,R=[],l=[],y=[],M=new bn,_=new Jc,n=q+1,w=1e-4;for(this.tangents=R,this.normals=l,this.binormals=y,O=0;n>O;O++)A=O/(n-1),R[O]=d.getTangentAt(A),R[O].normalize();for(e(),O=1;n>O;O++)l[O]=l[O-1].clone(),y[O]=y[O-1].clone(),M.crossVectors(R[O-1],R[O]),M.length()>w&&(M.normalize(),S=z(If(R[O-1].dot(R[O]),-1,1)),l[O].applyMatrix4(_.makeRotationAxis(M,S))),y[O].crossVectors(R[O],l[O]);if(x)for(S=z(If(l[0].dot(l[n-1]),-1,1)),S/=n-1,R[0].dot(M.crossVectors(l[0],l[n-1]))>0&&(S=-S),O=1;n>O;O++)l[O].applyMatrix4(_.makeRotationAxis(R[O],S*O)),y[O].crossVectors(R[O],l[O])};var Kr=function(M,G,q,T){tj.call(this),G=G||18,q=q||0,T=T==U?t:T;for(var C=1/(M.length-1),Z=1/G,f=0,r=G;r>=f;f++)for(var K=q+f*Z*T,j=b(K),S=_(K),W=0,z=M.length;z>W;W++){var w=M[W],V=new bn;V.x=j*w.x-S*w.y,V.y=S*w.x+j*w.y,V.z=w.z,this.vertices.push(V)}for(var e=M.length,f=0,r=G;r>f;f++)for(var W=0,z=M.length-1;z>W;W++){var J=W+e*f,I=J,c=J+e,j=J+1+e,d=J+1,F=f*Z,n=W*C,Q=F+Z,k=n+C;this.faces.push(new Sf(I,d,c)),this.faceVertexUvs[0].push([new tk(F,n),new tk(F,k),new tk(Q,n)]),this.faces.push(new Sf(c,d,j)),this.faceVertexUvs[0].push([new tk(Q,n),new tk(F,k),new tk(Q,k)])}this.mergeVertices(),lg(this),this.computeFaceNormals(),this.computeVertexNormals()};Kr.prototype=di(xo);var Tb=function(K,v){v=v||{};var O=Ao.generateShapes(K,v);v.amount=v.amount!==c?v.amount:.5,v.convertYZ=!1,v.fill!==!1&&(v.bottom=!0,v.top=!0),dd.call(this,O,v)};Tb.prototype=di(Ho);var Hh=C.Node=function(){Zn(Hh,this)},Zq={X:Oo,Y:Tk,Z:Xd},Wo={X:0,Y:1,Z:2},ij={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Kh=new So,Wk="xzy",rb=function(l,E,T){if(E){var f=E[0],G=E[1],b=E[2];"xzy"===T?(Tk(l,G),Xd(l,b),Oo(l,f)):"xyz"===T?(Xd(l,b),Tk(l,G),Oo(l,f)):"yxz"===T?(Xd(l,b),Oo(l,f),Tk(l,G)):"yzx"===T?(Oo(l,f),Xd(l,b),Tk(l,G)):"zxy"===T?(Tk(l,G),Oo(l,f),Xd(l,b)):"zyx"===T?(Oo(l,f),Tk(l,G),Xd(l,b)):(Tk(l,G),Xd(l,b),Oo(l,f))}};ub("Node",Cb,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Wk,_64O:0,_rotationX:0,_53O:0,_host:U,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return up},_22Q:function(){return Ss},getX:function(){return this.p().x},setX:function(n){this.p(n,this.p().y)},getY:function(){return this.p().y},setY:function(R){this.p(this.p().x,R)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(b){this.setAnchor(b,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(p){this.setAnchor(this.getAnchor().x,p)},getScaleX:function(){return this.getScale().x},setScaleX:function(q){this.setScale(q,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(Q){this.setScale(this.getScale().x,Q)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},setQuaternion:function(y){var O=(new od).setFromQuaternion(y,od.ReverseOrder(this.getRotationMode()));return this._applyClosestR3(O.x,O.y,O.z)},getQuaternion:function(){var x=new od,b=new od,S=new So;return function(q){return q||(q=new So),this.getEuler(x),x.equals(b)?q.copy(S):q.copy(S.setFromEuler(b.copy(x)))}}(),getEuler:function(N){var o=this.r3();return N||(N=new od),N.set(o[0],o[1],o[2],od.ReverseOrder(this.getRotationMode()))},setEuler:function(i){return i=i.clone().reorder(od.ReverseOrder(this.getRotationMode())),this.r3(i.x,i.y,i.z)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(o,O){lp(o,Ak(U,U,this.r3(),this.getRotationMode())),this.translate3d(o[0]*O,o[1]*O,o[2]*O)},translateFront:function(A){this.translate3dBy([0,0,1],A)},translateBack:function(Z){this.translate3dBy([0,0,-1],Z)},translateLeft:function(D){this.translate3dBy([-1,0,0],D)},translateRight:function(e){this.translate3dBy([1,0,0],e)},translateTop:function(A){this.translate3dBy([0,1,0],A)},translateBottom:function(h){this.translate3dBy([0,-1,0],h)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(w,d,T){1===arguments.length&&(d=w[1],T=w[2],w=w[0]),this.p(w,T),this.setElevation(d)},translate3d:function(M,l,T){1===arguments.length&&(l=M[1],T=M[2],M=M[0]),this.translate(M,T),this.setElevation(this._54O+l)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(g,B,l){1===arguments.length&&(B=g[1],l=g[2],g=g[0]),this.setSize(g,l),this.setTall(B)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(s,h,L){var O=this;if(!O._updatingRotation3d){O._updatingRotation3d=1,1===arguments.length&&(h=s[1],L=s[2],s=s[0]);var o=[O._rotationX,-O._64O,O._53O];O._rotationX=s,O._64O=-h,O._53O=L,O.fp("rotation3d",o,[s,h,L]),delete O._updatingRotation3d}},_applyClosestR3:function(){function f(l){return l%=t,0>l&&(l+=t),l>S?t-l:l}function s(d,R){return f(d[0]-R[0])+f(d[1]-R[1])+f(d[2]-R[2])}return function(v,l,E){var f,D,R,u=this.r3(),K=this.getRotationMode();"xzy"===K||"yzx"===K?(f=v>0?v-S:v+S,D=l>0?l-S:l+S,R=E>0?S-E:-S-E):"xyz"===K||"zyx"===K?(f=v>0?v-S:v+S,R=E>0?E-S:E+S,D=l>0?S-l:-S-l):("yxz"===K||"zxy"===K)&&(R=E>0?E-S:E+S,D=l>0?l-S:l+S,f=v>0?S-v:-S-v),s([f,D,R],u)<s([v,l,E],u)?this.r3(f,D,R):this.r3(v,l,E)}}(),setRotationY:function(S){this.setRotation(-S)},getRotationY:function(){return-this._64O},lookAtDirection:function(H,y){y=y||Sl;var z=this,a=Sn(H);y===Sl?(z.r3([-F(H[1]/a),-dj(H[2],H[0])+Cg,0]),z.setRotationMode("xzy")):y===fk?(z.r3(0,-dj(H[2],H[0]),F(H[1]/a)),z.setRotationMode("zyx")):y===Ld?(z.r3(0,-dj(H[2],H[0])+S,-F(H[1]/a)),z.setRotationMode("zyx")):y===vc?(z.r3([-F(H[1]/a)+Cg,-dj(H[2],H[0])+Cg,0]),z.setRotationMode("xzy")):y===Ol&&(z.r3([-F(H[1]/a)-Cg,-dj(H[2],H[0])+Cg,0]),z.setRotationMode("xzy")),y===Em&&(z.r3([-F(H[1]/a)+S,-dj(H[2],H[0])+Cg,S]),z.setRotationMode("zxy"))},lookAt:function(B,k){return this.lookAtDirection(Wc(B,this.p3()),k)},lookAtX:function(){var f=new Cc,q=new Cc,j=new Cc,H=new Jc,y=new Jc,v=new od;return function(l,p){var X=Jl(this);if(H.fromArray(X),j.copy(this.p3()),f.copy(l).sub(j),!(f.lengthSq()<1e-6)){f.normalize(),p===Sl?q.set(0,0,1):p===Em?q.set(0,0,-1):p===Ld?q.set(-1,0,0):p===fk?q.set(1,0,0):p===vc?q.set(0,1,0):p===Ol&&q.set(0,-1,0),q.applyMatrix4(H).sub(j).normalize();var K=Math.acos(f.dot(q));if(K){var I=f.clone().cross(q);I.lengthSq()<1e-6&&(p===vc||p===Ol?I.set(0,0,1).applyMatrix4(H).sub(j):I.set(0,1,0).applyMatrix4(H).sub(j)),I.normalize(),v.set(this.r3(),this.getRotationMode(),!0),H.makeRotationFromEuler(v),y.makeRotationAxis(I,-K),v.setFromRotationMatrix(y.multiply(H)),this._applyClosestR3(v.x,v.y,v.z)}}}}(),getHost:function(){return this._host},setHost:function(I){var u=this;if(u!==I&&u._host!==I){var Z=u._host;Z&&(Z._removeAttach(u),Z.updateLayoutAttaches()),u._host=I,u._host&&(u._host._addAttach(u),u._host.updateLayoutAttaches()),u.fp("host",Z,I),u.onHostChanged(Z,I)}},getAttaches:function(){return this._69O},_addAttach:function(s){var Y=this;Y._69O||(Y._69O=new Vo),Y._69O.add(s),Y.fp("attaches",U,s)},_removeAttach:function(H){var D=this;D._69O.remove(H),D._69O.isEmpty()&&delete D._69O,D.fp("attaches",H,U)},getImage:function(){if(this._pendingCheckImageJSON){var o=G.getImage(this._image);o&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof qn&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(E){var m=this,X=m._image,l=m.getWidth(),d=m.getHeight();if(m._image=E,m.fp("image",X,E)){if(null!=E&&(jb(E)||ak(E)&&/\.json$/i.test(E))&&(this._pendingCheckImageJSON=!0),Hc)return;m.fp(Vr,l,m.getWidth()),m.fp(Jb,d,m.getHeight())}},getElevation:function(){return this._54O},setElevation:function(a){var R=this;if(!R._50O){R._50O=1;var T=R._54O;R._54O=a,R.fp(Dq,T,a),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(P){var t=this;if(!t._49O){t._49O=1;var H=t._64O;t._64O=P,t.fp(ee,H,P),delete t._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(f){var E=this;if(!E._51O){E._51O=1;var n=E._rotationX;E._rotationX=f,E.fp("rotationX",n,f),delete E._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(J){var Q=this;if(!Q._52O){Q._52O=1;var $=Q._53O;Q._53O=J,Q.fp("rotationZ",$,J),delete Q._52O}},getPosition:function(){return this._position},setPosition:function(C,R){var F=this;if(!F._50I){F._50I=1;var r;if(r=2===arguments.length?{x:C,y:R}:C,r.x!==F._position.x||r.y!==F._position.y){var l=F._position;F._position=r,F.fp(Pc,l,r)}delete F._50I}},translate:function(s,Y){var q=this._position;this.p(q.x+s,q.y+Y)},getWidth:function(){var T=this;if(T._width>=0)return T._width;var J=T.getStyle("shape3d");if(J){var a=cm(J);if(a&&a.rawS3)return a.rawS3[0];if("billboard"===J||"plane"===J){var y=Kj(T.getStyle("shape3d.image"));return y?Zo(y,T):20}}var y=Kj(T._image);return y?Zo(y,T):20},setWidth:function(d){var W=this,O=W._width;W._width=d,W.fp(Vr,O,d)
},getHeight:function(){var W=this;if(W._height>=0)return W._height;var J=W.getStyle("shape3d");if(J){var z=cm(J);if(z&&z.rawS3)return z.rawS3[2];if("plane"===J){var V=Kj(W.getStyle("shape3d.image"));return V?Ge(V,W):20}if("billboard"===J)return 2}var V=Kj(W._image);return V?Ge(V,W):20},setHeight:function($){var o=this,x=o._height;o._height=$,o.fp(Jb,x,$)},getTall:function(){var u=this;if(u._tall>=0)return u._tall;var o=u.getStyle("shape3d");if(o){var w=cm(o);if(w&&w.rawS3)return w.rawS3[1];if("billboard"===o){var E=Kj(u.getStyle("shape3d.image"));return E?Ge(E,u):20}if("plane"===o)return 2}return 20},setTall:function(G){var v=this,b=v._tall;v._tall=G,v.fp("tall",b,G)},setSize:function(n,S){var p=this;2===arguments.length?(p.setWidth(n),p.setHeight(S)):(p.setWidth(n.width),p.setHeight(n.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(C,g,A,_,E){var u=this,M=u.getAnchor(),y=u.getScale();arguments.length<=2&&(E=g,g=C.y,A=C.width,_=C.height,C=C.x);var F=E&&y.x<0?1-M.x:M.x,J=E&&y.y<0?1-M.y:M.y;u.p(C+A*F,g+_*J),E&&(A/=Math.abs(y.x),_/=Math.abs(y.y)),u.setWidth(A),u.setHeight(_)},getMatrix:function(){var t=this,e=t._64O,a=t._position,A=t.getScale();return new Fh(e,a.x,a.y,A.x,A.y)},getMatrix4:function(){var w=new Cc,f=new So,l=new Cc;return function(g){return this.getQuaternion(f),w.copy(this.p3()),l.copy(this.getFinalScale3d()),g||(g=new Jc),g.compose(w,f,l)}}(),getAnchorRect:function(){var Y=this,n=Y.getWidth(),K=Y.getHeight(),v=Y.getAnchor();return{x:-n*v.x,y:-K*v.y,width:n,height:K}},toLocal:function(I){return this.getMatrix().tfi(I)},toGlobal:function(K){return this.getMatrix().tf(K)},getAttachPosition:function(){var A=new Fh;return function(e,j,S,b){S=S||0,b=b||0;var $=this,q=$.getAnchor(),r=$._64O,J=$._position,C=$.getScale();return A.setFromTransform(r,J.x,J.y).tf({x:S+C.x*$.getWidth()*(e-q.x),y:b+C.y*$.getHeight()*(j-q.y)})}}(),isInRect:function(i){i=this.toLocal(i);var d=this.getWidth(),J=this.getHeight();return i.x+=d*this.getAnchorX(),i.y+=J*this.getAnchorY(),!(i.x<0||i.y<0||i.x>d||i.y>J)},getRect:function(){var q=this,W=q.getWidth(),g=q.getHeight(),z=q.getAnchor(),$={x:-W*z.x,y:-g*z.y,width:W,height:g},h=q.getMatrix();return $=Fq([h.tf($.x,$.y),h.tf($.x+$.width,$.y),h.tf($.x+$.width,$.y+$.height),h.tf($.x,$.y+$.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var f=this,c=f.getAnchor(),Z=f._anchorElevation;return{x:c.x,y:Z,z:c.y}},setAnchorElevation:function(r){var j=this,S=j._anchorElevation;return S!==r?(j._anchorElevation=r,j.fp("anchorElevation",S,r),!0):!1},setAnchor3d:function(T,i,h,q){var E,p=this;"number"==typeof T?E={x:T,y:i,z:h}:(E=T.length?{x:T[0],y:T[1],z:T[2]}:T,q=i);var r=p.getDataModel();r&&r.beginTransaction();var e=p.getAnchor3d(),u=p.setAnchor(E.x,E.z);if(p.setAnchorElevation(E.y)&&(u=!0),u&&q&&!Hc){p.getAnchor3d();var K=Jl(p),w=lp([E.x-e.x,E.y-e.y,E.z-e.z],K);p.p3(w)}return r&&r.endTransaction(),u},getAnchor:function(){var E=this;if(E.hasOwnProperty("_anchor"))return E._anchor;var f=Kj(E._image);return f&&f.anchorX!==c?{x:f.anchorX,y:f.anchorY}:E._anchor},setAnchor:function(j,r,Y){var N,P=this;"number"==typeof j?N={x:j,y:r}:(N=j.length?{x:j[0],y:j[1]}:j,Y=r);var J=P.getAnchor();if(J.x!==N.x||J.y!==N.y){var K=P.getDataModel();if(K&&K.beginTransaction(),P._anchor=N,P.fp("anchor",J,N),Y&&!Hc){var V=P.getPosition(),y=P.getSize(),f=P.getRotation(),z=P.getScale(),x=-y.width*(J.x-N.x)*z.x,l=-y.height*(J.y-N.y)*z.y,n=_(f),a=b(f);P.setPosition(V.x+a*x-n*l,V.y+n*x+a*l)}return K&&K.endTransaction(),!0}return!1},getLocalQuaternion:function(p){var d=this,J=d.getHost();if(!J)return d.getQuaternion(p);var F=J.getQuaternion(),Y=d.getQuaternion();return p||(p=new So),p.copy(F).inverse().multiply(Y)},setLocalQuaternion:function(l){var g=this,j=g.getHost();if(!j)return g.setQuaternion(l);var O=j.getQuaternion();g.setQuaternion(O.clone().multiply(l))},getLocalEuler:function(){var X=new So;return function(U){var u=this,R=u.getHost();return R?(u.getLocalQuaternion(X),U||(U=new od),U.setFromQuaternion(X,od.ReverseOrder(this.getRotationMode()))):u.getEuler(U)}}(),setLocalEuler:function(){var z=new So;return function(g){var K=this,D=K.getHost();return D?(z.setFromEuler(g),K.setLocalQuaternion(z)):K.setEuler(g)}}(),getLocalPosition3d:function(G){var O=this;G||(G=new Cc),G.copy(O.p3());var A=O.getHost();if(!A)return G;var L=A.getMatrix4();return G.applyMatrix4(L.getInverse(L))},setLocalPosition3d:function(g){var h=this,C=h.getHost();if(!C)return g.x!==c?h.p3(g.x,g.y,g.z):h.p3(g),void 0;var P=C.getMatrix4(),v=new Cc(g);v.applyMatrix4(P),h.p3(v.x,v.y,v.z)},getScale:function(){return this._scale},setScale:function(G,i){var a,o=this;a=2===arguments.length?{x:G,y:i}:G;var w=o.getScale();(w.x!==a.x||w.y!==a.y)&&(o._scale=a,o.fp("scale",w,a))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var S=this,a=S._scaleTall,k=S.getScale();return[k.x,a,k.y]},getFinalScale3d:function(){var g=this,m=g.s3(),u=g._dynamicScale3d,f=g.getScale3d();return m&&(f[0]*=m[0],f[1]*=m[1],f[2]*=m[2]),u&&(f[0]*=u[0],f[1]*=u[1],f[2]*=u[2]),f},getFinalRotation3d:function(){var p=this;return p._dynamicRotation||p.r3()},setScaleTall:function(q){var O=this,r=O._scaleTall;r!==q&&(O._scaleTall=q,O.fp("scaleTall",r,q))},setScale3d:function(D,W,m){var E,a=this;E="number"==typeof D?{x:D,y:W,z:m}:D.length?{x:D[0],y:D[1],z:D[2]}:D,a.setScaleTall(E.y),a.setScale(E.x,E.z)},getCorners:function(Z,m){Z==U&&(Z=0),m==U&&(m=Z);var i=this,c=i.getAnchor(),O=i.getWidth(),b=i.getHeight(),y=-O*c.x-Z,j=-b*c.y-m,G=O+2*Z,Q=b+2*m,l=i.getMatrix();return[l.tf(y,j),l.tf(y,j+Q),l.tf(y+G,j+Q),l.tf(y+G,j)]},getEditControlPoints:function(v,k,W){k==U&&(k=0),W==U&&(W=k);var x=this,f=x.getAnchor(),K=x.getWidth(),N=x.getHeight(),A=-K*f.x-k,E=-N*f.y-W,n=K+2*k,B=N+2*W;if(v)return[{x:A,y:E},{x:A,y:0},{x:A,y:E+B},{x:0,y:E+B},{x:A+n,y:E+B},{x:A+n,y:0},{x:A+n,y:E},{x:0,y:E}];var _=x.getMatrix();return[_.tf(A,E),_.tf(A,0),_.tf(A,E+B),_.tf(0,E+B),_.tf(A+n,E+B),_.tf(A+n,0),_.tf(A+n,E),_.tf(0,E)]},rotateAt:function(X,H,B){var R=this,d=R._position,L=R._64O,I=new Fh(L,d.x,d.y).tf(X,H),P=j(X*X+H*H),D=dj(d.y-I.y,d.x-I.x)+B;R.setRotation(L+B),R.p(I.x+P*b(D),I.y+P*_(D))},rotateAroundAxis:function(T,R){this.setQuaternion(this.getQuaternion().multiply(Kh.setFromAxisAngle(T,R)))},rotateAroundWorldAxis:function(w,R){this.setQuaternion(this.getQuaternion().premultiply(Kh.setFromAxisAngle(w,R)))},rotateX:function(n){return this.rotateAroundAxis(Cc.AxisX,n)},rotateY:function(r){return this.rotateAroundAxis(Cc.AxisY,r)},rotateZ:function(w){return this.rotateAroundAxis(Cc.AxisZ,w)},onParentChanged:function(){Hh.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var g={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(u){g[u]=!0}),function(J){var Q=this;Hh.superClass.onPropertyChanged.call(Q,J);var j=J.property;if(g[j]&&!Q._layoutUpdating&&Q.updateLayoutParameters(null,j),Q._69O&&Q._69O.each(function(k){k.handleHostPropertyChange(J)}),Q._49I&&Q._49I.each(function(h){h.fp("agentChange",!0,!1)}),Rh[j]&&this.updateLayoutAttaches(),"a:layout"===j.substring(0,8)){this.updateLayoutAttaches();var n=Q._host;n&&n.updateLayoutAttaches()}("s:shape3d.autorotate"===j||"s:autorotate"===j||"s:shape3d.fixSizeOnScreen"===j||"s:fixSizeOnScreen"===j||"s:hide.overlapping.group"===j)&&(Q._47Q=Q.s("autorotate")||Q.s("shape3d.autorotate")||Q.s("fixSizeOnScreen")||Q.s("shape3d.fixSizeOnScreen")||Q.s("hide.overlapping.group"))}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(j){this.updateAttach(j)},onStyleChanged:function(e){Hh.superClass.onStyleChanged.apply(this,arguments),Tm[e]&&this.updateAttach()},updateLayoutAttaches:function(){if(!Hc){var K,S,n=this;return K=Kj(n.getImage()),K&&K.layoutAttach&&(S=K.layoutAttach,S&&S(n))?!0:void 0}},updateAttach:function(b){var u=this;return Hc?(u.updateLayoutParameters(),void 0):(u._51I||(u._51I=1,u._71O(b),delete u._51I),void 0)},_71O:function(i){var h,P,s,p,E,k,o=this,A=o._host,O=i?i.property:U,u=i?i.oldValue:U,G=i?i.newValue:U;if(A instanceof Hh&&(!i||Rh[O])){var X;if(X=Kj(A.getImage()),X&&X.layoutAttach)return}if(A instanceof C.Grid){if(O===Dq)o.setElevation(o._54O+G-u);else if(!i||Kc[O]){if(h=o.s("attach.row.index"),P=o.s("attach.column.index"),s=A.getCellRect(h,P),!s)return;p=o.s("attach.row.span"),E=o.s("attach.column.span"),(1!==p||1!==E)&&(s=Pj(s,A.getCellRect(h+p-1,P+E-1))),Ip(s,o,"attach.padding",1),o.setRect(s)}}else if(A instanceof ys&&(k=o.s("attach.index"))>=0&&(!i||Ai[O])){var T=o.s("attach.thickness"),$=A.getScale(),t=Math.max($.x,$.y);T>0&&o.setHeight(A.getThickness()*T*t);var R=o.s("attach.offset"),r=A.getPoints(),M=r.size();if(M>k){var l=A.getPointsMatrix2d(),g=r.get(k),L=M===k+1?r.get(0):r.get(k+1);g=l.apply(g),L=l.apply(L);var w=[L.x-g.x,L.y-g.y],n=Sn(w);if(n){o.s("attach.offset.relative")&&(R*=n),o.s("attach.offset.opposite")&&(R=n-R);var y={x:g.x+w[0]/n*R,y:g.y+w[1]/n*R},c=o.s("attach.gap");c&&(o.s("attach.gap.relative")&&(c*=A.getThickness()*t),y=br(U,y,L,c)),o.p(y),o.setRotation(dj(w[1],w[0]))}}}else i&&(O===Pc?o.translate(G.x-u.x,G.y-u.y):O===Dq?o.setElevation(o._54O+G-u):pf[O]?"rotation3d"===O?o.syncRotation3d(A,G,u):o._11Q(A,O,G-u):("anchor"===O||"width"===O||"height"===O||"scale"===O)&&o.layout(A))},_11Q:function(){var O=new C.Math.Euler,c=C.Math.Euler.ReverseOrder,v=new C.Math.Vector2,i=new C.Math.Vector2;return function(p,S,Z){var H=this,y=p.p3(),n=p.r3(),V=H.p3(),Y=H.r3();if(S===ee&&(S="rotationY",Z=-Z),(S===ee||"rotationY"===S)&&0===Y[0]&&0===Y[2]&&0===n[0]&&0===n[2]&&0===V[1]&&0===y[1])return H.setRotation(-Y[1]-Z),v.set(V[0],V[2]).rotateAround(i.set(y[0],y[2]),-Z),H.p(v.x,v.y),void 0;var e=ij[p.getRotationMode()],h=e[0],C=e[1],$=e[2],U=Zq[h],D=Zq[C],Q=Zq[$],B=Tj();S===ee+h?(Q(B,n[Wo[$]]),D(B,n[Wo[C]]),U(B,Z),D(B,-n[Wo[C]]),Q(B,-n[Wo[$]])):S===ee+C?(Q(B,n[Wo[$]]),D(B,Z),Q(B,-n[Wo[$]])):S===ee+$&&Q(B,Z);var r=Wc(V,y);lp(r,B),H.p3(y[0]+r[0],y[1]+r[1],y[2]+r[2]);var L=H.getRotationMode();rb(B,H.r3(),L),O.setFromRotationMatrix(B,c(L)),H.r3([O.x,O.y,O.z])}}(),syncRotation3d:function(){var n=new So,x=new od,e=new Cc;return function(y,H,I){var E=this;if(I[0]!==H[0]||I[1]!==H[1]||I[2]!==H[2]){var w=od.ReverseOrder(y.getRotationMode());Kh.setFromEuler(x.set(I[0],I[1],I[2],w)),n.setFromEuler(x.set(H[0],H[1],H[2],w)),n.multiply(Kh.inverse());var f=y.p3(),c=E.p3();e.set(c[0]-f[0],c[1]-f[1],c[2]-f[2]).applyQuaternion(n),E.p3(f[0]+e.x,f[1]+e.y,f[2]+e.z),E.setQuaternion(E.getQuaternion(Kh).premultiply(n))}}}(),isHostOn:function(N){var S=this;if(S._host&&N&&N._69O)for(var k={},D=S._host;D&&D!==S&&!k[D._id];){if(D===N)return!0;k[D._id]=D,D=D._host}return!1},isLoopedHostOn:function(Y){return this.isHostOn(Y)&&Y.isHostOn(this)},getScaledSize:function(){var t=this.getSize(),H=this.getScale();return t.width*=Math.abs(H.x),t.height*=Math.abs(H.y),t},layout:function(y){if(y=y||this.getHost()){var n=this,f=n.s("layout.h")||"center",$=n.s("layout.v")||"center";if("center"!==f||"center"!==$){var k=new C.Math.Vector2,P=y.getPosition(),p=y.getAnchor(),i=y.getScaledSize();n.getPosition();var j,U,g,K,Q,l=1,L=1;switch(n._layoutUpdating=!0,f){case"left":k.setX(n._layoutHValue-p.x*i.width);break;case"right":k.setX((1-p.x)*i.width-n._layoutHValue);break;case"leftright":j=i.width-n._layoutHValue[2],g=n.getRotation()-y.getRotation(),K=Math.abs(Math.sin(g)),Q=Math.abs(Math.cos(g)),l+=Q*j/n._layoutHValue[3],L+=K*j/n._layoutHValue[4],k.setX(n._layoutHValue[1]+(n._layoutHValue[5]-p.x)*i.width);break;case"center":k.setX((.5-p.x)*i.width-n._layoutHValue);break;case"scale":g=n.getRotation()-y.getRotation(),K=Math.abs(Math.sin(g)),Q=Math.abs(Math.cos(g)),k.setX((.5-p.x)*i.width-n._layoutHValue[1]*i.width/n._layoutHValue[0]),U=i.width/n._layoutHValue[2]-1,l+=Q*U,L+=K*U}switch($){case"top":k.setY(n._layoutVValue-p.y*i.height);break;case"bottom":k.setY((1-p.y)*i.height-n._layoutVValue);break;case"topbottom":g||(g=n.getRotation()-y.getRotation(),K=Math.abs(Math.sin(g)),Q=Math.abs(Math.cos(g))),j=i.height-n._layoutVValue[2],l+=K*j/n._layoutVValue[3],L+=Q*j/n._layoutVValue[4],k.setY(n._layoutVValue[1]+(n._layoutVValue[5]-p.y)*i.height);break;case"center":k.setY((.5-p.y)*i.height-n._layoutVValue);break;case"scale":g||(g=n.getRotation()-y.getRotation(),K=Math.abs(Math.sin(g)),Q=Math.abs(Math.cos(g))),k.setY((.5-p.y)*i.height-n._layoutVValue[1]*i.height/n._layoutVValue[0]),U=i.height/n._layoutVValue[2]-1,l+=K*U,L+=Q*U}if("leftright"===f||"scale"===f||"topbottom"===$||"scale"===$){var b=this.getScale(),S=Math.abs(b.x),J=Math.abs(b.y);"leftright"===f||"scale"===f?n.setSize(n._layoutHValue[3]*l/S,n._layoutHValue[4]*L/J):n.setSize(n._layoutVValue[3]*l/S,n._layoutVValue[4]*L/J)}k.rotateAround(null,y.getRotation()),this.setPosition(k.x+P.x,k.y+P.y),n._layoutUpdating=c}}},updateLayoutParameters:function(V,H){if(V=V||this.getHost()){var W=this,s=W.s("layout.h"),o=W.s("layout.v");if(s||o){var n,O,z,j,_,x,F=new C.Math.Vector2,Y=V.getPosition(),q=V.getAnchor(),g=V.getScaledSize(),u=W.getPosition(),Z=W.getScaledSize();switch(F.set(u.x-Y.x,u.y-Y.y),F.rotateAround(null,-V.getRotation()),s){case"left":W._layoutHValue=F.x+q.x*g.width;break;case"right":W._layoutHValue=-F.x+(1-q.x)*g.width;break;case"center":W._layoutHValue=-F.x+(.5-q.x)*g.width;break;case"leftright":case"scale":"scale"===s?n=-F.x+(.5-q.x)*g.width:(O=W.getAnchor(),z=W.getRotation()-V.getRotation(),j=Math.cos(z),_=Math.sin(z),x=-Math.min(-O.x*j+O.y*_,-O.x*j-(1-O.y)*_,(1-O.x)*j+O.y*_,(1-O.x)*j-(1-O.y)*_),n=F.x-(x-q.x)*g.width),"position"===H&&"object"==typeof W._layoutHValue?(W._layoutHValue[0]=g.width,W._layoutHValue[1]=n):W._layoutHValue=[g.width,n,g.width,Z.width,Z.height,x]}switch(o){case"top":W._layoutVValue=F.y+q.y*g.height;break;case"bottom":W._layoutVValue=-F.y+(1-q.y)*g.height;break;case"center":W._layoutVValue=-F.y+(.5-q.y)*g.height;break;case"topbottom":case"scale":"scale"===o?n=-F.y+(.5-q.y)*g.height:(z||(O=W.getAnchor(),z=W.getRotation()-V.getRotation(),j=Math.cos(z),_=Math.sin(z)),x=-Math.min(-O.x*_-O.y*j,-O.x*_+(1-O.y)*j,(1-O.x)*_-O.y*j,(1-O.x)*_+(1-O.y)*j),n=F.y-(x-q.y)*g.height),"position"===H&&"object"==typeof W._layoutVValue?(W._layoutVValue[0]=g.height,W._layoutVValue[1]=n):W._layoutVValue=[g.height,n,g.height,Z.width,Z.height,x]}}}},getSerializableProperties:function(){var n=Hh.superClass.getSerializableProperties.call(this);return hn(n,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),n}});var Fb=C.Edge=function(e,h){var p=this;Zn(Fb,p),p.setSource(e),p.setTarget(h)};ub("Edge",Cb,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return tr},_22Q:function(){return Us},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(U){if(U===this)return!1;if(Je(U))return!0;for(var r,Q,$,z,x,s=[this],Z=-1,w=0;w>Z;)if(Z++,r=s[Z],Q=r._44I)for(Q=Q.getArray(),z=0,x=Q.length;x>z;z++)if($=Q[z],hq($)&&!(s.indexOf($)>=0)){if($===U)return!1;s.push($),w++}return!0},setSource:function(s){var I=this;if(I._source!==s&&I.canSetSourceTarget(s)){var c=I._source;I._source=s,c&&c._16I(I),s&&s._2I(I),I._7I(),I.fp("source",c,s)}},setTarget:function(X){var x=this;if(x._target!==X&&x.canSetSourceTarget(X)){var w=x._target;x._target=X,w&&w._18I(x),X&&X._4I(x),x._7I(),x.fp("target",w,X)}},isLooped:function(){var T=this;return T._source===T._target&&Je(T._source)&&Je(T._target)},onPropertyChanged:function(){var v=this;v._49I&&v._49I.each(function(g){g.fp("agentChange",!0,!1)})},_7I:function(){var h,O=this,_=mp(O);O._40I!==_&&(h=this._40I,h&&h._15I(O),O._40I=_,_&&_._1I(O),O.fp("sourceAgent",h,_),Gm(h,O._41I),Gm(_,O._41I));var G=Wq(O);O._41I!==G&&(h=O._41I,h&&h._17I(O),O._41I=G,G&&G._3I(O),O.fp("targetAgent",h,G),Gm(h,O._40I),Gm(G,O._40I))},_22I:function(b){this._52I=b,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var k=this;return k._52I&&k._52I.get(0)!==k&&!k.getStyle(tn)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var I=this,j=I._52I;return j&&!I.getStyle(tn)&&j.size()>1&&I===j.get(0)},toggle:function(){this.beginTransaction();var h=this._52I,K=!this.s(tn);h&&h.size()>1&&(h.each(function(c){c.s(tn,K)}),h.getSiblings().each(function(z){z!==h&&z.each(function(c){c.fp("edgeGroup",U,z)})})),this.endTransaction()},setStyle:function(r,d){(r===tg||"edge.segments"===r)&&(d=Nm(d)),Fb.superClass.setStyle.call(this,r,d)},onStyleChanged:function(F){Fb.superClass.onStyleChanged.apply(this,arguments),zd[F]&&Gm(this._41I,this._40I)},getSerializableProperties:function(){var o=Fb.superClass.getSerializableProperties.call(this);return hn(o,{source:1,target:1}),o}});var bc=C.Group=function(){Zn(bc,this)};ub("Group",Hh,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return um},onChildAdded:function(){bc.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){bc.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var T=this;if(!T._54I&&!Hc){var k=T.getChildrenRect();k&&(T._53I=1,T.p(Ml(T.s("group.position"),k,T.getSize())),delete T._53I)}},getChildrenRect:function(){var Q,_=this;return _.eachChild(function(r){Je(r)&&(Q=Pj(Q,_.getChildRect(r)))}),Q},getChildRect:function(x){var l;return Je(x)&&x.s(mo)&&(Di(x)&&x.isExpanded()&&x.eachChild(function(r){l=Pj(l,x.getChildRect(r))}),!l&&x.getRect&&(l=x.getRect())),l},setPosition:function(j,q){var E=this;if(!E._54I){var s;s=2===arguments.length?{x:j,y:q}:j,Hc||E._53I||(E._54I=1,we(E._children,s.x-E._position.x,s.y-E._position.y),delete E._54I),bc.superClass.setPosition.call(this,s)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(Z){var m=this;if(m._57O!==Z){var F=m._57O;m._57O=Z,m.fp("expanded",F,m._57O),m._fireInvalidateDeep(),m._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(v){Di(v)?v._fireInvalidateDeep():v.iv()})},_8I:function(){bc.superClass._8I.call(this),this.eachChild(function(p){Je(p)&&p._8I()})},onStyleChanged:function(A){bc.superClass.onStyleChanged.apply(this,arguments),"group.position"===A&&this._81I()},getSerializableProperties:function(){var K=bc.superClass.getSerializableProperties.call(this);return K.expanded=1,K}});var eq=C.Camera=function(){Zn(eq,this),this.s({"shadow.cast":!1,"shadow.receive":!1,shape3d:"billboard"}),this._viewMatrix=new Up.Matrix4,this._projectMatrix=new Up.Matrix4,this.setScale3d(1,1,-1),this.setCullingMask("main,top"),this._projectMatrixDirty=!0};eq.CubeDirectionParam=[1,0,0,0,-1,0,-1,0,0,0,-1,0,0,1,0,0,0,1,0,-1,0,0,0,-1,0,0,1,0,-1,0,0,0,-1,0,-1,0],ub("Camera",Hh,{_22Q:function(){return Camera3dUI},attachRenderTarget:function(K){this._projectMatrixDirty=!0,this.renderTarget=K},detachRenderTarget:function(){this._projectMatrixDirty=!0,this.renderTarget=null},setCullingMask:function(x){var o=x.split(",");this._cullingMask=Aj(o)},isLayerVisible:function(E){var K=In[E];return K&&al(this._cullingMask,K.mask)},isOrtho:function(){return"ortho"===this.s("camera.type")&&!this.isCube()},isCube:function(){return this.renderTarget&&this.renderTarget.isCube()},isPerspective:function(){return!this.isOrtho()},setViewMatrix:function(){var R=new C.Math.Matrix4,H=new C.Math.Euler;return function(V){var e=this;V.isMatrix4?e._viewMatrix.copy(V):e._viewMatrix.fromArray(V),R.getInverse(e._viewMatrix),e.p3(R.getPosition().toArray()),H.set(0,0,0,e.getRotationMode(),!0).setFromRotationMatrix(R),e.r3([H.x,H.y,H.z])}}(),getViewMatrix:function(s){var t=this,x=Ak(null,null,t.r3(),t.getRotationMode(),t.p3()),l=t._viewMatrix;return l.fromArray(x).getInverse(l),l.toArray(s)},setProjectMatrix:function(N){var G=this;N.isMatrix4?G._projectMatrix.copy(N):G._projectMatrix.fromArray(N),N=G._projectMatrix.getElements(),G.isOrtho()?G.s({"camera.near":(N[14]+1)/N[10],"camera.far":(N[14]-1)/N[10],"camera.ortho.width":2/N[0]}):G.s({"camera.near":N[14]/(N[10]-1),"camera.far":N[14]/(N[10]+1),"camera.fovy":2*Math.atan(1/N[5]),"camera.aspect":N[5]/N[0]}),G._projectMatrixDirty=!1},onPropertyChanged:function(D){var _=this;eq.superClass.onPropertyChanged.call(_,D);var A=D.property;("s:camera.near"===A||"s:camera.far"===A||"s:camera.fovy"===A||"s:camera.aspect"===A||"s:camera.ortho.width"===A)&&(_._projectMatrixDirty=!0)},getProjectMatrix:function(){var N=this;if(N._projectMatrixDirty){var j=N.gv,x=N.isCube(),T=x?1:N.s("camera.aspect")||(j?j.getAspect():null)||G.graph3dViewAspect,b=N.s("camera.near")||(j?j.getNear():null)||G.graph3dViewNear,E=N.s("camera.far")||(j?j.getFar():null)||G.graph3dViewFar,k=Tj();if(N.isOrtho()){var F=N.s("camera.ortho.width")||(j?j.getOrthoWidth():null)||G.graph3dViewOrthoWidth,Z=F/2,z=Z/T;cb(k,-Z,Z,-z,z,b,E)}else{var g=x?Math.PI/2:N.s("camera.fovy")||(j?j.getFovy():null)||G.graph3dViewFovy;Xi(k,g,T,b,E)}N._projectMatrix.fromArray(k),N._projectMatrixDirty=!1}return N._projectMatrix.toArray()},lookAt:function(b,D){var u=this.p3();return b.x?this.lookAtDirection([b.x-u[0],b.y-u[1],b.z-u[2]],D):this.lookAtDirection([b[0]-u[0],b[1]-u[1],b[2]-u[2]],D)},lookAtDirection:function(){var E=new C.Math.Matrix4,I=new C.Math.Euler,e=new C.Math.Vector3,m=new C.Math.Vector3;return function(N,c){E.lookAtDirection(e.copy(N).multiplyScalar(-1),c?m.copy(c):m.set(0,1,0)),I.set(0,0,0,this.getRotationMode(),!0).setFromRotationMatrix(E),this.r3([I.x,I.y,I.z])}}(),render:function(E){var d=this,a=E.getGL();if(!a)return!1;var F,n,S=d.renderTarget;if(S)F=S.width,n=S.height;else{var z=E.getDevicePixelRatio();F=E.getWidth()*z,n=E.getHeight()*z}d.gv=E,E._camera=d;var D=E._frameState.renderState.glState,f=D.color.clear.slice(0);fo(a,d.s("camera.background"));var P=E.getEye;if(E.getEye=function(){return d.p3()},d.isCube())for(var A=eq.CubeDirectionParam,L=0;6>L;L++)S&&S.bind(a,L),d.lookAtDirection([A[6*L+0],A[6*L+1],A[6*L+2]],[A[6*L+3],A[6*L+4],A[6*L+5]]),a.clear(a.COLOR_BUFFER_BIT),E.setViewport(a,0,0,F,n),d.s("camera.onlySky")?E.renderSky():E.renderScene({renderAxis:d.s("camera.renderAxis"),renderGrid:d.s("camera.renderGrid"),renderEdit:d.s("camera.renderEdit"),renderReflector:!1}),S&&S.unbind(a);else S&&S.bind(a),a.clear(a.COLOR_BUFFER_BIT),E.overlappingBox.clear(),E.setViewport(a,0,0,F,n),d.s("camera.onlySky")?E.renderSky():E.renderScene({renderAxis:d.s("camera.renderAxis"),renderGrid:d.s("camera.renderGrid"),renderEdit:d.s("camera.renderEdit")}),S&&S.unbind(a);return E.getEye=P,fo(a,f),E._camera=null,d.gv=null,!0}});var af=C.Block=function(){Zn(af,this),this.s({"shadow.cast":!1,"shadow.receive":!1})};ub("Block",Hh,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return zq},_22Q:function(){return Ts},onChildAdded:function(){af.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){af.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:function(){function Y(O,_,N){C.fromArray(Jl(_));var H=_.getAnchor3d();O.push((new Cc).set(0-H.x,0-H.y,0-H.z).applyMatrix4(C).applyMatrix4(N)),O.push((new Cc).set(0-H.x,0-H.y,1-H.z).applyMatrix4(C).applyMatrix4(N)),O.push((new Cc).set(0-H.x,1-H.y,0-H.z).applyMatrix4(C).applyMatrix4(N)),O.push((new Cc).set(0-H.x,1-H.y,1-H.z).applyMatrix4(C).applyMatrix4(N)),O.push((new Cc).set(1-H.x,0-H.y,0-H.z).applyMatrix4(C).applyMatrix4(N)),O.push((new Cc).set(1-H.x,0-H.y,1-H.z).applyMatrix4(C).applyMatrix4(N)),O.push((new Cc).set(1-H.x,1-H.y,0-H.z).applyMatrix4(C).applyMatrix4(N)),O.push((new Cc).set(1-H.x,1-H.y,1-H.z).applyMatrix4(C).applyMatrix4(N))}function j(b,A){var u=(new Jc).makeRotationFromEuler(this.getEuler()).setPosition((new Cc).fromArray(this.p3()));u.getInverse(u),b.forEach(function(e){Je(e)&&Y(A,e,u)})}var C=new Jc;return function(b,g){if(b instanceof Hh&&(b=[b]),!b||0===b.length)return U;var g=[];j.call(this,b,g);var E=[1/0,1/0,1/0],t=[-1/0,-1/0,-1/0];return g.forEach(function(U){E[0]=Math.min(U.x,E[0]),E[1]=Math.min(U.y,E[1]),E[2]=Math.min(U.z,E[2]),t[0]=Math.max(U.x,t[0]),t[1]=Math.max(U.y,t[1]),t[2]=Math.max(U.z,t[2])}),{min:E,max:t}}}(),updateFromChildren:function(){var F=this;if(!Hc&&!F._updatingToChildren&&F._syncSize&&0!==F.size()&&!F._freezeSyncFromChildren){var y=this._getBoundingBox(F.toChildren(Je));if(y){F._updatingFromChildren=1;var k=(new Cc).fromArray(this.getScale3d()),v=(new Cc).fromArray(y.min),N=(new Cc).fromArray(y.max),c=G.blockMinSize,p=new Cc,_=N.clone().sub(v);0===_.x&&p.setX(.5),0===_.y&&p.setY(.5),0===_.z&&p.setZ(.5);var z=this._width==U||-1===this._width,K=new Cc(this.getAnchor3d()),r=k.clone().multiply((new Cc).fromArray(this.s3())),C=_.clone();0===C.x&&C.setX(c),0===C.y&&C.setY(c),0===C.z&&C.setZ(c);var L=K.clone().multiply(r),j=L.clone().multiplyScalar(-1).sub(v).divide(C).add(L.divide(C)).add(p),V=this.s("keepPosition");if(z||this._anchorChanged||this._scaleChanged||!V){!z&&V&&(K=j);var d=K.clone().multiply(_).add(v).applyEuler(this.getEuler()).add((new Cc).fromArray(this.p3()));this.p3([d.x,d.y,d.z])}else this.setAnchor3d(j.x,j.y,j.z);var I=new Cc(1,1,1).divide(k).multiply(_);this.s3(Math.abs(I.x),Math.abs(I.y),Math.abs(I.z)),delete F._updatingFromChildren}}},setPosition:function(h,y){var n=this;if(!n._updatingToChildren){var I;I=2===arguments.length?{x:h,y:y}:h,Hc||n._updatingFromChildren||(n._updatingToChildren=1,we(n._children,I.x-n._position.x,I.y-n._position.y),delete n._updatingToChildren),af.superClass.setPosition.call(this,I)}},setSize3d:function(){this.beginTransaction(),af.superClass.setSize3d.apply(this,arguments),this.endTransaction()},setTall:function(l){var U=this;if(!U._updatingToChildren){this.beginTransaction(),l=B(l,G.blockMinSize);var $=U.getTall();if(l!==$&&af.superClass.setTall.call(U,l),!Hc&&!U._updatingFromChildren){U._updatingToChildren=1;var d=l/$;U._adjustChildTallOrScale(d,"size"),delete U._updatingToChildren,U.updateFromChildren()}this.endTransaction()}},setWidth:function(g){return this.setSize(g,this.getHeight())},setHeight:function(k){return this.setSize(this.getWidth(),k)},setSize:function(r,s){var l=G.blockMinSize;r=B(r,l),s=B(s,l);var C=this;if(!C._updatingToChildren){2!==arguments.length&&(s=r.height,r=r.width),this.beginTransaction();var m=C.getWidth(),Q=C.getHeight();if(r!==m&&af.superClass.setWidth.call(C,r),s!==Q&&af.superClass.setHeight.call(C,s),!Hc&&!C._updatingFromChildren){C._updatingToChildren=1;var Y=r/m,e=s/Q;C._adjustChildScaleOrSize(Y,e,"size"),delete C._updatingToChildren,C.updateFromChildren()}this.endTransaction()}},_adjustChildScaleOrSize:function(J,w,U){var Y=this;if(Y._syncSize){var D=Y.getPosition(),l=Y.getRotation();Y.eachChild(function(z){if(Je(z)){var j=z.getPosition(),r=z.getRotation(),u=z.getWidth(),W=z.getHeight(),S=z.getScale(),K=S.x*u,t=S.y*W;if(0!==K&&0!==t){0>J*w&&z.setRotation(-1*r);var R=new Fh(r,j.x,j.y,K,t);R.translate(-D.x,-D.y),R.rotate(-l),r=dj(R.b*Math.sign(K),R.a*Math.sign(K)),R.scale(J,w);var P,V,H,E=b(r);if(Math.abs(E)<.001?(P=_(r),V=R.b/P,H=-R.c/P):(V=R.a/E,H=R.d/E),"scale"===U)z.setScale(V/u,H/W);else if("size"===U){var q=V/S.x,L=H/S.y;z.setScale(ki(V)*Math.abs(S.x),ki(H)*Math.abs(S.y)),z instanceof C.Shape?(z.setWidthForce(Math.max(Math.abs(q),1e-5)),z.setHeightForce(Math.max(Math.abs(L),1e-5))):z.setSize(Math.max(.01,Math.abs(q)),Math.max(.01,Math.abs(L)))}R.rotate(l),R.translate(D.x,D.y),z.setPosition(R.tx,R.ty)}}})}},_calcChangeFactor:function(z,G,O,Y){var u,w,t,D;return u=k(z),w=k(O),t=u>w?u/w:w/u,u=k(G),w=k(Y),D=u>w?u/w:w/u,B(t,D)},setElevation:function(f){var L=this;if(!L._updatingToChildren){var M=L.getElevation(),E=f-M;0!==E&&(Hc||L._updatingFromChildren||(L._updatingToChildren=1,we(L._children,0,E,0),delete L._updatingToChildren),af.superClass.setElevation.apply(L,arguments))}},setScaleTall:function(R){var r=this;if(!r._updatingToChildren){var B=r.getScaleTall();if(k(R)<.01&&(R=.01*(ki(R)||ki(B))),af.superClass.setScaleTall.call(r,R),!Hc&&!r._updatingFromChildren){r._updatingToChildren=1;var W=R/B;r._adjustChildTallOrScale(W,"size"),delete r._updatingToChildren,r._scaleChanged=1,this.updateFromChildren(),delete r._scaleChanged}}},_adjustChildTallOrScale:function(m,w){var r=this;if(r._syncSize){var f=r.getElevation();r.eachChild(function(Z){if(Je(Z))if("size"===w){var n=Z.getTall();0>m&&Z.setScaleTall(-1*Z.getScaleTall()),Z.setTall(Math.max(.01,Math.abs(n*m))),Z.setElevation(f+(Z.getElevation()-f)*m)}else{var k=Z.getScaleTall();Z.setScaleTall(k*m)}})}},setAnchor3d:function(){if(!this._updatingToChildren){this.beginTransaction();var Y=af.superClass.setAnchor3d.apply(this,arguments);return Y&&!Hc&&!this._updatingFromChildren&&this._syncSize&&(this._anchorChanged=1,this.updateFromChildren(),delete this._anchorChanged),this.endTransaction(),Y}},setAnchor:function(){var H=this;if(!H._updatingToChildren){var Y=H.getAnchor(),N=af.superClass.setAnchor.apply(H,arguments);if(Hc||H._updatingFromChildren||!H._syncSize)return N;H._updatingToChildren=1;var V=H.getAnchor();H.getPosition();var R=H.getSize(),y=H.getScale(),D=H.getRotation(),w=-R.width*y.x*(Y.x-V.x),P=-R.height*y.y*(Y.y-V.y),T=_(D),G=b(D),j=G*w-T*P,q=T*w+G*P;return H.eachChild(function(D){if(Je(D)){var L=D.getPosition();D.setPosition(L.x-j,L.y-q)}}),delete H._updatingToChildren,N}},setAnchorElevation:function(){var d=this;if(!d._updatingToChildren){var Y=d.getAnchorElevation(),I=af.superClass.setAnchorElevation.apply(d,arguments);if(Hc||d._updatingFromChildren||!d._syncSize)return I;d._updatingToChildren=1;var k=d.getAnchorElevation(),q=d.getTall(),l=d.getScaleTall(),j=-q*l*(Y-k);return d.eachChild(function(D){if(Je(D)){var d=D.getElevation();D.setElevation(d-j)}}),delete d._updatingToChildren,I}},setRotation:function(k){this._updateChildrenRotation3d("rotation",k)},setRotationX:function(R){this._updateChildrenRotation3d("rotationX",R)},setRotationZ:function(f){this._updateChildrenRotation3d("rotationZ",f)},setRotation3d:function(){var $=this;if(!$._updatingToChildren){var J=$.r3();af.superClass.setRotation3d.apply($,arguments);var c=$.r3();Hc||$._updatingFromChildren||($._updatingToChildren=1,$.eachChild(function(x){Je(x)&&x.syncRotation3d($,c,J)}),delete $._updatingToChildren)}},_updateChildrenRotation3d:function(X,e){var D=this;if(!D._updatingToChildren){var f=D[rs(X)]();af.superClass[Iq(X)].call(D,e),Hc||D._updatingFromChildren||this._updateRotationToChildren(X,e-f)}},_updateRotationToChildren:function(P,A){var Z=this;Z._updatingToChildren=1,Z.eachChild(function(H){Je(H)&&H._11Q(Z,P,A)}),delete Z._updatingToChildren},setScale:function(J,U){var h=this;if(!h._updatingToChildren){null==U&&(U=J.y,J=J.x);var u=h.getScale();if(k(J)<.01&&(J=.01*(ki(J)||ki(u.x))),k(U)<.01&&(U=.01*(ki(U)||ki(u.y))),af.superClass.setScale.call(h,J,U),!Hc&&!h._updatingFromChildren){h._updatingToChildren=1;var l=J/u.x,F=U/u.y;h._adjustChildScaleOrSize(l,F,"size"),delete h._updatingToChildren,h._scaleChanged=1,h.updateFromChildren(),delete h._scaleChanged}}},onPropertyChanged:function(c){af.superClass.onPropertyChanged.call(this,c),"s:3d.visible"===c.property&&this._invalidateChildrenBatch()},_invalidateChildrenBatch:function(){this.eachChild(function(D){(D.s("batch")||D.s("wf.geometry")||D.s("wf.visible"))&&D.iv(),D instanceof af&&D._invalidateChildrenBatch()})},getSerializableProperties:function(){var S=af.superClass.getSerializableProperties.call(this);return S.clickThroughEnabled=1,S.syncSize=1,S}});var ti=C.Grid=function(){Zn(C.Grid,this)};ub("Grid",Hh,{IRotatable:!1,_icon:"grid_icon",_image:U,getUIClass:function(){return Jf},setRotation:function(){},getCellRect:function(_,j){var g=this,B=g.s("grid.row.count"),X=g.s("grid.column.count");if(0>=B||0>=X||0>_||_>=B||0>j||j>=X)return U;var x,s,v,K=g.getRect(),f=g.s("grid.row.percents"),u=g.s("grid.column.percents");
if(Ip(K,g,"grid.border",-1),f&&f._as&&(f=f._as),u&&u._as&&(u=u._as),f&&f.length===B){for(v=0,x=0;_>x;x++)v+=K.height*f[x];K.y+=v,K.height=K.height*f[_]}else K.height=K.height/B,K.y+=K.height*_;if(u&&u.length===X){for(s=0,x=0;j>x;x++)s+=K.width*u[x];K.x+=s,K.width=K.width*u[j]}else K.width=K.width/X,K.x+=K.width*j;return sr(K,-g.s("grid.gap")),K}});var hc=C.Text=function(){Zn(hc,this),this.setSize(100,50),this.s("text","TEXT")};ub("Text",Hh,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return ol},setWidth:function(n){n||(n=.001),hc.superClass.setWidth.call(this,n)},setHeight:function(Y){Y||(Y=.001),hc.superClass.setHeight.call(this,Y)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),or("__text__",{width:{value:100,isSafeFunc:!0,func:function(P){return P?P._width:100}},height:{value:50,isSafeFunc:!0,func:function(k){return k?k._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"},gradient:{func:"style@text.gradient"},gradientColor:{func:"style@text.gradient.color"},gradientPack:{func:"style@text.gradient.pack"},decoration:{func:"style@text.decoration"},vertical:{func:"style@text.vertical"},verticalGap:{func:"style@text.vertical.gap"}}]});var ys=C.Shape=function(){Zn(ys,this),this._59O=new Vo};ys.__de__=lm,ub("Shape",Hh,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Gj},_22Q:function(){return Vs},getLength:function(S){return on(Yp(this._59O,this._58O,S,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var Q=this._58O;return Q?new Vo(Q._as.slice(0)):Q},setSegments:function(Y){var p=this._58O;Y=Y?zo(Y)?new Vo(Y.slice(0)):new Vo(Y._as.slice(0)):null,(p&&Y&&p._as.join(",")!==Y._as.join(",")||p!==Y)&&(this._58O=Y,this.fp("segments",p,Y))},getPoints:function(){return this._59O},toPoints:function(){var I=this._59O;return new Vo(I._as.slice(0))},getPointsMatrix2d:function(){var D=this,d=new Up.Matrix2d,R=D.getPosition(),L=D.getScale(),k=D.getRotation();return d.translate(-R.x,-R.y).scale(L.x,L.y).rotate(k).translate(R.x,R.y),d},getPointsMatrix3d:function(){return function(){var H=this,f=new Up.Matrix4,g=f.getElements(),i=H.p3();Ic(g,i),rb(g,H.getFinalRotation3d(),H.getRotationMode());var o=H.getScale3d(),J=H._dynamicScale3d;return J&&(o[0]*=J[0],o[1]*=J[1],o[2]*=J[2]),$j(g,o),Ic(g,fc(i)),f}}(),setPoints:function(W,Q){var I=this,T=I._59O;W=W?zo(W)?new Vo(W.slice(0)):new Vo(W._as.slice(0)):new Vo;var B,p,a,X,A,V;Q&&(B=I.getPosition(),V=new Fh(I.getRotation(),0,0,I.getScale().x,I.getScale().y)),(T&&W&&T._as.join(",")!==W._as.join(",")||T!==W)&&(I._59O=W,I.fs(),I.fp("points",T,W)),Q&&(p=I.getPosition(),a=p.x-B.x,X=p.y-B.y,A=V.tf(a,X),I.setPosition(p.x-a+A.x,p.y-X+A.y))},addPoint:function(u,W,f){var n=this.toPoints();n.add(u,W),this.setPoints(n,f)},setPoint:function(N,o,$){var l=this.toPoints();l.set(N,o),this.setPoints(l,$)},removePointAt:function(c){var y=this.toPoints();y.removeAt(c),this.setPoints(y)},setWidthForce:function(M){var J=this;if(!J._55I&&!Hc&&J.getWidth()){J._55I=1;var B=J._position.x,h=M/J.getWidth(),u=J.toPoints(),G=new Vo;1!==h&&(u.each(function(T){G.add({x:(T.x-B)*h+B,y:T.y,e:T.e})}),J.setPoints(G),sh(J,[h,0,0,1,B*(1-h),0]),J.fs()),delete J._55I}ys.superClass.setWidth.call(J,M)},setWidth:function(u){return this.setWidthForce(Rr>u?Rr:u)},setHeightForce:function(j){var D=this;if(!D._55I&&!Hc&&D.getHeight()){D._55I=1;var G=D._position.y,w=j/D.getHeight(),k=D.toPoints(),Z=new Vo;1!==w&&(k.each(function(D){Z.add({x:D.x,y:(D.y-G)*w+G,e:D.e})}),D.setPoints(Z),sh(D,[1,0,0,w,0,G*(1-w)]),D.fs()),delete D._55I}ys.superClass.setHeight.call(D,j)},setHeight:function(f){return this.setHeightForce(Rr>f?Rr:f)},setAnchorElevation:function(P){var M=this;M._55I=!0;var V=M._updatingAnchor3d,$=!Hc&&!V;if($){var n,u=P,Q=M.getAnchorElevation(),_=M.getTall();n=_*(Q-u),0!==n&&M.shiftPointsElevation(n)}var J=ys.superClass.setAnchorElevation.apply(M,arguments);return V||delete M._55I,J},getShapeElevation:function(){var M=this,H=M._54O;return H-(M.getTall()||0)*(M._anchorElevation-.5)},setAnchor3d:function(P,F,v,E){var B,N=this;"number"==typeof P?B={x:P,y:F,z:v}:(B=P.length?{x:P[0],y:P[1],z:P[2]}:P,E=F),N._55I=!0,N._updatingAnchor3d=!0;var t=N.getDataModel();if(t&&t.beginTransaction(),!Hc){var $=N.getAnchor3d(),D=N.getSize(),T=N.getTall(),y=D.width*($.x-B.x),q=D.height*($.z-B.z),x=T*($.y-B.y);E||N.shiftPoints(y,q,x);var u=N.p3()}var O=ys.superClass.setAnchor3d.apply(N,arguments);if(!Hc&&E){var Y=N.p3();N.shiftPoints(Y[0]-u[0]+y,Y[2]-u[2]+q,Y[1]-u[1]+x)}return t&&t.endTransaction(),delete N._updatingAnchor3d,delete N._55I,O},setAnchor:function(H,o,T){var $=this;$._55I=!0;var h=$._updatingAnchor3d,V=!Hc&&!h;if(V){var Y,S,d;"number"==typeof H?d={x:H,y:o}:(d=H.length?{x:H[0],y:H[1]}:H,T=o);var Z=$.getAnchor(),m=$.getSize();Y=m.width*(Z.x-d.x),S=m.height*(Z.y-d.y),T||$.shiftPoints(Y,S);var N=$.getPosition()}var X=ys.superClass.setAnchor.apply($,arguments);if(V){var e=$.getPosition();T&&$.shiftPoints(e.x-N.x+Y,e.y-N.y+S)}return h||delete $._55I,X},shiftPoints:function(e,r,I){if(e||r||I){var c=this,P=c.getElevation()||0,X=c.toPoints(),S=new Vo;X.each(function(m){var K=m.e;I&&(K=(K==U?P:K)+I),S.add({x:m.x+e,y:m.y+r,e:K})}),c.setPoints(S),c.fs()}},shiftPointsElevation:function(w){return this.shiftPoints(0,0,w)},setPosition:function(P,G){var R,O=this;if(!O._28Q){if(O._28Q=1,!O._55I&&!Hc){R=2===arguments.length?{x:P,y:G}:P;var e=R.x-O._position.x,F=R.y-O._position.y;if(0===e&&0===F)return delete O._28Q,void 0;O._55I=1,O.shiftPoints(e,F),sh(O,[1,0,0,1,e,F]),delete O._55I}ys.superClass.setPosition.apply(O,arguments),delete O._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var i=this;if(2!==i._59O.size())return!1;var F=i._58O;return F?2===F.size()&&1===F.get(0)&&2===F.get(1)?!0:!1:!0},fireShapeChange:function(){var M=this;if(!M._55I&&!Hc){var E=Fq(M._59O);E&&(M._55I=1,M.setRect(E),delete M._55I)}M.fp(gs,!1,!0)},getSerializableProperties:function(){var R=ys.superClass.getSerializableProperties.call(this);return R.segments=1,R.points=1,R.thickness=1,R.closePath=1,R}});var jq=C.Points=function(){Zn(jq,this)};ub("Points",Hh,{_59O:[],_colors:[],_sizes:[],_uvoffsets:[],_22Q:function(){return Ws},getPoints:function(){return this._59O},setPoints:function(p){var u=this._59O;p=p?p.slice(0):[];var f=p[0];if(Bk(f)){var z=p;p=[];for(var t=0,D=z.length;D>t;t+=3)p.push({x:z[t],e:z[t+1],y:z[t+2]})}this._59O=p,this._pointsDirty=!0,this.fp("points",u,this._59O)},setPoint:function(_,u){var q=this._59O.slice(0);q[_]=u,this.setPoints(q)},addPoint:function(Q){this.setPoint(this._59O.length,Q)},getColors:function(){return this._colors},setColors:function(f){var V=this._colors;f=f?f.slice(0):[],this._colors=f,this._colorsDirty=!0,this.fp("colors",V,f)},setPointColor:function(X,_){var x=this._colors.slice(0);x[X]=_,this.setColors(x)},getSizes:function(){return this._sizes},setSizes:function(c){var k=this._sizes;c=c?c.slice(0):[],this._sizes=c,this._sizesDirty=!0,this.fp("sizes",k,this._sizes)},setPointSize:function(N,l){var u=this._sizes.slice(0);u[N]=l,this.setSizes(u)},getUvoffsets:function(){return this._uvoffsets},setUvoffsets:function(o){var Q=this._uvoffsets;o=o?o.slice(0):[],this._uvoffsets=o,this._offsetsDirty=!0,this.fp("uvoffsets",Q,this._uvoffsets)},setPointUvoffset:function(g,t,j){var G;"object"==typeof t?(G=t[0],j=t[1]):G=t;var C=this._uvoffsets.slice(0);C[2*g+0]=G,C[2*g+1]=j,this.setUvoffsets(C)},getPointInfo:function(V){var I=this.getPoints();if(!I||I[V]==U)return U;var w=I[V],m=[w.x,w.e,w.y],D=this.mat||Jl(this),C=[m[0],m[1],m[2]];lp(C,D);var N=this.getColors(),X=N[V]||this.s("points.color"),o=this.getSizes(),S=o[V];return{size:S==U?this.s("points.size"):S,color:X,local:m,world:C}},getSerializableProperties:function(){var Y=jq.superClass.getSerializableProperties.call(this);return Y.points=1,Y.colors=1,Y.sizes=1,Y.uvoffsets=1,Y},onPropertyChanged:function(U){jq.superClass.onPropertyChanged.call(this,U);var B=U.property;"s:points.color"===B?this._colorsDirty=!0:"s:points.size"===B?this._sizesDirty=!0:"s:points.model"===B&&(this._modelDirty=!0)},getWidth:function(){var O=this;if(O._width>=0)return O._width;var p=O.getStyle("points.model");if(p){var B=cm(p);if(B&&B.rawS3)return B.rawS3[0]}return 1},getHeight:function(){var W=this;if(W._height>=0)return W._height;var P=W.getStyle("points.model");if(P){var U=cm(P);if(U&&U.rawS3)return U.rawS3[2]}return 1},getTall:function(){var q=this;if(q._tall>=0)return q._tall;var B=q.getStyle("points.model");if(B){var b=cm(B);if(b&&b.rawS3)return b.rawS3[1]}return 1}});var fl=C.Polyline=function(){Zn(fl,this),this.s({"shape.background":null,"shape.border.width":2})};ub("Polyline",ys,{_icon:"polyline_icon",_22Q:function(){return Zs},getUIClass:function(){return ds},setClosePath:function(){},setTall:function(V){var _=this,o=_.getDataModel();if(o&&o.beginTransaction(),!_._55I&&!_._24Q&&!Hc&&_.getTall()){_._24Q=1;var M=_._54O,y=V/_.getTall();if(1!==y){var k=_.toPoints(),B=new Vo;k.each(function(e){B.add({x:e.x,y:e.y,e:e.e==U?e.e:(e.e-M)*y+M})}),_.setPoints(B),_.fs()}delete _._24Q}fl.superClass.setTall.call(_,V),o&&o.endTransaction()},setElevation:function(V){var U=this,$=U.getDataModel();if($&&$.beginTransaction(),!U._55I&&!U._24Q&&!Hc){U._24Q=1;var s=V-U._54O;0!==s&&U.shiftPointsElevation(s),delete U._24Q}fl.superClass.setElevation.apply(U,arguments),$&&$.endTransaction()},fireShapeChange:function(){var s=this,g=s._59O;if(!s._55I&&!s._24Q&&!Hc){var b=g.size();if(b){var n=1,_=g.get(0),P=s._54O;_.e==U&&(_.e=P);for(var I=_.e,M=0;b>n;n++){_=g.get(n),_.e==U&&(_.e=P);var L=x(I,_.e),i=B(I+M,_.e);I=L,M=i-L}s._24Q=1,s.setTall(M),s.setElevation(I+M*s._anchorElevation),delete s._24Q}}fl.superClass.fireShapeChange.apply(s,arguments)}});var aj=C.SubGraph=function(){Zn(aj,this)};ub("SubGraph",Hh,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){aj.superClass._8I.call(this),this.eachChild(function(U){Je(U)&&U._8I()})}}),G.loadingRefGraph=0;var qn=C.RefGraph=function(){Zn(qn,this)};ub("RefGraph",af,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(x){var j=this._ref;this._ref=x,this.fp("ref",j,x),this.updateRef()},_21I:function(){qn.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var f=this;if(G.loadingRefGraph++,f.clearChildrenFromDataModel(),G.loadingRefGraph--,f._ref&&f._dataModel){f._xhrLoadHandler&&(f._xhrLoadHandler.cancel=!0);var Y=Hc,b=f._xhrLoadHandler=function(X){if(X&&f._dataModel){G.loadingRefGraph++;var g=f._pendingUpdateInfo={needToRestore:Y};Y&&(g.p3=f.p3(),g.s3=f.s3(),g.r3=f.r3(),g.anchor3d=f.getAnchor3d(),g.scale3d=f.getScale3d()),f.r3(0,0,0),f.setScale3d(1,1,1),f.setAnchor3d(.5,.5,.5),f.p3(0,0,0);var U=G.parse(X),M=f._dataModel.deserialize(U,f,{justDatas:!0});M.each(function(r){r._refGraph=f}),f.checkPendingUpdateInfo(),G.loadingRefGraph--,G.handleRefGraphLoaded(f,M,U)}};b.xhrLoadCalled=!1,G.load(f._ref,function(_){b.cancel||(b.xhrLoadCalled?b(_):xk(function(){b(_)}))}),b.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var x=this,e=x._pendingUpdateInfo;if(!e)return x.onPendingUpdated&&(G.loadingRefGraph++,x.onPendingUpdated(),G.loadingRefGraph--),void 0;var U=!0;this.eachChild(function(n){(n._pendingCheckImageJSON||n._pendingUpdateInfo)&&(U=!1)}),U&&(G.loadingRefGraph++,x._pendingUpdateInfo=null,x.updateFromChildren(),e.needToRestore&&(x.setAnchor3d(e.anchor3d),x.setScale3d(e.scale3d),x.r3(e.r3),x.p3(e.p3)),this.getParent()instanceof qn&&this.getParent().checkPendingUpdateInfo(),x.onPendingUpdated&&x.onPendingUpdated(),G.loadingRefGraph--)},getSerializableProperties:function(){var s=qn.superClass.getSerializableProperties.call(this);return s.ref=1,s}}),C.EdgeGroup=function(v,A){this._70O=v,this._siblings=A;for(var y,K,u=0,g=v.size(),s=Y[tn];g>u;u++)if(y=v.get(u).getStyle(tn,!1),y!=U){s=y;break}s==U&&(s=!0);var T=G.edgeGroupAgentFunc;for(T&&(K=T(v),K&&K!==v.get(0)&&(v.remove(K),v.add(K,0))),u=0;g>u;u++)v.get(u).s(tn,s)},ub("EdgeGroup",g,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(e){return this._70O.get(e)},indexOf:function(O){return this._70O.indexOf(O)},each:function(_,r){this._70O.each(_,r)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(X,L){this._siblings.each(function(V){V._70O.each(X,L)})}});var Hd=function(e,H,h){var q=$n[e]={type:e,action:H};if(h)for(var K in h)q[K]=h[K]};hn(G,{setConnectAction:Hd,getConnectAction:function(l,n){if(!n){if(!l)return null;n=l.getCurrentConnectActionType()}return $n[n]},doConnectAction:function(t,V,m,O){O=O||t.getCurrentConnectActionType();var Y=$n[O];if(!Y)return!1;var x=Y.action;return x?(V instanceof Uj.Group?t.sm().getSelection().each(function(N){x.call(null,t,N,m)}):x.call(null,t,V,m),!0):!1},doDeleteConnectionAction:function(z,l,x){x=x||z.getCurrentConnectActionType();var A=$n[x];if(!A||!A.delete)return!1;var Z=A.delete.action;return Z?(l instanceof Uj.Group?z.sm().getSelection().each(function(F){Z.call(null,z,F)}):Z.call(null,z,l),!0):!1}});var Fn=C.JSONSerializer=function(I,D){this.dm=this._dataModel=I,this._hierarchical=G.forceHierarchicalSerialization?!0:D==U?I.isHierarchicalRendering():D};ub("JSONSerializer",g,{ms_ac:["hierarchical"],serialize:function(N){return G.stringify(this.toJSON(),N)},toJSON:function(){var s,t=this,T=t.dm,F=T.getRoots(),d=t.json={v:G.getVersion(),p:{},a:{},d:[]},o=T.getSerializableAttrs();(s=T.getInit())&&(d.init=s),(s=T.getName())&&(d.p.name=s),(s=T.getBackground())&&(d.p.background=s),(s=T.getLayers())&&(d.p.layers=s),(s=T.getEnvmap())&&(d.p.envmap=s),(s=T.getEnvmapType())&&(d.p.envmapType=s),d.p.autoAdjustIndex=T.isAutoAdjustIndex(),d.p.hierarchicalRendering=T.isHierarchicalRendering();for(var W in o){var u=T.a(W);u!==c&&t[gc](W,u,d.a)}return bi(d.a)&&delete d.a,t._hierarchical?F.each(t.serializeData,this):T.each(function(u){t.serializeData(u)}),T.fireSerializeEvent({type:"serialize",json:d}),T.getPostProcessingData()&&(d.p.postProcessingData=T.getPostProcessingData()),d},isSerializable:function(){return!0},getProperties:function(V){return V.getSerializableProperties()},getStyles:function(M){return M.getSerializableStyles()},getAttrs:function(c){return c.getSerializableAttrs()},serializeData:function(W){var e=this;if(e.isSerializable(W)&&!W._refGraph){var N,Q,$,x,G=Ef(W.getClassName())||W.getClass(),K=new G,l={c:W.getClassName(),i:W.getId(),p:{},s:{},a:{}};e.json.d.push(l),N=e.getProperties(W);for(Q in N)if(/^_/.test(Q)){if($=W[Q],!("_width"!==Q&&"_height"!==Q||$!=U&&-1!==$)){var P;((W.s("layout.h")||W.s("layout.v"))&&W.getHost()||W instanceof C.Node&&(P=W.getParent())&&P instanceof C.Block||W.s("fullscreen"))&&($=W[Q]="_width"===Q?W.getWidth():W.getHeight())}$!==K[Q]&&e[gc](Q.substr(1),$,l.p)}else x=rs(Q),W[x]&&($=W[x](),$!==K[x]()&&e[gc](Q,$,l.p));N=e.getStyles(W);for(Q in N)$=W.s(Q),$!==K.s(Q)&&e[gc](Q,$,l.s);N=e.getAttrs(W);for(Q in N)$=W.a(Q),$!==K.a(Q)&&e[gc](Q,$,l.a);bi(l.p)&&delete l.p,bi(l.s)&&delete l.s,bi(l.a)&&delete l.a}e._hierarchical&&W.getChildren().each(e.serializeData,e)},serializeValue:function(i,u,v){gg(u)?u={__a:u._as}:u instanceof Cb?u={__i:u.getId()}:u instanceof sm&&(u={__dm:u.serialize(0)}),v[i]=u},deserialize:function(F,Y,H){var s=this;return ak(F)&&/.json$/.test(F)?(G.xhrLoad(F,function(X){s.deserializeImpl(X,Y,H)}),void 0):s.deserializeImpl(F,Y,H)},deserializeImpl:function(L,l,N){var s=this,z=s.dm;z.setDeserializing(!0),N=Nj(N)?{setId:N}:kk(N)?{finishFunc:N}:N||{},L=s.json=ak(L)?G.parse(L):L,!N.justDatas&&L.a&&L.a.onPreDeserialize&&!N.disableOnPreDeserialize&&L.a.onPreDeserialize(L,z,N.view),z.beginTransaction(),Hc++,s._82I={};var u=new Vo,M=new Vo,F=0,e=L.d.length;if(N.justDatas||(!N.disableInit&&kk(L.init)&&L.init(z),z.setInit(L.init)),!N.justDatas){for(var q in L.a)z.a(q,s[Yg](L.a[q]));for(var Q in L.p)z[Iq(Q)](L.p[Q])}for(;e>F;F++){var J=L.d[F],E=Ef(J.c),A=new E,K=J.i;N.setId&&K!=U&&(A._id=K),s._82I[K]=A,u.add(A),M.add(J)}for(F=0;e>F;F++)s.deserializeData(u.get(F),M.get(F));return u.each(function($){l&&!$.getParent()&&$.setParent(l),z.add($)}),N.__innerHandler__&&N.__innerHandler__(L,z,N.view,u),z.fireSerializeEvent({type:"deserialize",json:L}),Hc--,z.endTransaction(),!N.justDatas&&L.a&&L.a.onPostDeserialize&&!N.disableOnPostDeserialize&&L.a.onPostDeserialize(L,z,N.view,u),N.finishFunc&&N.finishFunc(L,z,N.view,u),z.setDeserializing(!1),u},deserializeData:function(a,d){for(var o in d.p)a[Iq(o)](this[Yg](d.p[o]));for(o in d.s)a.s(o,this[Yg](d.s[o]));for(o in d.a)a.a(o,this[Yg](d.a[o]))},deserializeValue:function(B){if(jb(B)){var D=B.__i;if(D!=U)return this._82I[D];if(D=B.__dm,D!=U){var t=new C.DataModel;return t.deserialize(D),t}if(D=B.__a,zo(D))return new Vo(D)}return B}}),hn(sm,{serialize:function(d,l){return new Fn(this,l).serialize(d)},toJSON:function(l){return new Fn(this,l).toJSON()},deserialize:function(v,z,u){return new Fn(this).deserialize(v,z,u)}});var El=C.OverlappingBox=function(t){this.gv=t,this.boxes={}};ub("OverlappingBox",g,{clear:function(){var o,M,Y=this.boxes;for(o in Y)M=Y[o],M.length=0},isOverlapping:function(Z,j){var a,P,T=this,t=T.boxes,E=t[Z];E?(a=E.rects,P=E.length):E=t[Z]={rects:a=[],length:P=0};var M,S,j;for(M=0;P>M;M++)if(S=a[M],S.x<j.x+j.w&&S.x+S.w>j.x&&S.y<j.y+j.h&&S.h+S.y>j.y)return!0;return a.length<=P?(a.push(j),E.length++):a[E.length++]=j,!1}}),hn(G,{fetch:function(M,X){var x="GET",F=!1,L=null,b="";X&&(x=X.method||"GET",F=X.sync,b=X.url,L=X.data||null),M.open(x,b,!F),X.responseType?M.responseType=X.responseType:X.overrideMimeType&&M.overrideMimeType&&M.overrideMimeType(X.overrideMimeType),M.send(L)},convertImageSrc:function(r,q){q&&"function"==typeof q||(q=function(){}),q(r)}});var Wh=C.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};ub("Request",g,{_responseType:null,_overrideMimeType:"text/plain",send:function(k){var U=this._xhr,u=this.onload,i=this.onerror;this.getResponseType()?k.responseType=this.getResponseType():this.getOverrideMimeType()&&(k.overrideMimeType=this.getOverrideMimeType()),U.onload=u,U.onerror=i,G.fetch(U,k)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(K){this._responseType=K},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(H){this._overrideMimeType=H},getResponseText:function(){var L=this._xhr;return L.response||L.responseText}}),Ui.GraphView=function(i){var A=this;A._24I={},A._34I=new Vo,A.enableDirtyRect(),A._25I={},A._56I={},A._view=np(1,A),A._canvas=Nb(A._view),A.dm(i?i:new sm),this._coreInteractor=new Dm(this),A.setEditable(!1),A.setScrollBarVisible(G.graphViewScrollBarVisible),A._initView()},_n("GraphView",g,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Bm,uk,_m,ne,"resettable","editInteractor",oq,"zoomable","pannable","rectSelectable","autoScrollZone",Wm,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:G.graphViewZoomable,_resettable:G.graphViewResettable,_pannable:G.graphViewPannable,_rectSelectable:G.graphViewRectSelectable,_autoScrollZone:G.graphViewAutoScrollZone,_rectSelectBackground:G.graphViewRectSelectBackground,_rectSelectBorderColor:G.graphViewRectSelectBorderColor,_editPointSize:G.graphViewEditPointSize,_editPointBorderColor:G.graphViewEditPointBorderColor,_editPointBackground:G.graphViewEditPointBackground,_scrollBarColor:vi,_scrollBarSize:Ud,_autoHideScrollBar:gn,_autoMakeVisible:ud,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(S){this._dataModel.setLayers(S)},setEditable:function(V){var y=this,l=y.__interactorMap__;if(!l){var L=Ui.XEditInteractor;l=y.__interactorMap__={scrollBar:new _e(y),select:new wr(y),edit:L?new L(y):new Cd(y),text:new jc(y),move:new Hi(y),"default":new fd(y),touch:new rc(y,{editable:!1})}}V?(y._uieditable=!0,y.setInteractors([l.scrollBar,l.select,l.edit,l.text,l.move,l.default,l.touch])):(y._uieditable=!1,y.setInteractors([l.scrollBar,l.select,l.move,l.default,l.touch]))},getCanvas:function(){return this._canvas},_33I:function(y){var v=y.getUIClass();return v?new v(this,y):U},getDataUI:function(i){var R=this,x=R._25I[i._id];return x===c&&(x=R._33I(i),R._25I[i._id]=x),x},getNodeRect:function(u){return G.getNodeRect(this,u)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(Y){var z=this.getDataUI(Y);return z?(z._79o(),z._78o):null},getEdgeSourcePosition:function(W){var c=this,B=c.getDataUI(W),K=B.s,y=B._data._40I;return Kd(c,y,K("edge.source.position"),K("edge.source.offset.x"),K("edge.source.offset.y"),K("edge.source.anchor.x"),K("edge.source.anchor.y"))},getEdgeTargetPosition:function(b){var U=this,J=U.getDataUI(b),j=J.s,x=J._data._41I;return Kd(U,x,j("edge.target.position"),j("edge.target.offset.x"),j("edge.target.offset.y"),j("edge.target.anchor.x"),j("edge.target.anchor.y"))},invalidateAll:function(q){var W=this;if(q){for(var e in W._25I){var l=W._25I[e];l&&l.dispose()}W._25I={},W._56I={},W._24I={},W._34I.clear(),W.redraw()}else W.dm().each(function(k){W.invalidateData(k)})},invalidateSelection:function(){var l=this;l.sm().each(function(g){l.invalidateData(g)})},invalidateData:function(I){var q=this;q._24I[I._id]=I,q._21Q(I),q.iv()},_21Q:function(O){var o=this,j=o._24I;if(hq(O)&&Ko[O.s(Hk)]){var v=O.getSourceAgent();v&&v.getAgentEdges().each(function($){j[$._id]=$}),v=O.getTargetAgent(),v&&v.getAgentEdges().each(function(L){j[L._id]=L}),o.iv()}},redraw:function(_){var A=this;A._32I||(_?A._34I.add(_):(A._32I=1,A._34I.clear()),A.iv())},each:function(k,E){var i,G,O,D=0,j=this.getLayers(),m=this._dataModel,B=m._datas._as,V=B.length;if(j){for(var F=j.length;F>D;D++)if(O=j[D],jb(O)&&(O=O.name),m.isHierarchicalRendering()){var s=function(S){return S._layer===O?E?k.call(E,S):k(S):void 0};if(this._dataModel.eachByHierarchical(s)===!1)return}else for(var R=0;V>R;R++)if(i=B[R],i._layer===O&&(G=E?k.call(E,i):k(i),G===!1))return}else if(m.isHierarchicalRendering())this._dataModel.eachByHierarchical(k,null,E);else for(;V>D;D++)if(i=B[D],G=E?k.call(E,i):k(i),G===!1)return},reverseEach:function(R,D){var E,I,i,G,l=this._dataModel,p=l._layers,t=l._datas._as,n=t.length;if(p){for(E=p.length-1;E>=0;E--)if(G=p[E],jb(G)&&(G=G.name),l.isHierarchicalRendering()){var h=function(q){return q._layer===G?D?R.call(D,q):R(q):void 0};if(l.reverseEachByHierarchical(h)===!1)return}else for(var J=n-1;J>=0;J--)if(I=t[J],I._layer===G&&(i=D?R.call(D,I):R(I),i===!1))return}else if(l.isHierarchicalRendering())l.reverseEachByHierarchical(R,null,D);else for(E=n-1;E>=0;E--)if(I=t[E],i=D?R.call(D,I):R(I),i===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var b=this,P=b._84I;if(!P){var n=this.dm().a("width"),j=this.dm().a("height");n>0&&j>0?b._84I={x:0,y:0,width:n,height:j}:(b.each(function(_){b.isVisible(_)&&(P=Pj(P,b.getDataUIBounds(_)))}),b._84I=P?P:Ki)}return b._84I},getScrollRect:function(){return Pj(this.getContentRect(),this._29I)},makeCenter:function(L,c,i){var B=this;if(!B.getWidth()||!B.getHeight())return i||xk(B.makeCenter,B,[L,c,!0],500),void 0;B.makeVisible(L),B.validate();var s=B.getDataUIBounds(L);if(s){var z=B.getWidth(),A=B.getHeight(),o=s.x+s.width/2,v=s.y+s.height/2,p=-o*B._zoom+z/2,S=-v*B._zoom+A/2;B.setTranslate(p,S,c)}},fitData:function($,B,D,Y,h){var t=this;if(!t.getWidth()||!t.getHeight())return h||xk(t.fitData,t,[$,B,D,Y,!0],500),void 0;var P=function(){t.makeVisible($),t.validate();var F=t.getDataUIBounds($);F&&(F=ns(F),sr(F,D==U?20:D),t.fitRect(F,B,Y))};B?G.callWhenLoaded(P):P()},fitContent:function(y,x,u,O){var n=this;if(!n.getWidth()||!n.getHeight())return O||xk(n.fitContent,n,[y,x,u,!0],500),void 0;var g=function(){n.validate();var d=ns(n.getContentRect());sr(d,x==U?20:x),n.fitRect(d,y,u)};y?G.callWhenLoaded(g):g()},fitRect:function(X,e,P){var v=this,G=v.getWidth(),g=v.getHeight(),A=X.x+X.width/2,W=X.y+X.height/2,a=x(G/X.width,g/X.height),I=v._zoom,O=-A*I+G/2,M=-W*I+g/2;0===a||isNaN(a)||(P&&(a=x(1,a)),e?(v._65I&&(delete v._65I.finishFunc,v._65I.stop(!0)),v._14o&&v._14o.stop(!0),v.setTranslate(O,M,{finishFunc:function(){v.setZoom(a,e)}})):(v.setTranslate(O,M),v.setZoom(a)))},fitSelection:function(E,B,F){var e=this,p=e.sm(),t=null;p.size()&&(p.each(function(O){t=Pj(e.getDataUIBounds(O),t)}),E&&sr(t,E),e.fitRect(t,B,F))},toCanvas:function(c,f,o){f=f||this._zoom,this.validateImpl();var t=this,H=t.getContentRect();o&&sr(H,o),H.width||(H.width=10),H.height||(H.height=10);var V=Nb(),K=H.x*f,u=H.y*f,l=Math.ceil(H.width*f),i=Math.ceil(H.height*f);cs(V,l,i,1);var m=Rg(V);c=c||this._dataModel.getBackground(),c&&om(m,0,0,l,i,c),Xg(m,-K,-u),m.scale(f,f);var N=this._zoom;return this._zoom=f,t._42(m),this._zoom=N,m.restore(),V},toDataURL:function(H,S,i,a){return this.toCanvas(H,i,a).toDataURL(S||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(F,R){var X=this,k=X.dm().getBackground();if(k){var a=X.dm().a("width"),m=X.dm().a("height");a>0&&m>0&&om(F,0,0,a,m,k)}var z=X.__htmlOrderList,g=[],l=X._forcedLayoutHTML;if(X._93db(F,R),X.each(function(M){var T=X.getDataUI(M);if(T){var P=X._56I[M._id],y=T._htmlView;if(P){var v=T._79o();if(y=T._htmlView,C.HtmlNode&&M instanceof C.HtmlNode)T._42(F);else{var O=X.getViewRect(),$=y&&y.layoutHTML;!R||$f(R,v)?($&&(y.layoutHTML(),T.__outerLayout&&delete T.__outerLayout),T._42(F)):$f(O,v)||!$||T.__outerLayout&&!l||(y.layoutHTML(),T.__outerLayout=!0)}}y&&(g.push(y),y.getView&&(y=y.getView()),y.style.display=P?"block":Jj)}}),z&&g.length>0){var Z=!1;if(z.length!==g.length)Z=!0;else for(var x=0;x<g.length;x++)if(g[x]!==z[x]){Z=!0;break}Z&&(g.forEach(function(N){N.autoAdjustIndex!==!1&&X.appendHTML(N,!0)}),this.__htmlOrderList=g)}else this.__htmlOrderList=g;X._92db(F,R)},disableDirtyRect:function(){this._shouldRedrawAll=E},enableDirtyRect:function(){var m=this;m._shouldRedrawAll=function(){return m._32I}},validateImpl:function(){this.tryUpdateRootData();var f,L,E,K,o,Z=this,a=Z.tx(),W=Z.ty(),l=Z._zoom,k=Z._canvas,P=this.getWidth(),h=this.getHeight(),J=Z._29I,q={x:-a/l,y:-W/l,width:P/l,height:h/l},s={},i=Z._34I,M=Z._24I,T=Z._shouldRedrawAll(),H=Z._23I;Z._24I={},(P!==k.clientWidth||h!==k.clientHeight)&&(cs(k,P,h),T=1,Z._forcedLayoutHTML=1),T||Gn(q,J)||(T=1,Z._forcedLayoutHTML=1),Z._29I=q,Z.each(function(I){L=I._id;var q=s[L]=Z.isVisible(I);q!==Z._56I[L]&&(M[L]=I,E=Z.getDataUI(M[L]),E&&E._84o(q),Z._84o(I,q))},Z);for(L in M)E=Z.getDataUI(M[L]),E&&(!T&&Z._56I[L]&&(o=E._79o(),o&&i.add(o)),E.invalidate()),Z._83I=1;if(Z._56I=s,!T)for(L in M)s[L]&&(E=Z.getDataUI(M[L]),E&&(o=E._79o(),o&&i.add(o)));if(T?K=q:(i.each(function(Q){$f(q,Q)&&(K=Pj(K,Q))}),K&&(sr(K,B(1,1/l)),K.x=A(K.x*l)/l,K.y=A(K.y*l)/l,K.width=Q(K.width*l)/l,K.height=Q(K.height*l)/l,K=Wp(q,K))),Z._74O=K,K&&0!==K.width&&0!==K.height){f=Rg(k);var w=K.x,R=K.y,g=K.width,X=K.height;w=Math.floor((w*l+a)*vm),R=Math.floor((R*l+W)*vm),g=Math.ceil(g*l*vm)+1,X=Math.ceil(X*l*vm)+1,T||(K.x=(w/vm-a)/l,K.y=(R/vm-W)/l,K.width=g/vm/l,K.height=X/vm/l),f.beginPath(),f.rect(w,R,g,X),f.clip(),f.clearRect(w,R,g,X),id(f,a,W,l),Z._42(f,K),f.restore(),delete Z._74O}if(i.clear(),delete Z._32I,delete Z._forcedLayoutHTML,H&&P>0&&h>0){var E=Z.getDataUI(H);if(E){var o=E._79o(),v=Z._29I,$=v.x,u=v.y,U=v.width,x=v.height,l=Z._zoom;o&&!$f(o,v)&&(o.x+o.width<$&&Z.tx(-o.x*l),o.x>$+U&&Z.tx(-(o.x+o.width-U)*l),o.y+o.height<u&&Z.ty(-o.y*l),o.y>u+x&&Z.ty(-(o.y+o.height-x)*l))}delete Z._23I}Z._83I&&(delete Z._83I,delete Z._84I),Z._98O(),Z.countFrame(),bi(Z._24I)||xk(Z.iv,Z)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var z,R=this.getFullscreenDatas();for(var N in R)z=R[N],this.scaleRootData(z);this.onRootDataUpdated&&this.onRootDataUpdated(),this._rootDataUpdating=!1}},scaleRootData:function(z){var C=z.s("fullscreen");if("uniform"===C||"fill"===C){z.getRotation()&&z.setRotation(0);var G=z.s("fullscreen.gap")||0,k=this.getWidth(),E=this.getHeight();if(k&&E){var D,V,H,U=k-2*G,m=E-2*G,g=z.getAnchor(),i=z.getScaledSize(),$=i.width,T=i.height,M=z.s("fullscreen.lock");if(M)return"uniform"===C?U/m>$/T?(D=m/T,$=T*U/m):(D=U/$,T=$*m/U):"v"===M?(D=m/T,$=U/D,z.getWidth()!==$&&z.setWidth($)):(D=U/$,T=m/D,z.getHeight()!==T&&z.setHeight(T)),this.setZoom(D),V=G-(z.getX()-g.x*$)*D,H=G-(z.getY()-g.y*T)*D,V!==this.tx()&&this.tx(V),H!==this.ty()&&this.ty(H),void 0;V=this.tx(),H=this.ty(),D=this._zoom;var p={x:(-V+G)/D,y:(-H+G)/D,width:U/D,height:m/D};if("uniform"===C){var q=$/T,I=Math.min(p.width,p.height*q),O=I/q;p.x+=.5*(p.width-I),p.y+=.5*(p.height-O),p.width=I,p.height=O}U=p.width/z.getScaleX(),m=p.height/z.getScaleY(),(z.getWidth()!=U||z.getHeight()!==m)&&z.setSize(U,m);var J=p.x+g.x*p.width,d=p.y+g.y*p.height,o=z.getPosition();(J!==o.x||d!==o.y)&&z.setPosition(J,d)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(t){var w=this;t!==w.isScrollBarVisible()&&(t?(zp(w._view,w._79O=qg()),zp(w._79O,w._27I=qg()),zp(w._79O,w._28I=qg())):(Oi(w._79O),delete w._79O,delete w._27I,delete w._28I),w.fp("scrollBarVisible",!t,t))},getDebugTip:function(){return""},showScrollBar:function(){var l=this;l._79O&&(l._85I||(xq(function(){l._86I()},dh),l.iv()),l._85I=new Date)},_86I:function(){var g=this;if(g._85I){var I=new Date,V=I.getTime();V-g._85I.getTime()>=dh?(delete g._85I,g.iv()):xq(function(){g._86I()},dh)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var o=this,J=this._27I,z=this._28I;if(o._79O){if(o._autoHideScrollBar&&!o._85I)return J.style.visibility=Mc,z.style.visibility=Mc,void 0;var C=o.getScrollBarColor(),t=o._zoom,I=o.getScrollBarSize(),c=o.getViewRect(),g=o.getScrollRect(),j=c.height*t,X=g.height*t,Q=c.width*t-I-2,Y=j*((c.y-g.y)*t/X),v=j*(j/X),Z=J.style;X-.5>j?(Cs>v&&(Y=Y+v/2-Cs/2,0>Y&&(Y=0),Y+Cs>j&&(Y=j-Cs),v=Cs),Gq(J,Q,Y,I,v),Z.visibility=Uk,Z.background=C,Z.borderRadius=I/2+Cm):Z.visibility=Mc;var u=c.width*t,S=g.width*t,Y=c.height*t-I-2,Q=u*((c.x-g.x)*t/S),T=u*(u/S),Z=z.style;S-.5>u?(Cs>T&&(Q=Q+T/2-Cs/2,0>Q&&(Q=0),Q+Cs>u&&(Q=u-Cs),T=Cs),Gq(z,Q,Y,T,I),Z.visibility=Uk,Z.background=C,Z.borderRadius=I/2+Cm):Z.visibility=Mc}},setDataModel:function(h){var K=this,o=K._dataModel,X=K._selectionModel;o!==h&&(o&&(o.ump(K.handleDataModelPropertyChange,K),o.umm(K.handleDataModelChange,K),o.umd(K.handleDataPropertyChange,K),o.removeIndexChangeListener(K._75O,K),o.removeHierarchyChangeListener(K.handleHierarchyChange,K),X||o.sm().ums(K.handleSelectionChange,K)),K._dataModel=h,h.mp(K.handleDataModelPropertyChange,K),h.mm(K.handleDataModelChange,K),h.md(K.handleDataPropertyChange,K),h.addIndexChangeListener(K._75O,K),h.addHierarchyChangeListener(K.handleHierarchyChange,K),X?X._21I(h):h.sm().ms(K.handleSelectionChange,K),K.invalidateAll(!0),K.fp(ln,o,h),K.updateBackground())},getLayersInfo:function(){if(this._layersInfo===c){var R=this.getLayers();R?(this._layersInfo={},R.forEach(function(N){var X=jb(N)?N.name:N;this._layersInfo[X]=N},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(h,W,g){var k,H,d=this,e=d.getDataUI(h),J=Xf(e),Q=hi(W,function(I){return $g(J,100*I)},100,.001),Z=$g(J,100*Q);if(!g){var Y=Td(e),t=new jm(Z.x,Z.y),$=49/(d._zoom*d._zoom);for(k=0,H=Y.length;H>k;k++)if(t.distanceToSquared(Y[k])<$)return{index:k,point:Y[k],distance:Math.sqrt((Y[k].x-W.x)*(Y[k].x-W.x)+(Y[k].y-W.y)*(Y[k].y-W.y))}
}return{percent:Q,point:Z,distance:Math.sqrt((Z.x-W.x)*(Z.x-W.x)+(Z.y-W.y)*(Z.y-W.y))}},calculateAttachPoint:function(){var H=new jm,J=new jm,a=new jm;return function(_,u){var W=this.getAttachPoints(_);if(!W||!W.length)return null;a.set(u.x,u.y);for(var n,c,E,x,p,P=1/0,N=0,i=W.length;i>N;N++)E=W[N],J.x=E.x,J.y=E.y,H.x=E.offsetX||0,H.y=E.offsetY||0,x=Kd(this,_,0,H.x,H.y,J.x,J.y),c=a.distanceToSquared(x),P>c&&(n=N,P=c,p=x);P=Math.sqrt(P);var b=this.getAttachStyle(_);if("close"===b){var d=_.s("attach.close.threshold")/this._zoom;if(P>d)return null}return{index:n,distance:P,info:W[n],point:p}}}(),getAttachPoints:function(C){var v=C.s("attach.points");if(v)return v;var N=Kj(C._image);return N?zi(N.attachPoints,C,this)||null:void 0},getAttachStyle:function(s){var f=s.s("attach.style");if(f)return f;var t=Kj(s._image);return t?zi(t.attachStyle,s,this)||"close":void 0},updateLayers:function(){this._layersInfo=c,this.invalidateSelection(),this.redraw()},updateBackground:function(){var l=this.dm().a("width"),z=this.dm().a("height");this._canvas.style.background=l>0&&z>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(i){if("background"===i.property){var A=this._canvas.style.background,W=i.newValue||"";this.updateBackground(),this.fp("canvasBackground",A,W),this.redraw()}else"a:width"===i.property||"a:height"===i.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===i.property?this.updateLayers():"hierarchicalRendering"===i.property&&this.redraw()},handleDataPropertyChange:function(q){this.dm().isHierarchicalRendering()&&"parent"===q.property&&q.data.hasChildren()&&this.redraw(),this.invalidateData(q.data)},onPropertyChanged:function($){var g=this,q=$.property;if(g.redraw(),"zoom"===q){var M=g.sm().getSelection();M.size()&&M.each(function(h){h.invalidate()})}else"dataModel"===q&&(g._83I=1);bp[q]?g.showScrollBar():q===oq&&g.onCurrentSubGraphChanged($)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(K){var I=this,B=K.kind,P=K.data;if(I._83I=1,"add"===B)I.invalidateData(P),hq(P)&&P.getEdgeGroup()&&P.getEdgeGroup().eachSiblingEdge(I.invalidateData,I),P.getHost&&P.getHost()&&P.getHost().updateLayoutAttaches();else if(B===Db){I._21Q(P);var T=P._id,w=I._25I[T];if(w){if(I._56I[T]){var C=w._79o();C&&I.redraw(C)}w.dispose(),delete I._25I[T],delete I._24I[T],delete I._56I[T]}P===I._currentSubGraph&&I.setCurrentSubGraph(U)}else B===ke&&(I.invalidateAll(!0),I.setCurrentSubGraph(U))},_75O:function(R){this.invalidateData(R.data)},handleHierarchyChange:function(U){this.dm().isHierarchicalRendering()&&U.data.hasChildren()&&this.redraw(),this.invalidateData(U.data)},adjustIndex:function(B){var v=this;if(v.isVisible(B)){v.dm().beginTransaction();for(var Z=B;Z._parent&&v.isVisible(Z._parent);)Z=Z._parent;Z&&Z!==B&&v._dataModel.adjustIndex(Z),v._dataModel.adjustIndex(B),v.dm().endTransaction()}},getImage:function(L){return L.getImage?L.getImage():c},getSelectWidth:function(r){var C=Kj(this.getImage(r));return C&&zi(C.disableSelectedBorder,r,this)?0:r.s("select.width")},getSelectColor:function(g){return g.s("select.color")},isSelectable:function(_,r){if(this.isSelected(_))return!0;if(!r&&_.getParent()instanceof af&&this.isSelectable(_.getParent(),!0)&&_.getParent().isSyncSize())return!1;var O=this.getLayersInfo();if(O){var s=O[_._layer];if(s&&s.selectable===!1)return!1}return _.s("2d.selectable")&&this.sm().isSelectable(_)},isMovable:function(t){var j=this;if(hq(t)&&t.getStyle(Hk)!==vn)return!1;var o=this.getLayersInfo();if(o){var n=o[t._layer];if(n&&n.movable===!1)return!1}return t.s("2d.movable")?j._movableFunc?j._movableFunc(t):!0:!1},isEditable:function(E){var k=this;if(C._uiSerializing)return k._uieditable;if(!k._editInteractor||!k.isSelected(E))return!1;if(Di(E)){var T=k.getDataUI(E);if(!T||T._88I)return!1}if(hq(E)&&E.getStyle(Hk)!==vn)return!1;var h=this.getLayersInfo();if(h){var x=h[E._layer];if(x&&x.editable===!1)return!1}return E.s("2d.editable")?k._editableFunc?k._editableFunc(E):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(u){return Je(u)&&0!==u.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(u):!0},isRectEditable:function(o){return this._rectEditableFunc?this._rectEditableFunc(o):!0},isAnchorEditable:function(I){return this._anchorEditableFunc?this._anchorEditableFunc(I):!0},isRotationEditable:function(a){return a.setRotation&&a.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(a):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(N){var l=N.getAnchor(),F=N.getScale(),h=this._zoom,D=Sh(N.getRotation(),0,-N.getHeight()*F.y*l.y-(F.y<0?-1:1)*(jg?32:16)/h),O=N.p();return D.x+=O.x,D.y+=O.y,D},getLogicalPoint:function(V){var b=this;return Ag(V,b._canvas,b.tx(),b.ty(),b._zoom,b._zoom)},getScreenPoint:function(h,b){var e,v=this;return"object"==typeof h?h.x!==c?(e=h.x,b=h.y):(e=h[0],b=h[1]):e=h,sk(e,b,v._canvas,v.tx(),v.ty(),v._zoom,v._zoom)},getSelectedDataAt:function(V){var i=this;return this.getDataAt(V,function(g){return i.isSelected(g)})},getDataInfoAt:function(l,m,K){var x,C=this.lp(l),I=this.getDataAt(C,m,K);if(I){var s=this.getDataUI(I);x={data:I,ui:s,point:C};var e=s._38o;if(e){var O=e.icons;for(var k in O){var o=O[k],M=e.rects[k];if(M)for(var z=zi(o.names,I,this),j=z?z.length:0,F=M.rotation,y=j-1;y>=0;y--){var W=z[y],Y=M[y];if(Qn(Y,C,F))return x.part="icons",x.name=k,x.icon=W,x.rect=Y,x.index=y,x.rotation=F,x}}}if(this.isNoteVisible(I)){if(s.note2Info&&Qn(s.note2Info.clickRect,C,U,s.note2Info.scale))return x.part="note2",x;if(s.noteInfo&&Qn(s.noteInfo.clickRect,C,U,s.noteInfo.scale))return x.part="note",x}if(this.isLabelVisible(I)){if(s.label2Info&&Qn(s.label2Info.rect,C,s.label2Info.rotation,s.label2Info.scale))return x.part="label2",x;if(s.labelInfo&&Qn(s.labelInfo.rect,C,s.labelInfo.rotation,s.labelInfo.scale))return x.part="label",x}if(I.isInRect&&I.isInRect(C))return x.part="body",x}return x},getDataAt:function(l,M,w){l.target&&(l=this.lp(l));var t,j=this._zoom;return this.reverseEach(function(J){return(M?M(J):this.isSelectable(J))&&this.rectIntersects(J,Yn(l.x,l.y,w,j))?(t=J,!1):void 0},this),t},getIconInfoAt:function(w,e){var u=this;if(w.target&&(w=u.lp(w)),e||(e=u.getDataAt(w)),e){var j=u.getDataUI(e);if(j&&j._38o){var r,M=j._38o,b=new Vo;for(r in M.icons)b.add(r);for(var V=b.size()-1;V>=0;V--){r=b.get(V);for(var a=M.rects[r],$=a.rotation,S=a.length-1;S>=0;S--){var I=a[S],A=I.width,O=I.height,c={x:w.x-I.x-A/2,y:w.y-I.y-O/2};$!=U&&(c=Sh(-$,c.x,c.y));var I={x:-A/2,y:-O/2,width:A,height:O};if(Qn(I,c))return{key:r,index:S,name:M.icons[r].names[S],rect:a[S],point:w,rotation:$,relativeRect:I,relativePoint:c,data:e}}}}}return U},getDatasInRect:function(I,z,s){s===c&&(s=1);var f=this,E=new Vo;return f.reverseEach(function(X){s&&!f.isSelectable(X)||(z?f.rectIntersects(X,I):f.rectContains(X,I))&&E.add(X)}),E},moveSelection:function(X,d){var N=this;N.dm().beginTransaction(),we(N.sm().toSelection(N.isMovable,N),X,d),N.dm().endTransaction()},moveDatas:function(S,b,_){var N=this;N.dm().beginTransaction(),S instanceof Vo||(S=new Vo(S)),we(S,b,_),N.dm().endTransaction()},getDataUIBounds:function(A){var o=this.getDataUI(A);return o?o._79o():U},drawData:function(W,M,K){var o=this.getDataUI(M);if(o){var k=o._79o();(!K||$f(K,k))&&(o._42(W),M instanceof C.Block&&M.eachChild(function(v){this.isVisible(v)&&this.drawData(W,v,K)},this))}},getBoundsForGroup:function(D){return D.s(mo)?this.getDataUIBounds(D):U},isPixelPerfect:function(J){return J.s("pixelPerfect")},rectIntersects:function(d,F){this.validate();var p=U;if(this._56I[d._id]){var f=this._25I[d._id];if(f){var v=f._79o();if(Hn(F,v))p=!0;else if((F=Wp(F,v))&&(f.rectIntersects&&(p=f.rectIntersects(F)),p==U)){if(!this.isPixelPerfect(d))return!0;var k=F.x,O=F.y,P=F.width,D=F.height,i=this._zoom,V=G.hitMaxArea,Y=P*D*i*i;if(Y>V){var g=Math.sqrt(V/Y);i*=g}P*=i,D*=i,2>P&&(P=2),2>D&&(D=2),k*=i,O*=i;var S=Qr(P,D);Xg(S,-k,-O),S.scale(i,i),this._drawForChecking=!0,this.drawData(S,d,F),this._drawForChecking=!1;try{for(var B=0,q=S.getImageData(0,0,P,D).data;B<q.length;B+=4)if(0!==q[B+3]){p=!0;break}S.restore()}catch(w){mj=U,p=!1}}}}return p?!0:!1},rectContains:function(v,j){if(this._56I[v._id]){var x=this._25I[v._id];if(x)return Hn(j,x._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(d){if(!G.isInput(d.target)){var h=this,v=h._focusData,F=v&&h._25I[v._id],M=0,Q=h._dataModel._datas;if(!(v&&v._enabled&&v._editable&&F&&F.onKeyDown&&F.onKeyDown(d)===!0))if(9===d.keyCode&&(v&&(M=Q.indexOf(v),zm(d)?-1===--M&&(M=0):++M===Q.size()&&(M=0)),h._focusData=v=Q.get(M),h.sm().setSelection(v)),Qb(d)?h.selectAll():Tr(d)&&h.isResettable()&&h.reset(),h.sm().isEmpty()){if(h._editing)return;var t=h.tx(),O=h.ty(),U=!1,a=zm()?100:10;Go(d)&&(t-=a,U=!0),uq(d)&&(O-=a,U=!0),ib(d)&&(t+=a,U=!0),Ok(d)&&(O+=a,U=!0),U&&h.setTranslate(t,O)}else{Nc(d)&&h.handleDelete(d);var c=zm()?10:1;Go(d)&&(h.moveSelection(-c,0),h.fi({kind:"moveLeft"})),uq(d)&&(h.moveSelection(0,-c),h.fi({kind:"moveUp"})),ib(d)&&(h.moveSelection(c,0),h.fi({kind:"moveRight"})),Ok(d)&&(h.moveSelection(0,c),h.fi({kind:"moveDown"}))}}},handleScroll:function(g,m){if(Uh(g),this.isZoomable()){if(!this.getEditInteractor()){var Z=this.getDataAt(g);if(Z){var T=Kj(this.getImage(Z));if(T&&zi(T.scrollable,Z,this))return}}var J=this.lp(g);m>0?this.scrollZoomIn(J):0>m&&this.scrollZoomOut(J)}},handlePinch:function(Z,K,C){this.isZoomable()&&(Math.abs(K-C)<G.pinchZoomThreshold||(K>C?this.pinchZoomIn(Z):this.pinchZoomOut(Z)))},checkDoubleClickOnNote:function(k,h){var U=this,d=U.lp(k),C=U.getDataUI(h),A=C.note2Info;return A&&h.s("note2.toggleable")&&Qn(A.clickRect,d)?(h.s(zf,!h.s(zf)),U.fi({kind:"toggleNote2",event:k,data:h}),!0):(A=C.noteInfo,A&&h.s("note.toggleable")&&Qn(A.clickRect,d)?(h.s(Ep,!h.s(Ep)),U.fi({kind:"toggleNote",event:k,data:h}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(_,d){var M=this,T=M.getAutoScrollZone(),L=T/M.getZoom(),p=T/4,D=M._29I,r=M.lp(_),x={x:M.tx(),y:M.ty()};return r&&T>0&&D&&(r.x-D.x<L?M.translate(p,0):D.x+D.width-r.x<L&&M.translate(-p,0),r.y-D.y<L?M.translate(0,p):D.y+D.height-r.y<L&&M.translate(0,-p)),x.x=M.tx()-x.x,x.y=M.ty()-x.y,d&&(d.x+=x.x,d.y+=x.y),x},getMoveMode:function(Y,C){var w=C.s("2d.move.mode");return w?w:Dk["88"]?"x":Dk["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(i,k,w){var P=this;return"currentSubGraph"===k?{__i:i.getId()}:w.serializeProperty(i,k,P)},deserializeProperty:function(H,f,I){var v=this;if("currentSubGraph"===f){var b=v.dm(),G=b.__idMap;return G[H.__i]}return I.deserializeProperty(H,f,v)},setDefaultCursor:function(g,l){this._defaultCursor=g,l!==!1&&this.setCursor(g)},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(F){return F===U||G.getConnectAction(null,F)?(this._currentActionType=F,this.redraw(),!0):!1},getEditStyle:function(X){var h=this.getEditInteractor();return h?h.getStyle(X):c},setEditStyle:function(Z,p,N){var Q=this.getEditInteractor();return Q?(Q.setStyle(Z,p,N),!0):!1},isConnectActionVisible:function(F){var u=G.getConnectAction(this);if(!u)return!1;var P=u.visible;return kk(P)&&(P=P(this,F)),P},isInteractive:function(H){if(this._drawForChecking)return!1;var l=Kj(this.getImage(H));return l&&zi(l.interactive,H,this)?!0:H.s("interactive")},getRenderingStyleIconName:function(){return yc},appendHTML:function(J,W){var L=this.getView();if(!(W||J&&J.parentNode!==L))return!1;var Z=J.getView&&J.getView(),F=J.beforeCanvas;if(!W&&Z&&Z.parentNode===L)return!1;(J.getView||J.isSelfViewEvent)&&(J=J.getView());var $=this.getEditInteractor();return F?L.insertBefore(J,this.getCanvas()):$&&$._canvas?L.insertBefore(J,$._canvas):this.isScrollBarVisible()?L.insertBefore(J,this.getView().lastChild):zp(L,J),!0},_layoutHTMLImpl:function(v,e,m){if(arguments.length>1){var c,w=this,G=w._zoom;if(e.getView&&(c=e,e=e.getView()),e.style.position="absolute",m){var M=v.getRect();Gq(c||e,w.tx()+M.x*G,w.ty()+M.y*G,M.width*G,M.height*G)}else{var h=new kp,M=v.getAnchorRect(),V=v.getPosition(),r=v.getScale(),i=e.style;Gq(c||e,M),h.appendTranslate(w.tx(),w.ty()),h.appendScale(G,G),h.append(new kp(v.getRotation(),V.x,V.y,r.x,r.y)),Mr(i,"transform","matrix("+h.a.toFixed(5)+", "+h.b.toFixed(5)+", "+h.c.toFixed(5)+",\n    "+h.d.toFixed(5)+", "+h.tx.toFixed(5)+", "+h.ty.toFixed(5)+")"),Mr(i,"transformOrigin",(-M.x).toFixed(5)+"px "+(-M.y).toFixed(5)+"px"),e.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(x){return x instanceof hc?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(J){var L="state",m=J.s(L);if(m)return m;var k=Kj(J._image);return k?zi(k[L],J,this)||null:void 0},getShape:function($){return $.getStyle(gs)}}),g.defineProperties(Ui.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(m){this._layoutHTML=m}}});var li=function(N,i){var G=this;G.gv=N,G.s=function(X){return i.getStyle(X)},G._data=i,G._87I=new Vo},yc=U;Bb(li,g,{_6I:U,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var X=this,y=X.gv.isSelected(X._data);return!y||X.isShadowed()?0:X.gv.getSelectWidth(X._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(Q){var f=this._data,H=this.gv.getBodyColor(f);return H?H:Q?f.getStyle(Q):U},_2Q:function(s){return this.s(s)},_1Q:function(B,N,e,F){var z=this.s,X=z("2d.gray"),I=z(N+".dash.color");if(X&&(I=G.toGrayColor(I)),B.strokeStyle=I,B.lineWidth=e,B.stroke(),z(N+".dash.3d")){var l=z(N+".dash.3d.color");_j(B,I,X?G.toGrayColor(l):l,e,this.gv._zoom,z(N+".dash.3d.accuracy"))}of(B,F)},invalidate:function(){this._6I=U},_79o:function(){var n=this;if(!n._6I){var Q=n._data,N=n.gv;n.labelInfo=n.label2Info=n.noteInfo=n.note2Info=n._38o=U,n._87I.clear(),n.interactiveInfo=N.isInteractive(Q)?{}:U,n._3O(),n._55O=N.isEditable(Q)?{_42O:N.isRectEditable(Q),_43O:N.isPointEditable(Q),_56O:N.isRotationEditable(Q)}:U,n._6I=n._81o()}return n._6I},_3O:function(){},getPosition:function(){return Ki},_68o:function(u,p){u&&this._87I.add(qe(u,p))},_81o:function(){var U=this,M=U.s;U._24O(Np,"getLabel"),U._24O(Kq,"getLabel2"),U._26O(oj,"getNote"),U._26O(ok,"getNote2"),U._15O(),U._55O&&U._48O();var c;if(U._87I.each(function(F){c=Pj(c,F)}),c&&M("shadow.interactable")){var f=U.isShadowed(),r=M("shadow2"),t=ns(c);r?(t.x+=M("shadow2.offset.x"),t.y+=M("shadow2.offset.y"),sr(t,M("shadow2.blur"))):f&&(t.x+=M("shadow.offset.x"),t.y+=M("shadow.offset.y"),sr(t,M("shadow.blur"))),c=Pj(c,t)}return U._87I.clear(),c},_42:function(k){var F=this,h=F._data,m=F.gv,c=F.s,i=c("opacity"),J=this.isShadowed(),x=c("shadow2");if(J||x){var e=k.shadowOffsetX,t=k.shadowOffsetY,y=k.shadowBlur,Y=k.shadowColor,X=m.getZoom()*G.devicePixelRatio,z=J?"shadow":"shadow2";k.shadowOffsetX=c(z+".offset.x")*X,k.shadowOffsetY=c(z+".offset.y")*X,k.shadowBlur=c(z+".blur")*X,k.shadowColor=J?F.getSelectColor():c(z+".color")}if(i!=U){var f=k.globalAlpha;k.globalAlpha=i}F._80o(k),m.isLabelVisible(h)&&((!m._drawForChecking||c("label.selectable"))&&hj(k,F.labelInfo),(!m._drawForChecking||c("label2.selectable"))&&hj(k,F.label2Info)),m.isNoteVisible(h)&&(gi(k,F.noteInfo),gi(k,F.note2Info)),F._99O(k),i!=U&&(k.globalAlpha=f),(J||x)&&(k.shadowOffsetX=e,k.shadowOffsetY=t,k.shadowBlur=y,k.shadowColor=Y)},_80o:function(){},_47O:function(){},_24O:function(n,B){var g=this,G=g._data,I=g.gv,O=g.s,m=I[B](G);if(m!=U){var W=O(n+".scale"),q=O(n+".max"),b=O(n+".position"),R=g[n+"Info"]={label:m,scale:W,color:I[B+"Color"](G),font:O(n+".font"),opacity:O(n+".opacity"),align:O(n+".align"),rotation:g.getRotation(O(n+".rotation"),!1,b),background:I[B+"Background"](G)},F=Ad(R,m);q>0&&q<F.width&&(R.labelWidth=F.width,F.width=q),1!==W&&(F.width*=W,F.height*=W);var M=g.getPosition(b,O(n+".offset.x"),O(n+".offset.y"),F,O(n+".position.fixed"));if(F.x=M.x-F.width/2,F.y=M.y-F.height/2,g._68o(R.rect=F,R.rotation),1!==W){var o=F.width/W,i=F.height/W;R.rect={x:M.x-o/2,y:M.y-i/2,width:o,height:i}}}},_26O:function(B,o){var Z=this,a=Z.gv,G=Z._data,y=Z.s,w=a[o](G);if(w!=U){var c,z,m=y(B+".scale"),n=Z[B+"Info"]={note:w,scale:m,data:G,view:a,expanded:y(B+".expanded"),font:y(B+".font"),color:y(B+".color"),opacity:y(B+".opacity"),align:y(B+".align"),icon:y(B+".icon"),backgroundImage:y(B+".backgroundImage"),borderWidth:y(B+".border.width"),borderColor:y(B+".border.color"),background:a[o+"Background"](G)},T=Z.getPosition(y(B+".position"),y(B+".offset.x"),y(B+".offset.y")),b=T.x,$=T.y;if(n.expanded){var i,M=y(B+".max"),v=y(B+".backgroundImage");v?(v=Kj(v),i={width:Zo(v,G),height:Ge(v,G)}):i=Ad(n,w),i.width+=6,i.height+=2,M>0&&M<i.width&&(n.labelWidth=i.width,i.width=M),c=i.width,z=i.height+8,n.clickRect={x:b-c*m/2,y:$-z*m,width:c*m,height:z*m*i.height/z}}else{var V=y(B+".icon");V?(V=Kj(V),c=Zo(V,G),z=Ge(V,G)):(c=12,z=18),n.clickRect={x:b-c*m/2,y:$-z*m,width:c*m,height:z*m}}n.rect={x:b-c/2,y:$-z*m/2-z/2,width:c,height:z};var C=Q(n.borderWidth/2)*m;Z._68o({x:b-c*m/2-C,y:$-z*m-C,width:c*m+2*C,height:z*m+2*C})}},_48O:function(){},_99O:function(M){var N=this,C=N._38o;if(C){var H=N.gv,E=N._data,f=C.icons,O=N.interactiveInfo;O&&(O._38o={});for(var V in f){var Y=f[V],A=C.rects[V];if(A){O&&(O._38o[V]=[]);var v=zi(Y.opacity,E,H),o=zi(Y.names,E,H),u=o?o.length:0,_=A.rotation;if(v!=U){var z=M.globalAlpha;M.globalAlpha*=v}for(var y=0;u>y;y++){var e=o[y],T=Kj(e),Z=A[y];if(_){var B=Z.x+Z.width/2,m=Z.y+Z.height/2;M.save(),Xg(M,B,m),tp(M,_),Xg(M,-B,-m)}O&&O._38o[V].push(M.interactiveInfo={compInfos:[],matrix:_?new kp(_,B,m).appendTranslate(-B,-m):new kp});var i=yc;yc=V,bl(M,T,zi(Y.stretch,E,H),Z.x,Z.y,Z.width,Z.height,N._data,N.gv),yc=i,M.interactiveInfo=U,_&&M.restore()}v!=U&&(M.globalAlpha=z)}}}}});var up=function(j,b){Zn(up,this,[j,b])};Bb(up,li,{_checkEmptyRect:!0,_40O:function(_,y){var M=this,z=M.s,f=_.rect;(_.borderColor=M.gv.getBorderColor(M._data))&&(_.borderType=z("border.type"),_.borderWidth=z("border.width"),_.borderPadding=z("border.padding"),y=B(y,_.borderPadding+_.borderWidth/2));var x=M._data.getScale(),G=B(1,B(k(x.x),k(x.y)));if(_.selectWidth=M.getSelectWidth()){var T=M.gv._zoom;_.selectType=z("select.type"),_._97o=M.getSelectColor(),_.selectPadding=z("select.padding"),y=B(y,(_.selectPadding+_.selectWidth/2/T)/G)}y>0&&(y*=G,f=ns(f),sr(f,y)),M._68o(f)},_39O:function(E,W){var O,D=this,t=W.rect;if(W.borderWidth>0&&(O=W.borderPadding,E.strokeStyle=W.borderColor,E.lineWidth=W.borderWidth,Vh(E,W.borderType,{x:t.x-O,y:t.y-O,width:t.width+2*O,height:t.height+2*O}),E.stroke()),W.selectWidth>0){var A=D.gv._zoom;if(O=W.selectPadding,E.strokeStyle=W._97o,E.lineWidth=W.selectWidth/A,W.rotation!=U){E.save(),E.translate(W.position.x,W.position.y),E.rotate(W.rotation);var H=D._data,$=H.getWidth(),l=H.getHeight(),j=W.scale,Y=W.anchor;t={x:j.x*-$*Y.x,y:j.y*-l*Y.y,width:j.x*$,height:j.y*l}}Vh(E,W.selectType,{x:t.x-O,y:t.y-O,width:t.width+2*O,height:t.height+2*O}),W.rotation!=U&&E.restore(),E.stroke()}},dispose:function(){var w=this,P=w._htmlView;up.superClass._3O.call(w),P&&(P.onHTMLRemoved&&P.onHTMLRemoved(),Oi(P))},_3O:function(){var P,D=this,z=D.s,Y=D._data,T=D.gv,n=T.getShape(Y),t=D.getBodyColor(),X=z("shape.border.color"),q=D._83o=n?{shape:n,_53o:D.getBodyColor("shape.background"),_27Q:Kj(z("shape.repeat.image"),t),shapeGradientPack:z("shape.gradient.pack"),shapeBorderGradientPack:z("shape.border.gradient.pack"),_54o:z("shape.border.width"),_55o:X,shapeBorderRepeatImage:Kj(z("shape.border.repeat.image"),X),_56o:z("shape.border.3d"),_57o:z("shape.border.3d.color"),_58o:z("shape.border.3d.accuracy"),shapeGradient:z("shape.gradient"),_59o:z("shape.gradient.color"),_60o:z("shape.border.pattern"),_61o:z("shape.border.cap"),_62o:z("shape.border.join"),shapeForeground:z("shape.foreground"),bodyColor:t,gray:z("2d.gray")}:{img:Kj(T.getImage(Y),t),bodyColor:t,gray:z("2d.gray"),stretch:z("image.stretch")},$=q.img;$&&$.renderHTML?(D._htmlInfo&&D._htmlInfo.img!==$&&(D._htmlInfo=U),D._htmlInfo||(D._htmlInfo={img:$,cache:{}}),P=$.renderHTML(Y,T,D._htmlInfo.cache)):D._htmlInfo=U,D._htmlView&&D._htmlView!==P&&(D._htmlView.onHTMLRemoved&&D._htmlView.onHTMLRemoved(),Oi(D._htmlView.getView?D._htmlView.getView():D._htmlView)),(D._htmlView=P)&&T.appendHTML(P)&&(P.onHTMLAddedSync&&P.onHTMLAddedSync(),P.onHTMLAdded&&xk(P.onHTMLAdded)),q.rect=Y.getRect(),q.position=Y.p(),q.scale=Y.getScale(),q.anchor=Y.getAnchor(),q.rotation=Y.getRotation(),n===co&&(q._63o=z("shape.depth"));var w=0;if(n)w=Fk(U,q._54o/2,q._62o),D.s("shape.dash")&&(w=B(w,(D.s("shape.dash.width")||q._54o)/2));else if($&&$.boundExtend)if(w=zi($.boundExtend,Y,T),$.boundExtendAbsolute){var y=Y.getScale();w/=T._zoom*B(1,B(k(y.x),k(y.y)))}else if(!zi($.fitSize,Y,T)){var b=zi($.width,Y,T),M=zi($.height,Y,T);w*=B(Y.getWidth()/b,Y.getHeight()/M)}D._40O(q,w);var f=Qe(Y,T.isSelected(Y)),F=z("clip.percentage");if(1>F&&(0>F&&(F=0),q.clipRect=rd(Y.getAnchorRect(),z("clip.direction"),F,f)),n){var H=z("shape.fill.clip.percentage");1>H&&(0>H&&(H=0),q.shapeClipRect=rd(Y.getAnchorRect(),z("shape.fill.clip.direction"),H,f));var h=z("shape.foreground.clip.percentage");1>h&&(0>h&&(h=0),q.shapeForegroundClipRect=rd(Y.getAnchorRect(),z("shape.foreground.clip.direction"),h,f))}},getPosition:function($,Z,a,v){var _=Ml($,this._83o.rect,v);return _.x+=Z,_.y+=a,_},_80o:function($){var e=this,F=e.s,z=e.gv,S=e._data,s=e._83o,V=s.rect,B=s.position,x=s.rotation,Y=s.anchor,j=s.scale,w=s.shape,O=s.clipRect;if(!e._checkEmptyRect||V.width>0&&V.height>0){var i=S.getSize();if(i.x=-i.width*Y.x,i.y=-i.height*Y.y,ah&&!le&&Xg($,i.width,i.height),$.save(),Xg($,B.x,B.y),tp($,x),Ze($,j.x,j.y),O&&($.beginPath(),$.rect(O.x,O.y,O.width,O.height),$.clip()),z._drawForChecking&&s.img&&zi(s.img.pixelPerfect,S,z)===!1)om($,i.x,i.y,i.width,i.height,"#888888");else if(e.freeDraw)e.freeDraw($,i,s);else if(w){var K,p,m,r,W=s._60o,L=rl($,W),Q=s._27Q,f=s._54o,u=s.shapeGradientPack,M=s.gray,y=$.lineJoin,P=$.lineCap,D=function(p){return M?G.toGrayColor(p):p};"roundRect"===w?K=F("shape.corner.radius"):"polygon"===w?K=F("shape.polygon.side"):"arc"===w&&(K=F("shape.arc.from"),p=F("shape.arc.to"),m=F("shape.arc.close"),r=F("shape.arc.oval")),$.lineJoin=s._62o,$.lineCap=s._61o;var q=D(s._53o);if(q||Q||u){var h=s.shapeClipRect;h&&($.save(),$.beginPath(),$.rect(h.x,h.y,h.width,h.height),$.clip()),Vh($,w,i,K,p,m,r),u?lh($,u,function(N){return ip(N,s.bodyColor)},!1,i):Q?jl($,Q,D(s.bodyColor),null,S,z):Jh($,q,s.shapeGradient,D(s._59o),i),$.fill(),u&&$.restore(),h&&$.restore(),$!==L&&Vh(L,w,i,K,p,m,r)}else Vh(L,w,i,K,p,m,r);var E=s.shapeForeground;if(E){$.save();var c=s.shapeForegroundClipRect;c&&($.beginPath(),$.rect(c.x,c.y,c.width,c.height),$.clip()),Vh($,w,i,K,p,m,r),Jh($,E,F("shape.foreground.gradient"),D(F("shape.foreground.gradient.color")),i),$.fill(),$.restore()}if(f>0){var Z=F("shape.border.width.absolute");Z&&($.save(),$.setTransform(1,0,0,1,0,0)),$.lineWidth=f;var H=D(s._55o),n=s.shapeBorderGradientPack;n?lh($,n,D,!0,i):s.shapeBorderRepeatImage?ks($,s.shapeBorderRepeatImage,H,null,S,z):$.strokeStyle=H,$.stroke(),n&&$.restore(),Z&&$.restore(),s._56o&&_j($,H,D(s._57o),f,z._zoom,s._58o)}if(of($,W),F("shape.dash")){var X=F("shape.dash.width")||f;if(X>0){W=F("shape.dash.pattern");var L=rl($,W,e._2Q("shape.dash.offset"));L!==$&&Vh(L,w,i,K,p,m,r),e._1Q($,"shape",X,W)}}ve($,q,s._63o,i),$.lineJoin=y,$.lineCap=P}else{var l=e.interactiveInfo;l&&($.interactiveInfo=l.bodyInfo={compInfos:[],matrix:new kp(x,B.x,B.y,j.x,j.y)}),s.gray&&($.compGray=!0);var o=s.img;o&&o.cacheRule!=U&&(o=yo($,o,s.stretch,i.width,i.height,S,z,s.bodyColor)),bl($,o,s.stretch,i.x,i.y,i.width,i.height,S,z,s.bodyColor),$.compGray=!1,$.interactiveInfo=U}$.restore()}e._39O($,s)},_48O:function(){},_47O:function(){}});var tr=function(F,u){Zn(tr,this,[F,u])},mb=function(O,R,h,F){var B=Sn(O,R);return h=F?x(h,B):xb(h,B),B?h/=B:h=0,{x:O.x+(R.x-O.x)*h,y:O.y+(R.y-O.y)*h}};Bb(tr,li,{_3O:function(){var x,N=this,d=N._data,A=N.gv,I=N.s,M=I(Hk),Q=d.isLooped(),f=I("edge.width"),i=N.getBodyColor("edge.color"),X=I("edge.center"),F=I("edge.offset"),C=A.getBorderColor(d),z=C?I("border.width"):0,o=N.getSelectWidth(),O=d._40I,Z=d._41I,t=N._78o=O&&Z?{looped:Q,type:M,width:f,center:X,color:i,repeatImage:Kj(I("edge.repeat.image"),i),borderColor:C,borderWidth:z,_97o:o?N.getSelectColor():U,selectWidth:o,pattern:I("edge.pattern"),cap:I("edge.cap"),join:I("edge.join"),is3d:I("edge.3d"),_67o:I("edge.3d.color"),_66o:I("edge.3d.accuracy"),gray:I("2d.gray")}:U;if(t){var T=G.getEdgeType(M);if(T){var D=T(d,ch(N,A,d,Q,M),A,N._19Q);D.points&&D.points.size()>1?(t.edgeTypeInfo=D,x=Fq(t.edgeTypeInfo.points)):D[Tg]&&D.rect&&(t.edgeTypeInfo=D,x=D.rect)}else{var n=I("edge.source.anchor.x"),e=I("edge.source.anchor.y"),w=I("edge.target.anchor.x"),$=I("edge.target.anchor.y"),s=xe(A,d,"source"),H=xe(A,d,"target");if(M===vn){var W=t.points=I(tg)||am,P=W.size();t.segments=I("edge.segments");var r=n!==c||e!==c||hq(O),_=w!==c||$!==c||hq(Z);if(!X)if(F)r||(s=mb(s,P?W.get(0):H,F,P)),_||(H=mb(H,P?W.get(P-1):s,F,P));else{var b;r||(b=wc(s,P?W.get(0):H,Zc(A,O)),b&&(s={x:b[0],y:b[1]})),_||(b=wc(P?W.get(P-1):s,H,Zc(A,Z)),b&&(H={x:b[0],y:b[1]}))}x=Pj(Fq(t.points),Fq(s,H))}else{var m=ch(N,A,d,Q,M);if(N._19Q||(m=-m),Q)s=ns(s),s.x=A.getNodeRect(O).x,t.radius=m,x={x:s.x-m,y:s.y-m,width:2*m,height:2*m};else{var p=Sn(s,H),l=xb(F,p),R={x:l,y:m},j={x:p-l,y:m},h=dj(H.y-s.y,H.x-s.x),u=t.mat=new Fh(h);if(t.orienAngle=h,t.angle=H.x<s.x?h+S:h,t.rect={x:R.x,y:R.y,width:j.x-R.x,height:0},t.origin=s,R=u.tf(R),R.x+=s.x,R.y+=s.y,j=u.tf(j),j.x+=s.x,j.y+=s.y,X){var g={x:p,y:0};g=u.tf(g),g.x+=s.x,g.y+=s.y,x=Fq([s,R,j,g]),t.c1=s,t.c2=g}else x=Fq(R,j);s=R,H=j}}t.sourcePoint=s,t.targetPoint=H,d._lastSourcePoint=s,d._lastTargetPoint=H}var Y=0;I("edge.dash")&&(Y=I("edge.dash.width")||f);var K="square"===t.cap?.71:.5;Fk(x,B(Y*K,f*K+z+o),t.join),N._68o(x)}},getRotation:function(v,W,f){v=v||0;var w=this._78o;if(w){var j,e=w.angle,C=w.points,r=w.edgeTypeInfo;if(e!=U)return W?w.orienAngle+v:e+v;if(r&&r[Tg])return r.getRotation?r.getRotation(this,v,W,f):0;if(r&&r.points){var u=r.points;return j=u.size(),fq[f]?j&&0===j%2?Rm(u.get(j/2-1),u.get(j/2),W,v):v:Uc[f]?Rm(u.get(0),u.get(1),W,v):Rm(u.get(j-2),u.get(j-1),W,v)}if(C)return j=C.size(),fq[f]?j&&0===j%2?Rm(C.get(j/2-1),C.get(j/2),W,v):v:Uc[f]?Rm(w.sourcePoint,j?C.get(0):w.targetPoint,W,v):Rm(j?C.get(j-1):w.sourcePoint,w.targetPoint,W,v)}return v},getPosition:function(b,j,E,W,Z){var t=this._78o;if(t){var v,C=t.type,w=t.points,x=t.edgeTypeInfo,r=t.sourcePoint,O=t.targetPoint;if(!C)return t.looped?{x:r.x-t.radius+j,y:r.y+E}:(Z&&r&&O&&(r.x>O.x||r.x===O.x&&r.y>O.y)&&(b=Wg[b],E=-E),v=Ml(b,t.rect,W),v.x+=j,v.y+=E,v=t.mat.tf(v),v.x+=t.origin.x,v.y+=t.origin.y,v);if(x&&x[Tg])return x.getPosition?x.getPosition(this,b,j,E,W,Z):{x:(r.x+O.x)/2,y:(r.y+O.y)/2};if(w){var v,A=w.size();if(fq[b]){if(A){var J=A%2;if(0===J)return Fo(w.get(A/2-1),w.get(A/2),b,j,E,W,Z);v=w.get((A-J)/2)}else v={x:(r.x+O.x)/2,y:(r.y+O.y)/2};return v=Ml(b,{x:v.x,y:v.y,width:0,height:0},W),v.x+=j,v.y+=E,v}return Uc[b]?Fo(r,A?w.get(0):O,b,j,E,W,Z):Fo(A?w.get(A-1):r,O,b,j,E,W,Z)}if(x){var u=x.points,A=u.size();if(fq[b]){var J=A%2;return 0===J?Fo(u.get(A/2-1),u.get(A/2),b,j,E,W,Z):(v=u.get((A-J)/2),v=Ml(b,{x:v.x,y:v.y,width:0,height:0},W),v.x+=j,v.y+=E,v)}return Uc[b]?Fo(u.get(0),u.get(1),b,j,E,W,Z):Fo(u.get(A-2),u.get(A-1),b,j,E,W,Z)}}return Ki},_42:function(v){this._78o&&tr.superClass._42.call(this,v)},drawPath:function(o,m){o.beginPath();var Q=m.type,e=m.points,D=m.segments,d=m.edgeTypeInfo;if(!Q||e){var h=m.sourcePoint,P=h.x,$=h.y,g=m.targetPoint,E=g.x,p=g.y;if(Q)if(D){var U=new Vo({x:P,y:$});U.addAll(e),U.add({x:E,y:p}),Xk(o,U,D)}else o.moveTo(P,$),e.each(function(v){o.lineTo(v.x,v.y)}),o.lineTo(E,p);else m.looped?o.arc(P,$,m.radius,0,t,!0):m.center?(o.moveTo(m.c1.x,m.c1.y),o.lineTo(P,$),o.lineTo(E,p),o.lineTo(m.c2.x,m.c2.y)):(o.moveTo(P,$),o.lineTo(E,p))}else d&&(d.points?Xk(o,d.points,d.segments):d[Tg]&&d[Tg](o,d))},_80o:function(B){var b=this,c=b.s,Q=b._78o,j=Q.width,P=Q.selectWidth,D=Q.borderWidth,e=Q.repeatImage,O=B.lineJoin,N=B.lineCap,L=Q.gray,C=Q.pattern;B.lineJoin=Q.join,B.lineCap=Q.cap,b.drawPath(rl(B,C),Q);var a=c("edge.width.absolute");a&&(B.save(),B.setTransform(1,0,0,1,0,0)),P&&(B.strokeStyle=Q._97o,B.lineWidth=j+2*(D+P),B.stroke()),D&&(B.strokeStyle=L?G.toGrayColor(Q.borderColor):Q.borderColor,B.lineWidth=j+2*D,B.stroke());var l=L?G.toGrayColor(Q.color):Q.color;if(e?ks(B,e,l,null,b._data,b.gv):B.strokeStyle=l,B.lineWidth=j,B.stroke(),Q.is3d){var F=L?G.toGrayColor(Q._67o):Q._67o;_j(B,l,F,j,b.gv._zoom,Q._66o)}if(of(B,C),c("edge.dash")){C=c("edge.dash.pattern");var g=rl(B,C,b._2Q("edge.dash.offset"));g!==B&&b.drawPath(g,Q),b._1Q(B,"edge",c("edge.dash.width")||j,C)}a&&B.restore(),B.lineJoin=O,B.lineCap=N},_48O:function(){},_47O:function(){}});var um=function(c,a){Zn(um,this,[c,a])};Bb(um,up,{_3O:function(){var O,N,C=this,f=C.s,i=C._data,A=C.gv;if(C._88I=U,i.isExpanded()&&i.eachChild(function(f){if(Je(f)){var y=A.getBoundsForGroup(f);y&&(N||(N=[]),N.push(y),O=Pj(O,y))}}),O){var I=A.getLabel(i),k=f("group.type"),y=f("group.border.width")||0,t=f("group.border.width.absolute"),G=y/2;t&&(y/=A._zoom),O=Df(k,N,O),Ip(O,i,"group.padding",1),sr(O,y);var r=C._88I={type:k,rect:O,_64o:O};if(!k&&I!=U){var s,L=C.labelInfo={label:I,color:f("group.title.color"),font:f("group.title.font"),align:f("group.title.align")},e=Ad(L,I),F=e.width+y,V=e.height+y,l=f("group.title.align"),n=f("group.title.orientation");if(n===vc||n===Ol?(O.height+=y,F>O.width&&(O.width=F)):(n===Ld||n===fk)&&(O.width+=y,F>O.height&&(O.height=F)),s=l===Ld?O.x:l===fk?O.x+O.width-F:O.x+O.width/2-F/2,n===Ol)r.titleRect={x:O.x,y:O.y+O.height,width:O.width,height:V},r.rect={x:O.x,y:O.y,width:O.width,height:O.height+V},L.rect={x:s,y:O.y+O.height,width:F,height:V};else if(n===Ld){var X=r.titleRect={x:O.x-V,y:O.y,width:V,height:O.height};r.rect={x:O.x-V,y:O.y,width:O.width+V,height:O.height},L.rect={x:X.x+V/2-O.height/2,y:X.y+O.height/2-V/2,width:O.height,height:V},L.rotation=-Math.PI/2}else if(n===fk){var X=r.titleRect={x:O.x+O.width,y:O.y,width:V,height:O.height};r.rect={x:O.x,y:O.y,width:O.width+V,height:O.height},L.rect={x:X.x+V/2-O.height/2,y:X.y+O.height/2-V/2,width:O.height,height:V},L.rotation=Math.PI/2}else r.titleRect={x:O.x,y:O.y-V,width:O.width,height:V},r.rect={x:O.x,y:O.y-V,width:O.width,height:O.height+V},L.rect={x:s,y:O.y-V-G,width:F,height:V+y}}C._40O(r,f("group.border.width")/2)}else um.superClass._3O.call(C)},getPosition:function(n,Y,P,U){var B=this._88I;if(B){var q=Ml(n,B.rect,U);return q.x+=Y,q.y+=P,q}return um.superClass.getPosition.apply(this,arguments)},_24O:function(i,B){var R=this._88I;(!R||R.type||"label2"===i)&&um.superClass._24O.call(this,i,B)},_80o:function(w){var x=this,Y=x._88I;if(Y){var C=x._data,Z=x.s,T=x.gv,e=Y.type,n=Y.rect,A=Y._64o,F=Y.titleRect,t=x.getBodyColor(),i=Kj(Z("group.image"),t),V=Z("group.image.stretch"),W=x.getBodyColor("group.background"),H=Kj(Z("group.repeat.image"),t),G=Z("group.gradient.pack"),K=Z("group.gradient"),E=Z("group.gradient.color"),o=Z("group.border.width"),P=Z("group.border.color"),s=Z("group.border.pattern"),q=Z("group.title.orientation"),O=Z("group.depth"),u=Z("group.border.radius"),l=Z("group.border.join"),D=Z("group.border.cap"),d=Z("group.border.width.absolute");
d&&(o/=T._zoom);var U=P,g=Z("group.border.repeat.image");if(g&&(g=Kj(g,P))&&(U=Vd(w,g,P,null,C,T)),e){var h=w.lineJoin,b=w.lineCap;if(w.lineJoin=l,w.lineCap=D,i){if(w.save(),Vh(w,e,n,u),w.clip(),bl(w,i,V,n.x,n.y,n.width,n.height,C,T,t),w.restore(),o>0){var j=rl(w,s);Vh(j,e,n,u),w.lineWidth=o,w.strokeStyle=U,w.stroke(),of(w,s)}}else{var j=rl(w,s);W||H||G?(Vh(w,e,n,u),G?lh(w,G,function(I){return ip(I,t)},!1,n):H?jl(w,H,t,null,C,T):Jh(w,W,K,E,n),w.fill(),G&&w.restore(),w!==j&&Vh(j,e,n,u)):Vh(j,e,n,u),o>0&&(w.lineWidth=o,w.strokeStyle=U,w.stroke()),of(w,s),e===co&&ve(w,W,O,n)}w.lineJoin=h,w.lineCap=b}else{var $=Z("group.title.background");if((!u||0>u)&&(u=0),i)bl(w,i,V,A.x,A.y,A.width,A.height,C,T,x.getBodyColor());else if(W||H)if(H?jl(w,H,t,null,C,T):Jh(w,W,K,E,A),0===o)Vh(w,co,A),w.fill(),ve(w,W,O,A);else{switch(w.beginPath(),q){case Ol:vb(w,A.x,A.y,A.width,A.height,u,u,0,0);break;case Ld:vb(w,A.x,A.y,A.width,A.height,0,u,0,u);break;case fk:vb(w,A.x,A.y,A.width,A.height,u,0,u,0);break;case vc:vb(w,A.x,A.y,A.width,A.height,0,0,u,u)}w.fill()}if(F&&$)if(0===o)om(w,F.x,F.y,F.width,F.height,$),ve(w,$,O,F);else{switch(w.beginPath(),w.fillStyle=$,q){case Ol:vb(w,F.x,F.y,F.width,F.height,0,0,u,u);break;case Ld:vb(w,F.x,F.y,F.width,F.height,u,0,u,0);break;case fk:vb(w,F.x,F.y,F.width,F.height,0,u,0,u);break;case vc:vb(w,F.x,F.y,F.width,F.height,u,u,0,0)}w.fill()}if(o>0){var j=rl(w,s);if(Vh(j,"roundRect",n,u),w.save(),w.lineWidth=o,w.strokeStyle=U,w.lineJoin=l,w.lineCap=D,w.closePath(),w.stroke(),F&&Z("group.splitLine")){var m=F.x,p=F.y,J=F.width,v=F.height;w.beginPath(),q===Ol?(w.moveTo(m,p),w.lineTo(m+J,p)):q===Ld?(w.moveTo(m+J,p),w.lineTo(m+J,p+v)):q===fk?(w.moveTo(m,p),w.lineTo(m,p+v)):(w.moveTo(m,p+v),w.lineTo(m+J,p+v))}w.stroke(),w.restore(),of(j,s)}}x._39O(w,Y)}else um.superClass._80o.call(x,w)}});var zq=function(j,X){Zn(zq,this,[j,X])};Bb(zq,up,{_80o:function(A){this._39O(A,this._83o)}});var Gj=function(D,_){Zn(Gj,this,[D,_])};Bb(Gj,up,{_3O:function(){var R=this,C=R._data,I=R.s,i=R.gv,Y=C.getPoints(),d=i.getBorderColor(C),x=d?I("border.width"):0,E=R.getSelectWidth(),J=I("shape.border.width"),u=C.getRect(),O=C.getAnchorRect(),p=i.getBodyColor(C),V=I("shape.border.color"),D=R._99o=Y.isEmpty()?U:{rect:u,rotation:C.getRotation(),fillRule:I("shape.fill.rule"),scale:C.getScale(),position:C.p(),points:Y,segments:C.getSegments(),bodyColor:p,borderColor:d,borderWidth:x,_94o:I("shape.border.3d"),_95o:I("shape.border.3d.color"),_96o:I("shape.border.3d.accuracy"),_97o:E?R.getSelectColor():U,selectWidth:E,_53o:I("shape.background"),_27Q:Kj(I("shape.repeat.image"),p),shapeGradientPack:I("shape.gradient.pack"),shapeBorderGradientPack:I("shape.border.gradient.pack"),_54o:J,_55o:V,shapeBorderRepeatImage:Kj(I("shape.border.repeat.image"),V),shapeGradient:I("shape.gradient"),_59o:I("shape.gradient.color"),_60o:I("shape.border.pattern"),_61o:I("shape.border.cap"),_62o:I("shape.border.join"),shapeForeground:I("shape.foreground"),gray:I("2d.gray")};if(D){O.x+=D.position.x,O.y+=D.position.y,D.gradientRect=O;var H=C.getScale(),q=B(1,B(k(H.x),k(H.y)));I("shape.dash")&&I("shape.dash.width")>J&&(J=I("shape.dash.width"));var X,P=I("shape.border.width.absolute");X=P?(J+x+E)/R.gv._zoom/q:J*("square"===D._61o?.71:.5)+x+E/R.gv._zoom/q,X&&(X*=q,u=ns(u),Fk(u,X,D._62o)),R._68o(u);var _=Qe(C,i.isSelected(C)),L=I("clip.percentage");1>L&&(0>L&&(L=0),D.clipRect=rd(C.getAnchorRect(),I("clip.direction"),L,_));var z=I("shape.fill.clip.percentage");1>z&&(0>z&&(z=0),D.shapeClipRect=rd(C.getAnchorRect(),I("shape.fill.clip.direction"),z,_));var S=I("shape.foreground.clip.percentage");1>S&&(0>S&&(S=0),D.shapeForegroundClipRect=rd(C.getAnchorRect(),I("shape.foreground.clip.direction"),S,_))}},getPosition:function(v,l,H,t){var h=this._99o;if(h){var f=Ml(v,h.rect,t);return f.x+=l,f.y+=H,f}return Ki},_42:function(t){this._99o&&Gj.superClass._42.call(this,t)},_80o:function(q){var M,I=this,J=I.s,T=I._99o,F=T.position,c=T.scale,O=T.rotation,j=T.borderWidth,V=T.selectWidth/I.gv._zoom,f=T._27Q,g=T.shapeGradientPack,L=T._54o,d=T.clipRect,l=T.shapeClipRect,S=T.points,Q=T.segments,x=I._data.isClosePath(),v=T.fillRule,t=T.gray,Y=function(q){return t?G.toGrayColor(q):q},X=Y(T._53o),n=X||f||g;q.save(),Xg(q,F.x,F.y),tp(q,O),Ze(q,c.x,c.y),d&&(q.beginPath(),q.rect(d.x,d.y,d.width,d.height),q.clip()),n&&l&&(q.save(),q.beginPath(),q.rect(l.x,l.y,l.width,l.height),q.clip()),C.Default.extractShapeTranslation?(S=ns(S),S.forEach(function(c){c.x-=F.x,c.y-=F.y})):Xg(q,-F.x,-F.y);var B=T._60o,h=rl(q,B),K=q.lineJoin,i=q.lineCap;q.lineJoin=T._62o,q.lineCap=T._61o;var r=Y(T.bodyColor);n?(Xk(q,S,Q,x),g?lh(q,g,function(f){return ip(f,T.bodyColor)},!1,T.rect):f?jl(q,f,r,null,I._data,I.gv):(M=r?r:X,Jh(q,M,T.shapeGradient,Y(T._59o),T.gradientRect)),q.fill(v),g&&q.restore(),l&&(q.restore(),Xg(q,-F.x,-F.y)),h!==q&&Xk(h,S,Q,x)):Xk(h,S,Q,x);var P=T.shapeForeground;if(P){q.save();var z=T.shapeForegroundClipRect;z&&(Xg(q,F.x,F.y),q.beginPath(),q.rect(z.x,z.y,z.width,z.height),q.clip(),Xg(q,-F.x,-F.y)),Xk(q,S,Q,x),Jh(q,P,J("shape.foreground.gradient"),Y(J("shape.foreground.gradient.color")),T.gradientRect),q.fill(v),q.restore()}var y=J("shape.border.width.absolute");if(y&&(q.save(),q.setTransform(1,0,0,1,0,0)),V&&(q.strokeStyle=T._97o,q.lineWidth=L+2*(j+V),q.stroke()),j&&(q.strokeStyle=Y(T.borderColor),q.lineWidth=L+2*j,q.stroke()),L){M=Y(T._55o);var b=T.shapeBorderGradientPack;b?lh(q,b,Y,!0,T.rect):T.shapeBorderRepeatImage?ks(q,T.shapeBorderRepeatImage,M,null,I._data,I.gv):(!X&&r&&(M=r),q.strokeStyle=M),q.lineWidth=L,q.stroke(),b&&q.restore(),T._94o&&_j(q,M,Y(T._95o),L,I.gv._zoom,T._96o)}if(of(q,B),J("shape.dash")){var D=J("shape.dash.width")||L;if(D>0){B=J("shape.dash.pattern");var h=rl(q,B,I._2Q("shape.dash.offset"));h!==q&&Xk(h,S,Q,x),I._1Q(q,"shape",D,B)}}y&&q.restore(),q.lineJoin=K,q.lineCap=i,q.restore()},_48O:function(){},_47O:function(){}});var ds=function(N,w){Zn(ds,this,[N,w])};Bb(ds,Gj,{getRotation:function(E,q,c){E=E||0;var J=this._data.getPoints(),s=J.size();return s>1?fq[c]?s&&0===s%2?Rm(J.get(s/2-1),J.get(s/2),q,E):E:Uc[c]?Rm(J.get(0),J.get(1),q,E):Rm(J.get(s-2),J.get(s-1),q,E):E},getPosition:function($,A,M,R,E){var p=this._data.getPoints(),z=p.size();if(z>1){if(fq[$]){var g=z%2;if(0===g)return Fo(p.get(z/2-1),p.get(z/2),$,A,M,R,E);var q=p.get((z-g)/2),I={x:q.x,y:q.y,width:0,height:0};return q=Ml($,I,R),q.x+=A,q.y+=M,q}return Uc[$]?Fo(p.get(0),p.get(1),$,A,M,R,E):Fo(p.get(z-2),p.get(z-1),$,A,M,R,E)}return Ki}});var Jf=function(u,$){Zn(Jf,this,[u,$])};Bb(Jf,up,{_3O:function(){var q=this;Jf.superClass._3O.call(q);var f=q.s,h=q._83o;q._82o=h.img||h.shape?U:{background:q.getBodyColor("grid.background"),depth:f("grid.depth"),rect:h.rect,_88o:f("grid.cell.depth"),cellBorderColor:f("grid.cell.border.color"),_89o:f("grid.row.count"),_90o:f("grid.column.count"),block:f("grid.block"),_91o:f("grid.block.color"),_92o:f("grid.block.padding"),_93o:f("grid.block.width")}},_80o:function(o){var $=this,h=$._82o;if(!h)return Jf.superClass._80o.call($,o),void 0;var M,y,z=$._data,v=h.background,t=h.rect,j=h.block,A=h._91o,N=h._92o,i=h._93o,L=h._88o,H=h.cellBorderColor,Q=h._89o,g=h._90o;if(v)if(om(o,t.x,t.y,t.width,t.height,v),ve(o,v,h.depth,t),L)for(M=0;Q>M;M++)for(y=0;g>y;y++)t=z.getCellRect(M,y),t&&ve(o,v,L,t);else if(H){for(o.beginPath(),M=0;Q>M;M++)for(y=0;g>y;y++)t=z.getCellRect(M,y),t&&o.rect(t.x,t.y,t.width,t.height);o.strokeStyle=H,o.lineWidth=1,o.stroke()}if("h"===j)for(M=0;Q>M;M++)t=Pj(z.getCellRect(M,0),z.getCellRect(M,g-1)),sr(t,N),ni(o,A,t.x,t.y,t.width,t.height,i);else if("v"===j)for(y=0;g>y;y++)t=Pj(z.getCellRect(0,y),z.getCellRect(Q-1,y)),sr(t,N),ni(o,A,t.x,t.y,t.width,t.height,i);$._39O(o,$._83o)}});var ol=function(v,m){Zn(ol,this,[v,m])};Bb(ol,up,{_checkEmptyRect:!1,_81o:function(){var r=this._data,x=ol.superClass._81o.call(this),F=r.s("text");if(F!=U){var g,B,M=r.s("text.font"),q=r.s("text.align"),m=r.s("text.vAlign"),u=ei(M,F),_=u.width,L=u.height,O=r.getAnchor(),X=r.getWidth(),I=r.getHeight();"left"===q?g=-X*O.x:"center"===q?g=-X*O.x+(X-_)/2:"right"===q&&(g=X*(1-O.x)-u.width),"top"===m?B=-I*O.y:"middle"===m?B=-I*O.y+(I-L)/2:"bottom"===m&&(B=I*(1-O.y)-u.height);var W,S=r.getMatrix();if(W=Fq([S.tf(g,B),S.tf(g+_,B),S.tf(g+_,B+L),S.tf(g,B+L)]),x=Pj(x,W),x&&r.s("text.shadow")){var i=ns(x);i.x+=r.s("text.shadow.offset.x"),i.y+=r.s("text.shadow.offset.y"),sr(i,r.s("text.shadow.blur")),x=Pj(x,i)}}return x}});var ws=Ui.Interactor=function(H){this.gv=this._graphView=H};_n("Interactor",g,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(r){this.gv.fi(r)},setCursor:function(q){jg||this.gv.setCursor(q)},startDragging:function(k){var h=this;h._lastClientPoint=Ae(k),h._lastLogicalPoint=h.gv.lp(k),Ir(h,k)},clearDragging:function(){var e=this;e._lastClientPoint=e._lastLogicalPoint=e._logicalPoint=U},autoScroll:function(o){return this.gv.autoScroll(o,this._lastClientPoint)}});var jp=U,dk=function($){jp.handleWindowTouchMove($)},rn=function(e){jp.handleWindowTouchEnd(e),h(i,Yh,dk),h(i,Wn,rn),jp=U},Lk=function(N){jp.handleWindowMouseMove(N)},Ye=function(E){jp.handleWindowMouseUp(E),h(i,hr,Lk),h(i,wf,Ye),jp=U},ep=function($,F){if($!==jp){var q=ig(F);jp?q?jp.handleWindowTouchEnd(F):jp.handleWindowMouseUp(F):q?(d(i,Yh,dk),d(i,Wn,rn)):(d(i,hr,Lk),d(i,wf,Ye)),jp=$}},Dm=function(y){var c=this;c.gv=y,c._is2d=y instanceof Ui.GraphView,c._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",Ri,"wheel"].forEach(function(S){c.addListener(S)}),c.initImageResource()};Bb(Dm,ws,{enableVR:function(U){var W=this;!!W._vrEnable!==U&&(W._vrEnable=U,U?W.gv.vr.mp(W.onVRControllerChange,W):W.gv.vr.ump(W.onVRControllerChange,W))},onVRControllerChange:function(D){var L=this,B=D.property,O=D.newValue,y=O.id,P=L.gv.vr.getController(y),w=P.getRay();if(w){w.controllerId=y;var x=L.gv.vr.getRayEventType(w,B,O._62O);switch(x){case"down":L.handle_mousedown(w);break;case"up":jp&&Ye(w);break;case"move":L.handle_mousemove(w),jp&&L.handleWindowMouseMove(w)}}},setPreventEventDefault:function(V,X){var m=this,A=m._eventListeners[V];A?A._prevent=X:m._eventListeners[V]=A={_removal:c,_prevent:X}},removeListener:function(x){var k=this,Q=k._eventListeners[x];Q&&Q._removal&&(Q._removal(),Q._removal=c)},addListener:function(U){var p=this,C=p._eventListeners[U];if(C||(p._eventListeners[U]=C={_removal:c,_prevent:!0}),!C||!C._removal){var M=function(w){C._prevent&&G.preventDefault(w),p.disabled||p.gv._48Q||("wheel"===U?Op(p,w):p["handle_"+U](w))};d(p.gv.getView(),U,M),C._removal=function(){h(p.gv.getView(),U,M)}}},handleWindowTouchMove:function(q){this.handleWindowMouseMove(q)},handleWindowMouseMove:function(o){return!this.downInfo||ig(o)&&1!==mq(o)?(this.isDragging&&(this.handleDownInfo("onEndDrag",o),this.isDragging=!1),void 0):(this.isDragging?this.handleDownInfo("onDrag",o):(this.handleDownInfo("onBeginDrag",o),this.isDragging=!0),void 0)},handleWindowTouchEnd:function(J){this.handleWindowMouseUp(J)},handleWindowMouseUp:function(Z){if(this.isDragging&&(this.handleDownInfo("onEndDrag",Z),this.isDragging=!1),this.downInfo){var q=this.handle("onUp",Z);if(q&&q.data===this.downInfo.data){this.handleMissingUp(Z);var A=this,n=2===Z.button?"onContextMenu":"onClick";if(!A._dbclickTimer)return A._dbclickTimer=xq(function(){delete A._dbclickTimer,A.handleClick(Z,n,q),this.downInfo=U},G.clickDelay),void 0;rj(A._dbclickTimer),delete A._dbclickTimer,n="onDoubleClick",A.handleClick(Z,n,q)}else this.handleDownInfo("onUp",Z);this.downInfo=U,this.downComps=U}},handle_mouseleave:function(L){var X=this,V=X.gv;X._hoverTimer&&(rj(X._hoverTimer),delete X._hoverTimer);var G=X.currentInfo?X.currentInfo.data:U;if(G){G.s("onLeave")&&G.s("onLeave")(L,G,V),X.fire("data","onLeave",L,G);var d=X.currentInfo?X.currentInfo.hits:U;if(d)for(var E in d)X.handleLeave(L,E);X.currentInfo=U}},handle_mousewheel:function(e){e.scrollDelta=e.wheelDelta/40,this.handle("onScroll",e)},handle_DOMMouseScroll:function(t){t.scrollDelta=2===t.axis?-t.detail:0,this.handle("onScroll",t)},handle_touchstart:function(l){this.handle_mousedown(l)},handle_touchmove:function(Z){this.handle("onMove",Z)},handle_mousedown:function(k){this.isDragging&&(this.handleDownInfo("onEndDrag",k),this.isDragging=!1),this.downComps=[],this.downInfo=this.handle("onDown",k),this.downInfo&&ep(this,k)},handle_mousemove:function(K){var c=this,Y=c.gv;if(c._hoverTimer&&(rj(c._hoverTimer),delete c._hoverTimer),!Y._panning&&!Y._moving){var f,h,i,H=c.handle("onMove",K),B=this.currentInfo?this.currentInfo.data:U,O=this.currentInfo?this.currentInfo.hits:U;if(H&&(h=H.data,i=H.hits,c._hoverTimer=xq(function(){rj(c._hoverTimer),delete c._hoverTimer,c.handle("onHover",K,H)},Y.getHoverDelay()||G.hoverDelay)),h!==B){if(B&&(B.s("onLeave")&&B.s("onLeave")(K,B,Y),this.fire("data","onLeave",K,B)),h&&(h.s("onEnter")&&h.s("onEnter")(K,h,Y),this.fire("data","onEnter",K,h)),O)for(f in O)this.handleLeave(K,f);if(i)for(f in i){var s=i[f],J=h._interactPrefix=s.prefix,e=J&&h.a(J+"onEnter")||s.target.onEnter;e&&e.call(s.target,K,h,Y,s.point,s.width,s.height),this.fire(s.type,"onEnter",s.event,s.data,s.image,s.comp,s.point,s),h._interactPrefix=null}}else{if(O)for(f in O)i&&i[f]||this.handleLeave(K,f);if(i)for(f in i)if(!O||!O[f]){var s=i[f],J=h._interactPrefix=s.prefix,e=J&&h.a(J+"onEnter")||s.target.onEnter;e&&e.call(s.target,K,h,Y,s.point,s.width,s.height),this.fire(s.type,"onEnter",s.event,s.data,s.image,s.comp,s.point,s),h._interactPrefix=null}}this.currentInfo=H}},handle:function(F,B,t){var h,Q=this,_=Q.gv;if(Q._is2d){if(t=t||_.getDataInfoAt(B),!t||!_.isInteractive(t.data))return;if(h=t.ui.interactiveInfo){var z,i=t.data;if(i.s(F)&&i.s(F)(B,i,_),this.fire("data",F,B,i),"body"===t.part&&h.bodyInfo)z="body",t.hits=this.handleImage(z,_.getImage(i),F,B,i,t.point,h.bodyInfo);else if("icons"===t.part&&h._38o){var E=h._38o[t.name];E&&E[t.index]&&(z="icons|"+t.name+"|"+t.index,t.hits=this.handleImage(z,t.icon,F,B,i,t.point,E[t.index]))}}return t}var i,X;if(!t)if(B&&B instanceof C.Math.Ray&&_.isVREnabled()){var P=_.vr.intersectWorld(B);if(i=P.data,X=P.intersect,_.vr.renderRayDuringInteraction(B,i,X),!i)return;var k=_.getData3dUI(i);if(h=k.interactiveInfo,!h)return;t={data:i,part:X.part,ui:k}}else{if(t=_.getDataInfoAt(B),!t)return;t&&(t={data:t.data,part:t.part})}if(_.isInteractive(t.data)){if(!X){i=t.data;var k=_.getData3dUI(i);if(t.ui=k,h=k.interactiveInfo,!h)return t;if(X=_.intersectObject(B,i),!X)return}i.s(F)&&i.s(F)(B,i,_),this.fire("data",F,B,i);var d,f=X.part;return"body"!==f&&(d=i.s(f+".image")||i.s("shape3d."+f+".image")),d||(d=i.s("all.image")||i.s("shape3d.image")),d?(h="object"==typeof d?h[d.uuid]:h[d],h&&h.bodyInfo?(t.part="body",t.interactiveInfo=h,t.point=this._convertUVToPoint(X.uv,h),t.image=d,t.hits=this.handleImage("body",d,F,B,i,t.point,h.bodyInfo),t):t):t}},_handleLeaveOrMissing:function(b,u,F){var t="leave"===b?this.currentInfo:this.downInfo;if(t){var T=t.interactiveInfo||t.ui.interactiveInfo;if(T){var J,O,I=t.data;if(this._is2d){if(O=this.gv.lp(u),"body"===t.part&&T.bodyInfo)J="body","leave"===b?this.handleLeaveImage(F,J,this.gv.getImage(I),u,I,O,T.bodyInfo):this.handleMissingUpImage(J,this.gv.getImage(I),u,I,O,T.bodyInfo);else if("icons"===t.part&&T._38o){var _=T._38o[t.name];_&&_[t.index]&&(J="icons|"+t.name+"|"+t.index,"leave"===b?this.handleLeaveImage(F,J,t.icon,u,I,O,_[t.index]):this.handleMissingUpImage(J,t.icon,u,I,O,_[t.index]))}}else{if(!T.bodyInfo)return;var x=this.gv.intersectObject(u,I);O=x&&x.uv?this._convertUVToPoint(x.uv,T):{x:1/0,y:1/0},"leave"===b?this.handleLeaveImage(F,"body",t.image,u,I,O,T.bodyInfo):this.handleMissingUpImage("body",t.image,u,I,O,T.bodyInfo)}}}},handleClick:function(H,p,U){var g=this,J=this.downInfo;if(J&&U){var u,F=U.interactiveInfo||U.ui.interactiveInfo,D=U.data,$=this.gv;if(D.s(p)&&D.s(p)(H,D,$),g.fire("data",p,H,D),F)if(this._is2d){if(J.part===U.part){var M=$.lp(H);"body"===U.part&&F.bodyInfo&&(u="body",this.handleClickImage(u,$.getImage(D),p,H,D,M,F.bodyInfo,U))}}else{if(!F.bodyInfo)return;var a=$.intersectObject(H,D);if(!a)return;M=this._convertUVToPoint(a.uv,F),this.handleClickImage("body",J.image,p,H,D,M,F.bodyInfo,U)}}},handleDownInfo:function(_,S){if(this.downInfo){var c=this.downInfo,L=this.gv,b=c.interactiveInfo||c.ui.interactiveInfo;if(b){var u,m=c.data;if(m.s(_)&&m.s(_)(S,m,L),this.fire("data",_,S,m),this._is2d){var D=L.lp(S);if("body"===c.part&&b.bodyInfo)u="body",this.handleDownInfoImage(u,L.getImage(m),_,S,m,D,b.bodyInfo);else if("icons"===c.part&&b._38o){var i=b._38o[c.name];i&&i[c.index]&&(u="icons|"+c.name+"|"+c.index,this.handleDownInfoImage(u,c.icon,_,S,m,D,i[c.index]))}}else{if(!b.bodyInfo)return;var o=L.intersectObject(S,m);if(!o)return;D=this._convertUVToPoint(o.uv,b),this.handleDownInfoImage("body",c.image,_,S,m,D,b.bodyInfo)}}}},fire:function(p,s,v,r,q,e,m,h){this.gv.fi({kind:s,type:p,event:v,data:r,image:q,comp:e,view:this.gv,point:m,width:h?h.width:c,height:h?h.height:c})},handleImage:function($,V,F,P,H,n,A){var X={};if(V&&(V=Kj(V))){var i=this.gv,I=A.rect,e=this.convertPoint(n,A);e.inRect&&(V[F]&&V[F](P,H,i,e,I.width,I.height),this.fire("image",F,P,H,V,c,e,I),X[$+"|image"]={target:V,type:"image",image:V,data:H,event:P,point:e,width:I.width,height:I.height});for(var T,k=A.compInfos,B=V,w=k.length-1;w>=0;w--){var J=k[w],y=J.comp;if(e=this.convertPoint(n,J,B,y,i,H),e.inRect){I=J.rect;var Z=H._interactPrefix=J.prefix,r=Z&&H.a(Z+F)||y[F];if(r&&(T=r.call(y,P,H,i,e,I.width,I.height)),this.fire("comp",F,P,H,V,y,e,I),T!==!0&&(V=I.image)&&(V[F]&&(T=V[F](P,H,i,e,I.width,I.height)),this.fire("image",F,P,H,V,c,e,I)),H._interactPrefix=null,X[$+"|"+w]={target:y,type:"comp",comp:y,image:V,data:H,event:P,point:e,width:I.width,height:I.height,prefix:Z},this.downComps&&this.downComps.push(y),V&&(X[$+"|"+w+"|image"]={target:V,type:"image",image:V,data:H,event:P,point:e,width:I.width,height:I.height,prefix:Z}),T===!0)break}}}return X},handleLeave:function(x,J){return this._handleLeaveOrMissing("leave",x,J)},handleMissingUp:function(k){return this._handleLeaveOrMissing("missing",k)},handleLeaveImage:function($,G,h,l,u,O,K){if(h&&(h=Kj(h))){var k=this.gv,M=K.rect,g=this.convertPoint(O,K);$===G+"|image"&&(h.onLeave&&h.onLeave(l,u,k,g,M.width,M.height),this.fire("image","onLeave",l,u,h,c,g,M));for(var C,i=K.compInfos,D=h,P=i.length-1;P>=0;P--){var m=i[P],F=m.comp;g=this.convertPoint(O,m,D,F,k,u),M=m.rect;var y=u._interactPrefix=m.prefix;if($===G+"|"+P){var S=y&&u.a(y+"onLeave")||F.onLeave;S&&(C=S.call(F,l,u,k,g,M.width,M.height)),this.fire("comp","onLeave",l,u,h,F,g,M)}if(C!==!0&&(h=M.image)&&$===G+"|"+P+"|image"&&(h.onLeave&&(C=h.onLeave(l,u,k,g,M.width,M.height)),this.fire("image","onLeave",l,u,h,c,g,M)),u._interactPrefix=null,C===!0)break}}},handleMissingUpImage:function(d,s,n,R,C,h){var $="onUp",O=this.downInfo.hits;if(O&&s&&(s=Kj(s))){var U=this.gv,P=h.rect,H=this.convertPoint(C,h);!H.inRect&&O[d+"|image"]&&(s[$]&&s[$](n,R,U,H,P.width,P.height),this.fire("image",$,n,R,s,c,H,P));for(var v,a=h.compInfos,A=s,b=a.length-1;b>=0;b--){var W=a[b],L=W.comp;if(H=this.convertPoint(C,W,A,L,U,R),!H.inRect){P=W.rect;var i=R._interactPrefix=W.prefix;if(O[d+"|"+b]){var Z=i&&R.a(i+$)||L[$];Z&&(v=Z.call(L,n,R,U,H,P.width,P.height)),this.fire("comp",$,n,R,s,L,H,P)}if(v!==!0&&(s=P.image)&&O[d+"|"+b+"|image"]&&(s[$]&&(v=s[$](n,R,U,H,P.width,P.height)),this.fire("image",$,n,R,s,c,H,P)),R._interactPrefix=null,v===!0)break}}}},handleDownInfoImage:function(R,h,o,f,l,V,v){var X=this.downInfo.hits;if(X&&h&&(h=Kj(h))){var t=this.gv,P=v.rect,C=this.convertPoint(V,v);X[R+"|image"]&&(h[o]&&h[o](f,l,t,C,P.width,P.height),this.fire("image",o,f,l,h,c,C,P));for(var A,S=v.compInfos,M=h,d=S.length-1;d>=0;d--){var D=S[d],i=D.comp;C=this.convertPoint(V,D,M,i,t,l),P=D.rect;var T=l._interactPrefix=D.prefix,Z=["onDrag","onEndDrag"].indexOf(o)>=0;if(!Z&&X[R+"|"+d]||Z&&this.downComps&&this.downComps.indexOf(i)>=0){var y=T&&l.a(T+o)||i[o];y&&(A=y.call(i,f,l,t,C,P.width,P.height)),this.fire("comp",o,f,l,h,i,C,P)}if(A!==!0&&(h=P.image)&&X[R+"|"+d+"|image"]&&(h[o]&&(A=h[o](f,l,t,C,P.width,P.height)),this.fire("image",o,f,l,h,c,C,P)),l._interactPrefix=null,A===!0)break}}},handleClickImage:function(U,Q,l,J,G,E,s,p){var i=this.downInfo.hits,b=p.hits;if(i&&Q&&(Q=Kj(Q))){var f=this.gv,H=s.rect,X=this.convertPoint(E,s);i[U+"|image"]&&(Q[l]&&Q[l](J,G,f,X,H.width,H.height),this.fire("image",l,J,G,Q,c,X,H));for(var m,x=s.compInfos,d=Q,P=x.length-1;P>=0;P--){var y=x[P],e=y.comp;X=this.convertPoint(E,y,d,e,f,G),H=y.rect;var k=G._interactPrefix=y.prefix;if(i[U+"|"+P]&&b[U+"|"+P]){var T=k&&G.a(k+l)||e[l];T&&(m=T.call(e,J,G,f,X,H.width,H.height)),this.fire("comp",l,J,G,Q,e,X,H)}if(m!==!0&&(Q=H.image)&&i[U+"|"+P+"|image"]&&(Q[l]&&(m=Q[l](J,G,f,X,H.width,H.height)),this.fire("image",l,J,G,Q,c,X,H)),G._interactPrefix=null,m===!0)break}}},initImageResource:function(){G.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(q,U){if(!q)return{x:1/0,y:1/0};var X=U.bodyInfo.rect,v=q.clone(),M=q.multiply({x:X.width,y:X.height});return M.local=v,M},convertPoint:function(B,n,Y,X,H,F){var z=n.rect,J=n.matrix.applyInverse(B).sub(z),u=J.x>=0&&J.y>=0&&J.x<=z.width&&J.y<=z.height;if(!u)return J;if(X&&zi(X.pixelPerfect,F,H)){var z,v=1;this._is2d?(v=H.getZoom(),z=Yn(B.x,B.y,c,v)):z=Yn(B.x,B.y);var a=!1,Z=z.x,d=z.y,g=z.width,y=z.height,h=G.hitMaxArea,T=g*y*v*v;if(T>h){var S=Math.sqrt(h/T);v*=S}g*=v,y*=v,2>g&&(g=2),2>y&&(y=2),Z*=v,d*=v;var p=Qr(g,y),m=new kp(0,-Z,-d,v,v);m.append(n.matrix),H._drawForChecking=!0,X.transform=m;var s=Y.fitSize;n.refRect&&n.refRect.fitSize?(X.refRect=n.refRect,Y.fitSize=!0):Y.fitSize=!1;var V=Y.comps;Y.comps=[X],kc(p,Y,0,0,g,y,F,self),Y.comps=V,Y.fitSize=s,delete X.refRect,delete X.unionRect,delete X.transform,H._drawForChecking=!1;try{for(var b=0,L=p.getImageData(0,0,g,y).data;b<L.length;b+=4)if(0!==L[b+3]){a=!0;break}p.restore()}catch(W){mj=U,a=!1}J.inRect=a}else J.inRect=!0;return J}});var fd=Ui.DefaultInteractor=function(D){Zn(fd,this,[D])};_n("DefaultInteractor",ws,{handle_mousedown:function(X){Uh(X);var h=this,G=h.gv,W=G.getDataAt(X);if(G.setFocus(X)&&!G._editing&&!G._scrolling){ar(X)?G.handleDoubleClick(X,W):G.handleClick(X,W);var Y=Ni(X);!Tr()&&!Y&&W&&(G.isMovable(W)||G._39Q(W))||!G.isPannable()||!dr(X)&&!Y||Pm(X)||(h._tx=G.tx(),h._ty=G.ty(),h.startDragging(X))}},handleWindowMouseUp:function(o){var S=this,A=S.gv;A._panning&&(delete A._panning,A.onPanEnded(),S.fi({kind:"endPan",event:o})),delete S._tx,delete S._ty,S.clearDragging()},handle_mousemove:function(g){var A=this,h=A.gv;A._hoverTimer&&(rj(A._hoverTimer),delete A._hoverTimer),A._hoverTimer=xq(function(){A.fi({kind:"hover",event:g}),rj(A._hoverTimer),delete A._hoverTimer},h.getHoverDelay()||G.hoverDelay)},handle_mouseleave:function(){var J=this;J._hoverTimer&&(rj(J._hoverTimer),delete J._hoverTimer)},handleWindowMouseMove:function(M){var J=this,f=J.gv;J.fi({kind:f._panning?"betweenPan":"beginPan",event:M}),f._panning=1;var $=Mm(f,M,J._lastClientPoint);f.setTranslate(J._tx+$.x,J._ty+$.y)},handle_mousewheel:function(B){this.gv.handleScroll(B,B.wheelDelta)},handle_DOMMouseScroll:function(v){2===v.axis&&this.gv.handleScroll(v,-v.detail)},handle_keydown:function(z){this.gv.handleKeyDown(z)}});var wr=Ui.SelectInteractor=function(w){Zn(wr,this,[w])};_n("SelectInteractor",ws,{_42:function(){var o=this,I=o.gv,S=I.getZoom(),g=o.mark,f=o.div;f||(f=o.div=qg(),zp(o.getView(),f));var U={};U.x=g.x*S+I.tx(),U.y=g.y*S+I.ty(),U.width=g.width*S,U.height=g.height*S,Gq(f,U),this.intersects()?(f.style.border="",f.style.background=I.getRectSelectBackground()):(f.style.background="",f.style.border="1px solid "+I.getRectSelectBorderColor())},handle_mousedown:function(m){var X=this,J=X.gv;if(X._57I=U,X.pendingClickThrough=U,!(J._editing||J._scrolling||Tr()||Ni(m))){var c=J.getDataAt(m),$=J.sm();c?Pm(m)?$.co(c)?$.rs(c):$.as(c):$.co(c)?c instanceof af&&c.isClickThroughEnabled()&&dr(m)&&(X.pendingClickThrough=Ae(m)):$.ss(c):Pm(m)||!J.isPannable()?dr(m)&&(Pm(m)||$.cs(),J.isRectSelectable()&&(X.startDragging(m),J._77O=1)):dr(m)&&(X._57I=Ae(m))}},handle_mouseup:function(R){var F=this,X=F.gv,l=F._57I;if(l&&(Sn(l,Ae(R))<=1&&X.sm().cs(),F._57I=U),F.pendingClickThrough){if(Sn(F.pendingClickThrough,Ae(R))<=1){var Q=X.getDataAt(R);if(Q instanceof af&&Q.isClickThroughEnabled()){var S=X.getDataAt(R,function($){var v=$.getParent()===Q&&X.isSelectable($,!0);return v});S&&(R.clickThrough=!0,X.sm().ss(S))}}F.pendingClickThrough=U}},handleWindowMouseUp:function(T){this.clear(T)},handleWindowMouseMove:function(W){var I=this,w=I.gv;I._logicalPoint=w.lp(W),I.mark?(I.fi({kind:"betweenRectSelect",event:W}),w.isPannable()&&I.autoScroll(W),I.redraw()):I.fi({kind:"beginRectSelect",event:W}),I.mark=Fq(I._lastLogicalPoint,I._logicalPoint),I.redraw()},intersects:function(){var e=this,H=e._lastLogicalPoint,J=e._logicalPoint;return H.x>J.x||H.y>J.y},clear:function(v){var R=this,G=R.gv,W=R.mark;if(R._57I=U,R.pendingClickThrough=U,R._lastLogicalPoint){if(W){if(0!==W.width&&0!==W.height){var c=G.getDatasInRect(W,R.intersects());if(!c.isEmpty()){var L=G.sm(),M=L.toSelection(),E=zm(v),O=v.altKey;c.each(function(r){L.co(r)?(!E||E&&O)&&M.remove(r):(!O||E&&O)&&M.add(r)}),L.ss(M)}}Oi(R.div),delete R.div,delete R.mark,R.redraw(),R.fi({kind:"endRectSelect",event:v}),G.onRectSelectEnded()}R.clearDragging(),delete G._77O}},redraw:function(){var o=this;o._draw||(o._draw=1,xq(function(){o.mark&&o._42(),delete o._draw},16))}});var Hi=Ui.MoveInteractor=function(z){Zn(Hi,this,[z])};_n("MoveInteractor",ws,{handle_mousedown:function(s){var Y=this,u=Y.gv;if(dr(s)&&!u._editing&&!u._scrolling&&!Tr()){var G=u.getSelectedDataAt(s);!G||u._39Q(G)&&!u.isMovable(G)?u._focusData=U:(Y._data=G,u.handleMouseDown&&u.handleMouseDown(s,G),Y.startDragging(s),u.isMovable(G)&&(u._moving=1))}},handleWindowMouseUp:function(O){var t=this,m=t.gv;m.handleMouseUp&&m.handleMouseUp(O,t._data),t.clear(O)},handleWindowMouseMove:function(c){var l=this,K=l._data,u=l.gv;if((!u._93O||!u._93O(c,K))&&u._moving){l._logicalPoint||l.fi({kind:"prepareMove",event:c});var S=l._logicalPoint?"betweenMove":"beginMove",x={kind:S,event:c},b=l._logicalPoint=u.lp(c);"beginMove"!==S||l._alreadyBeginTransaction||(l._alreadyBeginTransaction=!0,u.getDataModel().beginTransaction());var I=l._calcShift(S,c),q=I.x,W=I.y,D=l.gv.getMoveMode(c,K);D&&("x"===D?W=0:"y"===D?q=0:"xy"!==D&&(q=W=0)),u.moveSelection(q,W),l._lastLogicalPoint=b,l.autoScroll(c),l.fi(x)}},_calcShift:function(){var E=this,x=E._logicalPoint,m=E._lastLogicalPoint,l=x.x-m.x,U=x.y-m.y;return{x:l,y:U}},clear:function(i){var r=this,d=r.gv;r._lastLogicalPoint&&(r._lastLogicalPoint=r._data=d._moving=U,r._logicalPoint&&(r.fi({kind:"endMove",event:i}),d.onMoveEnded()),r.clearDragging()),r._alreadyBeginTransaction&&(r._alreadyBeginTransaction=!1,d.getDataModel().endTransaction())}});var jc=Ui.TextEditInteractor=function(W){Zn(jc,this,[W]),this.init()};_n("TextEditInteractor",ws,{init:function(){var N=this,a=this.input=X.createElement("input"),K=a.style;a.text="text",K.border="1px solid #d8d8d8",K.position="absolute",K.padding="2px 3px",K.outline="none",K.marginLeft="-90px",K.marginTop="-16px",K.backgroundColor="rgba(255,255,255, 0.9)",K.fontSize="14px",K.width="180px",K.height="32px",K.boxShadow="0 0 13px rgba(16,142,233, 0.5)",K.textAlign="center",K.boxSizing="border-box",d(a,"keyup",function(X){Am(X)&&N.endTextEdit()}),d(a,"focus",function(){a.select()});var D=this.textarea=X.createElement("textarea"),n=this.wrap=X.createElement("div");n.appendChild(D),K=D.style,K.margin=0,K.padding="4px",K.overflow="hidden",K.boxSizing="border-box",K.position="absolute",K.outline="none",K.backgroundColor="transparent",K.resize="none",K.textAlign="center",K.fontSize="14px",K.border="none",K.borderWidth=0,K.width="100%",K.top="50%",K=n.style,K.boxSizing="border-box",K.margin=0,K.padding=0,K.position="absolute",K.boxShadow="0 0 13px rgba(16,142,233, 0.5)",K.border="1px solid #d8d8d8",K.backgroundColor="rgba(255,255,255, 0.9)",K.width="180px",K.marginLeft="-90px",d(D,"keydown",function(V){return(zm()||Pm())&&Am(V)?(N.endTextEdit(),void 0):(N.calculateTextareaHeight(String.fromCharCode(V.keyCode)),void 0)}),d(D,"focus",function(){D.select()});var m=function(U){U.stopPropagation()};d(a,"mousedown",m),d(a,"touchstart",m),d(D,"mousedown",m),d(D,"touchstart",m),N.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],N.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",N.handleWindowClick=function($){var x=N._editingDOM;if(x){var X=x.getBoundingClientRect(),p=Ae($);Qn(X,p)||N.endTextEdit()}}},handle_mousedown:function(c){var b=this,S=b.gv;if(ar(c)&&!S._editing){var C=S.getDataAt(c);if(C){var d=S.getTextEditInfo(C);d&&(this._editInfo=d,this._editTarget=C,S._editing=!0,d.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var n=this,$=n.gv,a=n._editTarget,_=n.getTargetValue(),w=n.textarea,E=n.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===_||_===c)&&(_=""),w.value=_,n._editingDOM=w,$.getView().appendChild(E),this.layoutHTML(E,a),this.calculateTextareaHeight(),xq(function(){w.focus(),d(i,"mousedown",n.handleWindowClick),d(i,"touchstart",n.handleWindowClick)},10)},handleTextEdit:function(){var u=this,S=u.gv,Q=u._editTarget,m=u.getTargetValue(),K=u.input;(null===m||m===c)&&(m=""),K.value=m,u._editingDOM=K,S.getView().appendChild(K),this.layoutHTML(K,Q),xq(function(){K.focus(),d(i,"mousedown",u.handleWindowClick),d(i,"touchstart",u.handleWindowClick)},10)},layoutHTML:function(t,x){var p=this.gv,E=p.getZoom();if(x instanceof C.Node){var h=x.getRect(),b=Math.min(Math.max(100,h.width*E),800);t.style.left=(h.x+h.width/2)*E+p.tx()+"px",t.style.top=(h.y+h.height/2)*E+p.ty()+"px",t.style.width=b+"px",t.style.marginLeft=-b/2+"px"}else if(x instanceof C.Edge){var F=p.getDataUI(x),h=F._6I;t.style.left=(h.x+h.width/2)*E+p.tx()+"px",t.style.top=(h.y+h.height/2)*E+p.ty()+"px"}},endTextEdit:function(){var g=this,W=g._editInfo.isMultiline?g.wrap:g.input,Z=g._editInfo.isMultiline?g.textarea:g.input;g.setTargetValue(Z.value),g.gv.getView().removeChild(W),g.gv._editing=!1,delete g._editingDOM,h(i,"mousedown",g.handlelick),h(i,"touchstart",g.handleWindowClick)},setTargetValue:function(J){var Z=this,s=Z._editTarget,i=Z._editInfo,h=i.accessType,b=i.name;if(b&&h||(h="p",b="name"),"p"===h){var v=C.Default.setter(b);s[v](J)}else"a"===h?s.a(b,J):s.s(b,J)},getTargetValue:function(){var b=this,r=b._editTarget,O=b._editInfo,d=O.accessType,h=O.name;if(h&&d||(d="p",h="name"),"p"===d){var B=C.Default.getter(h);return r[B]()}return"a"===d?r.a(h):r.s(h)},createHiddenTextarea:function(){this.hiddenTextarea=X.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(b,o){if(o&&this.computedStyleCache)return this.computedStyleCache;var N=this,w=i.getComputedStyle(b),v=w.getPropertyValue("box-sizing")||w.getPropertyValue("-moz-box-sizing")||w.getPropertyValue("-webkit-box-sizing"),E=parseFloat(w.getPropertyValue("padding-bottom"))+parseFloat(w.getPropertyValue("padding-top")),X=parseFloat(w.getPropertyValue("border-bottom-width"))+parseFloat(w.getPropertyValue("border-top-width")),f=N.SIZING_STYLE.map(function(u){return u+":"+w.getPropertyValue(u)
}).join(";"),Q={sizingStyle:f,paddingSize:E,borderSize:X,boxSizing:v};return o&&(this.computedStyleCache=Q),Q},calculateTextareaHeight:function(s){s=s||"";var O=this,v=O.textarea,T=O.hiddenTextarea,n=O.wrap,d=32,X=O.calculateHTMLStyle(v,!1),F=X.paddingSize,u=X.borderSize,J=X.boxSizing,c=X.sizingStyle;T.setAttribute("style",c+";"+O.HIDDEN_TEXTAREA_STYLE),T.value=v.value+s;var H=T.scrollHeight;"border-box"===J?H+=u:"content-box"===J&&(H-=F),v.style.height=H+"px",v.style.marginTop=0-.5*H+"px",n.style.height=Math.max(H,d)+"px",n.style.marginTop=H*-.5+"px"}});var _e=Ui.ScrollBarInteractor=function(H){Zn(_e,this,[H])};_n("ScrollBarInteractor",ws,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(F){var o=this.gv.getViewRect();return this._41o()&&(o.x+o.width-this.gv.lp(F).x)*this.gv.getZoom()<sj},isH:function(_){var d=this.gv.getViewRect();return this._40o()&&(d.y+d.height-this.gv.lp(_).y)*this.gv.getZoom()<sj},handle_mousemove:function(o){this.handle_touchmove(o)},handle_touchmove:function(F){if(!Sd&&dr(F)&&this.gv.isScrollBarVisible()){var g=this,L=g.isV(F),n=g.isH(F);(L||n)&&g.gv.showScrollBar(),g.gv._scrolling=L||n}},handleWindowMouseUp:function(H){this.handleWindowTouchEnd(H)},handleWindowTouchEnd:function(O){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=U,this.fi({kind:"endScroll",event:O})},handle_mousedown:function(u){this.handle_touchstart(u)},handle_touchstart:function(t){var y=this;if(y.gv.setFocus(t),Uh(t),y.handle_touchmove(t),!(mq(t)>1)&&y.gv._scrolling&&y.gv.isScrollBarVisible()){y._cp=Ae(t),y._tx=y.gv.tx(),y._ty=y.gv.ty();var i=y.isV(t);y._state=i?"vScroll":"hScroll",Ir(y,t),y.fi({kind:"beginScroll",event:t})}},handleWindowMouseMove:function(g){this.handleWindowTouchMove(g)},handleWindowTouchMove:function(b){var K=Ae(b),S=this.gv.getViewRect(),P=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-K.y)*P.height/S.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-K.x)*P.width/S.width),this.fi({kind:"betweenScroll",event:b})}});var rc=Ui.TouchInteractor=function(M,F){F=F||{},F.selectable===c&&(F.selectable=!0),F.movable===c&&(F.movable=!0),F.pannable===c&&(F.pannable=!0),F.pinchable===c&&(F.pinchable=!0),F.editable===c&&(F.editable=!0),this.params=F,Zn(rc,this,[M])};_n("TouchInteractor",ws,{ms_edit:1,setUp:function(){var $=this;rc.superClass.setUp.call($),jg&&$.params.editable&&$.gv.setEditInteractor($)},tearDown:function(){var R=this;rc.superClass.tearDown.call(R),jg&&R.params.editable&&R.gv.setEditInteractor(U)},clear:function(n){var r=this,O=r.gv;O._moving&&(r.fi({kind:"endMove",event:n}),delete O._moving,O.onMoveEnded(),O.dm().endTransaction()),O._panning&&(r.fi({kind:"endPan",event:n}),delete O._panning,O.onPanEnded()),O._pinching&&(r.fi({kind:"endPinch",event:n}),delete O._pinching,O.onPinchEnded()),O._editing&&(r._46O(n),r._77I=r._node=r._edge=r._shape=r._rect=r._89I=r._index=O._editing=U),r.pendingClickThrough=r._moving=r._panning=r._pinching=r._editing=r._57I=r._data=r._beginHistory=U,r.clearDragging()},handle_touchstart:function(D){var G=this;if(!G.gv._editing){Uh(D),G._57I=U,G.pendingClickThrough=U;var k=G.params,d=G.gv,s=d.sm(),p=d.getDataAt(D),h=mq(D);if(1===h){if(ar(D))return d.handleDoubleClick(D,p),void 0;d.handleClick(D,p),p&&(d.handleMouseDown&&d.handleMouseDown(D,p),G._data=p),k.selectable||(p=U),p&&(s.co(p)?p instanceof af&&p.isClickThroughEnabled()&&(G.pendingClickThrough=Ae(D)):s.ss(p),k.editable&&d.isEditable(p)&&G._79I(D,p,!0)?(G._editing=1,G.startDragging(D)):k.movable&&d.isMovable(p)&&(G._moving=1,G.startDragging(D))),p&&(d.isMovable(p)||d._39Q(p))||(G._57I=Ae(D),k.pannable&&d.isPannable()&&(G._panning=1,G.startDragging(D),G._translate={x:d.tx(),y:d.ty()}))}else if(k.pinchable&&2===h){if(!d.getEditInteractor()&&p){var V=Kj(d.getImage(p));if(V&&zi(V.scrollable,p,this))return}G._pinching=1,G.startDragging(D);var y=d.getView(),$=d.getZoom(),L=y.getBoundingClientRect(),S=D.touches[0],O=D.touches[1],v={x:(S.clientX+O.clientX)/2-L.left,y:(S.clientY+O.clientY)/2-L.top};v.x-=d.tx(),v.y-=d.ty(),v.x/=$,v.y/=$,G._p=v,G._d=Xe(D)}}},handle_touchend:function(c){var j=this,A=j.gv,d=j._57I,F=j._data;if(d&&(Sn(d,Ae(c))<=1&&!A.getDataAt(c)&&A.sm().cs(),j._57I=U),F&&A.handleMouseUp&&A.handleMouseUp(c,F),j.pendingClickThrough){if(Sn(j.pendingClickThrough,Ae(c))<=1){var F=A.getDataAt(c);if(F instanceof af&&F.isClickThroughEnabled()){var Y=A.getDataAt(c,function(b){var g=b.getParent()===F&&A.isSelectable(b,!0);return g});Y&&(c.clickThrough=!0,A.sm().ss(Y))}}j.pendingClickThrough=U}},handleWindowTouchEnd:function($){this.clear($)},handleWindowTouchMove:function(R){var I=this,u=I.gv,k=mq(R);if(1===k){var p=Ae(R),d=Mm(u,p,I._lastClientPoint),h=Sn({x:0,y:0},d);if(I._editing&&(I._beginHistory||(I._beginHistory=1,u.dm().beginTransaction()),u._editing=1,I._78I(R)),I._moving){if(!u._moving&&h<G.touchMoveThreshold)return;I._beginHistory||(I._beginHistory=1,u.dm().beginTransaction()),I.handleMove(R)}else if(I._panning){if(!u._panning&&h<G.touchMoveThreshold)return;u.setTranslate(I._translate.x+d.x,I._translate.y+d.y),I.fi({kind:u._panning?"betweenPan":"beginPan",event:R}),u._panning=1}}else if(2===k&&I._pinching){var c=Xe(R);u.handlePinch(I._p,c,I._d),I._d=c,I.fi({kind:u._pinching?"betweenPinch":"beginPinch",event:R}),u._pinching=1}},handleMove:function(X){var q=this,D=q.gv,c=D.lp(X);D._93O&&D._93O(X,q._data)||(D.moveSelection(c.x-q._lastLogicalPoint.x,c.y-q._lastLogicalPoint.y),q._lastLogicalPoint=c,q.autoScroll(X),q.fi({kind:D._moving?"betweenMove":"beginMove",event:X}),D._moving=1)}});var C=i.ht,Uj=C.graph._editor={Math:C.Math,Guide:{}};Uj.getStyle=function(Q){var l,k=Uj.StyleMap;return k&&(l=k[Q],l!==c)?l:Uj.DefaultStyleMap[Q]},Uj.setStyle=function(D,U){var p=Uj.StyleMap;p||(p=Uj.StyleMap={}),p[D]=U},Uj.inEdit=function(m){return m._inXEdit===!0},Uj.startEdit=function(X){X._inXEdit=!0,Uj.Inject.doInject(X)},Uj._46O=function(L){L._inXEdit=!1,Uj.Inject.undoInject(L)},Uj.toScreenPosition=function(h,c){var j=h.tx(),G=h.ty(),M=h._zoom;return new Uj.Math.Vector2(c.x*M+j,c.y*M+G)},Uj.checkHit=function(d,v,i){return d.distanceTo(v)<i?!0:!1},Uj.toWorldPosition=function(m,g){var X=m.tx(),q=m.ty(),B=m._zoom;return{x:(g.x-X)/B,y:(g.y-q)/B}},Uj.setAntialias=function(t,n){for(var q,K=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],p=0,G=K.length;G>p&&(q=K[p],!(q in t));p++);t[q],t[q]=n},Uj.getTargetCornersOnScreen=function(h,s){if(!s)return null;var Y,d=[];if(tm(s,h)){var J=Zc(h,s);Y=[{x:J.x,y:J.y},{x:J.x+J.width,y:J.y},{x:J.x+J.width,y:J.y+J.height},{x:J.x,y:J.y+J.height}]}else{if(!s.getCorners)return null;Y=s.getCorners()}return Y.forEach(function(q){var C=Uj.toScreenPosition(h,q);d.push(C.x,C.y)}),d},Uj.log=function(){};var pk=Uj.Inject={_modules:[]};pk.registAsModule=function(m,$){var k={},w={};for(var z in m){var B=$.prototype[z];k[z]=B}m.getBackup=function(Q){return k[Q]},m.getBackups=function(){return k},w.doInject=function(){for(var b in m)"getBackup"!==b&&($.prototype[b]=m[b])},w.undoInject=function(){for(var O in m)"getBackup"!==O&&($.prototype[O]=k[O])},pk._modules.push(w)},pk.doInject=function(E){for(var x,w=pk._modules,f=0,U=w.length;U>f;f++)x=w[f],x.doInject(E)},pk.undoInject=function(c){for(var y,G=pk._modules,x=0,P=G.length;P>x;x++)y=G[x],y.undoInject(c)};var ws=C.graph.EditInteractor=function(w){var L=this,h=X.createElement("canvas");h.className="editCanvas",h.style.position="absolute",L._uuid=C.Math.generateUUID(),L._styleMap={},L._canvas=h,L._context=h.getContext("2d"),ws.superClass.constructor.call(L,w),this._editDetail=!1,Uj.setAntialias(L._context,!1),L._subModules=[new Uj.Anchor(L),new Uj.RotateX(L),new Uj.MoveDummy(L),new Uj.Rect(L),new Uj.Curve(L),new Uj.MoveHelper(L)],L._gridGuide=new Uj.Guide.Grid(L),L._rectGuide=new Uj.Guide.Rect(L),L._hoverGuide=new Uj.Guide.Hover(L)},Cd=ws;C.Default.def(ws,C.graph.Interactor,{ms_edit:1,ms_fire:1}),g.defineProperties(ws.prototype,{editDetail:{get:function(){var e=!!this._editDetail;return e},set:function(c){var D=this,l=D._editDetail;l!==c&&(D._editDetail=c,D.gv._editing=c,D.fp("editDetail",l,c),D.fp("pointsEditingMode",l,c),D.fi({kind:c?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(X){(!this._editDetail||X)&&(this.gv._editing=X,X||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(Z){this._editing=Z,this.gvEditing=Z}},editingModule:{get:function(){return this._editMod}},pointsEditingMode:{get:function(){return this.editDetail},set:function(p){var y=this;y.editDetail!==p&&(p?y._tryEnterEditDetailMode():y._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var y=this._gridEnabled;if(!y)return!1;var $=this.gv;return $?!0:!0},set:function(T){T!==this._gridEnabled&&(this._gridEnabled=T,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(X){X!==this._agEnabled&&(this._agEnabled=X,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),ws.prototype.getSubModule=function(F){var R,w,p,u=this._subModules;for(w=0,p=u.length;p>w;w++)if(R=u[w],R.catalog===F)return R},ws.prototype.invokeSubModule=function(z,s){for(var K,C,U,S=this,p=S._subModules,T=Array.prototype.slice.call(arguments,2),O=0,N=p.length;N>O;O++)if(K=p[O],C=K[z],C&&(U=C.apply(K,T),U!=c&&s))return K},ws.prototype.invokeSubModuleInverse=function(y,P){var r=this,f=r._subModules;if(f)for(var V,s,g,n=Array.prototype.slice.call(arguments,2),Y=f.length-1;Y>=0;Y--)if(V=f[Y],s=V[y],s&&(g=s.apply(V,n),g!=c&&P))return V},ws.prototype.setUp=function(){Uj.log("setUp");var J=this,z=J.gv,B=z.getView(),L=J._canvas;ws.superClass.setUp.call(J),z.setEditInteractor(J),z._79O?B.insertBefore(L,z._79O):B.appendChild(L),Uj.startEdit(z),J.invokeSubModule("setUp"),z.dm().mm(J._onDataModelChanged,J),z.dm().md(J._onDataPropertyChanged,J)},ws.prototype.tearDown=function(){Uj.log("tearDown");var M=this,J=M.gv,X=J.getView();M._resetCustomCursorStyle(),ws.superClass.tearDown.call(M),J.dm().umm(M._onDataModelChanged,M),J.dm().umd(M._onDataPropertyChanged,M),J.setEditInteractor(null),X.removeChild(M._canvas),M._drawTimer&&(rj(M._drawTimer),M._drawTimer=null),Uj._46O(J),M.invokeSubModule("tearDown")},ws.prototype._onDataModelChanged=function(e){var x=this;("clear"===e.kind||"remove"===e.kind&&x.editDetail&&e.data===x.getSubModule("Curve").target)&&(x.editDetail=!1,x._42())},ws.prototype._onDataPropertyChanged=function(R){var E=this;if(E.editDetail){var y=E.getSubModule("Curve"),t=R.data;t===y.target&&(t._writing||y._handleDataChanged(R))}},ws.prototype.clear=function(){Uj.log("clear")},ws.prototype.redraw=function(){this._42()},ws.prototype._42=function(){var o=this;o._drawTimer||(o._drawTimer=xq(function(){o._drawTimer=null,o.drawImpl()},0))},ws.prototype.drawImpl=function(){var A;for(A in{_42:!0})break;return function(){var a=this,X=a._canvas,S=a.gv,J=S.getWidth(),r=S.getHeight(),R=a._context,j=C.Default.getInternal(),$=G.devicePixelRatio;(X.width!==J||X.height!==r)&&j.setCanvas(X,J,r,$),R.clearRect(0,0,X.width,X.height);var o=a._getValidSelection();R.save(),R.scale($,$),a._gridGuide._42(),a.invokeSubModuleInverse(A,!1,R,S,o),a._rectGuide._42(),a._hoverGuide._42(),R.restore()}}(),ws.prototype._getValidSelection=function(){var z=this,W=z.gv,x=W.sm().getSelection(),F=[];return x.each(function(G){W.isVisible(G)&&W.isEditable(G)&&F.push(G)}),F},ws.prototype.handle_touchmove=function(k){return this.handle_mousemove(k)},ws.prototype.handle_mousemove=function(b){if(!C.Default.isDragging()){var U=this;if((U.editDetail||!Tr()&&!Ni(b))&&!U.gv._externalEditing)if(U.gvEditing=!1,U._checkEdit(b))U.gvEditing=!0;else{if(!U.getStyle("hoverGuideVisible"))return;U.hoverData=U.gv.getDataAt(b),U._42()}}},ws.prototype.handle_touchstart=function(f){return this.handle_mousedown(f)},ws.prototype.handle_mousedown=function(a){Uh(a);var g=this;if((g.editDetail||!Tr()&&!Ni(a))&&!g.gv._externalEditing){if(ar(a)&&!a.clickThrough){if(g.editDetail){if(g._tryQuitEditDetailMode(a))return}else if(g._tryEnterEditDetailMode())return;g.gv.dm().beginTransaction();var L=g.invokeSubModule("handleDoubleClick",!0,a);if(g.gv.dm().endTransaction(),L)return}var m=g._checkEdit(a);m&&(g._downPosition=g._getLogicalPoint(a),g.gv.dm().beginTransaction(),m.startEdit(g,a),g.editing=!0)}},ws.prototype._checkEdit=function(o){var B=this,U=B.gv,C=B._getLogicalPoint(o),s=B.invokeSubModule("check",!0,U,o,C)||null;return B._editMod=s,s},ws.prototype.handleWindowTouchMove=function(D){return this.handleWindowMouseMove(D)},ws.prototype.handleWindowMouseMove=function(U){var y=this,u=y._downPosition;if(u){var A=y._getLogicalPoint(U);if(A.distanceTo(u)<y.getStyle("moveSensitivity"))return;delete y._downPosition}var f=y._editMod;f&&f.handleEdit(y.gv,U)},ws.prototype._getLogicalPoint=function(H){var o=this,l=C.Default.getLogicalPoint(H,o._canvas);return new Uj.Math.Vector2(l)},ws.prototype.handleWindowTouchEnd=function(G){return this.handleWindowMouseUp(G)},ws.prototype.handleWindowMouseUp=function(){var D;for(D in{_46O:!0})break;return function(z){var a=this;a.editing=!1,a.setCursor("default"),a.invokeSubModule(D,!1,z),a._42(),a.gv.dm().endTransaction()}}(),ws.prototype.handle_mousewheel=function(C){var h=this;Uh(C),h.invokeSubModule("preHandleScroll",!0)||h.gv.handleScroll(C,C.wheelDelta)},ws.prototype.handleDelete=function(){var f=this;if(!f.editDetail){f.gv.dm().beginTransaction();var w=f.invokeSubModule("handleNormalStateDelete",!0);return f.gv.dm().endTransaction(),w||f.gv.removeSelection(),void 0}f.gv.dm().beginTransaction(),f.invokeSubModule("handleDelete",!0),f.gv.dm().endTransaction(),f._42()},ws.prototype.handle_keydown=function(m){var j=this;if((m.metaKey||m.ctrlKey)&&j._42(),Tr(m)&&!j.editing)return j.gvEditing=!1,j.setCursor("default"),j._42(),void 0;var d=Am(m);return j.editDetail?((d||Jk(m))&&(j.editDetail=!1,j._42()),j.gv.dm().beginTransaction(),j.invokeSubModule("handle_keydown",!0,m),j.gv.dm().endTransaction(),void 0):(j.gv.dm().beginTransaction(),j.invokeSubModule("handleNormalStateKeyDown",!0,m),j.gv.dm().endTransaction(),d&&j._tryEnterEditDetailMode(),void 0)},ws.prototype.handle_keyup=function(d){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,d),this.gv.dm().endTransaction()},ws.prototype._tryEnterEditDetailMode=function(){var b=this;return!b.editDetail&&b.invokeSubModule("canEnterEditDetailMode",!0)&&1===b._getValidSelection().length?(b.editDetail=!0,b._42(),!0):void 0},ws.prototype._tryQuitEditDetailMode=function(R){var E=this;return E.editDetail?!R||E.invokeSubModule("canQuitEditDetailMode",!0,R)?(E.editDetail=!1,E._42(),!0):!1:!1},ws.prototype.setStyle=function(Y,p,L){var j=this;L?Uj.setStyle(Y,p):j._styleMap[Y]=p,"baseColor"===Y&&(lo=p),j.fp("styleChanged",null,{key:Y,value:p,base:L}),j._42()},ws.prototype.getStyle=function(J){var D=this,g=D._styleMap[J];return g!==c?g:Uj.getStyle(J)},ws.prototype.setCursor=function(Q){this._resetCustomCursorStyle(),C.graph.EditInteractor.superClass.setCursor.call(this,Q)},ws.prototype._drawHostGuide=function(A){var G=this,d=G._context,U=G.gv;Uj.Icons.DrawIcon(G,d,Uj.Icons.NodeHoverGuide,A.corners);var B=A.host;if(B){var K=U.getAttachPoints(B);if(K&&K.length)for(var Q=0,I=K.length;I>Q;Q++){var k=K[Q],L=Kd(U,B,0,k.offsetX||0,k.offsetY||0,k.x,k.y);L=Uj.toScreenPosition(U,L),L.isAttach=A.attach===Q,Uj.Icons.DrawIcon(G,d,Uj.Icons.AttachPoint,L)}}},ws.prototype._resetCustomCursorStyle=function(){var Q=this;if(Q._customStyle){var p=this.gv.getView();p.classList&&p.classList.remove&&p.classList.remove(Q._customStyle),Q._customStyle=null}},ws.prototype._setRotateCursor=function(L){var J=this,x=J._cursorFactory;x||(x=J._cursorFactory=new Uj.CursorFactory(J));var w=x.getRotateCursor(L),H=J.gv.getView();J._resetCustomCursorStyle(),J._customStyle=w,H.classList&&H.classList.add&&H.classList.add(w)};var hs=Uj.Group=function(p){var U=this;U._entities=p,U._64O=0,U._position={x:0,y:0},U._scale={x:1,y:1},U._anchor={x:.5,y:.5},U._anchor2={x:.5,y:.5}};hs.prototype={},hs.prototype.constructor=hs;var si=null,fm=null;hs.findOrCreateGroup=function(s,q){if(fm===q&&si&&si.checkIsMe(s))return si;fm=q;var v=new Uj.Group(s);return v.getKeyOb()?(si=v,v):void 0},hs.prototype.checkIsMe=function($){var y=this._entities;if(y.length!==$.length)return!1;var S,m={},R=$.length;for(S=0;R>S;S++)m[$[S]._id]=!0;for(S=0;R>S;S++)if(!m[y[S]._id])return!1;return!0},hs.prototype.getRotation=function(){return this._64O},hs.prototype.getPosition=function(){return this._position},hs.prototype.getAnchor=function(){return this._anchor},hs.prototype.getWidth=function(){return this._width},hs.prototype.getScale=function(){return this._scale},hs.prototype.getSize=function(){return{width:this._width,height:this._height}},hs.prototype.getHeight=function(){return this._height},hs.prototype.getKeyOb=function(){for(var J=this._entities,t=J.length-1;t>=0;t--){var a=J[t];if(this.isNode(a))return a}},hs.prototype.getAnchor2=function(){var x=this,l=x.rotateCenter;if(l)return l;var A=x.getKeyOb();if(!A)return x._anchor;var p=x._anchor2,t=A.getMatrix();return t.tf({x:A.getWidth()*(p.x-A.getAnchor().x),y:A.getHeight()*(p.y-A.getAnchor().y)})},hs.prototype.setAnchor2=function(P,p){var X=this,e=X.getKeyOb();if(e){var E,h=e.getMatrix();E="number"==typeof P?{x:P,y:p}:P;var Q=h.tfi(E);X._anchor2={x:e.getAnchor().x+Q.x/e.getWidth(),y:e.getAnchor().y+Q.y/e.getHeight()}}},hs.prototype.setRotation=function(){},hs.prototype.beginRotate=function(b){this.rotateCenter=b.pos,this.rotateMode=b.groupRotateMode},hs.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},hs.prototype.addRotation=function(r,E,L){return"batch"===E?this._addRotationInBatchMode(r,L):"block"===E?this._addRotationInBlockMode(r,L):void 0},hs.prototype._addRotationInBlockMode=function(Q,W){var H=this,M=H.rotateCenter||H.getPosition();H._entities.forEach(function(l){if(H.isNode(l)&&(!W||W(l))){var E=l.getMatrix();E.translate(-M.x,-M.y),E.rotate(Q),E.translate(M.x,M.y);var i=Math.sign(l.getScale().x);l.setRotation(dj(E.b*i,E.a*i)),l.setPosition(E.tx,E.ty)}})},hs.prototype._addRotationInBatchMode=function(J,r){var Z=this,K=Z._anchor2;Z._entities.forEach(function(k){if(Z.isNode(k)&&(!r||r(k))){var x=k.getAnchor(),j=k.getMatrix(),b=j.tf({x:k.getWidth()*(K.x-x.x),y:k.getHeight()*(K.y-x.y)}),a=new Uj.Math.Matrix2d;a.set(j.a,j.b,j.c,j.d,j.tx,j.ty),a.translate(-b.x,-b.y),a.rotate(J),a.translate(b.x,b.y);var N=Math.sign(k.getScale().x);k.setRotation(dj(a.b*N,a.a*N)),k.setPosition(a.tx,a.ty)}})},hs.prototype.setPosition=function(b){var Y,X,g,s,G=this,N=G._position,O=b.x-N.x,i=b.y-N.y,S=G._entities;for(X=0,g=S.length;g>X;X++)Y=S[X],Je(Y)&&(s=Y.getPosition(),Y.setPosition(s.x+O,s.y+i));G._position=b},hs.prototype.setScale=function(O,x){var u=this,A=O/u._scale.x,e=x/u._scale.y;u._adjustChildScaleOrSize(A,e,"size"),u._scale={x:O,y:x}},hs.prototype.getRect=function(){var O=this,i=O._position,l=O._width,q=O._height;return{x:i.x-l/2,y:i.y-q/2,width:l,height:q}},hs.prototype.setSize=function(h,B){var W=this,h=Math.max(1,h),B=Math.max(1,B),o=h/W._width,J=B/W._height;W._adjustChildScaleOrSize(o,J,"size"),W._width=h,W._height=B},hs.prototype._adjustChildScaleOrSize=function(o,f,K){var m,q,T,i,j,A,y,W,s,X,G,V,J,t,d=this,L=d._position,c=d._entities,h=new Uj.Math.Matrix2d;for(q=0,T=c.length;T>q;q++)if(m=c[q],d.isNode(m)){if(i=m.getPosition(),j=m.getRotation(),A=m.getWidth(),y=m.getHeight(),W=m.getScale(),G=W.x*A,V=W.y*y,h.identity().scale(G,V).rotate(j).translate(i.x,i.y).translate(-L.x,-L.y).rotate(-d._64O),j=dj(h.b*Math.sign(G),h.a*Math.sign(G)),h.scale(o,f),s=Math.cos(j),X=Math.sin(j),Math.abs(s)<.001?(J=h.b/X,t=-h.c/X):(J=h.a/s,t=h.d/s),"scale"===K)m.setScale(J/A,t/y);else if("size"===K){var P=J/W.x,k=t/W.y;m.setScale(ki(J)*Math.abs(W.x),ki(t)*Math.abs(W.y)),m.setSize(Math.max(.1,Math.abs(P)),Math.max(.1,Math.abs(k)))}h.rotate(d._64O).translate(L.x,L.y),m.setPosition(h.tx,h.ty)}},hs.prototype.getMatrix=function(){var z=this,U=z._position,h=C.Default.getInternal(),Q=z._scale;return new h.Mat(z._64O,U.x,U.y,Q.x,Q.y)},hs.prototype.toGlobal=function(K){return this.getMatrix().tf(K)},hs.prototype.getCorners=function(){var b=this,f=b._width,G=b._height,X=b._anchor,W=-f*X.x,g=-G*X.y,$=b.getMatrix();return[$.tf(W,g),$.tf(W,g+G),$.tf(W+f,g+G),$.tf(W+f,g)]},hs.prototype.calcInfo=function(){var D,x,h,C,s,u,c=this,q=[],g=c._entities,Z=c._64O;for(C=0,s=g.length;s>C;C++)u=g[C],c.isNode(u)&&u.getCorners&&q.push.apply(q,u.getCorners());if(q.length){var P=Math.cos(-Z),T=Math.sin(-Z),z=1/0,J=-1/0,Q=1/0,S=-1/0;for(C=0,s=q.length;s>C;C++)h=q[C],D=h.x,x=h.y,h.x=P*D-T*x,h.y=T*D+P*x,z=Math.min(z,h.x),J=Math.max(J,h.x),Q=Math.min(Q,h.y),S=Math.max(S,h.y);c._width=(J-z)/c._scale.x,c._height=(S-Q)/c._scale.y,P=Math.cos(Z),T=Math.sin(Z);var r=c._anchor;D=z+(J-z)*r.x,x=Q+(S-Q)*r.y,c._position={x:P*D-T*x,y:T*D+P*x}}},hs.prototype.isNode=function(j){return Je(j)?tm(j)?j.size()?!1:!0:!0:!1},hs.prototype._42=function(V,J,i){var n,b,G,P,v,y,C,o,F=this,h=F._entities,m=F.rotateMode;for("batch"===m&&(o=F.getKeyOb()),n=0,b=h.length;b>n;n++)G=h[n],F.isNode(G)&&(y=G.getRect(),P=Uj.toScreenPosition(i,{x:y.x,y:y.y}),v=Uj.toScreenPosition(i,{x:y.x+y.width,y:y.y+y.height}),C={min:P,max:v},G===o&&(C.isKeyOb=!0),Uj.Icons.DrawIcon(V,J,Uj.Icons.GroupSubEntityRect,C))};var Xq=Uj.CurveActiving=function(p,e){this._curve=p,this._interactor=p._interactor,this.silent=!0;for(var c in e)this[c]=e[c];delete this.silent};Xq.prototype={},Xq.prototype.constructor=Xq,g.defineProperties(Xq.prototype,{point:{get:function(){return this._point},set:function(G){var I=this;I._point=G,I.editingCtrl||I.silent||I._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(r){var w=this;w._pairs=r,w.editingCtrl&&!w.silent&&w._firePointChange()}}}),Xq.prototype._firePointChange=function(){var f=this,p=f.getCurrentEditingPoint(),T=f._interactor;if(!p)return T.fi({kind:"selectPoint"}),void 0;var u=this._curve.target;if(u){var Y=Uj.getDataMatrix(u).invert(),k=p.e;p=Y.apply(Uj.toWorldPosition(T.gv,p)),p.e=k;var K=f._lastFirePoint;K&&Math.abs(p.x-K.x)<1e-5&&Math.abs(p.y-K.y)<1e-5&&(p.e==c&&K.e==c||Math.abs(p.e-K.e)<1e-5)||(f._lastFirePoint=p,T.fi({kind:"selectPoint",x:p.x,y:p.y,e:p.e}))}},Xq.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Xq.prototype.getCurrentEditingPoint=function(){var r=this,t=r.editingCtrl;if(t){var R=r.pairs;if(R){var c=R[t.pairId];if(c){var A=c[t.type];if(A)return A}}}return r._point};var Qp=Uj.CursorFactory=function(m){var Z=this;Z._interactor=m,Z._rotateCursorStyles={}};Qp.prototype={},Qp.prototype.constructor=Qp,Qp.prototype.getRotateCursor=function(L){var C=this;0>L&&(L+=2*Math.PI);var o=C._interactor,n=o.getStyle("rotateCursorSize"),a=o.getStyle("rotateCursorRound"),g=Math.round(180*(L/Math.PI)/a);g*a>=360&&(g=0);var K=C._rotateCursorStyles,Q="htCustomRotateStyle_"+n+"_"+a+"_"+g;return K[Q]||(C._produceRotateCursor(Q,n,a,g),K[Q]=!0),Q},Qp.prototype._produceRotateCursor=function(q,z,i,l){var R=this;R._interactor;var I=R._canvas;I||(I=R._canvas=X.createElement("canvas"));var B=G.devicePixelRatio;I.width=I.height=z*B,I.style.width=I.style.height=z+" px";var P=I.getContext("2d");Uj.setAntialias(P,!1),P.scale(B,B);var f,O,h,K,S,M=Math.round(z/2),s=""+M+" "+M+",auto !important;",Z=4;f=Math.PI/180*l*i,P.clearRect(0,0,z,z),P.save(),P.scale(z/32,z/32),P.translate(16,15),P.rotate(f+Math.PI/2),P.beginPath(),P.moveTo(-8,0),P.lineTo(-8,Z),P.lineTo(-8+Z,Z),P.moveTo(8,0),P.lineTo(8,Z),P.lineTo(8-Z,Z),P.moveTo(-8,Z),P.quadraticCurveTo(0,-6,8,Z),P.restore(),P.lineCap="round",P.lineJoin="miter",P.strokeStyle="white",P.lineWidth=4,P.stroke(),P.strokeStyle="black",P.lineWidth=2,P.stroke(),O=JSON.stringify(I.toDataURL()),K="cursor:url("+O+")"+s,1!==B&&(h='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+z+'px" height="'+z+'px"><image xlink:href='+O+' width="'+z+'" height="'+z+'"/></svg>',K+="cursor:url(data:image/svg+xml;base64,"+btoa(h)+")"+s,K+="cursor:-webkit-image-set(url("+O+")"+B+"x,url("+O+")1x)"+s),S=X.createElement("style"),S.textContent="body."+q+" *, ."+q+"{"+K+"}",X.head.appendChild(S)};var ti=Uj.Guide.Grid=function(L){var R=this;R._interactor=L,R._alignmentGuideId=0,R._xAlignmentGuide=[],R._yAlignmentGuide=[]};ti.prototype={},ti.prototype.constructor=ti,g.defineProperties(ti.prototype,{gridBlockSize:{get:function(){var u=this;return u._gridBlockSize||u._interactor.getStyle("gridBlockSize")},set:function(b){this._gridBlockSize=b,this._interactor._42()}},gridThickLinesEvery:{get:function(){var Q=this;return Q._gridThickLinesEvery||Q._interactor.getStyle("gridThickLinesEvery")},set:function($){this._gridThickLinesEvery=$,this._interactor._42()}},gridEnabled:{get:function(){var U=this,S=U._interactor;return S.gridEnabled&&U.isValidGrid()}}}),ti.prototype._42=function(){var d=this,E=d._interactor;d.gridEnabled&&d.drawGrid(),E.alignmentGuideEnabled&&d.drawAlignmentGuide()},ti.prototype.makeMatrix=function(){var V=this,Y=V._interactor.getStyle("gridAngle"),J=V._interactor.getStyle("gridRotation"),q=new Uj.Math.Matrix2d,A=Math.sin(Y),y=Math.cos(Y);return q.set(1,0,y,A,0,0),q.rotate(J),q},ti.prototype.isValidGrid=function(){var W=this,h=Math.PI,e=W._interactor,$=e.gv;if($._zoom<e.getStyle("gridZoomThreshold"))return!1;var Q=e.getStyle("gridAngle"),B=Math.abs(180*(Q%h/h)),z=1-1e-8;return z>B||B>180-z?!1:!0},ti.prototype.drawAlignmentGuide=function(){var P=this,m=P._interactor,D=m.gv,$=m._canvas,d=m._context,M=$.width,K=$.height,l=D.tx(),X=D.ty(),h=D._zoom;d.beginPath(),d.strokeStyle=m.getStyle("gridAlignmentGuideColor"),d.lineWidth=1,P._xAlignmentGuide.forEach(function(F){var n=F.p*h+l;d.moveTo(n,0),d.lineTo(n,K)}),P._yAlignmentGuide.forEach(function(R){var A=R.p*h+X;d.moveTo(0,A),d.lineTo(M,A)}),d.stroke()},ti.prototype.drawGrid=function(){function S(v,o,g,M){var K=Uj.toScreenPosition(V,r.apply({x:v,y:o})),H=Uj.toScreenPosition(V,r.apply({x:g,y:M}));Z.moveTo(K.x,K.y),Z.lineTo(H.x,H.y)}var p=this,q=p._interactor,E=p.gridBlockSize,k=p.gridThickLinesEvery,u=q.getStyle("gridThickColor"),c=q.getStyle("gridLightColor"),V=q.gv,B=q._canvas,Z=q._context,f=B.width,v=B.height,r=p.makeMatrix(),$=r.applyInverse(Uj.toWorldPosition(V,{x:0,y:0})),Q=r.applyInverse(Uj.toWorldPosition(V,{x:f,y:0})),z=r.applyInverse(Uj.toWorldPosition(V,{x:0,y:v})),C=r.applyInverse(Uj.toWorldPosition(V,{x:f,y:v})),A=Math.min($.x,Q.x,z.x,C.x),l=Math.max($.x,Q.x,z.x,C.x),Y=Math.min($.y,Q.y,z.y,C.y),h=Math.max($.y,Q.y,z.y,C.y);f=l-A,v=h-Y;var e=Math.ceil(A/E),U=Math.floor(l/E),H=Math.ceil(Y/E),W=Math.floor(h/E);V.tx(),V.ty(),V._zoom;var x,I,P;for(Z.save(),Z.lineWidth=1,Z.beginPath(),Z.strokeStyle=u,P=Math.ceil(e/k)*k;U>=P;P+=k)x=P*E,S(x,Y,x,h);for(P=Math.ceil(H/k)*k;W>=P;P+=k)I=P*E,S(A,I,l,I);for(Z.stroke(),Z.beginPath(),Z.strokeStyle=c,P=e;U>=P;P++)0!==P%k&&(x=P*E,S(x,Y,x,h));for(P=H;W>=P;P++)0!==P%k&&(I=P*E,S(A,I,l,I));Z.stroke(),Z.restore()},ti.prototype.getAlignmentGuides=function(){var p=this;return{x:p._xAlignmentGuide,y:p._yAlignmentGuide}},ti.prototype.addAlignmentGuide=function(F,T,y){var h=this,b="x"===F?h._xAlignmentGuide:h._yAlignmentGuide,y=y?y:++h._alignmentGuideId,H={p:T,id:y};if(b.length){var m=h._findClosestAlignmentGuide(H.p,b);m.dis<0?b.splice(m.index+1,0,H):b.splice(m.index,0,H)}else b.push(H);return h._interactor._42(),y},ti.prototype.findClosest=function(E,Z,o){var s=this,P=s._interactor,f=P.gv;o&&(E=Uj.toWorldPosition(f,E));var u,I,q,d=1/0,A=1/0,v=E.x,O=E.y;if(s.gridEnabled){var l=s.gridBlockSize,Q=s.makeMatrix(),$=Q.applyInverse(E);$=Q.apply({x:Math.round($.x/l)*l,y:Math.round($.y/l)*l}),d=$.x-v,A=$.y-O,q=!0}if(P.alignmentGuideEnabled&&(u=s._findClosestAlignmentGuide(v,s._xAlignmentGuide).dis,I=s._findClosestAlignmentGuide(O,s._yAlignmentGuide).dis,Math.abs(u)<Math.abs(d)&&(d=u,q=!0),Math.abs(I)<Math.abs(A)&&(A=I,q=!0)),q){q=!1;var m=f._zoom,G=P.getStyle("smartGuideThreshold")/m,R={};if(Math.abs(d)<G&&"y"!==Z&&(R.x=o?d*m:d,q=!0),Math.abs(A)<G&&"x"!==Z&&(R.y=o?A*m:A,q=!0),q)return R}},ti.prototype._findClosestAlignmentGuide=function(p,W){if(!W.length)return{dis:1/0};for(var Y,K=0,U=W.length-1;U-K>1;)Y=Math.floor((K+U)/2),W[Y].p<p?K=Y:U=Y;var N=W[K].p-p,H=W[U].p-p;return Math.abs(N)<=Math.abs(H)?{line:W[K],dis:N,index:K}:{line:W[U],dis:H,index:U}},ti.prototype.removeAllAlignmentGuide=function(W){var R=this;"y"!==W&&(R._xAlignmentGuide=[]),"x"!==W&&(R._yAlignmentGuide=[]),R._interactor._42()},ti.prototype.removeAlignmentGuide=function(w){for(var L,K,p,f=this,U=f._xAlignmentGuide,N=0;2>N;N++)for(U=0===N?f._xAlignmentGuide:f._yAlignmentGuide,L=0,K=U.length;K>L;L++)if(p=U[L],p.id===w)return U.splice(L,1),f._interactor._42(),{axis:0===N?"x":"y",position:p.p};return!1},ti.prototype.adjustAlignmentGuide=function(t,p){var Q=this,u=Q.removeAlignmentGuide(t);return u?(Q.addAlignmentGuide(u.axis,p,t),!0):!1};var ye=Uj.Guide.Rect=function(n){var Z=this;Z._interactor=n};ye.prototype={},ye.prototype.constructor=ye,ye.prototype.gatherRects=function(){var K,b,Z,T,j=this,n=j._interactor.gv,w=[],c=[],N={x:w,y:c},u={},P=n.getDataModel(),F=P.a("width"),v=P.a("height");F&&v&&(K=0,b=0,Z=F,T=v,w.push({node:P,type:0,p:K},{node:P,type:1,p:K+Z/2},{node:P,type:2,p:K+Z}),c.push({node:P,type:0,p:b},{node:P,type:1,p:b+T/2},{node:P,type:2,p:b+T}),u[P._id||0]={x:K,y:b,width:Z,height:T}),P.each(function(M){if(Je(M)&&!n.isSelected(M)&&n.isVisible(M)&&n.isValidGuideLineSource(M)){var y=!1;if(n.sm().getSelection().each(function(R){y||(M.isHostOn(R)?y=!0:M.isDescendantOf(R)&&(y=!0))}),!y){var I=M.getRect();K=I.x,b=I.y,Z=I.width,T=I.height,w.push({node:M,type:0,p:K},{node:M,type:1,p:K+Z/2},{node:M,type:2,p:K+Z}),c.push({node:M,type:0,p:b},{node:M,type:1,p:b+T/2},{node:M,type:2,p:b+T}),u[M._id]=I}}}),w.sort(function(r,$){return r.p-$.p}),c.sort(function(G,b){return G.p-b.p}),j._grid=N,j._87I=u},ye.prototype.gatherLines=function(E,L,J){var G,P,x,C,X,k,Z,l,D,Q,B,c,r=this,i=[r.findClosest({x:E.x,y:E.y},L),r.findClosest({x:E.x+E.w/2,y:E.y+E.h/2},L),r.findClosest({x:E.x+E.w,y:E.y+E.h},L)],Y={},O=r._87I;J=J||255;var y,n;for(r._guideLine=[],G=0;2>G;G++)for(Y={},0===G?(C="y",l=E.x,D=l+E.w):(C="x",l=E.y,D=l+E.h),P=0;3>P;P++)X=i[P],X&&isFinite(X[C])&&(y=1<<3*G+P,J&y&&(k=X[C+"Line"],Z=k.node,n=Z._id||0,Y[n]||(Y[n]=!0,c=O[n],"y"===C?(Q=c.x,B=c.x+c.width):(Q=c.y,B=c.y+c.height),x=k.p,r._guideLine.push({type:C,a:l,b:D,c:Q,d:B,p:x,center:1===k.type}))))},ye.prototype._binarySearchClosest=function(B,Y){if(!Y.length)return{dis:1/0};for(var H,i=0,F=Y.length-1;F-i>1;)H=Math.floor((i+F)/2),Y[H].p<B?i=H:F=H;var b=Y[i].p-B,Q=Y[F].p-B;return Math.abs(b)<=Math.abs(Q)?{line:Y[i],dis:b}:{line:Y[F],dis:Q}},ye.prototype.findClosest=function(B,N,c){var m=this,t=m._interactor,C=t.gv,r=m._grid;c&&(B=Uj.toWorldPosition(C,B));var O,y=m._binarySearchClosest(B.x,r.x),E=m._binarySearchClosest(B.y,r.y),T=y.dis,j=E.dis,i=C._zoom,s=t.getStyle("smartGuideThreshold")/i,h={};return Math.abs(T)<s&&"y"!==N&&(h.x=c?T*i:T,h.xLine=y.line,O=!0),Math.abs(j)<s&&"x"!==N&&(h.y=c?j*i:j,h.yLine=E.line,O=!0),O?h:void 0},ye.prototype._42=function(){var e=this,j=e._guideLine;if(j&&!C.Default.isCtrlDown()){var O=e._interactor;if(O.getStyle("guideLineVisible")){var J,z,b,L,A,K,Z,X,h,M,B,_,d,t,$,S,x,c=O.gv,U=O._context,v=c.tx(),W=c.ty(),k=c._zoom,o=O.getStyle("guideLineTextSpacing");for(J=0,z=j.length;z>J;J++)b=j[J],X=b.type,h=b.p,M=b.a,B=b.b,_=b.c,d=b.d,t=Math.min(M,_),$=Math.max(B,d),"x"===X?(L=h*k+v,A=t*k+W,K=L,Z=$*k+W):(L=t*k+v,A=h*k+W,K=$*k+v,Z=A),Uj.Icons.DrawIcon(O,U,Uj.Icons.MoveLineGuide,{rect:[L,A,K,Z],center:b.center}),d>=M&&B>=_||(t=M>d?d:B,$=M>d?M:_,x=$-t,"x"===X?(b.center2center||(L-=o,K=L),A=t*k+W,Z=$*k+W,S=Uj.Icons.MoveLineGuideDistanceV):"y"===X&&(b.center2center||(A-=o,Z=A),L=t*k+v,K=$*k+v,S=Uj.Icons.MoveLineGuideDistanceH),Uj.Icons.DrawIcon(O,U,S,{x0:L,y0:A,x1:K,y1:Z,dis:x}))
}}},ye.prototype.clear=function(){this._guideLine=null};var Lj=Uj.Guide.Hover=function(K){var B=this;B._interactor=K};Lj.prototype={},Lj.prototype.constructor=Lj,g.defineProperties(Lj.prototype,{}),Lj.prototype._42=function(){var R=this._interactor;if(R.getStyle("hoverGuideVisible")&&!R.gvEditing){var P=R.hoverData,z=R.gv;if(!Je(P)||z.isSelected(P))return R.hoverData=null,void 0;var M=Zc(z,P),m=Uj.toScreenPosition(z,{x:M.x,y:M.y}),C=Uj.toScreenPosition(z,{x:M.x+M.width,y:M.y+M.height});Uj.Icons.DrawIcon(R,R._context,Uj.Icons.HoverDataRect,{min:m,max:C,color:R.getStyle("hoverGuideColor")||R.getStyle("baseColor"),borderWidth:R.getStyle("hoverGuideBorderWidth")||1,borderPattern:R.getStyle("hoverGuideBorderPattern")||[1,4]})}},Uj.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,rotateTipVisible:!0,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var pm=Uj.Icons={},Rd=1e4,Ih=null,lo=Uj.DefaultStyleMap.baseColor,Yl="rgb(183,232,135)",De="rgb(255,204,153)",yj=6;C.Default.setImage("Icons.RectPoint",{width:yj,height:yj,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return lo}},rect:[0,0,yj,yj]}]}),pm.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var d=pm.GroupSubEntityRect.data;if(!d)return[];var b=d.min,X=d.max;return[b.x,b.y,b.x,X.y,X.x,X.y,X.x,b.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return pm.GroupSubEntityRect.data.isKeyOb?lo:lo}}}]};var dp=4;pm.HoverDataRect={comps:[{type:"shape",points:{func:function(){var E=pm.HoverDataRect.data;if(!E)return[];var h=E.min,d=E.max,A=dp;return h.x-=A,h.y-=A,d.x+=A,d.y+=A,[h.x,h.y,h.x,d.y,d.x,d.y,d.x,h.y]}},segments:[1,2,2,2,5],background:null,borderWidth:{func:function(){return pm.HoverDataRect.data.borderWidth}},borderColor:{func:function(){return pm.HoverDataRect.data.color}},borderCap:"butt",borderPattern:{func:function(){return pm.HoverDataRect.data.borderPattern}}}]},pm.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[pm.Line.data.P1.x,pm.Line.data.P1.y],yj,yj]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[pm.Line.data.P2.x,pm.Line.data.P2.y],yj,yj]}}}]},pm.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return pm.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},pm.Rect={comps:[{type:"shape",points:{func:function(){var t=pm.Rect.data;if(!t)return[];var s=t.LT,W=t.LB,I=t.RB,c=t.RT;return[s.x,s.y,W.x,W.y,I.x,I.y,c.x,c.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return lo}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return pm.Rect.data.rotation}},rect:{func:function(){return[[pm.Rect.data.LT.x,pm.Rect.data.LT.y],yj,yj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return pm.Rect.data.rotation}},rect:{func:function(){return[[pm.Rect.data.LB.x,pm.Rect.data.LB.y],yj,yj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return pm.Rect.data.rotation}},rect:{func:function(){return[[pm.Rect.data.RB.x,pm.Rect.data.RB.y],yj,yj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return pm.Rect.data.rotation}},rect:{func:function(){return[[pm.Rect.data.RT.x,pm.Rect.data.RT.y],yj,yj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return pm.Rect.data.rotation}},visible:{func:function(){return pm.Rect.data.L?!0:!1}},rect:{func:function(){return[[pm.Rect.data.L.x,pm.Rect.data.L.y],yj,yj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return pm.Rect.data.rotation}},visible:{func:function(){return pm.Rect.data.R?!0:!1}},rect:{func:function(){return[[pm.Rect.data.R.x,pm.Rect.data.R.y],yj,yj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return pm.Rect.data.rotation}},visible:{func:function(){return pm.Rect.data.T?!0:!1}},rect:{func:function(){return[[pm.Rect.data.T.x,pm.Rect.data.T.y],yj,yj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return pm.Rect.data.rotation}},visible:{func:function(){return pm.Rect.data.B?!0:!1}},rect:{func:function(){return[[pm.Rect.data.B.x,pm.Rect.data.B.y],yj,yj]}}}]};var ms=16;C.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return lo}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return lo}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),pm.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[pm.Anchor.data.POS.x,pm.Anchor.data.POS.y],ms,ms]}}}]},pm.TipShiftX=12,pm.TipShiftY=12;var yr=[8,28];pm.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[pm.TipHelper.data.helperPos.x,pm.TipHelper.data.helperPos.y,yr[0]*pm.TipHelper.data.size,yr[1]]}},background:{func:function(){return Ih.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return pm.TipHelper.data.text}},rect:{func:function(){return[pm.TipHelper.data.helperPos.x,pm.TipHelper.data.helperPos.y,yr[0]*pm.TipHelper.data.size,yr[1]]}},color:{func:function(){return Ih.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var vj=7;pm.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!pm.ShapePoint.data.dynamicVisible}},rect:{func:function(){var G=pm.ShapePoint.data.point,W=pm.ShapePoint.data.size||vj;return[G,W+10,W+10]}},background:{func:function(){var m=Date.now(),F=pm.ShapePoint.data.dynamicPeriod||1500,o=Math.sin(m%F/F*Math.PI);return"rgba(27,124,22,"+.5*o+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var a=pm.ShapePoint.data.point,$=pm.ShapePoint.data.size||vj;return[a,$,$]}},background:{func:function(){var J=pm.ShapePoint.data.isEnd;return J?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return pm.ShapePoint.data.color||lo}}},{type:"rect",visible:{func:function(){return!!pm.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return lo}},rect:{func:function(){var $=5;return[pm.ShapePoint.data.point,$,$]}}}]},pm.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!pm.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return pm.ShapeBgCurve.data.P}},segments:{func:function(){return pm.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var t=Date.now(),V=pm.ShapeBgCurve.data.dynamicPeriod||1500,I=Math.sin(t%V/V*Math.PI);return"rgba(27,124,22,"+.3*I+")"}}},{type:"shape",points:{func:function(){return pm.ShapeBgCurve.data.P}},segments:{func:function(){return pm.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return pm.ShapeBgCurve.data.color||lo}}}]};var el=8;pm.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var p=pm.ShapeHighlighPoint.data;return[[p.x,p.y],el,el]}},background:{func:function(){return Ih.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var ci=10;pm.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var x=pm.ShapeHighlighRealPoint.data;return[[x.x,x.y],ci,ci]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return lo}}}]};var Ei=8;pm.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var W=pm.ShapeHighlighCtrlPoint.data,G=W.x,$=W.y,f=Ei/2;return[G-f,$-f,G-f,$+f,G+f,$+f,G+f,$-f]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Ih.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Ih.getStyle("shapeCtrlPointBorderColor")||lo}}}]};var yk=3;pm.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return pm.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:yk,borderColor:{func:function(){return Ih.getStyle("curveHighlightColor")}}}]},pm.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return pm.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},pm.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return pm.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return pm.MoveLineGuide.data.center?Yl:De}}}]};var lj=5;pm.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var E=pm.MoveLineGuideDistanceH.data,U=E.x0,w=E.y0;return[U,w-lj,U,w+lj]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:De},{type:"shape",points:{func:function(){var D=pm.MoveLineGuideDistanceH.data,l=D.x1,s=D.y1;return[l,s-lj,l,s+lj]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:De},{type:"text",text:{func:function(){return Math.round(pm.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var q=pm.MoveLineGuideDistanceH.data;return[[(q.x0+q.x1)/2,q.y0-10],20,20]}},color:De,font:"12px Arial",align:"center"}]},pm.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var x=pm.MoveLineGuideDistanceV.data,i=x.x0,b=x.y0;return[i-lj,b,i+lj,b]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:De},{type:"shape",points:{func:function(){var T=pm.MoveLineGuideDistanceV.data,I=T.x1,v=T.y1;return[I-lj,v,I+lj,v]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:De},{type:"text",text:{func:function(){return Math.round(pm.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var C=pm.MoveLineGuideDistanceV.data;return[[C.x0-10,(C.y0+C.y1)/2],20,20]}},color:De,font:"12px Arial",align:"center"}]},C.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),pm.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var H=pm.EdgeElevationGuide.data,C=H.x,q=H.y,v=Ih.getStyle("curveElevationIntersectSize"),B=Ih.getStyle("curveElevationGuideShift");return C+=B[0],q+=B[1],[C-v,q-v,2*v,2*v]}}}]},C.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),C.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),pm.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return pm.ConnectGuide.data.rotation}},rect:{func:function(){var K=pm.ConnectGuide.data.connect;K.x,K.y;var F=Ih.getStyle("connectGuideIntersectSize");return[[K.x,K.y],2*F,2*F]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var J=pm.ConnectGuide.data.cursorPos||pm.ConnectGuide.data.connect,A=Ih.getStyle("connectGuideIntersectSize");return[[J.x,J.y],2*A-2,2*A-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var p=pm.ConnectGuide.data.connect,f=pm.ConnectGuide.data.cursorPos||p;return[p.x,p.y,p.x+.5*(f.x-p.x),p.y,f.x+.5*(p.x-f.x),f.y,f.x,f.y]}}}]},C.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),C.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),pm.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var g=pm.ConnectGuideGarbage.data.hover;return g?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var t=pm.ConnectGuideGarbage.data,n=Ih.getStyle("connectGuideGarbageIntersectsize");return t.hover&&(n+=5),[[t.x,t.y],2*n,2*n]}}}]};var po=6;pm.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return pm.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var $=pm.ShapeActivingCtrl.data;return[$.point.x,$.point.y,$.c1.x,$.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return lo}}},{type:"shape",visible:{func:function(){return pm.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var $=pm.ShapeActivingCtrl.data;return[$.point.x,$.point.y,$.c2.x,$.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return lo}}},{type:"shape",visible:{func:function(){return pm.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var l=pm.ShapeActivingCtrl.data.c1,i=l.x,W=l.y,K=po/2;return"c1"===pm.ShapeActivingCtrl.data.hl&&(K+=.5),[i-K,W-K,i-K,W+K,i+K,W+K,i+K,W-K]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Ih.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===pm.ShapeActivingCtrl.data.hl?Ih.getStyle("shapeCtrlPointHighlightBorder")||lo:Ih.getStyle("shapeCtrlPointBorderColor")||lo}}},{type:"shape",visible:{func:function(){return pm.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var D=pm.ShapeActivingCtrl.data.c2,v=D.x,O=D.y,q=po/2;return"c2"===pm.ShapeActivingCtrl.data.hl&&(q+=.5),[v-q,O-q,v-q,O+q,v+q,O+q,v+q,O-q]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Ih.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===pm.ShapeActivingCtrl.data.hl?Ih.getStyle("shapeCtrlPointHighlightBorder")||lo:Ih.getStyle("shapeCtrlPointBorderColor")||lo}}}]},pm.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return lo}},rect:{func:function(){return[[pm.RoundPoint.data.x,pm.RoundPoint.data.y],yj,yj]}}}]},pm.AttachPoint={comps:[{type:"rect",background:{func:function(){return pm.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return lo}},rect:{func:function(){var K=pm.AttachPoint.data.isAttach?yj+4:yj;return[[pm.AttachPoint.data.x,pm.AttachPoint.data.y],K,K]}}}]},pm.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return pm.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return pm.SimpleRect.data.color||lo}},rect:{func:function(){var l=pm.SimpleRect.data;return[l.x,l.y,l.width,l.height]}}}]},C.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),pm.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var y=pm.MoveDummy.data;return[[y.pos.x,y.pos.y],2*y.size,2*y.size]}}}]},Uj.Icons.DrawIcon=function(S,j,B,L){B.width=B.height=Rd,B.data=L,Ih=S,C.Default.drawImage(j,B,0,0,Rd,Rd),Ih=c},Uj.Icons.MapPoints=function(x,i){for(var p=0,l=x.length;l>p;p++)x[p]/=i},Uj.roundTo=function(P,r,D){var R=Math.abs(P%r);return D>R||D>r-R?r*Math.round(P/r):P},Uj.toFixed=function(H){return Math.round(100*H)/100},Uj.getDataMatrix=function(O){if(O instanceof C.Shape){var Z=new C.Math.Matrix2d,G=O.getPosition();return Z.translate(-G.x,-G.y).scale(O.getScale().x,O.getScale().y).rotate(O.getRotation()).translate(G.x,G.y),Z}return O.getMatrix?O.getMatrix():new C.Math.Matrix2d};var Pd=Uj.Math.Curve=function(){this._curves=[]};Pd.prototype={},Pd.prototype.constructor=Pd,Pd.prototype.createFromHtShape=function(Z,N,n){N instanceof C.List&&(N=N.toArray());var O,S,V,i,s,v,K,U=this,W=null,F=null,g=0,z=Uj.Math.Vector2,d=Uj.Math.CubicBezier,t=function(w){return new z(Z[w],Z[w+1],n?n[w/2]:c)};for(S=0,V=N.length;V>S;S++){switch(i=N[S],s=null,i){case 1:F=t(g),W=F,g+=2;break;case 2:O=t(g),g+=2,s=new d(F,F.clone(),O.clone(),O),F=O;break;case 3:v=t(g),O=t(g+2),g+=4,s=new d(F,v.clone().sub(F).multiplyScalar(2/3).add(F),v.clone().sub(O).multiplyScalar(2/3).add(O),O),F=O;break;case 4:v=t(g),K=t(g+2),O=t(g+4),g+=6,s=new d(F,v,K,O),F=O;break;case 5:if(!W)break;s=new d(F,F.clone(),W.clone(),W),F=null,W=null}s&&(s._index=U._curves.length,U._curves.push(s))}},Pd.prototype.checkPoint=function(x,U){var Z,z,F,c,d,l=this,L=l._curves;for(Z=0,z=L.length;z>Z;Z++)if(c=L[Z],d=c.intersectRect(x,U,U),d.length)return F=0,d.forEach(function(J){F+=J.t}),F/=d.length,x=c.getPointAt(F),x.t=F,{bezier:c,intersection:x}},Pd.prototype.insertKnot=function(Q,z){var t=Q.insertKnot(z),e=this,w=e._curves;w.splice(Q._index,1,t[0],t[1])},Pd.prototype._isCloseEnough=function(s,D){return Math.abs(s.x-D.x)<1e-6&&Math.abs(s.y-D.y)<1e-6},Pd.prototype._isSamePoint=function(H,u){return H===u},Pd.prototype.moveRealPoint=function(v,Z){var p=this,y=p._curves,b=Z.clone().sub(v);y.forEach(function(j){var n=j._p1;j._p2,j._p3;var u=j._p4;p._isSamePoint(n,v)&&(j._p2.add(b),j._p1=Z),p._isSamePoint(u,v)&&(j._p3.add(b),j._p4=Z)})},Pd.prototype.moveCtrlDueToRealPointMovement=function(o,G){var W=this,I=W._curves,h=function(q){q.add(G),q.e&&G.e&&(q.e+=G.e)};I.forEach(function(G){var L=G._p1;G._p2,G._p3;var d=G._p4;W._isSamePoint(L,o)&&h(G._p2),W._isSamePoint(d,o)&&h(G._p3)})},Pd.prototype.moveCtrlPoint=function(t,u,B){var x=t[B];if(x){x.e!==c&&(u.e=x.e);var D=this,f=D._curves;u.clone().sub(x),f.forEach(function(s){var U;"c2"===B?U="_p2":"c1"===B&&(U="_p3"),D._isSamePoint(s[U],x)&&(s[U]=u)}),t[B]=u}},Pd.prototype.deleteRealPoint=function(a,D){var u,p,f,B,N,Y,$,g=this,y=g._curves,i={},Z=[],r=Uj.Math.CubicBezier;for(p=0,f=y.length;f>p;p++)u=y[p],B=u._p1,N=u._p2,Y=u._p3,$=u._p4,(i[p]||!g._isSamePoint(B,a))&&(g._isSamePoint($,a)?f>p+1&&g._isSamePoint(y[p+1]._p1,a)&&(D||Z.push(new r(B,N,y[p+1]._p3,y[p+1]._p4))):Z.push(u));g._curves=Z},Pd.prototype.findPairs=function(H,m){var A,L,a,z,K,D,d,q,F=this,i=F._curves,G={},R=[];for(L=0,a=i.length;a>L;L++)A=i[L],z=A._p1,K=A._p2,D=A._p3,d=A._p4,!G[L]&&F._isSamePoint(z,H)&&(m?R.push({point:z,r2:d}):R.push({point:z,c2:K})),F._isSamePoint(d,H)&&(q=m?{point:d,r1:z}:{point:d,c1:D},a>L+1&&F._isSamePoint(i[L+1]._p1,H)&&(m?q.r2=i[L+1]._p4:q.c2=i[L+1]._p2,G[L+1]=!0),R.push(q));return R},Pd.prototype.toHtShape=function(){var A=this,K=A._curves,x=[],U=[],F={x:1/0,y:1/0};return K.forEach(function(i){var O=i._p1,l=i._p2,c=i._p3,n=i._p4;return A._isCloseEnough(O,F)||(x.push(1),U.push(O.clone())),F=n,A._isCloseEnough(O,l)&&A._isCloseEnough(c,n)?(x.push(2),U.push(n.clone()),void 0):(x.push(4),U.push(l.clone(),c.clone(),n.clone()),void 0)}),{segments:x,points:U}};var xc=Uj.Math.CubicBezier=function(U,_,l,X){var D=this;D._id=Uj.Math.CubicBezier._globalId++,D._p1=U,D._p2=_,D._p3=l,D._p4=X};xc._globalId=1,xc.prototype={},xc.prototype.constructor=xc,xc.prototype.toString=function(){return this._id},xc.prototype.intersectRect=function(P,n,H){var b=n/2,l=H/2,I=P.x,m=P.y,q=Uj.Math.Vector2,j=new q(-b+I,-l+m),D=new q(b+I,l+m),J=new q(D.x,j.y),C=new q(j.x,D.y),T=this,X=T.intersectLine(j,J),U=T.intersectLine(J,D),Y=T.intersectLine(D,C),w=T.intersectLine(C,j),c=X.concat(U).concat(Y).concat(w);return c},xc.prototype.intersectLine=function(O,p){var f,r,E,R,k,u,K,b,i,g,G,Y,Q,s=this,N=O.clone().min(p),y=O.clone().max(p);R=s._p1,k=s._p2,u=s._p3,K=s._p4,f=R.clone().multiplyScalar(-1),r=k.clone().multiplyScalar(3),E=u.clone().multiplyScalar(-3),G=f.add(r).add(E).add(K),f=R.clone().multiplyScalar(3),r=k.clone().multiplyScalar(-6),E=u.clone().multiplyScalar(3),g=f.add(r).add(E),f=R.clone().multiplyScalar(-3),r=k.clone().multiplyScalar(3),i=f.add(r),b=R.clone(),Q=new Uj.Math.Vector2(O.y-p.y,p.x-O.x),Y=O.x*p.y-p.x*O.y;for(var m=s.getRoots(Q.dot(G),Q.dot(g),Q.dot(i),Q.dot(b)+Y),S=new Array,e=0,t=m.length;t>e;e++){var C=m[e];if(!(0>C||C>1)){var I=s.getPointAt(C);I.t=C,O.x==p.x?N.y<=I.y&&I.y<=y.y&&S.push(I):O.y==p.y?N.x<=I.x&&I.x<=y.x&&S.push(I):I.x>=N.x&&I.y>=N.y&&I.x<=y.x&&I.y<=y.y&&S.push(I)}}return S},xc.prototype.solveTForPoint=function(y){var k,$,p,V,n=this;k=n._p1.x-y.x,$=n._p2.x-y.x,p=n._p3.x-y.x,V=n._p4.x-y.x;for(var v=n.getRoots(V-3*p+3*$-k,3*p-6*$+3*k,3*$-3*k,k),F=c,N=1/0,f=0,d=v.length;d>f;f++){var s=v[f];if(!(0>s||s>1)){var A=n.getPointAt(s);A.t=s;var m=Math.abs(A.y-y.y);N>m&&(N=m,F=A)}}return F},xc.prototype.getPointAt=function(x){var A=this,U=A._p1,D=A._p2,V=A._p3,Q=A._p4,T=U.clone().lerp(D,x),q=D.clone().lerp(V,x),s=V.clone().lerp(Q,x),o=T.lerp(q,x),E=q.lerp(s,x);return o.lerp(E,x)},xc.prototype.getPointByPercentage=function(W){var u=this.length*W,S=this._cacheLength,K=S.length;if(0===u)return S[0].point;if(W>=1)return S[K-1].point;for(var s=0;K>s;s++){var i=S[s];if(!(i.len<u)){var X=S[s-1];return i.point.clone().sub(X.point).setLength(u-X.len).add(X.point)}}},xc.prototype.getTByPercentage=function(_){var s=this.length*_,V=this._cacheLength,e=V.length;if(0===s||0>=_)return V[0].t;if(_>=1)return V[e-1].t;for(var J=0;e>J;J++){var R=V[J];if(!(R.len<s)){var P=V[J-1];return(s-P.len)/(R.len-P.len)*(R.t-P.t)+P.t}}},xc.prototype.getRoots=function(T,r,j,W){var Y,O,k,E,g,b=new Array;if(Math.abs(T)<1e-6){var Y=r,O=j/Y,k=W/Y,E=O*O-4*k;if(E>0){var g=Math.sqrt(E);b.push(.5*(-O+g)),b.push(.5*(-O-g))}else 0==E&&b.push(.5*-O)}r/=T,j/=T,W/=T,Y=(3*j-r*r)/3,O=(2*r*r*r-9*j*r+27*W)/27;var u=r/3,H=O*O/4+Y*Y*Y/27,v=O/2;if(Math.abs(H)<=1e-6&&(H=0),H>0){var K,L,g=Math.sqrt(H);K=-v+g,L=K>=0?Math.pow(K,1/3):-Math.pow(-K,1/3),K=-v-g,K>=0?L+=Math.pow(K,1/3):L-=Math.pow(-K,1/3),b.push(L-u)}else if(0>H){var w=Math.sqrt(-Y/3),D=Math.atan2(Math.sqrt(-H),-v)/3,S=Math.cos(D),t=Math.sin(D),e=Math.sqrt(3);b.push(2*w*S-u),b.push(-w*(S+e*t)-u),b.push(-w*(S-e*t)-u)}else{var K;K=v>=0?-Math.pow(v,1/3):Math.pow(-v,1/3),b.push(2*K-u),b.push(-K-u)}return b},xc.prototype._70I=function(){var l=this;return l._p1.distanceToSquared(l._p2)<1e-10&&l._p3.distanceToSquared(l._p4)<1e-10},xc.prototype.insertKnot=function(l){var Q=this,s=Q._p1,b=Q._p2,X=Q._p3,R=Q._p4,f=s.clone().lerp(b,l),K=b.clone().lerp(X,l),M=X.clone().lerp(R,l),O=f.clone().lerp(K,l),g=K.clone().lerp(M,l),q=O.clone().lerp(g,l);return Q._70I()?(s.clone().lerp(R,l),[new Uj.Math.CubicBezier(s,s.clone(),q.clone(),q),new Uj.Math.CubicBezier(q,q.clone(),R.clone(),R)]):[new Uj.Math.CubicBezier(s,f,O,q),new Uj.Math.CubicBezier(q,g,M,R)]},g.defineProperties(xc.prototype,{length:{get:function(){var s=this._cacheLength;if(!s){s=this._cacheLength=[];for(var Q=this._p1,X=0,H=0;1>=X;){var K=this.getPointAt(X+=.001);H+=K.clone().sub(Q).length(),Q=K,s.push({len:H,t:X,point:K.clone()})}}return s[s.length-1].len}},p1:{get:function(){return this._p1},set:function(K){this._p1=K,this._cacheLength=c}},p2:{get:function(){return this._p2},set:function(x){this._p2=x,this._cacheLength=c}},p3:{get:function(){return this._p3},set:function(N){this._p3=N,this._cacheLength=c}},p4:{get:function(){return this._p4},set:function(P){this._p4=P,this._cacheLength=c}}});var tr=C.Default.getInternal().ui().EdgeUI,$o={_47O:function(Y){var L=this,G=$o.getBackups()._47O;Uj.inEdit(L.gv)||G.call(L,Y)}};Uj.Inject.registAsModule($o,tr);var up=C.Default.getInternal().ui().NodeUI,as={_47O:function(H){var m=this,i=as.getBackups()._47O;Uj.inEdit(m.gv)||i.call(m,H)},getSelectWidth:function(){var q=this,j=q.gv,w=q._data;if(j.isEditable(w)&&Uj.inEdit(j))return 0;var v=as.getBackup("getSelectWidth");return v.call(q)}};Uj.Inject.registAsModule(as,up);var Lp=C.graph.GraphView,xm={_editPointSize:function(){var a=C.Default.isTouchable,u=Uj.getStyle("pointSize");return u[a?0:1]}(),isPointEditable:function(t){var r=this;if(Uj.inEdit(r))return r._pointEditableFunc?r._pointEditableFunc(t):!0;var z=xm.getBackup("isPointEditable");z.call(r,t)},isEditable:function(o){var v,s=this,N=xm.getBackup("isEditable");if(v=o instanceof Uj.Group?!0:N.call(s,o),!Uj.inEdit(s))return v;if(!(o instanceof C.Edge))return v;if(!o.s("2d.editable"))return!1;var j=s.getEditableFunc();return j?j(o):!0},_42:function(W,q){var i=this,O=xm.getBackups()._42;if(O.call(i,W,q),Uj.inEdit(i)){var e=i.getEditInteractor();e.drawImpl()}}};Uj.Inject.registAsModule(xm,Lp);var Gj=C.Default.getInternal().ui().ShapeUI,$p={_47O:function(m){var h=this,M=$p.getBackups()._47O;Uj.inEdit(h.gv)||M.call(h,m)}};Uj.Inject.registAsModule($p,Gj);var fd=C.graph.DefaultInteractor,gb={handle_mousewheel:function(K){var h=this,v=gb.getBackup("handle_mousewheel");Uj.inEdit(h.gv)||v.call(h,K)}};Uj.Inject.registAsModule(gb,fd);var Hi=C.graph.MoveInteractor,gk={_calcShift:function(U,B){var E=this,Z=gk.getBackup("_calcShift"),r=E.gv;if(!Uj.inEdit(r))return Z.call(E,U,B);var I=r.getEditInteractor(),g=I.getSubModule("Move").calcShift(U,B,E);return g||Z.call(E,U,B)},clear:function(x){var e=this,F=gk.getBackup("clear");F.call(e,x);var R=e.gv;if(Uj.inEdit(R)){var m=R.getEditInteractor();m.getSubModule("Move").clear(x)}}};Uj.Inject.registAsModule(gk,Hi);var ye=Uj.Rect=function(N){this.catalog="Rect",this._interactor=N};ye.prototype={},ye.prototype.constructor=ye,ye.prototype.gatherInfo=function(k,R){var A=this;if(1===R.length){var y=R[0];return y instanceof C.Shape&&y._70I()?A.gatherLine(k,y):tm(y,k)?!1:A.gatherSingleTarget(k,y)}return R.length>1?A.gatherMultiTargets(k,R):!1},ye.prototype.gatherSingleTarget=function(O,E){if(E.getCorners){var J,s=this,q=s.info;s.target=E,J=s.screenInfo={};var A=E.getCorners();q.LT=new Uj.Math.Vector2(A[0]),q.LB=new Uj.Math.Vector2(A[1]),q.RB=new Uj.Math.Vector2(A[2]),q.RT=new Uj.Math.Vector2(A[3]),q.T=q.LT.clone().add(q.RT).divideScalar(2),q.B=q.LB.clone().add(q.RB).divideScalar(2),q.L=q.LT.clone().add(q.LB).divideScalar(2),q.R=q.RT.clone().add(q.RB).divideScalar(2);for(var $ in q)J[$]=Uj.toScreenPosition(O,q[$]);var M=s._interactor,z=M.getStyle("checkSize"),k=function(p,G,h){var j=G.clone().sub(p).setLength(-z),b=h.clone().sub(p).setLength(-z),l=j.add(b).add(p);return l};return J.rotLT=k(J.LT,J.RT,J.LB),J.rotLB=k(J.LB,J.LT,J.RB),J.rotRB=k(J.RB,J.LB,J.RT),J.rotRT=k(J.RT,J.LT,J.RB),J.rotT=J.rotLT.clone().add(J.rotRT).divideScalar(2),J.rotB=J.rotLB.clone().add(J.rotRB).divideScalar(2),J.rotL=J.rotLT.clone().add(J.rotLB).divideScalar(2),J.rotR=J.rotRT.clone().add(J.rotRB).divideScalar(2),J.rotation=E.getRotation(),s.gatherConnectInfo(),!0
}},ye.prototype.gatherConnectInfo=function(){var j=this,a=j.target,D=j._interactor,Z=j.screenInfo,H=D.gv;if(H.isConnectActionVisible(a)&&D.getStyle("connectGuideVisible")){var o;a.s&&(o=a.s("connectGuideShift")),o||(o=D.getStyle("connectGuideShift"));var I=a.getAnchor(),t=a.getSize(),n=a.toGlobal({x:t.width*(o[0]-I.x),y:t.height*(o[1]-I.y)});n=Uj.toScreenPosition(H,n),Z.P1?n.add(Z.P2.clone().sub(Z.P1).setLength(o[2])):(n.add(Z.RT.clone().sub(Z.LT).setLength(o[2])),n.add(Z.LB.clone().sub(Z.LT).setLength(o[3]))),Z.connect=n}},ye.prototype.gatherMultiTargets=function(u,Q){var O=Uj.Group.findOrCreateGroup(Q,this._interactor._uuid);if(!O)return!1;var R=this;return R.editing&&"rotate"!==R.editing.mode||O.calcInfo(),R.gatherSingleTarget(u,O)},ye.prototype.gatherLine=function(D,P){this.target=P;var S=this.screenInfo={},V=P.getPoints(),L=Uj.getDataMatrix(P);return S.P1=Uj.toScreenPosition(D,L.apply(V.get(0))),S.P2=Uj.toScreenPosition(D,L.apply(V.get(1))),this.gatherConnectInfo(),!0},ye.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],ye.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],ye.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],ye.prototype.check=function(Y,V,Q){if(C.Default.isLeftButton(V)){var K=this;if(K.editing=null,K.tipInfo=null,K.screenInfo){var F=K.target,f=Y.isEditable(F),I=K.screenInfo;if(f&&I.connect){var n=K._checkConnect(Q);if(n)return n}if(I.P1)return K._checkLine(Q);var _,H,P,U=null,E=K._interactor,G=E.getStyle("checkSize");if(f&&Y.isRectEditable(F))for(H=0;H<Uj.Rect.ResizeKeys.length;H++)if(P=Uj.Rect.ResizeKeys[H],Uj.checkHit(Q,I[P],G)){U=P,_="resize";break}if(!U&&f&&Y.isRotationEditable(F)&&!E.getStyle("rotateAsClock")){var A=E.getStyle("rotateCheckSize");for(H=0;H<Uj.Rect.RotateKeys.length;H++)if(P=Uj.Rect.RotateKeys[H],Uj.checkHit(Q,I[P],A)){U=P,_="rotate";break}}if(!U)return E.setCursor("default"),void 0;if("rotate"===_){var x,j=Y.lp(V);if(F instanceof Uj.Group){var q=E.getStyle("groupRotateModeKey");"string"==typeof q&&(q=[q]);for(var y=!1,M=0,p=q.length;p>M;M++)if(V[q[M]]){y=!0;break}var O=E.getStyle("groupRotateModeDefault");x=y?"batch"===O?"block":"batch":O}var D="batch"===x?F.getAnchor2():F.getPosition(),W=Math.atan2(j.y-D.y,j.x-D.x);E._setRotateCursor(W),K.editing={mode:_,key:U,pos:D,flipY:F.getScale().y<0,rotation:F.getRotation(),hitRot:W},x&&(K.editing.groupRotateMode=x)}else{var $=Uj.Rect.ResizeKeys.indexOf(U),r=Uj.Rect.ResizeDirection[$],u=Math.cos(F.getRotation()),d=Math.sin(F.getRotation()),R=r.x*Math.sign(F.getScale().x),e=r.y*Math.sign(F.getScale().y),v=Math.atan2(-d*R-u*e,u*R-d*e),N=(Math.round(v/(Math.PI/4))+8)%8,J=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][N];this._interactor.setCursor(J);var T=F.getWidth(),c=F.getHeight(),t=F.getAnchor();K.editing={mode:_,key:U,rect:{x:-T*t.x,y:-c*t.y,width:T,height:c},anchor:t,matrix:F.getMatrix()}}return U}}},ye.prototype._checkLine=function(P){var C=this;C.screenInfo;var I,Q=C._interactor.getStyle("checkSize");if(Uj.checkHit(P,C.screenInfo.P1,Q))I="P1";else{if(!Uj.checkHit(P,C.screenInfo.P2,Q))return this._interactor.setCursor("default"),void 0;I="P2"}return C.editing={mode:"line",key:I},I},ye.prototype._checkConnect=function(W){var V=this,T=V.screenInfo,f=V._interactor,s=f.getStyle("connectGuideIntersectSize"),w=T.connect,D=W.x,x=w.x;if(x>D&&s>x-D&&Math.abs(w.y-W.y)<s||D>=x&&Uj.checkHit(W,w,s)){var u="connect",z=G.getConnectAction(f.gv);if(V.editing={mode:u},z&&z.delete)if(V.target instanceof Uj.Group){var O=!0;f.gv.sm().getSelection().each(function(E){z.delete.visible.call(null,f.gv,E)||(O=!1)}),V.editing.hasDeleteAction=O}else z.delete.visible.call(null,f.gv,V.target)&&(V.editing.hasDeleteAction=!0);return f.setCursor("default"),u}},ye.prototype._fireEditEvent=function(b,E){var V=this._interactor,U=this.editing;if(U){var d=U.mode;d="rotate"===d?"Rotation":"connect"===d?"Connection":"resize"===d?"Rect":d[0].toUpperCase()+d.slice(1),V.fi({kind:b+"Edit"+d,event:E})}},ye.prototype.startEdit=function(S,v){S.startDragging(v);var A=this;A._interactor.fi({kind:"prepareEdit",event:v});var O=A.editing,K=A.target;if(O){if(A._fireEditEvent("begin",v),O.started=!0,"rotate"===O.mode)return O.groupRotateMode&&K.beginRotate(O),S._42(),void 0;if("connect"!==O.mode)("line"===O.mode||K&&0===K.getRotation())&&(A._inSmartGuide=!0,A._interactor.rectGuide.gatherRects());else if(O.hasDeleteAction){var J=S.gv,d=A._interactor.getStyle("connectGuideGarbageShift");O.garbageInfo={x:J.getWidth()*d[0]+d[2],y:J.getHeight()*d[1]+d[3],size:A._interactor.getStyle("connectGuideGarbageIntersectsize")},S._42()}}},ye.prototype._46O=function(t){var q,r,Y=this,T=Y.editing,M=Y.target;if(T){if("connect"===T.mode&&!T.canceled&&!T.deleted)try{T.garbageInfo&&T.garbageInfo.hover?G.doDeleteConnectionAction(Y._interactor.gv,M):G.doConnectAction(Y._interactor.gv,M,T.target)}catch(f){console.error(f)}r=T.freezeFlag,q=Y.editing.groupRotateMode,Y._fireEditEvent("end",t),Y.editing=null}Y.tipInfo=null,Y._inSmartGuide&&(Y._interactor.rectGuide.clear(),Y._inSmartGuide=!1),q&&M&&M.endRotate(),M instanceof C.Block&&(r===c?delete M._freezeSyncFromChildren:M._freezeSyncFromChildren=r,M.updateFromChildren())},ye.prototype.handleNormalStateDelete=function(){var r=this,R=r.editing;if(R&&"connect"===R.mode&&!R.canceled&&!R.deleted){if(R.garbageInfo){try{G.doDeleteConnectionAction(r._interactor.gv,r.target)}catch(u){console.error(u)}R.garbageInfo=null}return R.cursorPos=null,R.targetCorners=null,R.deleted=!0,r._interactor._42(),!0}},ye.prototype.handleNormalStateKeyDown=function(K){var q=this,g=q.editing;return!g||"connect"!==g.mode||g.canceled||g.deleted?void 0:C.Default.isEsc(K)?(g.cursorPos=null,g.targetCorners=null,g.canceled=!0,q._interactor._42(),!0):void 0},ye.prototype.handleEdit=function(R,m){var g=this,o=g.editing;if(o){var r,i,D,v,Y,W=g.target,j=o.key,P=o.mode,a=R.lp(m),k=g._interactor;if("connect"===P){if(o.canceled)return;if(o.deleted)return;o.cursorPos=k._getLogicalPoint(m);var E=o.garbageInfo;return E&&Uj.checkHit(o.cursorPos,E,E.size)?(E.hover=!0,o.target=null,o.targetCorners=null):(E&&(E.hover=!1),o.target=R.getDataAt(a,function(N){return R.isSelectable(N)?Je(N)?!0:!1:!1})||null,o.targetCorners=Uj.getTargetCornersOnScreen(R,o.target)),k._42(),void 0}if("rotate"===P){var T,t,e=o.pos,l=Math.atan2(a.y-e.y,a.x-e.x);if(o.groupRotateMode?t=l-o.hitRot:(T=l-o.hitRot,t=o.rotation+T),t%=2*Math.PI,0>t&&(t+=2*Math.PI),!C.Default.isCtrlDown(m)){var O,X;zm(m)?(O=k.getStyle("shiftRotateRound"),X=O/2):(O=k.getStyle("rotateRound"),X=k.getStyle("rotateSensitivity")),t=Uj.roundTo(t,O,X)}o.groupRotateMode?(T=t-(o.lastRotation||0),0!==T&&(W.addRotation(T,o.groupRotateMode,function(J){return R.isRotationEditable(J)}),o.lastRotation=t)):W.setRotation(t),k._setRotateCursor(l),t>Math.PI&&(t-=2*Math.PI);var q=180*(t/Math.PI);q=q.toFixed(2),r=""+q+"°"}else if("resize"===P){var w=o.rect;D=w.x,v=w.y;var J,Q=w.width,S=w.height,M=o.anchor,H=o.matrix,z=W.s&&W.s("keepAspectRatio")||k.getStyle("keepAspectRatio");zm(m)&&(z=!z);var n=g._unionPointMode1,d=g._unionPointMode2;if(g._inSmartGuide&&!C.Default.isCtrlDown(m)&&!z){var x;"L"===j||"R"===j?x="x":("T"===j||"B"===j)&&(x="y"),g._adsorbedToClosest(a,x),Y=!0}J=H.tfi(a);var s;"LT"===j?(w=n(J,{x:D+Q,y:v+S},Q,S,z),s=9):"T"===j?(w=d({x:D,y:J.y},{x:D+Q,y:v+S},Q,S,z,"v"),s=1):"RT"===j?(w=n(J,{x:D,y:v+S},Q,S,z),s=33):"L"===j?(w=d({x:J.x,y:v},{x:D+Q,y:v+S},Q,S,z,"h"),s=8):"R"===j?(w=d({x:D,y:v},{x:J.x,y:v+S},Q,S,z,"h"),s=32):"LB"===j?(w=n(J,{x:D+Q,y:v},Q,S,z),s=12):"B"===j?(w=d({x:D,y:v},{x:D+Q,y:J.y},Q,S,z,"v"),s=4):"RB"===j&&(w=n(J,{x:D,y:v},Q,S,z),s=36);var c=H.tf(w.x+w.width*M.x,w.y+w.height*M.y);W instanceof C.Block&&(o.hasOwnProperty("freezeFlag")||(o.freezeFlag=W._freezeSyncFromChildren,W._freezeSyncFromChildren=!0)),W.setPosition(c),W.setSize(w.width,w.height),Y&&(i=W.getRect(),k.rectGuide.gatherLines({node:W,x:i.x,y:i.y,w:i.width,h:i.height},x,s)),r=""+Math.round(w.width)+" * "+Math.round(w.height)}else if("line"===P){if(zm(m)){var I=W.getPoints(),Z="P1"===j?I.get(1):I.get(0),f={x:a.x-Z.x,y:a.y-Z.y},V=k.getStyle("shiftLineRotateRound"),p=g._shiftDirList;if(!p||g._shiftRotateRound!==V){g._shiftRotateRound=V,g._shiftDirList=p=[];for(var B=0;B<Math.PI;B+=V)p.push({x:_(B),y:b(B)})}for(var y,N=0,u=0,U=p.length;U>u;u++){var A=p[u],K=A.x*f.x+A.y*f.y;Math.abs(K)>Math.abs(N)&&(N=K,y=A)}a={x:Z.x+y.x*N,y:Z.y+y.y*N},k.rectGuide.clear()}else g._inSmartGuide&&!C.Default.isCtrlDown(m)&&(g._adsorbedToClosest(a),Y=!0);var L=Uj.getDataMatrix(W).applyInverse(a);W.setPoint("P1"===j?0:1,L,!0);var F=W.getPoints(),G=F.get(0),$=F.get(1);D=G.x-$.x,v=G.y-$.y,r=" "+Math.round(Math.sqrt(D*D+v*v))+" ",Y&&(i=W.getRect(),k.rectGuide.gatherLines({node:W,x:i.x,y:i.y,w:i.width,h:i.height}))}if(r){var h=C.Default.getLogicalPoint(m,k._canvas);h.x+=Uj.Icons.TipShiftX,h.y+=Uj.Icons.TipShiftY,g.tipInfo={helperPos:h,text:r,size:r.length}}g._fireEditEvent("between",m)}},ye.prototype._unionPointMode1=function(I,Y,M,A,z){if(z&&M&&A){var V=I.x-Y.x,y=I.y-Y.y;Math.abs(V*A)<Math.abs(y*M)?(y=Math.sign(y)*Math.abs(V*A/M),I.y=Y.y+y):(V=Math.sign(V)*Math.abs(y*M/A),I.x=Y.x+V)}return C.Default.unionPoint(I,Y)},ye.prototype._unionPointMode2=function(L,q,N,W,Q,y){var A=C.Default.unionPoint(L,q);if(Q&&N&&W){var D;"v"===y?(D=A.x+A.width/2,A.width=N*A.height/W,A.x=D-A.width/2):(D=A.y+A.height/2,A.height=W*A.width/N,A.y=D-A.height/2)}return A},ye.prototype._adsorbedToClosest=function(q,G){var D=this,I=D._interactor,e=I.rectGuide.findClosest(q,G),u=I.gridGuide.findClosest(q,G),d=1/0,n=1/0;e&&(isFinite(e.x)&&(d=e.x),isFinite(e.y)&&(n=e.y)),u&&(isFinite(u.x)&&Math.abs(u.x)<Math.abs(d)&&(d=u.x),isFinite(u.y)&&Math.abs(u.y)<Math.abs(n)&&(n=u.y)),isFinite(d)&&(q.x+=d),isFinite(n)&&(q.y+=n)},ye.prototype._42=function($,r,h){var N=this;N.info={},N.screenInfo=null;var U=N._interactor;if(!U.editDetail&&N.gatherInfo(r,h)){var c=N.editing,Z=c?c.groupRotateMode:null,V=N.screenInfo;if("block"!==Z||!c||!c.started){if(V.P1?Uj.Icons.DrawIcon(U,$,Uj.Icons.Line,V):Uj.Icons.DrawIcon(U,$,Uj.Icons.Rect,V),V.connect&&(Uj.Icons.DrawIcon(U,$,Uj.Icons.ConnectGuide,{rotation:V.rotation,connect:V.connect,cursorPos:c?c.cursorPos:null}),c)){if(c.targetCorners){for(var H={x:1/0,y:1/0},y={x:-1/0,y:-1/0},S=0,_=c.targetCorners.length;_>S;S+=2)H.x=Math.min(H.x,c.targetCorners[S]),y.x=Math.max(y.x,c.targetCorners[S]),H.y=Math.min(H.y,c.targetCorners[S+1]),y.y=Math.max(y.y,c.targetCorners[S+1]);Uj.Icons.DrawIcon(U,$,Uj.Icons.HoverDataRect,{min:H,max:y,color:U.getStyle("hoverGuideColor")||U.getStyle("baseColor")})}c.garbageInfo&&Uj.Icons.DrawIcon(U,$,Uj.Icons.ConnectGuideGarbage,c.garbageInfo)}U.getStyle("rotateTipVisible")&&N.tipInfo&&Uj.Icons.DrawIcon(U,$,Uj.Icons.TipHelper,N.tipInfo)}N.target instanceof Uj.Group&&N.target._42(U,$,r)}};var Ti=Uj.Anchor=function(p){this.catalog="Anchor",this._interactor=p};Ti.prototype={},Ti.prototype.constructor=Ti,Ti.prototype.gatherInfo=function(S,z){var Q=this;if(1===z.length){var O=z[0];if(!O.getAnchor)return;if(O instanceof C.Shape&&O._70I())return;if(tm(O,S))return;return Q.gatherSingleTarget(S,z[0])}return z.length>1?Q.gatherMultiTargets(S,z):!1},Ti.prototype.gatherSingleTarget=function(n,$){var U=this;return U.info.POS=$.getPosition(),U.screenInfo.POS=Uj.toScreenPosition(n,U.info.POS),U.target=$,!0},Ti.prototype.gatherMultiTargets=function(F,$){var g=this,I=Uj.Group.findOrCreateGroup($,this._interactor._uuid);return I?(g.screenInfo.POS=Uj.toScreenPosition(F,I.getAnchor2()),g.target=I,!0):!1},Ti.prototype.isVisible=function(){var L=this,P=L._interactor;if(P.getStyle("anchorVisible")===!1)return!1;var q=L.target;if(q){if(this.editing)return!0;var $=q.getAnchor(),N=P.getStyle("anchorOutsideVisibleThreshold");if($.x<-N||$.x>1+N||$.y<-N||$.y>1+N)return!0;var A=q.getSize(),G=q.getScale(),V=Math.min(Math.abs(A.width*G.x),Math.abs(A.height*G.y));if(V*P.gv._zoom<P.getStyle("anchorHideThreshold"))return!1}return!0},Ti.prototype.check=function(g,I,c){if(C.Default.isLeftButton(I)){var x=this,K=x._interactor;if(x.isVisible()&&K.getStyle("anchorMovable")!==!1){x.editing=null,x.tipInfo=null;var l=x.target;if(l&&g.isAnchorEditable(l)&&g.isEditable(l)){var A;if(x.screenInfo&&(A=x.screenInfo.POS)&&Uj.checkHit(c,new Uj.Math.Vector2(A),K.getStyle("checkSize"))){if(l instanceof Uj.Group)return x.editing={},!0;var q=l.getWidth(),o=l.getHeight(),G=l.getAnchor();return x.editing={rect:{x:-q*G.x,y:-o*G.y,width:q,height:o},anchor:G,matrix:l.getMatrix()},!0}}}}},Ti.prototype.startEdit=function(z,Z){z.startDragging(Z),z.fi({kind:"beginEditAnchor",event:Z})},Ti.prototype._46O=function(o){var W=this;W.editing&&(W.editing=null,W._interactor.fi({kind:"endEditAnchor",event:o})),W.tipInfo=null},Ti.prototype.handleEdit=function(Y,B){var K=this,f=K.target;if(f){var t=K.editing;if(t){var w=Y.lp(B),J=K._interactor;if(f instanceof Uj.Group)return f.setAnchor2(w),J._42(),void 0;var b=t.matrix,$=b.tfi(w),R=t.rect,H=($.x-R.x)/R.width,V=($.y-R.y)/R.height;if(!C.Default.isCtrlDown(B)){var q=J.getStyle("anchorRound"),I=J.getStyle("anchorSensitivity");H=Uj.roundTo(H,q,I),V=Uj.roundTo(V,q,I)}f.setAnchor(H,V,!0);var E=C.Default.getLogicalPoint(B,J._canvas);E.x+=Uj.Icons.TipShiftX,E.y+=Uj.Icons.TipShiftY;var k=""+H.toFixed(2)+", "+V.toFixed(2);K.tipInfo={helperPos:E,text:k,size:k.length},J.fi({kind:"betweenEditAnchor",event:B})}}},Ti.prototype._42=function(x,W,H){var v=this;v.info={},v.screenInfo={};var T=v._interactor;T.editDetail||v.gatherInfo(W,H)&&v.isVisible()&&(Uj.Icons.DrawIcon(T,x,Uj.Icons.Anchor,v.screenInfo),v.tipInfo&&Uj.Icons.DrawIcon(T,x,Uj.Icons.TipHelper,v.tipInfo))};var td=Uj.MoveDummy=function(H){this.catalog="MoveDummy",this._interactor=H};td.prototype={},td.prototype.constructor=td,td.prototype.gatherInfo=function(){var S=this,t=this._interactor.getSubModule("Rect");if(t){var h=t.screenInfo;if(h){var R=S._interactor,u=S.getMovableTarget(t.target);if(u){var F=R.getStyle("moveDummyThreshold");if(F!==!1){var c=h.LT||h.P1,W=h.RT||h.P2,l=h.LB||c;if(c){var E=h.P1,J=Math.min(c.distanceTo(l),c.distanceTo(W));if(!(F!==!0&&J>F)){var $=R.getStyle("moveDummyPosition"),w=W.clone().sub(c),D=l.clone().sub(c),L=$[2],o=$[3];if(E){var I=R.getStyle("moveDummyLineExtraShift");I&&(L+=I[0],o+=I[1])}var Q=c.clone().add(w.clone().multiplyScalar($[0])).add(w.setLength(L)).add(D.clone().multiplyScalar($[1])).add(D.setLength(o));return S.screenInfo.pos=Q,S.screenInfo.size=R.getStyle("moveDummySensitivity"),!0}}}}}}},td.prototype.getMovableTarget=function(N){var v=this._interactor.gv;if(Je(N)){if(v.isMovable(N))return N}else if(N instanceof Uj.Group)for(var i=N._entities,Y=i.length-1;Y>=0;Y--){var b=i[Y];if(Je(b)&&v.isMovable(b))return b}return null},td.prototype.getMoveInteractor=function(){for(var m,n,T,Y=this._interactor.gv,B=Y.getInteractors(),m=0,n=B.length;n>m;m++)if(T=B.get(m),T instanceof Hi)return T},td.prototype.startEdit=function(B,Z){B.startDragging(Z);var r=this.getMoveInteractor();if(r){var d=this.selectedTarget,E=B.gv;E._moving=1,r._data=d,E.handleMouseDown&&E.handleMouseDown(Z,d)}},td.prototype._46O=function(L){var G=this,f=G.getMoveInteractor();f&&(f.handleWindowMouseUp(L),G.selectedTarget=null)},td.prototype.handleEdit=function(k,u){var N=this.getMoveInteractor();N&&N.handleWindowMouseMove(u)},td.prototype.check=function(a,v,$){if(this.selectedTarget=null,C.Default.isLeftButton(v)&&!a._scrolling&&!Tr()){var A=this;if(A.screenInfo){var Z=A.screenInfo.pos;if(Z&&!($.distanceTo(Z)>A.screenInfo.size)){var E=A._interactor;return A.selectedTarget=A.getMovableTarget(E.getSubModule("Rect").target),E.setCursor("default"),!0}}}},td.prototype._42=function(b,B,z){var c=this;c.screenInfo={};var Z=c._interactor;Z.editDetail||c.gatherInfo(B,z)&&(!Z.editing||c.selectedTarget)&&Uj.Icons.DrawIcon(Z,b,Uj.Icons.MoveDummy,c.screenInfo)};var Zh=Uj.RotateX=function(o){this.catalog="RotateX",this._interactor=o};Zh.prototype={},Zh.prototype.constructor=Zh,Zh.prototype.gatherInfo=function(k,m){var N=this;if(1===m.length){var U=m[0];return U instanceof C.Shape&&U._70I()||tm(U,k)?!1:N.gatherSingleTarget(k,U)}return m.length>1?N.gatherMultiTargets(k,m):!1},Zh.prototype.gatherSingleTarget=function(){var f=new C.Math.Vector2,p=new C.Math.Vector2,h=new C.Math.Vector2,R=new C.Math.Vector2,b=function(n,i){var U=n.x-i.x,S=n.y-i.y;return U*U+S*S};return function(e,d){if(d.getCorners){var _=this,Z=d.getCorners(),V=15,T=d.getPosition();f.copy(Z[0]),h.copy(Z[1]),R.copy(Z[3]),p.copy(f).add(R).divideScalar(2).add(f.sub(h).setLength(V/e.getZoom()));var U=Math.max(b(T,Z[0]),b(T,Z[1]),b(T,Z[2]),b(T,Z[3]));return _.info.POS=p.clone(),_.screenInfo.POS=Uj.toScreenPosition(e,_.info.POS),_.screenInfo.LEN=Math.sqrt(U)*e.getZoom()+V,_.screenInfo.CENTER=Uj.toScreenPosition(e,T),_.target=d,!0}}}(),Zh.prototype.gatherMultiTargets=function(z,a){var R=this,F=Uj.Group.findOrCreateGroup(a,this._interactor._uuid);if(!F)return!1;var R=this;return R.gatherSingleTarget(z,F)},Zh.prototype.isVisible=function(){var b=this._interactor;if(!b.getStyle("rotateAsClock"))return!1;var $=this.target;if(!$)return!0;var F=b.gv;return F.isEditable($)&&F.isRotationEditable($)?!0:!1},Zh.prototype.check=function(G,j,k){var S=this,Q=S._checkImpl(G,j,k);return(Q||S._clockPainted)&&S._interactor._42(),Q},Zh.prototype._checkImpl=function(q,y,N){if(C.Default.isLeftButton(y)){var P=this;P.editing=null,P.tipInfo=null;var v;if(P.screenInfo&&(v=P.screenInfo.POS)&&P.isVisible()){var b=P._interactor;if(Uj.checkHit(N,v,b.getStyle("checkSize"))){var I=P.target,W=q.lp(y),S=I.getPosition(),z=Math.atan2(W.y-S.y,W.x-S.x);return b._setRotateCursor(z),P.editing={pos:S,rotation:I.getRotation(),hitRot:z,groupRotateMode:"block",screenInfo:{CENTER:P.screenInfo.CENTER,LEN:P.screenInfo.LEN}},!0}}}},Zh.prototype.startEdit=function(C,n){C.startDragging(n),C.fi({kind:"beginEditRotation",event:n}),this.target instanceof Uj.Group&&this.target.beginRotate(this.editing)},Zh.prototype._46O=function(C){var $=this;$.editing&&($.editing=null,$._interactor.fi({kind:"endEditRotation",event:C})),$.target instanceof Uj.Group&&$.target.endRotate(),$.tipInfo=null},Zh.prototype.handleEdit=function(A,y){var t=this,V=t.editing;if(V){var l,v,w=t.target,K=A.lp(y),e=t._interactor,u=V.pos,s=Math.atan2(K.y-u.y,K.x-u.x),X=w instanceof Uj.Group;if(X?v=s-V.hitRot:(l=s-V.hitRot,v=V.rotation+l),v%=2*Math.PI,0>v&&(v+=2*Math.PI),!C.Default.isCtrlDown(y)){var b,d;zm(y)?(b=e.getStyle("shiftRotateRound"),d=b/2):(b=e.getStyle("rotateRound"),d=e.getStyle("rotateSensitivity")),v=Uj.roundTo(v,b,d)}X?(l=v-(V.lastRotation||0),0!==l&&(w.addRotation(l,V.groupRotateMode,function(U){return A.isRotationEditable(U)}),V.lastRotation=v)):w.setRotation(v),e._setRotateCursor(s),v>Math.PI&&(v-=2*Math.PI);var h=180*(v/Math.PI),x=""+h.toFixed(2)+"°",Q=C.Default.getLogicalPoint(y,e._canvas);Q.x+=Uj.Icons.TipShiftX,Q.y+=Uj.Icons.TipShiftY,t.tipInfo={helperPos:Q,text:x,size:x.length},e.fi({kind:"betweenEditRotation",event:y})}},Zh.prototype._42=function(Z,Q,v){var D=this;D._clockPainted=!1,D.info={},D.screenInfo={};var e=D._interactor;e.editDetail||D.gatherInfo(Q,v)&&D.isVisible()&&(Uj.Icons.DrawIcon(e,Z,Uj.Icons.RoundPoint,D.screenInfo.POS),e.getStyle("rotateTipVisible")&&D.tipInfo&&Uj.Icons.DrawIcon(e,Z,Uj.Icons.TipHelper,D.tipInfo),D.editing&&D.drawClock(Z))},Zh.prototype.drawClock=function(w){w.save();var E=this;E._clockPainted=!0;var p=E.editing||{},Y=p.screenInfo||E.screenInfo,t=Y.LEN,o=t+8,G=t+18;w.save(),w.translate(Y.CENTER.x,Y.CENTER.y),w.beginPath(),w.strokeStyle="rgb(150, 150, 150)";for(var v,z,W,h,k,S=0;360>S;S++)v=S*Math.PI/180,0===S%5&&(z=b(v)*t,W=_(v)*t,h=b(v)*o,k=_(v)*o,w.moveTo(z,W),w.lineTo(h,k)),0===S%45&&(z=b(v)*t,W=_(v)*t,h=b(v)*G,k=_(v)*G,w.moveTo(z,W),w.lineTo(h,k));w.stroke(),w.rotate(-Cg);var g=p.lastRotation||E.target.getRotation();w.beginPath(),w.fillStyle="rgba(255, 0, 0, 0.1)",w.strokeStyle="rgb(157, 157, 157)",w.moveTo(0,0),w.arc(0,0,G,0,g,!1),w.fill(),w.beginPath(),w.moveTo(0+G,0),w.arc(0,0,G,0,g,!1),w.stroke(),w.restore()};var Pd=Uj.Curve=function(L){this.catalog="Curve",this._interactor=L};Pd.prototype={},Pd.prototype.constructor=Pd,g.defineProperties(Pd.prototype,{activing:{get:function(){return this._activing},set:function(S){var f=this;if(S)f._activing=new Uj.CurveActiving(this,S),f._activing._firePointChange();else{var _=f._activing;_&&_.dispose(),f._activing=null}}}}),Pd.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Pd.prototype.setUp=function(){var C=this,E=C._interactor;E&&E.gv.mp(C._onGraphviewPropertyChanged,C)},Pd.prototype._onGraphviewPropertyChanged=function(t){("zoom"===t.property||"translateX"===t.property||"translateY"===t.property)&&this._handleDataChanged()},Pd.prototype.tearDown=function(){var I=this,n=I._interactor;n&&n.gv.ump(I._onGraphviewPropertyChanged,I)},Pd.prototype.canEnterEditDetailMode=function(){var y=io(this._interactor);return y?this.target=y:void 0},Pd.prototype.canQuitEditDetailMode=function(O){var H=this,l=H._interactor._getLogicalPoint(O);return H._checkEditRealPoint(l)?void 0:H._interactor.gv.getDataAt(O)!==H.target?!0:void 0},Pd.prototype.preHandleScroll=function(){var w=this.editing;return w&&w.inEdit?!0:void 0},Pd.prototype.getCurrentSelectintStatus=function(){var N=this;if(N.activing&&!N.activing.selections){if(N.activing.status!=c)return N.activing.status;var _=function(O){var Y=N.activing.status;N.activing.status=O,N._interactor.fp("shapePointStatus",Y,O)},F=Uj.Curve.PointType,S=N.activing.point,t=N.activing.pairs;if(!t||1!==t.length)return _(F.Mirrored);var z=t[0],e=z.c1&&z.c1.isNearEnough(S),E=z.c2&&z.c2.isNearEnough(S);if(!z.c1||!z.c2)return e||E?_(F.Straight):_(F.Disconnected);if(e&&E)return _(F.Straight);if(e||E)return _(F.Asymmetric);var G=z.c1.clone().sub(S),g=z.c2.clone().sub(S);return Math.abs(G.x*g.y-G.y*g.x)>1e-5||G.x*g.x>0?_(F.Disconnected):Math.abs(G.length()-g.length())>1e-5?_(F.Asymmetric):_(F.Mirrored)}},Pd.prototype.handle_keydown=function(w){var O=this;if(O._interactor.editDetail){var $=Uj.Curve.PointType;"1"===w.key?O._setCurrentSelectionStatus($.Straight):"2"===w.key?O._setCurrentSelectionStatus($.Mirrored):"3"===w.key?O._setCurrentSelectionStatus($.Disconnected):"4"===w.key&&O._setCurrentSelectionStatus($.Asymmetric)}},Pd.prototype.setCurrentSelectionStatus=function(a){var k=this,w=k._interactor;if(w){var X=w.gv;X.dm().beginTransaction(),this._setCurrentSelectionStatus(a),X.dm().endTransaction()}},Pd.prototype._setCurrentSelectionStatus=function(Q){var j=this,P=j.activing;if(P){var S=j.getCurrentSelectintStatus();if(null!==S&&S!==Q){P.status=Q;var C=j.activing.point,W=j.activing.pairs;if(W&&1===W.length){var O=W[0],c=j.screenInfo.curve,A=Uj.Curve.PointType,u=j._interactor,I=function(){j._writeToHt(),u.fp("shapePointStatus",S,Q),j.check(u.gv,null,new Uj.Math.Vector2(u._lastLogicalPoint))};if(Q===A.Straight)return c.moveCtrlPoint(O,C,"c1"),c.moveCtrlPoint(O,C,"c2"),I(),void 0;if(S===A.Straight){var r=c.findPairs(C,!0),M=r[0],v=M.r1||C,o=M.r2||C,s=o.clone().sub(v).multiplyScalar(.25);return c.moveCtrlPoint(O,C.clone().sub(s),"c1"),c.moveCtrlPoint(O,C.clone().add(s),"c2"),I(),void 0}var H=O.c1,p=O.c2;if(H&&p){if(Q===A.Mirrored)return c.moveCtrlPoint(O,C.clone().multiplyScalar(2).sub(p),"c1"),I(),void 0;if(Q===A.Asymmetric&&S===A.Disconnected){var X=H.clone().sub(C).length(),s=C.clone().sub(p).setLength(X).add(C);return c.moveCtrlPoint(O,s,"c1"),I(),void 0}}P._firePointChange(),u.fp("shapePointStatus",S,Q),j.check(u.gv,null,new Uj.Math.Vector2(u._lastLogicalPoint))}}}},Pd.prototype._handleDataChanged=function(){var h="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(d){var Q=this;if(Q.screenInfo&&Q.target){if(d&&h.indexOf(d.property)<0)return;var n=Q._interactor;Q.gatherSingleTarget(n.gv,Q.target,!0),Q.check(n.gv,null,new Uj.Math.Vector2(n._lastLogicalPoint)),n._42()}}}(),Pd.prototype.gatherSingleTarget=function(T,V,g){var M,l,a=this;a.screenInfo&&a.screenInfo.curve&&(l=a.screenInfo.curve._curves);var m=a.editing;M=m?a.screenInfo:a.screenInfo={};var A,Z,R=V instanceof C.Edge;R?(A=V.s("edge.segments"),Z=V.s("edge.points")||new C.List):(A=V._58O,Z=V._59O),M.S=A;var P,O=M.P=[],I=Uj.getDataMatrix(V);if(V instanceof C.Polyline||V instanceof C.Edge&&a._interactor.getStyle("edgeElevationEditable"))P=V.getElevation&&V.getElevation()||0,M.E=[];else{var y=!1;Z.each(function(k){k.e!==c&&(y=!0)}),y&&(M.E=[])}if(Z.each(function(J){M.E&&M.E.push(J.e!=c?J.e:P),J=I.apply(J);var j=Uj.toScreenPosition(T,J);O.push(j.x,j.y)}),R){var F=O.length,d=Uj.toScreenPosition(T,V._lastSourcePoint||(F?{x:O[0],y:O[1]}:{x:0,y:0})),X=Uj.toScreenPosition(T,V._lastTargetPoint||(F?{x:O[F-2],y:O[F-1]}:{x:0,y:0}));if(O.splice(0,0,d.x,d.y),O.push(X.x,X.y),M.E){var S=V.getSource(),D=V.getTarget();M.E.splice(0,0,((V.s("edge.source.anchor.elevation")||.5)-.5)*S.getTall()+S.getElevation()),M.E.push(((V.s("edge.target.anchor.elevation")||.5)-.5)*D.getTall()+D.getElevation())}}if(!M.S||!M.S.size()){M.S=new C.List,M.S.add(1);for(var i=0;i<O.length/2-1;i++)M.S.add(2)}if((!m||g)&&a.convertToCubicBezier(l),a.activing&&(g||!a.editing||"realPoint"===a.editing.type)){var K=M.curve.findPairs(a.activing.point);a.activing.pairs=K}},Pd.prototype._convertToNewPoint=function(p,f,W,F){var y,m,j;for(y=0,m=f.length;m>y;y++){if(j=f[y],j._p1.isNearEnough(p)&&(!F||F.indexOf(j._p1)<0))return j._p1;if(j._p4.isNearEnough(p)&&(!F||F.indexOf(j._p4)<0))return j._p4}if(W)for(y=0,m=Math.min(W.length,m);m>y;y++){if(j=W[y],j._p1===p&&(!F||F.indexOf(f[y]._p1)<0))return f[y]._p1;if(j._p4===p&&(!F||F.indexOf(f[y]._p4)<0))return f[y]._p4}},Pd.prototype.convertToCubicBezier=function(J){var G,p,u=this,s=new Uj.Math.Curve,b=u.screenInfo;if(s.createFromHtShape(b.P,b.S,b.E),b.curve=s,u.activing){var v=s._curves;G=u.activing.point,p=u._convertToNewPoint(G,v,J);var Q=[];if(p&&(u.activing.point=p,Q.push(p)),u.activing.selections){var X=-1,z=u.activing.selections;z.forEach(function(q){X++,p=u._convertToNewPoint(q,v,J,Q),p&&(z[X]=p,Q.push(p))})}}},Pd.prototype.check=function(j,m,o){if(!m||dr(m)||Ni(m)){var F=this;if(F._interactor.setCursor("default"),F.editing=null,F.highlight=null,F.tipInfo=null,F.edgeEditResult=null,F.screenInfo){if(Tr()||m&&Ni(m))return F._interactor._42(),!0;if(F._checkEditCtrlPoint(o))return F._interactor._42(),!0;if(F._checkEditRealPoint(o))return F._interactor._42(),!0;if(F._checkEditElevation(o))return F._interactor._42(),!0;var x=F.screenInfo.curve,u=x.checkPoint(o,F._interactor.getStyle("curveIntersectSize"));if(u){var M=F.highlight={};M.type="insertKnot",M.bezier=u.bezier,M.point=u.intersection}return F._interactor._42(),!0}}},Pd.prototype.getAdjacentBeziers=function(_){var W=this.screenInfo;if(W){var e,f,n,Q=W.curve._curves,u=[],A=c;for(e=0,f=Q.length;f>e;e++)if(n=Q[e],A===c){if(n._p4.isNearEnough(_)){u.push(n),A=e;continue}}else{if(n._p1.isNearEnough(_))return u.push(n),u;if(n._p4.isNearEnough(_)){u[0]=n,A=e;continue}}}},Pd.prototype.roundCorner=function(J){if(this.activing&&this.screenInfo){var a=this.screenInfo.curve,P=a._curves,r=this.getAdjacentBeziers(this.activing.point),c=r[1],M=c._index;c=c.insertKnot(c.getTByPercentage(J/c.length))[1],P[M]=c;var V=c.p1,E=r[0],t=E._index;E=E.insertKnot(E.getTByPercentage(1-J/E.length))[0],P[t]=E;var C=E.p4,f=this.activing.point,D=new Uj.Math.CubicBezier(C,f.clone().sub(C).multiplyScalar(2/3).add(C),f.clone().sub(V).multiplyScalar(2/3).add(V),V);P.splice(M,0,D),this._writeToHt(),this.activing=null,this._interactor._42()}},Pd.prototype._checkEditRealPoint=function(D){var w,y,A,p,J,N,l=this,F=l.screenInfo.curve._curves,r=l._interactor.getStyle("curvePointIntersectSize"),V=1/0;for(r*=r,A=0,p=F.length;p>A;A++)w=F[A],J=w._p1,N=D.distanceToSquared(J),V>N&&(V=N,y=J),J=w._p4,N=D.distanceToSquared(J),V>N&&(V=N,y=J);if(V>r)return!1;var u=l.highlight={};return u.type="changeRealPoint",u.point=y,l.editing={type:"realPoint",point:y,shiftGuide:{point:y.clone(),dir:"x",limit:0}},l._interactor.setCursor("crosshair"),!0},Pd.prototype._checkEditElevation=function(u){var s=this;if(!s._interactor.getStyle("curveElevationVisible"))return!1;var T=s.target;if(T instanceof C.Edge&&!s._interactor.getStyle("edgeElevationEditable"))return!1;var H=s.activing;if(!H)return!1;var F=H.getCurrentEditingPoint();if(!F)return!1;var i=s._interactor,G=i.getStyle("curveElevationGuideShift"),S=i.getStyle("curveElevationIntersectSize"),n=u.distanceToSquared({x:F.x+G[0],y:F.y+G[1]});if(!(n>S*S)){var k=s.highlight={};k.type="elevation";var c=new Uj.Math.Vector2(u.x,u.y,F.e);return s.editing={type:"elevation",startPoint:c},s._interactor.setCursor("crosshair"),!0}},Pd.prototype._checkEditCtrlPoint=function(i){var Y=this;if(Y.activing&&!Y.activing.selections){var x=Y.getCurrentSelectintStatus();if(x!==Uj.Curve.PointType.Straight){var z=Y.activing.pairs;if(z){var K=Y._interactor.getStyle("curvePointIntersectSize");K*=K;var E,k,t,$,w,d,O,j,X,v=1/0;for(O=0,X=z.length;X>O;O++)for($=z[O],j=0;2>j;j++)w=0===j?"c1":"c2",$[w]&&(d=i.distanceToSquared($[w]),v>d&&(v=d,E=$,k=O,t=w));if(v>K)return!1;Y.activing.hlpair=E,Y.activing.hltype=t;var Q=Y.highlight={};return Q.type="changeCtrlPoint",Q.point=E[t],Y.editing={type:"ctrlPoint",pair:E,pairId:k,ctrlType:t,direction:E[t].clone().sub(Y.activing.point).normalize()},Y._interactor.setCursor("crosshair"),!0}}}},Pd.prototype.startEdit=function(o,K){o.startDragging(K);var R=this;R.highlight&&"insertKnot"===R.highlight.type&&(R.insertKnot(),R.gatherSingleTarget(R._interactor.gv,R.target),R.activing=null,R._checkEditRealPoint(R._interactor._getLogicalPoint(K)));var h=R._activing;if(h){var p=R.editing?R.editing.type:null;"ctrlPoint"===p?h.editingCtrl={pairId:R.editing.pairId,type:h.hltype}:"realPoint"===p&&(h.editingCtrl=!1)}var m=R.highlight,U=C.Default.isCtrlDown(K);if(!m||Tr()||Ni(K)){var O=R._interactor.gv;if(!O.setFocus(K)||O._scrolling)return;return U?R._multiSelect={startPoint:O.lp(K)}:O.isPannable()&&(dr(K)||Ni(K))&&(R._pan={tx:O.tx(),ty:O.ty()},o.fi({kind:"beginPan",event:K})),void 0}if("changeRealPoint"===m.type){var E,I=R.activing?R.activing.point:null,d=R.activing?R.activing.selections:null;if(U&&R.activing)I===m.point?(d?(R.activing={point:d[0]},d.length>1&&(d.splice(0,1),R.activing.selections=d)):R.activing=null,R.editing=null):d&&(E=d.indexOf(m.point))>=0?(d.length>1?d.splice(E,1):delete R.activing.selections,R.editing=null):d?(d.push(I),R.activing={point:m.point,selections:d}):R.activing={point:m.point,selections:[I]};else if(d)I===m.point||((E=d.indexOf(m.point))>=0?(d.splice(E,1,I),R.activing={point:m.point,selections:d}):R.activing={point:m.point});else{var G;I===m.point&&(G=R.activing.status),R.activing={point:m.point},G&&(R.activing.status=G)}o.fi({kind:"beginEditPoint",event:K})}},Pd.prototype.insertKnot=function(){var g=this,X=g.highlight,G=g.screenInfo.curve;G.insertKnot(X.bezier,X.point.t),g._writeToHt()},Pd.prototype._writeToHt=function(){var U,W,t=this,q=t.screenInfo.curve,n=q.toHtShape(),F=n.points,p=[],I=n.segments,M=t._interactor.gv;M.dm().beginTransaction();var Y,v,w=t.target,l=w instanceof C.Edge,K=Uj.getDataMatrix(w).invert();v=w instanceof C.Polyline||l&&t._interactor.getStyle("edgeElevationEditable"),v&&(Y=w.getElevation&&w.getElevation()||0);for(var X=0,k=F.length;k>X;X++)U=F[X],W=Uj.toWorldPosition(M,U),W=K.apply(W),isFinite(U.e)&&U.e!==Y&&(W.e=U.e),p.push(W);if(w._writing=!0,l){w.s("edge.type","points"),w.setStyle("edge.segments",I),w.setStyle("edge.points",p.slice(1,p.length-1)),w.setStyle("edge.source.offset.x",0),w.setStyle("edge.source.offset.y",0),w.setStyle("edge.target.offset.x",0),w.setStyle("edge.target.offset.y",0);var r=t._nextChangeEdgeHost;delete t._nextChangeEdgeHost,r&&("source"===r.type?w.setSource(r.host):w.setTarget(r.host)),t._writeEdgeHostAnchor("source",p[0]),t._writeEdgeHostAnchor("target",p[p.length-1])}else p.length?(w.setSegments(I),w.setPoints(p,!0)):w.removeFromDataModel();M.dm().endTransaction(),delete w._writing},Pd.prototype._writeEdgeHostAnchor=function(U,z){var L=this,a=L.target,Z=L._calcHostAnchor(a,U,z);Z.index!==c?(a.setStyle("edge."+U+".index",Z.index),a.setStyle("edge."+U+".percent",c),a.setStyle("edge."+U+".anchor.x",c),a.setStyle("edge."+U+".anchor.y",c)):Z.percent!==c?(a.setStyle("edge."+U+".percent",Z.percent),a.setStyle("edge."+U+".index",c),a.setStyle("edge."+U+".anchor.x",c),a.setStyle("edge."+U+".anchor.y",c)):(a.s("edge."+U+".anchor.x",Z.x),a.s("edge."+U+".anchor.y",Z.y),a.s("edge."+U+".anchor.elevation",Z.e),Z.offsetX||Z.offsetY?(a.s("edge."+U+".offset.x",Z.offsetX),a.s("edge."+U+".offset.y",Z.offsetY),a.s("edge."+U+".offset.elevation",Z.offsetElevation)):(a.s("edge."+U+".offset.x",0),a.s("edge."+U+".offset.y",0),a.s("edge."+U+".offset.elevation",0)))
},Pd.prototype._calcHostAnchor=function(h,Z,F,S){S||(S="source"===Z?h.getSource():h.getTarget());var b=this._interactor.gv,T=b.calculateAttachPoint(S,F);if(T)return T.info;if(hq(S)){var K=b.calculateEdgePosition(S,F);return K}var y=S.getRotation(),D=S.getAnchor();tm(S,b)&&(y=0);var n=S.getElevation(),E=S.getTall();n=((F.e||0)-n)/E+.5;var X=S.getScale();if(y||X.x<0||X.y<0){var w=S.getMatrix(),q=w.tfi(F),l=S.getSize();return{x:q.x/l.width+D.x,y:q.y/l.height+D.y,e:n}}var O=Zc(b,S),v={x:(F.x-O.x)/O.width,y:(F.y-O.y)/O.height,e:n};return v},Pd.prototype._handlePanning=function(F){var y=this,P=y._pan;if(P){P.started=!0;var L=y._interactor,u=L.gv,N=L._lastClientPoint,A=Ae(F),X=Mm(u,A,N);u.setTranslate(P.tx+X.x,P.ty+X.y),y.gatherSingleTarget(L.gv,y.target),L._42(),L.fi({kind:"betweenPan",event:F})}},Pd.prototype.handleEdit=function(E,e){var s=this,K=s.editing;if(s._pan)return s._handlePanning(e),void 0;if(s._multiSelect)return s._multiSelect.endPoint=E.lp(e),s._interactor.redraw(),void 0;if(K){K.inEdit=!0;var _,l,v,n=s._interactor._getLogicalPoint(e),S=C.Default.isCtrlDown(e),I=C.Default.isShiftDown(e),p=K.type,y=s.activing;if(s._guideInfo=null,"ctrlPoint"===p&&I){var x=s.editing.direction.clone();_=y.point;var r=x.dot(n.clone().sub(_));n=x.setLength(r).add(_)}else if("ctrlPoint"===p||"realPoint"===p){var x;if("realPoint"===p&&I){var F=s.editing.shiftGuide;l=F.point;var B=Math.abs(n.x-l.x),N=Math.abs(n.y-l.y);B>N&&B>F.limit&&"y"===F.dir&&(F.dir="x"),N>B&&N>F.limit&&"x"===F.dir&&(F.dir="y"),x=F.dir,"x"===x?(n.y=l.y,F.limit=Math.max(F.limit,B)):"y"===x&&(n.x=l.x,F.limit=Math.max(F.limit,N))}var u=s._isEditEdgeSourceTarget();if(u){var A=s._editEdgeSourceTarget(u,n,S);A&&(s.edgeEditResult=A,v=A.tipText)}else if(!S){var H=s._guidingToEdit(n,x),U="realPoint"===p?s._interactor.gridGuide.findClosest(n,x,!0):null,T=1/0,V=1/0;U&&(U.x&&(T=U.x),U.y&&(V=U.y));var i=!1;H&&(H.xList&&(Math.abs(H.x)<=Math.abs(T)?(i=!0,T=H.x):delete H.xList),H.yList&&(Math.abs(H.y)<=Math.abs(V)?(i=!0,V=H.y):delete H.yList),i&&(s._guideInfo=H)),isFinite(T)&&(n.x+=T),isFinite(V)&&(n.y+=V),i&&(H.v=n)}}var Q=s.screenInfo.curve;if("realPoint"===K.type){_=K.point,_.e!==c&&(n.e=_.e),Q.moveRealPoint(_,n),K.point=n,s.highlight.point=n;var b=y.status,R=y.selections;if(s.activing={point:n,status:b},R){var w=n.clone().sub(_),m=0;R.forEach(function(D){var v=D.clone().add(w);Q.moveRealPoint(D,v),R[m++]=v}),s.activing.selections=R}}else if("ctrlPoint"===K.type){var X=y.pairs,k=X[K.pairId];Q.moveCtrlPoint(k,n,K.ctrlType);var j=y.status,L=Uj.Curve.PointType;if((j===L.Mirrored||j===L.Asymmetric)&&k.c1&&k.c2){var _=new Uj.Math.Vector2(y.point),G="c1"===K.ctrlType?"c2":"c1";if(j===Uj.Curve.PointType.Mirrored)Q.moveCtrlPoint(k,_.clone().multiplyScalar(2).sub(n),G);else if(j===L.Asymmetric){var r=k[G].clone().sub(_).length(),d=_.clone().sub(k[K.ctrlType]).setLength(r).add(_);isNaN(d.x)||Q.moveCtrlPoint(k,d,G)}}y._firePointChange()}else if("elevation"===K.type){l=K.startPoint;var f=l.e+(l.y-n.y)/E._zoom;s._setCurrentPointImpl("e",f),y._firePointChange(),v="E: "+Uj.toFixed(f)}var z=C.Default.getLogicalPoint(e,s._interactor._canvas);if(z.x+=Uj.Icons.TipShiftX,z.y+=Uj.Icons.TipShiftY,!v){var D=Uj.toWorldPosition(E,n);v=""+Uj.toFixed(D.x)+", "+Uj.toFixed(D.y)}s.tipInfo={helperPos:z,text:v,size:v.length},s._writeToHt(),s._interactor.fi({kind:"betweenEditPoint",event:e})}},Pd.prototype._setCurrentPointImpl=function(U,H){var q=this,p=q._activing;if(!p)return!1;var K=q.target;if(!K)return!1;var r=p.getCurrentEditingPoint();if(!r)return!1;var C=p.editingCtrl;if(!C)var j=r.clone();if("e"===U)r.e=H;else{var B;if("x"===U||"y"===U){var s=p._lastFirePoint;B="x"===U?{x:H,y:s?s.y:0}:{x:s?s.x:0,y:H}}else"object"==typeof U?(B=U,U.e!==c&&(r.e=U.e)):(B={x:arguments[0],y:arguments[1]},arguments[2]!==c&&(r.e=arguments[2]));var X=Uj.getDataMatrix(K);B=Uj.toScreenPosition(q._interactor.gv,X.apply(B)),r.x=B.x,r.y=B.y}if(!C){var m=j.multiplyScalar(-1).add(r);r.e&&j.e&&(m.e=r.e-j.e);var v=q.screenInfo.curve;v.moveCtrlDueToRealPointMovement(r,m);var R=p.selections;if(R){var O=0;R.forEach(function(F){var e=F.clone().add(m);isFinite(m.e)&&(e.e=(isFinite(F.e)?F.e:K.getElevation()||0)+m.e),v.moveRealPoint(F,e),R[O++]=e}),p.selections=R}}return!0},Pd.prototype.setCurrentPoint=function(W,X){return this._setCurrentPointImpl(W,X)?(this._writeToHt(),!0):!1},Pd.prototype._isEditEdgeSourceTarget=function(){var R=this,P=R.target;if(!(P instanceof C.Edge))return!1;var b=R.editing.point,J=R.screenInfo.curve._curves;return b===J[0]._p1?"source":b===J[J.length-1]._p4?"target":!1},Pd.prototype._editEdgeSourceTarget=function(L,D,n){var U,F=this,H=F.target;if(U="source"===L?H.getSource():H.getTarget()){var T,z=F._interactor.gv,A=Uj.toWorldPosition(z,D),E=F._calcHostAnchor(H,L,A,U);if(T=E.index!==c||E.percent!==c?E.distance*z.getZoom()>F._interactor.getStyle("edgeHostEdgeMaxDistance"):F._interactor.getStyle("edgeHostDetectPerFrame")?!0:E.x<0||E.x>1||E.y<0||E.y>1?!0:!1){var I=z.getDataAt(A,function(y){return z.isSelectable(y)?z.isSourceTargetEditable(H,y,L)?H.canSetSourceTarget(y,L)?!0:!1:!1:!1});if(I){var k=F._calcHostAnchor(H,L,A,I);U=I,F._nextChangeEdgeHost={type:L,host:I},E=k}}var B,m,V;if(n||E.x===c)(E.percent!==c||E.index!==c)&&(m=E.point);else{var C=F._interactor.getStyle("anchorRound"),Z=F._interactor.getStyle("anchorSensitivity");B=z.calculateAttachPoint(U,A),B?E=B.info:(E.x=Uj.roundTo(E.x,C,Z),E.y=Uj.roundTo(E.y,C,Z)),m=Kd(z,U,0,E.offsetX||0,E.offsetY||0,E.x,E.y)}m&&(V=Uj.toScreenPosition(z,m),D.x=V.x,D.y=V.y),F._edgeHostGuideInfo={corners:Uj.getTargetCornersOnScreen(z,U),attach:B?B.index:-1,host:U};var K;return E.percent!==c?K="percent: "+E.percent.toFixed(2):E.index!==c?K="index: "+E.index:(K=""+E.x.toFixed(2)+", "+E.y.toFixed(2),(E.offsetX||E.offsetY)&&(K+=" offset: "+E.offsetX.toFixed(2)+", "+E.offsetY.toFixed(2))),{host:U,anchor:E,tipText:K}}},Pd.prototype._guidingToEdit=function(v,n){var w,D,C=this;if(w=C.screenInfo.curve){D=w._curves;var h,U,N,L,O,k,Y,e,M=1/0,c=1/0,B=[];for(C.editing&&"realPoint"===C.editing.type&&(e=C.editing.point),O=0,k=2*D.length;k>O;O++)Y=D[Math.floor(O/2)][O%2?"_p4":"_p1"],B.indexOf(Y)>=0||(B.push(Y),e&&e===Y||(N=Y.x-v.x,L=Y.y-v.y,Math.abs(N)<Math.abs(M)?(M=N,h=[Y]):N===M&&h.push(Y),Math.abs(L)<Math.abs(c)?(c=L,U=[Y]):L===c&&U.push(Y)));var F=C._interactor.getStyle("smartGuideThreshold");if((Math.abs(M)>F||"y"===n)&&(h=null),(Math.abs(c)>F||"x"===n)&&(U=null),h||U){var G=!1,P={};if(h&&(G=!0,P.xList=h,P.x=M),U&&(G=!0,P.yList=U,P.y=c),G)return P}}},Pd.prototype._46O=function(F){var w=this;w.editing&&(w.editing=null,w._interactor.fi({kind:"endEditPoint",event:F})),w._guideInfo=null,w._edgeHostGuideInfo=null,w._pan&&(w._pan=null,w._interactor.fi({kind:"endPan",event:F})),w._multiSelect&&(w._handleMultiSelect(w._multiSelect,F),w._multiSelect=null),w.tipInfo=null,w.edgeEditResult=null},Pd.prototype._handleMultiSelect=function(p,M){if(p.startPoint&&p.endPoint){var s,d,E,T,w,u,N=this,B=N._interactor,t=B.gv,j=Uj.toScreenPosition(t,p.startPoint),F=Uj.toScreenPosition(t,p.endPoint),g=C.Default.unionPoint(j,F),D=N.screenInfo.curve._curves,H=[],I=function(V){V.x>=g.x&&V.y>=g.y&&V.x<=g.x+g.width&&V.y<=g.y+g.height&&H.indexOf(V)<0&&H.push(V)};for(s=0,d=D.length;d>s;s++)w=D[s],I(w._p1),I(w._p4);if(H.length){var y=N.activing||{},x=y.selections||[];y.point&&x.push(y.point);var J=C.Default.isShiftDown(M),n=M.altKey;if(n&&!J)for(u=H,H=[],s=0,d=u.length;d>s;s++)E=u[s],T=x.indexOf(E),T>=0&&H.push(E);for(s=0,d=x.length;d>s;s++)E=x[s],T=H.indexOf(E),T>=0?(!J||J&&n)&&(H[T]=c):H.push(E);for(u=H,H=[],s=0,d=u.length;d>s;s++)u[s]&&H.push(u[s]);d=H.length,0===d?N.activing=null:1===d?N.activing={point:H[0]}:(E=H[d-1],N.activing={point:E,selections:H.splice(0,d-1)}),B.redraw()}}},Pd.prototype._canDeletePoint=function(H,B){var k=this.target;if(!(k instanceof C.Edge))return!0;var o=H._curves[0],v=H._curves[H._curves.length-1];return o._p1===B||v._p4===B?!1:!0},Pd.prototype.handleDelete=function(){var k=this;if(k.activing&&k.screenInfo){var M=C.Default.isShiftDown(),z=k.screenInfo.curve;k._canDeletePoint(z,k.activing.point)&&z.deleteRealPoint(k.activing.point,M),k.activing.selections&&k.activing.selections.forEach(function(d){k._canDeletePoint(z,d)&&z.deleteRealPoint(d,M)}),k.activing=null,delete k.editing,delete k.tipInfo,delete k.edgeEditResult,delete k._pan,delete k._multiSelect,k._writeToHt(),k._interactor.fp("deleteShapePoint",!1,!0)}},Pd.prototype.handleDoubleClick=function(u){var e=this,E=e._interactor._getLogicalPoint(u);if(e.screenInfo&&e._checkEditRealPoint(E)){var F=e.getCurrentSelectintStatus(),K=Uj.Curve.PointType;return F=F===K.Mirrored?K.Straight:K.Mirrored,e._setCurrentSelectionStatus(F),e._interactor._42(),!0}},Pd.prototype._drawHighlight=function(n){var p=this,b=p.highlight;if(b){var S=b.bezier,$=p._interactor;S&&Uj.Icons.DrawIcon($,n,Uj.Icons.ShapeHighlightCurve,[S._p1.x,S._p1.y,S._p2.x,S._p2.y,S._p3.x,S._p3.y,S._p4.x,S._p4.y]);var W=b.point;W&&"insertKnot"===b.type&&Uj.Icons.DrawIcon($,n,Uj.Icons.ShapeHighlighPoint,W)}},Pd.prototype._drawGuide=function(b){var w=this,k=w._guideInfo;if(k){var j,L,m,W,F=k.v;for(j=0;2>j;j++)if(W=0===j?k.xList:k.yList)for(L=0,m=W.length;m>L;L++)Uj.Icons.DrawIcon(w._interactor,b,Uj.Icons.ShapeGuideLine,[F.x,F.y,W[L].x,W[L].y])}},Pd.prototype._drawCurrentPoint=function(Q){var d=this;if(d.activing){var H=d.activing,b=d.getCurrentSelectintStatus(),i=d._interactor;if(b!==Uj.Curve.PointType.Straight){var k=H.pairs;H.hlpair,H.hltype;var Y=H.selections,g=H.editingCtrl;if(k&&!Y){var O,V,E;for(V=0,E=k.length;E>V;V++)O=k[V],g&&V===g.pairId&&O[g.type]?Uj.Icons.DrawIcon(i,Q,Uj.Icons.ShapeActivingCtrl,{point:O.point,c1:O.c1,c2:O.c2,hl:g.type}):Uj.Icons.DrawIcon(i,Q,Uj.Icons.ShapeActivingCtrl,O)}}Uj.Icons.DrawIcon(i,Q,Uj.Icons.ShapeHighlighRealPoint,d.activing.point),Y&&Y.forEach(function(F){Uj.Icons.DrawIcon(i,Q,Uj.Icons.ShapeHighlighRealPoint,F)})}},Pd.prototype.clear=function(){var F=this;F.editing=null,F._guideInfo=null,F.activing=null,F.highlight=null},Pd.prototype._42=function(R){var p=this;p.info={},p.editing||(p.screenInfo=null);var N=p._interactor;if(!N.editDetail)return p.clear(),void 0;var a=N.gv;if(!p.target||!a.isSelected(p.target)||!a.isVisible(p.target))return N.editDetail=!1,p.clear(),void 0;if(p.gatherSingleTarget(a,p.target),Uj.Icons.DrawIcon(N,R,Uj.Icons.ShapeBgCurve,p.screenInfo),p._interactor.getStyle("curveElevationVisible")&&(p.target instanceof C.Polyline||p.target instanceof C.Edge&&p._interactor.getStyle("edgeElevationEditable"))&&p.activing){var x=p.activing.getCurrentEditingPoint();x&&"string"!=typeof x.e&&Uj.Icons.DrawIcon(N,R,Uj.Icons.EdgeElevationGuide,x)}if(p._drawHighlight(R),p._drawCurrentPoint(R),p._getRealPoint().forEach(function(C){Uj.Icons.DrawIcon(N,R,Uj.Icons.ShapePoint,C)}),p._drawGuide(R),p.tipInfo&&p._interactor.getStyle("curveTipVisible")&&Uj.Icons.DrawIcon(N,R,Uj.Icons.TipHelper,p.tipInfo),p._edgeHostGuideInfo&&N._drawHostGuide(p._edgeHostGuideInfo),p.edgeEditResult&&p._drawEdgeHostHighlight(R,p.edgeEditResult.host,p.edgeEditResult.anchor),p._multiSelect&&p._multiSelect.endPoint){var o=C.Default.unionPoint(Uj.toScreenPosition(a,p._multiSelect.startPoint),Uj.toScreenPosition(a,p._multiSelect.endPoint));o.color=a.getRectSelectBorderColor(),R.save(),R.setTransform(1,0,0,1,0,0);var u=G.devicePixelRatio,K=o.borderWidth=Math.round(u);K/=2,o.x=Math.round(o.x*u)+K,o.y=Math.round(o.y*u)+K,o.width=Math.round(o.width*u),o.height=Math.round(o.height*u),Uj.Icons.DrawIcon(N,R,Uj.Icons.SimpleRect,o),R.restore()}},Pd.prototype._drawEdgeHostHighlight=function(L,N,U){this.drawEdgeHostHighlight(L,N,U),this._interactor.redraw()},Pd.prototype.drawEdgeHostHighlight=function(N,f,e){if(hq(f)){var $,C,A,P,n=this,U=n._interactor,p=U.gv,Z=p.getDataUI(f),F=xs(Z),b=[];for(A=0,P=F.points.length;P>A;A++)C=Uj.toScreenPosition(p,F.points.get(A)),b.push(C.x,C.y);F.segments&&($=F.segments.toArray());var z=U.getStyle("edgeHostHighlighPeriod"),E=U.getStyle("edgeHostEdgeHighlighColor");Uj.Icons.DrawIcon(U,N,Uj.Icons.ShapeBgCurve,{P:b,S:$,color:E,dynamicVisible:e.index===c,dynamicPeriod:z}),E=U.getStyle("edgeHostPointHighlighColor");var r=Td(Z);for(A=0,P=r.length;P>A;A++){var W=r[A],x=Uj.toScreenPosition(p,W);Uj.Icons.DrawIcon(U,N,Uj.Icons.ShapePoint,{point:{x:x.x,y:x.y},color:E,size:12,dynamicVisible:A===e.index,dynamicPeriod:z})}}},Pd.prototype._getRealPoint=function(){var t,w=this.screenInfo,a=w.P,R=w.S,J=-1,s=[],d=-1,W=R.length;return R.each(function(l){d++;var E=1;if(3===l)E=2;else if(4===l)E=3;else if(5===l)return;J+=E,t=d+1>=W?!0:1===R.get(d+1)?!0:!1,s.push({point:{x:a[2*J],y:a[2*J+1]},segmentIndex:d,pointIndex:J,isEnd:t})}),s},Pd.prototype.getEditingPointsInfo=function(J){var w=this,v=w.activing;if(!v)return!1;var O=v.point;if(!O)return!1;var L=this._getRealPoint(),V=[{screen:O}];v.selections&&v.selections.forEach(function(N){V.push({screen:N})});var K,s,_=L.length;return V.forEach(function(G){for(K=0;_>K;K++)if(s=L[K],G.screen.isNearEnough(s.point)){G.segmentIndex=s.segmentIndex,G.pointIndex=s.pointIndex,G.point=w.target.getPoints().get(s.pointIndex);break}}),J&&V.sort(function(F,l){return F.segmentIndex-l.segmentIndex}),V};var Bs=Uj.MoveHelper=function(d){var C=this;C.catalog="Move",C._interactor=d};Bs.prototype={},Bs.prototype.constructor=Bs,Bs.prototype.calcShift=function(i,h,p){var X,f,e=this,G=e._interactor.gv,d=G.lp(h);if("beginMove"===i&&e._gatherGridInfo(p._lastLogicalPoint||d),X=e._target){var R=X.downPosition;if(R){var t=e._interactor.getStyle("moveSensitivity")/G._zoom;if(R.distanceTo(d)<t)return{x:0,y:0};delete X.downPosition}var b;f=C.Default.isShiftDown(h),f&&(d=e._dealShiftDown(d),b=X.shiftGuide.dir);var N,L=X.rawPos={x:X.pos.x+d.x-X.lp.x,y:X.pos.y+d.y-X.lp.y};if(C.Default.isCtrlDown(h)){if(N=e._calcShiftByAddon(),e._target.node instanceof Uj.Group){var j=e._target.node;j._position.x+=N.x,j._position.y+=N.y}return N}var I=e._interactor.rectGuide;if(X.node instanceof C.Data&&X.node.s("2d.attachable")){var r=e._calcAttachNodeShift(X.node,L);if(I.clear(),r)return r}for(var J,g=X.x+L.x,u=X.y+L.y,Q={x:g,y:u},q={x:g+X.w/2,y:u+X.h/2},Y={x:g+X.w,y:u+X.h},w=e._interactor.gridGuide,k=[I.findClosest(Q,b),I.findClosest(q,b),I.findClosest(Y,b),w.findClosest(Q,b),w.findClosest(q,b),w.findClosest(Y,b)],z=1/0,A=1/0,m=0,s=k.length;s>m;m++)J=k[m],J&&(g=J.x,u=J.y,isFinite(g)&&Math.abs(g)<Math.abs(z)&&(z=g),isFinite(u)&&Math.abs(u)<Math.abs(A)&&(A=u));if(isFinite(z)||(z=0),isFinite(A)||(A=0),N=e._calcShiftByAddon(z,A),e._target.node instanceof Uj.Group){var j=e._target.node;j._position.x+=N.x,j._position.y+=N.y}var P=X.node;if(!tm(P,G)){var c=L.x+z,O=L.y+A;e._interactor.rectGuide.gatherLines({node:P,x:X.x+c,y:X.y+O,w:X.w,h:X.h},b)}return N}},Bs.prototype._calcShiftByAddon=function(n,Z){var e=this._target,P=e.rawPos,y=e.node.getPosition();return n=n||0,Z=Z||0,{x:P.x-y.x+n,y:P.y-y.y+Z}},Bs.prototype._dealShiftDown=function(i){var Q=this,u=Q._target.shiftGuide,p=Q._target.lp,E=Math.abs(i.x-p.x),n=Math.abs(i.y-p.y);E>n&&E>u.limit&&"y"===u.dir&&(u.dir="x"),n>E&&n>u.limit&&"x"===u.dir&&(u.dir="y");var e=u.dir;return"x"===e?(i.y=p.y,u.limit=Math.max(u.limit,E)):"y"===e&&(i.x=p.x,u.limit=Math.max(u.limit,n)),i},Bs.prototype._isAttachableLineShape=function(Z){if(!Z.getSegments)return!1;var O=Z.getSegments();if(!O)return!0;O instanceof C.List&&(O=O.getArray());for(var p=1,s=O.length;s>p;p++)if(2!==O[p])return!1;return!0},Bs.prototype._calcAttachNodeShift=function(){var z=new jm,M=new jm,Y=new jm,_=new jm;return function(C,I){var L=this._interactor.gv,P=C.getHost(),A=L.getDataAt(I,function(y){return y.s("2d.hostable")?!0:!1});if(A&&P!==A&&C.setHost(A),!A)return this._edgeHostGuideInfo=null,C.setHost(null);var r=this._edgeHostGuideInfo={corners:Uj.getTargetCornersOnScreen(L,A),host:A,attach:-1};if(this._isAttachableLineShape(A)){for(var t,J,S,i,k,O,$=A.getPoints(),B=$.size(),K=A.getPointsMatrix2d(),G=1/0,j=0;B>j&&(j!==B-1||A.isClosePath());j++)0!==j?M.copy(Y):K.apply($.get(j),M),K.apply(j===B-1?$.get(0):$.get(j+1),Y),z.copy(I).sub(M),_.copy(Y).sub(M),t=_.length(),_.divideScalar(t),J=z.dot(_),0>J?J=0:J>t&&(J=t),_.multiplyScalar(J).add(M),S=z.copy(I).sub(_).lengthSq(),G>S&&(G=S,O=j,i=J,k=t);return Math.sqrt(G)*L.getZoom()>this._interactor.getStyle("attachThreshold")?(C.s({"attach.index":-1}),C.setHost(null),void 0):(C.s("attach.offset.opposite")&&(i=k-i),C.s({"attach.index":O,"attach.offset":C.s("attach.offset.relative")?i/k:i}),{x:0,y:0})}var b=L.calculateAttachPoint(A,I);if(b){var s=b.point;return r.attach=b.index,this._calcShiftByAddon(s.x-I.x,s.y-I.y)}}}(),Bs.prototype._gatherGridInfo=function(u){var B,l=this,d=l._interactor,A=d._getValidSelection();if(A.length){if(1===A.length){if(B=A[0],!B.getRect)return l._target=null,void 0}else if(B=Uj.Group.findOrCreateGroup(A,d._uuid),!B)return l._target=null,void 0}else{var A=d.gv.sm().getSelection();if(A.length&&(B=A.get(0),!B.getRect))return l._target=null,void 0}if(B){var S=B.getPosition(),f=B.getRect();l._target={node:B,x:f.x-S.x,y:f.y-S.y,w:f.width,h:f.height,lp:{x:u.x,y:u.y},pos:{x:S.x,y:S.y},shiftGuide:{dir:"x",limit:0},downPosition:new Uj.Math.Vector2(u)},d.rectGuide.gatherRects()}},Bs.prototype.clear=function(){var m=this;m._edgeHostGuideInfo=null,m._interactor.rectGuide.clear(),m._interactor._42()},Bs.prototype._42=function(){var x=this._edgeHostGuideInfo;x&&this._interactor._drawHostGuide(x)};var Gp=g.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),Zp=function(){function m(o,X){var w=c;return function(){return w||(w=o.getExtension(X)),w}}function Q(t,Y){Y==c&&(Y={}),Y.version=n&&(t instanceof WebGL2RenderingContext||g.prototype.toString.call(t)===y)?2:1,Y.extensions=function(){for(var j={},x=t.getSupportedExtensions(),f=x.length;f--;)j[name]=m(t,x[f]);return j}();for(var $=g.keys(b),N=0,x=$.length;x>N;++N){var D=$[N];Y[D]=t.getParameter(b[D])}if(Y.version>1){$=g.keys(W);for(var N=0,x=$.length;x>N;++N){var D=$[N];Y[D]=t.getParameter(W[D])}}return Y}var n="undefined"!=typeof WebGL2RenderingContext,y="[object WebGL2RenderingContext]",b={aliasedLineWidthRange:Gp.ALIASED_LINE_WIDTH_RANGE,aliasedPointSizeRange:Gp.ALIASED_POINT_SIZE_RANGE,maxCombinedTextureImageUnits:Gp.MAX_COMBINED_TEXTURE_IMAGE_UNITS,maxCubeMapTextureSize:Gp.MAX_CUBE_MAP_TEXTURE_SIZE,maxFragmentUniformVectors:Gp.MAX_FRAGMENT_UNIFORM_VECTORS,maxRenderBufferSize:Gp.MAX_RENDERBUFFER_SIZE,maxTextureImageUnits:Gp.MAX_TEXTURE_IMAGE_UNITS,maxTextureSize:Gp.MAX_TEXTURE_SIZE,maxVaryingVectors:Gp.MAX_VARYING_VECTORS,maxVertexAttribs:Gp.MAX_VERTEX_ATTRIBS,maxVertexTextureImageUnits:Gp.MAX_VERTEX_TEXTURE_IMAGE_UNITS,maxVertexUniformVectors:Gp.MAX_VERTEX_UNIFORM_VECTORS,maxViewportDIMs:Gp.MAX_VIEWPORT_DIMS},W={max3DTextureSize:Gp.MAX_3D_TEXTURE_SIZE,maxArrayTextureLayers:Gp.MAX_ARRAY_TEXTURE_LAYERS,maxColorAttachments:Gp.MAX_COLOR_ATTACHMENTS,maxCombinedFragmentUniformComponents:Gp.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,maxCombinedUniformBlocks:Gp.MAX_COMBINED_UNIFORM_BLOCKS,maxCombinedVertexUniformComponents:Gp.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,maxDrawBuffers:Gp.MAX_DRAW_BUFFERS,maxElementIndex:Gp.MAX_ELEMENT_INDEX,maxElementsIndices:Gp.MAX_ELEMENTS_INDICES,maxElementsVertices:Gp.MAX_ELEMENTS_VERTICES,maxFragmentInpuComponents:Gp.MAX_FRAGMENT_INPUT_COMPONENTS,maxFragmentUniformBlocks:Gp.MAX_FRAGMENT_UNIFORM_BLOCKS,maxFragmentUniformComponents:Gp.MAX_FRAGMENT_UNIFORM_COMPONENTS,maxProgramTexelOffset:Gp.MAX_PROGRAM_TEXEL_OFFSET,maxSamples:Gp.MAX_SAMPLES,maxTextureLODBias:Gp.MAX_TEXTURE_LOD_BIAS,maxTransformFeedbackInterleavedComponents:Gp.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,maxTransformFeedbackSeparateAttribs:Gp.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,maxTransformFeedbackSeparateComponents:Gp.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,maxUniformBlockSize:Gp.MAX_UNIFORM_BLOCK_SIZE,maxUniformBufferBindings:Gp.MAX_UNIFORM_BUFFER_BINDINGS,maxVaryingComponents:Gp.MAX_VARYING_COMPONENTS,maxVertexOutputComponents:Gp.MAX_VERTEX_OUTPUT_COMPONENTS,maxVertexUniformBlocks:Gp.MAX_VERTEX_UNIFORM_BLOCKS,maxVertexUniformComponents:Gp.MAX_VERTEX_UNIFORM_COMPONENTS,minProgramTexelOffset:Gp.MIN_PROGRAM_TEXEL_OFFSET};
return{"for":function(j){var w=j._info;return w||(j._info=w=Q(j,w)),w}}}(),$i=function(){function q(_,J,W){return{def:_,getter:W?function($){var x=Zp.for($);return x.version>1?$.getParameter(J):_}:function(k){return k.getParameter(J)},setter:W?function(t,N){var y=Zp.for(t);y.version>1&&t.pixelStorei(J,N)}:function(h,e){h.pixelStorei(J,e)}}}function X(r){return"string"==typeof r?Ap(r):r.r!==c?(_[0]=r.r,_[1]=r.g,_[2]=r.b,_[3]=r.a,_):r.red!==c?(_[0]=r.red,_[1]=r.green,_[2]=r.blue,_[3]=r.alpha,_):r}function d(X){return K(X)?Array.prototype.slice.call(X,0):X}function W(u,k,B){this.gl=k,this._record=B||{},this._branches={},this._leafSync={},this._struct=u;for(var E=u.children,T=E.length;T--;){var R=E[T],h=R.name;R.isLeaf?(this._leafSync[h]=!1,this._record[h]=d(R.desc.def)):this._record[h]={}}}function n(m){function q(E,e){W.call(this,m,E,e);for(var d=i.length;d--;){var Q=i[d];this._branches[Q._name]=new Q._type(E,this._record[Q._name])}}function M(f,E){function T(o,$){for(var U=e,q=!1;U--;)o[U]!==$[U]&&(o[U]=$[U],q=!0);return q}var U=f.name,p=K(f.desc.def),e=p&&f.desc.def.length;if(f.isLeaf){var d=f.desc.setter,V=f.desc.parse;g.defineProperty(E,U,{configurable:!1,enumerable:!0,get:function(){return this._record[U]},set:p?function(_){V&&(_=V(_)),(T(this._record[U],_)||!this._leafSync[U])&&(d(this.gl,this._record[U]),this._leafSync[U]=!0)}:function(Q){this._record[U]===Q&&this._leafSync[U]||(d(this.gl,Q),this._record[U]=Q,this._leafSync[U]=!0)}})}else i.push({_name:U,_type:n(f)}),g.defineProperty(E,U,{configurable:!1,enumerable:!0,get:function(){return this._branches[U]},set:function(n){this._branches[U].apply(n)}})}var i=[];return N(q,W),m.forEach(M,q.prototype),q}var _="undefined"!=typeof Float32Array&&new Float32Array(4),L={viewport:{def:[0,0,0/0,0/0],getter:function(O){return O.getParameter(O.VIEWPORT)},setter:function(K,y){var Z=y[2]!==y[2]?K.drawingBufferWidth-y[0]:y[2],L=y[3]!==y[3]?K.drawingBufferHeight-y[1]:y[3];K.viewport(y[0],y[1],Z,L)}},dither:{def:!1,getter:function(D){return D.isEnabled(D.DITHER)},setter:function(P,B){B?P.enable(P.DITHER):P.disable(P.DITHER)}},rasterizerDiscard:{def:!1,getter:function(E){var K=Zp.for(E);return K.version>1&&E.isEnabled(E.RASTERIZER_DISCARD)},setter:function(D,q){var x=Zp.for(D);1!==x.version&&(q?D.enable(D.RASTERIZER_DISCARD):D.disable(D.RASTERIZER_DISCARD))}},lineWidth:{def:1,getter:function(c){return c.lineWidth?c.getParameter(c.LINE_WIDTH):1},setter:function(B,i){B.lineWidth&&B.lineWidth(i)}},color:{clear:{def:[0,0,0,0],getter:function(w){return w.getParameter(w.COLOR_CLEAR_VALUE)},setter:function(x,M){x.clearColor(M[0],M[1],M[2],M[3])},parse:X},mask:{def:[!0,!0,!0,!0],getter:function(w){return w.getParameter(w.COLOR_WRITEMASK)},setter:function(c,v){c.colorMask(v[0],v[1],v[2],v[3])}}},blend:{enabled:{def:!1,getter:function(T){return T.isEnabled(T.BLEND)},setter:function(k,l){l?k.enable(k.BLEND):k.disable(k.BLEND)}},color:{def:[0,0,0,0],getter:function(m){return m.getParameter(m.BLEND_COLOR)},setter:function(C,v){C.blendColor(v[0],v[1],v[2],v[3])},parse:X},equation:{def:[Gp.FUNC_ADD,Gp.FUNC_ADD],getter:function(a){return[a.getParameter(a.BLEND_EQUATION_RGB),a.getParameter(a.BLEND_EQUATION_ALPHA)]},setter:function(M,j){M.blendEquationSeparate(j[0],j[1])},parse:function(h){var S=h.length;return S>1?h:1===S?(_[1]=_[0]=h[0],_):(_[1]=_[0]=h,_)}},func:{def:[Gp.ONE,Gp.ZERO,Gp.ONE,Gp.ZERO],getter:function(h){return[h.getParameter(h.BLEND_SRC_RGB),h.getParameter(h.BLEND_DST_RGB),h.getParameter(h.BLEND_SRC_ALPHA),h.getParameter(h.BLEND_DST_ALPHA)]},setter:function(o,r){o.blendFuncSeparate(r[0],r[1],r[2],r[3])},parse:function(n){var G=n.length;return G>3?n:(_[2]=_[0]=n[0],_[3]=_[1]=n[1],_)}}},cullFace:{enabled:{def:!1,getter:function(G){return G.isEnabled(G.CULL_FACE)},setter:function(Y,i){i?Y.enable(Y.CULL_FACE):Y.disable(Y.CULL_FACE)}},mode:{def:Gp.BACK,getter:function(j){return j.getParameter(j.CULL_FACE_MODE)},setter:function(e,L){e.cullFace(L)}},frontFace:{def:Gp.CCW,getter:function(c){return c.getParameter(c.FRONT_FACE)},setter:function(Q,Z){Q.frontFace(Z)}}},scissor:{enabled:{def:!1,getter:function(g){return g.isEnabled(g.SCISSOR_TEST)},setter:function(W,B){B?W.enable(W.SCISSOR_TEST):W.disable(W.SCISSOR_TEST)}},box:{def:[0,0,0/0,0/0],getter:function(x){return x.getParameter(x.SCISSOR_BOX)},setter:function(I,B){var d=B[2]!==B[2]?I.drawingBufferWidth-B[0]:B[2],l=B[3]!==B[3]?I.drawingBufferHeight-B[1]:B[3];I.scissor(B[0],B[1],d,l)}}},depth:{enabled:{def:!1,getter:function(U){return U.isEnabled(U.DEPTH_TEST)},setter:function(s,E){E?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST)}},clear:{def:1,getter:function(e){return e.getParameter(e.DEPTH_CLEAR_VALUE)},setter:function(V,D){V.clearDepth(D)}},mask:{def:!0,getter:function(L){return L.getParameter(L.DEPTH_WRITEMASK)},setter:function(m,s){m.depthMask(s)}},range:{def:[-1,1],getter:function(p){return p.getParameter(p.DEPTH_RANGE)},setter:function(y,T){y.depthRange(T[0],T[1])}},func:{def:Gp.LESS,getter:function(l){return l.getParameter(l.DEPTH_FUNC)},setter:function(z,a){z.depthFunc(a)}}},stencil:{enabled:{def:!1,getter:function(f){return f.isEnabled(f.STENCIL_TEST)},setter:function(o,p){p?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST)}},clear:{def:0,getter:function(f){return f.getParameter(f.STENCIL_CLEAR_VALUE)},setter:function(w,x){w.clearStencil(x)}},frontMask:{def:255,getter:function(E){return E.getParameter(E.STENCIL_WRITEMASK)},setter:function(k,q){k.stencilMaskSeparate(k.FRONT,q)}},frontOp:{def:[Gp.KEEP,Gp.KEEP,Gp.KEEP],getter:function(g){return[g.getParameter(g.STENCIL_FAIL),g.getParameter(g.STENCIL_PASS_DEPTH_FAIL),g.getParameter(g.STENCIL_PASS_DEPTH_PASS)]},setter:function(g,k){g.stencilOpSeparate(g.FRONT,k[0],k[1],k[2])}},frontFunc:{def:[Gp.ALWAYS,0,255],getter:function(U){return[U.getParameter(U.STENCIL_FUNC),U.getParameter(U.STENCIL_REF),U.getParameter(U.STENCIL_VALUE_MASK)]},setter:function(J,v){J.stencilFuncSeparate(J.FRONT,v[0],v[1],v[2])}},backMask:{def:255,getter:function(l){return l.getParameter(l.STENCIL_BACK_WRITEMASK)},setter:function(v,y){v.stencilMaskSeparate(v.BACK,y)}},backOp:{def:[Gp.KEEP,Gp.KEEP,Gp.KEEP],getter:function(T){return[T.getParameter(T.STENCIL_BACK_FAIL),T.getParameter(T.STENCIL_BACK_PASS_DEPTH_FAIL),T.getParameter(T.STENCIL_BACK_PASS_DEPTH_PASS)]},setter:function(s,j){s.stencilOpSeparate(s.BACK,j[0],j[1],j[2])}},backFunc:{def:[Gp.ALWAYS,0,255],getter:function(N){return[N.getParameter(N.STENCIL_BACK_FUNC),N.getParameter(N.STENCIL_BACK_REF),N.getParameter(N.STENCIL_BACK_VALUE_MASK)]},setter:function(x,Y){x.stencilFuncSeparate(x.BACK,Y[0],Y[1],Y[2])}}},hint:{generateMipmap:{def:Gp.DONT_CARE,getter:function(g){return g.getParameter(g.GENERATE_MIPMAP_HINT)},setter:function(r,T){r.hint(r.GENERATE_MIPMAP_HINT,T)}},fragmentShaderDerivative:{def:Gp.DONT_CARE,getter:function(I){var M=Zp.for(I);return 1!==M.version||M.extensions.OES_standard_derivatives?I.getParameter(Gp.FRAGMENT_SHADER_DERIVATIVE_HINT):Gp.DONT_CARE},setter:function(I,v){var R=Zp.for(I);return R.version>1||R.extensions.OES_standard_derivatives?(I.hint(Gp.FRAGMENT_SHADER_DERIVATIVE_HINT,v),void 0):void 0}}},pixelStore:{packAlignment:q(4,Gp.PACK_ALIGNMENT,!1),unpackAlignment:q(4,Gp.UNPACK_ALIGNMENT,!1),unpackFlipY:q(!1,Gp.UNPACK_FLIP_Y_WEBGL,!1),unpackPremultiplyAlpha:q(!1,Gp.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),unpackColorspaceConversion:q(Gp.BROWSER_DEFAULT_WEBGL,Gp.UNPACK_COLORSPACE_CONVERSION_WEBGL,!1),packRowLength:q(0,Gp.PACK_ROW_LENGTH,!0),packSkipPixels:q(0,Gp.PACK_SKIP_PIXELS,!0),packSkipRows:q(0,Gp.PACK_SKIP_ROWS,!0),unpackRowLength:q(0,Gp.UNPACK_ROW_LENGTH,!0),unpackImageHeight:q(0,Gp.UNPACK_IMAGE_HEIGHT,!0),unpackSkipPixels:q(0,Gp.UNPACK_SKIP_PIXELS,!0),unpackSkipRows:q(0,Gp.UNPACK_SKIP_ROWS,!0),unpackSkipImages:q(0,Gp.UNPACK_SKIP_IMAGES,!0)},polygonOffset:{enabled:{def:!1,getter:function(K){return K.isEnabled(K.POLYGON_OFFSET_FILL)},setter:function(X,K){K?X.enable(X.POLYGON_OFFSET_FILL):X.disable(X.POLYGON_OFFSET_FILL)}},value:{def:[0,0],getter:function(G){return[G.getParameter(G.POLYGON_OFFSET_FACTOR),G.getParameter(G.POLYGON_OFFSET_UNITS)]},setter:function(C,G){C.polygonOffset(G[0],G[1])}}},sampleCoverage:{enabled:{def:!1,getter:function(r){return r.isEnabled(r.SAMPLE_COVERAGE)},setter:function(H,V){V?H.enable(H.SAMPLE_COVERAGE):H.disable(H.SAMPLE_COVERAGE)}},alpha:{def:!1,getter:function(f){return f.isEnabled(f.SAMPLE_ALPHA_TO_COVERAGE)},setter:function(y,P){P?y.enable(y.SAMPLE_ALPHA_TO_COVERAGE):y.disable(y.SAMPLE_ALPHA_TO_COVERAGE)}},value:{def:[1,!1],getter:function(e){return[e.getParameter(e.SAMPLE_COVERAGE_VALUE),e.getParameter(e.SAMPLE_COVERAGE_INVERT)]},setter:function(s,R){s.sampleCoverage(R[0],R[1])}}}},l=xp.create(L,function(Q){return"def"in Q});W.prototype.reset=function(){for(var g=this._struct.children,V=g.length;V--;){var s=g[V],D=s.name;s.isLeaf?this[D]=s.desc.def:this._branches[D].reset()}},W.prototype.save=function(g){g==c&&(g={});for(var y=this._struct.children,$=y.length;$--;){var K=y[$],R=K.name;if(K.isLeaf)g[R]=d(this._record[R]);else{var J=g[R];J==c&&(g[R]=J={}),this._branches[R].save(J)}}return g},W.prototype.sync=function(B,k){for(var P=this._struct.children,w=P.length;w--;){var T=P[w],M=T.name;T.isLeaf?(k||!this._leafSync[M])&&(B?(this._record[M]=T.desc.getter(this.gl),this._leafSync[M]=!0):(T.desc.setter(this.gl,this._record[M]),this._leafSync[M]=!0)):this._branches[M].sync(B,k)}},W.prototype.syncLoss=function(){for(var T=this._struct.children,o=T.length;o--;){var B=T[o];B.isLeaf?this._leafSync[B.name]=!1:this._branches[B.name].syncLoss()}},W.prototype.apply=function(u){for(var M=this._struct.children,y=M.length;y--;){var X=M[y],$=X.name;$ in u&&(X.isLeaf?this[$]=u[$]:this._branches[$].apply(u[$]))}},W.prototype.append=function(R){var n=this._struct.childMap;for(var E in R){var d=n[E];d&&(d.isLeaf?this[E]=R[E]:this._branches[E].append(R[E]))}};var D=n(l);return function(a){var P=a._state;return P||(a._state=P=new D(a)),P}}(),hh=function(){function j(U,x,V,Y){if(U){var H=U.length;if(H!=c)for(var h=0;Y>h;++h)x[V+h]=U[h];else U.toArray&&U.toArray(x,V)}else for(var h=0;Y>h;++h)x[V+h]=0}function P(r,o,H){var m=r[0];if(0>=m||m>0)return r;var V=o*H,g=y[V];if(g==c&&(y[V]=g=new Float32Array(V)),0!==o){j(m,g,0,H);for(var $=1,w=0;$!==o;++$)w+=H,j(r[$],g,w,H)}return g}function p(A,z){A.uniform1f(this.addr,z)}function M(h,E){h.uniform1fv(this.addr,E)}function h(r,R){if(R.x!=c)r.uniform2f(this.addr,R.x,R.y);else{var B=y[2];B.set(R,0),r.uniform2fv(this.addr,B)}}function b(r,H){r.uniform2fv(this.addr,P(H,this.size,2))}function m(D,H){if(H.x!=c)D.uniform3f(this.addr,H.x,H.y,H.z);else if(H.r!=c)D.uniform3f(this.addr,H.r,H.g,H.b);else if(H.red!=c)D.uniform3f(this.addr,H.red,H.green,H.blue);else{var m=y[3];m.set(H,0),D.uniform3fv(this.addr,m)}}function C(f,M){f.uniform3fv(this.addr,P(M,this.size,3))}function S(S,o){if("string"==typeof o&&(o=Ap(o)),o.x!=c)S.uniform4f(this.addr,o.x,o.y,o.z,o.w);else if(o.r!=c)S.uniform4f(this.addr,o.r,o.g,o.b,o.a);else if(o.red!=c)S.uniform4f(this.addr,o.red,o.green,o.blue,o.alpha);else{var j=y[4];j.set(o,0),S.uniform4fv(this.addr,j)}}function f(i,B){i.uniform4fv(this.addr,P(B,this.size,4))}function H(p,I){p.uniform1i(this.addr,I)}function z(h,O){h.uniform1iv(this.addr,O)}function q(j,r){j.uniform2iv(this.addr,r)}function T(n,b){n.uniform3iv(this.addr,b)}function R(E,Y){E.uniform4iv(this.addr,Y)}function X(f,A){f.uniform1i(this.addr,E[A?1:0])}function L(x,u){var F=y[4];F.set(u,0),x.uniformMatrix2fv(this.addr,!1,F)}function k(m,c){m.uniformMatrix2fv(this.addr,!1,P(c,this.size,4))}function Y(h,u){var R=y[9];R.set(u,0),h.uniformMatrix3fv(this.addr,!1,R)}function Q(d,b){d.uniformMatrix3fv(this.addr,!1,P(b,this.size,9))}function v(P,X){var h=y[16];h.set(X,0),P.uniformMatrix4fv(this.addr,!1,h)}function B(T,R){T.uniformMatrix4fv(this.addr,!1,P(R,this.size,16))}function G(R,P){R.uniform1i(this.addr,this.slots[0]),R.activeTexture(R.TEXTURE0+this.slots[0]),R.bindTexture(R.TEXTURE_2D,P||R._emptyTexture)}function O(N,J){N.uniform1iv(this.addr,this.slots);for(var D=this.slots.length;D--;)N.activeTexture(N.TEXTURE0+this.slots[D]),N.bindTexture(N.TEXTURE_2D,J[D]||N._emptyTexture)}function t(M,T){M.uniform1i(this.addr,this.slots[0]),M.activeTexture(M.TEXTURE0+this.slots[0]),M.bindTexture(M.TEXTURE_CUBE_MAP,T||M._emptyCubeTexture)}function A(x,e){x.uniform1iv(this.addr,this.slots);for(var r=this.slots.length;r--;)x.activeTexture(x.TEXTURE0+this.slots[r]),x.bindTexture(x.TEXTURE_CUBE_MAP,e[r]||x._emptyCubeTexture)}function e(B,r,N){d[B]=[r,N]}function i(r,d,S){switch(r.type){case 35678:case 35680:if("uSampler"===S)return[0];if("uBlendSampler"===S)return[1];for(var q=r.size,E=new Int32Array(q),K=0;q>K;++K)E[K]=d.usedTextureSlot++;return E}return c}function u(A,s,y,q,g){this.name=A,this.addr=s,this.size=q?y.size:0,this.activeInfo=y,this.setter=d[y.type][q?1:0],this.slots=i(y,g,A),nq(this)}function J(X,a,H,v){var R=X.name,i=R.length;for(l.lastIndex=0;;){var P=l.exec(R),g=l.lastIndex,f=P[1],k="]"===P[2],O=P[3];if(k&&(f=0|f),O===c||"["===O&&g+2===i){H[f]=new u(f,a,X,O!==c,v);break}var z=H[f];z==c&&(H[f]=z={}),H=z}}function x(n,v,m){this.gl=v,this._program=m,this._leaves={},this._branches={},this._struct=n}function Z(h){function m(f,W){x.call(this,h,f,W);for(var s=e.length;s--;){var q=e[s];this._branches[q._name]=new q._type(f,W)}this.uuid=Up.generateUUID()}function R(f,r){var T=f.name;if(f.isLeaf){var k=o("d.setter(this.gl, v);",["v"],["d"],[f.desc]);g.defineProperty(r,T,{configurable:!1,enumerable:!0,get:function(){return k},set:k})}else e.push({_name:T,_type:Z(f)}),g.defineProperty(r,T,{configurable:!1,enumerable:!0,get:function(){return this._branches[T]},set:function(Y){this._branches[T].apply(Y)}})}var e=[];return N(m,x),h.forEach(R,m.prototype),m}function n(C,k){for(var Y=C.getProgramParameter(k,C.ACTIVE_UNIFORMS),b={},t={usedTextureSlot:2};Y--;){var w=C.getActiveUniform(k,Y),r=w.name,c=C.getUniformLocation(k,r);J(w,c,b,t)}var q=xp.create(b,function(Q){return"addr"in Q}),V=Z(q);return g.defineProperty(V.prototype,"textureCount",{configurable:!1,enumerable:!1,writable:!1,value:t.usedTextureSlot}),new V(C,k)}var y=[];if("function"==typeof Float32Array)for(var V=1;17>V;++V)y[V]=new Float32Array(V);var E=[0,1],d=[];e(Gp.FLOAT,p,M),e(Gp.FLOAT_VEC2,h,b),e(Gp.FLOAT_VEC3,m,C),e(Gp.FLOAT_VEC4,S,f),e(Gp.INT,H,z),e(Gp.INT_VEC2,q,q),e(Gp.INT_VEC3,T,T),e(Gp.INT_VEC4,R,R),e(Gp.BOOL,X,z),e(Gp.BOOL_VEC2,q,q),e(Gp.BOOL_VEC3,T,T),e(Gp.BOOL_VEC4,R,R),e(Gp.FLOAT_MAT2,L,k),e(Gp.FLOAT_MAT3,Y,Q),e(Gp.FLOAT_MAT4,v,B),e(Gp.SAMPLER_2D,G,O),e(Gp.SAMPLER_CUBE,t,A);var l=/([\w\d_]+)(\])?(\[|\.)?/g;return x.prototype.apply=function(O){for(var B=this._struct.children,E=B.length;E--;){var x=B[E],e=x.name;e in O&&(x.isLeaf?this[e]=O[e]:this._branches[e].apply(O[e]))}},x.prototype.append=function(F){var G=this._struct.childMap;for(var x in F){var y=G[x];y&&(y.isLeaf?this[x]=F[x]:this._branches[x].append(F[x]))}},function(V,j){var A=j._uniforms;return A||(j._uniforms=A=n(V,j)),A}}(),Pn=function(){function V(Q,M,A){M.vertexAttrib1f(Q.addr,A)}function h(y,h,l){if(l.x!=c)h.vertexAttrib2f(y.addr,l.x,l.y);else{var J=M[2];J.set(l,0),h.vertexAttrib2fv(y.addr,J)}}function j(t,$,L){if(L.x!=c)$.vertexAttrib3f(t.addr,L.x,L.y,L.z);else if(L.r!=c)$.vertexAttrib3f(t.addr,L.r,L.g,L.b);else if(L.red!=c)$.vertexAttrib3f(t.addr,L.red,L.green,L.blue);else{var I=M[3];I.set(L,0),$.vertexAttrib3fv(t.addr,I)}}function m(w,O,A){if("string"==typeof A&&(A=Ap(A)),A.x!=c)O.vertexAttrib4f(w.addr,A.x,A.y,A.z,A.w);else if(A.r!=c)O.vertexAttrib4f(w.addr,A.r,A.g,A.b,A.a);else if(A.red!=c)O.vertexAttrib4f(w.addr,A.red,A.green,A.blue,A.alpha);else{var T=M[4];T.set(A,0),O.vertexAttrib4fv(w.addr,T)}}function n($,L,K){K=K.el||K;for(var W=0,J=0;2>W;++W)L.vertexAttrib2f($.addr,K[J++],K[J++])}function b(D,g,N){N=N.el||N;for(var L=0,l=0;3>L;++L)g.vertexAttrib3f(D.addr,N[l++],N[l++],N[l++])}function P(B,K,u){u=u.el||u;for(var e=0,E=0;4>e;++e)K.vertexAttrib4f(B.addr,u[E++],u[E++],u[E++],u[E++])}function v(s,l,G,a,I,m,H){l.bindBuffer(l.ARRAY_BUFFER,G),l.vertexAttribPointer(s.addr,1,a||l.FLOAT,!!I,m||0,H||0),l.bindBuffer(l.ARRAY_BUFFER,null)}function z(r,m,G,R,$,O,A){m.bindBuffer(m.ARRAY_BUFFER,G),m.vertexAttribPointer(r.addr,2,R||m.FLOAT,!!$,O||0,A||0),m.bindBuffer(m.ARRAY_BUFFER,null)}function w(E,x,M,v,Q,O,G){x.bindBuffer(x.ARRAY_BUFFER,M),x.vertexAttribPointer(E.addr,3,v||x.FLOAT,!!Q,O||0,G||0),x.bindBuffer(x.ARRAY_BUFFER,null)}function Q(q,h,f,R,m,K,o){h.bindBuffer(h.ARRAY_BUFFER,f),h.vertexAttribPointer(q.addr,4,R||h.FLOAT,!!m,K||0,o||0),h.bindBuffer(h.ARRAY_BUFFER,null)}function H(O,D,g,j,B,e,k){var e=e||4,k=k||0;D.bindBuffer(D.ARRAY_BUFFER,g),D.vertexAttribPointer(O.addr,2,j||D.FLOAT,!!B,e,k),D.vertexAttribPointer(O.addr+1,2,j||D.FLOAT,!!B,e,k+2),D.bindBuffer(D.ARRAY_BUFFER,null)}function G(o,n,$,M,t,p,c){var p=p||9,c=c||0;n.bindBuffer(n.ARRAY_BUFFER,$),n.vertexAttribPointer(o.addr,3,M||n.FLOAT,!!t,p,c),n.vertexAttribPointer(o.addr+1,3,M||n.FLOAT,!!t,p,c+3),n.vertexAttribPointer(o.addr+2,3,M||n.FLOAT,!!t,p,c+6),n.bindBuffer(n.ARRAY_BUFFER,null)}function f(W,J,b,U,F,H,r){var H=H||16,r=r||0;J.bindBuffer(J.ARRAY_BUFFER,b),J.vertexAttribPointer(W.addr,4,U||J.FLOAT,!!F,H,r),J.vertexAttribPointer(W.addr+1,4,U||J.FLOAT,!!F,H,r+4),J.vertexAttribPointer(W.addr+2,4,U||J.FLOAT,!!F,H,r+8),J.vertexAttribPointer(W.addr+3,4,U||J.FLOAT,!!F,H,r+12),J.bindBuffer(J.ARRAY_BUFFER,null)}function p(z,D,p){S[z]=function(l,y,f,S,G,N){this.addr==c||this.addr<0||(y==c||y===!1?l.disableVertexAttribArray(this.addr):Rk(y)===t?(l.enableVertexAttribArray(this.addr),p(this,l,y,f,S,G,N)):(l.disableVertexAttribArray(this.addr),D(this,l,y)))}}function y(n,L,P){this.name=n,this.addr=L,this.activeInfo=P,this.setter=S[P.type],nq(this)}function A(v,Q,h){this.gl=Q,this.program=h,this._branches={},this._struct=v}function _(L){function v(_,e){A.call(this,L,_,e);for(var H=M.length;H--;){var x=M[H];this._branches[x._name]=new x._type(_,e)}}function x(O,C){var A=O.name;if(O.isLeaf){var U=o("d.setter(this.gl, v);",["v"],["d"],[O.desc]);g.defineProperty(C,A,{configurable:!1,enumerable:!0,get:function(){return U},set:U})}else M.push({_name:A,_type:_(O)}),g.defineProperty(C,A,{configurable:!1,enumerable:!0,get:function(){return this._branches[A]},set:function(d){this._branches[A].apply(d)}})}var M=[];return N(v,A),L.forEach(x,v.prototype),v}function J(n,g){for(var M=n.getProgramParameter(g,n.ACTIVE_ATTRIBUTES),v={};M--;){var C=n.getActiveAttrib(g,M),f=C.name,K=n.getAttribLocation(g,f);v[f]=new y(f,K,C)}var q=xp.create(v,function(B){return"addr"in B}),h=_(q);return new h(n,g)}for(var M=[],x=1;17>x;++x)M[x]=new Ek(x);var S=[],t="undefined"!=typeof WebGLBuffer&&WebGLBuffer.prototype;return p(Gp.FLOAT,V,v),p(Gp.FLOAT_VEC2,h,z),p(Gp.FLOAT_VEC3,j,w),p(Gp.FLOAT_VEC4,m,Q),p(Gp.FLOAT_MAT2,n,H),p(Gp.FLOAT_MAT3,b,G),p(Gp.FLOAT_MAT4,P,f),A.prototype.disable=function(){for(var x=this._struct.children,v=x.length;v--;){var $=x[v],A=$.name;$.isLeaf?this.gl.disableVertexAttribArray($.desc.addr):this._branches[A].disable()}},A.prototype.apply=function(K){for(var S=this._struct.children,J=S.length;J--;){var V=S[J],y=V.name;y in K&&(V.isLeaf?this[y]=K[y]:this._branches[y].apply(K[y]))}},A.prototype.append=function(c){var k=this._struct.childMap;for(var J in c){var a=k[J];a&&(a.isLeaf?this[J]=c[J]:this._branches[J].append(c[J]))}},function(A,c){var I=c._attribs;return I||(c._attribs=I=J(A,c)),I}}(),Ph=function(Q){var t=this;g.defineProperties(this,{gl:{configurable:!1,enumerable:!1,value:Q,writable:!1},glState:{configurable:!1,enumerable:!1,value:$i(Q),writable:!1}}),t._currProgram=c,t._currUniforms=c,t._currAttribs=c,t._sync=!0};g.defineProperties(Ph.prototype,{program:{configurable:!1,enumerable:!1,get:function(){return this._currProgram},set:function(J){var v=this;v._sync&&J===v._currProgram||(v.gl.useProgram(J),v._currProgram=J,v._currUniforms=hh(v.gl,J),v._currAttribs=Pn(v.gl,J),v._sync=!0)}},uniforms:{configurable:!1,enumerable:!1,get:function(){var $=this;return $._currProgram&&!$._sync&&($.gl.useProgram($._currProgram),$._sync=!0),$._currUniforms},set:function(I){var F=this;F._currUniforms&&(F._currProgram&&!F._sync&&(F.gl.useProgram(F._currProgram),this._sync=!0),F._currUniforms.apply(I))}},attribs:{configurable:!1,enumerable:!1,get:function(){var i=this;return i._currProgram&&!i._sync&&(i.gl.useProgram(i._currProgram),i._sync=!0),i._currAttribs},set:function(X){var J=this;J._currUniforms&&(J._currProgram&&!J._sync&&(J.gl.useProgram(J._currProgram),this._sync=!0),J._currAttribs.apply(X))}}}),Ph.prototype.useProgram=function(b){var D=this;D._sync&&b===D._currProgram||(D.gl.useProgram(b),D._currProgram=b,D._currUniforms=hh(D.gl,b),D._currAttribs=Pn(D.gl,b),D._sync=!0)},Ph.prototype.directState=function(){return this.glState},Ph.prototype.directUniforms=function(){return this._currUniforms},Ph.prototype.directAttribs=function(){return this._currAttribs},Ph.prototype.syncLoss=function(){this._sync=!1,this.glState.syncLoss()},Ph.for=function(V){var W=V._renderState;return W||(V._renderState=W=new Ph(V)),W};var bh="directional",Nn="point",Fm="spot",Bf="light.color",Zk=4294967295,Gb={},Po=[],ap=0,sl=function(X,Z){ak(Z)&&Ch.test(Z)?zs(X,Z):jb(Z)&&Z.modelType?Rj(X,Z):Z===c?delete fb[X]:fb[X]=Z},Qq=function(W){return W},cm=function(h){h=G.convertShape3dModelName(h);var U;if(jb(h)){if(h.modelType){if(h.uuid){if(U=fb[h.uuid])return U}else h.uuid=C.Math.generateUUID();return U===c&&(Ur&&Ur[h.uuid]||Rj(h.uuid,h)),c}return h}return U=fb[h],h&&U===c&&Ch.test(h)&&(Ur&&Ur[h]||zs(h,h)),U},ql=function(g,V){g.frameStack?g.frameStack.push(V):g.frameStack=[V],g.bindFramebuffer(g.FRAMEBUFFER,V)},vr=function(z){var y=z.frameStack;if(y){if(y.pop(),y.length)return z.bindFramebuffer(z.FRAMEBUFFER,y[y.length-1]),void 0;z.frameStack=null}z.bindFramebuffer(z.FRAMEBUFFER,null)};hn(G,{graph3dViewAttributes:U,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:S/60,graph3dViewSortable:!1,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:bj,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewRotateMaxPhi:S,graph3dViewRotateMinPhi:0,graph3dViewShadowQuality:"high",graph3dViewShadowIntensity:.3,graph3dViewShadowBias:-.005,graph3dViewShadowRadius:.1,graph3dViewShadowType:"hard",graph3dViewShadowDegreeX:30,graph3dViewShadowDegreeZ:-10,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewSyncEyeWithOrthoWidth:!1,graph3dViewFovy:S/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewDataNumWarningLine:1e4,graph3dViewHeadlightRange:0,graph3dViewHeadlightGroup:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogMode:"linear",graph3dViewFogDensity:5e-4,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dViewEnvmapType:"legacy",graph3dMaxVectorCacheTime:50,graph3dEnvmapCapabilityRequire:8,setShape3dModel:sl,getShape3dModel:cm,convertShape3dModelName:Qq,getShape3dModelMap:function(){return fb},getCachedShape3dModelMap:function(){return Jm},createMatrix:function(j,$){zo(j)||(j=[j]);for(var H=j.length-1;H>=0;H--){var B=j[H];$=Ak(B.mat,B.s3,B.r3,B.rotationMode,B.t3,$)}return $},transformVec:function(X,F){return lp(X,F)},glBindFrame:ql,glUnbindFrame:vr,createBoxModel:function(){return{vs:cd,ns:wk,uv:zr,is:Tn}},createRoundRectModel:function(A,X){return vh.roundRect(A,X)},createStarModel:function(l,n){return vh.star(l,n)},createRectModel:function(j,X){return vh.rect(j,X)},createTriangleModel:function(D,z){return vh.triangle(D,z)},createRightTriangleModel:function(f,D){return vh.rightTriangle(f,D)},createParallelogramModel:function(X,S){return vh.parallelogram(X,S)},createTrapezoidModel:function(y,g){return vh.trapezoid(y,g)},createSmoothSphereModel:function(Q,D,Z,v,o,q,c){return kd(new We(Q,D,Z,v,o,q,c))},createSphereModel:function(Q,J,m,D,o,_,T){return Q?mm(Q,J,m,D,o,_,T):G.createSmoothSphereModel()},createSmoothConeModel:function(H,R,Y,I,N){return ej(H,R,Y,I,N)},createConeModel:function(_,U,f,O,b,H,u,m){return _?Fp(_,U,f,O,b,H,u,m):ej(H)},createSmoothCylinderModel:function(b,o,G,S,$,B,x,H){return kd(new To(b,o,G,S,$,B,x,H))},createCylinderModel:function(o,L,g,B,v,T,l,t){return o?Ji(o,L,g,B,v,T,l,t):lk(T,l)},createSmoothTorusModel:function(a,K,S,R,C,H){return kd(new vf(a,K,S,R,C,H))},createTorusModel:function(Q,k,d,R,T,w,K,U){return Q?Ee(Q,k,d,R,T,w,K,U):Oc(w,K)},createExtrusionModel:function(_,A,p,Q,c,U,F,T){return te(_,A,p,Q,c,U,F,T)},createSmoothRingModel:function(T,k,X,V,E,c){for(var D=[],y=0;y<T.length-1;y+=2)D.push({x:T[y],y:T[y+1]});for(T=Yp(D,k,X)[0],D=[],y=0;y<T.length;y++){var U=T[y];D.push(new bn(U.x,0,U.y))}return kd(new Kr(D,c,V,E))},createTextGeometry:function(z,J){return kd(new Tb(z,J))},loadFontFace:function(B,Y){G.xhrLoad(B,function(E){if(!E)return Y();var W;try{W=JSON.parse(E)}catch(l){W=JSON.parse(E.substring(65,E.length-2))}Ao.loadFace(W),Y&&Y(W.familyName.toLowerCase())},Y?null:{sync:!0})},getShaderErrorLog:function(){return Po.join("\n")},createRingModel:function(f,p,Q,o,e,O,M,L,E,$){for(var X=[],n=0;n<f.length-1;n+=2)X.push({x:f[n],y:f[n+1]});O=O||G.shapeSide,M=M||0,L=L||O;var T,Z,Y,A,h,k,N,v,B,W,n,I,q,P,g,D,H,R,d=[],t=[],l=E?[]:U,F=E?[]:U,w=$?[]:U,i=$?[]:U,u=o?[]:U,z=o?[]:U,m=e?[]:U,S=e?[]:U,f=Yp(X,p,Q),y=on(f),x=0,a=2*Math.PI/O;return f.forEach(function(V){if(Y=V.length,Y>1){if(A=V[0],o)for(k=A.x,v=A.y,n=M;L>n;n++)I=n+1,q=n*a,P=I*a,g=b(q),D=_(q),H=b(P),R=_(P),u.push(g*k,v,-D*k,H*k,v,-R*k,0,v,0),z.push(.5-.5*g,.5-.5*D,.5-.5*H,.5-.5*R,.5,.5);for(W=0;Y>W;W++){for(h=V[W],k=A.x,N=h.x,v=A.y,B=h.y,T=x/y,x+=Sn(A,h),Z=x/y,n=M;L>n;n++)I=n+1,q=n*a,P=I*a,g=b(q),D=_(q),H=b(P),R=_(P),d.push(g*N,B,-D*N,H*N,B,-R*N,g*k,v,-D*k,H*N,B,-R*N,H*k,v,-R*k,g*k,v,-D*k),t.push(n/O,Z,I/O,Z,n/O,T,I/O,Z,I/O,T,n/O,T),E&&n===M&&(l.push(0,v,0,0,B,0,g*N,B,-D*N,g*N,B,-D*N,g*k,v,-D*k,0,v,0),F.push(0,.5-v,0,.5-B,2*N,.5-B,2*N,.5-B,2*k,.5-v,0,.5-v)),$&&I===L&&(w.push(0,v,0,H*N,B,-R*N,0,B,0,H*N,B,-R*N,0,v,0,H*k,v,-R*k),i.push(1,.5-v,1-2*N,.5-B,1,.5-B,1-2*N,.5-B,1,.5-v,1-2*k,.5-v));A=h}if(e)for(k=A.x,v=A.y,n=M;L>n;n++)I=n+1,q=n*a,P=I*a,g=b(q),D=_(q),H=b(P),R=_(P),m.push(H*k,v,-R*k,g*k,v,-D*k,0,v,0),S.push(.5-.5*H,.5+.5*R,.5-.5*g,.5+.5*D,.5,.5)}}),{vs:d,uv:t,bottom_vs:m,bottom_uv:S,top_vs:u,top_uv:z,from_vs:l,from_uv:F,to_vs:w,to_uv:i}}},!0),hn(Y,{"3d.move.mode":c,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"3d.reflectable":!0,"shape.border.gradient.color":c,"edge.gradient.color":c,"edge.source.t3":c,"edge.target.t3":c,"light.type":Nn,"light.group":0,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":S/4,"light.range":0,"light.exponent":1,"light.intensity":1,"light.mask":Zk,"wf.visible":!1,"wf.width":1,"wf.color":Hr,"wf.short":!1,"wf.mat":c,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:c,"transparent.mask":!1,brightness:c,"select.brightness":.7,"repeat.uv.length":c,"shadow.cast":!0,"shadow.receive":!0,"3d.clipbox":c,"3d.clipbox.enabled":!0,"effect.flow":!1,"effect.flow.gradient":"spread.horizontal","effect.flow.uvshape":"rect","effect.flow.size":512,"effect.flow.group":0,"effect.flow.mask":Zk,bloom:!1,envmap:0,"envmap.probe":0,roughness:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,"texture.cache":!1,"hide.overlapping.group":c,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.type":"hard","highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","highlight.glow":.8,"highlight.strength":2,"color.empty":[0,0,0,0],"label.face":Sl,"label.t3":c,"label.r3":c,"label.texture.scale":2,"label.rotationMode":Wk,"label.light":!1,"label.blend":c,"label.reverse.flip":!1,"label.reverse.color":Od,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Sl,"label2.t3":c,"label2.r3":c,"label2.texture.scale":2,"label2.rotationMode":Wk,"label2.light":!1,"label2.blend":c,"label2.reverse.flip":!1,"label2.reverse.color":Od,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Sl,"note.t3":c,"note.r3":c,"note.texture.scale":2,"note.rotationMode":Wk,"note.light":!1,"note.blend":c,"note.reverse.flip":!1,"note.reverse.color":Od,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Sl,"note2.t3":c,"note2.r3":c,"note2.texture.scale":2,"note2.rotationMode":Wk,"note2.light":!1,"note2.blend":c,"note2.reverse.flip":!1,"note2.reverse.color":Od,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:c,"shape3d.color":Xp,"shape3d.top.color":c,"shape3d.bottom.color":c,"shape3d.from.color":c,"shape3d.to.color":c,"shape3d.image":c,"shape3d.image.projection":c,"shape3d.top.image":c,"shape3d.bottom.image":c,"shape3d.from.image":c,"shape3d.to.image":c,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":c,"shape3d.side.to":c,"shape3d.smooth":c,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":c,"shape3d.opacity":c,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Od,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":c,"shape3d.uv.scale":c,"shape3d.uv.rotation":c,"shape3d.top.uv.offset":c,"shape3d.top.uv.scale":c,"shape3d.top.uv.rotation":c,"shape3d.bottom.uv.offset":c,"shape3d.bottom.uv.scale":c,"shape3d.bottom.uv.rotation":c,"shape3d.from.uv.offset":c,"shape3d.from.uv.scale":c,"shape3d.from.uv.rotation":c,"shape3d.to.uv.offset":c,"shape3d.to.uv.scale":c,"shape3d.to.uv.rotation":c,"shape3d.top.cap":c,"shape3d.bottom.cap":c,"shape3d.start.angle":0,"shape3d.sweep.angle":t,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.blur":0,"shape3d.reflector.blur.iterations":1,"shape3d.reflector.background":null,"shape3d.reflector.clip":.003,"camera.type":"perspective","camera.aspect":1,"camera.fovy":c,"camera.ortho.width":c,"camera.near":c,"camera.far":c,"camera.background":0,"camera.renderSky":!0,"camera.renderAxis":!1,"camera.renderGrid":!1,"camera.renderEdit":!1,"camera.onlySky":!1,"texture.mipmap.max":c,"texture.filter":c,"texture.filter.min":c,"texture.filter.mag":c,"texture.wrap":c,"points.image":"rect","points.color":"white","points.transparent":!1,"points.size":20,"points.opacity":1,"points.uv.scale":[1,1],"points.uv.offset":[0,0],"points.discard.selectable":!1,"all.light":!0,"all.visible":!0,"all.color":Xp,"all.image":c,"all.blend":c,"all.opacity":c,"all.reverse.flip":!1,"all.reverse.color":Od,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":c,"all.uv.offset":c,"all.uv.scale":c,"all.uv.rotation":c,"all.discard.selectable":!0,mat:c,"left.mat":c,"right.mat":c,"top.mat":c,"bottom.mat":c,"front.mat":c,"back.mat":c,"edge.source.anchor.elevation":c,"edge.target.anchor.elevation":c},!0);var _l,us=!1,sn=[0,0,0,0],Xc=function(Y){return Y instanceof an},wm=function(V){return[V.x,V.e||0,V.y]},xd=function(X,N,l){for(var N=Ap(N||0),q=N[0],d=N[1],s=N[2];l--;)X.push(q,d,s)
},nj=function(w,q,c){for(var q=Ap(q||0),$=q[0],U=q[1],C=q[2],g=q[3];c--;)w.push($,U,C,g)},pp=function(f,W,X){if(W)for(var A,E,i,r=W[0],o=W[1],b=W[2],d=W[4],V=W[5],N=W[6],K=W[8],G=W[9],v=W[10],k=W[12],q=W[13],n=W[14],D=X.length,L=0,L=0;D>L;L+=3)A=X[L],E=X[L+1],i=X[L+2],f.push(r*A+d*E+K*i+k,o*A+V*E+G*i+q,b*A+N*E+v*i+n);else kq(f,X)},Qh=function(D,R,g){var d=R.s("light.intensity"),j=Ap(R.s(Bf)),C=j[0],U=j[1],i=j[2];1!==d&&(C*=d,U*=d,i*=d);var o=R.s("light.disabled");D.push(C,U,i,o?1:0),g.c.push(C,U,i),g.g.push(o?-1:R.s("light.group")),g.e.push(o?1:0)},vo=function(E,K){var t=Ph.for(K),N=t.directUniforms(),d=E._lastLightUploadInfo={c:[],g:[],e:[]};N.uHeadlightRange=E._headlightRange,N.uHeadlightAmbientIntensity=E._headlightAmbientIntensity;var z=E._headlightIntensity,C=Ap(E._headlightColor);1!==z&&(C=[C[0]*z,C[1]*z,C[2]*z]);var i;N.uHeadlightColor=[C[0],C[1],C[2],(i=E._headlightDisabled)?1:0],d.c.push(C[0],C[1],C[2]),d.g.push(i?-1:E._headlightGroup),d.e.push(i?1:0);var o=E._59O,$=E._spots,g=E._dirs;if(o.length){var w=[],q=[],y=[];o.forEach(function(B){Qh(w,B,d),kq(q,E._transformPointToViewSpace(B.p3())),y.push(B.s("light.range"))}),N.uPointColor=w,N.uPointRange=y,N.uPointPosition=q}if($.length){var n=[],A=[],p=[],v=[],R=[],I=[];$.forEach(function(X){Qh(n,X,d),kq(A,E._transformPointToViewSpace(X.p3())),kq(R,E._transformDirectionToViewSpace(X.p3(),X.s("light.center"))),p.push(X.s("light.range")),v.push(b(X.s("light.angle")/2)),I.push(X.s("light.exponent"))}),N.uSpotColor=n,N.uSpotRange=p,N.uSpotAngle=v,N.uSpotExponent=I,N.uSpotPosition=A,N.uSpotDirection=R}if(g.length){var f=[],h=[];g.forEach(function(k){Qh(f,k,d),kq(h,E._transformDirectionToViewSpace(k.p3()))}),N.uDirColor=f,N.uDirDirection=h}E._lastLightMask=Zk},Pf=function(z,R,f){if(f!==z._lastLightMask){z._lastLightMask=f;var X=z._lastLightUploadInfo;if(X){var L,b,k,s=X.g,y=X.e,U=s.length,t=new Array(U),Q=!1;for(b=0;U>b;b++)L=s[b],k=0>L||L>=32?1:f&1<<L?0:1,t[b]=k,k!==y[b]&&(Q=!0);if(Q){X.e=y=t;var S=X.c;R.uHeadlightColor=[S[0],S[1],S[2],y[0]];var $,O=z._59O,M=z._spots,V=z._dirs,x=3,v=1;if(U=O.length){for(b=0,$=[];U>b;b++)$.push(S[x++],S[x++],S[x++],y[v++]);R.uPointColor=$}if(U=M.length){for(b=0,$=[];U>b;b++)$.push(S[x++],S[x++],S[x++],y[v++]);R.uSpotColor=$}if(U=V.length){for(b=0,$=[];U>b;b++)$.push(S[x++],S[x++],S[x++],y[v++]);R.uDirColor=$}}}}},Io=function(D,i){return Math.max(D.getRotateMinPhi()+Rr,Math.min(D.getRotateMaxPhi()-Rr,i))},tq=function(){return.05+Al()/2},vg=function(a,i,x,s){var K,P=a.getEye();return a.isOrtho()?(K=Wc(a.getCenter(),P),K[0]+=s[0],K[1]+=s[1],K[2]+=s[2]):K=P,Kf(i,x,s,K)},Kf=function(l,p,B,A){var b=hk(l,p),c=Wc(A,B,!0),g=hk(c,p);if(k(g)<Rr)return U;var i=(b-hk(B,p))/g;return[B[0]+c[0]*i,B[1]+c[1]*i,B[2]+c[2]*i]},Qi=function(Z,O){return{x:2*Z.x-O.x,y:2*Z.y-O.y}},br=function(n,F,D,s){var t,C;if(!n)return t=dj(F.y-D.y,D.x-F.x),{x:F.x+s*_(t),y:F.y+s*b(t)};if(!D)return t=dj(n.y-F.y,F.x-n.x),{x:F.x+s*_(t),y:F.y+s*b(t)};var N=Wc([n.x,n.y,0],[F.x,F.y,0],!0),Q=Wc([D.x,D.y,0],[F.x,F.y,0],!0),p=-(N[0]+Q[0])/2,y=-(N[1]+Q[1])/2,h=j(p*p+y*y);if(Rr>h)return t=dj(n.y-F.y,F.x-n.x),{x:F.x+s*_(t),y:F.y+s*b(t)};var P=n.x-F.x,K=n.y-F.y,S=D.x-F.x,I=D.y-F.y,G=j(P*P+K*K),q=j(S*S+I*I);t=z(hk(N,Q))/2,C=N[1]*Q[0]-N[0]*Q[1]>0?-1:1,p/=h,y/=h;var r=s/_(t),g=B(G,q)/b(t);h=Math.min(r,g);var v={x:F.x+C*h*p,y:F.y+C*h*y};return D.b&&r>q/b(t)&&(v.adjust=!0),v},ec=function(U){var s=U[1],l=U[2],z=U[3],A=U[6],t=U[7],T=U[11];U[1]=U[4],U[2]=U[8],U[3]=U[12],U[4]=s,U[6]=U[9],U[7]=U[13],U[8]=l,U[9]=A,U[11]=U[14],U[12]=z,U[13]=t,U[14]=T},Bn=function(u){var H=u[0],Y=u[1],I=u[2],O=u[3],l=u[4],S=u[5],Z=u[6],$=u[7],b=u[8],k=u[9],J=u[10],X=u[11],x=u[12],q=u[13],G=u[14],K=u[15],L=H*S-Y*l,V=H*Z-I*l,E=H*$-O*l,T=Y*Z-I*S,Q=Y*$-O*S,t=I*$-O*Z,c=b*q-k*x,w=b*G-J*x,B=b*K-X*x,d=k*G-J*q,o=k*K-X*q,a=J*K-X*G,s=L*a-V*o+E*d+T*B-Q*w+t*c;return s?(s=1/s,u[0]=(S*a-Z*o+$*d)*s,u[1]=(I*o-Y*a-O*d)*s,u[2]=(q*t-G*Q+K*T)*s,u[3]=(J*Q-k*t-X*T)*s,u[4]=(Z*B-l*a-$*w)*s,u[5]=(H*a-I*B+O*w)*s,u[6]=(G*E-x*t-K*V)*s,u[7]=(b*t-J*E+X*V)*s,u[8]=(l*o-S*B+$*c)*s,u[9]=(Y*B-H*o-O*c)*s,u[10]=(x*Q-q*E+K*L)*s,u[11]=(k*E-b*Q-X*L)*s,u[12]=(S*w-l*d-Z*c)*s,u[13]=(H*d-Y*w+I*c)*s,u[14]=(q*V-x*T-G*L)*s,u[15]=(b*T-k*V+J*L)*s,void 0):U},Ic=function(a,R){if(R){var A=R[0],n=R[1],k=R[2];a[12]=a[0]*A+a[4]*n+a[8]*k+a[12],a[13]=a[1]*A+a[5]*n+a[9]*k+a[13],a[14]=a[2]*A+a[6]*n+a[10]*k+a[14],a[15]=a[3]*A+a[7]*n+a[11]*k+a[15]}},$j=function(D,b){if(b){var q=b[0],$=b[1],h=b[2];D[0]=D[0]*q,D[1]=D[1]*q,D[2]=D[2]*q,D[3]=D[3]*q,D[4]=D[4]*$,D[5]=D[5]*$,D[6]=D[6]*$,D[7]=D[7]*$,D[8]=D[8]*h,D[9]=D[9]*h,D[10]=D[10]*h,D[11]=D[11]*h}},Lo=function(l,J,$){var F=J[0],y=J[1],b=J[2],d=J[3],o=J[4],z=J[5],I=J[6],Q=J[7],K=J[8],U=J[9],e=J[10],W=J[11],k=J[12],H=J[13],M=J[14],h=J[15],T=$[0],Y=$[1],C=$[2],R=$[3];return l[0]=T*F+Y*o+C*K+R*k,l[1]=T*y+Y*z+C*U+R*H,l[2]=T*b+Y*I+C*e+R*M,l[3]=T*d+Y*Q+C*W+R*h,T=$[4],Y=$[5],C=$[6],R=$[7],l[4]=T*F+Y*o+C*K+R*k,l[5]=T*y+Y*z+C*U+R*H,l[6]=T*b+Y*I+C*e+R*M,l[7]=T*d+Y*Q+C*W+R*h,T=$[8],Y=$[9],C=$[10],R=$[11],l[8]=T*F+Y*o+C*K+R*k,l[9]=T*y+Y*z+C*U+R*H,l[10]=T*b+Y*I+C*e+R*M,l[11]=T*d+Y*Q+C*W+R*h,T=$[12],Y=$[13],C=$[14],R=$[15],l[12]=T*F+Y*o+C*K+R*k,l[13]=T*y+Y*z+C*U+R*H,l[14]=T*b+Y*I+C*e+R*M,l[15]=T*d+Y*Q+C*W+R*h,l},Co=function(A,G,U,R){var O,b,D,F,p,i,_,W,a,c,C=G[0],$=G[1],P=G[2],Z=R[0],L=R[1],q=R[2],I=U[0],m=U[1],Q=U[2];return k(C-I)<Rr&&k($-m)<Rr&&k(P-Q)<Rr?is(A):(_=C-I,W=$-m,a=P-Q,c=1/j(_*_+W*W+a*a),_*=c,W*=c,a*=c,O=L*a-q*W,b=q*_-Z*a,D=Z*W-L*_,c=j(O*O+b*b+D*D),c?(c=1/c,O*=c,b*=c,D*=c):(O=0,b=0,D=0),F=W*D-a*b,p=a*O-_*D,i=_*b-W*O,c=j(F*F+p*p+i*i),c?(c=1/c,F*=c,p*=c,i*=c):(F=0,p=0,i=0),A[0]=O,A[1]=F,A[2]=_,A[3]=0,A[4]=b,A[5]=p,A[6]=W,A[7]=0,A[8]=D,A[9]=i,A[10]=a,A[11]=0,A[12]=-(O*C+b*$+D*P),A[13]=-(F*C+p*$+i*P),A[14]=-(_*C+W*$+a*P),A[15]=1,A)},Xi=function(W,Y,L,O,t){var D=1/nm(Y/2),e=1/(O-t);return W[0]=D/L,W[1]=0,W[2]=0,W[3]=0,W[4]=0,W[5]=D,W[6]=0,W[7]=0,W[8]=0,W[9]=0,W[10]=(t+O)*e,W[11]=-1,W[12]=0,W[13]=0,W[14]=2*t*O*e,W[15]=0,W},cb=function(e,h,F,C,x,R,g){var m=1/(h-F),Q=1/(C-x),P=1/(R-g);return e[0]=-2*m,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*Q,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*P,e[11]=0,e[12]=(h+F)*m,e[13]=(x+C)*Q,e[14]=(g+R)*P,e[15]=1,e},Pq=function(w,U){var v=U[0],j=U[1],z=U[2],q=U[3],t=v*v+j*j+z*z+q*q,h=t?1/t:0;return w[0]=-v*h,w[1]=-j*h,w[2]=-z*h,w[3]=q*h,w},Xh=function(f,p){var $=p[0]+p[5]+p[10],E=0;return $>0?(E=2*Math.sqrt($+1),f[3]=.25*E,f[0]=(p[6]-p[9])/E,f[1]=(p[8]-p[2])/E,f[2]=(p[1]-p[4])/E):p[0]>p[5]&p[0]>p[10]?(E=2*Math.sqrt(1+p[0]-p[5]-p[10]),f[3]=(p[6]-p[9])/E,f[0]=.25*E,f[1]=(p[1]+p[4])/E,f[2]=(p[8]+p[2])/E):p[5]>p[10]?(E=2*Math.sqrt(1+p[5]-p[0]-p[10]),f[3]=(p[8]-p[2])/E,f[0]=(p[1]+p[4])/E,f[1]=.25*E,f[2]=(p[6]+p[9])/E):(E=2*Math.sqrt(1+p[10]-p[0]-p[5]),f[3]=(p[1]-p[4])/E,f[0]=(p[8]+p[2])/E,f[1]=(p[6]+p[9])/E,f[2]=.25*E),f},$k=function(f,_,e){var s=_[0],M=_[1],r=_[2],K=_[3],x=s+s,G=M+M,b=r+r,R=s*x,J=s*G,U=s*b,Y=M*G,V=M*b,Q=r*b,j=K*x,k=K*G,q=K*b;return f[0]=1-(Y+Q),f[1]=J+q,f[2]=U-k,f[3]=0,f[4]=J-q,f[5]=1-(R+Q),f[6]=V+j,f[7]=0,f[8]=U+k,f[9]=V-j,f[10]=1-(R+Y),f[11]=0,f[12]=e[0],f[13]=e[1],f[14]=e[2],f[15]=1,f},Jq=function(s,P){if(s.isVREnabled()){var t=s.vr.getViewMatrix(P);if(t)return t}return s._camera?s._camera.getViewMatrix(P):Co(P?P:Tj(),s._eye,s._center,s._up)},Ro=function(x,i){if(x.isVREnabled()){var Z=x.vr.getProjectMatrix();if(Z)return Z}if(x._camera)return x._camera.getProjectMatrix();if(!i&&x._computedProjectMatrix)return md(x._computedProjectMatrix);var e=x.getAspect(),Q=x._near,n=x._far,g=Tj();if(x._ortho){var r=x._orthoWidth/2,U=r/e;cb(g,-r,r,-U,U,Q,n)}else Xi(g,x._fovy,e,Q,n);return g},Cp=function(o,d){if(!o)return U;var V=0,c=1,m=2,p=[],P=0,x=o.length,l=x/3;if(d){for(;x>P;P++)p[P]=0;for(P=0;P<d.length;P+=3){var t=[],s=[],H=[];t[V]=o[3*d[P+1]+V]-o[3*d[P]+V],t[c]=o[3*d[P+1]+c]-o[3*d[P]+c],t[m]=o[3*d[P+1]+m]-o[3*d[P]+m],s[V]=o[3*d[P+2]+V]-o[3*d[P+1]+V],s[c]=o[3*d[P+2]+c]-o[3*d[P+1]+c],s[m]=o[3*d[P+2]+m]-o[3*d[P+1]+m],H[V]=t[c]*s[m]-t[m]*s[c],H[c]=t[m]*s[V]-t[V]*s[m],H[m]=t[V]*s[c]-t[c]*s[V];for(var B=0;3>B;B++)p[3*d[P+B]+V]+=H[V],p[3*d[P+B]+c]+=H[c],p[3*d[P+B]+m]+=H[m]}}else for(P=0;l>P;P+=3){var t=[],s=[],H=[];t[V]=o[3*(P+1)+V]-o[3*P+V],t[c]=o[3*(P+1)+c]-o[3*P+c],t[m]=o[3*(P+1)+m]-o[3*P+m],s[V]=o[3*(P+2)+V]-o[3*(P+1)+V],s[c]=o[3*(P+2)+c]-o[3*(P+1)+c],s[m]=o[3*(P+2)+m]-o[3*(P+1)+m],H[V]=t[c]*s[m]-t[m]*s[c],H[c]=t[m]*s[V]-t[V]*s[m],H[m]=t[V]*s[c]-t[c]*s[V];for(var B=0;3>B;B++)p[3*(P+B)+V]=H[V],p[3*(P+B)+c]=H[c],p[3*(P+B)+m]=H[m]}for(P=0;x>P;P+=3){var E=[];E[V]=p[P+V],E[c]=p[P+c],E[m]=p[P+m];var z=j(E[V]*E[V]+E[c]*E[c]+E[m]*E[m]);0===z&&(z=Rr),E[V]=E[V]/z,E[c]=E[c]/z,E[m]=E[m]/z,p[P+V]=E[V],p[P+c]=E[c],p[P+m]=E[m]}return new Ek(p)},Uf=function(Q,N,j,x){if(j||(j=Q.createTexture()),N){var J=Q.TEXTURE_2D,G=Q.REPEAT,z=Q.CLAMP_TO_EDGE,B=Q.TEXTURE_MIN_FILTER;x=x||oc;var e=x.minFilter||x.filter||Q.LINEAR,W=x.magFilter||x.filter||Q.LINEAR;Q.activeTexture(Q.TEXTURE0),Qf(Q,j),Q.texImage2D(J,0,Q.RGBA,Q.RGBA,Q.UNSIGNED_BYTE,N),Dg(Q,Q.TEXTURE_MAG_FILTER,W);var S=N.naturalWidth||N.width,l=N.naturalHeight||N.height;Up.isPOT(S)&&Up.isPOT(l)&&!x.clampToEdge&&!N.clampToEdge?(Dg(Q,Q.TEXTURE_WRAP_S,G),Dg(Q,Q.TEXTURE_WRAP_T,G),Dg(Q,B,e===Q.NEAREST?Q.NEAREST_MIPMAP_NEAREST:Q.LINEAR_MIPMAP_LINEAR),x.mipmapMaxLevel!==c&&Dg(Q,Q.TEXTURE_MAX_LEVEL,x.mipmapMaxLevel),Q.generateMipmap(J)):(Dg(Q,Q.TEXTURE_WRAP_S,z),Dg(Q,Q.TEXTURE_WRAP_T,z),Dg(Q,B,e)),Qf(Q,U)}return j},Xo=function(P,N){var R=new Uint8Array(4);return N=N||P.createTexture(),P.activeTexture(P.TEXTURE0),Qf(P,N),Dg(P,P.TEXTURE_MIN_FILTER,P.LINEAR),P.texImage2D(P.TEXTURE_2D,0,P.RGBA,1,1,0,P.RGBA,P.UNSIGNED_BYTE,R),N},_o=function(l,b){var N=new Uint8Array(4);return b=b||l.createTexture(),l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_CUBE_MAP,b),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_MAG_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_MIN_FILTER,l.LINEAR),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,N),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,N),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,N),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,N),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,N),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,N),b},Wf=function(H){H._26I&&H._prg&&(H._26I.deleteProgram(H._prg),H._prg=U)},em=function(q,s,J,g){var b=q.createShader(J);return q.shaderSource(b,g),q.compileShader(b),q.attachShader(s,b),b},fs=function(s){return s.createBuffer()},Qf=function(W,O){W.bindTexture(W.TEXTURE_2D,O||W._emptyTexture)},Dg=function(O,a,N){O.texParameteri(O.TEXTURE_2D,a,N)},Yi=function(a,Q){var D=Ph.for(a).directState();D.polygonOffset.enabled=!0,D.polygonOffset.value=Q},Xl=function(Z){var x=Ph.for(Z).directState();x.polygonOffset.enabled=!1},fo=function(U,T){if(T){var f=Ph.for(U).directState();f.color.clear=Ap(T)}},Fg=function(O){var o=Ph.for(O),E=o.directUniforms(),G=o.directAttribs();E.uFix=!0,G.aNormal=!1},lf=function(e){var x=Ph.for(e),G=x.directUniforms();x.directAttribs(),G.uFix=!1},aq=function(c,i,D,n,x,Z,u,w){var f=Ph.for(c),F=f.directState(),y=f.directUniforms();c._picking||(D?(y.uBlend=!0,y.uBlendColor=D):y.uBlend=!1,y.uLight=n==U?!0:n,Bk(x)&&1!==x&&(y.uPartOpacity=x),y.uReverseFlip=Z==U?!1:Z,y.uFixPickReverseColor=u||Od),F.cullFace.enabled=w?!0:!1},_p=function(n){if(!n._picking){var S=Ph.for(n),b=S.directUniforms();b.uPartOpacity=1}},Rb=function(){var E=new C.Math.Matrix2d,k=[1,0,0,0,1,0,0,0,0];return function(o,X,R,d,x,Z,N,r,H,D){var l=Ph.for(o),_=l.directUniforms(),B=l.directAttribs();return R?(_.uTexture=!0,_.uDiscardSelectable=Nj(d)?d:!0,B.aUv=og(o,x,Z,U,2),D?(_.uBlendTexture=!0,_.uBlendSampler=D):(_.uBlendTexture=!1,_.uBlendSampler=o._emptyBlendTexture),_.uSampler=R,_.uUvMatrix=N||r||H?Km(H,N,r,E).toArray9():k,void 0):(_.uSampler=o._emptyTexture,_.uBlendSampler=o._emptyBlendTexture,void 0)}}(),vs=function(T,H,e){var V=Ph.for(T),E=V.directUniforms(),L=V.directAttribs();T.activeTexture(T.TEXTURE0),Qf(T,U),T.activeTexture(T.TEXTURE1),Qf(T,U),e&&(L.aUv=!1,E.uTexture=!1,E.uSampler=T._emptyTexture,E.uBlendTexture=!1,E.uBlendSampler=T._emptyBlendTexture)},ic=function(E,N,x,g,B,W){var G=Ph.for(E),F=G.directUniforms(),X=G.directAttribs();!x||ze||dq||E.lineWidth(x),g&&!E._picking&&(F.uFixPickReverseColor=g),B&&(X.aPosition=og(E,B,W,U))},Kg=function(A,t,k,p){_l&&(p=A[_l]),A.drawArrays(p==U?A.TRIANGLES:p,t,k);var D=A._renderInfo;D&&(D.calls++,D.vertices+=k,(p==U||p===A.TRIANGLES)&&(D.faces+=k/3),p===A.LINES&&(D.lines+=k/2),p===A.POINTS&&(D.points+=k))},Ke=function(X,j,w,B,z){_l&&(B=X[_l]),X.drawElements(B==U?X.TRIANGLES:B,w,z==U?X.UNSIGNED_SHORT:z,j==U?0:2*j);var G=X._renderInfo;G&&(G.calls++,G.vertices+=w,(B==U||B===X.TRIANGLES)&&(G.faces+=w/3),B===X.LINES&&(G.lines+=w/2),B===X.POINTS&&(G.points+=w))},Dp=function(_,Y,j){var W=_.ARRAY_BUFFER;return _.bindBuffer(W,Y),j&&_.bufferData(W,j,_.STATIC_DRAW),Y},og=function(A,U,R,k,K){return R?$b(A,A.ARRAY_BUFFER,U,R):Dp(A,U,R,k,K)},Rn=function(A,$,r){var W=A.ELEMENT_ARRAY_BUFFER;A.bindBuffer(W,$),r&&A.bufferData(W,r,A.STATIC_DRAW)},yn=function(Y,s,J){$b(Y,Y.ELEMENT_ARRAY_BUFFER,s,J)},$b=function(N,F,d,t){var f=t._bufId;f||(f=t._bufId=C.Math.generateIncreasingID());var d,r=N._bufPool;return(d=r[f])&&d._buf?N.bindBuffer(F,d._buf):(d=r[f]={_buf:fs(N)},N.bindBuffer(F,d._buf),N.bufferData(F,t,N.STATIC_DRAW)),d._fid=N._renderInfo.frame,d._buf},gj=function(C,M){M!=U&&M>=0&&C.enableVertexAttribArray(M)},Do=function(x,D){D!=U&&D>=0&&x.disableVertexAttribArray(D)},Vg=function(p,b){var l=p.getGL(),O=Ph.for(l),i=O.directUniforms();p._7O=p._8O.pop(),b&&(i.uMVMatrix=p._7O,p._6O=b,i.uNMatrix=b)},Le=function(t,z){return z||(z=Tj()),bd(z,t),Bn(z),ec(z),z},Mg=function(d,s){var B=d.getGL(),F=d._7O,W=Ph.for(B),t=W.directUniforms();s?(d._8O.push(md(F)),t.uMMatrix=s,Lo(F,F,s),d._7O=F):t.uMMatrix=Zf,t.uMVMatrix=F,t.uNMatrix=Le(F,d._6O)},Vb={body:0,label:1,label2:2,note:3,note2:4,symbol:5},Se=10,km=function(V,z,x,Y,P,n){var S;if(x){var d=Y._pickId;d||(d=Y._pickId=z._pickIdUsed,z._pickIdUsed+=Se);var U,g=Vb[P];if(null!=g)U=d+g;else{var X=Y._pickExtraPartMap;X||(X=Y._pickExtraPartMap={}),(U=X[P])||(U=X[P]=z._pickIdUsed++)}z[U]||(z[U]={data:Y,part:P}),S=se(U)}else S=sn;if(!n){var M=Ph.for(V),h=M.directUniforms();h.uFixPickReverseColor=S}return S},mg=km,Md=function(C,l,h){"target"!==h&&(h="source");var s="target"===h?l.getTargetAgent():l.getSourceAgent(),y="edge."+h+".";if(Je(s)){var r=l.s(y+"anchor.x"),q=l.s(y+"anchor.elevation"),u=l.s(y+"anchor.y"),P=Jl(s,C.getMat(s)),V=s.getAnchor3d();return lp([(r===c?.5:r)-V.x,(q===c?.5:q)-V.y,(u===c?.5:u)-V.z],P)}var B=l.s(y+"index"),x=C.getData3dUI(s);if(!x.info||!x.info.list)return!1;if(B>=0){var d,e,K,k,n,Y=x.info._lastPointsSegments,H=Y.points,M=Y.segments,g=-1,I=-1;for(K=0,k=M?M.length:H.length;k>K;K++){if(e=M?M.get(K):1,3===e)n=2;else if(4===e)n=3;else{if(5===e)continue;n=1}if(g+=n,I++,I===B){d=H.get(g);break}}return d||(d=H.get(H.length-1)),[d.x,d.e||0,d.y]}var R=l.s(y+"percent")||.5;if(R=Math.max(0,Math.min(R,1)),!x||!x.getCache)return!1;var z=x.getCache(),k=z[z.length-1].length,Y=C.getLineOffset(s,R*k),A=Y.point;return[A.x,A.y,A.z]},Om=function(){var C={center:function(z,G,d,b,J){var j=-G[1]/2,Y={x:-G[0]/2,y:j,width:G[0],height:G[1]},H=Ml(z,Y,d);return[H.x+b,-H.y-J,tq()]},front:function(V,r,Q,q,u){var n=-r[1]/2,v={x:-r[0]/2,y:n,width:r[0],height:r[1]},K=Ml(V,v,Q);return[K.x+q,-K.y-u,r[2]/2+tq()]},back:function(a,b,u,E,B){var q=-b[0]/2,z=-b[1]/2,F={x:q,y:z,width:b[0],height:b[1]},_=Ml(a,F,u);return[-_.x-E,-_.y-B,-b[2]/2-tq()]},left:function(d,S,D,E,L){var K=-S[1]/2,h={x:-S[2]/2,y:K,width:S[2],height:S[1]},c=Ml(d,h,D);return[-S[0]/2-tq(),-c.y-L,c.x+E]},right:function(k,n,h,r,R){var B=-n[2]/2,Q=-n[1]/2,H={x:B,y:Q,width:n[2],height:n[1]},N=Ml(k,H,h);return[n[0]/2+tq(),-N.y-R,-N.x-r]},top:function(p,y,t,q,U){var M={x:-y[0]/2,y:-y[2]/2,width:y[0],height:y[2]},P=Ml(p,M,t);return[P.x+q,y[1]/2+tq(),P.y+U]},bottom:function(J,n,f,R,A){var e=-n[2]/2,v={x:-n[0]/2,y:e,width:n[0],height:n[2]},E=Ml(J,v,f);return[E.x+R,-n[1]/2-tq(),-E.y-A]}};return function(W,I,d,o,y,r){return C[o](W,I,d,y||0,r||0)}}(),mi=function(x,E,R,e,f,m,n,q,v,p){if(f&&(E[0]+=f[0],E[1]+=f[1],E[2]+=f[2]),Ic(x,R),q){var C=Tj();if(rb(C,v,p),lp(E,C),Ic(x,E),x.auto=q,x.pos=lp([0,0,0],x),m){var L=x.mat2=Tj();rb(L,m,n)}}else rb(x,v,p),Ic(x,E),e===Ld?Tk(x,-Cg):e===fk?Tk(x,Cg):e===vc?Oo(x,-Cg):e===Ol?Oo(x,Cg):e===Em&&Tk(x,S),rb(x,m,n);return x},jo=function(p,i){var $=i.auto,O=i.mat2,C=p.gv;if($){var k,v=Tj(),t=[0,0,0,0];k="string"==typeof $?[$.indexOf("x")<0?C._eye[0]:C._center[0],$.indexOf("y")<0?C._eye[1]:C._center[1],$.indexOf("z")<0?C._eye[2]:C._center[2]]:C._eye,Xh(t,Co(Tj(),k,C._center,C._up)),$k(v,Pq(t,t),i.pos),O&&Lo(v,v,O),Mg(C,v)}else Mg(C,i)},cc=function(s,D,S,N,a){var G=s.s,z=s.gv,i=z.getGL(),L=z._prg,M=z._buffer,v=z._1O,I=Ph.for(i),w=I.directAttribs();Uf(i,mj,v),jo(s,S),aq(i,L,G(D+".blend"),G(D+".light"),G(D+".opacity"),G(D+".reverse.flip"),G(D+".reverse.color"),G(D+".reverse.cull")),Rb(i,L,v,a,M.uv,Zr),w.aPosition=og(i,M.vs,N,U),w.aNormal=og(i,M.ns,nl,U),yn(i,M.is,jk),Ke(i,0,jk.length),vs(i,L,v),_p(i,L),Vg(z)},Ej=function(Q,x,p){var N=Q.gv,O=Q.data,F=Q[x]={blend:N.getBodyColor(O)||N.getFaceBlend(O,x),light:N.getFaceLight(O,x),color:N.getFaceColor(O,x),opacity:N.getFaceOpacity(O,x),transparent:N.getFaceTransparent(O,x),reverseFlip:N.getFaceReverseFlip(O,x),reverseColor:N.getFaceReverseColor(O,x),reverseCull:N.getFaceReverseCull(O,x),texture:N.getFaceImage(O,x),blendTexture:N.getFaceBlendImage(O,x),discardSelectable:N.getFaceDiscardSelectable(O,x)};if("csg"!==x){F.uv=N.getFaceUv(O,x)||p&&p[x+"Uv"],F.uvScale=N.getFaceUvScale(O,x)||p&&p[x+"UvScale"],F.uvOffset=N.getFaceUvOffset(O,x)||p&&p[x+"UvOffset"],F.uvRotation=N.getFaceUvRotation(O,x)||p&&p[x+"uvRotation"];var z=N.getFaceMat(O,x);if(z){var Y=Jl(O,z);O.appendAnchorMatrix3d(Y),F.mat=Y}}return F},ng=function($,M,O,L,i){var h=$[L];if(h){if(!i(h.transparent))return;var b=$.data,F=$.gv,S=F._buffer,m=F.getTexture(h.texture,b,L),p=F.getTexture(h.blendTexture,b),x=Ph.for(M),l=x.directUniforms(),t=x.directAttribs();Rb(M,O,m,h.discardSelectable,S.uv,h.tuv,h.uvOffset,h.uvScale,h.uvRotation,p),aq(M,O,h.blend,h.light,h.opacity,h.reverseFlip,h.reverseColor,h.reverseCull),h.cs&&!F._batchColorDisabled?(l.uBatchColor=!0,t.aBatchColor=og(M,S.batchColor,h.cs,O.aBatchColor,4)):l.uDiffuse=h.color||Y["color.empty"],t.aPosition=og(M,S.vs,h.vs,U),t.aNormal=og(M,S.ns,h.ns,U),Kg(M,0,h.vs.length/3),h.cs&&!F._batchColorDisabled&&(l.uBatchColor=!1,Do(M,O.aBatchColor)),_p(M,O),vs(M,O,m)}},Lm=function(C,d,x){zo(C)?C.forEach(function(s){Lm(s,d,x)}):ak(C)?Lm(Bq(d,C),d,x):jb(C)?C.shape3d?Lm(C.shape3d,d,x):x.push(C):x.push(C)},xg=function(){for(var V=50,a=arguments.length,y=[],$=0;a>$;$++)y[$]=arguments[$];Po[ap]="Time : "+(new Date).toLocaleString()+", Info :"+y.join(", "),ap=(ap+1)%V,console.error("Failed to create shader.")},Km=function(){var L=new Up.Matrix2d;return function(o,C,a,j){j||(j=L);var R,D,z,v;return C?(R=C[0],D=C[1]):R=D=0,a?(z=a[0],v=a[1]):z=v=1,j.setFromTransform(o||0,R,D,z,v)}}(),rg=function(e,P,S,V,Q,z){var a,m,h,u,y,s,C,c,r,k,f,M=[V-P,Q-S],p=e?e.length:0;for(h=0;p>h;h++){for(u=2,a=e[h],y=a[0],s=a[1];u+1<a.length;){if(C=a[u],c=a[u+1],m=ik(P,S,V,Q,y,s,C,c,!0)){r=[C-y,c-s],k=Sn(r),r[0]/=k,r[1]/=k,k=hk(M,r),k=k>0?z:-z,f=[r[0]*k,r[1]*k];break}y=C,s=c,u+=2}if(f)break}if(f)for(V=P+f[0],Q=S+f[1],h=0;p>h;h++)for(u=2,a=e[h],y=a[0],s=a[1];u+1<a.length;){if(C=a[u],c=a[u+1],m=ik(P,S,V,Q,y,s,C,c,!0))return[0,0];y=C,s=c,u+=2}return f?f:[V-P,Q-S]},Bi=function(s){return"nearest"===s?Gp.NEAREST:"linear"===s?Gp.LINEAR:s},Vf=C.graph3d={WebGLConstants:Gp},Sc=function(c,M,x){Bb(s+".graph3d."+c,M,x)},hg="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<6/1!,!*{/mbdpMwVxpmg!,!z/mbdpMwVxpmg!-y/mbdpMwVxpmg)3dfw!>!^j]wVxpmg<{zy/**1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!^j]yjsubNxpmg)!>!mbdpMwVxpmg|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1>j!uoj)spg<mbdpMwVxpmg!4dfw1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!<*1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!QBNXPEBIT`FTV!gfegj$!!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw!gjeof$!~!1!>>!SFQQJMD`YPC`YBN!gj$!<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!gjeof$!|*ldjQva!%%!yjGva)gj!1!>>!SFQQJMD`YPC`YBN!gj$!<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw<^UDFKCP`XPMG`YBN]yjsubNxpmg!5ubn!nspgjov1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!<esppDxpebit!5dfw!hojzsbw<yjsubNxpebit!5ubn!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<yjsubNwVv!4ubn!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",be="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVw!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ!gjeof$!<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg!ftmf$!<*iuqfe!+!iuqfe!+!zujtofEhpGv!+!zujtofEhpGv!.)qyf!.!1/2!>!spudbGhpg!ubpmg!3QYF`HPG!gfegj$!<{/yfusfWw.!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~<chs/*^j]wVxpmg!-^j]fsvuyfUxpmg)E3fsvuyfu!!>,!chs/eJ!****1/1)3dfw!-^j]wVxpmg)obiUsfubfsh)mmb!%%!***1/2)3dfw!-^j]wVxpmg)obiUttfm)mmb!%%!^j]efmcboFxpmg)!gj|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1>j!uoj)spg!1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ!gjeof$!<*spmpDwof)sbfojMpUmfyfUqbNwof!>!spmpDwof<**{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv)fcvDfsvuyfu!>!spmpDwof!5dfw!ftmf$!<**ttfoihvps!-*{z/dfWudfmgfs!-y/dfWudfmgfs.)4dfw!-qbNwoFv)WVfcvDfsvuyfu)CHStpUsbfojM!>!spmpDwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!<*mbnspOemspx!-yfusfWpUbsfnbd)udfmgfs!>!dfWudfmgfs!4dfw<*yjsubNxfjWv!-O)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*opjujtpQbsfnbDv!.!emspXw)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!gjeof$!~<fvmbWxpebit!+!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm!~!!<osvufs!<esbdtje!!|!*1/1!>>!fvmbWxpebit!%%!mmvDxpebit)!gj<*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit)xpebiTufh!.!1/2!>!fvmbWxpebit!ubpmg|!*fwjfdfSxpebit)!gj!QBNXPEBIT`FTV!gfegj$!~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*fdobutjEitbEv!?!*fdobutjEqbHitbEv!-fdobutjEfojMw)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj!gjeof$!~~~!<osvufs!<esbdtje!|!****ojNqjmd!-mbdpMw)obiUsfubfsh)mmb!%%!**ybNqjmd!-mbdpMw)obiUttfm)mmb)!>a!^j]sfooJqjmDsfqqjmDv)!gj<**1/2!-emspXw)5dfw!+!^j]yjsubNsfqqjmDv)4dfw!>!mbdpMw|!*,,j!<SFQQJMD`YPC`YBN!=!j!<1>j!uoj)spg<mbdpMw!4dfw|!*qjmDypCfmcboFv)!gj!1!?!SFQQJMD`YPC`YBN!gj$!~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~!<osvufs!<*1/2!-1/1!-1/1!-1/1)5dfw!>!spmpDhbsG`mh!|!*uvpldbmc)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw<uvpldbmc!mppc!nspgjov!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw<^UDFKCP`XPMG`YBN]efmcboFxpmg!mppc!nspgjov<^UDFKCP`XPMG`YBN]fsvuyfUxpmg!E3sfmqnbt!nspgjov!1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!!gjeof$!!~~<*1/2!-*Gqjn!-2spmpd!-1spmpd)yjn)5dfw!osvufs<*1/2!,!uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!2spmpd!4dfw|!ftmf!~<*1/2!-1spmpd)5dfw!osvufs|!*1/1!>>!Gqjn)!gj<*uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!1spmpd!4dfw<*qjn)sppmg!>!uoJqjn!ubpmg<*qjn)udbsg!>!Gqjn!ubpmg<*mfwfMqjNybn`WVfcvd!-1n!-*ttfoihvps)qjNpUttfoihvps)qnbmd!>!qjn!ubpmg|!*ttfoihvps!ubpmg!-sjEfmqnbt!4dfw!-qbNwof!E3sfmqnbt)WVfcvDfsvuyfu!5dfw!~<qjn!osvufs~<*ttfoihvps!+!72/2)3hpm!+!1/3!.!>!qjn|!ftmf!~<6n!,!*7s!.!6s)!0!*6n!.!7n)!+!*ttfoihvps!.!6s)!>!qjn|!*7s!>?!ttfoihvps)!gj!ftmf!~<5n!,!*6s!.!5s)!0!*5n!.!6n)!+!*ttfoihvps!.!5s)!>!qjn|!*6s!>?!ttfoihvps)!gj!ftmf!~<2n!,!*5s!.!2s)!0!*2n!.!5n)!+!*ttfoihvps!.!2s)!>!qjn|!*5s!>?!ttfoihvps)!gj!ftmf!~<1n!,!*2s!.!1s)!0!*1n!.!2n)!+!*ttfoihvps!.!1s)!>!qjn|!*2s!>?!ttfoihvps)!gj<1/1!>!qjn!ubpmg|!*ttfoihvps!ubpmg)qjNpUttfoihvps!ubpmg!1/5!7n!fojgfe$!9411/1!7w!fojgfe$!23/1!7s!fojgfe$!1/4!6n!fojgfe$!721/1!6w!fojgfe$!614/1!6s!fojgfe$!1/3!5n!fojgfe$!751/1!5w!fojgfe$!5/1!5s!fojgfe$!1/2!.!2n!fojgfe$!783/1!2w!fojgfe$!9/1!2s!fojgfe$!1/3!.!1n!fojgfe$!:44/1!1w!fojgfe$!1/2!1s!fojgfe$!~<*z/g!-nc!-nu)yjn!osvufs<*y/g!-sc!-mc)yjn!>!nc!4dfw<*y/g!-su!-mu)yjn!>!nu!4dfw<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mc!4dfw<f{jTmfyfu!>.!y/wv<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!sc!4dfw<f{jTmfyfu!>,!z/wv<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!su!4dfw<f{jTmfyfu!>,!y/wv<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mu!4dfw<f{jTmfyfu!>+!wv<*f{jTfdbg!+!1/3!.!f{jTfmjUybn`WVfcvd!-1/1)ybn!+!1/4!>,!y/wv<f{jTfmjUojn`WVfcvd!+!1/3!+!uoJsfumjg!>,!z/wv~<f{jTfmjUybn`WVfcvd!+!1/3!>,!z/wv|!*mfwfMqjNybn`WVfcvd!=!uoJqjn)!gj<f{jTfdbg!+!fdbg!>,!y/wv~<1/4!>.!fdbg<f{jTfdbg!>,!z/wv|!*1/3!?!fdbg)!gj<g!.!6/1!>,!wv<*wv)udbsg!>!g!3dfw<*1/2!.!f{jTfdbg)!+!*fdbg!-opjudfsje)WVufh!>!wv!3dfw<*f{jTfmjUybn`WVfcvd!+!1/4)!0!1/2!>!f{jTmfyfu!ubpmg<*uoJqjn)3qyf!>!f{jTfdbg!ubpmg<*mfwfMqjNojn`WVfcvd!-uoJqjn)ybn!>!uoJqjn<*1/1!-uoJqjn!.!mfwfMqjNojn`WVfcvd)ybn!>!uoJsfumjg!ubpmg<*opjudfsje)fdbGufh!>!fdbg!ubpmg|!*uoJqjn!ubpmg!-opjudfsje!4dfw!-qbNwof!E3sfmqnbt)WVfcvDsbfojmjc!4dfw!~<*1/2!,!wv)!+!6/1!osvufs~<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje)3dfw!>!wv|!ftmf!~<*z/opjudfsje)tcb!0!*{/opjudfsje!-y/opjudfsje!.)3dfw!>!wv|!*1/5!>>!fdbg)!gj!ftmf!~<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje!.)3dfw!>!wv|!*1/4!>>!fdbg)!gj!ftmf!~<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje!.)3dfw!>!wv|!*1/3!>>!fdbg)!gj!ftmf!~<*z/opjudfsje)tcb!0!*{/opjudfsje!.!-y/opjudfsje!.)3dfw!>!wv|!*1/2!>>!fdbg)!gj!ftmf!~<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje)3dfw!>!wv|!*1/1!>>!fdbg)!gj<wv!3dfw|!*fdbg!ubpmg!-opjudfsje!4dfw)WVufh!3dfw!~<fdbg!osvufs~<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/6!;!1/3!@!1/1!?!{/opjudfsje!>!fdbg!*z/opjudfsjEtcb!?!{/opjudfsjEtcb)!gj|!ftmf!~<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/4!;!1/1!@!1/1!?!y/opjudfsje!>!fdbg*z/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj|!*{/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj<1/2!.!>!fdbg!ubpmg<*opjudfsje)tcb!>!opjudfsjEtcb!4dfw|!*opjudfsje!4dfw)fdbGufh!ubpmg!1/72!f{jTfmjUojn`WVfcvd!fojgfe$!1/763!f{jTfmjUybn`WVfcvd!fojgfe$!1/5!mfwfMqjNojn`WVfcvd!fojgfe$!1/9!mfwfMqjNybn`WVfcvd!fojgfe$!WV`FCVD`FQZU`QBNWOF!gfegj$!~<*{zy/*yjsubn!+!*1/1!-sje)5dfw))f{jmbnspo!osvufs|!*yjsubn!5ubn!oj!-sje!4dfw!oj)opjudfsjEnspgtobsUftsfwoj!4dfw!gjeof$!~!<*x/fvmbw!-**SPUDBG`BNNBH)4dfw!-{zy/fvmbw)xpq)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!ftmf$!~<*!b/fvmbw!-*!*!*!*!9142411/1!)4dfw!-chs/fvmbw!)mbvrFobiUttfm!)4dfw!-3:/32!+!chs/fvmbw!-*!661/1!)4dfw!.!661/2!+!*!*!77725/1!)4dfw!-chs/fvmbw!)xpq!)yjn!)5dfw!osvufs!|!*!fvmbw!5dfw!oj!)CHStpUsbfojM!5dfw~!<*b/fvmbw!-****65151/1)4dfw!-chs/fvmbw)mbvrFobiUttfm)4dfw!-9194::4881/1!+!chs/fvmbw!-**5/3)4dfw!-*5218342361/1)4dfw!,!79:387985:/1!+!chs/fvmbw)xpq)yjn)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!QBNWOF`FTV!gfegj$!!gjeof$!~!!!!!!!!gjeof$!!!!!!!!!!!!<*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!osvufs!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*1/:!0!1/2)!+!*!!!!!!!!!!!!!!!*qe!-*z/f{jTmfyfu!-yyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-yyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-yzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-yzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!osvufs!!!!!!!!!!!!!!!!<z/f{jTmfyfu!+!tvjebSxpebit!+!*2!-2!.)3dfw!>!uftggp!3dfw!!!!!!!!!!!!!!!!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!}}!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!!!!!!!!!!!!<*opjujtpQpUuihjm)f{jmbnspo!>!E4ec!4dfw!!!!!!!!!!!!<tbjCxpebit!>,!qe!!!!!!!!<*sbfObsfnbDxpebit!.!sbGbsfnbDxpebit)!0!*sbfObsfnbDxpebit!.!*opjujtpQpUuihjm)iuhofm)!>!qe!ubpmg!!!!!!!!!!!!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!!!!!!!!!!!!<**1/3!-1/5)3dfw!+!f{jTqbNxpebit)!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!|!*sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTuojpQufh!ubpmg!!!!!!!!~!!!!!!!!<*68/1!-684/1)3dfw!,!sbobmq!+!*63/1!-632/1)3dfw!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!!!!!!!!!!!!!!!!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*z/w)ohjt!>!Zohjt!ubpmg!!!!!!!!!!!!!!!!|!*foPutpnmb!>?!z/Wtcb)!gj!ftmf!~!!!!!!!!!!!!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*y/w)ohjt!>!Yohjt!ubpmg!!!!!!!!!!!!!!!!|!*foPutpnmb!>?!y/Wtcb)!gj!ftmf!~!!!!!!!!!!!!<y/w!.!1/5!>!y/sbobmq!!!!!!!!!!!!!!!!!!!!*1/1!?!{/w)!gj!!!!!!!!!!!!!!!!|!*foPutpnmb!>?!{/Wtcb)!gj!!!!!!!!!!!!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!!!!!!!!!!!!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!!!!!!!!!!!!<zy/w!>!sbobmq!3dfw!!!!!!!!!!!!<*Zf{jTmfyfu!+!1/3!.!1/2)!+!fcvDpUfmbdt!>+!w!!!!!!!!!!!!<fcvDpUfmbdt!>+!Wtcb!!!!!!!!!!!!<**{/Wtcb!-z/Wtcb)ybn!-y/Wtcb)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!!!!!!!!!!!!<*w)tcb!>!Wtcb!4dfw!!!!!!!!!!!!|!*Zf{jTmfyfu!ubpmg!-w!4dfw)WVpUfcvd!3dfw!!!!!!!!~!!!!!!!!<xpebit!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!gjeof$!!!!!!!!!!!!<*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!>!xpebit!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*1/:!0!1/2)!+!*!!!!!!!!!!!!!!!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!gjmf$!!!!!!!!!!!!<*1/:!0!1/2)!+!*!!!!!!!!!!!!!!!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!!!!!!!!!!!!|!*utfUnvutvsg)!gj!!!!!!!!!!!!<*dfWutfUnvutvsg)mmb!>!utfUnvutvsg!mppc!!!!!!!!!!!!<*1/2!>=!{/esppDxpebit!-nvutvsGoj)3dfwc!>!dfWutfUnvutvsg!3dfwc!!!!!!!!!!!!<*dfWnvutvsGoj)mmb!>!nvutvsGoj!mppc!!!!!!!!!!!!<*1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit)!5dfwc!>!dfWnvutvsGoj!5dfwc!!!!!!!!!!!!<tbjCxpebit!>,!{/esppDxpebit!!!!!!!!!!!!<x/esppDxpebit!>0!{zy/esppDxpebit!!!!!!!!!!!!<1/2!>!xpebit!ubpmg!!!!!!!!!!!!|!*esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTufh!ubpmg!!!!!!!!~!!!!!!!!<d!osvufs!!!!!!!!!!!!<*y/g!-c!-b)yjn!>!d!ubpmg!!!!!!!!!!!!<*z/g!-us!-cs)yjn!>!c!ubpmg!!!!!!!!!!!!<*z/g!-um!-cm)yjn!>!b!ubpmg!!!!!!!!!!!!<*6/1!,!f{jt!+!wv)udbsg!>!g!3dfw!!!!!!!!!!!!<*fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!us!ubpmg!!!!!!!!!!!!<*fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cs!ubpmg!!!!!!!!!!!!<*fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!um!ubpmg!!!!!!!!!!!!<*fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cm!ubpmg!!!!!!!!!!!!<f{jt!0!*6/1!,!f{jt!+!wv)sppmg!>!WVejpsuofd!3dfw!!!!!!!!!!!!<f{jt!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!<*1/2!-1/1)3dfw!>!uftggp!3dfw!utopd!!!!!!!!!!!!|!*fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt)qsfMxpebiTE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<***wv!-tiuqfe)E3fsvuyfu)iuqfEpUBCHSldbqov!-fsbqnpd)qfut!osvufs!!!!!!!!!!!!|!*fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt)fsbqnpDE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*tspudbGldbqoV!-w)upe!osvufs|!*w!5dfw!oj!utopd)iuqfEpUBCHSldbqov!ubpmg!!!!!!!!<*/2!-tspudbGldbQ)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!!!!!!!!<*/763!!-/763!+!/763!-/763!+!/763!+!/763)4dfw!>!tspudbGldbQ!4dfw!utopd!!!!!!!!<*2!hojevmdyf)!opjudbsg!?.!2//1!00!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!!!!!!!!<*2!hojevmdoj)!2//1!?.!opjudbsg!00!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!!!!!!!!<esppDxpebit!5dfw!hojzsbw<fwjfdfSxpebit!mppc!nspgjov<tvjebSxpebit!ubpmg!nspgjov<tbjCxpebit!ubpmg!nspgjov<zujtofuoJxpebit!ubpmg!nspgjov<f{jTxpebit!3dfw!nspgjov<qbNxpebit!E3sfmqnbt!nspgjov<mmvDxpebit!mppc!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov!ftmf$!<zujtofEhpGv!ubpmg!nspgjov!3QYF`HPG!gfegj$!<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<*6/1!-6/1!-6/1)4dfw!>!ybNqjmd!4dfw!utopd<*6/1.!-6/1.!-6/1.)4dfw!>!ojNqjmd!4dfw!utopd<^SFQQJMD`YPC`YBN]yjsubNsfqqjmDv!5ubn!nspgjov<^SFQQJMD`YPC`YBN]sfooJqjmDsfqqjmDv!mppc!nspgjov<qjmDypCfmcboFv!mppc!nspgjov!1!?!SFQQJMD`YPC`YBN!gj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!!gjeof$!<qbNwoFv!fcvDsfmqnbt!nspgjov!ftmf$!<ttfoihvps!ubpmg!nspgjov<qbNwoFv!E3sfmqnbt!nspgjov!WV`FCVD`FQZU`QBNWOF!gfegj$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";
hn(G,{setBatchInfo:function(G,q){Be[G]=q},getBatchInfo:function($){return Be[$]},getBatchInfoMap:function(){return Be},setBatchInfoMap:function(E){Be=E}},!0);var sq=[1,1,1],ih=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Og=[1,0,0,0,0,1,0,1,1,1,1,0],Jg=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],no=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],kr=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Br=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Pi=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Yq=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Ub=function(D,u){var A=D._40Q;A.each(function(S){S.ivBatch(u)})},Mf=function(U,t,o){var I=o._id,n=t[I];if(n){var x=n.batch,j=U[x],e=j.ds,a=n.index;if(j.invalidate=!0,delete t[I],e.splice(a,1),$d(e))return delete U[x],void 0;for(var T=n.begin,q=n.size,Y=3*T,N=3*q,v=4*T,i=4*q,A=j.vs,H=j.ps,_=j.uv,B=j.cs,W=j.bs,E=j.rs,J=j.ns,$=j.ls;a<e.length;a++)n=t[e[a]._id],n.index--,n.begin-=q;A.splice(Y,N),H.splice(v,i),_&&_.splice(2*T,2*q),B&&B.splice(v,i),W&&W.splice(Y,N),E&&E.splice(T,q),J&&J.splice(Y,N),$&&$.splice(T,q)}},dc=function(R,z,x,o,n){if(!o)return U;var M=z[o];if(!M){var T=n.getBatchInfo(o)||oc,K=T.image?[]:U;M=z[o]={vs:[],ns:[],uv:K,cs:K?U:T.color?U:[],bs:T.blend?[]:U,ps:[],rs:T.brightness?[]:U,ds:[]}}return M.invalidate=!0,R[x._id]={index:M.ds.length,begin:M.vs.length/3,batch:o},M.ds.push(x),M},oe=function(a,O){return O!=U&&1!==O?[a[0]*O,a[1]*O,a[2]*O,a[3]]:a},yg=function(q){var D=q.shapeModel;D||(D=Bq(q)),D&&(D._ctlineModel=[],D._lineModel=c)},Qo=function(){var q;return function(Y,I,M){var m=Y.getData3dUI(I),L=m.shapeModel;if(L||(L=Bq(m)),L||!m.shapeName){var d,k=I.s("wf.combineTriangle");if(M.geometry){if(!L&&(I instanceof C.Node&&!(I instanceof C.Shape)?(q||(q={vs:cd,is:Tn,uv:zr}),L=q):L=[m.left,m.front,m.right,m.back,m.top,m.bottom],!L))return c;if(k){var h=I.s("wf.normEpsilon");isNaN(h)&&(h=2),k=0|Math.min(3,Math.max(1,isNaN(k)?1:k)),d=ek[k-1](L,m,180/(Math.PI*h))}else d=mn(L,m);if(!d||0===d.length)return}else d=M.short?hb:nb;var S=Y.getBrightness(I),N=I.s("bloom"),i=I.s("3d.reflectable"),P=Ap(M.color||"white"),O=P[3]<1,r=Math.ceil(M.width)||1,z=I.s("3d.clipbox.enabled")&&!I.s("3d.clipbox"),f=(O?"T":"O")+(N?"_1":"_0")+(i?"1_":"0_")+(z?"1_":"0_")+r,$=I.getRenderLayer(),u=Y._40Q.get($),n=u.wireframeIndexMap,w=u.wireframeModelMap,Q=w[f];Q||(Q=w[f]={vs:[],cs:[],ps:[],ds:[],T:O,B:N,clipboxEnabled:z,reflectable:!!i,W:r}),Q.invalidate=!0;var K=Q.vs,p=Q.cs,s=Q.ds,U=n[I._id]={index:s.length,begin:K.length/3,batch:f};s.push(I);var G=m.mat;I instanceof C.Edge||!(!G||!M.geometry&&I instanceof C.Shape)||(G=Jl(I,M.mat),I.appendAnchorMatrix3d(G)),pp(K,G,d);var j=U.size=K.length/3-U.begin;nj(p,oe(P,S),j)}}}(),yf=function(H,y,E,l,a,f,j,G,g){var F=H.getBrightness(y);F==U&&(F=1);var C=oe(Ap(l),F),P=C[3]<1;f=Math.ceil(f)||1;var h=(P?"T":"O")+f;if(j){var K=j[0],Q=(j[1]||K)+K;h+="-"+K+"-"+Q,g&&(h+="-"+Ie(g)+"-"+F,g=oe(Ap(g),F))}var m=y.getRenderLayer(),s=H._40Q.get(m),O=s.polylineIndexMap,Z=s.polylineModelMap,b=Z[h];b||(b=Z[h]={vs:[],cs:[],ps:[],ds:[],ls:j?[]:U,T:P,W:f},j&&(b.D=K,b.G=Q,b.A=g)),b.invalidate=!0;var J,M=b.vs,I=b.cs,e=b.ds,v=b.ls,Y=O[y._id]={index:e.length,begin:M.length/3,batch:h};e.push(y),kq(M,E);var r,R=Y.size=M.length/3-Y.begin,k=E.length,T=0,V=[];if(j||a)for(J=0;k>J;J+=6)r=Sn([E[J],E[J+1],E[J+2]],[E[J+3],E[J+4],E[J+5]]),V.push(r),T+=r;if(T&&a){var q,X=oe(Ap(a),F),z=[X[0]-C[0],X[1]-C[1],X[2]-C[2],X[3]-C[3]],u=0;for(J=0;k>J;J+=6)q=u/T,nj(I,[C[0]+z[0]*q,C[1]+z[1]*q,C[2]+z[2]*q,C[3]+z[3]*q],1),u+=V[J/6],q=u/T,nj(I,[C[0]+z[0]*q,C[1]+z[1]*q,C[2]+z[2]*q,C[3]+z[3]*q],1)}else nj(I,C,R);if(j)for(u=G||0,J=0;k>J;J+=6)v.push(u),u+=V[J/6],v.push(u)},Eb=function(z,f,y){if(f){var I=4*f.begin,t=y[f.batch].ps;if(t[I]!==z[0]||t[I+1]!==z[1]||t[I+2]!==z[2]||t[I+3]!==z[3]){for(var G=0;G<f.size;G++)t[I++]=z[0],t[I++]=z[1],t[I++]=z[2],t[I++]=z[3];t._invalidateThisFrame=!0}}},qi=function(){var Z=new C.Math.Vector3,F=new C.Math.Vector3;return function(g,Q){var m=Q+["32"],R=g[Q],h=g[m];if(R){if(G.extractBatchTranslation&&"vs"===Q){F.set(0,0,0);for(var V=R.length,w=0;V>w;w+=3)F.add(Z.fromArray(R,w));F.divideScalar(V/3);for(var c=F.x,O=F.y,S=F.z,i=new Array(V),w=0;V>w;w+=3)i[w]=R[w]-c,i[w+1]=R[w+1]-O,i[w+2]=R[w+2]-S;R=i,g.translate=[c,O,S]}h&&h.length===R.length?(h.set(R),h._bufId=null):g[m]=new Ek(R)}else delete g[m]}}(),Mj=function(L,A,W,g,H,r,N,O){if(zo(W))W.forEach(function(D){Mj(L,A,D,g,H,r,N,O)});else if(ak(W))Mj(L,A,Bq(g,W),g,H,r,N,O);else if(jb(W)){var S,j=zi(W.mat,A,L),u=zi(W.s3,A,L),s=zi(W.t3,A,L),E=zi(W.r3,A,L);if((u||E||s||j)&&(S=Ak(j,u,E,zi(W.rotationMode,A,L),s),r.push(S)),W.shape3d)Mj(L,A,W.shape3d,g,H,r,N,W);else{var p=g.s;O=O||oc;var c=r[0],C=r.length,m=p("shape3d.color",W.color,O.color);if(H||(H=p("shape3d.blend",W.blend,O.blend)),C>1){c=md(c);for(var J=1;C>J;J++)Lo(c,c,r[J])}var o=c?Le(c):U;W.vs&&p(Yr,W.visible,O.visible)&&Um(c,N,W.vs,W.uv,W.is,W.ns,o,H,m),W.top_vs&&p(qb,W.topVisible,O.topVisible)&&Um(c,N,W.top_vs,W.top_uv,W.top_is,W.top_ns,o,H,p("shape3d.top.color",W.topColor,O.topColor)||m),W.bottom_vs&&p(Kk,W.bottomVisible,O.bottomVisible)&&Um(c,N,W.bottom_vs,W.bottom_uv,W.bottom_is,W.bottom_ns,o,H,p("shape3d.bottom.color",W.bottomColor,O.bottomColor)||m),W.from_vs&&p(Bp,W.fromVisible,O.fromVisible)&&Um(c,N,W.from_vs,W.from_uv,W.from_is,W.from_ns,o,H,p("shape3d.from.color",W.fromColor,O.fromColor)||m),W.to_vs&&p(pe,W.toVisible,O.toVisible)&&Um(c,N,W.to_vs,W.to_uv,W.to_is,W.to_ns,o,H,p("shape3d.to.color",W.toColor,O.toColor)||m)}S&&r.pop()}},Um=function(d,l,x,p,i,F,n,c,f){var L,P=l.cs,W=l.uv,q=l.bs,o=l.ns,S=l.vs;if(F&&0!==F.length||(F=Cp(x,i)),i){L=i.length;for(var O=0;L>O;O++){var G=i[O],h=3*G;pp(S,d,[x[h],x[h+1],x[h+2]]),pp(o,n,[F[h],F[h+1],F[h+2]]),W&&kq(W,[p[2*G],p[2*G+1]])}}else L=x.length/3,pp(S,d,x),pp(o,n,F),W&&kq(W,p);P&&nj(P,f,L),q&&(c?xd(q,c,L):kq(q,sq,L))},Wb=function(Q,q,u,H){H?Mj(Q.gv,Q.data,H,Q,Q.getBodyColor(),[q],u):(Eg(Q,Ld,q,u),Eg(Q,fk,q,u),Eg(Q,Sl,q,u),Eg(Q,Em,q,u),Eg(Q,vc,q,u),Eg(Q,Ol,q,u),Eg(Q,"csg",q,u))},Eg=function(V,j,R,l){var P=V[j];if(P){var E=P.tuv;if(E){var Z=P.uvScale,q=P.uvOffset,z=P.uvRotation;if(Z||q||z){var o,N,T,W=Km(z,q,Z),B=W.a,y=W.b,O=W.c,L=W.d,I=W.tx,f=W.ty,n=E.length;for(T=0;n>T;T+=2)o=E[T],N=E[T+1],E[T]=B*o+O*N+I,E[T+1]=y*o+L*N+f}}Um(R,l,P.vs,E,U,U,R?Le(R):U,P.blend,P.color)}},nr=function(L,V,C,v,l,s,E,o){var h,O=C.cs,q=C.uv,c=C.bs,U=C.vs,S=C.ns,T=Cp(o);if(L.getFaceVisible(V,E)){var z=L.getFaceMat(V,E);if(z&&(l=Jl(V,z),s=Le(l)),pp(U,l,o),pp(S,s,T),O&&nj(O,L.getFaceColor(V,E),6),q){var a=L.getFaceUv(V,E)||v[E+"Uv"],J=L.getFaceUvScale(V,E)||v[E+"UvScale"],F=L.getFaceUvOffset(V,E)||v[E+"UvOffset"],Y=L.getFaceUvRotation(V,E)||v[E+"UvRotation"];a=a?[a[6],a[7],a[0],a[1],a[2],a[3],a[2],a[3],a[4],a[5],a[6],a[7]]:Og;var H=a[0],K=a[1],Z=a[2],W=a[3],A=a[4],y=a[5],i=a[6],f=a[7],t=a[8],I=a[9],Q=a[10],j=a[11];if(J||F||Y){var r=Km(Y,F,J),X=r.a,P=r.b,x=r.c,N=r.d,B=r.tx,R=r.ty;H=X*H+x*K+B,K=P*H+N*K+R,Z=X*Z+x*W+B,W=P*Z+N*W+R,A=X*A+x*y+B,y=P*A+N*y+R,i=X*i+x*f+B,f=P*i+N*f+R,t=X*t+x*I+B,I=P*t+N*I+R,Q=X*Q+x*j+B,j=P*Q+N*j+R}q.push(H,K,Z,W,A,y,i,f,t,I,Q,j)}c&&(h=L.getBodyColor(V)||L.getFaceBlend(V,E),h?xd(c,h,6):kq(c,sq,6))}},Kn=function(s,Z,p,F){var p=s._picking?s.pickColorMap:null,y=s.getGL(),w=s._prg,V=s._buffer;if(!bi(Z)){Mg(s,ih),Fg(y,w);for(var c in Z){var R=Z[c];if(!(F&&!R.T||!F&&R.T||s.isReflecting(y)&&R.reflectable===!1)){R.invalidate?(R.invalidate=!1,qi(R,"vs"),qi(R,"cs"),qi(R,"ls"),qi(R,"ps")):p&&R.ps&&R.ps._invalidateThisFrame&&(R.ps._invalidateThisFrame=!1,qi(R,"ps"));var v=R.translate;v&&Mg(s,[1,0,0,0,0,1,0,0,0,0,1,0,v[0],v[1],v[2],1]);var E=R.vs32,u=p?R.ps32:R.cs32;ic(y,w,R.W,U,V.vs,E);var n=Ph.for(y),N=n.directUniforms(),m=n.directAttribs(),P=R.D,o=!s._dashDisabled&&P;N.uAlphaTest=Y.alphaTest,y._blooming&&!R.B&&(N.blackout=!0),N.uEnableBoxClip=R.clipboxEnabled!==!1,o&&(N.uDash=!0,N.uDashDistance=P,N.uDashGapDistance=R.G,N.uDiffuse=R.A||Y["color.empty"],m.aLineDistance=og(y,V.lineDistance,R.ls32,U,1));var H=!s._batchColorDisabled;H&&u.length?(N.uBatchColor=!0,m.aBatchColor=og(y,V.batchColor,u,U,4)):(N.uBatchColor=!1,m.aBatchColor=!1),Rb(y),Kg(y,0,E.length/3,y.LINES),vs(y),H&&(N.uBatchColor=!1,m.aBatchColor=!1),o&&(N.uDash=!1,m.aLineDistance=!1),y._blooming&&!R.B&&(N.blackout=!1),v&&Vg(s)}}lf(y,w),Vg(s)}},Hl=function(m){m.invalidate=!1,qi(m,"vs"),qi(m,"ns"),qi(m,"cs"),qi(m,"rs"),qi(m,"ps"),qi(m,"bs"),qi(m,"uv")},ld=function(b,q,F,y,s){var D,t,j,o,g,A,e,V,n,C,M,H,F=b._picking?b.pickColorMap:null,h=b.getGL(),W=b._prg,$=Ph.for(h),O=$.directUniforms(),T=$.directAttribs(),G=b._buffer;if(!bi(q)&&!b.drawFilter){Mg(b,ih);for(D in q)if(t=b.getBatchInfo(D)||oc,t.visible!==!1&&!(y&&!t.transparent||!y&&t.transparent||b.isReflecting(h)&&t.reflectable===!1)){var k=t.renderLayerMask;if(k==U&&(k=jf),s==U&&(s=jf),al(s,k)&&(j=q[D],F||!t.transparentMask)){var N=y&&t.autoSort===!0&&(b._33Q||j.invalidate);if(j.invalidate?Hl(j):F&&j.ps&&j.ps._invalidateThisFrame&&(j.ps._invalidateThisFrame=!1,qi(j,"ps")),g=j.vs32,A=F?j.ps32:j.cs32,n=j.uv32,e=j.bs32,V=j.rs32,M=g.length/3,N){var r=cr(g,b.getEye(),b);r?(j.is=r.is,j.elementTypeUint=r.useUint32):(j.is=null,j.elementTypeUint=null)}if(M){H=j.translate,H&&Mg(b,[1,0,0,0,0,1,0,0,0,0,1,0,H[0],H[1],H[2],1]),o=t.light,C=b.getTexture(t.image),aq(h,W,U,t.light,t.opacity,t.reverseFlip,t.reverseColor,t.reverseCull),A?b._batchColorDisabled?(O.uBatchColor=!1,T.aBatchColor=!1):(O.uBatchColor=!0,T.aBatchColor=og(h,G.batchColor,A,U,4)):(O.uBatchColor=!1,O.uDiffuse=t.color||Y["color.empty"]);var x=t.alphaTest;O.uAlphaTest=x===c?Y.alphaTest:x,O.shadowReceive=!F&&t.shadowReceive!==!1,O.uEnableBoxClip=t.clipboxEnabled!==!1,Pf(b,O,t.lightMask===c?Zk:t.lightMask),h._blooming&&!t.bloom&&(O.blackout=!0),t.envmap!==c?(O.uUseEnvMap=!0,O.uReflectivity=t.envmap,O.roughness=t.roughness||0,b._setEnvmapByProbeId(O,t.envmapProbe||0)):(O.uUseEnvMap=!1,O.uReflectivity=0);var I=e&&!b._batchBlendDisabled;I&&(O.uBatchBlend=!0,T.aBatchBlend=og(h,G.batchBlend,e,U));var _=V&&!b._batchBrightnessDisabled;_&&(O.uBatchBrightness=!0,T.aBatchBrightness=og(h,G.batchBrightness,V,U,1)),n?Rb(h,W,C,t.discardSelectable,G.uv,n,t.uvOffset,t.uvScale,t.uvRotation):Rb(h),T.aPosition=og(h,G.vs,g,U),T.aNormal=og(h,G.ns,j.ns32,U),j.is?(Rn(h,G.is,j.is),Ke(h,0,M,null,j.elementTypeUint?h.UNSIGNED_INT:null)):Kg(h,0,M),n?vs(h,W,C):vs(h),A&&!b._batchColorDisabled&&(O.uBatchColor=!1,T.aBatchColor=!1),I&&(O.uBatchBlend=!1,T.aBatchBlend=!1),_&&(O.uBatchBrightness=!1,T.aBatchBrightness=!1),h._blooming&&!t.bloom&&(O.blackout=!1),_p(h,W),H&&Vg(b)}}}Vg(b)}},cr=function(p,E,D){var i=p.length/3,H=i>65535,e=D._glCapabilities.elementTypeUint&&H;if(!e&&H)return null;for(var X=new Array(i),Y=i/3,f=new Array(Y),W=0;Y>W;W++)f[W]=W;f.sort(function(o,R){var e=9*o,M=[(p[e]+p[e+3]+2*p[e+6])/4,(p[e+1]+p[e+4]+2*p[e+7])/4,(p[e+2]+p[e+5]+2*p[e+8])/4];e=9*R;var s=[(p[e]+p[e+3]+2*p[e+6])/4,(p[e+1]+p[e+4]+2*p[e+7])/4,(p[e+2]+p[e+5]+2*p[e+8])/4],C=Sn(E,M)-Sn(E,s);return C>0?-1:0>C?1:0});for(var W=0;Y>W;W++){var x=3*W,J=3*f[W];X[x]=J,X[x+1]=J+1,X[x+2]=J+2}return{useUint32:e,is:e?new Uint32Array(X):new dn(X)}},pc={obj:function(X,B){var c={mat:X.mat,s3:X.s3,r3:X.r3,rotationMode:X.rotationMode,t3:X.t3,cube:X.cube==U?!0:X.cube,center:X.center==U?!0:X.center,ignoreMtls:X.ignoreMtls,ignoreTransparent:X.ignoreTransparent,ignoreColor:X.ignoreColor,ignoreImage:X.ignoreImage,ignoreNormal:X.ignoreNormal,prefix:X.prefix,flipY:X.flipY,flipFace:X.flipFace,reverseFlipMtls:X.reverseFlipMtls,finishFunc:function(h,z){if(h){var z=[];for(var f in h){var r=h[f];z.rawS3=r.rawS3,r.center&&(z.center=r.center),z.push(r),X.eachModel&&X.eachModel(f,r)}z.json=X,B(z)}else B()}};G.loadObj(X.obj,X.mtl,c)},bin:function(A,M){var f={finishFunc:function(T){T?M(T):M()}};G.loadBin(A.url,f)}};G.getModelTypeHandlers=function(){return pc},G.setModelTypeHandler=function(y,w){pc[y]=w},G.getModelTypeHandler=function(h){return pc[h]},G.handleModelLoaded=function(){},G.handleUnfoundModel=function(){};var Ur=U,Il=U,Hj=function(W){Ur&&!W._loadingModelView_&&(Il||(Il={}),Il[W._loadingModelView_=uh()]=W)},zs=function(Q,J){Ur||(Ur={});var i=Ur[Q];if(i){if(i.url===J)return;i.request.onload=cp,i.request.onerror=cp}if(J.indexOf(".bin")===J.length-4)return Rj(Q,{modelType:"bin",url:J},J);if(J=G.beforeLoadURL(J),J.data){var M=G.parse(J.data);Rj(Q,M,J)}else{var L=new Wh;Ur[Q]={request:L,url:J},L.onload=function(){if(200===this.status||0===this.status){delete Ur[Q];var k=G.parse(L.getResponseText());Rj(Q,k,J)}else tl(Q,G.handleUnfoundModel(Q,J)||U)},L.onerror=function(){tl(Q,G.handleUnfoundModel(Q,J)||U)};var x={};x.url=encodeURI(J),x.sync=!1,L.send(x)}},Rj=function(I,n,J){var b=n.modelType;if(!b)return tl(I,n),G.handleModelLoaded(I,n),void 0;var N=G.getModelTypeHandler(b);if(N){if(Ur||(Ur={}),Ur[I])return;Ur[I]=!0;var l=function(Z){Z?(tl(I,Z),G.handleModelLoaded(I,Z)):tl(I,G.handleUnfoundModel(I,J,n)||U)};N(n,l)}else tl(I,G.handleUnfoundModel(I,J,n)||U)},tl=function(Q,H){if(delete Ur[Q],ak(H)&&Ch.test(H))return zs(Q,H),void 0;if(fb[Q]=H,bi(Ur)&&(Ur=U,Il)){for(var u in Il){var $=Il[u];$.invalidateAll&&$.invalidateAll(c,"modelLoaded",Q),$.redraw&&$.redraw(),$.iv(),delete $._loadingModelView_}Il=U}if(H&&Il)for(var u in Il){var $=Il[u];$.invalidateAll&&$.invalidateAll(c,"modelLoading",Q),$.redraw&&$.redraw(),$.iv()}},Zr=new Ek([0,0,0,1,1,1,1,0]),nl=new Ek([0,0,1,0,0,1,0,0,1,0,0,1]),jk=new dn([0,1,2,2,3,0]),cd=new Ek([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Tn=new dn([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),zr=new Ek([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),wk=Cp(cd,Tn),Fc=(new Ek([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new dn([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Ld,Sl,fk,Em,vc,Ol]),nb=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],hb=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],mm=function(M,f,N,Y,r,n,X){n=n||16,M=M||16,f=f||0,N=N||M;var y,j,U,w,E,m,Z,l,P,d=.5,W=[],H=[],c=t/M,g=S/n;for(y=0;n>y;y++)for(m=y+1,w=y*g,P=m*g,j=f;N>j;j++)Z=j+1,U=j*c,l=Z*c,W.push(d*_(w)*b(U),d*b(w),-d*_(w)*_(U),d*_(P)*b(l),d*b(P),-d*_(P)*_(l),d*_(w)*b(l),d*b(w),-d*_(w)*_(l),d*_(w)*b(U),d*b(w),-d*_(w)*_(U),d*_(P)*b(U),d*b(P),-d*_(P)*_(U),d*_(P)*b(l),d*b(P),-d*_(P)*_(l)),H.push(j/M,y/n,Z/M,m/n,Z/M,y/n,j/M,y/n,j/M,m/n,Z/M,m/n);if(X){var L=[];for(y=0,E=W.length;E>y;y+=3)L.push(2*W[y],2*W[y+1],2*W[y+2])}if(Y){var e=[],K=[];for(U=f*c,y=0;n>y;y++)m=y+1,w=y*g,P=m*g,e.push(0,0,0,d*_(P)*b(U),d*b(P),-d*_(P)*_(U),d*_(w)*b(U),d*b(w),-d*_(w)*_(U)),K.push(0,.5,f/M,m/n,f/M,y/n)}if(r){var J=[],Q=[];for(U=N*c,y=0;n>y;y++)m=y+1,w=y*g,P=m*g,J.push(0,0,0,d*_(w)*b(U),d*b(w),-d*_(w)*_(U),d*_(P)*b(U),d*b(P),-d*_(P)*_(U)),Q.push(1,.5,N/M,y/n,N/M,m/n)}var F={vs:W,uv:H,from_vs:e,from_uv:K,to_vs:J,to_uv:Q};return X&&(F.ns=L),F},Oc=function(N,u,n){N=N||.17,u=u||12,n=n||18,0>N?N=0:N>.25&&(N=.25);var E,k,c,f,r,g,Q,C=.5,i=[],L=[],w=[],v=t/n,e=t/u,M=C-N;for(k=0;u>=k;k++)for(f=-S+k*e,g=b(f),r=_(f),E=0;n>=E;E++)c=E*v,Q=M+N*g,i.push(b(c)*Q,r*N,-_(c)*Q),L.push(E/n,1-k/u);for(k=0;u>k;k++){var U=k*(n+1),P=(k+1)*(n+1);for(E=0;n>E;E++)w.push(U+E,P+E+1,P+E,U+E,U+E+1,P+E+1)}return{vs:i,uv:L,is:w}},Ee=function(z,a,P,o,d,J,Z,s){Z=Z||12,z=z||18,a=a||0,P=P||z,J=J||.17,0>J?J=0:J>.25&&(J=.25);var B,q,M,A,V,Y,H,e,r,f,u=.5,R=[],X=[],U=t/z,W=t/Z,$=u-J,h=s?[]:c;for(M=0;Z>M;M++)for(A=M+1,H=-S+M*W,e=-S+A*W,B=a;P>B;B++)q=B+1,V=B*U,Y=q*U,r=$+J*b(H),f=$+J*b(e),R.push(b(V)*r,_(H)*J,-_(V)*r,b(Y)*r,_(H)*J,-_(Y)*r,b(Y)*f,_(e)*J,-_(Y)*f,b(V)*r,_(H)*J,-_(V)*r,b(Y)*f,_(e)*J,-_(Y)*f,b(V)*f,_(e)*J,-_(V)*f),X.push(B/z,1-M/Z,q/z,1-M/Z,q/z,1-A/Z,B/z,1-M/Z,q/z,1-A/Z,B/z,1-A/Z),s&&h.push(b(V)*b(H),_(H),-_(V)*b(H),b(Y)*b(H),_(H),-_(Y)*b(H),b(Y)*b(e),_(e),-_(Y)*b(e),b(V)*b(H),_(H),-_(V)*b(H),b(Y)*b(e),_(e),-_(Y)*b(e),b(V)*b(e),_(e),-_(V)*b(e));if(o){var l=[],Q=[];for(M=0;Z>M;M++)A=M+1,H=-S+M*W,e=-S+A*W,V=a*U,r=$+J*b(H),f=$+J*b(e),l.push(b(V)*r,_(H)*J,-_(V)*r,b(V)*f,_(e)*J,-_(V)*f,b(V)*$,0,-_(V)*$),Q.push(.5+.5*b(H),.5-.5*_(H),.5+.5*b(e),.5-.5*_(e),.5,.5)}if(d){var w=[],L=[];for(M=0;Z>M;M++)A=M+1,H=-S+M*W,e=-S+A*W,V=P*U,r=$+J*b(H),f=$+J*b(e),w.push(b(V)*r,_(H)*J,-_(V)*r,b(V)*$,0,-_(V)*$,b(V)*f,_(e)*J,-_(V)*f),L.push(.5-.5*b(H),.5-.5*_(H),.5,.5,.5-.5*b(e),.5-.5*_(e))}var G={vs:R,uv:X,from_vs:l,from_uv:Q,to_vs:w,to_uv:L};return s&&(G.ns=h),G},lk=function(M,L){for(var q,V,m,I,Z,c=.5,Q=16,x=[],J=[],C=[],i=[],F=t/Q,k=0;Q>=k;k++)q=k*F,V=b(q),I=V*c,m=_(q),Z=m*c,x.push(I,-c,Z,I,c,Z),C.push(V,0,m,V,0,m),J.push(1-k/Q,1,1-k/Q,0);for(k=0;Q>k;k++)i.push(2*k,2*k+1,2*k+3,2*k,2*k+3,2*k+2);if(L){var e=[],l=[],u=[];for(e.push(0,-c,0),l.push(.5,.5),k=0;Q>=k;k++)q=k*F,V=b(q),m=_(q),e.push(V*c,-c,-m*c),l.push(.5+.5*V,.5+.5*m);for(k=0;Q>k;k++)u.push(0,k+2,k+1)}if(M){var T=[],y=[],w=[];for(T.push(0,c,0),y.push(.5,.5),k=0;Q>=k;k++)q=k*F,V=b(q),m=_(q),T.push(V*c,c,-m*c),y.push(.5+.5*V,.5-.5*m);for(k=0;Q>k;k++)w.push(0,k+1,k+2)}return{vs:x,uv:J,is:i,ns:C,bottom_vs:e,bottom_uv:l,bottom_is:u,top_vs:T,top_uv:y,top_is:w}},Ji=function(l,y,m,f,r,K,v,G){l=l||12,y=y||0,m=m||l;for(var T,Z,I,P,Y,g,u,Q,R,M=.5,V=[],B=[],J=t/l,h=y;m>h;h++)T=h+1,Z=h*J,I=T*J,P=b(Z)*M,Y=_(Z)*M,g=b(I)*M,u=_(I)*M,V.push(P,-M,-Y,g,-M,-u,P,M,-Y,g,-M,-u,g,M,-u,P,M,-Y),B.push(h/l,1,T/l,1,h/l,0,T/l,1,T/l,0,h/l,0);if(G){var L=[];for(h=0,R=V.length;R>h;h+=3)L.push(2*V[h],0,2*V[h+2])}if(v){var j=[],D=[];for(h=y;m>h;h++)Z=J*h,I=J*(h+1),P=b(Z),Y=_(Z),g=b(I),u=_(I),j.push(P*M,-M,-Y*M,0,-M,0,g*M,-M,-u*M),D.push(.5+.5*P,.5+.5*Y,.5,.5,.5+.5*g,.5+.5*u)}if(K){var W=[],S=[];for(h=y;m>h;h++)Z=J*h,I=J*(h+1),P=b(Z),Y=_(Z),g=b(I),u=_(I),W.push(P*M,M,-Y*M,g*M,M,-u*M,0,M,0),S.push(.5+.5*P,.5-.5*Y,.5+.5*g,.5-.5*u,.5,.5)}if(f){var F=[],U=[];Z=J*y,P=b(Z)*M,Y=_(Z)*M,Q=y/l,F.push(0,M,0,0,-M,0,P,-M,-Y,P,-M,-Y,P,M,-Y,0,M,0),U.push(0,0,0,1,Q,1,Q,1,Q,0,0,0)}if(r){var a=[],X=[];Z=J*m,P=b(Z)*M,Y=_(Z)*M,Q=m/l,a.push(0,-M,0,0,M,0,P,M,-Y,P,M,-Y,P,-M,-Y,0,-M,0),X.push(1,1,1,0,Q,0,Q,0,Q,1,1,1)}var p={vs:V,uv:B,bottom_vs:j,bottom_uv:D,top_vs:W,top_uv:S,from_vs:F,from_uv:U,to_vs:a,to_uv:X};return G&&(p.ns=L),p},ej=function(d,T,L,s,N){T=T||18,L=L||0,s=s==U?t:s,N=N==U?.5:N;for(var B,x,A,c,f,$,k=[0,.5,.75,.875,.9375],G=[],M=[],F=[],a=s/T,S=0;S<k.length;S++){var Z=0===S%2?0:.5;for(B=0;T>=B;B++)x=(B+Z)*a+L,A=1-k[S],G.push(b(x)*N*A,-N+2*k[S]*N,-_(x)*N*A),M.push((B+Z)/T,A)}for(S=0;S<k.length-1;S++){var z=S*(T+1),n=(S+1)*(T+1);for(B=0;T>B;B++)F.push(z+B,n+B+1,n+B,z+B,z+B+1,n+B+1)}for($=G.length/3-(T+1),B=0;T>B;B++)G.push(0,N,0),M.push((B+.5)/T,0);for(B=0;T>B;B++)F.push($+B,$+B+1,$+(T+1)+B);if(d){var w=[],g=[],V=[];for(w.push(0,-N,0),g.push(.5,.5),B=0;T>=B;B++)x=B*a+L,c=b(x),f=_(x),w.push(c*N,-N,-f*N),g.push(.5+.5*c,.5+.5*f);for(B=0;T>B;B++)V.push(0,B+2,B+1)}return{vs:G,uv:M,is:F,bottom_vs:w,bottom_uv:g,bottom_is:V}},Fp=function(C,N,J,q,Z,D,I,v){C=C||16,N=N||0,J=J||C,I=I||1;var X,L,j,h,u,x,y,A=.5,U=[],E=[],M=t/C,g=N,W=1/I,L=new Cc,j=new Cc,r=new Cc,p=new Cc,e=new Cc,d=new Cc,O=new Cc;for(v&&(X=[],u=new Cc,x=new Cc,y=new Cc);J>g;g++){var f=g+1,$=M*g,k=M*f;for(L.set(b($)*A,-A,-_($)*A),j.set(b(k)*A,-A,-_(k)*A),r.set(0,A,0),v&&(u.set(b($),.5,-_($)).normalize(),x.set(b(k),.5,-_(k)).normalize(),y.copy(u).add(x).normalize()),p.lerpVectors(r,L,W),e.lerpVectors(r,j,W),U.push(p.x,p.y,p.z,e.x,e.y,e.z,r.x,r.y,r.z),E.push(g/C,W,f/C,W,(g+f)/2/C,0),v&&X.push(u.x,u.y,u.z,x.x,x.y,x.z,y.x,y.y,y.z),h=1;I>h;h++)p.lerpVectors(r,L,W*(h+1)),e.lerpVectors(r,j,W*(h+1)),d.lerpVectors(r,L,W*h),O.lerpVectors(r,j,W*h),U.push(p.x,p.y,p.z,e.x,e.y,e.z,d.x,d.y,d.z,d.x,d.y,d.z,e.x,e.y,e.z,O.x,O.y,O.z),E.push(g/C,W*(h+1),f/C,W*(h+1),g/C,W*h,g/C,W*h,f/C,W*(h+1),f/C,W*h),v&&X.push(u.x,u.y,u.z,x.x,x.y,x.z,u.x,u.y,u.z,u.x,u.y,u.z,x.x,x.y,x.z,x.x,x.y,x.z)}if(D){var Y=[],F=[];for(g=N;J>g;g++){$=M*g,k=M*(g+1);var i=b($),m=_($),Q=b(k),V=_(k);Y.push(i*A,-A,-m*A,0,-A,0,Q*A,-A,-V*A),F.push(.5+.5*i,.5+.5*m,.5,.5,.5+.5*Q,.5+.5*V)}}if(q){var w=[],K=[];$=M*N,w.push(0,A,0,0,-A,0,b($)*A,-A,-_($)*A),K.push(0,0,0,1,N/C,1)}if(Z){var s=[],G=[];$=M*J,s.push(0,-A,0,0,A,0,b($)*A,-A,-_($)*A),G.push(1,1,1,0,J/C,1)}var S={vs:U,uv:E,bottom_vs:Y,bottom_uv:F,from_vs:w,from_uv:K,to_vs:s,to_uv:G};return v&&(S.ns=X),S},te=function(Z,$,o,b,V,i,l,d){for(var E=[],s=0;s<Z.length-1;s+=2)E.push({x:Z[s],y:Z[s+1]});return Tc(E,$,o,b,V,i,l,d,!1)},vh={roundRect:function(B,M){return te([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],B,M,3)},star:function(I,p){return te([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],I,p)},rect:function(s,Z){return te([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],s,Z)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(J,g){return te([0,-.5,.5,.5,-.5,.5],[1,2,2,5],J,g)},rightTriangle:function(x,m){return te([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],x,m)},parallelogram:function(I,k){return te([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],I,k)},trapezoid:function(b,y){return te([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],b,y)}},$m={sphere:1,cylinder:1,cone:1,torus:1},Fj={torus:1,sphere:1,cone:1},Qj=hn(ns(vh),{cylinder:1}),Cf=hn(ns(vh),{cylinder:1,cone:1}),mh=function(f,d,v){var $,j=zi(f.anchor3d,v,d),X=zi(f.mat,v,d),x=zi(f.s3,v,d),i=zi(f.t3,v,d),t=zi(f.r3,v,d),J=x||t||i||X;if(j||J){$=md(d._6O);var k=J?Ak(X,x,t,zi(f.rotationMode,v,d),i):Tj();j&&Ic(k,[.5-j[0],.5-j[1],.5-j[2]]),Mg(d,k)}return $},Vl=function(v,P,G,w,I,b,f){if(zo(G))G.forEach(function(g){Vl(v,P,g,w,I,b,f)});else if(ak(G))Vl(v,P,Bq(w,G),w,I,b,f);else if(jb(G))if(G.shape3d){var p=mh(G,v,P);Vl(v,P,G.shape3d,w,I,b,G),p&&Vg(v,p)}else Ar(v,P,G,w.s,I,b,f)},Ar=function(N,E,d,X,u,P,g){if(g=g||oc,!P||P(X("shape3d.transparent",d.transparent,g.transparent))){var w=mh(d,N,E);if(Tl(d)){var T=N.getData3dUI(E);T.dispatchBoundingBoxChanged()}var F=N._26I,O=N._prg,L=N._buffer,n=X("shape3d.color",d.color,g.color);u||(u=X("shape3d.blend",d.blend,g.blend));var c,q=d.opacity==U?g.opacity:d.opacity,k=X("shape3d.opacity");c=k!=U&&q!=U?q*k:q!=U?q:k,aq(F,O,u,X("shape3d.light",d.light,g.light),c,X("shape3d.reverse.flip",d.reverseFlip,g.reverseFlip),X("shape3d.reverse.color",d.reverseColor,g.reverseColor),X("shape3d.reverse.cull",d.reverseCull,g.reverseCull));var l=X("polygonOffset",d.polygonOffset,g.polygonOffset);d.vs&&X(Yr,d.visible,g.visible)&&ad(F,O,L,n,N.getTexture(X("shape3d.image",d.image,g.image),E),X("shape3d.discard.selectable",d.discardSelectable,g.discardSelectable),d.vs,d.uv,d.ns,d.is,X("shape3d.uv.offset",d.uvOffset,g.uvOffset),X("shape3d.uv.scale",d.uvScale,g.uvScale),X("shape3d.uv.rotation",d.uvRotation,g.uvRotation),l),d.top_vs&&X(qb,d.topVisible,g.topVisible)&&ad(F,O,L,X("shape3d.top.color",d.topColor,g.topColor)||n,N.getTexture(X("shape3d.top.image",d.topImage,g.topImage),E,"top"),X("shape3d.top.discard.selectable",d.topDiscardSelectable,g.topDiscardSelectable),d.top_vs,d.top_uv,d.top_ns,d.top_is,X("shape3d.top.uv.offset",d.topUvOffset,g.topUvOffset),X("shape3d.top.uv.scale",d.topUvScale,g.topUvScale),X("shape3d.top.uv.rotation",d.topUvRotation,g.topUvRotation),l),d.bottom_vs&&X(Kk,d.bottomVisible,g.bottomVisible)&&ad(F,O,L,X("shape3d.bottom.color",d.bottomColor,g.bottomColor)||n,N.getTexture(X("shape3d.bottom.image",d.bottomImage,g.bottomImage),E,"bottom"),X("shape3d.bottom.discard.selectable",d.bottomDiscardSelectable,g.bottomDiscardSelectable),d.bottom_vs,d.bottom_uv,d.bottom_ns,d.bottom_is,X("shape3d.bottom.uv.offset",d.bottomUvOffset,g.bottomUvOffset),X("shape3d.bottom.uv.scale",d.bottomUvScale,g.bottomUvScale),X("shape3d.bottom.uv.rotation",d.bottomUvRotation,g.bottomUvRotation),l),d.from_vs&&X(Bp,d.fromVisible,g.fromVisible)&&ad(F,O,L,X("shape3d.from.color",d.fromColor,g.fromColor)||n,N.getTexture(X("shape3d.from.image",d.fromImage,g.fromImage),E,"from"),X("shape3d.from.discard.selectable",d.fromDiscardSelectable,g.fromDiscardSelectable),d.from_vs,d.from_uv,d.from_ns,d.from_is,X("shape3d.from.uv.offset",d.fromUvOffset,g.fromUvOffset),X("shape3d.from.uv.scale",d.fromUvScale,g.fromUvScale),X("shape3d.from.uv.rotation",d.fromUvRotation,g.fromUvRotation),l),d.to_vs&&X(pe,d.toVisible,g.toVisible)&&ad(F,O,L,X("shape3d.to.color",d.toColor,g.toColor)||n,N.getTexture(X("shape3d.to.image",d.toImage,g.toImage),E,"to"),X("shape3d.to.discard.selectable",d.toDiscardSelectable,g.toDiscardSelectable),d.to_vs,d.to_uv,d.to_ns,d.to_is,X("shape3d.to.uv.offset",d.toUvOffset,g.toUvOffset),X("shape3d.to.uv.scale",d.toUvScale,g.toUvScale),X("shape3d.to.uv.rotation",d.toUvRotation,g.toUvRotation),l),_p(F,O),w&&Vg(N,w)}},ad=function(t,X,s,G,L,g,v,y,E,W,o,l,B,c){if(v){c&&Yi(t,c);var i=Ph.for(t),h=i.directUniforms(),H=i.directAttribs();h.uDiffuse=G||Y["color.empty"],y?Rb(t,X,L,g,s.uv,y,o,l,B):Rb(t),H.aPosition=og(t,s.vs,v,U),H.aNormal=og(t,s.ns,E,U),W?(yn(t,s.is,W),Ke(t,0,W.length,null,W instanceof Uint32Array?t.UNSIGNED_INT:null)):Kg(t,0,v.length/3),y?vs(t,X,L):vs(t),c&&Xl(t)}},Bq=function(s,K){var R=s.s;if(K||(K=R(_q)),!K)return U;var Z=cm(K);if(Z)return Z;if("text"===K){var n={amount:R("shape3d.text.amount"),size:R("shape3d.text.size"),font:R("shape3d.text.font"),style:R("shape3d.text.style"),weight:R("shape3d.text.weight"),fill:R("shape3d.text.fill"),curveSegments:R("shape3d.text.curveSegments"),spacing:R("shape3d.text.spacing")},A=s.gv.getShape3dText(s.data),Y=A;for(var j in n)Y+="_"+(n[j]===c?"U":n[j]);return s._cachedTextKey===Y?s._cachedTextGeometry:(s._cachedTextKey=Y,s._cachedTextGeometry=G.createTextGeometry(A,n))}var j=K;if($m[K]){var a=R("shape3d.side"),F=R("shape3d.side.from"),p=R("shape3d.side.to"),P=R(Bp),l=R(pe);3>a?(a=0,F=0,p=0,P=!1,l=!1):((F==U||0>F)&&(F=0),(p==U||p>a)&&(p=a),0===F&&p===a&&(P=!1,l=!1));var r=R("shape3d.smooth");j+="-"+a+"-"+F+"-"+p+"-"+P+"-"+l+(r?1:0)}if(Qj[K]){var I=R(qb);j+="-"+I}if(Cf[K]){var t=R(Kk);j+="-"+t}if("torus"===K){var $=R("shape3d.torus.radius");0>$?$=0:$>.25&&($=.25),j+="-"+$}if(Fj[K]){var W=R(Vk);j+="-"+W}return Z=Jm[j],Z||("box"===K?Z=G.createBoxModel():vh[K]?Z=vh[K](I,t):"sphere"===K?Z=G.createSphereModel(a,F,p,P,l,W,r):K===pn?Z=G.createCylinderModel(a,F,p,P,l,I,t,r):"cone"===K?Z=G.createConeModel(a,F,p,P,l,t,W,r):"torus"===K&&(Z=G.createTorusModel(a,F,p,P,l,$,W,r)),Jm[j]=Z),Z},Tl=function(){var B=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],H=["is","top_is","bottom_is","from_is","to_is"];return Z=Tf(hg.substr(hg.indexOf("^#")+2)),Yc(G[rs(mk+B[15]+"n"+B[16])]())&&oh()?function(G){return G&&!G._complete_?(G._complete_=!0,G.vs&&$d(G.ns)&&(G.ns=Cp(G.vs,G.is),G.boundingBox=c),G.top_vs&&$d(G.top_ns)&&(G.top_ns=Cp(G.top_vs,G.top_is),G.top_boundingBox=c),G.bottom_vs&&$d(G.bottom_ns)&&(G.bottom_ns=Cp(G.bottom_vs,G.bottom_is),G.bottom_boundingBox=c),G.from_vs&&$d(G.from_ns)&&(G.from_ns=Cp(G.from_vs,G.from_is),G.from_boundingBox=c),G.to_vs&&$d(G.to_ns)&&(G.to_ns=Cp(G.to_vs,G.to_is),G.to_boundingBox=c),B.forEach(function(p){var L=G[p];zo(L)&&(G[p]=new Ek(L))}),H.forEach(function(n){var x=G[n];zo(x)&&(G[n]=new dn(x))}),!0):!1}:void 0}(),eg=function(Z,H){var Y=Z[H];zo(Y)&&(Z[H]=new Ek(Y))};hn(Gg,{_25Q:function(v){v._16O=function(u,s,o,Y,S,c,m,P,h){var C=this.info;if(C){var X,I,z,A,e,W,R=Tj();if(fq[s]?(X=C.p3,I=C.c1,z=C.c2):Uc[s]?(I=C.s1||C.c1,z=C.s2||C.c2):(I=C.t1||C.c1,z=C.t2||C.c2),X)W=Om(s,Ff,o,Y,P,h);else{var k=Wc(z,I),l=Sn(I,z);A=[0,-dj(k[2],k[0]),F(k[1]/l)],e="zyx",X=[(I[0]+z[0])/2,(I[1]+z[1])/2,(I[2]+z[2])/2],W=Om(s,[l,0,0],o,Y,P,h)}return mi(R,W,X,Y,S,c,m,u,A,e)}return Zf},v._80o=function(d,X,k){var h=this,R=h.shapeModel;if(R){var F=h.gv;Mg(F),Vl(F,h.data,R,h,h.getBodyColor(),k)}},v.createLineModel=function(k,F,g,j,v){var e=this,G=e.s,K=Fe(k,F,G(Vk)),d=G(j+".color");if(d){for(var Z=[],$=0;$<K.length;$++){var m=K[$],O=m.length;if(O>1){var T=m[0];Z.push(T.x,T.y,T.z);for(var q=1;O-1>q;q++)T=m[q],Z.push(T.x,T.y,T.z),Z.push(T.x,T.y,T.z);T=m[O-1],Z.push(T.x,T.y,T.z)}}var M,A,z,s=G(v),o=0;s&&(A=G(v+".color"),M=G(v+".pattern"),o=G(v+".offset"),z=d),yf(e.gv,e.data,Z,A||d,z?U:G(j+".gradient.color"),g,M||G(j+".pattern"),o,z)}return K},v.createTubeModel=function(f,K,j,s){for(var d=this,B=d.s,I=B("shape3d.side")||kj,o=B("shape3d.start.angle"),N=B("shape3d.sweep.angle"),L=B(qb)?B("shape3d.top.cap"):U,Z=B(Kk)?B("shape3d.bottom.cap"):U,c="flat"===L,m="flat"===Z,r=c&&(s?s.uv:B("shape3d.top.image")),e=m&&(s?s.uv:B("shape3d.bottom.image")),D=s?s.uv:B("shape3d.image"),x=B("shape3d.smooth"),M={vs:[],uv:D?[]:U,ns:x?[]:U,top_vs:c?[]:U,top_uv:r?[]:U,bottom_vs:m?[]:U,bottom_uv:e?[]:U},X=Fe(f,K,B(Vk),j),i=0,W=X.length;W>i;i++)Mi(M,X[i],B(ge),j,I,o,N,L,Z);return s?Mj(d.gv,d.data,M,d,d.getBodyColor(),d.mat?[d.mat]:[],s):d.shapeModel=M,d.lineShapeModel=M,X},v.getCache=function(){var T=this.info;if(T){var g=T.list;if(g){var O=T.cache;return O||(O=T.cache=Qc(g)),O}}return U}}});var ph=function(B,G){for(var n,$=0,Q=B.length,u=0,f=Q-1;f>=u;)if($=A(u+(f-u)/2),n=B[$].length-G,0>n)u=$+1;else{if(!(n>0)){f=$;break}f=$-1}$=f;var L=B[$],m=L.point;return $===Q-1||L.length===G||(m=(new bn).subVectors(B[$+1].point,m).normalize().multiplyScalar(G-L.length).add(m)),{point:m,tangent:L.tangent}},Qc=function(Z){for(var $,z,m=[],r=0,o=0;o<Z.length;o++){for(var D=Z[o],e=0;e<D.length;e++){$=D[e],z&&(r+=z.distanceTo($));var t=new bn,_=D[e+1];_?t.subVectors(_,$):z?t.subVectors($,z):t.x=1,t.normalize(),m.push({point:$,length:r,tangent:t}),z=$}z=null}return m},Fe=function(E,s,H,i){H=H||Rq;for(var j=[],w=0,O=E.size();O>w;w++){var A=E.get(w);j.push(new bn(A.x,A.e||0,A.y))}s&&(gg(s)&&(s=s._as),s.length||(s=null));for(var p,u,W,l,M,t=[],q=[],h=0,V=0,F=s?s.length:O;F>V;V++){if(M=s?s[V]:0===V?1:2,1===M)t.push(W=[]),W.push(j[h++]);else if(2===M||5===M)if(l=2===M?j[h++]:W[0],i){var J=s?s[V+1]:F>V+1?2:U;if(2===J||5===J){var D=W[W.length-1],P=2===J?j[h]:W[0],c=(new bn).subVectors(D,l),_=(new bn).subVectors(P,l),v=c.length(),B=_.length();if(v&&B)if(i>v/2&&i>B/2)W.push(l);else for(c.multiplyScalar(x(i,v/2)/v).add(l),_.multiplyScalar(x(i,B/2)/B).add(l),p=new Qd(c,l,_).getPoints(H),u=0;H>=u;u++)W.push(p[u])}else W.push(l)}else W.push(l);else if(3===M)for(p=new Qd(W[W.length-1],j[h++],j[h++]).getPoints(H),u=1;H>=u;u++)W.push(p[u]);else if(4===M)for(p=new Yb(W[W.length-1],j[h++],j[h++],j[h++]).getPoints(H),u=1;H>=u;u++)W.push(p[u]);q.push(t.length,W.length)}return t.indexMark=q,t},qd=function(s){for(var Z,D,S=new bn,L=[],q=[],J=[],G=0,C=s.length;C>G;G++)Z=s[G],D=s[G+1],D?S.subVectors(D,Z):S.subVectors(Z,s[G-1]),L.push(S.normalize().clone());var h,E=new bn,O=new bn,Q=new Jc,W=1e-4,i=L[0],$=q[0]=new bn,d=J[0]=new bn;for(Math.abs(Math.abs(i.y)-1)<W?E.set(1,0,0):E.set(0,1,0),O.crossVectors(i,E).normalize(),$.crossVectors(i,O),d.crossVectors(i,$),G=1;C>G;G++)q[G]=q[G-1].clone(),J[G]=J[G-1].clone(),O.crossVectors(L[G-1],L[G]),O.length()>W&&(O.normalize(),h=z(If(L[G-1].dot(L[G]),-1,1)),q[G].applyMatrix4(Q.makeRotationAxis(O,h))),J[G].crossVectors(L[G],q[G]);
return{B:J,T:L,N:q}},Mi=function(){var u=function(N){for(var f=1;f<arguments.length;f++){var n=arguments[f];N.push(n.x,n.y,n.z)}},O=function(I){for(var H=1;H<arguments.length;H++){var c=arguments[H].uv;I.push(c[0],c[1])}},M=function(B){for(var L=1;L<arguments.length;L++){var e=arguments[L].ns;B.push(e[0],e[1],e[2])}},z=function(Z,L,x,N,M){var W=-N*b(M),J=N*_(M);return new bn(Z.x+W*x.x+J*L.x,Z.y+W*x.y+J*L.y,Z.z+W*x.z+J*L.z)},s=function(R,o,n,j,L,J,Y,K,x){Y=Y||t;for(var C,i=[],r=Y/L,C=x?new Cc:U,Z=0;L>=Z;Z++){var E=z(R,o,n,j,Z*r+J);i.push(E),K!=U&&(E.uv=[K,1-Z/L]),x&&(E.ns=C.subVectors(E,R).normalize().toArray())}return i},D=function(g,l,h,p,A,X,r,E,O){O=O||t;var N=l?g.top_vs:g.bottom_vs;if(N)for(var d=l?g.top_uv:g.bottom_uv,L=O/r,V=0;r>V;V++){var I,v;l?(I=V*L+E,v=(V+1)*L+E):(v=V*L+E,I=(V+1)*L+E),u(N,z(h,p,A,X,I),z(h,p,A,X,v),h),d&&d.push(.5-.5*b(I),.5-.5*_(I),.5-.5*b(v),.5-.5*_(v),.5,.5)}};return function(h,z,F,l,x,y,K,w,G){var X=z.length;if(X>1){var n,o,E,k,$,B,A,v=qd(z),q=v.T,f=v.N,d=v.B;"flat"===w&&D(h,!0,z[0],d[0],f[0],l,x,y,K),"flat"===G&&D(h,!1,z[X-1],d[X-1],f[X-1],l,x,y,K);var W,r,P=[],T=Q(x/2),p="round"===w,Y="round"===G,Z=z[0],R=q[0],H=d[0],N=f[0],e=z[X-1],b=q[X-1],g=d[X-1],C=f[X-1];if(p){for(E=1;T>=E;E++)f.splice(0,0,N),d.splice(0,0,H),q.splice(0,0,R),r=-E/T*l,z.splice(0,0,R.clone().multiplyScalar(r).add(Z)),P[T-E]=j(l*l-r*r);X+=T}if(Y){for(E=1;T>=E;E++)f.push(C),d.push(g),q.push(b),r=E/T*l,z.push(b.clone().multiplyScalar(r).add(e)),P[z.length-1]=j(l*l-r*r);X+=T}if(h.uv){var i=0,S=0,m=[];for(F&&(i=F),$=z[0],m[0]=0,E=1;X>E;E++)k=z[E],m[E]=$.distanceTo(k),$=k,F||(i+=m[E]);for(W=[],E=0;X>E;E++)S+=m[E],W[E]=i?S/i:0}var L=h.ns?!0:!1;for(E=0;X>E;E++){if(k=z[E],B=d[E],A=f[E],n=s(k,B,A,P[E]===c?l:P[E],x,y,K,W?W[E]:U,L),o)for(var I=0;x>I;I++){var J=o[I],t=o[I+1]||o[0],a=n[I],_=n[I+1]||n[0];u(h.vs,t,J,a,a,_,t),h.uv&&O(h.uv,t,J,a,a,_,t),L&&M(h.ns,t,J,a,a,_,t)}o=n}}}}();hn(G,{getLineLength:function(O){return O[O.length-1].length},getLineOffset:function(K,C){return ph(K,C)},getLineCacheInfo:function(N,$,D,J){return Qc(Fe(N,$,D,J))}});var Dc=C.graph3d.RenderLite={},Ql=new Array(0),bb=Dc.Buffer=function(O,T,D,B){this.gl=O,this.buffer=O.createBuffer(),this.type=T||O.ARRAY_BUFFER,this.drawType=B||O.STATIC_DRAW,this.data=Ql,D&&this.upload(D)};bb.prototype.upload=function(D,g,q){q||this.bind();var P=this.gl;D=D||this.data,g=g||0,this.data.byteLength>=D.byteLength?P.bufferSubData(this.type,g,D):P.bufferData(this.type,D,this.drawType),this.data=D},bb.prototype.bind=function(){var H=this.gl;H.bindBuffer(this.type,this.buffer)},bb.createVertexBuffer=function(Q,U,v){return new bb(Q,Q.ARRAY_BUFFER,U,v)},bb.createIndexBuffer=function(K,i,S){return new bb(K,K.ELEMENT_ARRAY_BUFFER,i,S)},bb.create=function(Y,h,n,_){return new bb(Y,h,_)},bb.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Vq=Dc.Shader=function(R,m,y){this.gl=R,this.program=Jd(R,m,y),this.attributes=zg(R,this.program);var J=Kp(R,this.program);this.uniforms=Dn(R,J)};Vq.prototype.bind=function(){this.gl.useProgram(this.program)},Vq.prototype.destroy=function(){this.gl};var Jd=function(y,Y,x){var A=Sq(y,y.VERTEX_SHADER,Y),r=Sq(y,y.FRAGMENT_SHADER,x),t=y.createProgram();return y.attachShader(t,A),y.attachShader(t,r),y.linkProgram(t),y.getProgramParameter(t,y.LINK_STATUS)||(xg("LINK","LITE",y.getProgramParameter(t,y.VALIDATE_STATUS),y.getError(),y.getProgramInfoLog(t)),y.deleteProgram(t),t=null),y.deleteShader(A),y.deleteShader(r),t},Sq=function(A,D,m){var Q=A.createShader(D);return A.shaderSource(Q,m),A.compileShader(Q),A.getShaderParameter(Q,A.COMPILE_STATUS)?Q:(xg("COMPILE","LITE",D,A.getError(),A.getShaderInfoLog(Q)),null)},Kp=function(g,E){for(var k={},X=g.getProgramParameter(E,g.ACTIVE_UNIFORMS),N=0;X>N;N++){var v=g.getActiveUniform(E,N),O=v.name.replace(/\[.*?\]/,""),D=Cr(g,v.type);k[O]={type:D,size:v.size,location:g.getUniformLocation(E,O),value:Jr(D,v.size)}}return k},zg=function(G,L){for(var i={},x=G.getProgramParameter(L,G.ACTIVE_ATTRIBUTES),F=0;x>F;F++){var K=G.getActiveAttrib(L,F),D=Cr(G,K.type);i[K.name]={type:D,size:Ck(D),gl:G,location:G.getAttribLocation(L,K.name),pointer:ko}}return i},ko=function(p,z,X,l,v){var a=this.gl;a.enableVertexAttribArray(this.location),p instanceof Dc.Buffer||(p=Dc.Buffer.createVertexBuffer(a,p)),a.bindBuffer(p.type,p.buffer),a.vertexAttribPointer(this.location,this.size,z||a.FLOAT,X||!1,l||0,v||0)},Ck=function(J){return jd[J]},jd={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},Cr=function(D,A){if(!wh){var E=g.keys(_b);wh={};for(var I=0;I<E.length;++I){var s=E[I];wh[D[s]]=_b[s]}}return wh[A]},wh=null,_b={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Jr=function(M,L){switch(M){case"float":return 0;case"vec2":return new Float32Array(2*L);case"vec3":return new Float32Array(3*L);case"vec4":return new Float32Array(4*L);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*L);case"ivec3":return new Int32Array(3*L);case"ivec4":return new Int32Array(4*L);case"bool":return!1;case"bvec2":return Fr(2*L);case"bvec3":return Fr(3*L);case"bvec4":return Fr(4*L);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Fr=function(A){for(var f=new Array(A),X=0;X<f.length;X++)f[X]=!1;return f},Dn=function(w,B){var K={data:{}};K.gl=w;for(var j=g.keys(B),C=0;C<j.length;C++){var N=j[C],x=N.split("."),P=x[x.length-1],U=rf(x,K),J=B[N];U.data[P]=J,U.gl=w,g.defineProperty(U,P,{get:Lg(P),set:ir(P,J)})}return K},Lg=function(H){var x=xi.replace("%%",H);return new Function(x)},ir=function(n,v){var K,k=so.replace(/%%/g,n);return K=1===v.size?Nr[v.type]:xh[v.type],K&&(k+="\nthis.gl."+K+";"),new Function("value",k)},rf=function(p,R){for(var I=R,u=0;u<p.length-1;u++){var s=I[p[u]]||{data:{}};I[p[u]]=s,I=s}return I},xi=["return this.data.%%.value;"].join("\n"),so=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),Nr={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},xh={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},Id=function(K){function b(k){if("string"!=typeof k)return 0|k;switch(k){case"low":return 512;case"medium":return 1024;case"ultra":return 4096;default:return 2048}}var P=this;P.enable=!1;var w,d,J,v,x=G.graph3dViewShadowType,Y=G.graph3dViewShadowIntensity,z=G.graph3dViewShadowBias,A=G.graph3dViewShadowQuality,T=G.graph3dViewShadowRadius,M=G.graph3dViewShadowDegreeX,F=G.graph3dViewShadowDegreeZ,L=1,s=b(A),X=!1,l=new C.Math.Matrix4,B=new C.Math.Matrix4,I=P.pvMatrix=new C.Math.Matrix4;P.render=function(){if(!K._picking&&P.enable){var m=K.getGL();if(m){if(X&&P.setupShadowCamera(),K._glCapabilities&&(s=Math.min(s,K._glCapabilities.maxTextureSize)),P.map?w.setSize(s,s):w=P.map=new Ii(K,K.getGL(),0,0,{samples:1,minFilter:Gp.NEAREST,magFilter:Gp.NEAREST,width:s,height:s}),!m._shadowShader){var u="#define MAX_BOX_CLIPPER "+K._boxClippers.length;m._shadowShader=new Dc.Shader(m,Id.shaderSrc.vs.replace("$DEFINE",u),Id.shaderSrc.fs.replace("$DEFINE",u))}var t=K._frameState,h=t.renderState.glState;h.blend.enabled=!1,h.depth.enabled=!0,h.depth.mask=!0;var I=h.color.clear.slice(0);fo(m,[1,1,1,1]),t.renderState.useProgram(m._shadowShader.program),n(),fo(m,I)}}},P.deleteShadowProgram=function(){var Y=K.getGL();Y&&Y._shadowShader&&(Y.deleteProgram(Y._shadowShader.program),Y._shadowShader=null)},P.getShadow=function(){var i={degreeX:M,degreeZ:F,intensity:Y,quality:A,type:x,radius:T,bias:z};return 1!==L&&(i.boundExtend=L),i},P.setShadow=function(Z,u){Z=!!Z;var S=P.enable!==Z;P.enable=Z,"object"==typeof u&&(u.intensity!==c&&(Y=u.intensity),u.bias!==c&&(z=u.bias),u.radius!==c&&(T=u.radius),u.degreeX!==c&&(M=u.degreeX),u.degreeZ!==c&&(F=u.degreeZ),u.quality!==c&&(A=u.quality),u.type!==c&&x!==u.type&&(x=u.type,S=!0),s=b(A),u.boundExtend!==c&&(L=u.boundExtend)),Z&&P.setupShadowCamera(),S&&Wf(K),K.iv()},P.refresh=function(){this.enable&&(this.setupShadowCamera(),K.iv())},P.tryUpdateBounding=function(S){var c=this.boundingSphere;if(c){var p=(new Jc).fromArray(Jl(S,K.getMat(S))),q=S.getAnchor3d(),t=new Cc;c.containsPoint(t.set(0-q.x,0-q.y,0-q.z).applyMatrix4(p))&&c.containsPoint(t.set(0-q.x,0-q.y,1-q.z).applyMatrix4(p))&&c.containsPoint(t.set(0-q.x,1-q.y,0-q.z).applyMatrix4(p))&&c.containsPoint(t.set(0-q.x,1-q.y,1-q.z).applyMatrix4(p))&&c.containsPoint(t.set(1-q.x,0-q.y,0-q.z).applyMatrix4(p))&&c.containsPoint(t.set(1-q.x,0-q.y,1-q.z).applyMatrix4(p))&&c.containsPoint(t.set(1-q.x,1-q.y,0-q.z).applyMatrix4(p))&&c.containsPoint(t.set(1-q.x,1-q.y,1-q.z).applyMatrix4(p))||P.setupShadowCamera()}},P.createShadow=function(R){R||(R=K._frameState.renderState.directUniforms()),R.shadowMatrix=I.toArray(),R.shadowMap=w.texture,R.shadowSize=[w.width,w.height],R.shadowIntensity=Y,R.shadowBias=z,R.shadowRadius=T},P.genShaderDefine=function(){var n="#define USE_SHADOWMAP\n";return"hard"===x?n+="#define SHADOWMAP_TYPE_PCF\n":"soft"===x&&(n+=K.isGLTempRegisterLimited()?"#define SHADOWMAP_TYPE_PCF\n":"#define SHADOWMAP_TYPE_PCF_SOFT\n"),n};var g;P.setupShadowCamera=function(){d||(d=P.boundingSphere=new C.Math.Sphere),X=!1;var s,B,q=K.getBoundingBox(K.dm().toDatas(function(M){return M.s("shadow.cast")&&K.isVisible(M)}));q?(s=new Cc(q.min),B=new Cc(q.max)):(s=new Cc(-256,-256,-256),B=new Cc(256,256,256),X=!0),d.set(s.clone().add(B).multiplyScalar(.5),.5*s.distanceTo(B)*L);var h,$=d.radius,V=K.getBoundingBox(K.dm().toDatas(function(S){return(S.s("shadow.cast")||S.s("shadow.receive"))&&K.isVisible(S)}));if(V){s.copy(V.min),B.copy(V.max);var H=.5*s.distanceTo(B);h=H+Math.min(H,$+d.center.distanceTo(s.add(B).multiplyScalar(.5)))}else h=2*$;g=cb(Tj(),-$,$,-$,$,h/1e3,h),I.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),I.multiply(l.fromArray(g));var S=Math.tan(-M*Math.PI/180),R=Math.tan(-F*Math.PI/180),Q=$/Math.sqrt(S*S+R*R+1),A=new Cc(Q*S,Q,Q*R);l.lookAt(A,new Cc(0,0,0),new Cc(0,1,0)).setPosition(A.add(d.center)),l.getInverse(l),I.multiply(l)};var n=function(){var O=K.getGL(),u=s,Y=s;w.setSize(O,u,Y),w.bind(O),O.clear(Gp.COLOR_BUFFER_BIT|Gp.DEPTH_BUFFER_BIT);var U=K._frameState,x=U.renderState,e=x.directUniforms(),A=x.directAttribs(),o=x.directState();e.projectionMatrix=g,(J=K._boxClippers.length>0)&&(e.uEnableBoxClip=!1,e.uClipperMatrix=K._boxClipperMatrixes,e.uClipperClipInner=K._boxClipperClipInner),v=K.isReflecting(O);var W=K._viewport;K.setViewport(O,0,0,u,Y);var F,y,l,Z;for(F=0,y=Lq.length;y>F;F++)if(l=Lq[F],!In[l].ignore&&(Z=K._40Q.get(l))){var m=Z.batchIndexMap;P.renderItems(O,e,A,o,Z.opaque,m),P.renderItems(O,e,A,o,Z.transparent,m),P.renderBatch(O,e,A,o,Z.batchModelMap,m)}w.unbind(O),K.setViewport(O,W[0],W[1],W[2],W[3])};P._renderDirect=function(A,i,z,b){z&&z.length&&(i.position=og(A,K._buffer.vs,z,U),b?(yn(A,K._buffer.is,b),Ke(A,0,b.length,null,b instanceof Uint32Array?A.UNSIGNED_INT:null)):Kg(A,0,z.length/3))},P.renderShapeModel=function(d,L,J,$){var Q,N,m;if(zo(J))for(N=0,m=J.length;m>N;N++)Q=J[N],Q&&P.renderShapeModel(d,L,Q,$);else ak(J)?P.renderShapeModel(d,L,Bq($,J),$):jb(J)&&(J.shape3d?P.renderShapeModel(d,L,J.shape3d,$):P.renderShapeModelImpl(d,L,J))},P.renderShapeModelImpl=function(I,o,Z){Tl(Z),P._renderDirect(I,o,Z.vs,Z.is),P._renderDirect(I,o,Z.top_vs,Z.top_is),P._renderDirect(I,o,Z.bottom_vs,Z.bottom_is),P._renderDirect(I,o,Z.from_vs,Z.from_is),P._renderDirect(I,o,Z.to_vs,Z.to_is)},P.renderBatch=function($,I,G,z,t){if(!bi(t)&&!K.drawFilter){I.modelViewMatrix=B.identity().premultiply(l).toArray();var u,H,c;for(u in t)c=K.getBatchInfo(u)||oc,c.visible!==!1&&c.shadowCast!==!1&&(v&&c.reflectable===!1||(H=t[u],H.invalidate&&Hl(H),J&&(I.uEnableBoxClip=c.clipboxEnabled!==!1),P._renderDirect($,G,H.vs32,H.is)))}},P.renderItems=function(j,x,m,E,X,Z){var G,k,W,Q,S,t,Y=X.length;for(G=0;Y>G;G++)if(k=X[G],Q=k.ui,W=k.data,!(Xc(W)||!W.s("shadow.cast")||W instanceof jq||!K.isVisible(W)||Z[W._id]||v&&W.s("3d.reflectable")===!1)){var $=Q.s("3d.clip.direction");if($){var s=Q.s("3d.clip.percentage");if(0===s)continue;var o=Q._formatClipUniforms($,s,W);x.uClipPercent=o[1],x.uClipDirection=o[0]}else x.uClipDirection=0;S=Q.shapeModel||Bq(Q),S||(S=W instanceof C.Node&&!(W instanceof C.Shape)?{vs:cd,is:Tn}:[Q.left,Q.front,Q.right,Q.back,Q.top,Q.bottom]),t=Q.mat?B.fromArray(Q.mat):B.identity(),J&&(x.modelMatrix=t.toArray(),x.uEnableBoxClip=W.s("3d.clipbox.enabled")&&!W.s("3d.clipbox")),x.modelViewMatrix=t.premultiply(l).toArray(),E.cullFace.enabled=!!W.s("shape3d.reverse.cull"),P.renderShapeModel(j,m,S,Q)}}};Id.shaderSrc={vs:["$DEFINE","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","attribute vec3 position;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform mat4 modelMatrix;","varying vec3 vWorld;","\n #endif \n","varying vec3 vPosition;","void main() {","vec3 transformed = vec3( position );","vPosition = vec3(position);","vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );","\n #if MAX_BOX_CLIPPER > 0 \n","vWorld = vec3(modelMatrix * vec4(transformed, 1.0));","\n #endif \n","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fs:["$DEFINE","precision highp float;","const float PackUpscale = 256. / 255.;","const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );","const float ShiftRight8 = 1. / 256.;","varying vec3 vPosition;","uniform int uClipDirection;","uniform float uClipPercent;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform bool uEnableBoxClip;","uniform bool uClipperClipInner[MAX_BOX_CLIPPER];","uniform mat4 uClipperMatrix[MAX_BOX_CLIPPER];","const vec3 clipMin = vec3(-0.5, -0.5, -0.5);","const vec3 clipMax = vec3(0.5, 0.5, 0.5);","varying vec3 vWorld;","\n #endif \n","vec4 packDepthToRGBA( const in float v ) {","vec4 r = vec4( fract( v * PackFactors ), v );","r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;","}","void main() {","if (uClipDirection > 0) {","vec3 dir = vec3(0.0, 0.0, 0.0);","if (uClipDirection < 2) { dir.x = 1.0; }","else if (uClipDirection < 3) { dir.x = -1.0; }","else if (uClipDirection < 4) { dir.y = 1.0; }","else if (uClipDirection < 5) { dir.y = -1.0; }","else if (uClipDirection < 6) { dir.z = 1.0; }","else if (uClipDirection < 7) { dir.z = -1.0; }","if (dot(dir, vPosition) > dot(vec3(uClipPercent), dir)) { discard; }","}","\n #if MAX_BOX_CLIPPER > 0 \n","if (uEnableBoxClip) {","vec3 vLocal;","for(int i=0; i < MAX_BOX_CLIPPER; i++) {","vLocal = vec3(uClipperMatrix[i] * vec4(vWorld, 1.0));","if (uClipperClipInner[i] != (all(lessThan(vLocal, clipMax)) && all(greaterThan(vLocal, clipMin)))) { discard; return; }","}","}","\n #endif \n","gl_FragColor = packDepthToRGBA( gl_FragCoord.z );","}"].join("\n")},Id.PARAMS=["quality","intensity","bias","radius","type","degree.x","degree.z"];var Af=function(K){function q(J,v,M,D,R){var E=K.getData3dUI(M),H=E.s("shape3d");if("billboard"===H||"plane"===H){var y;(y=X[v])||(y=X[v]=new Ii(K));var q=M.s("effect.flow.size"),o=M.s("effect.flow.uvshape");y.setSize(J,q,q),y.bind(J);var P=K.getViewport(J);K.setViewport(J,0,0,q,q),J.clear(J.COLOR_BUFFER_BIT|J.DEPTH_BUFFER_BIT);var r,E=K.getData3dUI(M),V=Bq(E,H);if(!V)return!1;!V.ns&&V.length&&(V=V[0]),r=V.vs;var A,l=M.s("effect.flow.gradient");if(l){if(A="Flow3d.Cached."+l,!C.Default.getImage(A)){var T=100;C.Default.setImage(A,C.Default.toCanvas({width:T,height:T,comps:[{type:"rect",background:"rgb(0,0,0)",gradient:l,rect:[0,0,T,T]}]},T,T))}}else A=M.s("shape3d.image");D.useXZ="plane"===H,D.image=K.getTexture(A,M),D.uvMatrix=Km(E.s("shape3d.uv.rotation"),E.s("shape3d.uv.offset"),E.s("shape3d.uv.scale"),O).toArray9();var F=z.indexOf(o);-1===F&&0===o.indexOf("polygon")&&(F=xl(1*o.substring(7),3,1024)-1),D.shape=F,R.position=og(J,null,r,U,3),Kg(J,0,r.length/3),y.unbind(J),K.setViewport(J,P[0],P[1],P[2],P[3]);var k=M.getMatrix4();k.getInverse(k);var Q=k.getElements();"plane"===H?Q[1]=Q[5]=Q[9]=Q[13]=0:Q[2]=Q[6]=Q[10]=Q[14]=0,n[v]={matrix:k,group:M.s("effect.flow.group")}}}var O,A=this,X=this.renderTargetPool=[],n=[],z=["rect","circle","polygon"];A.render=function(){if(!K._picking){var G=K._flowObjects;if(G.length){var P=K.getGL();if(P){var L;(L=P._flowShader)||(L=P._flowShader=new Dc.Shader(P,Af.shaderSrc.vs,Af.shaderSrc.fs));var F=K._frameState.renderState,u=F.glState;u.blend.enabled=!1,u.depth.enabled=!1;var o=u.color.clear.slice(0);fo(P,[0,0,0,1]),F.useProgram(L.program);var d,E,H=F.directUniforms(),Q=F.directAttribs();for(d=0,E=G.length;E>d;d++)q(P,d,G[d],H,Q);fo(P,o),X.length!==E&&X.splice(E,X.length-E)}}}},A.createFlow=function(M){var Z;if(Z=X.length){M||(M=K._frameState.renderState.directUniforms());for(var G=[],R=[],V=[],t=0;Z>t;t++)G[t]=n[t].matrix.toArray(),R[t]=X[t].texture,V[t]=!1;M.flowMatrix=G,M.flowTexture=R,M.flowEnabled=V}},A.disableFlow=function(f){var w;if(w=X.length){f||(f=K._frameState.renderState.directUniforms());for(var B=[],M=0;w>M;M++)B[M]=!1;f.flowEnabled=B}},A.resetDataFlowEnabld=function(a,c){var W=a.s("effect.flow.mask"),r=X.length,Y=new Array(r);if(W)for(var e=0;r>e;e++)W&1<<n[e].group&&(Y[e]=!0);c.flowEnabled=Y}};Af.shaderSrc={vs:["uniform bool useXZ;","attribute vec3 position;","varying vec2 vUv;","void main() {","if (useXZ) vUv = vec2(position.x, position.z);","else vUv = vec2(position.x, position.y);","gl_Position = vec4(vUv * 2.0, 0.0, 1.0);","}"].join("\n"),fs:["precision highp float;","const float pi2 = 6.2831853;","uniform sampler2D image;","uniform mat3 uvMatrix;","uniform int shape;","varying vec2 vUv;","void main() {","vec2 uv;","float angle = atan(vUv.y, vUv.x) / pi2 + 0.5;","if (shape == 0) {","uv = vUv + 0.5;","}","else if (shape == 1) {","uv = vec2(length(vUv) * 2.0, angle);","}","else {","float step = 1.0 / float(shape + 1);","float modAngle = mod(angle, step) - step * 0.5;","uv = vec2(length(vUv) * 2.0 * cos(modAngle * pi2) , angle);","}","gl_FragColor = texture2D(image, vec2((uvMatrix * vec3(uv, 1.0)).xy));","}"].join("\n")};var sp=function(j){this.gv=j,this.onMouseOver=this.onMouseOver.bind(this),this.mode=sp.Mode.Style,this.type=Y["highlight.type"],this.color=Y["highlight.color"],this.width=Y["highlight.width"],this.glow=Y["highlight.glow"],this.strength=Y["highlight.strength"]};sp.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},Gg.ms_highlight=function(s){s.setHighlightMode=function(b){var k;k="selection"===b||"selected"===b?sp.Mode.Selection:"mouseover"===b||"hover"===b?sp.Mode.MouseOver:"style"===b?sp.Mode.Style:sp.Mode.Disable;var I=this.getHighlightMode();this._highlightHelper.mode=k,this.firePropertyChange("highlightMode",I,b)},s.getHighlightMode=function(){var F=this._highlightHelper.mode;return F===sp.Mode.Selection?"selected":F===sp.Mode.MouseOver?"hover":F===sp.Mode.Style?"style":"disabled"},["type","color","width","glow","strength"].forEach(function(P){var B=P.replace(/(^|\.)[a-z]/g,function(l){return l[l.length-1].toUpperCase()});s["getHighlight"+B]=function(){return this._highlightHelper[P]},s["setHighlight"+B]=function(v){var L=this._highlightHelper,C=L[P];v!==C&&(L[P]=v,this.firePropertyChange("highlight"+B,C,v))}})},Bb(sp,g,{onMouseOver:function(r){G.preventDefault(r);var u=this.gv;if(!u._48Q){var e=u.getDataAt(r);e!==this.mouseOverData&&(this.mouseOverData=e,u.iv())}},setFetchTargetFunc:function(V){this.fetchTargetFunc=V},_42:function(j,J){var W,m,g=this,F=g._mode,P=g.gv;if(!j._renderInfo.reflectDepth&&F!==sp.Mode.Disable){if(F===sp.Mode.Selection?W=P.sm().getSelection().toArray(function(x){return x.s("highlight.visible")}):F===sp.Mode.MouseOver&&g.mouseOverData&&g.mouseOverData.s("highlight.visible")&&(W=[g.mouseOverData]),g.fetchTargetFunc&&(W=g.fetchTargetFunc(W)),F===sp.Mode.Style)W=W||[],m=function(B){if(W.indexOf(B)>=0)return!1;var Y=P.getDataHighlightMode(B);return Y===!1?!0:Y===!0?!1:"selected"===Y?P.isSelected(B)?!1:!0:"hover"===Y?B===g.mouseOverData?!1:!0:!0};else{if(!W||!W.length)return;m=function(I){return W.indexOf(I)<0?!0:void 0}}var r=P.isVRPresenting(),O=P.getWidth();if(r){var c=P.getWidth;O/=2,P.getWidth=function(){return O};var t=P.getViewport()}var h,L=P.getDevicePixelRatio(),e=Math.floor(O*L),d=Math.floor(P.getHeight()*L);(h=g._renderTarget)?h.setSize(j,e,d):g._renderTarget=h=new Vf.RenderTarget(P,j,e,d);var Z="soft"===g.type;if(h.bind(j),Z){var u=j.getParameter(j.COLOR_CLEAR_VALUE);fo(j,[1,1,1,1]),j.clear(j.COLOR_BUFFER_BIT),fo(j,u)}else j.clear(j.COLOR_BUFFER_BIT);P.setViewport(j,0,0,e,d),P.drawFilter=m,km=function(I,k,x,d,U,N){var E=[x?0:1,1,1,1];return N||(Ph.for(I).directUniforms().uFixPickReverseColor=E),E},P.renderPickScene(),km=mg,P.drawFilter=null,h.unbind(j),ze&&Do(j,J.aPosition),Do(j,J.aNormal),r&&(P.getWidth=c,P.setViewport(j,t[0],t[1],t[2],t[3]));var y=P.getHighlightColor();if(g._lastHighlightColor!==y){var f=Ie(g._lastHighlightColor=y);g._highlightColorData=[f[0]/255,f[1]/255,f[2]/255,f[3]/255]}return Z?g.renderSoftOutline(j,e,d):g.renderHardOutline(j,e,d),j.useProgram(J=P._prg),ze&&gj(j,J.aPosition),!0}},_assureShader:function(x,O){var H=x._compiledShader[O];return H||(H=x._compiledShader[O]=new Dc.Shader(x,sp.CommonShaderVs,sp[O].fs)),H},renderHardOutline:function(Y,h,G){var o=this,t=o.gv,c=t._postProcessing,s=Ph.for(Y),T=s.directState();T.blend.enabled=!0,T.depth.enabled=!1,c.blitScreen(null,o._renderTarget.texture,o._assureShader(Y,"HighlightHard"),{textureSize:[h,G],edgeWidth:t.getHighlightWidth(),edgeColor:o._highlightColorData},{clear:!1}),T.blend.enabled=!1,T.depth.enabled=!0},renderSoftOutline:function(_,g,J){var u,Z,K,r,M,X=this,S=X.gv,E=S._postProcessing,i=Math.floor(g/2),w=Math.floor(J/2),f=Math.floor(g/4),D=Math.floor(J/4),x=X._downSampleRenderTarget;x?(u=X._edgeDetectionRenderTarget,Z=X._blurV2,K=X._blurH2,r=X._blurV4,M=X._blurH4,(x.width!==i||x.height!==w)&&(x.setSize(i,w),u.setSize(i,w),Z.setSize(i,w),K.setSize(i,w),r.setSize(f,D),M.setSize(f,D))):(x=X._downSampleRenderTarget=new Vf.RenderTarget(S,_,i,w),u=X._edgeDetectionRenderTarget=new Vf.RenderTarget(S,_,i,w),Z=X._blurV2=new Vf.RenderTarget(S,_,i,w),K=X._blurH2=new Vf.RenderTarget(S,_,i,w),r=X._blurV4=new Vf.RenderTarget(S,_,f,D),M=X._blurH4=new Vf.RenderTarget(S,_,f,D));var F=_.getParameter(_.COLOR_CLEAR_VALUE),k=S.getViewport(),z=X.width,a=X.strength,G=X.glow,h=Ph.for(_).glState,d=h.depth,t=h.blend,V=d.enabled;fo(_,[1,1,1,1]),d.enabled=!1,t.apply({func:[_.SRC_ALPHA,_.ONE]}),E.blitScreen(x,X._renderTarget.texture),E.blitScreen(u,x.texture,X._assureShader(_,"EdgeDetection"),{texSize:[i,w],color:X._highlightColorData}),E.blitScreen(K,u.texture,X._assureShader(_,"Blur"),{direction:[1,0],texSize:[i,w],radius:z}),E.blitScreen(Z,K.texture,X._assureShader(_,"Blur"),{direction:[0,1],texSize:[i,w],radius:z}),E.blitScreen(M,Z.texture,X._assureShader(_,"Blur"),{direction:[1,0],texSize:[f,D],radius:z}),E.blitScreen(r,M.texture,X._assureShader(_,"Blur"),{direction:[0,1],texSize:[f,D],radius:z}),t.apply({enabled:!0}),S.setViewport(_,k[0],k[1],k[2],k[3]),E.blitScreen(null,X._renderTarget.texture,X._assureShader(_,"BlendTogether"),{edgeTexture1:Z.texture,edgeTexture2:r.texture,edgeStrength:a*z,edgeGlow:G},{clear:!1}),t.apply({func:[_.SRC_ALPHA,_.ONE_MINUS_SRC_ALPHA,_.ONE,_.ONE_MINUS_SRC_ALPHA]}),d.enabled=V,fo(_,F)}}),g.defineProperties(sp.prototype,{mode:{get:function(){return this._mode},set:function(_){var c=this._mode;if(_!==c){this._mode=_;var L=c===sp.Mode.MouseOver||c===sp.Mode.Style,e=_===sp.Mode.MouseOver||_===sp.Mode.Style;e&&L||(L&&h(this.gv.getView(),"mousemove",this.onMouseOver),e&&d(this.gv.getView(),"mousemove",this.onMouseOver))}}}}),sp.CommonShaderVs=["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),sp.HighlightHard={fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},sp.EdgeDetection={fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","uniform vec2 texSize;","uniform vec4 color;","void main() {","vec2 invSize = 1.0 / texSize;","vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);","vec4 c1 = texture2D( image, vUv + uvOffset.xy);","vec4 c2 = texture2D( image, vUv - uvOffset.xy);","vec4 c3 = texture2D( image, vUv + uvOffset.yw);","vec4 c4 = texture2D( image, vUv - uvOffset.yw);","float diff1 = (c1.r - c2.r)*0.5;","float diff2 = (c3.r - c4.r)*0.5;","float d = length( vec2(diff1, diff2) );","gl_FragColor = color * vec4(d);","}"].join("\n")},sp.Blur={fs:["#define MAX_RADIUS 4","precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform vec2 texSize;","uniform vec2 direction;","uniform float radius;","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float weightSum = gaussianPdf(0.0, radius);","vec4 diffuseSum = texture2D( image, vUv) * weightSum;","vec2 delta = direction * invSize * radius/float(MAX_RADIUS);","vec2 uvOffset = delta;","for( int i = 1; i <= MAX_RADIUS; i ++ ) {","float w = gaussianPdf(uvOffset.x, radius);","vec4 sample1 = texture2D( image, vUv + uvOffset);","vec4 sample2 = texture2D( image, vUv - uvOffset);","diffuseSum += ((sample1 + sample2) * w);","weightSum += (2.0 * w);","uvOffset += delta;","}","gl_FragColor = diffuseSum/weightSum;","}"].join("\n")},sp.BlendTogether={fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform sampler2D edgeTexture1;","uniform sampler2D edgeTexture2;","uniform float edgeStrength;","uniform float edgeGlow;","void main() {","vec4 edgeValue1 = texture2D(edgeTexture1, vUv);","vec4 edgeValue2 = texture2D(edgeTexture2, vUv);","vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;","float vv = texture2D(image, vUv).r;","vec4 finalColor = edgeStrength * vv * edgeValue;","gl_FragColor = finalColor;","}"].join("\n")};var an=C.Light=function(){Zn(an,this),this.s(Bf,Y[Bf]),this.s(_q,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};ub("Light",Hh,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(A,g,k){an.superClass.onStyleChanged.apply(this,arguments),A===Bf&&this.s("shape3d.color",k)}});var $c=Vf.FrameState=function(F,$){this.renderState=Ph.for($),this.picking=!1,this.envmapReflectivity=.5,this.cameraPosition=c,this.projectMatrix=c,this.viewMatrix=c,this.view=F,this.defaultProgram=c,this.pickColorMap=c,this._pvStack=[],this._renderStateStack=[]};$c.prototype.savePV=function(){var v=this.view;this._pvStack.push([md(this.projectMatrix),md(this.viewMatrix),v._18Q,md(v._7O)])},$c.prototype.restorePV=function(){var d=this._pvStack.pop();if(d){var G=this.view;this.projectMatrix=G._projectMatrix=d[0],this.viewMatrix=G._viewMatrix=d[1],G._18Q=d[2],G._7O=d[3]}},$c.prototype.setPV=function(B,S){var M=this.view,q=!1;if(B&&(this.projectMatrix=M._projectMatrix=B,q=!0),S&&(this.viewMatrix=M._viewMatrix=S,M._7O=md(S),q=!0),q){var Y=M.getWidth(),K=M.getHeight(),h=md(this.projectMatrix);M._18Q=Lo(h,h,S),M._18Q._wh=Y/K}},$c.prototype.syncEnv=function(_){var Z=this,I=Z.view;Z.envmapReflectivity=I._envmapReflectivity||.5,Z.cameraPosition=I.getEye(),Z.projectMatrix=I._projectMatrix,Z.viewMatrix=I._viewMatrix,Z.pickColorMap=_,Z.picking=I.getGL()._picking},$c.prototype.setGLState=function(){var G=[0,0,0,0],e=[!0,!0,!0,!0],H=[-1,1],C=[Gp.FUNC_ADD,Gp.FUNC_ADD],f=[Gp.SRC_ALPHA,Gp.ONE_MINUS_SRC_ALPHA,Gp.ONE,Gp.ONE_MINUS_SRC_ALPHA];return function(A,h){var m=this,V=m.renderState.gl,s=m.renderState.glState;s.dither=!1,h?s.color.mask=e:s.color.reset(),s.pixelStore.reset(),s.blend.color=G,s.blend.equation=C,s.blend.func=f,s.cullFace.enabled=!1,s.scissor.enabled=!1,s.depth.enabled=!0,s.depth.clear=1,s.depth.func=V.LEQUAL,s.depth.range=H,s.stencil.enabled=!1,s.polygonOffset.enabled=!1,A?(s.depth.mask=!1,s.blend.enabled=!0):(s.depth.mask=!0,s.blend.enabled=!1)}}(),$c.prototype.setUniforms=function(e){var t=this,x=t.view,u=t.renderState,Z=u.gl,O=u.uniforms;O.uBrightness=1,O.uOpacity=1,O.uPartOpacity=1,O.uPick=t.picking,O.uTexture=!1,O.uBlendTexture=!1,O.uAlphaTest=Y.alphaTest,O.uTransparent=!!e,O.uFix=!1,O.uBatchColor=!1,O.uBatchBlend=!1,O.uBatchBrightness=!1,O.uReflectivity=t.envmapReflectivity||.5,O.uCameraPosition=t.cameraPosition,O.uPMatrix=t.projectMatrix,O.uViewMatrix=t.viewMatrix,O.uEnvMap=null,O.uEnableBoxClip=!1,O.uClipperMatrix=x._boxClipperMatrixes,O.uClipperClipInner=x._boxClipperClipInner,x._envmapRenderer.resetUniformCache(),t.picking||(vo(x,Z,c),x._fogDisabled||(O.uFogColor=x._fogColor,O.uFogDensity=x._fogDensity,O.uFogNear=x._fogNear,O.uFogFar=x._fogFar))},$c.prototype.drawLayer=function(y){return this.view.renderLayers(y,!0)},$c.prototype.drawData=function(S,X,L){var y=this.view;if(y.isVisible(S)){var v=this.renderState,b=v.uniforms,h=y.getData3dUI(S);if(h){var Y=v.gl,Z=Y._picking,c=y._picking,A=S._pickId;L&&(S._pickId=L),b.uPick=Y._picking=y._picking=!!L,b.uTransparent=!!X,h._42(v.gl,v.program,X?M:D),b.uPick=Y._picking=Z,y._picking=c,S._pickId=A}}};var Qm=Vf.Graph3dView=function(w,q){var F=this;F._webGLVersion=1,F._attributes=q||G.graph3dViewAttributes,F._25I={},F._view=np(1,F);var p=F._canvas=Nb(F._view);d(p,"webglcontextlost",function(A){A.preventDefault(),Wf(F),F._26I&&F._doBufferGC(F._26I,!0),F._26I=U,F._1o.onContextLost(),F._35O=!0}),d(p,"webglcontextrestored",function(){F._35O=!1,F.iv()}),F._40Q=new Ab,F._43Q={},F._44Q=-1,F._batchIndexMap={},F._batchModelMap={},F._wireframeIndexMap={},F._wireframeModelMap={},F._wireframeIndexMapSwap={},F._wireframeModelMapSwap={},F._polylineIndexMap={},F._polylineIndexMap={},F._polylineIndexMapSwap={},F._polylineIndexMapSwap={},F._8O=[],F._7O=Tj(),F._6O=Tj(),F._1o=new lq(F),F._30O=new Fs(F),F._31O=new Ds(F),F._32O=new Es(F),F._raycaster=new Qs(F),F._highlightHelper=new sp(F),F._postProcessing=new $s(F),F._41Q=[],F._42Q=0,F._frameRenderOptionStack=[],Vf.VR?(F.vr=new Vf.VR(F),F.isVREnabled=function(){return this.vr.enable
},F.isVRPresenting=function(){return this.vr.isPresenting()}):(F.vr={enable:!1,isPresenting:R},F.isVREnabled=R,F.isVRPresenting=R),F.shadowMap=new Id(F),F.flowMap=new Af(F),F._33Q=!0,F._eye=ns(G.graph3dViewEye),F._center=ns(G.graph3dViewCenter),F._up=ns(G.graph3dViewUp),F._lightChanged=!1,F._59O=[],F._spots=[],F._dirs=[],F._boxClippers=[],F._flowObjects=[],F._frameId=0,F._picking=!1,F._batchInfoMap={},F.overlappingBox=new El(F),F.dm(w?w:new sm),F._coreInteractor=new Dm(this),F._envmapRenderer=new Vf.EnvmapRenderer(this),F.setInteractors([new Lf(F)]),F._initView()},Te={fogDisabled:1,fogMode:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},Xm=0;Sc("Graph3dView",g,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_shadow:1,ms_highlight:1,ms_quickVisible:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",oq,_m,"firstPersonMode",Wm,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","headlightGroup","ortho","orthoWidth","syncEyeWithOrthoWidth","fovy","near","far",wi,Rp,"up","aspect","fogDisabled","fogMode","fogDensity","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay","batchInfoMap","rotateMinPhi","rotateMaxPhi","sortable","sortFunc"],_editable:!1,_sortable:G.graph3dViewSortable,_editHelperDisabled:G.graph3dViewEditHelperDisabled,_blockSelectable:G.graph3dViewBlockSelectable,_devicePixelRatio:c,_boundaries:c,_moveStep:G.graph3dViewMoveStep,_rotateStep:G.graph3dViewRotateStep,_rotateMinPhi:G.graph3dViewMinPhi===c?G.graph3dViewRotateMinPhi:G.graph3dViewMinPhi,_rotateMaxPhi:G.graph3dViewMaxPhi===c?G.graph3dViewRotateMaxPhi:G.graph3dViewMaxPhi,_pannable:G.graph3dViewPannable,_rotatable:G.graph3dViewRotatable,_walkable:G.graph3dViewWalkable,_resettable:G.graph3dViewResettable,_zoomable:G.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:G.graph3dViewFirstPersonMode,_mouseRoamable:G.graph3dViewMouseRoamable,_gridVisible:G.graph3dViewGridVisible,_gridSize:G.graph3dViewGridSize,_gridGap:G.graph3dViewGridGap,_gridColor:G.graph3dViewGridColor,_originAxisVisible:G.graph3dViewOriginAxisVisible,_centerAxisVisible:G.graph3dViewCenterAxisVisible,_axisXColor:G.graph3dViewAxisXColor,_axisYColor:G.graph3dViewAxisYColor,_axisZColor:G.graph3dViewAxisZColor,_ortho:G.graph3dViewOrtho,_orthoWidth:G.graph3dViewOrthoWidth,_syncEyeWithOrthoWidth:G.graph3dViewSyncEyeWithOrthoWidth,_fovy:G.graph3dViewFovy,_near:G.graph3dViewNear,_far:G.graph3dViewFar,_headlightColor:G.graph3dViewHeadlightColor,_headlightIntensity:G.graph3dViewHeadlightIntensity,_headlightRange:G.graph3dViewHeadlightRange,_headlightGroup:G.graph3dViewHeadlightGroup,_headlightAmbientIntensity:G.graph3dViewHeadlightAmbientIntensity,_headlightDisabled:G.graph3dViewHeadlightDisabled,_rectSelectable:G.graph3dViewRectSelectable,_rectSelectBackground:G.graph3dViewRectSelectBackground,_editSizeColor:G.graph3dViewEditSizeColor,_autoMakeVisible:ud,_fogDisabled:G.graph3dViewFogDisabled,_fogMode:G.graph3dViewFogMode,_fogDensity:G.graph3dViewFogDensity,_fogColor:G.graph3dViewFogColor,_fogNear:G.graph3dViewFogNear,_fogFar:G.graph3dViewFogFar,_pickerResolution:G.graph3dViewPickerResolution,_dashDisabled:G.graph3dViewDashDisabled,_batchColorDisabled:G.graph3dViewBatchColorDisabled,_batchBlendDisabled:G.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:G.graph3dViewBatchBrightnessDisabled,addCamera:function(c){var b=this,H=g.freeze({id:b._42Q++,priority:c.priority||0,ignoreInPick:!!c.ignoreInPick,render:c.render});c.switch3DStatus&&(b._43Q[H.id]=!0),b._41Q.push(H),b._41Q.sort(function(w,x){return w.priority!==x.priority?w.priority-x.priority:w.id-x.id})},setEye:function(d,y,Z){1===arguments.length&&(y=d[1],Z=d[2],d=d[0]);var S=this._eye;S[0]=d,S[1]=y,S[2]=Z,this.fp(wi,U,S)},setCenter:function(h,M,S){1===arguments.length&&(M=h[1],S=h[2],h=h[0]);var W=this._center;W[0]=h,W[1]=M,W[2]=S,this.fp(Rp,U,W)},setUp:function(T,k,Y){1===arguments.length&&(k=T[1],Y=T[2],T=T[0]);var t=this._up;t[0]=T,t[1]=k,t[2]=Y,this.fp("up",U,t)},getDevicePixelRatio:function(){return this._picking?this._1o._resolution:this._devicePixelRatio||vm},isTransparentMask:function(V){return V.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var i=this,v=i._aspect;return v?v:(v=i.getWidth()/i.getHeight(),v||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(e){var Q=this,B=Q._dataModel,G=Q._selectionModel;B!==e&&(B&&(B.ump(Q.handleDataModelPropertyChange,Q),B.umm(Q.handleDataModelChange,Q),B.umd(Q.handleDataPropertyChange,Q),G||B.sm().ums(Q.handleSelectionChange,Q)),Q._dataModel=e,e.mp(Q.handleDataModelPropertyChange,Q),e.mm(Q.handleDataModelChange,Q),e.md(Q.handleDataPropertyChange,Q),G?G._21I(e):e.sm().ms(Q.handleSelectionChange,Q),Q._postProcessing.handleDataModleChange(B,e),Q._tryInvalidateEnvmap(),Q.invalidateAll(!0),Q.invalidateLight(),Q.invalidateboxClipper(),Q.invalidateFlowObjects(),Q._49Q(),Q.fp(ln,B,e),Q._canvas.style.background=e.getBackground()||"")},handleDataModelPropertyChange:function(R){var H=R.property;if("background"===H){var d=this._canvas.style.background,l=R.newValue||"";this._canvas.style.background=l,this.fp("canvasBackground",d,l)}else"envmapType"===H?this._tryInvalidateEnvmap():"envmap"===H&&this.iv()},handleDataPropertyChange:function(I){var l=I.data;this.invalidateData(l);var A=I.property;Xc(l)&&"s:light.type"===A?this.invalidateLight():"s:3d.clipbox"===A?this.invalidateboxClipper(l):"s:effect.flow"===A?this.invalidateFlowObjects(l):"s:shadow.cast"===A?this.shadowMap.tryUpdateBounding(l):"s:3d.visible"===A&&this.invalidateQuickVisible(l)},invalidateboxClipper:function(l){var K=this._boxClippers,Q=K.length;if(l)if(l.s("3d.clipbox"))K.indexOf(l)<0&&K.push(l);else{var _=K.indexOf(l);_>=0&&K.splice(_,1)}else K=this._boxClippers=[],this.dm().each(function(T){T.s("3d.clipbox")&&K.push(T)});Q!==K.length&&(Wf(this),this.shadowMap.deleteShadowProgram(),this._updateBoxClipperMatrix()),this.iv()},_updateBoxClipperMatrix:function(){for(var f,o,Y=this._boxClippers,h=this._boxClipperMatrixes=[],O=this._boxClipperClipInner=[],Q=new Jc,$=0,A=Y.length;A>$;$++)f=Y[$],f.appendAnchorMatrix3d(o=Jl(f,this.getMat(f))),h.push(Q.getInverse(Q.fromArray(o)).toArray()),O.push("inner"===f.s("3d.clipbox"))},_49Q:function(){this._4AQ||this._48Q||this.dm().size()<G.graph3dViewDataNumWarningLine||(this._48Q=!0,console.log("Too many datas so than disable some feature to speed up.\nYou can set global Default.graph3dViewDataNumWarningLine to largeEnoughNum to avoid this, or call graph3dView.quitDataNumWarning() to quit.\n"),this.enableQuickVisibleMode(),this.getHighlightHelper().mouseOverData=null)},quitDataNumWarning:function(){this.disableQuickVisibleMode(),this._48Q=!1,this._4AQ=!0},invalidateFlowObjects:function(O){var A=this._flowObjects,h=A.length;if(O)if(O.s("effect.flow"))A.indexOf(O)<0&&A.push(O);else{var j=A.indexOf(O);j>=0&&A.splice(j,1)}else A=this._flowObjects=[],this.dm().each(function(c){c.s("effect.flow")&&A.push(c)});h!==A.length&&Wf(this),this.iv()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function($){var w=this,K=$.property;w.iv(),w._18Q=U,"eye"===K?w._33Q=!0:"devicePixelRatio"===K?w._42(w.getDevicePixelRatio()):Te[K]&&Wf(w)},_5O:function(Y){var k=Y._22Q();return k?new k(this,Y):U},getData3dUI:function($){var J=this._25I[$._id];return J===c&&(J=this._5O($),this._25I[$._id]=J),J},invalidateAll:function(D){var W=this;if(D){for(var C in W._25I){var O=W._25I[C];O&&O.dispose()}W._25I={},W.iv(),Ub(W)}else Ub(W),W.dm().each(function(l){W.invalidateData(l)})},invalidateSelection:function(){var k=this;k.sm().each(function(J){k.invalidateData(J)})},invalidateData:function(T){var z=this,A=z.getData3dUI(T);A&&(A.iv(),z.iv()),Ub(z,T)},getShape3dText:function(B){return B.getStyle("shape3d.text")||this.getLabel(B)},invalidateBatch:function(V){var n=this,I=n._40Q;I.each(function(g){n._invalidateBatch(g.batchModelMap,g.batchIndexMap,g.polylineModelMap,g.polylineIndexMap,g.wireframeModelMap,g.wireframeIndexMap,V),g.markBatchInvalid()})},_invalidateBatch:function(G,$,C,d,v,n,P){var p=this,W=G[P],q=[],e={};if(W){W.ds.forEach(function(T){var X=p.getData3dUI(T);X&&X.iv(),delete $[T._id],q.push(T._id)}),delete G[P];for(var L,E,N,k,g,z,F,Z,K,o=[v,C],w=[n,d],T=0;T<o.length;T++){var h=o[T],Y=w[T];for(e={},Z=0;Z<q.length;Z++){var U=Y[q[Z]];if(U){delete Y[q[Z]],K=U.batch,L=h[K];var x=U.begin,X=U.size,S=3*x,J=3*X,H=4*x,r=4*X;for(E=L.ds,N=L.vs,k=L.cs,g=L.ps,z=L.ls,F=U.index,L.invalidate=!0,E[F]=c,F=S;S+J>F;F++)N[F]=c;for(F=H;H+r>F;F++)k[F]=c;for(F=H;H+r>F;F++)g[F]=c;if(z)for(F=S;S+J>F;F++)z[F]=c;e[K]=!0}}for(K in e){L=h[K],E=L.ds,N=L.vs,k=L.cs,g=L.ps,z=L.ls;var O=[];for(F=0;F<E.length;F++)E[F]!==c&&O.push(E[F]);if(0===O.length)delete h[K];else{for(L.ds=O,O=[],F=0;F<N.length;F++)N[F]!==c&&O.push(N[F]);for(L.vs=O,O=[],F=0;F<k.length;F++)k[F]!==c&&O.push(k[F]);for(L.cs=O,O=[],F=0;F<g.length;F++)g[F]!==c&&O.push(g[F]);if(L.ps=O,z){for(O=[],F=0;F<z.length;F++)z[F]!==c&&O.push(z[F]);L.ls=O}}}}p.iv()}},handleDataModelChange:function(Z){var m=this,M=Z.kind,D=Z.data;if("add"===M)m.invalidateData(D),hq(D)&&D.getEdgeGroup()&&D.getEdgeGroup().eachSiblingEdge(m.invalidateData,m),Xc(D)&&m.invalidateLight(),D.s("3d.clipbox")&&m.invalidateboxClipper(D),D.s("effect.flow")&&m.invalidateFlowObjects(D),m._49Q();else if(M===Db){var J=D._id,c=m._25I[J];c&&(c.dispose(),delete m._25I[J],m.iv()),D===m._currentSubGraph&&m.setCurrentSubGraph(U),Ub(m,D),Xc(D)&&m.invalidateLight(),D.s("3d.clipbox")&&m.invalidateboxClipper(D),D.s("effect.flow")&&m.invalidateFlowObjects(D)}else M===ke&&(m.invalidateAll(!0),m.setCurrentSubGraph(U),Ub(m),m.invalidateLight(),m.invalidateboxClipper(),m.invalidateFlowObjects())},toCanvas:function(g,D,X){var T=this,E=T.getGL();if(T.validate(),g){var e=E.getParameter(E.COLOR_CLEAR_VALUE);fo(E,g)}T._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var P=T.getWidth()||1,i=T.getHeight()||1,R=new Uint8Array(4*P*i),Q=Nb(),L=Q.getContext("2d");E.readPixels(0,0,P,i,E.RGBA,E.UNSIGNED_BYTE,R),cs(Q,P,i,1);for(var F=L.getImageData(0,0,P,i),h=F.data,z=0;z<h.length;z+=4){var B=z/4,c=A(B/P),j=B-c*P;B=4*((i-1-c)*P+j),h[B]=R[z],h[B+1]=R[z+1],h[B+2]=R[z+2],h[B+3]=R[z+3]}if(L.putImageData(F,0,0),g&&fo(E,e),T._42(T.getDevicePixelRatio()),D&&X){var b=Nb(),K=b.getContext("2d");return cs(b,D,X,1),G.drawImage(K,Q,0,0,D,X),b}return Q},toDataURL:function(C,G){var E=this,i=E.getGL();if(E.validate(),C){var D=i.getParameter(i.COLOR_CLEAR_VALUE);fo(i,C)}E._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var _=E._canvas.toDataURL(G||"image/png",1);return C&&fo(i,D),E._42(E.getDevicePixelRatio()),_},getGL:function(){var i=this._26I;if(i)return this.acquireProgram(),i;if(!this._35O){var o=this,m=o._canvas,h=o._attributes;if(!h||h.requestWebGL2!==!1)try{i=m.getContext("webgl2",h)||m.getContext("experimental-webgl2",h),i&&(o._webGLVersion=2,o._26I=i)}catch(P){}if(!i)try{i=m.getContext("webgl",h)||m.getContext("experimental-webgl",h)}catch(P){throw new Error("WebGL not supported")}if(!i)throw new Error("WebGL not supported");o._26I=i;var S=o._frameState=new $c(this,i);o._glExtensions=new l(i),o._glCapabilities=new $(i,o._glExtensions),o._2O={},i._emptyCubeTexture=_o(i),i._compiledShader={},i._emptyTexture=Xo(i),i._emptyBlendTexture=Xo(i),i._bufPool={},i._id=++Xm,S.setGLState(),o._buffer={vs:fs(i),ns:fs(i),is:fs(i),uv:fs(i),batchColor:fs(i),batchBlend:fs(i),batchBrightness:fs(i),lineDistance:fs(i)},o._1O=Uf(i);var W=o._cube={vs:fs(i),ns:fs(i),is:fs(i),uv:fs(i)};return Dp(i,W.vs,cd),Dp(i,W.ns,wk),Dp(i,W.uv,zr),Rn(i,W.is,Tn),o.acquireProgram(),i._renderInfo={calls:0,vertices:0,faces:0,lines:0,points:0,frame:0,cacheTimeCost:0},i}},getGLCapabilities:function(){var d=this.getGL();return d?this._glCapabilities:void 0},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<G.graph3dEnvmapCapabilityRequire?null:this.dm().getEnvmap()},getEnvmapType:function(){var s,B=this.dm();return B&&(s=B.getEnvmapType()),s||"legacy"},invalidateEnvmap:function(b){return this._envmapRenderer.invalidateEnvmap(b)},_setEnvmapByProbeId:function(l,Q){return this._envmapRenderer.setEnvmapByProbeId(l,Q)},_tryInvalidateEnvmap:function(){var Q=this.getEnvmapType();Q!==this._lastProgramEnvmapType&&(Wf(this),this.iv())},acquireProgram:function(){var N=this,O=N._26I;if(O&&!N._prg){var l=N._prg=O.createProgram();if(!l)return U;var p=N._dirs.length,G=N._spots.length,j=N._59O.length,g=N._boxClippers.length,A=N._flowObjects.length,_=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uUvMatrix","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogDensity","uFogNear","uFogFar"];p&&_.push("uDirColor","uDirDirection"),G&&_.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),j&&_.push("uPointColor","uPointRange","uPointPosition"),us||(hg=Tf(hg.substring(0,hg.indexOf("^#"))),be=Tf(be),us=!0);var E=N.getEnvmapType(),v=["#define MAX_DIR "+p,"#define MAX_SPOT "+G,"#define MAX_POINT "+j,"#define MAX_BOX_CLIPPER "+g,"#define MAX_FLOW_OBJECT "+A,N._fogDisabled?"":"#define FOG","exp2"===N.getFogMode()?"#define FOG_EXP2":"",N._dashDisabled?"":"#define DASH","#define USE_ENVMAP","legacy"!==E?"#define ENVMAP_TYPE_CUBE_UV":"",N.isOrtho()?"#define ORTHOGRAPHIC":"",N._batchColorDisabled?"":"#define BATCHCOLOR",N._batchBlendDisabled?"":"#define BATCHBLEND",N._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",N.shadowMap.enable?N.shadowMap.genShaderDefine():"",""].join("\n"),w=em(O,l,O.VERTEX_SHADER,hg.replace("PREFIX",v));O.getShaderParameter(w,O.COMPILE_STATUS)||xg("COMPILE",O.VERTEX_SHADER,O.getError(),O.getShaderInfoLog(w));var q=em(O,l,O.FRAGMENT_SHADER,be.replace("PREFIX",v));if(O.getShaderParameter(q,O.COMPILE_STATUS)||xg("COMPILE",O.FRAGMENT_SHADER,O.getError(),O.getShaderInfoLog(q)),ze?_.push("aPosition"):(l.aPosition=0,O.bindAttribLocation(l,0,"aPosition")),O.linkProgram(l),!O.getProgramParameter(l,O.LINK_STATUS)){var d=O.getProgramInfoLog(l);return N._prg=U,d.indexOf("maximum temp register")>=0&&!N._glTempRegisterLimited?(N._glTempRegisterLimited=!0,O.deleteProgram(l),N.acquireProgram()):(xg("LINK",O.getProgramParameter(l,O.VALIDATE_STATUS),O.getError(),d),O.deleteProgram(l),U)}_.forEach(function(B){l[B]=/^u/.test(B)?O.getUniformLocation(l,B):O.getAttribLocation(l,B)});var o=N._frameState;o.renderState.program=o.defaultProgram=l,N._envmapRenderer.changeEnvmapType(N._lastProgramEnvmapType=E),O.deleteShader(w),O.deleteShader(q)}},isGLTempRegisterLimited:function(){return this._glTempRegisterLimited},getBrightness:function(D){var X=D.s("brightness"),u=this.isSelected(D)?D.s("select.brightness"):U;return X==U?u:u==U?X:X*u},getDataHighlightMode:function(J){return J.s("highlight.mode")},getWireframe:function(j){var T=j.s("wf.visible"),R=j.s("wf.width");return T===!0||R>0&&"selected"===T&&this.isSelected(j)?{color:j.s("wf.color"),width:R,"short":j.s("wf.short"),mat:j.s("wf.mat")}:void 0},_transformPointToViewSpace:function(U){var v=[U[0],U[1],U[2]];return lp(v,this._viewMatrix),v},_transformDirectionToViewSpace:function(u,I){var g=[u[0],u[1],u[2]];lp(g,this._viewMatrix);var X=I?[I[0],I[1],I[2]]:[0,0,0];lp(X,this._viewMatrix);var N=X[0]-g[0],y=X[1]-g[1],r=X[2]-g[2],Q=Math.sqrt(N*N+y*y+r*r);return Q?[N/Q,y/Q,r/Q]:[N,y,r]},getWireframeGeometry:function(O){return O.s("wf.geometry")?{color:O.s("wf.color"),width:O.s("wf.width"),mat:O.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(x){return x.s("body.color")},getMat:function(C){return C.getMat?C.getMat():C.s("mat")},getFaceMat:function(w,z){return w.getFaceMat?w.getFaceMat(z):w.s(z+".mat")},getFaceBlend:function(v,f){return v.s(f+".blend")||v.s("all.blend")},getFaceColor:function(w,r){return w.s(r+".color")||w.s("all.color")},getFaceImage:function(E,e){return E.s(e+".image")||E.s("all.image")},getFaceBlendImage:function(J,D){return J.s(D+".blend.image")||J.s("all.blend.image")},getFaceDiscardSelectable:function(S,h){var I=S.s(h+".discard.selectable");return I==U?S.s("all.discard.selectable"):I},getFaceUv:function(F,L){return F.s(L+".uv")||F.s("all.uv")},getFaceUvOffset:function(x,b){return x.s(b+".uv.offset")||x.s("all.uv.offset")},getFaceUvScale:function(k,l){return k.s(l+".uv.scale")||k.s("all.uv.scale")},getFaceUvRotation:function(X,Y){return X.s(Y+".uv.rotation")||X.s("all.uv.rotation")},getFaceLight:function(V,g){var $=V.s(g+".light");return $==U?V.s("all.light"):$},getFaceVisible:function(k,$){var f=k.s($+".visible");return f==U?k.s("all.visible"):f},getFaceOpacity:function(R,k){var B=R.s(k+".opacity");return B==U?R.s("all.opacity"):B},getFaceTransparent:function(q,m){var F=q.s(m+".transparent");return F==U?q.s("all.transparent"):F},getFaceReverseColor:function(C,Z){return C.s(Z+".reverse.color")||C.s("all.reverse.color")},getFaceReverseFlip:function(P,j){var T=P.s(j+".reverse.flip");return T==U?P.s("all.reverse.flip"):T},getFaceReverseCull:function(M,e){var g=M.s(e+".reverse.cull");return g==U?M.s("all.reverse.cull"):g},getTextureMap:function(){return this._2O},_2Oi:function(p,R,Q){Q=Q||"";var M;(M=this._2O[p])||(M=this._2O[p]={}),M[Q]=R},deleteTexture:function(r){var K=this,k=K._2O[r];if(k){delete K._2O[r];var o=K.getGL();for(var u in k)o.deleteTexture(k[u])}},renderPickScene:function(){var Q=this.getGL();this.syncRenderState(),this._picking=Q._picking=!0,this.renderScene(),this._picking=Q._picking=!1},invalidateCachedTexture:function(_){var z=this.getData3dUI(_);z.invalidateCachedTexture(this.getGL()),this.invalidateData(_)},invalidateShape3dCachedImage:function(j){this.invalidateCachedTexture(j)},invalidateCachedGeometry:function(k){var i=this.getData3dUI(k);i.invalidateCachedGeometry(),this.invalidateData(k)},isInteractive:function(k){return k.s("interactive")},getTexture:function(L,P,J,W){if(!L)return U;var v,$,O=this,Z=O.getGL(),b=O._2O[L];if(b&&(P&&($=P.s("texture.mipmap.max")),v=b[$||""]||b.default),!v){var p=Kj(L);if(W||(W={}),!p)return Z._emptyTexture;if(P){W.mipmapMaxLevel=$=P.s("texture.mipmap.max");var M=P.s("texture.wrap");W.clampToEdge="clampToEdge"===M?!0:"repeat"===M?!1:c}if(p.uuid||(p.uuid=C.Math.generateUUID()),p.tagName){if(p.dynamic)return Uf(Z,p,O._1O,W);v=Uf(Z,p,c,W),O._2Oi(L,v,$)}else{var w,S=P&&(P.s("texture.cache")||P.s("shape3d.image.cache")||p.textureCache),a=O.isVRPresenting();if(a&&(P._textureUpdateFrame===Z._renderInfo.frame?S=!0:P._textureUpdateFrame=Z._renderInfo.frame),S&&(w=O.getData3dUI(P),v=w.getCachedTexture(J),v&&w.interactiveInfo&&v.interactiveInfo&&(w.interactiveInfo[v.interactiveInfo.key]=v.interactiveInfo.info)),!v){var t=Z._renderInfo.textureCache;if(S){if(t.time>G.graph3dMaxVectorCacheTime)return O.redraw(),Z._emptyTexture;if(!lr(p,P))return Z._emptyTexture}var A;P&&(1!==P.s("texture.scale")?A=P.s("texture.scale"):1!==P.s("shape3d.texture.scale")&&(A=P.s("shape3d.texture.scale"))),A||(A=1);var Y=P&&(P.s("fixSizeOnScreen")||P.s("shape3d.fixSizeOnScreen")),V=Y?Z.NEAREST:Z.LINEAR;Y?"number"==typeof Y&&(A*=0>Y?1:Y):P&&(P.s("vector.dynamic")||P.s("shape3d.vector.dynamic"))&&(w||(w=O.getData3dUI(P)),Y=w.getVectorDynamicSize());var o,x,z,i=P&&P.s("shape3d");"billboard"===i?z=P.getTall()/P.getWidth():"plane"===i&&(z=P.getHeight()/P.getWidth());var m=Zo(p,P);if(Y){var Q;Q=S?O._devicePixelRatio||vm:O.getDevicePixelRatio(),o=Y[0]>0?Y[0]*Q:A*m*Q,x=Y[1]>0?Y[1]*Q:A*(z?Ge(p,P,O,Math.min(4096,m*z)):Ge(p,P))*Q}else o=A*m,x=A*(z?Ge(p,P,O,Math.min(4096,m*z)):Ge(p,P));if(o>=1&&x>=1){var d=0;(S||a)&&(d=Date.now());var n=O._glCapabilities.maxTextureSize;o=Math.min(o,n),x=Math.min(x,n);var R=Qr(o,x);if(!w&&P&&(w=O.getData3dUI(P)),w&&w.interactiveInfo){var f=L;"object"==typeof f&&(f=f.uuid||(f.uuid=C.Math.generateUUID()));var l=w.interactiveInfo[f]={};R.interactiveInfo=l.bodyInfo={compInfos:[],matrix:new kp,rect:{x:0,y:0,width:o,height:x}}}kc(R,p,0,0,o,x,P,O),R.interactiveInfo&&(R.interactiveInfo=null),R.restore(),t.count++,t.pixels+=o*x,P?(W.minFilter=Bi(P.s("texture.filter.min")||P.s("texture.filter"))||V,W.magFilter=Bi(P.s("texture.filter.mag")||P.s("texture.filter"))||V):W.minFilter=W.magFilter=V,S||a?(v=Uf(Z,mj,null,W),w.setCachedTexture(v,J),t.time+=Date.now()-d,l&&(v.interactiveInfo={key:f,info:l}),mj=null):v=Uf(Z,mj,O._1O,W)}}}}return v},redraw:function(){this.iv()},validateImpl:function(){var G=this;if(G._lightChanged){G._lightChanged=!1;var i=[],f=[],z=[];G.dm().each(function(J){if(Xc(J)){var V=J.s("light.type");V===Nn?i.push(J):V===Fm?f.push(J):V===bh&&z.push(J)}}),(i.length!==G._59O.length||f.length!==G._spots.length||z.length!==G._dirs.length)&&Wf(G),G._59O=i,G._spots=f,G._dirs=z}var j=G.getAspect();j!==G.__cachedAspect__&&(G._updateSkybox({property:"asceptChanged"}),G.__cachedAspect__=j),G._42(),G._1o.iv()},getRenderInfo:function(){var v=this.getGL();return v?v._renderInfo:void 0},getDebugTip:function(){var e=this,E=e.getRenderInfo();if(E){var n=e.getGL()._validBufCount||0,y="Draw Calls: "+E.calls+"<br/>"+"Vertices: "+E.vertices+"<br/>"+"Faces: "+E.faces+"<br/>"+"Lines: "+E.lines+"<br/>"+(E.points?"Points: "+E.points+"<br/>":"")+"Buffers: "+n+"<br/>"+"Cache Models: "+g.keys(Jm).length+"<br/>"+"Shape3d Models: "+g.keys(fb).length;if(e.isVRPresenting()&&(y+="<br/>VR fps: "+e.vr.getFps()),E.textureCache){var i=E.textureCache.count;if(y+="<br/>2D Dynamic Textures: "+E.textureCache.count,i>0){var A,x=E.textureCache.pixels;A=x>1e6?Math.round(x/1e6)+"M":x>1e3?Math.round(x/1e3)+"K":Math.round(x),y+="<br/>2D Dynamic pixels: "+A}}return y}},getFrameState:function(){return this._frameState},isBoundingBoxInView:function(){var l=new C.Math.Box3,g=new C.Math.Matrix4;return function(S){var u=S;if(u instanceof C.Data&&(u=this.getData3dUI(u)),!u.mat)return!0;var K=u.getBoundingBox();l.copy(K).applyMatrix4(g.fromArray(u.mat));var k=this.getFrustum();return k.intersectsBox(l)}}(),updateScene:function(){var s=this;s._81O=U,s.overlappingBox.clear();var c=s._40Q;c.init();var q=s.getGL(),Z=s.dm();if(Z.isHierarchicalRendering())Z.eachByHierarchical(function(y){var T=s.getData3dUI(y);T&&T.update(s,q,c)});else{var H,k,A,z=Z.getDatas().getArray(),v=z.length;for(H=0;v>H;H++)k=z[H],A=s.getData3dUI(k),A&&A.update(s,q,c)}this._updateBoxClipperMatrix(),c.onUpdated()},_pushFrameRenderOptions:function(m){this._frameRenderOptionStack.push(this._currentFrameRenderOptions),this._currentFrameRenderOptions=m},_popFrameRenderOptions:function(){this._currentFrameRenderOptions=this._frameRenderOptionStack.pop()},_getFrameRenderOptions:function(T){var q=this._currentFrameRenderOptions;return q&&q[T]},getRenderLists:function(){return this._40Q},renderScene:function(C){function R(q,y){M.setGLState(q,y),M.setUniforms(q),M.renderState.attribs.disable(),K=F.directUniforms(),h=F.directAttribs(),h.disable()}function D(u){for(;J>V;V++){var y=j[V];if(!H||!y.ignoreInPick){if(y.priority>=u)break;(!i._43Q[i._44Q=y.id]||vd[Lc.length])&&(y.render(s,i,M),R())}}}var i=this;i._pushFrameRenderOptions(C),i.shadowMap.render(),i.flowMap.render();var s=i.getGL();i._envmapRenderer.onBeforeRender(s),i._44Q=-1;var K,h,M=i._frameState,F=M.renderState,$=F.glState,P=i._prg;i._projectMatrix=Ro(i),Jq(i,i._7O),i._viewMatrix=md(i._7O),i.isReflecting(s)||Lo(i._projScreenMatrix=Tj(),i._projectMatrix,i._viewMatrix),M.syncEnv(this._picking?this.pickColorMap:c),F.useProgram(P),R(!1,!0),s.clear(s.DEPTH_BUFFER_BIT);var H=i._picking,j=this._41Q,V=0,J=j.length;if(D(G.cameraPriority.skybox),H){var S=$.color.clear.slice(0);fo(s,[0,0,0,0])}else fo(s,[0,0,0,0]),$.blend.enabled=!1,$.depth.enabled=!1,$.depth.mask=!1,i._camera&&i._camera.s("camera.renderSky")===!1||i.drawSky(s,P),i._getFrameRenderOptions("renderReflector")!==!1&&i.drawReflectors(s)&&(i._projectMatrix=Ro(i),Jq(i,i._7O),i._viewMatrix=md(i._7O),M.syncEnv(),R()),$.blend.enabled=!1,$.depth.enabled=!0,$.depth.mask=!0,K.uTransparent=!1,i._getFrameRenderOptions("renderGrid")!==!1&&i._31O._42(s,P);if(!s.textureBatch||vd[(ONE_FRAME_TIME-6)/2]){H||(i.shadowMap.enable&&i.shadowMap.createShadow(K),i.flowMap.createFlow(K));for(var Y=0,t=Lq.length;t>Y;Y++){var a=Lq[Y],z=In[a];if(!(!i._camera&&z.ignore||i._camera&&!i._camera.isLayerVisible(a))){var A=z.priority;D(A),this.renderLayer(a)}}D(G.cameraPriority.infinity),i.flowMap.disableFlow(K),Pf(i,K,0),K.uHeadlightColor=[1,1,1,0],K.uUseEnvMap=!1,$.depth.enabled=!1,K.uTransparent=!1,K.shadowReceive=!1,K.uEnableBoxClip=!1,H?i.drawFilter||i._30O._42(s,P):(i._highlightHelper._42(s,P),this._renderAxisAndEditHelper(i._getFrameRenderOptions("renderAxis")!==!1,i._getFrameRenderOptions("renderEdit")!==!1),$.blend.enabled=!1,$.depth.mask=!0),$.depth.enabled=!0,H&&fo(s,S),Dp(s,U),Rn(s,U),i._44Q=-1,i._popFrameRenderOptions(null)}},_renderAxisAndEditHelper:function(R,o){if(R||o){var V=this,d=V.getGL(),O=V._prg,u=V._frameState,t=u.renderState,p=t.glState,_=t.directUniforms();u.renderState.attribs.disable(),p.depth.enabled=!1,_.uTransparent=!1,_.shadowReceive=!1,p.blend.enabled=!1,p.depth.mask=!0,_.uPick=V._picking,R&&V._32O._42(d,O),o&&V._30O._42(d,O),Dp(d,U),Rn(d,U)}},renderLayers:function(L,k){k&&(L=Bg(L));for(var H=0,u=L.length;u>H;H++)this.renderLayer(L[H])},renderSky:function(){var b=this,v=b._frameState,m=v.renderState,w=m.glState,V=b.getGL(),q=b._prg;b._projectMatrix=Ro(b),Jq(b,b._7O),b._viewMatrix=md(b._7O),Lo(b._projScreenMatrix=Tj(),b._projectMatrix,b._viewMatrix),v.syncEnv(),m.useProgram(q),v.setGLState(!1,!0),v.setUniforms(!1),v.renderState.attribs.disable(),V.clear(V.DEPTH_BUFFER_BIT),fo(V,[0,0,0,0]),w.blend.enabled=!1,w.depth.enabled=!1,w.depth.mask=!1,b.drawSky(V,q),w.depth.mask=!0,w.depth.enabled=!0,Dp(V,U),Rn(V,U)},addRenderLayerListener:function(b,o,Z){var k=this;k._renderLayerNotifier||(k._renderLayerNotifier=new Ce),k._renderLayerNotifier.add(b,o,Z)},removeRenderLayerListener:function(D,c){this._renderLayerNotifier&&this._renderLayerNotifier.remove(D,c)},fireRenderLayerEvent:function(f,v){var q=this._renderLayerNotifier;q&&q.fire({layer:f,phase:v})},renderLayer:function(n){var L=this,Y=L._picking,x=L._40Q.get(n);if(x){L.fireRenderLayerEvent(n,"prepare");var l=L.getGL(),I=In[n],C=L._frameState,F=C.renderState,R=F.glState,s=F.directUniforms();!Y&&L.isSortable()&&x.sort(L._sortFunc,L._projScreenMatrix);var o,j,J,y=x.opaque,P=x.transparent,B=x.batchModelMap,X=x.polylineModelMap,m=x.wireframeModelMap,l=L.getGL(),g=L._prg;Y||(R.blend.enabled=!1,R.depth.enabled=!0,R.depth.mask=!0),s.uTransparent=!1,I.clearDepth!==!1&&l.clear(l.DEPTH_BUFFER_BIT);var u=this.drawFilter;if(u)for(J=y,o=0,j=J.length;j>o;o++)u(J[o].data)!==!0&&J[o].ui._42(l,g,D);else{for(J=y,o=0,j=J.length;j>o;o++)J[o].ui._42(l,g,D);if(Y)for(J=P,o=0,j=J.length;j>o;o++)J[o].ui._46Q(l);ld(L,B),Kn(L,X),Kn(L,m)}if(Y||(R.blend.enabled=!0,R.depth.mask=!1),L._45Q=s.uTransparent=!0,u)for(J=P,o=0,j=J.length;j>o;o++)u(J[o].data)!==!0&&J[o].ui._42(l,g,M);else{for(J=P,o=0,j=J.length;j>o;o++)J[o].ui._42(l,g,M);ld(L,B,null,!0),Kn(L,X,null,!0),Kn(L,m,null,!0)}L._45Q=null,L.fireRenderLayerEvent(n,"post")}},_42:function(t,L){var x=this;if(!x._35O&&(!db||vd(db))){var S=x.getWidth(),M=x.getHeight();if(S&&M){var k=x.getGL();if(k){var d,p=x._canvas;if(t?d=!0:t=x.getDevicePixelRatio(),!x._picking&&(d||S!==p.clientWidth||M!==p.clientHeight)){cs(p,S,M,t);var z=t;S&&Math.abs(k.drawingBufferWidth-S*t)>1&&(z=Math.min(z,k.drawingBufferWidth/S)),M&&Math.abs(k.drawingBufferHeight-M*t)>1&&(z=Math.min(z,k.drawingBufferHeight/M)),z!==t&&(x.setDevicePixelRatio(t=z),cs(p,S,M,t)),x._18Q=null}k.clear(k.COLOR_BUFFER_BIT);var j=k._renderInfo;j.calls=0,j.vertices=0,j.faces=0,j.lines=0,j.points=0,j.textureCache={time:0,count:0,pixels:0},j.frame=++x._frameId,j.cacheTimeCost=0,j.reflectDepth=0,S*=t,M*=t,this.syncRenderState();do{if(x.isVREnabled()&&x.vr.render(k,S,M,L))break;if(x.updateScene(),x._postProcessing.render(k,S,M,L))break;x.setViewport(k,0,0,S,M),x.renderScene(L)}while(!1);x._33Q=!1,x.countFrame(),x._doBufferGC(k)}}}},syncRenderState:function(){var s,m;(s=this._frameState)&&(m=s.renderState)&&m.syncLoss()},drawReflectors:function(y){y._renderInfo.reflectDepth++;var N,w,j,e=this,t=e._dataModel.getReflectors(),V=!1;for(N in t)w=t[N],e.isVisible(w)&&(j=e.getData3dUI(w),j&&j.drawReflector(y)&&(V=!0));return y._renderInfo.reflectDepth--,V},isReflecting:function(I){return I._renderInfo.reflectDepth},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(K,u){return this._postProcessing.enableModule(K,u)},getPostProcessingModule:function(T){return this._postProcessing.getModule(T)},getPostProcessingValue:function(P,G){var V=this._postProcessing.getModule(P);return V?V[G]:c},setPostProcessingValue:function(J,f,n){var U=this.getPostProcessingValue(J,f),c=this._postProcessing.getModule(J);c&&U!==n&&("enable"===f?this.enablePostProcessing(J,n):c[f]=n,this.firePropertyChange("postProcessing."+J+"."+f,U,n))},setViewport:function(_,Y,g,$,L){this._viewport=[Y,g,$,L],Ph.for(_).directState().viewport=this._viewport},getRenderState:function(){return Ph.for(this._26I)},getViewport:function(){return this._viewport},setBufferGCInterval:function(u){this._bufferGCInterval=u},_doBufferGC:function(S,Z){var z,h,L=S._bufPool,F=0,g=0,D=S._renderInfo.frame,I=this._bufferGCInterval||10;for(z in L)F++,h=L[z],h&&(Z||D-h._fid>I?(S.deleteBuffer(h._buf),h._buf=null,L[z]=null):g++);if(F/2>g&&F>128){var U={};for(z in L)L[z]&&(U[z]=L[z]);S._bufPool=U}S._validBufCount=g},_swapLineMap:function(){var f=this;ii=f._polylineModelMap,f._polylineModelMap=f._polylineModelMapSwap,f._polylineModelMapSwap=ii,ii=f._wireframeModelMap,f._wireframeModelMap=f._wireframeModelMapSwap,f._wireframeModelMapSwap=ii,ii=f._polylineIndexMap,f._polylineIndexMap=f._polylineIndexMapSwap,f._polylineIndexMapSwap=ii,ii=f._wireframeIndexMap,f._wireframeIndexMap=f._wireframeIndexMapSwap,f._wireframeIndexMapSwap=ii},_updateSkybox:function(F){if(this._skybox&&F){var M=F.property,w=!1,z=this._skybox;if("eye"===M||"forceUpdate"===M){var P=this._eye;z.p3(P[0],P[1],P[2]),w=!0}if("near"===M||"far"===M||"forceUpdate"===M||"asceptChanged"===M){var g=z.__cachedS3__;g||(g=z.__cachedS3__=z.getFinalScale3d());var c=Math.sqrt(3),t=1/0,s=-1/0;g.forEach(function(o){o/=2,t=x(o,t),s=B(o,s)}),s*=c;var W=this._near,j=this._far,Y=Math.tan(this.getFovy()/2)*W,_=this.getAspect()*Y,l=1.1*Math.sqrt(_*_+Y*Y+W*W),r=1;if(l>t)r=l/t;else if(s>=j){var p=j*j/(W+j);r=p/s}if(1!==r){z.__updatingSkybox__=!0;var I=g.map(function(i){return r*i});z.s3(I),z.setScale3d(1,1,1),w=!0,delete z.__updatingSkybox__}}w&&this.invalidateData(z)}},getSkyBox:function(){return this.getSkybox()},setSkyBox:function(O){return this.setSkybox(O)},getSkybox:function(){return this._skybox},setSkybox:function(R){var X=this._skybox;if(X===R)return R&&this._updateSkybox({property:"forceUpdate"}),void 0;if(X&&(this._skyboxStyleMap&&X.setStyleMap(this._skyboxStyleMap),this._skyboxStyleMap=null,this._skyboxAnchor3d&&X.setAnchor3d(this._skyboxAnchor3d),this._skyboxAnchor3d=null,this._skyboxP3&&X.p3(this._skyboxP3),this._skyboxP3=null,this.handleDataModelChange({kind:Db,data:X})),this._skybox=R,this.ump(this._updateSkybox,this),R){R.dm()&&R.dm().remove(R),this._skyboxStyleMap=C.Default.clone(R.getStyleMap()),this._skyboxAnchor3d=R.getAnchor3d(),R.setAnchor3d(.5,.5,.5),this._skyboxP3=R.p3().slice(0),R.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1});
var a=R.onPropertyChanged;R.onPropertyChanged=function(v){a.call(R,v),!R.__updatingSkybox__&&["width","height","tall","scale","scaleTall"].indexOf(v.property)>=0&&(R.__cachedS3__=c)},this.mp(this._updateSkybox,this),this._updateSkybox({property:"forceUpdate"})}this.fp("skybox",X,R)},drawSky:function(Q,Z){var B=this,d=B._skybox;if(d){var t=Ph.for(Q).directUniforms(),h=B._headlightIntensity,J=Ap(B._headlightColor),Z=B._prg;1!==h&&(J=[J[0]*h,J[1]*h,J[2]*h]),t.uHeadlightColor=[J[0],J[1],J[2],1];var n=B.getData3dUI(d);if(n){var F=B.isOrtho(),j=F||this._computedProjectMatrix;if(j){var $=B._projectMatrix;F&&(B._ortho=!1),t.uPMatrix=B._projectMatrix=Ro(B,!0)}var A=d.p3(),T=this.getEye();(A[0]!==T[0]||A[1]!==T[1]||A[2]!==T[2])&&(d._position.x=T[0],d._54O=T[1],d._position.y=T[2]),n.validate(),n._42(Q,Z,E),j&&(F&&(B._ortho=!0),t.uPMatrix=B._projectMatrix=$)}Q.clear(Q.DEPTH_BUFFER_BIT),t.uHeadlightColor=[J[0],J[1],J[2],B._headlightDisabled?1:0]}},getLogicalPoint:function(F){return Ag(F,this._canvas)},isRectOverlapping:function(v){var U=this.getData3dUI(v);return U._rectOverlapping},getHitFaceInfo:function(h){h.target&&(h=this.lp(h));var q=this.getDataInfoAt(h);if(q){var S=this.intersectObject(h,q.data);if(S)return{data:q.data,face:S.part}}return U},unproject:function(O,H){var m=this,e=m.getWidth(),B=m.getHeight(),D=O.target?m.lp(O):O,Z=D.x-e/2,q=D.y-B/2,u=2*(Z/e),K=2*(-1*q/B);H=H||0;var c=Tj(),t=Ro(m),E=Jq(m);Lo(c,t,E),Bn(c);var R=je([u,K,H,1],c);return[R[0]/R[3],R[1]/R[3],R[2]/R[3]]},getDataAt:function(d){var W=this.getDataInfoAt(d);return W?W.data:U},getDataInfoAt:function(n,I,F){return n.target&&(n=this.lp(n)),this._1o.get(Yn(n.x,n.y,I),!0,F)},getDatasInRect:function(t,G){return this._1o.get(t,!1,G)},setEditable:function(m){var J=this,b=J._editable;J._editable=m,this.fp(kl,b,m)},isEditable:function(S){var I=this;return S?I._editable?Je(S)?S.s("3d.editable")?I._editableFunc?I._editableFunc(S):!0:!1:!1:!1:I._editable},isSelectable:function(Q){return Q.s("3d.selectable")&&this.sm().isSelectable(Q)},isMovable:function(Z){var a=this;return hq(Z)&&Z.getStyle(Hk)!==vn?!1:Z.s("3d.movable")?a._movableFunc?a._movableFunc(Z):!0:!1},isSizeEditable:function(c){return Je(c)?this._sizeEditableFunc?this._sizeEditableFunc(c):!0:!1},isRotationEditable:function(Q){return Je(Q)&&Q.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(Q):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(n){this.setZoom(lb,n)},zoomOut:function(F){this.setZoom(1/lb,F)},setZoom:function(){var t=new Cc,H=new Cc,_=new Cc,o=new Cc;return function(P,S){if(1!==P){var g=this;g._14o&&g._14o.stop(!0);var l,X=1/P;t.copy(g.getCenter()),H.copy(g.getEye());var u=g._ortho;if(u){if(l=g._orthoWidth,l<g._moveStep&&P>1)return}else if(t.distanceTo(H)<g._moveStep&&1>X)return;var p=!1;return g._zoomToCenter===!1&&g._lastZoomLP&&(_.copy(H).sub(t).normalize(),g._81O=null,o.copy(g.getHitPosition(g._lastZoomLP,t.toArray(),_.toArray())),p=!0,g._lastZoomHit=o),(S=Li(S))?(S.action=function(b){g.fi({kind:g._zooming?"betweenZoom":"beginZoom"}),g._zooming=1;var d=(X-1)*b+1;u&&g.setOrthoWidth(l*d),p?(g.setEye(_.lerpVectors(o,H,d).toArray()),g.setCenter(_.lerpVectors(o,t,d).toArray())):u||g.setEye(_.lerpVectors(t,H,d).toArray())},S._37o=function(){delete g._14o,delete g._zooming,g.fi({kind:"endZoom"}),g.onZoomEnded()},g._14o=Jn(S)):(u&&g.setOrthoWidth(l*X),p?(g.setEye(_.lerpVectors(o,H,X).toArray()),g.setCenter(_.lerpVectors(o,t,X).toArray())):u||g.setEye(_.lerpVectors(t,H,X).toArray()),void 0)}}}(),setOrthoZoom:function(R,Q){return this.setZoom(R,Q)},getPositionInfo:function(h){var Y=this,x=Y._eye,S=Y._center,j=Y.getAspect(),q=h?hk(Wc(S,x,!0),Wc(h,x)):Sn(x,S);if(Y._ortho){var s=Y._orthoWidth;return{length:q,height:s/j,width:s}}var I=2*nm(Y._fovy/2)*q;return{length:q,height:I,width:I*j}},getCenterInfo:function(){var o=this;return o._81O||(o._81O=o.getPositionInfo()),ns(o._81O)},rotate:function(s,q,V,R){var J=this;if(s||q){R==U&&(R=J._firstPersonMode),J._88O&&J._88O.stop(!0);var D=J._center,O=J._eye,p=J.getCenterInfo().length,h=R?D:O,f=R?O:D,T=Wc(h,f),F=dj(T[0],T[2]),l=dj(j(T[0]*T[0]+T[2]*T[2]),T[1]),Z=R?Rp:wi;return R&&(q=-q),(V=Li(V))?(V.action=function(n){J.fi({kind:J._rotating?"betweenRotate":"beginRotate"}),J._rotating=1;var E=F+s*n,w=l+q*n;w=R?S-Io(J,S-w):Io(J,w),T[0]=p*_(w)*_(E),T[1]=p*b(w),T[2]=p*_(w)*b(E),h[0]=f[0]+T[0],h[1]=f[1]+T[1],h[2]=f[2]+T[2],J.fp(Z,U,h)},V._37o=function(){delete J._88O,delete J._rotating,J.fi({kind:"endRotate"}),J.onRotateEnded()},J._88O=Jn(V)):(F+=s,l+=q,l=R?S-Io(J,S-l):Io(J,l),T[0]=p*_(l)*_(F),T[1]=p*b(l),T[2]=p*_(l)*b(F),h[0]=f[0]+T[0],h[1]=f[1]+T[1],h[2]=f[2]+T[2],J.fp(Z,U,h),void 0)}},pan:function(v,O,d,N){if(v||O){var G=this;N==U&&(N=G._firstPersonMode),G._89O&&G._89O.stop(!0);var m=Jq(G),x=[m[0]*v,m[4]*v,m[8]*v],Y=[m[1]*O,m[5]*O,m[9]*O],o=x[0]+Y[0],s=x[1]+Y[1],p=x[2]+Y[2],e=G._center,X=G._eye;if(N){var z=rg(G.getBoundaries(),X[0],X[2],X[0]+o,X[2]+p,j(o*o+p*p));o=z[0],p=z[1]}if(d=Li(d)){var P=ns(X),i=ns(e);return d.action=function(u){G.fi({kind:G._panning?"betweenPan":"beginPan"}),G._panning=1,e[0]=i[0]+o*u,e[1]=i[1]+s*u,e[2]=i[2]+p*u,X[0]=P[0]+o*u,X[1]=P[1]+s*u,X[2]=P[2]+p*u,G.fp(wi,U,X),G.fp(Rp,U,e)},d._37o=function(){delete G._89O,delete G._panning,G.fi({kind:"endPan"}),G.onPanEnded()},G._89O=Jn(d)}e[0]+=o,e[1]+=s,e[2]+=p,X[0]+=o,X[1]+=s,X[2]+=p,G.fp(wi,U,X),G.fp(Rp,U,e)}},walk:function(S,z,I){if(S){var m=this;I==U&&(I=m._firstPersonMode),m._90O&&m._90O.stop(!0);var g=m._center,j=m._eye,h=Wc(g,j,!0);if(I){var M=rg(m.getBoundaries(),j[0],j[2],j[0]+h[0]*S,j[2]+h[2]*S,k(S));if(S=Sn(M),!S)return;h=[M[0]/S,0,M[1]/S]}if(z=Li(z)){var w=ns(j),d=ns(g);return z.action=function($){m.fi({kind:m._walking?"betweenWalk":"beginWalk"}),m._walking=1;var y=S*$;j[0]=w[0]+h[0]*y,j[1]=w[1]+h[1]*y,j[2]=w[2]+h[2]*y,g[0]=d[0]+h[0]*y,g[1]=d[1]+h[1]*y,g[2]=d[2]+h[2]*y,m.fp(wi,U,j),m.fp(Rp,U,g)},z._37o=function(){delete m._90O,delete m._walking,m.fi({kind:"endWalk"}),m.onWalkEnded()},m._90O=Jn(z)}j[0]+=h[0]*S,j[1]+=h[1]*S,j[2]+=h[2]*S,g[0]+=h[0]*S,g[1]+=h[1]*S,g[2]+=h[2]*S,m.fp(wi,U,j),m.fp(Rp,U,g)}},handleScroll:function(U,q){Uh(U);var l=this,x=l._moveStep,d=l.getDataInfoAt(U);if(d){var _=d.data;if(_&&l.isInteractive(_)){var J=l.intersectObject(U,_);if(J){var f=J.part,b=Kj(_.s(f+".image")||_.s("shape3d."+f+".image")||_.s("all.image")||_.s("shape3d.image"));if(b&&zi(b.scrollable,_,l))return}}}return l.isFirstPersonMode()?(l.isPannable()&&l.pan(0,q>0?x:-x),void 0):(l.isZoomable()&&(l._lastZoomLP=l.lp(U),l.setZoom(0>q?1/ug:ug),l._lastZoomLP=l._lastZoomHit=null),void 0)},handlePinch:function(A,Y){if(this.isZoomable()){if(Math.abs(A-Y)<G.pinchZoomThreshold)return;this.setZoom(Y>A?1/Qg:Qg)}},reset:function($){this.setUp(G.graph3dViewUp),this.moveCamera(G.graph3dViewEye,G.graph3dViewCenter,$)},moveSelection:function(s,u,N){var b=this;b.dm().beginTransaction(),we(this.sm().toSelection(this.isMovable,this),s,u,N),b.dm().endTransaction()},getMoveMode:function(e,T){var W=T.s("3d.move.mode");if(W)return W;var K="88",n="89",z="90";return zm(e)||Dk[K]&&Dk[n]&&Dk[z]?"xyz":Dk[K]&&Dk[n]?"xy":Dk[K]&&Dk[z]?"xz":Dk[n]&&Dk[z]?"yz":Dk[K]?"x":Dk[n]?"y":Dk[z]?"z":"xz"},handleTick:function(){var s=this,K=!1,w=s._moveStep,R=w,p=!1,z=!0,j=s._rotateStep*(z?-1:1);if(s.isWalkable()||(R=0),s.isPannable()||(w=0),s.isRotatable()||(j=0),s._32Q){var Z=(rq()-s._32Q)/50;R*=Z,w*=Z,j*=Z}s._31Q&&(An(s._31Q),delete s._31Q,delete s._32Q),cj()&&(K=!0,s.pan(-w,0,p,z)),Bc()&&(K=!0,s.pan(w,0,p,z)),Th()&&(K=!0,zm()?s.pan(0,w,p,z):s.walk(R,p,z)),gr()&&(K=!0,zm()?s.pan(0,-w,p,z):s.walk(-R,p,z)),Go()&&(K=!0,s.rotate(-j,0,p,z)),ib()&&(K=!0,s.rotate(j,0,p,z)),uq()&&(K=!0,s.rotate(0,-j/2,p,z)),Ok()&&(K=!0,s.rotate(0,j/2,p,z)),K&&(s._32Q=rq(),s._31Q=xk(s.handleTick,s))},handleKeyDown:function(w){var l=this;!Pm(w)&&yp[w.keyCode]?l.handleTick():Qb(w)?l.selectAll():Nc(w)?l.handleDelete(w):Tr(w)&&this.isResettable()&&l.reset()},checkDoubleClickOnNote:function(l,i,h){var G=this;if(h===oj){if(i.s("note.toggleable"))return i.s(Ep,!i.s(Ep)),G.fi({kind:"toggleNote",event:l,data:i,part:h}),!0}else if(h===ok&&i.s("note2.toggleable"))return i.s(zf,!i.s(zf)),G.fi({kind:"toggleNote2",event:l,data:i,part:h}),!0;return!1},checkDoubleClickOnRotation:function(y,k,c){return c===Js?(k.setRotationX(0),!0):c===Ks?(k.setRotationY(0),!0):c===Ls?(k.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(G){var r=this;if(r.isOrtho())return r.getWidth()/r.getOrthoWidth();var V=r.getCenter(),x=r.getHeight(),y=r.getEye(),h=[V[0]-y[0],V[1]-y[1],V[2]-y[2]],w=[G[0]-y[0],G[1]-y[1],G[2]-y[2]],F=Math.sqrt(h[0]*h[0]+h[1]*h[1]+h[2]*h[2]),v=1/Math.tan(r.getFovy()/2);return x*F*v/(w[0]*h[0]+w[1]*h[1]+w[2]*h[2])},inViewSpace:function(Y){var f,j=this,e=j._transformPointToViewSpace(Y),P=j.getAspect(),t=j.getNear(),m=j.getFar();return-e[2]<t||-e[2]>m?!1:j.isOrtho()?(f=j.getOrthoWidth()/2,Math.abs(e[0])<=f&&Math.abs(e[1]*P)<=f):(f=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])*Math.tan(j.getFovy()/2),Math.abs(e[1]<=f)&&Math.abs(e[0])<=f*P)},getPVMatrix:function(){var k,w=this;return(k=w._18Q)||(k=Ro(w),w._18Q=Lo(k,k,Jq(w)),w._18Q._wh=w.getWidth()/2/w.getHeight()),k},getFrustum:function(){var _=new Jc,X=new sb,x=new Array(16);return function(){for(var $=this.getPVMatrix(),d=!1,D=0;16>D;D++)$[D]!==x[D]&&(d=!0,x[D]=$[D]);return d&&X.setFromMatrix(_.fromArray($)),X}}(),toViewPosition:function(B){var P=this,j=P.getWidth()/2,l=P.getHeight()/2,V=P.getPVMatrix();return B=je([B[0],B[1],B[2],1],V),{x:j+j*B[0]/B[3],y:l-l*B[1]/B[3],z:B[2]/B[3]}},getHitPosition:function(y,S,I){var K=this,v=K.getWidth(),J=K.getHeight(),F=y.target?K.lp(y):y,a=F.x-v/2,X=F.y-J/2,s=K.getCenterInfo(),i=Jq(K);S=S?S:[0,0,0],I=I?I:[0,1,0],a=a/v*s.width,X=-1*X/J*s.height;var P=[i[0]*a,i[4]*a,i[8]*a],M=[i[1]*X,i[5]*X,i[9]*X],C=[P[0]+M[0],P[1]+M[1],P[2]+M[2]],n=K.getCenter(),W=vg(K,S,I,[C[0]+n[0],C[1]+n[1],C[2]+n[2]]);return W?W:[0,0,0]},intersectObject:function(k,u){return this._raycaster.intersectObject(k,u)},intersectObjects:function(B,T,F){return this._raycaster.intersectObjects(B,T,F)},getLineLength:function(t){this.validate();var O=this.getData3dUI(t);if(O&&O.getCache){var h=O.getCache();if(h)return h[h.length-1].length}return 0},getLineOffset:function(v,G){var _=this.getData3dUI(v);if(_&&_.getCache){var I=_.getCache();if(I){var p=ph(I,G);if(!v.r3)return p;var S=v.r3();if(0===S[0]&&0===S[1]&&0===S[2])return p;var T=new Cc(v.p3()),M=new Cc(p.point).sub(T),f=new Cc(p.tangent).add(M),c=(new So).setFromEuler(new od(S,v.getRotationMode(),!0));return M.applyQuaternion(c),f.applyQuaternion(c),{point:M.add(T),tangent:f.sub(M).normalize()}}}return U},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(V,C,m){var P=this,O=P.getEye();O=[O[0],O[1],O[2]];var u=P.getCenter();if(u=[u[0],u[1],u[2]],V||(V=O),C||(C=u),P._flyAnim&&P._flyAnim.stop(!0),m=Li(m),!m)return P.setEye(V[0],V[1],V[2]),P.setCenter(C[0],C[1],C[2]),delete P._flyAnim,!0;var D=[V[0]-O[0],V[1]-O[1],V[2]-O[2]],I=[C[0]-u[0],C[1]-u[1],C[2]-u[2]];return m.action=function(v){P.setCenter(u[0]+I[0]*v,u[1]+I[1]*v,u[2]+I[2]*v),P.setEye(O[0]+D[0]*v,O[1]+D[1]*v,O[2]+D[2]*v)},m._37o=function(){delete P._flyAnim},P._flyAnim=Jn(m)},flyTo:function(){function j(Y,f,X){if(X instanceof C.Node){y.fromArray(Jl(X,f.getMat(X)));var h=X.getAnchor3d();Y.push((new Cc).set(0-h.x,0-h.y,0-h.z).applyMatrix4(y)),Y.push((new Cc).set(0-h.x,0-h.y,1-h.z).applyMatrix4(y)),Y.push((new Cc).set(0-h.x,1-h.y,0-h.z).applyMatrix4(y)),Y.push((new Cc).set(0-h.x,1-h.y,1-h.z).applyMatrix4(y)),Y.push((new Cc).set(1-h.x,0-h.y,0-h.z).applyMatrix4(y)),Y.push((new Cc).set(1-h.x,0-h.y,1-h.z).applyMatrix4(y)),Y.push((new Cc).set(1-h.x,1-h.y,0-h.z).applyMatrix4(y)),Y.push((new Cc).set(1-h.x,1-h.y,1-h.z).applyMatrix4(y))}}var S=new Cc,f=new Cc,b=new Cc,D=new Cc,L=new Cc,y=new Jc,r=new C.Math.Quaternion,X=new od,m=new en;return function(M,Q,G){var z=this;if(G!==c)Q={animation:Q,ratio:G};else{var B=typeof Q;("boolean"===B||"object"===B&&Q.duration)&&(Q={animation:Q})}Q=Q||{},S.fromArray(z.getEye()),f.fromArray(z.getCenter());var l,I,Y=[],O=Q.center,U=Q.distance===c;if(O&&b.fromArray(O),M||(M=z.dm().getDatas()),1===M.length&&(M=gg(M)?M.get(0):M[0]),M instanceof C.Node)O||b.fromArray(M.p3()),U&&(j(Y,z,M),l=Y.length);else{if(!M.length)return;if((U||!O)&&(Y=[],M.forEach(function(P){j(Y,z,P)}),l=Y.length,!l))return;O||(m.setFromPoints(Y),b.copy(m.min).add(m.max).multiplyScalar(.5))}if(z.setCenter(b.x,b.y,b.z),D.subVectors(S,f),Q.direction||Q.worldDirection){!Q.worldDirection&&M instanceof C.Node?r.setFromEuler(X.set(M.r3(),M.getRotationMode(),!0)):r.set(0,0,0,1);var w=D.length();D.fromArray(Q.worldDirection||Q.direction).applyQuaternion(r).setLength(w)}var y=0;if(U){var J,$,p,G=Q.ratio||.8,e=Q.xRatio||G,n=Q.yRatio||G;if(L.copy(D),z.isOrtho()){var T=-1/0;for(z._eye[0]=D.x+b.x,z._eye[1]=D.y+b.y,z._eye[2]=D.z+b.z,J=Ro(z),Lo(J,J,Jq(z)),I=0;l>I;I++)p=Y[I],$=je([p.x,p.y,p.z,1],J),T=Math.max(T,Math.max(Math.abs($[0])/e,Math.abs($[1])/n));y=z.getOrthoWidth()*T}else{for(var q,V,H=z.getNear(),Z=10;Z--;){for(z._eye[0]=D.x+b.x,z._eye[1]=D.y+b.y,z._eye[2]=D.z+b.z,J=Ro(z),Lo(J,J,Jq(z)),q=!0,V=-1/0,I=0;l>I;I++){if(p=Y[I],$=je([p.x,p.y,p.z,1],J),$[3]<H&&Z){D.multiplyScalar(2),q=!1;break}V=Math.max(V,Math.max(Math.abs($[0])/e,Math.abs($[1])/n)-$[3])}if(q)break}D.setLength(V+D.length())}D.manhattanLength()<1e-6&&D.copy(L)}else D.setLength(Q.distance);var o=D.add(b);z._flyAnim&&z._flyAnim.stop(!0);var A=Li(Q.animation);if(A){z.setEye(S.x,S.y,S.z),z.setCenter(f.x,f.y,f.z);var W=(new Cc).subVectors(o,S),E=(new Cc).subVectors(b,f);if(y)var F=z.getOrthoWidth();var t=new Cc,a=new Cc,u=A.action,x=A._37o,P=S.clone(),k=f.clone();return A.action=function(x,Z){t.copy(P).addScaledVector(W,x),a.copy(k).addScaledVector(E,x),z.setCenter(a.x,a.y,a.z),z.setEye(t.x,t.y,t.z),y&&z.setOrthoWidth((y-F)*x+F),u&&u(x,Z)},A._37o=function(){delete z._flyAnim,x&&x()},{lastEye:S,lastCenter:f,eye:o,center:b,orthoWidth:y,animation:z._flyAnim=Jn(A)}}return z.setEye(o.x,o.y,o.z),y&&z.setOrthoWidth(y),delete z._flyAnim,{lastEye:S,lastCenter:f,eye:o,center:b,orthoWidth:y}}}(),getBoundingBox:function(){function J(o,Q,v){x.fromArray(Jl(v,Q.getMat(v)));var u=v.getAnchor3d();o.push((new Cc).set(0-u.x,0-u.y,0-u.z).applyMatrix4(x)),o.push((new Cc).set(0-u.x,0-u.y,1-u.z).applyMatrix4(x)),o.push((new Cc).set(0-u.x,1-u.y,0-u.z).applyMatrix4(x)),o.push((new Cc).set(0-u.x,1-u.y,1-u.z).applyMatrix4(x)),o.push((new Cc).set(1-u.x,0-u.y,0-u.z).applyMatrix4(x)),o.push((new Cc).set(1-u.x,0-u.y,1-u.z).applyMatrix4(x)),o.push((new Cc).set(1-u.x,1-u.y,0-u.z).applyMatrix4(x)),o.push((new Cc).set(1-u.x,1-u.y,1-u.z).applyMatrix4(x))}var x=new Jc;return function(r){if(r=r||this.sm().getSelection(),r instanceof C.Node&&(r=[r]),0===r.length)return U;var R=[];r.forEach(function(o){Je(o)&&J(R,this,o)},this);var M=[1/0,1/0,1/0],o=[-1/0,-1/0,-1/0];return R.forEach(function(l){M[0]=Math.min(l.x,M[0]),M[1]=Math.min(l.y,M[1]),M[2]=Math.min(l.z,M[2]),o[0]=Math.max(l.x,o[0]),o[1]=Math.max(l.y,o[1]),o[2]=Math.max(l.z,o[2])}),{min:M,max:o}}}(),setBatchInfo:function(R,y){var P=this._batchInfoMap[R];this._batchInfoMap[R]=y,this.fp("batchInfo",P,y)},getBatchInfo:function(L){return this._batchInfoMap[L]||Be[L]},setOrthoWidth:function(I){var t=this._orthoWidth;if(this._orthoWidth=I,this._syncEyeWithOrthoWidth){var m=I/this.getAspect(),b=m/2/nm(this.getFovy()/2),q=(new Cc).fromArray(this.getEye()),p=(new Cc).fromArray(this.getCenter());q.sub(p).setLength(b).add(p),this.setEye(q.toArray())}this.fp("orthoWidth",t,I)},getCamera:function(m){var X=this;m||(m=X._mainCamera,m||(m=X._mainCamera=new C.Camera)),m.s({"camera.type":X.isOrtho()?"ortho":"perspective","camera.aspect":X.getAspect(),"camera.fovy":X.getFovy(),"camera.ortho.width":X.getOrthoWidth(),"camera.near":X.getNear(),"camera.far":X.getFar()});var E=X.getEye();return m.p3(E.slice()),m.lookAt(X.getCenter(),X.getUp()),m}}),function(){function e(R,e,Z){var J=R[e];J&&J.releaseTexture(),R[e]=Z}function v(){return["\n #ifdef ENVMAP_TYPE_CUBE_UV \n","#define cubeUV_maxMipLevel 8.0 \n","#define cubeUV_minMipLevel 4.0 \n","#define cubeUV_maxTileSize 256.0 \n","#define cubeUV_minTileSize 16.0 \n","float getFace(vec3 direction) {","vec3 absDirection = abs(direction);","float face = - 1.0;","if (absDirection.x > absDirection.z) {","if (absDirection.x > absDirection.y)","face = direction.x > 0.0 ? 0.0 : 3.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","} else {","if (absDirection.z > absDirection.y) ","face = direction.z > 0.0 ? 2.0 : 5.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","}","return face;","} ","vec2 getUV(vec3 direction, float face) {","vec2 uv;","if (face == 0.0) {","uv = vec2(direction.z, direction.y) / abs(direction.x);","} else if (face == 1.0) {","uv = vec2(- direction.x, - direction.z) / abs(direction.y);","} else if (face == 2.0) {","uv = vec2(- direction.x, direction.y) / abs(direction.z);","} else if (face == 3.0) {","uv = vec2(- direction.z, direction.y) / abs(direction.x);","} else if (face == 4.0) {","uv = vec2(- direction.x, direction.z) / abs(direction.y);","} else {","uv = vec2(direction.x, direction.y) / abs(direction.z);","}","return 0.5 * (uv + 1.0);","} ","vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {","float face = getFace(direction);","float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);","mipInt = max(mipInt, cubeUV_minMipLevel);","float faceSize = exp2(mipInt);","float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);","vec2 uv = getUV(direction, face) * (faceSize - 1.0);","vec2 f = fract(uv);","uv += 0.5 - f;","if (face > 2.0) {","uv.y += faceSize;","face -= 3.0;","}","uv.x += face * faceSize;","if (mipInt < cubeUV_maxMipLevel) {","uv.y += 2.0 * cubeUV_maxTileSize;","}","uv.y += filterInt * 2.0 * cubeUV_minTileSize;","uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);","uv *= texelSize;","vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x += texelSize;","vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.y += texelSize;","vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x -= texelSize;","vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","vec3 tm = mix(tl, tr, f.x);","vec3 bm = mix(bl, br, f.x);","return mix(tm, bm, f.y);","}","\n #define r0 1.0 \n","#define v0 0.339 \n","#define m0 - 2.0 \n","#define r1 0.8 \n","#define v1 0.276 \n","#define m1 - 1.0 \n","#define r4 0.4 \n","#define v4 0.046 \n","#define m4 2.0 \n","#define r5 0.305 \n","#define v5 0.016 \n","#define m5 3.0 \n","#define r6 0.21 \n","#define v6 0.0038 \n","#define m6 4.0 \n","float roughnessToMip(float roughness) {","float mip = 0.0;","if (roughness >= r1) {","mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;","} else if (roughness >= r4) {","mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;","} else if (roughness >= r5) {","mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;","} else if (roughness >= r6) {","mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;","} else {","mip = - 2.0 * log2(1.16 * roughness);","}","return mip;","} ","vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {","float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);","float mipF = fract(mip);","float mipInt = floor(mip);","vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);","if (mipF == 0.0) {","return vec4(color0, 1.0);","} else {","vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);","return vec4(mix(color0, color1, mipF), 1.0);","}","} ","\n #endif \n"].join("")}function $(){return["vec4 sRGBToLinear( in vec4 value ) {","return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );","}","vec4 LinearTosRGB( in vec4 value ) {","return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );","}","vec4 inputTexelToLinear( vec4 value ) { return sRGBToLinear( value ); }","vec4 linearToOutputTexel( vec4 value ) { return LinearTosRGB( value ); }","vec4 envMapTexelToLinear( vec4 color ) { return inputTexelToLinear( color ); }"].join("")}function I(){return["precision mediump float;\n","precision mediump int;\n","attribute vec3 position;","attribute vec2 uv;","attribute float faceIndex;","varying vec3 vOutputDirection;","vec3 getDirection( vec2 uv, float face ) {","uv = 2.0 * uv - 1.0;","vec3 direction = vec3( uv, 1.0 );","if ( face == 0.0 ) { direction = direction.zyx; } ","else if ( face == 1.0 ) { direction = direction.xzy; direction.xz *= -1.0; } ","else if ( face == 2.0 ) { direction.x *= -1.0; }","else if ( face == 3.0 ) { direction = direction.zyx; direction.xz *= -1.0; } ","else if ( face == 4.0 ) { direction = direction.xzy; direction.xy *= -1.0; } ","else if ( face == 5.0 ) { direction.z *= -1.0; }","return direction;","}","void main() {","vOutputDirection = getDirection( uv, faceIndex );","gl_Position = vec4( position, 1.0 );","}"].join("")}function p(){return{vs:I(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform samplerCube envMap;\n",$(),"\n void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3(- vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function t(){return{vs:I(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform vec2 texelSize;\n",$(),"\n #define RECIPROCAL_PI 0.3183098861837907 \n","\n #define RECIPROCAL_PI2 0.15915494309189535 \n","vec2 equirectUv( in vec3 dir ) {","float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;","float v = 0.5 - asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI;","return vec2( u, v );","}","void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","vec3 outputDirection = normalize( vOutputDirection );","vec2 uv = equirectUv( outputDirection );","vec2 f = fract( uv / texelSize - 0.5 );","uv -= f * texelSize;","vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x += texelSize.x;","vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.y += texelSize.y;","vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x -= texelSize.x;","vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","vec3 tm = mix( tl, tr, f.x );","vec3 bm = mix( bl, br, f.x );","gl_FragColor.rgb = mix( tm, bm, f.y );","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function M(Z){return{vs:I(),fs:["precision mediump float;\n","precision mediump int;\n","#define n "+Z+"\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform int samples;","uniform float weights[ n ];","uniform bool latitudinal;","uniform float dTheta;","uniform float mipInt;","uniform vec3 poleAxis; \n",$(),"\n #define ENVMAP_TYPE_CUBE_UV \n",v(),"\n vec3 getSample( float theta, vec3 axis ) {","float cosTheta = cos( theta );","vec3 sampleDirection = vOutputDirection * cosTheta + cross(axis, vOutputDirection) * sin(theta) + axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);","return bilinearCubeUV( envMap, sampleDirection, mipInt );","}","void main() {","vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );","if ( all( equal( axis, vec3( 0.0 ) ) ) ) {","axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );","}","axis = normalize( axis );","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );","for ( int i = 1; i < n; i++ ) {","if ( i >= samples ) { break; }","float theta = dTheta * float( i );","gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );","gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );","}","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}var j=Vf.EnvmapRenderer=function(w){this.gv=w,this._envmaps={},this._envmapHash={},this._probeCaptureTime={},this._pingPongRenderTarget=null,this._equirectShader=null,this._cubemapShader=null,this._blurMaterial=null,this._lastCaptureFrame=0};j.prototype={},j.prototype.constructor=j,j.prototype.changeEnvmapType=function(k){"legacy"===k?(this.setEnvmapByProbeId=this.setEnvmapLegacy,this.onBeforeRender=this.onBeforeRenderLegacy):(this.setEnvmapByProbeId=this.setEnvmap,this.onBeforeRender=this.onBeforeRenderNew)},j.prototype.invalidateEnvmap=function(p){var h=this.gv;if("legacy"!==h.getEnvmapType()){var C=h.getGL();C&&(p?(delete this._envmapHash[p],delete this._probeCaptureTime[p]):(this._envmapHash={},this._probeCaptureTime={}),h.iv())}},j.prototype.onBeforeRenderLegacy=function(c){this.assureTextureLegacy(c)},j.prototype.assureTextureLegacy=function(v){var e=this,Y=e.gv,n=Y.getEnvmap();if(n!==e._lastLegacyImage){if(e._envmapLegacy&&(v.deleteTexture(e._envmapLegacy),e._envmapLegacy=null),!n)return e._lastLegacyImage=n,void 0;var c=G.getImage(n);if(c&&c.tagName){c=G.resizeImagePOT(c,!0);var P=e._envmapLegacy=v.createTexture();v.activeTexture(v.TEXTURE0),v.bindTexture(v.TEXTURE_CUBE_MAP,P),v.texParameteri(v.TEXTURE_CUBE_MAP,v.TEXTURE_MAG_FILTER,v.LINEAR),v.texParameteri(v.TEXTURE_CUBE_MAP,v.TEXTURE_MIN_FILTER,v.LINEAR),v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,c),v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,c),v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,c),v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,c),v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,c),v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,c),v.bindTexture(v.TEXTURE_CUBE_MAP,v._emptyCubeTexture),e._lastLegacyImage=n}}},j.prototype.setEnvmapLegacy=function(q){q.uEnvMap=this._envmapLegacy},j.prototype.onBeforeRenderNew=function(W){this.assureTextureNew(W),this.resetUniformCache()},j.prototype.assureTextureNew=function(P){var m=this,I=m.gv,A=I.getEnvmap(),T=m._envmapHash,W=m._envmaps,q=P._renderInfo.frame;if(!(this._lastCaptureFrame>=q||I._picking))for(var D in A){var d,L=A[D],z=L.type;switch(z){case"sphere":d=L.image,d!==T[D]&&(yb=G.getImage(d),yb&&(T[D]=d,e(W,D,m.fromEquirectangular(d))));break;case"cube":var y=L.images;if(y&&6===y.length&&(d=y.join(","),d!==T[D])){for(var o=!0,J=0;6>J;J++)if(!G.getImage(y[J])){o=!1;break}o&&(T[D]=d,e(W,D,m.fromCubemap(y)))}break;case"skybox":var i=I.getSkybox();if(i){var C=i.s("shape3d");if(d="sphere"===C?i._id+"_"+i.s("shape3d.image"):i._id+"_"+i.s("front.image"),d!==T[D]){var o;if("sphere"===C)o=G.getImage(i.s("shape3d.image"));else{o=!0;for(var N=["front","back","left","right","top","bottom"],J=0;6>J;J++)if(!G.getImage(i.s(N[J]+".image"))){o=!1;break}}o&&(T[D]=d,e(W,D,m.fromSkybox()))}}break;case"probe":var g=L.pos,Y=L.size;if(d=g[0]+"_"+g[1]+"_"+g[2]+"_"+Y,d!==T[D]){var U=this._probeCaptureTime[d],Z=Date.now();U||(this._probeCaptureTime[d]=U=Z),Z-U>G.envmapProbeMinWaitTime&&!Pe&&!Ur||Z-U>G.envmapProbeMaxWaitTime?(delete this._probeCaptureTime[d],T[D]=d,e(W,D,m.fromSceneProbe(g,Y,L.filter))):I.iv()}}}},j.prototype.resetUniformCache=function(){this._frameUniformCache={}},j.prototype.setEnvmap=function(b,X){var O=b.uuid,y=this._frameUniformCache,w=this._envmaps[X];w&&(w=w.texture),y[O]!==w&&(y[O]=w,b.uEnvMap=w)},j.prototype.fromEquirectangular=function(J){var e=C.Default.getImage(J);return this.rectSize=[1/e.width,1/e.height],J=this.gv.getTexture(J),this.fromTexture(J)},j.prototype.fromCubemap=function(j){var B=this.gv.getGL(),i=B.createTexture();B.activeTexture(B.TEXTURE0),B.bindTexture(B.TEXTURE_CUBE_MAP,i),B.texParameteri(B.TEXTURE_CUBE_MAP,B.TEXTURE_MAG_FILTER,B.LINEAR),B.texParameteri(B.TEXTURE_CUBE_MAP,B.TEXTURE_MIN_FILTER,B.LINEAR);for(var o=[],l=_/3,X=0;6>X;X++)o[X]=G.resizeImage(C.Default.getImage(j[X]),l);return B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,B.RGBA,B.RGBA,B.UNSIGNED_BYTE,o[0]),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,B.RGBA,B.RGBA,B.UNSIGNED_BYTE,o[1]),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,B.RGBA,B.RGBA,B.UNSIGNED_BYTE,o[2]),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,B.RGBA,B.RGBA,B.UNSIGNED_BYTE,o[3]),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,B.RGBA,B.RGBA,B.UNSIGNED_BYTE,o[4]),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,B.RGBA,B.RGBA,B.UNSIGNED_BYTE,o[5]),B.bindTexture(B.TEXTURE_CUBE_MAP,B._emptyCubeTexture),this.fromTexture(i,!0)},j.prototype.fromTexture=function(O,Q){var w=this._allocateTargets();this._pingPongRenderTarget||(this._pingPongRenderTarget=this._allocateTargets());var Y=this.gv,A=Y.getGL(),x=Ph.for(A).directState(),W=x.depth.enabled;x.scissor.enabled=!0,x.depth.enabled=!1;var K=Y.getViewport(A);return this._textureToCubeUV(O,w,Q),this._applyPMREM(w),w.unbind(A),Y.setViewport(A,K[0],K[1],K[2],K[3]),x.depth.enabled=W,x.scissor.enabled=!1,w},j.prototype.fromSkybox=function(){return this._fromCamera(function(D){D.s({"camera.onlySky":!0})})},j.prototype.fromScene=function(V){return this._fromCamera(function(R){R.s({"camera.onlySky":!1}),V&&V(R)})},j.prototype.fromNode=function(e){var v=this.gv.getData3dUI(e),a=v._42;v._42=cp;var q=this.gv.getSkybox(),Q=e.p3();if(q){var y=q.p3();q.p3(Q)}var R=this.fromScene(function(N){N.p3(Q)});return v._42=a,q&&q.p3(y),R},j.prototype.fromSceneProbe=function(s,I,B){var R=this.gv,M=R.getSkybox();if(M){var f=M.p3();M.p3(s)}if(B){var o=R.isVisible;R.isVisible=function(d){var f=B(d);return f!==c?f:o.call(R,d)}}var t=this.fromScene(function(P){P.p3(s),P.s("camera.near",I)});return B&&(R.isVisible=o),M&&M.p3(f),t},j.prototype._fromCamera=function(B){var I=this.gv,v=I.getCamera();B&&B(v);var G=new Ii(I,_,_,{cube:!0}),m=I.getGL(),o=I.getViewport(m),V=this.setEnvmapByProbeId,w=this.onBeforeRender;this.setEnvmapByProbeId=function(T){T.envMap=m._emptyTexture},this.onBeforeRender=cp,v.attachRenderTarget(G),v.render(I),v.detachRenderTarget(),this.setEnvmapByProbeId=V,this.onBeforeRender=w,I.setViewport(m,o[0],o[1],o[2],o[3]);var p=this.fromTexture(G.texture,!0);return G.releaseTexture(),p},j.prototype._allocateTargets=function(){return new Ii(this.gv,3*r,3*r,{magFilter:Gp.NEAREST,minFilter:Gp.NEAREST})},j.prototype._textureToCubeUV=function($,Q,v){var d,T=this.gv;v?null==(d=this._cubemapShader)&&(this._cubemapShader=d=this.createShader(p())):null==(d=this._equirectShader)&&(this._equirectShader=d=this.createShader(t()));var P=T.getGL();Q.bind(P),this._setViewport(Q,0,0,3*r,2*r);var c=T.getRenderState();c.useProgram(d);var K=c.directUniforms(),I=c.directAttribs();K.envMap=$,v||(K.texelSize=this.rectSize);var B=X[0];I.position=og(P,null,B.vs,U,3),I.uv=og(P,null,B.uv,U,2),I.faceIndex=og(P,null,B.faceIs,U,1),Kg(P,0,B.vs.length/3)},j.prototype._applyPMREM=function(Z){for(var G,S,I,G=1;y>G;G++)S=Math.sqrt(O[G]*O[G]-O[G-1]*O[G-1]),I=h[(G-1)%h.length],this._blur(Z,G-1,G,S,I)},j.prototype._setViewport=function(b,y,H,h,R){var w=this.gv;w.setViewport(w.getGL(),y,H,h,R),w.getRenderState().directState().scissor.box=[y,H,h,R]},j.prototype._blur=function(E,t,R,I,N){var G=this._pingPongRenderTarget;this._halfBlur(E,G,t,R,I,"latitudinal",N),this._halfBlur(G,E,R,R,I,"longitudinal",N)},j.prototype.createShader=function(h){var t=this.gv;return t.getPostProcessing().createShader(t.getGL(),h).program},j.prototype._halfBlur=function(x,e,v,C,d,i,j){var n=this.gv,G=this._blurMaterial;if("latitudinal"===i||"longitudinal"===i){G||(this._blurMaterial=G=this.createShader(M(l)));var R=n.getGL();e.bind(R);var D=3,g=n.getRenderState();g.useProgram(G);var B,F,$,J=g.directUniforms(),Q=g.directAttribs(),p=u[v]-1,Y=isFinite(d)?Math.PI/(2*p):2*Math.PI/(2*l-1),N=d/Y,y=isFinite(d)?1+Math.floor(D*N):l,W=[],L=0;for(B=0;l>B;++B)F=B/N,$=Math.exp(-F*F/2),W.push($),0==B?L+=$:y>B&&(L+=2*$);for(B=0;B<W.length;B++)W[B]=W[B]/L;J.envMap=x.texture,J.samples=y,J.weights=W,J.latitudinal="latitudinal"===i,j&&(J.poleAxis=j),J.dTheta=Y,J.mipInt=A-v;var t=u[C],F=3*Math.max(0,r-2*t),h=(0===C?0:2*r)+2*t*(C>A-k?C-A+k:0);
this._setViewport(e,F,h,3*t,2*t);var E=X[C];Q.position=og(R,null,E.vs,U,3),Q.uv=og(R,null,E.uv,U,2),Q.faceIndex=og(R,null,E.faceIs,U,1),Kg(R,0,E.vs.length/3),e.unbind(R)}};var k=4,A=8,r=Math.pow(2,A),S=[.125,.215,.35,.446,.526,.582],y=A-k+1+S.length,l=20,x=(1+Math.sqrt(5))/2,N=1/x,h=[new Cc(1,1,1),new Cc(-1,1,1),new Cc(1,1,-1),new Cc(-1,1,-1),new Cc(0,x,N),new Cc(0,x,-N),new Cc(N,0,x),new Cc(-N,0,x),new Cc(x,N,0),new Cc(-x,N,0)],V=function(){for(var e=[],D=[],b=[],n=A,F=0;y>F;F++){var O=Math.pow(2,n);D.push(O);var E=1/O;F>A-k?E=S[F-A+k-1]:0==F&&(E=0),b.push(E);for(var H=1/(O-1),a=-H/2,_=1+H/2,T=6,w=[],z=[],o=[],P=0;T>P;P++){var Y=2*(P%3)/3-1,f=P>2?0:-1;w.push(Y,f,0,Y+2/3,f,0,Y+2/3,f+1,0,Y,f,0,Y+2/3,f+1,0,Y,f+1,0),z.push(a,a,_,a,_,_,a,a,_,_,a,_),o.push(P,P,P,P,P,P)}e.push({vs:new Ek(w),uv:new Ek(z),faceIs:new Ek(o)}),n>k&&n--}return{_lodPlanes:e,_sizeLods:D,_sigmas:b}}(),X=V._lodPlanes,u=V._sizeLods,O=V._sigmas,_=G.EnvmapTextureSize}();var Vp=["left","front","right","back","top","bottom"],wo=Vf._RenderList=function(){function u(){H.length=0,i.length=0,Q={}}function Z(X){var k,e,O,q,h=X.gv,t=X.data,r=X.shapeModel;if(r){var H,v,m,d=t.s("shape3d.transparent")||t.s("points.transparent");for(zo(r)||(H=zi(r.transparent,t,h),r=[r]),O=0,q=r.length;q>O;O++)m=r[O],v=zi(m.transparent,t,h),v===c&&(v=H),v===c&&(v=d),v?e=!0:k=!0}for(O=0,q=Vp.length;q>O;O++){var R=X[Vp[O]];R&&(R.transparent?e=!0:k=!0)}h.isLabelVisible(t)&&(X.labelInfo&&(t.s(Np+".transparent")?e=!0:k=!0),X.label2Info&&(t.s(Kq+".transparent")?e=!0:k=!0)),h.isNoteVisible(t)&&(X.noteInfo&&(t.s(oj+".transparent")?e=!0:k=!0),X.note2Info&&(t.s(ok+".transparent")?e=!0:k=!0)),X._38o&&(e=k=!0),e||(k=!0),X._renderParams={opaque:k,transparent:e}}function m(j,a){a&&Z(j);var L=j.data,k=L._id;if(!Q[k]){Q[k]=!0;var I=j._renderParams;I&&I.visible!==!1&&(j={ui:j,data:L,z:0,id:k},I.opaque&&H.push(j),I.transparent&&i.push(j))}}function y(Y,z){if(i.length>1){for(var N,x,p=[0,0,0,0],G=0,l=i.length;l>G;G++)N=i[G].data,(x=N._position)?(p[0]=x.x,p[1]=N._54O,p[2]=x.y,p[3]=1,je(p,z),i[G].z=p[2]/p[3]):i[G].z=0;i.sort(Y||e)}}function I(u){u?(Mf(o,q,u),Mf(O,h,u),Mf(D,j,u)):(o=this.batchModelMap={},q=this.batchIndexMap={},O=this.polylineModelMap={},h=this.polylineIndexMap={},D=this.wireframeModelMap={},j=this.wireframeIndexMap={}),this.markBatchInvalid()}function w(v){v?Mf(o,q,v):(o=this.batchModelMap={},q=this.batchIndexMap={}),this.markBatchInvalid()}function V(D){D?Mf(O,h,D):(O=this.polylineModelMap={},h=this.polylineIndexMap={}),this.markBatchInvalid()}function b(O){O?Mf(D,j,O):(D=this.wireframeModelMap={},j=this.wireframeIndexMap={}),this.markBatchInvalid()}function S(){return this._batchInvalid}function x(){this._batchInvalid=!0}function g(){this._batchInvalid=null}var H=[],i=[],o={},q={},O={},h={},D={},j={},Q={};return{opaque:H,transparent:i,init:u,push:m,batchModelMap:o,batchIndexMap:q,polylineModelMap:O,polylineIndexMap:h,wireframeModelMap:D,wireframeIndexMap:j,ivBatch:I,ivModelBatch:w,ivPolylineBatch:V,ivWireframeBatch:b,markBatchInvalid:x,isBatchInvalid:S,onUpdated:g,sort:y}},Ab=Vf._RenderLists=function(){function C(){for(var P in I)I[P].init()}function h(){for(var e in I)I[e].onUpdated()}function Z(L,T){L=L||"main";var G=I[L];return!G&&T&&(G=I[L]=new wo),G}function P(o,n){var t=o.data.getRenderLayer(),u=Z(t,!0);u.push(o,n)}function Q(G){for(var D in I)G(I[D])}var I={};return{init:C,onUpdated:h,get:Z,push:P,each:Q,lists:I}},Ii=Vf.RenderTarget=function(S,X,o,T){var n,c=this;null!=X&&X.canvas?(n=X,X=o,o=T,T=arguments[4]):n=S.getGL(),T=T||{},T.cube===!!T.cube,T.samples=T.cube?0:Math.min(S._glCapabilities.maxSamples,T.samples&&T.samples>1&&2===S._webGLVersion?T.samples:0),c.options=T,c.uuid=C.Math.generateUUID(),c.gv=S,c.init(S,n,T),c.format=T.format||Gp.RGBA,c.generateMipmaps=!!T.generateMipmaps,T.samples&&!S._glCapabilities._maxSamplesChecked?c.setSize(n,X||1,o||1):c.setSize(n,X,o)};g.assign(Vf.RenderTarget.prototype,{bind:function(w,F){var N=this.options;if(N.autoSize){var G=this.gv,X=G.getDevicePixelRatio(),s=G.getWidth()*X,n=G.getHeight()*X;this.setSize(w,s,n)}N.cube?ql(w,this.frame[F]):ql(w,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(P){vr(P),this.options.samples&&(P.bindFramebuffer(P.READ_FRAMEBUFFER,this._MSAAFbo),P.bindFramebuffer(P.DRAW_FRAMEBUFFER,this.frame),P.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,P.COLOR_BUFFER_BIT,P.NEAREST),P.bindFramebuffer(P.READ_FRAMEBUFFER,null),P.bindFramebuffer(P.DRAW_FRAMEBUFFER,null))},isCube:function(){return this.options.cube},init:function(_,I,C){var v=this,g=C.samples,u=C.cube,j=v.texture=I.createTexture(),S=u?Gp.TEXTURE_CUBE_MAP:Gp.TEXTURE_2D;I.activeTexture(I.TEXTURE0),I.bindTexture(S,j),I.texParameteri(S,I.TEXTURE_WRAP_S,C.wrapS||I.CLAMP_TO_EDGE),I.texParameteri(S,I.TEXTURE_WRAP_T,C.wrapT||I.CLAMP_TO_EDGE);var K=g?I.NEAREST:I.LINEAR;if(I.texParameteri(S,I.TEXTURE_MIN_FILTER,C.minFilter||K),I.texParameteri(S,I.TEXTURE_MAG_FILTER,C.magFilter||K),I.bindTexture(S,null),u){v.depth=[],v.frame=[];for(var X=0;6>X;X++)v.depth[X]=I.createRenderbuffer(),v.frame[X]=I.createFramebuffer()}else v.depth=I.createRenderbuffer(),v.frame=I.createFramebuffer();v.assureTexture()},assureTexture:function(){var H=this;H.gv._2Oi(H.uuid,H.texture,"default")},releaseTexture:function(){this.gv.deleteTexture(this.uuid)},setSize:function(I,P,t){var M=this;if(P=Math.round(P),t=Math.round(t),P&&t&&(M.width!==P||M.height!==t)){M.width=P,M.height=t;var d=I.RENDERBUFFER,j=I.FRAMEBUFFER,S=M.options.samples,z=M.options.cube,w=z?Gp.TEXTURE_CUBE_MAP:Gp.TEXTURE_2D;if(S){var B=M.gv._glCapabilities;if(!B._maxSamplesChecked){for(I.bindRenderbuffer(d,M.depth),I.getError();S>1&&(I.renderbufferStorageMultisample(d,S,I.DEPTH_COMPONENT16,P,t),I.getError());)S=Math.floor(S>>1);1>=S&&(S=0,I.texParameteri(w,I.TEXTURE_MIN_FILTER,M.options.minFilter||I.LINEAR),I.texParameteri(w,I.TEXTURE_MAG_FILTER,M.options.magFilter||I.LINEAR),I.renderbufferStorage(d,I.DEPTH_COMPONENT16,P,t)),B._maxSamplesChecked=!0,B.maxSamples=M.options.samples=S,I.bindRenderbuffer(d,U)}}if(S&&(M._MSAAFbo||(M._MSAAFbo=I.createFramebuffer(),M._MSAARbO=I.createRenderbuffer()),I.bindRenderbuffer(d,M._MSAARbO),I.renderbufferStorageMultisample(I.RENDERBUFFER,S,I.RGBA8,P,t),I.bindFramebuffer(j,M._MSAAFbo),I.framebufferRenderbuffer(j,I.COLOR_ATTACHMENT0,d,M._MSAARbO),I.framebufferRenderbuffer(j,I.DEPTH_ATTACHMENT,d,M.depth),I.bindFramebuffer(j,null),I.bindRenderbuffer(d,null)),I.activeTexture(I.TEXTURE0),I.bindTexture(w,M.texture),z)for(var Z=I.TEXTURE_CUBE_MAP_POSITIVE_X,h=0;6>h;h++)M.setupFrameBufferTextureAndDepth(I,M.frame[h],M.depth[h],Z+h);else M.setupFrameBufferTextureAndDepth(I,M.frame,M.depth,I.TEXTURE_2D);if(M.generateMipmaps&&(2===gv._webGLVersion||Up.isPOT(P)&&Up.isPOT(t))){I.generateMipmap(w);var K=M.options.minFilter||(S?I.NEAREST:I.LINEAR);I.texParameteri(w,I.TEXTURE_MIN_FILTER,K===I.NEAREST?I.NEAREST_MIPMAP_NEAREST:I.LINEAR_MIPMAP_LINEAR)}I.bindTexture(w,null)}},setupFrameBufferTextureAndDepth:function(T,v,J,t){var D=this,m=D.format;T.texImage2D(t,0,m,this.width,this.height,0,m,T.UNSIGNED_BYTE,null),T.bindFramebuffer(T.FRAMEBUFFER,v),T.framebufferTexture2D(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,t,D.texture,0),this.setupRenderBufferStorage(T,J),T.bindFramebuffer(T.FRAMEBUFFER,null)},setupRenderBufferStorage:function(O,c){var N=this,m=O.RENDERBUFFER;O.bindRenderbuffer(m,c);var V=N.options.samples;V?O.renderbufferStorageMultisample(m,V,O.DEPTH_COMPONENT16,N.width,N.height):(O.renderbufferStorage(m,O.DEPTH_COMPONENT16,N.width,N.height),O.framebufferRenderbuffer(O.FRAMEBUFFER,O.DEPTH_ATTACHMENT,m,c)),O.bindRenderbuffer(O.RENDERBUFFER,null)},toCanvas:function(){var O=this,d=O.gv.getGL();ql(d,O.frame);var c=O.width,T=O.height,R=new Uint8Array(4*c*T);d.readPixels(0,0,c,T,O.format,d.UNSIGNED_BYTE,R),vr(d);var _=X.createElement("canvas");_.width=c,_.height=T;var m=_.getContext("2d"),y=m.createImageData(c,T);return y.data.set(R),m.putImageData(y,0,0),_}});var Sj=Vf.Interactor=function($){this.gv=this.g3d=$};Sc("Interactor",g,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()},fi:function(j){this.gv.fi(j)},startDragging:function(_){Ir(this,_)}});var Lf=Vf.DefaultInteractor=function(n){Zn(Lf,this,[n])};Sc("DefaultInteractor",Sj,{getState:function(){return this._62O},setState:function($){this._62O=$},getDataInfoAt:function(c,t){var g=this.gv,o=g.getDataInfoAt(c);if(!g.isBlockSelectable()||!o||!o.data)return o;if(!t&&g.isSelected(o.data))return o;for(var V=o.data;(V=V.getParent())&&V instanceof C.Block&&g.isSelectable(V);){var N=g.isSelected(V);if(N&&t)break;if(o={data:V,part:o.part},N&&!t)break}return o},handle_contextmenu:function(S){Uh(S)},handle_mousewheel:function(l){this.gv.handleScroll(l,l.wheelDelta/40)},handle_DOMMouseScroll:function(v){2===v.axis&&this.gv.handleScroll(v,-v.detail)},handle_keydown:function(_){this.gv.handleKeyDown(_)},handle_mousedown:function(T){this.handle_touchstart(T)},handle_touchstart:function(X){Uh(X);var B=this,b=B.gv,c=dr(X),Y=B.getDataInfoAt(X),f=Y?Y.data:U,V=Y?Y.part:U,l=b.sm(),p=to(X),T=mq(X);b.setFocus(X)&&(B._62O=U,B._57I=U,B.pendingClickThrough=U,B.__lastClientPoint__=Ae(X),f?Pm(X)?l.co(f)?l.rs(f):l.as(f):l.co(f)?f instanceof af&&f.isClickThroughEnabled()&&dr(X)&&(B.pendingClickThrough=Ae(X)):l.ss(f):c&&(Pm(X)?b.isRectSelectable()&&(B._62O=$e):B._57I=Ae(X)),B._31Q&&(An(B._31Q),delete B._31Q,delete B._32Q),B._62O||(b.isFirstPersonMode()&&(zm(X)||Ni(X)||T>2?B._62O="pan":b.isMouseRoamable()||ig(X)?(B._62O="roaming",B.foward=p&&dr(X),B._32Q=rq(),B._31Q=xk(B.tick,B)):c||(B._62O="roaming")),B._62O||(c&&p&&Ps[V]?(B._62O=V,B.p3=f.p3()):c&&p&&Je(f)&&b.isSelected(f)?b.isMovable(f)?(B._62O="move",B.p3=f.p3(),B.movedata=f):b._39Q(f)&&(B._62O="none"):ig(X)&&(T>2?B._62O="pan":2===T&&(B.dist=Xe(X),B._62O="pinch")))),B.point=b.lp(X),Ir(B,X),ar(X)?b.handleDoubleClick(X,f,V):b.handleClick(X,f,V))},tick:function(){var E=this,i=E.gv,G=i._moveStep;E.point&&i.isWalkable()&&(E._32Q&&(G*=(rq()-E._32Q)/50),i.walk(E.foward?G:-G),E._32Q=rq(),E._31Q=xk(E.tick,E))},handle_mouseup:function(u){this.handle_touchend(u)},handle_touchend:function(P){var i=this._57I;if(i&&(Sn(i,Ae(P))<=1&&this.gv.sm().cs(),this._57I=U),i=this.pendingClickThrough){if(Sn(i,Ae(P))<=1){var A=this.getDataInfoAt(P);A&&A.data instanceof af&&A.data.isClickThroughEnabled()&&(A=this.getDataInfoAt(P,!0),A&&(P.clickThrough=!0,this.gv.sm().ss(A.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(e){this.handleWindowTouchMove(e)},handleWindowTouchMove:function(n){var f,d,I=this,B=I.gv,g=I._62O,q=I.point,b=B.dm(),F=B.lp(n),M=F.x-q.x,Y=F.y-q.y,m=B.getWidth(),V=B.getHeight();if(m&&V){var E=Ae(n),H=Mm(B,E,I.__lastClientPoint__),N=Sn({x:0,y:0},H),w=-t*M/m,R=-t*Y/V;if("roaming"===g)I.rotate(n,w/2,R/2);else if(g===Js||g===Ks||g===Ls)B._86O||b.beginTransaction(),B.fi({kind:B._86O?"betweenEditRotation":"beginEditRotation",event:n}),B._86O=1,B.sm().each(function(r){if(Je(r)&&B.isRotationEditable(r)){var F=k(w)>k(R)?w:R;g===Js?r.setRotationX(r.getRotationX()+F):g===Ks?r.setRotationY(r.getRotationY()+F):g===Ls&&r.setRotationZ(r.getRotationZ()+F)}});else if("move"===g||Ps[g]){if(g===Ms||g===Ns||g===Os)B._87O||b.beginTransaction(),B.fi({kind:B._87O?"betweenEditScale":"beginEditScale",event:n}),B._87O=1;else{if(!B._moving){if(N<G.touchMoveThreshold)return;b.beginTransaction()}B.fi({kind:B._moving?"betweenMove":"beginMove",event:n}),B._moving=1}var v,P=I.p3,$=B.getPositionInfo(P),p=Jq(B);v=g===Gs?"x":g===Hs?"y":g===Is?"z":g===Ms?"sx":g===Ns?"sy":g===Os?"sz":B.getMoveMode(n,I.movedata),M=M/m*$.width,Y=-1*Y/V*$.height;var r,A,i=[p[0]*M,p[4]*M,p[8]*M],e=[p[1]*Y,p[5]*Y,p[9]*Y],_=i[0]+e[0],x=i[1]+e[1],c=i[2]+e[2],O=[P[0]+_,P[1]+x,P[2]+c],T=Wc(B.getEye(),O,!0);if("xyz"===v?(r=O,B.moveSelection(_,x,c)):"xz"===v?(r=vg(B,P,[0,1,0],O),r&&B.moveSelection(r[0]-P[0],0,r[2]-P[2])):"xy"===v?(r=vg(B,P,[0,0,1],O),r&&B.moveSelection(r[0]-P[0],r[1]-P[1],0)):"yz"===v?(r=vg(B,P,[1,0,0],O),r&&B.moveSelection(0,r[1]-P[1],r[2]-P[2])):"x"===v||"sx"===v?(T[0]=0,r=vg(B,P,T,O),r&&(A=r[0]-P[0],"x"===v?B.moveSelection(A,0,0):B.sm().each(function(J){Je(J)&&B.isSizeEditable(J)&&(f=J.getScaleX()+A/100,d=f/J.getScaleX(),J.setScaleX(f),zm(n)&&(J.setScaleY(J.getScaleY()*d),J.setScaleTall(J.getScaleTall()*d)))}))):"y"===v||"sy"===v?(T[1]=0,r=vg(B,P,T,O),r&&(A=r[1]-P[1],"y"===v?B.moveSelection(0,A,0):B.sm().each(function(w){Je(w)&&B.isSizeEditable(w)&&(f=w.getScaleTall()+A/100,d=f/w.getScaleTall(),w.setScaleTall(f),zm(n)&&(w.setScaleY(w.getScaleY()*d),w.setScaleX(w.getScaleX()*d)))}))):("z"===v||"sz"===v)&&(T[2]=0,r=vg(B,P,T,O),r&&(A=r[2]-P[2],"z"===v?B.moveSelection(0,0,A):B.sm().each(function(J){Je(J)&&B.isSizeEditable(J)&&(f=J.getScaleY()+A/100,d=f/J.getScaleY(),J.setScaleY(f),zm(n)&&(J.setScaleX(J.getScaleX()*d),J.setScaleTall(J.getScaleTall()*d)))}))),!r)return;I.p3=r}else if(g===$e){var o=I.div;o||(o=I.div=qg(),zp(I.getView(),o),o.op=q,o.style.background=B.getRectSelectBackground()),B.fi({kind:B._rectSelecting?"betweenRectSelect":"beginRectSelect",event:n}),B._rectSelecting=1,o.rect=Fq(o.op,F),Gq(o,o.rect)}else if("pinch"===g&&2===mq(n)){B.fi({kind:B._pinching?"betweenPinch":"beginPinch",event:n}),B._pinching=1;var A=Xe(n);B._lastZoomLP||(B._lastZoomLP=tb(n)),B.handlePinch(A,I.dist),I.dist=A}else"pan"===g||zm(n)||Ni(n)?I.pan(n,M,Y):"none"===g||B.isFirstPersonMode()||I.rotate(n,w,R);I.point=F}},pan:function(M,x,G){var y=this.gv;if(y.isPannable()){var B=y.getWidth(),S=y.getHeight();if(!B||!S)return;var W=y.getCenterInfo(),s=x/B*W.width,U=-1*G/S*W.height;y.fi({kind:y._panning?"betweenPan":"beginPan",event:M}),y._panning=1,y.pan(-s,-U)}},rotate:function(i,m,U){var L=this.gv;L.isRotatable()&&(L.fi({kind:L._rotating?"betweenRotate":"beginRotate",event:i}),L._rotating=1,L.rotate(m,U))},handleWindowMouseUp:function(H){this.handleWindowTouchEnd(H)},handleWindowTouchEnd:function(q){var z=this,W=z.gv,m=W.dm(),f=z.div;if(f){var V=W.getDatasInRect(f.rect);if(!V.isEmpty()){var o=W.sm(),r=o.toSelection(),L=zm(q),n=q.altKey;V.each(function(y){o.co(y)?(!L||L&&n)&&r.remove(y):(!n||L&&n)&&r.add(y)}),o.ss(r)}Oi(f)}W._moving&&(delete W._moving,W.fi({kind:"endMove",event:q}),W.onMoveEnded(),m.endTransaction()),W._panning&&(delete W._panning,W.fi({kind:"endPan",event:q}),W.onPanEnded()),W._rotating&&(delete W._rotating,W.fi({kind:"endRotate",event:q}),W.onRotateEnded()),W._86O&&(delete W._86O,W.fi({kind:"endEditRotation",event:q}),m.endTransaction()),W._87O&&(delete W._87O,W.fi({kind:"endEditScale",event:q}),m.endTransaction()),W._pinching&&(delete W._pinching,W.fi({kind:"endPinch",event:q}),W.onPinchEnded()),W._rectSelecting&&(delete W._rectSelecting,W.fi({kind:"endRectSelect",event:q}),W.onRectSelectEnded()),W._walking&&(delete W._walking,W.fi({kind:"endWalk",event:q}),W.onWalkEnded()),W._lastZoomLP=W._lastZoomHit=null,z.dist=z.point=z._62O=z.p3=z.movedata=z.div=z._57I=z.pendingClickThrough=z._32Q=z._31Q=z.foward=U,z.__lastClientPoint__=U}});var Lh=Vf.MapInteractor=function(J){Zn(Lh,this,[J]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this._minPhi=0,this._maxPhi=5*Math.PI/12};Sc("MapInteractor",Sj,{setUp:function(){Lh.superClass.setUp.call(this);var s=this.gv;this.__oldMinPhi__=s.getRotateMinPhi(),this.__oldMaxPhi__=s.getRotateMaxPhi(),s.setRotateMinPhi(this._minPhi),s.setRotateMaxPhi(this._maxPhi)},tearDown:function(){Lh.superClass.tearDown.call(this);var E=this.gv;E.setRotateMinPhi(this.__oldMinPhi__),E.setRotateMaxPhi(this.__oldMaxPhi__),delete this.__oldMinPhi__,delete this.__oldMaxPhi__},handle_contextmenu:function(S){Uh(S)},handle_mousewheel:function(U){this.gv.handleScroll(U,U.wheelDelta/40)},handle_DOMMouseScroll:function(F){2===F.axis&&this.gv.handleScroll(F,-F.detail)},handle_keydown:function(j){this.gv.handleKeyDown(j)},handle_mousedown:function(N){this.handle_touchstart(N)},handle_touchstart:function(f){Uh(f);var G=this,X=G.gv;if(X.setFocus(f)){var Y=X.getDataInfoAt(f),q=Y?Y.data:U,P=Y?Y.part:U,y=G.editing={point:X.lp(f)};ig(f)?y.touch=!0:(y.touch=!1,y.clickLeft=dr(f),y.pan=Ni(f)?!0:"left"===this.panButton===y.clickLeft),q&&X._39Q(q)&&(y.preventDefault=!0),Ir(G,f),ar(f)?X.handleDoubleClick(f,q,P):X.handleClick(f,q,P)}},handle_mouseup:function(G){this.handle_touchend(G)},handle_touchend:function(){},handleWindowMouseMove:function(_){this.handleWindowTouchMove(_)},handleWindowTouchMove:function(g){var v=this,q=v.gv,O=v.editing;if(O){var l=q.lp(g),Q=O.point,I=l.x-Q.x,B=l.y-Q.y;if(!O.moved){if(Math.abs(I)<v.threshold&&Math.abs(B)<v.threshold&&!(g.touches&&g.touches.length>1))return;O.moved=!0}if(!O.preventDefault)if(O.point=l,O.touch){var N=g.touches.length;if(2!==N)v.pan(g,I,B);else{if(1>=N)return;var k=g.touches,b={x:k[0].clientX,y:k[0].clientY},a={x:k[1].clientX,y:k[1].clientY},E={x:a.x-b.x,y:a.y-b.y},A=O.lastCenter,o=Math.atan2(E.y,E.x),W=O.theta,X=0;W==U?W=O.theta=o:(X=o-W,O.thetaStarted||Math.abs(X)>v.touchRotateThreshold?(O.thetaStarted=!0,O.theta=o):X=0);var h=S*(b.y+a.y)/2/q.getHeight(),u=O.phi,J=0;u==U?u=O.phi=h:(J=h-u,O.phiStarted||Math.abs(J)>v.touchRotateThreshold?(O.phiStarted=!0,O.phi=h):J=0);var y,r=Math.sqrt(E.x*E.x+E.y*E.y),p=O.vlen;if(p){var K=b.x-A.x,f=b.y-A.y,j=a.x-A.x,D=a.y-A.y,x=Math.sqrt(K*K+f*f),F=Math.sqrt(j*j+D*D),G=p/2,H=v._sign2(x-G),P=v._sign2(F-G);0>H*P||0===H&&0===P?(y=1,O.vlen=r):(y||(y=r/p),O.scaleStarted||Math.abs(y-1)>v.touchScaleThreshold?(O.vlen=r,O.scaleStarted=!0):y=1)}else p=O.vlen=r,y=1;1!==y&&q.setZoom(y),(J||X)&&v.rotate(g,X,-J),O.lastCenter={x:(a.x+b.x)/2,y:(a.y+b.y)/2}}}else if(O.pan)v.pan(g,I,B);else{var T=q.getWidth(),n=q.getHeight();if(!T||!n)return;var C=-t*I/T,Z=-t*B/n;v.rotate(g,C,Z)}}},_sign2:function(B){return Math.abs(B)<this._touchScaleCheckAccuracy?0:B>0?1:-1},handleWindowMouseUp:function(c){this.handleWindowTouchEnd(c)},getDataInfoAt:function(L,T){var w=this.gv,m=w.getDataInfoAt(L);if(!w.isBlockSelectable()||!m||!m.data)return m;if(!T&&w.isSelected(m.data))return m;for(var O=m.data,y=m.part;(O=O.getParent())&&O instanceof C.Block&&w.isSelectable(O);){var k=w.isSelected(O);if(k&&T)break;if(m={data:O,part:y},k&&!T)break}return m},handleWindowTouchEnd:function(i){var N=this,R=N.editing;if(N.editing=null,R){var L=N.gv;if(R.moved||!R.clickLeft&&!R.touch)L._panning=null,L._rotating=null,L.fi({kind:R.pan?"endPan":"endRotate",event:i});else{var X=N.getDataInfoAt(i),Y=X&&X.data;Y instanceof af&&Y.isClickThroughEnabled()&&(X=N.getDataInfoAt(i,!0),X&&(Y=X.data)),Y?L.sm().setSelection([Y]):L.sm().clearSelection()}}},pan:function(s,R,M){var l=this,c=l.gv;if(c.isPannable()){var P=c.getWidth(),H=c.getHeight();if(P&&H){var j=c.getCenterInfo(),y=-R/P*j.width,T=1*M/H*j.height;c.fi({kind:c._panning?"betweenPan":"beginPan",event:s}),c._panning=1;var L=l.keepHorizon,p=l.editing.touch;if((p&&s.touches&&s.touches.length>1||!p&&zm(s))&&(L=!L),!L)return c.pan(y,T);if(y||T){var e=Jq(c),F=[e[0]*y,e[4]*y,e[8]*y],w=[e[1],0,e[9]],h=Math.sqrt(w[0]*w[0]+w[2]*w[2]);h&&(w=[w[0]/h*T,0,w[2]/h*T]);var u=F[0]+w[0],r=F[1]+w[1],A=F[2]+w[2],k=c._center,Y=c._eye;k[0]+=u,k[1]+=r,k[2]+=A,Y[0]+=u,Y[1]+=r,Y[2]+=A,c.fp(wi,U,Y),c.fp(Rp,U,k)}}}},rotate:function(K,k,w){var q=this,R=q.gv;if(R.isRotatable()){var $=R._center,S=R._eye,y=Wc(S,$),I=dj(j(y[0]*y[0]+y[2]*y[2]),y[1]),n=Io(R,I+w);w=n-I,R.fi({kind:R._rotating?"betweenRotate":"beginRotate",event:K}),R._rotating=1,R.rotate(k,w)}}}),g.defineProperties(Lh.prototype,{panButton:{get:function(){return this._panButton},set:function(h){this._panButton=h}},minPhi:{get:function(){return this._minPhi},set:function(I){this.gv.setRotateMinPhi(this._minPhi=I)}},maxPhi:{get:function(){return this._maxPhi},set:function(Y){this.gv.setRotateMaxPhi(this._maxPhi=Y)}},keepHorizon:{get:function(){return this._keepHorizon},set:function(g){this._keepHorizon=g}},threshold:{get:function(){return this._threshold},set:function(f){this._threshold=f}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(_){this._touchScaleThreshold=_}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(Y){this._touchRotateThreshold=Y}}});var Cl,Ym="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",Zd=32,tf=Vf.GlobeInteractor=function(V,g){Zn(tf,this,[V]);var P,Y=g.radius||6378137,J=this,f=null;Cl||(Cl=qg(),Cl.style.border="",Cl.style.backgroundImage="url("+Ym+")");var I=new So,b=new Cc,F=new Cc,x=new Cc,q=new Tp,c="number"==typeof Y?{x:Y,y:Y,z:Y}:Y,T={center:new Cc(0,0,0),radius:c},o=function(N){V._81O=null;var z=V.getHitPosition(N,V.getCenter(),b.copy(V.getEye()).sub(F.copy(V.getCenter())).toArray());return q.origin.copy(V.getEye()),q.direction.copy(z).sub(q.origin).normalize(),q.intersectEllipsoid(T)},N=function(x,s){V._81O=null,q.origin.copy(V.getEye());for(var t,n,y=V.getCenter(),w=b.copy(V.getEye()).sub(F.copy(V.getCenter())).toArray(),Z=1,z=16,e=0,_=1,f={x:0,y:0};z--;){if(f.x=s.x+(x.x-s.x)*Z,f.y=s.y+(x.y-s.y)*Z,t=V.getHitPosition(f,y,w),q.direction.copy(t).sub(q.origin).normalize(),n=q.intersectEllipsoid(T),n&&1===Z)return{hit:n};n?e=Z:_=Z,Z=(e+_)/2}return{hit:n,out:1>Z}},Z=function(i,F){if(f){var G=Date.now();f.deltaTime=f.lastTime?G-f.lastTime:1e3,f.lastTime=G,f.lastAxis=i,f.lastAngle=F}F&&(I.setFromAxisAngle(i,F),V.setEye(b.copy(V.getEye()).applyQuaternion(I).toArray()),V.setCenter(b.copy(V.getCenter()).applyQuaternion(I).toArray()),V.setUp(b.copy(V.getUp()).applyQuaternion(I).toArray()))};J._showCrossIcon=function(b){zp(J.getView(),Cl),Gq(Cl,{x:b.clientX-Zd/2,y:b.clientY-Zd/2,width:Zd,height:Zd})},J._hideCrossIcon=function(){Oi(Cl)},J._scrollImpl=function(x,G){f={point:V.lp(x),screen:Ae(x),hit:o(x),type:"right"},f.hitNormalize=f.hit?f.hit.clone().normalize():new Cc;var D={clientX:f.screen.x,clientY:f.screen.y+10*G};J._handleMoveImpl(D),J._endMoveImpl(D)},J._startMoveImpl=function(y){P&&(P.stop(!0),P=null),f={point:V.lp(y),screen:Ae(y),hit:o(y)},f.hitNormalize=f.hit?f.hit.clone().normalize():new Cc,ig(y)?1===y.touches.length?f.hit&&(f.type="left"):2===y.touches.length&&(f.type="touch2"):(dr(y)?f.hit&&(f.type="left"):Ug(y)?f.type="right":Ni(y)&&f.hit&&(f.type="middle"),!f.hit||"right"!==f.type&&"middle"!==f.type||J._showCrossIcon(y)),f.type&&Ir(J,y)},J._handleMoveImpl=function(e){if(f)switch(f.type){case"left":return J._handleLeft(e);case"right":return J._handleRight(e);case"middle":return J._handleMiddle(e);case"touch2":return J._handleTouch2(e)}},J._endMoveImpl=function(){if(f){if(this._hideCrossIcon(),"left"===f.type||"middle"===f.type){var _=1e3*(f.lastAngle/(f.deltaTime||30)),D=f.lastAxis,G=f.lastTime,S=function(){var p=Date.now(),M=(p-G)/1e3;return G=p,_*=Math.pow(Math.abs(J.decelerationRate),3*M),Math.abs(_)<.01?(_=0,P&&P.stop(),void 0):(Z(D,_*M),void 0)};P=Jn({action:function(){S(arguments)},duration:5e3})}f=null}},J._handleLeft=function(B){if(!f.finished){var K=Ae(B),L=N(K,f.lastScreen||f.screen);if(f.lastScreen=K,!L.hit)return f.finished=!0,J._endMoveImpl(B),void 0;var O=L.hit;O.normalize();var b=f.hitNormalize,r=Math.acos(O.dot(b)),e=O.cross(b).normalize();Z(e,r),L.out&&(f.finished=!0,J._endMoveImpl(B))}},J._handleRight=function(E){var O=f.lastScreen||f.screen,T=O.y;O=f.lastScreen=Ae(E);var w=O.y,j=w-T;if(j){var g=Math.min(.5,j*J.scaleSpeed);b.copy(V.getEye());var M=f.hit;M||(M=b.clone().divide(c).normalize().multiply(c)),F.copy(b).lerp(M,g),V.setEye(F.toArray()),b.copy(V.getUp()),F.normalize();var d=b.clone().cross(F).normalize();if(x.copy(V.getCenter()),x.sub(d.multiplyScalar(x.dot(d))),V.setCenter(x.toArray()),f.hit){var P=o(f.screen),L=f.hitNormalize;if(P){P.normalize();var B=Math.acos(P.dot(L)),A=P.cross(L).normalize();B&&Z(A,B)}}}};var X=function(b){return Math.abs(b)<.01?0:b>0?1:-1};J._handleTouch2=function(A){var K=A.touches.length;if(2===K){var s=A.touches,d={x:s[0].clientX,y:s[0].clientY},B={x:s[1].clientX,y:s[1].clientY},E={x:B.x-d.x,y:B.y-d.y},w=f.lastCenter,l=Math.atan2(E.y,E.x),q=f.theta,h=0;q==U?q=f.theta=l:(h=l-q,f.thetaStarted||Math.abs(h)>.03?(f.thetaStarted=!0,f.theta=l):h=0);var _,J=Math.sqrt(E.x*E.x+E.y*E.y),Q=f.vlen;if(Q){var j=d.x-w.x,I=d.y-w.y,o=B.x-w.x,b=B.y-w.y,n=Math.sqrt(j*j+I*I),a=Math.sqrt(o*o+b*b),R=Q/2,z=X(n-R),W=X(a-R);0>z*W||0===z&&0===W?(_=1,f.vlen=J):(_||(_=J/Q),f.scaleStarted||Math.abs(_-1)>.05?(f.vlen=J,f.scaleStarted=!0):_=1)}else Q=f.vlen=J,_=1;var E=F.copy(V.getEye()).clone();1!==_&&V.setEye(E.setLength((E.length()-Y)/_+Y).toArray()),h&&Z(E.normalize(),h),f.lastCenter={x:(B.x+d.x)/2,y:(B.y+d.y)/2}}},J._handleMiddle=function(H){var U=Ae(H),Q=f.screen;f.screen=U;var n=(U.y-Q.y)/180*Math.PI*J.rollSpeed;F.copy(V.getCenter()).sub(b.copy(V.getEye())).normalize(),b.copy(V.getUp()).cross(F).normalize(),F.copy(V.getEye()).sub(f.hit).applyAxisAngle(b,n).add(f.hit);var i=F.clone();F.copy(V.getCenter()).sub(f.hit).applyAxisAngle(b,n).add(f.hit);var s=F.clone(),$=F.copy(V.getUp()).applyAxisAngle(b,n).clone(),w=!1;n>0&&(x.copy($),F.copy(s).sub(i).normalize(),b.copy(i).multiplyScalar(-1).normalize(),b.dot(x)-F.dot(x)>0&&(w=!0)),w||x.copy(f.hit).sub(i).dot(f.hitNormalize)>=0&&(w=!0),w||(V.setEye(i.toArray()),V.setCenter(s.toArray()),V.setUp($.toArray()));var z=-(U.x-Q.x)/180*Math.PI*J.rotateSpeed;Z(f.hitNormalize,z)}};Sc("GlobeInteractor",Sj,{handle_contextmenu:function(h){Uh(h)},handle_mousewheel:function(h){this._scrollImpl(h,h.wheelDelta/40)},handle_DOMMouseScroll:function(l){2===l.axis&&this._scrollImpl(l,-l.detail)},handle_keydown:function(A){this.gv.handleKeyDown(A)},handle_mousedown:function(l){this.handle_touchstart(l)},handle_touchstart:function(E){Uh(E);var F=this.gv;if(F.setFocus(E)){var v=F.getDataInfoAt(E),I=v?v.data:U;I&&F.isInteractive(I)||this._startMoveImpl(E);var p=v?v.part:U;ar(E)?F.handleDoubleClick(E,I,p):F.handleClick(E,I,p)}},handle_mouseup:function(c){this.handle_touchend(c)},handle_touchend:function(){},handleWindowMouseMove:function(U){this.handleWindowTouchMove(U)},handleWindowTouchMove:function(l){this._handleMoveImpl(l)},handleWindowMouseUp:function(M){this.handleWindowTouchEnd(M)},handleWindowTouchEnd:function(F){this._endMoveImpl(F)}}),g.defineProperties(tf.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(b){this._rotateSpeed=b}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(d){this._rollSpeed=d}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(k){this._scaleSpeed=k}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(R){this._decelerationRate=R}}});var se=function(Q){var h=2147483648|Q;return[(255&h>>16)/255,(255&h>>8)/255,(255&h)/255,(255&h>>24)/255]},lq=function(w){this.gv=w,this.gv.pickColorMap={_pickIdUsed:2e3}};Bb(lq,g,{_iv:!0,iv:function(){this._iv=!0},get:function(o,r,b){this.validate();var Z=this,M=Z.gv.getGL();if(!M)return U;var X,T,j=Z._resolution,i=Math.round(o.x*j),_=Math.ceil(o.width*j),P=Math.ceil(o.height*j),d=Z.height-Math.round(o.y*j)-P,e=A(_/2),c=new Uint8Array(4*_*P),z=0,u=c.length,a=r?U:new Vo,W=r?U:{};if(ql(M,Z.frame),M.readPixels(i,d,_,P,M.RGBA,M.UNSIGNED_BYTE,c),vr(M),r){for(;e>=z;z++)for(var G=e-z,q=e+z,v=G;q>=v;v++)for(var K=G;q>=K;K++)if((v===G||v===q||K===G||K===q)&&(X=Z.info(c,4*(v*_+K)))){if(b&&b(X)===!1)continue;return X}}else for(;u>z;z+=4)if(X=Z.info(c,z)){if(b&&b(X)===!1)continue;T=X.data,W[T._id]||(a.add(T),W[T._id]=T)}return a},info:function(R,s){return this.gv.pickColorMap[(R[s]<<16)+(R[s+1]<<8)+R[s+2]+((127&R[s+3])<<24)]},getResolution:function(){return this._resolution},onContextLost:function(){this.texture=null,this.width=this.height=-1},validate:function(){var P=this,Z=P.gv,Q=Z.getGL();if(Q){var R=P._resolution=Z._pickerResolution*Z.getDevicePixelRatio(),S=Math.round(R*Z.getWidth()),b=Math.round(R*Z.getHeight()),z=Q.RGBA,g=Q.TEXTURE_2D,V=Q.RENDERBUFFER,k=Q.FRAMEBUFFER;if(P.texture||(P.texture=Uf(Q),P.render=Q.createRenderbuffer(),P.frame=Q.createFramebuffer()),(P.width!==S||P.height!==b)&&(Q.activeTexture(Q.TEXTURE0),Qf(Q,P.texture),Q.texImage2D(g,0,z,S,b,0,z,Q.UNSIGNED_BYTE,U),Dg(Q,Q.TEXTURE_MIN_FILTER,Q.LINEAR),Q.bindRenderbuffer(V,P.render),Q.renderbufferStorage(V,Q.DEPTH_COMPONENT16,S,b),ql(Q,P.frame),Q.framebufferTexture2D(k,Q.COLOR_ATTACHMENT0,g,P.texture,0),Q.framebufferRenderbuffer(k,Q.DEPTH_ATTACHMENT,V,P.render),Qf(Q,U),Q.bindRenderbuffer(V,U),vr(Q),P.width=S,P.height=b),P._iv){P._iv=!1;var f=!1;Z._40Q.each(function(b){!f&&b.isBatchInvalid()&&(f=!0)}),f&&Z.updateScene(),ql(Q,P.frame),Q.clear(Q.COLOR_BUFFER_BIT),Z.overlappingBox.clear(),Z.setViewport(Q,0,0,S,b),Z.renderPickScene(),vr(Q)}}}});var Ds=function(u){this.gv=u};Bb(Ds,g,{gap:0,size:0,_42:function(p,m){var W=this,L=W.gv,S=L._gridGap,l=L._gridSize;if(L._gridVisible){if(W.gap!==S||W.size!==l){for(var I=[],M=L._gridSize/2,V=S*M,n=0;2*M+1>n;n++){var x=6*n,r=6*(2*M+1)+x;I[x]=-V,I[x+1]=0,I[x+2]=-V+n*S,I[x+3]=V,I[x+4]=0,I[x+5]=-V+n*S,I[r]=-V+n*S,I[r+1]=0,I[r+2]=-V,I[r+3]=-V+n*S,I[r+4]=0,I[r+5]=V}W.vs=new Ek(I),W.gap=S,W.size=l}Mg(L),Fg(p,m),Rb(p),ic(p,m,1,L._gridColor,L._buffer.vs,W.vs),Kg(p,0,W.vs.length/3,p.LINES),vs(p),lf(p,m)}else W.vs=W.gap=W.size=U}});var Es=function(i){this.gv=i};Bb(Es,g,{_42:function(M,y){var h=this.gv,I=h._buffer.vs,p=h._axisXColor,O=h._axisYColor,Z=h._axisZColor,w=h._originAxisVisible,d=h._centerAxisVisible;if(w||d){var A=ze?M.TRIANGLES:M.TRIANGLE_FAN,f=M.LINES;if(Mg(h),Fg(M,y),Rb(M),w){var D=h.getCenterInfo(),L=x(D.width,D.height)/5,z=.8*L,B=.05*L;ic(M,y,1.5,p,I,new Ek([0,0,0,L,0,0,z,B,0,z,0,B,z,-B,0,z,0,-B,z,B,0,0,0,0,0,L,0,B,z,0,0,z,B,-B,z,0,0,z,-B,B,z,0,0,0,0,0,0,L,B,0,z,0,B,z,-B,0,z,0,-B,z,B,0,z])),Kg(M,0,2,f),Kg(M,1,6,A),ic(M,y,U,O),Kg(M,7,2,f),Kg(M,8,6,A),ic(M,y,U,Z),Kg(M,14,2,f),Kg(M,15,6,A)}if(d){var i=h._center,T=i[0],m=i[1],Y=i[2],D=h.getPositionInfo(i);L=x(D.width,D.height)/20,ic(M,y,1.5,p,I,new Ek([T,m,Y,T+L,m,Y,T,m,Y,T,m+L,Y,T,m,Y,T,m,Y+L])),Kg(M,0,2,f),ic(M,y,U,O),Kg(M,2,2,f),ic(M,y,U,Z),Kg(M,4,2,f)}vs(M),lf(M,y)}}});var Fs=function(u){this.gv=u},Gs="edit_tx",Hs="edit_ty",Is="edit_tz",Js="edit_rx",Ks="edit_ry",Ls="edit_rz",Ms="edit_sx",Ns="edit_sy",Os="edit_sz",Ps={};Ps[Gs]=101,Ps[Hs]=102,Ps[Is]=103,Ps[Js]=104,Ps[Ks]=105,Ps[Ls]=106,Ps[Ms]=107,Ps[Ns]=108,Ps[Os]=109,Bb(Fs,g,{_42:function(t,W,X){var e=this,Z=e.gv,b=Z.sm().ld();if(b&&Z.isEditable(b)&&!Z.isEditHelperDisabled()&&Je(b)&&(!Z.isFirstPersonMode()||!Z.isMouseRoamable()&&!jg)){Mg(Z);var G,K=Z.isMovable(b),H=Z.isRotationEditable(b),U=Z.isSizeEditable(b),m=Z._axisXColor,$=Z._axisYColor,h=Z._axisZColor,Y=Z._editSizeColor,p=b.p3();
if(Z.isOrtho()){var M=Z.getCenterInfo();G=x(M.width,M.height)/8}else G=Sn(Z.getEye(),p)/10;var V,o,c=G/(X?5:10),d=.7*G,D=.4*d,L=p[0],z=p[1],j=p[2];V=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],K&&e._17O(t,W,b,X,Gs,m,V,[L,z-c,j,L+d,z-c,j,L+d,z,j,L+d,z,j,L,z,j,L,z-c,j,L,z-c,j+c,L+d,z-c,j+c,L+d,z-c,j,L+d,z-c,j,L,z-c,j,L,z-c,j+c]),o=L+d,U&&e._17O(t,W,b,X,Ms,Y,V,[o,z-c,j,o+D,z-c,j,o+D,z,j,o+D,z,j,o,z,j,o,z-c,j,o,z-c,j+c,o+D,z-c,j+c,o+D,z-c,j,o+D,z-c,j,o,z-c,j,o,z-c,j+c]),o+=D,H&&e._17O(t,W,b,X,Js,m,V,[o,z-c,j,o+D,z-c,j,o+D,z,j,o+D,z,j,o,z,j,o,z-c,j,o,z-c,j+c,o+D,z-c,j+c,o+D,z-c,j,o+D,z-c,j,o,z-c,j,o,z-c,j+c]),V=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],K&&e._17O(t,W,b,X,Hs,$,V,[L,z,j,L,z+d,j,L-c,z+d,j,L-c,z+d,j,L-c,z,j,L,z,j,L,z,j,L,z,j-c,L,z+d,j-c,L,z+d,j-c,L,z+d,j,L,z,j]),o=z+d,U&&e._17O(t,W,b,X,Ns,Y,V,[L,o,j,L,o+D,j,L-c,o+D,j,L-c,o+D,j,L-c,o,j,L,o,j,L,o,j,L,o,j-c,L,o+D,j-c,L,o+D,j-c,L,o+D,j,L,o,j]),o+=D,H&&e._17O(t,W,b,X,Ks,$,V,[L,o,j,L,o+D,j,L-c,o+D,j,L-c,o+D,j,L-c,o,j,L,o,j,L,o,j,L,o,j-c,L,o+D,j-c,L,o+D,j-c,L,o+D,j,L,o,j]),V=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],K&&e._17O(t,W,b,X,Is,h,V,[L,z,j,L,z,j+d,L,z-c,j+d,L,z-c,j+d,L,z-c,j,L,z,j,L,z-c,j,L-c,z-c,j,L-c,z-c,j+d,L-c,z-c,j+d,L,z-c,j+d,L,z-c,j]),o=j+d,U&&e._17O(t,W,b,X,Os,Y,V,[L,z,o,L,z,o+D,L,z-c,o+D,L,z-c,o+D,L,z-c,o,L,z,o,L,z-c,o,L-c,z-c,o,L-c,z-c,o+D,L-c,z-c,o+D,L,z-c,o+D,L,z-c,o]),o+=D,H&&e._17O(t,W,b,X,Ls,h,V,[L,z,o,L,z,o+D,L,z-c,o+D,L,z-c,o+D,L,z-c,o,L,z,o,L,z-c,o,L-c,z-c,o,L-c,z-c,o+D,L-c,z-c,o+D,L,z-c,o+D,L,z-c,o])}},_17O:function(V,e,D,P,C,$,v,M){var x=this.gv,I=x._buffer,c=Ph.for(V),Y=c.directUniforms(),n=c.directAttribs();if(x._picking){P=x.pickColorMap;var J=Ps[C];P[J]={data:D,part:C},Y.uFixPickReverseColor=se(J)}aq(V,e,U,!0,U,!0,U,!1),Y.uDiffuse=$,n.aPosition=Dp(V,I.vs,new Ek(M),U),n.aNormal=Dp(V,I.ns,new Ek(v),U),Rb(V),Kg(V,0,12),vs(V),_p(V,e)}});var Qs=C.Raycaster=function(K){this.gv=K,this.maxTriangleTest=1/0,this.backfaceCulling=!0};ub("Raycaster",g,{intersect:function(z){var S=this,A=S.gv,n=A.getDataAt(z);return n?S.intersectObject(z,n):null},intersectObjects:function(C,t,R){var I,c,A,T,u=this,o=1/0,S=C.origin||(new Cc).fromArray(u.gv.getEye()),q=u.maxTriangleTest,b=[];t.forEach(function(l){R&&R(l)===!1||l.s("intersect")!==!1&&b.push(l)});var Z=S.distanceToSquared2([0,0,0]);return b.sort(function(P,g){return(P.p3?S.distanceToSquared2(P.p3()):Z)-(g.p3?S.distanceToSquared2(g.p3()):Z)}),u.countTriangles=0,b.forEach(function(J){u.countTriangles>q||(I=u.intersectObject(C,J),I&&(c=S.distanceToSquared(I.world),o>c&&(A=J,T=I,o=c)))}),u.countTriangles=0,{data:A,intersect:T}},intersectObject:function(X,j){if(X instanceof Tp)return this._intersectObjectImpl(X,j);var D=this,T=D.gv,h=T.unproject(X),t=new Cc,G=T.getEye(),I=new Cc;if(T.isOrtho()){var b=new Cc(G);I.copy(T.getCenter()).sub(b).normalize();var U=t.copy(h).sub(b).dot(I);t.copy(I).setLength(-U).add(b.copy(h))}else t.copy(G),I.copy(h).sub(t).normalize();var k=new C.Math.Ray(t,I);return D._intersectObjectImpl(k,j)},_intersectObjectImpl:function(){function r(){var C=new Cc;return C.subVectors(q,x),P.subVectors(t,x),C.cross(P).normalize(),C}function T(A,m,O,V,g,H,X){return _f.barycoordFromPoint(A,m,O,V,D),g.multiplyScalar(D.x),H.multiplyScalar(D.y),X.multiplyScalar(D.z),g.add(H).add(X),g.clone()}var G=new Jc,X=new Jc,v=new Tp,e=new Cc,U=new Cc,E=new Cc,I=new Cc,Y=new Cc,t=new Cc,x=new Cc,q=new Cc,j=new jm,V=new jm,s=new jm,P=new Cc,O={vs:cd,is:Tn,uv:zr},D=new Cc,N=Fc.slice(0);return N.push("csg"),function(p,i){var b=this.gv.getData3dUI(i),l=i.mat||b.mat;l?G.fromArray(l):G.identity(),X.getInverse(G),v.copy(p).applyMatrix4(X);var F,S,g,W="body",Z=b.shapeModel;if(!Z&&(i instanceof C.Polyline||i instanceof C.Edge)&&b.lineShapeModel&&(Z=b.lineShapeModel),Z||(Z=Bq(b)),Z||(C.CSGNode&&i instanceof C.CSGNode||C.CSGShape&&i instanceof C.CSGShape?(g=!0,Z=[b.left,b.front,b.right,b.back,b.top,b.bottom,b.csg]):i instanceof C.Node&&!(i instanceof C.Shape)?(F=!0,Z=O):(S=!0,Z=[b.left,b.front,b.right,b.back,b.top,b.bottom])),!Z)return console.log("Can not find shape model."),null;zo(Z)||(Z=[Z]);var a,y,A,h,K,n,Q,o,M,d,u,R,z,m,D,f,H=1/0,k=["","top_","bottom_"],P=!1,c=this.backfaceCulling,B=[];for(Lm(Z,b,B),a=0,y=B.length;y>a;a++)if(z=B[a])for(A=0,h=k.length;h>A;A++)if(m=k[A],Q=z[m+"vs"],o=z[m+"is"],M=z[m+"uv"]||z[m+"tuv"],Q){if(D=z[m+"boundingBox"]){var u=v.intersectBox(D);if(!u)continue;if(v.origin.distanceTo(u)>H)continue;f=!1}else z[m+"boundingBox"]=D=new C.Math.Box3,f=!0;for(K=0,n=o?o.length:Q.length/3;n>K;K+=3)this.countTriangles++,o?(U.fromArray(Q,3*o[K]),E.fromArray(Q,3*o[K+1]),I.fromArray(Q,3*o[K+2])):(U.fromArray(Q,3*K),E.fromArray(Q,3*(K+1)),I.fromArray(Q,3*(K+2))),f&&(D.expandByPoint(U),D.expandByPoint(E),D.expandByPoint(I)),d=v.intersectTriangle(U,E,I,c,e),d&&(R=v.origin.distanceTo(d),H>R&&(H=R,Y.copy(d),t.copy(U),x.copy(E),q.copy(I),""!==m?W=m.slice(0,-1):F?W=Fc[Math.floor(K/6)]:S?W=Fc[a]:g&&(W=N[a]),M&&(P=!0,o?(j.fromArray(M,2*o[K]),V.fromArray(M,2*o[K+1]),s.fromArray(M,2*o[K+2])):(j.fromArray(M,2*K),V.fromArray(M,2*(K+1)),s.fromArray(M,2*(K+2))))))}if(!isFinite(H))return null;var _,$=Y.clone().applyMatrix4(G);P&&(_=T(Y,t,x,q,j,V,s));var J=r(t,x,q),w=r(t.applyMatrix4(G),x.applyMatrix4(G),q.applyMatrix4(G)),L=v.direction.dot(J);return L>0&&(J.multiplyScalar(-1),w.multiplyScalar(-1)),{world:$,local:Y.clone(),worldNormal:w,normal:J,uv:_,part:W}}}()});var Rs=function(j,h){this.gv=j,this.s=function(E,u,K){return u==U&&(u=K),u==U?h.getStyle(E):zi(u,h,j)},this.data=h};Bb(Rs,g,{I3d:!0,ms_icons:1,_iv:!0,_cacheBoundingBox:c,iv:function(){this._iv=!0},update:function(L,g,J){var Q=this,N=Q.data;if(L||(L=Q.gv,g=L.getGL(),J=L._40Q),!Q.needValidate(g)||!L.isVisible(N))return J.push(this,!1),void 0;var k,h,H,r,G,R=N._id,v=N._47Q?null:Q.s("batch"),B=N.getRenderLayer(),u=J.get(B,!0),x=u.batchIndexMap,q=u.batchModelMap,A=L.getBrightness(N),F=A!=U&&1!==A;k=dc(x,q,N,v,L);var z=Q.validate(k,v?L.getBatchInfo(v)||oc:U);if(k&&(h=x[R],H=h.size=k.vs.length/3-h.begin,G=k.rs))for(A=F?A:1,r=0;H>r;r++)G.push(A);var M=L.getWireframeGeometry(N);if(M)Qo(L,N,M);else if(Je(N)){var s=L.getWireframe(N);s&&Qo(L,N,s)}Q.labelInfo=Q.label2Info=Q.noteInfo=Q.note2Info=Q._38o=U,Q._24O(Np,"getLabel"),Q._24O(Kq,"getLabel2"),Q._26O(oj,"getNote"),Q._26O(ok,"getNote2"),Q._15O(),Q.interactiveInfo=L.isInteractive(N)?{}:U,u.push(this,!0),z!==!1&&(Q._iv=!1)},clearWireframeGeometryCache:function(){var f=this;yg(f),f.data.iv()},_46Q:function(g){var D=this,C=D.data,I=D.gv;if(I.isVisible(C)){var N=C._id,A=I._40Q.get(C._renderLayer,!0),u=A.batchIndexMap[N],Q=A.polylineIndexMap[N],M=A.wireframeIndexMap[N];if(u||Q||M){var V=km(g,I.pickColorMap,I.isSelectable(C),C,Dj,!0);V&&(Eb(V,u,A.batchModelMap),Eb(V,Q,A.polylineModelMap),Eb(V,M,A.wireframeModelMap))}}},_42:function(z,P,S){function F(G,M,K){var S=M.getBrightness(K),X=K.s("alphaTest"),T=K.s("envmap"),$=Ph.for(G),h=$.directUniforms();S!=U&&1!==S&&(h.uBrightness=S),h.uAlphaTest=X,h.uUseEnvMap=T?!0:!1,h.uReflectivity=T||.01,h.roughness=K.s("roughness"),M._setEnvmapByProbeId(h,K.s("envmap.probe")),h.shadowReceive=!O&&K.s("shadow.receive"),h.shadowCull=!O&&!!K.s("shadow.cull"),h.uEnableBoxClip=K.s("3d.clipbox.enabled")&&!K.s("3d.clipbox");var Y=i.s("3d.clip.direction");if(Y){var k=i.s("3d.clip.percentage");0===k&&(R=!1);var r=i._formatClipUniforms(Y,k,K);h.uClipPercent=r[1],h.uClipDirection=r[0]}else h.uClipDirection=0;G._blooming&&!K.s("bloom")&&(h.blackout=!0),O||(M._flowObjects.length&&M.flowMap.resetDataFlowEnabld(K,h),Pf(M,h,K.s("light.mask")))}var i=this,E=i.data,w=i.gv;if(w.isVisible(E)){var q,O=w._picking;if(O)q=w.pickColorMap;else{if(w.isTransparentMask(E)||w.isReflecting(z)&&E.s("3d.reflectable")===!1)return;q=c}if(Rs.getTitle===c){Rs.getTitle=0;for(var B in G)if(B.length===Kq.length+1&&B[Kq.length]===wl[4].toUpperCase()&&B[Kq.length-1]===wl[Kq.length+1].toUpperCase()){Rs.getTitle=go;break}}if(!Rs.getTitle||vd[Kq.length+2]){if(Rs.getHead===c){Rs.getHead=0;for(var B in y){var A="box-sizing";6===B.length&&B[0]===wl[4]&&B[3]===A[0]&&B[4]===A[1]&&B[5]===A[2]&&(Rs.getHead=go)}}if(!Rs.getHead||vd[Kq.length]){var r,t,n=E._id,j=w._40Q.get(E._renderLayer,!0),v=j.batchIndexMap,h=j.batchModelMap,T=w.isSelectable(E),W=!1,R=!0,X=v[n];if(O&&(t=km(z,q,T,E,Dj,X),t&&!w._45Q&&(Eb(t,X,h),Eb(t,j.polylineIndexMap[n],j.polylineModelMap),Eb(t,j.wireframeIndexMap[n],j.wireframeModelMap))),X||(W||(W=!0,F(z,w,E)),R&&i._80o(z,P,S)),w.isLabelVisible(E)&&((r=i.labelInfo)&&(O&&km(z,q,T,E,Np),W||(W=!0,F(z,w,E)),i._28O(r,Np,S)),(r=i.label2Info)&&(O&&km(z,q,T,E,Kq),W||(W=!0,F(z,w,E)),i._28O(r,Kq,S))),w.isNoteVisible(E)&&((r=i.noteInfo)&&(O&&km(z,q,T,E,oj),W||(W=!0,F(z,w,E)),i._29O(r,oj,S)),(r=i.note2Info)&&(O&&km(z,q,T,E,ok),W||(W=!0,F(z,w,E)),i._29O(r,ok,S))),(r=i._38o)&&(W||(W=!0,F(z,w,E)),i._99O(z,P,r,q,T,S)),W){var b=Ph.for(z).directUniforms();b.uBrightness=1,b.uClipDirection=0,z._blooming&&(b.blackout=!1)}}}}},_formatClipUniforms:function(A,e,b){switch(A){case"left":A=2;break;case"top":A=3;break;case"bottom":A=4;break;case"front":A=5;break;case"back":A=6;break;case"right":default:A=1}if(0===A%2&&(e=1-e),b instanceof C.Shape){var Y=b.s3(),a=b.p3(),S=b.getAnchor3d();e=3>A?(e-S.x)*Y[0]+a[0]:5>A?(e-S.y)*Y[1]+a[1]:(e-S.z)*Y[2]+a[2]}else e-=.5;return[A,e]},prepare:function(){var o=this,V=o.data;if(!(V instanceof af)){var r,L,w,j,T,y=o.gv,g=y.getGL(),D=V._id,z=o.s("batch"),x=y._batchIndexMap,k=y._batchModelMap,f=y.getBrightness(V),h=f!=U&&1!==f;if(o.needValidate(g)){if(r=dc(x,k,V,z,y),o.validate(r,z?y.getBatchInfo(z)||oc:U),r&&(L=x[D],w=L.size=r.vs.length/3-L.begin,T=r.rs))for(f=h?f:1,j=0;w>j;j++)T.push(f);if(Je(V)){var H=y.getWireframeGeometry(V);if(H)Qo(y,V,H);else{var b=y.getWireframe(V);b&&Qo(y,V,b)}}o.labelInfo=o.label2Info=o.noteInfo=o.note2Info=o._38o=U,o._24O(Np,"getLabel"),o._24O(Kq,"getLabel2"),o._26O(oj,"getNote"),o._26O(ok,"getNote2"),o._15O(),o.interactiveInfo=y.isInteractive(V)?{}:U,o._iv=!1}}},dispatchBoundingBoxChanged:function(){this._cacheBoundingBox=c},getBoundingBox:function(){var n,b,l,L,y,x;return function(){if(this._cacheBoundingBox)return this._cacheBoundingBox;n||(n={vs:cd,is:Tn,uv:zr},b=new Cc,l=new Cc,L=new Cc,y=new Cc,x=new Cc);var X=this,f=X.data,t=X.shapeModel;if(t||f instanceof C.Shape||(t=Bq(X)),!t&&f instanceof C.Shape&&(X.prepare(),t=X.shapeModel),t||(f instanceof C.Node&&!(f instanceof C.Shape)?t=n:(X.left||X.front||X.right||X.back||X.top||X.bottom)&&(t=[X.left,X.front,X.right,X.back,X.top,X.bottom])),!t)return c;zo(t)||(t=[t]);var q,Z,R,o,G,h,s,_,S,u,I,r,A=["","top_","bottom_"],M=new C.Math.Box3,J=!1;if(X._needRecoverPosition){y.set.apply(y,f.p3());var V=f.s3();x.set(1/(V[0]||1),1/(V[1]||1),1/(V[2]||1))}else y.set(0,0,0),x.set(1,1,1);for(q=0,Z=t.length;Z>q;q++)if(S=t[q])for(R=0,o=A.length;o>R;R++)if(u=A[R],s=S[u+"vs"],_=S[u+"is"],s){if(r=u+"boundingBox",I=S[r],!I)for(S[r]=I=new C.Math.Box3,G=0,h=_?_.length:s.length/3;h>G;G+=3)_?(b.fromArray(s,3*_[G]).sub(y).multiply(x),l.fromArray(s,3*_[G+1]).sub(y).multiply(x),L.fromArray(s,3*_[G+2]).sub(y).multiply(x)):(b.fromArray(s,3*G).sub(y).multiply(x),l.fromArray(s,3*(G+1)).sub(y).multiply(x),L.fromArray(s,3*(G+2)).sub(y).multiply(x)),!b.isNaN()&&I.expandByPoint(b),!l.isNaN()&&I.expandByPoint(l),!L.isNaN()&&I.expandByPoint(L);M.expandByBox(I),J=!0}return J?(this._cacheBoundingBox=M,g.freeze(M),g.freeze(M.min),g.freeze(M.max),Ub(X.gv,f),M):c}}(),needValidate:function(){return this._iv},validate:function(){},_16O:function(){return Zf},_80o:function(){},dispose:function(){var q=this,b=q.data,P=b._pickId;if(P){var h=q.gv.pickColorMap;h[P]&&delete h[P]}},getBodyColor:function(j){var y=this.data,M=this.gv.getBodyColor(y);return M?M:j?y.getStyle(j):U},getCachedTexture:function(C){var v=this._cachedTextures;return v?v[C||"main"]:null},setCachedTexture:function(M,F){var Y=this._cachedTextures;return Y||(Y=this._cachedTextures={}),Y[F||"main"]=M,M},invalidateCachedTexture:function(Z){var D=this._cachedTextures;if(D){for(var d in D)Z.deleteTexture(D[d]);this._cachedTextures={}}},invalidateCachedGeometry:function(){},_24O:function(k,f){var w=this,e=w.data,Z=w.gv,v=w.s,P=Z[f](e);if(P!=U){var B=v(k+".scale"),K=v(k+".max"),X=w[k+"Info"]={label:P,textureScale:v(k+".texture.scale"),color:Z[f+"Color"](e),font:v(k+".font"),align:v(k+".align"),background:Z[f+"Background"](e)},p=X.rect=Ad(X,P);K>0&&K<p.width&&(X.labelWidth=p.width,p.width=K),p.x=p.y=0,p.width*=B,p.height*=B,X.mat=w._16O(v(k+".autorotate"),v(k+".position"),p,v(k+".face"),v(k+".t3"),v(k+".r3"),v(k+".rotationMode"));var u=p.width/2,S=p.height/2;X.vs=new Ek([-u,S,0,-u,-S,0,u,-S,0,u,S,0]),p.width/=B,p.height/=B}},_26O:function(h,r){var Z=this,m=Z.data,u=Z.gv,O=Z.s,s=u[r](m);if(s!=U){var i=O(h+".scale"),j=this[h+"Info"]={note:s,textureScale:O(h+".texture.scale"),expanded:O(h+".expanded"),font:O(h+".font"),color:O(h+".color"),align:O(h+".align"),borderWidth:O(h+".border.width"),borderColor:O(h+".border.color"),background:u[r+"Background"](m)};if(j.expanded){var Y=O(h+".max"),N=Ad(j,s);N.width+=6,N.height+=2,Y>0&&Y<N.width&&(j.labelWidth=N.width,N.width=Y);var c={x:-N.width/2,y:-8-N.height,width:N.width,height:N.height+8}}else c={x:-6,y:-18,width:12,height:18};j.mat=Z._16O(O(h+".autorotate"),O(h+".position"),U,O(h+".face"),O(h+".t3"),O(h+".r3"),O(h+".rotationMode")),j.rect=c,1!==i&&(c=ns(c),c.x*=i,c.height*=i,c.y=-c.height,c.width*=i);var R=c.x,w=c.y,D=c.width,B=c.height;j.vs=new Ek([R,-w,0,R,-w-B,0,R+D,-w-B,0,R+D,-w,0])}},eachShapeModel:function(W,E){function R(p){Tl(p),p.vs&&W(p.vs,p.is,p.ns,p.uv),p.top_vs&&W(p.top_vs,p.top_is,p.top_ns,p.top_uv),p.bottom_vs&&W(p.bottom_vs,p.bottom_is,p.bottom_ns,p.bottom_uv),p.from_vs&&W(p.from_vs,p.from_is,p.from_ns,p.from_uv),p.to_vs&&W(p.to_vs,p.to_is,p.to_ns,p.to_uv)}function b(q){var Z,s,w;if(zo(q))for(s=0,w=q.length;w>s;s++)Z=q[s],Z&&b(Z);else ak(q)?b(Bq(M,q),M):jb(q)&&(q.shape3d?b(q.shape3d):R(q))}var M=this,i=M.data,E=E||M.shapeModel||Bq(M);E||(E=i instanceof C.Node&&!(i instanceof C.Shape)?{vs:cd,is:Tn}:[M.left,M.front,M.right,M.back,M.top,M.bottom]),b(E)},_28O:function(E,o,p){if(p(this.s(o+".transparent"))){var l=E.rect,n=E.textureScale,q=l.width*n,$=l.height*n;if(q>=1&&$>=1){var r=Qr(q,$);1!==n&&(r.translate(l.x,l.y),r.scale(n,n),r.translate(-l.x,-l.y)),hj(r,E),r.restore(),cc(this,o,E.mat,E.vs,!0)}}},_29O:function(M,g,N){if(N(this.s(g+".transparent"))){var A=M.rect,i=M.textureScale,B=A.x,o=A.y,O=A.width*i,F=A.height*i;if(O>=1&&F>=1){A.x=A.y=0;var q=Qr(O,F);1!==i&&q.scale(i,i),gi(q,M),q.restore(),A.x=B,A.y=o,cc(this,g,M.mat,M.vs,!1)}}},_99O:function(Q,A,g,B,E,P){if(g){var f=this,M=f.gv,K=f.data,D=M._buffer,$=M._1O,k=g.icons,e=Ph.for(Q),Y=e.directAttribs();for(var h in k){var a=k[h],i=g.rects[h];if(i&&P(zi(a.transparent,K,M))){M._picking&&km(Q,B,E,K,h);var n=zi(a.shape3d,K,M),r=n?[n]:zi(a.names,K,M),w=r?r.length:0,S=zi(a.textureScale,K,M)||1,q=zi(a.light,K,M);q==U&&(q=n?!0:!1),aq(Q,A,zi(a.blend,K,M),q,zi(a.opacity,K,M),zi(a.reverseFlip,K,M),zi(a.reverseColor,K,M),zi(a.reverseCull,K,M));for(var p=0;w>p;p++){var l=r[p],J=i[p];if(jo(f,J.mat),n)Vl(M,K,Bq(f,n),f);else{var L=Kj(l);if(L){var H=J.width*S,b=J.height*S;if(H>=1&&b>=1){var V=Qr(H,b);bl(V,L,zi(a.stretch,K,M),0,0,H,b,K,M),V.restore(),Uf(Q,mj,$),Rb(Q,A,$,zi(a.discardSelectable,K,M),D.uv,Zr),Y.aPosition=Dp(Q,D.vs,J.vs,U),Y.aNormal=og(Q,D.ns,nl,U),yn(Q,D.is,jk),Ke(Q,0,jk.length),vs(Q,A,$)}}}Vg(M)}_p(Q,A)}}}}});var Ss=function(w,A){Zn(Ss,this,[w,A])};Bb(Ss,Rs,{_16O:function(R,r,z,g,Y,M,p,E,W){var F=this.data,$=F.getFinalScale3d(),d=Om(r,$,z,g,E,W);if(F.hasOwnProperty("_anchor")||F.hasOwnProperty("_anchorElevation")){var j=F.getAnchor3d();d[0]-=(j.x-.5)*$[0],d[1]-=(j.y-.5)*$[1],d[2]-=(j.z-.5)*$[2]}return mi(Tj(),d,F.p3(),g,Y,M,p,R,F.getFinalRotation3d(),F.getRotationMode())},clear:function(){var l=this;l.faceMat=l.mat=l.shapeModel=l.left=l.right=l.front=l.back=l.top=l.bottom=l.csg=U},needValidate:function($){if(this._iv)return this._validateFrameId=$._renderInfo.frame,!0;if(this.data._47Q){var G=$._renderInfo.frame;if(this._validateFrameId!==G)return this._validateFrameId=G,!0}return!1},validate:function(i,P){var B=this,s=B.gv,X=B.data,S=B.shapeName=B.s(_q),R=Bq(B,S);if(B._updateAutoRotation(),B._updateFixSize2d(),B._updateOverlapping(),B.dispatchBoundingBoxChanged(),X._47Q){var k=X.getRenderLayer(),n=s._40Q.get(k);n&&n.ivWireframeBatch(X)}var m=Jl(X,s.getMat(X),R?B.s("shape3d.scaleable"):!0);if(X.appendAnchorMatrix3d(m),B.clear(),B.mat=X.mat=m,R||!S)if(B.shapeModel=R,i)if(R)Mj(s,X,R,B,B.getBodyColor(),[m],i);else{var K=Le(m);nr(s,X,i,P,m,K,Ld,Jg),nr(s,X,i,P,m,K,fk,no),nr(s,X,i,P,m,K,vc,kr),nr(s,X,i,P,m,K,Ol,Br),nr(s,X,i,P,m,K,Sl,Pi),nr(s,X,i,P,m,K,Em,Yq)}else R||(B._cubeUvs=null,B.vf(Ld,0),B.vf(fk,16),B.vf(Sl,8),B.vf(Em,24),B.vf(vc,32),B.vf(Ol,40))},_updateAutoRotation:function(){var o=new od,l=new Jc,m=new Cc,d=new Cc,c=new Cc;return function(){var p=this,D=p.data,z=p.s("autorotate")||p.s("shape3d.autorotate");if(!z)return D._dynamicRotation&&delete D._dynamicRotation,void 0;var t=p.gv;c.copy(p.s("shape3d.autorotate.up")||t._up);var R;R="string"==typeof z?[z.indexOf("x")<0?t._eye[0]:t._center[0],z.indexOf("y")<0?t._eye[1]:t._center[1],z.indexOf("z")<0?t._eye[2]:t._center[2]]:t._eye;var M=t._center,g=D.p3();m.copy(g),d.set(R[0]-M[0],R[1]-M[1],R[2]-M[2]).add(m),l.lookAt(d,m,c),o.set(0,0,0,D.getRotationMode(),!0).setFromRotationMatrix(l);var y=D._dynamicRotation;y&&Math.abs(y[0]-o.x)<1e-5&&Math.abs(y[1]-o.y)<1e-5&&Math.abs(y[2]-o.z)<1e-5||(D._dynamicRotation=[o.x,o.y,o.z])}}(),_updateFixSize2d:function(){var M=this,p=M.data,m=M.s("fixSizeOnScreen")||M.s("shape3d.fixSizeOnScreen");if(!m)return p._dynamicScale3d&&delete p._dynamicScale3d,void 0;var P=M.gv,v=Jl(p,P.getMat(p)),J=lp([0,0,0],v),r=P.toViewPosition(J);if(!isNaN(r.x)&&!isNaN(r.y)){var K=lp([1,0,0],v),F=P.toViewPosition(K),S=lp([0,1,0],v),a=P.toViewPosition(S),Y=F.x-r.x,h=a.y-r.y;if(Y&&h){var T,s,i=p._dynamicScale3d||[1,1,1],D=Kj(p.s("shape3d.image"));if(m[0]>0&&(T=m[0]),m[1]>0&&(s=m[1]),!T||!s){var H=m>0?m:1;T||(T=(Zo(D,p)||p.getWidth())*H),s||(s=(Ge(D,p)||p.getTall())*H)}var x=Math.abs(Y/T),w=Math.abs(h/s);Math.abs(x-1)<.001&&Math.abs(w-1)<.001||(p._dynamicScale3d=[i[0]/x,i[1]/w,i[2]])}}},_updateOverlapping:function(){var j=this,D=j.s("hide.overlapping.group");if(!D)return j._rectOverlapping&&(j._rectOverlapping=c),void 0;var $,T,W,i=j.gv,k=j.data,x=Jl(k,i.getMat(k)),d=1/0,e=1/0,t=-1/0,S=-1/0,G=k.getAnchor3d(),Z=G.x,f=G.y,Y=G.z;for($=0;8>$;$++){if(T=lp([($>>2)-Z,(1&$>>1)-f,(1&$)-Y],x),W=i.toViewPosition(T),isNaN(W.x)||isNaN(W.y))return;d=Math.min(d,W.x),t=Math.max(t,W.x),e=Math.min(e,W.y),S=Math.max(S,W.y)}var V={x:d,y:e,w:t-d,h:S-e};j._rectOverlapping=i.overlappingBox.isOverlapping(D,V)},getVectorDynamicSize:function(){var L,r=this,B=r.s("shape3d"),u=r.data;if("billboard"===B||"plane"===B||(L=u._currentCubeElementId)!=U){var V,D,h=r.gv,O=Jl(u,h.getMat(u)),R=u.getAnchor3d(),l=.5-R.x,J=.5-R.y,M=.5-R.z,v=Math.min(r.s("vector.dynamic.maxsize"),h._glCapabilities.maxTextureSize)/h.getDevicePixelRatio(),K=function(a,C){a[0]+=l,a[1]+=J,a[2]+=M,C[0]+=l,C[1]+=J,C[2]+=M;var A=h.toViewPosition(lp(a,O)),N=h.toViewPosition(lp(C,O)),I=A.x-N.x,$=A.y-N.y;return Math.min(v,Math.sqrt(I*I+$*$))};if("billboard"===B)V=K([-.5,0,0],[.5,0,0]),D=K([0,-.5,0],[0,.5,0]);else if("plane"===B)V=K([-.5,0,0],[.5,0,0]),D=K([0,0,-.5],[0,0,.5]);else if(u._currentCubeElementId!=U){var m=3*Tn[L+1],t=3*Tn[L],p=3*Tn[L+2];V=K([cd[m],cd[m+1],cd[m+2]],[cd[p],cd[p+1],cd[p+2]]),D=K([cd[m],cd[m+1],cd[m+2]],[cd[t],cd[t+1],cd[t+2]])}return[V,D]}},vf:function(U,p){var Y=this;if(Y.gv.getFaceVisible(Y.data,U)){var f=Ej(Y,U);f.mat&&(Y.faceMat=!0);var M=f.uv;if(M){var l=Y._cubeUvs;l||(l=Y._cubeUvs=new Ek([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var m=0;8>m;m++)l[p+m]=M[m]}return f}},_billboardInView:function(){var E=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],h=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],n=new en,c=new Cc,p=new Jc;return function(v){var I=this;if(!I.mat)return!0;var x=I.gv.getFrustum(),j="billboard"===v?E:h;n.makeEmpty(),p.fromArray(I.mat);for(var P=0,z=j.length;z>P;P+=3)n.expandByPoint(c.fromArray(j,P).applyMatrix4(p));return x.intersectsBox(n)}}(),_80o:function(q,P,Q){var p=this;if(p._rectOverlapping)return!0;var s=p.shapeModel;if(s||!p.shapeName){var W=p.s("shape3d");if(("billboard"===W||"plane"===W)&&!p._billboardInView(W))return!0;var f=p.gv,o=p.data,x=f._cube,g=Ph.for(q),j=g.directAttribs();if(ah&&!le){var m=p.mat;if(m)for(var J=0;J<m.length;J++)p.mat[J]=m[m.length-J-1]}Mg(f,p.mat),!q._picking&&p.s("shape3d.reflector")||p.s("effect.flow")||(s?Vl(f,o,s,p,p.getBodyColor(),Q):(j.aPosition=Dp(q,x.vs,U,U),j.aNormal=Dp(q,x.ns,U,U),Rn(q,x.is),p._18O(q,P,"left",0,Q),p._18O(q,P,"front",6,Q),p._18O(q,P,"right",12,Q),p._18O(q,P,"back",18,Q),p._18O(q,P,"top",24,Q),p._18O(q,P,"bottom",30,Q))),Vg(f),p.faceMat&&(p._18O(q,P,"left",0,Q,!0),p._18O(q,P,"front",6,Q,!0),p._18O(q,P,"right",12,Q,!0),p._18O(q,P,"back",18,Q,!0),p._18O(q,P,"top",24,Q,!0),p._18O(q,P,"bottom",30,Q,!0))}},_18O:function(r,L,u,X,n,l){var q=this[u];if(q){if(!n(q.transparent))return;if(l&&!q.mat||!l&&q.mat)return;var h=this.data.s("polygonOffset");h&&Yi(r,h),l&&Mg(this.gv,q.mat);var A=this,$=A.data,G=Ph.for(r),i=G.directUniforms();$._currentCubeElementId=X;var v=A.gv,s=v.getTexture(q.texture,$,u),C=q.uv,I=q.uvScale,o=q.uvOffset,T=q.uvRotation,Q=q.discardSelectable;s?C?Rb(r,L,s,Q,v._buffer.uv,A._cubeUvs,o,I,T):Rb(r,L,s,Q,v._cube.uv,U,o,I,T):Rb(r),aq(r,L,q.blend,q.light,q.opacity,q.reverseFlip,q.reverseColor,q.reverseCull),i.uDiffuse=q.color||Y["color.empty"],Ke(r,X,6),_p(r,L),vs(r,L,s),l&&Vg(v),h&&Xl(r),$._currentCubeElementId=null}},drawReflector:function(){var w=new Cc,b=new Cc,h=new od,Q=new Jc,W=new Cc,n=new Cc,Y=new Cc,G=new Cc,V=new Jc,p=new Jc,Z=new eb,B=new sc,M=new sc,m=function(w,M,m){w[m]=M[0],w[m+1]=M[1],w[m+2]=M[2]},P=function(d,U){m(d,U.getEye(),0),m(d,U.getCenter(),3),m(d,U.getUp(),6)},F=function(W,Z){Z._eye=[W[0],W[1],W[2]],Z._center=[W[3],W[4],W[5]],Z._up=[W[6],W[7],W[8]],Z._18Q=U;var T=Z._skybox;T&&(T.p3([W[0],W[1],W[2]]),Z.getData3dUI(T).iv())};return function(D){var k=this;k._reflectorInfo=null;var g=k.data;if(g._reflecting)return!1;var z=k.gv;if(z._picking)return!1;var X=g instanceof ys,s=k._reflectorRenderTarget,K=z._canvas.width,v=z._canvas.height;if(s?s.setSize(D,K,v):s=k._reflectorRenderTarget=new Vf.RenderTarget(z,D,K,v),X){var L=g.getPointsMatrix3d().getElements(),E=g.p3();E[1]+=(1-g.getAnchorElevation())*g.getTall(),w.copy(lp(E,L))}else w.copy(g.p3());if(b.copy(z.getEye()),Q.makeRotationFromEuler(h.set(g.r3(),g.getRotationMode(),!0)),!k._reflectNormal){var y;if(X&&g.getThickness()<0){if(!k.shapeModel||!k.shapeModel.top_vs)return!1;y={vs:k.shapeModel.top_vs,ns:k.shapeModel.top_ns}}else{if(y=Bq(k,k.s("shape3d")),!y)return!1;!y.ns&&y.length&&(y=y[0])}if(!y.ns||!y.vs)return!1;k._reflectNormal=[y.ns[0],y.ns[1],y.ns[2]],k._reflectorVbuffer=Dc.Buffer.createVertexBuffer(D,new Float32Array(y.vs))}if(W.copy(k._reflectNormal),W.applyMatrix4(Q),n.subVectors(w,b),n.dot(W)>0)return!1;n.reflect(W).negate(),n.add(w),Y.copy(z.getCenter()).negate().add(w),Y.reflect(W).negate(),Y.add(w),G.copy(z.getUp()),G.reflect(W);var l=[0,0,0,0,0,0,0,0,0];P(l,z),z._eye=n.toArray(),z._center=Y.toArray(),z._up=G.toArray(),z._18Q=U;var J=z._skybox;J&&(J.p3(z._eye),z.getData3dUI(J).iv()),ql(D,s.frame),z.setViewport(D,0,0,s.width,s.height);var j=g.s("shape3d.reflector.background");if(j){var t=D.getParameter(D.COLOR_CLEAR_VALUE);fo(D,j)}else fo(D,[0,0,0,1]);Ph.for(D).glState.depth.mask=!0,D.clear(D.COLOR_BUFFER_BIT|D.DEPTH_BUFFER_BIT);var m=g.s("shape3d.reflector.clip"),S=m===c?.003:m,u=Ro(z),C=Jq(z);Z.setFromNormalAndCoplanarPoint(W,w.add(W.clone().multiplyScalar(S))),Z.applyMatrix4(p.fromArray(C)),B.set(Z.normal.x,Z.normal.y,Z.normal.z,Z.constant),p.fromArray(u).getInverse(p),M.set(Math.sign(B.x),Math.sign(B.y),1,1).applyMatrix4(p),B.multiplyScalar(2/B.dot(M)),u[2]=B.x-u[3],u[6]=B.y-u[7],u[10]=B.z-u[11],u[14]=B.w-u[15];var A=z._computedProjectMatrix;z._computedProjectMatrix=u,g._reflecting=!0,z.renderScene({renderAxis:!1,renderEdit:!1,renderGrid:!1}),z._computedProjectMatrix=A,V.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),V.multiply(p.fromArray(z._projectMatrix)),V.multiply(p.fromArray(z._viewMatrix)),j&&fo(D,t),vr(D),F(l,z);var R=g.s("shape3d.reflector.blur");if(R){var r=z.getPostProcessingModule("Blur");r&&r.drawImpl(D,s,R,R>=3,g.s("shape3d.reflector.blur.iterations"))}var $=D._compiledShader.reflector;$||($=D._compiledShader.reflector=new Dc.Shader(D,Gb.Reflector.vs,Gb.Reflector.fs)),$.bind(),D.activeTexture(D.TEXTURE0),Qf(D,s.texture),$.uniforms.tDiffuse=0,$.uniforms.color=Ap(g.s("shape3d.reflector.color")||"rgb(128,128,128)"),$.uniforms.textureMatrix=V.toArray(),$.uniforms.modelMatrix=X?L:Jl(g),$.uniforms.viewMatrix=Jq(z),$.uniforms.projectionMatrix=Ro(z);var x=k._reflectorVbuffer;x.upload(),$.attributes.pos.pointer(x);var T=this.s("shape3d.transparent");if(T){var q=Ph.for(D).glState,f=q.depth.mask;q.depth.mask=!1}return D.drawArrays(D.TRIANGLES,0,x.data.length/3),T&&(q.depth.mask=f),g._reflecting=!1,D.useProgram(z._prg),Qf(D,U),!0}}()}),Gb.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );","}"].join("\n")};var Ts=function(y,U){Zn(Ts,this,[y,U])};Bb(Ts,Ss,{_80o:function(){}});var Us=function(s,R){Zn(Us,this,[s,R])};Bb(Us,Rs,{_25Q:1,validate:function(l){var D=this;if(!D.s("geometry.cache")||!D.info){var F=D.gv,J=D.data,O=D.s,o=O("edge.width"),f=J._40I,s=J._41I;if(D.shapeModel=D.info=D.lineShapeModel=U,f&&s){var i,d,q,b,z,R,P,t,h,I,p=J.isLooped(),H=O(Hk),_=G.getEdgeType(H);if(_){var w=_(J,ch(D,F,J,p,H),F,D._19Q);if(!w.points||w.points.isEmpty())return;R=D.info={},P=w.segments,z=w.points,t=z.size();for(var B=f.getElevation(),y=s.getElevation(),v=0;t>v;v++){var E=z.get(v);E.e==U&&(E.e=B+(y-B)*v/(t-1))}h=wm(z.get(0)),I=wm(z.get(t-1));var k=t%2;0===k?(R.c1=wm(z.get(t/2-1)),R.c2=wm(z.get(t/2))):R.p3=wm(z.get((t-k)/2)),R.s1=h,R.s2=wm(z.get(1)),R.t1=wm(z.get(t-2)),R.t2=I}else{z=new Vo,R=D.info={};var n=O("edge.offset"),e=O("edge.center"),L=O("edge.source.t3"),X=O("edge.target.t3"),g=Md(F,J,"source"),W=Md(F,J,"target");if(!g||!W)return F.invalidateData(J),delete D.info,!1;if(L&&(g[0]+=L[0],g[1]+=L[1],g[2]+=L[2]),X&&(W[0]+=X[0],W[1]+=X[1],W[2]+=X[2]),H===vn){P=O("edge.segments");var N=R.points=O(tg)||am;if(t=N.size()){h=wm(N.get(0)),I=wm(N.get(t-1)),!e&&n&&(q=Wc(h,g,!0),n=x(n,Sn(g,h)),g=[g[0]+q[0]*n,g[1]+q[1]*n,g[2]+q[2]*n],q=Wc(W,I,!0),n=x(n,Sn(I,W)),W=[W[0]-q[0]*n,W[1]-q[1]*n,W[2]-q[2]*n]);var k=t%2;0===k?(i=wm(N.get(t/2-1)),d=wm(N.get(t/2))):R.p3=wm(N.get((t-k)/2)),R.s1=g,R.s2=h,R.t1=I,R.t2=W}else!e&&n&&(q=Wc(W,g,!0),b=Sn(g,W),n=xb(n,b),g=[g[0]+q[0]*n,g[1]+q[1]*n,g[2]+q[2]*n],W=[W[0]-q[0]*n,W[1]-q[1]*n,W[2]-q[2]*n]),i=g,d=W;z.add({x:g[0],y:g[2],e:g[1]}),z.addAll(N),z.add({x:W[0],y:W[2],e:W[1]})}else{var c=ch(D,F,J,p,H);if(D._19Q||(c=-c),p){var j=g[0],m=g[1],K=g[2],S=f.getTall()/2+c;i=[j-c,m+S,K],d=[j+c,m+S,K],z.add({x:j-c,y:K,e:m}),z.add({x:j-c,y:K,e:m+S}),z.add({x:j+c,y:K,e:m+S}),z.add({x:j+c,y:K,e:m})}else{q=Wc(W,g,!0),b=Sn(g,W);var u={x:g[0],y:g[2]},r={x:W[0],y:W[2]},V=br(U,u,r,c),C=V.x-u.x,A=V.y-u.y;n=xb(n,b),q[0]*=n,q[1]*=n,q[2]*=n,i=[g[0]+q[0]+C,g[1]+q[1],g[2]+q[2]+A],d=[W[0]-q[0]+C,W[1]-q[1],W[2]-q[2]+A],e?(z.add({x:g[0],y:g[2],e:g[1]}),z.add({x:i[0],y:i[2],e:i[1]}),z.add({x:d[0],y:d[2],e:d[1]}),z.add({x:W[0],y:W[2],e:W[1]})):(z.add({x:i[0],y:i[2],e:i[1]}),z.add({x:d[0],y:d[2],e:d[1]}))}}R.c1=i,R.c2=d}R._lastPointsSegments={points:z,segments:P},R.list=O(_q)===pn?D.createTubeModel(z,P,o/2,l):D.createLineModel(z,P,o,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=U}});var Vs=function(u,d){Zn(Vs,this,[u,d]),this._needRecoverPosition=!0};Bb(Vs,Ss,{_80o:function(d,n,S){var L=this,V=L.mat;if(V&&(!L.s("shape3d.reflector")||d._picking)){var M=L.gv,Q=L.shapeModel;Mg(M,V),Q?Vl(M,L.data,Q,L,L.getBodyColor(),S):(ng(L,d,n,"left",S),ng(L,d,n,"front",S),ng(L,d,n,"right",S),ng(L,d,n,"back",S),ng(L,d,n,"top",S),ng(L,d,n,"bottom",S)),Vg(M)}},validate:function(g,d){var v,Q,C=this,X=C.s,M=C.data,S=M._thickness/2,W=M.isClosePath(),R=M.getPoints(),k=M.getSegments(),m=X(Vk),q=g&&g.uv;if(C.clear(),C.dispatchBoundingBoxChanged(),0>S){C.s("shape3d.reflector")&&(C._reflectNormal=null);try{var G=X("shape3d.image.projection");if(G&&G[4]){var T=M.p3(),O=T[0],V=T[2];G=[O+G[0],G[1]-V,O+G[2],G[3]-V]}Q=C.shapeModel=Tc(R,k,X(qb),X(Kk),m,X(ge),M.getTall(),M.getShapeElevation(),W,G)}catch(Z){Q=C.shapeModel={}}X(Yr)?X("shape3d.image")||delete Q.uv:(delete Q.vs,delete Q.ns,delete Q.uv),X("shape3d.top.image")||delete Q.top_uv,X("shape3d.bottom.image")||delete Q.bottom_uv}else if(X(_q)===pn)v=Yp(R,k,m,W),Q=C.shapeModel={vs:[]},X("shape3d.image")&&(Q.uv=[],Q.sum=X(ge)||on(v)||1,Q.len=0),X(qb)&&!W&&(Q.top_vs=[],X("shape3d.top.image")&&(Q.top_uv=[])),X(Kk)&&!W&&(Q.bottom_vs=[],X("shape3d.bottom.image")&&(Q.bottom_uv=[])),C._12O(v,S);else{var I,F,h,w,u,L,o,z,s,f;if(v=Yp(R,k,m,W),u=C.vf(Sl,q,!1,d),S&&(L=C.vf(Em,q,!1,d),o=W?U:C.vf(Ld,q,!1,d),z=W?U:C.vf(fk,q,!1,d),s=C.vf(vc,q,!1,d),f=C.vf(Ol,q,!1,d)),S){for(var y=0,r=v.length;r>y;y++)v[y]=C._tryRemoveBezierPoints(v[y],S);C._12O(v,S)}else u&&v.forEach(function(L){if(w=L.length,w>0)for(I=L[0],h=1;w>h;h++)F=L[h],C.addV(u.vs,I,F),I=F});C._20Q(v),g||(u&&(u.ns=Cp(u.vs),eg(u,"vs"),eg(u,ts)),S&&(L&&(L.ns=Cp(L.vs),eg(L,"vs"),eg(L,ts)),o&&(o.ns=Cp(o.vs),eg(o,"vs"),eg(o,ts)),z&&(z.ns=Cp(z.vs),eg(z,"vs"),eg(z,ts)),s&&(s.ns=Cp(s.vs),eg(s,"vs"),eg(s,ts)),f&&(f.ns=Cp(f.vs),eg(f,"vs"),eg(f,ts))))}var N=C.mat=M.getPointsMatrix3d().getElements();g&&(Wb(C,N,g,Q),C.clear())},_20Q:function(W){var K,f,j,S,c,B,L,N=this,a=N.front,p=N.back,i=N.top,y=N.bottom,C=a?a.tuv:U,M=p?p.tuv:U,w=i?i.tuv:U,n=y?y.tuv:U,s=0;(C||M||w||n)&&(K=N.s(ge)||on(W)||1,W.forEach(function(e){if(f=e.length,f>0)for(B=e[0],j=1;f>j;j++)L=e[j],S=s/K,s+=Sn(B,L),c=s/K,N._14O(a,S,c),N._14O(p,1-c,1-S),N._14O(i,S,c),N._14O(y,S,c),B=L}))},_14O:function(s,I,y){if(s){var S=s.uv,U=s.tuv;if(U){if(S)var w=S[0]+(S[6]-S[0])*I,i=S[1]+(S[7]-S[1])*I,V=S[2]+(S[4]-S[2])*I,R=S[3]+(S[5]-S[3])*I,t=S[2]+(S[4]-S[2])*y,o=S[3]+(S[5]-S[3])*y,_=S[0]+(S[6]-S[0])*y,J=S[1]+(S[7]-S[1])*y;else w=I,i=0,V=I,R=1,t=y,o=1,_=y,J=0;U.push(V,R,t,o,_,J,_,J,w,i,V,R)}}},_13O:function(h){var p=h.uv,s=h.tuv;s&&(p?s.push(p[2],p[3],p[4],p[5],p[6],p[7],p[6],p[7],p[0],p[1],p[2],p[3]):s.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(t,o){var l=t.length;if(4>l)return t;var T,A,U,Q,W,F,d=!1,h=function(n){return t[n]},O=function(W){return t[l-1-W]};for(W=0;1>=W;W++)for(F=W?O:h,A=F(0),U=F(1),T=2;l-1>T;T++)if(Q=F(T),!Q.remove)if(Q.b){var c=br(A,U,Q,o);c.adjust?(Q.remove=!0,d=!0):(A=U,U=Q)}else A=U,U=Q;if(!d)return t;var H=[];for(T=0;l>T;T++)t[T].remove||H.push(t[T]);return H},_12O:function(b,h){var W,y,q,R,N,k=this.s("shape3d.point.epsilon"),S=this;b.forEach(function(p){if(N=p.length,N>0)for(W={p:p[0],n:!0},R=1;N>R;R++)y=p[R],q=N-1>R?p[R+1]:U,q&&Math.abs(y.x-q.x)<k&&Math.abs(y.y-q.y)<k||S.addPoint(W,y,q,h,p)})},addPoint:function(b,M,N,B,w){var S,Q,E,K,G,V,I,t,D,H=this,l=b.p,p=b.f,R=b.b,o=H.s("shape3d.side")||kj,j=H.s("shape3d.start.angle"),q=H.s("shape3d.sweep.angle"),C=H.shapeModel,c=H.data.isClosePath();
if(b.n&&(b.n=!1,p=c&&w.length>2?br(w[w.length-2],l,M,B):br(U,l,M,B),R=Qi(l,p),C?C.top_vs&&H._10O(R,p,o,j,q,C.top_vs,C.top_uv):(S=H.left)&&(H.addV(S.vs,R,p),H._13O(S))),Q=N?br(l,M,N,B):c&&w.length>2?br(l,M,w[1],B):br(l,M,U,B),E=Qi(M,Q),C){var P,v,$=C.vs,r=C.uv,f=C.sum;for(r&&(P=C.len/f,C.len+=Sn(l,M),v=C.len/f),V=H._9O(R,p,o,j,q),I=H._9O(E,Q,o,j,q),t=0;o>t;t++)D=t+1,kq($,V[D]),kq($,I[t]),kq($,V[t]),kq($,I[t]),kq($,V[D]),kq($,I[D]),r&&(K=t/o,G=D/o,r.push(P,G,v,K,P,K,v,K,P,G,v,G));!N&&C.bottom_vs&&H._10O(E,Q,o,j,q,C.bottom_vs,C.bottom_uv,!0)}else!N&&(S=H.right)&&(H.addV(S.vs,Q,E),H._13O(S)),(S=H.front)&&H.addV(S.vs,p,Q),(S=H.back)&&H.addV(S.vs,E,R),(S=H.top)&&H.addH(S.vs,p,Q,E,R,!0),(S=H.bottom)&&H.addH(S.vs,R,E,Q,p);b.p=M,b.f=Q,b.b=E},_10O:function(O,w,f,Y,R,U,A,I){var C,m,i=this,l=i.data,J=i._9O(O,w,f,Y,R),L=(O.x+w.x)/2,P=(O.y+w.y)/2,Z=l.getShapeElevation(),c=0;for(c=0;f>c;c++)I?(kq(U,J[c]),kq(U,J[c+1])):(kq(U,J[c+1]),kq(U,J[c])),kq(U,[L,Z,P]),A&&(I?(C=t*(c+1)/f+Y,m=t*c/f+Y):(C=t*c/f+Y,m=t*(c+1)/f+Y),A.push(.5-.5*b(m),.5-.5*_(m),.5-.5*b(C),.5-.5*_(C),.5,.5))},_9O:function(p,k,o,J,K){var V,Q,B=this,I=B.data,l=[],x=(p.x+k.x)/2,r=(p.y+k.y)/2,H=I.getTall()/2,m=I.getShapeElevation(),h=0;for(K==U&&(K=t);o>=h;h++)V=K*h/o+J,Q=b(V),l.push([x+(p.x-x)*Q,m+H*_(V),r+(p.y-r)*Q]);return l},addV:function(M,v,B){var f=v.x,n=v.y,k=B.x,D=B.y,a=this.data,U=a.getShapeElevation(),p=a.getTall()/2;M.push(f,U-p,n,k,U-p,D,k,U+p,D,k,U+p,D,f,U+p,n,f,U-p,n)},addH:function(G,m,P,w,S,h){var g=this.data,Z=g.getTall()/2,s=g.getShapeElevation()+(h?Z:-Z);G.push(m.x,s,m.y,P.x,s,P.y,w.x,s,w.y,w.x,s,w.y,S.x,s,S.y,m.x,s,m.y)},vf:function(G,g,E,S){var d,O=this,y=O.gv.getFaceVisible(O.data,G);return(E||y)&&(d=Ej(O,G,S),d.vs=[],d.tuv=y&&(d.texture||g)?[]:U,d.visible=y),d}});var Ws=function(o,R){Zn(Ws,this,[o,R])},Xs={},Ys=function(n){return/\.(png|jpg|gif|jpeg|bmp|svg)$/i.test(n)};Bb(Ws,Ss,{validate:function(){var w=this,M=w.gv,T=w.data,a=w.s,K=Ap(a("points.color")),Y=a("points.size"),Z=a("points.uv.offset"),h=a("points.image");!h||Ys(h)||Gl.test(h)||(Xs[h]||(Xs[h]=w._createCachedImage(h)),h=Xs[h]);var B,q,u=T._modelDirty,F=a("points.model");if(F){if(w._lastShapeModel!==F||!w.shapeModel){var t=Bq(w,F);if(!t)return;var E=[],z={};w.eachShapeModel(function(g){for(var m=0,e=g.length;e>m;m+=3){var r=g[m],k=g[m+1],s=g[m+2],O=""+r+"_"+k+"_"+s;z[O]||(z[O]=!0,E.push(r,k,s))}},t),w._setShapeModelPoints(new Ek(E)),w._lastShapeModel=F,u=!0}B=w.shapeModel.vs.length,q=B/3}else{var v=T.getPoints();if(q=B=v.length,u||T._pointsDirty||!w.shapeModel){for(var s=[],G=0;q>G;G++){var x=v[G];x&&s.push(x.x,x.e,x.y)}w._setShapeModelPoints(new Ek(s)),T._pointsDirty=!1,w._lastShapeModel=null,u=!0}}if(w.info={mat:Jl(T),size:Y,diffuse:K,opacity:a("points.opacity"),texture:h,alphaTest:a("points.transparent")?0:a("alphaTest"),uvScale:a("points.uv.scale"),uvOffset:Z,discardSelectable:a("points.discard.selectable")},u||T._colorsDirty){var m=!1,I=T.getColors();if(I&&I.length>0)for(var X=[],G=0;q>G;G++)for(var W=I[G],V=W?(m=!0,Ap(W)):K,f=4*G,O=0;4>O;O++)X[f+O]=V[O];w.shapeModel.cs=m?new Ek(X):null,T._colorsDirty=!1}if(u||T._sizesDirty){var Q=!1,N=T.getSizes();if(N&&N.length>0)for(var k,l=[],G=0;q>G;G++)k=N[G],k>=0?(l.push(k),Q=!0):l.push(Y);w.shapeModel.ss=Q?new Ek(l):null,T._sizesDirty=!1}if(u||T._offsetsDirty){var n=!1,C=T.getUvoffsets();if(C&&C.length>0)for(var j,$,p,o=[],G=0;q>G;G++)j=2*G,$=C[j],p=C[j+1],$!=c&&p!=c?(o.push($,p),n=!0):o.push(Z[0],Z[1]);w.shapeModel.os=n?new Ek(o):null,T._offsetsDirty=!1}if(u||w._lastPointNumber!==q){this.dispose();var S=M.pickColorMap,i=w._startPickId=S._pickIdUsed;S._pickIdUsed=i+q;for(var s=[],G=0;q>G;G++){var R=i+G,e=se(R);s.push(e[0],e[1],e[2],e[3]),S[R]||(S[R]={data:T,part:G})}w.shapeModel.ps=new Ek(s),w._lastPointNumber=q}T._modelDirty=!1,this.dispatchBoundingBoxChanged()},_setShapeModelPoints:function(O){var F=this,y=F.shapeModel,u=F.shapeModel={vs:O};if(!y)return u;var $=O.length,Q=Math.round($/3);return y.cs&&y.cs.length==4*Q&&(u.cs=y.cs),y.ss&&y.ss.length==Q&&(u.ss=y.ss),y.os&&y.os.length==2*Q&&(u.os=y.os),y.ps&&y.ps.length==4*Q&&(u.ps=y.ps),u},_createCachedImage:function(p){var V=128,P=Nb(),J=P.getContext("2d");cs(P,V,V,1),kc(J,{width:V,height:V,comps:[{type:p,background:"white",borderWidth:0,rect:[0,0,V,V]}]},0,0,V,V);var e=C.Math.generateUUID();return $r[e]=P,e},_80o:function(J,K){var g=this,k=g.gv,c=k._picking;if(!c||k.isSelectable(g.data)){var A=g.shapeModel,E=g.info;if(A&&A.vs&&A.vs.length){var e=Ph.for(J);e.useProgram(g._asureProgram(J));var w=e.directUniforms(),i=e.directAttribs();w.modelMatrix=E.mat,w.modelViewMatrix=Lo([],k._viewMatrix,E.mat),w.projectionMatrix=k._projectMatrix,w.viewMatrix=k._viewMatrix,w.scale=k.getHeight()/2,w.size=E.size,w.diffuse=E.diffuse,w.opacity=E.opacity,w.map=k.getTexture(E.texture,g.data),w.alphaTest=E.alphaTest,w.resolution=k.getDevicePixelRatio(),w.discardSelectable=E.discardSelectable,w.uvScale=E.uvScale,i.uvOffset=!c&&A.os?og(J,k._buffer.os,A.os,U):E.uvOffset,w.blackout=J._blooming&&!g.data.s("bloom"),i.position=og(J,k._buffer.vs,A.vs,U),c?(w.picking=!0,i.pickColor=og(J,k._buffer.ps,A.ps,U),w.useColor=!1,i.color=null):(w.picking=!1,i.pickColor=null,A.cs?(w.useColor=!0,i.color=og(J,k._buffer.cs,A.cs,U)):(w.useColor=!1,i.color=null)),A.ss?(w.useSizeArray=!0,i.sizeArray=og(J,k._buffer.ss,A.ss,U)):(w.useSizeArray=!1,i.sizeArray=null),Kg(J,0,A.vs.length/3,J.POINTS),e.useProgram(K),i.disable(),k.shadowMap.enable&&k.shadowMap.createShadow(),k.flowMap.createFlow(w)}}},_asureProgram:function(P){return P._pointsShader||(P._pointsShader=this.gv._postProcessing.createShader(P,Ws.shaderSrc)),P._pointsShader.program},dispose:function(){Ws.superClass.dispose.call(this);var z=this._startPickId,A=this._lastPointNumber;if(z&&A){for(var v=this.gv.pickColorMap,n=0;A>n;n++){var q=z+n;v[q]&&delete v[q]}delete this._startPickId,delete this._lastPointNumber}}}),Ws.shaderSrc="!!~v!oj<g*p!s{n/!onpbjuu5j!tnppQewfnm!N.b!u0s!jfym<bd!tv!o)j!g>p+s!nf!{njbTuu5o!jnppQe`fmmhW!j*f!xfNwbjuusdjfyq<ts!fvQotjjg!p)s!ng!jn!bu<5*!!q1s/p2k!f.d!u>j>p!o^N!b4u!s]j^y!<3!!]vyojjsgupbsNno!pnjbuud5f!kwpjsfqx!N)b!u>s!jfyw<ju!dvfoqjtgspfsQnt!jg!mmppbpuc!!tdbm~f!<<o!pbjuuuvsmjpctvfusf!!+w!ffd{4j!tq!p>t!jfu{jjpTou<ojp!Qv`omjhg!ps|n!!fctpmpfm!!~v!tf<Doppmjpusv<mp!tbfusu!s+j!czvbusfs!Bwff{dj5t!!d>p!mfp{sj<Tu!owjbpsQz`jmohh!!w|f!d*5z!bwsDspBmfp{sj<Tft!vb)u!ugsjj!cv<uofp!jwufjdt3p!QvwwnP!g+g!tyfjus<ub!Nwobpsjzujdofhk!pwsfqd!3>!!woPpgjgutjftup<Q`m!hv!oj<goppsjnu!jctpppQmw!nq!j+d!lyjjoshu<bN!xbfujuWsmjfcevpunf!!>w!fodp5j!uqjjtdplQDwpnm!ps<<*!1!/v2o!j-gepfsnns!pggmtpobbus!ut!j){5fd<fw!!v>o!jogppjsunj!tgpmQpwbnu!!5sdfftwp!mv<u*j!poop<ju!jvtopjqg!p)s4nd!fcwp!p>m!!evftnfsTpjg{tfoBbsssub!z4<df!wb!uu<s*jucfvtugfg!Pgwmvp)b3ud!ftwj!{>f!Busfstbgzg<Pw!!c~p!pm<!sjptmQpfds!t>q!fsdpumjpwDfwN!bu|s!j*ys)p!mnpbDuf5t!vn)!!*g!j|!f!tsmffu!vs~o!!n<]s!p3m!p^D]l!d4j!q^!!>>!>s!p.m!p2D/w1!<|!!~*ho!jwlpdjjeq!)n!bgjjo!)*|!^#!!~qs~f!dj<tsjppmop!Difjthvigqg!jgem!p>b!us<pm!p$DehfbgsjGo`fm!hV!TF|`!NfBtQmf!!v~o!jg<psspnm!pwDfwd!5>!!esjpgmgpvDthfb<sG!`vmohj!gp<sens!bgdmtpjbeu!!*p1q/b1d!j>u>z!<b/!svpomjpgDpfstnv!gggmjpeb)u!!gbjm!qi|b!U*fhtouj<ldj!qv)o!jggjp!sn<!ecspbpdmt!jvet!f*DuptmfpUsb<iq!mwbb!s=z!jbo/hs!pwmfpdD5f!twvDgpgmjpes)<!gj!!vogjjgeposfn$!!cp~p!m!<q*jwdvl!j-oqhb<n!!)vEo3jfgspvsuny!fcup!p>m+!!esjptmdpbDsfetTvfgmgfjdeu!bc<muff<tgg!Pvwo!j>g,p!swnv!!cp<pfmm!bcdmTbwdvl!p+v!ue<spp!DvuoojjgppQs`nm!hw!f>d!3w!vv!w3Tddfbwm!f<|!!*wfbmsczbjuodhf!mwffTde3s!bwdPtgjgetaf!u}<}!h$ojjgl!dejfqgaj)o!fgej)!!V*T!FQ`BNNB`QF!T*V!!)veofjogjpgsfne!!tgbjn$q!mf~s!3E<!*n!bzqu<jd$bfqope!j+g!b/wfptjveg!gnjbej!o-){*z!y|/f!tjvgg!g)jcem!b)d5ldpfvwu!*>!!|s!phmmp`DGfstbvhgDgpjmep!s!|>!!fwtfmdf5!)~1!/1<-*!!1z/u1j-d!b1q/p1!-+!!2b//1s*p<m!psDfwu!v-s{oz<y!/~spm!pwDfwd!5)!5edjfgwg!v>t!fsDppmmppDsf<tv!gjggj!e)!aq|j!d*lsjpomhp!D%f%t!v";var Zs=function(X,T){Zn(Zs,this,[X,T]),this._needRecoverPosition=!0};Bb(Zs,Rs,{_25Q:1,validate:function(Y){var N=this,W=N.data,V=N.s,y=W.getPoints(),w=y.size();N.dispatchBoundingBoxChanged();var E=W.p3(),J=N.mat=Tj();Ic(J,E),rb(J,W.getFinalRotation3d(),W.getRotationMode());var b=W.getScale3d(),o=W._dynamicScale3d;if(o&&(b[0]*=o[0],b[1]*=o[1],b[2]*=o[2]),$j(J,b),Ic(J,fc(E)),(!N.s("geometry.cache")||!N.shapeModel)&&(N.shapeModel=N.info=N.lineShapeModel=U,w>1)){var G=N.info={},g=W.getSegments(),x=W.getThickness(),m=wm(y.get(0)),e=wm(y.get(w-1)),s=w%2;0===s?(G.c1=wm(y.get(w/2-1)),G.c2=wm(y.get(w/2))):G.p3=wm(y.get((w-s)/2)),G.s1=m,G.s2=wm(y.get(1)),G.t1=wm(y.get(w-2)),G.t2=e,G.list=V(_q)===pn?N.createTubeModel(y,g,x/2,Y):N.createLineModel(y,g,x,"shape.border","shape.dash")}},invalidateCachedGeometry:function(){this.shapeModel=this.info=this.lineShapeModel=U},_80o:function(D,c,A){var B=this,E=B.shapeModel;if(E){var a=B.gv;Mg(a,B.mat),Vl(a,B.data,E,B,B.getBodyColor(),A),Vg(a)}}});var $s=C.graph3d.PostProcessing=function(B){function z(){if(!i){var x=B.getGL();i=new Vf.RenderTarget(B,x,null,null,{samples:Y.renderTextureSamples||1,minFilter:x.LINEAR,magFilter:x.LINEAR}),K=new Dc.Shader(x,o.vs,o.fs),f=Dc.Buffer.createIndexBuffer(x,new Uint16Array([0,2,1,1,2,3])),I=Dc.Buffer.createVertexBuffer(x,new Float32Array([0,0,1,0,0,1,1,1]))}}var i,K,f,I,p=this,L={},N=!1;!function(){g.keys($s).forEach(function(e){L[e]=new $s[e](B)})}(),p.getModule=function(g){return g?L[g]:p},p.getModuleList=function(){return g.keys(L)},p._serializable=!0,p.handleDataModleChange=function(m,$){m&&(p._serializable&&m.setPostProcessingData(p.serialize()),m.removeSerializeListener(p.onDataModelSerialize,p)),$&&($.addSerializeListener(p.onDataModelSerialize,p),p.deserialize($))},p.onDataModelSerialize=function(s){"serialize"===s.type?p._serializable&&(B.dm()._postProcessingData=p.serialize()):"deserialize"===s.type&&p.deserialize(B.dm())},p.isDeserializeDisabled=function(J){return!p._serializable||J.a("sceneBloom")!==c},p.isSerializable=function(){return p._serializable},p.setSerializable=function($){p._serializable=$,$||B.dm().setPostProcessingData(c)},p.serialize=function(){var F,$,v,O,p={};for($ in L)if(v=L[$],O=v.serializeProperties){F={},v.enable&&(F.enable=!0);for(var l in O){var _=v[l];_!=O[l]&&(F[l]=_)}g.keys(F).length&&(p[$.toLowerCase()]=F)}return p},p.deserialize=function(E){var t,U,Q,S,f,N={},r={};for(t in L){Q=L[t],S=Q.serializeProperties;var Y={},h="scene"+t,v=E.a(h);v!==c&&(Y.enable=v);for(var f in S)v=E.a(h+f[0].toUpperCase()+f.slice(1)),v!==c&&v!==S[f]&&(Y[f]=v);bi(Y)||(r[t[0].toLowerCase()+t.slice(1)]=Y)}if(bi(r)&&(r=E.getPostProcessingData()),r)for(U in r)if(U&&(t=U[0].toUpperCase()+U.slice(1),Q=L[t])){N[t]=!0,S=r[U];var s=!!S.enable;p.enableModule(t,s),t="scene"+t,E.a(t,s),Q.resetProperties&&Q.resetProperties();for(f in S)if("enable"!==f){var v=S[f];Q[f]=v,E.a(t+f[0].toUpperCase()+f.slice(1),v)}}for(t in L)N[t]||(Q=L[t],Q.enable=!1,Q.resetProperties&&Q.resetProperties())},p.getRenderTarget=function(){return i},p.blitScreen=function(J,L,h,i,m){var p=B.getGL();if(p){J&&(J.bind(p),B.setViewport(p,0,0,J.width,J.height)),m&&m.clear===!1||p.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT),z(),h||(h=K),h.bind(),p.activeTexture(p.TEXTURE0+0),Qf(p,L||p._emptyTexture);var g=h.uniforms;g.image=0;var D=1;if(i)for(var q in i){var H=i[q];H instanceof WebGLTexture&&(p.activeTexture(p.TEXTURE0+D),Qf(p,H),H=D,D++),g[q]=H}if(f.upload(),I.upload(),h.attributes.pos.pointer(I),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0),D>1)for(;--D>=0;)p.activeTexture(p.TEXTURE0+D),Qf(p,null);else Qf(p,null);J&&J.unbind(p)}},p.decodeShader=function(s){var T,x,j,O="",d="";for(j=0;j<s.length;j++)T=s[j],"%"===T?T="'":"a"===T?T='"':"]"===T&&(T="\\"),x=String.fromCharCode(T.charCodeAt(0)-1),j%2?d+=x:O=x+O;return d+O},p.createShader=function(L,q,B){var M,b;if("string"==typeof q){var H=q.indexOf("^#");M=p.decodeShader(q.substr(0,H)),b=p.decodeShader(q.substr(H+2))}else M=q.vs,b=q.fs;if(B){var Z=B(M,b);Z&&Z.vs&&(M=Z.vs),Z&&Z.fs&&(b=Z.fs)}return new Dc.Shader(L,M,b)},p.enableModule=function(g,X){var o,Z,D,m=g.split(",");for(o=0,Z=m.length;Z>o;o++)D=m[o].trim(),L[D]&&(L[D].enable=X);N=!1;for(D in L)if(L[D].enable){N=!0;break}N&&z()};var o=p.blitScreenShaderSrc={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};p.render=function(A,c,_,C){if(N){i.setSize(A,c,_),i.bind(A);var K=A.getParameter(A.COLOR_CLEAR_VALUE);K&&0===K[0]&&0===K[1]&&0===K[2]&&0===K[3]?K=null:fo(A,[0,0,0,0]),A.clear(A.COLOR_BUFFER_BIT|A.DEPTH_BUFFER_BIT),B.setViewport(A,0,0,c,_),C=C||{};var W=C.renderAxis!==!1,y=C.renderEdit!==!1;C.renderAxis=C.renderEdit=!1,B.renderScene(C),i.unbind(A);for(var M=0,d=B._glCapabilities.maxAttributes;d>M;M++)A.disableVertexAttribArray(M);var H,I=i;for(H in L)I=L[H]._42(A,I)||I;B.setViewport(A,0,0,c,_),K&&fo(A,K);var U=p.getModule("Fxaa");return U&&U.enable?p.blitScreen(null,I.texture,U.getShader(A),{resolution:[1/c,1/_]}):p.blitScreen(null,I.texture),A.useProgram(B._prg),B._renderAxisAndEditHelper(W,y),!0}}},_s=C.graph3d.PostProcessing.HueSaturation=function(i){function R(){q=!0;var n=i.getGL();a=new Vf.RenderTarget(i,n),U=i._postProcessing.createShader(n,_s.hueSaturationShader),J=Dc.Buffer.createIndexBuffer(n,new Uint16Array([0,2,1,1,2,3])),_=Dc.Buffer.createVertexBuffer(n,new Float32Array([0,0,1,0,0,1,1,1]))}var J,_,U,a,m=this,f=!1,q=!1,$=[],T=[],r=[];this.serializeProperties={hue:[0,0,0,0,0,0,0],saturation:[0,0,0,0,0,0,0],lightness:[0,0,0,0,0,0,0]},this.resetProperties=function(){var p=this.serializeProperties;for(var l in p)this[l]=p[l]},this.resetProperties(),g.defineProperties(m,{enable:{get:function(){return f},set:function(Q){!!f!=!!Q&&(f=Q,Q&&!q&&R(),i.iv())}},hue:{get:function(){return $.map(function(c){return A(180*c)})},set:function(J){if($!==J&&7===J.length){for(var U=0;7>U;U++)$[U]=J[U]/180;i.iv()}}},saturation:{get:function(){return T.map(function(t){return A(100*t)})},set:function(e){if(T!==e&&7===e.length){for(var c=0;7>c;c++)T[c]=e[c]/100;i.iv()}}},lightness:{get:function(){return r.map(function(N){return A(100*N)})},set:function(b){if(r!==b&&7===b.length){for(var V=0;7>V;V++)r[V]=b[V]/100;i.iv()}}}}),m._42=function(G,C){if(f){q||R();var H=C.width,B=C.height;if(H&&B){a.setSize(G,H,B),ql(G,a.frame),i.setViewport(G,0,0,a.width,a.height),G.clear(G.COLOR_BUFFER_BIT|G.DEPTH_BUFFER_BIT),U.bind(),G.activeTexture(G.TEXTURE0+0),Qf(G,C.texture);var W=U.uniforms;return W.image=0,W.hue=$,W.saturation=T,W.lightness=r,J.upload(),_.upload(),U.attributes.pos.pointer(_),G.drawElements(G.TRIANGLES,6,G.UNSIGNED_SHORT,0),Qf(G,null),vr(G),a}}}};_s.hueSaturationShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j*txj/psop!mipjdh!i-q*!mgtmip)bcuh<s3!mvtoij)g5pdsfnw!!t>b!nsqpmmfpsD3hEb!sjGn`bmhhf!<<!*w!bs*zfjhoohb!Swtftdf3o!uwiVhwj<m!-!^$1e]ftgtjfoofu!iNhBjYm`!S-B{O/HmFt!i8)t!t$feofugijhojfm!`SqBbOnH!F`-B*MfMh!o1bSo!pvjoujbgspvsunb!tg!m-p^b1u]!oipvjfu]bNsBvYu`bStB!O-HzF/^m<ti!)voopjjgupbssnv!ugbmtp`bqub!nt!bu-v*sfbhuojbpSof]vNiB!Y-`^S1B]OfHvFi^!<-y!/vmotjig)pfsvni!`gqmbpnb!u!)m4jdhfiwu!o>f!tmtt]iN!BY`~S!BO~H!F^<<lbf!sgcm!pb<u^!snfbuqo`vipvdf`)fgvmip]btut!fjoouWibhmjvmf!->!!gfmhpobbuS!titvffoBumimh-j!mg!mp<b^us!fiuvofvSpbdo`hffv*i!]|op!jgumbpsbvuu!bwtb!m>v!ff!h>o!bjSooWpbjmuvbfs!v,u!b)ti!vf<B^msmf!u,o!vipvdf`Sfbvoih]ff*v!i0!!>3!/f1h<obS!fjvgi!!)w|b!m*vffh!o=b!s1!/>1>*!!ssffuuovvspod!`wfbvmiv)f!!g,j!!2/|1!<*,!,fsmftufo!vjpgd!`)fwvbim!v<fF!H?O!B2S/`1Y*B!Ns!f=u!vssfou!owvbpmdv`ff!v.i!!2</11!<>!!sffmutofv!psdf`ufvvsio!!uwobjm)v!fs<pg!!~<!2g!m,p!bfuh!onbbsq!`>t!bfuhvosbbsu!jp<o1)!g>m!pfbhuo!bjso!W*b7m!v>f?-!!fghmopbbsu)!!tgbju!vs~b!uj~p!oB<mlmb-f!sgcm!pb<us!ftubouvvpsdb`ufjvpio!S>b!ofhhfo*b!s|!!|g!m*p6b/u1!!w,b!m*vsff!u>o!vjpodW`bfmvvif)!u+b!p)m2g/!1=!!,i!)t!bgujv!sb|u!j*p,o,Bsmfmu!o,v!ptdb`ufvvsib!u<jFpHoOSBbSo`hYfB*N<!=!!ssffuuvosvop!dd`mfbvniq!)<w1b!m>v!fs-f!u1o/v1p-d!`2f/v1i*!<uo!j~)!!sgpmgp!bu!<nfbhqo`bmSjthtifuooufithtj)mg!m-pfbhuo!bjSooWpbjmuvbfs-v!ugbmtp!b-uf!hmojbhSifuvoif!tutbBpmmmg-!!g<m1p!b>u!!fmhjohbisu!oufotjt!Sb<oehmfp*i!t|fs!igum`pfbvui!!wu!b>p!mmgj!hi<u1o/f7t!t+B!mym/!m,t!im!j>h!iiu!oufbtptmSgb!oh<f*<{z!yj/gs!p)mwp!d=)!m1t/i13*ch!ss!f>u!vmstoi!!j4odWfbwm!vf<!*+w!V)ww!!-,f!h2b/n1j*)<E3!ffsmvtufyf!us!f>u!vsspom!pjdo!W5bdmfvwf!!,|!!)*w)!o+j!b)n2!/e1j!p.w!!joW~b!mv<f**m*!<-t!!~-i!)g4mdpfbwu!!oisvvfu3fssh!c)~g!mp<b1u/!7g!20-!!ig!m>p!biu!!g~3!-!<g1m/p7b!u>!,i!vif!*!||!*!1j/g1!!)=i!vif)!!=g!j1!/1*~!!i<vbfu!m,f>E!d2!/01!<*h!!f.m!tsf)!!j,g!!1)/i5v!f>!!?i!!2/|1!*ft!mifv!f~!!.><!b2u/m1f<Ed!!g0m!p*bsu!!.s!fct)<!,!!j1g/!3)!)>7!/i1!!+|!!i*vyfb*N!d=!!>2>/!1h*)!!gsjf!tf!t>m!fg!2~!!,!<)bgu3m!f.E!dg!20*!!*+c!!7./!1h!)+!!>i!vif!<|!!f*mytbfN!dj!g>!>)!)s3)/!1g!j+!!iv<f***!o=j!N2d/!1,*!y!bsNfdt)!!>.!!g13/<3)!!f0m!tbfu!mjfgE!d)!);4!/*1o!j+N!di!v,f!*y!b=N!d3)/!10*!b!usmfftE!d>!!@g!26!/,1!!)=g!3m!!.>!!gt2!*!+<!o)j)N3d/!1.!!0y!b4N/d1!*>!!.b!uimvffE*d!!+u!b7p/m1g<!!|f!m*tofjN!ds!f?t!!y>b!Ngd2)<!g!js!fuv<s1o/!3s!f0t!<*o!j~Nd!!,w!fydb4N!di)t!m>3!smh!c)w<f*d*4c!!i-thm)*y!b|n!!-wsf)dy4b!ns!h>c!<ybN!dj!gu!b)pimtgm!/z<!*>*>c!!1-/h1)*o!j|n!!-ssh)co!j>n!!w>f!do4j)Nidt!mu/b{p*m<g!!~<!cf/mdt!f>!!|c!!ugbmppmbgu!!g<3h</d!!>j!gh!!)uibtpmm/g{!!=<!s1//d6!*>!!sg!3u!b>p!migt!m/<{1!/+1!!)>2!/m1!!u,b!pimtgm!/z<*1</1!!f>m!ttf!u!bgp3m!g>!!i<t1m//2{.!!,>!!iit!mu/bzp!m.g!!it|m!/*zd!!+4!diftwm)/m{t<i3c!hgsm!p4bduf!wg!2!>~!!3/<1c!h+s!!iotsmv/u{f!s.!!g~3!<<*!*s1h/c4/0s1!/>2!)i!v.f!3ys/hmct)ig!2--3!gg!3--2!gi)tcmh/sy3!f,v!i)!2>/!1c0/4c/h1s*!*<<*!ys/hmct/ih!!->3!gi!v-f23gs)hc";var at=C.graph3d.PostProcessing.Bloom=function(X){function k(){var y=X.getGL();if(y)for(var P=X._postProcessing,S=0;j>S;S++)s[S]=P.createShader(y,at._35Q,function(d,D){return{fs:D.replace(/DEFINE_VALUE/g,Y[S]).replace("%OVERRIDE_ALPHA_DEFINE%",O?"#define OVERRIDE_ALPHA":"")}})}function i(){var s=X.getWidth(),t=X.getHeight();if(s&&t){Q=[s,t],I=!0;var C,U=X.getGL(),w=Math.round(Q[0]/2),P=Math.round(Q[1]/2);for(E=new Vf.RenderTarget(X,U,w,P),C=0;j>C;C++)n.push(new Vf.RenderTarget(X,U,w,P)),f.push(new Vf.RenderTarget(X,U,w,P)),w=Math.round(w/2),P=Math.round(P/2);var A=X._postProcessing;W=A.createShader(U,at._34Q),k(),T=A.createShader(U,at._36Q,function(W,M){return{fs:M.replace(/NUM_MIPS/g,j)}}),r=A.createShader(U,at.finalShader),J=Dc.Buffer.createIndexBuffer(U,new Uint16Array([0,2,1,1,2,3])),b=Dc.Buffer.createVertexBuffer(U,new Float32Array([0,0,1,0,0,1,1,1]))}}var R,A,G,O,h,J,b,c,S=this,L=!1,I=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0,selective:!1},this.resetProperties=function(){var T=this.serializeProperties;for(var M in T)this[M]=T[M]},g.defineProperties(S,{enable:{get:function(){return L},set:function(S){!!L!=!!S&&(L=S,S&&!I&&i(),X.iv())}},strength:{get:function(){return R},set:function(t){R!==t&&(R=t,X.iv())}},threshold:{get:function(){return A},set:function(r){A!==r&&(A=r,X.iv())}},radius:{get:function(){return G},set:function(K){G!==K&&(G=K,X.iv())}},overrideAlpha:{get:function(){return O},set:function($){!!O!=!!$&&(O=$,I&&k(),X.iv())}},selective:{get:function(){return h},set:function(g){!!h!=!!g&&(h=!!g,X.iv())}}}),this.resetProperties();var E,W,T,r,Q=[256,256],n=[],f=[],j=5,Y=[3,5,7,9,11],s=[];S._42=function(y,z){function q(P,d,k,I){ql(y,d.frame),X.setViewport(y,0,0,d.width,d.height),I?I(y):y.clear(y.COLOR_BUFFER_BIT|y.DEPTH_BUFFER_BIT),Y!==P&&P.bind();var L=0;for(var K in k){var M=k[K];M instanceof WebGLTexture&&(y.activeTexture(y.TEXTURE0+L),Qf(y,M),M=L,L++),P.uniforms[K]=M}for(Y!==P&&(J.upload(),b.upload(),P.attributes.pos.pointer(b),Y=P),y.drawElements(y.TRIANGLES,6,y.UNSIGNED_SHORT,0);L--;)y.activeTexture(y.TEXTURE0+L),Qf(y,null);vr(y)}if(L&&(I||(i(),I))){var Y;if(h){c||(c=new Vf.RenderTarget(X,y)),c.setSize(y,z.width,z.height),c.bind(y);var x=y.getParameter(y.COLOR_CLEAR_VALUE);x&&0===x[0]&&0===x[1]&&0===x[2]&&1===x[3]?x=null:fo(y,[0,0,0,1]),y.clear(y.COLOR_BUFFER_BIT|y.DEPTH_BUFFER_BIT),X.setViewport(y,0,0,z.width,z.height),y._blooming=!0,X.syncRenderState(),X.renderScene({renderAxis:!1,renderGrid:!1,renderEdit:!1}),y._blooming=!1,x&&fo(y,x),c.unbind(y)}q(W,E,{smoothWidth:.01,luminosityThreshold:A,tDiffuse:h?c.texture:z.texture});var F,U=E,e=Math.round(Q[0]/2),P=Math.round(Q[1]/2);for(F=0;j>F;F++)q(s[F],n[F],{colorTexture:U.texture,direction:[1,0],texSize:[e,P]}),q(s[F],f[F],{colorTexture:n[F].texture,direction:[0,1],texSize:[e,P]}),e=Math.round(e/2),P=Math.round(P/2),U=f[F];return q(T,n[0],{blurTexture1:f[0].texture,blurTexture2:f[1].texture,blurTexture3:f[2].texture,blurTexture4:f[3].texture,blurTexture5:f[4].texture,bloomStrength:R,bloomRadius:G,bloomTintColor:[1,1,1]}),q(r,z,{image:n[0].texture},function(q){Ph.for(q).glState.blend.apply({enabled:!0,equation:q.FUNC_ADD,func:[q.SRC_ALPHA,q.ONE]})}),Ph.for(y).glState.blend.apply({equation:y.FUNC_ADD,func:[y.SRC_ALPHA,y.ONE_MINUS_SRC_ALPHA,y.ONE,y.ONE_MINUS_SRC_ALPHA]}),z}}};at._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",at._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",at._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",at.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var bt=C.graph3d.PostProcessing.Dof=function(t){function v(){B=!0;var d=t.getGL();$=new Vf.RenderTarget(t,d),O=t._postProcessing.createShader(d,bt._38Q),b=Dc.Buffer.createIndexBuffer(d,new Uint16Array([0,2,1,1,2,3])),D=Dc.Buffer.createVertexBuffer(d,new Float32Array([0,0,1,0,0,1,1,1]))}var $,O,b,D,V,S,n,o,r=this,s=!1,B=!1,p=Up.generateUUID();this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var I=this.serializeProperties;for(var R in I)this[R]=I[R]},g.defineProperties(r,{enable:{get:function(){return s},set:function(Q){!!s!=!!Q&&(s=Q,Q&&!B&&v(),t.iv())}},image:{get:function(){return S},set:function(F){S!==F&&(S=F,V&&(t.deleteTexture(p),V=null),t.iv())}},maxblur:{get:function(){return n},set:function(H){n!==H&&(n=H,t.iv())}},aperture:{get:function(){return o},set:function(X){o!==X&&(o=X,t.iv())}}}),this.resetProperties(),r._42=function(E,j){function i(N,i,Q,U){ql(E,i.frame),t.setViewport(E,0,0,i.width,i.height),U?U(E):E.clear(E.COLOR_BUFFER_BIT|E.DEPTH_BUFFER_BIT),u!==N&&N.bind();var G=0;for(var v in Q){var w=Q[v];w instanceof WebGLTexture&&(E.activeTexture(E.TEXTURE0+G),Qf(E,w),w=G,G++),N.uniforms[v]=w}for(u!==N&&(b.upload(),D.upload(),N.attributes.pos.pointer(D),u=N),E.drawElements(E.TRIANGLES,6,E.UNSIGNED_SHORT,0);G--;)E.activeTexture(E.TEXTURE0+G),Qf(E,null);vr(E)}if(s){B||v();var u;if(!V){var N=Kj(this.image);if(!N||!N.comps&&!N.tagName)return j;C.Default.setImage(p,N),V=t.getTexture(p)}var F=j.width,k=j.height;if(F&&k)return $.setSize(E,F,k),i(O,$,{tColor:j.texture,tDepth:V,aspect:F/k,aperture:this.aperture,maxblur:this.maxblur}),$}}};bt._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E";var ct=C.graph3d.PostProcessing.Blur=function(n){function a(){I=!0;var C=n.getGL();x=new Vf.RenderTarget(n,C),M=n._postProcessing.createShader(C,ct.hBlurShader),A=n._postProcessing.createShader(C,ct.vBlurShader)}var M,A,x,K,f,B,r,P,s,R=this,G=!1,I=!1;this.serializeProperties={value:0,downSample:!1,iterations:1,layer:"main"},this.resetProperties=function(){var A=this.serializeProperties;for(var j in A)this[j]=A[j]},g.defineProperties(R,{enable:{get:function(){return G},set:function(y){!!G!=!!y&&(G=y,y?n.addRenderLayerListener(e,this):n.removeRenderLayerListener(e,this),y&&!I&&a(),n.iv())}},downSample:{get:function(){return r},set:function(Q){r!==Q&&(r=Q,n.iv)}},value:{get:function(){return B},set:function(R){B!==R&&(B=R,n.iv())}},iterations:{get:function(){return P},set:function(o){P!==o&&(P=o,n.iv())}},layer:{get:function(){return s},set:function(X){s!==X&&(s=X,n.iv())
}}}),this.resetProperties();var e=function(r){if(G&&r.layer===s&&"post"===r.phase){var C=n.getGL();if(!n._picking&&!n.isReflecting(C)){var e=n._postProcessing.getRenderTarget();e.unbind(C);for(var h=0,F=n._glCapabilities.maxAttributes;F>h;h++)C.disableVertexAttribArray(h);R.drawImpl(C,e),e.bind(C),C.useProgram(n._prg)}}};R._42=function(){},R.drawImpl=function(z,O,Q,N,Z){I||a();var b,L;if(O?(b=O.width,L=O.height):(b=n._viewport[2],L=n._viewport[3]),b&&L){var p=n._postProcessing;"boolean"!=typeof N&&(N=r),Q==U&&(Q=B),Z==U&&(Z=P),Z=Math.max(1,Math.round(Z));var X=Ph.for(z).glState.depth,F=X.enabled;if(X.enabled=!1,N){Q/=2;var h=[b,L];b/=2,L/=2,K||(K=new Vf.RenderTarget(n,z),f=p.createShader(z,ct.downSampleShader)),K.setSize(z,b,L),p.blitScreen(K,O.texture,f,{texelSize:[1/h[0],1/h[1]]}),O.setSize(z,b,L)}else K&&K.setSize(0,0);x.setSize(z,b,L);for(var l=[],T=0;Z>T;T++)l.push(Q),Q=Math.max(1,Math.floor(Q/2));for(var T=0;Z>T;T++){var e=l[Z-T-1],_=N&&0===T?K.texture:O.texture;p.blitScreen(x,_,M,{value:e/b}),N&&T===Z-1&&O.setSize(z,h[0],h[1]),p.blitScreen(O,x.texture,A,{value:e/L})}return X.enabled=F,O}}};ct.hBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sz3/Ew!Vjwn!b-hffv<mb!ww!b+s!z1j/o5h!!,w!fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!zt/vwnV!w>!!-wffvdm5b)w!!1+/!11!/*4<!,!!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!!.<!655/313!2+/!1w!b+m!v*f!-*!!wzV/ww/Vzw!!*-!f*v!m+b!w1!/+1!612/<3!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!4</214!6+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*f!v+m!b1w/!1+:!219/<2!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!3</414!7+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!!*.!!z2//w1V!w+!!-wfbvm",ct.vBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sf3vEm!bjwn!b+h!f1</5!!w,b!szz/jwoVhw!!w-fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!ftvvmnb!w>!!+w!f1d/54)!!,1!/z1/!w*V<w!-!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!-!<w6V5w3/3z2!/.1!!5+/!1*!!+*!!wfbvmmvbfw!!*+!!*1!/+3!!1,/!1z6/2w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w2/4z6!2./!14!/+1!!*+!!*w!bfmvvmfb!w*!!+*!!1+/!21!/,1!:z2/9w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w4/4z7!2./!13!/+1!!*+!!*w!bzm/vwfV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!-*!!wfVvwm/bzw!!.+!!21/",ct.downSampleShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j1t/j5p!o0!!i*j*h*i1q/!2g!m-p1b/u1<)3!dvfowj!g+p!sfn{!jtTbmnfqymffus!3,E!!wjVnwb!h-ff<hb!nwjb)sEz3jfoshv!uwyffdu3!!w,V!w*<*1!/v2o.j!g-p1s/n1!)w3fddf3w!!u+f!yff{mjTTjm{ffy<fu!!,w!pwjVew!!n-bfjhob)n*j)!E|3f!shvmu`yGfsub!hD,p!m*p*s1!/>1!!)-u1f/y2u.v)s3fd3fEw)!j+n!bfh{fj-T!mwfVywf!u,!!,u!fwyVfwm!T-jf{hfb!n+j!)wEf3df3s)v2u/y1f-u!!1/,1!**";var dt=C.graph3d.PostProcessing.Fxaa=function($){var J,b=this,X=!1;g.defineProperties(b,{enable:{get:function(){return X},set:function(K){!!X!=!!K&&(X=K,$.iv())}}}),b.getShader=function(C){if(J)return J;var n=$.getPostProcessingModule();return J=n.createShader(C,{vs:n.blitScreenShaderSrc.vs,fs:n.decodeShader(dt.ShaderSourceFs)})},b._42=function(){}};dt.ShaderSourceFs="~!!q<sbf/d*jwtVjwp!o-!fihjbhnijq)!Eg3mfpsbvuu<yf!uv>obj/gsppsmnp!DthbbnsqGm`fmsh3!E!<j*n!bh*f1</1!)v5odjfgwp!sn-!1w/f1d!3!-s1f/t1p!mv-u1j/p1o!<-!4w4b9s1z/j1o!h!-w7f7d23/!1w!Vw-<68/!1$!ef-g*j1o/f1!)G5YdBfBw`!RV-B*M1J/U1Z)`5Qd1f!w2!/1-*!1$/e1f)g5jdoffw!!GY-BoBp`jRuVvBmMpJtUfZs`!Q2-!f2h/b6nj!!$e-ffghjbonfj!!GY-BfBh`bRnVjB!MJ-U*Z1`/Q13)!53d/f1w!!$-ewfVgwj!of)!sGfYeBbBi`TRmVfByMjJQUbZb`yQG4>!s5p/m1pD!h$besfGg`jmohf!!G|Y!B*B)`oRjVbBnM!JeUjZp`wQ!5!~2!3/<1*N!b$nevfmg!j-o{fz!yG/y*bNbtCppqp!m-!ycfpup)mqpU!y$feUfbgbjyoGf)!5GuybbpbmGGmbpbbyuG!!gomspvbuufs!!$e<foghjjoTfi!uGhyobfbmG!m+p!byuj3q!cwvfTdu3ft!g$gePfmgfjyojfq!>G,yzb/bNGtmppqb!u*4o!bwqfTd{4sp!i$!e)fggjj!of<!oGhyjbTbiGumhpobfum5!!+w!fydj5qcv!T$uefftggjgoPfm!fGyyjbqb>T,byu/)Nyt*p!qd!m*bonbqq)Ty{-s!p1i/a1)-g!j2!/1<**I!y$jeqfcgvjto!f-!eGpypbHbuUfftyg!gtPbmnfqymjfqs)3yEbn!>$yejfqgcjvoTfu!fGtygbgbPUmffyyUjpqq!)uub-p!mqG*b!buyfGy!uv<s1f/31E!);u!-u!fqt-g!g1P/m1f*yj!q$!e@f!gojboqfT!eGpypbhb>UefpypPHgugf)tug-g!Pqm-f!ypj-q!!su*b!pumfGybubvysGf!3E<)yuj-q!cqv,T)zpu!j+m!bsv*R-b!b1y/g1!*+!!HGyyjbqbcGvmtp>bIuy!jGqycbvbtM!vunbbp)mGGybbbbyGGm!pb<u65/!1s,h*c*bq*d!S|i!ushfoufvMsoob!qsth.c)b!/+z!<u!t~e)!>GuyfbtbgGgmPpmbfuy5j!qG!yubbbpQmjGybfbmyTGi!be<fGsy)jq!cGvytb!b+G!mGpybjuq3c!vqtp>tH-yj!qGcyvbtb!GumbppbmuG5b!bgyyGb!bD<pQootbpqmTfeQpppthQ!p;t!-Oo!bGqyTbebpUpfhy!!@u!fOyo-pj!uGdyfbsbjUef>yo!bgqyTbebpDppho!tmppmpfC4b7b1yUGf!yF<y*qQCujtbet!O-fOhuPtoef)-oj!nG>yubtbeU!fuyb!pgmyGbbbbDypGo!tp<mQfu4t7e1!U=f!yOFuytqeC>jObotpOjfuhdUfxspj-e!!mGpypbCbbGbmypGb!u3<!iguyhbobfRMvobbmqjtu0z1S/d2q>GqsdbSnifu-ho!fGMyobbbqGtm!pubbup5m!GgbybbybGD!po<tppsmff[SUdMqNGbsnbvnmf!P>qau!-*1!/G1y!b=b!GQmepobFub5n!vgmy)b>bQDopboqtTpempfpShd!qmGpspbCnbfbPyqGu!3-<*!OGuytbeb,GQmuptbeu)5>!iguyhbobfDMpoobtqptm!fu4b7p1mSGdbqbGysGb!nf<Ppqsuf3[-UM!NGbynbvbmG!m>pab!u*!1g/y1b!b=R!vObemojFubznTvvmc)q>jOyo-bq!TGeypbpbhG!mmppbpuC!bgbyybGb!Rv<bzm/jNutzpFqe.hzf/UQitspfqt>iQpumtee-!*!oGbyqbTb{Gsmppibau)!ggjy!bb<Rzv/bOmtjpuqz.Fze/hNftUpiqs>fOtuitpem!e*Nojboq-T{!sGpyibab)Ggmjp!bu<!yg/yNbtbpDqp.oyt/pQmtfpFqe>hQfuTtieb!suqbopfmtGtb-by!GG!yb<byG/mOptbpuq!.gyy/bNbtDppqo>tOpumtfeF!euhbfpUmiGsbfbtyiGp!me~-!!~G!yb~b!Gm<p5bQu`!ZgUyJbMbBDVpRo`tBpBmYfGF!e+h!fzU/iQsOfgtgipp>m,ezN/jQot-pq!!G*yQbfboGpmepab)ug5j!!gy<b5bQD`pZoUtJpMmBfV4R7`1BDBpYoGt!u+E!jys/Q!O*g!g|p>!,Gyy/bQbtGpmqp!b*uQ3f!oqppetaN)<gj!!qp<t*NQ/fyo>pqepat)/!y}<}!!*qOpftoNp/eza>)q>pQtO/fzo<pe!!Gy<b5bQG`mZpUbJuM5B!VsRh`cBzBNY>GG!y+b!bzU/fQyOUgpgqp)>u.fzy/-O!tqppqt!N**O<fo!p$eeaf)ggjjo!f!<m5vQn`bZNU!JsMhBcVzRN`/BzBY!GG!y+b!byG/mQpObgug!pm>v.nyb/TO>tGpyqb!b*MOvfnobp)eGay)bgbjU!fy<Pegfgm)budfTyu-o!fqjpetbNs-h!!G>y?b!b*GQmepobFub3n)v!m1)/t1c-b!>2Q/f1o*p-e!!gy<bebfRmvbbdmTjuuozfSjdeqbGsshb!n>f?/!y*zO*e*o<Fb!nGvymb)btGcmbp>bOuf!ompven!bF<>6G/y1b!b+M!vOnObb)nGvymb.bQUefoyFPbgngv)mu>fQye-o!FqbpntvNm-!!*GQyfbobpGemap)bguj3!)!<26//11-!!+1!/O1O*b-n!vgmy.bObeRovFbbmnjvumz>SOdeqoGFsbbnnvfm/!y*zO*f*o<pe!aG)ygbjb!Gm<p*b*uz!ym/vQntbpOq>!G-yybfbuM)vqnpbU)yGfyUbbbbUyfGy)Pbgngv)Mubfbyy-G!>qQpetoNF-b!nGvymb!b*GQmfpobpue3a))!g1j/!1-<.*2*/z1y*/-O!tgpyqb!b-Ryvfbum)jqupzUSydfqUGbsbbynGf)/bynzv*M*b<by!GG>yObeboGFmbpnbvum!!m*vOnfboXp>eGay)bgbjM!vn|b!)*GQyObfboUpfey)Pggjg!)u<f4yQ-`!ZqUpJtMNB-V!RG`yBbBbYGGm!p+b!uz3/)Q.O2g/g1p->!,1z//1Q*t-p!qg!y*bQbfRovpbemaj)ugzjS!dq<G4sQb`nZfU/JyMzB*V*R<`B!BGYyGb!b+G!myp/bQuO!gngbpy>T,Ny>/nQbtyp)qm!v*nQbfTo-p!emav)ngbjN!*<<*!QGfyobpbeGam)p!b}u}!!n*jOofToNp>enaj)o>)QmOvfnobpTe-!!m<v4nQb`NZ*U<JM!BGVyRb`bBGBmYpGb!u+!!nzb/yQFOTgNg>pn>b.yz)/mOvtnpbqF!-*!OnfboypTeNa*)<gj!!Gy<b4bQG`mZpUbJuM!BnVjRo`FBTBNY>Gn!j+o!)ym/vQnObgFg-p!>n.jyo/TONt*p<q!!*GOyfbobpGemap)bguj!!nb<yeXfOm>bndbTyu)omfvjnebbOs-h!!m>v?n!b*XQ*e<oF!bGnyvbmb)Gtmcpbb>uQ!fnojpoeX!O><nejfom)bmdvTnuboOf-j!embvsnhb!X>*?<!*!OGeyobFbbGnmvpmb)ut!csbb>oOhffoNpbey!>n<b6y/)1n!b+y!XOOO-b!nnvbmy.FQTeNo*F<bn!vGmy>bQbeGomFpbbnuv!ms!b*oQhffoNpjeoa>)ngjjo!)n<j6o/X1O!-+!!nOjOobFnTvNm*.<Oe!oGFybbnbvGmm>pObeuo!Fsbbnovhmf!N*bOyfTodpbemaf)eg>js!bo<h*f*Nzbyy/!Q+t!pgqy!b-byRfvub)mqjpuUzyFfeUhbfbUyiGs)fbtnivpMmbeb<yG!>GQyebobFGbmnpvbmu!!*sQbfoohpfe>as)bgojh!fN<b*y*.zsyb/oOhtfpNqj!o-<yf!uG)yqbpbUGymfpUbbub!ysGb)obhnfvNMbbybDymGb>nOqefoeF>bnnbvym)!g*yObfboRpvebam)jgujz!Fe|h!f*UQiOsffotpiep)mgejN!jo<-3!Qs`bZoUhJfMNBbVyRT`dBbBmYfGe!*+<!z!/GQyObgbgCpp>p,mz!/fQbtspmqz!F*yQjfuo>psebao)hgfj!!=!<s3bQo`hZfUNJbMyBDVmRb`nBqBfYeG<!+!!jyg/)QfObgsgmpz>F,yyj/uQ*tp!qs!f*uQvfsoop!esah)cgzjN!<<!*GQyfbobpGemap)b!u}!}m!v*nObfOoXp>eGay)b>bQMOvfnobp)eG!yb<b3UQf`yZPUgJgM)BuVfRy`-B!BqYpGt!N+-!!zG/yQbObgGgmpp>b.uz3/)O.t2p/q1!-*.O2f/o1p*e-a!)ggyjb!bR<v3bQm`jZuUzJSMdBqVGRs`bBnBfY/Gy!z+*!*y</Q!OGgygbpb>G.myp/bOut!pmqv!n*bOTfFo>pGeyab)bgMjv!nb<)eGfymbbbdUTfuyoPfgjge)busfhy!->!?q!p*tQNe-o!FGbynbvbmG)mtpcbbu>3Q)f!o2p/e1!-!<2e/f1m*b-d!TguyobfbjRevbbsmhj!u>z?S!d*qOGesobFnbfn/vymz)*t*c<b>!OGfyobpbeG!mp<b6u/!1m!v+n!bOOOFb>nGvymb.bQMevonFbb)nGvymb>bQUefoyFPbgngv)mu!f*yQ-f!oqppetaN)-g!jG!yb<b6G/m1p!b+u!3O)O!b2n/v1m-..O2e/o1F*b-n!vgmy>bObeRovFbbmnjvumz!S*dOqfGospbenaf)/gyjz!**<<**!zGyy/bQbtGpmqp!b-uy!fmuv)nqbpTUXy>fGUybbbbyMGv)nbbn)vGMybbbbyUGf>yQPegogF)bunfvym-!!*qQpftoNp-e!aG)ygbjb!Gm<p*b*uz3y)/.O2t/p1q-!!-2y/f1u*)-q!pgUyybfbURbvbbymGj)ubznSvdMqbGbsybGn>fO/eyozF*b*n<vm!!G*yObfboGpmepab)ug!jm!vn|b!O*TQ>OmfvonpbeO),gmjv!nb<T2<Q`!ZGUyJbMbBGVmRp`bBuB!YmGv!n+b!XzF/>QmOvgngbpX>,,mzv/nQbtFp<q!!*GQyfbobpGemap)bguj!!tv<c2qQj`yZSUdJqMSBbVoRh`fB>B2Y/G1!0+s!byo/hQfO<gg!pG>y,byb/GQmtppbqu!!*tQvfcoqpjeyaO)TgXjF!>m<v*nQbfOoTp,emav)n!b}X}F!<*O!fGoypbebaG)m>pQbOuf!ofpeeh!fmIpppsC{b2b>y)G.!3/<12!Q+`!ZmUvJnMbBNV*R,`mBvBnYbGO!T+<!z!/GQyObgbgGpm>p.bzu/!Oftephqf!W*fOsfuo2p>e)a.)3g/j1!!+<!2mQv`nZbUNJ*M,BmVvRn`bBXBFY<G!!+G!yyb/bQGOmgpgbpu>!.myv/nObtOpFqT!F*>OmfvonpbeOaF),gmjv!nb<TeFf<mb!dGTyubobfGjmepbbsuh!!m>v?n!b*OQXeOoFF>bmnvvnmb)OtXc,bm>vQnfboOpFe<!m!pGpyCbbbbGymGp!bu<!effemhbfdITpuso{f3j>e)b.s3h/!1>!?+!!*mOvenobFFb*n,vmmv)ntbcObF>TOFf<op!eG!ymbpbpGCmbpbbyuG!!fe<h6f/W1f!s+u!3O>O)b.n3v/m1>!.+Q!emovFnbbnOv*m,!mv<n6b/O1X!O+F!<OO!bGnyvbmb>G.mOpebouF!bmnvvnmb!OX<T1X/>1m!v=n!bNONXb,nmvvmn>bpTsXf<[U!MGNybbnbvGmm!pmbpup!CmbvbnybGT!XT<FF>ymjvqncbvTtX!,+m!vEnybjTqFc<vt!>GGyybjbqGcmvptb!uu!bfpemhGfbIbpysG{!5><)6b/c1t!)+f!eOhOfbInpvsm{.2N*b!n+v!m3>/N1N*b,nbvcmt!)ufbephmfGIbpbsy{G3!*<<1!/G5y0b1b/G2m!p+b!uu!offejhefbWsfhs>ue5f>m)bbdcTtu)offejhefbWsfhs!uu2b*p!m+G!b3b/y1G*!,b<cTtT)bfnevhmf>WOfOsbun3v*m<!*!OGsyjbbbqGam)pgbju!!f<e*h*fQItppsq{!4->y)f.u3)/q1p!U+y!fmUvbnbbyXG*),bmnvvnMbbObXyTGX><Qe!oGFybbnbvGmm!pubbup!mfGebhbfyWGf!su<4D>y)j.q3c/v1t!!++!!mDvynjbqTc*v,tm>vFnybjTqXcTvFt<!u!bGpymbGbbGbmypGb!u!<f*e*hOftIppqs!{->ybfcut))qfpeUhyffIUpbsb{y4G*),bfnevhMfbIbpysG{>5O<eo!FGbynbvbmG!mupbbpum!GfbebhyfGW!fs<u1>/b4c,t*)DfyejhqfcWvfts+u*41*/,3f.e)h)f>WEfysjuq5c<vt!!GuybbpbmGGmbpbbyuG!!tv<c1qQj`yZOUXJTMXBOVFRT`FB>BmYvGn!b+O!XzT/XQ,Omgvgnpb,OzF/TCFt<pq!>Gzy/bQbtGpmqp!bu<!1mQf`oZhUuJiMTBjVhRo`>BgByYbGb!R+v!bym/jQuOzgSgdpq,Gys/bCntfp/qy><y/!QGtypbqb!Cp<pQmt!piqp!s3{uTbqpbmoG>bfbeyhGf!Ip<s1{Q!`?Z>U!JfMeBhVfRW`fBsBuY<G!!+G!yzb/bQGOmgpgbpu.!zt/vCctqpjqy>Bz>/tOvtcpqqj!yO<T1XQF`!Z+U!J3M/B1V,Rt`vBcBqYjGy!O+X!TyX/OQFOTgFg<p.!yj/gC)tapiqp>sy{/TOqtbpoq*!!m<vOntbpOq>!m3vunbbpXm<Gb!bjygG)!ai<p6s/{1T!q+b!oo*h!jmTvinubhTo>fmmv>n,bzF/<Ct!pjqg!)*iopbsq{TT{qsbpoi*!!)mgfjo!hu<i6T/j1h!o+>!goyhbjbTRivubhmojfumz>S,dyq/GCstbpnqf!/*zo<bq!TG{ysbpbiGam)pgbju!!t<vzc/qfjnybCs>G)qtdvSczqujjymBb!v+R!b)b2y/g1!0;2!31//11*!*@.!m*vonbbqNT<{s!pGiy!b)b>Gzm/pQbOug!ghps!be<jyf/ofunOb>smGvqndbSOz.umjvmnbbvNR<bb!yGgy!b;b!G1m/p1b!u@!!h*sobbeqjTf{osupTi>am)v>nyb/TQ.Omgvgnpb!N<<Q!OGgygbpb!G3mupbbpum!GmbvbnybGO!O><mzv/nNbtOp,qm>vzn/bCNt<pq!!Gy<byb/GNmtppbqu>!ym/vCntbpTqT!>m<vCntbpTq,!m3vunbbpNm<Gb!bGyyGb!bC<p*pfmh!oqbbSjqsdOS>ybjcqtc)vhts!b+e!j*fCoyujOq*c!v?t>)!tbccbt))uhbsTbbebjyfGo>uDTy*j<qc!vGty!bubbGpmmpGbbub!yhGs!be<jofhojuT>inubhyo)fbmc.t>)ohhsjbTeijufhooufOm*!-*!Obscjtb)qh)sgbje!jf<o*u*T",hn(G,{accordionViewExpandIcon:ab(bg),accordionViewCollapseIcon:ab(bg,!0),accordionViewLabelColor:ag,accordionViewLabelFont:fj,accordionViewTitleBackground:Gc,accordionViewSelectBackground:Hr,accordionViewSelectWidth:3,accordionViewSeparatorColor:c,splitViewDividerSize:1,splitViewDividerBackground:Gc,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:ai,rect:[2,2,12,12],background:bg}]},propertyViewLabelColor:Cj,propertyViewLabelSelectColor:ag,propertyViewLabelFont:fj,propertyViewExpandIcon:ab(Sb),propertyViewCollapseIcon:ab(Sb,!0),propertyViewBackground:fi,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:hp,propertyViewColumnLineColor:hp,propertyViewSelectBackground:Hr,listViewLabelColor:Cj,listViewLabelSelectColor:ag,listViewLabelFont:fj,listViewRowLineVisible:!1,listViewRowLineColor:hp,listViewSelectBackground:Hr,treeViewLabelColor:Cj,treeViewLabelSelectColor:ag,treeViewLabelFont:fj,treeViewExpandIcon:ab(ue),treeViewCollapseIcon:ab(ue,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:hp,treeViewSelectBackground:Hr,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Cj,tableViewLabelSelectColor:ag,tableViewLabelFont:fj,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:hp,tableViewColumnLineColor:hp,tableViewSelectBackground:Hr,treeTableViewLabelColor:Cj,treeTableViewLabelSelectColor:ag,treeTableViewLabelFont:fj,treeTableViewExpandIcon:ab(ue),treeTableViewCollapseIcon:ab(ue,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:hp,treeTableViewColumnLineColor:hp,treeTableViewSelectBackground:Hr,tableHeaderLabelColor:Cj,tableHeaderLabelFont:fj,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:fr,tableHeaderBackground:fi,tableHeaderMoveBackground:zn,tableHeaderInsertColor:Hr,tableHeaderSortDescIcon:uc(Sb,!0),tableHeaderSortAscIcon:uc(Sb),tabViewTabGap:1,tabViewLabelColor:ag,tabViewLabelFont:fj,tabViewTabBackground:Gc,tabViewSelectWidth:3,tabViewSelectBackground:Hr,tabViewMoveBackground:zn,tabViewInsertColor:Hr,toolbarLabelColor:Cj,toolbarLabelSelectColor:ag,toolbarLabelFont:fj,toolbarBackground:fi,toolbarSelectBackground:Hr,toolbarItemGap:8,toolbarSeparatorColor:Dr},!0);var et={translateX:1,sortColumn:1},ft={sortable:1,sortOrder:1,sortFunc:1},gt={focusData:1},ht={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},it={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},jt=function(A,G){G.add(A),A.hasChildren()&&A.eachChild(function(c){jt(c,G)})},kt=function(k,w,V,T,J,C,c,P,Q,O,L){var e,n=V.getValueType(O),j=V.getAlign(O);if(V.getEnumValues(O)){var l=V.toEnumLabel(w,O),i=Yk||0,K=0,A=C,H=G.getTextSize(T,l).width;return e=Kj(V.toEnumIcon(w,O)),e&&(K=C+Yk/2,"center"===j?K+=(P-(i+H))/2:"right"===j&&(K=K+P-(i+H)),Gf(k,e,K,c+Q/2,O,L),A=K+Yk/2),l!=U&&(e?hl(k,l,T,J,A,c,P-(A-C),Q):hl(k,l,T,J,C,c,P,Q,j)),void 0}return w=V.formatValue(w),w!=U?n===oi?(om(k,C,c,P,Q,w),void 0):n===Gh||!n&&Nj(w)?(e=Kj(w?il:Zb),Gf(k,e,C+P/2,c+Q/2,O,L),void 0):(hl(k,w,T,J,C,c,P,Q,j),void 0):void 0},lt=function(l,H){var v=H.view,m=Ec(l),F=H.column||H.property;v.getDataModel().beginTransaction(),H.editor=l,l.info=H,v.setCurrentEditor(l),v.getView().insertBefore(m,v._79O),Gq(l,H.editorRect),l.setFocus?l.setFocus():wb(l),l.commitValue=function($,y){l._17Q&&(l=l._17Q),y||v.setValue(H.data,F,l.getValue?l.getValue():l.value),l.close&&l.close(),Oi(m)},F.onEditorCreated&&F.onEditorCreated(H)},mt=function(D,T,V,E,L){var O=Ci(D,V),A=T.value,R=T.view,M=L.getValueType(T.data);return O.onblur=O.onchange=function(){R.endEditing()},"input"===D?(A=L.formatValue(A),A!=U&&(O.value=A),O.onkeydown=function(S){Am(S)?R.endEditing():Jk(S)&&R.endEditing(!0)},(M===mk||M===dm)&&d(O,Zl,G.numberListener)):D===$e&&E.forEach(function(B){var N=X.createElement("option");N.innerHTML=L.toEnumLabel(B),N.value=B,L.isEnumEqual(A,B)&&(N.selected=!0),zp(O,N)}),lt(O,T),O},nt=C.widget={},ot=function(u,m,M){Bb(s+".widget."+u,m,M)};hn(Gg,{ms_value:function($){$.getValue=function(K){var q=this.getItemById(K),D=q.element;return ak(D)?D:D?D.getValue?D.getValue():D.value:q.selected},$.setValue=function(H,D){var d=this.getItemById(H);if(d){var W=d.element;W&&!ak(W)?W.setValue?W.setValue(D):W.value=D:Nj(D)?(d.selected=D,this.iv()):(d.element=D,this.iv())}},$.v=function(q,f){var L=this;if(2===arguments.length)L.setValue(q,f);else{if(!jb(q))return L.getValue(q);for(var G in q)L.setValue(G,q[G])}return L}},_46o:function(J){J._icon=U,J._accessType=U,J._valueType=U,J._editable=!1,J._batchEditable=!0,J._align=Ld,J._nullable=!0,J._emptiable=!1,J.setParent=Cn,J.formatValue=function(n){var Y=this,Q=Y._valueType;return Y.getEnumValues()?Y.toEnumLabel(n):Q===Gh?!!n:n!=U&&Q===mk?O(n):n},J.setEnum=function(j,h,w,S,v,n,Y){var R=this;j&&!zo(j)&&j.values&&(S=j.editable,w=j.icons,h=j.labels,v=j.strict,n=j.maxHeight,Y=j.dropDownWidth,j=j.values),gg(j)&&(j=j._as),gg(h)&&(h=h._as),gg(w)&&(w=w._as),R._enumValues=j,R._enumLabels=h,R._enumIcons=w,R._enumEditable=S,R._enumStrict=v==U?!0:v,R._enumMaxHeight=n,R._enumDropDownWidth=Y,j&&j.length&&Bk(j[0])&&(R._valueType=dm),R.fp("enum",!1,!0)},J.getEnumDropDownWidth=function(){return this._enumDropDownWidth},J.getEnumMaxHeight=function(){return this._enumMaxHeight},J.isEnumEditable=function(){return this._enumEditable},J.getEnumValues=function(){return this._enumValues},J.getEnumLabels=function(){return this._enumLabels},J.getEnumIcons=function(){return this._enumIcons},J.isEnumStrict=function(){return this._enumStrict},J.isEnumEqual=function(n,I){return this._enumStrict?n===I:n==I},J.toEnumLabel=function(w,x){var l=this,d=l.getEnumValues(x),G=l.getEnumLabels(x);if(d&&G)for(var m=0;m<d.length;m++)if(l.isEnumEqual(w,d[m]))return G[m];return w},J.toEnumIcon=function(G,J){var s=this,j=s.getEnumValues(J),T=s.getEnumIcons(J);if(j&&T)for(var u=0;u<j.length;u++)if(s.isEnumEqual(G,j[u]))return T[u];return c}},_45o:function(U){U._87o=function(z,s,X,u,A,M){if(z){var Y=this,Q=Y._90I,x=qg(1);Y._columnLineVisible&&(A-=1),Y._rowLineVisible&&(M-=1),0>=A||0>=M||(Y._90I||(Q=Y._90I={}),Q[s]||(Q[s]=new Vo),Gq(x,Y.tx()+X,Y.ty()+u,A,M),zp(x,z),Y._view.insertBefore(x,Y._79O),z.onParentAdded&&z.onParentAdded(x),Q[s].add(x))}},U._76o=function(){var t=this,R=t._90I;if(R){for(var W in R)R[W].each(function(J){Oi(J)});delete t._90I}},U._77o=function(i){var S=this;if(S._90I){var z=S._90I[i];z&&(z.each(function(u){Oi(u)}),delete S._90I[i])}}},_47o:function(N){N.getValue=function(Q,b){return b.getValue?b.getValue(Q,b,this):go(Q,b.getAccessType(),b.getName())},N.setValue=function(y,o,Q){if(o.isEmptiable(y)||""!==Q||(Q=c),o.isNullable(y)||Q!=U){var q=this,$=o.getName(y),g=o.getAccessType(y),l=o.getValueType(y);l===mk&&ak(Q)?Q=Ob(Q):l===dm&&ak(Q)?Q=parseFloat(Q):l===Gh&&ak(Q)&&(Q="true"===Q),q._batchEditable&&o._batchEditable&&q.isSelected(y)?q.sm().each(function(O){o.setValue?o.setValue(O,o,Q,q):Eo(O,g,$,Q)}):o.setValue?o.setValue(y,o,Q,q):Eo(y,g,$,Q)}},N.setCurrentEditor=function(K){this.endEditing(),this._currentEditor=K,this.redraw()},N.isEditing=function(b,s){var v=this,N=v._currentEditor;if(!N)return!1;if(s){var K=N.info;return K?(K.column||K.property)===s&&K.data===b:!1}return!0},N.endEditing=function(Q){var U=this,j=U._currentEditor;j&&(delete U._currentEditor,j.commitValue&&j.commitValue(j.info,Q),U.redraw(),U.getDataModel().endTransaction())},N.beginEditing=function(T){this.endEditing();var Z=this,o=T.column||T.property;if(o.beginEditing)o.beginEditing(T);else{var b=T.data,r=T.value,H=Z.getSelectBackground(b),n=o.getEnumValues(b),k=o.getSlider(b),Q=o.getColorPicker(b);if(k){var c=ll(nt.Slider,k);return c.setValue(r),c.getView().onblur=function(){Z.endEditing()},c.isInstant()&&(c.onValueChanged=function(){Z.setValue(b,o,c.getValue())}),lt(c,T),void 0}if(Q||o.getValueType(b)===oi){var $=ll(nt.ColorPicker,Q);return $.setValue(r),$.onClosed=function(){Z.endEditing()},$.isInstant()&&($.onValueChanged=function(r,m){Z.setValue(b,o,m)}),lt($,T),$.open(),void 0}if(n){if(nt.ComboBox){var x=new nt.ComboBox;x.setValue(r),x.setValues(n),x.setLabels(o.getEnumLabels(b)),x.setIcons(o.getEnumIcons(b)),x.setEditable(o.isEnumEditable(b)),x.setStrict(o.isEnumStrict(b)),x.setMaxHeight(o.getEnumMaxHeight(b)),x.setDropDownWidth(o.getEnumDropDownWidth(b)),x.onClosed=function(){Z.endEditing()},lt(x,T),x.open()}else mt($e,T,H,n,o);return}var E=o.getValueType(b);if(E===Gh||Nj(r))return Z.setValue(b,o,!r),void 0;if(o.getItemEditor(b)){var j=Ef(o.getItemEditor(b)),d=new j(b,o,Z,T),V=d.getView();return V._17Q=d,d.setValue(r),th(V),lt(V,T),d.editBeginning&&d.editBeginning(),void 0}mt("input",T,H,U,o)}}},_44o:function(j){j.init=function(Q){var z=this,e=z.th=new Dt(Q),F=z._view=np(1,z);z.tv=z._tableView=Q,zp(F,e.getView()),zp(F,Q.getView()),e.mp(function(j){j.property===Jb&&z.iv()}),z.iv()},j.getTableView=function(){return this.tv},j.getTableHeader=function(){return this.th},j.getDataModel=function(){return this.tv.dm()},j.getColumnModel=function(){return this.tv.getColumnModel()},j.setColumns=function(x){this.tv.setColumns(x)},j.addColumns=function(u){this.tv.addColumns(u)},j.endEditing=function(){this.tv.endEditing()},j.validateImpl=function(){var o=this,r=o.th,h=zc(r),L={x:0,y:0,width:o.getWidth(),height:h};Gq(r,L),L.y=h,L.height=B(0,o.getHeight()-h),Gq(o.tv,L)}},ms_vs:function(K){K._41o=function(){return this._29I.height<this._59I},K._43o=function(){var q=this;q._41o()&&(q._58I||(xq(function(){q._94O()},dh),q.iv()),q._58I=new Date)},K._94O=function(){var i=this;if(i._58I){var n=new Date;n.getTime()-i._58I.getTime()>=dh?(delete i._58I,i.iv()):xq(function(){i._94O()},dh)}},K._93I=function(){var o=this,y=o._27I;if(o._58I||!o._autoHideScrollBar){y||zp(o._79O,y=o._27I=qg());var w=o._29I,h=w.height,z=o._59I,m=o.getScrollBarSize(),s=w.width-m-2,T=h*(-o.ty()/z),c=h*(h/z),G=y.style;z>h?(Cs>c&&(T=T+c/2-Cs/2,0>T&&(T=0),T+Cs>h&&(T=h-Cs),c=Cs),G.visibility=Uk,G.background=o.getScrollBarColor(),G.borderRadius=m/2+Cm,Gq(y,s,T,m,c)):G.visibility=Mc}else y&&(y.style.visibility=Mc)}},ms_hs:function(D){D._40o=function(){return this._29I.width<this._91I},D._42o=function(){var g=this;g._40o()&&(g._95O||(xq(function(){g._94I()},dh),g.iv()),g._95O=new Date)},D._94I=function(){var _=this;if(_._95O){var j=new Date;j.getTime()-_._95O.getTime()>=dh?(delete _._95O,_.iv()):xq(function(){_._94I()},dh)}},D._92I=function(){var e=this,H=e._28I;if(e._95O||!e._autoHideScrollBar){H||zp(e._79O,H=e._28I=qg());var T=e._29I,V=T.width,C=e._91I,t=e.getScrollBarSize(),v=T.height-t-2,A=V*(-e.tx()/C),z=V*(V/C),U=H.style;C>V?(Cs>z&&(A=A+z/2-Cs/2,0>A&&(A=0),A+Cs>V&&(A=V-Cs),z=Cs),U.visibility=Uk,U.background=e.getScrollBarColor(),U.borderRadius=t/2+Cm,Gq(H,A,v,z,t)):U.visibility=Mc}else H&&(H.style.visibility=Mc)}}}),or(il,pr(16,16,[{type:co,rect:[1,1,14,14],background:Hr},{type:Uq,rect:[1,1,14,14],width:1,color:Ve},{type:gs,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),or(Zb,pr(16,16,{type:Uq,rect:[1,1,14,14],width:1,color:Ve})),or(Oq,pr(16,16,[{type:He,rect:[2,2,12,12],borderWidth:1,borderColor:Ve,background:"#FFF"},{type:He,rect:[4,4,8,8],background:Hr}])),or(Mn,pr(16,16,{type:He,rect:[2,2,12,12],borderWidth:1,borderColor:Ve})),Gg._15Q=function(M){M._29I=Ki,M._59I=0,M._91I=0,M._5o=function(C){var c=this;c._30I=new Vo,c._rows=new Vo,c._rowMap={},c._31I=0,c._14I=0,c._view=np(1,c),c._canvas=Nb(c._view),zp(c._view,c._79O=qg()),c.dm(C?C:new sm)},M.getCheckIcon=function(t){var C=this.sm(),w=C.co(t);return C.sg()?Kj(w?Oq:Mn):Kj(w?il:Zb)},M.checkData=function(Y){var g=this.sm(),M=g.co(Y);g.sg()&&M||(this._32o=1,M?g.rs(Y):g.as(Y),delete this._32o)},M.getDataAt=function(K){K.target&&(K=this.lp(K));var d=A(K.y/this._rowHeight),P=this._rows;return 0>d||d>=P.size()?U:P.get(d)},M.onDataDoubleClicked=function(){},M.onDataClicked=function(){},M.adjustTranslateX=function(){return 0},M.adjustTranslateY=function(I){var n=this.getHeight()-this._59I;return n>I&&(I=n),I>0?0:O(I)},M.onPropertyChanged=function(y){var f=this,l=y.property;ht[l]?f.ivm():gt[l]||f.redraw(),l===mc?f._42o():l===yd&&f._43o()},M.getLabel=function(F){return F.toLabel()},M.getLabelFont=function(){return this._labelFont},M.getLabelColor=function(P){var N=this;if(N.isCheckMode()){if(N._focusData===P)return N._labelSelectColor}else if(N.isSelected(P))return N._labelSelectColor;return N._labelColor},M.getStartRowIndex=function(){return this._31I},M.getEndRowIndex=function(){return this._14I},M.getRowDatas=function(){return this._rows},M.getRowIndex=function(R){return this._rowMap[R._id]},M.getRowSize=function(){return this._rows.size()},M.getViewRect=function(){return ns(this._29I)},M.isVisible=function(B){return this._visibleFunc?this._visibleFunc(B):!0},M.getCurrentSortFunc=function(){return this._sortFunc},M.setDataModel=function($){var k=this,s=k._dataModel,K=k._selectionModel;s!==$&&(s&&(s.umm(k.handleDataModelChange,k),s.umd(k.handleDataPropertyChange,k),s.umh(k.handleHierarchyChange,k),K||s.sm().ums(k.handleSelectionChange,k)),k._dataModel=$,$.mm(k.handleDataModelChange,k),$.md(k.handleDataPropertyChange,k),$.mh(k.handleHierarchyChange,k),K?K._21I($):$.sm().ms(k.handleSelectionChange,k),k.fp("dataModel",s,$))},M.validateModel=function(){var E=this;E._rows.clear(),E._rowMap={},E.buildChildren(E._dataModel._roots);var T=E._rows=E._rows.toList(E.isVisible,E),S=0,p=E.getCurrentSortFunc(),y=T.size();for(p&&T.sort(p);y>S;S++)E._rowMap[T.get(S)._id]=S},M.buildChildren=function(v){var p=this;v.each(function(j){p._rows.add(j),p.buildChildren(j._children)})},M.handleDataModelChange=function(){this.ivm()},M.handleDataPropertyChange=function(Q){"parent"===Q.property?this.ivm():this.invalidateData(Q.data)},M.handleHierarchyChange=function(){this.ivm()},M.handleSelectionChange=function(u){u.datas.each(this.invalidateData,this),this.onSelectionChanged(u)},M.onSelectionChanged=function(w){var I=this,F=I.sm();!I.isAutoMakeVisible()||1!==F.size()||"set"!==w.kind&&"append"!==w.kind||I._32o||I.makeVisible(F.ld())},M.handleBackgroundClick=function(R){dr(R)&&!this.isCheckMode()&&this.sm().cs()},M.makeVisible=function(h){h&&(this._23I=h,this.iv())},M.scrollToIndex=function(e){var _=this,G=_._29I,I=G.height,M=_._rowHeight,u=M*e;e>=0&&e<_._rows.size()&&I>0&&(u+M>G.y+I?_.ty(-u+I-M):u<G.y&&_.ty(-u))},M.autoScroll=function(P,p){var O=this,M=O._rowHeight,N=M,c=M/4,k=O._29I,q=O.lp(P),i={x:O.tx(),y:O.ty()};return M>0&&k&&(q.x-k.x<N?O.translate(c,0):k.x+k.width-q.x<N&&O.translate(-c,0),q.y-k.y<N?O.translate(0,c):k.y+k.height-q.y<N&&O.translate(0,-c)),i.x=O.tx()-i.x,i.y=O.ty()-i.y,p&&(p.x+=i.x,p.y+=i.y),i},M.getTopRowOrderSelection=function(){var y=this.sm().getTopSelection(),X={},D=new Vo;return y.each(function(E){X[E._id]=E}),this._rows.each(function(O){X[O._id]&&D.add(O)}),D},M.getRowOrderSelection=function(){var f=new Vo;return this._rows.each(function(j){this.isSelected(j)&&f.add(j)},this),f},M.ivm=function(){this.invalidateModel()},M.invalidateModel=function(){var Y=this;Y._96I||(Y._96I=1,Y._32I=1,delete Y._24I),Y.iv()},M.redraw=function(){var w=this;w._32I||(w._32I=1,delete w._24I,w.iv())},M.invalidateData=function(d){var w=this;nk?w.redraw():w._32I||(w._24I||(w._24I={}),w._24I[d._id]=d,w.iv())},M.getFocusData=function(){return this._focusData},M.setFocusDataById=function(X){this.setFocusData(this.dm().getDataById(X))},M.setFocusData=function(e){var N=this,b=N._focusData;b!==e&&(N._focusData=e,N.fp("focusData",b,e),b&&N.invalidateData(b),e&&(N.invalidateData(e),N.isAutoMakeVisible()&&N.makeVisible(e)))},M.drawRowBackground=function(s,C,Q,r,G,L,z){var S=this,m=S.isCheckMode();(C===S._focusData&&m||Q&&!m)&&om(s,r,G,L,z,S.getSelectBackground(C))},M.drawData=function(I,W,s){var n=this,G=n._rowHeight,p=G*s,S=n._29I,b=S.x,t=S.width;I.save(),I.beginPath(),I.rect(b,p,t,G),I.clip(),n._87o(n.drawRow(I,W,n.isSelected(W),b,p,t,G),s,b,p,t,G),I.restore(),n._rowLineVisible&&om(I,b,p+G-1,t,1,n._rowLineColor)},M._12I=function(u){var Q=this,F=Q._31I,t=Q._29I,i=t.x,R=t.y,r=t.width,M=t.height;for(u.beginPath(),u.rect(i,R,r,M),u.clip(),u.clearRect(i,R,r,M),Q._76o(),Q._93db(u);F<Q._14I;F++)Q.drawData(u,Q._rows.get(F),F);Q._92db(u)},M._13I=function(q){for(var i,f=this,w=f._rowHeight,C=f._29I,y=C.x,D=C.width,z=f._31I,W=f._30I;z<f._14I;z++)i=f._rows.get(z),f._24I[i._id]&&W.add({data:i,index:z});W.isEmpty()||(q.beginPath(),W.each(function(M){q.rect(y,M.index*w,D,w)}),q.clip(),W.each(function(d){q.clearRect(y,d.index*w,D,w)}),W.each(function(i){f._77o(i.index)}),f._93db(q),W.each(function(D){f.drawData(q,D.data,D.index)}),f._92db(q),W.clear())},M.preValidateModel=function(){this.endEditing&&this.endEditing()},M.validateImpl=function(){var f=this,p=f._canvas,v=f.getWidth(),o=f.getHeight(),x=f._rowHeight,r=f._32I;(v!==p.clientWidth||o!==p.clientHeight)&&(cs(p,v,o),r=1),f._96I&&(f.preValidateModel(),f.validateModel());var M=f._29I,B={x:-f.tx(),y:-f.ty(),width:v,height:o},K=f._rows.size(),i=Rg(p),W=f._23I;r||Gn(B,M)||(r=1),f._29I=B,f._59I=K*x,f._31I=A(B.y/x),f._14I=Q((B.y+B.height)/x),f._31I<0&&(f._31I=0),f._14I>K&&(f._14I=K),f._99I&&r&&f._99I();var X=f.tx(),q=f.ty();(f._40o()||f._41o())&&(f._59I+=f.getScrollBarSize(),f._99I&&r&&(f._91I+=f.getScrollBarSize())),ah&&!le&&(i.save(),id(i,v/pn.length,o/pn.length,1)),id(i,X,q,1),r?f._12I(i):f._24I&&f._13I(i),f._93I(),f._92I(),i.restore(),f._32I=f._24I=f._96I=U,W&&(f.scrollToIndex(f.getRowIndex(W)),delete f._23I),f.tx(f.tx()),f.ty(f.ty())},M.canHandleSelectMode=function(){return!0}},Gg._48o=function(o){o._rootVisible=!0,o._rootData=U,o._35o=function(){this._expandMap={},this._levelMap={}},o.validateModel=function(){var v=this,z=v._rootData;v._rows.clear(),v._levelMap={},v._rowMap={},v._currentLevel=0,z?v._rootVisible?v.isVisible(z)&&v.buildData(z):v.buildChildren(z):v.buildChildren(),delete v._currentLevel},o.buildData=function(V){var o=this,q=V._id,G=o._rows;o._rowMap[q]=G.size(),G.add(V),o._levelMap[q]=o._currentLevel,o.isExpanded(V)&&(o._currentLevel++,o.buildChildren(V),o._currentLevel--)},o.buildChildren=function(e){var Q=this,b=e?e._children:Q._dataModel._roots,t=Q.getCurrentSortFunc();t&&Q.isChildrenSortable(e)?b.toList(Q.isVisible,Q).sort(t).each(Q.buildData,Q):b.each(function(k){Q.isVisible(k)&&Q.buildData(k)})},o.getLevel=function(F){return this._levelMap[F._id]},o.getToggleIcon=function(s){var u=this,f=u._loader,t=u._collapseIcon;return f&&!f.isLoaded(s)?t:s.hasChildren()?u.isExpanded(s)?u._expandIcon:t:U},o.isCheckMode=function(){return this._checkMode!=U},o.isChildrenSortable=function(){return!0},o.handleDataModelChange=function(d){var b=this;d.kind===Db?delete b._expandMap[d.data._id]:d.kind===ke&&(b._expandMap={}),b.ivm()},o.toggle=function(C){var q=this;q.isExpanded(C)?q.collapse(C):q.expand(C)},o.isExpanded=function(C){return 1===this._expandMap[C._id]},o.expand=function(N){var J=this,E=J._loader;J.isExpanded(N)||(E&&!E.isLoaded(N)&&E.load(N),J._expandMap[N._id]=1,J.ivm(),J.onExpanded(N))},o.onExpanded=function(){},o.collapse=function(z){var J=this;J.isExpanded(z)&&(delete J._expandMap[z._id],J.ivm(),J.onCollapsed(z))},o.onCollapsed=function(){},o.expandAll=function(R){if(R)this.expand(R),R.eachChild(function(K){this.expandAll(K)},this);else{var E=this;E._dataModel.each(function(A){A.hasChildren()&&(E._expandMap[A._id]=1)}),E.ivm()}},o.collapseAll=function(){this._expandMap={},this.ivm()},o.makeVisible=function(o){if(o){var z=this;if(!z._rootData||o.isDescendantOf(z._rootData)){for(var u=o._parent;u;)z.expand(u),u=u._parent;z._23I=o,z.iv()}}},o.checkData=function(h){var s,n=this,v=n._checkMode,b=n.sm(),B=b.co(h);if(!b.sg()||!B){if(n._32o=1,v===fg)B?b.rs(h):b.as(h);else if(v===Xb)s=new Vo(h),s.addAll(h._children);else if("descendant"===v)s=new Vo,jt(h,s);else if("all"===v&&(s=new Vo,jt(h,s),!B))for(var E=h._parent;E;)s.add(E),E=E._parent;s&&(B?b.rs(s):b.as(s)),delete n._32o}},o.drawTree=function(b,x,o,H,w,z,f){var E=this,r=E._indent,h=E._levelMap[x._id],N=E.getIconWidth(x),P=Kj(E.getToggleIcon(x));P?(H+=r*h,Gf(b,P,H+r/2,w+f/2,x,E),H+=r):H+=r*(h+1),E._checkMode&&(Gf(b,E.getCheckIcon(x),H+r/2,w+f/2,x,E),H+=r),E.drawIcon(b,x,H,w,N,f),E.drawLabel(b,x,H+N,w,f)}},Gg._14Q=function(O){O.getIcon=function(_){return _.getIcon()},O.getIconWidth=function(S){return this.getIcon(S)?this._indent:0
},O.drawIcon=function(l,B,N,K,G,b){if(G){var i=this,o=i.getBodyColor(B),I=Kj(i.getIcon(B),o);I&&(b-=i.isRowLineVisible()?1:0,bl(l,I,gf,N,K,G,b,B,i,o),ni(l,i.getBorderColor(B),N,K,G,b))}},O.drawLabel=function(G,k,y,K,q){var F=this;hl(G,F.getLabel(k),F.getLabelFont(k),F.getLabelColor(k),y,K,0,q)}},Gg._50o=function(I){I._98I=function(){var T=this,$=T._39o=new sm;T._60I=new Vo,$.mm(T._17o,T),$.md(T._18o,T),$.mh(T._19o,T)},I.setColumns=function(W){this._39o.clear(),this.addColumns(W)},I.addColumns=function(r){var o=this._39o;r.forEach(function(U){if(!(U instanceof qt)){var Y=Ef(U.className);U=ll(Y?Y:qt,U)}o.add(U)})},I.onColumnClicked=function(){},I.onCheckColumnClicked=function(){},I._3Q=function(B){for(var w,k=0,H=this._60I,C=H.size();C>k;k++)if(w=H.get(k),w.column===B)return w;return U},I.getColumnAt=function(D){var o=this._4Q(D);return o?o.column:U},I._4Q=function(G){for(var J=this,p=G.target?J.lp(G).x:G.x,q=J._60I,e=0;e<q.size();e++){var I=q.get(e),N=I.startX;if(p>=N&&p<N+I.column.getWidth())return I}return U},I.getToolTip=function(T){var m=this,L=m.getDataAt(T),I=m.getColumnAt(T);return L&&I?I.getToolTip(L,m):U},I.adjustTranslateX=function(V){var u=this.getWidth()-this._91I;return u>V&&(V=u),V>0?0:O(V)},I._99I=function(){var I=this,e=I._29I,R=I._60I;R.clear(),I._91I=0,I._39o._roots.each(function(k){if(k.isVisible()){var P=I._91I+k.getWidth();I._91I<=e.x+e.width&&P>=e.x&&R.add({column:k,startX:I._91I}),I._91I=P}})},I.drawData=function(w,Y,M){var t=this,R=t._rowHeight,f=R*M,B=t.isSelected(Y),d=t._29I,i=d.x,J=d.width;t.drawRowBackground(w,Y,B,i,f,J,R),t._60I.each(function(V){var Q=V.column,k=V.startX,J=Q.getWidth();J>0&&!t.isEditing(Y,Q)&&(w.save(),w.beginPath(),w.rect(k,f,J,R),w.clip(),t._87o(t.drawCell(w,Y,B,Q,k,f,J,R),M,k,f,J,R),t._columnLineVisible&&om(w,k+J-1,f,1,R,t._columnLineColor),w.restore())}),t._rowLineVisible&&om(w,i,f+R-1,J,1,t._rowLineColor)},I.drawCell=function(E,j,C,n,g,y,z,v){var r=this;if(n.drawCell)return n.drawCell(E,j,C,n,g,y,z,v,r);var s=r.getValue(j,n);kt(E,s,n,r.getLabelFont(j,n,s),r.getLabelColor(j,n,s),g,y,z,v,j,r)},I.getColumnModel=function(){return this._39o},I._17o=function(){this.redraw()},I._18o=function(Y){var K=this;Y.data===K._sortColumn&&ft[Y.property]?K.ivm():(K._42o(),K.redraw())},I._19o=function(){this.redraw()},I.getCurrentSortFunc=function(){var S=this,t=S._sortColumn;if(t&&t.isSortable()){var q=t.getSortFunc(),P=qk===t.getSortOrder()?1:-1;return q||(q=Dd),function(L,v){return q.call(S,S.getValue(L,t),S.getValue(v,t),L,v)*P}}return S._sortFunc},I.isCellEditable=function(I,y,R){return y.isEditable()&&this.isEditable()?y.isCellEditable?y.isCellEditable(I,y,R,this):!0:!1},I._37O=function(O,W){if(dr(W))for(var j=this,Y=j.lp(W),h=j._60I,I=j._rowHeight,N=j._29I,E=N.x,M=N.y,R=N.width,a=N.height,X=0;X<h.size();X++){var _=h.get(X),x=_.startX,k=_.column,U=k.getWidth();if(k!==j._31o&&k!==j._4o&&Y.x>=x&&Y.x<x+U&&j.isCellEditable(O,k,W)){var v={x:x,y:j.getRowIndex(O)*I,width:U,height:I},c={x:v.x+j.tx(),y:v.y+j.ty(),width:v.width,height:v.height},o=0,u=0;return v.x<E?o=v.x-E:v.x+v.width>E+R&&(o=v.x+v.width-E-R),o&&(j.tx(j.tx()-o),c.x-=o),v.y<M?u=v.y-M:v.y+I>M+a&&(u=v.y+I-M-a),u&&(j.ty(j.ty()-u),c.y-=u),j.beginEditing({data:O,column:k,value:j.getValue(O,k),event:W,rect:v,editorRect:c,view:j}),void 0}}}},nt.BaseItemEditor=function(e,U,r,F){this._data=e,this._column=U,this._master=r,this._editInfo=F},ot("BaseItemEditor",g,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var pt=C.Tab=function(){Zn(pt,this)};ub("Tab",Cb,{ms_ac:["view","closable","disabled","visible"],_icon:U,_closable:!1,_disabled:!1,_visible:!0,setParent:Cn});var qt=C.Column=function(){Zn(qt,this)};ub("Column",Cb,{_46o:1,ms_ac:["accessType","valueType",Uk,kl,ck,Vr,"align",oi,"sortOrder",Nl,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:qk,_sortFunc:U,_sortable:!0,_clickable:!0,setWidth:function(w){16>w&&(w=16);var y=this._width;this._width=w,this.fp(Vr,y,w)},getToolTip:function(A,D){return this.formatValue(D.getValue(A,this))}});var rt=C.Property=function(){Zn(rt,this)};ub("Property",Cb,{_46o:1,ms_ac:["accessType","valueType",kl,ck,"categoryName",oi,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:U,getToolTip:function(C,R,h){var B=this;return R?B.formatValue(h.getValue(C,B)):h.getPropertyName(B)}}),nt.AccordionView=function(){var f=this;f._20o={},f._21o=new Vo,f._10o=U,f._9o=U,f._11o=U,f._view=np(0,f),f.iv()},ot("AccordionView",g,{ms_v:1,ms_fire:1,ms_ac:[Of,wg,"titleHeight",Lr,Kl,"titleBackground","selectWidth",Bd,"orientation","separatorColor"],_expandIcon:G.accordionViewExpandIcon,_collapseIcon:G.accordionViewCollapseIcon,_titleHeight:pi,_labelColor:G.accordionViewLabelColor,_labelFont:G.accordionViewLabelFont,_titleBackground:G.accordionViewTitleBackground,_selectBackground:G.accordionViewSelectBackground,_selectWidth:G.accordionViewSelectWidth,_orientation:"v",_separatorColor:G.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(M,S,B,P){var j=this,b=qg(),l={content:S,div:b,canvas:Nb(b),icon:P};if(j._20o[M])throw M+" already exists";var s=l.downEventFunc=function(i){Uh(i)},n=l.upEventFunc=function(E){Uh(E),dr(E)&&(j._10o===M?j.collapse():j.expand(M))};[Wr,qf].forEach(function(u){d(b,u,s)}),[Wn,wf].forEach(function($){d(b,$,n)}),b.style.cursor=vp,zp(j._view,b),j._20o[M]=l,j._21o.add(M),B&&j.expand(M),j.iv()},remove:function(D){var Z=this,p=Z._20o[D];if(p){var Y=p.div;Oi(Y),[Wr,qf].forEach(function(K){h(Y,K,p.downEventFunc)}),[Wn,wf].forEach(function(t){h(Y,t,p.upEventFunc)}),delete Z._20o[D],Z._21o.remove(D),Z.iv()}},clear:function(){var K=this;K._21o.toArray().forEach(K.remove,K),K._20o={},K._21o.clear(),K.iv()},isExpanded:function(s){return this._10o===s},expand:function(v){var z=this;z._20o[v]&&z._10o!==v&&(z._10o=v,z.onExpanded(v),z.iv())},onExpanded:function(){},collapse:function(){var c=this;c._10o&&(c.onCollapsed(c._10o),delete c._10o,c.iv())},onCollapsed:function(){},initCanvas:function(J,w,P){cs(J,w,P);var j=Rg(J);return id(j,0,0,1),j.clearRect(0,0,w,P),j},drawTitle:function(i,m,v,$,e){var A=this,y=Kj(e.icon),D=A.isExpanded(m),d=A._titleHeight,u=A._titleBackground,L=A._selectWidth,T=A._separatorColor,G=Kj(D?A._expandIcon:A._collapseIcon),l=L+4;om(i,0,0,v,$,u),D&&L&&om(i,0,0,L,$,A._selectBackground),(D||A._21o.get(A._21o.size()-1)!==m)&&om(i,0,$-1,v,1,T?T:Yf(u)),y&&(Gf(i,y,l+Zo(y)/2,d/2),l+=Zo(y)+2),hl(i,m,A.getLabelFont(m),A.getLabelColor(m),l,0,0,d),G&&Gf(i,G,v-Zo(G)/2-4,d/2)},validateImpl:function(){var Q=this,i=Q._view,o=0,t=0,A=Q.getWidth(),w=Q.getHeight(),Z=Q._titleHeight,l=Q._21o.size()*Z,F=Q._11o,u=Q._9o;delete Q._11o,delete Q._9o,Q._21o.each(function(N){var V,h,u=Q._20o[N],r=u.content,f=Q._10o===N;ui(Q)?(Gq(u.div,o,0,Z,w),V=Q.initCanvas(u.canvas,Z,w),Xg(V,0,w),tp(V,-Cg),Q.drawTitle(V,N,w,Z,u),V.restore(),f?(h=B(0,A-l),r&&(Q._11o=r,Q._9o=Ec(r),Gq(r,o+Z,0,h,w)),o+=Z+h):o+=Z):(Gq(u.div,0,t,A,Z),V=Q.initCanvas(u.canvas,A,Z),Q.drawTitle(V,N,A,Z,u),V.restore(),f?(h=B(0,w-l),r&&(Q._11o=r,Q._9o=Ec(r),Gq(r,0,t+Z,A,h)),t+=Z+h):t+=Z)});var U=Q._9o;F&&F!==Q._11o&&F.endEditing&&F.endEditing(),U&&U!==u&&zp(i,U),u&&u!==U&&Oi(u)}}),nt.SplitView=function(A,W,T,V){var O=this,u=O._dividerDiv=qg(),C=O._60O=Nb(),Q=O._61O=Nb(),P=C.style,I=Q.style;O._view=np(1,O),zp(O._view,u),P.msTouchAction=zj,P.pointerEvents=zj,P.cursor=vp,I.msTouchAction=zj,I.pointerEvents=zj,I.cursor=vp,A&&O.setLeftView(A),W&&O.setRightView(W),T&&O.setOrientation(T),V!=U&&O.setPosition(V),O.setStatus(Lb),new st(O)},ot("SplitView",g,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:G.splitViewDividerSize,_dividerBackground:G.splitViewDividerBackground,_dragOpacity:G.splitViewDragOpacity,_toggleIcon:G.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(g,t){var Y=this,y=Y._position;isNaN(g)||(t||(Y._82O=0>g?-1:g>1?1:0),Y._position=g,Y.fp(Pc,y,g))},getLeftView:function(){return this._leftView},setLeftView:function(Z){var s=this,U=s._leftView,D=s._view;if(s._leftView!==Z){if(U&&U!==s._rightView){var _=Ec(U);_.parentNode===D&&Oi(_)}if(s._leftView=Z,Z){var Q=Ec(Z);Q.parentNode!==D&&D.insertBefore(Q,s._dividerDiv)}s.fp("leftView",U,Z)}},getRightView:function(){return this._rightView},setRightView:function(O){var t=this,c=t._rightView,a=t._view;if(t._rightView!==O){if(c&&c!==t._leftView){var q=Ec(c);q.parentNode===a&&Oi(q)}if(t._rightView=O,O){var x=Ec(O);x.parentNode!==a&&a.insertBefore(x,t._dividerDiv)}t.fp("rightView",c,O)}},validateImpl:function(){var E=this,Z=E._draggable,y=E._position,X=E.getWidth(),A=E.getHeight(),p=E._dividerSize,T=E._dividerBackground,c=jg?18:8,g=E._dividerDiv,H=E._82O,Y=E._60O,f=E._61O,n=E._toggleIcon,u=E._status,v=g.style,K=null,q=jg?20:4,F=n.comps[0];p>=c||0===p?E._coverDiv&&(Oi(E._coverDiv),delete E._coverDiv):E._coverDiv||(E._coverDiv=qg(),ze&&(E._coverDiv.style.background=ji),zp(g,E._coverDiv)),E._togglable?Y.parentNode||(zp(g,Y),zp(g,f)):(Oi(Y),Oi(f));var o=E._coverDiv,W=E._leftView,C=E._rightView;if(ui(E)){if(p>X&&(p=X),u===Lb)if(1===H)var r=x(y,X),b=B(0,X-p-r);else-1===H?(b=x(-y,X),r=B(0,X-p-b)):(r=O((X-p)*y),b=B(0,X-p-r));else"cl"===u?(r=0,b=B(0,X-p)):"cr"===u&&(b=0,r=B(0,X-p));W&&Gq(W,0,0,r,A),C&&Gq(C,r+p,0,b,A),Gq(g,r,0,p,A),E._22o=r,o&&(Gq(o,p/2-c/2,0,c,A),o.style.cursor=Z?Sm:""),g.style.cursor=Z?Sm:"";var R=g.clientHeight/2,z=g.clientWidth;cs(Y,z,z),Gq(Y,0,R-z-q,z,z),K=Rg(Y),id(K,0,0,1),F.rotation=-Cg,kc(K,n,0,0,z,z),K.restore(),cs(f,z,z),Gq(f,0,R+q,z,z),K=Rg(f),id(K,0,0,1),F.rotation=Cg,kc(K,n,0,0,z,z),K.restore()}else{if(p>A&&(p=A),u===Lb)if(1===H)var N=x(y,A),I=B(0,A-p-N);else-1===H?(I=x(-y,A),N=B(0,A-p-I)):(N=O((A-p)*y),I=B(0,A-p-N));else"cl"===u?(N=0,I=B(0,A-p)):"cr"===u&&(I=0,N=B(0,A-p));W&&Gq(W,0,0,X,N),C&&Gq(C,0,N+p,X,I),Gq(g,0,N,X,p),E._22o=N,o&&(Gq(o,0,p/2-c/2,X,c),o.style.cursor=Z?Sg:""),v.cursor=Z?Sg:"";var e=g.clientWidth/2,z=g.clientHeight;cs(Y,z,z),Gq(Y,e-z-q,0,z,z),K=Rg(Y),id(K,0,0,1),F.rotation=0,kc(K,n,0,0,z,z),K.restore(),cs(f,z,z),Gq(f,e+q,0,z,z),K=Rg(f),id(K,0,0,1),F.rotation=S,kc(K,n,0,0,z,z),K.restore()}v.background=T}});var st=function(q){this.sv=q,this.addListeners()};Bb(st,g,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(h){var k=this,R=k.sv,P=R._dividerDiv,U=R._60O,S=R._61O,X=R._status,p=h.target;if(p===U)X===Lb?R.setStatus("cl"):"cr"===X&&R.setStatus(Lb);else if(p===S)X===Lb?R.setStatus("cr"):"cl"===X&&R.setStatus(Lb);else if(to(h)&&(p===P||p===R._coverDiv)&&(Uh(h),R.isDraggable())){R.getLeftView(),R.getRightView();var j=k.maskDiv=qg();if(j.style.left=0,j.style.top=0,j.style.width=R.getWidth()+"px",j.style.height=R.getHeight()+"px",R.getView().appendChild(j),!R.isContinuousLayout()){var J=k.resizeDiv=qg();J.style.left=P.style.left,J.style.top=P.style.top,J.style.width=P.style.width,J.style.height=P.style.height,J.style.opacity=R.getDragOpacity(),J.style.background=R.getDividerBackground(),zp(k.getView(),J)}k._lastAbsPosition=R._22o,k._86o=ui(R)?Ae(h).x:Ae(h).y,Ir(k,h)}},handleWindowTouchMove:function(z){to(z)&&this.update(z,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(t){var I=this;I.update(t,!0),I.sv.setStatus(Lb),I.maskDiv&&Oi(I.maskDiv),I.resizeDiv&&Oi(I.resizeDiv),I.maskDiv=I.resizeDiv=U},handle_mousedown:function(v){dr(v)&&this.handle_touchstart(v)},handleWindowMouseMove:function(D){this.handleWindowTouchMove(D)},handleWindowMouseUp:function(F){this.handleWindowTouchEnd(F)},update:function(D,t){var s=this,P=s.sv,i=ui(P)?P.getWidth():P.getHeight(),y=P._dividerSize,Y=s._lastAbsPosition-s._86o;ui(P)?(Y+=Ae(D).x,Y>i-y&&(Y=i-y),0>Y&&(Y=0),s.resizeDiv&&(s.resizeDiv.style.left=Y+Cm)):(Y+=Ae(D).y,Y>i-y&&(Y=i-y),0>Y&&(Y=0),s.resizeDiv&&(s.resizeDiv.style.top=Y+Cm)),t&&i!==y&&(1===P._82O?P.setPosition(Y,1):-1===P._82O?P.setPosition(Y-i+y,1):P.setPosition(Y/(i-y),1))}}),nt.TabView=function(){var v=this,J=v._view=np(1,v),q=v._91O=qg(1),m=v._tabModel=new sm,B=m.sm(),S=v.invalidate;v._7o=new Vo,v._canvas=Nb(q),zp(J,q),zp(J,v._92O=qg(1)),B.setSelectionMode(uo),B.ms(v.handleSelectionChange,v),m.mm(S,v),m.mh(S,v),m.md(S,v),v._interactor=new tt(v),v.iv()},ot("TabView",g,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Lr,Kl,"tabHPadding","tabBackground","selectWidth",Bd,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:vc,_tabHeight:pi,_tabGap:G.tabViewTabGap,_labelColor:G.tabViewLabelColor,_labelFont:G.tabViewLabelFont,_tabBackground:G.tabViewTabBackground,_selectWidth:G.tabViewSelectWidth,_selectBackground:G.tabViewSelectBackground,_moveBackground:G.tabViewMoveBackground,_insertColor:G.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(R,i,B){var D,d=this._tabModel;return R instanceof pt?(D=R,i&&D.setView(i)):(D=new pt,D.setName(R),D.setView(i)),d.add(D),B&&d.sm().ss(D),D},getLabel:function(j){return j.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(z){this._23o=z,this.iv()},get:function(e){var x=this,I=x._tabModel;if(Bk(e))return I._roots.get(e);if(ak(e)){var W;return I.each(function(F){e===x.getLabel(F)&&(W=F)}),W}return e instanceof pt?e:U},select:function(N){this._tabModel.sm().ss(this.get(N))},remove:function(R){var P=this;if(R=P.get(R)){var p=P._tabModel,q=p._roots.indexOf(R);P._tabModel.remove(R),P.selectByIndex(--q)}},getCurrentTab:function(){return this._8o},hideTabView:function(P,s){s.parentNode===this._92O&&(ie(s)?(s.style.display=Jj,s._tab_=P):Oi(s),ho())},showTabView:function(o,v){ie(v)&&(v.style.display="block",v._tab_=o),v.parentNode!==this._92O&&(zp(this._92O,v),ho())},_24o:function(){var G,q=this,o=q._8o,F=q._9o,P=q._tabModel.sm().ld();P&&(G=Ec(P.getView())),G!==F&&(F&&(o.getView()&&o.getView().endEditing&&o.getView().endEditing(),q.hideTabView(o,F)),G&&q.showTabView(P,G)),q._8o=P,q._9o=G,o!==P&&q.onTabChanged(o,P)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(Z,b){this.selectByIndex(--b)},selectByIndex:function(n){var J=this,i=J._tabModel,N=i.size();if(N&&!i.sm().ld()){n==U&&(n=0),n>=N&&(n=N-1),0>n&&(n=0);for(var K=n;K>=0;K--){var C=J.get(K);if(!C.isDisabled())return J.select(C),C}for(K=n+1;N>K;K++)if(C=J.get(K),!C.isDisabled())return J.select(C),C}},getTabWidth:function(K){var A=this.getTabHPadding(),E=4+2*A,r=Kj(K.getIcon());r&&(E+=Zo(r,K)+4);var X=this.getLabel(K);return X&&(E+=ei(this.getLabelFont(K),X).width+4),K.isClosable()&&(E+=10),E},drawTab:function(v,G,R,N,x,a,h){var F,e=this,E=e._tabPosition,n=this.getTabHPadding(),K=R+4+n,Q=e._selectWidth,z=Kj(G.getIcon()),A=G.isDisabled(),M=e.getLabelColor(G),q=e.getLabelFont(G),H=e.getLabel(G),C=e._selectBackground,D=E===Ld+"-vertical",p=E===fk+"-vertical";(D||p)&&(K=N+4+n),A&&(v.globalAlpha=_r),om(v,R,N,x,a,h),G===e._8o&&Q&&(E===vc?om(v,R,N+a-Q,x,Q,C):E===Ld?om(v,R+x-Q,N,Q,a,C):E===fk?om(v,R,N,Q,a,C):D?om(v,R+x-Q,N,Q,a,C):p?om(v,R,N,Q,a,C):om(v,R,N,x,Q,C));var u=x/2;if(D&&(Xg(v,u,N+a/2),tp(v,S),Xg(v,-u,-N-a/2)),z){var P=Ge(z,G),d=Zo(z,G);if(D||p){var W=R+x/2,V=K+P/2;Xg(v,W,V),tp(v,Cg),Xg(v,-W,-V),Gf(v,z,R+x/2,K+P/2,G,e),Xg(v,W,V),tp(v,-Cg),Xg(v,-W,-V),K+=P+4}else Gf(v,z,K+d/2,N+a/2,G,e),K+=d+4}return D||p?(Xg(v,x/2,K+x/2),tp(v,Cg),Xg(v,-x/2,-K-x/2),hl(v,H,q,M,R,K,a,x),Xg(v,x/2,K+x/2),tp(v,-Cg),Xg(v,-x/2,-K-x/2)):hl(v,H,q,M,K,N,x,a),D&&(Xg(v,u,N+a/2),tp(v,-S),Xg(v,-u,-N-a/2)),G.isClosable()&&(F=p?{x:R+x-12,y:N+a-12,width:12,height:12}:{x:R+x-12,y:N+2,width:12,height:12},this.drawCloseIcon(G,v,M,F)),A&&(v.globalAlpha=1),F},drawCloseIcon:function(k,P,F,a){var Z=a.x,$=a.y;P.strokeStyle=F,P.lineWidth=1,P.beginPath(),P.moveTo(Z+2,$+8),P.lineTo(Z+8,$+2),P.moveTo(Z+8,$+8),P.lineTo(Z+2,$+2),P.stroke()},getTabAt:function(p){var F=this._interactor._8Q(p);return F?F.tab:null},validateImpl:function(){var Z=this;Z._24o();var Q,$=Z._canvas,t=Z._tabPosition,j=Z._91O,w=Z._92O,l=Z._tabModel,e=Z.getWidth(),a=Z.getHeight(),g=Z._tabHeight,S=Z._7o,K=Z._tabGap,R=t===vc,i=t===Ld,P=t===fk,T=t===Ld+"-vertical",I=t===fk+"-vertical",c=Z._23o,H=0;if((i||P)&&l._roots.each(function(r){H=B(Z.getTabWidth(r),H)}),R?(Gq(j,0,0,e,g),Q={x:0,y:g,width:e,height:B(0,a-g)}):i?(Gq(j,0,0,H,a),Q={x:H,y:0,width:B(0,e-H),height:a}):P?(Gq(j,e-H,0,H,a),Q={x:0,y:0,width:B(0,e-H),height:a}):T?(Gq(j,0,0,g,a),Q={x:g,y:0,width:B(0,e-g),height:a}):I?(Gq(j,e-g,0,g,a),Q={x:0,y:0,width:B(0,e-g),height:a}):(Gq(j,0,a-g,e,g),Q={x:0,y:0,width:e,height:B(0,a-g)}),Gq(w,Q),T||I){Z._9o&&(Q.x=0,Gq(Z._8o.getView(),Q)),cs($,g,a);var u=Rg($),N=0;if(id(u,0,Z.ty(),1),u.clearRect(0,0,g,a),S.clear(),l._roots.each(function(p){if(p.isVisible()){var d,J=Z.getTabWidth(p);if(!c||c.tab!==p){var X=Z.getTabBackground(p);d=Z.drawTab(u,p,0,N,g,J,X)}S.add({_75o:d,tab:p,startY:N,endY:N+J,height:J}),N+=J+K}}),Z._23Q=B(0,N-K),c){var s=c.position;Z.drawTab(u,c.tab,0,c.startY,g,c.height,Z._moveBackground),om(u,0,s,g,1,Z._insertColor)}if(u.restore(),Z._selectionChanged){Z._selectionChanged=!1;for(var v=Z.ty(),G=0;G<S.size();G++){var x=S.get(G);if(x.tab===Z._8o){if(x.endY+v<0){Z.ty(-x.startY);break}if(x.startY+v>a){Z.ty(a-x.endY);break}}}}Z.ty(Z.ty())}else if(i||P){Z._9o&&(Q.x=0,Gq(Z._8o.getView(),Q)),cs($,H,a);var u=Rg($),N=0;if(id(u,0,Z.ty(),1),u.clearRect(0,0,H,a),S.clear(),l._roots.each(function(p){if(p.isVisible()){var E;if(!c||c.tab!==p){var X=Z.getTabBackground(p);E=Z.drawTab(u,p,0,N,H,g,X)}S.add({_75o:E,tab:p,startY:N,endY:N+g,height:g}),N+=g+K}}),Z._23Q=B(0,N-K),c){var s=c.position;Z.drawTab(u,c.tab,0,c.startY,H,c.height,Z._moveBackground),om(u,0,s,H,1,Z._insertColor)}if(u.restore(),Z._selectionChanged){Z._selectionChanged=!1;for(var v=Z.ty(),G=0;G<S.size();G++){var x=S.get(G);if(x.tab===Z._8o){if(x.endY+v<0){Z.ty(-x.startY);break}if(x.startY+v>a){Z.ty(a-x.endY);break}}}}Z.ty(Z.ty())}else{Z._9o&&(Q.y=0,Gq(Z._8o.getView(),Q)),cs($,e,g);var u=Rg($),E=0;if(id(u,Z.tx(),0,1),u.clearRect(0,0,e,g),S.clear(),l._roots.each(function(k){if(k.isVisible()){var N,j=Z.getTabWidth(k);if(!c||c.tab!==k){var x=Z.getTabBackground(k);N=Z.drawTab(u,k,E,0,j,g,x)}S.add({_75o:N,tab:k,startX:E,endX:E+j,width:j}),E+=j+K}}),Z._64I=B(0,E-K),c){var s=c.position;Z.drawTab(u,c.tab,c.startX,0,c.width,g,Z._moveBackground),vq(u,Z._insertColor,s,0,g)}if(u.restore(),Z._selectionChanged){Z._selectionChanged=!1;for(var y=Z.tx(),G=0;G<S.size();G++){var x=S.get(G);if(x.tab===Z._8o){if(x.endX+y<0){Z.tx(-x.startX);break}if(x.startX+y>e){Z.tx(e-x.endX);break}}}}Z.tx(Z.tx())}for(var J=[],m=w.children,G=0;G<m.length;G++){var A=m[G],k=A._tab_;k&&!l.contains(k)&&J.push(A)}J.forEach(function(C){w.removeChild(C)})}});var tt=function(C){this.tv=C,this.addListeners()};Bb(tt,g,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(V){this.handleScroll(V,10*(V.wheelDelta/40))},handle_DOMMouseScroll:function(v){this.handleScroll(v,10*-v.detail)},handleScroll:function(J,B){Uh(J);var C=this.tv,O=C._tabPosition;!C._40o()||O!==vc&&O!==Ol||C.tx(this.tv.tx()+B),!C._41o()||O!==Ld&&O!==fk&&O!==Ld+"-vertical"&&O!==fk+"-vertical"||C.ty(this.tv.ty()+B)},_8Q:function(D){var G,P,N=this.tv,V=N._tabPosition,o=N._7o;if(V===vc||V===Ol){var j=N.lp(D).x;for(G=0;G<o.size();G++)if(P=o.get(G),P.startX<=j&&j<=P.endX)return P}else if(V===Ld||V===fk||V===Ld+"-vertical"||V===fk+"-vertical"){var n=N.lp(D).y;for(G=0;G<o.size();G++)if(P=o.get(G),P.startY<=n&&n<=P.endY)return P}return U},isClickable:function(M){var d=this.tv,$=d._tabPosition,Y=this._73o=this._8Q(M);return!d._40o()||$!==vc&&$!==Ol?!d._41o()||$!==Ld&&$!==fk&&$!==Ld+"-vertical"&&$!==fk+"-vertical"?Y&&(!Y.tab.isDisabled()||d.isMovable()):!0:!0},handle_mousemove:function(y){var v=this;Sd?v._74o=v._8Q(y):v.getView().style.cursor=v.isClickable(y)?vp:""},handle_mousedown:function(O){this.handle_mousemove(O),this.handle_touchstart(O)},handle_touchstart:function(e){var s=this,a=s.tv,$=a._tabPosition;Uh(e),dr(e)&&s.isClickable(e)&&($===vc||$===Ol?(s.x=Ae(e).x,s.lp=a.lp(e),s.tx=a.tx()):(s.y=Ae(e).y,s.lp=a.lp(e),s.ty=a.ty()),Ir(s,e))},handle_mouseup:function(t){this.handle_touchend(t)},handle_touchend:function(s){if(Ni(s)){var I=this._73o;if(!I)return;var C=this.tv,L=C.getTabModel(),w=I.tab;if(!w.isDisabled()&&w.isClosable()){var H=function(){var N=L._roots.indexOf(w);L.remove(w),C.onTabClosed(w,N)};C.onTabClosing(w,H)&&H()}}},handleWindowMouseMove:function(L){this.handleWindowTouchMove(L)},handleWindowTouchMove:function(W){var R,G=this,l=G.tv,Z=l._tabPosition,D=G._73o;if(Z===vc||Z===Ol){if(R=Ae(W).x-G.x,!G._25o&&!G.moving&&k(R)>2&&(l._40o()&&!Pm(W)?G._25o=1:D&&l.isMovable()&&(G.moving=1)),G._25o)l.tx(G.tx+R);else if(G.moving){var u=G.lp.x+R,y=l._tabGap/2;l._7o.each(function(q){var F=q.endX,C=u-q.startX<F-u;u>=q.startX&&F>=u&&l._7Q({tab:D.tab,startX:D.startX+R,width:D.width,front:C,insertTab:q.tab,position:C?B(0,q.startX-y):x(l._64I,F+y)})})}}else if(R=Ae(W).y-G.y,!G._25o&&!G.moving&&k(R)>2&&(l._41o()&&!Pm(W)?G._25o=1:D&&l.isMovable()&&(G.moving=1)),G._25o)l.ty(G.ty+R);else if(G.moving){var F=G.lp.y+R,y=l._tabGap/2;l._7o.each(function(d){var Z=d.endY,V=F-d.startY<Z-F;F>=d.startY&&Z>=F&&l._7Q({tab:D.tab,startY:D.startY+R,height:D.height,front:V,insertTab:d.tab,position:V?B(0,d.startY-y):x(l._23Q,Z+y)})})}},handleWindowMouseUp:function(V){this.handleWindowTouchEnd(V)},handleWindowTouchEnd:function(){var Y=this,G=Y.tv,f=G._tabPosition,c=G.getTabModel(),t=c._roots,J=Y._73o;if(Y.moving){var j=G._23o;if(j&&j.insertTab!==j.tab){var I=j.tab,R=t.remove(I),y=t.indexOf(j.insertTab);y>=0&&(j.front||y++,y<=t.size()&&(t.add(I,y),c._38I(I,R,y)))}G._7Q(U),delete Y.moving}else if(!Y._25o&&J){I=J.tab;var M=Y._74o;if(!M||M.tab===I)if(!I.isDisabled()&&Qn(J._75o,Y.lp)){var v=function(){var S=t.indexOf(I);c.remove(I),G.onTabClosed(I,S)};G.onTabClosing(I,v)&&v()}else I.isDisabled()||G._8o===I||c.sm().ss(I)}Y._25o=Y._73o=Y._74o=f===vc||f===Ol?Y.x=Y.lp=Y.tx=U:Y.y=Y.lp=Y.ty=U}}),nt.PropertyView=function($){var O=this;O._view=np(1,O),O._canvas=Nb(O._view),zp(O._view,O._79O=qg()),O._rows=new Vo,O._28o=new Vo,O._26o={},O._26Q={};var K=O._propertyModel=new sm,P=O.ivm;K.mm(P,O),K.md(P,O),K.mh(P,O),O.dm($?$:new sm),new ut(O)},ot("PropertyView",g,{ms_ac:[Lr,qr,Kl,kl,ck,"categorizable",Bo,Nl,Wm,Of,wg,Bm,uk,ne,"selectRowIndex",Bd,"background",Bj,gh,ro,pg,wl],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Ki,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Yk,_background:G.propertyViewBackground,_expandIcon:G.propertyViewExpandIcon,_collapseIcon:G.propertyViewCollapseIcon,_scrollBarColor:vi,_scrollBarSize:Ud,_autoHideScrollBar:gn,_selectBackground:G.propertyViewSelectBackground,_rowHeight:uj,_rowLineVisible:G.propertyViewRowLineVisible,_rowLineColor:G.propertyViewRowLineColor,_10I:.5,_columnLineVisible:G.propertyViewColumnLineVisible,_columnLineColor:G.propertyViewColumnLineColor,_labelColor:G.propertyViewLabelColor,_labelSelectColor:G.propertyViewLabelSelectColor,_labelFont:G.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(Q){0>Q&&(Q=0),Q>1&&(Q=1);var h=this,R=h._10I;h._10I=Q,h.fp("columnPosition",R,Q)},getPropertyName:function(l){return l.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(j,s,P){return P===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(u,S){return S===this._selectRowIndex?this._labelSelectColor:u.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(n){var R=this.getHeight()-this._59I;return R>n&&(n=R),n>0?0:O(n)},isExpanded:function(H){if(!H)return!0;var y=this._26o[H];return y?y.isExpanded:!(this._26Q[H]===!1)},toggle:function(j){var b=this;b.isExpanded(j)?b.collapse(j):b.expand(j)},expandAll:function(){this.validate();for(var f in this._26o)this.expand(f)},expand:function(X){if(X&&X!==Jj){var u=this,v=u._26o[X];v&&!v.isExpanded&&(v.isExpanded=!0,u.onExpanded(X),u.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var l in this._26o)this.collapse(l)},collapse:function(Q){if(Q&&Q!==Jj){var k=this,g=k._26o[Q];g&&g.isExpanded&&(g.isExpanded=!1,k.onCollapsed(Q),k.ivm())}},onCollapsed:function(){},getCategoryName:function(Z){if(!this.isCategorizable())return Jj;var B=Z.getCategoryName();return B?B:Jj},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(O){var U=this,H=U._dataModel;H!==O&&(H&&(H.umd(U.handlePropertyChange,U),U._selectionModel||H.sm().ums(U.handleSelectionChange,U)),U._dataModel=O,O.md(U.handlePropertyChange,U),U._selectionModel?U._selectionModel._21I(O):O.sm().ms(U.handleSelectionChange,U),U.fp(ln,H,O))},isVisible:function(f){return this._visibleFunc?this._visibleFunc(f):!0},onPropertyChanged:function(Y){var $=this,S=Y.property;it[S]?$.ivm():$.iv(),S===yd&&$._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:am},handlePropertyChange:function(P){this._27o===P.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var z=this;z._96I||(z.setSelectRowIndex(-1),z._96I=1,z.iv())},redraw:function(){this.iv()},validateModel:function(){var m=this,v=m._rows,W=m._28o,I={},E=new Vo,K=m._27o;m.updateCurrentData(),K!==m._27o&&m.endEditing(),v.clear(),W.clear(),m.getRawProperties().each(function(b){if(m.isVisible(b)){E.add(b);var a=m.getCategoryName(b);I[a]||(W.add(a,a===Jj?0:c),I[a]={isExpanded:m.isExpanded(a),properties:new Vo})}}),m._sortFunc&&E.sort(m._sortFunc);for(var G in m._26o)m._26Q[G]=m.isExpanded(G);m._26o=I,W.each(function(P){P!==Jj&&v.add(P);var i=I[P];i.isExpanded&&E.each(function(V){m.getCategoryName(V)===P&&(i.properties.add(V),v.add({property:V,data:m._27o}))},m)})},validateImpl:function(){var T=this;T._76o(),T._96I&&(T.validateModel(),delete T._96I);var i=T._canvas,m=T.getWidth(),w=T.getHeight(),E=-T.ty(),G=T._rowHeight,Y=T._indent,t=m-Y,W=T._rows,d=W.size(),B=T._9I=Y+t*T._10I,r=T._59I=d*G;cs(i,m,w),T._29I={x:0,y:E,width:m,height:w},T._31I=A(E/G),T._14I=Q((E+w)/G),T._31I<0&&(T._31I=0),T._14I>d&&(T._14I=d);var l,J=Rg(i),q=T._background;id(J,0,-E,1),J.beginPath(),J.rect(0,E,m,w),J.clip(),J.clearRect(0,E,m,w),T._93db(J),q&&om(J,0,0,Y,r,q);for(var F=T._31I;F<T._14I;F++){var S=W.get(F),E=G*F;if(ak(S))q&&om(J,Y,E,t,G,q),l=Kj(T.isExpanded(S)?T._expandIcon:T._collapseIcon),l&&bl(J,l,gf,0,E,Y,G),J.save(),J.beginPath(),J.rect(Y,E,t,G),J.clip(),T.drawCategoryName(J,S,F,Y,E,t,G),J.restore();else{var R=S.property,C=S.data,l=Kj(R.getIcon()),v=T._selectRowIndex===F?T.getSelectBackground():U;if(l&&bl(J,l,gf,0,E,Y,G),v&&om(J,Y,E,t,G,v),J.save(),J.beginPath(),J.rect(Y,E,B-Y,G),J.clip(),T.drawPropertyName(J,R,F,Y,E,B-Y,G),J.restore(),!T.isEditing(C,R)){var f=B+1,u=m-B-1;J.save(),J.beginPath(),J.rect(f,E,u,G),J.clip(),T._87o(T.drawPropertyValue(J,R,T.getValue(C,R),F,f,E,u,G,C),F,f,E,u,G),J.restore()}}T._rowLineVisible&&om(J,Y,E+G-1,t,1,T._rowLineColor)}T._columnLineVisible&&(om(J,B,0,1,r,T._columnLineColor),om(J,m-1,0,1,r)),T._92db(J),T._93I(),J.restore(),T.ty(T.ty())},drawCategoryName:function(t,u,_,f,n,R,v){hl(t,u,this.getCategoryFont(u),this.getCategoryColor(u),f,n,R,v)},drawPropertyName:function(a,T,H,K,o,U,I){return T.drawPropertyName?(T.drawPropertyName(a,T,H,K,o,U,I,this),void 0):(hl(a,this.getPropertyName(T),this.getPropertyFont(T,H),this.getPropertyColor(T,H),K,o,U,I),void 0)},drawPropertyValue:function(S,Q,u,v,x,Y,G,D,U){return Q.drawPropertyValue?Q.drawPropertyValue(S,Q,u,v,x,Y,G,D,U,this):(kt(S,u,Q,this.getLabelFont(Q,u,v),this.getLabelColor(Q,u,v),x,Y,G,D,U,this),void 0)},isPropertyEditable:function(n){return n.isEditable()&&this.isEditable()},setProperties:function(x){this._propertyModel.clear(),this.addProperties(x)},addProperties:function(x){if(x){var S=this._propertyModel;x.forEach(function(D){if(!(D instanceof rt)){var z=Ef(D.className);D=ll(z?z:rt,D)}S.add(D)})}},getRowIndexAt:function(a){var r=this,D=A(r.lp(a).y/r._rowHeight);return D>=0&&D<r._rows.size()?D:-1},getPropertyAt:function(O){var Y=this,$=Y.getRowIndexAt(O);return $>=0?Y._rows.get($).property:U},getToolTip:function(X){var H=this,u=H.getPropertyAt(X),y=H._27o;return u&&y?u.getToolTip(y,H._9I<H.lp(X).x,H):U}});var ut=function(S){this.pv=S,this.addListeners()};Bb(ut,g,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(Y){this.getView().style.cursor=Y},clear:function(){var Z=this;Z._62O=Z.cp=Z.ty=Z.p=U,Z.setCursor(fg)},handle_mousedown:function(l){this.handle_touchstart(l)},handle_touchstart:function(U){var d=this,K=d.pv;Uh(U),K.setFocus(U)&&(dr(U)?(d.cp=Ae(U),d.ty=K.ty(),d.p=K.getColumnPosition(),d.handle_touchmove(U)):K.setSelectRowIndex(K.getRowIndexAt(U)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(r){this.handle_touchend(r)},handle_touchend:function(p){var r=this;if(r.cp&&!r._62O){var E=r.pv,T=E.lp(p),Q=T.x,n=T.y,j=E._indent,z=E.getRowIndexAt(p),b=E._9I;if(z>=0){var C=E._rowHeight,V=C*z,h=E._rows.get(z),K=h.property;if(ak(h))Kj(E.isExpanded(h)?E._expandIcon:E._collapseIcon)&&Q>=0&&j>=Q&&n>=V&&V+C>=n?E.toggle(h):ar(p)&&E.toggle(h);else if(Q>b&&E.isPropertyEditable(K,p)){var O={x:b+1,y:V,width:E.getWidth()-b-1,height:C},H={x:O.x+E.tx(),y:O.y+E.ty(),width:O.width,height:O.height},D=0,e=E._29I;O.y<e.y?D=O.y-e.y:O.y+C>e.y+e.height&&(D=O.y+C-e.y-e.height),D&&(E.ty(E.ty()-D),H.y-=D),E.beginEditing({data:h.data,property:K,value:E.getValue(h.data,K),event:p,rect:O,editorRect:H,view:E})}}E.setSelectRowIndex(z)}r.clear()},handleWindowMouseMove:function(_){this.handleWindowTouchMove(_)},handleWindowTouchMove:function(w){var I=this,k=I.pv,l=I.ty,b=I.cp,z=Ae(w),J=I._62O;if("p"===J)k.setTranslateY(l+z.y-b.y);else if("c"===J){var a=k.getWidth()-k._indent;if(a>16){var N=I.p-(b.x-z.x)/a,K=16/a;K>N&&(N=K),N>1-K&&(N=1-K),k.setColumnPosition(N)}}else"s"===J&&k.setTranslateY(l+(b.y-z.y)*k._59I/k._29I.height)},handle_mousemove:function(E){this.handle_touchmove(E)},handle_touchmove:function(C){if(!Sd&&dr(C)){var w=this,s=w.pv,i=k(s.lp(C).x-s._9I)<=(jg?8:3);w.cp?w._62O||(i?(w._62O="c",Ir(w,C)):k(Ae(C).y-w.cp.y)>=2&&(w._62O=w.isV(C)?"s":"p",Ir(w,C))):(i?w.setCursor(Sm):w.setCursor(fg),w.isV(C)&&s._43o())}},isV:function(L){var b=this.pv,X=b._29I;return b._41o()&&X.x+X.width-b.lp(L).x<sj},handle_mousewheel:function(B){this.handleScroll(B,B.wheelDelta/40)},handle_DOMMouseScroll:function(x){2===x.axis&&this.handleScroll(x,-x.detail)},handleScroll:function(H,E){var o=this.pv;Uh(H),o.endEditing(),o.translate(0,E*o.getRowHeight())},handle_keydown:function(B){var g=this.pv,i=g._rows.size(),v=g._selectRowIndex+(uq(B)?-1:1);(uq(B)||Ok(B))&&(0>v&&(v=0),v>=i&&(v=i-1),g.setSelectRowIndex(v))}}),nt.ListView=function(G){this._5o(G),new vt(this)},ot("ListView",g,{ms_ac:[Lr,qr,Kl,Bj,Bo,gh,ro,Nl,Wm,Bm,uk,ne,_m,Bd],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Yk,_rowHeight:uj,_rowLineVisible:G.listViewRowLineVisible,_rowLineColor:G.listViewRowLineColor,_scrollBarColor:vi,_scrollBarSize:Ud,_autoMakeVisible:ud,_autoHideScrollBar:gn,_selectBackground:G.listViewSelectBackground,_labelColor:G.listViewLabelColor,_labelSelectColor:G.listViewLabelSelectColor,_labelFont:G.listViewLabelFont,isCheckMode:function(){return this._checkMode
},setCheckMode:function(N){var c=this,M=c._checkMode;c._checkMode=N,c.fp(yl,M,N)},drawRow:function(W,k,e,G,t,d,T){var S=this,V=0,n=S._indent,x=S.getIconWidth(k);S.drawRowBackground(W,k,e,G,t,d,T),S._checkMode&&(Gf(W,Kj(S.getCheckIcon(k)),V+n/2,t+T/2,k,S),V+=n),S.drawIcon(W,k,V,t,x,T),S.drawLabel(W,k,V+x,t,T)}});var vt=function(C){this.list=C,this.addListeners()};Bb(vt,g,{ms_listener:1,getView:function(){return this.list._view},clear:function(B){var C=this,F=C.list;B&&"d"===C._62O&&!C.dragCancel&&F.handleDragAndDrop(B,"end"),F.draggingData&&(F.draggingData=null,F.redraw()),C.dragCancel=C._62O=C._isV=C._isH=C.cp=C.tx=C.ty=U},handle_mousedown:function(P){this.handle_touchstart(P)},handle_touchstart:function(E){var x=this,O=x.list;if(Uh(E),O.setFocus(E)){var M=O.getDataAt(E);x.cp=Ae(E),x.tx=O.tx(),x.ty=O.ty(),dr(E)?M&&O.handleDragAndDrop&&!x.isV(E)&&!x.isH(E)&&(O.draggingData=M,O.redraw(),O.handleDragAndDrop(E,"prepare")):(M?x._33o(E,M):this._cancelDataDoubleSelect(),x.clear(E))}},handleWindowMouseUp:function(N){this.clear(N)},handleWindowTouchEnd:function(g){this.clear(g)},handle_mouseup:function(z){this.handle_touchend(z)},handle_touchend:function(o){var M=this,Y=M.list;if(!M._isV&&!M._isH&&M.cp&&!M._62O){var c=Y.getDataAt(o);c?(Y.isCheckMode()?M._34o(o,c):M._33o(o,c),ar(o)?Y.onDataDoubleClicked(c,o):Y.onDataClicked(c,o)):(M._cancelDataDoubleSelect(),Y.handleBackgroundClick(o))}M.clear(o)},handleWindowMouseMove:function(T){this.handleWindowTouchMove(T)},handleWindowTouchMove:function($){var w=this,S=w.list,o=w._62O,I=w.tx,b=w.ty,R=w.cp,M=Ae($),A=S._29I;"p"===o?S.setTranslate(I+M.x-R.x,b+M.y-R.y):"v"===o?S.ty(b+(R.y-M.y)*S._59I/A.height):"h"===o?S.tx(I+(R.x-M.x)*S._91I/A.width):"d"===o&&(w.dragCancel||S.handleDragAndDrop($,"between"))},handle_mousemove:function(R){this.handle_touchmove(R)},handle_touchmove:function(p){if(!Sd&&dr(p)){var h=this,x=h.list;if(h._isV=h.isV(p),h._isH=h.isH(p),h.cp){if(!h._62O){if(Sn(Ae(p),h.cp)<2)return;h._isV?h._62O="v":h._isH?h._62O="h":x.draggingData&&!this.dragCancel?(h._62O="d",x.handleDragAndDrop(p,"begin")):h._62O="p",h._62O&&"d"!==h._62O&&x.draggingData&&(x.draggingData=null,x.redraw()),Ir(h,p)}}else h._isV&&x._43o(),h._isH&&x._42o()}},isV:function(v){var Q=this.list,D=Q._29I;return Q._41o()&&D.x+D.width-Q.lp(v).x<sj},isH:function(S){var $=this.list,x=$._29I;return $._40o()&&x.y+x.height-$.lp(S).y<sj},handle_mousewheel:function(A){this.handleScroll(A,A.wheelDelta/40,A.wheelDelta!==A.wheelDeltaX)},handle_DOMMouseScroll:function(G){this.handleScroll(G,-G.detail,1)},handleScroll:function(n,T,$){var S=this.list;Uh(n),S.endEditing&&S.endEditing(),$&&S._41o()?S.translate(0,T*S.getRowHeight()):S._40o()&&S.translate(10*T,0)},handle_keydown:function(R){if(!G.isInput(R.target)){var _,E=this.list,A=E.sm(),n=E._rows,D=n.size();if(Qb(R))E.selectAll();else if(Nc(R))E.handleDelete&&E.handleDelete(R);else if(Jk(R))"d"!==this._62O||this.dragCancel||(E.handleDragAndDrop(R,"cancel"),this.dragCancel=!0);else if(Tr(R))E.isCheckMode()&&(_=E.getFocusData(),_&&E.checkData(_));else if(uq(R)||Ok(R)){var q=E.isCheckMode();if(_=q?E.getFocusData():A.ld()){var e=E.getRowIndex(_);e>=0&&(uq(R)?0!==e&&(_=n.get(e-1),q?E.setFocusData(_):A.ss(_)):e!==D-1&&(_=n.get(e+1),q?E.setFocusData(_):A.ss(_)))}else D>0&&(_=n.get(0),q?E.setFocusData(_):A.ss(_))}}},_34o:function(i,c){var Z=this.list,p=Z.lp(i).x;return p>=0&&p<=Z._indent?(Z.checkData(c),void 0):(Z.setFocusData(c),void 0)},_33o:function(r,F){var G=this.list,b=G.sm(),H=b.ld();if(!G.canHandleSelectMode(r,F))return this._cancelDataDoubleSelect(),void 0;if(Pm(r))G.isSelected(F)?b.rs(F):b.as(F);else if(zm(r))if(H)for(var t=G.getRowIndex(H),P=G.getRowIndex(F);t!==P;)t+=P>t?1:-1,b.as(G._rows.get(t));else b.ss(F);else dr(r)?(b.contains(F)?G.handleDataDoubleSelect&&(this._handleDataDoubleSelect(r,F),ar(r)&&this._cancelDataDoubleSelect()):this._cancelDataDoubleSelect(),b.ss(F)):b.contains(F)||b.ss(F)},_handleDataDoubleSelect:function(M,R){this._cancelDataDoubleSelect(),this._doubleSelectTimer=xq(function(){this.list.handleDataDoubleSelect(M,R),this._doubleSelectTimer=c}.bind(this),G.doubleClickSpeed)},_cancelDataDoubleSelect:function(){this._doubleSelectTimer&&(rj(this._doubleSelectTimer),this._doubleSelectTimer=c)}}),nt.TreeView=function(U){var m=this;m._35o(),m._5o(U),new wt(m)},ot("TreeView",g,{ms_ac:[Lr,qr,Kl,"rootVisible",yl,"rootData",Nl,Wm,Bm,uk,ne,Bo,Bj,gh,ro,Of,wg,_m,Bd,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:U,_indent:Yk,_rowHeight:uj,_rowLineVisible:G.treeViewRowLineVisible,_rowLineColor:G.treeViewRowLineColor,_scrollBarColor:vi,_scrollBarSize:Ud,_autoHideScrollBar:gn,_expandIcon:G.treeViewExpandIcon,_collapseIcon:G.treeViewCollapseIcon,_autoMakeVisible:ud,_selectBackground:G.treeViewSelectBackground,_labelColor:G.treeViewLabelColor,_labelSelectColor:G.treeViewLabelSelectColor,_labelFont:G.treeViewLabelFont,_doubleClickToToggle:G.treeViewDoubleClickToToggle,drawRow:function(Z,M,F,H,Q,w,O){var x=this;x.drawRowBackground(Z,M,F,H,Q,w,O),x.drawTree(Z,M,F,0,Q,w,O)},isOnToggleIcon:function(i){var W=this.getDataAt(i);if(W){var _=this.getIndent(),K=this.lp(i).x;if(Kj(this.getToggleIcon(W))){var N=_*this.getLevel(W);if(K>=N&&N+_>=K)return!0}}return!1}});var wt=function(f){Zn(wt,this,[f])};Bb(wt,vt,{toggle:function(i,o,z,r){var $=this.list,v=$.lp(i).x;if(Kj($.getToggleIcon(o))){var h=z*r;if(v>=h&&h+z>=v)return $.toggle(o),!0}return $.isDoubleClickToToggle()&&ar(i)?($.toggle(o),!0):!1},_34o:function(B,W){var C=this.list,u=C.lp(B).x,v=C._levelMap[W._id],L=C._indent,$=L*(v+1);return u>=$&&$+L>=u?(C.checkData(W),void 0):(this.toggle(B,W,L,v)||C.setFocusData(W),void 0)},_33o:function(g,E){var n=this,o=n.list;if(!n.toggle(g,E,o._indent,o.getLevel(E)))if(zm(g)){var K=o.sm();if(K.size()>0){for(var W=o._rows,l=null,V=0,C=W.size();C>V;V++)if(o.isSelected(W.get(V))){l=V;break}for(var z=null,V=W.size()-1;V>=0;V--)if(o.isSelected(W.get(V))){z=V;break}var w,H,M=o.getRowIndex(E);for(l>M?(w=M-1,H=l):M>z?(w=z,H=M):(w=l,H=z);w!==H;)w++,K.as(o._rows.get(w))}else K.ss(E)}else wt.superClass._33o.call(n,g,E)},handle_keydown:function(U){if(Go(U)||ib(U)){var g=this.list,W=g._rows,Y=g.isCheckMode(),J=g.sm(),i=Y?g.getFocusData():J.ld();i?i.hasChildren()&&(Go(U)?g.collapse(i):g.expand(i)):W.size()>0&&(i=W.get(0),Y?g.setFocusData(i):J.ss(i))}else wt.superClass.handle_keydown.call(this,U)}});var xt=nt.TableView=function(H){this._98I(),this._5o(H),new yt(this)};ot("TableView",g,{ms_ac:[Lr,qr,Kl,"sortMode",kl,ck,Bj,gh,ro,pg,wl,"sortColumn",Nl,Wm,Bm,uk,ne,_m,Bd],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:nh,_editable:!0,_batchEditable:!1,_rowHeight:uj,_rowLineVisible:G.tableViewRowLineVisible,_rowLineColor:G.tableViewRowLineColor,_columnLineVisible:G.tableViewColumnLineVisible,_columnLineColor:G.tableViewColumnLineColor,_scrollBarColor:vi,_scrollBarSize:Ud,_autoHideScrollBar:gn,_autoMakeVisible:ud,_selectBackground:G.tableViewSelectBackground,_labelColor:G.tableViewLabelColor,_labelSelectColor:G.tableViewLabelSelectColor,_labelFont:G.tableViewLabelFont,getCheckColumn:function(){var m=this;if(!m._31o){var s=m._31o=new qt;s.setEditable(!0),s.setWidth(40),s.getValue=m.getCheckColumValue,s.drawCell=m.drawCheckColumnCell}return m._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(p){var Y=this,r=Y._39o,o=Y.getCheckColumn();p!==Y.isCheckMode()&&(p?r.add(o,0):r.remove(o),Y.fp(yl,!p,p))},getCheckColumValue:function(u,O,w){return w.isSelected(u)},drawCheckColumnCell:function(N,W,_,J,Q,H,k,v,m){Gf(N,m.getCheckIcon(W),Q+k/2,H+v/2,W,m)}});var yt=function(b){Zn(yt,this,[b])};Bb(yt,vt,{_34o:function(y,J){var w=this.list,l=w._31o;if(w.isCellEditable(J,l,y)){var K=w._3Q(l),T=w.lp(y).x;if(K&&T>=K.startX&&T<K.startX+l.getWidth())return w.checkData(J),void 0}w._37O(J,y),w.setFocusData(J)},_33o:function(S,Q){this.list._37O(Q,S),yt.superClass._33o.apply(this,arguments)}});var zt=nt.TreeTableView=function(I){var K=this,j=K._4o=new qt;K._35o(),K._98I(),K._5o(I),j.setDisplayName("Name"),j.setEditable(!0),j.setWidth(180),j.drawCell=At,j.getValue=Bt,K._39o.add(j),new Ct(K)},At=function(j,q,k,Y,s,t,d,Z,Q){Q.drawTree(j,q,k,s,t,d,Z)},Bt=function(k,u,g){return g.getLabel(k)};ot("TreeTableView",g,{ms_ac:[Lr,qr,Kl,"sortMode",kl,ck,Bo,yl,"rootData","rootVisible",Nl,Wm,"sortColumn",Of,wg,Bm,uk,ne,_m,ro,Bj,gh,pg,wl,Bd,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:nh,_checkMode:U,_editable:!0,_batchEditable:!1,_indent:Yk,_rowHeight:uj,_rowLineVisible:G.treeTableViewRowLineVisible,_rowLineColor:G.treeTableViewRowLineColor,_columnLineVisible:G.treeTableViewColumnLineVisible,_columnLineColor:G.treeTableViewColumnLineColor,_expandIcon:G.treeTableViewExpandIcon,_collapseIcon:G.treeTableViewCollapseIcon,_scrollBarColor:vi,_scrollBarSize:Ud,_autoHideScrollBar:gn,_autoMakeVisible:ud,_selectBackground:G.treeTableViewSelectBackground,_labelColor:G.treeTableViewLabelColor,_labelSelectColor:G.treeTableViewLabelSelectColor,_labelFont:G.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Ct=function(D){Zn(Ct,this,[D])};Bb(Ct,vt,{_34o:function(r,w){var f=this.list,B=f._4o,T=f._3Q(B),U=f.lp(r).x;if(T){var Y=f._indent,O=T.startX+Y*f.getLevel(w);if(Kj(f.getToggleIcon(w))&&U>=O&&O+Y>=U)return f.toggle(w),void 0;if(f.isCellEditable(w,B)&&(O+=Y,U>=O&&O+Y>=U))return f.checkData(w),void 0}f._37O(w,r),f.setFocusData(w)},_33o:function(H,T){var Q=this.list,m=Q.lp(H).x;if(Kj(Q.getToggleIcon(T))){var Z=Q._3Q(Q._4o);if(Z){var x=Q._indent,u=Z.startX+x*Q.getLevel(T);if(m>=u&&u+x>=m)return Q.toggle(T),void 0}}Q._37O(T,H),Ct.superClass._33o.apply(this,arguments)}});var Dt=nt.TableHeader=function(U){var g=this,A=g._view=np(1,g),r=g._39o=U.getColumnModel(),P=g.iv;g.tv=g._tableView=U,g._60I=new Vo,g._canvas=Nb(A),A.style.background=G.tableHeaderBackground||"",A.style.height=bm+Cm,r.mm(P,g),r.md(P,g),r.mh(P,g),U.mp(function(P){et[P.property]&&g.iv()},g),new Et(g),g.iv()};ot("TableHeader",g,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Lr,Kl,Bo,"moveBackground","insertColor",pg,wl,"resizable","movable"],_checkIcon:Zb,_movable:!0,_resizable:!0,_labelColor:G.tableHeaderLabelColor,_labelFont:G.tableHeaderLabelFont,_columnLineColor:G.tableHeaderColumnLineColor,_columnLineVisible:G.tableHeaderColumnLineVisible,_sortDescIcon:G.tableHeaderSortDescIcon,_sortAscIcon:G.tableHeaderSortAscIcon,_moveBackground:G.tableHeaderMoveBackground,_insertColor:G.tableHeaderInsertColor,_indent:Yk,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(r){return r.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(t){return t.getColor()||this._labelColor},getLabelAlign:function(P){return P._align},onPropertyChanged:function(){this.iv()},_5Q:function(y){this._61I=y,this.iv()},getLogicalPoint:function(X){return Ag(X,this._canvas,this.tv.tx())},validateImpl:function(){var R=this,T=R._canvas,V=R.getWidth(),l=R.getHeight(),G=R.tv,z=R._60I,O=R._61I,I=-G.tx(),y=0;(V!==T.clientWidth||l!==T.clientHeight)&&cs(T,V,l),z.clear(),R._39o._roots.each(function(s){if(s.isVisible()){var R=y+s.getWidth();I+V>=y&&R>=I&&z.add({column:s,startX:y}),y=R}});var v=Rg(T);if(id(v,-I,0,1),v.beginPath(),v.rect(I,0,V,l),v.clip(),v.clearRect(I,0,V,l),z.each(function(N){var c=N.column,p=N.startX,s=c.getWidth();s>0&&(v.save(),v.beginPath(),v.rect(p,0,s,l),v.clip(),O&&O.column===c||R.drawColumn(v,c,p,0,s,l),R._columnLineVisible&&om(v,p+s-1,0,1,l,R._columnLineColor),v.restore())}),O){var p=O.column,y=O.startX,a=O.position,L=p.getWidth();v.save(),v.beginPath(),v.rect(y,0,L,l),v.clip(),v.fillStyle=R._moveBackground,v.fill(),R.drawColumn(v,p,y,0,L,l),v.restore(),vq(v,R._insertColor,a,0,l)}v.restore()},_6Q:function(A){var B=this.tv;return B._31o===A&&B.sm().getSelectionMode()===Jo},drawColumn:function(f,w,X,b,z,Z){var U=this,Y=U.tv,N=Kj(w.getIcon()),m=U.getLabelAlign(w);if(U._6Q(w)){var B=Kj(U._checkIcon);Gf(f,B,X+z/2,b+Z/2,w,U)}else{var P=U.getLabel(w),i=U.getLabelFont(w),x=U.getLabelColor(w),p=ei(i,P).width,O=N?U._indent:0;m===Ld?(N&&bl(f,N,gf,X,b,O,Z),hl(f,P,i,x,X+O,b,z,Z,Ld)):m===fk?(N&&bl(f,N,gf,X+z-p-O,b,O,Z),hl(f,P,i,x,X,b,z,Z,fk)):(N&&bl(f,N,gf,X+(z-p-O)/2,b,O,Z),hl(f,P,i,x,X+(z-p+O)/2,b,0,Z,Ld))}if(w.isSortable()&&Y.getSortColumn()===w&&(N=Kj(w.getSortOrder()===qk?U._sortAscIcon:U._sortDescIcon))){var v=Zo(N,w)/2+2;Gf(f,N,m===fk?X+v:X+z-v,b+Z/2,w,Y)}}});var Et=function(t){var v=this;v.th=t,v.tv=t._tableView,v.addListeners()};Bb(Et,g,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(w){this.getView().style.cursor=w},handle_mousemove:function(x){if(!Sd){var r=this;delete r._29o,r.setCursor(fg);for(var i=r.th,R=i._60I,Q=i.lp(x).x,E=R.size()-1;E>=0;E--){var p=R.get(E),W=p.column,C=p.startX+W.getWidth();if(i.isResizable()&&k(C-Q)<=(jg?10:3))return r._29o=p,r.setCursor(Sm),void 0;Q>p.startX&&C>Q&&(r._29o=p),(W.isClickable()||W.isSortable()||i.isMovable()||r.tv.getCheckColumn&&W===r.tv.getCheckColumn())&&Q>p.startX&&C>Q&&r.setCursor(vp)}}},handle_mousedown:function(D){this.handle_touchstart(D)},handle_touchstart:function(o){var R=this;Uh(o),R.tv.endEditing(),R.handle_mousemove(o),R._29o&&(R.x=Ae(o).x,R.lx=R.th.lp(o).x,R.w=R._29o.column.getWidth(),Ir(R,o))},handleWindowMouseMove:function(s){this.handleWindowTouchMove(s)},handleWindowTouchMove:function(a){var A=this,T=A.th,e=A.getView().style.cursor,H=A._29o,i=Ae(a).x-A.x;if(A.resizing||A.moving||(e===Sm?A.resizing=1:T.isMovable()&&e===vp&&k(i)>2&&(A.moving=1)),A.resizing)H.column.setWidth(A.w+i);else if(A.moving){var c=A.lx+i;T._60I.each(function(B){var p=B.startX,x=p+B.column.getWidth();if(c>=p&&x>=c){var h={column:H.column,startX:H.startX+i,front:x-c>c-p,insertColumn:B.column};h.position=h.front?p:x,T._5Q(h)}})}},_16Q:function(Y,d){var u=this,G=u.tv,z=u.th,_=z._checkIcon;if(z._6Q(Y)){var X=Kj(_),s=u.lx,O=Y.getWidth(),V=Zo(X,Y);if(s>=d+O/2-V&&d+O/2+V>=s){z.setCheckIcon(_===il?Zb:il);var t=G.sm(),Q=G._rows;return _===il?t.rs(Q):t.ss(Q),G.onCheckColumnClicked(Y),!0}}return!1},handleWindowMouseUp:function(W){this.handleWindowTouchEnd(W)},handleWindowTouchEnd:function(m){var P=this,F=P.tv,M=P.th,s=P._29o;if(P.moving){var t=M._61I;if(t&&t.insertColumn!==t.column){var T=t.column,X=F.getColumnModel()._roots,k=X.remove(T),o=X.indexOf(t.insertColumn);o>=0&&(t.front||o++,o<=X.size()&&(X.add(T,o),F.getColumnModel()._38I(T,k,o)))}M._5Q(U),delete P.moving}else if(!P.resizing&&s){T=s.column;var N=M.lp(m).x,l=s.startX,D=!0;if(M.onColumnClicked){var v=M.onColumnClicked(T,m,l);v===!1&&(D=!1)}if(D&&N>=l&&N<=l+T.getWidth()&&!P._16Q(T,l)){if(T.isSortable()){var V=F.getSortMode(),w=T.getSortOrder();V===nh?F.getSortColumn()===T?(w===Yj&&F.setSortColumn(U),T.setSortOrder(w===qk?Yj:qk)):F.setSortColumn(T):"bistate"===V&&(F.getSortColumn()===T?T.setSortOrder(w===qk?Yj:qk):F.setSortColumn(T))}F.onColumnClicked(T,m,l)}}P._29o=P.resizing=P.x=P.lx=P.w=U}}),nt.TablePane=function(Q){this.init(new xt(Q))},ot("TablePane",g,{ms_v:1,_44o:1}),nt.TreeTablePane=function(v){this.init(new zt(v))},ot("TreeTablePane",g,{ms_v:1,_44o:1}),nt.Toolbar=function(A){var T=this,b=T._view=np(1,T),J=b.style;J.background=G.toolbarBackground||"",J.height=pi+Cm,T._canvas=Nb(b),T._30o=new Vo,T._90I=new Vo,T.setItems(A||[]),b.handleGroupSelectedChanged=function(m){if(m.isSelected()){var M=m.getGroupId();null!=M&&T._items.forEach(function(R){var a=R.element;a&&a!==m&&a.setSelected&&a.getGroupId&&a.getGroupId()===M&&a.setSelected(!1)})}},new Ft(T)},ot("Toolbar",g,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[cf,Lr,Kl,qr,Bd,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:G.toolbarLabelColor,_labelSelectColor:G.toolbarLabelSelectColor,_labelFont:G.toolbarLabelFont,_selectBackground:G.toolbarSelectBackground,_itemGap:G.toolbarItemGap,_separatorColor:G.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(G){var j=this.getItemInfoAt(G);return j?j.item.toolTip:U},getLabelColor:function(m){return m&&m.selected&&m.type!==il&&m.type!==Wd?this._labelSelectColor:this._labelColor},onPropertyChanged:function(j){this.iv(),j.property===cf&&this._items.forEach(function(B){ul(B)})},redraw:function(){this.iv()},addItem:function(g,G){var V=this._items;G==U?V.push(g):V.splice(G,0,g),this.fp(cf,U,V)},removeItem:function(o){if(o)for(var K=this._items,P=0;P<K.length;P++)o===K[P]&&(K.splice(P,1),this.fp(cf,U,K))},removeItemById:function(u){if(u!=U)for(var l=this._items,P=0;P<l.length;P++)if(u===l[P].id){var j=l.splice(P,1)[0];return this.fp(cf,U,l),j}},getItemById:function(Q){if(Q!=U)for(var d=this._items,j=0;j<d.length;j++){var f=d[j];if(Q===f.id)return f}},setItemVisible:function(u,X){var t=this.getItemById(u);t&&(t.visible=X)},getItemInfos:function(){return this._30o},getItemInfoAt:function(L){var f=this,d=0,k=f._30o,O=f.lp(L),T=O.x,P=O.y;if(P>=0&&P<=f.getHeight())for(;d<k.size();d++){var q=k.get(d);if(q.startX<=T&&T<=q.endX)return q}return U},drawItem:function(E,m,$,S,O){if(m.visible===!1)return 0;if(kk(m.visible)&&!m.visible())return 0;var e=this,I=m.disabled;I&&(E.globalAlpha=_r);var Q=e.drawItemImpl(E,m,$,S,O),s=e._itemGap;return I&&(E.globalAlpha=1),this._currentItem!==m||"separator"===m||m.separator===!0||m.unfocusable||ni(E,e._separatorColor,$-s/2,0,Q+s,S),Q},drawItemImpl:function(R,L,i,B,m){var u=this,Z=u._view,P=u._itemGap,c=B/2,J=L.type,M=L.element,r=L.label;ak(M)&&(r=M,M=U);var T,_=u.getLabelFont(L),K=u.getLabelColor(L),e=L.selected,h=Kj(L.icon),C=Zo(h,L),H=0,A=C+(r?ei(_,r).width:0);if("separator"===L||L.separator===!0)return vq(R,u._separatorColor,i,B/4,c),1;if(M){h&&Gf(R,h,i+C/2,c,L,u),hl(R,r,_,K,i+C,0,0,B);var G=Ec(M);m||u._90I.add(G),G.parentNode!==Z&&zp(Z,G),M.iv&&M.iv(),M.validate&&M.validate();var s=G.getBoundingClientRect(),t=s.width,j=G.style;return th(G),j.left=u.tx()+i+A+Cm,j.top=(B-s.height)/2+Cm,A+t}return J===Wd?T=Kj(e?Oq:Mn):J===il&&(T=Kj(e?il:Zb)),T?(H=Zo(T,L),Gf(R,T,i+H/2,c,L,u),i+=H,A+=H):e&&om(R,i-P/2,0,A+P,B,u.getSelectBackground(L)),h&&Gf(R,h,i+C/2,c,L,u),hl(R,r,_,K,i+C,0,0,B),A},validateImpl:function(){var f=this,R=f._canvas,c=f.getWidth(),A=f.getHeight(),P=f._30o,K=f._items;cs(R,c,A);var M=Rg(R),b=f._itemGap,h=b/2;id(M,f.tx(),0,1),M.clearRect(0,0,c,A);var E=f._90I;f._90I=new Vo,P.clear(),K.forEach(function(V){var j=f.drawItem(M,V,h,A);P.add({item:V,startX:h,endX:h+j,width:j}),j&&(h+=j+b)}),E.each(function(Y){f._90I.contains(Y)||Oi(Y)});var t=f._64I;f._64I=B(0,h-b/2),M.restore(),f._stickToRight?(f._65O=0,M=Rg(R),h=c-f._64I+b/2,id(M,0,0,1),M.clearRect(0,0,c,A),P.clear(),K.forEach(function(E){var T=f.drawItem(M,E,h,A,!0);P.add({item:E,startX:h,endX:h+T,width:T}),T&&(h+=T+b)}),M.restore()):f.tx(f.tx()),t!==f._64I&&f.onSumWidthChanged(t,f._64I)},onSumWidthChanged:function(){},handleClick:function(x,I){var Y=this,o=x.type,g=x.action,J=x.groupId,F=x.selected;x.disabled||(J!=U?F||(x.selected=!0,this._items.forEach(function(h){h.groupId===J&&x!==h&&(h.selected=!1)}),g&&x.action(x,Y,I)):o===il||"toggle"===o?(x.selected=!F,g&&x.action(x,Y,I)):g&&x.action(x,Y,I)),ho(),Y.iv()}});var Ft=function(P){this.tb=P,this.addListeners()};Bb(Ft,g,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(r){this.handleScroll(r,10*(r.wheelDelta/40))},handle_DOMMouseScroll:function(u){this.handleScroll(u,10*-u.detail)},handleScroll:function(g,q){Uh(g);var z=this.tb;z.isScrollable()&&!z._stickToRight&&(z.tx(z.tx()+q),fn())},handle_mousemove:function(i){var b=this;Sd||b.setItem(i)},handle_mouseout:function(G){var d=this;G.target===d.getView()?d.tb.setCurrentItem(U):d.handle_mousemove(G)},handle_mousedown:function(z){this.handle_mousemove(z),this.handle_touchstart(z)},handle_touchstart:function(R){var E=this,q=E.tb,k=R.target;dr(R)&&(k===E.getView()||k===q._canvas)&&(Uh(R),q.setFocus(R)&&(this.setItem(R,!0),(q.isScrollable()||E.info&&!E.info.item.disabled)&&(E.x=Ae(R).x,E.tx=q.tx(),Ir(E,R))))},handleWindowMouseMove:function(K){this.handleWindowTouchMove(K)},handleWindowTouchMove:function(U){var $=this,_=$.tb;if(!_._stickToRight){var H=Ae(U).x-$.x;!$._25o&&k(H)>2&&_.isScrollable()&&($._25o=1),$._25o&&_.tx($.tx+H)}},handleWindowMouseUp:function(x){this.handleWindowTouchEnd(x)},handleWindowTouchEnd:function(F){var O=this,j=O.tb,S=O.info,i=O.tb.getItemInfoAt(F);if(!O._25o&&S){var w=S.item;i&&i.item===w&&j.handleClick(w,F)}O._25o=O.x=O.tx=U,O.setItem()},setItem:function(w,v){var G=this,B=G.tb,I=G.info=w?B.getItemInfoAt(w):U,m=I?I.item:U;B.setCurrentItem(m),v&&m&&kk(m.onDown)&&m.onDown(w)}}),nt.BorderPane=function(){this._view=np(1,this),this.iv()},ot("BorderPane",g,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(q,j){this._12o("leftView",q),j!=U&&this.setLeftWidth(j)},getRightView:function(){return this._rightView},setRightView:function(n,J){this._12o("rightView",n),J!=U&&this.setRightWidth(J)},getTopView:function(){return this._topView},setTopView:function(T,B){this._12o("topView",T),B!=U&&this.setTopHeight(B)},getBottomView:function(){return this._bottomView},setBottomView:function(N,B){this._12o("bottomView",N),B!=U&&this.setBottomHeight(B)},getCenterView:function(){return this._centerView},setCenterView:function(V){this._12o("centerView",V)},_12o:function(b,M){var U=this,Y="_"+b,m=U._view,i=U[Y];i!==M&&(i&&(i.getView?Oi(i.getView()):Oi(i)),U[Y]=M,M&&(M.getView?zp(m,M.getView(),1):zp(m,M,1)),U.fp(b,i,M))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var K=this,y=K._topView,F=K._bottomView,Y=K._leftView,f=K._rightView,X=K._centerView,P=K.getWidth(),g=K.getHeight(),n=0,j=0,$=P,m=g,I=0,R=0,N=0,_=0;y&&(I=K._topHeight==U?zc(y):K._topHeight,j=I),F&&(R=K._bottomHeight==U?zc(F):K._bottomHeight,m=g-R),Y&&(N=K._leftWidth==U?Wj(Y):K._leftWidth,n=N),f&&(_=K._rightWidth==U?Wj(f):K._rightWidth,$=P-_);var E=B(0,$-n),D=B(0,m-j);y&&Gq(y,0,0,P,I),F&&Gq(F,0,m,P,R),Y&&Gq(Y,0,j,N,D),f&&Gq(f,$,j,_,D),X&&Gq(X,n,j,E,D)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);