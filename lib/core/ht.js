!function(q,z,s){"use strict";function H(n,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function");n.prototype=z.create(c&&c.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),c&&xl(n,c)}function G(X){var p=z.prototype.toString.call(X);return"Array]"===p.substring(p.length-6)}function j(N,j,V,D,S,i){j=j||[],V=V||[],D=D||[];try{j.push(N);var O=Function.apply(0,j);return V[V.length]="return "+O,Function.apply(0,V).apply(0,D)}catch(k){return i&&i(k),S}}function k(y){var v={};return{get:function(F){if(v[F]!==s)return v[F];var k;switch(F){case"WEBGL_depth_texture":k=y.getExtension("WEBGL_depth_texture")||y.getExtension("MOZ_WEBGL_depth_texture")||y.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":k=y.getExtension("EXT_texture_filter_anisotropic")||y.getExtension("MOZ_EXT_texture_filter_anisotropic")||y.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":k=y.getExtension("WEBGL_compressed_texture_s3tc")||y.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||y.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":k=y.getExtension("WEBGL_compressed_texture_pvrtc")||y.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":k=y.getExtension("WEBGL_compressed_texture_etc1");break;default:k=y.getExtension(F)}return v[F]=k,k}}}function t(C,B,R){function u(){if(p!==s)return p;var h=B.get("EXT_texture_filter_anisotropic");return p=null!==h?C.getParameter(h.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function X(u){if("highp"===u){if(C.getShaderPrecisionFormat(C.VERTEX_SHADER,C.HIGH_FLOAT).precision>0&&C.getShaderPrecisionFormat(C.FRAGMENT_SHADER,C.HIGH_FLOAT).precision>0)return"highp";u="mediump"}return"mediump"===u&&C.getShaderPrecisionFormat(C.VERTEX_SHADER,C.MEDIUM_FLOAT).precision>0&&C.getShaderPrecisionFormat(C.FRAGMENT_SHADER,C.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var p;R=R||{};var Z="undefined"!=typeof WebGL2RenderingContext&&C instanceof WebGL2RenderingContext,i=R.precision!==s?R.precision:"highp",E=X(i);E!==i&&(console.warn("WebGL:",i,"not supported, using",E,"instead."),i=E);var x=R.logarithmicDepthBuffer===!0,L=C.getParameter(C.MAX_TEXTURE_IMAGE_UNITS),l=C.getParameter(C.MAX_VERTEX_TEXTURE_IMAGE_UNITS),n=C.getParameter(C.MAX_TEXTURE_SIZE),_=C.getParameter(C.MAX_CUBE_MAP_TEXTURE_SIZE),J=C.getParameter(C.MAX_VERTEX_ATTRIBS),g=C.getParameter(C.MAX_VERTEX_UNIFORM_VECTORS),c=C.getParameter(C.MAX_VARYING_VECTORS),W=C.getParameter(C.MAX_FRAGMENT_UNIFORM_VECTORS),b=l>0,N=Z||!!B.get("OES_texture_float"),H=(Z||!!B.get("OES_element_index_uint"))&&"undefined"!=typeof Uint32Array,e=b&&N,P=Z?C.getParameter(C.MAX_SAMPLES):0;return{getMaxAnisotropy:u,getMaxPrecision:X,precision:i,logarithmicDepthBuffer:x,maxTextures:L,maxVertexTextures:l,maxTextureSize:n,maxCubemapSize:_,maxAttributes:J,maxVertexUniforms:g,maxVaryings:c,maxFragmentUniforms:W,vertexTextures:b,floatFragmentTextures:N,elementTypeUint:H,floatVertexTextures:e,maxSamples:P}}function O(N,a){return N.z!==a.z?a.z-N.z:N.id-a.id}var e="ht";if(!q[e]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),q.performance&&q.performance.now||function(){var K=Date.now();q.performance||(q.performance={}),q.performance.now=function(){return Date.now()-K}}();for(var k=Date.now(),c=16,y=["ms","moz","webkit","o"],D=0;D<y.length&&!q.requestAnimationFrame;++D)q.requestAnimationFrame=q[y[D]+"RequestAnimationFrame"],q.cancelAnimationFrame=q[y[D]+"CancelAnimationFrame"]||q[y[D]+"CancelRequestAnimationFrame"];q.requestAnimationFrame||(q.requestAnimationFrame=function(O){var v=Date.now(),K=c+k-v;return 0>K&&(K=0),k=v,q.setTimeout(function(){k=Date.now(),O(performance.now())},K)}),q.cancelAnimationFrame||(q.cancelAnimationFrame=function(s){return q.clearTimeout(s)}),z.assign===s&&(z.assign=function(c){if(c===s||null===c)throw new TypeError("Cannot convert undefined or null to object");for(var d=z(c),y=1;y<arguments.length;y++){var u=arguments[y];if(u!==s&&null!==u)for(var Q in u)z.prototype.hasOwnProperty.call(u,Q)&&(d[Q]=u[Q])}return d}),q.btoa===s&&(q.btoa=function(U){for(var x,F,l=String(U),i=0,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",b="";l.charAt(0|i)||(t="=",i%1);b+=t.charAt(63&x>>8-8*(i%1))){if(F=l.charCodeAt(i+=.75),F>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");x=x<<8|F}return b})}();var R,X,b,i,F=q.location,o=F&&q.document,g=null,E=s,U=q[e]={},D=q[e+"config"],p=U.Default=D&&D.Default||{},x=U.Style=D&&D.Style||{},M=U.Attr=D&&D.Attr||{},T=function(){return!0},h=function(){return!1},V=function(Q){return Q},d=function(U){return!U},u=U.Color=D&&D.Color||{},n=U.IsGetter=D&&D.IsGetter||{};!function(){var t=!1;try{var d=z.defineProperty({},"passive",{get:function(){return t=!0,s}});F&&(b=R=F)&&q.addEventListener("test",d,d),F&&(i=X=F)&&q.removeEventListener("test",d,d)}catch(E){t=!1}p.passiveSupported=t}();var f,v,I,S,c=p.passiveSupported,K=p.eventListenerOptionsFalse=c?{passive:!1,capture:!1}:!1,Y=p.eventListenerOptionsTrue=c?{passive:!1,capture:!0}:!0,C=function(v,x,k,N){v.addEventListener(x,k,N?Y:K)},J=function(s,F,A,m){s.removeEventListener(F,A,m?Y:K)},P=Math,A=P.round,l=P.floor,y=P.ceil,w=P.sqrt,N=P.max,Q=P.min,B=P.abs,W=P.cos,Z=P.acos,_=P.sin,r=P.pow,m=P.asin,$=P.exp,a=P.PI,L=2*a,zp=a/2,Zo=P.tan,xb=P.atan2,Eg=P.random,Ho=P.log,hk=function(x,M,v){return Math.max(M,Math.min(v,x))},dm=r(2,1),Zd=!1,vs=q.parseInt||global.parseInt,jr="2022-02-15",mn=F&&(q.navigator?q.navigator.platform.indexOf("Win")>-1:!1),ro=function(K){return K*K},yo=F&&q.setTimeout,pg=F&&q.clearTimeout,Hf=F&&(q.navigator?q.navigator.userAgent.toLowerCase():""),Sh=function(k){return k.test(Hf)},sd=Sh(/msie/),uc=Sh(/msie/)||Sh(/trident/),hd=Sh(/msie 10/),rg=Sh(/edge/),zf=Sh(/firefox/),lo=Sh(/mac/),Dp=Sh(/mscAndroid/),Pb=p.isTouchable===s?mn?!1:o?"ontouchend"in o:!1:p.isTouchable,Wh="default",hb="single",Bm="multiple",Mh="front",xc="back",Vn="left",qp="right",$l="top",ep="bottom",ii="center",_n="eye",Tj="middle",yq="east",cl="west",mq="north",km="none",zk="px",Ip="absolute",sp="border",ks="triangle",Em="rect",Dq="circle",tj="cylinder",pc="shape",cs="items",xo="normal",Lf="remove",rm="clear",Ap="width",Xk="height",qn="ingroup",fm="check",Qk="uncheck",ng="radio",Rn="radioOn",Zf="radioOff",tp="points",jl="values",pj="series",Hp="body",pp="label",rb="label2",zg="note",Zb="note2",mc="icons",ig="labelFont",We="labelColor",as="labelSelectColor",xk="note.expanded",Jl="note2.expanded",Ie="edge.expanded",sm="edge.points",Qj="edge.type",Mp="rotation",lb="hidden",ar="visible",ui="tuv",Tp="no",kr="draw",ph="select",zj="currentSubGraph",Lq="selectBackground",Nl="autoMakeVisible",re="autoHideScrollBar",qd="scrollBarColor",Uo="scrollBarSize",Ab="indent",ms="rowHeight",Jf="columnLineColor",xj="rowLineColor",ch="columnLineVisible",Dc="rowLineVisible",ci="visibleFunc",Hh="expandIcon",Vh="collapseIcon",Mq="checkMode",of="sortFunc",Xf="editable",lj="batchEditable",ne="tristate",Oc="asc",Hr="desc",kh="position",ck="__",rn="elevation",Xr="children",Sj="translateX",Hq="translateY",Mi="dataModel",Vq="maxSize",Wk="enc",bc="state",sg=Wk+"o"+"de",wq="shape3d",Ol="shape3d.resolution",ok="shape3d.visible",xh="shape3d.from.visible",fc="shape3d.to.visible",Dn="shape3d.top.visible",Mo="shape3d.bottom.visible",xf="repeat.uv.length",Hl="serializeValue",db="deserializeValue",pq="centerUniform",mo="uniform",ye="rgba(255,255,255,0)",em="style",Fg="attr",jh="field",rs="string",Bk="boolean",ml="color",Bh="int",Tq="number",Nk="ew-resize",jb="ns-resize",fg="pointer",hf="auto",Ke="mousedown",Xm="mousemove",xp="mouseup",oc="mouseout",bi="touchstart",Jb="touchmove",Xi="touchend",Rk="keydown",Yo="keyup",Gq=["DOMMouseScroll","mousewheel"],Wj=zf?Gq[0]:Gq[1],Nr=ck+e+ck+sg,xg=[bi,Jb,Xi],Dh=[Ke,Xm,xp,oc,Wj,"wheel","mouseenter","mouseleave","mouseover"],ip=[Rk,Yo,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],Rm=Pb?xg.concat(ip):Dh.concat(ip),np=g,mh=g,eg=g,Gb=g,Ag=!1,wr=xp.length,_b=function(){eg&&(pg(eg.timeout),eg=g)},gl=function(){eg&&zr(eg.e,eg.info)};q.addEventListener&&(E=F)&&(Pb||(C(q,oc,function(){_b()}),C(q,Wj,function(){Pm()})),C(q,Yo,function(t){91===t.keyCode?Xd={}:delete Xd[t.keyCode]},!0),C(q,Rk,function(G){Xd[G.keyCode]=!0},!0),C(q,"blur",function(){Xd={}}));var Kk,_o,Xc,cf=0,Ih=g,Nj=function(l,x){var z=yo(function(){delete Ih[z],Lg(Ih)&&(Ih=g),l()},x);return z},sh=g,Ko=g,$b={},Dr={},Fb={},ps={},bm={},Xd={},Zi={},Zn={},Wr={},nh={},mj=/.json$/,nc=/\.(json|bin)$/,Mk=/^data:image\/svg\+xml/,gg={},Id=[],pr={},cq=g,ee=g,Yd=function(){},tb=function(){throw"Oops!"},He=[0,0,0],Pf={x:0,y:0,width:0,height:0},bf=g,jd=g,Pe=g,xs=function(r,x){Dr[r]=x,x&&x.comps&&!x.uuid&&(x.uuid=U.Math.generateUUID()),ce[r]&&(x.cacheRule=ce[r],delete ce[r])},qc=function(F){jd&&!F._72O&&(Pe||(Pe={}),Pe[F._72O=qi()]=F),Kk!=g?xq()<.05&&S&&!_o&&(Bl=_b):Bl=Tg},Ef=function(V,$,x,G){jd||(jd={});var s=jd[V];if(s){if(s.url===$)return;s.image?(s.image.onload=Yd,s.image.onerror=Yd):s.request&&(s.request.onload=Yd,s.request.onerror=Yd)}if(mj.test($)){var O=new _i;if(jd[V]={request:O,url:$},$=p.beforeLoadURL($,V),$.data){var i=p.parse($.data);nn(V,i),p.handleImageLoaded(V,i)}else{O.onload=function(){if(200===this.status||0===this.status){var d=p.parse(O.getResponseText());nn(V,d),p.handleImageLoaded(V,d)}else nn(V,p.handleUnfoundImage(V,$)||g)},O.onerror=function(){nn(V,p.handleUnfoundImage(V,$)||g)};var l={};l.url=encodeURI($),l.sync=!1,O.send(l)}}else{var i=new Image;jd[V]={image:i,url:$},/^data:image/.test($)||($=p.beforeLoadURL($,V),$=p.appendTimeStamp($),$=encodeURI($),i.crossOrigin=p.crossOrigin),p.convertImageSrc($,function(E){uc&&($.toLowerCase().indexOf(".svg")>0||Mk.test($))?(o.body.appendChild(i),i.style.visibility="hidden",i.onload=function(){yo(function(){if(x&&(i.width=x),G&&(i.height=G),!i.width||!i.height){var c=i.width||i.clientWidth,L=i.height||i.clientHeight;i.width=c,i.height=L}p.handleImageLoaded(V,i),nn(V,i),o.body.removeChild(i),i.style.visibility=""},180)},i.onerror=function(){nn(V,p.handleUnfoundImage(V,$)||g),o.body.removeChild(i),i.style.visibility=""}):(i.onload=function(){x&&(i.width=x),G&&(i.height=G),p.handleImageLoaded(V,i),nn(V,i)},i.onerror=function(){nn(V,p.handleUnfoundImage(V,$)||g)}),i.src=E})}},nn=function(E,r){if(xs(E,r),delete jd[E],Lg(jd)&&(jd=g,Pe)){for(var A in Pe){var S=Pe[A];S._2O&&S._2O[E]&&(S.deleteTexture(E),delete S._2O[E]),S.invalidateAll&&S.invalidateAll(s,"imageLoaded",E),S.redraw&&S.redraw(),S.iv(),r&&r.layoutAttach&&qr(S.dm)&&S.dm().updateLayoutAttach(E),delete S._72O}Pe=g}if(r&&Pe)for(var A in Pe){var S=Pe[A];S.invalidateAll&&S.invalidateAll(s,"imageLoading",E),S.redraw&&S.redraw(),S.iv(),r.layoutAttach&&qr(S.dm)&&S.dm().updateLayoutAttach(E)}},rp=function(){return Ho=P&&Date,function(){return q.performance&&q.performance.now?q.performance.now():Date.now()}}(),pm=function(w,a,g){return{width:w,height:a,comps:Vd(g)?g:[g]}},Fl=function(U,B){return{type:Dq,rect:[U,B,1.6,1.6],borderWidth:1,borderColor:hi,gradient:zh,gradientColor:go,background:hi}},er=function(I,D){return pm(16,16,{type:ks,rect:[4,4,10,8],background:I,rotation:D?1.57:3.14})},Cd=function(n,L){return pm(16,16,{type:ks,rect:[4,4,8,7],background:n,rotation:L?3.14:0})},io=function(_){var x=_._orientation;return"horizontal"===x||"h"===x},Cr=function(k,t){var P=g||4,f=g||1,J=g||1;0>P?P=0:P>.25&&(P=.25);var l,O,E,u,z,R,h,i=.5,V=[],A=[],U=[],s=L/J,T=L/f,N=i-P;for(O=0;f>=O;O++)for(u=-a+O*T,R=W(u),z=_(u),l=0;J>=l;l++)E=l*s,h=N+P*R,V.push(W(E)*h,z*P,-_(E)*h),(v=[k,t])&&A.push(l/J,1-O/f);for(O=0;f>O;O++){var d=O*(J+1),S=(O+1)*(J+1);for(l=0;J>l;l++)U.push(d+l,S+l+1,S+l,d+l,d+l+1,S+l+1),Lp.z=Te.z=[k,t]}},Vm=function(D){var N=2,U=0;for(var T in D)T.length===N&&vs(T,32)===Ij&&(cq=ee=D[T]),U++;return U},Ii=function(o,d,l,X){return l||(l=Pb?5:3,l/=X||1),{x:o-l,y:d-l,width:2*l,height:2*l}},Vo=function(j,w,N,S){var h=this;w||(w=Pb?5:3,N=20,S=20);var e={x:j,y:w,width:N,height:S};if(N)for(var n=0;N>n;n++)if(3===N)S=20;else for(var X=0;S>X;X++)h=q?q:N;var T={x:a,y:2*a};if(vb(e,T)){var P=Xk[0]+$l[0]+rm[1]+Oc.length,Z=lb[0]+ne[0]+rm[1]+Hp.length;gd[_n]=[h[P],h[Z]],h[P]=mp[_n],h[Z]=mp[wq]}},wd=function(x){return(/ble$/.test(x)||/ed$/.test(x)||n[x]?"is":"get")+x.charAt(0).toUpperCase()+x.slice(1)},mp=function(a){return"set"+a.charAt(0).toUpperCase()+a.slice(1)},Xj=function(x){return typeof x===rs||x instanceof String},Jr=function(B){return typeof B===Tq},Tg=function(t){return typeof t===Bk},Np=function(r){return r&&"object"==typeof r},qr=function(m){return"function"==typeof m},Vd=function(K){return K instanceof Array},Qq=function(M){return M instanceof Yn},Je=function(I){return Vd(I)?new Yn(I):I},Ob=function(j){return j instanceof rk},hg=function(L){return L instanceof dj},Mn=function(R){return R instanceof Ir},ve=function(K,c){if(!(K instanceof U.Group))return!1;if(!c)return K.isExpanded();var B=c.getDataUI(K);return B&&B._88I?!0:!1},pi=function(v){return v instanceof vc},wo=function(N){return N&&"IFRAME"===N.tagName},Xe=function(q){return q==g||p.numberDigits==g?q:parseFloat(q.toFixed(p.numberDigits))},sb=function(E,e,V){var W,d=e.length;if(V)for(var y=0;V>y;y++)if(3===d)E.push(e[0]),E.push(e[1]),E.push(e[2]);else for(W=0;d>W;W++)E.push(e[W]);else if(3===d)E.push(e[0]),E.push(e[1]),E.push(e[2]);else for(W=0;d>W;W++)E.push(e[W])},sj=function(e){return e?Np(e)?e:{}:!1},oi=function(t,j,b){var i,f=Np(t)?t:t.prototype;for(i in j)b&&i in f?f[i]===s&&console.warn("class",f,"has own undefined property",i,", keep exist!"):f[i]=j[i];return t},Hi=function(D,L){if(!("wheelDelta"in L)){var Y=L.deltaMode;L.wheelDelta=Y===L.DOM_DELTA_PIXEL?-L.deltaY:Y===L.DOM_DELTA_LINE?40*-L.deltaY:120*-L.deltaY}D.handle_mousewheel(L)},Yk=function(f){return String.fromCharCode(f)},yj=function(Z){for(var i,A=0,k="";A<Z.length;A++)i=Z[Z.length-1-A],"%"===i?i="'":"a"===i?i='"':"]"===i&&(i="\\"),k+=Yk(i.charCodeAt(0)-1);return k},$e=function(H,Y,h){H.superClass.constructor.apply(Y,h)},Lg=function(N){for(var l in N)return!1;return!0},ld=function(i){return i?0===i.length:!0},Yl=function(){var p="";return[Qk[0],xj[0],pp[0]].forEach(function($){p+=mp($).slice(3)}),mo=o&&o[p]||pq,function(l,k){return l===k?!0:l.x===k.x&&l.y===k.y&&l.width===k.width&&l.height===k.height}}(),ir=function(G,E,a){return E>G?E:G>a?a:G},Mr=function(y){return 0>y?-1:y>0?1:0},xq=function(){var Y=1e4*_(wr++);return Y-l(Y)},Sp=function(D,I,_){return Zh(D.x,D.y,I.x,I.y,_.x,_.y,_.x+_.width,_.y,!0)||Zh(D.x,D.y,I.x,I.y,_.x+_.width,_.y,_.x+_.width,_.y+_.height,!0)||Zh(D.x,D.y,I.x,I.y,_.x+_.width,_.y+_.height,_.x,_.y+_.height,!0)||Zh(D.x,D.y,I.x,I.y,_.x,_.y+_.height,_.x,_.y,!0)},Zh=function(R,E,_,y,L,F,d,W,e){var C=(d-L)*(E-F)-(W-F)*(R-L),D=(W-F)*(_-R)-(d-L)*(y-E);if(0!==D){var h=C/D,V=R+h*(_-R),x=E+h*(y-E);return e&&(V+bn<Q(R,_)||V-bn>N(R,_)||V+bn<Q(L,d)||V-bn>N(L,d)||x+bn<Q(E,y)||x-bn>N(E,y)||x+bn<Q(F,W)||x-bn>N(F,W))?g:[V,x]}return g},$g=function(V,y,g){if(V&&g)if(y){if(y===em)return V.getStyle(g);if(y===Fg)return V.getAttr(g);if(y===jh)return V[g]}else if(g=wd(g),V[g])return V[g]();return s},To=function(o,E,C,G){if(o&&C)if(E){if(E===em)o.s(C,G);else if(E===Fg)o.a(C,G);else if(E===jh){var x=o[C];o[C]=G,o.fp("f:"+C,x,G)}}else C=mp(C),o[C]&&o[C](G)},sq=function(G,O,o){var Z=100*Math.max(G.width,G.height);return O&&"top"!==O?"bottom"===O?{x:G.x-Z,y:G.y-Z,width:G.width+2*Z,height:G.height*o+Z}:"right"===O?{x:G.x-Z,y:G.y-Z,width:G.width*o+Z,height:G.height+2*Z}:"left"===O?{x:G.x+G.width*(1-o),y:G.y-Z,width:G.width*o+Z,height:G.height+2*Z}:void 0:{x:G.x-Z,y:G.y+G.height*(1-o),width:G.width+2*Z,height:G.height*o+Z}},Tm=function(E,F,V,j,w){F&&lc(E,V,j,1,w,F)},Xq=function(P,S,m,M){var H=1-P;return H*H*S+2*P*H*m+P*P*M},Lp=function(H,c,t,X,e){var U=1-H;return U*U*U*c+3*U*U*H*t+3*U*H*H*X+H*H*H*e},ud=function(Z){var O,I,k,i,w=0;return Z.forEach(function(X){if(O=X.length,O>0)for(I=X[0],i=1;O>i;i++)k=X[i],w+=lr(I,k),I=k}),w},Xb=function(E,_,f){var j="__"+E,k=function(S){("mousedown"===E||"mouseup"===E||"touchstart"===E||"touchend"===E)&&Sf(S),f.disabled||f["handle_"+E](S)};f[j]||(f[j]=k,C(_,E,k))},Bs=function(C,Y,V){var c="__"+C,R=V[c];R&&(J(Y,C,R),delete V[c])},Om=function(b,G){var Z="_"+G;b[wd(G)]=function(){return this[Z]},b[mp(G)]=function(l){var i=this[Z];this[Z]=l,this.fp(G,i,l)}},zn=function(W){return z.create(W)},Ff=function(W){if(!W.element){var c,u;(c=W.textField)?u=Op(xt.TextField,c):(c=W.textArea)?u=Op(xt.TextArea,c):(c=W.button)?u=Op(xt.Button,c):(c=W.comboBox)?u=Op(xt.ComboBox,c):(c=W.checkBox)?u=Op(xt.CheckBox,c):(c=W.radioButton)?u=Op(xt.RadioButton,c):(c=W.slider)?u=Op(xt.Slider,c):(c=W.colorPicker)?u=Op(xt.ColorPicker,c):(c=W.image)&&(u=Op(xt.Image,c)),u&&(W.element=u)}},_f=function(Q,e){var s=lp(Q);return s._ht=e,s},As=q.top===q?q.top:q||q.document,lp=function(c,G){var b=o.createElement("div"),K=b.style;return b.tabIndex=-1,b.onkeydown=fk,K.msTouchAction=km,rq(b,g,0),Pb&&K.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",g),c&&(K.overflow=lb),G&&ib(G,b),b},gj=function(A,h){var T=o.createElement("canvas"),d=T.style;return d.msTouchAction=km,h||(d.pointerEvents=km),rq(T,g,0),A&&ib(A,T),T},rq=function(B,v,J){var O=B.style;O.border=v?v+" solid 1px":0,O.outline=0,O.padding=J?"0 "+J+zk:0,Ym(B)},Ym=function(M){var G=M.style;G.position=Ip,G.margin=0,G.setProperty("box-sizing","border-box",g),G.setProperty("-moz-box-sizing","border-box",g)},Df=function(v,t,u,P){P||(P=Kn),t!=g&&(v.width=t*P,v.style.width=t+zk),u!=g&&(v.height=u*P,v.style.height=u+zk)},ib=function(Q,j,m){Q.appendChild(j),m&&(j.style.position=Ip)},uf=function(k,P){P.split||(P+="");for(var x,$=P.split("\n"),o=0,z=$.length,b=0;z>b;b++){var r=Lr(k.font,$[b]);r.width>o&&(o=r.width),x||(x=r.height)}return k.ss=$,{width:o,height:x*z}},ql=function(){var r=o?gj().getContext("2d"):g;return function(j,I,d,M,c,u){var W=j.split("\n"),S=[];return M||(M=0),r.font=d,r.textBaseline=$l,W.forEach(function(x){for(var G=0,g=1,H=0,Y=x.length;Y>=g;g++){var i=x.substring(G,g),E=c?r.measureText(x[g]):Lr(d,i);c&&(H+=E.fontBoundingBoxDescent);var l=c?H+(i.length-1)*u:E.width+(i.length-1)*M;l>I&&(g-1===G?(S.push(x.substring(G,g)),G=g):(S.push(x.substring(G,g-1)),G=g-1,g--),H=0)}G!==g-1&&S.push(x.substring(G,g))}),S}}(),Vi=function(S,H,p,J,k,s,L,K){S.font=p;var W=S.measureText(H);S.beginPath(),S.strokeStyle=J,S.lineWidth=1,"underline"===K?(S.moveTo(k-L/2,s+W.actualBoundingBoxDescent+1),S.lineTo(k+L/2,s+W.actualBoundingBoxDescent+1)):"strikethrough"===K?(S.moveTo(k-L/2,s),S.lineTo(k+L/2,s)):"overline"===K&&(S.moveTo(k-L/2,s-W.fontBoundingBoxAscent),S.lineTo(k+L/2,s-W.fontBoundingBoxAscent)),S.stroke()},Wp=function(W,$,R,z,w,S,P,n,F,k,q){var l=w.x,Z=w.y,J=w.width,B=w.height;if($!=g){var C=Lr(R,$),x={};F&&(C.width+=($.length-1)*F),x.y=P&&P!==Tj?P===$l?Z+C.height/2:Z+B-C.height/2:Z+B/2,x.x=S&&S!==Vn?S===qp?l+J-C.width/2:l+J/2:l+C.width/2,Xp(W,$,x,R,z,F,k,q),n&&Vi(W,$,R,z,x.x,x.y,C.width,n)}},qo=function(b,e,v,L,T,x,$,G,g,M){var P=e.length;if(1===P){var j=e[0];if(Xp(b,j,v,L,T,G,g,M),$){var d=Lr(L,j);Vi(b,j,L,T,v.x+v.width/2,v.y+v.height/2,d.width,$)}}else for(var D=v.height/P,J={x:v.x,y:v.y,width:v.width,height:D},K=0;K<e.length;K++){if(x)Wp(b,e[K],L,T,J,x,null,$,G,g,M);else if(Xp(b,e[K],J,L,T,G,g,M),$){var d=Lr(L,e[K]);Vi(b,e[K],L,T,J.x+J.width/2,J.y+J.height/2,d.width,$)}J.y+=D}},Xp=function(l,N,x,h,v,b,I,R){l.font=h?h:zq,l.fillStyle=v?v:Lm,l.textAlign=ii,l.textBaseline=Tj;var P,i;x?x.width===s?(P=x.x,i=x.y):(P=x.x+x.width/2,i=x.y+x.height/2):(P=0,i=0);var Q=I&&R;if(Q&&(l.strokeStyle=R,l.lineWidth=I),b){var E=Lr(h,N);P-=(E.width+b*(N.length-1))/2;for(var w=(N+"").length,Z=0;w>Z;Z++){var M=N[Z],u=l.measureText(M);Q&&l.strokeText(M,A(P+(u.width+4)/2),A(i)),l.fillText(M,A(P+(u.width+4)/2),A(i)),P+=u.width+b}}else Q&&l.strokeText(N,A(P),A(i)),l.fillText(N,A(P),A(i))},dr=function(w){w.getView&&(w=w.getView());var s=w.offsetWidth||w.scrollWidth;return!s&&w.style.width&&(s=vs(w.style.width)),s},ri=function(x){x.getView&&(x=x.getView());var l=x.offsetHeight||x.scrollHeight;return!l&&x.style.height&&(l=vs(x.style.height)),l},Qp=function(N,B,t){var G=B[0].toUpperCase()+B.substring(1,B.length);N["webkit"+G]=t,N["moz"+G]=t,N["ms"+G]=t,N["o"+G]=t,N[B]=t},Jm=function(){var T=function(o){fk(o),o.stopPropagation()},l=function(T){fk(T)},x=[bi,Rk,Ke];return function(Z,A){var o=lp(),H=o.style;return H.backgroundColor=p.disabledBackground,Z&&(H.backgroundImage="url("+Z+")",H.backgroundPosition="50% 50%",H.backgroundRepeat="no-repeat no-repeat"),A===!1?x.forEach(function(E){C(o,E,l)}):x.forEach(function(v){C(o,v,T)}),o}}(),Rl=function(i){var P=i.getContext("2d");return P.save(),P.lineCap=rj,P.lineJoin=yf,P},Bl=function(k,m,w,h){bs(k,m*Kn,w*Kn),h*=Kn,1!==h&&k.scale(h,h)},bs=function(j,V,v){j.translate(V,v)},no=function(o,l){l&&o.rotate(l)},Po=function(x,O,w){O===s&&(O=1),w===s&&(w=1),(1!==O||1!==w)&&x.scale(O,w)},Wn=!1,$=As[fm[1]+Sj[0]],jf=function(V){var r=o.activeElement;if(o.activeElement!==V){r&&r.forceOnblur&&r.forceOnblur();for(var d=[],p=V.parentNode;p;)d.push([p,p.scrollLeft,p.scrollTop]),p=p.parentNode;if(!Wn){var E=[],W=[];try{for(var u=q.parent,b=q;u!==b;)E.push([u,u.scrollX,u.scrollY]),b=u,u=q.parent;var c=q.frameElement;if(c)for(var x=c.parentNode;x;)W.push([x,x.scrollLeft,x.scrollTop]),x=x.parentNode}catch(l){Wn=!0}}if(Pb)V.focus();else{var T=mr(),A=T.target;V.focus(),A.scrollLeft=T.left,A.scrollTop=T.top}d.forEach(function(Z){Z[0].scrollLeft=Z[1],Z[0].scrollTop=Z[2]}),Wn||(E.forEach(function(E){E[0].scrollTo(E[1],E[2])}),W.forEach(function(w){w[0].scrollLeft=w[1],w[0].scrollTop=w[2]}))}},yh=function(P){return P&&P.getView?P.getView():P},Iq=function(a,m,f,g,j){if(2===arguments.length&&(f=m.y,g=m.width,j=m.height,m=m.x),a.isSelfViewEvent)a.setX(m),a.setY(f),a.setWidth(g),a.setHeight(j);else{var M=yh(a),D=M.style;if((o.fullscreenElement||o.mozFullScreenElement||o.webkitFullscreenElement||o.msFullscreenElement)!==M)m!==s&&(D.left=m+zk),f!==s&&(D.top=f+zk),g!==s&&(D.width=g+zk),j!==s&&(D.height=j+zk);else{var B=p.getWindowInfo();D.left=(m=B.left)+zk,D.top=(f=B.top)+zk,D.width=(g=B.width)+zk,D.height=(j=B.height)+zk}a.endEditing&&!Pb&&a.endEditing(),a.redraw&&a.redraw(),a.invalidate&&a.invalidate(),a.onLayouted&&a.onLayouted(m,f,g,j),a.fireViewEvent&&a.fireViewEvent("layout")}},$m=function(F){if(!F.touches)return F;var Z=F.touches[0];return Z?Z:F.changedTouches[0]},fh=function(l){return jc(l)?$m(l).target:l.target},jc=function(P){return P&&"object"==typeof P&&"touches"in P},mf=function(q){p.popup&&p.popup.close(),p.popup=q},Fe=g,nb=function(_){Fe.handleWindowTouchMove(_)},Ic=function(e){Fe.handleWindowTouchEnd(e),J(q,Jb,nb),J(q,Xi,Ic),J(q,"blur",Ic),Fe=g},Gf=function(M){Fe.handleWindowMouseMove(M)},pn=function(T){Fe.handleWindowMouseUp(T),J(q,Xm,Gf),J(q,xp,pn),J(q,"blur",pn),Fe=g},kk=function(i){return 1===ns(i)},Td=function($,a){return a?a.keyCode===$:Xd[$]},om=function(i){return wc(i)&&Td(65,i)},Lk=function(k){return Td(46,k)||Td(8,k)},uh=function(V){return function(F){return F?F.keyCode===V:Xd[V]}},Ij=573,bp=[65,83,68,87,37,38,39,40,32,13,27],Cg=uh(bp[0]),Pd=uh(bp[1]),bk=uh(bp[2]),je=uh(bp[3]),qh=uh(bp[4]),ol=uh(bp[5]),Nf=uh(bp[6]),lg=uh(bp[7]),Wc=uh(bp[8]),Um=uh(bp[9]),Pi=uh(bp[10]),wp={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Cc=[2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,5,5,5,5,5,19,167],tk=g,Ub=g,Wb=function(R,C){tk||(tk=gj()),Df(tk,R,C,1);var e=Rl(tk);return e.clearRect(0,0,R,C),e},Nb=function(s,y,H){if(y&&s){if("override"===H)return y;if("override_rgb"===H){var E=Jj(y);return s=kl(s),"rgba("+A(255*E[0])+","+A(255*E[1])+","+A(255*E[2])+","+s[3]/255+")"}if("override_a"===H){var E=Jj(y);return s=kl(s),"rgba("+s[0]+","+s[1]+","+s[2]+","+E[3]+")"}if("multiply_destinationAtop"===H){var m=Wi(Jj(s)),u=m[3],_=Wi(Jj(y)),V=_[3],q=Wi(m),e=q[3],L=m.map(function(f,Q){return f*_[Q]}),a=1-u,I=1-V,j=I*u+V;return m=m.map(function(P,q){return(V*a*_[q]+V*u*L[q]+I*u*P)/j}),u=j,a=1-u,m=m.map(function(A,F){return(e*q[F]*a+u*A*e)/e}),u=e,"rgba("+A(255*m[0])+","+A(255*m[1])+","+A(255*m[2])+","+u+")"}var E=Jj(y);return s=kl(s),"rgba("+A(s[0]*E[0])+","+A(s[1]*E[1])+","+A(s[2]*E[2])+","+s[3]/255*E[3]+")"}return s},kl=function(){var F,u={};for(var J in q){var S=Bm.length;if(J.length==S&&J[0]===Bm[2]&&J[1]===km[1]&&J[4]===Bm[3]&&J[5]===Bm[4]&&J.substr(S-2)===km[1]+km[2]){var o=q[J];for(var $ in o)$.length===S&&$.substr(0,3)===qp[3]+Lf[3]+ph[0]&&$.substr(S-2)===Bm[0]+zg[3]&&(Gq=o[$])}}return function(e){var B,C=u[e];return C||(F||(F=gj(),Df(F,1,1,1)),B=F.getContext("2d"),B.clearRect(0,0,1,1),lc(B,0,0,1,1,e),C=B.getImageData(0,0,1,1).data,C=u[e]=[C[0],C[1],C[2],C[3]]),C}}(),Jj=function(l){if(!Xj(l))return l;var M=kl(l);return M.CA||(M.CA=[M[0]/255,M[1]/255,M[2]/255,M[3]/255]),M.CA},Ce=function(O,l,H,y,Q){var E=gj();E.width=H,E.height=y;var o=E.getContext("2d");o.drawImage(O,0,0,H,y);try{for(var e=o.getImageData(0,0,H,y),c=e.data,v=0,Y=c.length;Y>v;v+=4){var k=c[v+0],$=c[v+1],r=c[v+2],W=c[v+3];"override_a"===Q?c[v+3]=255*l[3]:"override_rgb"===Q?(c[v+0]=255*l[0],c[v+1]=255*l[1],c[v+2]=255*l[2]):"override"===Q?(c[v+0]=255*l[0],c[v+1]=255*l[1],c[v+2]=255*l[2],c[v+3]=255*l[3]):(c[v+0]=l[0]*k,c[v+1]=l[1]*$,c[v+2]=l[2]*r,c[v+3]=l[3]*W)}o.putImageData(e,0,0)}catch(X){return O}return E},gd=function(K,G,T){return G&&(G="miter"===T?8*G+20:G+1,K&&ff(K,G)),G},Wm=function(b,X){if(X){var s=new Tc(X),i=b.width/2,v=b.height/2,A=In([s.tf(-i,-v),s.tf(i,-v),s.tf(i,v),s.tf(-i,v)]);return A.x+=b.x+i,A.y+=b.y+v,A}return b},Bo=function(b,Z,u,Q,A,w,x,M){Q*=Math.PI/180;var B={x:Math.cos(Q)*(b.x-x.x)/2+Math.sin(Q)*(b.y-x.y)/2,y:-Math.sin(Q)*(b.x-x.x)/2+Math.cos(Q)*(b.y-x.y)/2},r=Math.pow(B.x,2)/Math.pow(Z,2)+Math.pow(B.y,2)/Math.pow(u,2);r>1&&(Z*=Math.sqrt(r),u*=Math.sqrt(r));var o=(A==w?-1:1)*Math.sqrt((Math.pow(Z,2)*Math.pow(u,2)-Math.pow(Z,2)*Math.pow(B.y,2)-Math.pow(u,2)*Math.pow(B.x,2))/(Math.pow(Z,2)*Math.pow(B.y,2)+Math.pow(u,2)*Math.pow(B.x,2)));isNaN(o)&&(o=0);var U={x:o*Z*B.y/u,y:o*-u*B.x/Z},I={x:(b.x+x.x)/2+Math.cos(Q)*U.x-Math.sin(Q)*U.y,y:(b.y+x.y)/2+Math.sin(Q)*U.x+Math.cos(Q)*U.y},J=function(o){return Math.sqrt(Math.pow(o[0],2)+Math.pow(o[1],2))},R=function(r,m){return(r[0]*m[0]+r[1]*m[1])/(J(r)*J(m))},f=function(V,Q){return(V[0]*Q[1]<V[1]*Q[0]?-1:1)*Math.acos(R(V,Q))},N=f([1,0],[(B.x-U.x)/Z,(B.y-U.y)/u]),i=[(B.x-U.x)/Z,(B.y-U.y)/u],t=[(-B.x-U.x)/Z,(-B.y-U.y)/u],Y=f(i,t);R(i,t)<=-1&&(Y=Math.PI),R(i,t)>=1&&(Y=0);var R=Z>u?Z:u,K=Z>u?1:Z/u,H=Z>u?u/Z:1;if(null==M){var k={x:0,y:0,width:0,height:0};ff(k,R),k.x*=K,k.width*=K,k.y*=H,k.height*=H;var X=new Tc(Q);return k=In([X.tf(k.x,k.y),X.tf(k.x+k.width,k.y),X.tf(k.x+k.width,k.y+k.height),X.tf(k.x,k.y+k.height)]),k.x+=I.x,k.y+=I.y,[{x:k.x,y:k.y},{x:k.x+k.width,y:k.y},{x:k.x+k.width,y:k.y+k.height},{x:k.x,y:k.y+k.height}]}M.translate(I.x,I.y),M.rotate(Q),M.scale(K,H),M.arc(0,0,R,N,N+Y,1-w),M.scale(1/K,1/H),M.rotate(-Q),M.translate(-I.x,-I.y)},dn=function(B,w){B&&B.beginPath();for(var Y,I,S,u=[],M=function(Q){for(var w,D=/(\-{0,1}[\d\.]+)/gi,C=[];w=D.exec(Q);)C.push(parseFloat(w[0]));return C},$=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,W={x:0,y:0};Y=$.exec(w);){var T=Y[0],j=T.substr(0,1);if("M"===j||"m"===j){for(var D=M(T),X=0;X<D.length;X+=2){var d=D[X],x=D[X+1];"m"===j&&(d+=W.x,x+=W.y),B&&B.moveTo(d,x),u.push({x:d,y:x}),W.x=d,W.y=x}I=S=null}else if("H"===j||"h"===j){for(var D=M(T),X=0;X<D.length;X+=1){var d=D[X];"h"===j&&(d+=W.x),B&&B.lineTo(d,W.y),u.push({x:d,y:W.y}),W.x=d}I=S=null}else if("C"===j||"c"===j){for(var D=M(T),X=0;X<D.length;X+=6){var r=D[X],v=D[X+1],V=D[X+2],L=D[X+3],d=D[X+4],x=D[X+5];"c"===j&&(r+=W.x,v+=W.y,V+=W.x,L+=W.y,d+=W.x,x+=W.y),B&&B.bezierCurveTo(r,v,V,L,d,x),u.push({x:r,y:v}),u.push({x:V,y:L}),u.push({x:d,y:x}),W.x=d,W.y=x}I=[r,v,V,L,d,x],S=null}else if("S"===j||"s"===j){for(var D=M(T),X=0;X<D.length;X+=4){var r,v;I?(r=2*I[4]-I[2],v=2*I[5]-I[3]):(r=W.x,v=W.y);var V=D[X],L=D[X+1],d=D[X+2],x=D[X+3];"s"===j&&(V+=W.x,L+=W.y,d+=W.x,x+=W.y),B&&B.bezierCurveTo(r,v,V,L,d,x),u.push({x:r,y:v}),u.push({x:V,y:L}),u.push({x:d,y:x}),W.x=d,W.y=x}I=[r,v,V,L,d,x],S=null}else if("Q"===j||"q"===j){for(var D=M(T),X=0;X<D.length;X+=4){var r=D[X],v=D[X+1],d=D[X+2],x=D[X+3];"q"===j&&(r+=W.x,v+=W.y,d+=W.x,x+=W.y),B&&B.quadraticCurveTo(r,v,d,x),u.push({x:r,y:v}),u.push({x:d,y:x}),W.x=d,W.y=x}I=null,S=[r,v,d,x]}else if("T"===j||"t"===j){for(var D=M(T),X=0;X<D.length;X+=2){var r,v;S?(r=2*S[2]-S[0],v=2*S[3]-S[1]):(r=W.x,v=W.y);var d=D[X],x=D[X+1];"t"===j&&(d+=W.x,x+=W.y),B&&B.quadraticCurveTo(r,v,d,x),u.push({x:r,y:v}),u.push({x:d,y:x}),W.x=d,W.y=x}I=null,S=[r,v,d,x]}else if("V"===j||"v"===j){for(var D=M(T),X=0;X<D.length;X+=1){var x=D[X];"v"===j&&(x+=W.y),B&&B.lineTo(W.x,x),u.push({x:W.x,y:x}),W.y=x}I=S=null}else if("L"===j||"l"===j){for(var D=M(T),X=0;X<D.length;X+=2){var d=D[X],x=D[X+1];"l"===j&&(d+=W.x,x+=W.y),B&&B.lineTo(d,x),u.push({x:d,y:x}),W.x=d,W.y=x}I=S=null}else if("A"===j||"a"===j){for(var D=M(T),X=0;X<D.length;X+=7){var Z=D[X],s=D[X+1],p=D[X+2],t=D[X+3],m=D[X+4],d=D[X+5],x=D[X+6];"a"===j&&(d+=W.x,x+=W.y);var g=Bo(W,Z,s,p,t,m,{x:d,y:x},B);g&&(u=u.concat(g)),W.x=d,W.y=x}I=S=null}var A=T.substr(T.length-1);("z"===A||"Z"===A)&&B&&B.closePath()}return u},wl=function(T,s,i,O,y){var l,R=s[0];if(T.save(),Vd(s))if(R&&1===R.length){var C,P="L"===s[0],F=s.length;P?(T.transform(s[5],s[6],s[7],s[8],s[9],s[10]),l=T.createLinearGradient(s[1],s[2],s[3],s[4]),C=11):(T.transform(s[7],s[8],s[9],s[10],s[11],s[12]),l=T.createRadialGradient(s[1],s[2],s[3],s[4],s[5],s[6]),C=13);for(var v=T.compGray;F>C;){var j=s[C+1];j=i(j),l.addColorStop(s[C],v?p.toGrayColor(j):j),C+=2}}else{var C,P="linear"===R,f=y.x,k=y.y,d=y.width,m=y.height,F=s.length,v=T.compGray;if(P)l=T.createLinearGradient(f+d*s[1],k+m*s[2],f+d*s[3],k+m*s[4]),C=5;else{var e=Math.min(d,m),M=s[1]*d+f,Z=s[2]*m+k,D=s[3]*e;l=T.createRadialGradient(M,Z,0,M,Z,D),C=4}for(;F>C;){var j=s[C+1];j=i(j),l.addColorStop(s[C],v?p.toGrayColor(j):j),C+=2}}else l=s;return O?T.strokeStyle=l:T.fillStyle=l,l},Te=function(){function M(v,X){var n=v.length,c=v[0];if(Xj(v)||c&&1!==c.length)return v;for(var l=new Array(n),H=0;n>H;H++)l[H]=v[H];var Z,b,E,y,u,w,L,M,K,A,T,F,W,$="L"===l[0];return Z=$?5:7,b=l[Z],E=l[Z+1],y=l[Z+2],u=l[Z+3],w=l[Z+4],L=l[Z+5],M=X[0],K=X[1],A=X[2],T=X[3],F=X[4],W=X[5],l[Z]=M*b+A*E,l[Z+1]=K*b+T*E,l[Z+2]=M*y+A*u,l[Z+3]=K*y+T*u,l[Z+4]=M*w+A*L+F,l[Z+5]=K*w+T*L+W,l}return function(Q,J){var t;(t=Q.s("shape.gradient.pack"))&&Q.s("shape.gradient.pack",M(t,J)),(t=Q.s("shape.border.gradient.pack"))&&Q.s("shape.border.gradient.pack",M(t,J))}}(),vg=function(c,M,y,P){var $=!1;if(c.beginPath?c.beginPath():$=!0,Qq(M)&&(M=M._as),Qq(y)&&(y=y._as),y&&y.length){for(var D,b,R,G,h=0,V=0,X=y.length;X>V;V++)D=y[V],1===D?(b=M[h++],c.moveTo(b.x,$?-b.y:b.y)):2===D?(b=M[h++],c.lineTo(b.x,$?-b.y:b.y)):3===D?(b=M[h++],R=M[h++],c.quadraticCurveTo(b.x,$?-b.y:b.y,R.x,$?-R.y:R.y)):4===D?(b=M[h++],R=M[h++],G=M[h++],c.bezierCurveTo(b.x,$?-b.y:b.y,R.x,$?-R.y:R.y,G.x,$?-G.y:G.y)):5===D&&c.closePath();P&&5!==D&&c.closePath()}else{var W,q,T,F=M.length;if(F>0){for(W=M[0],c.moveTo(W.x,$?-W.y:W.y),q=1;F>q;q++)T=M[q],c.lineTo(T.x,$?-T.y:T.y);P&&c.closePath()}}},Ok=function(d,p,f,N){if(Qq(d)&&(d=d._as),Qq(p)&&(p=p._as),p&&p.length){f=f||cm;for(var L,X,S,K,e,U,C,n,A=[],j=g,Y=0,H=0,o=p.length;o>H;H++)if(L=p[H],1===L)A.push(j=[]),j.push(d[Y++]);else if(2===L)j.push(d[Y++]);else if(3===L){for(X=j[j.length-1],S=d[Y++],K=d[Y++],U=1;f>U;U++)C=Xq(U/f,X.x,S.x,K.x),n=Xq(U/f,X.y,S.y,K.y),j.push({x:C,y:n,b:!0});j.push(K)}else if(4===L){for(X=j[j.length-1],S=d[Y++],K=d[Y++],e=d[Y++],U=1;f>U;U++)C=Lp(U/f,X.x,S.x,K.x,e.x),n=Lp(U/f,X.y,S.y,K.y,e.y),j.push({x:C,y:n,b:!0});j.push(e)}else 5===L&&j.push(j[0]);return N&&5!==L&&j&&j.length>2&&j.push(j[0]),A}return N&&d.length>2&&(d=d.slice(),d.push(d[0])),d?[d]:[]},Dg=function(H,c,x,g,N,o){var f,i,U,P=kl(c),A=g,d=P[0],j=P[1],T=P[2];if(x){var O=kl(x);f=O[0]-d,i=O[1]-j,U=O[2]-T}else f=255-d,i=255-j,U=255-T;for(o||(o=g>10?1:.5,o=1>N?Q(o/N,2):o),H.save(),H.shadowOffsetX=0,H.shadowOffsetY=0,H.shadowBlur=0,H.shadowColor=0;(g-=o)>0;){var I=1-g/A,J=d+f*I,k=j+i*I,u=T+U*I;
J=Q(y(J),255),k=Q(y(k),255),u=Q(y(u),255),H.strokeStyle="rgb("+J+","+k+","+u+")",H.lineWidth=g,H.stroke()}H.restore()},zd=function(){if(Ag&&E){var D=E+""||Oc;Dp=D.indexOf(lb.substr(0,2))>0&&D.indexOf($l+$l.substr(1,1))>1?!0:!1}var x={};return function(d,e){var f=d+"-"+e,g=x[f];if(g)return g;var U,I,H,F=kl(d);return 0>e?(e=(100+e)/100,U=y(F[0]*e),I=y(F[1]*e),H=y(F[2]*e)):(e/=100,U=F[0],I=F[1],H=F[2],U+=(255-U)*e,I+=(255-I)*e,H+=(255-H)*e,U=Q(y(U),255),I=Q(y(I),255),H=Q(y(H),255)),x[f]="rgb("+U+","+I+","+H+")"}}(),lc=function(p,b,s,R,E,x){x&&(p.fillStyle=x),p.beginPath(),p.rect(b,s,R,E),p.fill()},Fk=function(e,B,C,s,c,x,u){e.beginPath(),vp[B](e,C.x,C.y,C.width,C.height,s,c,x,u)},fj=function(N,X,V,q,G){var p=vp[V];N.fillStyle=p?p(N,X,q?q:go,G.x,G.y,G.width,G.height):X},ji=function(B,b,y,d,g,m){B.fillStyle=Qm(B,b,y,d,g,m)},nj=function(d,D,Z,b,P,n){d.strokeStyle=Qm(d,D,Z,b,P,n)},Qm=function(G,P,E,$,c,C){var H;try{if(!P.tagName&&P.comps){P._cacheImage_||(P._cacheImage_={});var Y;Y="override"===$?"colors_override":"override_rgb"===$?"colors_override_rgb":"override_a"===$?"colors_override_a":"colors",P._cacheImage_[Y]||(P._cacheImage_[Y]={__count__:0});var T=P._cacheImage_[Y][E];T||(P._cacheImage_[Y].__count__>p.imageCacheThreshold&&(P._cacheImage_[Y]={__count__:0}),T=U.Default.toCanvas(P,Oo(P),Gl(P),null,c,C,E,null,$),P._cacheImage_[Y][E]=T,P._cacheImage_[Y].__count__++),P=T}H=G.createPattern(P,"repeat")}catch(M){H="black"}return H},fe=function(Q){var I,j,l=[],N=0,M=Q.length;for(I=0;65>I;I++)l[I]=I;for(I=0;65>I;I++)N=(N+l[I]+Q.charCodeAt(I%M))%65,j=l[I],l[I]=l[N],l[N]=j;for(I=0;65>I;I++)l[I]=vj[l[I]];return l.join("")},Nd=function(u){for(var j=8+fo.randomInt(8),Z=vj[8*fo.randomInt(8)+(j-8)],v="",i=0;j>i;i++)v+=vj[fo.randomInt(64)];var d=fe(v+e+ck+sg);return Z+v+Am.encode(u,d)},nr=function(V){var r=V[0],u=vj.indexOf(r);if(0>u)return"";u=8+(7&u);var F=V.slice(1,1+u),n=fe(F+e+ck+sg);return Am.decode(V,n,1+u)},Yg=function(f,o,S,u,n,N,w){f.save(),f.translate(o,S),f.scale(1,w/N),f.arc(0,0,N,u,n),f.restore()},bd=function(N,c,P,Q,m,Y,f,Z){var q,v,u,X,h,z,S,o,d,U,R;if(B(m)>2*a&&(m=2*a),h=y(B(m)/(a/4)),q=m/h,v=-q,u=-Q,h>0){z=c+W(Q)*Y,S=P+_(-Q)*f,Z?N.lineTo(z,S):N.moveTo(z,S);for(var b=0;h>b;b++)u+=v,X=u-v/2,o=c+W(u)*Y,d=P+_(u)*f,U=c+W(X)*(Y/W(v/2)),R=P+_(X)*(f/W(v/2)),N.quadraticCurveTo(U,R,o,d)}},ti=function(D,O,k,Z,_,f,v,t,T){6===arguments.length&&(Vd(f)?(t=f[1],T=f[2],v=f[3],f=f[0]):(v=f,t=f,T=f));var C=O+Z,I=k+_,W=_>Z?2*Z:2*_;f=W>f?f:W,v=W>v?v:W,t=W>t?t:W,T=W>T?T:W,D.moveTo(O+Z/2,k),D.arcTo(C,k,C,I,v),D.arcTo(C,I,O,I,T),D.arcTo(O,I,O,k,t),D.arcTo(O,k,C,k,f),D.lineTo(O+Z/2,k)},El=function(b,V,Q,u,Z,K,w){V&&(Q=A(Q),u=A(u),w||(w=1),b.fillStyle=V,b.beginPath(),b.rect(Q,u,w,K),b.rect(Q,u,Z,w),K-w>0&&b.rect(Q,u+K-w,Z,w),Z-w>0&&b.rect(Q+Z-w,u,w,K),b.fill())},Ig=function(U,o,h,z){var N=z.x,Z=z.y,t=z.width,R=z.height;if(!(!o||!h||0>=t||0>=R)){var P,q=Xg(o),b=Ao(o),d=h>0;1===h||-1===h?(U.fillStyle=d?q:b,U.beginPath(),U.rect(N,Z,1,R),U.rect(N,Z,t,1),U.fill(),U.fillStyle=d?b:q,U.beginPath(),U.rect(N,Z+R-1,t,1),U.rect(N+t-1,Z,1,R),U.fill()):(h=Q(B(h),Q(t/2,R/2)),P=U.createLinearGradient(N,Z,N+h,Z),P.addColorStop(0,d?q:b),P.addColorStop(1,o),U.fillStyle=P,U.beginPath(),U.moveTo(N,Z),U.lineTo(N+h,Z+h),U.lineTo(N+h,Z+R-h),U.lineTo(N,Z+R),U.lineTo(N,Z),U.fill(),P=U.createLinearGradient(N,Z,N,Z+h),P.addColorStop(0,d?q:b),P.addColorStop(1,o),U.fillStyle=P,U.beginPath(),U.moveTo(N,Z),U.lineTo(N+h,Z+h),U.lineTo(N+t-h,Z+h),U.lineTo(N+t,Z),U.lineTo(N,Z),U.fill(),P=U.createLinearGradient(N,Z+R,N,Z+R-h),P.addColorStop(0,d?b:q),P.addColorStop(1,o),U.fillStyle=P,U.beginPath(),U.moveTo(N,Z+R),U.lineTo(N+h,Z+R-h),U.lineTo(N+t-h,Z+R-h),U.lineTo(N+t,Z+R),U.lineTo(N,Z+R),U.fill(),P=U.createLinearGradient(N+t,Z,N+t-h,Z),P.addColorStop(0,d?b:q),P.addColorStop(1,o),U.fillStyle=P,U.beginPath(),U.moveTo(N+t,Z),U.lineTo(N+t-h,Z+h),U.lineTo(N+t-h,Z+R-h),U.lineTo(N+t,Z+R),U.lineTo(N+t,Z),U.fill())}},Sd=function(H,U,$,M,S,F,o){var q=H.createLinearGradient(M,S,F,o);return q.addColorStop(0,$),q.addColorStop(1,U),q},Yc=function(j,n,M,Y,F,y,m){var k=j.createLinearGradient(Y,F,y,m);return k.addColorStop(0,n),k.addColorStop(.5,M),k.addColorStop(1,n),k},Li=function(W,S,Z,b,N,a,F){var V=W.createLinearGradient(b,N,a,F);return V.addColorStop(0,S),V.addColorStop(1/3,Z),V.addColorStop(2/3,S),V.addColorStop(1,Z),V},ad=function(W,e,m,I,h,f,w,z,g){var y=W.createRadialGradient(I+f*z,h+w*g,Q(f,w)/24,I+f/2,h+w/2,N(f,w)/2);return y.addColorStop(0,m),y.addColorStop(1,e),y},_d=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],vp={polygon:function(P,Z,F,u,B,Y,O,R){(Y==g||3>Y)&&(Y=6),O==g&&(O=0),R==g&&(R=!0);var A,U=Q(u,B),y=U/2,m=new vr(Z+u/2,F+B/2),v=new vr,h=0,n=2*a/Y,j=new vr(y,y);if(R===!1&&j.multiply({x:u/U,y:B/U}),0===O)for(A=0;Y>A;A++)v.set(W(h),_(h)).multiply(j).add(m),0===A?P.moveTo(v.x,v.y):P.lineTo(v.x,v.y),h+=n;else{var w=[];for(A=0;2>A;A++)w.push(new vr(W(h),_(h)).multiply(j).add(m)),h+=n;var x=w.shift(),z=w[0],D=new vr(W(h),_(h)).multiply(j).add(m),M=x.clone().sub(z),V=D.clone().sub(z),d=M.clone().normalize().dot(V.clone().normalize()),N=Math.sqrt((1-d)/(1+d)),X=O/N;for(M.setLength(X).add(z),P.moveTo(M.x,M.y),A=0;Y>A;A++)w.push(new vr(W(h),_(h)).multiply(j).add(m)),h+=n,x=w.shift(),z=w[0],P.arcTo(x.x,x.y,z.x,z.y,O)}P.closePath()},arc:function(t,w,l,U,v,P,s,o,D){P==g&&(P=a),s==g&&(s=L),o==g&&(o=!0);var V=w+U/2,A=l+v/2;o&&t.moveTo(V,A),D?Yg(t,V,A,P,s,U/2,v/2):t.arc(V,A,Q(U,v)/2,P,s),o&&t.closePath()},rect:function(H,w,R,A,W){H.rect(w,R,A,W)},circle:function(m,s,V,M,$){m.arc(s+M/2,V+$/2,Q(M,$)/2,0,L,!0)},oval:function(u,H,M,v,n){Yg(u,H+v/2,M+n/2,0,L,v/2,n/2)},roundRect:function(L,M,h,t,k,G){G==g&&(G=Q(Q(t,k)/4,8)),ti(L,M,h,t,k,G),L.closePath()},star:function(A,h,m,Q,$){var s=2*Q,O=2*$,C=h+Q/2,g=m+$/2;A.moveTo(C-s/4,g-O/12),A.lineTo(h+.306*Q,m+.579*$),A.lineTo(C-s/6,g+O/4),A.lineTo(h+Q/2,m+.733*$),A.lineTo(C+s/6,g+O/4),A.lineTo(h+.693*Q,m+.579*$),A.lineTo(C+s/4,g-O/12),A.lineTo(h+.611*Q,m+.332*$),A.lineTo(C+0,g-O/4),A.lineTo(h+.388*Q,m+.332*$),A.closePath()},pentagram:function(b,A,N,P,Q){var Y=.5*Q,d=A+.5*P,K=N+Y,o=.5257311121191336*P;o>Y&&(o=Y);var j=_d,M=0;for(b.moveTo(d+o*j[M++],K+o*j[M++]);20>M;)b.lineTo(d+o*j[M++],K+o*j[M++]);b.closePath()},triangle:function(j,Y,o,v,J){j.moveTo(Y+v/2,o),j.lineTo(Y+v,o+J),j.lineTo(Y,o+J),j.closePath()},hexagon:function(g,O,q,e,Z){g.moveTo(O,q+Z/2),g.lineTo(O+e/4,q+Z),g.lineTo(O+3*e/4,+q+Z),g.lineTo(O+e,q+Z/2),g.lineTo(O+3*e/4,q),g.lineTo(O+e/4,q),g.closePath()},pentagon:function(d,q,M,Q,L){var m=2*Q,O=2*L,A=q+Q/2,T=M+L/2;d.moveTo(A-m/4,T-O/12),d.lineTo(A-m/6,T+O/4),d.lineTo(A+m/6,T+O/4),d.lineTo(A+m/4,T-O/12),d.lineTo(A+0,T-O/4),d.closePath()},diamond:function(h,n,q,Z,c){h.moveTo(n+Z/2,q),h.lineTo(n,q+c/2),h.lineTo(n+Z/2,q+c),h.lineTo(n+Z,q+c/2),h.closePath()},rightTriangle:function(S,g,w,s,K){S.moveTo(g,w),S.lineTo(g+s,w+K),S.lineTo(g,w+K),S.closePath()},parallelogram:function(F,I,D,c,s){var v=c/4;F.moveTo(I+v,D),F.lineTo(I+c,D),F.lineTo(I+c-v,D+s),F.lineTo(I,D+s),F.closePath()},trapezoid:function(X,o,D,q,T){var b=q/4;X.moveTo(o+b,D),X.lineTo(o+q-b,D),X.lineTo(o+q,D+T),X.lineTo(o,D+T),X.closePath()},"linear.southwest":function(f,I,P,i,q,z,H){return Sd(f,I,P,i,q+H,i+z,q)},"linear.southeast":function(H,b,e,m,B,W,j){return Sd(H,b,e,m+W,B+j,m,B)},"linear.northwest":function(d,A,F,L,N,g,W){return Sd(d,A,F,L,N,L+g,N+W)},"linear.northeast":function(s,N,E,w,e,_,V){return Sd(s,N,E,w+_,e,w,e+V)},"linear.north":function(r,G,o,Z,I,F,f){return Sd(r,G,o,Z,I,Z,I+f)},"linear.south":function(z,$,N,y,G,_,v){return Sd(z,$,N,y,G+v,y,G)},"linear.west":function(Z,o,W,p,g,e){return Sd(Z,o,W,p,g,p+e,g)},"linear.east":function(y,S,R,A,m,N){return Sd(y,S,R,A+N,m,A,m)},"radial.center":function(T,u,c,e,K,s,F){return ad(T,u,c,e,K,s,F,.5,.5)},"radial.southwest":function(g,o,L,X,t,q,l){return ad(g,o,L,X,t,q,l,.25,.75)},"radial.southeast":function(M,m,V,$,U,x,D){return ad(M,m,V,$,U,x,D,.75,.75)},"radial.northwest":function(v,r,U,q,h,s,A){return ad(v,r,U,q,h,s,A,.25,.25)},"radial.northeast":function(q,W,N,f,J,T,C){return ad(q,W,N,f,J,T,C,.75,.25)},"radial.north":function(S,e,r,Q,f,W,q){return ad(S,e,r,Q,f,W,q,.5,.25)},"radial.south":function(f,V,T,K,D,g,L){return ad(f,V,T,K,D,g,L,.5,.75)},"radial.west":function(T,p,Z,i,A,v,I){return ad(T,p,Z,i,A,v,I,.25,.5)},"radial.east":function(Z,O,E,u,B,l,a){return ad(Z,O,E,u,B,l,a,.75,.5)},"spread.horizontal":function(t,x,j,n,$,o){return Yc(t,x,j,n,$,n+o,$)},"spread.vertical":function(j,W,y,$,J,b,V){return Yc(j,W,y,$,J,$,J+V)},"spread.diagonal":function(u,T,V,p,O,q,n){return Yc(u,T,V,p+q,O,p,O+n)},"spread.antidiagonal":function(p,V,X,z,Y,Z,h){return Yc(p,V,X,z,Y,z+Z,Y+h)},"spread.north":function(p,z,R,j,r,x,P){return Li(p,z,R,j,r-P/4,j,r+P+P/4)},"spread.south":function(P,J,M,Z,K,i,O){return Li(P,M,J,Z,K-O/4,Z,K+O+O/4)},"spread.west":function(x,J,q,K,_,f){return Li(x,J,q,K-f/4,_,K+f+f/4,_)},"spread.east":function(t,y,s,W,Y,d){return Li(t,s,y,W-d/4,Y,W+d+d/4,Y)}},Bj=function(k,E,M){return new Tc(k).tf(E,M)},Kq=function(s){var d=s.touches[0],z=s.touches[1],V=d.clientX,g=d.clientY,o=z.clientX,O=z.clientY;return w((V-o)*(V-o)+(g-O)*(g-O))},bj=function(M){var C=M.touches[0],q=M.touches[1],b=C.clientX,$=C.clientY,O=q.clientX,V=q.clientY;return{x:(b+O)/2,y:($+V)/2}},nq=(function(){for(var x=0,y=Hr.split(""),A=0;A<y.length;A++)x=10*vs(y[A])+x;return Cr(q[Ij.toString(8*A)+pp.substr(A)+3],q[Ij.toString(8*A)+pp.substr(A)+4]),x}(),function(i,A,M){for(var S=0;S<M.size();S++){var Y=M.get(S);i.co(Y)&&A.add(Y)}for(S=0;S<M.size();S++)Y=M.get(S),nq(i,A,Y._children)}),li=function(d,Z,T){for(var F=0;F<T.size();F++){var t=T.get(T.size()-1-F);d.co(t)&&Z.add(t)}for(F=0;F<T.size();F++)t=T.get(F),li(d,Z,t._children)},Sk=function(I,s,X){for(var C=!1,e=0;e<X.size();e++){var T=X.get(e);I.co(T)?C&&s.add(T):C=1}for(e=0;e<X.size();e++)T=X.get(e),Sk(I,s,T._children)},xr=function(l,h,e){for(var j=!1,K=0;K<e.size();K++){var q=e.get(e.size()-1-K);l.co(q)?j&&h.add(q):j=!0}for(K=0;K<e.size();K++)q=e.get(K),xr(l,h,q._children)},qm=p.moveDatas=function(i,a,h,j){var X=j==g;if(0!==a||0!==h||!X&&0!==j){var P=!0,x=[];if(i.forEach(function($){P&&($._69O||Mn($)||pi($))&&(P=!1)}),P)x=i;else{var T={},J={};i.forEach(function(W){T[W._id]=!0});var L={},C=function(K){var N=K._id;return T[N]?(x.push(K),L[N]=!0):L[N]=!1},y=function(G){var e=G._id;if(J[e])return C(G);var f=L[e];if(f!==s)return f;var m=G._parent;if(m&&(pi(m)||Mn(m))&&y(m))return L[e]=!0;var w=G._host;return w&&(J[e]=e,f=y(w),J[e]=s,f)?L[e]=!0:C(G)};i.forEach(function(f){y(f)})}x.forEach(function(O){if(Ob(O))X?O.translate(a,h):O.translate3d(a,h,j);else{var l=O.s(sm);if(!l||l.isEmpty())return;var t=new Yn;l.each(function(S){S=Wi(S),X?(S.x+=a,S.y+=h):(S.x+=a,S.y+=j,S.e==g?S.e=h:S.e+=h),t.add(S)}),O.s(sm,t)}})}},Ej=function(){function E(v,M){return M===v.substring(0,M.length)?!0:!1}function h(I){return parseFloat(I)||0}function x(T,Z){if(Z==s&&(Z=new cr),E(T,"matrix3d")){var q=T.substring(9,T.length-1).split(",");q=q.map(h),Z.fromArray(q)}else if(E(T,"matrix")){var q=T.substring(7,T.length-1).split(",");q=q.map(h),Z.el[0]=q[0],Z.el[1]=q[1],Z.el[2]=0,Z.el[3]=0,Z.el[4]=q[2],Z.el[5]=q[3],Z.el[6]=0,Z.el[7]=0,Z.el[8]=0,Z.el[9]=0,Z.el[10]=1,Z.el[11]=0,Z.el[12]=q[4],Z.el[13]=q[5],Z.el[14]=0,Z.el[15]=1}return Z}function f(G,X){X==s&&(X=new Bb);var K=G.split(/\s+/);return K=K.map(h),X.set(K[0]||0,K[1]||0,K[2]||0),X}var M,A,O,K,U,w=function(d,e){M||(M=new cr,A=new Bb,O=new cr,K=new cr,U=new cr),e==s&&(e=new cr);var b=getComputedStyle(d);b.transform&&"none"!==b.transform&&(x(b.transform,M),f(b.transformOrigin,A),K.setPosition(A),A.negate(),U.setPosition(A),(uc||"preserve-3d"!==b.transformStyle)&&(M.el[8]=0,M.el[9]=0,M.el[10]=1,M.el[11]=0),e.multiplyMatrices(U,e),e.multiplyMatrices(M,e),e.multiplyMatrices(K,e)),!uc&&b.perspective&&"none"!==b.perspective&&(O.el[11]=-1/h(b.perspective),f(b.perspectiveOrigin,A),K.setPosition(A),A.negate(),U.setPosition(A),e.multiplyMatrices(U,e),e.multiplyMatrices(O,e),e.multiplyMatrices(K,e));for(var u=d.offsetParent,$=d.offsetLeft,W=d.offsetTop,n=d.parentElement;n&&n!==u;){var L=getComputedStyle(n);if("none"!==L.transform||"none"!==L.perspective)break;n=n.parentElement}return n==s&&d!==d.ownerDocument.documentElement&&"fixed"!==b.position&&(n=d.ownerDocument.documentElement),u!=s&&u!==n&&($-=n.offsetLeft,W-=n.offsetTop),A.set($,W,0),K.setPosition(A),e.multiplyMatrices(K,e),n&&w(n,e),e};return function(c,H){var U=c.parentElement;if(U){var Z=U.updateAppendMatrix;if(Z){delete U.updateAppendMatrix;var t=new cr;w(U,t);var u=new cr;u.getInverse(t),U._matrixAppend=u,U._maxrixPreAppend=t}return H?U._matrixAppend:U._maxrixPreAppend}}}(),ai=function(H,B){for(;H&&!H.hasOwnProperty(B);)H=z.getPrototypeOf(H);return H&&z.getOwnPropertyDescriptor(H,B)},il=z.getPrototypeOf?function(O,j,$){var P=ai(j,$);P&&z.defineProperty(O,$,P)}:function(y,w,F){y[F]=w[F]},ie={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},xm=function(){var e={1:function(M,B){return{x:M.x-B.width/2,y:M.y-B.height/2}},2:function(h,f){return{x:h.x+f.width/2,y:h.y-f.height/2}},3:function(Z,A){return{x:Z.x+Z.width/2,y:Z.y-A.height/2}},4:function(q,p){return{x:q.x+q.width-p.width/2,y:q.y-p.height/2}},5:function(I,Q){return{x:I.x+I.width+Q.width/2,y:I.y-Q.height/2}},6:function(v){return{x:v.x,y:v.y}},7:function(f){return{x:f.x+f.width/2,y:f.y}},8:function(l){return{x:l.x+l.width,y:l.y}},9:function(V,r){return{x:V.x-r.width/2,y:V.y+r.height/2}},10:function(g,T){return{x:g.x+T.width/2,y:g.y+T.height/2}},11:function(K,z){return{x:K.x+K.width/2,y:K.y+z.height/2}},12:function(g,y){return{x:g.x-y.width/2+g.width,y:g.y+y.height/2}},13:function(P,L){return{x:P.x+P.width+L.width/2,y:P.y+L.height/2}},14:function(i,u){return{x:i.x-u.width/2,y:i.y+i.height/2}},15:function(F){return{x:F.x,y:F.y+F.height/2}},16:function(V,g){return{x:V.x+g.width/2,y:V.y+V.height/2}},17:function(X){return{x:X.x+X.width/2,y:X.y+X.height/2}},18:function(Z,s){return{x:Z.x+Z.width-s.width/2,y:Z.y+Z.height/2}},19:function(X){return{x:X.x+X.width,y:X.y+X.height/2}},20:function(j,v){return{x:j.x+j.width+v.width/2,y:j.y+j.height/2}},21:function(N,j){return{x:N.x-j.width/2,y:N.y+N.height-j.height/2}},22:function(b,c){return{x:b.x+c.width/2,y:b.y+b.height-c.height/2}},23:function(A,R){return{x:A.x+A.width/2,y:A.y+A.height-R.height/2}},24:function(y,u){return{x:y.x+y.width-u.width/2,y:y.y+y.height-u.height/2}},25:function(X,K){return{x:X.x+X.width+K.width/2,y:X.y+X.height-K.height/2}},26:function(z){return{x:z.x,y:z.y+z.height}},27:function(y){return{x:y.x+y.width/2,y:y.y+y.height}},28:function(x){return{x:x.x+x.width,y:x.y+x.height}},29:function(J,l){return{x:J.x-l.width/2,y:J.y+J.height+l.height/2}},30:function(W,L){return{x:W.x+L.width/2,y:W.y+W.height+L.height/2}},31:function(O,w){return{x:O.x+O.width/2,y:O.y+O.height+w.height/2}},32:function(j,V){return{x:j.x+j.width-V.width/2,y:j.y+j.height+V.height/2}},33:function(q,W){return{x:q.x+q.width+W.width/2,y:q.y+q.height+W.height/2}},34:function(u,A){return{x:u.x,y:u.y-A.height/2}},35:function(Z,l){return{x:Z.x+Z.width,y:Z.y-l.height/2}},36:function(R,H){return{x:R.x,y:R.y+R.height+H.height/2}},37:function(W,O){return{x:W.x+W.width,y:W.y+W.height+O.height/2}},38:function(S,V){return{x:S.x+S.width/4,y:S.y-V.height/2}},39:function(q,x){return{x:q.x+3*q.width/4,y:q.y-x.height/2}},40:function(X){return{x:X.x+X.width/4,y:X.y}},41:function(l){return{x:l.x+3*l.width/4,y:l.y}},42:function(u,j){return{x:u.x+u.width/4,y:u.y+j.height/2}},43:function(E,U){return{x:E.x+3*E.width/4,y:E.y+U.height/2}},44:function(y,Q){return{x:y.x+y.width/2,y:y.y+y.height/2-Q.height/2}},45:function(g){return{x:g.x+g.width/4,y:g.y+g.height/2}},46:function(R,I){return{x:R.x+R.width/2-I.width/2,y:R.y+R.height/2}},47:function(k,l){return{x:k.x+k.width/2+l.width/2,y:k.y+k.height/2}},48:function(S){return{x:S.x+3*S.width/4,y:S.y+S.height/2}},49:function(R,i){return{x:R.x+R.width/2,y:R.y+R.height/2+i.height/2}},50:function(y,L){return{x:y.x+y.width/4,y:y.y+y.height-L.height/2}},51:function(h,Q){return{x:h.x+3*h.width/4,y:h.y+h.height-Q.height/2}},52:function(I){return{x:I.x+I.width/4,y:I.y+I.height}},53:function(r){return{x:r.x+3*r.width/4,y:r.y+r.height}},54:function(A,H){return{x:A.x+A.width/4,y:A.y+A.height+H.height/2}},55:function(z,h){return{x:z.x+3*z.width/4,y:z.y+z.height+h.height/2}}};return Vm(q)?function(I,$,j){return e[I]($,j?j:Pf)}:void 0}();oi(u,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#FFF",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Ck=u.reverse,lf=u.transparent,Tb=u.rectSelectBackground,Uk=u.dash,nl=u.titleBackground,zo=u.titleIconBackground,Yb=u.headerBackground,oj=u.headerIconBackground,Ik=u.headerSeparator,zi=u.headerLine,op=u.contentIconBackground,tn=u.contentLine,Oq=(u.widgetIconHighlight,u.widgetIconBorder),hi=(u.widgetIconGradient,u.imageBackground),go=u.imageGradient,_l=u.highlight,Ek=u.label,Ci=u.labelSelect;if(jr&&!q.shutAlert1){var Gn=new Date,Kl=jr.split("-"),Xh=new Date(Gn.getFullYear(),Gn.getMonth(),Gn.getDate()),jr=new Date(vs(Kl[0],10),vs(Kl[1],10)-1,vs(Kl[2],10)),_c=Xh.getTime(),Ve=jr.getTime(),ac=e+"_try",Kr=q.alert;try{var Oi=q.localStorage;if(Oi&&Kr)if(Ve>_c&&1728e6>Ve-_c){var vk=(Ve-_c)/864e5;Oi&&Oi[ac]!=vk&&(Oi[ac]=vk,q.htWillExpire?Kr(q.htWillExpire.replace("{{day}}",vk)):Kr("HT for Web free trial license will expire in "+vk+" days, please apply for a new license!"))}else _c>=Ve&&(q.htExpired?Kr(q.htExpired):Kr("Your free trial of HT for Web has expired!")),Oi&&delete Oi[ac]}catch(kb){}}Math.sign===s&&(Math.sign=function(n){return 0>n?-1:n>0?1:+n});var vj="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Am={encode:function(_,H){var C,a,d,q,t,e,z,g="",G=0;for(_=unescape(encodeURIComponent(_));G<_.length;)C=_.charCodeAt(G++),a=_.charCodeAt(G++),d=_.charCodeAt(G++),q=C>>2,t=(3&C)<<4|a>>4,e=(15&a)<<2|d>>6,z=63&d,isNaN(a)?e=z=64:isNaN(d)&&(z=64),g=g+H.charAt(q)+H.charAt(t)+H.charAt(e)+H.charAt(z);return g},decode:function(J,o,M){for(var T,B,Q,Z,x,a,X,i="",m=M||0;m<J.length;)Z=o.indexOf(J.charAt(m++)),x=o.indexOf(J.charAt(m++)),a=o.indexOf(J.charAt(m++)),X=o.indexOf(J.charAt(m++)),T=Z<<2|x>>4,B=(15&x)<<4|a>>2,Q=(3&a)<<6|X,i+=String.fromCharCode(T),64!=a&&(i+=String.fromCharCode(B)),64!=X&&(i+=String.fromCharCode(Q));return i=decodeURIComponent(escape(i))},_utf8_encode:function(y){y=y.replace(/\r\n/g,"\n");for(var H="",f=0;f<y.length;f++){var P=y.charCodeAt(f);128>P?H+=String.fromCharCode(P):P>127&&2048>P?(H+=String.fromCharCode(192|P>>6),H+=String.fromCharCode(128|63&P)):(H+=String.fromCharCode(224|P>>12),H+=String.fromCharCode(128|63&P>>6),H+=String.fromCharCode(128|63&P))}return H},_utf8_decode:function(f){for(var j="",b=0,E=0,n=0,l=0;b<f.length;)E=f.charCodeAt(b),128>E?(j+=String.fromCharCode(E),b++):E>191&&224>E?(n=f.charCodeAt(b+1),j+=String.fromCharCode((31&E)<<6|63&n),b+=2):(n=f.charCodeAt(b+1),l=f.charCodeAt(b+2),j+=String.fromCharCode((15&E)<<12|(63&n)<<6|63&l),b+=3);return j}},Vc=[],ik=[],fo=U.Math={generateUUID:function(){for(var I=[],W=0;256>W;W++)I[W]=(16>W?"0":"")+W.toString(16).toUpperCase();return function(){var W=0|4294967295*Math.random(),A=0|4294967295*Math.random(),Z=0|4294967295*Math.random(),B=0|4294967295*Math.random();return I[255&W]+I[255&W>>8]+I[255&W>>16]+I[255&W>>24]+"-"+I[255&A]+I[255&A>>8]+"-"+I[64|15&A>>16]+I[255&A>>24]+"-"+I[128|63&Z]+I[255&Z>>8]+"-"+I[255&Z>>16]+I[255&Z>>24]+I[255&B]+I[255&B>>8]+I[255&B>>16]+I[255&B>>24]}}(),clamp:function(F,j,n){return Math.max(j,Math.min(n,F))},fequal:function(U,O,I){return null==I&&(I=1e-8),Math.abs(U-O)<I},generateIncreasingID:function(){var E=0;return function(){return++E}}(),encodeBase64:function(G,k){return Am.encode(G,k||vj)},decodeBase64:function(J,M){return Am.decode(J,M||vj)},randomArray:function(R,l){l=l||R.length;for(var u=l-1;u>0;u--){var x=Math.floor(Math.random()*(u+1)),Z=R[u];R[u]=R[x],R[x]=Z}return R},randomInt:function(m,h){return h===s&&(h=m,m=0),m+Math.floor(Math.random()*(h-m))},randomFloat:function(A,D){return D===s&&(D=A,A=0),A+Math.random()*(D-A)},isPOT:function(O){return O>0&&0===(O-1&O)},nearestPOT:function(R){if(!R)return 1;var E=R;E--,E|=E>>1,E|=E>>2,E|=E>>4,E|=E>>8,E|=E>>16,E++;var m=E>>1;return R-m>E-R?E:m},requestMatrix4:function(){return Vc.length>0?Vc.pop():new fo.Matrix4},releaseMatrix4:function(Q){Vc.push(Q)},requestVector3:function(){return ik.length>0?ik.pop():new fo.Vector3},releaseVector3:function(G){ik.push(G)}},Wg=U.Matrix=U.Math.Matrix2d=function(N,w,X,r,a){this.setFromTransform(N,w,X,r,a)},Tc=Wg;Wg.prototype={},Wg.prototype.constructor=Wg,Wg.prototype.set=function(P,T,X,s,E,A){return this.a=P,this.b=T,this.c=X,this.d=s,this.tx=E,this.ty=A,this},Wg.prototype.setFromTransform=function(b,k,o,q,U){var m=this;if(b===s)return m.a=1,m.b=0,m.c=0,m.d=1,m.tx=0,m.ty=0,void 0;var u,K;return b?(u=_(b),K=W(b)):(u=0,K=1),q=q||1,U=U||1,m.a=K*q,m.b=u*q,m.c=-u*U,m.d=K*U,m.tx=k||0,m.ty=o||0,m},Wg.prototype.apply=function(O,S){S=S||new vr;var e=O.x,J=O.y;return S.x=this.a*e+this.c*J+this.tx,S.y=this.b*e+this.d*J+this.ty,S},Wg.prototype.applyInverse=function(x,T){T=T||new vr;var L=1/(this.a*this.d+this.c*-this.b),U=x.x,Z=x.y;return T.x=this.d*L*U+-this.c*L*Z+(this.ty*this.c-this.tx*this.d)*L,T.y=this.a*L*Z+-this.b*L*U+(-this.ty*this.a+this.tx*this.b)*L,T},Wg.prototype.translate=function(r,d){return this.tx+=r,this.ty+=d,this},Wg.prototype.scale=function(Z,W){return this.a*=Z,this.d*=W,this.c*=Z,this.b*=W,this.tx*=Z,this.ty*=W,this},Wg.prototype.rotate=function(k){var f=Math.cos(k),i=Math.sin(k),F=this.a,g=this.c,m=this.tx;return this.a=F*f-this.b*i,this.b=F*i+this.b*f,this.c=g*f-this.d*i,this.d=g*i+this.d*f,this.tx=m*f-this.ty*i,this.ty=m*i+this.ty*f,this},Wg.prototype.appendTranslate=function(A,B){return this.tx+=this.a*A+this.c*B,this.ty+=this.b*A+this.d*B,this},Wg.prototype.appendScale=function(L,c){return this.a*=L,this.d*=c,this.c*=c,this.b*=L,this},Wg.prototype.appendRotate=function(k){if(!k)return this;var c=Math.cos(k),j=Math.sin(k),Q=this.a,b=this.b;return this.a=Q*c+this.c*j,this.b=b*c+this.d*j,this.c=-Q*j+this.c*c,this.d=-b*j+this.d*c,this},Wg.prototype.append=function(L){var O=this.a,c=this.b,Y=this.c,M=this.d;return this.a=L.a*O+L.b*Y,this.b=L.a*c+L.b*M,this.c=L.c*O+L.d*Y,this.d=L.c*c+L.d*M,this.tx=L.tx*O+L.ty*Y+this.tx,this.ty=L.tx*c+L.ty*M+this.ty,this},Wg.prototype.setTransform=function(L,y,s,S,x,c,G,m,w){var W,C,Q,l,B,K,p,b,E,O;return B=Math.sin(G),K=Math.cos(G),p=Math.cos(w),b=Math.sin(w),E=-Math.sin(m),O=Math.cos(m),W=K*x,C=B*x,Q=-B*c,l=K*c,this.a=p*W+b*Q,this.b=p*C+b*l,this.c=E*W+O*Q,this.d=E*C+O*l,this.tx=L+(s*W+S*Q),this.ty=y+(s*C+S*l),this},Wg.prototype.prepend=function(C){var N=this.tx;if(1!==C.a||0!==C.b||0!==C.c||1!==C.d){var H=this.a,r=this.c;this.a=H*C.a+this.b*C.c,this.b=H*C.b+this.b*C.d,this.c=r*C.a+this.d*C.c,this.d=r*C.b+this.d*C.d}return this.tx=N*C.a+this.ty*C.c+C.tx,this.ty=N*C.b+this.ty*C.d+C.ty,this},Wg.prototype.transform=Wg.prototype.prepend,Wg.prototype.invert=function(){var K=this.a,p=this.b,s=this.c,v=this.d,z=this.tx,i=K*v-p*s;return this.a=v/i,this.b=-p/i,this.c=-s/i,this.d=K/i,this.tx=(s*this.ty-v*z)/i,this.ty=-(K*this.ty-p*z)/i,this},Wg.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Wg.prototype.clone=function(){var n=new Wg;return n.a=this.a,n.b=this.b,n.c=this.c,n.d=this.d,n.tx=this.tx,n.ty=this.ty,n},Wg.prototype.copy=function(o){return o.a=this.a,o.b=this.b,o.c=this.c,o.d=this.d,o.tx=this.tx,o.ty=this.ty,o},Wg.prototype.tf=function(K,$){1===arguments.length&&($=K.y,K=K.x);var O=this;return{x:O.a*K+O.c*$+O.tx,y:O.b*K+O.d*$+O.ty}},Wg.prototype.toArray=function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]},Wg.prototype.fromArray=function(A){return this.a=A[0],this.b=A[1],this.c=A[2],this.d=A[3],this.tx=A[4],this.ty=A[5],this},Wg.prototype.toArray9=function(){return[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1]},Wg.prototype.tfi=function(M,J){1===arguments.length&&(J=M.y,M=M.x);var D=this,W=1/(D.a*D.d+D.c*-D.b);return{x:D.d*W*M+-D.c*W*J+(D.ty*D.c-D.tx*D.d)*W,y:D.a*W*J+-D.b*W*M+(-D.ty*D.a+D.tx*D.b)*W}},Wg.IDENTITY=new Wg,Wg.TEMP_MATRIX=new Wg;var kg=U.Math.Quaternion=function(T,E,x,z){this.set(T,E,x,z)};z.assign(kg.prototype,{set:function(G,Y,f,T){var C=this;return C._x=G||0,C._y=Y||0,C._z=f||0,C._w=T!==s?T:1,C},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(m){var C=this;return C._x=m._x,C._y=m._y,C._z=m._z,C._w=m._w,C},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(z){return this._x*z._x+this._y*z._y+this._z*z._z+this._w*z._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var m=this.length();return 0===m?(this._x=0,this._y=0,this._z=0,this._w=1):(m=1/m,this._x=this._x*m,this._y=this._y*m,this._z=this._z*m,this._w=this._w*m),this},fromArray:function(D,P){P===s&&(P=0);var T=this;return T._x=D[P],T._y=D[P+1],T._z=D[P+2],T._w=D[P+3],this},slerp:function(u,K){if(0===K)return this;if(1===K)return this.copy(u);var k=this._x,B=this._y,q=this._z,A=this._w,T=A*u._w+k*u._x+B*u._y+q*u._z;if(0>T?(this._w=-u._w,this._x=-u._x,this._y=-u._y,this._z=-u._z,T=-T):this.copy(u),T>=1)return this._w=A,this._x=k,this._y=B,this._z=q,this;var h=Math.sqrt(1-T*T);if(Math.abs(h)<.001)return this._w=.5*(A+this._w),this._x=.5*(k+this._x),this._y=.5*(B+this._y),this._z=.5*(q+this._z),this;var m=Math.atan2(h,T),e=Math.sin((1-K)*m)/h,L=Math.sin(K*m)/h;return this._w=A*e+this._w*L,this._x=k*e+this._x*L,this._y=B*e+this._y*L,this._z=q*e+this._z*L,this},setFromAxisAngle:function(l,k){var Z=k/2,Q=Math.sin(Z);return this._x=l.x*Q,this._y=l.y*Q,this._z=l.z*Q,this._w=Math.cos(Z),this},setFromEuler:function(S){var t=S._x,N=S._y,Z=S._z,d=S._order,E=Math.cos,R=Math.sin,X=E(t/2),T=E(N/2),G=E(Z/2),D=R(t/2),n=R(N/2),F=R(Z/2);return"XYZ"===d?(this._x=D*T*G+X*n*F,this._y=X*n*G-D*T*F,this._z=X*T*F+D*n*G,this._w=X*T*G-D*n*F):"YXZ"===d?(this._x=D*T*G+X*n*F,this._y=X*n*G-D*T*F,this._z=X*T*F-D*n*G,this._w=X*T*G+D*n*F):"ZXY"===d?(this._x=D*T*G-X*n*F,this._y=X*n*G+D*T*F,this._z=X*T*F+D*n*G,this._w=X*T*G-D*n*F):"ZYX"===d?(this._x=D*T*G-X*n*F,this._y=X*n*G+D*T*F,this._z=X*T*F-D*n*G,this._w=X*T*G+D*n*F):"YZX"===d?(this._x=D*T*G+X*n*F,this._y=X*n*G+D*T*F,this._z=X*T*F-D*n*G,this._w=X*T*G-D*n*F):"XZY"===d&&(this._x=D*T*G-X*n*F,this._y=X*n*G-D*T*F,this._z=X*T*F+D*n*G,this._w=X*T*G+D*n*F),this},setFromRotationMatrix:function(R){var Y,e=R.el,W=e[0],j=e[4],D=e[8],B=e[1],t=e[5],U=e[9],$=e[2],r=e[6],o=e[10],n=W+t+o;return n>0?(Y=.5/Math.sqrt(n+1),this._w=.25/Y,this._x=(r-U)*Y,this._y=(D-$)*Y,this._z=(B-j)*Y):W>t&&W>o?(Y=2*Math.sqrt(1+W-t-o),this._w=(r-U)/Y,this._x=.25*Y,this._y=(j+B)/Y,this._z=(D+$)/Y):t>o?(Y=2*Math.sqrt(1+t-W-o),this._w=(D-$)/Y,this._x=(j+B)/Y,this._y=.25*Y,this._z=(U+r)/Y):(Y=2*Math.sqrt(1+o-W-t),this._w=(B-j)/Y,this._x=(D+$)/Y,this._y=(U+r)/Y,this._z=.25*Y),this},setFromToVectors:function(){var x,Z;return function(O,k){return x===s&&(x=new Bb),Z=O.dot(k)+1,1e-7>Z?(Z=0,Math.abs(O.x)>Math.abs(O.z)?x.set(-O.y,O.x,0):x.set(0,-O.z,O.y)):x.crossVectors(O,k),this._x=x.x,this._y=x.y,this._z=x.z,this._w=Z,this.normalize()}}(),setFromUnitVectors:function(){var b,R,$=1e-6;return function(o,m){return b===s&&(b=new Bb),R=o.dot(m)+1,$>R?(R=0,Math.abs(o.x)>Math.abs(o.z)?b.set(-o.y,o.x,0):b.set(0,-o.z,o.y)):b.crossVectors(o,m),this._x=b.x,this._y=b.y,this._z=b.z,this._w=R,this.normalize()}}(),multiply:function(l){return this.multiplyQuaternions(this,l)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(I,m){var B=I._x,f=I._y,_=I._z,Q=I._w,R=m._x,g=m._y,b=m._z,r=m._w;return this._x=B*r+Q*R+f*b-_*g,this._y=f*r+Q*g+_*R-B*b,this._z=_*r+Q*b+B*g-f*R,this._w=Q*r-B*R-f*g-_*b,this},toArray:function(q,A){return q||(q=[]),A=A||0,q[A]=this._x,q[A+1]=this._y,q[A+2]=this._z,q[A+3]=this._w,q}});var Gk=U.Math.Vector4=function(d,x,u,U){this.x=d||0,this.y=x||0,this.z=u||0,this.w=U!==s?U:1};z.assign(Gk.prototype,{isVector4:!0,set:function(N,M,W,O){return this.x=N,this.y=M,this.z=W,this.w=O,this},setScalar:function(j){return this.x=j,this.y=j,this.z=j,this.w=j,this},setX:function(j){return this.x=j,this},setY:function(S){return this.y=S,this},setZ:function(l){return this.z=l,this},setW:function(P){return this.w=P,this},setComponent:function(e,q){switch(e){case 0:this.x=q;break;case 1:this.y=q;break;case 2:this.z=q;break;case 3:this.w=q;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(r){switch(r){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+r)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(i){return this.x=i.x,this.y=i.y,this.z=i.z,this.w=i.w!==s?i.w:1,this},add:function(m,O){return O!==s?this.addVectors(m,O):(this.x+=m.x,this.y+=m.y,this.z+=m.z,this.w+=m.w,this)},addScalar:function(G){return this.x+=G,this.y+=G,this.z+=G,this.w+=G,this},addVectors:function(J,Y){return this.x=J.x+Y.x,this.y=J.y+Y.y,this.z=J.z+Y.z,this.w=J.w+Y.w,this},addScaledVector:function(f,X){return this.x+=f.x*X,this.y+=f.y*X,this.z+=f.z*X,this.w+=f.w*X,this},sub:function(G,d){return d!==s?this.subVectors(G,d):(this.x-=G.x,this.y-=G.y,this.z-=G.z,this.w-=G.w,this)},subScalar:function(G){return this.x-=G,this.y-=G,this.z-=G,this.w-=G,this},subVectors:function(I,A){return this.x=I.x-A.x,this.y=I.y-A.y,this.z=I.z-A.z,this.w=I.w-A.w,this},multiplyScalar:function(s){return this.x*=s,this.y*=s,this.z*=s,this.w*=s,this},applyMatrix4:function($){var g=this.x,o=this.y,p=this.z,L=this.w,F=$.el;return this.x=F[0]*g+F[4]*o+F[8]*p+F[12]*L,this.y=F[1]*g+F[5]*o+F[9]*p+F[13]*L,this.z=F[2]*g+F[6]*o+F[10]*p+F[14]*L,this.w=F[3]*g+F[7]*o+F[11]*p+F[15]*L,this},divideScalar:function(j){return this.multiplyScalar(1/j)},setAxisAngleFromQuaternion:function(E){this.w=2*Math.acos(E.w);var C=Math.sqrt(1-E.w*E.w);return 1e-4>C?(this.x=1,this.y=0,this.z=0):(this.x=E.x/C,this.y=E.y/C,this.z=E.z/C),this},setAxisAngleFromRotationMatrix:function(r){var L,N,K,Z,x=.01,j=.1,P=r.el,$=P[0],v=P[4],A=P[8],O=P[1],S=P[5],u=P[9],B=P[2],E=P[6],t=P[10];if(Math.abs(v-O)<x&&Math.abs(A-B)<x&&Math.abs(u-E)<x){if(Math.abs(v+O)<j&&Math.abs(A+B)<j&&Math.abs(u+E)<j&&Math.abs($+S+t-3)<j)return this.set(1,0,0,0),this;L=Math.PI;var M=($+1)/2,q=(S+1)/2,G=(t+1)/2,s=(v+O)/4,H=(A+B)/4,e=(u+E)/4;return M>q&&M>G?x>M?(N=0,K=.707106781,Z=.707106781):(N=Math.sqrt(M),K=s/N,Z=H/N):q>G?x>q?(N=.707106781,K=0,Z=.707106781):(K=Math.sqrt(q),N=s/K,Z=e/K):x>G?(N=.707106781,K=.707106781,Z=0):(Z=Math.sqrt(G),N=H/Z,K=e/Z),this.set(N,K,Z,L),this
}var F=Math.sqrt((E-u)*(E-u)+(A-B)*(A-B)+(O-v)*(O-v));return Math.abs(F)<.001&&(F=1),this.x=(E-u)/F,this.y=(A-B)/F,this.z=(O-v)/F,this.w=Math.acos(($+S+t-1)/2),this},min:function(k){return this.x=Math.min(this.x,k.x),this.y=Math.min(this.y,k.y),this.z=Math.min(this.z,k.z),this.w=Math.min(this.w,k.w),this},max:function(U){return this.x=Math.max(this.x,U.x),this.y=Math.max(this.y,U.y),this.z=Math.max(this.z,U.z),this.w=Math.max(this.w,U.w),this},clamp:function(f,D){return this.x=Math.max(f.x,Math.min(D.x,this.x)),this.y=Math.max(f.y,Math.min(D.y,this.y)),this.z=Math.max(f.z,Math.min(D.z,this.z)),this.w=Math.max(f.w,Math.min(D.w,this.w)),this},clampScalar:function(){var L,S;return function(h,b){return L===s&&(L=new Gk,S=new Gk),L.set(h,h,h,h),S.set(b,b,b,b),this.clamp(L,S)}}(),clampLength:function(N,y){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(N,Math.min(y,c)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(D){return this.x*D.x+this.y*D.y+this.z*D.z+this.w*D.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(G){return this.normalize().multiplyScalar(G)},lerp:function(D,W){return this.x+=(D.x-this.x)*W,this.y+=(D.y-this.y)*W,this.z+=(D.z-this.z)*W,this.w+=(D.w-this.w)*W,this},lerpVectors:function(c,r,p){return this.subVectors(r,c).multiplyScalar(p).add(c)},equals:function(k){return k.x===this.x&&k.y===this.y&&k.z===this.z&&k.w===this.w},fromArray:function(X,k){return k===s&&(k=0),this.x=X[k],this.y=X[k+1],this.z=X[k+2],this.w=X[k+3],this},toArray:function(E,f){return E===s&&(E=[]),f===s&&(f=0),E[f]=this.x,E[f+1]=this.y,E[f+2]=this.z,E[f+3]=this.w,E},fromBufferAttribute:function(x,a){return this.x=x.getX(a),this.y=x.getY(a),this.z=x.getZ(a),this.w=x.getW(a),this}});var Bb=U.Math.Vector3=function(y,v,n){y===s?(this.x=0,this.y=0,this.z=0):"object"==typeof y?this.copy(y):this.set(y,v==s?y:v,n==s?y:n)},Qh=U.Math.Vector3;z.assign(Bb.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(f,$,M){return this.x=f,this.y=$,this.z=M,this},equals:function(s){return s&&this.x===s.x&&this.y===s.y&&this.z===s.z},setScalar:function(z){return this.x=z,this.y=z,this.z=z,this},setX:function(j){return this.x=j,this},setY:function(U){return this.y=U,this},setZ:function(i){return this.z=i,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(H){return H.x===s?(this.x=H[0],this.y=H[1],this.z=H[2]):(this.x=H.x,this.y=H.y,this.z=H.z||0),this},add:function(c){return this.x+=c.x,this.y+=c.y,this.z+=c.z,this},addScalar:function(r){return this.x+=r,this.y+=r,this.z+=r,this},addVectors:function(M,K){return this.x=M.x+K.x,this.y=M.y+K.y,this.z=M.z+K.z,this},addScaledVector:function(x,X){return this.x+=x.x*X,this.y+=x.y*X,this.z+=x.z*X,this},sub:function(T){return this.x-=T.x,this.y-=T.y,this.z-=T.z,this},subScalar:function(A){return this.x-=A,this.y-=A,this.z-=A,this},subVectors:function(a,f){return this.x=a.x-f.x,this.y=a.y-f.y,this.z=a.z-f.z,this},divide:function(d){return this.x/=d.x,this.y/=d.y,this.z/=d.z,this},multiply:function(g){return this.x*=g.x,this.y*=g.y,this.z*=g.z,this},multiplyScalar:function(I){return this.x*=I,this.y*=I,this.z*=I,this},divideScalar:function(C){if(0!==C){var e=1/C;this.x*=e,this.y*=e,this.z*=e}else this.x=0,this.y=0,this.z=0;return this},distanceTo:function(J){return Math.sqrt(this.distanceToSquared(J))},distanceToSquared:function(Y){var q=this.x-Y.x,_=this.y-Y.y,i=this.z-Y.z;return q*q+_*_+i*i},distanceToSquared2:function(d){var K=this.x-d[0],X=this.y-d[1],o=this.z-d[2];return K*K+X*X+o*o},divideVectors:function(h,q){return this.x=h.x/q.x,this.y=h.y/q.y,this.z=h.z/q.z,this},multiplyVectors:function(N,G){return this.x=N.x*G.x,this.y=N.y*G.y,this.z=N.z*G.z,this},transformDirection:function(b){var W=this.x,v=this.y,R=this.z,q=b.el;return this.x=q[0]*W+q[4]*v+q[8]*R,this.y=q[1]*W+q[5]*v+q[9]*R,this.z=q[2]*W+q[6]*v+q[10]*R,this.normalize()},applyAxisAngle:function(){var $=new kg;return function(c,H){return this.applyQuaternion($.setFromAxisAngle(c,H))}}(),applyEuler:function(){var W=new kg;return function(Q){return this.applyQuaternion(W.setFromEuler(Q))}}(),applyQuaternion:function(f){var Y=this.x,E=this.y,M=this.z,g=f._x,s=f._y,u=f._z,q=f._w,n=q*Y+s*M-u*E,k=q*E+u*Y-g*M,b=q*M+g*E-s*Y,V=-g*Y-s*E-u*M;return this.x=n*q+V*-g+k*-u-b*-s,this.y=k*q+V*-s+b*-g-n*-u,this.z=b*q+V*-u+n*-s-k*-g,this},applyMatrix4:function(u){var c=this.x,D=this.y,h=this.z,L=u.el,S=1/(L[3]*c+L[7]*D+L[11]*h+L[15]);return this.x=(L[0]*c+L[4]*D+L[8]*h+L[12])*S,this.y=(L[1]*c+L[5]*D+L[9]*h+L[13])*S,this.z=(L[2]*c+L[6]*D+L[10]*h+L[14])*S,this},applyMatrix3:function(L){var e=this.x,f=this.y,F=this.z,t=L.el;return this.x=t[0]*e+t[3]*f+t[6]*F,this.y=t[1]*e+t[4]*f+t[7]*F,this.z=t[2]*e+t[5]*f+t[8]*F,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var h=new Bb;return function(z){return this.sub(h.copy(z).multiplyScalar(2*this.dot(z)))}}(),dot:function(K){return this.x*K.x+this.y*K.y+this.z*K.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var f=this.length();return f?this.multiplyScalar(1/f):this},setLength:function(x){return this.normalize().multiplyScalar(x)},fromArray:function(O,R){return R===s&&(R=0),this.x=O[R],this.y=O[R+1],this.z=O[R+2],this},toArray:function(P,b){return P===s&&(P=[0,0,0]),b===s&&(b=0),P[b]=this.x,P[b+1]=this.y,P[b+2]=this.z,P},cross:function(H){return this.crossVectors(this,H)},angleTo:function(O){var q=this.dot(O)/Math.sqrt(this.lengthSq()*O.lengthSq());return q>1||-1>q?0:Math.acos(q)},lerp:function(m,G){return this.x+=(m.x-this.x)*G,this.y+=(m.y-this.y)*G,this.z+=(m.z-this.z)*G,this},lerpVectors:function(W,h,l){return this.subVectors(h,W).multiplyScalar(l).add(W)},crossVectors:function(v,K){var Q=v.x,z=v.y,h=v.z,A=K.x,x=K.y,i=K.z;return this.x=z*i-h*x,this.y=h*A-Q*i,this.z=Q*x-z*A,this},min:function(k){return this.x=Math.min(this.x,k.x),this.y=Math.min(this.y,k.y),this.z=Math.min(this.z,k.z),this},max:function(v){return this.x=Math.max(this.x,v.x),this.y=Math.max(this.y,v.y),this.z=Math.max(this.z,v.z),this},setFromMatrixPosition:function(f){return this.setFromMatrixColumn(f,3)},setFromMatrixScale:function(g){var A=this.setFromMatrixColumn(g,0).length(),U=this.setFromMatrixColumn(g,1).length(),T=this.setFromMatrixColumn(g,2).length();return this.x=A,this.y=U,this.z=T,this},setFromMatrixColumn:function(S,A){return this.fromArray(S.el,4*A)}}),Bb.UP=new Bb(0,1,0),Bb.AxisX=new Bb(1,0,0),Bb.AxisY=new Bb(0,1,0),Bb.AxisZ=new Bb(0,0,1);var vr=U.Math.Vector2=function(D,X,R){"object"==typeof D&&(D.x!=s?(X=D.y,R=D.e,D=D.x):(R=D[2],X=D[1],D=D[0])),this.set(D||0,X||0,R)};vr.prototype={},vr.prototype.constructor=vr;var dq=vr;z.defineProperties(vr.prototype,{width:{get:function(){return this.x},set:function(J){this.x=J}},height:{get:function(){return this.y},set:function(I){this.y=I}}}),vr.prototype.clone=function(){return new vr(this.x,this.y,this.e)},vr.prototype.copy=function(d){return this.set(d.x,d.y,d.e),this},vr.prototype.equals=function(x){return x.x===this.x&&x.y===this.y&&x.e===this.e},vr.prototype.set=function(M,N,V){return this.x=M||0,this.y=N||(0!==N?this.x:0),V!=s&&(this.e=V),this},vr.prototype.setScalar=function(X){return this.x=X,this.y=X,this.e=X,this},vr.prototype.setX=function(r){return this.x=r||0,this},vr.prototype.setY=function(R){return this.y=R||0,this},vr.prototype.setE=function(q){return this.e=q||0,this},vr.prototype.add=function(A){return this.x+=A.x,this.y+=A.y,this},vr.prototype.addVectors=function(r,M){return this.x=r.x+M.x,this.y=r.y+M.y,this},vr.prototype.addScalar=function(c){return this.x+=c,this.y+=c,this},vr.prototype.addScaledVector=function(U,y){return this.x+=U.x*y,this.y+=U.y*y,this},vr.prototype.sub=function(C){return this.x-=C.x,this.y-=C.y,this},vr.prototype.subScalar=function(C){return this.x-=C,this.y-=C,this},vr.prototype.subVectors=function(o,$){return this.x=o.x-$.x,this.y=o.y-$.y,this},vr.prototype.multiply=function(I){return this.x*=I.x,this.y*=I.y,this},vr.prototype.multiplyScalar=function(f){return this.x*=f,this.y*=f,this},vr.prototype.divide=function(P){return this.x/=P.x,this.y/=P.y,this},vr.prototype.divideScalar=function(p){return this.multiplyScalar(1/p)},vr.prototype.min=function(D){return this.x=Math.min(this.x,D.x),this.y=Math.min(this.y,D.y),this},vr.prototype.max=function(S){return this.x=Math.max(this.x,S.x),this.y=Math.max(this.y,S.y),this},vr.prototype.fromArray=function(G,f){return f===s&&(f=0),this.x=G[f],this.y=G[f+1],this},vr.prototype.clamp=function(M,I){return this.x=Math.max(M.x,Math.min(I.x,this.x)),this.y=Math.max(M.y,Math.min(I.y,this.y)),this},vr.prototype.clampScalar=function(){var N,n;return function(W,u){return N===s&&(N=new vr,n=new vr),N.set(W,W),n.set(u,u),this.clamp(N,n)}}(),vr.prototype.clampLength=function(K,A){var O=this.length();return this.multiplyScalar(Math.max(K,Math.min(A,O))/O)},vr.prototype.dot=function(f){return this.x*f.x+this.y*f.y},vr.prototype.cross=function(i){return this.x*i.y-this.y*i.x},vr.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},vr.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},vr.prototype.normalize=function(){return this.divideScalar(this.length())},vr.prototype.angle=function(){var T=Math.atan2(this.y,this.x);return 0>T&&(T+=2*Math.PI),T},vr.prototype.distanceTo=function(Z){return Math.sqrt(this.distanceToSquared(Z))},vr.prototype.distanceToSquared=function(l){var I=this.x-l.x,R=this.y-l.y;return I*I+R*R},vr.prototype.isNearEnough=function(o){return this.distanceToSquared(o)<1e-8},vr.prototype.setLength=function(i){var y=this.length();return y?this.multiplyScalar(i/y):this},vr.prototype.lerp=function(f,c){return this.x+=(f.x-this.x)*c,this.y+=(f.y-this.y)*c,"number"==typeof f.e&&"number"==typeof this.e&&(this.e+=(f.e-this.e)*c),this},vr.prototype.lerpVectors=function(g,z,u){return this.subVectors(z,g).multiplyScalar(u).add(g)},vr.prototype.rotateAround=function(f,Z){var n=f?f.x:0,m=f?f.y:0,r=Math.cos(Z),i=Math.sin(Z),C=this.x-n,s=this.y-m;return this.x=C*r-s*i+n,this.y=C*i+s*r+m,this};var wm=U.Math.Matrix3=function(){this.el=[1,0,0,0,1,0,0,0,1]};z.assign(wm.prototype,{isMatrix3:!0,set:function(J,E,c,n,R,i,t,Q,d){var x=this.el;return x[0]=J,x[1]=n,x[2]=t,x[3]=E,x[4]=R,x[5]=Q,x[6]=c,x[7]=i,x[8]=d,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(z){var n=this.el,H=z.el;return n[0]=H[0],n[1]=H[1],n[2]=H[2],n[3]=H[3],n[4]=H[4],n[5]=H[5],n[6]=H[6],n[7]=H[7],n[8]=H[8],this},setFromMatrix4:function(A){var y=A.el;return this.set(y[0],y[4],y[8],y[1],y[5],y[9],y[2],y[6],y[10]),this},applyToBufferAttribute:function(){var Y=new Bb;return function(g){for(var I=0,X=g.count;X>I;I++)Y.x=g.getX(I),Y.y=g.getY(I),Y.z=g.getZ(I),Y.applyMatrix3(this),g.setXYZ(I,Y.x,Y.y,Y.z);return g}}(),multiply:function($){return this.multiplyMatrices(this,$)},premultiply:function(n){return this.multiplyMatrices(n,this)},multiplyMatrices:function(w,U){var p=w.el,f=U.el,G=this.el,W=p[0],N=p[3],d=p[6],i=p[1],A=p[4],M=p[7],o=p[2],O=p[5],T=p[8],h=f[0],z=f[3],q=f[6],e=f[1],K=f[4],$=f[7],r=f[2],Z=f[5],c=f[8];return G[0]=W*h+N*e+d*r,G[3]=W*z+N*K+d*Z,G[6]=W*q+N*$+d*c,G[1]=i*h+A*e+M*r,G[4]=i*z+A*K+M*Z,G[7]=i*q+A*$+M*c,G[2]=o*h+O*e+T*r,G[5]=o*z+O*K+T*Z,G[8]=o*q+O*$+T*c,this},multiplyScalar:function(H){var Y=this.el;return Y[0]*=H,Y[3]*=H,Y[6]*=H,Y[1]*=H,Y[4]*=H,Y[7]*=H,Y[2]*=H,Y[5]*=H,Y[8]*=H,this},determinant:function(){var Y=this.el,S=Y[0],_=Y[1],C=Y[2],g=Y[3],w=Y[4],I=Y[5],s=Y[6],h=Y[7],m=Y[8];return S*w*m-S*I*h-_*g*m+_*I*s+C*g*h-C*w*s},getInverse:function(v){var W=v.el,u=this.el,E=W[0],G=W[1],Y=W[2],M=W[3],D=W[4],C=W[5],q=W[6],B=W[7],s=W[8],O=s*D-C*B,S=C*q-s*M,r=B*M-D*q,F=E*O+G*S+Y*r;if(0===F)return this.identity();var j=1/F;return u[0]=O*j,u[1]=(Y*B-s*G)*j,u[2]=(C*G-Y*D)*j,u[3]=S*j,u[4]=(s*E-Y*q)*j,u[5]=(Y*M-C*E)*j,u[6]=r*j,u[7]=(G*q-B*E)*j,u[8]=(D*E-G*M)*j,this},transpose:function(){var Q,g=this.el;return Q=g[1],g[1]=g[3],g[3]=Q,Q=g[2],g[2]=g[6],g[6]=Q,Q=g[5],g[5]=g[7],g[7]=Q,this},getNormalMatrix:function(A){return this.setFromMatrix4(A).getInverse(this).transpose()},transposeIntoArray:function(g){var L=this.el;return g[0]=L[0],g[1]=L[3],g[2]=L[6],g[3]=L[1],g[4]=L[4],g[5]=L[7],g[6]=L[2],g[7]=L[5],g[8]=L[8],this},setUvTransform:function(s,C,E,b,D,R,w){var N=Math.cos(D),O=Math.sin(D);this.set(E*N,E*O,-E*(N*R+O*w)+R+s,-b*O,b*N,-b*(-O*R+N*w)+w+C,0,0,1)},scale:function(d,j){var X=this.el;return X[0]*=d,X[3]*=d,X[6]*=d,X[1]*=j,X[4]*=j,X[7]*=j,this},rotate:function(f){var u=Math.cos(f),i=Math.sin(f),k=this.el,G=k[0],h=k[3],o=k[6],p=k[1],q=k[4],m=k[7];return k[0]=u*G+i*p,k[3]=u*h+i*q,k[6]=u*o+i*m,k[1]=-i*G+u*p,k[4]=-i*h+u*q,k[7]=-i*o+u*m,this},translate:function(b,H){var p=this.el;return p[0]+=b*p[2],p[3]+=b*p[5],p[6]+=b*p[8],p[1]+=H*p[2],p[4]+=H*p[5],p[7]+=H*p[8],this},equals:function(q){for(var S=this.el,H=q.el,K=0;9>K;K++)if(S[K]!==H[K])return!1;return!0},fromArray:function(h,w){w===s&&(w=0);for(var c=0;9>c;c++)this.el[c]=h[c+w];return this},toArray:function(O,U){O===s&&(O=[]),U===s&&(U=0);var C=this.el;return O[U]=C[0],O[U+1]=C[1],O[U+2]=C[2],O[U+3]=C[3],O[U+4]=C[4],O[U+5]=C[5],O[U+6]=C[6],O[U+7]=C[7],O[U+8]=C[8],O}});var Hn=U.Math.Plane=function(J,g){this.normal=J!==s?J:new Bb(1,0,0),this.constant=g!==s?g:0};z.assign(Hn.prototype,{set:function(F,z){return this.normal.copy(F),this.constant=z,this},setComponents:function(e,S,h,Y){return this.normal.set(e,S,h),this.constant=Y,this},setFromNormalAndCoplanarPoint:function(h,t){return this.normal.copy(h),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var I=new Bb,m=new Bb;return function(F,C,L){var n=I.subVectors(L,C).cross(m.subVectors(F,C)).normalize();return this.setFromNormalAndCoplanarPoint(n,F),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(q){return this.normal.copy(q.normal),this.constant=q.constant,this},normalize:function(){var b=1/this.normal.length();return this.normal.multiplyScalar(b),this.constant*=b,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(X){return this.normal.dot(X)+this.constant},distanceToSphere:function(n){return this.distanceToPoint(n.center)-n.radius},projectPoint:function(m,W){return W===s&&(W=new Bb),W.copy(this.normal).multiplyScalar(-this.distanceToPoint(m)).add(m)},intersectLine:function(){var J=new Bb;return function(P,R){R===s&&(R=new Bb);var $=P.delta(J),v=this.normal.dot($);if(0===v)return 0===this.distanceToPoint(P.start)?R.copy(P.start):s;var A=-(P.start.dot(this.normal)+this.constant)/v;return 0>A||A>1?s:R.copy($).multiplyScalar(A).add(P.start)}}(),intersectsLine:function(t){var $=this.distanceToPoint(t.start),A=this.distanceToPoint(t.end);return 0>$&&A>0||0>A&&$>0},intersectsBox:function(B){return B.intersectsPlane(this)},intersectsSphere:function(E){return E.intersectsPlane(this)},coplanarPoint:function(e){return e===s&&(e=new Bb),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var y=new Bb,g=new wm;return function(w,f){var N=f||g.getNormalMatrix(w),n=this.coplanarPoint(y).applyMatrix4(w),X=this.normal.applyMatrix3(N).normalize();return this.constant=-n.dot(X),this}}(),translate:function(Y){return this.constant-=Y.dot(this.normal),this},equals:function(j){return j.normal.equals(this.normal)&&j.constant===this.constant}});var gc=U.Math.Ray=function(c,q){this.origin=c!==s?c.clone():new Bb,this.direction=q!==s?q.clone():new Bb};z.assign(gc.prototype,{set:function(F,l){return this.origin.copy(F),this.direction.copy(l),this},clone:function(){return(new this.constructor).copy(this)},copy:function(M){return this.origin.copy(M.origin),this.direction.copy(M.direction),this.maxHitLen=M.maxHitLen,this},at:function(W,F){var x=F||new Bb;return x.copy(this.direction).multiplyScalar(W).add(this.origin)},setMaxHitLength:function(U){this.maxHitLen=U},lookAt:function(w){return this.direction.copy(w).sub(this.origin).normalize(),this},applyMatrix4:function(W){var a=this.maxHitLen;if(a){var J=this.direction.clone().multiplyScalar(a).add(this.origin);J.applyMatrix4(W)}return this.origin.applyMatrix4(W),this.direction.transformDirection(W),a&&(this.maxHitLen=this.origin.distanceTo(J)),this},distanceToPlane:function(j){var _=j.normal.dot(this.direction);if(0===_)return 0===j.distanceToPoint(this.origin)?0:null;var u=-(this.origin.dot(j.normal)+j.constant)/_;return u>=0?u:null},intersectPlane:function(C,s){var v=this.distanceToPlane(C);return null===v?null:this.at(v,s)},intersectSphere:function(){var o=new Bb;return function(c,W){o.subVectors(c.center,this.origin);var z=o.dot(this.direction),K=o.dot(o)-z*z,x=c.radius*c.radius;if(K>x)return null;var $=Math.sqrt(x-K),D=z-$,n=z+$;return 0>D&&0>n?null:0>D?this.at(n,W):this.at(D,W)}}(),intersectEllipsoid:function(){var j=new Bb,R=new Bb;return function(F,q){j.subVectors(F.center,this.origin),j.divide(F.radius),R.divideVectors(this.direction,F.radius);var x=R.lengthSq(),G=j.dot(R),m=j.dot(j)*x-G*G;if(m>x)return null;var W=Math.sqrt(x-m),L=(G-W)/x,u=(G+W)/x;return 0>L&&0>u?null:0>L?this.at(u,q):this.at(L,q)}}(),intersectBox:function(J,w){var L,A,s,o,V,F,N=1/this.direction.x,P=1/this.direction.y,$=1/this.direction.z,g=this.origin;if(N>=0?(L=(J.min.x-g.x)*N,A=(J.max.x-g.x)*N):(L=(J.max.x-g.x)*N,A=(J.min.x-g.x)*N),P>=0?(s=(J.min.y-g.y)*P,o=(J.max.y-g.y)*P):(s=(J.max.y-g.y)*P,o=(J.min.y-g.y)*P),L>o||s>A)return null;if((s>L||L!==L)&&(L=s),(A>o||A!==A)&&(A=o),$>=0?(V=(J.min.z-g.z)*$,F=(J.max.z-g.z)*$):(V=(J.max.z-g.z)*$,F=(J.min.z-g.z)*$),L>F||V>A)return null;if((V>L||L!==L)&&(L=V),(A>F||A!==A)&&(A=F),0>A)return null;var v=L>=0?L:A,D=this.maxHitLen;return D&&v>D?null:this.at(v,w)},intersectTriangle:function(){var V=new Bb,U=new Bb,A=new Bb,j=new Bb;return function(L,K,P,k,Q){U.subVectors(K,L),A.subVectors(P,L),j.crossVectors(U,A);var g,Z=this.direction.dot(j);if(Z>0){if(k)return null;g=1}else{if(!(0>Z))return null;g=-1,Z=-Z}V.subVectors(this.origin,L);var r=g*this.direction.dot(A.crossVectors(V,A));if(0>r)return null;var _=g*this.direction.dot(U.cross(V));if(0>_||r+_>Z)return null;var T=-g*V.dot(j);if(0>T)return null;var W=T/Z,i=this.maxHitLen;return i&&W>i?null:this.at(W,Q)}}()});var el=U.Math.Box3=function(w,q){this.min=w!==s?w:new Bb(1/0,1/0,1/0),this.max=q!==s?q:new Bb(-1/0,-1/0,-1/0)};z.assign(el.prototype,{set:function(Y,o){return this.min.copy(Y),this.max.copy(o),this},setFromArray:function(f){for(var u=1/0,E=1/0,d=1/0,M=-1/0,Q=-1/0,X=-1/0,L=0,G=f.length;G>L;L+=3){var k=f[L],_=f[L+1],R=f[L+2];u>k&&(u=k),E>_&&(E=_),d>R&&(d=R),k>M&&(M=k),_>Q&&(Q=_),R>X&&(X=R)}return this.min.set(u,E,d),this.max.set(M,Q,X),this},setFromPoints:function(N){this.makeEmpty();for(var h=0,w=N.length;w>h;h++)this.expandByPoint(N[h]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(V){return V.max.x<this.min.x||V.min.x>this.max.x||V.max.y<this.min.y||V.min.y>this.max.y||V.max.z<this.min.z||V.min.z>this.max.z?!1:!0},copy:function(f){return this.min.copy(f.min),this.max.copy(f.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(y){return this.min.min(y),this.max.max(y),this},expandByBox:function(q){return this.min.min(q.min),this.max.max(q.max),this},applyMatrix4:function(){var v=[new Bb,new Bb,new Bb,new Bb,new Bb,new Bb,new Bb,new Bb];return function(e){return this.isEmpty()?this:(v[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),v[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),v[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),v[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),v[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),v[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),v[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),v[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(v),this)}}()});var ho=U.Math.Sphere=function(B,J){this.center=B!==s?B:new Bb,this.radius=J!==s?J:0};z.assign(ho.prototype,{set:function(L,E){return this.center.copy(L),this.radius=E,this},setFromPoints:function(){var g=new el;return function(E,C){var Y=this.center;C!==s?Y.copy(C):g.setFromPoints(E).getCenter(Y);for(var Z=0,d=0,q=E.length;q>d;d++)Z=Math.max(Z,Y.distanceToSquared(E[d]));return this.radius=Math.sqrt(Z),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function($){return this.center.copy($.center),this.radius=$.radius,this},empty:function(){return this.radius<=0},containsPoint:function(p){return p.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(P){return P.distanceTo(this.center)-this.radius},intersectsSphere:function(o){var f=this.radius+o.radius;return o.center.distanceToSquared(this.center)<=f*f},intersectsBox:function(v){return v.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(I,d){var V=this.center.distanceToSquared(I);return d===s&&(d=new Bb),d.copy(I),V>this.radius*this.radius&&(d.sub(this.center).normalize(),d.multiplyScalar(this.radius).add(this.center)),d},getBoundingBox:function(O){return O===s&&(O=new el),O.set(this.center,this.center),O.expandByScalar(this.radius),O},applyMatrix4:function(I){return this.center.applyMatrix4(I),this.radius=this.radius*I.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(H){return H.center.equals(this.center)&&H.radius===this.radius}});var qg=U.Math.Frustum=function(e,m,N,z,H,Q){this.planes=[e!==s?e:new Hn,m!==s?m:new Hn,N!==s?N:new Hn,z!==s?z:new Hn,H!==s?H:new Hn,Q!==s?Q:new Hn]};z.assign(qg.prototype,{set:function(Q,B,S,f,M,Z){var n=this.planes;return n[0].copy(Q),n[1].copy(B),n[2].copy(S),n[3].copy(f),n[4].copy(M),n[5].copy(Z),this},clone:function(){return(new this.constructor).copy(this)},copy:function(O){for(var L=this.planes,D=0;6>D;D++)L[D].copy(O.planes[D]);return this},setFromMatrix:function(b){var W=this.planes,L=b.el,S=L[0],O=L[1],E=L[2],R=L[3],o=L[4],w=L[5],d=L[6],$=L[7],Y=L[8],c=L[9],J=L[10],z=L[11],H=L[12],Q=L[13],h=L[14],l=L[15];return W[0].setComponents(R-S,$-o,z-Y,l-H).normalize(),W[1].setComponents(R+S,$+o,z+Y,l+H).normalize(),W[2].setComponents(R+O,$+w,z+c,l+Q).normalize(),W[3].setComponents(R-O,$-w,z-c,l-Q).normalize(),W[4].setComponents(R-E,$-d,z-J,l-h).normalize(),W[5].setComponents(R+E,$+d,z+J,l+h).normalize(),this},intersectsObject:function(){var t=new ho;return function(r){var z=r.geometry;return null===z.boundingSphere&&z.computeBoundingSphere(),t.copy(z.boundingSphere).applyMatrix4(r.matrixWorld),this.intersectsSphere(t)}}(),intersectsSprite:function(){var V=new ho;return function(U){return V.center.set(0,0,0),V.radius=.7071067811865476,V.applyMatrix4(U.matrixWorld),this.intersectsSphere(V)}}(),intersectsSphere:function(P){for(var G=this.planes,t=P.center,Z=-P.radius,i=0;6>i;i++){var W=G[i].distanceToPoint(t);if(Z>W)return!1}return!0},intersectsBox:function(){var v=new Bb;return function(J){for(var X=this.planes,A=0;6>A;A++){var m=X[A];if(v.x=m.normal.x>0?J.max.x:J.min.x,v.y=m.normal.y>0?J.max.y:J.min.y,v.z=m.normal.z>0?J.max.z:J.min.z,m.distanceToPoint(v)<0)return!1}return!0}}(),containsPoint:function(p){for(var Z=this.planes,s=0;6>s;s++)if(Z[s].distanceToPoint(p)<0)return!1;return!0}});var cr=U.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};z.assign(cr.prototype,{set:function(Y,X,c,W,_,P,O,H,A,u,b,N,K,e,p,G){var E=this.el;return E[0]=Y,E[4]=X,E[8]=c,E[12]=W,E[1]=_,E[5]=P,E[9]=O,E[13]=H,E[2]=A,E[6]=u,E[10]=b,E[14]=N,E[3]=K,E[7]=e,E[11]=p,E[15]=G,this},clone:function(){return(new cr).fromArray(this.el)},fromArray:function(n,I){I===s&&(I=0);for(var P=this.el,A=0;16>A;A++)P[A]=n[A+I];return this},getElements:function(){return this.el},scale:function(q){var A=this.el,U=q.x,I=q.y,u=q.z;return A[0]*=U,A[4]*=I,A[8]*=u,A[1]*=U,A[5]*=I,A[9]*=u,A[2]*=U,A[6]*=I,A[10]*=u,A[3]*=U,A[7]*=I,A[11]*=u,this},makeRotationFromEuler:function($){var B=this.el,o=$._x,Z=$._y,t=$._z,v=$._order,c=Math.cos(o),O=Math.sin(o),Q=Math.cos(Z),g=Math.sin(Z),r=Math.cos(t),q=Math.sin(t);if("XYZ"===v){var k=c*r,U=c*q,u=O*r,W=O*q;B[0]=Q*r,B[4]=-Q*q,B[8]=g,B[1]=U+u*g,B[5]=k-W*g,B[9]=-O*Q,B[2]=W-k*g,B[6]=u+U*g,B[10]=c*Q}else if("YXZ"===v){var p=Q*r,i=Q*q,l=g*r,j=g*q;B[0]=p+j*O,B[4]=l*O-i,B[8]=c*g,B[1]=c*q,B[5]=c*r,B[9]=-O,B[2]=i*O-l,B[6]=j+p*O,B[10]=c*Q}else if("ZXY"===v){var p=Q*r,i=Q*q,l=g*r,j=g*q;B[0]=p-j*O,B[4]=-c*q,B[8]=l+i*O,B[1]=i+l*O,B[5]=c*r,B[9]=j-p*O,B[2]=-c*g,B[6]=O,B[10]=c*Q}else if("ZYX"===v){var k=c*r,U=c*q,u=O*r,W=O*q;B[0]=Q*r,B[4]=u*g-U,B[8]=k*g+W,B[1]=Q*q,B[5]=W*g+k,B[9]=U*g-u,B[2]=-g,B[6]=O*Q,B[10]=c*Q}else if("YZX"===v){var x=c*Q,S=c*g,s=O*Q,E=O*g;B[0]=Q*r,B[4]=E-x*q,B[8]=s*q+S,B[1]=q,B[5]=c*r,B[9]=-O*r,B[2]=-g*r,B[6]=S*q+s,B[10]=x-E*q}else if("XZY"===v){var x=c*Q,S=c*g,s=O*Q,E=O*g;B[0]=Q*r,B[4]=-q,B[8]=g*r,B[1]=x*q+E,B[5]=c*r,B[9]=S*q-s,B[2]=s*q-S,B[6]=O*r,B[10]=E*q+x}return B[3]=0,B[7]=0,B[11]=0,B[12]=0,B[13]=0,B[14]=0,B[15]=1,this},makeRotationFromQuaternion:function(u){var P=this.el,$=u._x,n=u._y,S=u._z,A=u._w,o=$+$,H=n+n,y=S+S,f=$*o,K=$*H,L=$*y,d=n*H,M=n*y,W=S*y,C=A*o,x=A*H,Z=A*y;return P[0]=1-(d+W),P[4]=K-Z,P[8]=L+x,P[1]=K+Z,P[5]=1-(f+W),P[9]=M-C,P[2]=L-x,P[6]=M+C,P[10]=1-(f+d),P[3]=0,P[7]=0,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(T){var L=this.el,Q=T.el,k=Q[0],D=Q[1],b=Q[2],v=Q[3],c=Q[4],A=Q[5],R=Q[6],z=Q[7],d=Q[8],s=Q[9],S=Q[10],a=Q[11],m=Q[12],j=Q[13],f=Q[14],I=Q[15],x=s*f*z-j*S*z+j*R*a-A*f*a-s*R*I+A*S*I,r=m*S*z-d*f*z-m*R*a+c*f*a+d*R*I-c*S*I,y=d*j*z-m*s*z+m*A*a-c*j*a-d*A*I+c*s*I,K=m*s*R-d*j*R-m*A*S+c*j*S+d*A*f-c*s*f,Z=k*x+D*r+b*y+v*K;if(0===Z)return this.identity();var h=1/Z;return L[0]=x*h,L[1]=(j*S*v-s*f*v-j*b*a+D*f*a+s*b*I-D*S*I)*h,L[2]=(A*f*v-j*R*v+j*b*z-D*f*z-A*b*I+D*R*I)*h,L[3]=(s*R*v-A*S*v-s*b*z+D*S*z+A*b*a-D*R*a)*h,L[4]=r*h,L[5]=(d*f*v-m*S*v+m*b*a-k*f*a-d*b*I+k*S*I)*h,L[6]=(m*R*v-c*f*v-m*b*z+k*f*z+c*b*I-k*R*I)*h,L[7]=(c*S*v-d*R*v+d*b*z-k*S*z-c*b*a+k*R*a)*h,L[8]=y*h,L[9]=(m*s*v-d*j*v-m*D*a+k*j*a+d*D*I-k*s*I)*h,L[10]=(c*j*v-m*A*v+m*D*z-k*j*z-c*D*I+k*A*I)*h,L[11]=(d*A*v-c*s*v-d*D*z+k*s*z+c*D*a-k*A*a)*h,L[12]=K*h,L[13]=(d*j*b-m*s*b+m*D*S-k*j*S-d*D*f+k*s*f)*h,L[14]=(m*A*b-c*j*b-m*D*R+k*j*R+c*D*f-k*A*f)*h,L[15]=(c*s*b-d*A*b+d*D*R-k*s*R-c*D*S+k*A*S)*h,this},makeRotationAxis:function(X,f){var o=Math.cos(f),$=Math.sin(f),J=1-o,H=X.x,z=X.y,C=X.z,a=J*H,A=J*z;return this.set(a*H+o,a*z-$*C,a*C+$*z,0,a*z+$*C,A*z+o,A*C-$*H,0,a*C-$*z,A*C+$*H,J*C*C+o,0,0,0,0,1),this},multiply:function(q){return this.multiplyMatrices(this,q)},premultiply:function(r){return this.multiplyMatrices(r,this)},multiplyMatrices:function(Z,i){var P=Z.el,e=i.el,Q=this.el,z=P[0],S=P[4],F=P[8],r=P[12],A=P[1],l=P[5],V=P[9],N=P[13],C=P[2],J=P[6],k=P[10],W=P[14],D=P[3],H=P[7],f=P[11],Y=P[15],m=e[0],I=e[4],v=e[8],u=e[12],g=e[1],j=e[5],w=e[9],L=e[13],E=e[2],q=e[6],x=e[10],h=e[14],B=e[3],X=e[7],$=e[11],G=e[15];return Q[0]=z*m+S*g+F*E+r*B,Q[4]=z*I+S*j+F*q+r*X,Q[8]=z*v+S*w+F*x+r*$,Q[12]=z*u+S*L+F*h+r*G,Q[1]=A*m+l*g+V*E+N*B,Q[5]=A*I+l*j+V*q+N*X,Q[9]=A*v+l*w+V*x+N*$,Q[13]=A*u+l*L+V*h+N*G,Q[2]=C*m+J*g+k*E+W*B,Q[6]=C*I+J*j+k*q+W*X,Q[10]=C*v+J*w+k*x+W*$,Q[14]=C*u+J*L+k*h+W*G,Q[3]=D*m+H*g+f*E+Y*B,Q[7]=D*I+H*j+f*q+Y*X,Q[11]=D*v+H*w+f*x+Y*$,Q[15]=D*u+H*L+f*h+Y*G,this},lookAt:function(){var t=new Bb;return function(c,K,q){return t.subVectors(c,K),this.lookAtDirection(t,q)}}(),lookAtDirection:function(){var m=new Bb,F=new Bb,g=new Bb;return function(f,U){U||(U=Bb.UP);var M=this.el;return g.copy(f),0===g.lengthSq()&&(g.z=1),g.normalize(),m.crossVectors(U,g),0===m.lengthSq()&&(1===Math.abs(U.z)?g.x+=1e-4:g.z+=1e-4,g.normalize(),m.crossVectors(U,g)),m.normalize(),F.crossVectors(g,m),M[0]=m.x,M[4]=F.x,M[8]=g.x,M[1]=m.y,M[5]=F.y,M[9]=g.y,M[2]=m.z,M[6]=F.z,M[10]=g.z,this}}(),extractScale:function(){var W;return function(r){W===s&&(W=new Bb),r===s&&(r=new Bb);var V=W.setFromMatrixColumn(this,0).length(),u=W.setFromMatrixColumn(this,1).length(),B=W.setFromMatrixColumn(this,2).length();return r.set(V,u,B),r}}(),extractRotation:function(){var b;return function(D){b===s&&(b=new Bb),D===s&&(D=new cr);var C=this.el,K=D.el,z=1/b.setFromMatrixColumn(D,0).length(),O=1/b.setFromMatrixColumn(D,1).length(),T=1/b.setFromMatrixColumn(D,2).length();return C[0]=K[0]*z,C[1]=K[1]*z,C[2]=K[2]*z,C[4]=K[4]*O,C[5]=K[5]*O,C[6]=K[6]*O,C[8]=K[8]*T,C[9]=K[9]*T,C[10]=K[10]*T,this}}(),multiplyScalar:function(F){var s=this.el;return s[0]*=F,s[4]*=F,s[8]*=F,s[12]*=F,s[1]*=F,s[5]*=F,s[9]*=F,s[13]*=F,s[2]*=F,s[6]*=F,s[10]*=F,s[14]*=F,s[3]*=F,s[7]*=F,s[11]*=F,s[15]*=F,this},getPosition:function(q){return q===s&&(q=new Bb),q.setFromMatrixColumn(this,3)},setPosition:function(Z){var e=this.el;return e[12]=Z.x,e[13]=Z.y,e[14]=Z.z,this},toArray:function(S,r){S===s&&(S=[]),r===s&&(r=0);var b=this.el;return S[r]=b[0],S[r+1]=b[1],S[r+2]=b[2],S[r+3]=b[3],S[r+4]=b[4],S[r+5]=b[5],S[r+6]=b[6],S[r+7]=b[7],S[r+8]=b[8],S[r+9]=b[9],S[r+10]=b[10],S[r+11]=b[11],S[r+12]=b[12],S[r+13]=b[13],S[r+14]=b[14],S[r+15]=b[15],S},determinant:function(){var Y=this.el,D=Y[0],U=Y[4],F=Y[8],h=Y[12],$=Y[1],t=Y[5],V=Y[9],b=Y[13],z=Y[2],I=Y[6],i=Y[10],j=Y[14],l=Y[3],P=Y[7],v=Y[11],g=Y[15];return l*(+h*V*I-F*b*I-h*t*i+U*b*i+F*t*j-U*V*j)+P*(+D*V*j-D*b*i+h*$*i-F*$*j+F*b*z-h*V*z)+v*(+D*b*I-D*t*j-h*$*I+U*$*j+h*t*z-U*b*z)+g*(-F*t*z-D*V*I+D*t*i+F*$*I-U*$*i+U*V*z)},copy:function(H){var P=this.el,N=H.el;return P[0]=N[0],P[1]=N[1],P[2]=N[2],P[3]=N[3],P[4]=N[4],P[5]=N[5],P[6]=N[6],P[7]=N[7],P[8]=N[8],P[9]=N[9],P[10]=N[10],P[11]=N[11],P[12]=N[12],P[13]=N[13],P[14]=N[14],P[15]=N[15],this},compose:function(L,s,q){var Q=this.el,R=s._x,e=s._y,a=s._z,E=s._w,m=R+R,H=e+e,M=a+a,l=R*m,g=R*H,C=R*M,O=e*H,x=e*M,t=a*M,f=E*m,P=E*H,o=E*M,T=q.x,Z=q.y,S=q.z;return Q[0]=(1-(O+t))*T,Q[1]=(g+o)*T,Q[2]=(C-P)*T,Q[3]=0,Q[4]=(g-o)*Z,Q[5]=(1-(l+t))*Z,Q[6]=(x+f)*Z,Q[7]=0,Q[8]=(C+P)*S,Q[9]=(x-f)*S,Q[10]=(1-(l+O))*S,Q[11]=0,Q[12]=L.x,Q[13]=L.y,Q[14]=L.z,Q[15]=1,this},decompose:function(){var X=new Bb,U=new cr;return function(P,k,J){var I=this.el,o=X.set(I[0],I[1],I[2]).length(),E=X.set(I[4],I[5],I[6]).length(),s=X.set(I[8],I[9],I[10]).length(),$=this.determinant();0>$&&(o=-o),P.x=I[12],P.y=I[13],P.z=I[14],U.copy(this);var C=1/o,D=1/E,e=1/s;return U.el[0]*=C,U.el[1]*=C,U.el[2]*=C,U.el[4]*=D,U.el[5]*=D,U.el[6]*=D,U.el[8]*=e,U.el[9]*=e,U.el[10]*=e,k.setFromRotationMatrix(U),J.x=o,J.y=E,J.z=s,this}}()});var jk=U.Math.Triangle=function(M,i,d){this.a=M!==s?M:new Bb,this.b=i!==s?i:new Bb,this.c=d!==s?d:new Bb};z.assign(jk,{barycoordFromPoint:function(){var c=new Bb,b=new Bb,Z=new Bb;return function(D,t,h,i,U){c.subVectors(i,t),b.subVectors(h,t),Z.subVectors(D,t);
var r=c.dot(c),o=c.dot(b),q=c.dot(Z),p=b.dot(b),S=b.dot(Z),z=r*p-o*o,T=U||new Bb;if(0===z)return T.set(-2,-1,-1);var y=1/z,W=(p*q-o*S)*y,N=(r*S-o*q)*y;return T.set(1-W-N,N,W)}}(),uvIntersection:function(){var M=new Bb;return function(z,O,x,K,q,g,Q){return jk.barycoordFromPoint(z,O,x,K,M),q.multiplyScalar(M.x),g.multiplyScalar(M.y),Q.multiplyScalar(M.z),q.add(g).add(Q),q.clone()}}()});var qj=U.Math.Euler=function(D,e,d,T,z){this.set(D,e,d,T,z)};qj.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],qj.DefaultOrder="XYZ",qj.ReverseOrder=function(){var d={xyz:"ZYX",xzy:"YZX",yxz:"ZXY",yzx:"XZY",zxy:"YXZ",zyx:"XYZ"};return function(E){return d[E]}}(),z.defineProperties(qj.prototype,{x:{get:function(){return this._x},set:function(Q){this._x=Q,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(y){this._y=y,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(d){this._z=d,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(X){this._order=X,this.onChangeCallback()}}}),z.assign(qj.prototype,{set:function(j,b,a,f,Q){return Vd(j)&&(Q=a,f=b,a=j[2],b=j[1],j=j[0]),f?Q&&(f=qj.ReverseOrder(f)):f="ZYX",this._x=j||0,this._y=b||0,this._z=a||0,this._order=f||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(F){return this._x=F._x,this._y=F._y,this._z=F._z,this._order=F._order,this.onChangeCallback(),this},setFromRotationMatrix:function(h,m,t){var a=U.Math.clamp,W=h.el||h,F=W[0],c=W[4],e=W[8],C=W[1],T=W[5],u=W[9],y=W[2],X=W[6],V=W[10];return m=m||this._order,"XYZ"===m?(this._y=Math.asin(a(e,-1,1)),Math.abs(e)<.99999?(this._x=Math.atan2(-u,V),this._z=Math.atan2(-c,F)):(this._x=Math.atan2(X,T),this._z=0)):"YXZ"===m?(this._x=Math.asin(-a(u,-1,1)),Math.abs(u)<.99999?(this._y=Math.atan2(e,V),this._z=Math.atan2(C,T)):(this._y=Math.atan2(-y,F),this._z=0)):"ZXY"===m?(this._x=Math.asin(a(X,-1,1)),Math.abs(X)<.99999?(this._y=Math.atan2(-y,V),this._z=Math.atan2(-c,T)):(this._y=0,this._z=Math.atan2(C,F))):"ZYX"===m?(this._y=Math.asin(-a(y,-1,1)),Math.abs(y)<.99999?(this._x=Math.atan2(X,V),this._z=Math.atan2(C,F)):(this._x=0,this._z=Math.atan2(-c,T))):"YZX"===m?(this._z=Math.asin(a(C,-1,1)),Math.abs(C)<.99999?(this._x=Math.atan2(-u,T),this._y=Math.atan2(-y,F)):(this._x=0,this._y=Math.atan2(e,V))):"XZY"===m?(this._z=Math.asin(-a(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(X,T),this._y=Math.atan2(e,F)):(this._x=Math.atan2(-u,V),this._y=0)):console.warn("unsupported order: "+m),this._order=m,t!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var n=new cr;return function(r,s,H){return n.makeRotationFromQuaternion(r),this.setFromRotationMatrix(n,s,H)}}(),setFromVector3:function(X,s){return this.set(X.x,X.y,X.z,s||this._order)},reorder:function(){var V=new kg;return function(m){return V.setFromEuler(this),this.setFromQuaternion(V,m)}}(),equals:function(V){return V._x===this._x&&V._y===this._y&&V._z===this._z&&V._order===this._order},fromArray:function(_){return this._x=_[0],this._y=_[1],this._z=_[2],_[3]!==s&&(this._order=_[3]),this.onChangeCallback(),this},toArray:function(o,w){return o===s&&(o=[]),w===s&&(w=0),o[w]=this._x,o[w+1]=this._y,o[w+2]=this._z,o[w+3]=this._order,o},toVector3:function(O){return O?O.set(this._x,this._y,this._z):new Bb(this._x,this._y,this._z)},onChange:function(X){return this.onChangeCallback=X,this},onChangeCallback:function(){}});var xn={ms_ac:function(u,Q){for(var O=Q.ms_ac,e=0;e<O.length;e++)Om(u,O[e])},ms_listener:function(A){A.addListeners=function(){var $=this,L=Rm;p.mockTouch&&(L=xg.concat(Dh).concat(ip)),$.__events__=L;for(var P=0,W=L.length;W>P;P++){var V=L[P];"wheel"===V&&!$.handle_wheel&&$.handle_mousewheel&&($.handle_wheel=function(C){Hi($,C)}),$["handle_"+V]&&Xb(V,$.getView(),$)}},A.removeListeners=function(){var y=this,i=y.__events__;if(i){y.__events__=s;for(var Z=0,D=i.length;D>Z;Z++)y["handle_"+i[Z]]&&Bs(i[Z],y.getView(),y)}}},ms_fire:function(o){o.mp=function(J,Q,L){this.addPropertyChangeListener(J,Q,L)},o.ump=function(h,j){this.removePropertyChangeListener(h,j)},o.fp=function(S,Z,c,L,R){return this.firePropertyChange(S,Z,c,L,R)},o.addPropertyChangeListener=function(l,N,E){var x=this;x._62I||(x._62I=new Ri),x._62I.add(l,N,E)},o.removePropertyChangeListener=function(R,S){this._62I&&this._62I.remove(R,S)},o.firePropertyChange=function(X,W,c,y,b){if(y){if(y(W,c))return!1}else if(W===c)return!1;var B=this,_=b||{};return _.property=X,_.oldValue=W,_.newValue=c,_.source=B,_.data=B,B._62I&&B._62I.fire(_),B.onPropertyChanged&&B.onPropertyChanged(_),!0}},ms_attr:function(o){o.a=function(_,h){var j=this;if(2===arguments.length)j.setAttr(_,h);else{if(!Np(_))return j.getAttr(_);for(var u in _)j.setAttr(u,_[u])}return j},o.getAttr=function(W,Y){if(Y===s&&(Y=1),this._attrObject&&W in this._attrObject)return this._attrObject[W];if(this.getImage){var J=this.getImage();if(Xj(J)&&(J=Dr[J]),Np(J)&&"dataBindings"in J)for(var Z=J.dataBindings,L=Z.length-1;L>=0;L--){var D=Z[L];if(D.attr===W){if("defaultValue"in D)return D.defaultValue;break}}}return Y?M[W]:s},o.setAttr=function(A,T){var Q=this;Q._attrObject||(Q._attrObject={});var h=Q._attrObject[A];T===s?delete Q._attrObject[A]:Q._attrObject[A]=T,Q.fp&&Q.fp("a:"+A,h,T)&&Q.onAttrChanged&&Q.onAttrChanged(A,h,T)},o.getSerializableAttrs=function(){var r,h={};for(r in this._attrObject)h[r]=1;return h}},ms_bnb:function(e){e.getBodyColor=function(U){return U.s("body.color")},e.getBorderColor=function(Q){return Q.s("border.color")}},_51o:function(J){J.mi=function(o,D,s){this.addInteractorListener(o,D,s)},J.umi=function(q,b){this.removeInteractorListener(q,b)},J.fi=function(N){this.fireInteractorEvent(N)},J.addInteractorListener=function(a,M,n){var H=this;H._63I||(H._63I=new Ri),H._63I.add(a,M,n)},J.removeInteractorListener=function(R,c){this._63I&&this._63I.remove(R,c)},J.fireInteractorEvent=function(n){this._63I&&this._63I.fire(n)},J.setInteractors=function(D){var b=this,S=b._interactors;S&&S.each(function(F){F.tearDown()}),Vd(D)&&(D=new Yn(D)),b._interactors=D,D&&D.each(function(O){O.setUp()}),b.fp("interactors",S,D),b.invalidateSelection()},J.getInteractors=function(){return this._interactors}},_49o:function(s){s._44O=g,s._45O=g,s.getTopPainters=function(){return this._44O},s.getBottomPainters=function(){return this._45O},s.addTopPainter=function(d){var m=this;m._44O||(m._44O=new Yn),m._44O.contains(d)||(m._44O.add(d),m.redraw&&m.redraw())},s.removeTopPainter=function(c){var Z=this;Z._44O&&(Z._44O.remove(c),Z.redraw&&Z.redraw())},s.addBottomPainter=function(n){var G=this;G._45O||(G._45O=new Yn),G._45O.contains(n)||(G._45O.add(n),G.redraw&&G.redraw())},s.removeBottomPainter=function(J){var L=this;L._45O&&(L._45O.remove(J),L.redraw&&L.redraw())},s._93db=function(L,e){var q=this;q._45O&&q._45O.each(function(k){k.draw?k.draw(L,e):k.call(q,L,e)})},s._92db=function(D,Y){var T=this;T._44O&&T._44O.each(function(f){f.draw?f.draw(D,Y):f.call(T,D,Y)})}},ms_sm:function(H){H.sm=function(){return this.getSelectionModel()},H.setSelectableFunc=function(S){this.sm().setFilterFunc(S)},H.getSelectableFunc=function(){return this.sm().getFilterFunc()},H.getSelectionModel=function(){var D=this;return D._selectionModel?D._selectionModel:D.dm().sm()},H.isSelectionModelShared=function(){return!this._selectionModel},H.setSelectionModelShared=function(Z){var E=this,V=E.sm(),n=!E._selectionModel,H=E.handleSelectionChange,N=E.dm();n!==Z&&(E.invalidateSelection&&E.invalidateSelection(),Z?(N.sm().ms(H,E),E._selectionModel.ums(H,E),E._selectionModel.dispose(),E._selectionModel=g):(N.sm().ums(H,E),E._selectionModel=new Gr(N),E._selectionModel.ms(H,E)),E.onSelectionModelSharedChanged(),E.fp("selectionModelShared",n,Z),E.fireViewEvent({kind:"selectionModelSharedChange",oldValue:n,newValue:Z,oldSelectionModel:V,newSelectionModel:E.sm()}))},H.onSelectionModelSharedChanged=function(){var s=this;s.redraw(),s.invalidateSelection&&s.invalidateSelection()},H.removeSelection=function(){var A=this.dm();A.beginTransaction(),this.sm().toSelection().each(A.remove,A),A.endTransaction()},H.selectAll=function(){var P=this;P.sm().ss(P.dm().toDatas(function($){return P.isVisible($)&&P.isSelectable($)}))},H.isSelected=function(j){return this.sm().co(j)},H.isSelectedById=function(e){var $=this.dm().getDataById(e);return $?this.isSelected($):!1},H.isSelectable=function(a){return this.sm().isSelectable(a)}},ms_tx:function(X){X._64I=0,X._65O=0,X.isScrollable=function(){return this.getWidth()<this._64I},X._40o=function(){return this.isScrollable()},X.getLogicalPoint=function(j){return dc(j,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},X.tx=function(S){return S===s?this.getTranslateX():(this.setTranslateX(S),void 0)},X.getTranslateX=function(){return this._65O},X.setTranslateX=function(T){var s=this,V=s.getWidth()-s._64I;V>T&&(T=V),T>0&&(T=0),T=A(T);var d=s._65O;s._65O=T,s.fp(Sj,d,T)}},ms_ty:function(Y){Y._23Q=0,Y._66O=0,Y._41o=function(){return this.getHeight()<this._23Q},Y.getLogicalPoint=function(y){return dc(y,this._canvas||this._view,this.tx?this.tx():0,this.ty())},Y.ty=function(t){return t===s?this.getTranslateY():(this.setTranslateY(t),void 0)},Y.getTranslateY=function(){return this._66O},Y.setTranslateY=function(Z){var s=this,H=s.getHeight()-s._23Q;H>Z&&(Z=H),Z>0&&(Z=0),Z=A(Z);var n=s._66O;s._66O=Z,s.fp(Hq,n,Z)}},ms_txy:function(G){G._65O=0,G._66O=0,G.tx=function(C){return C===s?this.getTranslateX():(this.setTranslateX(C),void 0)},G.ty=function(g){return g===s?this.getTranslateY():(this.setTranslateY(g),void 0)},G.onTranslateEnded=function(){},G.setTranslate=function(R,T,M){var H=this;if(M=sj(M)){H._65I&&H._65I.stop(!0);var c=H.tx(),e=H.ty();M.action=function(N){H.setTranslate(c+(R-c)*N,e+(T-e)*N)},M._37o=function(){delete H._66I,delete H._65I,H.onTranslateEnded()},H._66I=1,H._65I=Qc(M)}else H.tx(R),H.ty(T)},G.getTranslateX=function(){return this._65O},G.setTranslateX=function(L){var M=this;L=M.adjustTranslateX(L);var f=M._65O;M._65O=L,M.fp(Sj,f,L)},G.getTranslateY=function(){return this._66O},G.setTranslateY=function(h){var L=this;h=L.adjustTranslateY(h);var Q=L._66O;L._66O=h,L.fp(Hq,Q,h)},G.adjustTranslateX=function(i){return A(i)},G.adjustTranslateY=function(c){return A(c)},G.translate=function(g,a,l){this.setTranslate(this.tx()+g,this.ty()+a,l)},G.getLogicalPoint=function(j){var R=this;return dc(j,this._canvas||R._view,R.tx(),R.ty())}},ms_dm:function(u){u.dm=function(V){return V?(this.setDataModel(V),void 0):this.getDataModel()},u.getDataModel=function(){return this._dataModel}},ms_lp:function(K){K.lp=function(o){return this.getLogicalPoint(o)}},ms_v:function(F){F._disabled=!1,F.setDisabled=function(B,s){var Y=this,P=Y._disabled;P!==B&&(P&&(cn(Y._63O),delete Y._63O),B&&(ib(Y._view,Y._63O=Jm(s)),Y.iv()),Y._disabled=B,Y.fp("disabled",P,B))},F.isDisabled=function(){return this._disabled},F.getDisabledDiv=function(){return this._63O},F.getView=function(){return this._view},F.addToDOM=function(t){var K=this,i=K.getView(),R=i.style;t=t||o.body,t.appendChild(i),R.left="0",R.right="0",R.top="0",R.bottom="0",C(q,"resize",function(){K.iv()}),K.iv()},F.setCursor=function(d){"default"===d&&(d=this._defaultCursor||d);var M=this.getView().style;M.cursor=d,M.cursor="-webkit-"+d,M.cursor="-moz-"+d},F.getWidth=function(){return this._view.clientWidth},F.getHeight=function(){return this._view.clientHeight},F.setWidth=function(e){var u=this;u._view.style.width=e+zk,u.iv(),u.fp&&u.fp(Ap,g,e)},F.setHeight=function(S){var D=this;D._view.style.height=S+zk,D.iv(),D.fp&&D.fp(Xk,g,S)},F.setFocus=function(Z){var q=this,E=q._currentEditor;return Z&&E&&(E.getView&&(E=E.getView()),E.contains(Z.target))?!1:(jf(q._view),q.endEditing&&q.endEditing(),q.fireViewEvent("focus"),!0)},F.iv=function(P){this.invalidate(P)},F.invalidate=function(_){var p=this;p._68I||(p._68I=1,oq(p.validate,p,g,_),p.onInvalidated&&p.onInvalidated(),p.fireViewEvent("invalidate"))},F.validate=function(){var n=this,R=n._view;if(n._68I&&(delete n._68I,R.parentNode))if(0===R.offsetWidth&&0===R.offsetHeight&&n._67I!==g)n._67I===s&&(n._67I=p.reinvalidateCount),n._67I>0?n._67I--:n._67I=g,n.iv();else{n.fireViewEvent("beginValidate"),n.validateImpl(),n.onValidated&&n.onValidated(),n.fireViewEvent("validate");var K=n._63O;K&&(R.lastChild!==K&&(cn(K),ib(R,K)),Iq(K,0,0,n.getWidth(),n.getHeight())),qc(n),Zq(n),ed(n)}},F.layout=function(H,Z,v,p){1===arguments.length?Iq(this,H):Iq(this,H,Z,v,p)},F.addViewListener=function(S,z,N){var Z=this;Z._67O||(Z._67O=new Ri),Z._67O.add(S,z,N)},F.removeViewListener=function(S,r){this._67O.remove(S,r)},F.fireViewEvent=function(J){var M=this;M._67O&&(Xj(J)&&(J={kind:J}),M._67O.fire(J)),p.viewListener&&p.viewListener(M,J)}},ms_tip:function(X){X.setToolTipEnabled=function(g){var k=this;g?Pb||k._13o||(k.enableToolTip(),k.fp("toolTipEnabled",!1,!0)):k._13o&&(k.disableToolTip(),k.fp("toolTipEnabled",!0,!1))},X.isToolTipEnabled=function(){return!!this._13o},X.enableToolTip=function(){var y=this;if(!Pb&&!y._13o){y._13o=function(m){var x=y.getToolTip(m);x!=g?(p.toolTipContinual&&p.isToolTipShowing()?zr(m,x):(Pm(),eg={timeout:yo(gl,$d),e:m,info:x}),Gb={e:m,view:y}):Pm()};var u=y.getView();C(u,Xm,y._13o),C(u,"mouseleave",p.hideToolTip)}},X.disableToolTip=function(){var n=this;if(n._13o){var A=n.getView();J(A,Xm,n._13o),J(A,"mouseleave",p.hideToolTip),delete n._13o}},X.getToolTip=function(S){var h=this;if(h.getDataAt){var l=h.getDataAt(S);return l?l.getToolTip():g}return h.getValue?h.getValue():void 0}},_52o:function(O){O._zoom=1,O._29I=Pf,O.zoomIn=function(p,x){this.setZoom(this._zoom*dk,p,x)},O.zoomOut=function(F,t){this.setZoom(this._zoom/dk,F,t)},O.zoomReset=function(A,f){this.setZoom(1,A,f)},O.scrollZoomIn=function(M){this.setZoom(this._zoom*Ml,g,M)},O.scrollZoomOut=function(G){this.setZoom(this._zoom/Ml,g,G)},O.pinchZoomIn=function(G){this.setZoom(this._zoom*Ki,g,G)},O.pinchZoomOut=function(t){this.setZoom(this._zoom/Ki,g,t)},O.adjustZoom=function(U){return Sl>U?Sl:U>Pg?Pg:U},O.getZoom=function(){return this._zoom},O.setZoom=function(q,b,K){var E=this;if(b=sj(b)){E._14o&&E._14o.stop(!0);var F=E._zoom;b.action=function(L){E._96O(F+(q-F)*L,K)},b._37o=function(){delete E._zooming,delete E._14o,E.onZoomEnded()},E._zooming=1,E._14o=Qc(b)}else E._96O(q,K)},O._96O=function(F,v){var C=this;if(F=C.adjustZoom(F),F!==C._zoom){C.validate();var G=C._29I,P=C._zoom;0!==G.width&&0!==G.height&&(v=v?v:{x:G.x+G.width/2,y:G.y+G.height/2},C.tx((v.x-G.x)*P-v.x*F),C.ty((v.y-G.y)*P-v.y*F)),C._zoom=F,C.fp("zoom",P,F)}}},ms_edge:function(U){U._2I=function(c){var K=this;K._44I||(K._44I=new Yn),K._42I||(K._42I=new Yn),K._44I.add(c),K._42I.add(c),K._20I()},U._4I=function(E){var K=this;K._44I||(K._44I=new Yn),K._43I||(K._43I=new Yn),K._44I.add(E),K._43I.add(E),K._20I()},U._16I=function(Z){var B=this;B._44I.remove(Z),B._42I.remove(Z),B._44I.isEmpty()&&delete B._44I,B._42I.isEmpty()&&delete B._42I,B._20I()},U._18I=function(Y){var B=this;B._44I.remove(Y),B._43I.remove(Y),B._44I.isEmpty()&&delete B._44I,B._43I.isEmpty()&&delete B._43I,B._20I()},U._20I=function(){var p=this;if(delete p._45I,!p._44I||p._44I.isEmpty())return delete p._70O,void 0;var O;p._44I.each(function(w){w.isLooped()&&(O||(O={}),O[w._id]||(p._45I||(p._45I=new Yn),p._45I.add(w),O[w._id]=w))}),O?(p._70O=new Yn,p._44I.each(function(i){O[i._id]?"A"===O[i._id]||(O[i._id]="A",p._70O.add(i)):p._70O.add(i)})):p._70O=p._44I},U.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},U.getSourceAgentEdges=function(){return this._46I},U.getTargetAgentEdges=function(){return this._47I},U._1I=function(b){var o=this;o._46I||(o._46I=new Yn),o._48I||(o._48I=new Yn),o._46I.add(b),o._48I.add(b),o._19I()},U._3I=function(J){var X=this;X._47I||(X._47I=new Yn),X._48I||(X._48I=new Yn),X._47I.add(J),X._48I.add(J),X._19I()},U._15I=function(B){var Q=this;Q._46I.remove(B),Q._48I.remove(B),Q._46I.isEmpty()&&delete Q._46I,Q._48I.isEmpty()&&delete Q._48I,Q._19I()},U._17I=function(S){var B=this;B._47I.remove(S),B._48I.remove(S),B._47I.isEmpty()&&delete B._47I,B._48I.isEmpty()&&delete B._48I,B._19I()},U._19I=function(){var S=this;delete S._49I;var e=S._48I;if(e&&!e.isEmpty()){var O={};e.each(function(U){O[U._id]?S._49I||(S._49I=new Yn):O[U._id]=U}),S._49I?e.each(function(r){O[r._id]&&(S._49I.add(r),delete O[r._id])}):S._49I=e}},U.getLoopedEdges=function(){return this._45I},U.getEdges=function(){return this._70O},U.getAgentEdges=function(){return this._49I},U.getSourceEdges=function(){return this._42I},U.getTargetEdges=function(){return this._43I},U._8I=function(){this._70O&&this._70O.each(function(i){i._7I()})}}};oi(p,{getVersion:function(){return"7.2.7"}},!0),oi(p,{numberDigits:5,crossOrigin:"",baseZIndex:s,isTouchable:Pb,mockTouch:!0,devicePixelRatio:q.devicePixelRatio?q.devicePixelRatio:q.screen?q.screen.deviceXDPI/q.screen.logicalXDPI:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:u.disabledBackground,forceHierarchicalSerialization:!0,extractBatchTranslation:!1,extractShapeTranslation:!1,envmapProbeMinWaitTime:300,envmapProbeMaxWaitTime:25e3,EnvmapTextureSize:1024,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Fe},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],blockMinSize:1,textExtraWidth:4,encodeStringKey:null,doubleClickSpeed:500,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(y){return y*y},labelColor:Ek,labelSelectColor:Ci,labelFont:"12px arial, sans-serif",widgetIndent:Pb?30:20,widgetRowHeight:Pb?30:20,widgetHeaderHeight:Pb?32:22,widgetTitleHeight:Pb?34:24,scrollBarColor:lf,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Pb?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Sp,intersectionLineLine:Zh,isEnter:Um,isEsc:Pi,isDelete:Lk,isSpace:Wc,isLeft:qh,isUp:ol,isRight:Nf,isDown:lg,isTouchEvent:jc,getTarget:fh,isString:Xj,isNumber:Jr,isBoolean:Tg,isArray:Vd,isSelectAll:om,isFunction:qr,isObject:Np,getPropertyValue:$g,setPropertyValue:To,addMethod:oi,createGradient:function(P,r,U,o,O,C,H,I){var N=vp[r];return N(P,U,o,O,C,H,I)},appendToScreen:function(G){G=G.getView?G.getView():G,(o.fullscreenElement||o.mozFullScreenElement||o.webkitFullscreenElement||o.msFullscreenElement||o.body).appendChild(G)},encodeString:function(e){return U.Math.encodeBase64(e,p.encodeStringKey)},decodeString:function(z){return U.Math.decodeBase64(z,p.encodeStringKey)},findView:function(X){var J=function(o,n){var m=n._ht;m&&o.push(m);var P=n.children,h=P.length;if(h)for(var D=0;h>D;D++)J(o,P[D])},y=[];J(y,o.body);var P=function(n,b){for(var x="2d"===b?lm.GraphView:dd.Graph3dView,m=0,r=n.length;r>m;m++)if(n[m]instanceof x)return y[m];return null};return"all"===X?y:"2d"===X?P(y,"2d"):"3d"===X?P(y,"3d"):P(y,"3d")||P(y,"2d")},toggleFullscreen:function(a){var X=a.getView();if(o.fullscreenElement||o.mozFullScreenElement||o.webkitFullscreenElement||o.msFullscreenElement)o.exitFullscreen?o.exitFullscreen():o.msExitFullscreen?o.msExitFullscreen():o.mozCancelFullScreen?o.mozCancelFullScreen():o.webkitExitFullscreen&&o.webkitExitFullscreen();else{var W=!0;if(a.isSelfViewEvent){var B=a.getX(),j=a.getY(),s=a.getWidth(),Q=a.getHeight(),u=X.style.background,v=X.style.backgroundColor;u||v||(X.style.backgroundColor="white"),X.requestFullscreen?X.requestFullscreen():X.msRequestFullscreen?X.msRequestFullscreen():X.mozRequestFullScreen?X.mozRequestFullScreen():X.webkitRequestFullscreen&&X.webkitRequestFullscreen();var D=setInterval(function(){if(X!==(o.fullscreenElement||o.mozFullScreenElement||o.webkitFullscreenElement||o.msFullscreenElement))clearInterval(D),a.setX(B),a.setY(j),a.setWidth(s),a.setHeight(Q),a._fullscreen=!1,X.style.oldBackgroundColor=v,a.iv();else{var l=U.Default.getWindowInfo();(W||l.width!==a.getWidth()||l.height!==a.getHeight())&&(a.setX(l.left),a.setY(l.top),a.setWidth(l.width),a.setHeight(l.height),a._fullscreen=!0,a.iv(),W=!1)}},500)}else{var V=X.style.left,z=X.style.top,s=X.style.width,Q=X.style.height,u=X.style.background,v=X.style.backgroundColor;u||v||(X.style.backgroundColor="white"),X.requestFullscreen?X.requestFullscreen():X.msRequestFullscreen?X.msRequestFullscreen():X.mozRequestFullScreen?X.mozRequestFullScreen():X.webkitRequestFullscreen&&X.webkitRequestFullscreen();var D=setInterval(function(){if(X!==(o.fullscreenElement||o.mozFullScreenElement||o.webkitFullscreenElement||o.msFullscreenElement))clearInterval(D),X.style.left=V,X.style.top=z,X.style.width=s,X.style.height=Q,X.style.oldBackgroundColor=v,a.iv();else{var I=U.Default.getWindowInfo();(W||I.width!==a.getWidth()||I.height!==a.getHeight())&&(Iq(a),W=!1)}},500)}}},appendTimeStamp:function(M){return M},setCompType:function(S,B){Xj(B)&&B.substr(0,12)==Nr&&(B=p.parse(B)),qr(B)||Np(B)?Zi[S]=B:zm(S)},getCompType:function(d){var Y=Zi[d];return Y===s&&mj.test(d)&&zm(d),Y},getCompTypeMap:function(){return Zi},drawCompType:function(a,M,F,V,z,U){a(M,F,V,z,U)},numberListener:function(){var h={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(w){var H=w.keyCode;h[H]||65===H&&p.isCtrlDown(w)||86===H&&p.isCtrlDown(w)||67===H&&p.isCtrlDown(w)||88===H&&p.isCtrlDown(w)||H>=35&&40>=H||(w.shiftKey||48>H||H>57)&&(96>H||H>105)&&w.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(s){var r=s.target.tagName;("DIV"===r||"CANVAS"===r)&&!(p.ignoreKeyCodes.indexOf(s.keyCode)>=0)&&("keydown"!==s.type||qh(s)||Nf(s)||ol(s)||lg(s)||Lk(s)||65===s.keyCode&&(s.metaKey||s.ctrlKey))&&s.cancelable===!0&&(s.preventDefault(),s.preventManipulation&&s.preventManipulation())},getWindowInfo:function(){var u=o.documentElement,x=u&&(u.scrollLeft||u.scrollTop)?u:o.body;return{target:x,left:x.scrollLeft,top:x.scrollTop,width:q.innerWidth||x.clientWidth,height:q.innerHeight||x.clientHeight}},isDragging:function(){return!!Fe},isLeftButton:function(g){return jc(g)?!0:0===g.button},isMiddleButton:function(L){return jc(L)?!1:L&&(1===L.button||4&(L.buttons||0))},isRightButton:function(u){return jc(u)?!1:u&&(2===u.button||2&(u.buttons||0))},isInput:function(Q){if(!Q)return!1;var f=Q.tagName;return"INPUT"===f||"TEXTAREA"===f||"SELECT"===f},getTouchCount:function(Q){return jc(Q)?Q.touches.length:1},isDoubleClick:function(){function N(i){i.details=0,i.timeout=null,i.lastPoint=null}var W={};return sh=new Ho,Ko=sh.getTime(),function(F){if(ns(F)>1)return!1;var T=F.button==g?"":F.button,r=F.type+T,q=r+"_isDoubleClick",k=W[r];if(k||(k=W[r]={details:0,timeout:null,lastPoint:null}),F[q]===s){F[q]=!0;var w=vq(F);k.timeout&&(pg(k.timeout),k.timeout=null);var f=jc(F)?p.doubleTouchRange:p.doubleClickRange;k.lastPoint&&lr(k.lastPoint,w)>f&&N(k),k.lastPoint=w,k.details++,k.timeout=yo(function(){N(this)}.bind(k),p.doubleClickSpeed)}return 2===k.details}}(),isShiftDown:function(t){return t?t.shiftKey:Xd["16"]},isCtrlDown:function(o){return o?lo?o.metaKey:o.ctrlKey:lo?Xd["91"]:Xd["17"]},getClientPoint:function(m){return jc(m)&&(m=$m(m)),{x:m.clientX,y:m.clientY}},isMouseEvent:function(k){return k instanceof MouseEvent||0===k.type.indexOf("mouse")},getTargetElement:function(U){var q,m=en(U);if(q=p.isMouseEvent(U)||!o.elementFromPoint?U.target:o.elementFromPoint(m.x,m.y),uc&&o.elementFromPoint){for(var s=[],e=[];"none"===q.style.pointerEvents;)s.push(q),e.push(q.style.display||""),q.style.display="none",q=o.elementFromPoint(m.x,m.y);s.forEach(function(r,j){r.style.display=e[j]})}return q},getPagePoint:function(o){return jc(o)&&(o=$m(o)),{x:o.pageX,y:o.pageY}},createObject:function(P,i){var q=new P;for(var Y in i){var b=i[Y];if(qr(b))q[Y]=b;else if(0===Y.indexOf("s:"))q.s(Y.substr(2),i[Y]);else if(0===Y.indexOf("a:"))q.a(Y.substr(2),i[Y]);else{var f=mp(Y),b=i[Y];q[f]?(q[f](b),"setToolTip"===f&&q.enableToolTip&&q.enableToolTip()):q[Y]=b}}return q},setImage:function(n,$,u,l){var x=arguments.length;4===x?Ef(n,l,$,u):2===x?Xj($)?$.substr(0,12)==Nr?xs(n,p.parse($)):Ef(n,$):xs(n,$):1===x&&Ef(n,n)},getImage:function(R,M,C){var k;if(R==g)return g;if(Np(R)?k=R:(k=Dr[R],R&&k===s&&(jd&&jd[R]||Ef(R,R))),M&&k&&k.tagName){var G;G="override"===C?"colors_override":"override_rgb"===C?"colors_override_rgb":"override_a"===C?"colors_override_a":"colors",k[G]||(k[G]={__count__:0});var Y=k[G][M];return Y||(k[G].__count__>p.imageCacheThreshold&&(k[G]={__count__:0}),Y=Ce(k,Jj(M),k.width,k.height,C),k[G][M]=Y,k[G].__count__++),Y}return k},isImageComplete:function(Y,K,P){var I=dg(Y);if(!I)return!1;if(I.tagName)return I.complete;for(var q,Y,f,$=I.comps,o=!0,C=0,l=$.length;l>C;C++)if(q=$[C],f=q.type,"image"===q.type){Y=q.name,Y&&Y.func&&(Y=gs(Y,K));var g=mk(Y,K,P);if(!g){o=!1;break}}else if(mj.test(f)&&p.getCompType(f)===s){o=!1,zm(f);break}return o},getId:function(){var u=1;return function(){return++u}}(),callLater:function(y,u,b,n){var E=function(){y.apply(u,b)};return n?yo(E,n):q.requestAnimationFrame(E)},cancelLater:function(V,G){G?pg(V):q.cancelAnimationFrame(V)},clone:function(Y){if(null==Y||"object"!=typeof Y)return Y;if(Y instanceof Date){var p=new Date;return p.setTime(Y.getTime()),p}if(Y instanceof Array){for(var p=[],X=0,r=Y.length;r>X;X++)p[X]=Wi(Y[X]);return p}if(Y instanceof Yn){for(var p=new Yn,X=0,r=Y.length;r>X;X++)p.set(X,Wi(Y.get(X)));return p}if(Y instanceof Zc)return Y;if(Y instanceof _m){var p=new _m;return p.deserialize(Y.serialize()),p}if(Y instanceof z){var p={};for(var J in Y)Y.hasOwnProperty(J)&&(p[J]=Wi(Y[J]));return p}return Y},callWhenLoaded:function(G,R){R=R||100;var H=Nj(G,R);Ih||(Ih={}),Ih[H]={tick:H,cb:G,delay:R}},beforeLoadURL:function(L,w){if(Ih){var Q={};for(var w in Ih){var b=Ih[w];pg(b.tick);var U=Nj(b.cb,b.delay);Q[U]={tick:U,delay:b.delay,cb:b.cb}}Ih=Q}return p.convertURL?p.convertURL(L,w):L},convertURL:function(e){return e},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return p.getImage("default_blank")},resizeImage:function(I,F,J,S){J||(J=F),S||(S=gj());var A=S.getContext("2d");return Df(S,F,J,1),A.drawImage(I,0,0,F,J),S},resizeImagePOT:function(W,U,h){if(!W||!W.tagName)return W;var G=W.width,E=W.height;if(!G||!E)return W;if(fo.isPOT(G)&&fo.isPOT(E)&&(!U||G===E))return W;var z,y;return U?y=z=fo.nearestPOT(Math.min(G,E)):(z=fo.nearestPOT(G),y=fo.nearestPOT(E)),p.resizeImage(W,z,y,h)},sortFunc:function(L,M){if(L===M)return 0;if(L==g&&M!=g)return 1;if(L!=g&&M==g)return-1;if(L==g&&M==g)return 0;var u,C=typeof L,B=typeof M;return C===rs&&B===rs?u=L.localeCompare(M):C===Tq&&B===Tq&&(u=L-M),u===s&&(u=(""+L).localeCompare(""+M)),u>0?1:0>u?-1:0},getClassMap:function(){return $b},getClass:function(r){if(Xj(r)){var n,I=$b[r];if(!I){n=r.split("."),I=q;for(var k=0;k<n.length;k++)I=I[n[k]];$b[r]=I}return I}return r},def:function(j,Z,X){var P,b,J,c=function(){};if(c.prototype=Z.prototype,P=new c,Xj(j)){if($b[j])throw"'"+j+"' already defined";J=Uf(j),P.getClassName=function(){return j}}else J=j;if(P.constructor=J,P.getClass=function(){return J},P.getSuperClass=function(){return Z},X)for(b in X)xn[b]&&xn.hasOwnProperty(b)?xn[b](P,X):il(P,X,b);J.prototype=P,J.superClass=Z.prototype},startAnim:function(){var k=function(E){E.duration&&(E.startTime=rp()),E.timeId=oq(E.tick,g,g,E.interval)};return function(S){return S=Wi(S),S.easing=S.easing||p.animEasing,S.duration||S.frames||(S.duration=p.animDuration),S.t=0,S.duration?S.interval=0:(S.frame=0,S.interval=S.interval||10),S.tick=function(){if(S.duration){var y=(rp()-S.startTime)/S.duration;if(y>1&&(y=1),S.t=y,S.action(S.easing(y),y),!S.isRunning())return;1===y?S.stop():S._isPaused||(S.timeId=oq(S.tick))}else{if(S.frame++,y=S.t=S.frame/S.frames,S.action(S.easing(y),y),!S.isRunning())return;S.frame<S.frames?S._isPaused||(S.timeId=oq(S.tick,g,g,S.interval)):S.stop()}},S.resume=function(){S._isPaused&&(delete S._isPaused,S.duration?S.t<1&&(S.startTime=rp()-S.duration*S.t,S.timeId=oq(S.tick)):S.frame<S.frames&&(S.timeId=oq(S.tick,g,g,S.interval)))},S.pause=function(){es(S.timeId,!S.duration),S._isPaused=!0},S.isPaused=function(){return this._isPaused},S.stop=function(n){S.isRunning()&&(es(S.timeId,!S.duration),delete S.timeId,S.duration?S.t<1&&n&&(S.t=1,S.action(S.easing(1),1)):S.frame<S.frames&&n&&(S.frame=S.frames,S.action(S.easing(1),1)),S._37o&&S._37o(),S.finishFunc&&S.finishFunc())},S.isRunning=function(){return S.timeId!=g},S.delay?oq(k,g,[S],S.delay):k(S),S}}(),getTextSize:function(){var c={},m=o?gj().getContext("2d"):g;return function(N,R){m.font=N?N:zq;var O=c[m.font];return O||(O=2*m.measureText("e").width+4,c[m.font]=O),{width:m.measureText(R).width+p.textExtraWidth,height:O}}}(),drawText:function(j,s,b,H,h,P,f,U,y,T,F){if(s!=g){var G=Lr(b,s),Y={};Y.y=T&&T!==Tj?T===$l?P+G.height/2:P+U-G.height/2:P+U/2,Y.x=y&&y!==Vn?y===qp?h+f-G.width/2:h+f/2:h+G.width/2,Xp(j,s,Y,b,H),F&&Vi(j,s,b,H,Y.x,Y.y,G.width,F)}},getDistance:function(f,F){var D=f.length;return F?3===D?w(ro(f[0]-F[0])+ro(f[1]-F[1])+ro(f[2]-F[2])):2===D?w(ro(f[0]-F[0])+ro(f[1]-F[1])):f.z===s?w(ro(F.x-f.x)+ro(F.y-f.y)):w(ro(F.x-f.x)+ro(F.y-f.y)+ro(F.z-f.z)):3===D?w(ro(f[0])+ro(f[1])+ro(f[2])):2===D?w(ro(f[0])+ro(f[1])):void 0},brighter:function(J,d){return 0>d&&(d=-d),zd(J,d?d:40)},darker:function(e,W){return W>0&&(W=-W),zd(e,W?W:-40)},unionPoint:function(L,v){if(!L)return g;if(2===arguments.length)return L&&v?{x:Q(L.x,v.x),y:Q(L.y,v.y),width:B(L.x-v.x),height:B(L.y-v.y)}:g;var e=L;if(e._as&&(e=e._as),e.length===s)return g;var C=e.length;if(0>=C)return g;for(var E=1,X=e[0],p={x:X.x,y:X.y,width:0,height:0};C>E;E++){X=e[E];var q=Q(p.x,X.x),W=N(p.x+p.width,X.x),G=Q(p.y,X.y),J=N(p.y+p.height,X.y);p.x=q,p.y=G,p.width=W-q,p.height=J-G}return p},unionRect:function(s,E){if(s&&!E)return Wi(s);if(!s&&E)return Wi(E);if(s&&E){var t={x:Q(s.x,E.x),y:Q(s.y,E.y)};return t.width=N(s.x+s.width,E.x+E.width)-t.x,t.height=N(s.y+s.height,E.y+E.height)-t.y,t}return g},containsPoint:function(K,n,E,e){if(e!=g&&1!==e){var P=K.x+K.width/2,s=K.y+K.height/2;K={x:P-K.width/2*e,y:s-K.height/2*e,width:K.width*e,height:K.height*e}}if(E){var C=K.width/2,U=K.height/2,f=_(-E),i=W(-E),N=n.x-K.x-C,h=n.y-K.y-U;return n={x:i*N-f*h,y:f*N+i*h},vb({x:-C,y:-U,width:K.width,height:K.height},n)}return!(!K||n.x<K.x||n.y<K.y||n.x>K.x+K.width||n.y>K.y+K.height)},containsRect:function(B,K){if(!B||!K)return!1;var N=K.x,i=K.y,V=K.width,g=K.height,A=B.width,O=B.height;if(0>(A|O|V|g))return!1;var f=B.x,Q=B.y;if(f>N||Q>i)return!1;if(A+=f,V+=N,N>=V){if(A>=f||V>A)return!1}else if(A>=f&&V>A)return!1;if(O+=Q,g+=i,i>=g){if(O>=Q||g>O)return!1}else if(O>=Q&&g>O)return!1;return!0},intersectsRect:function(t,u){if(!t||!u)return!1;var p=u.width,z=u.height,G=t.width,$=t.height;if(0>=G||0>=$||0>=p||0>=z)return!1;var w=u.x,N=u.y,U=t.x,F=t.y;return G+=U,$+=F,p+=w,z+=N,G>w&&$>N&&p>U&&z>F},intersection:function(m,y){if(!m||!y)return g;var v=y.x,P=y.y,X=m.x,b=m.y,Y=v,a=P,d=X,f=b;return Y+=y.width,a+=y.height,d+=m.width,f+=m.height,X>v&&(v=X),b>P&&(P=b),Y>d&&(Y=d),a>f&&(a=f),Y-=v,a-=P,0>=Y||0>=a?g:{x:v,y:P,width:Y,height:a}},grow:function(q,u,v){v===s&&(v=u),q.x-=u,q.y-=v,q.width=q.width+2*u,q.height=q.height+2*v},getScreenPoint:function(W,j,t,i,G,Z,X){var V=t.getBoundingClientRect(),b=W*(Z||1)-t.scrollLeft+(i||0),A=j*(X||1)-t.scrollTop+(G||0),q=Ej(t,!1);if(q){var N=new Bb(b,A,0);return N.applyMatrix4(q),console.log(N),{x:N.x,y:N.y}}return{x:b+V.left,y:A+V.top}},getLogicalPoint:function(I,D,f,x,l,j){var u,R,Q=D.getBoundingClientRect();I.target?(wc(I)?lo?Xd["91"]=!0:Xd["17"]=!0:lo?Xd["91"]=!1:Xd["17"]=!1,Xd["16"]=te(I)?!0:!1,I=jc(I)?$m(I):I,u=I.clientX,R=I.clientY):(u=I.x,R=I.y);var U=Ej(D,!0);if(U){var N=new Bb(u,R,0);N.applyMatrix4(U);do{if(Math.abs(N.z)<=1e-6)break;var z=new Bb(u,R,1);if(z.applyMatrix4(matrix),Math.abs(z.z)<=1e-6){N=z;break}if(z.sub(N),Math.abs(z.z)<=1e-6)break;N.addScaledVector(z,-N.z/z.z)}while(!1);return{x:(N.x+D.scrollLeft-(f||0))/(l||1),y:(N.y+D.scrollTop-(x||0))/(j||1)}}return{x:(u-Q.left+D.scrollLeft-(f||0))/(l||1),y:(R-Q.top+D.scrollTop-(x||0))/(j||1)}
},removeHTML:function(){var $;return function(E){return E&&E.getView&&(E=E.getView()),E&&E.parentNode?$===E?!0:($=E,E.parentNode.removeChild(E),$=g,!0):!1}}(),getToolTipDiv:function(){if(!np){np=lp(),mh=lp();var A=np.style;p.baseZIndex!=g&&(A.zIndex=vs(p.baseZIndex)+3+""),A.whiteSpace="nowrap",A.color=p.toolTipLabelColor,A.background=p.toolTipBackground,A.font=p.toolTipLabelFont,A.padding="5px",A.boxShadow="0px 0px 3px "+p.toolTipShadowColor}return np},isToolTipShowing:function(){return np&&np.parentNode?!0:mh&&mh.parentNode?!0:!1},updateToolTipContent:function(v,u){if(p.isToolTipShowing()&&(u||(u=Gb&&Gb.view),v===s&&u&&Gb.e&&(v=u.getToolTip(Gb.e)),v!=g)){var $;v.html?(v=v.html,$=mh):$=np,$.innerHTML=v}},hideToolTip:function(){if(p.isToolTipShowing()){cn(np),cn(mh),_b();var L=Gb&&Gb.view;L&&L.onHideToolTip&&L.onHideToolTip(),Gb=g}},showToolTip:function(k,P,u){if(!k||P==g)return Pm(),void 0;p.getToolTipDiv();var d,n;if(P.html?(P=P.html,d=mh,cn(np)):(d=np,cn(mh)),n=d.style,d.innerHTML=P,d.parentNode||U.Default.appendToScreen(d),k.target){k=en(k);var J=mr(),r=k.x,x=k.y,N=Pb?60:12;if(Pb){var E=d.getBoundingClientRect();n.left=r-E.width/2+zk,n.top=x-E.height-N<J.top?x+N+zk:x-E.height-N+zk}else{n.left=r+N+zk,n.top=x+N+zk;var E=d.getBoundingClientRect();E.left+E.width>J.width&&(n.left=r-N-E.width+zk),E.top+E.height>J.height&&(n.top=x-N-E.height+zk),E.left<0&&(n.left=r+N+zk),E.top<0&&(n.top=x+N+zk)}}else n.left=k.x+zk,n.top=k.y+zk;_b(),u===s?u=Gb&&Gb.view:Gb={e:k,view:u},u&&u.onShowToolTip&&u.onShowToolTip()},startDragging:function(K,E,X){X==s&&(X=!0),K!==Fe&&(Fe?X&&(jc(E)?Fe.handleWindowTouchEnd(E):Fe.handleWindowMouseUp(E)):jc(E)?(C(q,Jb,nb),C(q,Xi,Ic),C(q,"blur",Ic)):(C(q,Xm,Gf),C(q,xp,pn),C(q,"blur",pn)),Fe=K)},getImageMap:function(){return Dr},toBoundaries:function(n,c,D,I){var C=[];return Ok(n,c,D,I).forEach(function(K){var x=[];K.forEach(function(n){x.push(n.x,n.y)}),C.push(x)}),C},getCurrentKeyCodeMap:function(){return Xd},drawCenterImage:function($,x,u,h,p,B,N,I){!p&&B&&B.isSelfViewEvent&&(p=B);var T=Oo(x,p,B),f=Gl(x,p,B);jj($,x,A(u-T/2),A(h-f/2),T,f,p,B,N,I)},drawStretchImage:function(P,t,S,e,q,R,z,f,U,M,l,J){!f&&U&&U.isSelfViewEvent&&(f=U);var V,D=Oo(t,f,U,R),n=Gl(t,f,U,z);"uniform"===S?(V=Q(R/D,z/n),D*=V,n*=V,e+=A((R-D)/2),q+=A((z-n)/2),R=D,z=n):"centerUniform"===S&&((D>R||n>z)&&(V=Q(R/D,z/n),D*=V,n*=V),e+=A((R-D)/2),q+=A((z-n)/2),R=D,z=n);var p=P.interactiveInfo;if(p){var H;if(H="center"===S?{x:e+R/2-D/2,y:q+z/2-n/2,width:D,height:n}:{x:e,y:q,width:R,height:z},p.rect){var s=p.compInfos,y=s.length;y&&(s[y-1].rect.image=t)}else p.rect=H}if("center"===S){var w=l!==!1&&(D>R||n>z);w&&(P.save(),P.beginPath(),P.rect(e,q,R,z),P.clip()),jj(P,t,e+R/2-D/2,q+z/2-n/2,D,n,f,U,M,J),w&&P.restore()}else jj(P,t,e,q,R,z,f,U,M,J)},toCanvas:function(F,_,T,Y,$,E,a,Q,c){F=dg(F,a),_=_||Oo(F,$),T=T||Gl(F,$);var H=gj(),G=Rl(H);return Q?(Df(H,_,T,Q),G.scale(Q,Q)):Df(H,_,T,1),id(G,F,Y,0,0,_,T,$,E,a,c),F&&F.clampToEdge&&(H.clampToEdge=F.clampToEdge),G.restore(),H},toGrayColor:function(U){if(!U)return U;var E=kl(U),C=A(.299*E[0]+.587*E[1]+.114*E[2]);return"rgba("+C+","+C+","+C+","+E[3]/255+")"},createGradientImage:function(q,n,W,j){for(var v=["L",0,0,q,0,1,0,0,1,0,0],u=0,m=Math.min(n.length,W.length);m>u;u++)v.push(W[u],n[u]);var J=U.Default.toCanvas({width:q,height:q,clampToEdge:!0,comps:[{type:"shape",rotation:j||0,points:[0,0,q,0,q,q,0,q],background:"#ffffff",gradientPack:v}]});return J},createElement:function(L,N,t,A){var c=o.createElement(L);return rq(c,N||u.widgetBorder,2),c.style.font=t?t:zq,A!=g&&(c.value=A),p.onElementCreated&&p.onElementCreated(c),c},containedInView:function(s,R){var j=yh(R).getBoundingClientRect();return vb({x:j.left,y:j.top,width:j.width,height:j.height},vq(s))},isIsolating:function(){return cf>0},setIsolating:function(C){C?cf++:cf--},getMSMap:function(){return xn},stringify:function(k,i,f){var E=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var R=_m.prototype.toJSON;_m.prototype.toJSON=function(){return"__ht__dataModel"+this.serialize(0)},i=f?0:i==g?2:i;var P=JSON.stringify(k,function(C,w){return"function"==typeof w?"__ht__"+(w.__ht__||w.toString()):Jr(w)?Xe(w):w instanceof U.List?"__ht__list"+(w.__ht__list||p.stringify(w._as)):w},i);return Date.prototype.toJSON=E,_m.prototype.toJSON=R,f&&(P=Nr+Nd(P)),P},parse:function(s,D){return Xj(s)?s.substr(0,12)!=Nr||(s=nr(s.substr(12)),Xj(s))?(D=D||{},JSON.parse(s,function(H,x){if(Xj(x))if(D.ignoreFunction||"__ht__function"!=x.substr(0,14)){if(!D.ignoreDate&&"__ht__date"==x.substr(0,10))return new Date(vs(x.substr(10)));if("__ht__list"===x.substr(0,10))return new Yn(p.parse(x.substr(10)));if(!D.ignoreDataModel&&"__ht__dataModel"===x.substr(0,15)){var j=new _m;return j.deserialize(p.parse(x.substr(15))),j}}else{var i=x.indexOf("{")+1,T=x.lastIndexOf("}"),o=x.indexOf("(")+1,U=x.indexOf(")");if(i&&T&&o&&U)try{var E=new Function(x.substring(o,U),x.substring(i,T));return E.__ht__=x.substr(6),E}catch(w){throw console.info("=== SyntaxError ===\n",x),w}}return x})):s:s},loadJS:function(U,Z){Z&&U.push(Z);var H=U.shift();if(Vd(H))U=H.contact(U),p.loadJS(U);else if(qr(H))H(),p.loadJS(U);else if(Xj(H)){var W=o.createElement("script");W.onload=function(){p.loadJS(U)},W.setAttribute("src",H),o.getElementsByTagName("head")[0].appendChild(W)}else U.length&&p.loadJS(U)},extendClass:function(u,I){var p=u.prototype;for(var t in I)xn[t]&&xn.hasOwnProperty(t)?xn[t](p,I):p[t]=I[t]},toRoundedCorner:function(){function a(k,Q,D){k.x=Q.x,k.y=Q.e||D,k.z=Q.y}var z=new Bb,w=new Bb,o=new Bb,Q=new Bb;return function(T,P){var F,R=0;T.getPoints&&(R=T.getElevation(),T=T.getPoints()),F=T instanceof Yn?T:new Yn(T);var N=F.size();if(0>=P)return{points:F};var j=new Yn,L=new Yn,Z=F.get(0);a(z,Z,R),j.add(Z),L.add(1);for(var i=1;N>i;i++)if(N>i+1){var S=F.get(i),D=F.get(i+1);a(w,S,R),a(o,D,R),Q.subVectors(z,w).setLength(Math.min(.99*Q.length(),P)).add(w),S.e!==s||Z.e!==s?j.add({x:Q.x,y:Q.z,e:Q.y}):j.add({x:Q.x,y:Q.z}),j.add(S),Q.subVectors(o,w).setLength(Math.min(.99*Q.length(),P)).add(w),S.e!==s||D.e!==s?j.add(Z={x:Q.x,y:Q.z,e:Q.y}):j.add(Z={x:Q.x,y:Q.z}),z.copy(Q),L.addAll([2,3])}else j.add(F.get(i)),L.add(2);return{points:j,segments:L}}}(),toColorData:kl,setCanvas:Df,createDiv:lp,createDisabledDiv:Jm,createView:_f,createCanvas:gj,appendChild:ib,initContext:Rl,checkLoadingImage:qc,translateAndScale:Bl,layout:Iq,getPosition:xm,drawPoints:vg,drawRoundRect:ti,drawBorder:El,setFocus:jf,getter:wd,setter:mp,isEmptyObject:Lg,cameraPriority:function(){var D={skybox:0,main:1e4,top:1e7,infinity:1/0};return z.seal(z.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return D.skybox},set:function(x){if(x>=D.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");D.skybox=Number(x)}},main:{configurable:!1,enumerable:!1,get:function(){return D.main},set:function(R){if(R<=D.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(R>=D.top)throw new RangeError("Main camera must have lower priority than the top camera.");D.main=Number(R)}},top:{configurable:!1,enumerable:!1,get:function(){return D.top},set:function(Q){if(Q<=D.main)throw new RangeError("Top camera must have higher priority than the main camera.");D.top=Number(Q)}}}))}()},!0),oi(n,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var _j=p.disabledOpacity,$d=p.toolTipDelay,Kn=p.devicePixelRatio,Ql=p.autoMakeVisible,Ye=p.autoHideScrollBar,zh=p.imageGradient,zr=p.showToolTip,Pm=p.hideToolTip,dh=p.dashPattern,rj=p.lineCap,yf=p.lineJoin,Lm=p.labelColor,wn=p.labelSelectColor,zq=p.labelFont,fr=p.widgetIndent,Vp=p.widgetRowHeight,sl=p.widgetHeaderHeight,Go=p.widgetTitleHeight,os=p.scrollBarColor,se=p.scrollBarSize,Nq=p.scrollBarTimeout,is=p.scrollBarMinLength,eo=p.scrollBarInteractiveSize,dk=p.zoomIncrement,Ml=p.scrollZoomIncrement,Ki=p.pinchZoomIncrement,Pg=p.zoomMax,Sl=p.zoomMin,Op=p.createObject,fk=p.preventDefault,gk=p.setImage,dg=p.getImage,mk=p.isImageComplete,kn=p.drawCenterImage,id=p.drawStretchImage,qi=p.getId,oq=p.callLater,es=p.cancelLater,Kc=p.sortFunc,Wi=p.clone,Uf=p.getClass,Qc=p.startAnim,Xg=p.brighter,Ao=p.darker,kf=p.drawText,Lr=p.getTextSize,ys=p.isLeftButton,Wl=p.isMiddleButton,cj=p.isRightButton,ns=p.getTouchCount,Sf=p.isDoubleClick,te=p.isShiftDown,wc=p.isCtrlDown,vq=p.getClientPoint,en=p.getPagePoint,lr=p.getDistance,In=p.unionPoint,to=p.unionRect,vb=p.containsPoint,bq=p.containsRect,Rf=p.intersectsRect,Jg=p.intersection,mr=p.getWindowInfo,ff=p.grow,dc=p.getLogicalPoint,bl=p.getScreenPoint,Nm=p.startDragging,cn=p.removeHTML,$q=p.createElement,cm=p.segmentResolution,on=p.shapeResolution,Sq=p.shapeSide,zs=p.def,jn=function(q,P,k){zs(e+"."+q,P,k)},Pk=function(_,m){_.childNodes.forEach(function(P){m(P),Pk(P,m)})};oi(p,{toolTipLabelColor:Lm,toolTipLabelFont:zq,toolTipBackground:u.toolTipBackground,toolTipShadowColor:lf,debugTipLabelFont:zq,debugTipLabelColor:Lm,debugTipBackground:u.toolTipBackground,drawBreakableText:qo,setDevicePixelRatio:function(W){Kn=p.devicePixelRatio="number"==typeof W?W:q.screen?q.screen.deviceXDPI/q.screen.logicalXDPI:1,Pk(o.body,function(j){var w=j._ht;w&&w._canvas&&(Df(w._canvas,w.getWidth(),w.getHeight()),w.redraw?w.redraw():w.iv())})},getPosition3dGap:function(){return Il()}},!0);var bn=1e-6,Sb="undefined"!=typeof Uint16Array?Uint16Array:Array,Yp="undefined"!=typeof Float32Array?Float32Array:Array,Nh=function(p,t,i){var d=[p[0]-t[0],p[1]-t[1],p[2]-t[2]];if(i){var T=lr(d);T>0&&(d[0]/=T,d[1]/=T,d[2]/=T)}return d},zl=function(){var K="charCodeAt",v=2*(2*Ip.length+1);for(var I in q)if(I===e+Vn[0]+(zk.length+2)){var o=q[I];if(!o)break;for(var R=o.length,Q=0;R>Q;Q++)if(o[Q][K](0)===v&&o[Q+1]!=g&&o[Q+1]===zk[0]&&o[Q+2]!=g&&o[Q+2][K](0)===v){for(var L=Q+3;R>L;L++)if(o[L][K](0)===v){if(0==o[L+1])for(var t,s=L+2;R>s;s++){if(o[s][K](0)===v){0==o[s-1]&&t&&(sd=t.substr(0,t.length-1));break}t==g?t=o[s]:t+=o[s]}break}break}break}return function(m){return[-m[0],-m[1],-m[2]]}}(),Jq=function(Q,M){return 3===Q.length?Q[0]*M[0]+Q[1]*M[1]+Q[2]*M[2]:Q[0]*M[0]+Q[1]*M[1]},Wq=function(){var U=new Array(16);return U[0]=1,U[1]=0,U[2]=0,U[3]=0,U[4]=0,U[5]=1,U[6]=0,U[7]=0,U[8]=0,U[9]=0,U[10]=1,U[11]=0,U[12]=0,U[13]=0,U[14]=0,U[15]=1,U},Rp=Wq(),Km=function(p){var F=new Array(16);return F[0]=p[0],F[1]=p[1],F[2]=p[2],F[3]=p[3],F[4]=p[4],F[5]=p[5],F[6]=p[6],F[7]=p[7],F[8]=p[8],F[9]=p[9],F[10]=p[10],F[11]=p[11],F[12]=p[12],F[13]=p[13],F[14]=p[14],F[15]=p[15],F},Yq=function(R,x){return R[0]=x[0],R[1]=x[1],R[2]=x[2],R[3]=x[3],R[4]=x[4],R[5]=x[5],R[6]=x[6],R[7]=x[7],R[8]=x[8],R[9]=x[9],R[10]=x[10],R[11]=x[11],R[12]=x[12],R[13]=x[13],R[14]=x[14],R[15]=x[15],R},Qd=function(M){return M[0]=1,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=1,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=1,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M},aq=function(X,A){var h=X[0],O=X[1],$=X[2];return X[0]=A[0]*h+A[4]*O+A[8]*$+A[12],X[1]=A[1]*h+A[5]*O+A[9]*$+A[13],X[2]=A[2]*h+A[6]*O+A[10]*$+A[14],X},ob=function(i,e){var F=i[0],D=i[1],a=i[2],l=i[3];return i[0]=e[0]*F+e[4]*D+e[8]*a+e[12]*l,i[1]=e[1]*F+e[5]*D+e[9]*a+e[13]*l,i[2]=e[2]*F+e[6]*D+e[10]*a+e[14]*l,i[3]=e[3]*F+e[7]*D+e[11]*a+e[15]*l,i},eb=function(){var N,o,H,X,Q=Yk(bp[1]+bp[7]),E=Yk(bp[0]+bp[3]-bp[10]),g=Yk(bp[8]+2),R=function(){return o=H.charAt(N),N+=1,o},x=function(){var N="";if(o===g)for(;R();){if(o===g)return R(),N;N+=o}else R()},h=function(){for(;o&&" ">=o;)R()},w=function(){var l,J={};if(o===Q){if(R(),h(),o===E)return R(),J;for(;o;){if(l=x(),h(),R(),J[l]=X(),h(),o===E)return R(),J;R(),h()}}};return X=function(){switch(h(),o){case Q:return w();default:return x()}},function(U){if(S={},U){var c;if(H=U,N=0,o=" ",c=X(),h(),!o)return c}}}(),Ul=function(C,K){if(K){var Z=_(K),s=W(K),F=C[4],M=C[5],i=C[6],A=C[7],k=C[8],L=C[9],e=C[10],H=C[11];C[4]=F*s+k*Z,C[5]=M*s+L*Z,C[6]=i*s+e*Z,C[7]=A*s+H*Z,C[8]=k*s-F*Z,C[9]=L*s-M*Z,C[10]=e*s-i*Z,C[11]=H*s-A*Z}},lq=function(w,o){if(o){var J=_(o),M=W(o),G=w[0],$=w[1],v=w[2],S=w[3],y=w[8],p=w[9],H=w[10],Z=w[11];w[0]=G*M-y*J,w[1]=$*M-p*J,w[2]=v*M-H*J,w[3]=S*M-Z*J,w[8]=G*J+y*M,w[9]=$*J+p*M,w[10]=v*J+H*M,w[11]=S*J+Z*M}},mg=function(p,N){if(N){var x=_(N),t=W(N),e=p[0],X=p[1],b=p[2],U=p[3],u=p[4],z=p[5],c=p[6],l=p[7];p[0]=e*t+u*x,p[1]=X*t+z*x,p[2]=b*t+c*x,p[3]=U*t+l*x,p[4]=u*t-e*x,p[5]=z*t-X*x,p[6]=c*t-b*x,p[7]=l*t-U*x}},Ph=function(O,Q,U){return wi(g,U===!1?g:O.getFinalScale3d(),O.getFinalRotation3d(),O.getRotationMode(),O.p3(),g,Q)},wi=function(f,F,b,j,_,D,G){return D||(D=Wq()),_&&Lj(D,_),Pl(D,b,j),G&&$c(D,D,G),F&&Ng(D,F),f&&$c(D,D,f),D},cd=function(N,M,O){M=vs(M),O=vs(O);var g=this;g.g=N,g._84O=M,g._85O=O,g._70I=!0,g.F=0,g._83O=M+O,g.pen={x:0,y:0}},Rj="lineDashOffset",td="setLineDash",Od=function(T){for(var M in T)1===M.length&&(Rj=T[M]);return M?1:0},Kg=function(L,M,P){return ld(M)?L:L[td]?(L[td](M),P&&(L.lineDashOffset=P),L):new cd(L,M[0],M.length>1?M[1]:M[0])},Ee=function(z,f){!ld(f)&&z[td]&&(z[td](Id),z.lineDashOffset=0)};zs(cd,z,{_69I:6,moveTo:function(J,l){var U=this,H=U.pen;H.x=J,H.y=l,U.g.moveTo(J,l),U.start||(U.start={x:J,y:l})},lineTo:function(I,L){var n=this,J=n.pen,C=I-J.x,w=L-J.y,A=xb(w,C),r=W(A),K=_(A),Z=n._23O(J.x,J.y,I,L),F=n._85O,S=n._84O,T=n._83O;if(n.F){if(n.F>Z)return n._70I?n._72I(I,L):n.moveTo(I,L),n.F-=Z,void 0;if(n._70I?n._72I(J.x+r*n.F,J.y+K*n.F):n.moveTo(J.x+r*n.F,J.y+K*n.F),Z-=n.F,n.F=0,n._70I=!n._70I,!Z)return}var f=l(Z/T);if(f){for(var g=r*S,G=K*S,N=r*F,u=K*F,M=0;f>M;M++)n._70I?(n._72I(J.x+g,J.y+G),n.moveTo(J.x+N,J.y+u)):(n.moveTo(J.x+N,J.y+u),n._72I(J.x+g,J.y+G));Z-=T*f}n._70I?Z>S?(n._72I(J.x+r*S,J.y+K*S),n.moveTo(I,L),n.F=F-(Z-S),n._70I=!1):(n._72I(I,L),Z===S?(n.F=0,n._70I=!n._70I):(n.F=S-Z,n.moveTo(I,L))):Z>F?(n.moveTo(J.x+r*F,J.y+K*F),n._72I(I,L),n.F=S-(Z-F),n._70I=!0):(n.moveTo(I,L),Z===F?(n.F=0,n._70I=!n._70I):n.F=F-Z)},quadraticCurveTo:function(V,e,L,t){var r,J=this,Z=J.pen,B=Z.x,A=Z.y,d=J._22O(B,A,V,e,L,t),w=0,z=0,Q=J._85O,G=J._84O;if(J.F){if(J.F>d)return J._70I?J._71I(V,e,L,t):J.moveTo(L,t),J.F-=d,void 0;if(w=J.F/d,r=J._20O(B,A,V,e,L,t,w),J._70I?J._71I(r[2],r[3],r[4],r[5]):J.moveTo(r[4],r[5]),J.F=0,J._70I=!J._70I,!d)return}var $=d-d*w,H=l($/J._83O),g=G/d,U=Q/d;if(H)for(var i=0;H>i;i++)J._70I?(z=w+g,r=J._21O(B,A,V,e,L,t,w,z),J._71I(r[2],r[3],r[4],r[5]),w=z,z=w+U,r=J._21O(B,A,V,e,L,t,w,z),J.moveTo(r[4],r[5])):(z=w+U,r=J._21O(B,A,V,e,L,t,w,z),J.moveTo(r[4],r[5]),w=z,z=w+g,r=J._21O(B,A,V,e,L,t,w,z),J._71I(r[2],r[3],r[4],r[5])),w=z;$=d-d*w,J._70I?$>G?(z=w+g,r=J._21O(B,A,V,e,L,t,w,z),J._71I(r[2],r[3],r[4],r[5]),J.moveTo(L,t),J.F=Q-($-G),J._70I=!1):(r=J._19O(B,A,V,e,L,t,w),J._71I(r[2],r[3],r[4],r[5]),d===G?(J.F=0,J._70I=!J._70I):(J.F=G-$,J.moveTo(L,t))):$>Q?(z=w+U,r=J._21O(B,A,V,e,L,t,w,z),J.moveTo(r[4],r[5]),r=J._19O(B,A,V,e,L,t,z),J._71I(r[2],r[3],r[4],r[5]),J.F=G-($-Q),J._70I=!0):(J.moveTo(L,t),$===Q?(J.F=0,J._70I=!J._70I):J.F=Q-$)},bezierCurveTo:function(){var x=arguments;this.pen={x:x[4],y:x[5]},this.g.bezierCurveTo(x[0],x[1],x[2],x[3],x[4],x[5])},arc:function(U,l,r,E,F,m){m||(E=-E,F=-F),bd(this,U,l,E,F-E,r,r,!1)},rect:function(X,e,h,I){var H=this;H.pen={x:X,y:e},H.moveTo(X,e),H.lineTo(X,e+I),H.lineTo(X+h,e+I),H.lineTo(X+h,e),H.lineTo(X,e)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(m,n,R,J){var T=R-m,K=J-n;return w(T*T+K*K)},_22O:function(z,y,Y,q,G,s,p){for(var Q,d,P,U,e,S,V,I=0,T=z,X=y,N=p>0?p:this._69I,g=1;N>=g;g++)P=g/N,U=1-P,e=U*U,S=2*P*U,V=P*P,Q=e*z+S*Y+V*G,d=e*y+S*q+V*s,I+=this._23O(T,X,Q,d),T=Q,X=d;return I},_21O:function(B,V,U,z,J,d,G,I){var e=this;if(0===G)return e._20O(B,V,U,z,J,d,I);if(1===I)return e._19O(B,V,U,z,J,d,G);var H=e._20O(B,V,U,z,J,d,I);return H.push(G/I),e._19O.apply(e,H)},_20O:function(I,X,e,E,H,h,m){if(1!==m){var z=e+(H-e)*m,G=E+(h-E)*m;e=I+(e-I)*m,E=X+(E-X)*m,H=e+(z-e)*m,h=E+(G-E)*m}return[I,X,e,E,H,h]},_19O:function(h,u,$,f,v,H,R){if(1!==R){var M=h+($-h)*R,T=u+(f-u)*R;$+=(v-$)*R,f+=(H-f)*R,h=M+($-M)*R,u=T+(f-T)*R}return[h,u,$,f,v,H]},_72I:function(g,E){var X=this.pen;(g!==X.x||E!==X.y)&&(X.x=g,X.y=E,this.g.lineTo(g,E))},_71I:function(X,d,P,Q){var N=this.pen;(X!==P||d!==Q||P!==N.x||Q!==N.y)&&(N.x=P,N.y=Q,this.g.quadraticCurveTo(X,d,P,Q))}}),xn.ms_quickVisible=function(k){k._4BQ=!1,k._4CQ=function(b){var Q=b._4EQ;return Q!==s?Q:Q=b._4EQ=this._4FQ(b)},k._4DQ=function(Z){if(!Z)return this.dm().each(function(n){n._4EQ=s}),void 0;Z._4EQ=s;var H=this;if(Z instanceof vc||Mn(Z)||Z instanceof ij||Z.ISubGraph)Z.eachChild(function(v){H.invalidateQuickVisible(v)});else if(Z.getEdges){var l=Z.getEdges();l&&l.each(function(P){H.invalidateQuickVisible(P)})}},k.enableQuickVisibleMode=function(){this._4BQ||(this._4BQ=!0,this._4FQ=this.isVisible,this.isVisible=this._4CQ,this.invalidateQuickVisible=this._4DQ)},k.disableQuickVisibleMode=function(){this._4BQ&&(this._4BQ=!1,this.isVisible=this._4FQ,this.invalidateQuickVisible=Yd)},k.isQuickVisibleMode=function(){return this._4BQ},k.invalidateQuickVisible=Yd},Zd=Eg()+1,dm&&q.console&&Zd&&!1&&(q.navigator&&q.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?q.console.log.apply(console,["Hightopo - Version："+U.Default.getVersion()+" - %cTrial：http://hightopo.com/request.html","color: #f00;"]):q.console.log("Hightopo - Version："+U.Default.getVersion()+" - Trial：http://hightopo.com/request.html"));var Ei=g,lk=g,Zq=p.checkLoadingCompType=function(D){Ei&&!D._72O_&&(lk||(lk={}),lk[D._72O_=qi()]=D)},zm=function(C,t){if(t||(t=C),t&&(Ei||(Ei={}),!Ei[C])){var f=new _i;if(Ei[t]={request:f,url:t},t=p.beforeLoadURL(t,C),t.data){var $=p.parse(t.data);Ni(C,$),p.handleCompTypeLoaded(C,$)}else{f.onload=function(){if(200===this.status||0===this.status){var c=p.parse(f.getResponseText());Ni(C,c),p.handleCompTypeLoaded(C,c)}else Ni(C,g)},f.onerror=function(){Ni(C,g)};var V={};V.url=encodeURI(t),V.sync=!1,f.send(V)}}},Ni=function(Z,X){if(Zi[Z]=X,delete Ei[Z],Lg(Ei)&&(Ei=g,lk)){for(var z in lk){var k=lk[z];k.invalidateAll&&k.invalidateAll(s,"compTypeLoaded",Z),k.redraw&&k.redraw(),k.iv(),delete k._72O_}lk=g}if(X&&lk)for(var z in lk){var k=lk[z];k.invalidateAll&&k.invalidateAll(s,"compTypeLoading",Z),k.redraw&&k.redraw(),k.iv()}},po=u.chart,Tk="",Ug=!0,Me=p.compStack=[],qf=/^style@/,jp=/^attr@/,Ro=/^field@/,bg={x:.5,y:.5},he=function(){Ug=!0},Xo=function(){return Ug},Oo=function(b,t,K,U){if(!b)return 0;if(gs(b.fitSize,t,K)&&U)return U;var F=gs(b.width,t,K);return null==F?20:F},Gl=function(J,E,S,Q){if(!J)return 0;if(gs(J.fitSize,E,S)&&Q)return Q;var w=gs(J.height,E,S);return null==w?20:w},gs=function(n,J,j){if(!n||!n.func)return n;var Q,F=n.func,Z=n.value;return Q=qr(F)?j&&j.vectorDataBindingDisabled&&!n.isSafeFunc?Z:F(J,j):J instanceof Zc||(U.ui?J instanceof U.ui.View:0)?jp.test(F)?J.a(Tk+F.slice(5)):qf.test(F)?J.s(Tk+F.slice(6)):Ro.test(F)?J[F.slice(6)]:J[F]?J[F](j):Z:Z,Z!==s&&Q==g?Z:Q},jj=p.drawImage=function(){var j,i,r,e,y,G,O=3,k=6,H=function(E,u){E.getValue&&E.getValue.compType===u||(E.getValue=function(C){var B=A(E,C);if(B===s&&u.properties){var K=u.properties[C];K&&(B=K.defaultValue)}return B},E.getColor=function(b,F){return F===!0?h(b):h(E.getValue(b))},E.getValue.compType=u)},A=function(y,k,n){var Y,$=!1;if(y.prefix&&i instanceof Zc){var e=i.a(Tk+k);e!==s&&($=!0,Y=e)}return Y===s&&(Y=y[k]),Y&&Y.func&&($=!0,Y=gs(Y,i,r)),n&&(Y=n(Y),$||(y[k]=Y)),Y},h=function(a,q){var v;return v=q?A(a,q):a,j&&j.compGray&&v?p.toGrayColor(v):y&&v?Nb(v,y,G):v},n=function(S){if(Vd(S)){for(var P=new Yn,X=S.length,i=0;X>i;i+=2)P.add({x:S[i],y:S[i+1]});S=P}return S},D=function(H){var F=A(H,"anchorX"),m=A(H,"anchorY");if(F!==s||m!==s)return{x:F===s?bg.x:F,y:m===s?bg.y:m};var w=A(H,"type"),k=A(H,"name");if("image"!==w||!k)return bg;var L=dg(k);return L&&L.anchorX!==s&&L.anchorY!==s?{x:L.anchorX,y:L.anchorY}:bg},X=function(H,B){var h=A(H,Em),m=D(H);if(Vd(h)){var o=h.length,n=A(H,"relative"),C=B.width,c=B.height;if(4===o)h={x:h[0],y:h[1],width:h[2],height:h[3]},n&&(h.x*=C,h.y*=c,h.width*=C,h.height*=c);else if(3===o){var Y=h[0];h={width:h[1],height:h[2]},n&&(h.width*=C,h.height*=c),"object"==typeof Y?Y.length&&(Y={x:Y[0],y:Y[1]}):Y=xm(Y,B,h),h.x=Y.x-h.width*m.x,h.y=Y.y-h.height*m.y}h.x+=A(H,"offsetX")||0,h.y+=A(H,"offsetY")||0,!n&&B.fitSize&&(h=V(H,h,B))}return h},V=function(m,N,u){if(N){var V,Q,S,J={x:N.x,y:N.y,width:N.width,height:N.height},q=D(m),s=A(m,"layoutH"),T=A(m,"layoutV"),R=1,h=1,b=0,U=0,r=1,j=1;switch(s){case"left":break;case"right":J.x+=u.width-u.rw;break;case"center":J.x+=.5*(u.width-u.rw);break;case"scale":case"leftright":default:V=A(m,Mp)||0,V&&(b=Math.abs(U=Math.sin(V)),r=Math.abs(j=Math.cos(V))),"leftright"!==s?(R+=r*(u.widthScale-1),h+=b*(u.widthScale-1)):(R+=J.width?r*(u.width-u.rw)/J.width:0,h+=J.height?b*(u.width-u.rw)/J.height:0,Q=-Math.min(-q.x*j+q.y*U,-q.x*j-(1-q.y)*U,(1-q.x)*j+q.y*U,(1-q.x)*j-(1-q.y)*U))}switch(T){case"top":break;case"bottom":J.y+=u.height-u.rh;break;case"center":J.y+=.5*(u.height-u.rh);break;case"scale":case"topbottom":default:V==g&&(V=A(m,Mp),V&&(b=Math.abs(U=Math.sin(V)),r=Math.abs(j=Math.cos(V)))),"topbottom"!==T?(R+=b*(u.heightScale-1),h+=r*(u.heightScale-1)):(R+=J.width?b*(u.height-u.rh)/J.width:0,h+=J.height?r*(u.height-u.rh)/J.height:0,S=-Math.min(-q.x*U-q.y*j,-q.x*U+(1-q.y)*j,(1-q.x)*U-q.y*j,(1-q.x)*U+(1-q.y)*j))}return(1!==R||1!==h)&&("scale"!==s&&s?"leftright"===s&&(J.x+=J.width*(1-R)*q.x+Q*(u.width-u.rw)):J.x+=J.x*(u.widthScale-1)+q.x*J.width*(u.widthScale-R),"scale"!==T&&T?"topbottom"===T&&(J.y+=J.height*(1-h)*q.y+S*(u.height-u.rh)):J.y+=J.y*(u.heightScale-1)+q.y*J.height*(u.heightScale-h),J.width*=R,J.height*=h),J.width<0&&(J.width=0),J.height<0&&(J.height=0),J}},d=function(_){return Vd(_)?new Yn(_):_},Z=function(k,U,o,H,w,e,R){var W=j.interactiveInfo,i=k.transform;if(i)return j.save(),j.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),W&&W.compInfos.push({comp:k,rect:U,matrix:i.clone(),prefix:Tk,refRect:W.refRect}),!0;w===s&&(w=1),e===s&&(e=1);var M=A(k,"clipPercentage"),n=Yl(o,U);if(n&&!H&&1===w&&1===e&&M==s)return W&&W.compInfos.push({comp:k,rect:U,matrix:W.matrix.clone(),prefix:Tk,refRect:W.refRect}),!1;R=R||bg;var g=U.x+U.width*R.x,G=U.y+U.height*R.y,E=o.x+o.width*R.x,r=o.y+o.height*R.y,p=o.width?w*(U.width/o.width):1,Z=o.height?e*(U.height/o.height):1;if(j.save(),W&&(W.matrix.appendTranslate(g,G).appendRotate(H).appendScale(p,Z).appendTranslate(-E,-r),W.compInfos.push({comp:k,rect:U,matrix:W.matrix.clone(),prefix:Tk,refRect:W.refRect})),bs(j,g,G),no(j,H||0),Po(j,p,Z),bs(j,-E,-r),M!=s){var L=sq(o,A(k,"clipDirection"),M);j.beginPath(),j.rect(L.x,L.y,L.width,L.height),j.clip()}return!0},T=function(){j.restore()},B=function(d,E,M){var V=A(d,"path"),l=A(d,Mp),H=A(d,"scaleX"),Y=A(d,"scaleY"),W=D(d),b=g,q=dn(null,V);if(M||(M=d.unionRect,M||(M=In(q),d.path.func||(d.unionRect=M)),b=M),M){b||(b=d.unionRect,b||(b=In(q),d.path.func||(d.unionRect=b)));var u=Z(d,M,b,l,H,Y,W),S=A(d,"borderPattern"),x=Kg(j,S),O=h(d,"background"),$=h(d,"borderColor"),k=A(d,"borderWidth"),B=A(d,"gradient"),K=h(d,"gradientColor"),f=A(d,"border3d"),X=h(d,"border3dColor"),o=A(d,"border3dAccuracy"),s=j.lineJoin,m=j.lineCap;j.lineJoin=A(d,"borderJoin")||yf,j.lineCap=A(d,"borderCap")||rj,O?(fj(j,O,B,K,b),dn(j,V),j.fill(),x!==j&&dn(j,V)):dn(j,V);var t=A(d,"borderWidthAbsolute");if(t&&(j.save(),j.setTransform(1,0,0,1,0,0)),k&&$&&(j.lineWidth=k,j.strokeStyle=$,j.stroke(),f&&Dg(j,$,X,k,e,o)),Ee(j,S),A(d,"dash")){var U=A(d,"dashWidth")||k;if(U>0){S=A(d,"dashPattern")||dh;var x=Kg(j,S,A(d,"dashOffset")),L=h(d,"dashColor")||h(Uk);x!==j&&dn(j,V),j.strokeStyle=L,j.lineWidth=U,j.stroke(),A(d,"dash3d")&&Dg(j,L,h(d,"dash3dColor"),U,e,A(d,"dash3dAccuracy")),Ee(j,S)}}t&&j.restore(),E===Em&&Ig(j,O,A(d,"depth"),b),j.lineJoin=s,j.lineCap=m,u&&T()}},z=function(w,Q,B,u){var z=A(w,tp,n),W=A(w,Mp),q=D(w);if(z&&u.fitSize){var a=new Yn,t=In(z),S=V(w,t,u),L=t.x+q.x*t.width,J=t.y+q.y*t.height,l=S.x+q.x*S.width,k=S.y+q.y*S.height,c=t.width?S.width/t.width:1,I=t.height?S.height/t.height:1;z.each(function(x){a.add({x:l+(x.x-L)*c,y:k+(x.y-J)*I})}),z=a,w.unionRect=null}var U=A(w,"scaleX"),_=A(w,"scaleY"),v=Q===pc,H=g;if(!B&&v&&(B=w.unionRect,B||(B=In(z),w.points.func||(w.unionRect=B)),H=B),B){v?H||(H=w.unionRect,H||(H=In(z),w.points.func||(w.unionRect=H))):H=B;var Y,E,M,p,P=Z(w,B,H,W,U,_,q),N=A(w,"borderPattern"),m=Kg(j,N),X=h(w,"background"),F=dg(A(w,"repeatImage"),y,G),f=A(w,"gradientPack"),b=A(w,"borderGradientPack"),R=h(w,"borderColor"),C=A(w,"borderWidth"),K=dg(A(w,"borderRepeatImage"),y,G),x=A(w,"segments",d),o=A(w,"gradient"),$=h(w,"gradientColor"),O=A(w,"border3d"),Cc=h(w,"border3dColor"),Ek=A(w,"border3dAccuracy"),Hg=A(w,"closePath"),Zd=A(w,"fillRule")||"nonzero",Zq=j.lineJoin,Hh=j.lineCap;if(j.lineJoin=A(w,"borderJoin")||yf,j.lineCap=A(w,"borderCap")||rj,v)if(X||F||f){var Oe=A(w,"fillClipPercentage");if(Oe!=s){var is=sq(H,A(w,"fillClipDirection"),Oe);j.save(),j.beginPath(),j.rect(is.x,is.y,is.width,is.height),j.clip()}vg(j,z,x,Hg),f?wl(j,f,h,!1,B):F?ji(j,F,y,G,i,r):fj(j,X,o,$,H),j.fill(Zd),f&&j.restore(),Oe!=s&&j.restore(),m!==j&&vg(m,z,x,Hg)}else vg(m,z,x,Hg);else if("roundRect"===Q?Y=A(w,"cornerRadius"):"polygon"===Q?(Y=A(w,"polygonSide"),E=A(w,"cornerRadius"),M=A(w,"regular")):"arc"===Q&&(Y=A(w,"arcFrom"),E=A(w,"arcTo"),M=A(w,"arcClose"),p=A(w,"arcOval")),X||F||f){var Oe=A(w,"fillClipPercentage");if(Oe!=s){var is=sq(H,A(w,"fillClipDirection"),Oe);j.save(),j.beginPath(),j.rect(is.x,is.y,is.width,is.height),j.clip()}Fk(j,Q,H,Y,E,M,p),f?wl(j,f,h,!1,B):F?ji(j,F,y,G,i,r):fj(j,X,o,$,H),j.fill(Zd),f&&j.restore(),Oe!=s&&j.restore(),j!==m&&Fk(m,Q,H,Y,E,M,p)}else Fk(m,Q,H,Y,E,M,p);var Cp=A(w,"borderWidthAbsolute");if(Cp&&(j.save(),j.setTransform(1,0,0,1,0,0)),C&&(R||K||b)&&(j.lineWidth=C,b?wl(j,b,h,!0,B):K?nj(j,K,y,G,i,r):j.strokeStyle=R,j.stroke(),b&&j.restore(),O&&Dg(j,R,Cc,C,e,Ek)),Ee(j,N),A(w,"dash")){var Jp=A(w,"dashWidth")||C;if(Jp>0){N=A(w,"dashPattern")||dh;var m=Kg(j,N,A(w,"dashOffset")),xf=h(w,"dashColor")||h(Uk);m!==j&&(v?vg(m,z,x,Hg):Fk(m,Q,H,Y,E,M,p)),j.strokeStyle=xf,j.lineWidth=Jp,j.stroke(),A(w,"dash3d")&&Dg(j,xf,h(w,"dash3dColor"),Jp,e,A(w,"dash3dAccuracy")),Ee(j,N)}}Cp&&j.restore(),Q===Em&&Ig(j,X,A(w,"depth"),H),j.lineJoin=Zq,j.lineCap=Hh,P&&T()}},b=function(m,n){var X=y||A(m,ml),u=G||A(m,"blendMode"),T=A(m,"name"),b=dg(T,X,u);b&&b.cacheRule!=g&&(b=js(j,b,A(m,"stretch"),n.width,n.height,i,r,X)),b?id(j,b,A(m,"stretch"),n.x,n.y,n.width,n.height,i,r,X,null,u):Ug=!1},f=function(G,c){var I=A(G,"text");if(I!=g){I+="";var q,B=A(G,"gradientPack"),f=A(G,"gradient"),W=h(G,"gradientColor"),U=A(G,"font"),J=A(G,"vertical"),K=A(G,"verticalGap")||0,z=A(G,"align"),o=A(G,"vAlign"),P=A(G,"decoration"),Z=A(G,"letterGap")||0,$=A(G,"wrap"),S=A(G,"borderWidth"),y=A(G,"borderColor");if(B?(q=wl(j,B,h,!1,c),j.restore()):q=h(G,ml),!B&&f&&(q=p.createGradient(j,f,q||p.labelColor,W||u.imageGradient,c.x,c.y,c.width,c.height)),S&&Vd(y)&&(y=wl(j,y,h,!1,c),j.restore()),J){null==K&&(K=1);var b,e,O,C=[],w=[];b=$?ql(I,c.height,U,Z,J,K):[I],j.textBaseline=$l,j.font=U,b.forEach(function(A){for(var R=A.length,J=0,o=(R-1)*K,p=0;R>p;p++){var v=j.measureText(A[p]);C.push(v),o+=v.fontBoundingBoxDescent,J=N(J,v.width)}w.push({width:J,height:o})});var T=(b.length-1)*Z;w.forEach(function(t){T+=t.width}),e=z&&z!==Vn?z===qp?c.x+c.width-T:c.x+(c.width-T)/2:c.x;var E=0;b.forEach(function(M,A){var _=w[A],b=M.length;O=o&&o!==Tj?o===$l?c.y:c.y+c.height-_.height:c.y+(c.height-_.height)/2;for(var $=0;b>$;$++){var N=M[$],g=C[E];Wp(j,N,U,q,{x:e,y:O,width:_.width,height:g.fontBoundingBoxDescent},ii,o,P,Z,S,y),O+=g.fontBoundingBoxDescent+K,E++}e+=_.width+Z})}else{var b=$?ql(I,c.width,U,Z,J,K):I.split("\n"),v=b.length;if(v>1){var D=Lr(U,I),a=D.height,L=v*a+K*(v-1),x=Wi(c);return o&&o!==Tj?o===ep&&(x.y=c.y+c.height-L):x.y=c.y+(c.height-L)/2,x.height=L,qo(j,b,x,U,q,z||Vn,P,Z,S,y),void 0}Wp(j,I,U,q,c,z,o,P,Z,S,y)}}},x=function(y,e){El(j,h(y,ml),e.x,e.y,e.width,e.height,A(y,"width"))},Y=function(Z,T){var k=A(Z,jl),M=0;if(k&&(k.forEach(function(E){M+=E}),M>0)){for(var a=A(Z,"colors")||po,Y=A(Z,"startAngle")||0,X=A(Z,"hollow"),l=A(Z,pp),h=A(Z,ig),E=A(Z,We),e=l?new Yn:g,U=T.x,u=T.y,S=T.width,K=T.height,s=U+S/2,w=u+K/2,G=Q(S,K)/2,p=0,f=0;f<k.length;f++){var b=k[f],P=L*b/M,V=Y+P;if(j.fillStyle=a[p++],p===a.length&&(p=0),j.beginPath(),X){var n=s+W(Y)*G/2,C=w+_(Y)*G/2,H=s+W(V)*G,N=w+_(V)*G;j.moveTo(n,C),j.arc(s,w,G/2,Y,V,!1),j.lineTo(H,N),j.arc(s,w,G,V,Y,!0)}else j.moveTo(s,w),j.arc(s,w,G,V,Y,!0);e&&(P=(Y+V)/2,e.add({text:qr(l)?l(b,f,M,i):b,x:s+.75*W(P)*G,y:w+.75*_(P)*G})),j.closePath(),j.fill(),Y=V}e&&e.each(function(I){kf(j,I.text,h,E,I.x,I.y,0,0,ii)})}},F=function(O,u){var S=A(O,pj);if(S&&S.length>0){var I=S.length,D=A(O,pp),z=A(O,ig),p=A(O,We),W=D?new Yn:g,M=A(O,"minValue")||0,a=A(O,"maxValue");if(a==g&&(a=0,S.forEach(function(O){A(O,jl).forEach(function(A){a=N(a,A)})})),M===a)return;for(var n=u.height/(a-M),C=u.y+a*n,r=A(S[0],jl).length,h=u.width/(3*r+1),B=2*h/I,J=0,e=0;I>e;e++)for(var x=S[e],P=A(x,ml),L=A(x,"colors"),F=A(x,jl),K=0;r>K;K++){L?j.fillStyle=L[K]:P?j.fillStyle=P:(j.fillStyle=po[J++],J===po.length&&(J=0));var t=F[K],l=t*n,V=u.x+(1+3*K)*h+e*B;if(lc(j,V,C-l,B,l),W){var T=qr(D)?D(t,K,x,i):t,v=Lr(z,T).height;W.add({x:V,y:C-l-v,width:B,height:v,text:T})}}W&&W.each(function($){kf(j,$.text,z,p,$.x,$.y,$.width,$.height,ii)})}},E=function(R,r){var t=A(R,pj);if(t&&t.length>0){var P=t.length,z=A(t[0],jl).length,q=r.width/(3*z+1),B=0,I=A(R,"maxValue"),V=A(R,pp),Q=A(R,ig),M=A(R,We),a=V?new Yn:g;if(I==g){I=0;for(var k=0;z>k;k++){for(var G=0,K=0;P>K;K++)G+=A(t[K],jl)[k];I=N(I,G)}}if(I>0){for(var k=0;z>k;k++)for(var h=r.y+r.height,K=0;P>K;K++){var D=t[K],Z=A(D,ml),S=A(D,jl)[k],v=S/I*r.height;Z?j.fillStyle=Z:(j.fillStyle=po[B++],B===po.length&&(B=0)),h-=v;var y={x:r.x+(1+3*k)*q,y:h,width:2*q,height:v};lc(j,y.x,y.y,y.width,y.height),a&&(y.text=qr(V)?V(S,k,D,i):S,a.add(y))}a&&a.each(function(z){kf(j,z.text,Q,M,z.x,z.y,z.width,z.height,ii)})}}},$=function(X,N){var y=A(X,pj);if(y&&y.length>0){for(var D=y.length,m=A(y[0],jl).length,G=N.width/(3*m+1),z=0,b=A(X,pp),t=A(X,ig),c=A(X,We),Q=b?new Yn:g,s=0;m>s;s++){for(var Y=0,V=0;D>V;V++)Y+=A(y[V],jl)[s];if(Y>0){var J=N.y+N.height;for(V=0;D>V;V++){var f=y[V],E=A(f,ml),U=A(f,jl)[s],C=U/Y*N.height;E?j.fillStyle=E:(j.fillStyle=po[z++],z===po.length&&(z=0)),J-=C;var B={x:N.x+(1+3*s)*G,y:J,width:2*G,height:C};lc(j,B.x,B.y,B.width,B.height),Q&&(B.text=qr(b)?b(U,s,f,i):U,Q.add(B))}}}Q&&Q.each(function(o){kf(j,o.text,t,c,o.x,o.y,o.width,o.height,ii)})}},I=function(n,a){var Y=A(n,pj);if(Y&&Y.length>0){var X=Y.length,y=A(n,"minValue")||0,J=A(n,"maxValue");if(J==g&&(J=0,Y.forEach(function(S){A(S,jl).forEach(function(b){J=N(J,b)})})),y===J)return;for(var G=a.height/(J-y),q=a.y+J*G,z=A(Y[0],jl).length,W=a.width/(3*z+1),u=0,$=A(n,"lineWidth")||2,T=A(n,"line3d"),h=A(n,"linePoint"),H=A(n,pp),U=A(n,ig),r=A(n,We),o=0;X>o;o++){var P=Y[o],R=A(P,ml),E=A(P,jl);R?j.strokeStyle=R:(R=j.strokeStyle=po[u++],u===po.length&&(u=0)),j.beginPath();for(var I=0;z>I;I++){var p=a.x+(2+3*I)*W,s=q-E[I]*G;0===I?j.moveTo(p,s):j.lineTo(p,s)}if(j.lineWidth=$,j.stroke(),T&&Dg(j,R,g,$,e),h||H){var m,D=$/2+2;for(I=0;z>I;I++){var B=E[I];if(p=a.x+(2+3*I)*W,s=q-B*G,qr(h)?h(j,p,s,R,I,P,i):h&&(j.fillStyle=R,j.beginPath(),j.arc(p,s,D,0,L,!0),j.fill()),qr(H)?m=H(B,I,P,i):H&&(m=B),m){var t=Lr(U,m).height,M=j.shadowBlur;if(M){var l=j.shadowOffsetX,k=j.shadowOffsetY,b=j.shadowColor;j.shadowOffsetX=0,j.shadowOffsetY=0,j.shadowBlur=0,j.shadowColor=g}kf(j,m,U,r,p,s-t-D+2,0,t,ii),M&&(j.shadowOffsetX=l,j.shadowOffsetY=k,j.shadowBlur=M,j.shadowColor=b)}}}}}},t=function(C){j=C[0],i=C[1],r=C[2],e=C[3],y=C[4],G=C[5]},c=function(){return[j,i,r,e,y,G]},P=function(C,N){var J;r&&r.getDrawableState?J=r.getDrawableState(i):r&&r.getState?J=r.getState(i):(J=i instanceof Zc?i.s(bc):null,(J===s||null===J)&&(J=A(C,bc)));var e=A(N,bc);return e!==s&&null!==e&&e!==J?!1:A(N,ar)},a={border:x,image:b,text:f,pieChart:Y,columnChart:F,stackedColumnChart:E,percentageColumnChart:$,lineChart:I};return function(u,$,Y,o,M,V,Q,m,f,N){if($&&M&&V){var v=c();j=u,i=Q,r=m,!i&&r&&r.isSelfViewEvent&&(i=r),e=r?r._zoom?r._zoom:1:1,y=f,G=N;
var W=M,I=V;if(Dm()){var S,w,E,R,C,l;0===j[Vq]?Dm[0]&&(S=!0):S=!0,j.texureImage2D?Dm[1]&&(w=!0):w=!0,j.texureImage3D?Dm[2]&&(E=!0):E=!0,j.drawDNDState?Dm[3]&&(C=!0):C=!0,U[Uo[1]+Nl[0]+Qj[1]]?Dm[Nl[0]]&&(l=!0):l=!0,ee.widget[0]?Dm[4]&&(R=!0):R=!0,S&&w&&E&&R&&C&&l&&(W=Y,I=o)}if($.tagName)return Xj(sd)&&!q[sd]||j.drawImage($,W,I,M,V),t(v),void 0;if(0==A($,"visible"))return t(v),void 0;y||(y=gs($.color,i,r)),N||(G=gs($.blendMode,i,r)),Xj(sd)&&!q[sd]&&(M=W,V=I);var b=Oo($,i,r,M),K=Gl($,i,r,V),J={x:0,y:0,width:b,height:K,fitSize:A($,"fitSize")},L=A($,"clip"),F=A($,"opacity");if(J.fitSize){var x=J.rw=gs($.width,i,r)||20;J.widthScale=b/x;var _=J.rh=gs($.height,i,r)||20;J.heightScale=K/_}if(j.save(),j.interactiveInfo){var Nh=j.interactiveInfo.matrix,pq=Nh.clone();Nh.appendTranslate(W,I).appendScale(M/b,V/K),j.interactiveInfo.refRect=J}bs(j,W,I),(b!==M||K!==V)&&j.scale(M/b,V/K),L&&(qr(L)?L(j,b,K,i,r,$):(j.beginPath(),j.rect(0,0,b,K),j.clip())),F!=g&&(j.globalAlpha*=F),A($,"comps").forEach(function(N){if(N.prefix){var f=Tk,b=gs(N.prefix,i,r);b&&(Tk=Tk+b+".")}if(0==P($,N))return N.prefix&&(Tk=f),void 0;if(Me.splice(0,0,N),j.interactiveInfo)var W=j.interactiveInfo.matrix.clone();var E=A(N,"opacity"),F=A(N,"shadow"),m=A(N,"type"),c=A(N,"refRect")||J,K=X(N,c);if(E!=g){var t=j.globalAlpha;j.globalAlpha*=E}if(F){var L=e*p.devicePixelRatio,o=j.shadowOffsetX,q=j.shadowOffsetY,v=j.shadowBlur,V=j.shadowColor,u=A(N,"shadowOffsetX"),C=A(N,"shadowOffsetY"),S=A(N,"shadowBlur"),w=h(N,"shadowColor");j.shadowOffsetX=(u==g?O:u)*L,j.shadowOffsetY=(C==g?O:C)*L,j.shadowBlur=(S==g?k:S)*L,j.shadowColor=w||h(_l)}if("save"===m)j.save();else if("endClip"===m||"restore"===m)j.restore();else if("clip"===m)j.save(),vg(j,A(N,"points",n),A(N,"segments",d),!0),j.clip();else if(vp[m]){if(K=K||{x:0,y:0,width:c.width,height:c.height},z(N,m,K,c),N.prefix&&0===N.prefix.indexOf("ui.")&&r&&U.ui&&r instanceof U.ui.View){r._vectorCompInfo||(r._vectorCompInfo=[]);for(var R=!1,G=0;G<r._vectorCompInfo.length;G++){var I=r._vectorCompInfo[G];if(N.prefix===I.comp.prefix&&Q===I.data){r._vectorCompInfo[G]={comp:N,type:m,rect:K,compRefRect:c,data:Q,image:$,transform:j.getTransform()},R=!0;break}}R||r._vectorCompInfo.push({comp:N,type:m,rect:K,compRefRect:c,data:Q,image:$,transform:j.getTransform()})}}else if(m===pc)z(N,m,K,c);else if("SVGPath"===m)B(N,m,K);else{K=K||{x:0,y:0,width:c.width,height:c.height};var y=A(N,Mp),l=A(N,"scaleX"),M=A(N,"scaleY"),_=D(N),Y=Z(N,K,K,y,l,M,_);if(qr(m))H(N,m),p.drawCompType(m,j,K,N,i,r);else if(p.getCompType(m)){var x=p.getCompType(m),sq=x.func||x;H(N,x),p.drawCompType(sq,j,K,N,i,r)}else a[m]?a[m](N,K):p.getCompType(m)===s&&mj.test(m)&&(zm(m),Ug=!1);Y&&T()}F&&(j.shadowOffsetX=o,j.shadowOffsetY=q,j.shadowBlur=v,j.shadowColor=V),E!=g&&(j.globalAlpha=t),j.interactiveInfo&&(j.interactiveInfo.matrix=W),N.prefix&&(Tk=f),Me.splice(0,1)}),j.interactiveInfo&&(j.interactiveInfo.matrix=pq),j.restore(),t(v)}}}();p.getCurrentComp=function(){return Me[0]},p.getParentComp=function(){return Me[1]},p.getInternal=function(){return{isEnter:Um,isEsc:Pi,isSpace:Wc,isLeft:qh,isUp:ol,isRight:Nf,isDown:lg,addMethod:oi,superCall:$e,toPointsArray:Ok,translateAndScale:Bl,appendArray:sb,createWorldMatrix:wi,vec3TransformMat4:aq,setCanvas:Df,createDiv:lp,createView:_f,createCanvas:gj,createImage:pm,initContext:Rl,layout:Iq,fillRect:lc,Mat:Tc,drawBorder:El,isString:Xj,setBorder:rq,getPropertyValue:$g,setPropertyValue:To,drawVerticalLine:Tm,draw3DRect:Ig,getPinchDist:Kq,isSameRect:Yl,getPosition:xm,intersectionLineRect:Sp,getNodeRect:Ec,getEdgeAgentPosition:zb,getEdgeHostPosition:Jc,getImageWidth:Oo,getImageHeight:Gl,initItemElement:Ff,drawPoints:vg,createG2:Kg,closePopup:mf,isH:io,createAnim:sj,createNormalMatrix:$k,toColorArray:Jj,createNormals:Cl,toFloatArray:Vr,glMV:hn,glPop:ur,batchShape:Ll,createNodeMatrix:Ph,getShapeModel:ub,getFaceInfo:vo,transformAppend:ln,drawFaceInfo:hs,glUploadData:bo,glUploadElementData:Zr,glDrawArray:Co,glDrawElement:ih,glBindTexture:nm,pickValueToColor:Ks,to3dPointsArray:Ne,setGLDebugMode:function(g){gf=g},cube:function(){return{vs:jq,is:Pq,uv:Og}},ui:function(){return{DataUI:Cq,NodeUI:yi,EdgeUI:cc,GroupUI:mb,ShapeUI:De,GridUI:xe,Data3dUI:$s,Node3dUI:_s,Shape3dUI:ct}},getInternalVersion:function(){return"U2FsdGVkX19+8zV/gHR+YOs9T3wd8On80DHicaR9j60="},getDragger:function(){return Fe},addMSMap:function(U){oi(xn,U)},k:f,overrideTimerFunc:function(c,S){oq=U.Default.callLater=c,es=U.Default.cancelLater=S},canEnterEditDetailMode:Gj,addEventListener:C,removeEventListener:J}},function(k){function i(p,s){p!=g&&(s==g&&rs!=typeof p?this._54O(p,256):this._54O(p,s))}function V(){return new i(g)}function Y(g,c,O,j,Y,z){for(;--z>=0;){var q=c*this[g++]+O[j]+Y;Y=l(q/67108864),O[j++]=67108863&q}return Y}function b(t,x,f,y,d,Z){for(var u=32767&x,W=x>>15;--Z>=0;){var r=32767&this[t],Y=this[t++]>>15,z=W*r+Y*u;r=u*r+((32767&z)<<15)+f[y]+(1073741823&d),d=(r>>>30)+(z>>>15)+W*Y+(d>>>30),f[y++]=1073741823&r}return d}function $(n,C,S,K,O,m){for(var _=16383&C,h=C>>14;--m>=0;){var s=16383&this[n],q=this[n++]>>14,o=h*s+q*_;s=_*s+((16383&o)<<14)+S[K]+O,O=(s>>28)+(o>>14)+h*q,S[K++]=268435455&s}return O}function d(o){return Yf.charAt(o)}function C(F,P){var e=oj[F.charCodeAt(P)];return e==g?-1:e}function z(m){for(var G=this.t-1;G>=0;--G)m[G]=this[G];m.t=this.t,m.s=this.s}function t(t){this.t=1,this.s=0>t?-1:0,t>0?this[0]=t:-1>t?this[0]=t+this.DV:this.t=0}function A(p){var A=V();return A._58O(p),A}function F(N,R){var M,Q=this;if(16==R)M=4;else if(8==R)M=3;else if(256==R)M=8;else if(2==R)M=1;else if(32==R)M=5;else{if(4!=R)return Q.fromRadix(N,R),void 0;M=2}Q.t=0,Q.s=0;for(var W=N.length,w=!1,A=0;--W>=0;){var H=8==M?255&N[W]:C(N,W);0>H?"-"==N.charAt(W)&&(w=!0):(w=!1,0==A?Q[Q.t++]=H:A+M>Q.DB?(Q[Q.t-1]|=(H&(1<<Q.DB-A)-1)<<A,Q[Q.t++]=H>>Q.DB-A):Q[Q.t-1]|=H<<A,A+=M,A>=Q.DB&&(A-=Q.DB))}8==M&&0!=(128&N[0])&&(Q.s=-1,A>0&&(Q[Q.t-1]|=(1<<Q.DB-A)-1<<A)),Q._57O(),w&&i.ZERO._78O(Q,Q)}function Z(){for(var p=this,W=p.s&p.DM;p.t>0&&p[p.t-1]==W;)--p.t}function a(n){var b=this;if(b.s<0)return"-"+b._85O()[vn](n);var g;if(16==n)g=4;else if(8==n)g=3;else if(2==n)g=1;else if(32==n)g=5;else{if(4!=n)return b.toRadix(n);g=2}var q,Y=(1<<g)-1,r=!1,p="",$=b.t,B=b.DB-$*b.DB%g;if($-->0)for(B<b.DB&&(q=b[$]>>B)>0&&(r=!0,p=d(q));$>=0;)g>B?(q=(b[$]&(1<<B)-1)<<g-B,q|=b[--$]>>(B+=b.DB-g)):(q=b[$]>>(B-=g)&Y,0>=B&&(B+=b.DB,--$)),q>0&&(r=!0),r&&(p+=d(q));return r?p:"0"}function s(){var Z=V();return i.ZERO._78O(this,Z),Z}function x(){return this.s<0?this._85O():this}function T(n){var S=this,i=S.s-n.s;if(0!=i)return i;var W=S.t;if(i=W-n.t,0!=i)return S.s<0?-i:i;for(;--W>=0;)if(0!=(i=S[W]-n[W]))return i;return 0}function q(H){var V,N=1;return 0!=(V=H>>>16)&&(H=V,N+=16),0!=(V=H>>8)&&(H=V,N+=8),0!=(V=H>>4)&&(H=V,N+=4),0!=(V=H>>2)&&(H=V,N+=2),0!=(V=H>>1)&&(H=V,N+=1),N}function m(){var b=this;return b.t<=0?0:b.DB*(b.t-1)+q(b[b.t-1]^b.s&b.DM)}function o(i,u){var f;for(f=this.t-1;f>=0;--f)u[f+i]=this[f];for(f=i-1;f>=0;--f)u[f]=0;u.t=this.t+i,u.s=this.s}function H(Z,x){for(var u=Z;u<this.t;++u)x[u-Z]=this[u];x.t=N(this.t-Z,0),x.s=this.s}function U(U,u){var L,n=this,I=U%n.DB,B=n.DB-I,$=(1<<B)-1,g=l(U/n.DB),D=n.s<<I&n.DM;for(L=n.t-1;L>=0;--L)u[L+g+1]=n[L]>>B|D,D=(n[L]&$)<<I;for(L=g-1;L>=0;--L)u[L]=0;u[g]=D,u.t=n.t+g+1,u.s=n.s,u._57O()}function P(s,u){var L=this;u.s=L.s;var A=l(s/L.DB);if(A>=L.t)return u.t=0,void 0;var W=s%L.DB,e=L.DB-W,R=(1<<W)-1;u[0]=L[A]>>W;for(var a=A+1;a<L.t;++a)u[a-A-1]|=(L[a]&R)<<e,u[a-A]=L[a]>>W;W>0&&(u[L.t-A-1]|=(L.s&R)<<e),u.t=L.t-A,u._57O()}function M(e,$){for(var q=this,J=0,D=0,N=Q(e.t,q.t);N>J;)D+=q[J]-e[J],$[J++]=D&q.DM,D>>=q.DB;if(e.t<q.t){for(D-=e.s;J<q.t;)D+=q[J],$[J++]=D&q.DM,D>>=q.DB;D+=q.s}else{for(D+=q.s;J<e.t;)D-=e[J],$[J++]=D&q.DM,D>>=q.DB;D-=e.s}$.s=0>D?-1:0,-1>D?$[J++]=q.DV+D:D>0&&($[J++]=D),$.t=J,$._57O()}function h(b,g){var c=this.abs(),a=b.abs(),y=c.t;for(g.t=y+a.t;--y>=0;)g[y]=0;for(y=0;y<a.t;++y)g[y+c.t]=c.am(0,a[y],g,y,0,c.t);g.s=0,g._57O(),this.s!=b.s&&i.ZERO._78O(g,g)}function D(e){for(var H=this.abs(),V=e.t=2*H.t;--V>=0;)e[V]=0;for(V=0;V<H.t-1;++V){var $=H.am(V,H[V],e,2*V,0,1);(e[V+H.t]+=H.am(V+1,2*H[V],e,2*V+1,$,H.t-V-1))>=H.DV&&(e[V+H.t]-=H.DV,e[V+H.t+1]=1)}e.t>0&&(e[e.t-1]+=H.am(V,H[V],e,2*V,0,1)),e.s=0,e._57O()}function c(Z,m,A){var U=Z.abs(),C=this;if(!(U.t<=0)){var k=C.abs();if(k.t<U.t)return m!=g&&m._58O(0),A!=g&&C._77O(A),void 0;A==g&&(A=V());var D=V(),c=C.s,y=Z.s,d=C.DB-q(U[U.t-1]);d>0?(U._44O(d,D),k._44O(d,A)):(U._77O(D),k._77O(A));var B=D.t,h=D[B-1];if(0!=h){var z=h*(1<<C.F1)+(B>1?D[B-2]>>C.F2:0),x=C.FV/z,X=(1<<C.F1)/z,w=1<<C.F2,E=A.t,T=E-B,J=m==g?V():m;for(D._59O(T,J),A._52O(J)>=0&&(A[A.t++]=1,A._78O(J,A)),i.ONE._59O(B,J),J._78O(D,D);D.t<B;)D[D.t++]=0;for(;--T>=0;){var O=A[--E]==h?C.DM:l(A[E]*x+(A[E-1]+w)*X);if((A[E]+=D.am(0,O,A,T,0,B))<O)for(D._59O(T,J),A._78O(J,A);A[E]<--O;)A._78O(J,A)}m!=g&&(A._45O(B,m),c!=y&&i.ZERO._78O(m,m)),A.t=B,A._57O(),d>0&&A._46O(d,A),0>c&&i.ZERO._78O(A,A)}}}function u(P){var v=V();return this.abs()._49O(P,g,v),this.s<0&&v._52O(i.ZERO)>0&&P._78O(v,v),v}function E(g){this.m=g}function J(Q){return Q.s<0||Q._52O(this.m)>=0?Q.mod(this.m):Q}function S(C){return C}function B(h){h._49O(this.m,g,h)}function n(Y,X,i){Y._47O(X,i),this._74O(i)}function O(m,Y){m._48O(Y),this._74O(Y)}function p(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var B=3&t;return B=15&B*(2-(15&t)*B),B=255&B*(2-(255&t)*B),B=65535&B*(2-(65535&(65535&t)*B)),B=B*(2-t*B%this.DV)%this.DV,B>0?this.DV-B:-B}function v(H){var Q=this;Q.m=H,Q.mp=H._50O(),Q.mpl=32767&Q.mp,Q.mph=Q.mp>>15,Q.um=(1<<H.DB-15)-1,Q.mt2=2*H.t}function K(P){var C=V();return P.abs()._59O(this.m.t,C),C._49O(this.m,g,C),P.s<0&&C._52O(i.ZERO)>0&&this.m._78O(C,C),C}function G(h){var F=V();return h._77O(F),this._74O(F),F}function X($){for(var B=this;$.t<=B.mt2;)$[$.t++]=0;for(var Y=0;Y<B.m.t;++Y){var p=32767&$[Y],D=p*B.mpl+((p*B.mph+($[Y]>>15)*B.mpl&B.um)<<15)&$.DM;for(p=Y+B.m.t,$[p]+=B.m.am(0,D,$,Y,0,B.m.t);$[p]>=$.DV;)$[p]-=$.DV,$[++p]++}$._57O(),$._45O(B.m.t,$),$._52O(B.m)>=0&&$._78O(B.m,$)}function j(b,d){b._48O(d),this._74O(d)}function R(q,i,T){q._47O(i,T),this._74O(T)}function Yp(){return 0==(this.t>0?1&this[0]:this.s)}function Hb(B,D){if(B>4294967295||1>B)return i.ONE;var d=V(),z=V(),s=D._73O(this),W=q(B)-1;for(s._77O(d);--W>=0;)if(D._76O(d,z),(B&1<<W)>0)D._75O(z,s,d);else{var h=d;d=z,z=h}return D.revert(d)}function Bp(D,Q){var C;return C=256>D||Q._51O()?new E(Q):new v(Q),this.exp(D,C)}function zs(){var $=this;if($.s<0){if(1==$.t)return $[0]-$.DV;if(0==$.t)return-1}else{if(1==$.t)return $[0];if(0==$.t)return 0}return($[1]&(1<<32-$.DB)-1)<<$.DB|$[0]}function $m(x,E){return new i(x,E)}function Lh(){var J=this;J.n=g,J.e=0,J.d=g,J.p=g,J.q=g,J.dmp1=g,J.dmq1=g,J._10A=g}function Nn(V){return V._53O(this.e,this.n)}function Or(R){var Y,W,_,K="",x=0;for(Y=0;Y<R.length&&R.charAt(Y)!=yl;++Y)_=Ik.indexOf(R.charAt(Y)),0>_||(0==x?(K+=d(_>>2),W=3&_,x=1):1==x?(K+=d(W<<2|_>>4),W=15&_,x=2):2==x?(K+=d(W),K+=d(_>>2),W=3&_,x=3):(K+=d(W<<2|_>>4),K+=d(15&_),x=0));return 1==x&&(K+=d(W<<2)),K}function sn(H){var R=H.split(""),w=Or(H);return R.forEach(function(h){var B=h.length;B>0&&w&&(Kk+=vs(h))}),w}function Ml(z,J){var u=aj._4O.Util._56O(z,"ss"),w={},k=0;return w.v=u==J,w.t=1,w.s=0>k?-1:0,_o=w.v,k>0?w[0]=k:-1>k?w[0]=k+w.DV:w.t=0,[u,w]}function $p(Y){var l=38,B=Y.substring(0,l);if(B&&30==B.indexOf("05000420")){var O=["ss",Y.substring(l)];return O}return[]}function an(k,A){A=A.replace(ed,""),A=A.replace(/[ \n]+/g,"");var Q=$m(A,16);if(Q._55O()>this.n._55O())return 0;var c=this._37O(Q),i=c[vn](16).replace(/^1f+00/,""),y=$p(i);if(0==y.length)return!1;for(var B,X,K,f=.5,O=Sq,u=[0,.5,.75,.875,.9375],P=[],V=[],G=[],w=L/O,Y=y[1],D=Ml(k,Y)[0],d=0,I=0;d<u.length;d++){var U=0===d%2?0:.5;for(B=0;O>=B;B++)X=(B+U)*w,K=1-u[d],P.push(W(X)*f*K,-f+2*u[d]*f,-_(X)*f*K),V.push((B+U)/O,K)}for(d=0;d<u.length-1;d++){var M=d*(O+1),R=(d+1)*(O+1);for(B=0;O>B;B++)G.push(M+B,R+B+1,R+B,M+B,M+B+1,R+B+1)}return G.forEach(function(h){I+=h}),Y==D&&I>10}var qb,oo=0xdeadbeefcafe,vg=15715070==(16777215&oo),vn="toString",fl="",yn="nat",tp=function(){};I=k["D"+11182[vn](r(2,5))];var me=i.prototype;Tp+=cl.substr(0,1);var Bs=k.navigator?k.navigator.appName:"";vg&&"Microsoft Internet Explorer"==Bs?(me.am=b,qb=30):vg&&"Netscape"!=Bs?(me.am=Y,qb=26):(me.am=$,qb=28),me.DB=qb,me.DM=(1<<qb)-1,me.DV=1<<qb;var kh=52;me.FV=r(2,kh),me.F1=kh-qb,me.F2=2*qb-kh;var dg,dp,Yf="0123456789abcdefghijklmnopqrstuvwxyz",oj=[],Pg=function(Y){return String.fromCharCode(Y)};for(dg="0".charCodeAt(0),dp=0;9>=dp;++dp)oj[dg++]=dp;for(dg="a".charCodeAt(0),dp=10;36>dp;++dp)oj[dg++]=dp;for(dg="A".charCodeAt(0),dp=10;36>dp;++dp)oj[dg++]=dp;var vk=E.prototype;vk._73O=J,vk.revert=S,vk._74O=B,vk._75O=n,vk._76O=O;var zf=v.prototype;zf._73O=K,zf.revert=G,zf._74O=X,zf._75O=R,zf._76O=j,me._77O=z,me._58O=t,me._54O=F,me._57O=Z,me._59O=o,me._45O=H,me._44O=U,me._46O=P,me._78O=M,me._47O=h,me._48O=D,me._49O=c,me._50O=p,me._51O=Yp,me.exp=Hb,me.toString=a,me._85O=s,me.abs=x,me._52O=T,me._55O=m,me.mod=u,me._53O=Bp,i.ZERO=A(0),i.ONE=A(1),me._86O=zs;var Mb=function(c,d){var C=this;C.isPublic=!0,typeof c!==rs?(C.n=c,C.e=d):c!=g&&d!=g&&c.length>0&&d.length>0&&(C.n=$m(c,16),C.e=vs(d,16))};Ub=function(){var D,i,T=sn(Ce),o=T.substr(0,4),_=T.substr(4,2),b=T.substr(6,2),Y=1,x=!Y,w=f,R=[],C=jb.charAt(7);if(I&&(I[vn]().indexOf(yn)<0||I[Tp][vn]().indexOf(yn)<0||!T?D=g:(T=new I(o-0,_-Y,b-0),i=T.setHours(9),I[Tp]()>i?D=Te[C]:x=!0)),T&&D&&D[0]&&D[y(.5)]&&w){var O=eb(D[0]),v=eb(D[1]);for(var Z in v)R.push(Z);var W,u=0,L=O[R[u]],s=v[R[u++]],K=v[R[u++]],U=v[R[u++]],J=v[R[u++]],V=v[R[u++]],X=v[R[u++]],e=O[R[u]],N=v[R[u++]],M=hf._27O(w);if(L===s&&M&&N){W=s+K+U+J+V+X;var p=!X||X===Gq;if(!p&&X)for(var m,l=0,G=X.length;G>l;l++)X[l]===ci[u]?m===Gq?p=!0:m[0]===as[5]&&Gq&&Gq.indexOf(m.substr(1))>=0?p=!0:m=g:(m==g?m=X[l]:m+=X[l],l===G-1&&(m===Gq?p=!0:m[0]===as[5]&&Gq&&Gq.indexOf(m.substr(1))>=0&&(p=!0)));W&&M._31O(W,N)&&M._31O(L,e)&&p&&(!V||I[Tp]()<V)&&(x=!0)}}return x||(Fk=ld),C};var Eb=Lh.prototype;Eb._37O=Nn,Eb._38O=Mb;var Ik="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",yl="=",xf=25,Ve=10,Ce="ICICFQ==",Fe=Fe||function(M,$){var w={},v=w._7A={},K=v._6A=function(){function f(){}return{_80O:function(B){f.prototype=this;var Z=new f;return B&&Z._5A(B),Z.hasOwnProperty("_82O")||(Z._82O=function(){Z.$super._82O.apply(this,arguments)}),Z._82O.prototype=Z,Z.$super=this,Z},_3A:function(){var L=this._80O();return L._82O.apply(L,arguments),L},_82O:function(){},_5A:function(t){for(var Q in t)t.hasOwnProperty(Q)&&(this[Q]=t[Q]);t.hasOwnProperty(vn)&&(this.toString=t.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),F=v._39O=K._80O({_82O:function(M,q){M=this._84O=M||[],this._65O=q!=$?q:4*M.length},toString:function(K){return(K||t).stringify(this)},_89O:function(U){var a=this._84O,v=U._84O,I=this._65O,g=U._65O;if(this._57O(),I%4)for(var Y=0;g>Y;Y++){var d=255&v[Y>>>2]>>>24-8*(Y%4);a[I+Y>>>2]|=d<<24-8*((I+Y)%4)}else if(v.length>65535)for(var Y=0;g>Y;Y+=4)a[I+Y>>>2]=v[Y>>>2];else a.push.apply(a,v);return this._65O+=g,this},_57O:function(){var q=this._84O,o=this._65O;q[o>>>2]&=4294967295<<32-8*(o%4),q.length=y(o/4)},_88O:function(){var M=K._88O.call(this);return M._84O=this._84O.slice(0),M},_87O:function(H){for(var U=[],E=0;H>E;E+=4)U.push(0|4294967296*Eg);return new F._82O(U,H)}}),n=w._2A={},t=n._69O={stringify:function(P){var G,V=P._84O,y=P._65O,h=[];for(G=0;y>G;G++){var L=255&V[G>>>2]>>>24-8*(G%4);h.push((L>>>4).toString(16)),h.push((15&L).toString(16))}return h.join("")},_68O:function(Z){for(var j=Z.length,m=[],a=0;j>a;a+=2)m[a>>>3]|=vs(Z.substr(a,2),16)<<24-4*(a%8);return new F._82O(m,j/2)}},m=n._8A={stringify:function(p){var I,e=p._84O,Q=p._65O,z=[];for(I=0;Q>I;I++){var Z=255&e[I>>>2]>>>24-8*(I%4);z.push(Pg(Z))}return z.join("")},_68O:function(A){var B,J=A.length,I=[];for(B=0;J>B;B++)I[B>>>2]|=(255&A.charCodeAt(B))<<24-8*(B%4);return new F._82O(I,J)}},h=n._9A={stringify:function(t){try{return decodeURIComponent(escape(m.stringify(t)))}catch(r){throw new Error("")}},_68O:function(B){return m._68O(unescape(encodeURIComponent(B)))}},Z=v._32O=K._80O({_1A:function(){this._83O=new F._82O,this._23O=0},_33O:function(y){typeof y==rs&&(y=h._68O(y)),this._83O._89O(y),this._23O+=y._65O},_25O:function(G){var H=this._83O,f=H._84O,U=H._65O,h=this._79O,C=4*h,g=U/C;g=G?y(g):N((0|g)-this._22O,0);var z=g*h,M=Q(4*z,U);if(z){for(var o=0;z>o;o+=h)this._20O(f,o);var X=f.splice(0,z);H._65O-=M}return new F._82O(X,M)},_88O:function(){var d=K._88O.call(this);return d._83O=this._83O._88O(),d},_22O:0});v._66O=Z._80O({cfg:K._80O(),_82O:function(v){this.cfg=this.cfg._80O(v),this._1A()},_1A:function(){Z._1A.call(this),this._34O()},_81O:function(z){return this._33O(z),this._25O(),this},_72O:function(F){F&&this._33O(F);var N=this._21O();return N},_79O:16,_26O:function(a){return function(Q,t){return new a._82O(t)._72O(Q)}},_19O:function($){return function(h,t){return new f._71O._82O($,t)._72O(h)}}});var f=w._67O={};return w}();!function(){var c=Fe,q=c._7A,V=q._39O,B=q._66O,A=c._67O,I=[],x=[];!function(){function q(J){for(var f=w(J),u=2;f>=u;u++)if(!(J%u))return!1;return!0}function D(E){return 0|4294967296*(E-(0|E))}for(var U=2,p=0;64>p;)q(U)&&(8>p&&(I[p]=D(r(U,.5))),x[p]=D(r(U,1/3)),p++),U++}();var u=[],$=A._41O=B._80O({_34O:function(){this._64O=new V._82O(I.slice(0))},_20O:function(v,$){for(var X=this._64O._84O,V=X[0],b=X[1],z=X[2],D=X[3],p=X[4],a=X[5],Q=X[6],e=X[7],t=0;64>t;t++){if(16>t)u[t]=0|v[$+t];else{var B=u[t-15],G=(B<<25|B>>>7)^(B<<14|B>>>18)^B>>>3,C=u[t-2],d=(C<<15|C>>>17)^(C<<13|C>>>19)^C>>>10;u[t]=G+u[t-7]+d+u[t-16]}var w=p&a^~p&Q,F=V&b^V&z^b&z,W=(V<<30|V>>>2)^(V<<19|V>>>13)^(V<<10|V>>>22),j=(p<<26|p>>>6)^(p<<21|p>>>11)^(p<<7|p>>>25),Z=e+j+w+x[t]+u[t],y=W+F;e=Q,Q=a,a=p,p=0|D+Z,D=z,z=b,b=V,V=0|Z+y}X[0]=0|X[0]+V,X[1]=0|X[1]+b,X[2]=0|X[2]+z,X[3]=0|X[3]+D,X[4]=0|X[4]+p,X[5]=0|X[5]+a,X[6]=0|X[6]+Q,X[7]=0|X[7]+e},_21O:function(){var D=this._83O,H=D._84O,m=8*this._23O,C=8*D._65O;return H[C>>>5]|=128<<24-C%32,H[(C+64>>>9<<4)+14]=l(m/4294967296),H[(C+64>>>9<<4)+15]=m,D._65O=4*H.length,this._25O(),this._64O},_88O:function(){var V=B._88O.call(this);return V._64O=this._64O._88O(),V}});c._41O=B._26O($),c._42O=B._19O($)}();var ed=new RegExp("");ed.compile("[^0-9a-f]","gi"),Lh._28O=-1,Lh._29O=-2,Eb._31O=an,Eb._63O=an,Lh._43O=-2;var Kh=new function(){var b=this;b._5O=function(x,V){if("8"!=x.substring(V+2,V+3))return 1;var b=vs(x.substring(V+3,V+4));return 0==b?-1:b>0&&10>b?b+1:-2},b._13O=function(H,d){var G=b._5O(H,d);return 1>G?"":H.substring(d+2,d+2+2*G)},b._12O=function(M,d){var N=b._13O(M,d);if(""==N)return-1;var W;return W=vs(N.substring(0,1))<8?new i(N,16):new i(N.substring(2),16),W._86O()},b._6O=function(w,G){var x=b._5O(w,G);return 0>x?x:G+2*(x+1)},b._11O=function(T,K){var $=b._6O(T,K),M=b._12O(T,K);return T.substring($,$+2*M)},b._10O=function(D,L){var R=b._6O(D,L),i=b._12O(D,L);return R+2*i},b._7O=function(I,X){var f=[],O=b._6O(I,X);f.push(O);for(var x=b._12O(I,X),o=O,R=0;;){var H=b._10O(I,o);if(H==g||H-O>=2*x)break;if(R>=200)break;f.push(H),o=H,R++}return f}};if(Kh._90O=Pg(Ve+24),Kh._91O=e+Pg(Ve*Ve+8),aj==g||!aj)var aj={};aj._4O!=g&&aj._4O||(aj._4O={});var Oc=aj._4O;aj._4O.Util=new function(){var n=this;n._56O=function(a){var m=new aj._4O._3O;return m._30O(a)},n._4A=function($){var B=new aj._4O._3O;return B._36O($)},n._11A=function(R){var Y=new Oc._3O;return Y._30O(R)}},aj._4O._3O=function(){var q=this;q._8O=function(V,$){if("ss"==V&&"cj"==$){try{q.md=Fe._67O._41O._3A()}catch(m){tp(fl)}q._24O=function(x){q.md._81O(x)},q._35O=function(B){var Y=Fe._2A._69O._68O(B);q.md._81O(Y)},q._60O=function(){var L=q.md._72O();return L[vn](Fe._2A._69O)},q._30O=function(x){return q._24O(x),q._60O()},q._36O=function(N){return q._35O(N),q._60O()}}},q._24O=function(){tp(fl)},q._35O=function(){tp(fl)},q._60O=function(){tp(fl)},q._30O=function(){tp(fl)},q._36O=function(){tp(fl)},q._8O("ss","cj")},Xc=function(h){var F=Lp[Hl[7]],Z=1,C=!1;if(Cc.a!=Lp[Tq])return Cc.a;if(Cc.forEach(function(N){Z*=N}),h>Z){if(F&&F[1]&&F[0]){var H=F[0],g=F[1];g=g.split(Kh._90O),H=H.split(Kh._90O);var m=g[3],I=H[3],V=g[7],j=g[11],f=g[15],N=g[19],b=g[23],$=g[27],R=H[7],l=m+V+j+f+N+b,W=b?!1:!0,c=I===m;if(b){var k=b&&b.split(mp("firefox")[3]);if(k)for(var t=0;t<k.length;t++){var E=k[t];if(E[0]===re[8]&&(E=E.substring(1)),mo.indexOf(E)>=0){W=!0;break}}}C=c&&bf()(I,R)&&bf()(l,$)&&W&&(!N||N>h),C&&j.indexOf(mq.length)>=0&&(Xc[mq.length]=mq),C&&j.indexOf(mq.length+1)>=0&&(Xc[mq.length+1]=mq),C&&j.indexOf(mq.length+3)>=0&&(Xc[mq.length+3]=mq),C&&j.indexOf(rn.length)>=0&&(Xc[rn.length]=rn)}C||(Cq.prototype._42=gl)}else C=!0,Xc[mq.length]=Xc[mq.length+1]=Xc[mq.length+3]=Xc[rn.length]=mq;return Cc.a=C,C},xf=String.fromCharCode(xf+20);var Uc=function(E){return E=E.replace(ed,fl),E=E.replace(/[ \n]+/g,fl)},Jr="30",Lm="06",Ii="02",ej="03",co=$m,zr=/^1f+00/,hf=function(){var N;return N={_18O:function(g){var X=g,S=X.replace(/\s+/g,""),r=Or(S);return r},_14O:function(D){var $=this._18O(D),u=this._15O($);return u},_15O:function(Y){var g=this._17O(Y);if("2a864886f70d010101"==g._61O){var Z=this._16O(g.key),r=new Lh;return r._38O(Z.n,Z.e),r}tp(fl)},_16O:function(Q){var q={};Q.substr(0,2)!=Jr&&tp(fl);var A=Kh._7O(Q,0);return 2!=A.length&&tp(fl),Q.substr(A[0],2)!=Ii&&tp(fl),q.n=Kh._11O(Q,A[0]),Q.substr(A[1],2)!=Ii&&tp(fl),q.e=Kh._11O(Q,A[1]),q},_17O:function(v){var T={};T._40O=g;var n=Kh._7O(v,0);2!=n.length&&tp(fl);var W=n[0];v.substr(W,2)!=Jr&&tp(fl);var Z=Kh._7O(v,W);return 2!=Z.length&&tp(fl),v.substr(Z[0],2)!=Lm&&tp(fl),T._61O=Kh._11O(v,Z[0]),v.substr(Z[1],2)==Lm?T._40O=Kh._11O(v,Z[1]):v.substr(Z[1],2)==Jr&&(T._40O={},T._40O.p=Kh._70O(v,Z[1],[0],Ii),T._40O.q=Kh._70O(v,Z[1],[1],Ii),T._40O.g=Kh._70O(v,Z[1],[2],Ii)),v.substr(n[1],2)!=ej&&tp(fl),T.key=Kh._11O(v,n[1]).substr(2),T}},N._17O?N:g}(),Tn=hf._27O=function(H){return hf._14O(H)};bf=function(){return function(p,M){if(p&&M){M=Uc(M);var N=co(M,r(2,4)),W=this;if(!W||!W.n||N._55O()>W.n._55O())return 0;var O=W._37O(N),B=O[vn](r(2,4)).replace(zr,""),b=$p(B);if(0==b.length)return!1;var Y=b[0],n=b[1],P=function(V){return aj._4O.Util._56O(V,Y)},$=P(p);return n==$}}.bind(Tn(f))};var zm,wp;return function(){var x=Vh.length-Hh.length;if(x>0)for(var W=0;x>W;W++)zm=Oc.Util,wp=Uc}(),gg=function(e,M){M=wp(M);var R=Tn(Rj),X=zk.length,F=2*X,p=co(M,r(X,F)),U=R,S=!0;if(U){var s=U[km[0]];s&&p._55O()<=s._55O()&&(S=!1)}if(S)return 0;var x=U._37O(p),D=x[vn](r(X,F)).replace(zr,""),$=$p(D);if(0==$.length)return!1;var N=$[0],i=$[1],Z=zm._11A(e,N);return i==Z},hf}(q,z),oi(p,{load:function(){var u={},d=function(r){return r?"c_"+(r.sync?"1":"0")+"_"+(r.post?"1":"0")+"_"+(r.responseType||"H")+"_"+(r.mimeType||"H")+"_"+(r.data?JSON.stringify(r.data):"H"):""};return function(g,n,H){var b,U=u[g],D=d(H);return U&&(b=U[D])?(b.push(n),void 0):(u[g]||(U=u[g]={count:0}),b=U[D]=[n],U.count++,p.xhrLoad(g,function(v){delete U[D],U.count--,U.count||delete u[g],b.forEach(function(A){A(v)})},H),void 0)}}(),asyncEach:function(s,w,n){"function"!=typeof n&&(n=Function.prototype);var b=new Array(s.length),$=0,B=!1;s.forEach(function(U,Z){w(U,function(q,R){return B?void 0:q?(B=!0,n(null)):(b[Z]=R,$++,$===s.length?n(b):void 0)})})},xhrLoad:function(N,n,B){var Y=!1;Vd(N)||(Y=!0,N=[N]),B=B||{};var z=B.sync,g=null,E=B.method||"GET";return B.post&&(E="POST"),B.method=E,p.asyncEach(N,function(m,G){var s=new _i;m=p.beforeLoadURL(m),m.data?G(null,m.data):(B.url=encodeURI(m),B.responseType?s.setResponseType(B.responseType):s.setOverrideMimeType(B.mimeType||"text/plain"),s.onload=function(){200===this.status||0===this.status?G(null,s.getResponseText()):G(!0)},s.onerror=function(){G(!0)},s.send(B))},function(C){var t="function"==typeof n;(t||z)&&(g=Y&&C?C[0]:C,t&&n(g))}),z?g:void 0}});var xl=z.setPrototypeOf||function(k,n){return k.__proto__=n,k},Zl=z.getPrototypeOf||function(E){return E.__proto__},Sg=z.freeze;z.isFrozen;var aj=function(){var i=function(H){return H};return function(H){return H&&H.length?new Function("o",["return o['",H.join("']['"),"'];"].join("")):i}}(),Tf=function(){var Y=function(j,P){return j=P};return function(F){return F&&F.length?new Function("o","v",["return o['",F.join("']['"),"'] = v;"].join("")):Y}}();!function(){function z(N){var l=[];if(N)for(var e;(e=U.exec(N))!=s;)l.push(e[1]);return l}function R(Z,q){var o=G.exec(q);this._cell=Z,this._key=o[1],this._format=o[2],this._style=z(o[3])}function Z(v){for(var n=this._cellList=[],H=this._paramList=[],W=v.split(c),t=0,e=W.length;e>t;++t){var E=W[t];if("{{"!==E)for(var u=E.split(x),O=0,C=u.length;C>O;++O){var M=u[O];x.test(M)?(H.push(new R(n.length,M)),n.push(s)):M.length>0&&n.push(M)}else n.push("{")}this._formatList=this._cellList.slice(0)}var W={},u={},c=/(\{\{)/,x=/(\{\w+(?:\:\w+(?:\&[\w\.])*)?\})/,G=/\{(\w+)(?:\:(\w+)((?:\&[\w\.])*))?\}/,U=/\&([\w\.]*)/g;Z.prototype._73O=function(F){for(var v=this._paramList.length;v--;){var h=this._paramList[v],X=F[vs(h._key)+1],Y=u[h._format];Y&&(X=Y(X,h._style)),this._formatList[h._cell]=X}return this._formatList.join("")},Z.prototype._map=function(J){for(var H=this._paramList.length;H--;){var y=this._paramList[H],b=J[y._key],S=u[y._format];S&&(b=S(b,y._style)),this._formatList[y._cell]=b}return this._formatList.join("")};var K=function(b){var D=W[b];return D||(W[b]=D=new Z(b)),D._73O(arguments)};return K.map=function(n,$){var k=W[n];return k||(W[n]=k=new Z(n)),k._map($)},K.setValueFormat=function(y,n){u[y]=n},K.gc=function(){W.length=0},K.__parsed=W,K}();var lh=function(){function B(g,I,m,j){var d=g?g.path.slice(0):[];I&&d.push(I),this.desc=m,this.name=I,this.path=Sg(d),this.getter=aj(d),this.setter=Tf(d),this.isLeaf=j,this.parent=g,this.children=[],this.childMap={}}return B.create=function(){function e(a,v,o,d){var _=d(o),F=new B(a,v,o,_);if(!_){for(var l=F.children,T=F.childMap,X=z.keys(o),W=0,G=X.length;G>W;++W){var g=X[W],q=e(F,g,o[g],d);l.push(q),T[q.name]=q}F.children=Sg(l),F.childMap=Sg(T)}return Sg(F),F}return function(r,k){return e(s,s,r,k)}}(),B.prototype.forEach=function(E,X){for(var R=this.children,D=0,z=R.length;z>D;++D){var o=R[D];E(o,X)}},B}(),Sg=z.freeze,wk={main:{mask:1,priority:p.cameraPriority.main,clearDepth:!1,ignore:!1},top:{mask:2,priority:p.cameraPriority.top,ignore:!1}},tm="main",Sc=wk[tm].mask,Oj=function(C,T){C=C||0;var A;if(T in wk)A=wk[T].mask;else{if(!(32>Jd))throw new Error("Only 31 render layer can be defined.");wk[T]={mask:1<<Jd++,priority:wk[tm].priority},A=wk[T].mask,tq=En(z.keys(wk)),Jd=tq.length}return C|=A},di=function(g){var Y=0;if("string"==typeof g)Y=Oj(Y,g);else for(var z=0,W=g.length;W>z;++z)Y=Oj(Y,g[z]);return Y},yl=function(Q,S){return Q&&S&&Q&S},En=function(y){return y.sort(function(G,q){return wk[G].priority-wk[q].priority})},tq=En(z.keys(wk)),Jd=tq.length;oi(p,{setRenderLayerInfo:function(w,U){if(Oj(0,w),U){for(var c in U)wk[w][c]=U[c];U.priority&&(tq=En(z.keys(wk)))}},getRenderLayerInfo:function(m){return wk[m]}},!0);var Yn=U.List=function(){this._as=[];var k,b,T=arguments.length;if(1===T){var e=arguments[0];if(Qq(e)&&(e=e._as),Vd(e))for(b=e.length,k=0;b>k;k++)this._as.push(e[k]);else e!=g&&this._as.push(e)}else if(T>1)for(k=0;T>k;k++)this._as.push(arguments[k])};jn("List",z,{forEach:function(C,a){this.each(C,a)},push:function(){for(var X=0;X<arguments.length;X++)this.add(arguments[X])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(g,V){return V===s?this._as.push(g):this._as.splice(V,0,g)},addAll:function(J){Qq(J)&&(J=J._as),Vd(J)?sb(this._as,J):this._as.push(J)},get:function(B){return this._as[B]},slice:function(g,S){return new Yn(this._as.slice(g,S))},remove:function(F){var M=this._as.indexOf(F);return M>=0&&M<this._as.length&&this.removeAt(M),M},removeAt:function(V){return this._as.splice(V,1)[0]},set:function(D,O){return this._as[D]=O},clear:function(){return this._as.splice(0,this._as.length)},contains:function($){return this._as.indexOf($)>=0},indexOf:function(v){return this._as.indexOf(v)},each:function(Y,J){for(var a=0,X=this._as.length;X>a;a++){var j=this._as[a];J?Y.call(J,j,a,this):Y(j,a,this)}},reverseEach:function(C,Q){for(var u=this._as.length-1;u>=0;u--){var b=this._as[u];Q?C.call(Q,b):C(b)}},getArray:function(){return this._as},toArray:function(u,h){if(u){for(var T,y=[],p=0,X=this._as.length;X>p;p++)T=this._as[p],h?u.call(h,T)&&y.push(T):u(T)&&y.push(T);return y}return this._as.concat()},toList:function(N,W){if(N){for(var m,j=new Yn,o=0,K=this._as.length;K>o;o++)m=this._as[o],W?N.call(W,m)&&j.add(m):N(m)&&j.add(m);return j}return new Yn(this)},reverse:function(){this._as.reverse()},sort:function(Z){return this._as.sort(Z?Z:Kc),this},toString:function(){return this._as.toString()}}),z.defineProperties(Yn.prototype,{length:{get:function(){return this._as.length},set:function(z){this._as.length=z}}});var Bn=new Yn;oi(Bn,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Yd,each:Yd,reverseEach:Yd,toArray:function(){return[]},toList:function(){return new Yn},add:tb,addAll:tb,set:tb,remove:tb,removeAt:tb,clear:tb});var Ri=U.Notifier=function(){this._f=0};jn("Notifier",z,{contains:function(I,m){if(this._ls)for(var F,X=0,e=this._ls.size();e>X;X++)if(F=this._ls.get(X),I===F.l&&m===F.s)return!0;return!1},add:function(s,c,n){var T=this,j={l:s,s:c,a:n};T._ls||(T._ls=new Yn),T._f?(T._as||(T._as=new Yn),T._as.add(j)):j.a?T._ls.add(j,0):T._ls.add(j)},remove:function(a,E){var c=this;c._ls&&(c._f?(c._rs||(c._rs=new Yn),c._rs.add({l:a,s:E})):c._remove(a,E))},_remove:function(G,w){for(var K,B=this._ls,M=0,U=B.size();U>M;M++)if(K=B.get(M),K.l===G&&K.s===w)return B.removeAt(M),void 0},fire:function(Q){var i=this,A=i._ls;if(i._b=1e4,A){++i._f;try{for(var f,g=0,c=A.size();c>g;g++)f=A.get(g),f.s?f.l.call(f.s,Q):f.l(Q)}catch(Q){yo(function(){throw Q})}finally{if(--i._f)return;if(i._rs){for(c=i._rs.size(),g=0;c>g;g++)f=i._rs.get(g),i._remove(f.l,f.s);delete i._rs}if(i._as){for(c=i._as.size(),g=0;c>g;g++)f=i._as.get(g),f.a?A.add(f,0):A.add(f);delete i._as}}}}});var Zc=U.Data=function(){this._id=qi()};jn("Data",z,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:g,_parent:g,_children:Bn,_childMap:g,_styleMap:g,_layer:"0",_renderLayer:tm,_renderLayerMask:Sc,_adjustChildrenToTop:!1,getRenderLayerMask:function(){return this._renderLayerMask||Sc},getRenderLayer:function(){return this._renderLayer||tm},setRenderLayer:function(z){var y=this,L=Oj(0,z);y._renderLayerMask=L;var S=y._renderLayer;y._renderLayer=z,y.fp("renderLayer",S,y._renderLayer)},testRenderLayer:function(o){var B=wk[o];return B&&yl(this._renderLayerMask,wk[o].mask)},getUIClass:function(){return g},_22Q:function(){return g},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(j,Q){var b=this;if(2===arguments.length)b.setStyle(j,Q);else{if(!Np(j))return b.getStyle(j);for(var v in j)b.setStyle(v,j[v])}return b},fp:function(y,N,D,n,T){return this.firePropertyChange(y,N,D,n,T)},firePropertyChange:function(L,c,Z,N,P){if(N){if(N(c,Z))return!1}else if(c===Z)return!1;var e=this,z=P||{};return z.property=L,z.oldValue=c,z.newValue=Z,z.data=e,e._dataModel&&e._dataModel.handleDataPropertyChange(z),e.onPropertyChanged(z),!0},onPropertyChanged:function(j){var I=this,Y=I._parent,f=j.property;if(Mn(Y)){var p=I.s(qn),U="s:ingroup"===f;(p&&Jk[f]||f===U)&&Y._81I(),(p||U)&&Y.fp("childChange",!0,!1)}pi(Y)&&(Jk[f]||"elevation"===f||Kb[f]||"scaleTall"===f||"tall"===f)&&Y.updateFromChildren(),("s:alwaysOnTop"===f||"s:shape3d.alwaysOnTop"===f)&&(j.newValue?this.setRenderLayer("top"):this.setRenderLayer(s))},_21I:function(X){var B=this;if(X&&B._dataModel)throw"Remove data from dataModel before adding";B._dataModel=X},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var X=0,Q=this._children.toArray(),M=Q.length;M>X;X++)Q[X].removeFromDataModel()
},getId:function(){return this._id},setId:function(J){this._id=J},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(S,I){return this._children.toList(S,I)},eachChild:function(Q,n){this._children.each(Q,n)},addChild:function(s,u){var L=this;s!==L&&(L._children===Bn&&(L._children=new Yn,L._childMap={}),u>=0||(u=L._children.size()),L._childMap[s._id]||L.isDescendantOf(s)||(s._parent&&s._parent.removeChild(s),(0>u||u>L._children.size())&&(u=L._children.size()),L._children.add(s,u),L._childMap[s._id]=s,s.setParent(L),L.onChildAdded(s,u),L.fp(Xr,g,s)))},onChildAdded:function(){},removeChild:function(k){var f=this;if(f._childMap&&f._childMap[k._id]){var q=f._children.remove(k);delete f._childMap[k._id],f.fp(Xr,k,g),k.setParent(g,q),f.onChildRemoved(k,q)}},onChildRemoved:function(){},getChildAt:function(Y){return this._children.get(Y)},clearChildren:function(){var w=this;if(!w._children.isEmpty())for(var e=0,P=w._children.toArray(),s=P.length;s>e;e++)w.removeChild(P[e])},getParent:function(){return this._parent},setParent:function(W,O){var C=this;if(!(C._73I||C._parent===W||C===W||W&&W.isDescendantOf(C))){var F,x=C._parent;C._parent=W,C._73I=1,x?(O==g&&(O=x.getChildren().indexOf(C)),x.removeChild(C)):C._dataModel&&O==g&&(O=C._dataModel.getRoots().indexOf(C)),W&&(W.addChild(C),F=W.getChildren().indexOf(C)),delete C._73I,C.fp("parent",x,W,s,{oldIndex:O,newIndex:F}),C.onParentChanged(x,W)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(h){return h?this.isDescendantOf(h)||h.isDescendantOf(this):!1},isParentOf:function(P){return P&&this._childMap?!!this._childMap[P._id]:!1},isDescendantOf:function(z){if(!z||z.isEmpty())return!1;for(var X=this._parent;X;){if(z===X)return!0;X=X._parent}return!1},getStyle:function(E,U){U===s&&(U=1);var j=this._styleMap?this._styleMap[E]:s;return j===s&&U?x[E]:j},setStyle:function(M,X){var v=this;v._styleMap||(v._styleMap={});var k=v._styleMap[M];X===s?delete v._styleMap[M]:v._styleMap[M]=X,v.fp("s:"+M,k,X)&&v.onStyleChanged(M,k,X)},onStyleChanged:function(){},iv:function(a){this.invalidate(a)},invalidate:function(r){this.fp(r||"*",!1,!0)},toString:function(){var V=this;return V._displayName||V._name||V._tag||V._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(L,q){var d=this,H=d.s(mc);d.beginTransaction(),H||d.s(mc,H={}),q?H[L]=q:delete H[L],d.fp(mc,g,H),d.endTransaction()},removeStyleIcon:function(L){var u=this.s(mc);if(u){var I=u[L];delete u[L],this.fp(mc,g,u)}return I},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(t){var U=this;if(U.hasOwnProperty("_anchor")||U.hasOwnProperty("_anchorElevation")){var z=U.getAnchor3d(),f={x:z.x-.5,y:z.y-.5,z:z.z-.5};Lj(t,[-f.x,-f.y,-f.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,renderLayer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var Z,y={};for(Z in this._styleMap)y[Z]=1;return y},getCurrentPrefix:function(){return this._interactPrefix||Tk},ca:function(i,u){var q=this.getCurrentPrefix();return i=q+i,2===arguments.length?this.a(i,u):this.a(i)}});var _m=U.DataModel=function(){var P=this;P._isDeserializing=0,P._datas=new Yn,P._dataMap={},P._roots=new Yn,P._rootMap={},P._fsDataMap={},P._78O={},P._reflectorMap={},P._36I=new Ri,P._35I=new Ri,P._serializeNotifier=new Ri,P._selectionModel=new Gr(P);var w=P._29Q=[],B=P._scheduleCallback=function(){for(var D=Date.now(),W=0;W<w.length;W++){var S=w[W];S.enabled&&D-S.lastTime>S.interval&&(S.beforeAction&&S.beforeAction(),S.action&&P.each(function(X){S.action(X)}),S.afterAction&&S.afterAction(),S.lastTime=D)}w.length&&(P._30Q=q.requestAnimationFrame(B))}};jn("DataModel",z,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmapType","envmap","postProcessingData","init"],_name:s,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:s,_init:s,_envmap:s,_envmapType:s,_postProcessingData:s,sm:function(){return this.getSelectionModel()},mm:function(Z,T,x){this.addDataModelChangeListener(Z,T,x)},umm:function(X,v){this.removeDataModelChangeListener(X,v)},md:function(D,v,L){this.addDataPropertyChangeListener(D,v,L)},umd:function(d,c){this.removeDataPropertyChangeListener(d,c)},mh:function(B,k,D){this.addHierarchyChangeListener(B,k,D)},umh:function(Q,U){this.removeHierarchyChangeListener(Q,U)},getAttrObject:function(){return this._attrObject},setAttrObject:function(L){return this._attrObject=L},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(V){return this._dataMap[V]},removeDataById:function(v){this.remove(this.getDataById(v))},toDatas:function(S,j){return this._datas.toList(S,j)},each:function(h,W){this._datas.each(h,W)},getDataByTag:function(T){return this._78O[T]},getTagMap:function(){return this._78O},removeDataByTag:function(B){this.remove(this.getDataByTag(B))},add:function(n,v,h){var W=this,L=n._id,f=n._tag,p=W._roots;if(W._dataMap[L])throw"'"+L+"' already exists";f!=g&&(W._78O[f]=n),W._dataMap[L]=n,h>=0?W._datas.add(n,h):W._datas.add(n),n._parent||(W._rootMap[L]=n,v>=0?p.add(n,v):p.add(n)),n.s("fullscreen")!==s&&(W._fsDataMap[L]=n),n.s("shape3d.reflector")&&(W._reflectorMap[L]=n),n._21I(W),W.onAdded(n),W._36I.fire({kind:"add",data:n,rootsIndex:v,datasIndex:h})},onAdded:function(){},remove:function(Z,$){if(Z){var P=this,u=Z._id,d=$&&$.keepStructure,B=$&&$.keepChildren,U=Z.getTag();if(Z._dataModel===P){var T=Z instanceof vc;T&&p.setIsolating(!0),this.beginTransaction(),d?P._removingData||(P._removingData=Z):P.prepareRemove(Z),B||Z.toChildren().each(function(s){P.remove(s,$)},P),d?P._removingData===Z&&(Z._parent&&Z._parent.removeChild(Z),delete P._removingData):Z._parent&&Z._parent.removeChild(Z);var f=P._datas.remove(Z);delete P._dataMap[u],U!=g&&delete P._78O[U];var O;P._rootMap[u]&&(delete P._rootMap[u],O=P._roots.remove(Z)),P._fsDataMap[u]&&delete P._fsDataMap[u],P._reflectorMap[u]&&delete P._reflectorMap[u],Z._21I(g),P.onRemoved(Z),P._36I.fire({kind:Lf,data:Z,rootsIndex:O,datasIndex:f}),this.endTransaction(),T&&p.setIsolating(!1)}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var w=this;if(w._datas.size()){var C=w._historyManager?this.toJSON():s;w._datas.toArray().forEach(function(A){A._21I(g)}),w._datas.clear(),w._dataMap={},w._roots.clear(),w._rootMap={},w._fsDataMap={},w._reflectorMap={},w._78O={},w._36I.fire({kind:rm,json:C})}},contains:function(X){return X&&X._dataModel===this},handleDataPropertyChange:function(p){var W=this,C=p.data,E=p.property;if("parent"===E){var d=C._id,Y=W._rootMap,I=W._roots;C._parent?Y[d]&&(delete Y[d],I.remove(C)):Y[d]||(Y[d]=C,I.add(C))}else if("tag"===E){var n=p.oldValue,f=p.newValue,B=W._78O;n!=g&&delete B[n],f!=g&&(B[f]=C)}else if("s:fullscreen"===E){var d=C._id,e=W._fsDataMap;p.oldValue!=g&&delete e[d],p.newValue!=g&&(e[d]=C)}else if("s:shape3d.reflector"===E){var d=C._id,s=W._reflectorMap;p.oldValue&&delete s[d],p.newValue&&(s[d]=C)}this.onDataPropertyChanged(C,p),this._35I.fire(p)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(N,$,i){this._36I.add(N,$,i)},removeDataModelChangeListener:function(Y,f){this._36I.remove(Y,f)},addSerializeListener:function(C,w,T){this._serializeNotifier.add(C,w,T)},removeSerializeListener:function(Y,d){this._serializeNotifier.remove(Y,d)},fireSerializeEvent:function(A){this._serializeNotifier.fire(A)},addDataPropertyChangeListener:function(C,K,e){this._35I.add(C,K,e)},removeDataPropertyChangeListener:function(k,y){this._35I.remove(k,y)},_38I:function(Z,R,r){this._37I&&this._37I.fire({data:Z,oldIndex:R,newIndex:r})},addHierarchyChangeListener:function(x,X,Y){this._37I||(this._37I=new Ri),this._37I.add(x,X,Y)},removeHierarchyChangeListener:function(K,v){this._37I.remove(K,v)},getSiblings:function(s){var e=s._parent;return e?e._children:this._roots},eachByHierarchical:function(x,i,$){if(i)return this._eachByHierarchical(x,i,$);for(var q=0,M=this._roots,m=M.size();m>q;q++)if(this._eachByHierarchical(x,M.get(q),$)===!1)return!1;return!0},_eachByHierarchical:function(c,J,$){if($){if(c.call($,J)===!1)return!1}else if(c(J)===!1)return!1;for(var U=J.size(),o=0;U>o;o++)if(this._eachByHierarchical(c,J.getChildAt(o),$)===!1)return!1;return!0},reverseEachByHierarchical:function(E,C,w){if(C)return this._reverseEachByHierarchical(E,C,w);for(var p=this._roots,Q=p.size(),n=Q-1;n>=0;n--)if(this._reverseEachByHierarchical(E,p.get(n),w)===!1)return!1;return!0},_reverseEachByHierarchical:function(V,Z,h){for(var f=Z.size(),k=f-1;k>=0;k--)if(this._reverseEachByHierarchical(V,Z.getChildAt(k),h)===!1)return!1;if(h){if(V.call(h,Z)===!1)return!1}else if(V(Z)===!1)return!1;return!0},eachByDepthFirst:function(d,b,W){if(b)return this._11I(d,b,W);for(var Z=0,J=this._roots,c=J.size();c>Z;Z++)if(this._11I(d,J.get(Z),W)===!1)return!1;return!0},_11I:function(T,V,B){for(var E=V.size(),n=0;E>n;n++)if(this._11I(T,V.getChildAt(n),B)===!1)return!1;if(B){if(T.call(B,V)===!1)return!1}else if(T(V)===!1)return!1;return!0},eachByBreadthFirst:function(d,V,L){var p=new Yn;for(V?p.add(V):this._roots.each(p.add,p);p.size()>0;)if(V=p.removeAt(0),V.eachChild(p.add,p),L){if(d.call(L,V)===!1)return!1}else if(d(V)===!1)return!1;return!0},moveTo:function(L,f){var J=this.getSiblings(L),w=J.indexOf(L);w===f||0>w||f>=0&&f<=J.size()&&(J.remove(L),f>J.size()&&f--,J.add(L,f),this._38I(L,w,f))},moveUp:function(m){this.moveTo(m,this.getSiblings(m).indexOf(m)-1)},moveDown:function(U){this.moveTo(U,this.getSiblings(U).indexOf(U)+1)},moveToTop:function(T){this.moveTo(T,0)},moveToBottom:function(K){this.moveTo(K,this.getSiblings(K).size())},moveSelectionUp:function(I){this.beginTransaction(),I||(I=this.sm());var q=new Yn;Sk(I,q,this._roots),q.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(w){this.beginTransaction(),w||(w=this.sm());var k=new Yn;xr(w,k,this._roots),k.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(A){this.beginTransaction(),A||(A=this.sm());var l=new Yn;li(A,l,this._roots),l.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(W){this.beginTransaction(),W||(W=this.sm());var G=new Yn;nq(W,G,this._roots),G.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(j,J,r){var P=this.getDatas();null==r&&(r=P.indexOf(j)),r===J||0>r||J>=0&&J<=P.size()&&(P.remove(j),J>P.size()&&J--,P.add(j,J),this._76I(j,r,J))},bringForward:function(k){this.moveToIndex(k,this.getDatas().indexOf(k)+1)},bringToFront:function(E){this.moveToIndex(E,this.size())},sendBackward:function(E){this.moveToIndex(E,this.getDatas().indexOf(E)-1)},sendToBack:function(S){this.moveToIndex(S,0)},bringSelectionForward:function(D){this.beginTransaction(),D||(D=this.sm());for(var G=new Yn,P=this.getDatas(),q=!1,m=0;m<P.size();m++){var T=P.get(P.size()-1-m);D.contains(T)?q&&G.add(T):q=!0}G.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(c){this.beginTransaction(),c||(c=this.sm());for(var O=new Yn,r=this.getDatas(),h=0;h<r.size();h++){var e=r.get(h);c.contains(e)&&O.add(e)}O.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(H){this.beginTransaction(),H||(H=this.sm());for(var k=new Yn,F=this.getDatas(),f=!1,G=0;G<F.size();G++){var o=F.get(G);H.contains(o)?f&&k.add(o):f=!0}k.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(o){this.beginTransaction(),o||(o=this.sm());for(var E=new Yn,l=this.getDatas(),s=0;s<l.size();s++){var j=l.get(l.size()-1-s);o.contains(j)&&E.add(j)}E.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(B){var v=this;v.removeScheduleTask(B),B.enabled==g&&(B.enabled=!0),B.interval==g&&(B.interval=10),B.lastTime=Date.now(),v._29Q.push(B),v._30Q==g&&(v._30Q=q.requestAnimationFrame(v._scheduleCallback))},removeScheduleTask:function(Q){var R=this,C=R._29Q,z=C.indexOf(Q);z>=0&&C.splice(z,1),C.length||R._30Q==g||(q.cancelAnimationFrame(R._30Q),delete R._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(a){this._historyManager||new U.HistoryManager(this),null!=a&&this._historyManager.setMaxHistoryCount(a),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(k){this._historyManager&&this._historyManager.undo(k)},redo:function(u){this._historyManager&&this._historyManager.redo(u)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(v){this._historyManager&&this._historyManager.addHistory(v)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(H){H?this._isDeserializing++:this._isDeserializing--},updateLayoutAttach:function(m){this.each(function(p){p instanceof rk&&p.getImage()===m&&p.updateLayoutAttaches()})},isCubicEnvmap:function(){return!1},setCubicEnvmap:function(){}});var Gr=U.SelectionModel=function(E){var c=this;c._68O=Bm,c._map={},c._73O=new Yn,c._74I=new Ri,c._21I(E)};jn("SelectionModel",z,{ms_fire:1,ms_dm:1,ms:function(q,m,G){this.addSelectionChangeListener(q,m,G)},ums:function(i,A){this.removeSelectionChangeListener(i,A)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===hb},co:function(P){return this._map[P._id]!=g},ss:function(O){this.setSelection(O)},as:function(q){this.appendSelection(q)},rs:function(T){this.removeSelection(T)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(M){var y=this;if(y._68O!==M&&(M===km||M===hb||M===Bm)){y.cs();var x=y._68O;y._68O=M,y.fp("selectionMode",x,M)}},_21I:function(r){var I=this,k=I._dataModel;k!==r&&(k&&(I.cs(),k.umm(I.handleDataModelChange,I)),I._dataModel=r,r.mm(I.handleDataModelChange,I,!0),I.fp(Mi,k,r))},dispose:function(){var f=this;f.cs(),f._dataModel.umm(f.handleDataModelChange,f)},handleDataModelChange:function(B){var k=this;if(B.kind===Lf){var G=B.data;k.co(G)&&(k._73O.remove(G),delete k._map[G._id],k._75I(Lf,new Yn(G)))}else B.kind===rm&&k.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(f){var t=this;if(t._filterFunc!==f){t.cs();var b=t._filterFunc;t._filterFunc=f,t.fp("filterFunc",b,t._filterFunc)}},_75I:function(e,t,q,S){q&&(this._73O.each(function(z){S[z._id]?q.remove(z):q.add(z)}),t=q.toList()),this._74I.fire({kind:e,datas:new Yn(t)})},addSelectionChangeListener:function(M,v,E){this._74I.add(M,v,E)},removeSelectionChangeListener:function(U,L){this._74I.remove(U,L)},_97O:function(z,M){for(var f,N=this,P=0,s=new Yn(z);P<s.size();P++)f=s.get(P),(N._filterFunc&&!N._filterFunc(f)||M&&N.co(f)||!M&&!N.co(f)||!N._dataModel.contains(f))&&(s.removeAt(P),P--);return s},appendSelection:function(K){var R=this;if(R._68O!==km){var a,$,w=R._73O,c=R._97O(K,!0);c.isEmpty()||(R.sg()&&(a=new Yn(w),$=R._map,w.clear(),R._map={},c=new Yn(c.get(c.size()-1))),c.each(function(f){w.add(f),R._map[f._id]=f}),R._75I("append",c,a,$))}},removeSelection:function(n){var g=this,S=g._97O(n),E=0,H=S.size();if(0!==H){for(;H>E;E++){var l=S.get(E);g._73O.remove(l),delete g._map[l._id]}g._75I(Lf,S)}},toSelection:function(z,k){return this._73O.toList(z,k)},getSelection:function(){return this._73O},each:function(I,B){this._73O.each(I,B)},setSelection:function(C){var b=this,l=b._73O;if(b._68O!==km&&!(l.isEmpty()&&!C||1===l.size()&&b.ld()===C)){var e=new Yn(l),I=b._map;l.clear(),b._map={};var y=b._97O(C,!0);b.sg()&&y.size()>1&&(y=new Yn(y.get(y.size()-1))),y.each(function(e){l.add(e),b._map[e._id]=e}),b._75I("set",g,e,I)}},clearSelection:function(){var W=this,o=W._73O;if(o.size()>0){var g=o.toList();o.clear(),W._map={},W._75I(rm,g)}},selectAll:function(){var I=this;if(I._68O!==km){var k,e,i=I._dataModel.toDatas();if(I._filterFunc)for(k=0;k<i.size();k++)e=i.get(k),I._filterFunc(e)||(i.removeAt(k),k--);var A=I._73O,t=new Yn(A),W=I._map;A.clear(),I._map={},I.sg()&&i.size()>1&&(i=new Yn(i.get(i.size()-1)));var p=i.size();for(k=0;p>k;k++)e=i.get(k),A.add(e),I._map[e._id]=e;I._75I("all",g,t,W)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(i){return this._map[i._id]!=g},getLastData:function(){var i=this._73O;return i.size()>0?i.get(i.size()-1):g},getFirstData:function(){var C=this._73O;return C.size()>0?C.get(0):g},isSelectable:function(K){var o=this;return K&&o._68O!==km?o._filterFunc?o._filterFunc(K):!0:!1},getTopSelection:function(){var z=this,a=new Yn;return z._73O.each(function(F){for(var w=F.getParent();w;){if(z.contains(w)){F=g;break}w=w.parent}F&&a.add(F)}),a}});var Ec=function(){return Vo(0),function(Z,Y){var E;if(ve(Y)){var o=Z.getDataUI(Y);o&&o._88I&&(E=o._88I.rect)}return E?E:Y.getRect()}}();oi(p,{edgeGroupAgentFunc:g,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:u.rectSelectBorder,graphViewRectSelectBackground:Tb,graphViewEditPointSize:Pb?17:7,graphViewEditPointBorderColor:u.editPointBorder,graphViewEditPointBackground:u.editPointBackground,setEdgeType:function(y,l,Q){Zn[y]=l,nh[y]=Q},getEdgeType:function(h){return Zn[h]},getEdgeTypeMap:function(){return Zn},getNodeRect:Ec},!0);var Ib={"layout.h":s,"layout.v":s,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":s,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:s,ingroup:!0,"body.color":s,"2d.gray":!1,fullscreen:s,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:s,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"vector.layoutable":!1,"clip.direction":"top","clip.percentage":s,"select.color":_l,"select.width":1,"select.padding":2,"select.type":Em,"shadow.interactable":!0,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,shadow2:!1,"shadow2.color":_l,"shadow2.blur":6,"shadow2.offset.x":3,"shadow2.offset.y":3,"border.color":s,"border.width":2,"border.padding":2,"border.type":Em,label:s,"label.font":s,"label.color":Lm,"label.background":s,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":s,"label.max":s,"label.opacity":s,"label.scale":1,"label.align":s,"label.selectable":!0,"label.decoration":s,label2:s,"label2.font":s,"label2.color":Lm,"label2.background":s,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":s,"label2.max":s,"label2.opacity":s,"label2.scale":1,"label2.align":s,"label2.selectable":!0,"label2.decoration":s,note:s,"note.expanded":!0,"note.font":s,"note.color":wn,"note.background":_l,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":s,"note.toggleable":!0,"note.border.width":1,"note.border.color":s,"note.opacity":s,"note.scale":1,"note.align":s,note2:s,"note2.expanded":!0,"note2.font":s,"note2.color":wn,"note2.background":_l,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":s,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":s,"note2.opacity":s,"note2.scale":1,"note2.align":s,"group.type":s,"group.image":s,"group.image.stretch":"fill","group.repeat.image":s,"group.border.repeat.image":s,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":s,"group.title.color":wn,"group.title.background":u.groupTitleBackground,"group.title.align":Vn,"group.title.orientation":$l,"group.background":u.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":s,"group.border.color":hi,"group.border.radius":s,"group.border.cap":rj,"group.border.join":yf,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":g,"group.gradient.color":"#FFF",shape:s,"shape.background":hi,"shape.repeat.image":s,"shape.border.repeat.image":s,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":hi,"shape.border.3d":!1,"shape.border.3d.color":s,"shape.border.3d.accuracy":s,"shape.border.cap":rj,"shape.border.join":yf,"shape.border.pattern":s,"shape.gradient":g,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":dh,"shape.dash.offset":0,"shape.dash.color":Uk,"shape.dash.width":s,"shape.dash.3d":!1,"shape.dash.3d.color":s,"shape.dash.3d.accuracy":s,"shape.polygon.side":6,"shape.arc.from":a,"shape.arc.to":L,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":s,"shape.gradient.pack":s,"shape.border.gradient.pack":s,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":s,"shape.foreground":s,"shape.foreground.gradient":g,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":s,"shape.regular":!0,"autolayout.gap":s,"autolayout.hgap":s,"autolayout.vgap":s,"edge.type":s,"edge.points":s,"edge.segments":s,"edge.color":hi,"edge.width":2,"edge.width.absolute":!1,"edge.repeat.image":null,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":s,"edge.3d.accuracy":s,"edge.cap":rj,"edge.join":yf,"edge.source.position":17,"edge.source.anchor.x":s,"edge.source.anchor.y":s,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":s,"edge.target.anchor.y":s,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":s,"edge.dash":!1,"edge.dash.pattern":dh,"edge.dash.offset":0,"edge.dash.color":Uk,"edge.dash.width":s,"edge.dash.3d":!1,"edge.dash.3d.color":s,"edge.dash.3d.accuracy":s,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":s,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":s,"grid.column.percents":s,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":u.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":u.gridCellBorderColor,"grid.block":s,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":u.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Lm,"text.gradient.pack":s,"text.font":zq,"text.shadow":!1,"text.shadow.color":_l,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,"text.gradient":s,"text.gradient.color":"#FFF","text.decoration":s,"text.vertical":!1,"text.vertical.gap":1,"text.wrap":!1,"text.letter.gap":null,"text.border.color":_l,"text.border.width":0,keepPosition:!0};Ib[bc]=s,oi(x,Ib,!0),oi(_m,{_76I:function(y,c,N){this._39I&&this._39I.fire({data:y,oldIndex:c,newIndex:N})},addIndexChangeListener:function(t,N,f){var w=this;w._39I||(w._39I=new Ri),w._39I.add(t,N,f)},removeIndexChangeListener:function(B,h){this._39I.remove(B,h)},prepareRemove:function(e){hg(e)&&(e.setSource(g),e.setTarget(g)),e._70O&&e._70O.toList().each(this.remove,this),e._69O&&e._69O.toList().each(function(p){p.setHost(g)}),e._host&&e.setHost(g)},onAdded:function(Q){this.isAutoAdjustIndex()&&this.adjustIndex(Q)},onDataPropertyChanged:function(I,M){Mj[M.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(I)},isAdjustable:function(B){return Ob(B)||hg(B)},isAdjustedToBottom:function(Y){return Mn(Y)?Y.isExpanded()&&uj(Y):!1},adjustIndex:function(u){var Y=this;this.isHierarchicalRendering()||(Y.isAdjustedToBottom(u)?(Y.sendToBottom(u),u.eachChild(Y.adjustIndex,Y)):Y.sendToTop(u))},sendToTop:function(n){var J=this;if(J.contains(n)&&J.isAdjustable(n)){var O=J._datas;if(n!==O.get(J.size()-1)){var V=O.indexOf(n);O.removeAt(V),O.add(n),J._76I(n,V,J.size()-1)}if(hg(n)){var h=n._40I;h&&!J.isAdjustedToBottom(h)&&J.sendToTop(h),h=n._41I,h&&!J.isAdjustedToBottom(h)&&J.sendToTop(h)}n._69O&&n._69O.each(function(M){M.isRelatedTo(n)||Ob(n)&&M.isLoopedHostOn(n)||J.sendToTop(M)}),n.ISubGraph||(!Mn(n)||n.isExpanded())&&n._adjustChildrenToTop&&n.eachChild(function(f){hg(f)||J.sendToTop(f)})}},sendToBottom:function(Q,m){var R=this;if(Q!==m&&R.contains(Q)&&R.isAdjustable(Q)&&(!m||R.contains(m))){var P=R._datas,A=P.remove(Q),E=m?R._datas.indexOf(m):0;if(P.add(Q,E),A!==E){R._76I(Q,A,E);var Z=Q._parent;!Z||Z.ISubGraph||hg(Z)||R.sendToBottom(Q._parent,Q)}}}}),oi(xn,{ms_edit:function(m){m._46O=function(N){var E=this,a=E.gv.dm(),G=E._index,y=E._89I,k=E._node,q=E._shape,Y=E._edge,x=E._77I;k&&y?(this.fi({kind:"endEditRect",event:N,data:k,direction:y}),a.endTransaction()):q&&G>=0?(E.fi({kind:"endEditPoint",event:N,data:q,index:G}),a.endTransaction()):Y&&G>=0?(E.fi({kind:"endEditPoint",event:N,data:Y,index:G}),a.endTransaction()):x&&(E.fi({kind:"endEditRotation",event:N,data:x}),a.endTransaction())},m._78I=function(U){var Y=this;Y.autoScroll(U);var S=Y.gv.lp(U),n=Y._index,N=Y._89I,v=Y._node,E=Y._shape,Z=Y._edge,W=Y._77I;if(v&&N)Y._80O(S),Y.fi({kind:"betweenEditRect",event:U,data:v,direction:N});else if(E&&n>=0)S.e=E.getPoints().get(n).e,E.setPoint(n,S),Y.fi({kind:"betweenEditPoint",event:U,data:E,index:n});else if(Z&&n>=0){var b=Z.s(sm);S.e=b.get(n).e,b.set(n,S),Z.fp(sm,g,b),Y.fi({kind:"betweenEditPoint",event:U,data:Z,index:n})}else if(W){var P=W.p(),y=W.getScale(),R=zp+xb(S.y-P.y,S.x-P.x);y.y<0&&(R+=a),B(R)<.04&&(R=0),W.setRotation(R),Y.fi({kind:"betweenEditRotation",event:U,data:W})}},m._80O=function(p){var n=this,e=n._node,r=n._rect,U=r.x,C=r.y,D=r.width,A=r.height,m=n._89I,k=n._anchor,y=n._matrix,p=y.tfi(p);"northwest"===m?r=In(p,{x:U+D,y:C+A}):m===mq?r=In({x:U,y:p.y},{x:U+D,y:C+A}):"northeast"===m?r=In({x:U,y:p.y},{x:p.x,y:C+A}):m===cl?r=In({x:p.x,y:C},{x:U+D,y:C+A}):m===yq?r=In({x:U,y:C},{x:p.x,y:C+A}):"southwest"===m?r=In({x:p.x,y:C},{x:U+D,y:p.y}):"south"===m?r=In({x:U,y:C},{x:U+D,y:p.y}):"southeast"===m&&(r=In({x:U,y:C},p)),e.setPosition(y.tf(r.x+r.width*k.x,r.y+r.height*k.y)),e.setWidth(r.width),e.setHeight(r.height)},m._80I=function(g,p,t,w){var T=this,Q=T.gv._zoom,o=(T.gv.getEditPointSize()+2)/Q;return vb({x:p-o/2,y:t-o/2,width:o,height:o},g)?(T._89I!==w&&(T._89I=w),!0):!1},m._79I=function(K,C,l){var y=this,w=y.gv,x=C?w.getDataUI(C):g,N=x?x._55O:g;if(N){var T,Q,L,U,E=w._zoom,V=(w.getEditPointSize()+2)/E,M=w.lp(K);if(Ob(C)){if(N._56O&&Ob(C)&&(Q=N._98o,vb({x:Q.x-V/2,y:Q.y-V/2,width:V,height:V},M)))return y._77I=C,l&&y.fi({kind:"beginEditRotation",event:K,data:C}),y.setCursor("crosshair"),!0;if(N._43O&&C instanceof Uj)for(L=C.getPoints(),T=L.size()-1;T>=0;T--)if(Q=L.get(T),vb({x:Q.x-V/2,y:Q.y-V/2,width:V,height:V},M))return y._index=T,y._shape=C,l&&y.fi({kind:"beginEditPoint",event:K,data:C,index:T}),y.setCursor("crosshair"),!0;if(N._42O)for(var I=C.getEditControlPoints(),b=["northwest",-1,-1,cl,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,yq,1,0,"northeast",1,-1,mq,0,-1],T=0,U=I.length;U>T;T++){var u=b[3*T],X=I[T];if(y._80I(M,X.x,X.y,u)){y._node=C;var e=C.getWidth(),k=C.getHeight(),d=C.getAnchor();y._rect={x:-e*d.x,y:-k*d.y,width:e,height:k},y._anchor=d,y._matrix=C.getMatrix();var Z=C.getRotation(),G=W(Z),F=_(Z),A=b[3*T+1]*Mr(C.getScale().x),J=b[3*T+2]*Mr(C.getScale().y),i=Math.atan2(-F*A-G*J,G*A-F*J),H=(Math.round(i/(Math.PI/4))+8)%8,Y=[Nk,"nesw-resize",jb,"nwse-resize",Nk,"nesw-resize",jb,"nwse-resize"][H];return y.setCursor(Y),l&&y.fi({kind:"beginEditRect",event:K,data:C,direction:y._89I}),!0}}}if(N._43O&&hg(C)&&C.s(Qj)===tp&&(L=C.s(sm)))for(T=L.size()-1;T>=0;T--)if(Q=L.get(T),vb({x:Q.x-V/2,y:Q.y-V/2,width:V,height:V},M))return y._index=T,y._edge=C,l&&y.fi({kind:"beginEditPoint",event:K,data:C,index:T}),y.setCursor("crosshair"),!0}return!1}},ms_gv:function(Q){Q._currentSubGraph=g,Q._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},Q.upSubGraph=function(){this.setCurrentSubGraph(Ed(this._currentSubGraph))},Q.isVisible=function(B){var R=this;if(Ed(B)!==R._currentSubGraph)return!1;if(hg(B)){var s=B._40I,b=B._41I;if(!s||!b)return!1;if(!(B.s("edge.independent")||R.isVisible(s)&&R.isVisible(b)))return!1;if(B.isEdgeGroupHidden())return!1}else for(var k=B._parent;k&&!k.ISubGraph;){if(Mn(k)&&(!k.isExpanded()||!R.isVisible(k)))return!1;k=k._parent}if(B._parent instanceof vc&&!R.isVisible(B._parent))return!1;if(B._refGraph instanceof ij&&!R.isVisible(B._refGraph))return!1;if(R instanceof Ud){if(!B.s("3d.visible"))return!1}else{var E=R.getLayersInfo();if(E){var X=E[B._layer];if(X&&X.visible===!1)return!1}if(!B.s("2d.visible"))return!1}return R._visibleFunc?R._visibleFunc(B):!0},Q.handleSelectionChange=function(K){var C=this;K.datas.each(function(B){C.invalidateData(B);var a=B._parent;Mn(a)&&Ob(B)&&B.s(qn)&&(C.invalidateData(a),a._49I&&a._49I.each(function(V){C.invalidateData(V)}))}),C.onSelectionChanged(K)},Q.onSelectionChanged=function(r){var b=this,z=b.sm();if(1===z.size()&&("set"===r.kind||"append"===r.kind)){var Q=z.ld();b.isAutoMakeVisible()&&b.makeVisible(Q),b.adjustIndex&&b._dataModel.isAutoAdjustIndex()&&b.adjustIndex(Q)}},Q.makeVisible=function(g){if(g){var l=this,u=l.getDataUI?l.getDataUI(g):l.getData3dUI(g);if(u){var h=g,s=Ed(g);for(s!==l._currentSubGraph&&l.setCurrentSubGraph(s);(h=h._parent)&&h!==s;)Mn(h)&&h.setExpanded(!0);l._23I=g,l.iv()}}},Q.getLabel=function(Q){var Y=Q.getStyle(pp);return Y===s?Q.getName():Y},Q.getLabelBackground=function(A){return A.getStyle("label.background")},Q.getLabelColor=function(U){return U.getStyle("label.color")},Q.getLabel2=function(Q){return Q.getStyle("label2")},Q.getLabel2Background=function(I){return I.getStyle("label2.background")},Q.getLabel2Color=function(s){return s.getStyle("label2.color")},Q.getNote=function(c){return c.getStyle(zg)},Q.getNoteBackground=function(H){return H.getStyle("note.background")},Q.getNote2=function(v){return v.getStyle(Zb)},Q.getNote2Background=function($){return $.getStyle("note2.background")},Q.handleClick=function(V,k,K){var e=this;k?(e.fi({kind:"clickData",event:V,data:k,part:K}),e.onDataClicked(k,V)):(e.fi({kind:"clickBackground",event:V}),e.onBackgroundClicked(V))},Q.handleDoubleClick=function(L,A,P){var J=this;ys(L)&&(A?(J.fi({kind:"doubleClickData",event:L,data:A,part:P}),J.onDataDoubleClicked(A,L,P),J.checkDoubleClickOnNote(L,A,P)||J.checkDoubleClickOnRotation&&J.checkDoubleClickOnRotation(L,A,P)||(hg(A)?J.onEdgeDoubleClicked(A,L,P):A.ISubGraph?J.onSubGraphDoubleClicked(A,L,P):Mn(A)?J.onGroupDoubleClicked(A,L,P):A.IDoorWindow?J.onDoorWindowDoubleClicked(A,L,P):A.ICSGBox&&J.onCSGBoxDoubleClicked(A,L,P))):(J.fi({kind:"doubleClickBackground",event:L}),J.onBackgroundDoubleClicked(L)))},Q.onSubGraphDoubleClicked=function(Y){this.setCurrentSubGraph(Y)},Q.onEdgeDoubleClicked=function(g,A){this.isEditable(g)||(g.ISubGraph&&!wc(A)?this.setCurrentSubGraph(g):g.s("edge.toggleable")&&g.toggle())},Q._39Q=function(z){return this.isInteractive(z)?this.preventDefaultWhenInteractive(z):!1},Q.preventDefaultWhenInteractive=function(c){return c.s("preventDefaultWhenInteractive")},Q.onGroupDoubleClicked=function(T){T.s("group.toggleable")&&T.toggle()
},Q.onDoorWindowDoubleClicked=function(k){k.s("dw.toggleable")&&k.toggle(!0)},Q.onCSGBoxDoubleClicked=function(s,L){var W=this;if(W instanceof Ud){var B=W.intersectObject(L,s);B&&s.s(B.part+".toggleable")&&s.toggleFace(B.part,!0)}},Q.onBackgroundClicked=function(){},Q.onBackgroundDoubleClicked=function(){this.upSubGraph()},Q.onDataClicked=function(){},Q.onDataDoubleClicked=function(){},Q.onAutoLayoutEnded=function(){},Q.onMoveEnded=function(){},Q.onPanEnded=function(){},Q.onPinchEnded=function(){},Q.onRectSelectEnded=function(){},Q.onZoomEnded=function(){},Q.serialize=function(b){return this.dm().serialize(b)},Q.toJSON=function(){return this.dm().toJSON()},Q.deserialize=function(q,n){var V=this;n=n instanceof Zc?{rootParent:n}:Tg(n)?{setId:n}:qr(n)?{finishFunc:n}:n||{},n.view=V;var N=V.dm();return n.reset&&(N.setAttrObject({}),N.setLayers(s),N.setName(s),N.setAutoAdjustIndex(!0),N.setHierarchicalRendering(!1),N.setBackground(s),N.setInit(s),N.setPostProcessingData(s),N.setEnvmap(s),N.setEnvmapType(s),V.disableToolTip(),V instanceof U.graph.GraphView?(V.setZoomable(p.graphViewZoomable),V.setPannable(p.graphViewPannable),V.setRectSelectable(p.graphViewRectSelectable)):V instanceof U.graph3d.Graph3dView&&(V.shadowMap.resetProperties(),V.setDashDisabled(p.graph3dViewDashDisabled),V.getHighlightHelper().resetProperties(),V.resetHeadlightProperties(),V.resetFogProperties(),V.setBatchInfoMap({}),V.setBatchColorDisabled(p.graph3dViewBatchColorDisabled),V.setBatchBlendDisabled(p.graph3dViewBatchBlendDisabled),V.setBatchBrightnessDisabled(p.graph3dViewBatchBrightnessDisabled),V.setMoveStep(p.graph3dViewMoveStep),V.setRotateStep(p.graph3dViewRotateStep),V.setSortable(p.graph3dViewSortable),V.setSortFunc(s),V.setSkybox(s),Nn(V))),n.__innerHandler__=function(n){if(Tg(N.a("toolTipEnable"))&&(N.a("toolTipEnable")?V.enableToolTip():V.disableToolTip()),V instanceof U.graph.GraphView&&(Tg(N.a("zoomable"))&&V.setZoomable&&V.setZoomable(N.a("zoomable")),Tg(N.a("pannable"))&&V.setPannable&&V.setPannable(N.a("pannable")),Tg(N.a("rectSelectable"))&&V.setRectSelectable&&V.setRectSelectable(N.a("rectSelectable")),N.a("fitContent")===!0&&V.fitContent&&V.fitContent(!0,0)),V instanceof U.graph3d.Graph3dView){var $=n.scene;$&&$.shadow!=g&&V.shadowMap.setShadow($.shadow,$.shadowParams);var A=N.a("sceneContext");A?(A.eye&&V.setEye(A.eye),A.center&&V.setCenter(A.center),Jr(A.far)&&V.setFar(A.far),Jr(A.near)&&V.setNear(A.near)):(Jr(N.a("sceneNear"))&&V.setNear(N.a("sceneNear")),Jr(N.a("sceneFar"))&&V.setFar(N.a("sceneFar")),$&&($.eye&&V.setEye($.eye),$.center&&V.setCenter($.center))),Tg(N.a("sceneShadowEnabled"))&&(N.a("sceneShadowEnabled")?V.enableShadow():V.disableShadow()),Jr(N.a("sceneShadowDegreeX"))&&V.setShadowDegreeX(N.a("sceneShadowDegreeX")),Jr(N.a("sceneShadowDegreeZ"))&&V.setShadowDegreeZ(N.a("sceneShadowDegreeZ")),Jr(N.a("sceneShadowIntensity"))&&V.setShadowIntensity(N.a("sceneShadowIntensity")),N.a("sceneShadowQuality")!=g&&V.setShadowQuality(N.a("sceneShadowQuality")),N.a("sceneShadowType")&&V.setShadowType(N.a("sceneShadowType")),Jr(N.a("sceneShadowRadius"))&&V.setShadowRadius(N.a("sceneShadowRadius")),Jr(N.a("sceneShadowBias"))&&V.setShadowBias(N.a("sceneShadowBias")),Tg(N.a("sceneDashEnable"))&&V.setDashDisabled(!N.a("sceneDashEnable")),Xj(N.a("sceneHighlightMode"))&&V.setHighlightMode(N.a("sceneHighlightMode")),Jr(N.a("sceneHighlightWidth"))&&V.setHighlightWidth(N.a("sceneHighlightWidth")),N.a("sceneHighlightColor")&&V.setHighlightColor(N.a("sceneHighlightColor")),N.a("sceneHighlightType")&&V.setHighlightType(N.a("sceneHighlightType")),N.a("sceneHighlightGlow")&&V.setHighlightGlow(N.a("sceneHighlightGlow")),N.a("sceneHighlightStrength")&&V.setHighlightStrength(N.a("sceneHighlightStrength")),Tg(N.a("sceneHeadlightEnable"))&&V.setHeadlightDisabled(!N.a("sceneHeadlightEnable")),Jr(N.a("sceneHeadlightRange"))&&V.setHeadlightRange(N.a("sceneHeadlightRange")),N.a("sceneHeadlightColor")&&V.setHeadlightColor(N.a("sceneHeadlightColor")),Jr(N.a("sceneHeadlightIntensity"))&&V.setHeadlightIntensity(N.a("sceneHeadlightIntensity")),Jr(N.a("sceneHeadlightAmbientIntensity"))&&V.setHeadlightAmbientIntensity(N.a("sceneHeadlightAmbientIntensity")),Jr(N.a("sceneHeadlightGroup"))&&V.setHeadlightGroup(N.a("sceneHeadlightGroup")),Tg(N.a("sceneFogEnable"))&&V.setFogDisabled(!N.a("sceneFogEnable")),N.a("sceneFogMode")&&V.setFogMode(N.a("sceneFogMode")),Jr(N.a("sceneFogDensity"))&&V.setFogDensity(N.a("sceneFogDensity")),N.a("sceneFogColor")&&V.setFogColor(N.a("sceneFogColor")),Jr(N.a("sceneFogNear"))&&V.setFogNear(N.a("sceneFogNear")),Jr(N.a("sceneFogFar"))&&V.setFogFar(N.a("sceneFogFar")),Tg(N.a("sceneBatchBrightnessDisabled"))&&V.setBatchBrightnessDisabled(N.a("sceneBatchBrightnessDisabled")),Tg(N.a("sceneBatchBlendDisabled"))&&V.setBatchBlendDisabled(N.a("sceneBatchBlendDisabled")),Tg(N.a("sceneBatchColorDisabled"))&&V.setBatchColorDisabled(N.a("sceneBatchColorDisabled")),N.a("sceneBatchInfoMap")&&V.setBatchInfoMap(N.a("sceneBatchInfoMap")),Jr(N.a("sceneMoveStep"))&&V.setMoveStep(N.a("sceneMoveStep")),Jr(N.a("sceneRotateStep"))&&V.setRotateStep(N.a("sceneRotateStep")),Tg(N.a("sceneSortable"))&&V.setSortable(N.a("sceneSortable")),qr(N.a("sceneSortFunc"))&&V.setSortFunc(N.a("sceneSortFunc"));var d=N.a("sceneSkyboxType")||"sphere";if(d!=g){var T={},H=!1;if("sphere"===d){T.shape3d=d;var X=N.a("sceneSkyboxImage");X&&(T["shape3d.image"]=X,H=!0)}else T.shape3d=s,["front","back","left","right","top","bottom"].forEach(function(x){var K=x+".image",I=x.charAt(0).toUpperCase()+x.slice(1),D=N.a("sceneSkybox"+I+"Image");D&&(T[K]=D,H=!0)});if(H){var E=new rk,q=N.a("sceneSkyboxDiameter");Jr(q)?E.s3(q,q,q):E.s3(20,20,20),T["body.color"]=N.a("sceneSkyboxBodyColor"),T.envmap=N.a("sceneSkyboxEnvmap"),T["envmap.probe"]=N.a("sceneSkyboxEnvmapProbe"),T.roughness=N.a("sceneSkyboxRoughness"),T["shape3d.light"]=T["all.light"]=N.a("sceneSkyboxLight"),T["light.mask"]=N.a("sceneSkyboxLightMask"),T["headlight.ambientIntensity"]=N.a("sceneSkyboxHeadLightAmbientIntensity"),T["texture.wrap"]="clampToEdge",T["3d.clipbox.mask"]=pk,T["effect.flow.mask"]=pk,E.s(T),["X","Y","Z"].forEach(function(s){var i=N.a("sceneSkyboxRotation"+s);Jr(i)&&E["setRotation"+s](i)}),V.setSkybox(E)}}}},N.deserialize(q,n.rootParent,n)},Q.isDebugTipShowing=function(){return!!this._debugDiv},Q.showDebugTip=function(){var I=this,n=I._debugDiv;if(!n){n=I._debugDiv=o.createElement("div"),n.style.position="absolute",n.style.overflow="hidden",n.style.font=p.debugTipLabelFont,n.style.padding="6px",n.style.backgroundColor=p.debugTipBackground,n.style.color=p.debugTipLabelColor;var V=I.getView();I._79O?V.insertBefore(n,I._79O):V.appendChild(n);var B=function(){I.redraw();var g=I._canvas,W="FPS: "+I._fpsInfo.fps+"<br/>"+"Datas: "+I.dm().getDatas().length+(g?"<br/>Size: "+g.width+" * "+g.height:""),v=I.dm()._historyManager;v&&(W+="<br/>Undoes: "+v.getHistories().length+" index: "+v.getHistoryIndex());var X=I.getDebugTip();X&&(W+="<hr>"+X),n.innerHTML=W,I._isDebugging&&requestAnimationFrame(B)};requestAnimationFrame(B),I._isDebugging=!0}},Q.hideDebugTip=function(){var t=this,z=t._debugDiv;z&&(delete t._debugDiv,t.getView().removeChild(z),t._isDebugging=!1)},Q.updateDOMAppendMatrix=function(){var P=this.getView();P&&(P.updateAppendMatrix=!0)},Q.countFrame=function(){if(this._isDebugging){var U=Date.now(),G=this._fpsInfo;U-G.time>1e3?(G.fps=Math.round(1e5*(G.frames+1)/(U-G.time))/100,G.time=U,G.frames=0):G.frames++}}},ms_icons:function(d){d.getRotation=function(l){return l==g?0:l},d._15O=function(){var h=this,y=h.s(mc);if(y){var O=h,_=h.data||h._data,D=h._38o={icons:y,rects:{}};for(var G in y){var l=y[G],J=gs(l.shape3d,_,O);if(!(gs(l.visible,_,O)===!1||gs(l.for3d,_,O)&&!h.I3d||J&&!h.I3d)){var k=J?[J]:gs(l.names,_,O),I=k?k.length:0,A=gs(l.position,_,O)||3,u=gs(l.offsetX,_,O)||0,R=gs(l.offsetY,_,O)||0,U=gs(l.direction,_,O)||yq,j=gs(l.gap,_,O),W=j!=g?j:1,c=gs(l.rotation,_,O),v=gs(l.keepOrien,_,O),m=gs(l.rotationFixed,_,O)?c:h.getRotation(c,v,A),Q=g,x=D.rects[G]=new Array(I);x.rotation=m;for(var r=0;I>r;r++){var i,B,N,e,K=k[r];if(J)N=0,e=0;else{var s=dg(K);N=gs(l.width,_,O),e=gs(l.height,_,O),N==g&&(N=Oo(s,_)),e==g&&(e=Gl(s,_))}if(Q?U===yq?u+=N/2:U===cl?u-=N/2:U===mq?R-=e/2:R+=e/2:Q={width:N,height:e},h.I3d){var $=-N/2,F=-e/2;B={width:N,height:e,mat:h._16O(gs(l.autorotate,_,O),A,Q,gs(l.face,_,O)||Mh,gs(l.t3,_,O),gs(l.r3,_,O),gs(l.rotationMode,_,O),u,R),vs:new Yp([$,-F,0,$,-F-e,0,$+N,-F-e,0,$+N,-F,0])}}else i=h.getPosition(A,u,R,Q,gs(l.positionFixed,_,O)),B={x:i.x-N/2,y:i.y-e/2,width:N,height:e},h._68o(B,m);x[r]=B,U===yq?u+=N/2+W:U===cl?u-=N/2+W:U===mq?R-=e/2+W:R+=e/2+W}}}}}}});var Bc={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},yb={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},th={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Mj={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Jk={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},we={"edge.type":1,"edge.group":1},Kb={rotation:1,rotationX:1,rotationZ:1,rotation3d:1},Lc={rotation:1,position:1,width:1,height:1,anchor:1,scale:1,host:1},fq={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},pb={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},oo={shape:1,thickness:1,position:1,anchor:1,scale:1},Ed=function(E){if(!E)return g;if(hg(E)){var J=E._40I,_=E._41I;if(!J||!_)return g;var C=Ed(J),b=Ed(_);return C===b?C:g}for(var w=E._parent;hg(w)&&!w.ISubGraph;)w=w._parent;return w?w.ISubGraph?w:Ed(w):g},ek=function(M,r,t,A){var L=r.getStyle(t)*A;L&&ff(M,L),L=r.getStyle(t+".left")*A,L&&(M.x-=L,M.width+=L),L=r.getStyle(t+".right")*A,L&&(M.width+=L),L=r.getStyle(t+".top")*A,L&&(M.y-=L,M.height+=L),L=r.getStyle(t+".bottom")*A,L&&(M.height+=L),M.width<0&&(M.width=-M.width,M.x-=M.width),M.height<0&&(M.height=-M.height,M.y-=M.height)},uj=function(L){for(var g,z=0,W=L.size();W>z;z++)if(g=L.getChildAt(z),Ob(g)&&uj(g))return!0;return L.hasAgentEdges()},fs=function(M){if(!M)return g;for(var _=M._parent;Mn(_);){if(!Mn(_._parent))return _.isExpanded()?M:_;_.isExpanded()||(M=_),_=_._parent}return M},kj=function(E,F){if(!E||!F)return g;var i,W,_,p=Ed(E),h=Ed(F);if(p!==h){for(;h&&p!==h;)h=Ed(h);if(p===h)return E;i=new Yn,i.add(E,0);for(var z=E._parent;Ob(z)&&!F.isDescendantOf(z);)i.add(z,0),z=z._parent;for(_=i.size(),W=0;_>W;W++){var V=i.get(W);if(Mn(V)&&!V.isExpanded())return V;if(V.ISubGraph)return V}return E}return E},Wf=function(f){if(f.isLooped())return f._source;var q=fs(f._source),B=fs(f._target);return q===B?f._source:kj(q,B)},Eh=function(L){if(L.isLooped())return L._target;var c=fs(L._source),F=fs(L._target);return c===F?L._target:kj(F,c)},Jc=function(c,t,P){"target"!==P&&(P="source");var h="target"===P?t.getTargetAgent():t.getSourceAgent(),R="edge."+P+".";if(hg(h)){var q=c.getDataUI(h);q._79o();var S=t.s(R+"index");if(S>=0){var A=tg(q);return A[Math.max(0,Math.min(S,A.length-1))]}var Z=t.s(R+"percent")||0;Z=Math.max(0,Math.min(Z,1));var r=_q(q);return Rq(r,100*Z)}return zb(c,h,t.s(R+"position"),t.s(R+"offset.x"),t.s(R+"offset.y"),t.s(R+"anchor.x"),t.s(R+"anchor.y"))},zb=function(O,o,J,r,f,Q,K){if(!o)return g;var A,X=o.getRotation?o.getRotation():0;if(Q!==s||K!==s){Q=Q===s?.5:Q,K=K===s?.5:K;var Z=o.getScale();if(X&&!ve(o,O)||Z.x<0||Z.y<0){var u=o.getPosition(),G=o.getWidth(),w=o.getHeight(),x=o.getAnchor(),n=new Tc(X,u.x,u.y,Z.x,Z.y);J=n.tf((Q-x.x)*G,(K-x.y)*w)}else A=Ec(O,o),J={x:A.x+Q*A.width,y:A.y+K*A.height}}else J=xm(J,Ec(O,o));if(X){var T=W(X),U=_(X),M=r*T-f*U;f=r*U+f*T,r=M}return J.x+=r,J.y+=f,J},Or=function(F,y){if(!F||!y)return g;var s,q,_,c,K,S;if(F===y){if(c=F.getLoopedEdges(),!c)return g;c=new Yn(c)}else{if(K=F.getAgentEdges(),S=y.getAgentEdges(),!K||!S)return g;for(q=K.size(),s=0;q>s;s++)_=K.get(s),S.contains(_)&&(c||(c=new Yn),c.add(_))}if(c)for(s=0;s<c.size();s++)_=c.get(s),_.getStyle(Qj)===tp&&(_._22I(g),c.removeAt(s),s--);return c},Fi=function(C,$){var L=Or(C,$);if(L&&!L.isEmpty()){if(1===L.size())return L.get(0)._22I(g),void 0;var y=new Yn,G=new Yn;L.each(function(l){var J=l.s("edge.group");y.contains(J)||y.add(J)}),y.sort(),y.each(function(W){G.add(new U.EdgeGroup(L.toList(function(o){return W===o.s("edge.group")}),G))}),G.each(function(A){A.each(function(y){y._22I(A)})})}},Qf=function(U,W,R){var f=U._canvas;U._zoom;var v=dc(W,f),t=dc(R,f);return{x:v.x-t.x,y:v.y-t.y}},Ue=function(M,i){if(i){var t=i.rect,Y=i.color,_=i.rotation,d=i.labelWidth,N=i.background,P=i.opacity,U=i.scale,O=U!=g&&1!==U;if(P!=g){var f=M.globalAlpha;M.globalAlpha*=P}if(_||O){M.save();var u=t.x+t.width/2,k=t.y+t.height/2;bs(M,u,k),_&&no(M,_),O&&M.scale(U,U),bs(M,-u,-k)}if(N&&lc(M,t.x,t.y,t.width,t.height,N),d){var Q=t.width,C=M.createLinearGradient(t.x,t.y,t.x+Q,t.y);C.addColorStop(0,Y),C.addColorStop(.9,Y),C.addColorStop(1,ye),Y=C,t.width=d}qo(M,i.ss,t,i.font,Y,i.align,i.decoration),d&&(t.width=Q),(_||O)&&M.restore(),P!=g&&(M.globalAlpha=f)}},ge=function(k,P){if(P){var b=P.rect,c=b.x,q=b.y,s=b.width,o=b.height,i=P.background,U=P.backgroundImage,m=P.borderWidth,T=P.borderColor,l=P.labelWidth,$=P.opacity,Z=P.scale,t=Z!=g&&1!==Z;if($!=g){var C=k.globalAlpha;k.globalAlpha*=$}if(t){k.save();var p=b.x+b.width/2,h=b.y+b.height/2;bs(k,p,h),k.scale(Z,Z),bs(k,-p,-h)}if(P.expanded){var r=Q(8,s/4),G=q+o-8;if(k.fillStyle=i,k.beginPath(),k.moveTo(c,q),k.lineTo(c,G),k.lineTo(c+s/2,G),k.lineTo(c+s/2,q+o),k.lineTo(c+s/2+r,G),k.lineTo(c+s,G),k.lineTo(c+s,q),k.closePath(),k.fill(),m&&(k.lineWidth=m,k.lineJoin="round",k.lineCap="round",T?(k.strokeStyle=T,k.stroke()):(k.strokeStyle=Ao(i),k.beginPath(),k.moveTo(c+s,q),k.lineTo(c+s,G),k.lineTo(c+s/2+r,G),k.lineTo(c+s/2,q+o),k.stroke(),k.strokeStyle=Xg(i),k.beginPath(),k.moveTo(c+s,q),k.lineTo(c,q),k.lineTo(c,G),k.lineTo(c+s/2,G),k.lineTo(c+s/2,q+o),k.stroke())),U)id(k,dg(U),pq,b.x,b.y,b.width,b.height-8,P.data,P.view);else{if(b.height-=8,i=P.color,l){var E=s,z=k.createLinearGradient(c,q,c+E,q);z.addColorStop(0,i),z.addColorStop(.9,i),z.addColorStop(1,ye),i=z,b.width=l}qo(k,P.ss,b,P.font,i,P.align),l&&(b.width=E),b.height+=8}}else if(P.icon)jj(k,dg(P.icon),c,q,s,o,P.data,P.view);else{var N=s/2;m&&(k.lineWidth=m,k.lineJoin="round",k.lineCap="round",k.strokeStyle=T?T:Ao(i),k.beginPath(),k.arc(c+N,q+N,N,zp,1.6*a,!0),k.moveTo(c+N,q+o),k.lineTo(c+s-N/5,q+N),k.stroke(),k.strokeStyle=T?T:Xg(i),k.beginPath(),k.arc(c+N,q+N,N,1.6*a,zp,!0),k.moveTo(c+N,q+o),k.lineTo(c+N/5,q+N),k.stroke()),k.fillStyle=i,k.beginPath(),k.arc(c+N,q+N,N,0,L,!0),k.moveTo(c+N,q+o),k.lineTo(c+s-N/5,q+N),k.lineTo(c+N/5,q+N),k.closePath(),k.fill(),k.fillStyle=P.color,k.beginPath(),k.arc(c+N,q+N,N/3,0,L,!0),k.fill()}t&&k.restore(),$!=g&&(k.globalAlpha=C)}},_e=function(Z,S){return S>2*Z?Z:S/2},$p=function(L,G,N,z){if(!L||!G)return 0;var A=xb(G.y-L.y,G.x-L.x);return N||(A=G.x<L.x?A+a:A),A+z},Gd=function(x,K,k,B,F,$,J){J&&(x.x>K.x||x.x===K.x&&x.y>K.y)&&(k=ie[k],F=-F);var g=xm(k,{x:0,y:0,width:lr(x,K),height:0},$);return g.x+=B,g.y+=F,g=new Tc(xb(K.y-x.y,K.x-x.x)).tf(g),g.x+=x.x,g.y+=x.y,g},Cb=function(D,t,u,P,U){if(D._19Q=!0,!u.getEdgeGroup())return P?u.s("edge.gap"):0;if(hg(u.getSourceAgent())||hg(u.getTargetAgent()))return 0;var S,N=0,J=0,F=0;if(u.getEdgeGroup().getSiblings().each(function(z){z.each(function(f){if(t.isVisible(f)&&f.s(Qj)==U){var r=f.s("edge.gap");S?(J+=F/2+r/2,F=r):(S=f,F=r),f===u&&(N=J)}})}),P)return J-N+F;var a=N-J/2;return S&&u._40I!==S._40I&&(D._19Q=!1),a},Gj=function(K){var s=K._getValidSelection();if(1===s.length){var x=s[0],J=x instanceof U.Edge;if(x instanceof U.Shape||J){if(J){var i=x.s("edge.type");if(i&&"points"!==i)return}var n=K.gv;if((!n.isPointEditable||n.isPointEditable(x))&&n.isEditable(x))return x}}},Al=function(){var n=function(f){var O=[];return f.forEach(function(x){O.push({x:x.x,y:x.y}),O.push({x:x.x+x.width,y:x.y+x.height}),O.push({x:x.x+x.width,y:x.y}),O.push({x:x.x,y:x.y+x.height})}),O};return function(u,C,r){if("oval"===u){var M=0,l=r.height/r.width,O=l*l,x=r.x+r.width/2,f=r.y+r.height/2,Z=n(C);Z.forEach(function(a){var q=a.x-x,r=a.y-f,K=q*q+r*r/O;K>M&&(M=K)}),M=w(M);var W=l*M;return{x:x-M,y:f-W,width:2*M,height:2*W}}if("circle"===u){var t=0,x=r.x+r.width/2,f=r.y+r.height/2,Z=n(C);return Z.forEach(function(U){var L=U.x-x,s=U.y-f,Y=L*L+s*s;Y>t&&(t=Y)}),t=w(t),{x:x-t,y:f-t,width:2*t,height:2*t}}return"roundRect"===u?(ff(r,Q(r.width,r.height)/16),r):r}}(),lm=U.graph={},hj=function(N,O,b){zs(e+".graph."+N,O,b)};U.layout={};var ce={},js=function($,z,J,P,g,f,A,w){var Q=A._zoom;if(Q!==A._cacheZoom&&(A._cacheZoom=Q,A._cacheImage={}),Q*=Kn,P=Math.ceil(P),g=Math.ceil(g),P*Q>2048||g*Q>2048)return z;var x=[z.uuid,P,g,J].join("_");if(z.cacheRule){var X;X=qr(z.cacheRule)?z.cacheRule(f,A):gs(z.cacheRule,f,A),x+="_"+X}var F,h=1;g>=P&&h>P*Q?(F=g/P,P=h/Q,g=P*F):P>=g&&h>g*Q&&(F=P/g,g=h/Q,P=g*F),P=Math.ceil(P),g=Math.ceil(g);var T=A._cacheImage[x];if(!T){if(he(),T=U.Default.toCanvas(z,P,g,J,f,A,w,Q),!Xo())return z;A._cacheImage[x]=T}return T};oi(p,{setImageCacheRule:function(s,S){var a;S||"object"!=typeof s?(a={},a[s]=S):a=s;for(var C in a){var c=a[C];Xj(C)?(zs=dg(C),zs?zs.cacheRule=c:ce[C]=c):C.cacheRule=c}}});var Qr={comps:[{type:pc,points:[85,50,70,115,100,71,86,107,88,49,43,69,98,65,69,65,112,54,116,107,98,111,73,112,120,52,49,51,73,48,67,53,98,51,110,75,106,69,114,87,81,67,119,61],borderWidth:1,borderColor:g}]};if(Qr[Ap]=Qr[Xk]=160,q.Image){var im=new q.Image;im.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",gk("default_blank",im)}gk("node_image",pm(30,30,[{type:Em,rect:[4,5,22,16],gradient:zh,gradientColor:go,background:hi},{type:Em,rect:[2,3,26,20],borderWidth:1,borderColor:hi},{type:Em,rect:[11,23,8,4],background:hi},{type:Em,rect:[6,27,18,2],background:hi}])),gk("node_icon",pm(16,16,[{type:Em,rect:[2,2,12,10],gradient:zh,gradientColor:go,background:hi},{type:sp,rect:[2,2,12,10],width:1,color:hi},{type:Em,rect:[6,12,4,2],background:hi},{type:Em,rect:[4,14,8,1],background:hi}])),gk("block_icon",pm(16,16,[{type:sp,rect:[1,1,14,14],width:1,color:hi}])),gk("group_image",pm(66,39,[{type:Em,rect:[44.3,18,18.1,12.8],gradient:zh,gradientColor:go,background:hi},{type:Em,rect:[3.3,17.8,18.1,12.8],gradient:zh,gradientColor:go,background:hi},{type:Em,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:hi,gradient:zh,gradientColor:go,background:hi},{type:Em,rect:[26.2,29.4,12.8,4.2],background:hi},{type:Em,rect:[21.3,33.5,22.5,2.3],background:hi},{type:Em,rect:[5.3,32.7,14.1,2.1],background:hi},{type:Em,rect:[9,30.4,6.7,2.4],background:hi},{type:Em,rect:[50,30.7,6.7,2.4],background:hi},{type:Em,rect:[46.3,33,14.1,2.1],background:hi}])),gk("group_icon",pm(16,16,[{type:Em,rect:[4,12,4,2],background:hi},{type:Em,rect:[2,13,8,1],background:hi},{type:Em,rect:[12,12,2,1],background:hi},{type:Em,rect:[11,13,4,1],background:hi},{type:Em,rect:[10,7,6,5],gradient:zh,gradientColor:go,background:hi},{type:Em,rect:[1,2,10,10],gradient:zh,gradientColor:go,background:hi},{type:sp,rect:[1,2,10,10],width:1,color:hi}])),gk("refGraph_icon",pm(16,16,[{type:"shape",borderWidth:1,borderColor:hi,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:hi,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),gk("edge_icon",pm(16,16,[{type:Em,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:zh,gradientColor:go,background:hi},{type:Em,rect:[10.8,1,4,4],background:hi},{type:Em,rect:[1,11,4,4],background:hi}])),gk("subGraph_image",pm(72,45,[{type:pc,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:zh,gradientColor:go,background:hi},{type:Em,rect:[29.6,30.7,3.6,1.8],background:hi},{type:Em,rect:[28.4,32.3,6,1.2],background:hi},{type:Em,rect:[37.3,32,10.8,1.8],background:hi},{type:Em,rect:[39.1,29.9,7.2,2.3],background:hi},{type:Em,rect:[26.6,23.7,9.6,7.2],gradient:zh,gradientColor:go,background:hi},{type:Em,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:hi,gradient:zh,gradientColor:go,background:hi}])),gk("subGraph_icon",pm(17,17,[{type:pc,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:zh,gradientColor:go,background:hi}])),gk("shape_icon",pm(16,16,[{type:pc,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:hi}])),gk("polyline_icon",pm(16,16,[{type:pc,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:hi},Fl(7.5,.4),Fl(7.5,6.3),Fl(13.6,6.3),Fl(13.6,14),Fl(.7,13.9),Fl(.7,.3)])),gk("grid_icon",pm(16,16,[{type:Em,rect:[1,1,4,4],background:hi,gradient:zh,gradientColor:go},{type:Em,rect:[6,1,4,4],background:hi,gradient:zh,gradientColor:go},{type:Em,rect:[11,1,4,4],background:hi,gradient:zh,gradientColor:go},{type:Em,rect:[11,6,4,4],background:hi,gradient:zh,gradientColor:go},{type:Em,rect:[6,6,4,4],background:hi,gradient:zh,gradientColor:go},{type:Em,rect:[1,6,4,4],background:hi,gradient:zh,gradientColor:go},{type:Em,rect:[11,11,4,4],background:hi,gradient:zh,gradientColor:go},{type:Em,rect:[6,11,4,4],background:hi,gradient:zh,gradientColor:go},{type:Em,rect:[1,11,4,4],background:hi,gradient:zh,gradientColor:go}])),gk("light_icon",pm(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:hi},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:hi,gradient:zh,gradientColor:go,background:{func:function(b){var f=b?b.s($o):g;return Vd(f)?"rgb("+vs(255*f[0])+","+vs(255*f[1])+","+vs(255*f[2])+")":f||hi}}}])),gk("text_icon",pm(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:hi}])),gk("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),gk("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),gk("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),gk("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Lb=function(k,u,M,g,o,B){var W,q,J,I,U,N,_,b,z,Z,D,x=[];if(Math.abs(g)>2*Math.PI&&(g=2*Math.PI),U=Math.ceil(Math.abs(g)/(Math.PI/4)),W=g/U,q=-W,J=-M,U>0){N=k+Math.cos(M)*o,_=u+Math.sin(-M)*B,x.push({x:N,y:_});for(var l=0;U>l;l++)J+=q,I=J-q/2,b=k+Math.cos(J)*o,z=u+Math.sin(J)*B,Z=k+Math.cos(I)*(o/Math.cos(q/2)),D=u+Math.sin(I)*(B/Math.cos(q/2)),x.push({x:Z,y:D}),x.push({x:b,y:z})}return x},Ae=function(x){if(x){var u=x._data;if(u instanceof U.Shape)return{points:u.getPoints(),segments:u.getSegments()};var k;if(u instanceof U.Edge&&(k=x._78o)){var W,A,F=k.type,G=k.points,P=k.segments,X=k.edgeTypeInfo;if(!F||G){var p=k.sourcePoint,v=p.x,z=p.y,f=k.targetPoint,r=f.x,L=f.y;if(F)P?(W=new Yn({x:v,y:z}),W.addAll(G),W.add({x:r,y:L}),A=new Yn(P._as)):(W=new Yn({x:v,y:z}),G.each(function(G){W.add(G)}),W.add({x:r,y:L}));else if(k.looped){W=new Yn(Lb(v,z,0,2*Math.PI,k.radius,k.radius)),A=new Yn([1]);for(var m=0;m<(W.size()-1)/2;m++)A.add(3)}else W=new Yn,k.center?(W.add({x:k.c1.x,y:k.c1.y}),W.add({x:v,y:z}),W.add({x:r,y:L}),W.add({x:k.c2.x,y:k.c2.y})):(W.add({x:v,y:z}),W.add({x:r,y:L}))}else X&&(W=new Yn(X.points._as),X.segments&&(A=new Yn(X.segments._as)));return{points:W,segments:A}}}},_q=function(u,d,p){if(null==d){var k=Ae(u);if(!k)return;d=k.points,p=k.segments}if(d){if(Array.isArray(d)&&(d=new Yn(d)),"number"==typeof d.get(0)){for(var t=new U.List,B=0;B<d.size();B+=2)t.add({x:d.get(B),y:d.get(B+1)});d=t}if(!p){p=[1];for(var X=d.length-1;X>0;X--)p.push(2)}Array.isArray(p)&&(p=new Yn(p));for(var m=Ok(d._as,p._as,50),e=m.length,h=[],B=0;e>B;B++){var $=m[B];$.length>1&&h.push($)}return h}},ag=function(W){for(var z=0,w=W.length-1,i=0;w>i;i++){var X=W[i],j=W[i+1],P=j.x-X.x,R=j.y-X.y;z+=Math.sqrt(P*P+R*R)}return z},Qe=function(u,z){for(var i=0,R=z.length,N=0;R>N;N++){var D=z[N];if(i+=D,i>u)return N}return Math.min(N,R-1)},ab=function(v,X){for(var P=0,A=0,M=0,I=v.length-1,j=0;I>j;j++){var x=v[j],H=v[j+1],z=H.x-x.x,e=H.y-x.y;if(M=Math.sqrt(z*z+e*e),P+=M,P>X){P-=M,A=j;break}}var u=v[A],n=v[A+1],N=Math.atan2(n.y-u.y,n.x-u.x),W=X-P,e=Math.sin(N)*W,z=Math.cos(N)*W;return{x:u.x+z,y:u.y+e}},Rq=function(b,Z){if(b){var g;if(0===Z)g=b[0][0];else if(100===Z)b=b[b.length-1],g=b[b.length-1];else{for(var L=0,c=[],l=b.length,h=0;l>h;h++){var m=b[h],S=ag(m);L+=S,c.push(S)}for(var r=L*Z/100,H=Qe(r,c),d=0,p=0;H>p;p++)d+=c[p];r-=d,g=ab(b[H],r)}return g}},tg=function(D){var I,V;if(D instanceof Cq){var K=Ae(D);I=K.points,V=K.segments}else I=arguments[0],V=arguments[1];var g,Y,s,d,b=[],F=-1;for(Y=0,s=V?V.length:I.length;s>Y;Y++){if(g=V?V.get(Y):1,3===g)d=2;else if(4===g)d=3;else{if(5===g)continue;d=1}F+=d,b.push(I.get(F))}return b},pe=function(I,D,f,s){function V(v){if(v>=0&&1>=v){h=D(v);var f=(I.x-h.x)*(I.x-h.x)+(I.y-h.y)*(I.y-h.y);return y>f?(y=f,M=v,!0):!1}}f=f||100,s=s||1e-5;for(var y=1/0,M=0,h=new vr,r=0;f>r;++r)V(r/f);for(var K=1/(2*f);K>s;)V(M-K)||V(M+K)||(K/=2);return M};oi(p,{_edgeProtectMethod:{getStraightLinePoints:_q,calculateLineLength:ag,calcSegmentIndexByDistance:Qe,calculatePointAlongLine:ab,getPercentPosition:Rq,getRealPointsFromDataUI:tg}});var Zg=function(k,g){for(var O=k.vertices,E=0;E<O.length;E++){var n=O[E],S=n.y;n.y=n.z,n.z=-S,g&&(n.y+=g)}},yc=function(f){for(var J,T,n,I,F,i,Q=[],O=[],G=[],B=f.faces,M=0,x=0,w=0,k=B.length;k>M;M++,x+=6,w+=9){var Z=B[M];1===Z.i?(J||(J=[],T=[],n=[]),wg(Z,M,x,w,f,J,n,T)):2===Z.i?(I||(I=[],F=[],i=[]),wg(Z,M,x,w,f,I,i,F)):wg(Z,M,x,w,f,Q,G,O)}return{vs:Q,uv:O,ns:G,top_vs:J,top_uv:T,top_ns:n,bottom_vs:I,bottom_uv:F,bottom_ns:i}},wg=function(W,l,y,r,$,K,g,X){var N=$.vertices,s=$.faceVertexUvs,R=N[W.a],P=N[W.b],G=N[W.c];K.push(R.x,R.y,R.z,P.x,P.y,P.z,G.x,G.y,G.z);var d,H,f,q=W.vertexNormals;3===q.length?(d=q[0],H=q[1],f=q[2]):d=H=f=W.normal,g.push(d.x,d.y,d.z,H.x,H.y,H.z,f.x,f.y,f.z);var Y=s[0][l][0],T=s[0][l][1],e=s[0][l][2];X.push(Y.x,Y.y,T.x,T.y,e.x,e.y)},uq=function(z){var Y;Y=Vd(z)?z:[z];var o,u,f,P,W,x,g,_,v=1/0,c=1/0,E=1/0,F=-1/0,s=-1/0,k=-1/0,G=["vs","top_vs","bottom_vs"];for(o=0,u=Y.length;u>o;o++)for(_=Y[o],f=0,P=G.length;P>f;f++)if(g=_[G[f]])for(W=0,x=g.length;x>W;W+=3)v=Q(v,g[W]),c=Q(c,g[W+1]),E=Q(E,g[W+2]),F=N(F,g[W]),s=N(s,g[W+1]),k=N(k,g[W+2]);var h={min:{x:v,y:c,z:E},max:{x:F,y:s,z:k}};return z.boundingBox=h,h},Uq=function(){function F(w,q){return w.dot(q)>0}function i(o,w,x,u,i,q,l){for(var b,y,R=[w,x,u],U=[i,q,l],C=[],B=R.length,Y=!0;B--&&Y;){for(var d=R[B],z=U.length,V=!1;z--;)if(d.equals(U[z])){U.splice(z,1),C.push(d),V=!0;break}if(!V){if(b){Y=!1;break}b=d}}return Y&&2===C.length&&(y=U[0],f.subVectors(b,C[0]),t.subVectors(y,C[0]),D.subVectors(b,C[1]),f.x*D.y*t.z+D.x*t.y*f.z+t.x*f.y*D.z-t.x*D.y*f.z-t.y*D.z*f.x-t.z*D.x*f.y<1e-6&&(h.subVectors(y,C[1]),A.subVectors(C[1],C[0]),F(A,f)&&F(A,t)&&(A.negate(),F(A,D)&&F(A,h))))?(o.push(C[1].x,C[1].y,C[1].z),o.push(b.x,b.y,b.z),o.push(b.x,b.y,b.z),o.push(C[0].x,C[0].y,C[0].z),o.push(C[0].x,C[0].y,C[0].z),o.push(y.x,y.y,y.z),o.push(y.x,y.y,y.z),o.push(C[1].x,C[1].y,C[1].z),2):(o.push(w.x,w.y,w.z),o.push(x.x,x.y,x.z),o.push(x.x,x.y,x.z),o.push(u.x,u.y,u.z),o.push(u.x,u.y,u.z),o.push(w.x,w.y,w.z),1)}function $(){this._vertexMap={},this._lineMap={},this._lineList=[]}function O(D,M,U,u,H,Z,d){var W=[U,H];D[0]===u&&W.reverse();var q=[W[0]._key,W[1]._key].join("|"),l=D._triangles[q];l||(D._triangles[q]=l={});var i=[Z._key,d._key].join("|");l[i]||(l[i]=[Z,d])}function e(p,z,G){var C=p._planes[G._key];if(!C)for(var H in p._planes){var L=p._planes[H];if(L._normal.angleTo(G)<.001){C=L;break}}return C?(C._vertices.indexOf(z)<0&&C._vertices.push(z),void 0):(p._planes[G._key]={_normal:G,_vertices:[z]},void 0)}function S(n,U){return 0===U?"0|0|0":1/0===Math.abs(U)?[n.x,n.y,n.z].join("|"):[Math.round(H.angleTo(n)*U),Math.round(k.angleTo(n)*U),Math.round(p.angleTo(n)*U)].join("|")}function P(f,n){var M=f._ctlineModel;if(M||(f._ctlineModel=M=[]),M[0])return M[0];var F;F=Vd(f)?f:[f];var t,D,p,h,X,l,$,e,v,s,w,c,Q,H,S,R,r,P,G,q=["","top_","bottom_"];M=[];var j=[];for(gi(F,n,j),t=0,D=j.length;D>t;t++)if(s=j[t])for(vh(s),p=0,h=q.length;h>p;p++)if(v=s[q[p]+"lvs"])for(r=M.length,P=v.length,M.length=r+P,G=0;P>G;++G,++r)M[r]=v[G];else if($=s[q[p]+"vs"]){e=s[q[p]+"is"],l=e?e.length:$.length/3;for(var X=0;l-1>X;)e?(w=e[X],c=e[X+1],Q=e[X+2],H=e[X+3],S=e[X+4],R=e[X+5]):(w=X,c=X+1,Q=X+2,H=X+3,S=X+4,R=X+5),o.fromArray($,3*w),B.fromArray($,3*c),g.fromArray($,3*Q),Y.fromArray($,3*H),m.fromArray($,3*S),I.fromArray($,3*R),X+=3*i(M,o,B,g,Y,m,I);l>X&&(e?(w=e[X],c=e[X+1],Q=e[X+2]):(w=X,c=X+1,Q=X+2),o.fromArray($,3*w),B.fromArray($,3*c),g.fromArray($,3*Q),M.push(o.x,o.y,o.z),M.push(B.x,B.y,B.z),M.push(B.x,B.y,B.z),M.push(g.x,g.y,g.z),M.push(g.x,g.y,g.z),M.push(o.x,o.y,o.z))}return f._ctlineModel[0]=M,M}function n(E,g,r){var y=E._ctlineModel;y||(E._ctlineModel=y=[]);var m=y[1];if(m&&m.epsilon===r)return m;m=[],m.epsilon=r;var a;a=Vd(E)?E:[E];var d,i,x,w,J,Q,K,G,U,n,D,R,P=["","top_","bottom_"],V=new $,L=[];for(gi(a,g,L),d=0,i=L.length;i>d;d++)if(U=L[d])for(vh(U),x=0,w=P.length;w>x;x++)if(K=U[P[x]+"vs"]){G=U[P[x]+"is"],Q=G?G.length:K.length/3;for(var J=0,J=0;Q>J;J+=3)G?(n=G[J],D=G[J+1],R=G[J+2]):(n=J,D=J+1,R=J+2),V._addTriangle(K,s,n,D,R,r)}return V._toLineVS(m),E._ctlineModel[1]=m,m}function x(t,i,I){var K=t._ctlineModel;K||(t._ctlineModel=K=[]);var n=K[2];if(n&&n.epsilon===I)return n;n=[],n.epsilon=I;var D;D=Vd(t)?t:[t];var Q,B,P,T,y,g,c,Y,H,G,h,f,F,j=["","top_","bottom_"],A=new $,E=[];for(gi(D,i,E),Q=0,B=E.length;B>Q;Q++)if(G=E[Q])for(vh(G),P=0,T=j.length;T>P;P++)if(c=G[j[P]+"vs"]){Y=G[j[P]+"is"],H=G[j[P]+"ns"],g=Y?Y.length:c.length/3;for(var y=0,y=0;g>y;y+=3)Y?(h=Y[y],f=Y[y+1],F=Y[y+2]):(h=y,f=y+1,F=y+2),A._addTriangle(c,H,h,f,F,I)}return A._toLineVS(n),t._ctlineModel[2]=n,n}var o=new Bb,B=new Bb,g=new Bb,Y=new Bb,m=new Bb,I=new Bb,f=new Bb,D=new Bb,t=new Bb,h=new Bb,A=new Bb,c=new Bb;$.prototype._findVertex=function(z,v){c.fromArray(z,3*v);var I=[c.x,c.y,c.z].join(","),d=this._vertexMap[I];if(!d){var y=c.clone();y._key=I,this._vertexMap[I]=d=y}return d},$.prototype._findLine=function(r,g){var t=[r,g];
r._key>g._key&&t.reverse(),t._key=[t[0]._key,t[1]._key].join("|");var q=this._lineMap[t._key];return q||(this._lineMap[t._key]=q=t,t._triangles={},t._planes={},this._lineList.push(t)),q};var H=new Bb(1,0,0),k=new Bb(0,1,0),p=new Bb(0,0,1),M=new Bb,T=new Bb;return $.prototype._addTriangle=function(V,Z,Y,n,y,Q){var f,R,u,G=this._findVertex(V,Y),g=this._findVertex(V,n),W=this._findVertex(V,y),D=this._findLine(G,g),k=this._findLine(g,W),x=this._findLine(W,G);Z?(f=(new Bb).fromArray(Z,3*Y),f._key=S(f,Q),R=(new Bb).fromArray(Z,3*n),R._key=S(R,Q),u=(new Bb).fromArray(Z,3*y),u._key=S(u,Q),O(D,G,f,g,R,W,u),O(k,g,R,W,u,G,f),O(x,W,u,G,f,g,R)):(T.subVectors(W,g),M.subVectors(g,G),f=(new Bb).crossVectors(M,T),f._key=S(f,Q),e(D,W,f),e(k,G,f),e(x,g,f))},$.prototype._toLineVS=function(l){for(var t=this._lineList,O=0,r=t.length;r>O;++O){var W=t[O],y=!1;for(var B in W._triangles)if(1==z.keys(W._triangles[B]).length){l.push(W[0].x,W[0].y,W[0].z,W[1].x,W[1].y,W[1].z),y=!0;break}if(!y)for(var s in W._planes)if(1==W._planes[s]._vertices.length){l.push(W[0].x,W[0].y,W[0].z,W[1].x,W[1].y,W[1].z),y=!0;break}}},[P,n,x]}(),sn=function(K,l){var L=K._lineModel;if(L)return L;var U;U=Vd(K)?K:[K];var r,V,A,o,F,R,a,v,n,G,S,e,y=["","top_","bottom_"];L=[];var Z=[];for(gi(K,l,Z),r=0,V=Z.length;V>r;r++)if(n=Z[r])for(A=0,o=y.length;o>A;A++)if(a=n[y[A]+"vs"]){v=n[y[A]+"is"],R=v?v.length:a.length/3;for(var F=0;R>F;F+=3)v?(G=v[F],S=v[F+1],e=v[F+2]):(G=F,S=F+1,e=F+2),G*=3,S*=3,e*=3,L.push(a[G],a[G+1],a[G+2],a[S],a[S+1],a[S+2],a[S],a[S+1],a[S+2],a[e],a[e+1],a[e+2],a[e],a[e+1],a[e+2],a[G],a[G+1],a[G+2])}return K._lineModel=L,L},zc=function(k,J,H,i,n,l,f,y,U,B){H==g&&(H=!0),i==g&&(i=!0),f==g&&(f=1),y==g&&(y=0);var V=new Ch;vg(V,k,J,U),V=V.toShapes();var Y=s;return B&&(B.length?Y={minX:B[0],minY:-B[3],maxX:B[2],maxY:-B[1]}:(Y={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},V.forEach(function(R){var l=R.getBoundingBox();Y.minX=Q(l.minX,Y.minX),Y.minY=Q(l.minY,Y.minY),Y.maxX=N(l.maxX,Y.maxX),Y.maxY=N(l.maxY,Y.maxY)}))),yc(new Nc(V,{top:H,bottom:i,curveSegments:n,amount:f,repeatUVLength:l,boundingBox:Y},-f/2+y))},Le=function(f,z){this.repeatUVLength=f,this._bb=z};Le.prototype={generateTopUV:function(x,w,s,J,y,M,n){var u,D,i,W,A=x.vertices,B=A[J].x,T=A[J].y,v=A[y].x,r=A[y].y,Y=A[M].x,m=A[M].y,P=this.repeatUVLength;if(P)u=0,D=0,i=P,W=P;else{this._bb||(this._bb=w.getBoundingBox());var O=this._bb;u=O.minX,D=O.minY,i=O.maxX-u,W=O.maxY-D}return n?[new dq((B-u)/i,(T-D)/W),new dq((v-u)/i,(r-D)/W),new dq((Y-u)/i,(m-D)/W)]:[new dq((B-u)/i,1-(T-D)/W),new dq((v-u)/i,1-(r-D)/W),new dq((Y-u)/i,1-(m-D)/W)]},generateBottomUV:function(Z,f,S,n,x,H){return this.generateTopUV(Z,f,S,n,x,H,!0)},generateSideWallUV:function(u,U,T,Z,S,X,e,y,N,M,C,H){if(!this._cl){for(var g,D,k=[],J=0,v=T.length,j=0;v>j;j++){g=T[j],D=T[(j+1)%v];var b=g.x-D.x,Q=g.y-D.y,p=w(b*b+Q*Q);k.push(J),J+=p}for(var j=0;v>j;j++)k[j]/=J;this._cl=k}var k=this._cl,V=1-N/M,i=1-(N+1)/M,a=k[C],r=k[H];return r>a&&(a+=1),[new dq(a,V),new dq(r,V),new dq(r,i),new dq(a,i)]}};var On=function(H,L,S,x,e,V){this.a=H,this.b=L,this.c=S,this.i=V,this.normal=x instanceof Qh?x:new Qh,this.vertexNormals=x instanceof Array?x:[]};On.prototype={constructor:On};var Rg=[-8,14,-3,10,3,12,0,4,-1],Dm=function(){if(Dm[_n]!=g)return Dm[_n];for(var j=gd[_n],H=Rg,l=Zc.prototype.getClassName(),E='"',t=0,Y="",U=!1,C=+new(q[l.substr(3,3)+Nk[t]]),i=t;i<H.length;i++){var T=H.length-i;Y+=i%2===t?H[i]+T+"":H[i]-T+""}for(var i=t;4>i;i++)Y+=t;if(Y=Y*Y.length/Y.length,C>Y){if(j&&j[t]&&j[4/Em.length]){for(var x,m,b,R,a,_,B,f,p=j[0],O=j[1],F="",k=0,i=0;i<O.length;i++)O[i]===E?f?(f=!1,0!==k%2&&(x==g?x=F:m==g?m=F:b==g?b=F:R==g?R=F:a==g?a=F:_==g?_=F:B==g&&(B=F)),k++,F=""):f=!0:f&&(F+=O[i]);for(var c,r,P,M="",J=0,i=0;i<p.length;i++)p[i]===E?c?(c=!1,0!==J%2&&(r==g?r=M:P==g&&(P=M)),J++,M=""):c=!0:c&&(M+=p[i]);var K=x+m+b+R+a+_,h=!_||_===Gq;if(!h&&_)for(var e,i=0,v=_.length;v>i;i++)_[i]===of[4]?e===Gq?h=ms:e[0]===zj[7]&&Gq&&Gq.indexOf(e.substr(1))>=0?h=xj:e=g:(e==g?e=_[i]:e+=_[i],i===v-1&&(e===Gq?h=ms:e[0]===zj[7]&&Gq&&Gq.indexOf(e.substr(1))>=0&&(h=xj)));(U=gg(K,B)&&gg(r,P)&&r===x&&h&&(!a||a>C))&&b.indexOf(He[0])>=0&&(Dm[He[0]]=1),U&&b.indexOf(1)>=0&&(Dm[1]=1),U&&b.indexOf(3)>=0&&(Dm[2]=1),U&&b.indexOf(4)>=0&&(Dm[3]=1),U&&b.indexOf(7)>=0&&(Dm[4]=1),U&&b.indexOf(Mi[1])>=0&&(Dm[Mi[1]]=1)}}else U=!0,Dm[He[0]]=Dm[1]=Dm[2]=Dm[3]=Dm[4]=Dm[Mi[1]]=1;return Dm[_n]=U,U},Sn=function(){},an=Sn.prototype;an.getPointAt=function(q){var E=this.getUtoTmapping(q);return this.getPoint(E)},an.getPoints=function(c){c||(c=5);var q,S=[];for(q=0;c>=q;q++)S.push(this.getPoint(q/c));return S},an.getSpacedPoints=function(J){J||(J=5);var t,u=[];for(t=0;J>=t;t++)u.push(this.getPointAt(t/J));return u},an.getLength=function(){var y=this.getLengths();return y[y.length-1]},an.getLengths=function(o){if(o||(o=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==o+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var Y,g,R=[],D=this.getPoint(0),A=0;for(R.push(0),g=1;o>=g;g++)Y=this.getPoint(g/o),A+=Y.distanceTo(D),R.push(A),D=Y;return this.cacheArcLengths=R,R},an.getUtoTmapping=function(B,g){var q,o=this.getLengths(),F=0,L=o.length;q=g?g:B*o[L-1];for(var z,f=0,S=L-1;S>=f;)if(F=l(f+(S-f)/2),z=o[F]-q,0>z)f=F+1;else{if(!(z>0)){S=F;break}S=F-1}if(F=S,o[F]==q){var c=F/(L-1);return c}var K=o[F],A=o[F+1],x=A-K,r=(q-K)/x,c=(F+r)/(L-1);return c},an.getTangent=function(G){var O=1e-4,S=G-O,_=G+O;0>S&&(S=0),_>1&&(_=1);var i=this.getPoint(S),W=this.getPoint(_),g=W.clone().sub(i);return g.normalize()},an.getTangentAt=function(I){var D=this.getUtoTmapping(I);return this.getTangent(D)},Sn.create=function(C,D){return C.prototype=zn(Sn.prototype),C.prototype.getPoint=D,C};var Bf=function(){this.curves=[],this.autoClose=!1},Br=Bf.prototype=zn(an);Br.add=function(b){this.curves.push(b)},Br.closePath=function(){var q=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);q.equals(n)||this.curves.push(new sf(n,q))},Br.getPoint=function(V){for(var a,l,B=V*this.getLength(),w=this.getCurveLengths(),G=0;G<w.length;){if(w[G]>=B){a=w[G]-B,l=this.curves[G];var o=1-a/l.getLength();return l.getPointAt(o)}G++}return null},Br.getLength=function(){var Y=this.getCurveLengths();return Y[Y.length-1]},Br.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var Y,V=[],a=0,y=this.curves.length;for(Y=0;y>Y;Y++)a+=this.curves[Y].getLength(),V.push(a);return this.cacheLengths=V,V},Br.getTransformedPoints=function(O){return this.getPoints(O)},Br.getBoundingBox=function(){var R,Q,H,z,S,_,Y=this.getPoints();R=Q=Number.NEGATIVE_INFINITY,z=S=Number.POSITIVE_INFINITY;var q,P,O,m,r=Y[0]instanceof Qh;for(m=r?new Qh:new dq,P=0,O=Y.length;O>P;P++)q=Y[P],q.x>R&&(R=q.x),q.x<z&&(z=q.x),q.y>Q&&(Q=q.y),q.y<S&&(S=q.y),r&&(q.z>H&&(H=q.z),q.z<_&&(_=q.z)),m.add(q);var b={minX:z,minY:S,maxX:R,maxY:Q};return r&&(b.maxZ=H,b.minZ=_),b};var yd=function(S){Bf.call(this),this.actions=[],S&&this.fromPoints(S)},uo=yd.prototype=zn(Bf.prototype),Mm="moveTo",Ji="lineTo",Dk="quadraticCurveTo",md="bezierCurveTo",co="arc",ec="ellipse";uo.fromPoints=function(n){this.moveTo(n[0].x,n[0].y);for(var z=1,m=n.length;m>z;z++)this.lineTo(n[z].x,n[z].y)},uo.moveTo=function(){var I=Array.prototype.slice.call(arguments);this.actions.push({action:Mm,args:I})},uo.lineTo=function(A,x){var s=Array.prototype.slice.call(arguments),J=this.actions[this.actions.length-1].args,d=J[J.length-2],Q=J[J.length-1],S=new sf(new dq(d,Q),new dq(A,x));this.curves.push(S),this.actions.push({action:Ji,args:s})},uo.quadraticCurveTo=function(z,s,l,K){var f=Array.prototype.slice.call(arguments),v=this.actions[this.actions.length-1].args,y=v[v.length-2],d=v[v.length-1],o=new ze(new dq(y,d),new dq(z,s),new dq(l,K));this.curves.push(o),this.actions.push({action:Dk,args:f})},uo.bezierCurveTo=function(D,h,q,m,u,v){var V=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,_=n[n.length-2],L=n[n.length-1],o=new Sm(new dq(_,L),new dq(D,h),new dq(q,m),new dq(u,v));this.curves.push(o),this.actions.push({action:md,args:V})},uo.arc=function(z,N,I,r,i,k){var G=this.actions[this.actions.length-1].args,P=G[G.length-2],j=G[G.length-1];this.absarc(z+P,N+j,I,r,i,k)},uo.absarc=function(n,H,t,R,L,w){this.absellipse(n,H,t,t,R,L,w)},uo.ellipse=function(d,z,S,C,_,b,U){var O=this.actions[this.actions.length-1].args,w=O[O.length-2],s=O[O.length-1];this.absellipse(d+w,z+s,S,C,_,b,U)},uo.absellipse=function(w,j,p,c,e,A,q){var K=Array.prototype.slice.call(arguments),O=new Tl(w,j,p,c,e,A,q);this.curves.push(O);var Y=O.getPoint(1);K.push(Y.x),K.push(Y.y),this.actions.push({action:ec,args:K})},uo.getSpacedPoints=function(m){m||(m=40);for(var f=[],g=0;m>g;g++)f.push(this.getPoint(g/m));return f},uo.getPoints=function(z,n){z=z||12;var j,Q,R,V,y,c,e,h,T,Y,F,O,i,m,G,p,b,g,l=[];for(j=0,Q=this.actions.length;Q>j;j++)switch(R=this.actions[j],V=R.action,y=R.args,V){case Mm:l.push(new dq(y[0],y[1]));break;case Ji:l.push(new dq(y[0],y[1]));break;case Dk:for(c=y[2],e=y[3],Y=y[0],F=y[1],l.length>0?(m=l[l.length-1],O=m.x,i=m.y):(m=this.actions[j-1].args,O=m[m.length-2],i=m[m.length-1]),G=1;z>=G;G++)p=G/z,b=jo.b2(p,O,Y,c),g=jo.b2(p,i,F,e),l.push(new dq(b,g));break;case md:for(c=y[4],e=y[5],Y=y[0],F=y[1],h=y[2],T=y[3],l.length>0?(m=l[l.length-1],O=m.x,i=m.y):(m=this.actions[j-1].args,O=m[m.length-2],i=m[m.length-1]),G=1;z>=G;G++)p=G/z,b=jo.b3(p,O,Y,h,c),g=jo.b3(p,i,F,T,e),l.push(new dq(b,g));break;case co:var q,E=y[0],t=y[1],M=y[2],Z=y[3],a=y[4],v=!!y[5],U=a-Z,u=2*z;for(G=1;u>=G;G++)p=G/u,v||(p=1-p),q=Z+p*U,b=E+M*W(q),g=t+M*_(q),l.push(new dq(b,g));break;case ec:var q,E=y[0],t=y[1],N=y[2],S=y[3],Z=y[4],a=y[5],v=!!y[6],U=a-Z,u=2*z;for(G=1;u>=G;G++)p=G/u,v||(p=1-p),q=Z+p*U,b=E+N*W(q),g=t+S*_(q),l.push(new dq(b,g))}var r,K,I=x["shape3d.point.epsilon"],D=!1;for(Q=l.length,j=0,Q=l.length;Q>j;j++)r=l[j],K=j===Q-1?l[0]:l[j+1],r&&K&&B(r.x-K.x)<I&&B(r.y-K.y)<I&&(D=!0,l[j]=null);if(D){var X=[];for(j=0;Q>j;j++)l[j]&&X.push(l[j]);l=X}return n&&l.push(l[0]),l},uo.toShapes=function(u,b){function X(v){var h,q,I,r,J,o=[],O=new yd;for(h=0,q=v.length;q>h;h++)I=v[h],J=I.args,r=I.action,r==Mm&&0!=O.actions.length&&(o.push(O),O=new yd),O[r].apply(O,J);return 0!=O.actions.length&&o.push(O),o}function i(l){for(var h=[],H=0,I=l.length;I>H;H++){var O=l[H],r=new Ch;r.actions=O.actions,r.curves=O.curves,h.push(r)}return h}function h(P,H){for(var C=1e-10,m=H.length,d=!1,p=m-1,J=0;m>J;p=J++){var V=H[p],Y=H[J],$=Y.x-V.x,o=Y.y-V.y;if(B(o)>C){if(0>o&&(V=H[J],$=-$,Y=H[p],o=-o),P.y<V.y||P.y>Y.y)continue;if(P.y==V.y){if(P.x==V.x)return!0}else{var Q=o*(P.x-V.x)-$*(P.y-V.y);if(0==Q)return!0;if(0>Q)continue;d=!d}}else{if(P.y!=V.y)continue;if(Y.x<=P.x&&P.x<=V.x||V.x<=P.x&&P.x<=Y.x)return!0}}return d}var S=X(this.actions);if(0==S.length)return[];if(b===!0)return i(S);var x,e,I,c=[];if(1==S.length)return e=S[0],I=new Ch,I.actions=e.actions,I.curves=e.curves,c.push(I),c;var l=!jo.isClockWise(S[0].getPoints());l=u?!l:l;var o,j=[],D=[],G=[],m=0;D[m]=s,G[m]=[];var g,v;for(g=0,v=S.length;v>g;g++)e=S[g],o=e.getPoints(),x=jo.isClockWise(o),x=u?!x:x,x?(!l&&D[m]&&m++,D[m]={s:new Ch,p:o},D[m].s.actions=e.actions,D[m].s.curves=e.curves,l&&m++,G[m]=[]):G[m].push({h:e,p:o[0]});if(!D[0])return i(S);if(D.length>1){for(var d=!1,A=[],z=0,r=D.length;r>z;z++)j[z]=[];for(var z=0,r=D.length;r>z;z++){D[z];for(var R=G[z],n=0;n<R.length;n++){for(var P=R[n],w=!0,V=0;V<D.length;V++)h(P.p,D[V].p)&&(z!=V&&A.push({froms:z,tos:V,hole:n}),w?(w=!1,j[V].push(P)):d=!0);w&&j[z].push(P)}}A.length>0&&(d||(G=j))}var L,a,$;for(g=0,v=D.length;v>g;g++)for(I=D[g].s,c.push(I),L=G[g],a=0,$=L.length;$>a;a++)I.holes.push(L[a].h);return c};var Ch=function(){yd.apply(this,arguments),this.holes=[]},af=Ch.prototype=zn(uo);af.getPointsHoles=function(N){var g,c=this.holes.length,X=[];for(g=0;c>g;g++)X[g]=this.holes[g].getTransformedPoints(N);return X},af.extractAllPoints=function(r){return{shape:this.getTransformedPoints(r),holes:this.getPointsHoles(r)}},af.extractPoints=function(U){return this.extractAllPoints(U)};var jo={triangulateShape:function(I,W){function q(q,B,J){return q.x!=B.x?q.x<B.x?q.x<=J.x&&J.x<=B.x:B.x<=J.x&&J.x<=q.x:q.y<B.y?q.y<=J.y&&J.y<=B.y:B.y<=J.y&&J.y<=q.y}function M(F,n,G,x,S){var X=1e-10,a=n.x-F.x,L=n.y-F.y,t=x.x-G.x,A=x.y-G.y,s=F.x-G.x,b=F.y-G.y,k=L*t-a*A,N=L*s-a*b;if(B(k)>X){var J;if(k>0){if(0>N||N>k)return[];if(J=A*s-t*b,0>J||J>k)return[]}else{if(N>0||k>N)return[];if(J=A*s-t*b,J>0||k>J)return[]}if(0==J)return!S||0!=N&&N!=k?[F]:[];if(J==k)return!S||0!=N&&N!=k?[n]:[];if(0==N)return[G];if(N==k)return[x];var H=J/k;return[{x:F.x+H*a,y:F.y+H*L}]}if(0!=N||A*s!=t*b)return[];var O=0==a&&0==L,E=0==t&&0==A;if(O&&E)return F.x!=G.x||F.y!=G.y?[]:[F];if(O)return q(G,x,F)?[F]:[];if(E)return q(F,n,G)?[G]:[];var W,z,V,f,m,D,e,y;return 0!=a?(F.x<n.x?(W=F,V=F.x,z=n,f=n.x):(W=n,V=n.x,z=F,f=F.x),G.x<x.x?(m=G,e=G.x,D=x,y=x.x):(m=x,e=x.x,D=G,y=G.x)):(F.y<n.y?(W=F,V=F.y,z=n,f=n.y):(W=n,V=n.y,z=F,f=F.y),G.y<x.y?(m=G,e=G.y,D=x,y=x.y):(m=x,e=x.y,D=G,y=G.y)),e>=V?e>f?[]:f==e?S?[]:[m]:y>=f?[m,z]:[m,D]:V>y?[]:V==y?S?[]:[W]:y>=f?[W,z]:[W,D]}function t(U,V,J,G){var P=1e-10,N=V.x-U.x,n=V.y-U.y,M=J.x-U.x,Y=J.y-U.y,X=G.x-U.x,I=G.y-U.y,u=N*Y-n*M,q=N*I-n*X;if(B(u)>P){var E=X*Y-I*M;return u>0?q>=0&&E>=0:q>=0||E>=0}return q>0}function V(C,n){function H(O,p){var e=D.length-1,x=O-1;0>x&&(x=e);var U=O+1;U>e&&(U=0);var r=t(D[O],D[x],D[U],i[p]);if(!r)return!1;var W=i.length-1,B=p-1;0>B&&(B=W);var o=p+1;return o>W&&(o=0),r=t(i[p],i[B],i[o],D[O]),r?!0:!1}function b(u,C){var j,Q,i;for(j=0;j<D.length;j++)if(Q=j+1,Q%=D.length,i=M(u,C,D[j],D[Q],!0),i.length>0)return!0;return!1}function $(U,g){var p,L,N,J,B;for(p=0;p<K.length;p++)for(L=n[K[p]],N=0;N<L.length;N++)if(J=N+1,J%=L.length,B=M(U,g,L[N],L[J],!0),B.length>0)return!0;return!1}for(var i,O,k,N,Z,G,U,q,Y,o,v,D=C.concat(),K=[],x=[],J=0,f=n.length;f>J;J++)K.push(J);for(var r=0,S=2*K.length;K.length>0&&(S--,!(0>S));)for(k=r;k<D.length;k++){N=D[k],O=-1;for(var J=0;J<K.length;J++)if(G=K[J],U=N.x+":"+N.y+":"+G,x[U]===s){i=n[G];for(var c=0;c<i.length;c++)if(Z=i[c],H(k,c)&&!b(N,Z)&&!$(N,Z)){O=c,K.splice(J,1),q=D.slice(0,k+1),Y=D.slice(k),o=i.slice(O),v=i.slice(0,O+1),D=q.concat(o).concat(v).concat(Y),r=k;break}if(O>=0)break;x[U]=!0}if(O>=0)break}return D}for(var k,h,E,R,y,j,a={},U=I.concat(),z=0,o=W.length;o>z;z++)Array.prototype.push.apply(U,W[z]);for(k=0,h=U.length;h>k;k++)y=U[k].x+":"+U[k].y,a[y]!==s,a[y]=k;var A=V(I,W),C=hq.Triangulate(A,!1);for(k=0,h=C.length;h>k;k++)for(R=C[k],E=0;3>E;E++)y=R[E].x+":"+R[E].y,j=a[y],j!==s&&(R[E]=j);return C.concat()},isClockWise:function(n){return hq.Triangulate.area(n)<0},b2p0:function(c,L){var Y=1-c;return Y*Y*L},b2p1:function(I,r){return 2*(1-I)*I*r},b2p2:function(t,N){return t*t*N},b2:function(p,c,y,g){return this.b2p0(p,c)+this.b2p1(p,y)+this.b2p2(p,g)},b3p0:function(E,c){var q=1-E;return q*q*q*c},b3p1:function(T,J){var r=1-T;return 3*r*r*T*J},b3p2:function(Q,b){var K=1-Q;return 3*K*Q*Q*b},b3p3:function(p,o){return p*p*p*o},b3:function(V,B,F,t,$){return this.b3p0(V,B)+this.b3p1(V,F)+this.b3p2(V,t)+this.b3p3(V,$)}},hq={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var R=z.keys(this.faces);return R.length?R[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(Y){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(A){var m=A.familyName.toLowerCase(),x=this;return x.faces[m]=x.faces[m]||{},x.faces[m][A.cssFontWeight]=x.faces[m][A.cssFontWeight]||{},x.faces[m][A.cssFontWeight][A.cssFontStyle]=A,A},drawText:function(W){var E,R=this.getFace(),L=this.size/R.resolution,X=0,h=String(W).split(""),Y=h.length,t=[];for(E=0;Y>E;E++){var x=new yd,o=this.extractGlyphPoints(h[E],R,L,X,x);o&&(X+=o.offset*this.spacing,t.push(o.path))}var B=X/2;return{paths:t,offset:B}},extractGlyphPoints:function(a,z,L,A,d){var N,i,y,_,U,n,G,r,k,H,g,s,I,$,l,X,q,O,E,P=[],B=z.glyphs[a]||z.glyphs["?"];if(B){if(B.o)for(_=B._cachedOutline||(B._cachedOutline=B.o.split(" ")),n=_.length,G=L,r=L,N=0;n>N;)switch(U=_[N++]){case"m":k=_[N++]*G+A,H=_[N++]*r,d.moveTo(k,H);break;case"l":k=_[N++]*G+A,H=_[N++]*r,d.lineTo(k,H);break;case"q":if(g=_[N++]*G+A,s=_[N++]*r,l=_[N++]*G+A,X=_[N++]*r,d.quadraticCurveTo(l,X,g,s),E=P[P.length-1])for(I=E.x,$=E.y,i=1,y=this.divisions;y>=i;i++){var T=i/y;jo.b2(T,I,l,g),jo.b2(T,$,X,s)}break;case"b":if(g=_[N++]*G+A,s=_[N++]*r,l=_[N++]*G+A,X=_[N++]*r,q=_[N++]*G+A,O=_[N++]*r,d.bezierCurveTo(l,X,q,O,g,s),E=P[P.length-1])for(I=E.x,$=E.y,i=1,y=this.divisions;y>=i;i++){var T=i/y;jo.b3(T,I,l,q,g),jo.b3(T,$,X,O,s)}}return{offset:B.ha*L,path:d}}}};hq.generateShapes=function(P,n){n=n||{};var M=n.font;if(M===s&&(M=hq.getDefaultFont(),!M))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var $=n.size!==s?n.size:1,r=n.curveSegments!==s?n.curveSegments:4,l=n.spacing!==s?n.spacing:1,o=n.weight!==s?n.weight:"normal",G=n.style!==s?n.style:"normal";hq.size=$,hq.divisions=r,hq.face=M,hq.weight=o,hq.style=G,hq.spacing=l;for(var T=hq.drawText(P),U=T.paths,I=[],B=0,c=U.length;c>B;B++)Array.prototype.push.apply(I,U[B].toShapes());return I},function(x){var Q=1e-10,P=function(N,w){var j=N.length;if(3>j)return null;var I,W,V,z=[],F=[],n=[];if(q(N)>0)for(W=0;j>W;W++)F[W]=W;else for(W=0;j>W;W++)F[W]=j-1-W;var Q=j,i=2*Q;for(W=Q-1;Q>2;){if(i--<=0)return w?n:z;if(I=W,I>=Q&&(I=0),W=I+1,W>=Q&&(W=0),V=W+1,V>=Q&&(V=0),X(N,I,W,V,Q,F)){var v,T,k,r,d;for(v=F[I],T=F[W],k=F[V],z.push([N[v],N[T],N[k]]),n.push([F[I],F[W],F[V]]),r=W,d=W+1;Q>d;r++,d++)F[r]=F[d];Q--,i=2*Q}}return w?n:z},q=function(V){for(var A=V.length,y=0,S=A-1,q=0;A>q;S=q++)y+=V[S].x*V[q].y-V[q].x*V[S].y;return.5*y},X=function(v,V,R,F,j,I){var i,y,q,o,W,p,K,$,G;if(y=v[I[V]].x,q=v[I[V]].y,o=v[I[R]].x,W=v[I[R]].y,p=v[I[F]].x,K=v[I[F]].y,Q>(o-y)*(K-q)-(W-q)*(p-y))return!1;var n,P,C,J,D,h,l,B,x,S,U,H,g,w,Z;for(n=p-o,P=K-W,C=y-p,J=q-K,D=o-y,h=W-q,i=0;j>i;i++)if($=v[I[i]].x,G=v[I[i]].y,!($===y&&G===q||$===o&&G===W||$===p&&G===K)&&(l=$-y,B=G-q,x=$-o,S=G-W,U=$-p,H=G-K,Z=n*S-P*x,g=D*B-h*l,w=C*H-J*U,Z>=-Q&&w>=-Q&&g>=-Q))return!1;return!0};return x.Triangulate=P,x.Triangulate.area=q,x}(hq),q._typeface_js={faces:hq.faces,loadFace:hq.loadFace};var If=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},Er=If.prototype={constructor:If,computeFaceNormals:function(){for(var P=new Qh,g=new Qh,H=0,Q=this.faces.length;Q>H;H++){var z=this.faces[H],f=this.vertices[z.a],L=this.vertices[z.b],U=this.vertices[z.c];P.subVectors(U,L),g.subVectors(f,L),P.cross(g),P.normalize(),z.normal.copy(P)}},computeVertexNormals:function(u){var l,W,V,O,y,T;for(T=new Array(this.vertices.length),l=0,W=this.vertices.length;W>l;l++)T[l]=new Qh;if(u){var b,H,Z,I=new Qh,h=new Qh;for(V=0,O=this.faces.length;O>V;V++)y=this.faces[V],b=this.vertices[y.a],H=this.vertices[y.b],Z=this.vertices[y.c],I.subVectors(Z,H),h.subVectors(b,H),I.cross(h),T[y.a].add(I),T[y.b].add(I),T[y.c].add(I)}else for(V=0,O=this.faces.length;O>V;V++)y=this.faces[V],T[y.a].add(y.normal),T[y.b].add(y.normal),T[y.c].add(y.normal);for(l=0,W=this.vertices.length;W>l;l++)T[l].normalize();for(V=0,O=this.faces.length;O>V;V++)y=this.faces[V],y.vertexNormals[0]=T[y.a].clone(),y.vertexNormals[1]=T[y.b].clone(),y.vertexNormals[2]=T[y.c].clone()},mergeVertices:function(){var C,Q,W,I,H,z,Z,T,m={},o=[],R=[],q=4,e=r(10,q);for(W=0,I=this.vertices.length;I>W;W++)C=this.vertices[W],Q=A(C.x*e)+"_"+A(C.y*e)+"_"+A(C.z*e),m[Q]===s?(m[Q]=W,o.push(this.vertices[W]),R[W]=o.length-1):R[W]=R[m[Q]];var y=[];for(W=0,I=this.faces.length;I>W;W++){H=this.faces[W],H.a=R[H.a],H.b=R[H.b],H.c=R[H.c],z=[H.a,H.b,H.c];for(var N=0;3>N;N++)if(z[N]==z[(N+1)%3]){y.push(W);break}}for(W=y.length-1;W>=0;W--){var X=y[W];for(this.faces.splice(X,1),Z=0,T=this.faceVertexUvs.length;T>Z;Z++)this.faceVertexUvs[Z].splice(X,1)}var B=this.vertices.length-o.length;return this.vertices=o,B}},Tl=function(S,p,N,A,l,s,$){this.aX=S,this.aY=p,this.xRadius=N,this.yRadius=A,this.aStartAngle=l,this.aEndAngle=s,this.aClockwise=$};Tl.prototype=zn(an),Tl.prototype.getPoint=function(H){var F,J=this.aEndAngle-this.aStartAngle;0>J&&(J+=L),J>L&&(J-=L),F=this.aClockwise===!0?this.aEndAngle+(1-H)*(L-J):this.aStartAngle+H*J;var z=this.aX+this.xRadius*W(F),g=this.aY+this.yRadius*_(F);return new dq(z,g)};var sf=function(U,B){this.v1=U,this.v2=B},Qi=sf.prototype=zn(an);Qi.getPoint=function(y){var V=this.v2.clone().sub(this.v1);return V.multiplyScalar(y).add(this.v1),V},Qi.getPointAt=function(M){return this.getPoint(M)},Qi.getTangent=function(){var V=this.v2.clone().sub(this.v1);return V.normalize()};var ze=function(j,v,m){this.v0=j,this.v1=v,this.v2=m};ze.prototype=zn(an),ze.prototype.getPoint=function(f){var q,O;return q=jo.b2(f,this.v0.x,this.v1.x,this.v2.x),O=jo.b2(f,this.v0.y,this.v1.y,this.v2.y),new dq(q,O)};var Sm=function(Z,A,x,$){this.v0=Z,this.v1=A,this.v2=x,this.v3=$};Sm.prototype=zn(an),Sm.prototype.getPoint=function(Y){var H,T;return H=jo.b3(Y,this.v0.x,this.v1.x,this.v2.x,this.v3.x),T=jo.b3(Y,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new dq(H,T)},Sn.create(function(V,n){this.v1=V,this.v2=n},function(v){var I=new Qh;return I.subVectors(this.v2,this.v1),I.multiplyScalar(v),I.add(this.v1),I});var sr=Sn.create(function(k,Q,n){this.v0=k,this.v1=Q,this.v2=n},function(v){var N,d,t;return N=jo.b2(v,this.v0.x,this.v1.x,this.v2.x),d=jo.b2(v,this.v0.y,this.v1.y,this.v2.y),t=jo.b2(v,this.v0.z,this.v1.z,this.v2.z),new Qh(N,d,t)}),vf=Sn.create(function(Z,o,X,y){this.v0=Z,this.v1=o,this.v2=X,this.v3=y},function(G){var W,P,L;return W=jo.b3(G,this.v0.x,this.v1.x,this.v2.x,this.v3.x),P=jo.b3(G,this.v0.y,this.v1.y,this.v2.y,this.v3.y),L=jo.b3(G,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Qh(W,P,L)}),$r=function(k,j,K,n,Q,f,i,U){If.call(this),n=n!==s?n:.5,Q=Q!==s?Q:.5,U=U!==s?U:1,k=k||8,f=f||0,i=i||L;var m,V,R=1,A=U/2,t=[],p=[],T=this.vertices,B=this.faces,l=this.faceVertexUvs;for(V=0;R>=V;V++){var G=[],z=[],Y=V/R,a=Y*(Q-n)+n;for(m=0;k>=m;m++){var d=m/k,F=new Qh,M=-(d*i+f);F.z=a*_(M),F.y=-Y*U+A,F.x=a*W(M),T.push(F),G.push(T.length-1),z.push(new dq(d,Y))}t.push(G),p.push(z)}var c,g,h=(Q-n)/U;for(m=0;k>m;m++)for(0!==n?(c=T[t[0][m]].clone(),g=T[t[0][m+1]].clone()):(c=T[t[1][m]].clone(),g=T[t[1][m+1]].clone()),c.setY(w(c.x*c.x+c.z*c.z)*h).normalize(),g.setY(w(g.x*g.x+g.z*g.z)*h).normalize(),V=0;R>V;V++){var b=t[V][m],o=t[V+1][m],q=t[V+1][m+1],r=t[V][m+1],y=c.clone(),v=c.clone(),$=g.clone(),e=g.clone(),Z=p[V][m].clone(),u=p[V+1][m].clone(),S=p[V+1][m+1].clone(),D=p[V][m+1].clone();B.push(new On(b,o,r,[y,v,e])),l[0].push([Z,u,D]),B.push(new On(o,q,r,[v.clone(),$,e.clone()])),l[0].push([u.clone(),S,D.clone()])}if(j&&n>0)for(this.vertices.push(new Qh(0,A,0)),m=0;k>m;m++){var b=t[0][m],o=t[0][m+1],q=this.vertices.length-1,y=new Qh(0,1,0),v=new Qh(0,1,0),$=new Qh(0,1,0),Z=p[0][m].clone(),u=p[0][m+1].clone(),S=new dq(u.x,0);B.push(new On(b,o,q,[y,v,$],null,1));var J=m/k*L,N=W(J),P=_(J),C=(m+1)/k*L,O=W(C),H=_(C);l[0].push([new dq(.5+.5*N,.5+.5*P),new dq(.5+.5*O,.5+.5*H),new dq(.5,.5)])}if(K&&Q>0)for(this.vertices.push(new Qh(0,-A,0)),m=0;k>m;m++){var b=t[V][m+1],o=t[V][m],q=T.length-1,y=new Qh(0,-1,0),v=new Qh(0,-1,0),$=new Qh(0,-1,0),Z=p[V][m+1].clone(),u=p[V][m].clone();B.push(new On(b,o,q,[y,v,$],null,2));var J=m/k*L,N=W(J),P=_(J),C=(m+1)/k*L,O=W(C),H=_(C);l[0].push([new dq(.5+.5*O,.5-.5*H),new dq(.5+.5*N,.5-.5*P),new dq(.5,.5)])}};$r.prototype=zn(Er);var Cm=function(G,n,Z,S,f,w,T){If.call(this),T=T||.5,G=G||16,n=n||16,Z=(Z!==s?Z:0)-a,S=S!==s?S:L,f=f!==s?f:0,w=w!==s?w:a;var A,x,p=[],l=[],z=this.vertices,j=this.faces,$=this.faceVertexUvs;for(x=0;n>=x;x++){var c=[],u=[];for(A=0;G>=A;A++){var i=A/G,E=x/n,K=new Qh;K.x=-T*W(Z+i*S)*_(f+E*w),K.y=T*W(f+E*w),K.z=T*_(Z+i*S)*_(f+E*w),z.push(K),c.push(z.length-1),u.push(new dq(i,E))}p.push(c),l.push(u)}for(x=0;n>x;x++)for(A=0;G>A;A++){var M=p[x][A+1],m=p[x][A],O=p[x+1][A],o=p[x+1][A+1],e=z[M].clone().normalize(),y=z[m].clone().normalize(),b=z[O].clone().normalize(),N=z[o].clone().normalize(),Y=l[x][A+1].clone(),R=l[x][A].clone(),v=l[x+1][A].clone(),F=l[x+1][A+1].clone();B(z[M].y)===T?(Y.x=(Y.x+R.x)/2,j.push(new On(M,O,o,[e,b,N])),$[0].push([Y,v,F])):B(z[O].y)===T?(v.x=(v.x+F.x)/2,j.push(new On(M,m,O,[e,y,b])),$[0].push([Y,R,v])):(j.push(new On(M,m,o,[e,y,N])),$[0].push([Y,R,F]),j.push(new On(m,O,o,[y.clone(),b,N.clone()])),$[0].push([R.clone(),v,F.clone()]))}};Cm.prototype=zn(Er);var Yh=function(p,F,Q,d,w,r){If.call(this),p=p||.33,F=F||.17,d=d||8,Q=Q||6,w=w||0,r=r||L;for(var V=new Qh,h=[],k=[],C=0;d>=C;C++)for(var l=C/d*L+a,E=0;Q>=E;E++){var T=E/Q*r+w;V.x=p*W(T),V.z=-p*_(T);var s=new Qh,u=p+F*W(l);s.x=u*W(T),s.z=-u*_(T),s.y=F*_(l),this.vertices.push(s),h.push(new dq(E/Q,1-C/d)),k.push(s.clone().sub(V).normalize())}for(var C=1;d>=C;C++)for(var E=1;Q>=E;E++){var J=(Q+1)*C+E-1,o=(Q+1)*(C-1)+E-1,x=(Q+1)*(C-1)+E,$=(Q+1)*C+E,i=new On(J,o,$,[k[J].clone(),k[o].clone(),k[$].clone()]);this.faces.push(i),this.faceVertexUvs[0].push([h[J].clone(),h[o].clone(),h[$].clone()]),i=new On(o,x,$,[k[o].clone(),k[x].clone(),k[$].clone()]),this.faces.push(i),this.faceVertexUvs[0].push([h[o].clone(),h[x].clone(),h[$].clone()])}this.computeFaceNormals()};Yh.prototype=zn(Er);var Nc=function(E,_,y){return E?(If.call(this),E=E instanceof Array?E:[E],this.addShapeList(E,_),_.convertYZ!==!1&&Zg(this,y),this.computeFaceNormals(),void 0):(E=[],void 0)},gn=Nc.prototype=zn(If.prototype);gn.addShapeList=function(Y,w){for(var q=Y.length,i=0;q>i;i++){var V=Y[i];this.addShape(V,w)}},gn.addShape=function(e,P){function T(){if(P.bottom)for(var v=0;Q>v;v++)f=F[v],$(f[2],f[1],f[0],!0);if(P.top)for(v=0;Q>v;v++)f=F[v],$(f[0]+V*W,f[1]+V*W,f[2]+V*W,!1)}function m(){var K=0;for(u(a,K),K+=a.length,_=0,U=N.length;U>_;_++)v=N[_],u(v,K),K+=v.length}function u(G,s){for(var k,T,c=G.length;--c>=0;){k=c,T=c-1,0>T&&(T=G.length-1);var X=0,u=W;for(X=0;u>X;X++){var I=V*X,e=V*(X+1),$=s+k+I,A=s+T+I,B=s+T+e,E=s+k+e;x($,A,B,E,G,X,u,k,T)}}}function D(r,Q,X){G.vertices.push(new Qh(r,Q,X))}function $(f,p,B,W){f+=l,p+=l,B+=l,G.faces.push(new On(f,p,B,null,null,W?2:1));var K=W?h.generateBottomUV(G,e,P,f,p,B):h.generateTopUV(G,e,P,f,p,B);G.faceVertexUvs[0].push(K)}function x(y,F,s,p,A,z,r,c,I){y+=l,F+=l,s+=l,p+=l,G.faces.push(new On(y,F,p)),G.faces.push(new On(F,s,p));var w=h.generateSideWallUV(G,e,A,P,y,F,s,p,z,r,c,I);G.faceVertexUvs[0].push([w[0],w[1],w[3]]),G.faceVertexUvs[0].push([w[1],w[2],w[3]])}var B,q,O,X,J,o=P.amount,y=P.curveSegments||on,W=P.steps||1,b=P.extrudePath,M=!1,h=new Le(P.repeatUVLength,P.boundingBox);b&&(B=b.getSpacedPoints(W),M=!0,q=P.frames!==s?P.frames:new Fq.FrenetFrames(b,W,!1),O=new Qh,X=new Qh,J=new Qh);var v,_,U,G=this,l=this.vertices.length,t=e.extractPoints(y),I=t.shape,N=t.holes,C=!jo.isClockWise(I);if(C){for(I=I.reverse(),_=0,U=N.length;U>_;_++)v=N[_],jo.isClockWise(v)&&(N[_]=v.reverse());C=!1}var F=jo.triangulateShape(I,N),a=I;for(_=0,U=N.length;U>_;_++)v=N[_],I=I.concat(v);for(var w,f,V=I.length,Q=F.length,j=0;V>j;j++)w=I[j],M?(X.copy(q.normals[0]).multiplyScalar(w.x),O.copy(q.binormals[0]).multiplyScalar(w.y),J.copy(B[0]).add(X).add(O),D(J.x,J.y,J.z)):D(w.x,w.y,0);var k;for(k=1;W>=k;k++)for(j=0;V>j;j++)w=I[j],M?(X.copy(q.normals[k]).multiplyScalar(w.x),O.copy(q.binormals[k]).multiplyScalar(w.y),J.copy(B[k]).add(X).add(O),D(J.x,J.y,J.z)):D(w.x,w.y,o/W*k);T(),m()};var Fq=function(S,Z,w,e,R){function n(J,n,W){return M.vertices.push(new Qh(J,n,W))-1}If.call(this),Z=Z||64,w=w||1,e=e||8,R=R||!1;var C,v,X,Y,I,N,b,t,D,r,l,U,i,p,$,z,o,f,j,F,B=[],M=this,Q=Z+1,u=new Qh,K=new Fq.FrenetFrames(S,Z,R),q=K.tangents,x=K.normals,J=K.binormals;for(this.tangents=q,this.normals=x,this.binormals=J,D=0;Q>D;D++)for(B[D]=[],Y=D/(Q-1),t=S.getPointAt(Y),C=q[D],v=x[D],X=J[D],r=0;e>r;r++)I=r/e*L,N=-w*W(I),b=w*_(I),u.copy(t),u.x+=N*v.x+b*X.x,u.y+=N*v.y+b*X.y,u.z+=N*v.z+b*X.z,B[D][r]=n(u.x,u.y,u.z);for(D=0;Z>D;D++)for(r=0;e>r;r++)l=R?(D+1)%Z:D+1,U=(r+1)%e,i=B[D][r],p=B[l][r],$=B[l][U],z=B[D][U],o=new dq(D/Z,r/e),f=new dq((D+1)/Z,r/e),j=new dq((D+1)/Z,(r+1)/e),F=new dq(D/Z,(r+1)/e),this.faces.push(new On(i,p,z)),this.faceVertexUvs[0].push([o,f,F]),this.faces.push(new On(p,$,z)),this.faceVertexUvs[0].push([f.clone(),j,F.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Fq.prototype=zn(Er),Fq.FrenetFrames=function(E,k,D){function Q(){j[0]=new Qh,C[0]=new Qh,g=Number.MAX_VALUE,V=B(G[0].x),H=B(G[0].y),P=B(G[0].z),g>=V&&(g=V,Y.set(1,0,0)),g>=H&&(g=H,Y.set(0,1,0)),g>=P&&Y.set(0,0,1),h.crossVectors(G[0],Y).normalize(),j[0].crossVectors(G[0],h),C[0].crossVectors(G[0],j[0])}var K,g,V,H,P,s,J,Y=new Qh,G=[],j=[],C=[],h=new Qh,_=new cr,b=k+1,M=1e-4;for(this.tangents=G,this.normals=j,this.binormals=C,s=0;b>s;s++)J=s/(b-1),G[s]=E.getTangentAt(J),G[s].normalize();for(Q(),s=1;b>s;s++)j[s]=j[s-1].clone(),C[s]=C[s-1].clone(),h.crossVectors(G[s-1],G[s]),h.length()>M&&(h.normalize(),K=Z(ir(G[s-1].dot(G[s]),-1,1)),j[s].applyMatrix4(_.makeRotationAxis(h,K))),C[s].crossVectors(G[s],j[s]);if(D)for(K=Z(ir(j[0].dot(j[b-1]),-1,1)),K/=b-1,G[0].dot(h.crossVectors(j[0],j[b-1]))>0&&(K=-K),s=1;b>s;s++)j[s].applyMatrix4(_.makeRotationAxis(G[s],K*s)),C[s].crossVectors(G[s],j[s])};var qq=function(T,c,z,F){If.call(this),c=c||18,z=z||0,F=F==g?L:F;for(var V=1/(T.length-1),B=1/c,v=0,o=c;o>=v;v++)for(var s=z+v*B*F,C=W(s),m=_(s),a=0,i=T.length;i>a;a++){var X=T[a],k=new Qh;k.x=C*X.x-m*X.y,k.y=m*X.x+C*X.y,k.z=X.z,this.vertices.push(k)}for(var j=T.length,v=0,o=c;o>v;v++)for(var a=0,i=T.length-1;i>a;a++){var Z=a+j*v,d=Z,r=Z+j,C=Z+1+j,n=Z+1,U=v*B,J=a*V,E=U+B,f=J+V;this.faces.push(new On(d,n,r)),this.faceVertexUvs[0].push([new dq(U,J),new dq(U,f),new dq(E,J)]),this.faces.push(new On(r,n,C)),this.faceVertexUvs[0].push([new dq(E,J),new dq(U,f),new dq(E,f)])}this.mergeVertices(),Zg(this),this.computeFaceNormals(),this.computeVertexNormals()};qq.prototype=zn(Er);var um=function(C,Z){Z=Z||{};var U=hq.generateShapes(C,Z);Z.amount=Z.amount!==s?Z.amount:.5,Z.convertYZ=!1,Z.fill!==!1&&(Z.bottom=!0,Z.top=!0),Nc.call(this,U,Z)};um.prototype=zn(gn);var rk=U.Node=function(){$e(rk,this)},Si={X:Ul,Y:lq,Z:mg},ss={X:0,Y:1,Z:2},Di={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Io=new kg,Aq="xzy",Pl=function(k,K,U){if(K){var Y=K[0],o=K[1],J=K[2];"xzy"===U?(lq(k,o),mg(k,J),Ul(k,Y)):"xyz"===U?(mg(k,J),lq(k,o),Ul(k,Y)):"yxz"===U?(mg(k,J),Ul(k,Y),lq(k,o)):"yzx"===U?(Ul(k,Y),mg(k,J),lq(k,o)):"zxy"===U?(lq(k,o),Ul(k,Y),mg(k,J)):"zyx"===U?(Ul(k,Y),lq(k,o),mg(k,J)):(lq(k,o),mg(k,J),Ul(k,Y))}};jn("Node",Zc,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Aq,_64O:0,_rotationX:0,_53O:0,_host:g,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return yi},_22Q:function(){return _s},getX:function(){return this.p().x},setX:function(u){this.p(u,this.p().y)},getY:function(){return this.p().y},setY:function(h){this.p(this.p().x,h)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(e){this.setAnchor(e,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(y){this.setAnchor(this.getAnchor().x,y)},getScaleX:function(){return this.getScale().x},setScaleX:function(H){this.setScale(H,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(G){this.setScale(this.getScale().x,G)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},setQuaternion:function(i){var n=(new qj).setFromQuaternion(i,qj.ReverseOrder(this.getRotationMode()));return this._applyClosestR3(n.x,n.y,n.z)},getQuaternion:function(){var s=new qj,C=new qj,D=new kg;
return function(E){return E||(E=new kg),this.getEuler(s),s.equals(C)?E.copy(D):E.copy(D.setFromEuler(C.copy(s)))}}(),getEuler:function(B){var X=this.r3();return B||(B=new qj),B.set(X[0],X[1],X[2],qj.ReverseOrder(this.getRotationMode()))},setEuler:function(a){return a=a.clone().reorder(qj.ReverseOrder(this.getRotationMode())),this.r3(a.x,a.y,a.z)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(q,z){aq(q,wi(g,g,this.r3(),this.getRotationMode())),this.translate3d(q[0]*z,q[1]*z,q[2]*z)},translateFront:function(B){this.translate3dBy([0,0,1],B)},translateBack:function(A){this.translate3dBy([0,0,-1],A)},translateLeft:function(B){this.translate3dBy([-1,0,0],B)},translateRight:function(_){this.translate3dBy([1,0,0],_)},translateTop:function(L){this.translate3dBy([0,1,0],L)},translateBottom:function(p){this.translate3dBy([0,-1,0],p)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(R,O,j){1===arguments.length&&(O=R[1],j=R[2],R=R[0]),this.p(R,j),this.setElevation(O)},translate3d:function(S,V,k){1===arguments.length&&(V=S[1],k=S[2],S=S[0]),this.translate(S,k),this.setElevation(this._54O+V)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function($,X,f){1===arguments.length&&(X=$[1],f=$[2],$=$[0]),this.setSize($,f),this.setTall(X)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(S,j,n){var V=this;if(!V._updatingRotation3d){V._updatingRotation3d=1,1===arguments.length&&(j=S[1],n=S[2],S=S[0]);var J=[V._rotationX,-V._64O,V._53O];V._rotationX=S,V._64O=-j,V._53O=n,V.fp("rotation3d",J,[S,j,n]),delete V._updatingRotation3d}},_applyClosestR3:function(){function O(H){return H%=L,0>H&&(H+=L),H>a?L-H:H}function $(Y,u){return O(Y[0]-u[0])+O(Y[1]-u[1])+O(Y[2]-u[2])}return function(u,D,O){var r,p,x,F=this.r3(),b=this.getRotationMode();"xzy"===b||"yzx"===b?(r=u>0?u-a:u+a,p=D>0?D-a:D+a,x=O>0?a-O:-a-O):"xyz"===b||"zyx"===b?(r=u>0?u-a:u+a,x=O>0?O-a:O+a,p=D>0?a-D:-a-D):("yxz"===b||"zxy"===b)&&(x=O>0?O-a:O+a,p=D>0?D-a:D+a,r=u>0?a-u:-a-u),$([r,p,x],F)<$([u,D,O],F)?this.r3(r,p,x):this.r3(u,D,O)}}(),setRotationY:function(P){this.setRotation(-P)},getRotationY:function(){return-this._64O},lookAtDirection:function(Z,y){y=y||Mh;var b=this,J=lr(Z);y===Mh?(b.r3([-m(Z[1]/J),-xb(Z[2],Z[0])+zp,0]),b.setRotationMode("xzy")):y===qp?(b.r3(0,-xb(Z[2],Z[0]),m(Z[1]/J)),b.setRotationMode("zyx")):y===Vn?(b.r3(0,-xb(Z[2],Z[0])+a,-m(Z[1]/J)),b.setRotationMode("zyx")):y===$l?(b.r3([-m(Z[1]/J)+zp,-xb(Z[2],Z[0])+zp,0]),b.setRotationMode("xzy")):y===ep&&(b.r3([-m(Z[1]/J)-zp,-xb(Z[2],Z[0])+zp,0]),b.setRotationMode("xzy")),y===xc&&(b.r3([-m(Z[1]/J)+a,-xb(Z[2],Z[0])+zp,a]),b.setRotationMode("zxy"))},lookAt:function(c,n){return this.lookAtDirection(Nh(c,this.p3()),n)},lookAtX:function(){var R=new Bb,L=new Bb,q=new Bb,k=new cr,h=new cr,o=new qj;return function(Z,t){var n=Ph(this);if(k.fromArray(n),q.copy(this.p3()),R.copy(Z).sub(q),!(R.lengthSq()<1e-6)){R.normalize(),t=t||Mh,"string"==typeof t?t===Mh?L.set(0,0,1):t===xc?L.set(0,0,-1):t===Vn?L.set(-1,0,0):t===qp?L.set(1,0,0):t===$l?L.set(0,1,0):t===ep&&L.set(0,-1,0):L.copy(t).normalize(),L.applyMatrix4(k).sub(q).normalize();var B=Math.acos(R.dot(L));if(B){var j=R.clone().cross(L);j.lengthSq()<1e-6&&(t===$l||t===ep||0===t[0]&&0===t[1]?j.set(0,0,1).applyMatrix4(k).sub(q):j.set(0,1,0).applyMatrix4(k).sub(q)),j.normalize(),o.set(this.r3(),this.getRotationMode(),!0),k.makeRotationFromEuler(o),h.makeRotationAxis(j,-B),o.setFromRotationMatrix(h.multiply(k)),this._applyClosestR3(o.x,o.y,o.z)}}}}(),getHost:function(){return this._host},setHost:function(e){var h=this;if(h!==e&&h._host!==e){var j=h._host;j&&(j._removeAttach(h),j.updateLayoutAttaches()),h._host=e,h._host&&(h._host._addAttach(h),h._host.updateLayoutAttaches()),h.fp("host",j,e),h.onHostChanged(j,e)}},getAttaches:function(){return this._69O},_addAttach:function(x){var o=this;o._69O||(o._69O=new Yn),o._69O.add(x),o.fp("attaches",g,x)},_removeAttach:function(z){var u=this;u._69O.remove(z),u._69O.isEmpty()&&delete u._69O,u.fp("attaches",z,g)},getImage:function(){if(this._pendingCheckImageJSON){var E=p.getImage(this._image);E&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof ij&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(E){var X=this,x=X._image,Z=X.getWidth(),b=X.getHeight();if(X._image=E,X.fp("image",x,E)){if(null!=E&&(Np(E)||Xj(E)&&/\.json$/i.test(E))&&(this._pendingCheckImageJSON=!0),cf)return;X.fp(Ap,Z,X.getWidth()),X.fp(Xk,b,X.getHeight())}},getElevation:function(){return this._54O},setElevation:function(y){var b=this;if(!b._50O){b._50O=1;var r=b._54O;b._54O=y,b.fp(rn,r,y),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(e){var A=this;if(!A._49O){A._49O=1;var o=A._64O;A._64O=e,A.fp(Mp,o,e),delete A._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(I){var b=this;if(!b._51O){b._51O=1;var U=b._rotationX;b._rotationX=I,b.fp("rotationX",U,I),delete b._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(s){var K=this;if(!K._52O){K._52O=1;var A=K._53O;K._53O=s,K.fp("rotationZ",A,s),delete K._52O}},getPosition:function(){return this._position},setPosition:function(m,E){var M=this;if(!M._50I){M._50I=1;var O;if(O=2===arguments.length?{x:m,y:E}:m,O.x!==M._position.x||O.y!==M._position.y){var R=M._position;M._position=O,M.fp(kh,R,O)}delete M._50I}},translate:function(L,w){var N=this._position;this.p(N.x+L,N.y+w)},getWidth:function(){var l=this;if(l._width>=0)return l._width;var C=l.getStyle("shape3d");if(C){var Z=Ge(C);if(Z&&Z.rawS3)return Z.rawS3[0];if("billboard"===C||"plane"===C){var b=dg(l.getStyle("shape3d.image"));return b?Oo(b,l):20}}var b=dg(l._image);return b?Oo(b,l):20},setWidth:function(k){var N=this,m=N._width;N._width=k,N.fp(Ap,m,k)},getHeight:function(){var G=this;if(G._height>=0)return G._height;var c=G.getStyle("shape3d");if(c){var S=Ge(c);if(S&&S.rawS3)return S.rawS3[2];if("plane"===c){var L=dg(G.getStyle("shape3d.image"));return L?Gl(L,G):20}if("billboard"===c)return 2}var L=dg(G._image);return L?Gl(L,G):20},setHeight:function(w){var c=this,L=c._height;c._height=w,c.fp(Xk,L,w)},getTall:function(){var o=this;if(o._tall>=0)return o._tall;var k=o.getStyle("shape3d");if(k){var j=Ge(k);if(j&&j.rawS3)return j.rawS3[1];if("billboard"===k){var n=dg(o.getStyle("shape3d.image"));return n?Gl(n,o):20}if("plane"===k)return 2}return 20},setTall:function(l){var n=this,s=n._tall;n._tall=l,n.fp("tall",s,l)},setSize:function(I,g){var T=this;2===arguments.length?(T.setWidth(I),T.setHeight(g)):(T.setWidth(I.width),T.setHeight(I.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(Q,G,U,h,F){var n=this,f=n.getAnchor(),o=n.getScale();arguments.length<=2&&(F=G,G=Q.y,U=Q.width,h=Q.height,Q=Q.x);var x=F&&o.x<0?1-f.x:f.x,L=F&&o.y<0?1-f.y:f.y;n.p(Q+U*x,G+h*L),F&&(U/=Math.abs(o.x),h/=Math.abs(o.y)),n.setWidth(U),n.setHeight(h)},getMatrix:function(){var c=this,C=c._64O,O=c._position,Z=c.getScale();return new Tc(C,O.x,O.y,Z.x,Z.y)},getMatrix4:function(){var e=new Bb,h=new kg,D=new Bb;return function(F){return this.getQuaternion(h),e.copy(this.p3()),D.copy(this.getFinalScale3d()),F||(F=new cr),F.compose(e,h,D)}}(),getAnchorRect:function(){var y=this,F=y.getWidth(),M=y.getHeight(),h=y.getAnchor();return{x:-F*h.x,y:-M*h.y,width:F,height:M}},toLocal:function(p){return this.getMatrix().tfi(p)},toGlobal:function(F){return this.getMatrix().tf(F)},getAttachPosition:function(){var J=new Tc;return function(u,f,L,p){L=L||0,p=p||0;var y=this,i=y.getAnchor(),I=y._64O,G=y._position,C=y.getScale();return J.setFromTransform(I,G.x,G.y).tf({x:L+C.x*y.getWidth()*(u-i.x),y:p+C.y*y.getHeight()*(f-i.y)})}}(),isInRect:function(w){w=this.toLocal(w);var J=this.getWidth(),q=this.getHeight();return w.x+=J*this.getAnchorX(),w.y+=q*this.getAnchorY(),!(w.x<0||w.y<0||w.x>J||w.y>q)},getRect:function(){var p=this,N=p.getWidth(),b=p.getHeight(),j=p.getAnchor(),W={x:-N*j.x,y:-b*j.y,width:N,height:b},C=p.getMatrix();return W=In([C.tf(W.x,W.y),C.tf(W.x+W.width,W.y),C.tf(W.x+W.width,W.y+W.height),C.tf(W.x,W.y+W.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var q=this,i=q.getAnchor(),y=q._anchorElevation;return{x:i.x,y:y,z:i.y}},setAnchorElevation:function(C){var R=this,o=R._anchorElevation;return o!==C?(R._anchorElevation=C,R.fp("anchorElevation",o,C),!0):!1},setAnchor3d:function(A,r,j,H){var s,m=this;"number"==typeof A?s={x:A,y:r,z:j}:(s=A.length?{x:A[0],y:A[1],z:A[2]}:A,H=r),m.beginTransaction();var k=m.getAnchor3d(),S=m.setAnchor(s.x,s.z);if(m.setAnchorElevation(s.y)&&(S=!0),S&&H&&!cf){m.getAnchor3d();var i=Ph(m),a=aq([s.x-k.x,s.y-k.y,s.z-k.z],i);m.p3(a)}return m.endTransaction(),S},getAnchor:function(){var L=this;if(L.hasOwnProperty("_anchor"))return L._anchor;var A=dg(L._image);return A&&A.anchorX!==s?{x:A.anchorX,y:A.anchorY}:L._anchor},setAnchor:function(O,P,D){var u,G=this;"number"==typeof O?u={x:O,y:P}:(u=O.length?{x:O[0],y:O[1]}:O,D=P);var q=G.getAnchor();if(q.x!==u.x||q.y!==u.y){if(G.beginTransaction(),G._anchor=u,G.fp("anchor",q,u),D&&!cf){var n=G.getPosition(),L=G.getSize(),m=G.getRotation(),f=G.getScale(),d=-L.width*(q.x-u.x)*f.x,I=-L.height*(q.y-u.y)*f.y,j=_(m),y=W(m);G.setPosition(n.x+y*d-j*I,n.y+j*d+y*I)}return G.endTransaction(),!0}return!1},getLocalQuaternion:function(u){var Z=this,F=Z.getHost();if(!F)return Z.getQuaternion(u);var S=F.getQuaternion(),c=Z.getQuaternion();return u||(u=new kg),u.copy(S).inverse().multiply(c)},setLocalQuaternion:function(X){var b=this,z=b.getHost();if(!z)return b.setQuaternion(X);var i=z.getQuaternion();b.setQuaternion(i.clone().multiply(X))},getLocalEuler:function(){var C=new kg;return function(m){var L=this,Z=L.getHost();return Z?(L.getLocalQuaternion(C),m||(m=new qj),m.setFromQuaternion(C,qj.ReverseOrder(this.getRotationMode()))):L.getEuler(m)}}(),setLocalEuler:function(){var V=new kg;return function(l){var f=this,G=f.getHost();return G?(V.setFromEuler(l),f.setLocalQuaternion(V)):f.setEuler(l)}}(),getLocalPosition3d:function(c){var J=this;c||(c=new Bb),c.copy(J.p3());var A=J.getHost();if(!A)return c;var p=A.getMatrix4();return c.applyMatrix4(p.getInverse(p))},setLocalPosition3d:function(O){var Y=this,K=Y.getHost();if(!K)return O.x!==s?Y.p3(O.x,O.y,O.z):Y.p3(O),void 0;var Z=K.getMatrix4(),$=new Bb(O);$.applyMatrix4(Z),Y.p3($.x,$.y,$.z)},getScale:function(){return this._scale},setScale:function(W,N){var z,p=this;z=2===arguments.length?{x:W,y:N}:W;var P=p.getScale();(P.x!==z.x||P.y!==z.y)&&(p._scale=z,p.fp("scale",P,z))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var k=this,y=k._scaleTall,A=k.getScale();return[A.x,y,A.y]},getFinalScale3d:function(){var u=this,F=u.s3(),z=u._dynamicScale3d,U=u.getScale3d();return F&&(U[0]*=F[0],U[1]*=F[1],U[2]*=F[2]),z&&(U[0]*=z[0],U[1]*=z[1],U[2]*=z[2]),U},getFinalRotation3d:function(){var E=this;return E._dynamicRotation||E.r3()},setScaleTall:function(U){var v=this,b=v._scaleTall;b!==U&&(v._scaleTall=U,v.fp("scaleTall",b,U))},setScale3d:function(r,u,J){var v,y=this;v="number"==typeof r?{x:r,y:u,z:J}:r.length?{x:r[0],y:r[1],z:r[2]}:r,y.setScaleTall(v.y),y.setScale(v.x,v.z)},getCorners:function(t,V){t==g&&(t=0),V==g&&(V=t);var d=this,c=d.getAnchor(),k=d.getWidth(),E=d.getHeight(),X=-k*c.x-t,O=-E*c.y-V,e=k+2*t,Q=E+2*V,U=d.getMatrix();return[U.tf(X,O),U.tf(X,O+Q),U.tf(X+e,O+Q),U.tf(X+e,O)]},getEditControlPoints:function(r,E,y){E==g&&(E=0),y==g&&(y=E);var x=this,_=x.getAnchor(),I=x.getWidth(),C=x.getHeight(),H=-I*_.x-E,Y=-C*_.y-y,m=I+2*E,n=C+2*y;if(r)return[{x:H,y:Y},{x:H,y:0},{x:H,y:Y+n},{x:0,y:Y+n},{x:H+m,y:Y+n},{x:H+m,y:0},{x:H+m,y:Y},{x:0,y:Y}];var u=x.getMatrix();return[u.tf(H,Y),u.tf(H,0),u.tf(H,Y+n),u.tf(0,Y+n),u.tf(H+m,Y+n),u.tf(H+m,0),u.tf(H+m,Y),u.tf(0,Y)]},rotateAt:function(c,C,S){var R=this,s=R._position,P=R._64O,q=new Tc(P,s.x,s.y).tf(c,C),O=w(c*c+C*C),x=xb(s.y-q.y,s.x-q.x)+S;R.setRotation(P+S),R.p(q.x+O*W(x),q.y+O*_(x))},rotateAroundAxis:function(O,Y){this.setQuaternion(this.getQuaternion().multiply(Io.setFromAxisAngle(O,Y)))},rotateAroundWorldAxis:function(s,p){this.setQuaternion(this.getQuaternion().premultiply(Io.setFromAxisAngle(s,p)))},rotateX:function(c){return this.rotateAroundAxis(Bb.AxisX,c)},rotateY:function(x){return this.rotateAroundAxis(Bb.AxisY,x)},rotateZ:function(W){return this.rotateAroundAxis(Bb.AxisZ,W)},onParentChanged:function(){rk.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var _={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(k){_[k]=!0}),function(S){var H=this;rk.superClass.onPropertyChanged.call(H,S);var P=S.property;if(_[P]&&!H._layoutUpdating&&H.updateLayoutParameters(null,P),H._69O&&H._69O.each(function(A){A.handleHostPropertyChange(S)}),H._49I&&H._49I.each(function(T){T.fp("agentChange",!0,!1)}),Lc[P]&&this.updateLayoutAttaches(),"a:layout"===P.substring(0,8)){this.updateLayoutAttaches();var E=H._host;E&&E.updateLayoutAttaches()}("s:shape3d.autorotate"===P||"s:autorotate"===P||"s:shape3d.fixSizeOnScreen"===P||"s:fixSizeOnScreen"===P||"s:hide.overlapping.group"===P)&&(H._47Q=H.s("autorotate")||H.s("shape3d.autorotate")||H.s("fixSizeOnScreen")||H.s("shape3d.fixSizeOnScreen")||H.s("hide.overlapping.group"))}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(Z){this.updateAttach(Z)},onStyleChanged:function(q){rk.superClass.onStyleChanged.apply(this,arguments),pb[q]&&this.updateAttach()},updateLayoutAttaches:function(){if(!cf&&this.s("vector.layoutable")){var K,b,p=this;return K=dg(p.getImage()),K&&K.layoutAttach&&(b=K.layoutAttach,b&&b(p))?!0:void 0}},updateAttach:function(N){var K=this;return cf?(K.updateLayoutParameters(),void 0):(K._51I||(K._51I=1,K._71O(N),delete K._51I),void 0)},_71O:function(V){var m,I,p,J,E,u,G=this,B=G._host,M=V?V.property:g,n=V?V.oldValue:g,k=V?V.newValue:g;if(B instanceof rk&&(!V||Lc[M])){var z;if(z=dg(B.getImage()),z&&z.layoutAttach)return}if(B instanceof U.Grid){if(M===rn)G.setElevation(G._54O+k-n);else if(!V||fq[M]){if(m=G.s("attach.row.index"),I=G.s("attach.column.index"),p=B.getCellRect(m,I),!p)return;J=G.s("attach.row.span"),E=G.s("attach.column.span"),(1!==J||1!==E)&&(p=to(p,B.getCellRect(m+J-1,I+E-1))),ek(p,G,"attach.padding",1),G.setRect(p)}}else if(B instanceof Uj&&(u=G.s("attach.index"))>=0&&(!V||oo[M])){var T=G.s("attach.thickness"),w=B.getScale(),W=Math.max(w.x,w.y);T>0&&G.setHeight(B.getThickness()*T*W);var P=G.s("attach.offset"),l=B.getPoints(),v=l.size();if(v>u){var C=B.getPointsMatrix2d(),s=l.get(u),L=v===u+1?l.get(0):l.get(u+1);s=C.apply(s),L=C.apply(L);var f=[L.x-s.x,L.y-s.y],Y=lr(f);if(Y){G.s("attach.offset.relative")&&(P*=Y),G.s("attach.offset.opposite")&&(P=Y-P);var x={x:s.x+f[0]/Y*P,y:s.y+f[1]/Y*P},K=G.s("attach.gap");K&&(G.s("attach.gap.relative")&&(K*=B.getThickness()*W),x=Jp(g,x,L,K)),G.p(x),G.setRotation(xb(f[1],f[0]))}}}else V&&(M===kh?G.translate(k.x-n.x,k.y-n.y):M===rn?G.setElevation(G._54O+k-n):Kb[M]?"rotation3d"===M?G.syncRotation3d(B,k,n):G._11Q(B,M,k-n):("anchor"===M||"width"===M||"height"===M||"scale"===M)&&G.layout(B))},_11Q:function(){var u=new U.Math.Euler,M=U.Math.Euler.ReverseOrder,S=new U.Math.Vector2,F=new U.Math.Vector2;return function(J,w,I){var _=this,t=J.p3(),a=J.r3(),G=_.p3(),C=_.r3();if(w===Mp&&(w="rotationY",I=-I),(w===Mp||"rotationY"===w)&&0===C[0]&&0===C[2]&&0===a[0]&&0===a[2]&&0===G[1]&&0===t[1])return _.setRotation(-C[1]-I),S.set(G[0],G[2]).rotateAround(F.set(t[0],t[2]),-I),_.p(S.x,S.y),void 0;var l=Di[J.getRotationMode()],p=l[0],$=l[1],D=l[2],L=Si[p],h=Si[$],W=Si[D],Z=Wq();w===Mp+p?(W(Z,a[ss[D]]),h(Z,a[ss[$]]),L(Z,I),h(Z,-a[ss[$]]),W(Z,-a[ss[D]])):w===Mp+$?(W(Z,a[ss[D]]),h(Z,I),W(Z,-a[ss[D]])):w===Mp+D&&W(Z,I);var O=Nh(G,t);aq(O,Z),_.p3(t[0]+O[0],t[1]+O[1],t[2]+O[2]);var e=_.getRotationMode();Pl(Z,_.r3(),e),u.setFromRotationMatrix(Z,M(e)),_.r3([u.x,u.y,u.z])}}(),syncRotation3d:function(){var q=new kg,B=new qj,k=new Bb;return function(v,s,E){var l=this;if(E[0]!==s[0]||E[1]!==s[1]||E[2]!==s[2]){var h=qj.ReverseOrder(v.getRotationMode());Io.setFromEuler(B.set(E[0],E[1],E[2],h)),q.setFromEuler(B.set(s[0],s[1],s[2],h)),q.multiply(Io.inverse());var C=v.p3(),O=l.p3();k.set(O[0]-C[0],O[1]-C[1],O[2]-C[2]).applyQuaternion(q),l.p3(C[0]+k.x,C[1]+k.y,C[2]+k.z),l.setQuaternion(l.getQuaternion(Io).premultiply(q))}}}(),isHostOn:function(W){var D=this;if(D._host&&W&&W._69O)for(var E={},X=D._host;X&&X!==D&&!E[X._id];){if(X===W)return!0;E[X._id]=X,X=X._host}return!1},isLoopedHostOn:function(Q){return this.isHostOn(Q)&&Q.isHostOn(this)},getScaledSize:function(){var q=this.getSize(),T=this.getScale();return q.width*=Math.abs(T.x),q.height*=Math.abs(T.y),q},layout:function(C){if(C=C||this.getHost()){var m=this,v=m.s("layout.h")||"center",Z=m.s("layout.v")||"center";if("center"!==v||"center"!==Z){var _=new U.Math.Vector2,g=C.getPosition(),J=C.getAnchor(),E=C.getScaledSize();m.getPosition();var B,V,X,S,j,h=1,F=1;switch(m._layoutUpdating=!0,v){case"left":_.setX(m._layoutHValue-J.x*E.width);break;case"right":_.setX((1-J.x)*E.width-m._layoutHValue);break;case"leftright":B=E.width-m._layoutHValue[2],X=m.getRotation()-C.getRotation(),S=Math.abs(Math.sin(X)),j=Math.abs(Math.cos(X)),h+=j*B/m._layoutHValue[3],F+=S*B/m._layoutHValue[4],_.setX(m._layoutHValue[1]+(m._layoutHValue[5]-J.x)*E.width);break;case"center":_.setX((.5-J.x)*E.width-m._layoutHValue);break;case"scale":X=m.getRotation()-C.getRotation(),S=Math.abs(Math.sin(X)),j=Math.abs(Math.cos(X)),_.setX((.5-J.x)*E.width-m._layoutHValue[1]*E.width/m._layoutHValue[0]),V=E.width/m._layoutHValue[2]-1,h+=j*V,F+=S*V}switch(Z){case"top":_.setY(m._layoutVValue-J.y*E.height);break;case"bottom":_.setY((1-J.y)*E.height-m._layoutVValue);break;case"topbottom":X||(X=m.getRotation()-C.getRotation(),S=Math.abs(Math.sin(X)),j=Math.abs(Math.cos(X))),B=E.height-m._layoutVValue[2],h+=S*B/m._layoutVValue[3],F+=j*B/m._layoutVValue[4],_.setY(m._layoutVValue[1]+(m._layoutVValue[5]-J.y)*E.height);break;case"center":_.setY((.5-J.y)*E.height-m._layoutVValue);break;case"scale":X||(X=m.getRotation()-C.getRotation(),S=Math.abs(Math.sin(X)),j=Math.abs(Math.cos(X))),_.setY((.5-J.y)*E.height-m._layoutVValue[1]*E.height/m._layoutVValue[0]),V=E.height/m._layoutVValue[2]-1,h+=S*V,F+=j*V}if("leftright"===v||"scale"===v||"topbottom"===Z||"scale"===Z){var k=this.getScale(),l=Math.abs(k.x),b=Math.abs(k.y);"leftright"===v||"scale"===v?m.setSize(m._layoutHValue[3]*h/l,m._layoutHValue[4]*F/b):m.setSize(m._layoutVValue[3]*h/l,m._layoutVValue[4]*F/b)}_.rotateAround(null,C.getRotation()),this.setPosition(_.x+g.x,_.y+g.y),m._layoutUpdating=s}}},updateLayoutParameters:function(s,n){if(s=s||this.getHost()){var e=this,u=e.s("layout.h"),Q=e.s("layout.v");if(u||Q){var r,H,l,S,F,h,t=new U.Math.Vector2,R=s.getPosition(),O=s.getAnchor(),q=s.getScaledSize(),T=e.getPosition(),W=e.getScaledSize();switch(t.set(T.x-R.x,T.y-R.y),t.rotateAround(null,-s.getRotation()),u){case"left":e._layoutHValue=t.x+O.x*q.width;break;case"right":e._layoutHValue=-t.x+(1-O.x)*q.width;break;case"center":e._layoutHValue=-t.x+(.5-O.x)*q.width;break;case"leftright":case"scale":"scale"===u?r=-t.x+(.5-O.x)*q.width:(H=e.getAnchor(),l=e.getRotation()-s.getRotation(),S=Math.cos(l),F=Math.sin(l),h=-Math.min(-H.x*S+H.y*F,-H.x*S-(1-H.y)*F,(1-H.x)*S+H.y*F,(1-H.x)*S-(1-H.y)*F),r=t.x-(h-O.x)*q.width),"position"===n&&"object"==typeof e._layoutHValue?(e._layoutHValue[0]=q.width,e._layoutHValue[1]=r):e._layoutHValue=[q.width,r,q.width,W.width,W.height,h]}switch(Q){case"top":e._layoutVValue=t.y+O.y*q.height;break;case"bottom":e._layoutVValue=-t.y+(1-O.y)*q.height;break;case"center":e._layoutVValue=-t.y+(.5-O.y)*q.height;break;case"topbottom":case"scale":"scale"===Q?r=-t.y+(.5-O.y)*q.height:(l||(H=e.getAnchor(),l=e.getRotation()-s.getRotation(),S=Math.cos(l),F=Math.sin(l)),h=-Math.min(-H.x*F-H.y*S,-H.x*F+(1-H.y)*S,(1-H.x)*F-H.y*S,(1-H.x)*F+(1-H.y)*S),r=t.y-(h-O.y)*q.height),"position"===n&&"object"==typeof e._layoutVValue?(e._layoutVValue[0]=q.height,e._layoutVValue[1]=r):e._layoutVValue=[q.height,r,q.height,W.width,W.height,h]}}}},getSerializableProperties:function(){var t=rk.superClass.getSerializableProperties.call(this);return oi(t,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),t}});var dj=U.Edge=function(H,L){var t=this;$e(dj,t),t.setSource(H),t.setTarget(L)};jn("Edge",Zc,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return cc},_22Q:function(){return bt},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(Z){if(Z===this)return!1;if(Ob(Z))return!0;for(var n,T,I,D,b,w=[this],g=-1,F=0;F>g;)if(g++,n=w[g],T=n._44I)for(T=T.getArray(),D=0,b=T.length;b>D;D++)if(I=T[D],hg(I)&&!(w.indexOf(I)>=0)){if(I===Z)return!1;w.push(I),F++}return!0},setSource:function(y){var i=this;if(i._source!==y&&i.canSetSourceTarget(y)){var S=i._source;i._source=y,S&&S._16I(i),y&&y._2I(i),i._7I(),i.fp("source",S,y)}},setTarget:function(P){var $=this;if($._target!==P&&$.canSetSourceTarget(P)){var x=$._target;$._target=P,x&&x._18I($),P&&P._4I($),$._7I(),$.fp("target",x,P)}},isLooped:function(){var H=this;return H._source===H._target&&Ob(H._source)&&Ob(H._target)},onPropertyChanged:function(){var q=this;q._49I&&q._49I.each(function(p){p.fp("agentChange",!0,!1)})},_7I:function(){var Q,M=this,W=Wf(M);M._40I!==W&&(Q=this._40I,Q&&Q._15I(M),M._40I=W,W&&W._1I(M),M.fp("sourceAgent",Q,W),Fi(Q,M._41I),Fi(W,M._41I));var r=Eh(M);M._41I!==r&&(Q=M._41I,Q&&Q._17I(M),M._41I=r,r&&r._3I(M),M.fp("targetAgent",Q,r),Fi(Q,M._40I),Fi(r,M._40I))},_22I:function(x){this._52I=x,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var c=this;return c._52I&&c._52I.get(0)!==c&&!c.getStyle(Ie)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var f=this,S=f._52I;return S&&!f.getStyle(Ie)&&S.size()>1&&f===S.get(0)},toggle:function(){this.beginTransaction();var $=this._52I,n=!this.s(Ie);$&&$.size()>1&&($.each(function(k){k.s(Ie,n)}),$.getSiblings().each(function(V){V!==$&&V.each(function(A){A.fp("edgeGroup",g,V)})})),this.endTransaction()},setStyle:function(r,B){(r===sm||"edge.segments"===r)&&(B=Je(B)),dj.superClass.setStyle.call(this,r,B)},onStyleChanged:function(l){dj.superClass.onStyleChanged.apply(this,arguments),we[l]&&Fi(this._41I,this._40I)},getSerializableProperties:function(){var Y=dj.superClass.getSerializableProperties.call(this);return oi(Y,{source:1,target:1}),Y}});var Ir=U.Group=function(){$e(Ir,this)};jn("Group",rk,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return mb},onChildAdded:function(){Ir.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){Ir.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var z=this;if(!z._54I&&!cf){var F=z.getChildrenRect();F&&(z._53I=1,z.p(xm(z.s("group.position"),F,z.getSize())),delete z._53I)}},getChildrenRect:function(){var N,w=this;return w.eachChild(function(i){Ob(i)&&(N=to(N,w.getChildRect(i)))}),N},getChildRect:function(e){var Z;return Ob(e)&&e.s(qn)&&(Mn(e)&&e.isExpanded()&&e.eachChild(function(P){Z=to(Z,e.getChildRect(P))}),!Z&&e.getRect&&(Z=e.getRect())),Z},setPosition:function(p,$){var S=this;if(!S._54I){var G;G=2===arguments.length?{x:p,y:$}:p,cf||S._53I||(S._54I=1,qm(S._children,G.x-S._position.x,G.y-S._position.y),delete S._54I),Ir.superClass.setPosition.call(this,G)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(s){var c=this;if(c._57O!==s){var S=c._57O;c._57O=s,c.fp("expanded",S,c._57O),c._fireInvalidateDeep(),c._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(q){Mn(q)?q._fireInvalidateDeep():q.iv()})},_8I:function(){Ir.superClass._8I.call(this),this.eachChild(function(r){Ob(r)&&r._8I()})},onStyleChanged:function(N){Ir.superClass.onStyleChanged.apply(this,arguments),"group.position"===N&&this._81I()},getSerializableProperties:function(){var X=Ir.superClass.getSerializableProperties.call(this);return X.expanded=1,X}});var Zk=U.Camera=function(){$e(Zk,this),this.s({"shadow.cast":!1,"shadow.receive":!1,shape3d:"billboard"}),this._viewMatrix=new fo.Matrix4,this._projectMatrix=new fo.Matrix4,this.setScale3d(1,1,-1),this.setCullingMask("main,top"),this._projectMatrixDirty=!0};Zk.CubeDirectionParam=[1,0,0,0,-1,0,-1,0,0,0,-1,0,0,1,0,0,0,1,0,-1,0,0,0,-1,0,0,1,0,-1,0,0,0,-1,0,-1,0],jn("Camera",rk,{_22Q:function(){return Camera3dUI},attachRenderTarget:function(E){this._projectMatrixDirty=!0,this.renderTarget=E},detachRenderTarget:function(){this._projectMatrixDirty=!0,this.renderTarget=null},setCullingMask:function(B){var y=B.split(",");this._cullingMask=di(y)},isLayerVisible:function(d){var c=wk[d];return c&&yl(this._cullingMask,c.mask)},isOrtho:function(){return"ortho"===this.s("camera.type")&&!this.isCube()},isCube:function(){return this.renderTarget&&this.renderTarget.isCube()},isPerspective:function(){return!this.isOrtho()},setViewMatrix:function(){var w=new U.Math.Matrix4,J=new U.Math.Euler;return function(i){var k=this;i.isMatrix4?k._viewMatrix.copy(i):k._viewMatrix.fromArray(i),w.getInverse(k._viewMatrix),k.p3(w.getPosition().toArray()),J.set(0,0,0,k.getRotationMode(),!0).setFromRotationMatrix(w),k.r3([J.x,J.y,J.z])}}(),getViewMatrix:function(z){var Q=this,B=wi(null,null,Q.r3(),Q.getRotationMode(),Q.p3()),$=Q._viewMatrix;return $.fromArray(B).getInverse($),$.toArray(z)},setProjectMatrix:function(n){var Z=this;n.isMatrix4?Z._projectMatrix.copy(n):Z._projectMatrix.fromArray(n),n=Z._projectMatrix.getElements(),Z.isOrtho()?Z.s({"camera.near":(n[14]+1)/n[10],"camera.far":(n[14]-1)/n[10],"camera.ortho.width":2/n[0]}):Z.s({"camera.near":n[14]/(n[10]-1),"camera.far":n[14]/(n[10]+1),"camera.fovy":2*Math.atan(1/n[5]),"camera.aspect":n[5]/n[0]}),Z._projectMatrixDirty=!1},onPropertyChanged:function(V){var u=this;Zk.superClass.onPropertyChanged.call(u,V);var d=V.property;("s:camera.near"===d||"s:camera.far"===d||"s:camera.fovy"===d||"s:camera.aspect"===d||"s:camera.ortho.width"===d)&&(u._projectMatrixDirty=!0)},getProjectMatrix:function(){var B=this;if(B._projectMatrixDirty){var Y=B.gv,I=B.isCube(),G=I?1:B.s("camera.aspect")||(Y?Y.getAspect():null)||p.graph3dViewAspect,O=B.s("camera.near")||(Y?Y.getNear():null)||p.graph3dViewNear,S=B.s("camera.far")||(Y?Y.getFar():null)||p.graph3dViewFar,n=Wq();if(B.isOrtho()){var K=B.s("camera.ortho.width")||(Y?Y.getOrthoWidth():null)||p.graph3dViewOrthoWidth,i=K/2,l=i/G;us(n,-i,i,-l,l,O,S)}else{var w=I?Math.PI/2:B.s("camera.fovy")||(Y?Y.getFovy():null)||p.graph3dViewFovy;ls(n,w,G,O,S)}B._projectMatrix.fromArray(n),B._projectMatrixDirty=!1}return B._projectMatrix.toArray()},lookAt:function(z,B){var l=this.p3();return z.x?this.lookAtDirection([z.x-l[0],z.y-l[1],z.z-l[2]],B):this.lookAtDirection([z[0]-l[0],z[1]-l[1],z[2]-l[2]],B)},lookAtDirection:function(){var v=new U.Math.Matrix4,n=new U.Math.Euler,t=new U.Math.Vector3,y=new U.Math.Vector3;return function(D,i){v.lookAtDirection(t.copy(D).multiplyScalar(-1),i?y.copy(i):y.set(0,1,0)),n.set(0,0,0,this.getRotationMode(),!0).setFromRotationMatrix(v),this.r3([n.x,n.y,n.z])}}(),render:function(T){var z=this,i=T.getGL();if(!i)return!1;var E,t,m=z.renderTarget;if(m)E=m.width,t=m.height;else{var a=T.getDevicePixelRatio();E=T.getWidth()*a,t=T.getHeight()*a}z.gv=T,T._camera=z;var C=T._frameState.renderState.glState,R=C.color.clear.slice(0);Un(i,z.s("camera.background"));var V=T.getEye;if(T.getEye=function(){return z.p3()},z.isCube())for(var c=Zk.CubeDirectionParam,P=0;6>P;P++)m&&m.bind(i,P),z.lookAtDirection([c[6*P+0],c[6*P+1],c[6*P+2]],[c[6*P+3],c[6*P+4],c[6*P+5]]),i.clear(i.COLOR_BUFFER_BIT),T.setViewport(i,0,0,E,t),z.s("camera.onlySky")?T.renderSky():T.renderScene({renderAxis:z.s("camera.renderAxis"),renderGrid:z.s("camera.renderGrid"),renderEdit:z.s("camera.renderEdit"),renderReflector:!1}),m&&m.unbind(i);else m&&m.bind(i),i.clear(i.COLOR_BUFFER_BIT),T.overlappingBox.clear(),T.setViewport(i,0,0,E,t),z.s("camera.onlySky")?T.renderSky():T.renderScene({renderAxis:z.s("camera.renderAxis"),renderGrid:z.s("camera.renderGrid"),renderEdit:z.s("camera.renderEdit")}),m&&m.unbind(i);return T.getEye=V,Un(i,R),T._camera=null,z.gv=null,!0}});var vc=U.Block=function(){$e(vc,this),this.s({"shadow.cast":!1,"shadow.receive":!1})};jn("Block",rk,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return dl},_22Q:function(){return at},onChildAdded:function(){vc.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){vc.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:function(){function Y(G,R,$){K.fromArray(Ph(R));var P=R.getAnchor3d();G.push((new Bb).set(0-P.x,0-P.y,0-P.z).applyMatrix4(K).applyMatrix4($)),G.push((new Bb).set(0-P.x,0-P.y,1-P.z).applyMatrix4(K).applyMatrix4($)),G.push((new Bb).set(0-P.x,1-P.y,0-P.z).applyMatrix4(K).applyMatrix4($)),G.push((new Bb).set(0-P.x,1-P.y,1-P.z).applyMatrix4(K).applyMatrix4($)),G.push((new Bb).set(1-P.x,0-P.y,0-P.z).applyMatrix4(K).applyMatrix4($)),G.push((new Bb).set(1-P.x,0-P.y,1-P.z).applyMatrix4(K).applyMatrix4($)),G.push((new Bb).set(1-P.x,1-P.y,0-P.z).applyMatrix4(K).applyMatrix4($)),G.push((new Bb).set(1-P.x,1-P.y,1-P.z).applyMatrix4(K).applyMatrix4($))}function s(Q,j){var u=(new cr).makeRotationFromEuler(this.getEuler()).setPosition((new Bb).fromArray(this.p3()));u.getInverse(u),Q.forEach(function(L){Ob(L)&&Y(j,L,u)})}var K=new cr;return function(U,k){if(U instanceof rk&&(U=[U]),!U||0===U.length)return g;var k=[];s.call(this,U,k);var X=[1/0,1/0,1/0],L=[-1/0,-1/0,-1/0];return k.forEach(function(t){X[0]=Math.min(t.x,X[0]),X[1]=Math.min(t.y,X[1]),X[2]=Math.min(t.z,X[2]),L[0]=Math.max(t.x,L[0]),L[1]=Math.max(t.y,L[1]),L[2]=Math.max(t.z,L[2])}),{min:X,max:L}}}(),updateFromChildren:function(){var i=this;if(!cf&&!i._updatingToChildren&&i._syncSize&&0!==i.size()&&!i._freezeSyncFromChildren){var E=this._getBoundingBox(i.toChildren(Ob));if(E){i._updatingFromChildren=1;var Z=(new Bb).fromArray(this.getScale3d()),s=(new Bb).fromArray(E.min),H=(new Bb).fromArray(E.max),R=p.blockMinSize,d=new Bb,G=H.clone().sub(s);0===G.x&&d.setX(.5),0===G.y&&d.setY(.5),0===G.z&&d.setZ(.5);var b=this._width==g||-1===this._width,F=new Bb(this.getAnchor3d()),f=Z.clone().multiply((new Bb).fromArray(this.s3())),h=G.clone();0===h.x&&h.setX(R),0===h.y&&h.setY(R),0===h.z&&h.setZ(R);var k=F.clone().multiply(f),$=k.clone().multiplyScalar(-1).sub(s).divide(h).add(k.divide(h)).add(d),S=this.s("keepPosition");if(b||this._anchorChanged||this._scaleChanged||!S){!b&&S&&(F=$);var M=F.clone().multiply(G).add(s).applyEuler(this.getEuler()).add((new Bb).fromArray(this.p3()));this.p3([M.x,M.y,M.z])}else this.setAnchor3d($.x,$.y,$.z);var l=new Bb(1,1,1).divide(Z).multiply(G);this.s3(Math.abs(l.x),Math.abs(l.y),Math.abs(l.z)),delete i._updatingFromChildren}}},setPosition:function(Q,W){var q=this;if(!q._updatingToChildren){var t;t=2===arguments.length?{x:Q,y:W}:Q,cf||q._updatingFromChildren||(q._updatingToChildren=1,qm(q._children,t.x-q._position.x,t.y-q._position.y),delete q._updatingToChildren),vc.superClass.setPosition.call(this,t)}},setSize3d:function(){this.beginTransaction(),vc.superClass.setSize3d.apply(this,arguments),this.endTransaction()},setTall:function(A){var V=this;if(!V._updatingToChildren){this.beginTransaction(),A=N(A,p.blockMinSize);var i=V.getTall();if(A!==i&&vc.superClass.setTall.call(V,A),!cf&&!V._updatingFromChildren){V._updatingToChildren=1;var H=A/i;V._adjustChildTallOrScale(H,"size"),delete V._updatingToChildren,V.updateFromChildren()
}this.endTransaction()}},setWidth:function(q){return this.setSize(q,this.getHeight())},setHeight:function(t){return this.setSize(this.getWidth(),t)},setSize:function(a,s){var D=p.blockMinSize;a=N(a,D),s=N(s,D);var W=this;if(!W._updatingToChildren){2!==arguments.length&&(s=a.height,a=a.width),this.beginTransaction();var Y=W.getWidth(),f=W.getHeight();if(a!==Y&&vc.superClass.setWidth.call(W,a),s!==f&&vc.superClass.setHeight.call(W,s),!cf&&!W._updatingFromChildren){W._updatingToChildren=1;var I=a/Y,B=s/f;W._adjustChildScaleOrSize(I,B,"size"),delete W._updatingToChildren,W.updateFromChildren()}this.endTransaction()}},_adjustChildScaleOrSize:function(C,r,K){var I=this;if(I._syncSize){var G=I.getPosition(),F=I.getRotation();I.eachChild(function(H){if(Ob(H)){var o=H.getPosition(),S=H.getRotation(),b=H.getWidth(),c=H.getHeight(),D=H.getScale(),B=D.x*b,Z=D.y*c;if(0!==B&&0!==Z){0>C*r&&H.setRotation(-1*S);var q=new Tc(S,o.x,o.y,B,Z);q.translate(-G.x,-G.y),q.rotate(-F),S=xb(q.b*Math.sign(B),q.a*Math.sign(B)),q.scale(C,r);var y,i,Q,O=W(S);if(Math.abs(O)<.001?(y=_(S),i=q.b/y,Q=-q.c/y):(i=q.a/O,Q=q.d/O),"scale"===K)H.setScale(i/b,Q/c);else if("size"===K){var k=i/D.x,J=Q/D.y;H.setScale(Mr(i)*Math.abs(D.x),Mr(Q)*Math.abs(D.y)),H instanceof U.Shape?(H.setWidthForce(Math.max(Math.abs(k),1e-5)),H.setHeightForce(Math.max(Math.abs(J),1e-5))):H.setSize(Math.max(.01,Math.abs(k)),Math.max(.01,Math.abs(J)))}q.rotate(F),q.translate(G.x,G.y),H.setPosition(q.tx,q.ty)}}})}},_calcChangeFactor:function(X,o,I,m){var S,T,Q,s;return S=B(X),T=B(I),Q=S>T?S/T:T/S,S=B(o),T=B(m),s=S>T?S/T:T/S,N(Q,s)},setElevation:function(m){var I=this;if(!I._updatingToChildren){var Z=I.getElevation(),t=m-Z;0!==t&&(cf||I._updatingFromChildren||(I._updatingToChildren=1,qm(I._children,0,t,0),delete I._updatingToChildren),vc.superClass.setElevation.apply(I,arguments))}},setScaleTall:function(C){var t=this;if(!t._updatingToChildren){var s=t.getScaleTall();if(B(C)<.01&&(C=.01*(Mr(C)||Mr(s))),vc.superClass.setScaleTall.call(t,C),!cf&&!t._updatingFromChildren){t._updatingToChildren=1;var u=C/s;t._adjustChildTallOrScale(u,"scale"),delete t._updatingToChildren,t._scaleChanged=1,this.updateFromChildren(),delete t._scaleChanged}}},_adjustChildTallOrScale:function(x,Y){var p=this;if(p._syncSize){var Z=p.getElevation();p.eachChild(function(T){if(Ob(T)){if("size"===Y){var I=T.getTall();0>x&&T.setScaleTall(-1*T.getScaleTall()),T.setTall(Math.max(.01,Math.abs(I*x)))}else{var g=T.getScaleTall();T.setScaleTall(g*x)}T.setElevation(Z+(T.getElevation()-Z)*x)}})}},setAnchor3d:function(){if(!this._updatingToChildren){this.beginTransaction();var T=vc.superClass.setAnchor3d.apply(this,arguments);return T&&!cf&&!this._updatingFromChildren&&this._syncSize&&(this._anchorChanged=1,this.updateFromChildren(),delete this._anchorChanged),this.endTransaction(),T}},setAnchor:function(){var v=this;if(!v._updatingToChildren){var o=v.getAnchor(),X=vc.superClass.setAnchor.apply(v,arguments);if(cf||v._updatingFromChildren||!v._syncSize)return X;v._updatingToChildren=1;var p=v.getAnchor();v.getPosition();var c=v.getSize(),M=v.getScale(),Y=v.getRotation(),R=-c.width*M.x*(o.x-p.x),q=-c.height*M.y*(o.y-p.y),U=_(Y),L=W(Y),j=L*R-U*q,b=U*R+L*q;return v.eachChild(function(w){if(Ob(w)){var Y=w.getPosition();w.setPosition(Y.x-j,Y.y-b)}}),delete v._updatingToChildren,X}},setAnchorElevation:function(){var p=this;if(!p._updatingToChildren){var r=p.getAnchorElevation(),q=vc.superClass.setAnchorElevation.apply(p,arguments);if(cf||p._updatingFromChildren||!p._syncSize)return q;p._updatingToChildren=1;var o=p.getAnchorElevation(),G=p.getTall(),z=p.getScaleTall(),K=-G*z*(r-o);return p.eachChild(function(e){if(Ob(e)){var b=e.getElevation();e.setElevation(b-K)}}),delete p._updatingToChildren,q}},setRotation:function(U){this._updateChildrenRotation3d("rotation",U)},setRotationX:function(G){this._updateChildrenRotation3d("rotationX",G)},setRotationZ:function(d){this._updateChildrenRotation3d("rotationZ",d)},setRotation3d:function(){var T=this;if(!T._updatingToChildren){var p=T.r3();vc.superClass.setRotation3d.apply(T,arguments);var C=T.r3();cf||T._updatingFromChildren||(T._updatingToChildren=1,T.eachChild(function(L){Ob(L)&&L.syncRotation3d(T,C,p)}),delete T._updatingToChildren)}},_updateChildrenRotation3d:function(R,s){var A=this;if(!A._updatingToChildren){var m=A[wd(R)]();vc.superClass[mp(R)].call(A,s),cf||A._updatingFromChildren||this._updateRotationToChildren(R,s-m)}},_updateRotationToChildren:function(I,R){var l=this;l._updatingToChildren=1,l.eachChild(function(C){Ob(C)&&C._11Q(l,I,R)}),delete l._updatingToChildren},setScale:function(E,K){var $=this;if(!$._updatingToChildren){null==K&&(K=E.y,E=E.x);var e=$.getScale();if(B(E)<.01&&(E=.01*(Mr(E)||Mr(e.x))),B(K)<.01&&(K=.01*(Mr(K)||Mr(e.y))),vc.superClass.setScale.call($,E,K),!cf&&!$._updatingFromChildren){$._updatingToChildren=1;var V=E/e.x,L=K/e.y;$._adjustChildScaleOrSize(V,L,"scale"),delete $._updatingToChildren,$._scaleChanged=1,$.updateFromChildren(),delete $._scaleChanged}}},onPropertyChanged:function(k){vc.superClass.onPropertyChanged.call(this,k),"s:3d.visible"===k.property&&this._invalidateChildrenBatch()},_invalidateChildrenBatch:function(){this.eachChild(function(m){(m.s("batch")||m.s("wf.geometry")||m.s("wf.visible"))&&m.iv(),m instanceof vc&&m._invalidateChildrenBatch()})},getSerializableProperties:function(){var S=vc.superClass.getSerializableProperties.call(this);return S.clickThroughEnabled=1,S.syncSize=1,S}});var xi=U.Grid=function(){$e(U.Grid,this)};jn("Grid",rk,{IRotatable:!1,_icon:"grid_icon",_image:g,getUIClass:function(){return xe},setRotation:function(){},getCellRect:function(b,Y){var L=this,A=L.s("grid.row.count"),S=L.s("grid.column.count");if(0>=A||0>=S||0>b||b>=A||0>Y||Y>=S)return g;var p,w,r,k=L.getRect(),G=L.s("grid.row.percents"),W=L.s("grid.column.percents");if(ek(k,L,"grid.border",-1),G&&G._as&&(G=G._as),W&&W._as&&(W=W._as),G&&G.length===A){for(r=0,p=0;b>p;p++)r+=k.height*G[p];k.y+=r,k.height=k.height*G[b]}else k.height=k.height/A,k.y+=k.height*b;if(W&&W.length===S){for(w=0,p=0;Y>p;p++)w+=k.width*W[p];k.x+=w,k.width=k.width*W[Y]}else k.width=k.width/S,k.x+=k.width*Y;return ff(k,-L.s("grid.gap")),k}});var Aj=U.Text=function(){$e(Aj,this),this.setSize(100,50),this.s("text","TEXT")};jn("Text",rk,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Dj},setWidth:function(R){R||(R=.001),Aj.superClass.setWidth.call(this,R)},setHeight:function($){$||($=.001),Aj.superClass.setHeight.call(this,$)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),gk("__text__",{width:{value:100,isSafeFunc:!0,func:function(c){return c?c._width:100}},height:{value:50,isSafeFunc:!0,func:function(L){return L?L._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"},gradient:{func:"style@text.gradient"},gradientColor:{func:"style@text.gradient.color"},gradientPack:{func:"style@text.gradient.pack"},decoration:{func:"style@text.decoration"},vertical:{func:"style@text.vertical"},verticalGap:{func:"style@text.vertical.gap"},wrap:{func:"style@text.wrap"},letterGap:{func:"style@text.letter.gap"},borderWidth:{func:"style@text.border.width"},borderColor:{func:"style@text.border.color"}}]});var Uj=U.Shape=function(){$e(Uj,this),this._59O=new Yn};Uj.__de__=Qr,jn("Shape",rk,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return De},_22Q:function(){return ct},getLength:function(R){return ud(Ok(this._59O,this._58O,R,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var q=this._58O;return q?new Yn(q._as.slice(0)):q},setSegments:function(C){var A=this._58O;C=C?Vd(C)?new Yn(C.slice(0)):new Yn(C._as.slice(0)):null,(A&&C&&A._as.join(",")!==C._as.join(",")||A!==C)&&(this._58O=C,this.fp("segments",A,C))},getPoints:function(){return this._59O},toPoints:function(){var u=this._59O;return new Yn(u._as.slice(0))},getPointsMatrix2d:function(){var f=this,h=new fo.Matrix2d,z=f.getPosition(),R=f.getScale(),n=f.getRotation();return h.translate(-z.x,-z.y).scale(R.x,R.y).rotate(n).translate(z.x,z.y),h},getPointsMatrix3d:function(){return function(){var f=this,W=new fo.Matrix4,U=W.getElements(),z=f.p3();Lj(U,z),Pl(U,f.getFinalRotation3d(),f.getRotationMode());var V=f.getScale3d(),t=f._dynamicScale3d;return t&&(V[0]*=t[0],V[1]*=t[1],V[2]*=t[2]),Ng(U,V),Lj(U,zl(z)),W}}(),setPoints:function(q,a){var G=this,O=G._59O;q=q?Vd(q)?new Yn(q.slice(0)):new Yn(q._as.slice(0)):new Yn;var u,C,d,Q,F,I;a&&(u=G.getPosition(),I=new Tc(G.getRotation(),0,0,G.getScale().x,G.getScale().y)),(O&&q&&O._as.join(",")!==q._as.join(",")||O!==q)&&(G._59O=q,G.fs(),G.fp("points",O,q)),a&&(C=G.getPosition(),d=C.x-u.x,Q=C.y-u.y,F=I.tf(d,Q),G.setPosition(C.x-d+F.x,C.y-Q+F.y))},setPoints3d:function(c,N){var x=new Bb(this.p3()),Y=this.getPointsMatrix3d();if(Y.setPosition(new Bb),ao.superClass.setPoints.call(this,c),N){var g=new Bb(this.p3()),T=g.clone().sub(x).applyMatrix4(Y);x.add(T),this.p3(x.x,x.y,x.z)}},addPoint:function(V,$,h){var A=this.toPoints();A.add(V,$),this.setPoints(A,h)},setPoint:function(Z,B,R){var f=this.toPoints();f.set(Z,B),this.setPoints(f,R)},removePointAt:function(d){var p=this.toPoints();p.removeAt(d),this.setPoints(p)},setWidthForce:function(S){var c=this;if(!c._55I&&!cf&&c.getWidth()){c._55I=1;var $=c._position.x,a=S/c.getWidth(),L=c.toPoints(),X=new Yn;1!==a&&(L.each(function(O){X.add({x:(O.x-$)*a+$,y:O.y,e:O.e})}),c.setPoints(X),Te(c,[a,0,0,1,$*(1-a),0]),c.fs()),delete c._55I}Uj.superClass.setWidth.call(c,S)},setWidth:function(C){return this.setWidthForce(bn>C?bn:C)},setHeightForce:function(t){var o=this;if(!o._55I&&!cf&&o.getHeight()){o._55I=1;var s=o._position.y,J=t/o.getHeight(),m=o.toPoints(),Z=new Yn;1!==J&&(m.each(function(P){Z.add({x:P.x,y:(P.y-s)*J+s,e:P.e})}),o.setPoints(Z),Te(o,[1,0,0,J,0,s*(1-J)]),o.fs()),delete o._55I}Uj.superClass.setHeight.call(o,t)},setHeight:function(v){return this.setHeightForce(bn>v?bn:v)},setAnchorElevation:function($){var j=this;j._55I=!0;var y=j._updatingAnchor3d,H=!cf&&!y;if(H){var v,U=$,w=j.getAnchorElevation(),S=j.getTall();v=S*(w-U),0!==v&&j.shiftPointsElevation(v)}var f=Uj.superClass.setAnchorElevation.apply(j,arguments);return y||delete j._55I,f},getShapeElevation:function(){var G=this,U=G._54O;return U-(G.getTall()||0)*(G._anchorElevation-.5)},setAnchor3d:function(I,M,m,f){var E,L=this;if("number"==typeof I?E={x:I,y:M,z:m}:(E=I.length?{x:I[0],y:I[1],z:I[2]}:I,f=M),L._55I=!0,L._updatingAnchor3d=!0,L.beginTransaction(),!cf){var r=L.getAnchor3d(),p=L.getSize(),s=L.getTall(),X=p.width*(r.x-E.x),q=p.height*(r.z-E.z),x=s*(r.y-E.y);f||L.shiftPoints(X,q,x);var w=L.p3()}var d=Uj.superClass.setAnchor3d.apply(L,arguments);if(!cf&&f){var D=L.p3();L.shiftPoints(D[0]-w[0]+X,D[2]-w[2]+q,D[1]-w[1]+x)}return L.endTransaction(),delete L._updatingAnchor3d,delete L._55I,d},setAnchor:function(V,T,E){var K=this;K._55I=!0;var m=K._updatingAnchor3d,M=!cf&&!m;if(M){var z,p,w;"number"==typeof V?w={x:V,y:T}:(w=V.length?{x:V[0],y:V[1]}:V,E=T);var q=K.getAnchor(),f=K.getSize();z=f.width*(q.x-w.x),p=f.height*(q.y-w.y),E||K.shiftPoints(z,p);var P=K.getPosition()}var Q=Uj.superClass.setAnchor.apply(K,arguments);if(M){var e=K.getPosition();E&&K.shiftPoints(e.x-P.x+z,e.y-P.y+p)}return m||delete K._55I,Q},shiftPoints:function(u,U,l){if(u||U||l){var p=this,I=p.getElevation()||0,R=p.toPoints(),X=new Yn;R.each(function(x){var k=x.e;l&&(k=(k==g?I:k)+l),X.add({x:x.x+u,y:x.y+U,e:k})}),p.setPoints(X),p.fs()}},shiftPointsElevation:function(E){return this.shiftPoints(0,0,E)},setPosition:function(f,L){var o,J=this;if(!J._28Q){if(J._28Q=1,!J._55I&&!cf){o=2===arguments.length?{x:f,y:L}:f;var d=o.x-J._position.x,R=o.y-J._position.y;if(0===d&&0===R)return delete J._28Q,void 0;J._55I=1,J.shiftPoints(d,R),Te(J,[1,0,0,1,d,R]),delete J._55I}Uj.superClass.setPosition.apply(J,arguments),delete J._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var c=this;if(2!==c._59O.size())return!1;var B=c._58O;return B?2===B.size()&&1===B.get(0)&&2===B.get(1)?!0:!1:!0},fireShapeChange:function(){var $=this;if(!$._55I&&!cf){var j=In($._59O);j&&($._55I=1,$.setRect(j),delete $._55I)}$.fp(pc,!1,!0)},getSerializableProperties:function(){var w=Uj.superClass.getSerializableProperties.call(this);return w.segments=1,w.points=1,w.thickness=1,w.closePath=1,w}});var Ur=U.Points=function(){$e(Ur,this)};jn("Points",rk,{_59O:[],_colors:[],_sizes:[],_uvoffsets:[],_22Q:function(){return dt},getPoints:function(){return this._59O},setPoints:function(J){var L=this._59O;J=J?J.slice(0):[];var w=J[0];if(Jr(w)){var n=J;J=[];for(var c=0,S=n.length;S>c;c+=3)J.push({x:n[c],e:n[c+1],y:n[c+2]})}this._59O=J,this._pointsDirty=!0,this.fp("points",L,this._59O)},setPoint:function(F,g){var v=this._59O.slice(0);v[F]=g,this.setPoints(v)},addPoint:function(H){this.setPoint(this._59O.length,H)},getColors:function(){return this._colors},setColors:function(B){var l=this._colors;B=B?B.slice(0):[],this._colors=B,this._colorsDirty=!0,this.fp("colors",l,B)},setPointColor:function(d,i){var R=this._colors.slice(0);R[d]=i,this.setColors(R)},getSizes:function(){return this._sizes},setSizes:function(N){var Q=this._sizes;N=N?N.slice(0):[],this._sizes=N,this._sizesDirty=!0,this.fp("sizes",Q,this._sizes)},setPointSize:function(j,r){var T=this._sizes.slice(0);T[j]=r,this.setSizes(T)},getUvoffsets:function(){return this._uvoffsets},setUvoffsets:function(r){var T=this._uvoffsets;r=r?r.slice(0):[],this._uvoffsets=r,this._offsetsDirty=!0,this.fp("uvoffsets",T,this._uvoffsets)},setPointUvoffset:function(b,n,z){var d;"object"==typeof n?(d=n[0],z=n[1]):d=n;var v=this._uvoffsets.slice(0);v[2*b+0]=d,v[2*b+1]=z,this.setUvoffsets(v)},getPointInfo:function(z){var L=this.getPoints();if(!L||L[z]==g)return g;var v=L[z],P=[v.x,v.e,v.y],e=this.mat||Ph(this),V=[P[0],P[1],P[2]];aq(V,e);var u=this.getColors(),s=u[z]||this.s("points.color"),W=this.getSizes(),o=W[z];return{size:o==g?this.s("points.size"):o,color:s,local:P,world:V}},getSerializableProperties:function(){var O=Ur.superClass.getSerializableProperties.call(this);return O.points=1,O.colors=1,O.sizes=1,O.uvoffsets=1,O},onPropertyChanged:function(t){Ur.superClass.onPropertyChanged.call(this,t);var V=t.property;"s:points.color"===V?this._colorsDirty=!0:"s:points.size"===V?this._sizesDirty=!0:"s:points.model"===V&&(this._modelDirty=!0)},getWidth:function(){var $=this;if($._width>=0)return $._width;var Y=$.getStyle("points.model");if(Y){var F=Ge(Y);if(F&&F.rawS3)return F.rawS3[0]}return 1},getHeight:function(){var G=this;if(G._height>=0)return G._height;var F=G.getStyle("points.model");if(F){var V=Ge(F);if(V&&V.rawS3)return V.rawS3[2]}return 1},getTall:function(){var B=this;if(B._tall>=0)return B._tall;var s=B.getStyle("points.model");if(s){var y=Ge(s);if(y&&y.rawS3)return y.rawS3[1]}return 1}});var ao=U.Polyline=function(){$e(ao,this),this.s({"shape.background":null,"shape.border.width":2})};jn("Polyline",Uj,{_icon:"polyline_icon",_22Q:function(){return gt},getUIClass:function(){return Fp},setClosePath:function(){},setTall:function(o){var V=this;if(V.beginTransaction(),!V._55I&&!V._24Q&&!cf&&V.getTall()){V._24Q=1;var k=V._54O,M=o/V.getTall();if(1!==M){var z=V.toPoints(),E=new Yn;z.each(function(x){E.add({x:x.x,y:x.y,e:x.e==g?x.e:(x.e-k)*M+k})}),V.setPoints(E),V.fs()}delete V._24Q}ao.superClass.setTall.call(V,o),V.endTransaction()},setElevation:function(g){var s=this;if(s.beginTransaction(),!s._55I&&!s._24Q&&!cf){s._24Q=1;var S=g-s._54O;0!==S&&s.shiftPointsElevation(S),delete s._24Q}ao.superClass.setElevation.apply(s,arguments),s.endTransaction()},fireShapeChange:function(){var W=this,Y=W._59O;if(!W._55I&&!W._24Q&&!cf){var i=Y.size();if(i){var C=1,f=Y.get(0),b=W._54O;f.e==g&&(f.e=b);for(var l=f.e,M=0;i>C;C++){f=Y.get(C),f.e==g&&(f.e=b);var j=Q(l,f.e),I=N(l+M,f.e);l=j,M=I-j}W._24Q=1,W.setTall(M),W.setElevation(l+M*W._anchorElevation),delete W._24Q}}ao.superClass.fireShapeChange.apply(W,arguments)}});var Ti=U.SubGraph=function(){$e(Ti,this)};jn("SubGraph",rk,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Ti.superClass._8I.call(this),this.eachChild(function(j){Ob(j)&&j._8I()})}}),p.loadingRefGraph=0;var ij=U.RefGraph=function(){$e(ij,this)};jn("RefGraph",vc,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(k){var c=this._ref;this._ref=k,this.fp("ref",c,k),this.updateRef()},_21I:function(){ij.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var o=this;if(p.loadingRefGraph++,o.clearChildrenFromDataModel(),p.loadingRefGraph--,o._ref&&o._dataModel){o._xhrLoadHandler&&(o._xhrLoadHandler.cancel=!0);var P=cf,i=o._xhrLoadHandler=function(u){if(u&&o._dataModel){p.loadingRefGraph++;var c=o._pendingUpdateInfo={needToRestore:P};P&&(c.p3=o.p3(),c.s3=o.s3(),c.r3=o.r3(),c.anchor3d=o.getAnchor3d(),c.scale3d=o.getScale3d()),o.r3(0,0,0),o.setScale3d(1,1,1),o.setAnchor3d(.5,.5,.5),o.p3(0,0,0);var B=p.parse(u),x=o._dataModel.deserialize(B,o,{justDatas:!0});x.each(function(_){_._refGraph=o}),o.checkPendingUpdateInfo(),p.loadingRefGraph--,p.handleRefGraphLoaded(o,x,B)}};i.xhrLoadCalled=!1,p.load(o._ref,function(r){i.cancel||(i.xhrLoadCalled?i(r):oq(function(){i(r)}))}),i.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var D=this,q=D._pendingUpdateInfo;if(!q)return D.onPendingUpdated&&(p.loadingRefGraph++,D.onPendingUpdated(),p.loadingRefGraph--),void 0;var $=!0;this.eachChild(function(j){(j._pendingCheckImageJSON||j._pendingUpdateInfo)&&($=!1)}),$&&(p.loadingRefGraph++,D._pendingUpdateInfo=null,D.updateFromChildren(),q.needToRestore&&(D.setAnchor3d(q.anchor3d),D.setScale3d(q.scale3d),D.r3(q.r3),D.p3(q.p3)),this.getParent()instanceof ij&&this.getParent().checkPendingUpdateInfo(),D.onPendingUpdated&&D.onPendingUpdated(),p.loadingRefGraph--)},getSerializableProperties:function(){var k=ij.superClass.getSerializableProperties.call(this);return k.ref=1,k}}),U.EdgeGroup=function(O,b){this._70O=O,this._siblings=b;for(var W,l,B=0,T=O.size(),f=x[Ie];T>B;B++)if(W=O.get(B).getStyle(Ie,!1),W!=g){f=W;break}f==g&&(f=!0);var D=p.edgeGroupAgentFunc;for(D&&(l=D(O),l&&l!==O.get(0)&&(O.remove(l),O.add(l,0))),B=0;T>B;B++)O.get(B).s(Ie,f)},jn("EdgeGroup",z,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(P){return this._70O.get(P)},indexOf:function(B){return this._70O.indexOf(B)},each:function(Y,b){this._70O.each(Y,b)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(A,i){this._siblings.each(function($){$._70O.each(A,i)})}});var ko=function(P,y,g){var H=Wr[P]={type:P,action:y};if(g)for(var u in g)H[u]=g[u]};oi(p,{setConnectAction:ko,getConnectAction:function(T,o){if(!o){if(!T)return null;o=T.getCurrentConnectActionType()}return Wr[o]},doConnectAction:function(S,e,p,R){R=R||S.getCurrentConnectActionType();var x=Wr[R];if(!x)return!1;var F=x.action;return F?(e instanceof Cf.Group?S.sm().getSelection().each(function(E){F.call(null,S,E,p)}):F.call(null,S,e,p),!0):!1},doDeleteConnectionAction:function(t,X,V){V=V||t.getCurrentConnectActionType();var m=Wr[V];if(!m||!m.delete)return!1;var y=m.delete.action;return y?(X instanceof Cf.Group?t.sm().getSelection().each(function(N){y.call(null,t,N)}):y.call(null,t,X),!0):!1}});var tc=U.JSONSerializer=function(Z,d){this.dm=this._dataModel=Z,this._hierarchical=p.forceHierarchicalSerialization?!0:d==g?Z.isHierarchicalRendering():d};jn("JSONSerializer",z,{ms_ac:["hierarchical"],serialize:function(j){return p.stringify(this.toJSON(),j)},toJSON:function(){var A,k=this,M=k.dm,S=M.getRoots(),e=k.json={v:p.getVersion(),p:{},a:{},d:[]},Z=M.getSerializableAttrs();(A=M.getInit())&&(e.init=A),(A=M.getName())&&(e.p.name=A),(A=M.getBackground())&&(e.p.background=A),(A=M.getLayers())&&(e.p.layers=A),(A=M.getEnvmap())&&(e.p.envmap=A),(A=M.getEnvmapType())&&(e.p.envmapType=A),e.p.autoAdjustIndex=M.isAutoAdjustIndex(),e.p.hierarchicalRendering=M.isHierarchicalRendering();for(var W in Z){var g=M.a(W);g!==s&&k[Hl](W,g,e.a)}return Lg(e.a)&&delete e.a,k._hierarchical?S.each(k.serializeData,this):M.each(function(O){k.serializeData(O)}),M.fireSerializeEvent({type:"serialize",json:e}),M.getPostProcessingData()&&(e.p.postProcessingData=M.getPostProcessingData()),e},isSerializable:function(){return!0},getProperties:function(Q){return Q.getSerializableProperties()},getStyles:function(c){return c.getSerializableStyles()},getAttrs:function(r){return r.getSerializableAttrs()},serializeData:function(Y){var c=this;if(c.isSerializable(Y)&&!Y._refGraph){var Q,t,R,b,z=Uf(Y.getClassName())||Y.getClass(),E=new z,I={c:Y.getClassName(),i:Y.getId(),p:{},s:{},a:{}};c.json.d.push(I),Q=c.getProperties(Y);for(t in Q)if(/^_/.test(t)){if(R=Y[t],!("_width"!==t&&"_height"!==t||R!=g&&-1!==R)){var m;((Y.s("layout.h")||Y.s("layout.v"))&&Y.getHost()||Y instanceof U.Node&&(m=Y.getParent())&&m instanceof U.Block||Y.s("fullscreen"))&&(R=Y[t]="_width"===t?Y.getWidth():Y.getHeight())}R!==E[t]&&c[Hl](t.substr(1),R,I.p)}else b=wd(t),Y[b]&&(R=Y[b](),R!==E[b]()&&c[Hl](t,R,I.p));Q=c.getStyles(Y);for(t in Q)R=Y.s(t),R!==E.s(t)&&c[Hl](t,R,I.s);Q=c.getAttrs(Y);for(t in Q)R=Y.a(t),R!==E.a(t)&&c[Hl](t,R,I.a);Lg(I.p)&&delete I.p,Lg(I.s)&&delete I.s,Lg(I.a)&&delete I.a}c._hierarchical&&Y.getChildren().each(c.serializeData,c)},serializeValue:function(M,H,j){Qq(H)?H={__a:H._as}:H instanceof Zc?H={__i:H.getId()}:H instanceof _m&&(H={__dm:H.serialize(0)}),j[M]=H},deserialize:function($,S,D){var B=this;return Xj($)&&/.json$/.test($)?(p.xhrLoad($,function(Q){B.deserializeImpl(Q,S,D)}),void 0):B.deserializeImpl($,S,D)},deserializeImpl:function(N,Z,X){var e=this,Y=e.dm;Y.setDeserializing(!0),X=Tg(X)?{setId:X}:qr(X)?{finishFunc:X}:X||{},N=e.json=Xj(N)?p.parse(N):N,!X.justDatas&&N.a&&N.a.onPreDeserialize&&!X.disableOnPreDeserialize&&N.a.onPreDeserialize(N,Y,X.view),Y.beginTransaction(),cf++,e._82I={};var c=new Yn,Q=new Yn,i=0,D=N.d.length;if(X.justDatas||(!X.disableInit&&qr(N.init)&&N.init(Y),Y.setInit(N.init)),!X.justDatas){for(var t in N.a)Y.a(t,e[db](N.a[t]));for(var l in N.p)Y[mp(l)](N.p[l])}for(;D>i;i++){var B=N.d[i],O=Uf(B.c),V=new O,v=B.i;X.setId&&v!=g&&(V._id=v),e._82I[v]=V,c.add(V),Q.add(B)}for(i=0;D>i;i++)e.deserializeData(c.get(i),Q.get(i));return c.each(function(E){Z&&!E.getParent()&&E.setParent(Z),Y.add(E)}),X.__innerHandler__&&X.__innerHandler__(N,Y,X.view,c),Y.fireSerializeEvent({type:"deserialize",json:N}),cf--,Y.endTransaction(),!X.justDatas&&N.a&&N.a.onPostDeserialize&&!X.disableOnPostDeserialize&&N.a.onPostDeserialize(N,Y,X.view,c),X.finishFunc&&X.finishFunc(N,Y,X.view,c),Y.setDeserializing(!1),c},deserializeData:function(i,c){for(var I in c.p)i[mp(I)](this[db](c.p[I]));for(I in c.s)i.s(I,this[db](c.s[I]));for(I in c.a)i.a(I,this[db](c.a[I]))},deserializeValue:function(V){if(Np(V)){var y=V.__i;if(y!=g)return this._82I[y];if(y=V.__dm,y!=g){var F=new U.DataModel;return F.deserialize(y),F}if(y=V.__a,Vd(y))return new Yn(y)}return V}}),oi(_m,{serialize:function(A,q){return new tc(this,q).serialize(A)},toJSON:function(y){return new tc(this,y).toJSON()},deserialize:function(A,U,z){return new tc(this).deserialize(A,U,z)}});var nk=U.OverlappingBox=function(l){this.gv=l,this.boxes={}};jn("OverlappingBox",z,{clear:function(){var U,A,H=this.boxes;for(U in H)A=H[U],A.length=0},isOverlapping:function(b,T){var u,B,R=this,K=R.boxes,H=K[b];H?(u=H.rects,B=H.length):H=K[b]={rects:u=[],length:B=0};var F,D,T;for(F=0;B>F;F++)if(D=u[F],D.x<T.x+T.w&&D.x+D.w>T.x&&D.y<T.y+T.h&&D.h+D.y>T.y)return!0;return u.length<=B?(u.push(T),H.length++):u[H.length++]=T,!1}}),oi(p,{fetch:function(H,G){var b="GET",k=!1,$=null,z="";G&&(b=G.method||"GET",k=G.sync,z=G.url,$=G.data||null),H.open(b,z,!k),G.responseType?H.responseType=G.responseType:G.overrideMimeType&&H.overrideMimeType&&H.overrideMimeType(G.overrideMimeType),H.send($)},convertImageSrc:function(L,u){u&&"function"==typeof u||(u=function(){}),u(L)}});var _i=U.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};jn("Request",z,{_responseType:null,_overrideMimeType:"text/plain",send:function(C){var N=this._xhr,K=this.onload,i=this.onerror;this.getResponseType()?C.responseType=this.getResponseType():this.getOverrideMimeType()&&(C.overrideMimeType=this.getOverrideMimeType()),N.onload=K,N.onerror=i,p.fetch(N,C)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(W){this._responseType=W},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(u){this._overrideMimeType=u},getResponseText:function(){var N=this._xhr;return N.response||N.responseText}}),lm.GraphView=function(n){var z=this;z._24I={},z._34I=new Yn,z.enableDirtyRect(),z._25I={},z._56I={},z._view=_f(1,z),z._canvas=gj(z._view),z.dm(n?n:new _m),this._coreInteractor=new Uc(this),z.setEditable(!1),z.setScrollBarVisible(p.graphViewScrollBarVisible),z._initView()},hj("GraphView",z,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[qd,Uo,Nl,re,"resettable","editInteractor",zj,"zoomable","pannable","rectSelectable","autoScrollZone",ci,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:p.graphViewZoomable,_resettable:p.graphViewResettable,_pannable:p.graphViewPannable,_rectSelectable:p.graphViewRectSelectable,_autoScrollZone:p.graphViewAutoScrollZone,_rectSelectBackground:p.graphViewRectSelectBackground,_rectSelectBorderColor:p.graphViewRectSelectBorderColor,_editPointSize:p.graphViewEditPointSize,_editPointBorderColor:p.graphViewEditPointBorderColor,_editPointBackground:p.graphViewEditPointBackground,_scrollBarColor:os,_scrollBarSize:se,_autoHideScrollBar:Ye,_autoMakeVisible:Ql,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(w){this._dataModel.setLayers(w)},setEditable:function(Y){var M=this,A=M.__interactorMap__;if(!A){var O=lm.XEditInteractor;A=M.__interactorMap__={scrollBar:new Up(M),select:new Rc(M),edit:O?new O(M):new yk(M),text:new Qn(M),move:new Do(M),"default":new Qb(M),touch:new Ak(M,{editable:!1})}}Y?(M._uieditable=!0,M.setInteractors([A.scrollBar,A.select,A.edit,A.text,A.move,A.default,A.touch])):(M._uieditable=!1,M.setInteractors([A.scrollBar,A.select,A.move,A.default,A.touch]))},getCanvas:function(){return this._canvas},_33I:function(i){var d=i.getUIClass();return d?new d(this,i):g},getDataUI:function(N){var n=this,y=n._25I[N._id];return y===s&&(y=n._33I(N),n._25I[N._id]=y),y},getNodeRect:function(K){return p.getNodeRect(this,K)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(o){var i=this.getDataUI(o);return i?(i._79o(),i._78o):null},getEdgeSourcePosition:function(L){var j=this,B=j.getDataUI(L),s=B.s,W=B._data._40I;return zb(j,W,s("edge.source.position"),s("edge.source.offset.x"),s("edge.source.offset.y"),s("edge.source.anchor.x"),s("edge.source.anchor.y"))},getEdgeTargetPosition:function(y){var Q=this,s=Q.getDataUI(y),b=s.s,h=s._data._41I;return zb(Q,h,b("edge.target.position"),b("edge.target.offset.x"),b("edge.target.offset.y"),b("edge.target.anchor.x"),b("edge.target.anchor.y"))},invalidateAll:function(J){var Q=this;if(J){for(var m in Q._25I){var U=Q._25I[m];U&&U.dispose()}Q._25I={},Q._56I={},Q._24I={},Q._34I.clear(),Q.redraw()}else Q.dm().each(function(n){Q.invalidateData(n)})},invalidateSelection:function(){var Z=this;Z.sm().each(function(h){Z.invalidateData(h)})},invalidateData:function(w){var n=this;n._24I[w._id]=w,n._21Q(w),n.iv()},_21Q:function(w){var m=this,P=m._24I;if(hg(w)&&nh[w.s(Qj)]){var D=w.getSourceAgent();D&&D.getAgentEdges().each(function(p){P[p._id]=p}),D=w.getTargetAgent(),D&&D.getAgentEdges().each(function(x){P[x._id]=x}),m.iv()}},redraw:function(P){var g=this;g._32I||(P?g._34I.add(P):(g._32I=1,g._34I.clear()),g.iv())},each:function(r,x){var s,I,p,l=0,f=this.getLayers(),T=this._dataModel,_=T._datas._as,R=_.length;if(f){for(var G=f.length;G>l;l++)if(p=f[l],Np(p)&&(p=p.name),T.isHierarchicalRendering()){var k=function(N){return N._layer===p?x?r.call(x,N):r(N):void 0};if(this._dataModel.eachByHierarchical(k)===!1)return}else for(var j=0;R>j;j++)if(s=_[j],s._layer===p&&(I=x?r.call(x,s):r(s),I===!1))return}else if(T.isHierarchicalRendering())this._dataModel.eachByHierarchical(r,null,x);else for(;R>l;l++)if(s=_[l],I=x?r.call(x,s):r(s),I===!1)return},reverseEach:function(M,R){var K,w,h,A,n=this._dataModel,m=n._layers,v=n._datas._as,F=v.length;if(m){for(K=m.length-1;K>=0;K--)if(A=m[K],Np(A)&&(A=A.name),n.isHierarchicalRendering()){var T=function(Y){return Y._layer===A?R?M.call(R,Y):M(Y):void 0};if(n.reverseEachByHierarchical(T)===!1)return}else for(var N=F-1;N>=0;N--)if(w=v[N],w._layer===A&&(h=R?M.call(R,w):M(w),h===!1))return}else if(n.isHierarchicalRendering())n.reverseEachByHierarchical(M,null,R);else for(K=F-1;K>=0;K--)if(w=v[K],h=R?M.call(R,w):M(w),h===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var t=this,J=t._84I;if(!J){var W=this.dm().a("width"),r=this.dm().a("height");W>0&&r>0?t._84I={x:0,y:0,width:W,height:r}:(t.each(function(w){t.isVisible(w)&&(J=to(J,t.getDataUIBounds(w)))}),t._84I=J?J:Pf)}return t._84I},getScrollRect:function(){return to(this.getContentRect(),this._29I)},makeCenter:function(W,z,k){var r=this;if(!r.getWidth()||!r.getHeight())return k||oq(r.makeCenter,r,[W,z,!0],500),void 0;r.makeVisible(W),r.validate();var X=r.getDataUIBounds(W);if(X){var _=r.getWidth(),K=r.getHeight(),N=X.x+X.width/2,V=X.y+X.height/2,c=-N*r._zoom+_/2,b=-V*r._zoom+K/2;r.setTranslate(c,b,z)}},fitData:function(k,U,E,A,_){var F=this;if(!F.getWidth()||!F.getHeight())return _||oq(F.fitData,F,[k,U,E,A,!0],500),void 0;var c=function(){F.makeVisible(k),F.validate();var x=F.getDataUIBounds(k);x&&(x=Wi(x),ff(x,E==g?20:E),F.fitRect(x,U,A))};U?p.callWhenLoaded(c):c()},fitContent:function(v,d,I,x){var n=this;if(!n.getWidth()||!n.getHeight())return x||oq(n.fitContent,n,[v,d,I,!0],500),void 0;var y=function(){n.validate();var N=Wi(n.getContentRect());ff(N,d==g?20:d),n.fitRect(N,v,I)};v?p.callWhenLoaded(y):y()},fitRect:function(S,l,d){var f=this,Y=f.getWidth(),Z=f.getHeight(),p=S.x+S.width/2,J=S.y+S.height/2,I=Q(Y/S.width,Z/S.height),E=f._zoom,$=-p*E+Y/2,H=-J*E+Z/2;0===I||isNaN(I)||(d&&(I=Q(1,I)),l?(f._65I&&(delete f._65I.finishFunc,f._65I.stop(!0)),f._14o&&f._14o.stop(!0),f.setTranslate($,H,{finishFunc:function(){f.setZoom(I,l)}})):(f.setTranslate($,H),f.setZoom(I)))},fitSelection:function(o,K,g){var c=this,z=c.sm(),N=null;z.size()&&(z.each(function(h){N=to(c.getDataUIBounds(h),N)}),o&&ff(N,o),c.fitRect(N,K,g))},toCanvas:function(c,g,M){g=g||this._zoom,this.validateImpl();var t=this,A=t.getContentRect();M&&ff(A,M),A.width||(A.width=10),A.height||(A.height=10);var T=gj(),p=A.x*g,N=A.y*g,I=Math.ceil(A.width*g),W=Math.ceil(A.height*g);Df(T,I,W,1);var J=Rl(T);c=c||this._dataModel.getBackground(),c&&lc(J,0,0,I,W,c),bs(J,-p,-N),J.scale(g,g);var k=this._zoom;return this._zoom=g,t._42(J),this._zoom=k,J.restore(),T},toDataURL:function(K,J,E,t){return this.toCanvas(K,E,t).toDataURL(J||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(G,E){var B=this,m=B.dm().getBackground();if(m){var S=B.dm().a("width"),I=B.dm().a("height");S>0&&I>0&&lc(G,0,0,S,I,m)}var r=B.__htmlOrderList,u=[],H=B._forcedLayoutHTML;if(B._93db(G,E),B.each(function(t){var j=B.getDataUI(t);if(j){var M=B._56I[t._id],J=j._htmlView;if(M){var T=j._79o();
if(J=j._htmlView,U.HtmlNode&&t instanceof U.HtmlNode)j._42(G);else{var C=B.getViewRect(),P=J&&J.layoutHTML;!E||Rf(E,T)?(P&&(J.layoutHTML(),j.__outerLayout&&delete j.__outerLayout),j._42(G)):Rf(C,T)||!P||j.__outerLayout&&!H||(J.layoutHTML(),j.__outerLayout=!0)}}J&&(u.push(J),J.getView&&(J=J.getView()),J.style.display=M?"block":km)}}),r&&u.length>0){var i=!1;if(r.length!==u.length)i=!0;else for(var p=0;p<u.length;p++)if(u[p]!==r[p]){i=!0;break}i&&(u.forEach(function(R){R.autoAdjustIndex!==!1&&B.appendHTML(R,!0)}),this.__htmlOrderList=u)}else this.__htmlOrderList=u;B._92db(G,E)},disableDirtyRect:function(){this._shouldRedrawAll=T},enableDirtyRect:function(){var m=this;m._shouldRedrawAll=function(){return m._32I}},validateImpl:function(){this.tryUpdateRootData();var I,J,f,R,T,e=this,_=e.tx(),D=e.ty(),K=e._zoom,E=e._canvas,o=this.getWidth(),r=this.getHeight(),g=e._29I,c={x:-_/K,y:-D/K,width:o/K,height:r/K},P={},M=e._34I,H=e._24I,w=e._shouldRedrawAll(),z=e._23I;e._24I={},(o!==E.clientWidth||r!==E.clientHeight)&&(Df(E,o,r),w=1,e._forcedLayoutHTML=1),w||Yl(c,g)||(w=1,e._forcedLayoutHTML=1),e._29I=c,e.each(function(j){J=j._id;var C=P[J]=e.isVisible(j);C!==e._56I[J]&&(H[J]=j,f=e.getDataUI(H[J]),f&&f._84o(C),e._84o(j,C))},e);for(J in H)f=e.getDataUI(H[J]),f&&(!w&&e._56I[J]&&(T=f._79o(),T&&M.add(T)),f.invalidate()),e._83I=1;if(e._56I=P,!w)for(J in H)P[J]&&(f=e.getDataUI(H[J]),f&&(T=f._79o(),T&&M.add(T)));if(w?R=c:(M.each(function(h){Rf(c,h)&&(R=to(R,h))}),R&&(ff(R,N(1,1/K)),R.x=l(R.x*K)/K,R.y=l(R.y*K)/K,R.width=y(R.width*K)/K,R.height=y(R.height*K)/K,R=Jg(c,R))),e._74O=R,R&&0!==R.width&&0!==R.height){I=Rl(E);var v=R.x,h=R.y,S=R.width,Z=R.height;v=Math.floor((v*K+_)*Kn),h=Math.floor((h*K+D)*Kn),S=Math.ceil(S*K*Kn)+1,Z=Math.ceil(Z*K*Kn)+1,w||(R.x=(v/Kn-_)/K,R.y=(h/Kn-D)/K,R.width=S/Kn/K,R.height=Z/Kn/K),I.beginPath(),I.rect(v,h,S,Z),I.clip(),I.clearRect(v,h,S,Z),Bl(I,_,D,K),e._42(I,R),I.restore(),delete e._74O}if(M.clear(),delete e._32I,delete e._forcedLayoutHTML,z&&o>0&&r>0){var f=e.getDataUI(z);if(f){var T=f._79o(),F=e._29I,u=F.x,U=F.y,O=F.width,i=F.height,K=e._zoom;T&&!Rf(T,F)&&(T.x+T.width<u&&e.tx(-T.x*K),T.x>u+O&&e.tx(-(T.x+T.width-O)*K),T.y+T.height<U&&e.ty(-T.y*K),T.y>U+i&&e.ty(-(T.y+T.height-i)*K))}delete e._23I}e._83I&&(delete e._83I,delete e._84I),e._98O(),e.countFrame(),Lg(e._24I)||oq(e.iv,e)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var _,e=this.getFullscreenDatas();for(var i in e)_=e[i],this.scaleRootData(_);this.onRootDataUpdated&&this.onRootDataUpdated(),this._rootDataUpdating=!1}},scaleRootData:function(C){var r=C.s("fullscreen");if("uniform"===r||"fill"===r){C.getRotation()&&C.setRotation(0);var H=C.s("fullscreen.gap")||0,N=this.getWidth(),o=this.getHeight();if(N&&o){var R,d,i,q=N-2*H,Q=o-2*H,t=C.getAnchor(),p=C.getScaledSize(),v=p.width,l=p.height,X=C.s("fullscreen.lock");if(X)return"uniform"===r?q/Q>v/l?(R=Q/l,v=l*q/Q):(R=q/v,l=v*Q/q):"v"===X?(R=Q/l,v=q/R,C.getWidth()!==v&&C.setWidth(v)):(R=q/v,l=Q/R,C.getHeight()!==l&&C.setHeight(l)),this.setZoom(R),d=H-(C.getX()-t.x*v)*R,i=H-(C.getY()-t.y*l)*R,d!==this.tx()&&this.tx(d),i!==this.ty()&&this.ty(i),void 0;d=this.tx(),i=this.ty(),R=this._zoom;var x={x:(-d+H)/R,y:(-i+H)/R,width:q/R,height:Q/R};if("uniform"===r){var k=v/l,I=Math.min(x.width,x.height*k),O=I/k;x.x+=.5*(x.width-I),x.y+=.5*(x.height-O),x.width=I,x.height=O}q=x.width/C.getScaleX(),Q=x.height/C.getScaleY(),(C.getWidth()!=q||C.getHeight()!==Q)&&C.setSize(q,Q);var f=x.x+t.x*x.width,P=x.y+t.y*x.height,h=C.getPosition();(f!==h.x||P!==h.y)&&C.setPosition(f,P)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(g){var K=this;g!==K.isScrollBarVisible()&&(g?(ib(K._view,K._79O=lp()),ib(K._79O,K._27I=lp()),ib(K._79O,K._28I=lp())):(cn(K._79O),delete K._79O,delete K._27I,delete K._28I),K.fp("scrollBarVisible",!g,g))},getDebugTip:function(){return""},showScrollBar:function(){var o=this;o._79O&&(o._85I||(yo(function(){o._86I()},Nq),o.iv()),o._85I=new Date)},_86I:function(){var I=this;if(I._85I){var R=new Date,h=R.getTime();h-I._85I.getTime()>=Nq?(delete I._85I,I.iv()):yo(function(){I._86I()},Nq)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var J=this,n=this._27I,F=this._28I;if(J._79O){if(J._autoHideScrollBar&&!J._85I)return n.style.visibility=lb,F.style.visibility=lb,void 0;var h=J.getScrollBarColor(),B=J._zoom,f=J.getScrollBarSize(),E=J.getViewRect(),G=J.getScrollRect(),W=E.height*B,D=G.height*B,C=E.width*B-f-2,Q=W*((E.y-G.y)*B/D),j=W*(W/D),Z=n.style;D-.5>W?(is>j&&(Q=Q+j/2-is/2,0>Q&&(Q=0),Q+is>W&&(Q=W-is),j=is),Iq(n,C,Q,f,j),Z.visibility=ar,Z.background=h,Z.borderRadius=f/2+zk):Z.visibility=lb;var r=E.width*B,i=G.width*B,Q=E.height*B-f-2,C=r*((E.x-G.x)*B/i),P=r*(r/i),Z=F.style;i-.5>r?(is>P&&(C=C+P/2-is/2,0>C&&(C=0),C+is>r&&(C=r-is),P=is),Iq(F,C,Q,P,f),Z.visibility=ar,Z.background=h,Z.borderRadius=f/2+zk):Z.visibility=lb}},setDataModel:function(C){var u=this,n=u._dataModel,D=u._selectionModel;n!==C&&(n&&(n.ump(u.handleDataModelPropertyChange,u),n.umm(u.handleDataModelChange,u),n.umd(u.handleDataPropertyChange,u),n.removeIndexChangeListener(u._75O,u),n.removeHierarchyChangeListener(u.handleHierarchyChange,u),D||n.sm().ums(u.handleSelectionChange,u)),u._dataModel=C,C.mp(u.handleDataModelPropertyChange,u),C.mm(u.handleDataModelChange,u),C.md(u.handleDataPropertyChange,u),C.addIndexChangeListener(u._75O,u),C.addHierarchyChangeListener(u.handleHierarchyChange,u),D?D._21I(C):C.sm().ms(u.handleSelectionChange,u),u.invalidateAll(!0),u.fp(Mi,n,C),u.updateBackground())},getLayersInfo:function(){if(this._layersInfo===s){var O=this.getLayers();O?(this._layersInfo={},O.forEach(function(B){var Y=Np(B)?B.name:B;this._layersInfo[Y]=B},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(N,A,T){var R,v,e,a,G=this;N instanceof U.Data?(a=G.getDataUI(N),e=_q(a)):(e=_q(null,arguments[0],arguments[1]),A=arguments[2],T=arguments[3]),2===A.length&&(A=new vr(A[0],A[1]));var C=pe(A,function(I){return Rq(e,100*I)},100,.001),W=Rq(e,100*C);if(!T){var n=a?tg(a):tg(arguments[0],arguments[1]),m=new vr(W.x,W.y),c=49/(G._zoom*G._zoom);for(R=0,v=n.length;v>R;R++)if(m.distanceToSquared(n[R])<c)return{index:R,point:n[R],distance:Math.sqrt((n[R].x-A.x)*(n[R].x-A.x)+(n[R].y-A.y)*(n[R].y-A.y))}}return{percent:C,point:W,distance:Math.sqrt((W.x-A.x)*(W.x-A.x)+(W.y-A.y)*(W.y-A.y))}},getPercentPositionOfPath:function(Z,E){var L;if(Z instanceof U.Data){var G=this.getDataUI(Z);L=_q(G)}else L=_q(null,arguments[0],arguments[1]),E=arguments[2];return Rq(L,E)},getNeareastPositionOfPath:function(){return this.calculateEdgePosition.apply(this,arguments)},getPointsOfPath:function(){function K(q,g,W,i,m,B){var k=new vr(g.get(W)),n=B.apply(k);q.push({local:k,world:n,type:m,index:W,realIndex:i})}return function(Z){var J,Q;if(Z instanceof U.Data){var R=this.getDataUI(Z),g=Ae(R);J=g.points,Q=g.segments}else J=arguments[0],Q=arguments[1];var $,k,I,i=Z instanceof U.Shape?Z.getPointsMatrix2d():new fo.Matrix2d,b=[],V=-1,D=-1;for(k=0,I=Q?Q.length:J.length;I>k;k++)$=Q?Q.get(k):1,5!==$&&(D++,3===$?(K(b,J,V+1,D,"C",i),K(b,J,V+2,D,"M",i),V+=2):4===$?(K(b,J,V+1,D-1,"R",i),K(b,J,V+2,D,"L",i),K(b,J,V+3,D,"M",i),V+=3):(K(b,J,V+1,D,"M",i),V+=1));return b}}(),calculateAttachPoint:function(){var o=new vr,g=new vr,z=new vr;return function(L,b){var O=this.getAttachPoints(L);if(!O||!O.length)return null;z.set(b.x,b.y);for(var f,J,H,C,l,Q=1/0,y=0,R=O.length;R>y;y++)H=O[y],g.x=H.x,g.y=H.y,o.x=H.offsetX||0,o.y=H.offsetY||0,C=zb(this,L,0,o.x,o.y,g.x,g.y),J=z.distanceToSquared(C),Q>J&&(f=y,Q=J,l=C);Q=Math.sqrt(Q);var q=this.getAttachStyle(L);if("close"===q){var w=L.s("attach.close.threshold")/this._zoom;if(Q>w)return null}return{index:f,distance:Q,info:O[f],point:l}}}(),getAttachPoints:function(o){var z=o.s("attach.points");if(z)return z;var H=dg(o._image);return H?gs(H.attachPoints,o,this)||null:void 0},getAttachStyle:function(R){var S=R.s("attach.style");if(S)return S;var j=dg(R._image);return j?gs(j.attachStyle,R,this)||"close":void 0},updateLayers:function(){this._layersInfo=s,this.invalidateSelection(),this.redraw()},updateBackground:function(){var i=this.dm().a("width"),z=this.dm().a("height");this._canvas.style.background=i>0&&z>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(Q){if("background"===Q.property){var Y=this._canvas.style.background,q=Q.newValue||"";this.updateBackground(),this.fp("canvasBackground",Y,q),this.redraw()}else"a:width"===Q.property||"a:height"===Q.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===Q.property?this.updateLayers():"hierarchicalRendering"===Q.property&&this.redraw()},handleDataPropertyChange:function(C){this.dm().isHierarchicalRendering()&&"parent"===C.property&&C.data.hasChildren()&&this.redraw(),this.invalidateData(C.data)},onPropertyChanged:function(Z){var k=this,I=Z.property;if(k.redraw(),"zoom"===I){var i=k.sm().getSelection();i.size()&&i.each(function(O){O.invalidate()})}else"dataModel"===I&&(k._83I=1);th[I]?k.showScrollBar():I===zj&&k.onCurrentSubGraphChanged(Z)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(S){var O=this,W=S.kind,F=S.data;if(O._83I=1,"add"===W)O.invalidateData(F),hg(F)&&F.getEdgeGroup()&&F.getEdgeGroup().eachSiblingEdge(O.invalidateData,O),F.getHost&&F.getHost()&&F.getHost().updateLayoutAttaches();else if(W===Lf){O._21Q(F);var L=F._id,$=O._25I[L];if($){if(O._56I[L]){var I=$._79o();I&&O.redraw(I)}$.dispose(),delete O._25I[L],delete O._24I[L],delete O._56I[L]}F===O._currentSubGraph&&O.setCurrentSubGraph(g)}else W===rm&&(O.invalidateAll(!0),O.setCurrentSubGraph(g))},_75O:function(R){this.invalidateData(R.data)},handleHierarchyChange:function(S){this.dm().isHierarchicalRendering()&&S.data.hasChildren()&&this.redraw(),this.invalidateData(S.data)},adjustIndex:function(J){var I=this;if(I.isVisible(J)){I.dm().beginTransaction();for(var e=J;e._parent&&I.isVisible(e._parent);)e=e._parent;e&&e!==J&&I._dataModel.adjustIndex(e),I._dataModel.adjustIndex(J),I.dm().endTransaction()}},getImage:function(f){return f.getImage?f.getImage():s},getSelectWidth:function(N){var J=dg(this.getImage(N));return J&&gs(J.disableSelectedBorder,N,this)?0:N.s("select.width")},getSelectColor:function(x){return x.s("select.color")},isSelectable:function(m,a){if(this.isSelected(m))return!0;if(!a&&m.getParent()instanceof vc&&this.isSelectable(m.getParent(),!0)&&m.getParent().isSyncSize())return!1;var K=this.getLayersInfo();if(K){var z=K[m._layer];if(z&&z.selectable===!1)return!1}return m.s("2d.selectable")&&this.sm().isSelectable(m)},isMovable:function(z){var t=this;if(hg(z)&&z.getStyle(Qj)!==tp)return!1;var B=this.getLayersInfo();if(B){var $=B[z._layer];if($&&$.movable===!1)return!1}return z.s("2d.movable")?t._movableFunc?t._movableFunc(z):!0:!1},isEditable:function(N){var o=this;if(U._uiSerializing)return o._uieditable;if(!o._editInteractor||!o.isSelected(N))return!1;if(Mn(N)){var e=o.getDataUI(N);if(!e||e._88I)return!1}if(hg(N)&&N.getStyle(Qj)!==tp)return!1;var l=this.getLayersInfo();if(l){var Z=l[N._layer];if(Z&&Z.editable===!1)return!1}return N.s("2d.editable")?o._editableFunc?o._editableFunc(N):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(I){return Ob(I)&&0!==I.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(I):!0},isRectEditable:function(l){return this._rectEditableFunc?this._rectEditableFunc(l):!0},isAnchorEditable:function(Z){return this._anchorEditableFunc?this._anchorEditableFunc(Z):!0},isRotationEditable:function(P){return P.setRotation&&P.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(P):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(r){var y=r.getAnchor(),u=r.getScale(),Z=this._zoom,N=Bj(r.getRotation(),0,-r.getHeight()*u.y*y.y-(u.y<0?-1:1)*(Pb?32:16)/Z),Y=r.p();return N.x+=Y.x,N.y+=Y.y,N},getLogicalPoint:function($){var o=this;return dc($,o._canvas,o.tx(),o.ty(),o._zoom,o._zoom)},getScreenPoint:function(W,i){var h,f=this;return"object"==typeof W?W.x!==s?(h=W.x,i=W.y):(h=W[0],i=W[1]):h=W,bl(h,i,f._canvas,f.tx(),f.ty(),f._zoom,f._zoom)},getSelectedDataAt:function(M){var u=this;return this.getDataAt(M,function(l){return u.isSelected(l)})},getDataInfoAt:function(Z,b,G){var h,z=this.lp(Z),j=this.getDataAt(z,b,G);if(j){var J=this.getDataUI(j);h={data:j,ui:J,point:z};var f=J._38o;if(f){var k=f.icons;for(var Q in k){var U=k[Q],B=f.rects[Q];if(B)for(var M=gs(U.names,j,this),L=M?M.length:0,n=B.rotation,w=L-1;w>=0;w--){var A=M[w],$=B[w];if(vb($,z,n))return h.part="icons",h.name=Q,h.icon=A,h.rect=$,h.index=w,h.rotation=n,h}}}if(this.isNoteVisible(j)){if(J.note2Info&&vb(J.note2Info.clickRect,z,g,J.note2Info.scale))return h.part="note2",h;if(J.noteInfo&&vb(J.noteInfo.clickRect,z,g,J.noteInfo.scale))return h.part="note",h}if(this.isLabelVisible(j)){if(J.label2Info&&vb(J.label2Info.rect,z,J.label2Info.rotation,J.label2Info.scale))return h.part="label2",h;if(J.labelInfo&&vb(J.labelInfo.rect,z,J.labelInfo.rotation,J.labelInfo.scale))return h.part="label",h}if(j.isInRect&&j.isInRect(z))return h.part="body",h}return h},getDataAt:function(M,P,Z){M.target&&(M=this.lp(M));var k,q=this._zoom;return this.reverseEach(function(Y){return(P?P(Y):this.isSelectable(Y))&&this.rectIntersects(Y,Ii(M.x,M.y,Z,q))?(k=Y,!1):void 0},this),k},getIconInfoAt:function(P,H){var c=this;if(P.target&&(P=c.lp(P)),H||(H=c.getDataAt(P)),H){var L=c.getDataUI(H);if(L&&L._38o){var W,m=L._38o,K=new Yn;for(W in m.icons)K.add(W);for(var N=K.size()-1;N>=0;N--){W=K.get(N);for(var n=m.rects[W],Z=n.rotation,o=n.length-1;o>=0;o--){var t=n[o],k=t.width,F=t.height,C={x:P.x-t.x-k/2,y:P.y-t.y-F/2};Z!=g&&(C=Bj(-Z,C.x,C.y));var t={x:-k/2,y:-F/2,width:k,height:F};if(vb(t,C))return{key:W,index:o,name:m.icons[W].names[o],rect:n[o],point:P,rotation:Z,relativeRect:t,relativePoint:C,data:H}}}}}return g},getDatasInRect:function(z,Z,U){U===s&&(U=1);var F=this,x=new Yn;return F.reverseEach(function(r){U&&!F.isSelectable(r)||(Z?F.rectIntersects(r,z):F.rectContains(r,z))&&x.add(r)}),x},moveSelection:function(m,d){var f=this;f.dm().beginTransaction(),qm(f.sm().toSelection(f.isMovable,f),m,d),f.dm().endTransaction()},moveDatas:function(c,F,L){var b=this;b.dm().beginTransaction(),c instanceof Yn||(c=new Yn(c)),qm(c,F,L),b.dm().endTransaction()},getDataUIBounds:function(c){var u=this.getDataUI(c);return u?u._79o():g},drawData:function(t,l,y){var g=this.getDataUI(l);if(g){var W=g._79o();(!y||Rf(y,W))&&(g._42(t),l instanceof U.Block&&l.eachChild(function(b){this.isVisible(b)&&this.drawData(t,b,y)},this))}},getBoundsForGroup:function(v){return v.s(qn)?this.getDataUIBounds(v):g},isPixelPerfect:function(K){return K.s("pixelPerfect")},rectIntersects:function(I,c){this.validate();var Z=g;if(this._56I[I._id]){var H=this._25I[I._id];if(H){var A=H._79o();if(bq(c,A))Z=!0;else if((c=Jg(c,A))&&(H.rectIntersects&&(Z=H.rectIntersects(c)),Z==g)){if(!this.isPixelPerfect(I))return!0;var U=c.x,a=c.y,G=c.width,E=c.height,O=this._zoom,L=p.hitMaxArea,r=G*E*O*O;if(r>L){var S=Math.sqrt(L/r);O*=S}G*=O,E*=O,2>G&&(G=2),2>E&&(E=2),U*=O,a*=O;var k=Wb(G,E);bs(k,-U,-a),k.scale(O,O),this._drawForChecking=!0,this.drawData(k,I,c),this._drawForChecking=!1;try{for(var N=0,h=k.getImageData(0,0,G,E).data;N<h.length;N+=4)if(0!==h[N+3]){Z=!0;break}k.restore()}catch(l){tk=g,Z=!1}}}}return Z?!0:!1},rectContains:function(r,B){if(this._56I[r._id]){var p=this._25I[r._id];if(p)return bq(B,p._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(T){if(!p.isInput(T.target)){var H=this,Q=H._focusData,U=Q&&H._25I[Q._id],q=0,Y=H._dataModel._datas;if(!(Q&&Q._enabled&&Q._editable&&U&&U.onKeyDown&&U.onKeyDown(T)===!0))if(9===T.keyCode&&(Q&&(q=Y.indexOf(Q),te(T)?-1===--q&&(q=0):++q===Y.size()&&(q=0)),H._focusData=Q=Y.get(q),H.sm().setSelection(Q)),om(T)?H.selectAll():Wc(T)&&H.isResettable()&&H.reset(),H.sm().isEmpty()){if(H._editing)return;var P=H.tx(),o=H.ty(),C=!1,Z=te()?100:10;qh(T)&&(P-=Z,C=!0),ol(T)&&(o-=Z,C=!0),Nf(T)&&(P+=Z,C=!0),lg(T)&&(o+=Z,C=!0),C&&H.setTranslate(P,o)}else{Lk(T)&&H.handleDelete(T);var G=te()?10:1;qh(T)&&(H.moveSelection(-G,0),H.fi({kind:"moveLeft"})),ol(T)&&(H.moveSelection(0,-G),H.fi({kind:"moveUp"})),Nf(T)&&(H.moveSelection(G,0),H.fi({kind:"moveRight"})),lg(T)&&(H.moveSelection(0,G),H.fi({kind:"moveDown"}))}}},handleScroll:function(u,v){if(fk(u),this.isZoomable()){if(!this.getEditInteractor()){var O=this.getDataAt(u);if(O){var p=dg(this.getImage(O));if(p&&gs(p.scrollable,O,this))return}}var o=this.lp(u);v>0?this.scrollZoomIn(o):0>v&&this.scrollZoomOut(o)}},handlePinch:function(h,r,d){this.isZoomable()&&(Math.abs(r-d)<p.pinchZoomThreshold||(r>d?this.pinchZoomIn(h):this.pinchZoomOut(h)))},checkDoubleClickOnNote:function(H,U){var z=this,r=z.lp(H),m=z.getDataUI(U),Z=m.note2Info;return Z&&U.s("note2.toggleable")&&vb(Z.clickRect,r)?(U.s(Jl,!U.s(Jl)),z.fi({kind:"toggleNote2",event:H,data:U}),!0):(Z=m.noteInfo,Z&&U.s("note.toggleable")&&vb(Z.clickRect,r)?(U.s(xk,!U.s(xk)),z.fi({kind:"toggleNote",event:H,data:U}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(j,N){var M=this,x=M.getAutoScrollZone(),L=x/M.getZoom(),I=x/4,$=M._29I,w=M.lp(j),P={x:M.tx(),y:M.ty()};return w&&x>0&&$&&(w.x-$.x<L?M.translate(I,0):$.x+$.width-w.x<L&&M.translate(-I,0),w.y-$.y<L?M.translate(0,I):$.y+$.height-w.y<L&&M.translate(0,-I)),P.x=M.tx()-P.x,P.y=M.ty()-P.y,N&&(N.x+=P.x,N.y+=P.y),P},getMoveMode:function(z,F){var i=F.s("2d.move.mode");return i?i:Xd["88"]?"x":Xd["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(E,B,l){var L=this;return"currentSubGraph"===B?{__i:E.getId()}:l.serializeProperty(E,B,L)},deserializeProperty:function(C,G,c){var N=this;if("currentSubGraph"===G){var T=N.dm(),b=T.__idMap;return b[C.__i]}return c.deserializeProperty(C,G,N)},setDefaultCursor:function(l,h){this._defaultCursor=l,h!==!1&&this.setCursor(l)},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(E){return E===g||p.getConnectAction(null,E)?(this._currentActionType=E,this.redraw(),!0):!1},getEditStyle:function(w){var u=this.getEditInteractor();return u?u.getStyle(w):s},setEditStyle:function(z,K,f){var T=this.getEditInteractor();return T?(T.setStyle(z,K,f),!0):!1},isConnectActionVisible:function(A){var M=p.getConnectAction(this);if(!M)return!1;var G=M.visible;return qr(G)&&(G=G(this,A)),G},isInteractive:function(C){if(this._drawForChecking)return!1;var n=dg(this.getImage(C));return n&&gs(n.interactive,C,this)?!0:C.s("interactive")},getRenderingStyleIconName:function(){return $i},appendHTML:function(C,P){var Y=this.getView();if(!(P||C&&C.parentNode!==Y))return!1;var S=C.getView&&C.getView(),G=C.beforeCanvas;if(!P&&S&&S.parentNode===Y)return!1;(C.getView||C.isSelfViewEvent)&&(C=C.getView());var q=this.getEditInteractor();return G?Y.insertBefore(C,this.getCanvas()):q&&q._canvas?Y.insertBefore(C,q._canvas):this.isScrollBarVisible()?Y.insertBefore(C,this.getView().lastChild):ib(Y,C),!0},_layoutHTMLImpl:function(D,d,B){if(arguments.length>1){var _,S=this,W=S._zoom;if(d.getView&&(_=d,d=d.getView()),d.style.position="absolute",B){var v=D.getRect();Iq(_||d,S.tx()+v.x*W,S.ty()+v.y*W,v.width*W,v.height*W)}else{var U=new Wg,v=D.getAnchorRect(),q=D.getPosition(),R=D.getScale(),e=d.style;Iq(_||d,v),U.appendTranslate(S.tx(),S.ty()),U.appendScale(W,W),U.append(new Wg(D.getRotation(),q.x,q.y,R.x,R.y)),Qp(e,"transform","matrix("+U.a.toFixed(5)+", "+U.b.toFixed(5)+", "+U.c.toFixed(5)+",\n    "+U.d.toFixed(5)+", "+U.tx.toFixed(5)+", "+U.ty.toFixed(5)+")"),Qp(e,"transformOrigin",(-v.x).toFixed(5)+"px "+(-v.y).toFixed(5)+"px"),d.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(Q){return Q instanceof Aj?{name:"text",accessType:"s",isMultiline:!0}:void 0},getState:function(v){var F="state",V=v.s(F);if(V)return V;var A=dg(v._image);return A?gs(A[F],v,this)||null:void 0},getShape:function(f){return f.getStyle(pc)}}),z.defineProperties(lm.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(A){this._layoutHTML=A}}});var Cq=function(y,D){var C=this;C.gv=y,C.s=function(m){return D.getStyle(m)},C._data=D,C._87I=new Yn},$i=g;zs(Cq,z,{_6I:g,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var A=this,x=A.gv.isSelected(A._data);return!x||A.isShadowed()?0:A.gv.getSelectWidth(A._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(T){var t=this._data,O=this.gv.getBodyColor(t);return O?O:T?t.getStyle(T):g},_2Q:function(z){return this.s(z)},_1Q:function(H,$,Z,I){var Q=this.s,O=Q("2d.gray"),V=Q($+".dash.color");if(O&&(V=p.toGrayColor(V)),H.strokeStyle=V,H.lineWidth=Z,H.stroke(),Q($+".dash.3d")){var F=Q($+".dash.3d.color");Dg(H,V,O?p.toGrayColor(F):F,Z,this.gv._zoom,Q($+".dash.3d.accuracy"))}Ee(H,I)},invalidate:function(){this._6I=g},_79o:function(){var L=this;if(!L._6I){var y=L._data,e=L.gv;L.labelInfo=L.label2Info=L.noteInfo=L.note2Info=L._38o=g,L._87I.clear(),L.interactiveInfo=e.isInteractive(y)?{}:g,L._3O(),L._55O=e.isEditable(y)?{_42O:e.isRectEditable(y),_43O:e.isPointEditable(y),_56O:e.isRotationEditable(y)}:g,L._6I=L._81o()}return L._6I},_3O:function(){},getPosition:function(){return Pf},_68o:function(M,_){M&&this._87I.add(Wm(M,_))},_81o:function(){var U=this,w=U.s;U._24O(pp,"getLabel"),U._24O(rb,"getLabel2"),U._26O(zg,"getNote"),U._26O(Zb,"getNote2"),U._15O(),U._55O&&U._48O();var p;if(U._87I.each(function(B){p=to(p,B)}),p&&w("shadow.interactable")){var I=U.isShadowed(),A=w("shadow2"),T=Wi(p);A?(T.x+=w("shadow2.offset.x"),T.y+=w("shadow2.offset.y"),ff(T,w("shadow2.blur"))):I&&(T.x+=w("shadow.offset.x"),T.y+=w("shadow.offset.y"),ff(T,w("shadow.blur"))),p=to(p,T)}return U._87I.clear(),p},_42:function(C){var Q=this,o=Q._data,M=Q.gv,$=Q.s,k=$("opacity"),F=this.isShadowed(),r=$("shadow2");if(F||r){var A=C.shadowOffsetX,V=C.shadowOffsetY,t=C.shadowBlur,u=C.shadowColor,X=M.getZoom()*p.devicePixelRatio,K=F?"shadow":"shadow2";C.shadowOffsetX=$(K+".offset.x")*X,C.shadowOffsetY=$(K+".offset.y")*X,C.shadowBlur=$(K+".blur")*X,C.shadowColor=F?Q.getSelectColor():$(K+".color")}if(k!=g){var _=C.globalAlpha;C.globalAlpha=k}Q._80o(C),M.isLabelVisible(o)&&((!M._drawForChecking||$("label.selectable"))&&Ue(C,Q.labelInfo),(!M._drawForChecking||$("label2.selectable"))&&Ue(C,Q.label2Info)),M.isNoteVisible(o)&&(ge(C,Q.noteInfo),ge(C,Q.note2Info)),Q._99O(C),k!=g&&(C.globalAlpha=_),(F||r)&&(C.shadowOffsetX=A,C.shadowOffsetY=V,C.shadowBlur=t,C.shadowColor=u)},_80o:function(){},_47O:function(){},_24O:function(e,h){var f=this,O=f._data,$=f.gv,b=f.s,w=$[h](O);if(w!=g){var D=b(e+".scale"),u=b(e+".max"),t=b(e+".position"),p=f[e+"Info"]={label:w,scale:D,color:$[h+"Color"](O),font:b(e+".font"),opacity:b(e+".opacity"),align:b(e+".align"),decoration:b(e+".decoration"),rotation:f.getRotation(b(e+".rotation"),!1,t),background:$[h+"Background"](O)},z=uf(p,w);u>0&&u<z.width&&(p.labelWidth=z.width,z.width=u),1!==D&&(z.width*=D,z.height*=D);var y=f.getPosition(t,b(e+".offset.x"),b(e+".offset.y"),z,b(e+".position.fixed"));if(z.x=y.x-z.width/2,z.y=y.y-z.height/2,f._68o(p.rect=z,p.rotation),1!==D){var L=z.width/D,k=z.height/D;p.rect={x:y.x-L/2,y:y.y-k/2,width:L,height:k}}}},_26O:function(s,f){var u=this,c=u.gv,Q=u._data,Y=u.s,k=c[f](Q);if(k!=g){var n,U,O=Y(s+".scale"),x=u[s+"Info"]={note:k,scale:O,data:Q,view:c,expanded:Y(s+".expanded"),font:Y(s+".font"),color:Y(s+".color"),opacity:Y(s+".opacity"),align:Y(s+".align"),icon:Y(s+".icon"),backgroundImage:Y(s+".backgroundImage"),borderWidth:Y(s+".border.width"),borderColor:Y(s+".border.color"),background:c[f+"Background"](Q)},e=u.getPosition(Y(s+".position"),Y(s+".offset.x"),Y(s+".offset.y")),b=e.x,h=e.y;if(x.expanded){var a,w=Y(s+".max"),d=Y(s+".backgroundImage");d?(d=dg(d),a={width:Oo(d,Q),height:Gl(d,Q)}):a=uf(x,k),a.width+=6,a.height+=2,w>0&&w<a.width&&(x.labelWidth=a.width,a.width=w),n=a.width,U=a.height+8,x.clickRect={x:b-n*O/2,y:h-U*O,width:n*O,height:U*O*a.height/U}}else{var r=Y(s+".icon");r?(r=dg(r),n=Oo(r,Q),U=Gl(r,Q)):(n=12,U=18),x.clickRect={x:b-n*O/2,y:h-U*O,width:n*O,height:U*O}}x.rect={x:b-n/2,y:h-U*O/2-U/2,width:n,height:U};var H=y(x.borderWidth/2)*O;u._68o({x:b-n*O/2-H,y:h-U*O-H,width:n*O+2*H,height:U*O+2*H})}},_48O:function(){},_99O:function(B){var U=this,J=U._38o;if(J){var N=U.gv,l=U._data,z=J.icons,Y=U.interactiveInfo;Y&&(Y._38o={});for(var L in z){var D=z[L],K=J.rects[L];if(K){Y&&(Y._38o[L]=[]);var Q=gs(D.opacity,l,N),a=gs(D.names,l,N),R=a?a.length:0,q=K.rotation;if(Q!=g){var j=B.globalAlpha;B.globalAlpha*=Q}for(var h=0;R>h;h++){var Z=a[h],T=dg(Z),y=K[h];if(q){var O=y.x+y.width/2,W=y.y+y.height/2;B.save(),bs(B,O,W),no(B,q),bs(B,-O,-W)}Y&&Y._38o[L].push(B.interactiveInfo={compInfos:[],matrix:q?new Wg(q,O,W).appendTranslate(-O,-W):new Wg});var p=$i;$i=L,id(B,T,gs(D.stretch,l,N),y.x,y.y,y.width,y.height,U._data,U.gv),$i=p,B.interactiveInfo=g,q&&B.restore()}Q!=g&&(B.globalAlpha=j)}}}}});var yi=function(g,S){$e(yi,this,[g,S])};zs(yi,Cq,{_checkEmptyRect:!0,_40O:function(M,s){var D=this,H=D.s,f=M.rect;(M.borderColor=D.gv.getBorderColor(D._data))&&(M.borderType=H("border.type"),M.borderWidth=H("border.width"),M.borderPadding=H("border.padding"),s=N(s,M.borderPadding+M.borderWidth/2));var $=D._data.getScale(),p=N(1,N(B($.x),B($.y)));if(M.selectWidth=D.getSelectWidth()){var Q=D.gv._zoom;M.selectType=H("select.type"),M._97o=D.getSelectColor(),M.selectPadding=H("select.padding"),s=N(s,(M.selectPadding+M.selectWidth/2/Q)/p)}s>0&&(s*=p,f=Wi(f),ff(f,s)),D._68o(f)},_39O:function(Z,l){var k,S=this,Y=l.rect;if(l.borderWidth>0&&(k=l.borderPadding,Z.strokeStyle=l.borderColor,Z.lineWidth=l.borderWidth,Fk(Z,l.borderType,{x:Y.x-k,y:Y.y-k,width:Y.width+2*k,height:Y.height+2*k}),Z.stroke()),l.selectWidth>0){var G=S.gv._zoom;if(k=l.selectPadding,Z.strokeStyle=l._97o,Z.lineWidth=l.selectWidth/G,l.rotation!=g){Z.save(),Z.translate(l.position.x,l.position.y),Z.rotate(l.rotation);var f=S._data,K=f.getWidth(),y=f.getHeight(),i=l.scale,_=l.anchor;Y={x:i.x*-K*_.x,y:i.y*-y*_.y,width:i.x*K,height:i.y*y}}Fk(Z,l.selectType,{x:Y.x-k,y:Y.y-k,width:Y.width+2*k,height:Y.height+2*k}),l.rotation!=g&&Z.restore(),Z.stroke()}},dispose:function(){var h=this,C=h._htmlView;yi.superClass.dispose.call(h),C&&(C.onHTMLRemoved&&C.onHTMLRemoved(),cn(C))},_3O:function(){var M,W=this,A=W.s,P=W._data,y=W.gv,L=y.getShape(P),T=W.getBodyColor(),q=A("shape.border.color"),j=W._83o=L?{shape:L,_53o:W.getBodyColor("shape.background"),_27Q:dg(A("shape.repeat.image"),T),shapeGradientPack:A("shape.gradient.pack"),shapeBorderGradientPack:A("shape.border.gradient.pack"),_54o:A("shape.border.width"),_55o:q,shapeBorderRepeatImage:dg(A("shape.border.repeat.image"),q),_56o:A("shape.border.3d"),_57o:A("shape.border.3d.color"),_58o:A("shape.border.3d.accuracy"),shapeGradient:A("shape.gradient"),_59o:A("shape.gradient.color"),_60o:A("shape.border.pattern"),_61o:A("shape.border.cap"),_62o:A("shape.border.join"),shapeForeground:A("shape.foreground"),bodyColor:T,gray:A("2d.gray")}:{img:dg(y.getImage(P),T),bodyColor:T,gray:A("2d.gray"),stretch:A("image.stretch")},V=j.img;V&&V.renderHTML?(W._htmlInfo&&W._htmlInfo.img!==V&&(W._htmlInfo=g),W._htmlInfo||(W._htmlInfo={img:V,cache:{}}),M=V.renderHTML(P,y,W._htmlInfo.cache)):W._htmlInfo=g,W._htmlView&&W._htmlView!==M&&(W._htmlView.onHTMLRemoved&&W._htmlView.onHTMLRemoved(),cn(W._htmlView.getView?W._htmlView.getView():W._htmlView)),(W._htmlView=M)&&y.appendHTML(M)&&(M.onHTMLAddedSync&&M.onHTMLAddedSync(),M.onHTMLAdded&&oq(M.onHTMLAdded)),j.rect=P.getRect(),j.position=P.p(),j.scale=P.getScale(),j.anchor=P.getAnchor(),j.rotation=P.getRotation(),L===Em&&(j._63o=A("shape.depth"));var a=0;if(L)a=gd(g,j._54o/2,j._62o),W.s("shape.dash")&&(a=N(a,(W.s("shape.dash.width")||j._54o)/2));else if(V&&V.boundExtend)if(a=gs(V.boundExtend,P,y),V.boundExtendAbsolute){var E=P.getScale();a/=y._zoom*N(1,N(B(E.x),B(E.y)))}else if(!gs(V.fitSize,P,y)){var i=gs(V.width,P,y),n=gs(V.height,P,y);a*=N(P.getWidth()/i,P.getHeight()/n)}W._40O(j,a);var D=A("clip.percentage");if(D!=s&&(j.clipRect=sq(P.getAnchorRect(),A("clip.direction"),D)),L){var r=A("shape.fill.clip.percentage");r!=s&&(j.shapeClipRect=sq(P.getAnchorRect(),A("shape.fill.clip.direction"),r));var J=A("shape.foreground.clip.percentage");J!=s&&(j.shapeForegroundClipRect=sq(P.getAnchorRect(),A("shape.foreground.clip.direction"),J))}},getPosition:function(o,a,g,Y){var p=xm(o,this._83o.rect,Y);return p.x+=a,p.y+=g,p},_80o:function(v){var _=this,G=_.s,j=_.gv,n=_._data,s=_._83o,q=s.rect,u=s.position,Y=s.rotation,Z=s.anchor,K=s.scale,b=s.shape,W=s.clipRect;if(!_._checkEmptyRect||q.width>0&&q.height>0){var o=n.getSize();if(o.x=-o.width*Z.x,o.y=-o.height*Z.y,Ag&&!Dp&&bs(v,o.width,o.height),v.save(),bs(v,u.x,u.y),no(v,Y),Po(v,K.x,K.y),W&&(v.beginPath(),v.rect(W.x,W.y,W.width,W.height),v.clip()),j._drawForChecking&&s.img&&gs(s.img.pixelPerfect,n,j)===!1)lc(v,o.x,o.y,o.width,o.height,"#888888");else if(_.freeDraw)_.freeDraw(v,o,s);else if(b){var m,e,a,r,Q=s._60o,F=Kg(v,Q),X=s._27Q,S=s._54o,V=s.shapeGradientPack,$=s.gray,M=v.lineJoin,c=v.lineCap,f=function(o){return $?p.toGrayColor(o):o};"roundRect"===b?m=G("shape.corner.radius"):"polygon"===b?(m=G("shape.polygon.side"),e=G("shape.corner.radius"),a=G("shape.regular")):"arc"===b&&(m=G("shape.arc.from"),e=G("shape.arc.to"),a=G("shape.arc.close"),r=G("shape.arc.oval")),v.lineJoin=s._62o,v.lineCap=s._61o;var D=f(s._53o);if(D||X||V){var i=s.shapeClipRect;i&&(v.save(),v.beginPath(),v.rect(i.x,i.y,i.width,i.height),v.clip()),Fk(v,b,o,m,e,a,r),V?wl(v,V,function(u){return Nb(u,s.bodyColor)},!1,o):X?ji(v,X,f(s.bodyColor),null,n,j):fj(v,D,s.shapeGradient,f(s._59o),o),v.fill(),V&&v.restore(),i&&v.restore(),v!==F&&Fk(F,b,o,m,e,a,r)}else Fk(F,b,o,m,e,a,r);var t=s.shapeForeground;if(t){v.save();var T=s.shapeForegroundClipRect;T&&(v.beginPath(),v.rect(T.x,T.y,T.width,T.height),v.clip()),Fk(v,b,o,m,e,a,r),fj(v,t,G("shape.foreground.gradient"),f(G("shape.foreground.gradient.color")),o),v.fill(),v.restore()}if(S>0){var J=G("shape.border.width.absolute");J&&(v.save(),v.setTransform(1,0,0,1,0,0)),v.lineWidth=S;var H=f(s._55o),z=s.shapeBorderGradientPack;z?wl(v,z,f,!0,o):s.shapeBorderRepeatImage?nj(v,s.shapeBorderRepeatImage,H,null,n,j):v.strokeStyle=H,v.stroke(),z&&v.restore(),J&&v.restore(),s._56o&&Dg(v,H,f(s._57o),S,j._zoom,s._58o)}if(Ee(v,Q),G("shape.dash")){var P=G("shape.dash.width")||S;if(P>0){Q=G("shape.dash.pattern");var F=Kg(v,Q,_._2Q("shape.dash.offset"));F!==v&&Fk(F,b,o,m,e,a,r),_._1Q(v,"shape",P,Q)}}Ig(v,D,s._63o,o),v.lineJoin=M,v.lineCap=c}else{var A=_.interactiveInfo;A&&(v.interactiveInfo=A.bodyInfo={compInfos:[],matrix:new Wg(Y,u.x,u.y,K.x,K.y)}),s.gray&&(v.compGray=!0);var x=s.img;x&&x.cacheRule!=g&&(x=js(v,x,s.stretch,o.width,o.height,n,j,s.bodyColor)),id(v,x,s.stretch,o.x,o.y,o.width,o.height,n,j,s.bodyColor),v.compGray=!1,v.interactiveInfo=g}v.restore()}_._39O(v,s)},_48O:function(){},_47O:function(){}});var cc=function(P,m){$e(cc,this,[P,m])},qs=function(J,K,R,h){var v=lr(J,K);return R=h?Q(R,v):_e(R,v),v?R/=v:R=0,{x:J.x+(K.x-J.x)*R,y:J.y+(K.y-J.y)*R}
};zs(cc,Cq,{_3O:function(){var i,G=this,O=G._data,P=G.gv,H=G.s,U=H(Qj),X=O.isLooped(),b=H("edge.width"),F=G.getBodyColor("edge.color"),q=H("edge.center"),$=H("edge.offset"),y=P.getBorderColor(O),f=y?H("border.width"):0,J=G.getSelectWidth(),E=O._40I,Z=O._41I,t=G._78o=E&&Z?{looped:X,type:U,width:b,center:q,color:F,repeatImage:dg(H("edge.repeat.image"),F),borderColor:y,borderWidth:f,_97o:J?G.getSelectColor():g,selectWidth:J,pattern:H("edge.pattern"),cap:H("edge.cap"),join:H("edge.join"),is3d:H("edge.3d"),_67o:H("edge.3d.color"),_66o:H("edge.3d.accuracy"),gray:H("2d.gray")}:g;if(t){var e=p.getEdgeType(U);if(e){var I=e(O,Cb(G,P,O,X,U),P,G._19Q);I.points&&I.points.size()>1?(t.edgeTypeInfo=I,i=In(t.edgeTypeInfo.points)):I[kr]&&I.rect&&(t.edgeTypeInfo=I,i=I.rect)}else{var r=H("edge.source.anchor.x"),u=H("edge.source.anchor.y"),C=H("edge.target.anchor.x"),c=H("edge.target.anchor.y"),w=Jc(P,O,"source"),k=Jc(P,O,"target");if(U===tp){var d=t.points=H(sm)||Bn,S=d.size();t.segments=H("edge.segments");var x=r!==s||u!==s||hg(E),n=C!==s||c!==s||hg(Z);if(!q)if($)x||(w=qs(w,S?d.get(0):k,$,S)),n||(k=qs(k,S?d.get(S-1):w,$,S));else{var M;x||(M=Sp(w,S?d.get(0):k,Ec(P,E)),M&&(w={x:M[0],y:M[1]})),n||(M=Sp(S?d.get(S-1):w,k,Ec(P,Z)),M&&(k={x:M[0],y:M[1]}))}i=to(In(t.points),In(w,k))}else{var D=Cb(G,P,O,X,U);if(G._19Q||(D=-D),X)w=Wi(w),w.x=P.getNodeRect(E).x,t.radius=D,i={x:w.x-D,y:w.y-D,width:2*D,height:2*D};else{var m=lr(w,k),R=_e($,m),A={x:R,y:D},v={x:m-R,y:D},Y=xb(k.y-w.y,k.x-w.x),h=t.mat=new Tc(Y);if(t.orienAngle=Y,t.angle=k.x<w.x?Y+a:Y,t.rect={x:A.x,y:A.y,width:v.x-A.x,height:0},t.origin=w,A=h.tf(A),A.x+=w.x,A.y+=w.y,v=h.tf(v),v.x+=w.x,v.y+=w.y,q){var B={x:m,y:0};B=h.tf(B),B.x+=w.x,B.y+=w.y,i=In([w,A,v,B]),t.c1=w,t.c2=B}else i=In(A,v);w=A,k=v}}t.sourcePoint=w,t.targetPoint=k,O._lastSourcePoint=w,O._lastTargetPoint=k}var V=0;H("edge.dash")&&(V=H("edge.dash.width")||b);var Q="square"===t.cap?.71:.5;gd(i,N(V*Q,b*Q+f+J),t.join),G._68o(i)}},getRotation:function(l,L,b){l=l||0;var Q=this._78o;if(Q){var w,p=Q.angle,K=Q.points,z=Q.edgeTypeInfo;if(p!=g)return L?Q.orienAngle+l:p+l;if(z&&z[kr])return z.getRotation?z.getRotation(this,l,L,b):0;if(z&&z.points){var $=z.points;return w=$.size(),yb[b]?w&&0===w%2?$p($.get(w/2-1),$.get(w/2),L,l):l:Bc[b]?$p($.get(0),$.get(1),L,l):$p($.get(w-2),$.get(w-1),L,l)}if(K){var y=K.toArray();return y.unshift(Q.sourcePoint),y.push(Q.targetPoint),K=new Yn(y),w=K.size(),yb[b]?w&&0===w%2?$p(K.get(w/2-1),K.get(w/2),L,l):l:Bc[b]?$p(Q.sourcePoint,w?K.get(0):Q.targetPoint,L,l):$p(w?K.get(w-1):Q.sourcePoint,Q.targetPoint,L,l)}}return l},getPosition:function(Y,S,h,r,U){var w=this._78o;if(w){var D,V=w.type,A=w.points,j=w.edgeTypeInfo,e=w.sourcePoint,k=w.targetPoint;if(!V)return w.looped?{x:e.x-w.radius+S,y:e.y+h}:(U&&e&&k&&(e.x>k.x||e.x===k.x&&e.y>k.y)&&(Y=ie[Y],h=-h),D=xm(Y,w.rect,r),D.x+=S,D.y+=h,D=w.mat.tf(D),D.x+=w.origin.x,D.y+=w.origin.y,D);if(j&&j[kr])return j.getPosition?j.getPosition(this,Y,S,h,r,U):{x:(e.x+k.x)/2,y:(e.y+k.y)/2};if(A){var D,q=A.size();if(yb[Y]){if(q){var x=q%2;if(0===x)return Gd(A.get(q/2-1),A.get(q/2),Y,S,h,r,U);D=A.get((q-x)/2)}else D={x:(e.x+k.x)/2,y:(e.y+k.y)/2};return D=xm(Y,{x:D.x,y:D.y,width:0,height:0},r),D.x+=S,D.y+=h,D}return Bc[Y]?Gd(e,q?A.get(0):k,Y,S,h,r,U):Gd(q?A.get(q-1):e,k,Y,S,h,r,U)}if(j){var m=j.points,q=m.size();if(yb[Y]){var x=q%2;return 0===x?Gd(m.get(q/2-1),m.get(q/2),Y,S,h,r,U):(D=m.get((q-x)/2),D=xm(Y,{x:D.x,y:D.y,width:0,height:0},r),D.x+=S,D.y+=h,D)}return Bc[Y]?Gd(m.get(0),m.get(1),Y,S,h,r,U):Gd(m.get(q-2),m.get(q-1),Y,S,h,r,U)}}return Pf},_42:function(o){this._78o&&cc.superClass._42.call(this,o)},drawPath:function(Q,H){Q.beginPath();var $=H.type,o=H.points,m=H.segments,X=H.edgeTypeInfo;if(!$||o){var Y=H.sourcePoint,n=Y.x,J=Y.y,l=H.targetPoint,b=l.x,M=l.y;if($)if(m){var c=new Yn({x:n,y:J});c.addAll(o),c.add({x:b,y:M}),vg(Q,c,m)}else Q.moveTo(n,J),o.each(function(y){Q.lineTo(y.x,y.y)}),Q.lineTo(b,M);else H.looped?Q.arc(n,J,H.radius,0,L,!0):H.center?(Q.moveTo(H.c1.x,H.c1.y),Q.lineTo(n,J),Q.lineTo(b,M),Q.lineTo(H.c2.x,H.c2.y)):(Q.moveTo(n,J),Q.lineTo(b,M))}else X&&(X.points?vg(Q,X.points,X.segments):X[kr]&&X[kr](Q,X))},_80o:function(R){var K=this,s=K.s,U=K._78o,u=U.width,A=U.selectWidth,H=U.borderWidth,O=U.repeatImage,n=R.lineJoin,a=R.lineCap,C=U.gray,r=U.pattern;R.lineJoin=U.join,R.lineCap=U.cap,K.drawPath(Kg(R,r),U);var V=s("edge.width.absolute");V&&(R.save(),R.setTransform(1,0,0,1,0,0)),A&&(R.strokeStyle=U._97o,R.lineWidth=u+2*(H+A),R.stroke()),H&&(R.strokeStyle=C?p.toGrayColor(U.borderColor):U.borderColor,R.lineWidth=u+2*H,R.stroke());var d=C?p.toGrayColor(U.color):U.color;if(O?nj(R,O,d,null,K._data,K.gv):R.strokeStyle=d,R.lineWidth=u,R.stroke(),U.is3d){var E=C?p.toGrayColor(U._67o):U._67o;Dg(R,d,E,u,K.gv._zoom,U._66o)}if(Ee(R,r),s("edge.dash")){r=s("edge.dash.pattern");var N=Kg(R,r,K._2Q("edge.dash.offset"));N!==R&&K.drawPath(N,U),K._1Q(R,"edge",s("edge.dash.width")||u,r)}V&&R.restore(),R.lineJoin=n,R.lineCap=a},_48O:function(){},_47O:function(){}});var mb=function(n,C){$e(mb,this,[n,C])};zs(mb,yi,{_3O:function(){var A,x,Z=this,R=Z.s,D=Z._data,s=Z.gv;if(Z._88I=g,D.isExpanded()&&D.eachChild(function(d){if(Ob(d)){var j=s.getBoundsForGroup(d);j&&(x||(x=[]),x.push(j),A=to(A,j))}}),A){var p=s.getLabel(D),v=R("group.type"),d=R("group.border.width")||0,B=R("group.border.width.absolute"),S=d/2;B&&(d/=s._zoom),A=Al(v,x,A),ek(A,D,"group.padding",1),ff(A,d);var E=Z._88I={type:v,rect:A,_64o:A};if(!v&&p!=g){var n,$=Z.labelInfo={label:p,color:R("group.title.color"),font:R("group.title.font"),align:R("group.title.align")},F=uf($,p),k=F.width+d,l=F.height+d,z=R("group.title.align"),Q=R("group.title.orientation");if(Q===$l||Q===ep?(A.height+=d,k>A.width&&(A.width=k)):(Q===Vn||Q===qp)&&(A.width+=d,k>A.height&&(A.height=k)),n=z===Vn?A.x:z===qp?A.x+A.width-k:A.x+A.width/2-k/2,Q===ep)E.titleRect={x:A.x,y:A.y+A.height,width:A.width,height:l},E.rect={x:A.x,y:A.y,width:A.width,height:A.height+l},$.rect={x:n,y:A.y+A.height,width:k,height:l};else if(Q===Vn){var J=E.titleRect={x:A.x-l,y:A.y,width:l,height:A.height};E.rect={x:A.x-l,y:A.y,width:A.width+l,height:A.height},$.rect={x:J.x+l/2-A.height/2,y:J.y+A.height/2-l/2,width:A.height,height:l},$.rotation=-Math.PI/2}else if(Q===qp){var J=E.titleRect={x:A.x+A.width,y:A.y,width:l,height:A.height};E.rect={x:A.x,y:A.y,width:A.width+l,height:A.height},$.rect={x:J.x+l/2-A.height/2,y:J.y+A.height/2-l/2,width:A.height,height:l},$.rotation=Math.PI/2}else E.titleRect={x:A.x,y:A.y-l,width:A.width,height:l},E.rect={x:A.x,y:A.y-l,width:A.width,height:A.height+l},$.rect={x:n,y:A.y-l-S,width:k,height:l+d}}Z._40O(E,R("group.border.width")/2)}else mb.superClass._3O.call(Z)},getPosition:function(P,y,q,U){var o=this._88I;if(o){var m=xm(P,o.rect,U);return m.x+=y,m.y+=q,m}return mb.superClass.getPosition.apply(this,arguments)},_24O:function(g,M){var i=this._88I;(!i||i.type||"label2"===g)&&mb.superClass._24O.call(this,g,M)},_80o:function(q){var A=this,C=A._88I;if(C){var l=A._data,i=A.s,G=A.gv,T=C.type,m=C.rect,g=C._64o,X=C.titleRect,j=A.getBodyColor(),M=dg(i("group.image"),j),n=i("group.image.stretch"),s=A.getBodyColor("group.background"),f=dg(i("group.repeat.image"),j),L=i("group.gradient.pack"),J=i("group.gradient"),$=i("group.gradient.color"),H=i("group.border.width"),P=i("group.border.color"),d=i("group.border.pattern"),h=i("group.title.orientation"),k=i("group.depth"),c=i("group.border.radius"),O=i("group.border.join"),o=i("group.border.cap"),B=i("group.border.width.absolute");B&&(H/=G._zoom);var t=P,V=i("group.border.repeat.image");if(V&&(V=dg(V,P))&&(t=Qm(q,V,P,null,l,G)),T){var a=q.lineJoin,v=q.lineCap;if(q.lineJoin=O,q.lineCap=o,M){if(q.save(),Fk(q,T,m,c),q.clip(),id(q,M,n,m.x,m.y,m.width,m.height,l,G,j),q.restore(),H>0){var Z=Kg(q,d);Fk(Z,T,m,c),q.lineWidth=H,q.strokeStyle=t,q.stroke(),Ee(q,d)}}else{var Z=Kg(q,d);s||f||L?(Fk(q,T,m,c),L?wl(q,L,function(G){return Nb(G,j)},!1,m):f?ji(q,f,j,null,l,G):fj(q,s,J,$,m),q.fill(),L&&q.restore(),q!==Z&&Fk(Z,T,m,c)):Fk(Z,T,m,c),H>0&&(q.lineWidth=H,q.strokeStyle=t,q.stroke()),Ee(q,d),T===Em&&Ig(q,s,k,m)}q.lineJoin=a,q.lineCap=v}else{var E=i("group.title.background");if((!c||0>c)&&(c=0),M)id(q,M,n,g.x,g.y,g.width,g.height,l,G,A.getBodyColor());else if(s||f)if(f?ji(q,f,j,null,l,G):fj(q,s,J,$,g),0===H)Fk(q,Em,g),q.fill(),Ig(q,s,k,g);else{switch(q.beginPath(),h){case ep:ti(q,g.x,g.y,g.width,g.height,c,c,0,0);break;case Vn:ti(q,g.x,g.y,g.width,g.height,0,c,0,c);break;case qp:ti(q,g.x,g.y,g.width,g.height,c,0,c,0);break;case $l:ti(q,g.x,g.y,g.width,g.height,0,0,c,c)}q.fill()}if(X&&E)if(0===H)lc(q,X.x,X.y,X.width,X.height,E),Ig(q,E,k,X);else{switch(q.beginPath(),q.fillStyle=E,h){case ep:ti(q,X.x,X.y,X.width,X.height,0,0,c,c);break;case Vn:ti(q,X.x,X.y,X.width,X.height,c,0,c,0);break;case qp:ti(q,X.x,X.y,X.width,X.height,0,c,0,c);break;case $l:ti(q,X.x,X.y,X.width,X.height,c,c,0,0)}q.fill()}if(H>0){var Z=Kg(q,d);if(Fk(Z,"roundRect",m,c),q.save(),q.lineWidth=H,q.strokeStyle=t,q.lineJoin=O,q.lineCap=o,q.closePath(),q.stroke(),X&&i("group.splitLine")){var S=X.x,Y=X.y,I=X.width,u=X.height;q.beginPath(),h===ep?(q.moveTo(S,Y),q.lineTo(S+I,Y)):h===Vn?(q.moveTo(S+I,Y),q.lineTo(S+I,Y+u)):h===qp?(q.moveTo(S,Y),q.lineTo(S,Y+u)):(q.moveTo(S,Y+u),q.lineTo(S+I,Y+u))}q.stroke(),q.restore(),Ee(Z,d)}}A._39O(q,C)}else mb.superClass._80o.call(A,q)}});var dl=function(x,T){$e(dl,this,[x,T])};zs(dl,yi,{_80o:function(B){this._39O(B,this._83o)}});var De=function(q,$){$e(De,this,[q,$])};zs(De,yi,{_3O:function(){var p=this,V=p._data,F=p.s,Y=p.gv,A=V.getPoints(),y=Y.getBorderColor(V),E=y?F("border.width"):0,W=p.getSelectWidth(),R=F("shape.border.width"),a=V.getRect(),D=V.getAnchorRect(),u=Y.getBodyColor(V),m=F("shape.border.color"),T=p._99o=A.isEmpty()?g:{rect:a,rotation:V.getRotation(),fillRule:F("shape.fill.rule"),scale:V.getScale(),position:V.p(),points:A,segments:V.getSegments(),bodyColor:u,borderColor:y,borderWidth:E,_94o:F("shape.border.3d"),_95o:F("shape.border.3d.color"),_96o:F("shape.border.3d.accuracy"),_97o:W?p.getSelectColor():g,selectWidth:W,_53o:F("shape.background"),_27Q:dg(F("shape.repeat.image"),u),shapeGradientPack:F("shape.gradient.pack"),shapeBorderGradientPack:F("shape.border.gradient.pack"),_54o:R,_55o:m,shapeBorderRepeatImage:dg(F("shape.border.repeat.image"),m),shapeGradient:F("shape.gradient"),_59o:F("shape.gradient.color"),_60o:F("shape.border.pattern"),_61o:F("shape.border.cap"),_62o:F("shape.border.join"),shapeForeground:F("shape.foreground"),gray:F("2d.gray")};if(T){D.x+=T.position.x,D.y+=T.position.y,T.gradientRect=D;var l=V.getScale(),$=N(1,N(B(l.x),B(l.y)));F("shape.dash")&&F("shape.dash.width")>R&&(R=F("shape.dash.width"));var e,I=F("shape.border.width.absolute");e=I?(R+E+W)/p.gv._zoom/$:R*("square"===T._61o?.71:.5)+E+W/p.gv._zoom/$,e&&(e*=$,a=Wi(a),gd(a,e,T._62o)),p._68o(a);var d=F("clip.percentage");d!=s&&(T.clipRect=sq(V.getAnchorRect(),F("clip.direction"),d));var b=F("shape.fill.clip.percentage");b!=s&&(T.shapeClipRect=sq(V.getAnchorRect(),F("shape.fill.clip.direction"),b));var o=F("shape.foreground.clip.percentage");o!=s&&(T.shapeForegroundClipRect=sq(V.getAnchorRect(),F("shape.foreground.clip.direction"),o))}},getPosition:function(J,p,K,l){var u=this._99o;if(u){var f=xm(J,u.rect,l);return f.x+=p,f.y+=K,f}return Pf},_42:function(I){this._99o&&De.superClass._42.call(this,I)},_80o:function(A){var Y,M=this,H=M.s,e=M._99o,T=e.position,m=e.scale,$=e.rotation,K=e.borderWidth,u=e.selectWidth/M.gv._zoom,P=e._27Q,h=e.shapeGradientPack,x=e._54o,d=e.clipRect,D=e.shapeClipRect,N=e.points,_=e.segments,F=M._data.isClosePath(),s=e.fillRule,w=e.gray,E=function(h){return w?p.toGrayColor(h):h},i=E(e._53o),f=i||P||h;A.save(),bs(A,T.x,T.y),no(A,$),Po(A,m.x,m.y),d&&(A.beginPath(),A.rect(d.x,d.y,d.width,d.height),A.clip()),f&&D&&(A.save(),A.beginPath(),A.rect(D.x,D.y,D.width,D.height),A.clip()),U.Default.extractShapeTranslation?(N=Wi(N),N.forEach(function(L){L.x-=T.x,L.y-=T.y})):bs(A,-T.x,-T.y);var y=e._60o,S=Kg(A,y),J=A.lineJoin,Z=A.lineCap;A.lineJoin=e._62o,A.lineCap=e._61o;var R=E(e.bodyColor);f?(vg(A,N,_,F),h?wl(A,h,function(f){return Nb(f,e.bodyColor)},!1,e.rect):P?ji(A,P,R,null,M._data,M.gv):(Y=R?R:i,fj(A,Y,e.shapeGradient,E(e._59o),e.gradientRect)),A.fill(s),h&&A.restore(),D&&(A.restore(),bs(A,-T.x,-T.y)),S!==A&&vg(S,N,_,F)):vg(S,N,_,F);var G=e.shapeForeground;if(G){A.save();var W=e.shapeForegroundClipRect;W&&(bs(A,T.x,T.y),A.beginPath(),A.rect(W.x,W.y,W.width,W.height),A.clip(),bs(A,-T.x,-T.y)),vg(A,N,_,F),fj(A,G,H("shape.foreground.gradient"),E(H("shape.foreground.gradient.color")),e.gradientRect),A.fill(s),A.restore()}var O=H("shape.border.width.absolute");if(O&&(A.save(),A.setTransform(1,0,0,1,0,0)),u&&(A.strokeStyle=e._97o,A.lineWidth=x+2*(K+u),A.stroke()),K&&(A.strokeStyle=E(e.borderColor),A.lineWidth=x+2*K,A.stroke()),x){Y=E(e._55o);var v=e.shapeBorderGradientPack;v?wl(A,v,E,!0,e.rect):e.shapeBorderRepeatImage?nj(A,e.shapeBorderRepeatImage,Y,null,M._data,M.gv):(!i&&R&&(Y=R),A.strokeStyle=Y),A.lineWidth=x,A.stroke(),v&&A.restore(),e._94o&&Dg(A,Y,E(e._95o),x,M.gv._zoom,e._96o)}if(Ee(A,y),H("shape.dash")){var I=H("shape.dash.width")||x;if(I>0){y=H("shape.dash.pattern");var S=Kg(A,y,M._2Q("shape.dash.offset"));S!==A&&vg(S,N,_,F),M._1Q(A,"shape",I,y)}}O&&A.restore(),A.lineJoin=J,A.lineCap=Z,A.restore()},_48O:function(){},_47O:function(){}});var Fp=function(u,M){$e(Fp,this,[u,M])};zs(Fp,De,{getRotation:function(U,g,u){U=U||0;var E=this._data.getPoints(),$=E.size();return $>1?yb[u]?$&&0===$%2?$p(E.get($/2-1),E.get($/2),g,U):U:Bc[u]?$p(E.get(0),E.get(1),g,U):$p(E.get($-2),E.get($-1),g,U):U},getPosition:function(I,v,G,_,n){var M=this._data.getPoints(),Z=M.size();if(Z>1){if(yb[I]){var k=Z%2;if(0===k)return Gd(M.get(Z/2-1),M.get(Z/2),I,v,G,_,n);var b=M.get((Z-k)/2),V={x:b.x,y:b.y,width:0,height:0};return b=xm(I,V,_),b.x+=v,b.y+=G,b}return Bc[I]?Gd(M.get(0),M.get(1),I,v,G,_,n):Gd(M.get(Z-2),M.get(Z-1),I,v,G,_,n)}return Pf}});var xe=function(v,d){$e(xe,this,[v,d])};zs(xe,yi,{_3O:function(){var r=this;xe.superClass._3O.call(r);var G=r.s,q=r._83o;r._82o=q.img||q.shape?g:{background:r.getBodyColor("grid.background"),depth:G("grid.depth"),rect:q.rect,_88o:G("grid.cell.depth"),cellBorderColor:G("grid.cell.border.color"),_89o:G("grid.row.count"),_90o:G("grid.column.count"),block:G("grid.block"),_91o:G("grid.block.color"),_92o:G("grid.block.padding"),_93o:G("grid.block.width")}},_80o:function(Y){var v=this,C=v._82o;if(!C)return xe.superClass._80o.call(v,Y),void 0;var _,S,r=v._data,E=C.background,t=C.rect,I=C.block,e=C._91o,f=C._92o,T=C._93o,h=C._88o,B=C.cellBorderColor,y=C._89o,o=C._90o;if(E)if(lc(Y,t.x,t.y,t.width,t.height,E),Ig(Y,E,C.depth,t),h)for(_=0;y>_;_++)for(S=0;o>S;S++)t=r.getCellRect(_,S),t&&Ig(Y,E,h,t);else if(B){for(Y.beginPath(),_=0;y>_;_++)for(S=0;o>S;S++)t=r.getCellRect(_,S),t&&Y.rect(t.x,t.y,t.width,t.height);Y.strokeStyle=B,Y.lineWidth=1,Y.stroke()}if("h"===I)for(_=0;y>_;_++)t=to(r.getCellRect(_,0),r.getCellRect(_,o-1)),ff(t,f),El(Y,e,t.x,t.y,t.width,t.height,T);else if("v"===I)for(S=0;o>S;S++)t=to(r.getCellRect(0,S),r.getCellRect(y-1,S)),ff(t,f),El(Y,e,t.x,t.y,t.width,t.height,T);v._39O(Y,v._83o)}});var Dj=function(U,$){$e(Dj,this,[U,$])},iq=o?gj().getContext("2d"):g;zs(Dj,yi,{_checkEmptyRect:!1,_81o:function(){var F=this._data,p=Dj.superClass._81o.call(this),w=F.s("text");if(w!=g){w+="";var j,i=F.s("text.font"),b=F.s("text.align"),e=F.s("text.vAlign"),f=F.s("text.wrap"),V=F.s("text.vertical"),o=F.s("text.vertical.gap"),X=F.s("text.letter.gap")||0,h=F.getWidth(),d=F.getHeight();if(null==o&&(o=1),V){var x;x=f?ql(w,d,i,X,V,o):[w];var c=(x.length-1)*X,D=0;iq.textBaseline=$l,iq.font=i,x.forEach(function(Q){for(var p=Q.length,M=0,X=(p-1)*o,U=0;p>U;U++){var g=iq.measureText(Q[U]);X+=g.fontBoundingBoxDescent,M=N(M,g.width)}c+=M,D=N(X,D)});var G=(x.length-1)*X;x.forEach(function(e){G+=e}),j={width:c,height:D}}else{var x=f?ql(w,h,i,X,V,o):w.split("\n"),C=x.length;if(C>1){var E=Lr(i,w).height,c=0,D=E*C+o*(C-1);x.forEach(function(R){c=N(c,Lr(i,R).width)}),j={width:c,height:D}}else j=Lr(i,w),X&&(j.width+=(w.length-1)*X)}var U,H,z=j.width,I=j.height,O=F.getAnchor();"left"===b?U=-h*O.x:"center"===b?U=-h*O.x+(h-z)/2:"right"===b&&(U=h*(1-O.x)-j.width),"top"===e?H=-d*O.y:"middle"===e?H=-d*O.y+(d-I)/2:"bottom"===e&&(H=d*(1-O.y)-j.height);var L,W=F.getMatrix();if(L=In([W.tf(U,H),W.tf(U+z,H),W.tf(U+z,H+I),W.tf(U,H+I)]),p=to(p,L),p&&F.s("text.shadow")){var T=Wi(p);T.x+=F.s("text.shadow.offset.x"),T.y+=F.s("text.shadow.offset.y"),ff(T,F.s("text.shadow.blur")),p=to(p,T)}}return p}});var ll=lm.Interactor=function(N){this.gv=this._graphView=N};hj("Interactor",z,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(L){this.gv.fi(L)},setCursor:function(U){Pb||this.gv.setCursor(U)},startDragging:function(i){var b=this;b._lastClientPoint=vq(i),b._lastLogicalPoint=b.gv.lp(i),Nm(b,i)},clearDragging:function(){var C=this;C._lastClientPoint=C._lastLogicalPoint=C._logicalPoint=g},autoScroll:function(a){return this.gv.autoScroll(a,this._lastClientPoint)}});var fi=g,jm=function(Q){fi.handleWindowTouchMove(Q)},Hb=function(A){fi.handleWindowTouchEnd(A),J(q,Jb,jm),J(q,Xi,Hb),fi=g},_r=function(c){fi.handleWindowMouseMove(c)},Kh=function(v){fi.handleWindowMouseUp(v),J(q,Xm,_r),J(q,xp,Kh),fi=g},Kj=function(Z,e){if(Z!==fi){var _=jc(e);fi?_?fi.handleWindowTouchEnd(e):fi.handleWindowMouseUp(e):_?(C(q,Jb,jm),C(q,Xi,Hb)):(C(q,Xm,_r),C(q,xp,Kh)),fi=Z}},Uc=function(q){var I=this;I.gv=q,I._is2d=q instanceof lm.GraphView,I._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",Wj,"wheel"].forEach(function(r){I.addListener(r)}),I.initImageResource()};zs(Uc,ll,{enableVR:function(V){var x=this;!!x._vrEnable!==V&&(x._vrEnable=V,V?x.gv.vr.mp(x.onVRControllerChange,x):x.gv.vr.ump(x.onVRControllerChange,x))},onVRControllerChange:function(e){var Z=this,g=e.property,a=e.newValue,k=a.id,d=Z.gv.vr.getController(k),Q=d.getRay();if(Q){Q.controllerId=k;var P=Z.gv.vr.getRayEventType(Q,g,a._62O);switch(P){case"down":Z.handle_mousedown(Q);break;case"up":fi&&Kh(Q);break;case"move":Z.handle_mousemove(Q),fi&&Z.handleWindowMouseMove(Q)}}},setPreventEventDefault:function(P,F){var i=this,g=i._eventListeners[P];g?g._prevent=F:i._eventListeners[P]=g={_removal:s,_prevent:F}},removeListener:function(F){var l=this,U=l._eventListeners[F];U&&U._removal&&(U._removal(),U._removal=s)},addListener:function(R){var Q=this,Y=Q._eventListeners[R];if(Y||(Q._eventListeners[R]=Y={_removal:s,_prevent:!0}),!Y||!Y._removal){var i=function(K){Y._prevent&&p.preventDefault(K),Q.disabled||Q.gv._48Q||("wheel"===R?Hi(Q,K):Q["handle_"+R](K))};C(Q.gv.getView(),R,i),Y._removal=function(){J(Q.gv.getView(),R,i)}}},handleWindowTouchMove:function(J){this.handleWindowMouseMove(J)},handleWindowMouseMove:function(V){return!this.downInfo||jc(V)&&1!==ns(V)?(this.isDragging&&(this.handleDownInfo("onEndDrag",V),this.isDragging=!1),void 0):(this.isDragging?this.handleDownInfo("onDrag",V):(this.handleDownInfo("onBeginDrag",V),this.isDragging=!0),void 0)},handleWindowTouchEnd:function(p){this.handleWindowMouseUp(p)},handleWindowMouseUp:function(F){if(this.isDragging&&(this.handleDownInfo("onEndDrag",F),this.isDragging=!1),this.downInfo){var q=this.handle("onUp",F);if(q&&q.data===this.downInfo.data){this.handleMissingUp(F);var M=this,B=2===F.button?"onContextMenu":"onClick";if(!M._dbclickTimer)return M._dbclickTimer=yo(function(){delete M._dbclickTimer,M.handleClick(F,B,q),this.downInfo=g},p.clickDelay),void 0;pg(M._dbclickTimer),delete M._dbclickTimer,B="onDoubleClick",M.handleClick(F,B,q)}else this.handleDownInfo("onUp",F);this.downInfo=g,this.downComps=g}},handle_mouseleave:function(E){var u=this,z=u.gv;u._hoverTimer&&(pg(u._hoverTimer),delete u._hoverTimer);var K=u.currentInfo?u.currentInfo.data:g;if(K){K.s("onLeave")&&K.s("onLeave")(E,K,z),u.fire("data","onLeave",E,K);var T=u.currentInfo?u.currentInfo.hits:g;if(T)for(var x in T)u.handleLeave(E,x);u.currentInfo=g}},handle_mousewheel:function(u){u.scrollDelta=u.wheelDelta/40,this.handle("onScroll",u)},handle_DOMMouseScroll:function(S){S.scrollDelta=2===S.axis?-S.detail:0,this.handle("onScroll",S)},handle_touchstart:function(C){this.handle_mousedown(C)},handle_touchmove:function(U){this.handle("onMove",U)},handle_mousedown:function(l){this.isDragging&&(this.handleDownInfo("onEndDrag",l),this.isDragging=!1),this.downComps=[],this.downInfo=this.handle("onDown",l),this.downInfo&&Kj(this,l)},handle_mousemove:function(P){var C=this,D=C.gv;if(C._hoverTimer&&(pg(C._hoverTimer),delete C._hoverTimer),!D._panning&&!D._moving){var Y,i,o,x=C.handle("onMove",P),v=this.currentInfo?this.currentInfo.data:g,B=this.currentInfo?this.currentInfo.hits:g;if(x&&(i=x.data,o=x.hits,C._hoverTimer=yo(function(){pg(C._hoverTimer),delete C._hoverTimer,C.handle("onHover",P,x)},D.getHoverDelay()||p.hoverDelay)),i!==v){if(v&&(v.s("onLeave")&&v.s("onLeave")(P,v,D),this.fire("data","onLeave",P,v)),i&&(i.s("onEnter")&&i.s("onEnter")(P,i,D),this.fire("data","onEnter",P,i)),B)for(Y in B)this.handleLeave(P,Y);if(o)for(Y in o){var $=o[Y],j=i._interactPrefix=$.prefix,M=j&&i.a(j+"onEnter")||$.target.onEnter;M&&M.call($.target,P,i,D,$.point,$.width,$.height),this.fire($.type,"onEnter",$.event,$.data,$.image,$.comp,$.point,$),i._interactPrefix=null}}else{if(B)for(Y in B)o&&o[Y]||this.handleLeave(P,Y);if(o)for(Y in o)if(!B||!B[Y]){var $=o[Y],j=i._interactPrefix=$.prefix,M=j&&i.a(j+"onEnter")||$.target.onEnter;M&&M.call($.target,P,i,D,$.point,$.width,$.height),this.fire($.type,"onEnter",$.event,$.data,$.image,$.comp,$.point,$),i._interactPrefix=null}}this.currentInfo=x}},handle:function(I,n,S){var w,t=this,V=t.gv;if(t._is2d){if(S=S||V.getDataInfoAt(n),!S||!V.isInteractive(S.data))return;if(w=S.ui.interactiveInfo){var $,z=S.data;if(z.s(I)&&z.s(I)(n,z,V),this.fire("data",I,n,z),"body"===S.part&&w.bodyInfo)$="body",S.hits=this.handleImage($,V.getImage(z),I,n,z,S.point,w.bodyInfo);else if("icons"===S.part&&w._38o){var O=w._38o[S.name];O&&O[S.index]&&($="icons|"+S.name+"|"+S.index,S.hits=this.handleImage($,S.icon,I,n,z,S.point,O[S.index]))}}return S}var z,L;if(!S)if(n&&n instanceof U.Math.Ray&&V.isVREnabled()){var m=V.vr.intersectWorld(n);if(z=m.data,L=m.intersect,V.vr.renderRayDuringInteraction(n,z,L),!z)return;var l=V.getData3dUI(z);if(w=l.interactiveInfo,!w)return;S={data:z,part:L.part,ui:l}}else{if(S=V.getDataInfoAt(n),!S)return;S&&(S={data:S.data,part:S.part})}if(V.isInteractive(S.data)){if(!L){z=S.data;var l=V.getData3dUI(z);if(S.ui=l,w=l.interactiveInfo,!w)return S;if(L=V.intersectObject(n,z),!L)return S}z.s(I)&&z.s(I)(n,z,V),this.fire("data",I,n,z);var G,B=L.part;return"body"!==B&&(G=z.s(B+".image")||z.s("shape3d."+B+".image")),G||(G=z.s("all.image")||z.s("shape3d.image")),G?(w="object"==typeof G?w[G.uuid]:w[G],w&&w.bodyInfo?(S.part="body",S.interactiveInfo=w,S.point=this._convertUVToPoint(L.uv,w),S.image=G,S.hits=this.handleImage("body",G,I,n,z,S.point,w.bodyInfo),S):S):S}},_handleLeaveOrMissing:function(A,B,b){var f="leave"===A?this.currentInfo:this.downInfo;if(f){var C=f.interactiveInfo||f.ui.interactiveInfo;if(C){var V,r,x=f.data;if(this._is2d){if(r=this.gv.lp(B),"body"===f.part&&C.bodyInfo)V="body","leave"===A?this.handleLeaveImage(b,V,this.gv.getImage(x),B,x,r,C.bodyInfo):this.handleMissingUpImage(V,this.gv.getImage(x),B,x,r,C.bodyInfo);else if("icons"===f.part&&C._38o){var I=C._38o[f.name];I&&I[f.index]&&(V="icons|"+f.name+"|"+f.index,"leave"===A?this.handleLeaveImage(b,V,f.icon,B,x,r,I[f.index]):this.handleMissingUpImage(V,f.icon,B,x,r,I[f.index]))}}else{if(!C.bodyInfo)return;var Q=this.gv.intersectObject(B,x);r=Q&&Q.uv?this._convertUVToPoint(Q.uv,C):{x:1/0,y:1/0},"leave"===A?this.handleLeaveImage(b,"body",f.image,B,x,r,C.bodyInfo):this.handleMissingUpImage("body",f.image,B,x,r,C.bodyInfo)}}}},handleClick:function(d,D,k){var O=this,C=this.downInfo;if(C&&k){var F,W=k.interactiveInfo||k.ui.interactiveInfo,c=k.data,y=this.gv;if(c.s(D)&&c.s(D)(d,c,y),O.fire("data",D,d,c),W)if(this._is2d){if(C.part===k.part){var u=y.lp(d);"body"===k.part&&W.bodyInfo&&(F="body",this.handleClickImage(F,y.getImage(c),D,d,c,u,W.bodyInfo,k))}}else{if(!W.bodyInfo)return;var h=y.intersectObject(d,c);if(!h)return;u=this._convertUVToPoint(h.uv,W),this.handleClickImage("body",C.image,D,d,c,u,W.bodyInfo,k)}}},handleDownInfo:function(S,i){if(this.downInfo){var u=this.downInfo,n=this.gv,$=u.interactiveInfo||u.ui.interactiveInfo;if($){var O,F=u.data;if(F.s(S)&&F.s(S)(i,F,n),this.fire("data",S,i,F),this._is2d){var h=n.lp(i);if("body"===u.part&&$.bodyInfo)O="body",this.handleDownInfoImage(O,n.getImage(F),S,i,F,h,$.bodyInfo);else if("icons"===u.part&&$._38o){var T=$._38o[u.name];T&&T[u.index]&&(O="icons|"+u.name+"|"+u.index,this.handleDownInfoImage(O,u.icon,S,i,F,h,T[u.index]))}}else{if(!$.bodyInfo)return;var X;if("onBeginDrag"===S?(X=n._raycaster.intersectObjectAndRecordTriangle(i,F),X&&($.beginDragIntersectInfo=X.triangleInfo)):X=n.intersectObject(i,F),!X&&("onDrag"!==S&&"onEndDrag"!==S||!$.beginDragIntersectInfo||(X=n._raycaster.intersectLastTriangle(i,$.beginDragIntersectInfo)),!X))return;h=this._convertUVToPoint(X.uv,$),this.handleDownInfoImage("body",u.image,S,i,F,h,$.bodyInfo)}}}},fire:function(k,X,D,Z,S,O,r,a){this.gv.fi({kind:X,type:k,event:D,data:Z,image:S,comp:O,view:this.gv,point:r,width:a?a.width:s,height:a?a.height:s})},handleImage:function(l,U,Z,v,j,A,t){var d={};if(U&&(U=dg(U))){var H=this.gv,r=t.rect,N=this.convertPoint(A,t);N.inRect&&(U[Z]&&U[Z](v,j,H,N,r.width,r.height),this.fire("image",Z,v,j,U,s,N,r),d[l+"|image"]={target:U,type:"image",image:U,data:j,event:v,point:N,width:r.width,height:r.height});for(var e,b=t.compInfos,g=U,h=b.length-1;h>=0;h--){var u=b[h],X=u.comp;if(N=this.convertPoint(A,u,g,X,H,j),N.inRect){r=u.rect;var M=j._interactPrefix=u.prefix,i=M&&j.a(M+Z)||X[Z];if(i&&(e=i.call(X,v,j,H,N,r.width,r.height)),this.fire("comp",Z,v,j,U,X,N,r),e!==!0&&(U=r.image)&&(U[Z]&&(e=U[Z](v,j,H,N,r.width,r.height)),this.fire("image",Z,v,j,U,s,N,r)),j._interactPrefix=null,d[l+"|"+h]={target:X,type:"comp",comp:X,image:U,data:j,event:v,point:N,width:r.width,height:r.height,prefix:M},this.downComps&&this.downComps.push(X),U&&(d[l+"|"+h+"|image"]={target:U,type:"image",image:U,data:j,event:v,point:N,width:r.width,height:r.height,prefix:M}),e===!0)break}}}return d},handleLeave:function(k,P){return this._handleLeaveOrMissing("leave",k,P)},handleMissingUp:function(x){return this._handleLeaveOrMissing("missing",x)},handleLeaveImage:function(a,c,V,i,F,$,Z){if(V&&(V=dg(V))){var x=this.gv,p=Z.rect,R=this.convertPoint($,Z);a===c+"|image"&&(V.onLeave&&V.onLeave(i,F,x,R,p.width,p.height),this.fire("image","onLeave",i,F,V,s,R,p));for(var f,l=Z.compInfos,L=V,K=l.length-1;K>=0;K--){var D=l[K],n=D.comp;R=this.convertPoint($,D,L,n,x,F),p=D.rect;var E=F._interactPrefix=D.prefix;if(a===c+"|"+K){var H=E&&F.a(E+"onLeave")||n.onLeave;H&&(f=H.call(n,i,F,x,R,p.width,p.height)),this.fire("comp","onLeave",i,F,V,n,R,p)}if(f!==!0&&(V=p.image)&&a===c+"|"+K+"|image"&&(V.onLeave&&(f=V.onLeave(i,F,x,R,p.width,p.height)),this.fire("image","onLeave",i,F,V,s,R,p)),F._interactPrefix=null,f===!0)break}}},handleMissingUpImage:function(E,V,N,t,M,_){var F="onUp",W=this.downInfo.hits;if(W&&V&&(V=dg(V))){var q=this.gv,f=_.rect,L=this.convertPoint(M,_);!L.inRect&&W[E+"|image"]&&(V[F]&&V[F](N,t,q,L,f.width,f.height),this.fire("image",F,N,t,V,s,L,f));for(var Q,T=_.compInfos,I=V,r=T.length-1;r>=0;r--){var J=T[r],w=J.comp;if(L=this.convertPoint(M,J,I,w,q,t),!L.inRect){f=J.rect;var b=t._interactPrefix=J.prefix;if(W[E+"|"+r]){var P=b&&t.a(b+F)||w[F];P&&(Q=P.call(w,N,t,q,L,f.width,f.height)),this.fire("comp",F,N,t,V,w,L,f)}if(Q!==!0&&(V=f.image)&&W[E+"|"+r+"|image"]&&(V[F]&&(Q=V[F](N,t,q,L,f.width,f.height)),this.fire("image",F,N,t,V,s,L,f)),t._interactPrefix=null,Q===!0)break}}}},handleDownInfoImage:function(u,l,K,c,A,b,p){var M=this.downInfo.hits;if(M&&l&&(l=dg(l))){var V=this.gv,H=p.rect,r=this.convertPoint(b,p);M[u+"|image"]&&(l[K]&&l[K](c,A,V,r,H.width,H.height),this.fire("image",K,c,A,l,s,r,H));for(var x,O=p.compInfos,P=l,B=O.length-1;B>=0;B--){var t=O[B],$=t.comp;r=this.convertPoint(b,t,P,$,V,A),H=t.rect;var D=A._interactPrefix=t.prefix,Y=["onDrag","onEndDrag"].indexOf(K)>=0;if(!Y&&M[u+"|"+B]||Y&&this.downComps&&this.downComps.indexOf($)>=0){var i=D&&A.a(D+K)||$[K];i&&(x=i.call($,c,A,V,r,H.width,H.height)),this.fire("comp",K,c,A,l,$,r,H)}if(x!==!0&&(l=H.image)&&M[u+"|"+B+"|image"]&&(l[K]&&(x=l[K](c,A,V,r,H.width,H.height)),this.fire("image",K,c,A,l,s,r,H)),A._interactPrefix=null,x===!0)break}}},handleClickImage:function(y,R,k,r,J,S,A,d){var L=this.downInfo.hits,g=d.hits;if(L&&R&&(R=dg(R))){var j=this.gv,P=A.rect,Z=this.convertPoint(S,A);L[y+"|image"]&&(R[k]&&R[k](r,J,j,Z,P.width,P.height),this.fire("image",k,r,J,R,s,Z,P));for(var D,h=A.compInfos,T=R,i=h.length-1;i>=0;i--){var Q=h[i],c=Q.comp;Z=this.convertPoint(S,Q,T,c,j,J),P=Q.rect;var w=J._interactPrefix=Q.prefix;if(L[y+"|"+i]&&g[y+"|"+i]){var I=w&&J.a(w+k)||c[k];I&&(D=I.call(c,r,J,j,Z,P.width,P.height)),this.fire("comp",k,r,J,R,c,Z,P)}if(D!==!0&&(R=P.image)&&L[y+"|"+i+"|image"]&&(R[k]&&(D=R[k](r,J,j,Z,P.width,P.height)),this.fire("image",k,r,J,R,s,Z,P)),J._interactPrefix=null,D===!0)break}}},initImageResource:function(){p.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(u,W){if(!u)return{x:1/0,y:1/0};var k=W.bodyInfo.rect,K=u.clone(),M=u.multiply({x:k.width,y:k.height});return M.local=K,M},convertPoint:function(E,D,W,I,G,m){var e=D.rect,J=D.matrix.applyInverse(E).sub(e),U=J.x>=0&&J.y>=0&&J.x<=e.width&&J.y<=e.height;if(!U)return J;if(I&&gs(I.pixelPerfect,m,G)){var e,d=1;this._is2d?(d=G.getZoom(),e=Ii(E.x,E.y,s,d)):e=Ii(E.x,E.y);var H=!1,Y=e.x,Z=e.y,f=e.width,y=e.height,a=p.hitMaxArea,b=f*y*d*d;if(b>a){var L=Math.sqrt(a/b);d*=L}f*=d,y*=d,2>f&&(f=2),2>y&&(y=2),Y*=d,Z*=d;var N=Wb(f,y),C=new Wg(0,-Y,-Z,d,d);C.append(D.matrix),G._drawForChecking=!0,I.transform=C;var w=W.fitSize;D.refRect&&D.refRect.fitSize?(I.refRect=D.refRect,W.fitSize=!0):W.fitSize=!1;var V=W.comps;W.comps=[I],jj(N,W,0,0,f,y,m,self),W.comps=V,W.fitSize=w,delete I.refRect,delete I.unionRect,delete I.transform,G._drawForChecking=!1;try{for(var k=0,i=N.getImageData(0,0,f,y).data;k<i.length;k+=4)if(0!==i[k+3]){H=!0;break}N.restore()}catch($){tk=g,H=!1}J.inRect=H}else J.inRect=!0;return J}});var Qb=lm.DefaultInteractor=function(q){$e(Qb,this,[q])};hj("DefaultInteractor",ll,{handle_mousedown:function(H){fk(H);var G=this,W=G.gv,I=W.getDataAt(H);if(W.setFocus(H)&&!W._editing&&!W._scrolling){Sf(H)?W.handleDoubleClick(H,I):W.handleClick(H,I);var F=Wl(H);!Wc()&&!F&&I&&(W.isMovable(I)||W._39Q(I))||!W.isPannable()||!ys(H)&&!F||wc(H)||(G._tx=W.tx(),G._ty=W.ty(),G.startDragging(H))}},handleWindowMouseUp:function(v){var s=this,W=s.gv;W._panning&&(delete W._panning,W.onPanEnded(),s.fi({kind:"endPan",event:v})),delete s._tx,delete s._ty,s.clearDragging()},handle_mousemove:function(v){var l=this,a=l.gv;l._hoverTimer&&(pg(l._hoverTimer),delete l._hoverTimer),l._hoverTimer=yo(function(){l.fi({kind:"hover",event:v}),pg(l._hoverTimer),delete l._hoverTimer},a.getHoverDelay()||p.hoverDelay)},handle_mouseleave:function(){var w=this;w._hoverTimer&&(pg(w._hoverTimer),delete w._hoverTimer)},handleWindowMouseMove:function(i){var K=this,x=K.gv;K.fi({kind:x._panning?"betweenPan":"beginPan",event:i}),x._panning=1;var R=Qf(x,i,K._lastClientPoint);x.setTranslate(K._tx+R.x,K._ty+R.y)},handle_mousewheel:function(y){this.gv.handleScroll(y,y.wheelDelta)},handle_DOMMouseScroll:function(g){2===g.axis&&this.gv.handleScroll(g,-g.detail)},handle_keydown:function(Q){this.gv.handleKeyDown(Q)}});var Rc=lm.SelectInteractor=function(U){$e(Rc,this,[U])};hj("SelectInteractor",ll,{_42:function(){var P=this,x=P.gv,N=x.getZoom(),c=P.mark,B=P.div;
B||(B=P.div=lp(),ib(P.getView(),B));var T={};T.x=c.x*N+x.tx(),T.y=c.y*N+x.ty(),T.width=c.width*N,T.height=c.height*N,Iq(B,T),this.intersects()?(B.style.border="",B.style.background=x.getRectSelectBackground()):(B.style.background="",B.style.border="1px solid "+x.getRectSelectBorderColor())},handle_mousedown:function(Y){var T=this,I=T.gv;if(T._57I=g,T.pendingClickThrough=g,!(I._editing||I._scrolling||Wc()||Wl(Y))){var X=I.getDataAt(Y),K=I.sm();X?wc(Y)?K.co(X)?K.rs(X):K.as(X):K.co(X)?X instanceof vc&&X.isClickThroughEnabled()&&ys(Y)&&(T.pendingClickThrough=vq(Y)):K.ss(X):wc(Y)||!I.isPannable()?ys(Y)&&(wc(Y)||K.cs(),I.isRectSelectable()&&(T.startDragging(Y),I._77O=1)):ys(Y)&&(T._57I=vq(Y))}},handle_mouseup:function(j){var S=this,$=S.gv,D=S._57I;if(D&&(lr(D,vq(j))<=1&&$.sm().cs(),S._57I=g),S.pendingClickThrough){if(lr(S.pendingClickThrough,vq(j))<=1){var z=$.getDataAt(j);if(z instanceof vc&&z.isClickThroughEnabled()){var M=$.getDataAt(j,function(N){var g=N.getParent()===z&&$.isSelectable(N,!0);return g});M&&(j.clickThrough=!0,$.sm().ss(M))}}S.pendingClickThrough=g}},handleWindowMouseUp:function(Z){this.clear(Z)},handleWindowMouseMove:function(s){var x=this,A=x.gv;x._logicalPoint=A.lp(s),x.mark?(x.fi({kind:"betweenRectSelect",event:s}),A.isPannable()&&x.autoScroll(s),x.redraw()):x.fi({kind:"beginRectSelect",event:s}),x.mark=In(x._lastLogicalPoint,x._logicalPoint),x.redraw()},intersects:function(){var w=this,o=w._lastLogicalPoint,J=w._logicalPoint;return o.x>J.x||o.y>J.y},clear:function(C){var H=this,b=H.gv,I=H.mark;if(H._57I=g,H.pendingClickThrough=g,H._lastLogicalPoint){if(I){if(0!==I.width&&0!==I.height){var d=b.getDatasInRect(I,H.intersects());if(!d.isEmpty()){var V=b.sm(),w=V.toSelection(),q=te(C),J=C.altKey;d.each(function(f){V.co(f)?(!q||q&&J)&&w.remove(f):(!J||q&&J)&&w.add(f)}),V.ss(w)}}cn(H.div),delete H.div,delete H.mark,H.redraw(),H.fi({kind:"endRectSelect",event:C}),b.onRectSelectEnded()}H.clearDragging(),delete b._77O}},redraw:function(){var c=this;c._draw||(c._draw=1,yo(function(){c.mark&&c._42(),delete c._draw},16))}});var Do=lm.MoveInteractor=function(W){$e(Do,this,[W])};hj("MoveInteractor",ll,{handle_mousedown:function(C){var P=this,W=P.gv;if(ys(C)&&!W._editing&&!W._scrolling&&!Wc()){var Q=W.getSelectedDataAt(C);!Q||W._39Q(Q)&&!W.isMovable(Q)?W._focusData=g:(P._data=Q,W.handleMouseDown&&W.handleMouseDown(C,Q),P.startDragging(C),W.isMovable(Q)&&(W._moving=1))}},handleWindowMouseUp:function(q){var A=this,v=A.gv;v.handleMouseUp&&v.handleMouseUp(q,A._data),A.clear(q)},handleWindowMouseMove:function(G){var s=this,m=s._data,T=s.gv;if((!T._93O||!T._93O(G,m))&&T._moving){s._logicalPoint||s.fi({kind:"prepareMove",event:G});var I=s._logicalPoint?"betweenMove":"beginMove",R={kind:I,event:G},V=s._logicalPoint=T.lp(G);"beginMove"!==I||s._alreadyBeginTransaction||(s._alreadyBeginTransaction=!0,T.getDataModel().beginTransaction());var L=s._calcShift(I,G),b=L.x,$=L.y,j=s.gv.getMoveMode(G,m);j&&("x"===j?$=0:"y"===j?b=0:"xy"!==j&&(b=$=0)),T.moveSelection(b,$),s._lastLogicalPoint=V,s.autoScroll(G),s.fi(R)}},_calcShift:function(){var r=this,z=r._logicalPoint,i=r._lastLogicalPoint,W=z.x-i.x,F=z.y-i.y;return{x:W,y:F}},clear:function(p){var m=this,M=m.gv;m._lastLogicalPoint&&(m._lastLogicalPoint=m._data=M._moving=g,m._logicalPoint&&(m.fi({kind:"endMove",event:p}),M.onMoveEnded()),m.clearDragging()),m._alreadyBeginTransaction&&(m._alreadyBeginTransaction=!1,M.getDataModel().endTransaction())}});var Qn=lm.TextEditInteractor=function(f){$e(Qn,this,[f]),this.init()};hj("TextEditInteractor",ll,{init:function(){var $=this,k=this.input=o.createElement("input"),r=k.style;k.text="text",r.border="1px solid #d8d8d8",r.position="absolute",r.padding="2px 3px",r.outline="none",r.marginLeft="-90px",r.marginTop="-16px",r.backgroundColor="rgba(255,255,255, 0.9)",r.fontSize="14px",r.width="180px",r.height="32px",r.boxShadow="0 0 13px rgba(16,142,233, 0.5)",r.textAlign="center",r.boxSizing="border-box",C(k,"keyup",function(x){Um(x)&&$.endTextEdit()}),C(k,"focus",function(){k.select()});var D=this.textarea=o.createElement("textarea"),e=this.wrap=o.createElement("div");e.appendChild(D),r=D.style,r.margin=0,r.padding="4px",r.overflow="hidden",r.boxSizing="border-box",r.position="absolute",r.outline="none",r.backgroundColor="transparent",r.resize="none",r.textAlign="center",r.fontSize="14px",r.border="none",r.borderWidth=0,r.width="100%",r.top="50%",r=e.style,r.boxSizing="border-box",r.margin=0,r.padding=0,r.position="absolute",r.boxShadow="0 0 13px rgba(16,142,233, 0.5)",r.border="1px solid #d8d8d8",r.backgroundColor="rgba(255,255,255, 0.9)",r.width="180px",r.marginLeft="-90px",C(D,"keydown",function(g){return(te()||wc())&&Um(g)?($.endTextEdit(),void 0):($.calculateTextareaHeight(String.fromCharCode(g.keyCode)),void 0)}),C(D,"focus",function(){D.select()});var c=function(R){R.stopPropagation()};C(k,"mousedown",c),C(k,"touchstart",c),C(D,"mousedown",c),C(D,"touchstart",c),$.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],$.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",$.handleWindowClick=function(Z){var e=$._editingDOM;if(e){var K=e.getBoundingClientRect(),N=vq(Z);vb(K,N)||$.endTextEdit()}}},handle_mousedown:function(C){var w=this,Y=w.gv;if(Sf(C)&&!Y._editing){var Z=Y.getDataAt(C);if(Z){var D=Y.getTextEditInfo(Z);D&&(this._editInfo=D,this._editTarget=Z,Y._editing=!0,D.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var w=this,M=w.gv,n=w._editTarget,J=w.getTargetValue(),H=w.textarea,f=w.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===J||J===s)&&(J=""),H.value=J,w._editingDOM=H,M.getView().appendChild(f),this.layoutHTML(f,n),this.calculateTextareaHeight(),yo(function(){H.focus(),C(q,"mousedown",w.handleWindowClick),C(q,"touchstart",w.handleWindowClick)},10)},handleTextEdit:function(){var o=this,E=o.gv,e=o._editTarget,d=o.getTargetValue(),W=o.input;(null===d||d===s)&&(d=""),W.value=d,o._editingDOM=W,E.getView().appendChild(W),this.layoutHTML(W,e),yo(function(){W.focus(),C(q,"mousedown",o.handleWindowClick),C(q,"touchstart",o.handleWindowClick)},10)},layoutHTML:function(P,p){var m=this.gv,c=m.getZoom();if(p instanceof U.Node){var L=p.getRect(),C=Math.min(Math.max(100,L.width*c),800);P.style.left=(L.x+L.width/2)*c+m.tx()+"px",P.style.top=(L.y+L.height/2)*c+m.ty()+"px",P.style.width=C+"px",P.style.marginLeft=-C/2+"px"}else if(p instanceof U.Edge){var I=m.getDataUI(p),L=I._6I;P.style.left=(L.x+L.width/2)*c+m.tx()+"px",P.style.top=(L.y+L.height/2)*c+m.ty()+"px"}},endTextEdit:function(){var h=this,g=h._editInfo.isMultiline?h.wrap:h.input,G=h._editInfo.isMultiline?h.textarea:h.input;h.setTargetValue(G.value),h.gv.getView().removeChild(g),h.gv._editing=!1,delete h._editingDOM,J(q,"mousedown",h.handlelick),J(q,"touchstart",h.handleWindowClick)},setTargetValue:function(S){var T=this,y=T._editTarget,t=T._editInfo,w=t.accessType,k=t.name;if(k&&w||(w="p",k="name"),"p"===w){var u=U.Default.setter(k);y[u](S)}else"a"===w?y.a(k,S):y.s(k,S)},getTargetValue:function(){var I=this,G=I._editTarget,Q=I._editInfo,f=Q.accessType,S=Q.name;if(S&&f||(f="p",S="name"),"p"===f){var h=U.Default.getter(S);return G[h]()}return"a"===f?G.a(S):G.s(S)},createHiddenTextarea:function(){this.hiddenTextarea=o.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(k,w){if(w&&this.computedStyleCache)return this.computedStyleCache;var h=this,m=q.getComputedStyle(k),N=m.getPropertyValue("box-sizing")||m.getPropertyValue("-moz-box-sizing")||m.getPropertyValue("-webkit-box-sizing"),T=parseFloat(m.getPropertyValue("padding-bottom"))+parseFloat(m.getPropertyValue("padding-top")),s=parseFloat(m.getPropertyValue("border-bottom-width"))+parseFloat(m.getPropertyValue("border-top-width")),i=h.SIZING_STYLE.map(function(s){return s+":"+m.getPropertyValue(s)}).join(";"),I={sizingStyle:i,paddingSize:T,borderSize:s,boxSizing:N};return w&&(this.computedStyleCache=I),I},calculateTextareaHeight:function(f){f=f||"";var q=this,z=q.textarea,W=q.hiddenTextarea,C=q.wrap,A=32,F=q.calculateHTMLStyle(z,!1),R=F.paddingSize,J=F.borderSize,O=F.boxSizing,k=F.sizingStyle;W.setAttribute("style",k+";"+q.HIDDEN_TEXTAREA_STYLE),W.value=z.value+f;var o=W.scrollHeight;"border-box"===O?o+=J:"content-box"===O&&(o-=R),z.style.height=o+"px",z.style.marginTop=0-.5*o+"px",C.style.height=Math.max(o,A)+"px",C.style.marginTop=o*-.5+"px"}});var Up=lm.ScrollBarInteractor=function(Z){$e(Up,this,[Z])};hj("ScrollBarInteractor",ll,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(x){var q=this.gv.getViewRect();return this._41o()&&(q.x+q.width-this.gv.lp(x).x)*this.gv.getZoom()<eo},isH:function(K){var p=this.gv.getViewRect();return this._40o()&&(p.y+p.height-this.gv.lp(K).y)*this.gv.getZoom()<eo},handle_mousemove:function(A){this.handle_touchmove(A)},handle_touchmove:function(E){if(!Fe&&ys(E)&&this.gv.isScrollBarVisible()){var r=this,c=r.isV(E),R=r.isH(E);(c||R)&&r.gv.showScrollBar(),r.gv._scrolling=c||R}},handleWindowMouseUp:function(V){this.handleWindowTouchEnd(V)},handleWindowTouchEnd:function(S){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=g,this.fi({kind:"endScroll",event:S})},handle_mousedown:function(p){this.handle_touchstart(p)},handle_touchstart:function(Y){var G=this;if(G.gv.setFocus(Y),fk(Y),G.handle_touchmove(Y),!(ns(Y)>1)&&G.gv._scrolling&&G.gv.isScrollBarVisible()){G._cp=vq(Y),G._tx=G.gv.tx(),G._ty=G.gv.ty();var t=G.isV(Y);G._state=t?"vScroll":"hScroll",Nm(G,Y),G.fi({kind:"beginScroll",event:Y})}},handleWindowMouseMove:function(E){this.handleWindowTouchMove(E)},handleWindowTouchMove:function(F){var N=vq(F),h=this.gv.getViewRect(),O=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-N.y)*O.height/h.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-N.x)*O.width/h.width),this.fi({kind:"betweenScroll",event:F})}});var Ak=lm.TouchInteractor=function($,O){O=O||{},O.selectable===s&&(O.selectable=!0),O.movable===s&&(O.movable=!0),O.pannable===s&&(O.pannable=!0),O.pinchable===s&&(O.pinchable=!0),O.editable===s&&(O.editable=!0),this.params=O,$e(Ak,this,[$])};hj("TouchInteractor",ll,{ms_edit:1,setUp:function(){var O=this;Ak.superClass.setUp.call(O),Pb&&O.params.editable&&O.gv.setEditInteractor(O)},tearDown:function(){var V=this;Ak.superClass.tearDown.call(V),Pb&&V.params.editable&&V.gv.setEditInteractor(g)},clear:function(N){var d=this,z=d.gv;z._moving&&(d.fi({kind:"endMove",event:N}),delete z._moving,z.onMoveEnded(),z.dm().endTransaction()),z._panning&&(d.fi({kind:"endPan",event:N}),delete z._panning,z.onPanEnded()),z._pinching&&(d.fi({kind:"endPinch",event:N}),delete z._pinching,z.onPinchEnded()),z._editing&&(d._46O(N),d._77I=d._node=d._edge=d._shape=d._rect=d._89I=d._index=z._editing=g),d.pendingClickThrough=d._moving=d._panning=d._pinching=d._editing=d._57I=d._data=d._beginHistory=g,d.clearDragging()},handle_touchstart:function(T){var f=this;if(!f.gv._editing){fk(T),f._57I=g,f.pendingClickThrough=g;var x=f.params,G=f.gv,O=G.sm(),$=G.getDataAt(T),e=ns(T);if(1===e){if(Sf(T))return G.handleDoubleClick(T,$),void 0;G.handleClick(T,$),$&&(G.handleMouseDown&&G.handleMouseDown(T,$),f._data=$),x.selectable||($=g),$&&(O.co($)?$ instanceof vc&&$.isClickThroughEnabled()&&(f.pendingClickThrough=vq(T)):O.ss($),x.editable&&G.isEditable($)&&f._79I(T,$,!0)?(f._editing=1,f.startDragging(T)):x.movable&&G.isMovable($)&&(f._moving=1,f.startDragging(T))),$&&(G.isMovable($)||G._39Q($))||(f._57I=vq(T),x.pannable&&G.isPannable()&&(f._panning=1,f.startDragging(T),f._translate={x:G.tx(),y:G.ty()}))}else if(x.pinchable&&2===e){if(!G.getEditInteractor()&&$){var Q=dg(G.getImage($));if(Q&&gs(Q.scrollable,$,this))return}f._pinching=1,f.startDragging(T);var X=G.getView(),p=G.getZoom(),P=X.getBoundingClientRect(),H=T.touches[0],s=T.touches[1],z={x:(H.clientX+s.clientX)/2-P.left,y:(H.clientY+s.clientY)/2-P.top};z.x-=G.tx(),z.y-=G.ty(),z.x/=p,z.y/=p,f._p=z,f._d=Kq(T)}}},handle_touchend:function(y){var e=this,k=e.gv,J=e._57I,u=e._data;if(J&&(lr(J,vq(y))<=1&&!k.getDataAt(y)&&k.sm().cs(),e._57I=g),u&&k.handleMouseUp&&k.handleMouseUp(y,u),e.pendingClickThrough){if(lr(e.pendingClickThrough,vq(y))<=1){var u=k.getDataAt(y);if(u instanceof vc&&u.isClickThroughEnabled()){var V=k.getDataAt(y,function(c){var v=c.getParent()===u&&k.isSelectable(c,!0);return v});V&&(y.clickThrough=!0,k.sm().ss(V))}}e.pendingClickThrough=g}},handleWindowTouchEnd:function(j){this.clear(j)},handleWindowTouchMove:function(l){var h=this,f=h.gv,X=ns(l);if(1===X){var c=vq(l),C=Qf(f,c,h._lastClientPoint),L=lr({x:0,y:0},C);if(h._editing&&(h._beginHistory||(h._beginHistory=1,f.dm().beginTransaction()),f._editing=1,h._78I(l)),h._moving){if(!f._moving&&L<p.touchMoveThreshold)return;h._beginHistory||(h._beginHistory=1,f.dm().beginTransaction()),h.handleMove(l)}else if(h._panning){if(!f._panning&&L<p.touchMoveThreshold)return;f.setTranslate(h._translate.x+C.x,h._translate.y+C.y),h.fi({kind:f._panning?"betweenPan":"beginPan",event:l}),f._panning=1}}else if(2===X&&h._pinching){var n=Kq(l);f.handlePinch(h._p,n,h._d),h._d=n,h.fi({kind:f._pinching?"betweenPinch":"beginPinch",event:l}),f._pinching=1}},handleMove:function(D){var Y=this,b=Y.gv,N=b.lp(D);b._93O&&b._93O(D,Y._data)||(b.moveSelection(N.x-Y._lastLogicalPoint.x,N.y-Y._lastLogicalPoint.y),Y._lastLogicalPoint=N,Y.autoScroll(D),Y.fi({kind:b._moving?"betweenMove":"beginMove",event:D}),b._moving=1)}});var U=q.ht,Cf=U.graph._editor={Math:U.Math,Guide:{}};Cf.getStyle=function(D){var J,y=Cf.StyleMap;return y&&(J=y[D],J!==s)?J:Cf.DefaultStyleMap[D]},Cf.setStyle=function(b,p){var h=Cf.StyleMap;h||(h=Cf.StyleMap={}),h[b]=p},Cf.inEdit=function(F){return F._inXEdit===!0},Cf.startEdit=function(u){u._inXEdit=!0,Cf.Inject.doInject(u)},Cf._46O=function(p){p._inXEdit=!1,Cf.Inject.undoInject(p)},Cf.toScreenPosition=function(s,f){var X=s.tx(),P=s.ty(),v=s._zoom;return new Cf.Math.Vector2(f.x*v+X,f.y*v+P)},Cf.checkHit=function(D,$,p){return D.distanceTo($)<p?!0:!1},Cf.toWorldPosition=function(i,g){var N=i.tx(),F=i.ty(),O=i._zoom;return{x:(g.x-N)/O,y:(g.y-F)/O}},Cf.setAntialias=function(Y,J){for(var i,Z=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],P=0,K=Z.length;K>P&&(i=Z[P],!(i in Y));P++);Y[i],Y[i]=J},Cf.getTargetCornersOnScreen=function(C,f){if(!f)return null;var F,G=[];if(ve(f,C)){var E=Ec(C,f);F=[{x:E.x,y:E.y},{x:E.x+E.width,y:E.y},{x:E.x+E.width,y:E.y+E.height},{x:E.x,y:E.y+E.height}]}else{if(!f.getCorners)return null;F=f.getCorners()}return F.forEach(function(l){var Y=Cf.toScreenPosition(C,l);G.push(Y.x,Y.y)}),G},Cf.log=function(){};var cb;Cf.updateTipInfo=function(V,k,l){if(l){var i=U.Default.getLogicalPoint(V,k._canvas);i.x+=Cf.Icons.TipShiftX,i.y+=Cf.Icons.TipShiftY,cb={helperPos:i,text:l,size:l.length}}else cb=g},Cf.drawTip=function(A,o){cb&&Cf.Icons.DrawIcon(o,A,Cf.Icons.TipHelper,cb)};var Gg=Cf.Inject={_modules:[]};Gg.registAsModule=function(B,h){var M={},k={};for(var C in B){var d=h.prototype[C];M[C]=d}B.getBackup=function(x){return M[x]},B.getBackups=function(){return M},k.doInject=function(){for(var z in B)"getBackup"!==z&&(h.prototype[z]=B[z])},k.undoInject=function(){for(var d in B)"getBackup"!==d&&(h.prototype[d]=M[d])},Gg._modules.push(k)},Gg.doInject=function(x){for(var K,R=Gg._modules,c=0,s=R.length;s>c;c++)K=R[c],K.doInject(x)},Gg.undoInject=function(n){for(var X,o=Gg._modules,m=0,N=o.length;N>m;m++)X=o[m],X.undoInject(n)};var ll=U.graph.EditInteractor=function(b){var a=this,l=o.createElement("canvas");l.className="editCanvas",l.style.position="absolute",a._uuid=U.Math.generateUUID(),a._styleMap={},a._canvas=l,a._context=l.getContext("2d"),ll.superClass.constructor.call(a,b),this._editDetail=!1,Cf.setAntialias(a._context,!1),a._subModules=a.initSubModule(),a._gridGuide=new Cf.Guide.Grid(a),a._rectGuide=new Cf.Guide.Rect(a),a._hoverGuide=new Cf.Guide.Hover(a)},yk=ll;U.Default.def(ll,U.graph.Interactor,{ms_edit:1,ms_fire:1}),z.defineProperties(ll.prototype,{editDetail:{get:function(){var p=!!this._editDetail;return p},set:function(v){var j=this,s=j._editDetail;s!==v&&(j._editDetail=v,j.gv._editing=v,j.fp("editDetail",s,v),j.fp("pointsEditingMode",s,v),j.fi({kind:v?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(Y){(!this._editDetail||Y)&&(this.gv._editing=Y,Y||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(M){this._editing=M,this.gvEditing=M}},editingModule:{get:function(){return this._editMod}},pointsEditingMode:{get:function(){return this.editDetail},set:function(f){var G=this;G.editDetail!==f&&(f?G._tryEnterEditDetailMode():G._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var f=this._gridEnabled;if(!f)return!1;var y=this.gv;return y?!0:!0},set:function(m){m!==this._gridEnabled&&(this._gridEnabled=m,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(v){v!==this._agEnabled&&(this._agEnabled=v,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),ll.prototype.initSubModule=function(){var J=this;return[new Cf.Anchor(J),new Cf.RotateX(J),new Cf.MoveDummy(J),new Cf.Rect(J),new Cf.Curve(J),new Cf.MoveHelper(J)]},ll.prototype.getSubModule=function(X){var A,E,y,L=this._subModules;for(E=0,y=L.length;y>E;E++)if(A=L[E],A.catalog===X)return A},ll.prototype.invokeSubModule=function(l,G){for(var K,q,g,I=this,R=I._subModules,j=Array.prototype.slice.call(arguments,2),U=0,F=R.length;F>U;U++)if(K=R[U],q=K[l],q&&(g=q.apply(K,j),g!=s&&G))return K},ll.prototype.invokeSubModuleInverse=function(Q,m){var X=this,O=X._subModules;if(O)for(var $,l,J,f=Array.prototype.slice.call(arguments,2),F=O.length-1;F>=0;F--)if($=O[F],l=$[Q],l&&(J=l.apply($,f),J!=s&&m))return $},ll.prototype.setUp=function(){Cf.log("setUp");var p=this,Z=p.gv,A=Z.getView(),k=p._canvas;ll.superClass.setUp.call(p),Z.setEditInteractor(p),Z._79O?A.insertBefore(k,Z._79O):A.appendChild(k),Cf.startEdit(Z),p.invokeSubModule("setUp"),Z.dm().mm(p._onDataModelChanged,p),Z.dm().md(p._onDataPropertyChanged,p)},ll.prototype.tearDown=function(){Cf.log("tearDown");var N=this,y=N.gv,E=y.getView();N._resetCustomCursorStyle(),ll.superClass.tearDown.call(N),y.dm().umm(N._onDataModelChanged,N),y.dm().umd(N._onDataPropertyChanged,N),y.setEditInteractor(null),E.removeChild(N._canvas),N._drawTimer&&(pg(N._drawTimer),N._drawTimer=null),Cf._46O(y),N.invokeSubModule("tearDown")},ll.prototype._onDataModelChanged=function(n){var $=this;("clear"===n.kind||"remove"===n.kind&&$.editDetail&&n.data===$.getSubModule("Curve").target)&&($.editDetail=!1,$._42())},ll.prototype._onDataPropertyChanged=function(u){var c=this;if(c.editDetail){var A=c.getSubModule("Curve"),G=u.data;G===A.target&&(G._writing||A._handleDataChanged(u))}},ll.prototype.clear=function(){Cf.log("clear")},ll.prototype.redraw=function(){this._42()},ll.prototype._42=function(){var R=this;R._drawTimer||(R._drawTimer=yo(function(){R._drawTimer=null,R.drawImpl()},0))},ll.prototype.drawImpl=function(){var R;for(R in{_42:!0})break;return function(){var t=this,k=t._canvas,b=t.gv,A=b.getWidth(),L=b.getHeight(),V=t._context,N=U.Default.getInternal(),g=p.devicePixelRatio;(k.width!==A||k.height!==L)&&N.setCanvas(k,A,L,g),V.clearRect(0,0,k.width,k.height);var S=t._getValidSelection();V.save(),V.scale(g,g),t._gridGuide._42(),t.invokeSubModuleInverse(R,!1,V,b,S),t._rectGuide._42(),t._hoverGuide._42(),V.restore()}}(),ll.prototype._getValidSelection=function(){var I=this,x=I.gv,A=x.sm().getSelection(),l=[];return A.each(function(o){x.isVisible(o)&&x.isEditable(o)&&l.push(o)}),l},ll.prototype.handle_touchmove=function(c){return this.handle_mousemove(c)},ll.prototype.handle_mousemove=function(D){if(!U.Default.isDragging()){var E=this;if((E.editDetail||!Wc()&&!Wl(D))&&!E.gv._externalEditing){if(E.gvEditing=!1,E._checkEdit(D))E.gvEditing=!0;else{if(!E.getStyle("hoverGuideVisible"))return;E.hoverData=E.gv.getDataAt(D)}E._42()}}},ll.prototype.handle_touchstart=function(p){return this.handle_mousedown(p)},ll.prototype.handle_mousedown=function(i){fk(i);var f=this;if((f.editDetail||!Wc()&&!Wl(i))&&!f.gv._externalEditing){if(Sf(i)&&!i.clickThrough){if(f.editDetail){if(f._tryQuitEditDetailMode(i))return}else if(f._tryEnterEditDetailMode())return;f.gv.dm().beginTransaction();var M=f.invokeSubModule("handleDoubleClick",!0,i);if(f.gv.dm().endTransaction(),M)return}var V=f._checkEdit(i);V&&(f._downPosition=f._getLogicalPoint(i),f.gv.dm().beginTransaction(),V.startEdit(f,i),f.editing=!0)}},ll.prototype._checkEdit=function(T){var L=this,C=L.gv,x=L._getLogicalPoint(T),e=L.invokeSubModule("check",!0,C,T,x)||null;return L._editMod=e,e},ll.prototype.handleWindowTouchMove=function(l){return this.handleWindowMouseMove(l)},ll.prototype.handleWindowMouseMove=function(z){var J=this,M=J._downPosition;if(M){var F=J._getLogicalPoint(z);if(F.distanceTo(M)<J.getStyle("moveSensitivity"))return;delete J._downPosition}var c=J._editMod;c&&c.handleEdit(J.gv,z),J.redraw()},ll.prototype._getLogicalPoint=function(k){var u=this,F=U.Default.getLogicalPoint(k,u._canvas);return new Cf.Math.Vector2(F)},ll.prototype.handleWindowTouchEnd=function(y){return this.handleWindowMouseUp(y)},ll.prototype.handleWindowMouseUp=function(){var z;for(z in{_46O:!0})break;return function(p){var b=this;b.editing=!1,b.setCursor("default"),b.invokeSubModule(z,!1,p),b._42(),b.gv.dm().endTransaction()}}(),ll.prototype.handle_mousewheel=function(w){var q=this;fk(w),q.invokeSubModule("preHandleScroll",!0)||q.gv.handleScroll(w,w.wheelDelta)},ll.prototype.handleDelete=function(){var y=this;if(!y.editDetail){y.gv.dm().beginTransaction();var e=y.invokeSubModule("handleNormalStateDelete",!0);return y.gv.dm().endTransaction(),e||y.gv.removeSelection(),void 0}y.gv.dm().beginTransaction(),y.invokeSubModule("handleDelete",!0),y.gv.dm().endTransaction(),y._42()},ll.prototype.handle_keydown=function(B){var s=this;if((B.metaKey||B.ctrlKey)&&s._42(),Wc(B)&&!s.editing)return s.gvEditing=!1,s.setCursor("default"),s._42(),void 0;var Z=Um(B);return s.editDetail?((Z||Pi(B))&&(s.editDetail=!1,s._42()),s.gv.dm().beginTransaction(),s.invokeSubModule("handle_keydown",!0,B),s.gv.dm().endTransaction(),void 0):(s.gv.dm().beginTransaction(),s.invokeSubModule("handleNormalStateKeyDown",!0,B),s.gv.dm().endTransaction(),Z&&s._tryEnterEditDetailMode(),void 0)},ll.prototype.handle_keyup=function(m){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,m),this.gv.dm().endTransaction()},ll.prototype._tryEnterEditDetailMode=function(){var x=this;return!x.editDetail&&x.invokeSubModule("canEnterEditDetailMode",!0)&&1===x._getValidSelection().length?(x.editDetail=!0,x._42(),!0):void 0},ll.prototype._tryQuitEditDetailMode=function(f){var N=this;return N.editDetail?!f||N.invokeSubModule("canQuitEditDetailMode",!0,f)?(N.editDetail=!1,N._42(),!0):!1:!1},ll.prototype.setStyle=function(k,X,e){var o=this;e?Cf.setStyle(k,X):o._styleMap[k]=X,"baseColor"===k&&(Zj=X),o.fp("styleChanged",null,{key:k,value:X,base:e}),o._42()},ll.prototype.getStyle=function(x){var _=this,Y=_._styleMap[x];return Y!==s?Y:Cf.getStyle(x)},ll.prototype.setCursor=function(r){this._resetCustomCursorStyle(),U.graph.EditInteractor.superClass.setCursor.call(this,r)},ll.prototype._drawHostGuide=function(O){var b=this,d=b._context,B=b.gv;Cf.Icons.DrawIcon(b,d,Cf.Icons.NodeHoverGuide,O.corners);var w=O.host;if(w){var s=B.getAttachPoints(w);if(s&&s.length)for(var m=0,$=s.length;$>m;m++){var I=s[m],t=zb(B,w,0,I.offsetX||0,I.offsetY||0,I.x,I.y);t=Cf.toScreenPosition(B,t),t.isAttach=O.attach===m,Cf.Icons.DrawIcon(b,d,Cf.Icons.AttachPoint,t)}}},ll.prototype._resetCustomCursorStyle=function(){var m=this;if(m._customStyle){var K=this.gv.getView();K.classList&&K.classList.remove&&K.classList.remove(m._customStyle),m._customStyle=null}},ll.prototype._setRotateCursor=function(W){var a=this,h=a._cursorFactory;h||(h=a._cursorFactory=new Cf.CursorFactory(a));var v=h.getRotateCursor(W),j=a.gv.getView();a._resetCustomCursorStyle(),a._customStyle=v,j.classList&&j.classList.add&&j.classList.add(v)};var Mb=Cf.Group=function(V){var d=this;d._entities=V,d._64O=0,d._position={x:0,y:0},d._scale={x:1,y:1},d._anchor={x:.5,y:.5},d._anchor2={x:.5,y:.5}};Mb.prototype={},Mb.prototype.constructor=Mb;var Wo=null,gh=null;Mb.findOrCreateGroup=function(C,G){if(gh===G&&Wo&&Wo.checkIsMe(C))return Wo;gh=G;var i=new Cf.Group(C);return i.getKeyOb()?(Wo=i,i):void 0},Mb.prototype.checkIsMe=function(h){var M=this._entities;if(M.length!==h.length)return!1;var c,Z={},q=h.length;for(c=0;q>c;c++)Z[h[c]._id]=!0;for(c=0;q>c;c++)if(!Z[M[c]._id])return!1;return!0},Mb.prototype.getRotation=function(){return this._64O},Mb.prototype.getPosition=function(){return this._position},Mb.prototype.getAnchor=function(){return this._anchor},Mb.prototype.getWidth=function(){return this._width},Mb.prototype.getScale=function(){return this._scale},Mb.prototype.getSize=function(){return{width:this._width,height:this._height}},Mb.prototype.getHeight=function(){return this._height},Mb.prototype.getKeyOb=function(){for(var C=this._entities,h=C.length-1;h>=0;h--){var W=C[h];if(this.isNode(W))return W}},Mb.prototype.getAnchor2=function(){var T=this,x=T.rotateCenter;if(x)return x;var C=T.getKeyOb();if(!C)return T._anchor;var q=T._anchor2,h=C.getMatrix();return h.tf({x:C.getWidth()*(q.x-C.getAnchor().x),y:C.getHeight()*(q.y-C.getAnchor().y)})},Mb.prototype.setAnchor2=function(k,u){var b=this,g=b.getKeyOb();if(g){var Q,T=g.getMatrix();Q="number"==typeof k?{x:k,y:u}:k;var n=T.tfi(Q);b._anchor2={x:g.getAnchor().x+n.x/g.getWidth(),y:g.getAnchor().y+n.y/g.getHeight()}}},Mb.prototype.setRotation=function(){},Mb.prototype.beginRotate=function($){this.rotateCenter=$.pos,this.rotateMode=$.groupRotateMode},Mb.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Mb.prototype.addRotation=function(O,v,r){return"batch"===v?this._addRotationInBatchMode(O,r):"block"===v?this._addRotationInBlockMode(O,r):void 0},Mb.prototype._addRotationInBlockMode=function(B,A){var t=this,J=t.rotateCenter||t.getPosition();t._entities.forEach(function(H){if(t.isNode(H)&&(!A||A(H))){var W=H.getMatrix();W.translate(-J.x,-J.y),W.rotate(B),W.translate(J.x,J.y);var R=Math.sign(H.getScale().x);H.setRotation(xb(W.b*R,W.a*R)),H.setPosition(W.tx,W.ty)}})},Mb.prototype._addRotationInBatchMode=function(J,N){var A=this,b=A._anchor2;A._entities.forEach(function(K){if(A.isNode(K)&&(!N||N(K))){var U=K.getAnchor(),r=K.getMatrix(),m=r.tf({x:K.getWidth()*(b.x-U.x),y:K.getHeight()*(b.y-U.y)}),n=new Cf.Math.Matrix2d;n.set(r.a,r.b,r.c,r.d,r.tx,r.ty),n.translate(-m.x,-m.y),n.rotate(J),n.translate(m.x,m.y);var c=Math.sign(K.getScale().x);K.setRotation(xb(n.b*c,n.a*c)),K.setPosition(n.tx,n.ty)}})},Mb.prototype.setPosition=function(m){var D,N,t,o,y=this,h=y._position,R=m.x-h.x,S=m.y-h.y,V=y._entities;for(N=0,t=V.length;t>N;N++)D=V[N],Ob(D)&&(o=D.getPosition(),D.setPosition(o.x+R,o.y+S));y._position=m},Mb.prototype.setScale=function(O,g){var E=this,e=O/E._scale.x,T=g/E._scale.y;E._adjustChildScaleOrSize(e,T,"size"),E._scale={x:O,y:g}},Mb.prototype.getRect=function(){var h=this,b=h._position,n=h._width,j=h._height;return{x:b.x-n/2,y:b.y-j/2,width:n,height:j}},Mb.prototype.setSize=function(j,z){var P=this,j=Math.max(1,j),z=Math.max(1,z),L=j/P._width,t=z/P._height;P._adjustChildScaleOrSize(L,t,"size"),P._width=j,P._height=z},Mb.prototype._adjustChildScaleOrSize=function(L,x,g){var b,S,u,Y,t,$,v,p,V,F,G,C,k,r,q=this,d=q._position,h=q._entities,f=new Cf.Math.Matrix2d;for(S=0,u=h.length;u>S;S++)if(b=h[S],q.isNode(b)){if(Y=b.getPosition(),t=b.getRotation(),$=b.getWidth(),v=b.getHeight(),p=b.getScale(),G=p.x*$,C=p.y*v,f.identity().scale(G,C).rotate(t).translate(Y.x,Y.y).translate(-d.x,-d.y).rotate(-q._64O),t=xb(f.b*Math.sign(G),f.a*Math.sign(G)),f.scale(L,x),V=Math.cos(t),F=Math.sin(t),Math.abs(V)<.001?(k=f.b/F,r=-f.c/F):(k=f.a/V,r=f.d/V),"scale"===g)b.setScale(k/$,r/v);else if("size"===g){var A=k/p.x,Z=r/p.y;b.setScale(Mr(k)*Math.abs(p.x),Mr(r)*Math.abs(p.y)),b.setSize(Math.max(.1,Math.abs(A)),Math.max(.1,Math.abs(Z)))}f.rotate(q._64O).translate(d.x,d.y),b.setPosition(f.tx,f.ty)}},Mb.prototype.getMatrix=function(){var z=this,o=z._position,C=U.Default.getInternal(),F=z._scale;return new C.Mat(z._64O,o.x,o.y,F.x,F.y)},Mb.prototype.toGlobal=function(y){return this.getMatrix().tf(y)},Mb.prototype.getCorners=function(){var p=this,X=p._width,J=p._height,I=p._anchor,t=-X*I.x,z=-J*I.y,d=p.getMatrix();return[d.tf(t,z),d.tf(t,z+J),d.tf(t+X,z+J),d.tf(t+X,z)]},Mb.prototype.calcInfo=function(){var P,z,W,$,B,x,p=this,j=[],q=p._entities,g=p._64O;for($=0,B=q.length;B>$;$++)x=q[$],p.isNode(x)&&x.getCorners&&j.push.apply(j,x.getCorners());if(j.length){var r=Math.cos(-g),m=Math.sin(-g),M=1/0,V=-1/0,Y=1/0,G=-1/0;for($=0,B=j.length;B>$;$++)W=j[$],P=W.x,z=W.y,W.x=r*P-m*z,W.y=m*P+r*z,M=Math.min(M,W.x),V=Math.max(V,W.x),Y=Math.min(Y,W.y),G=Math.max(G,W.y);p._width=(V-M)/p._scale.x,p._height=(G-Y)/p._scale.y,r=Math.cos(g),m=Math.sin(g);var y=p._anchor;P=M+(V-M)*y.x,z=Y+(G-Y)*y.y,p._position={x:r*P-m*z,y:m*P+r*z}}},Mb.prototype.isNode=function(d){return Ob(d)?ve(d)?d.size()?!1:!0:!0:!1},Mb.prototype._42=function(f,E,J){var $,e,a,W,y,P,p,Y,_=this,F=_._entities,A=_.rotateMode;for("batch"===A&&(Y=_.getKeyOb()),$=0,e=F.length;e>$;$++)a=F[$],_.isNode(a)&&(P=a.getRect(),W=Cf.toScreenPosition(J,{x:P.x,y:P.y}),y=Cf.toScreenPosition(J,{x:P.x+P.width,y:P.y+P.height}),p={min:W,max:y},a===Y&&(p.isKeyOb=!0),Cf.Icons.DrawIcon(f,E,Cf.Icons.GroupSubEntityRect,p))};var Fm=Cf.CurveActiving=function(Z,$){this._curve=Z,this._interactor=Z._interactor,this.silent=!0;for(var G in $)this[G]=$[G];delete this.silent};Fm.prototype={},Fm.prototype.constructor=Fm,z.defineProperties(Fm.prototype,{point:{get:function(){return this._point},set:function(Q){var j=this;j._point=Q,j.editingCtrl||j.silent||j._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(Q){var f=this;f._pairs=Q,f.editingCtrl&&!f.silent&&f._firePointChange()}}}),Fm.prototype._firePointChange=function(){var y=this,F=y.getCurrentEditingPoint(),S=y._interactor;if(!F)return S.fi({kind:"selectPoint"}),void 0;var N=this._curve.target;if(N){var t=Cf.getDataMatrix(N).invert(),w=F.e;F=t.apply(Cf.toWorldPosition(S.gv,F)),F.e=w;var a=y._lastFirePoint;a&&Math.abs(F.x-a.x)<1e-5&&Math.abs(F.y-a.y)<1e-5&&(F.e==s&&a.e==s||Math.abs(F.e-a.e)<1e-5)||(y._lastFirePoint=F,S.fi({kind:"selectPoint",x:F.x,y:F.y,e:F.e}))}},Fm.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Fm.prototype.getCurrentEditingPoint=function(){var n=this,E=n.editingCtrl;if(E){var U=n.pairs;if(U){var k=U[E.pairId];if(k){var T=k[E.type];if(T)return T}}}return n._point};var ug=Cf.CursorFactory=function(h){var r=this;r._interactor=h,r._rotateCursorStyles={}};ug.prototype={},ug.prototype.constructor=ug,ug.prototype.getRotateCursor=function(w){var D=this;0>w&&(w+=2*Math.PI);var M=D._interactor,h=M.getStyle("rotateCursorSize"),G=M.getStyle("rotateCursorRound"),X=Math.round(180*(w/Math.PI)/G);X*G>=360&&(X=0);var k=D._rotateCursorStyles,e="htCustomRotateStyle_"+h+"_"+G+"_"+X;return k[e]||(D._produceRotateCursor(e,h,G,X),k[e]=!0),e},ug.prototype._produceRotateCursor=function(Q,I,F,u){var J=this;J._interactor;var B=J._canvas;
B||(B=J._canvas=o.createElement("canvas"));var H=p.devicePixelRatio;B.width=B.height=I*H,B.style.width=B.style.height=I+" px";var k=B.getContext("2d");Cf.setAntialias(k,!1),k.scale(H,H);var h,A,b,G,$,L=Math.round(I/2),s=""+L+" "+L+",auto !important;",_=4;h=Math.PI/180*u*F,k.clearRect(0,0,I,I),k.save(),k.scale(I/32,I/32),k.translate(16,15),k.rotate(h+Math.PI/2),k.beginPath(),k.moveTo(-8,0),k.lineTo(-8,_),k.lineTo(-8+_,_),k.moveTo(8,0),k.lineTo(8,_),k.lineTo(8-_,_),k.moveTo(-8,_),k.quadraticCurveTo(0,-6,8,_),k.restore(),k.lineCap="round",k.lineJoin="miter",k.strokeStyle="white",k.lineWidth=4,k.stroke(),k.strokeStyle="black",k.lineWidth=2,k.stroke(),A=JSON.stringify(B.toDataURL()),G="cursor:url("+A+")"+s,1!==H&&(b='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+I+'px" height="'+I+'px"><image xlink:href='+A+' width="'+I+'" height="'+I+'"/></svg>',G+="cursor:url(data:image/svg+xml;base64,"+btoa(b)+")"+s,G+="cursor:-webkit-image-set(url("+A+")"+H+"x,url("+A+")1x)"+s),$=o.createElement("style"),$.textContent="body."+Q+" *, ."+Q+"{"+G+"}",o.head.appendChild($)};var xi=Cf.Guide.Grid=function(f){var V=this;V._interactor=f,V._alignmentGuideId=0,V._xAlignmentGuide=[],V._yAlignmentGuide=[]};xi.prototype={},xi.prototype.constructor=xi,z.defineProperties(xi.prototype,{gridBlockSize:{get:function(){var v=this;return v._gridBlockSize||v._interactor.getStyle("gridBlockSize")},set:function(l){this._gridBlockSize=l,this._interactor._42()}},gridThickLinesEvery:{get:function(){var K=this;return K._gridThickLinesEvery||K._interactor.getStyle("gridThickLinesEvery")},set:function(u){this._gridThickLinesEvery=u,this._interactor._42()}},gridEnabled:{get:function(){var M=this,q=M._interactor;return q.gridEnabled&&M.isValidGrid()}}}),xi.prototype._42=function(){var E=this,H=E._interactor;E.gridEnabled&&E.drawGrid(),H.alignmentGuideEnabled&&E.drawAlignmentGuide()},xi.prototype.makeMatrix=function(){var h=this,y=h._interactor.getStyle("gridAngle"),x=h._interactor.getStyle("gridRotation"),Q=new Cf.Math.Matrix2d,g=Math.sin(y),Y=Math.cos(y);return Q.set(1,0,Y,g,0,0),Q.rotate(x),Q},xi.prototype.isValidGrid=function(){var K=this,Q=Math.PI,C=K._interactor,a=C.gv;if(a._zoom<C.getStyle("gridZoomThreshold"))return!1;var E=C.getStyle("gridAngle"),G=Math.abs(180*(E%Q/Q)),O=1-1e-8;return O>G||G>180-O?!1:!0},xi.prototype.drawAlignmentGuide=function(){var v=this,m=v._interactor,q=m.gv,R=m._canvas,T=m._context,a=R.width,d=R.height,A=q.tx(),V=q.ty(),l=q._zoom;T.beginPath(),T.strokeStyle=m.getStyle("gridAlignmentGuideColor"),T.lineWidth=1,v._xAlignmentGuide.forEach(function(Q){var K=Q.p*l+A;T.moveTo(K,0),T.lineTo(K,d)}),v._yAlignmentGuide.forEach(function(m){var G=m.p*l+V;T.moveTo(0,G),T.lineTo(a,G)}),T.stroke()},xi.prototype.drawGrid=function(){function E(K,n,q,P){var m=Cf.toScreenPosition(c,Z.apply({x:K,y:n})),V=Cf.toScreenPosition(c,Z.apply({x:q,y:P}));s.moveTo(m.x,m.y),s.lineTo(V.x,V.y)}var F=this,z=F._interactor,f=F.gridBlockSize,O=F.gridThickLinesEvery,d=z.getStyle("gridThickColor"),u=z.getStyle("gridLightColor"),c=z.gv,B=z._canvas,s=z._context,L=B.width,A=B.height,Z=F.makeMatrix(),y=Z.applyInverse(Cf.toWorldPosition(c,{x:0,y:0})),I=Z.applyInverse(Cf.toWorldPosition(c,{x:L,y:0})),W=Z.applyInverse(Cf.toWorldPosition(c,{x:0,y:A})),Q=Z.applyInverse(Cf.toWorldPosition(c,{x:L,y:A})),v=Math.min(y.x,I.x,W.x,Q.x),m=Math.max(y.x,I.x,W.x,Q.x),K=Math.min(y.y,I.y,W.y,Q.y),_=Math.max(y.y,I.y,W.y,Q.y);L=m-v,A=_-K;var D=Math.ceil(v/f),j=Math.floor(m/f),J=Math.ceil(K/f),S=Math.floor(_/f);c.tx(),c.ty(),c._zoom;var n,i,w;for(s.save(),s.lineWidth=1,s.beginPath(),s.strokeStyle=d,w=Math.ceil(D/O)*O;j>=w;w+=O)n=w*f,E(n,K,n,_);for(w=Math.ceil(J/O)*O;S>=w;w+=O)i=w*f,E(v,i,m,i);for(s.stroke(),s.beginPath(),s.strokeStyle=u,w=D;j>=w;w++)0!==w%O&&(n=w*f,E(n,K,n,_));for(w=J;S>=w;w++)0!==w%O&&(i=w*f,E(v,i,m,i));s.stroke(),s.restore()},xi.prototype.getAlignmentGuides=function(){var P=this;return{x:P._xAlignmentGuide,y:P._yAlignmentGuide}},xi.prototype.addAlignmentGuide=function(T,D,l){var P=this,M="x"===T?P._xAlignmentGuide:P._yAlignmentGuide,l=l?l:++P._alignmentGuideId,W={p:D,id:l};if(M.length){var h=P._findClosestAlignmentGuide(W.p,M);h.dis<0?M.splice(h.index+1,0,W):M.splice(h.index,0,W)}else M.push(W);return P._interactor._42(),l},xi.prototype.findClosest=function(b,h,f){var r=this,L=r._interactor,l=L.gv;f&&(b=Cf.toWorldPosition(l,b));var S,F,Z,X=1/0,Q=1/0,g=b.x,E=b.y;if(r.gridEnabled){var B=r.gridBlockSize,$=r.makeMatrix(),I=$.applyInverse(b);I=$.apply({x:Math.round(I.x/B)*B,y:Math.round(I.y/B)*B}),X=I.x-g,Q=I.y-E,Z=!0}if(L.alignmentGuideEnabled&&(S=r._findClosestAlignmentGuide(g,r._xAlignmentGuide).dis,F=r._findClosestAlignmentGuide(E,r._yAlignmentGuide).dis,Math.abs(S)<Math.abs(X)&&(X=S,Z=!0),Math.abs(F)<Math.abs(Q)&&(Q=F,Z=!0)),Z){Z=!1;var d=l._zoom,u=L.getStyle("smartGuideThreshold")/d,j={};if(Math.abs(X)<u&&"y"!==h&&(j.x=f?X*d:X,Z=!0),Math.abs(Q)<u&&"x"!==h&&(j.y=f?Q*d:Q,Z=!0),Z)return j}},xi.prototype._findClosestAlignmentGuide=function(b,H){if(!H.length)return{dis:1/0};for(var M,B=0,d=H.length-1;d-B>1;)M=Math.floor((B+d)/2),H[M].p<b?B=M:d=M;var l=H[B].p-b,F=H[d].p-b;return Math.abs(l)<=Math.abs(F)?{line:H[B],dis:l,index:B}:{line:H[d],dis:F,index:d}},xi.prototype.removeAllAlignmentGuide=function(D){var O=this;"y"!==D&&(O._xAlignmentGuide=[]),"x"!==D&&(O._yAlignmentGuide=[]),O._interactor._42()},xi.prototype.removeAlignmentGuide=function(k){for(var h,I,_,V=this,u=V._xAlignmentGuide,R=0;2>R;R++)for(u=0===R?V._xAlignmentGuide:V._yAlignmentGuide,h=0,I=u.length;I>h;h++)if(_=u[h],_.id===k)return u.splice(h,1),V._interactor._42(),{axis:0===R?"x":"y",position:_.p};return!1},xi.prototype.adjustAlignmentGuide=function(I,J){var G=this,N=G.removeAlignmentGuide(I);return N?(G.addAlignmentGuide(N.axis,J,I),!0):!1};var gp=Cf.Guide.Rect=function(k){var F=this;F._interactor=k};gp.prototype={},gp.prototype.constructor=gp,gp.prototype.gatherRects=function(){var r,R,v,V,W=this,d=W._interactor.gv,A=[],o=[],z={x:A,y:o},C={},q=d.getDataModel(),b=q.a("width"),F=q.a("height");b&&F&&(r=0,R=0,v=b,V=F,A.push({node:q,type:0,p:r},{node:q,type:1,p:r+v/2},{node:q,type:2,p:r+v}),o.push({node:q,type:0,p:R},{node:q,type:1,p:R+V/2},{node:q,type:2,p:R+V}),C[q._id||0]={x:r,y:R,width:v,height:V}),q.each(function(i){if(Ob(i)&&!d.isSelected(i)&&d.isVisible(i)&&d.isValidGuideLineSource(i)){var Q=!1;if(d.sm().getSelection().each(function(S){Q||(i.isHostOn(S)?Q=!0:i.isDescendantOf(S)&&(Q=!0))}),!Q){var s=i.getRect();r=s.x,R=s.y,v=s.width,V=s.height,A.push({node:i,type:0,p:r},{node:i,type:1,p:r+v/2},{node:i,type:2,p:r+v}),o.push({node:i,type:0,p:R},{node:i,type:1,p:R+V/2},{node:i,type:2,p:R+V}),C[i._id]=s}}}),A.sort(function(t,e){return t.p-e.p}),o.sort(function(j,t){return j.p-t.p}),W._grid=z,W._87I=C},gp.prototype.gatherLines=function(p,t,j){var a,n,K,Z,D,I,Q,r,B,J,k,T,E=this,H=[E.findClosest({x:p.x,y:p.y},t),E.findClosest({x:p.x+p.w/2,y:p.y+p.h/2},t),E.findClosest({x:p.x+p.w,y:p.y+p.h},t)],e={},N=E._87I;j=j||255;var l,G;for(E._guideLine=[],a=0;2>a;a++)for(e={},0===a?(Z="y",r=p.x,B=r+p.w):(Z="x",r=p.y,B=r+p.h),n=0;3>n;n++)D=H[n],D&&isFinite(D[Z])&&(l=1<<3*a+n,j&l&&(I=D[Z+"Line"],Q=I.node,G=Q._id||0,e[G]||(e[G]=!0,T=N[G],"y"===Z?(J=T.x,k=T.x+T.width):(J=T.y,k=T.y+T.height),K=I.p,E._guideLine.push({type:Z,a:r,b:B,c:J,d:k,p:K,center:1===I.type}))))},gp.prototype._binarySearchClosest=function(c,I){if(!I.length)return{dis:1/0};for(var F,S=0,N=I.length-1;N-S>1;)F=Math.floor((S+N)/2),I[F].p<c?S=F:N=F;var _=I[S].p-c,g=I[N].p-c;return Math.abs(_)<=Math.abs(g)?{line:I[S],dis:_}:{line:I[N],dis:g}},gp.prototype.findClosest=function(G,y,r){var J=this,x=J._interactor,g=x.gv,R=J._grid;r&&(G=Cf.toWorldPosition(g,G));var o,L=J._binarySearchClosest(G.x,R.x),V=J._binarySearchClosest(G.y,R.y),h=L.dis,w=V.dis,C=g._zoom,U=x.getStyle("smartGuideThreshold")/C,O={};return Math.abs(h)<U&&"y"!==y&&(O.x=r?h*C:h,O.xLine=L.line,o=!0),Math.abs(w)<U&&"x"!==y&&(O.y=r?w*C:w,O.yLine=V.line,o=!0),o?O:void 0},gp.prototype._42=function(){var $=this,G=$._guideLine;if(G&&!U.Default.isCtrlDown()){var V=$._interactor;if(V.getStyle("guideLineVisible")){var z,g,s,S,O,v,x,i,D,P,c,a,H,b,q,m,l,e=V.gv,n=V._context,t=e.tx(),T=e.ty(),r=e._zoom,F=V.getStyle("guideLineTextSpacing");for(z=0,g=G.length;g>z;z++)s=G[z],i=s.type,D=s.p,P=s.a,c=s.b,a=s.c,H=s.d,b=Math.min(P,a),q=Math.max(c,H),"x"===i?(S=D*r+t,O=b*r+T,v=S,x=q*r+T):(S=b*r+t,O=D*r+T,v=q*r+t,x=O),Cf.Icons.DrawIcon(V,n,Cf.Icons.MoveLineGuide,{rect:[S,O,v,x],center:s.center}),H>=P&&c>=a||(b=P>H?H:c,q=P>H?P:a,l=q-b,"x"===i?(s.center2center||(S-=F,v=S),O=b*r+T,x=q*r+T,m=Cf.Icons.MoveLineGuideDistanceV):"y"===i&&(s.center2center||(O-=F,x=O),S=b*r+t,v=q*r+t,m=Cf.Icons.MoveLineGuideDistanceH),Cf.Icons.DrawIcon(V,n,m,{x0:S,y0:O,x1:v,y1:x,dis:l}))}}},gp.prototype.clear=function(){this._guideLine=null};var Wd=Cf.Guide.Hover=function(P){var c=this;c._interactor=P};Wd.prototype={},Wd.prototype.constructor=Wd,z.defineProperties(Wd.prototype,{}),Wd.prototype._42=function(){var k=this._interactor;if(k.getStyle("hoverGuideVisible")&&!k.gvEditing){var n=k.hoverData,K=k.gv;if(!Ob(n)||K.isSelected(n))return k.hoverData=null,void 0;var j=Ec(K,n),m=Cf.toScreenPosition(K,{x:j.x,y:j.y}),N=Cf.toScreenPosition(K,{x:j.x+j.width,y:j.y+j.height});Cf.Icons.DrawIcon(k,k._context,Cf.Icons.HoverDataRect,{min:m,max:N,color:k.getStyle("hoverGuideColor")||k.getStyle("baseColor"),borderWidth:k.getStyle("hoverGuideBorderWidth")||1,borderPattern:k.getStyle("hoverGuideBorderPattern")||[1,4]})}},Cf.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,rotateTipVisible:!0,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Ai=Cf.Icons={},qb=1e4,hh=null,Zj=Cf.DefaultStyleMap.baseColor,Vk="rgb(183,232,135)",Ze="rgb(255,204,153)",Fr=6;U.Default.setImage("Icons.RectPoint",{width:Fr,height:Fr,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Zj}},rect:[0,0,Fr,Fr]}]}),Ai.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var Y=Ai.GroupSubEntityRect.data;if(!Y)return[];var S=Y.min,j=Y.max;return[S.x,S.y,S.x,j.y,j.x,j.y,j.x,S.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Ai.GroupSubEntityRect.data.isKeyOb?Zj:Zj}}}]};var si=4;Ai.HoverDataRect={comps:[{type:"shape",points:{func:function(){var A=Ai.HoverDataRect.data;if(!A)return[];var b=A.min,I=A.max,F=si;return b.x-=F,b.y-=F,I.x+=F,I.y+=F,[b.x,b.y,b.x,I.y,I.x,I.y,I.x,b.y]}},segments:[1,2,2,2,5],background:null,borderWidth:{func:function(){return Ai.HoverDataRect.data.borderWidth}},borderColor:{func:function(){return Ai.HoverDataRect.data.color}},borderCap:"butt",borderPattern:{func:function(){return Ai.HoverDataRect.data.borderPattern}}}]},Ai.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Ai.Line.data.P1.x,Ai.Line.data.P1.y],Fr,Fr]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Ai.Line.data.P2.x,Ai.Line.data.P2.y],Fr,Fr]}}}]},Ai.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Ai.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Ai.Rect={comps:[{type:"shape",points:{func:function(){var K=Ai.Rect.data;if(!K)return[];var I=K.LT,_=K.LB,w=K.RB,y=K.RT;return[I.x,I.y,_.x,_.y,w.x,w.y,y.x,y.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Zj}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ai.Rect.data.rotation}},rect:{func:function(){return[[Ai.Rect.data.LT.x,Ai.Rect.data.LT.y],Fr,Fr]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ai.Rect.data.rotation}},rect:{func:function(){return[[Ai.Rect.data.LB.x,Ai.Rect.data.LB.y],Fr,Fr]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ai.Rect.data.rotation}},rect:{func:function(){return[[Ai.Rect.data.RB.x,Ai.Rect.data.RB.y],Fr,Fr]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ai.Rect.data.rotation}},rect:{func:function(){return[[Ai.Rect.data.RT.x,Ai.Rect.data.RT.y],Fr,Fr]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ai.Rect.data.rotation}},visible:{func:function(){return Ai.Rect.data.L?!0:!1}},rect:{func:function(){return[[Ai.Rect.data.L.x,Ai.Rect.data.L.y],Fr,Fr]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ai.Rect.data.rotation}},visible:{func:function(){return Ai.Rect.data.R?!0:!1}},rect:{func:function(){return[[Ai.Rect.data.R.x,Ai.Rect.data.R.y],Fr,Fr]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ai.Rect.data.rotation}},visible:{func:function(){return Ai.Rect.data.T?!0:!1}},rect:{func:function(){return[[Ai.Rect.data.T.x,Ai.Rect.data.T.y],Fr,Fr]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ai.Rect.data.rotation}},visible:{func:function(){return Ai.Rect.data.B?!0:!1}},rect:{func:function(){return[[Ai.Rect.data.B.x,Ai.Rect.data.B.y],Fr,Fr]}}}]};var ei=16;U.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return Zj}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return Zj}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Ai.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Ai.Anchor.data.POS.x,Ai.Anchor.data.POS.y],ei,ei]}}}]},Ai.TipShiftX=12,Ai.TipShiftY=12;var ni=[8,28];Ai.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Ai.TipHelper.data.helperPos.x,Ai.TipHelper.data.helperPos.y,ni[0]*Ai.TipHelper.data.size,ni[1]]}},background:{func:function(){return hh.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Ai.TipHelper.data.text}},rect:{func:function(){return[Ai.TipHelper.data.helperPos.x,Ai.TipHelper.data.helperPos.y,ni[0]*Ai.TipHelper.data.size,ni[1]]}},color:{func:function(){return hh.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var rc=7;Ai.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!Ai.ShapePoint.data.dynamicVisible}},rect:{func:function(){var q=Ai.ShapePoint.data.point,v=Ai.ShapePoint.data.size||rc;return[q,v+10,v+10]}},background:{func:function(){var n=Date.now(),o=Ai.ShapePoint.data.dynamicPeriod||1500,u=Math.sin(n%o/o*Math.PI);return"rgba(27,124,22,"+.5*u+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var Y=Ai.ShapePoint.data.point,m=Ai.ShapePoint.data.size||rc;return[Y,m,m]}},background:{func:function(){var Q=Ai.ShapePoint.data.isEnd;return Q?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return Ai.ShapePoint.data.color||Zj}}},{type:"rect",visible:{func:function(){return!!Ai.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return Zj}},rect:{func:function(){var M=5;return[Ai.ShapePoint.data.point,M,M]}}}]},Ai.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!Ai.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return Ai.ShapeBgCurve.data.P}},segments:{func:function(){return Ai.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var d=Date.now(),U=Ai.ShapeBgCurve.data.dynamicPeriod||1500,R=Math.sin(d%U/U*Math.PI);return"rgba(27,124,22,"+.3*R+")"}}},{type:"shape",points:{func:function(){return Ai.ShapeBgCurve.data.P}},segments:{func:function(){return Ai.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return Ai.ShapeBgCurve.data.color||Zj}}}]};var tl=8;Ai.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var V=Ai.ShapeHighlighPoint.data;return[[V.x,V.y],tl,tl]}},background:{func:function(){return hh.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var tr=10;Ai.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var M=Ai.ShapeHighlighRealPoint.data;return[[M.x,M.y],tr,tr]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return Zj}}}]};var Oe=8;Ai.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var A=Ai.ShapeHighlighCtrlPoint.data,o=A.x,J=A.y,w=Oe/2;return[o-w,J-w,o-w,J+w,o+w,J+w,o+w,J-w]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return hh.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return hh.getStyle("shapeCtrlPointBorderColor")||Zj}}}]};var Rh=3;Ai.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Ai.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Rh,borderColor:{func:function(){return hh.getStyle("curveHighlightColor")}}}]},Ai.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Ai.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Ai.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Ai.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Ai.MoveLineGuide.data.center?Vk:Ze}}}]};var Ar=5;Ai.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var q=Ai.MoveLineGuideDistanceH.data,E=q.x0,w=q.y0;return[E,w-Ar,E,w+Ar]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ze},{type:"shape",points:{func:function(){var M=Ai.MoveLineGuideDistanceH.data,H=M.x1,y=M.y1;return[H,y-Ar,H,y+Ar]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ze},{type:"text",text:{func:function(){return Math.round(Ai.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var n=Ai.MoveLineGuideDistanceH.data;return[[(n.x0+n.x1)/2,n.y0-10],20,20]}},color:Ze,font:"12px Arial",align:"center"}]},Ai.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var W=Ai.MoveLineGuideDistanceV.data,L=W.x0,X=W.y0;return[L-Ar,X,L+Ar,X]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ze},{type:"shape",points:{func:function(){var X=Ai.MoveLineGuideDistanceV.data,u=X.x1,R=X.y1;return[u-Ar,R,u+Ar,R]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ze},{type:"text",text:{func:function(){return Math.round(Ai.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var O=Ai.MoveLineGuideDistanceV.data;return[[O.x0-10,(O.y0+O.y1)/2],20,20]}},color:Ze,font:"12px Arial",align:"center"}]},U.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Ai.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var O=Ai.EdgeElevationGuide.data,q=O.x,Z=O.y,s=hh.getStyle("curveElevationIntersectSize"),f=hh.getStyle("curveElevationGuideShift");return q+=f[0],Z+=f[1],[q-s,Z-s,2*s,2*s]}}}]},U.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),U.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Ai.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Ai.ConnectGuide.data.rotation}},rect:{func:function(){var K=Ai.ConnectGuide.data.connect;K.x,K.y;var u=hh.getStyle("connectGuideIntersectSize");return[[K.x,K.y],2*u,2*u]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var z=Ai.ConnectGuide.data.cursorPos||Ai.ConnectGuide.data.connect,V=hh.getStyle("connectGuideIntersectSize");return[[z.x,z.y],2*V-2,2*V-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var v=Ai.ConnectGuide.data.connect,r=Ai.ConnectGuide.data.cursorPos||v;return[v.x,v.y,v.x+.5*(r.x-v.x),v.y,r.x+.5*(v.x-r.x),r.y,r.x,r.y]}}}]},U.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),U.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Ai.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var l=Ai.ConnectGuideGarbage.data.hover;return l?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var u=Ai.ConnectGuideGarbage.data,I=hh.getStyle("connectGuideGarbageIntersectsize");return u.hover&&(I+=5),[[u.x,u.y],2*I,2*I]}}}]};var Hm=6;Ai.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Ai.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var T=Ai.ShapeActivingCtrl.data;return[T.point.x,T.point.y,T.c1.x,T.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Zj}}},{type:"shape",visible:{func:function(){return Ai.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var M=Ai.ShapeActivingCtrl.data;return[M.point.x,M.point.y,M.c2.x,M.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Zj}}},{type:"shape",visible:{func:function(){return Ai.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var X=Ai.ShapeActivingCtrl.data.c1,A=X.x,l=X.y,K=Hm/2;return"c1"===Ai.ShapeActivingCtrl.data.hl&&(K+=.5),[A-K,l-K,A-K,l+K,A+K,l+K,A+K,l-K]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return hh.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Ai.ShapeActivingCtrl.data.hl?hh.getStyle("shapeCtrlPointHighlightBorder")||Zj:hh.getStyle("shapeCtrlPointBorderColor")||Zj}}},{type:"shape",visible:{func:function(){return Ai.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var D=Ai.ShapeActivingCtrl.data.c2,q=D.x,j=D.y,k=Hm/2;return"c2"===Ai.ShapeActivingCtrl.data.hl&&(k+=.5),[q-k,j-k,q-k,j+k,q+k,j+k,q+k,j-k]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return hh.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Ai.ShapeActivingCtrl.data.hl?hh.getStyle("shapeCtrlPointHighlightBorder")||Zj:hh.getStyle("shapeCtrlPointBorderColor")||Zj}}}]},Ai.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Zj}},rect:{func:function(){return[[Ai.RoundPoint.data.x,Ai.RoundPoint.data.y],Fr,Fr]}}}]},Ai.AttachPoint={comps:[{type:"rect",background:{func:function(){return Ai.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return Zj}},rect:{func:function(){var j=Ai.AttachPoint.data.isAttach?Fr+4:Fr;return[[Ai.AttachPoint.data.x,Ai.AttachPoint.data.y],j,j]}}}]},Ai.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return Ai.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return Ai.SimpleRect.data.color||Zj}},rect:{func:function(){var P=Ai.SimpleRect.data;return[P.x,P.y,P.width,P.height]}}}]},U.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),Ai.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var R=Ai.MoveDummy.data;return[[R.pos.x,R.pos.y],2*R.size,2*R.size]}}}]},Cf.Icons.DrawIcon=function(o,n,j,J){j.width=j.height=qb,j.data=J,hh=o,U.Default.drawImage(n,j,0,0,qb,qb),hh=s},Cf.Icons.MapPoints=function(D,T){for(var G=0,c=D.length;c>G;G++)D[G]/=T},Cf.roundTo=function(F,J,U){var X=Math.abs(F%J);return U>X||U>J-X?J*Math.round(F/J):F},Cf.toFixed=function(n){return Math.round(100*n)/100},Cf.getDataMatrix=function(X){if(X instanceof U.Shape){var N=new U.Math.Matrix2d,J=X.getPosition();return N.translate(-J.x,-J.y).scale(X.getScale().x,X.getScale().y).rotate(X.getRotation()).translate(J.x,J.y),N}return X.getMatrix?X.getMatrix():new U.Math.Matrix2d};var Fc=Cf.Math.Curve=function(){this._curves=[]};Fc.prototype={},Fc.prototype.constructor=Fc,Fc.prototype.createFromHtShape=function(K,A,M){A instanceof U.List&&(A=A.toArray());var F,x,k,S,L,e,h,l=this,X=null,N=null,z=0,a=Cf.Math.Vector2,r=Cf.Math.CubicBezier,P=function(C){return new a(K[C],K[C+1],M?M[C/2]:s)};for(x=0,k=A.length;k>x;x++){switch(S=A[x],L=null,S){case 1:N=P(z),X=N,z+=2;break;case 2:F=P(z),z+=2,L=new r(N,N.clone(),F.clone(),F),N=F;break;case 3:e=P(z),F=P(z+2),z+=4,L=new r(N,e.clone().sub(N).multiplyScalar(2/3).add(N),e.clone().sub(F).multiplyScalar(2/3).add(F),F),N=F;break;case 4:e=P(z),h=P(z+2),F=P(z+4),z+=6,L=new r(N,e,h,F),N=F;break;case 5:if(!X)break;L=new r(N,N.clone(),X.clone(),X),N=null,X=null}L&&(L._index=l._curves.length,l._curves.push(L))}},Fc.prototype.checkPoint=function(B,s){var P,R,x,h,o,m=this,w=m._curves;for(P=0,R=w.length;R>P;P++)if(h=w[P],o=h.intersectRect(B,s,s),o.length)return x=0,o.forEach(function(k){x+=k.t}),x/=o.length,B=h.getPointAt(x),B.t=x,{bezier:h,intersection:B}},Fc.prototype.insertKnot=function(n,f){var k=n.insertKnot(f),i=this,z=i._curves;z.splice(n._index,1,k[0],k[1])},Fc.prototype._isCloseEnough=function(G,A){return Math.abs(G.x-A.x)<1e-6&&Math.abs(G.y-A.y)<1e-6},Fc.prototype._isSamePoint=function(c,K){return c===K},Fc.prototype.moveRealPoint=function(f,E){var U=this,z=U._curves,T=E.clone().sub(f);z.forEach(function(c){var $=c._p1;c._p2,c._p3;var b=c._p4;U._isSamePoint($,f)&&(c._p2.add(T),c._p1=E),U._isSamePoint(b,f)&&(c._p3.add(T),c._p4=E)})},Fc.prototype.moveCtrlDueToRealPointMovement=function(Y,P){var Z=this,C=Z._curves,L=function(_){_.add(P),_.e&&P.e&&(_.e+=P.e)};C.forEach(function(Q){var V=Q._p1;Q._p2,Q._p3;var M=Q._p4;Z._isSamePoint(V,Y)&&L(Q._p2),Z._isSamePoint(M,Y)&&L(Q._p3)})},Fc.prototype.moveCtrlPoint=function(U,A,t){var d=U[t];
if(d){d.e!==s&&(A.e=d.e);var y=this,C=y._curves;A.clone().sub(d),C.forEach(function(Y){var p;"c2"===t?p="_p2":"c1"===t&&(p="_p3"),y._isSamePoint(Y[p],d)&&(Y[p]=A)}),U[t]=A}},Fc.prototype.deleteRealPoint=function(A,L){var c,E,k,F,H,t,B,z=this,r=z._curves,g={},D=[],n=Cf.Math.CubicBezier;for(E=0,k=r.length;k>E;E++)c=r[E],F=c._p1,H=c._p2,t=c._p3,B=c._p4,(g[E]||!z._isSamePoint(F,A))&&(z._isSamePoint(B,A)?k>E+1&&z._isSamePoint(r[E+1]._p1,A)&&(L||D.push(new n(F,H,r[E+1]._p3,r[E+1]._p4))):D.push(c));z._curves=D},Fc.prototype.findPairs=function(N,E){var T,P,S,Z,A,M,D,p,q=this,U=q._curves,y={},n=[];for(P=0,S=U.length;S>P;P++)T=U[P],Z=T._p1,A=T._p2,M=T._p3,D=T._p4,!y[P]&&q._isSamePoint(Z,N)&&(E?n.push({point:Z,r2:D}):n.push({point:Z,c2:A})),q._isSamePoint(D,N)&&(p=E?{point:D,r1:Z}:{point:D,c1:M},S>P+1&&q._isSamePoint(U[P+1]._p1,N)&&(E?p.r2=U[P+1]._p4:p.c2=U[P+1]._p2,y[P+1]=!0),n.push(p));return n},Fc.prototype.toHtShape=function(){var B=this,z=B._curves,x=[],l=[],L={x:1/0,y:1/0};return z.forEach(function(H){var o=H._p1,V=H._p2,w=H._p3,u=H._p4;return B._isCloseEnough(o,L)||(x.push(1),l.push(o.clone())),L=u,B._isCloseEnough(o,V)&&B._isCloseEnough(w,u)?(x.push(2),l.push(u.clone()),void 0):(x.push(4),l.push(V.clone(),w.clone(),u.clone()),void 0)}),{segments:x,points:l}};var Of=Cf.Math.CubicBezier=function(O,V,i,S){var N=this;N._id=Cf.Math.CubicBezier._globalId++,N._p1=O,N._p2=V,N._p3=i,N._p4=S};Of._globalId=1,Of.prototype={},Of.prototype.constructor=Of,Of.prototype.toString=function(){return this._id},Of.prototype.intersectRect=function(B,h,y){var w=h/2,V=y/2,M=B.x,j=B.y,P=Cf.Math.Vector2,L=new P(-w+M,-V+j),b=new P(w+M,V+j),Q=new P(b.x,L.y),$=new P(L.x,b.y),Z=this,X=Z.intersectLine(L,Q),p=Z.intersectLine(Q,b),H=Z.intersectLine(b,$),i=Z.intersectLine($,L),e=X.concat(p).concat(H).concat(i);return e},Of.prototype.intersectLine=function(l,x){var e,_,Z,T,W,k,Q,V,s,P,F,o,c,O=this,I=l.clone().min(x),G=l.clone().max(x);T=O._p1,W=O._p2,k=O._p3,Q=O._p4,e=T.clone().multiplyScalar(-1),_=W.clone().multiplyScalar(3),Z=k.clone().multiplyScalar(-3),F=e.add(_).add(Z).add(Q),e=T.clone().multiplyScalar(3),_=W.clone().multiplyScalar(-6),Z=k.clone().multiplyScalar(3),P=e.add(_).add(Z),e=T.clone().multiplyScalar(-3),_=W.clone().multiplyScalar(3),s=e.add(_),V=T.clone(),c=new Cf.Math.Vector2(l.y-x.y,x.x-l.x),o=l.x*x.y-x.x*l.y;for(var w=O.getRoots(c.dot(F),c.dot(P),c.dot(s),c.dot(V)+o),j=new Array,t=0,X=w.length;X>t;t++){var S=w[t];if(!(0>S||S>1)){var r=O.getPointAt(S);r.t=S,l.x==x.x?I.y<=r.y&&r.y<=G.y&&j.push(r):l.y==x.y?I.x<=r.x&&r.x<=G.x&&j.push(r):r.x>=I.x&&r.y>=I.y&&r.x<=G.x&&r.y<=G.y&&j.push(r)}}return j},Of.prototype.solveTForPoint=function(R){var O,u,y,$,g=this;O=g._p1.x-R.x,u=g._p2.x-R.x,y=g._p3.x-R.x,$=g._p4.x-R.x;for(var k=g.getRoots($-3*y+3*u-O,3*y-6*u+3*O,3*u-3*O,O),U=s,o=1/0,i=0,E=k.length;E>i;i++){var F=k[i];if(!(0>F||F>1)){var p=g.getPointAt(F);p.t=F;var N=Math.abs(p.y-R.y);o>N&&(o=N,U=p)}}return U},Of.prototype.getPointAt=function(z){var C=this,$=C._p1,h=C._p2,n=C._p3,p=C._p4,j=$.clone().lerp(h,z),Z=h.clone().lerp(n,z),J=n.clone().lerp(p,z),l=j.lerp(Z,z),u=Z.lerp(J,z);return l.lerp(u,z)},Of.prototype.getPointByPercentage=function(T){var L=this.length*T,s=this._cacheLength,H=s.length;if(0===L)return s[0].point;if(T>=1)return s[H-1].point;for(var u=0;H>u;u++){var y=s[u];if(!(y.len<L)){var U=s[u-1];return y.point.clone().sub(U.point).setLength(L-U.len).add(U.point)}}},Of.prototype.getTByPercentage=function($){var b=this.length*$,S=this._cacheLength,_=S.length;if(0===b||0>=$)return S[0].t;if($>=1)return S[_-1].t;for(var s=0;_>s;s++){var U=S[s];if(!(U.len<b)){var r=S[s-1];return(b-r.len)/(U.len-r.len)*(U.t-r.t)+r.t}}},Of.prototype.getRoots=function(F,U,u,D){var T,e,K,C,M,i=new Array;if(Math.abs(F)<1e-6){var T=U,e=u/T,K=D/T,C=e*e-4*K;if(C>0){var M=Math.sqrt(C);i.push(.5*(-e+M)),i.push(.5*(-e-M))}else 0==C&&i.push(.5*-e)}U/=F,u/=F,D/=F,T=(3*u-U*U)/3,e=(2*U*U*U-9*u*U+27*D)/27;var v=U/3,c=e*e/4+T*T*T/27,n=e/2;if(Math.abs(c)<=1e-6&&(c=0),c>0){var q,Q,M=Math.sqrt(c);q=-n+M,Q=q>=0?Math.pow(q,1/3):-Math.pow(-q,1/3),q=-n-M,q>=0?Q+=Math.pow(q,1/3):Q-=Math.pow(-q,1/3),i.push(Q-v)}else if(0>c){var s=Math.sqrt(-T/3),g=Math.atan2(Math.sqrt(-c),-n)/3,O=Math.cos(g),t=Math.sin(g),R=Math.sqrt(3);i.push(2*s*O-v),i.push(-s*(O+R*t)-v),i.push(-s*(O-R*t)-v)}else{var q;q=n>=0?-Math.pow(n,1/3):Math.pow(-n,1/3),i.push(2*q-v),i.push(-q-v)}return i},Of.prototype._70I=function(){var r=this;return r._p1.distanceToSquared(r._p2)<1e-10&&r._p3.distanceToSquared(r._p4)<1e-10},Of.prototype.insertKnot=function(j){var u=this,R=u._p1,_=u._p2,Y=u._p3,E=u._p4,X=R.clone().lerp(_,j),o=_.clone().lerp(Y,j),C=Y.clone().lerp(E,j),Q=X.clone().lerp(o,j),y=o.clone().lerp(C,j),V=Q.clone().lerp(y,j);return u._70I()?(R.clone().lerp(E,j),[new Cf.Math.CubicBezier(R,R.clone(),V.clone(),V),new Cf.Math.CubicBezier(V,V.clone(),E.clone(),E)]):[new Cf.Math.CubicBezier(R,X,Q,V),new Cf.Math.CubicBezier(V,y,C,E)]},z.defineProperties(Of.prototype,{length:{get:function(){var G=this._cacheLength;if(!G){G=this._cacheLength=[];for(var z=this._p1,$=0,s=0;1>=$;){var J=this.getPointAt($+=.001);s+=J.clone().sub(z).length(),z=J,G.push({len:s,t:$,point:J.clone()})}}return G[G.length-1].len}},p1:{get:function(){return this._p1},set:function(f){this._p1=f,this._cacheLength=s}},p2:{get:function(){return this._p2},set:function(y){this._p2=y,this._cacheLength=s}},p3:{get:function(){return this._p3},set:function(c){this._p3=c,this._cacheLength=s}},p4:{get:function(){return this._p4},set:function(t){this._p4=t,this._cacheLength=s}}});var cc=U.Default.getInternal().ui().EdgeUI,Xl={_47O:function(z){var j=this,E=Xl.getBackups()._47O;Cf.inEdit(j.gv)||E.call(j,z)}};Cf.Inject.registAsModule(Xl,cc);var yi=U.Default.getInternal().ui().NodeUI,Xn={_47O:function(c){var N=this,f=Xn.getBackups()._47O;Cf.inEdit(N.gv)||f.call(N,c)},getSelectWidth:function(){var U=this,Y=U.gv,w=U._data;if(Y.isEditable(w)&&Cf.inEdit(Y))return 0;var q=Xn.getBackup("getSelectWidth");return q.call(U)}};Cf.Inject.registAsModule(Xn,yi);var Kp=U.graph.GraphView,kd={_editPointSize:function(){var d=U.Default.isTouchable,N=Cf.getStyle("pointSize");return N[d?0:1]}(),isPointEditable:function(p){var G=this;if(Cf.inEdit(G))return G._pointEditableFunc?G._pointEditableFunc(p):!0;var Z=kd.getBackup("isPointEditable");Z.call(G,p)},isEditable:function(t){var l,f=this,D=kd.getBackup("isEditable");if(l=t instanceof Cf.Group?!0:D.call(f,t),!Cf.inEdit(f))return l;if(!(t instanceof U.Edge))return l;if(!t.s("2d.editable"))return!1;var R=f.getEditableFunc();return R?R(t):!0},_42:function(F,$){var N=this,X=kd.getBackups()._42;if(X.call(N,F,$),Cf.inEdit(N)){var o=N.getEditInteractor();o.drawImpl()}}};Cf.Inject.registAsModule(kd,Kp);var De=U.Default.getInternal().ui().ShapeUI,yn={_47O:function(T){var O=this,h=yn.getBackups()._47O;Cf.inEdit(O.gv)||h.call(O,T)}};Cf.Inject.registAsModule(yn,De);var Qb=U.graph.DefaultInteractor,Fh={handle_mousewheel:function(w){var d=this,S=Fh.getBackup("handle_mousewheel");Cf.inEdit(d.gv)||S.call(d,w)}};Cf.Inject.registAsModule(Fh,Qb);var Do=U.graph.MoveInteractor,ak={_calcShift:function(p,y){var T=this,j=ak.getBackup("_calcShift"),R=T.gv;if(!Cf.inEdit(R))return j.call(T,p,y);var b=R.getEditInteractor(),F=b.getSubModule("Move").calcShift(p,y,T);return F||j.call(T,p,y)},clear:function(w){var z=this,t=ak.getBackup("clear");t.call(z,w);var T=z.gv;if(Cf.inEdit(T)){var f=T.getEditInteractor();f.getSubModule("Move").clear(w)}}};Cf.Inject.registAsModule(ak,Do);var gp=Cf.Rect=function(q){this.catalog="Rect",this._interactor=q};gp.prototype={},gp.prototype.constructor=gp,gp.prototype.gatherInfo=function(d,w){var m=this;if(1===w.length){var Z=w[0];return Z instanceof U.Shape&&Z._70I()?m.gatherLine(d,Z):ve(Z,d)?!1:m.gatherSingleTarget(d,Z)}return w.length>1?m.gatherMultiTargets(d,w):!1},gp.prototype.gatherSingleTarget=function(f,h){if(h.getCorners){var M,x=this,I=x.info;x.target=h,M=x.screenInfo={};var N=h.getCorners();I.LT=new Cf.Math.Vector2(N[0]),I.LB=new Cf.Math.Vector2(N[1]),I.RB=new Cf.Math.Vector2(N[2]),I.RT=new Cf.Math.Vector2(N[3]),I.T=I.LT.clone().add(I.RT).divideScalar(2),I.B=I.LB.clone().add(I.RB).divideScalar(2),I.L=I.LT.clone().add(I.LB).divideScalar(2),I.R=I.RT.clone().add(I.RB).divideScalar(2);for(var $ in I)M[$]=Cf.toScreenPosition(f,I[$]);var w=x._interactor,G=w.getStyle("checkSize"),o=function(o,S,E){var P=S.clone().sub(o).setLength(-G),n=E.clone().sub(o).setLength(-G),c=P.add(n).add(o);return c};return M.rotLT=o(M.LT,M.RT,M.LB),M.rotLB=o(M.LB,M.LT,M.RB),M.rotRB=o(M.RB,M.LB,M.RT),M.rotRT=o(M.RT,M.LT,M.RB),M.rotT=M.rotLT.clone().add(M.rotRT).divideScalar(2),M.rotB=M.rotLB.clone().add(M.rotRB).divideScalar(2),M.rotL=M.rotLT.clone().add(M.rotLB).divideScalar(2),M.rotR=M.rotRT.clone().add(M.rotRB).divideScalar(2),M.rotation=h.getRotation(),x.gatherConnectInfo(),!0}},gp.prototype.gatherConnectInfo=function(){var x=this,J=x.target,W=x._interactor,u=x.screenInfo,r=W.gv;if(r.isConnectActionVisible(J)&&W.getStyle("connectGuideVisible")){var f;J.s&&(f=J.s("connectGuideShift")),f||(f=W.getStyle("connectGuideShift"));var e=J.getAnchor(),S=J.getSize(),T=J.toGlobal({x:S.width*(f[0]-e.x),y:S.height*(f[1]-e.y)});T=Cf.toScreenPosition(r,T),u.P1?T.add(u.P2.clone().sub(u.P1).setLength(f[2])):(T.add(u.RT.clone().sub(u.LT).setLength(f[2])),T.add(u.LB.clone().sub(u.LT).setLength(f[3]))),u.connect=T}},gp.prototype.gatherMultiTargets=function(t,s){var J=Cf.Group.findOrCreateGroup(s,this._interactor._uuid);if(!J)return!1;var L=this;return L.editing&&"rotate"!==L.editing.mode||J.calcInfo(),L.gatherSingleTarget(t,J)},gp.prototype.gatherLine=function(i,X){this.target=X;var Y=this.screenInfo={},m=X.getPoints(),s=Cf.getDataMatrix(X);return Y.P1=Cf.toScreenPosition(i,s.apply(m.get(0))),Y.P2=Cf.toScreenPosition(i,s.apply(m.get(1))),this.gatherConnectInfo(),!0},gp.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],gp.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],gp.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],gp.prototype.check=function(r,g,B){if(U.Default.isLeftButton(g)){var b=this;if(b.editing=null,b.tipInfo=null,b.screenInfo){var Z=b.target,H=r.isEditable(Z),Y=b.screenInfo;if(H&&Y.connect){var m=b._checkConnect(B);if(m)return m}if(Y.P1)return b._checkLine(B);var N,L,t,$=null,d=b._interactor,J=d.getStyle("checkSize");if(H&&r.isRectEditable(Z))for(L=0;L<Cf.Rect.ResizeKeys.length;L++)if(t=Cf.Rect.ResizeKeys[L],Cf.checkHit(B,Y[t],J)){$=t,N="resize";break}if(!$&&H&&r.isRotationEditable(Z)&&!d.getStyle("rotateAsClock")){var k=d.getStyle("rotateCheckSize");for(L=0;L<Cf.Rect.RotateKeys.length;L++)if(t=Cf.Rect.RotateKeys[L],Cf.checkHit(B,Y[t],k)){$=t,N="rotate";break}}if(!$)return d.setCursor("default"),void 0;if("rotate"===N){var I,F=r.lp(g);if(Z instanceof Cf.Group){var O=d.getStyle("groupRotateModeKey");"string"==typeof O&&(O=[O]);for(var R=!1,i=0,f=O.length;f>i;i++)if(g[O[i]]){R=!0;break}var h=d.getStyle("groupRotateModeDefault");I=R?"batch"===h?"block":"batch":h}var K="batch"===I?Z.getAnchor2():Z.getPosition(),c=Math.atan2(F.y-K.y,F.x-K.x);d._setRotateCursor(c),b.editing={mode:N,key:$,pos:K,flipY:Z.getScale().y<0,rotation:Z.getRotation(),hitRot:c},I&&(b.editing.groupRotateMode=I)}else{var X=Cf.Rect.ResizeKeys.indexOf($),j=Cf.Rect.ResizeDirection[X],l=Math.cos(Z.getRotation()),S=Math.sin(Z.getRotation()),D=j.x*Math.sign(Z.getScale().x),Q=j.y*Math.sign(Z.getScale().y),T=Math.atan2(-S*D-l*Q,l*D-S*Q),e=(Math.round(T/(Math.PI/4))+8)%8,v=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][e];this._interactor.setCursor(v);var M=Z.getWidth(),y=Z.getHeight(),z=Z.getAnchor();b.editing={mode:N,key:$,rect:{x:-M*z.x,y:-y*z.y,width:M,height:y},anchor:z,matrix:Z.getMatrix()}}return $}}},gp.prototype._checkLine=function(k){var t=this;t.screenInfo;var T,$=t._interactor.getStyle("checkSize");if(Cf.checkHit(k,t.screenInfo.P1,$))T="P1";else{if(!Cf.checkHit(k,t.screenInfo.P2,$))return this._interactor.setCursor("default"),void 0;T="P2"}return t.editing={mode:"line",key:T},T},gp.prototype._checkConnect=function(_){var o=this,C=o.screenInfo,N=o._interactor,k=N.getStyle("connectGuideIntersectSize"),Q=C.connect,t=_.x,x=Q.x;if(x>t&&k>x-t&&Math.abs(Q.y-_.y)<k||t>=x&&Cf.checkHit(_,Q,k)){var s="connect",r=p.getConnectAction(N.gv);if(o.editing={mode:s},r&&r.delete)if(o.target instanceof Cf.Group){var m=!0;N.gv.sm().getSelection().each(function(E){r.delete.visible.call(null,N.gv,E)||(m=!1)}),o.editing.hasDeleteAction=m}else r.delete.visible.call(null,N.gv,o.target)&&(o.editing.hasDeleteAction=!0);return N.setCursor("default"),s}},gp.prototype._fireEditEvent=function(U,P){var Y=this._interactor,j=this.editing;if(j){var q=j.mode;q="rotate"===q?"Rotation":"connect"===q?"Connection":"resize"===q?"Rect":q[0].toUpperCase()+q.slice(1),Y.fi({kind:U+"Edit"+q,event:P})}},gp.prototype.startEdit=function(w,$){w.startDragging($);var b=this;b._interactor.fi({kind:"prepareEdit",event:$});var y=b.editing,V=b.target;if(y){if(b._fireEditEvent("begin",$),y.started=!0,"rotate"===y.mode)return y.groupRotateMode&&V.beginRotate(y),w._42(),void 0;if("connect"!==y.mode)("line"===y.mode||V&&0===V.getRotation())&&(b._inSmartGuide=!0,b._interactor.rectGuide.gatherRects());else if(y.hasDeleteAction){var R=w.gv,c=b._interactor.getStyle("connectGuideGarbageShift");y.garbageInfo={x:R.getWidth()*c[0]+c[2],y:R.getHeight()*c[1]+c[3],size:b._interactor.getStyle("connectGuideGarbageIntersectsize")},w._42()}}},gp.prototype._46O=function(r){var l,k,S=this,M=S.editing,L=S.target;if(M){if("connect"===M.mode&&!M.canceled&&!M.deleted)try{M.garbageInfo&&M.garbageInfo.hover?p.doDeleteConnectionAction(S._interactor.gv,L):p.doConnectAction(S._interactor.gv,L,M.target)}catch(v){console.error(v)}k=M.freezeFlag,l=S.editing.groupRotateMode,S._fireEditEvent("end",r),S.editing=null}S.tipInfo=null,S._inSmartGuide&&(S._interactor.rectGuide.clear(),S._inSmartGuide=!1),l&&L&&L.endRotate(),L instanceof U.Block&&(k===s?delete L._freezeSyncFromChildren:L._freezeSyncFromChildren=k,L.updateFromChildren())},gp.prototype.handleNormalStateDelete=function(){var I=this,n=I.editing;if(n&&"connect"===n.mode&&!n.canceled&&!n.deleted){if(n.garbageInfo){try{p.doDeleteConnectionAction(I._interactor.gv,I.target)}catch(g){console.error(g)}n.garbageInfo=null}return n.cursorPos=null,n.targetCorners=null,n.deleted=!0,I._interactor._42(),!0}},gp.prototype.handleNormalStateKeyDown=function(M){var o=this,d=o.editing;return!d||"connect"!==d.mode||d.canceled||d.deleted?void 0:U.Default.isEsc(M)?(d.cursorPos=null,d.targetCorners=null,d.canceled=!0,o._interactor._42(),!0):void 0},gp.prototype.handleEdit=function(L,C){var V=this,h=V.editing;if(h){var A,q,e,J,Q,b=V.target,y=h.key,N=h.mode,I=L.lp(C),E=V._interactor;if("connect"===N){if(h.canceled)return;if(h.deleted)return;h.cursorPos=E._getLogicalPoint(C);var P=h.garbageInfo;return P&&Cf.checkHit(h.cursorPos,P,P.size)?(P.hover=!0,h.target=null,h.targetCorners=null):(P&&(P.hover=!1),h.target=L.getDataAt(I,function(I){return L.isSelectable(I)?Ob(I)?!0:!1:!1})||null,h.targetCorners=Cf.getTargetCornersOnScreen(L,h.target)),E._42(),void 0}if("rotate"===N){var T,D,F=h.pos,M=Math.atan2(I.y-F.y,I.x-F.x);if(h.groupRotateMode?D=M-h.hitRot:(T=M-h.hitRot,D=h.rotation+T),D%=2*Math.PI,0>D&&(D+=2*Math.PI),!U.Default.isCtrlDown(C)){var G,p;te(C)?(G=E.getStyle("shiftRotateRound"),p=G/2):(G=E.getStyle("rotateRound"),p=E.getStyle("rotateSensitivity")),D=Cf.roundTo(D,G,p)}h.groupRotateMode?(T=D-(h.lastRotation||0),0!==T&&(b.addRotation(T,h.groupRotateMode,function(Q){return L.isRotationEditable(Q)}),h.lastRotation=D)):b.setRotation(D),E._setRotateCursor(M),D>Math.PI&&(D-=2*Math.PI);var z=180*(D/Math.PI);z=z.toFixed(2),A=""+z+"°"}else if("resize"===N){var O=h.rect;e=O.x,J=O.y;var w,X=O.width,l=O.height,d=h.anchor,a=h.matrix,o=b.s&&b.s("keepAspectRatio")||E.getStyle("keepAspectRatio");te(C)&&(o=!o);var g=V._unionPointMode1,Y=V._unionPointMode2;if(V._inSmartGuide&&!U.Default.isCtrlDown(C)&&!o){var m;"L"===y||"R"===y?m="x":("T"===y||"B"===y)&&(m="y"),V._adsorbedToClosest(I,m),Q=!0}w=a.tfi(I);var Z;"LT"===y?(O=g(w,{x:e+X,y:J+l},X,l,o),Z=9):"T"===y?(O=Y({x:e,y:w.y},{x:e+X,y:J+l},X,l,o,"v"),Z=1):"RT"===y?(O=g(w,{x:e,y:J+l},X,l,o),Z=33):"L"===y?(O=Y({x:w.x,y:J},{x:e+X,y:J+l},X,l,o,"h"),Z=8):"R"===y?(O=Y({x:e,y:J},{x:w.x,y:J+l},X,l,o,"h"),Z=32):"LB"===y?(O=g(w,{x:e+X,y:J},X,l,o),Z=12):"B"===y?(O=Y({x:e,y:J},{x:e+X,y:w.y},X,l,o,"v"),Z=4):"RB"===y&&(O=g(w,{x:e,y:J},X,l,o),Z=36);var n=a.tf(O.x+O.width*d.x,O.y+O.height*d.y);b instanceof U.Block&&(h.hasOwnProperty("freezeFlag")||(h.freezeFlag=b._freezeSyncFromChildren,b._freezeSyncFromChildren=!0)),b.setPosition(n),b.setSize(O.width,O.height),Q&&(q=b.getRect(),E.rectGuide.gatherLines({node:b,x:q.x,y:q.y,w:q.width,h:q.height},m,Z)),A=""+Math.round(O.width)+" * "+Math.round(O.height)}else if("line"===N){if(te(C)){var v=b.getPoints(),u="P1"===y?v.get(1):v.get(0),R={x:I.x-u.x,y:I.y-u.y},B=E.getStyle("shiftLineRotateRound"),k=V._shiftDirList;if(!k||V._shiftRotateRound!==B){V._shiftRotateRound=B,V._shiftDirList=k=[];for(var x=0;x<Math.PI;x+=B)k.push({x:_(x),y:W(x)})}for(var r,s=0,H=0,c=k.length;c>H;H++){var $=k[H],K=$.x*R.x+$.y*R.y;Math.abs(K)>Math.abs(s)&&(s=K,r=$)}I={x:u.x+r.x*s,y:u.y+r.y*s},E.rectGuide.clear()}else V._inSmartGuide&&!U.Default.isCtrlDown(C)&&(V._adsorbedToClosest(I),Q=!0);var t=Cf.getDataMatrix(b).applyInverse(I);b.setPoint("P1"===y?0:1,t,!0);var S=b.getPoints(),j=S.get(0),f=S.get(1);e=j.x-f.x,J=j.y-f.y,A=" "+Math.round(Math.sqrt(e*e+J*J))+" ",Q&&(q=b.getRect(),E.rectGuide.gatherLines({node:b,x:q.x,y:q.y,w:q.width,h:q.height}))}if(A){var i=U.Default.getLogicalPoint(C,E._canvas);i.x+=Cf.Icons.TipShiftX,i.y+=Cf.Icons.TipShiftY,V.tipInfo={helperPos:i,text:A,size:A.length}}V._fireEditEvent("between",C)}},gp.prototype._unionPointMode1=function(T,V,u,K,l){if(l&&u&&K){var S=T.x-V.x,X=T.y-V.y;Math.abs(S*K)<Math.abs(X*u)?(X=Math.sign(X)*Math.abs(S*K/u),T.y=V.y+X):(S=Math.sign(S)*Math.abs(X*u/K),T.x=V.x+S)}return U.Default.unionPoint(T,V)},gp.prototype._unionPointMode2=function(W,w,v,D,Z,p){var m=U.Default.unionPoint(W,w);if(Z&&v&&D){var e;"v"===p?(e=m.x+m.width/2,m.width=v*m.height/D,m.x=e-m.width/2):(e=m.y+m.height/2,m.height=D*m.width/v,m.y=e-m.height/2)}return m},gp.prototype._adsorbedToClosest=function(Q,h){var e=this,U=e._interactor,v=U.rectGuide.findClosest(Q,h),H=U.gridGuide.findClosest(Q,h),m=1/0,t=1/0;v&&(isFinite(v.x)&&(m=v.x),isFinite(v.y)&&(t=v.y)),H&&(isFinite(H.x)&&Math.abs(H.x)<Math.abs(m)&&(m=H.x),isFinite(H.y)&&Math.abs(H.y)<Math.abs(t)&&(t=H.y)),isFinite(m)&&(Q.x+=m),isFinite(t)&&(Q.y+=t)},gp.prototype._42=function(L,v,G){var l=this;l.info={},l.screenInfo=null;var N=l._interactor;if(!N.editDetail&&l.gatherInfo(v,G)){var H=l.editing,D=H?H.groupRotateMode:null,g=l.screenInfo;if("block"!==D||!H||!H.started){if(g.P1?Cf.Icons.DrawIcon(N,L,Cf.Icons.Line,g):Cf.Icons.DrawIcon(N,L,Cf.Icons.Rect,g),g.connect&&(Cf.Icons.DrawIcon(N,L,Cf.Icons.ConnectGuide,{rotation:g.rotation,connect:g.connect,cursorPos:H?H.cursorPos:null}),H)){if(H.targetCorners){for(var C={x:1/0,y:1/0},k={x:-1/0,y:-1/0},$=0,p=H.targetCorners.length;p>$;$+=2)C.x=Math.min(C.x,H.targetCorners[$]),k.x=Math.max(k.x,H.targetCorners[$]),C.y=Math.min(C.y,H.targetCorners[$+1]),k.y=Math.max(k.y,H.targetCorners[$+1]);Cf.Icons.DrawIcon(N,L,Cf.Icons.HoverDataRect,{min:C,max:k,color:N.getStyle("hoverGuideColor")||N.getStyle("baseColor")})}H.garbageInfo&&Cf.Icons.DrawIcon(N,L,Cf.Icons.ConnectGuideGarbage,H.garbageInfo)}N.getStyle("rotateTipVisible")&&l.tipInfo&&Cf.Icons.DrawIcon(N,L,Cf.Icons.TipHelper,l.tipInfo)}l.target instanceof Cf.Group&&l.target._42(N,L,v)}};var Bp=Cf.Anchor=function(D){this.catalog="Anchor",this._interactor=D};Bp.prototype={},Bp.prototype.constructor=Bp,Bp.prototype.gatherInfo=function(r,z){var v=this;if(1===z.length){var t=z[0];if(!t.getAnchor)return;if(t instanceof U.Shape&&t._70I())return;if(ve(t,r))return;return v.gatherSingleTarget(r,z[0])}return z.length>1?v.gatherMultiTargets(r,z):!1},Bp.prototype.gatherSingleTarget=function(z,i){var x=this;return x.info.POS=i.getPosition(),x.screenInfo.POS=Cf.toScreenPosition(z,x.info.POS),x.target=i,!0},Bp.prototype.gatherMultiTargets=function(d,O){var x=this,X=Cf.Group.findOrCreateGroup(O,this._interactor._uuid);return X?(x.screenInfo.POS=Cf.toScreenPosition(d,X.getAnchor2()),x.target=X,!0):!1},Bp.prototype.isVisible=function(){var Q=this,B=Q._interactor;if(B.getStyle("anchorVisible")===!1)return!1;var u=Q.target;if(u){if(this.editing)return!0;var D=u.getAnchor(),G=B.getStyle("anchorOutsideVisibleThreshold");if(D.x<-G||D.x>1+G||D.y<-G||D.y>1+G)return!0;var $=u.getSize(),K=u.getScale(),Y=Math.min(Math.abs($.width*K.x),Math.abs($.height*K.y));if(Y*B.gv._zoom<B.getStyle("anchorHideThreshold"))return!1}return!0},Bp.prototype.check=function(I,i,N){if(U.Default.isLeftButton(i)){var Y=this,E=Y._interactor;if(Y.isVisible()&&E.getStyle("anchorMovable")!==!1){Y.editing=null,Y.tipInfo=null;var P=Y.target;if(P&&I.isAnchorEditable(P)&&I.isEditable(P)){var G;if(Y.screenInfo&&(G=Y.screenInfo.POS)&&Cf.checkHit(N,new Cf.Math.Vector2(G),E.getStyle("checkSize"))){if(P instanceof Cf.Group)return Y.editing={},!0;var Q=P.getWidth(),u=P.getHeight(),p=P.getAnchor();return Y.editing={rect:{x:-Q*p.x,y:-u*p.y,width:Q,height:u},anchor:p,matrix:P.getMatrix()},!0}}}}},Bp.prototype.startEdit=function(c,f){c.startDragging(f),c.fi({kind:"beginEditAnchor",event:f})},Bp.prototype._46O=function(o){var D=this;D.editing&&(D.editing=null,D._interactor.fi({kind:"endEditAnchor",event:o})),D.tipInfo=null},Bp.prototype.handleEdit=function(v,m){var R=this,W=R.target;if(W){var B=R.editing;if(B){var r=v.lp(m),h=R._interactor;if(W instanceof Cf.Group)return W.setAnchor2(r),h._42(),void 0;var j=B.matrix,b=j.tfi(r),D=B.rect,K=(b.x-D.x)/D.width,t=(b.y-D.y)/D.height;if(!U.Default.isCtrlDown(m)){var O=h.getStyle("anchorRound"),P=h.getStyle("anchorSensitivity");K=Cf.roundTo(K,O,P),t=Cf.roundTo(t,O,P)}W.setAnchor(K,t,!0);var p=U.Default.getLogicalPoint(m,h._canvas);p.x+=Cf.Icons.TipShiftX,p.y+=Cf.Icons.TipShiftY;var l=""+K.toFixed(2)+", "+t.toFixed(2);R.tipInfo={helperPos:p,text:l,size:l.length},h.fi({kind:"betweenEditAnchor",event:m})}}},Bp.prototype._42=function(o,J,i){var U=this;U.info={},U.screenInfo={};var w=U._interactor;w.editDetail||U.gatherInfo(J,i)&&U.isVisible()&&(Cf.Icons.DrawIcon(w,o,Cf.Icons.Anchor,U.screenInfo),U.tipInfo&&Cf.Icons.DrawIcon(w,o,Cf.Icons.TipHelper,U.tipInfo))};var $n=Cf.MoveDummy=function(s){this.catalog="MoveDummy",this._interactor=s};$n.prototype={},$n.prototype.constructor=$n,$n.prototype.gatherInfo=function(){var v=this,_=this._interactor.getSubModule("Rect");if(_){var q=_.screenInfo;if(q){var c=v._interactor,B=v.getMovableTarget(_.target);if(B){var d=c.getStyle("moveDummyThreshold");if(d!==!1){var A=q.LT||q.P1,l=q.RT||q.P2,y=q.LB||A;if(A){var J=q.P1,e=Math.min(A.distanceTo(y),A.distanceTo(l));if(!(d!==!0&&e>d)){var Y=c.getStyle("moveDummyPosition"),H=l.clone().sub(A),t=y.clone().sub(A),z=Y[2],h=Y[3];if(J){var Z=c.getStyle("moveDummyLineExtraShift");Z&&(z+=Z[0],h+=Z[1])}var i=A.clone().add(H.clone().multiplyScalar(Y[0])).add(H.setLength(z)).add(t.clone().multiplyScalar(Y[1])).add(t.setLength(h));return v.screenInfo.pos=i,v.screenInfo.size=c.getStyle("moveDummySensitivity"),!0}}}}}}},$n.prototype.getMovableTarget=function(f){var e=this._interactor.gv;if(Ob(f)){if(e.isMovable(f))return f}else if(f instanceof Cf.Group)for(var R=f._entities,z=R.length-1;z>=0;z--){var F=R[z];if(Ob(F)&&e.isMovable(F))return F}return null},$n.prototype.getMoveInteractor=function(){for(var m,l,T,r=this._interactor.gv,f=r.getInteractors(),m=0,l=f.length;l>m;m++)if(T=f.get(m),T instanceof Do)return T},$n.prototype.startEdit=function(w,T){w.startDragging(T);var v=this.getMoveInteractor();if(v){var e=this.selectedTarget,V=w.gv;V._moving=1,v._data=e,V.handleMouseDown&&V.handleMouseDown(T,e)}},$n.prototype._46O=function(I){var H=this,o=H.getMoveInteractor();o&&(o.handleWindowMouseUp(I),H.selectedTarget=null)},$n.prototype.handleEdit=function(C,m){var W=this.getMoveInteractor();W&&W.handleWindowMouseMove(m)},$n.prototype.check=function(G,f,p){if(this.selectedTarget=null,U.Default.isLeftButton(f)&&!G._scrolling&&!Wc()){var s=this;if(s.screenInfo){var w=s.screenInfo.pos;if(w&&!(p.distanceTo(w)>s.screenInfo.size)){var M=s._interactor;return s.selectedTarget=s.getMovableTarget(M.getSubModule("Rect").target),M.setCursor("default"),!0}}}},$n.prototype._42=function($,y,W){var R=this;R.screenInfo={};var c=R._interactor;c.editDetail||R.gatherInfo(y,W)&&(!c.editing||R.selectedTarget)&&Cf.Icons.DrawIcon(c,$,Cf.Icons.MoveDummy,R.screenInfo)};var Gh=Cf.RotateX=function(W){this.catalog="RotateX",this._interactor=W};Gh.prototype={},Gh.prototype.constructor=Gh,Gh.prototype.gatherInfo=function(P,m){var t=this;if(1===m.length){var J=m[0];return J instanceof U.Shape&&J._70I()||ve(J,P)?!1:t.gatherSingleTarget(P,J)}return m.length>1?t.gatherMultiTargets(P,m):!1},Gh.prototype.gatherSingleTarget=function(){var A=new U.Math.Vector2,$=new U.Math.Vector2,K=new U.Math.Vector2,d=new U.Math.Vector2,h=function(L,D){var e=L.x-D.x,V=L.y-D.y;return e*e+V*V};return function(H,k){if(k.getCorners){var L=this,I=k.getCorners(),v=15,B=k.getPosition();A.copy(I[0]),K.copy(I[1]),d.copy(I[3]),$.copy(A).add(d).divideScalar(2).add(A.sub(K).setLength(v/H.getZoom()));var V=Math.max(h(B,I[0]),h(B,I[1]),h(B,I[2]),h(B,I[3]));return L.info.POS=$.clone(),L.screenInfo.POS=Cf.toScreenPosition(H,L.info.POS),L.screenInfo.LEN=Math.sqrt(V)*H.getZoom()+v,L.screenInfo.CENTER=Cf.toScreenPosition(H,B),L.target=k,!0}}}(),Gh.prototype.gatherMultiTargets=function(M,c){var S=this,k=Cf.Group.findOrCreateGroup(c,this._interactor._uuid);if(!k)return!1;var S=this;return S.gatherSingleTarget(M,k)},Gh.prototype.isVisible=function(){var m=this._interactor;if(!m.getStyle("rotateAsClock"))return!1;var I=this.target;if(!I)return!0;var j=m.gv;return j.isEditable(I)&&j.isRotationEditable(I)?!0:!1},Gh.prototype.check=function(K,m,R){var r=this,P=r._checkImpl(K,m,R);return(P||r._clockPainted)&&r._interactor._42(),P},Gh.prototype._checkImpl=function(G,o,d){if(U.Default.isLeftButton(o)){var z=this;z.editing=null,z.tipInfo=null;var u;if(z.screenInfo&&(u=z.screenInfo.POS)&&z.isVisible()){var w=z._interactor;if(Cf.checkHit(d,u,w.getStyle("checkSize"))){var E=z.target,g=G.lp(o),r=E.getPosition(),n=Math.atan2(g.y-r.y,g.x-r.x);return w._setRotateCursor(n),z.editing={pos:r,rotation:E.getRotation(),hitRot:n,groupRotateMode:"block",screenInfo:{CENTER:z.screenInfo.CENTER,LEN:z.screenInfo.LEN}},!0}}}},Gh.prototype.startEdit=function(o,x){o.startDragging(x),o.fi({kind:"beginEditRotation",event:x}),this.target instanceof Cf.Group&&this.target.beginRotate(this.editing)},Gh.prototype._46O=function(n){var G=this;G.editing&&(G.editing=null,G._interactor.fi({kind:"endEditRotation",event:n})),G.target instanceof Cf.Group&&G.target.endRotate(),G.tipInfo=null},Gh.prototype.handleEdit=function(z,D){var G=this,C=G.editing;if(C){var O,I,v=G.target,n=z.lp(D),N=G._interactor,Z=C.pos,k=Math.atan2(n.y-Z.y,n.x-Z.x),F=v instanceof Cf.Group;if(F?I=k-C.hitRot:(O=k-C.hitRot,I=C.rotation+O),I%=2*Math.PI,0>I&&(I+=2*Math.PI),!U.Default.isCtrlDown(D)){var l,h;te(D)?(l=N.getStyle("shiftRotateRound"),h=l/2):(l=N.getStyle("rotateRound"),h=N.getStyle("rotateSensitivity")),I=Cf.roundTo(I,l,h)}F?(O=I-(C.lastRotation||0),0!==O&&(v.addRotation(O,C.groupRotateMode,function(S){return z.isRotationEditable(S)}),C.lastRotation=I)):v.setRotation(I),N._setRotateCursor(k),I>Math.PI&&(I-=2*Math.PI);var y=180*(I/Math.PI),Y=""+y.toFixed(2)+"°",J=U.Default.getLogicalPoint(D,N._canvas);J.x+=Cf.Icons.TipShiftX,J.y+=Cf.Icons.TipShiftY,G.tipInfo={helperPos:J,text:Y,size:Y.length},N.fi({kind:"betweenEditRotation",event:D})}},Gh.prototype._42=function(X,y,G){var s=this;s._clockPainted=!1,s.info={},s.screenInfo={};var b=s._interactor;b.editDetail||s.gatherInfo(y,G)&&s.isVisible()&&(Cf.Icons.DrawIcon(b,X,Cf.Icons.RoundPoint,s.screenInfo.POS),b.getStyle("rotateTipVisible")&&s.tipInfo&&Cf.Icons.DrawIcon(b,X,Cf.Icons.TipHelper,s.tipInfo),s.editing&&s.drawClock(X))},Gh.prototype.drawClock=function(G){G.save();var a=this;a._clockPainted=!0;var F=a.editing||{},b=F.screenInfo||a.screenInfo,s=b.LEN,U=s+8,O=s+18;G.save(),G.translate(b.CENTER.x,b.CENTER.y),G.beginPath(),G.strokeStyle="rgb(150, 150, 150)";for(var A,r,z,P,w,v=0;360>v;v++)A=v*Math.PI/180,0===v%5&&(r=W(A)*s,z=_(A)*s,P=W(A)*U,w=_(A)*U,G.moveTo(r,z),G.lineTo(P,w)),0===v%45&&(r=W(A)*s,z=_(A)*s,P=W(A)*O,w=_(A)*O,G.moveTo(r,z),G.lineTo(P,w));G.stroke(),G.rotate(-zp);var C=F.lastRotation||a.target.getRotation();G.beginPath(),G.fillStyle="rgba(255, 0, 0, 0.1)",G.strokeStyle="rgb(157, 157, 157)",G.moveTo(0,0),G.arc(0,0,O,0,C,!1),G.fill(),G.beginPath(),G.moveTo(0+O,0),G.arc(0,0,O,0,C,!1),G.stroke(),G.restore()};var Fc=Cf.Curve=function(j){this.catalog="Curve",this._interactor=j};Fc.prototype={},Fc.prototype.constructor=Fc,z.defineProperties(Fc.prototype,{activing:{get:function(){return this._activing},set:function(n){var r=this;if(n)r._activing=new Cf.CurveActiving(this,n),r._activing._firePointChange();else{var t=r._activing;t&&t.dispose(),r._activing=null}}}}),Fc.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Fc.prototype.setUp=function(){var I=this,b=I._interactor;b&&b.gv.mp(I._onGraphviewPropertyChanged,I)},Fc.prototype._onGraphviewPropertyChanged=function(f){("zoom"===f.property||"translateX"===f.property||"translateY"===f.property)&&this._handleDataChanged()},Fc.prototype.tearDown=function(){var o=this,B=o._interactor;B&&B.gv.ump(o._onGraphviewPropertyChanged,o)},Fc.prototype.canEnterEditDetailMode=function(){var P=Gj(this._interactor);return P?this.target=P:void 0},Fc.prototype.canQuitEditDetailMode=function(g){var U=this,h=U._interactor._getLogicalPoint(g);return U._checkEditRealPoint(h)?void 0:U._interactor.gv.getDataAt(g)!==U.target?!0:void 0},Fc.prototype.preHandleScroll=function(){var o=this.editing;return o&&o.inEdit?!0:void 0},Fc.prototype.getCurrentSelectintStatus=function(){var N=this;if(N.activing&&!N.activing.selections){if(N.activing.status!=s)return N.activing.status;var V=function(H){var t=N.activing.status;N.activing.status=H,N._interactor.fp("shapePointStatus",t,H)},H=Cf.Curve.PointType,y=N.activing.point,w=N.activing.pairs;if(!w||1!==w.length)return V(H.Mirrored);var m=w[0],K=m.c1&&m.c1.isNearEnough(y),Y=m.c2&&m.c2.isNearEnough(y);if(!m.c1||!m.c2)return K||Y?V(H.Straight):V(H.Disconnected);if(K&&Y)return V(H.Straight);if(K||Y)return V(H.Asymmetric);var d=m.c1.clone().sub(y),g=m.c2.clone().sub(y);return Math.abs(d.x*g.y-d.y*g.x)>1e-5||d.x*g.x>0?V(H.Disconnected):Math.abs(d.length()-g.length())>1e-5?V(H.Asymmetric):V(H.Mirrored)}},Fc.prototype.handle_keydown=function(S){var L=this;if(L._interactor.editDetail){var w=Cf.Curve.PointType;"1"===S.key?L._setCurrentSelectionStatus(w.Straight):"2"===S.key?L._setCurrentSelectionStatus(w.Mirrored):"3"===S.key?L._setCurrentSelectionStatus(w.Disconnected):"4"===S.key&&L._setCurrentSelectionStatus(w.Asymmetric)}},Fc.prototype.setCurrentSelectionStatus=function(S){var P=this,H=P._interactor;if(H){var e=H.gv;e.dm().beginTransaction(),this._setCurrentSelectionStatus(S),e.dm().endTransaction()}},Fc.prototype._setCurrentSelectionStatus=function(n){var A=this,h=A.activing;if(h){var $=A.getCurrentSelectintStatus();if(null!==$&&$!==n){h.status=n;var f=A.activing.point,k=A.activing.pairs;if(k&&1===k.length){var N=k[0],X=A.screenInfo.curve,x=Cf.Curve.PointType,Z=A._interactor,v=function(){A._writeToHt(),Z.fp("shapePointStatus",$,n),A.check(Z.gv,null,new Cf.Math.Vector2(Z._lastLogicalPoint))};if(n===x.Straight)return X.moveCtrlPoint(N,f,"c1"),X.moveCtrlPoint(N,f,"c2"),v(),void 0;if($===x.Straight){var l=X.findPairs(f,!0),R=l[0],E=R.r1||f,O=R.r2||f,e=O.clone().sub(E).multiplyScalar(.25);return X.moveCtrlPoint(N,f.clone().sub(e),"c1"),X.moveCtrlPoint(N,f.clone().add(e),"c2"),v(),void 0}var y=N.c1,i=N.c2;if(y&&i){if(n===x.Mirrored)return X.moveCtrlPoint(N,f.clone().multiplyScalar(2).sub(i),"c1"),v(),void 0;if(n===x.Asymmetric&&$===x.Disconnected){var J=y.clone().sub(f).length(),e=f.clone().sub(i).setLength(J).add(f);
return X.moveCtrlPoint(N,e,"c1"),v(),void 0}}h._firePointChange(),Z.fp("shapePointStatus",$,n),A.check(Z.gv,null,new Cf.Math.Vector2(Z._lastLogicalPoint))}}}},Fc.prototype._handleDataChanged=function(){var Q="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(i){var G=this;if(G.screenInfo&&G.target){if(i&&Q.indexOf(i.property)<0)return;var $=G._interactor;G.gatherSingleTarget($.gv,G.target,!0),G.check($.gv,null,new Cf.Math.Vector2($._lastLogicalPoint)),$._42()}}}(),Fc.prototype.gatherSingleTarget=function(j,W,R){var I,u,c=this;c.screenInfo&&c.screenInfo.curve&&(u=c.screenInfo.curve._curves);var A=c.editing;I=A?c.screenInfo:c.screenInfo={};var i,f,o=W instanceof U.Edge;o?(i=W.s("edge.segments"),f=W.s("edge.points")||new U.List):(i=W._58O,f=W._59O),I.S=i;var E,k=I.P=[],z=Cf.getDataMatrix(W);if(W instanceof U.Polyline||W instanceof U.Edge&&c._interactor.getStyle("edgeElevationEditable"))E=W.getElevation&&W.getElevation()||0,I.E=[];else{var y=!1;f.each(function(g){g.e!==s&&(y=!0)}),y&&(I.E=[])}if(f.each(function(c){I.E&&I.E.push(c.e!=s?c.e:E),c=z.apply(c);var C=Cf.toScreenPosition(j,c);k.push(C.x,C.y)}),o){var l=k.length,w=Cf.toScreenPosition(j,W._lastSourcePoint||(l?{x:k[0],y:k[1]}:{x:0,y:0})),Q=Cf.toScreenPosition(j,W._lastTargetPoint||(l?{x:k[l-2],y:k[l-1]}:{x:0,y:0}));if(k.splice(0,0,w.x,w.y),k.push(Q.x,Q.y),I.E){var n=W.getSourceAgent();n instanceof U.Edge?I.E.splice(0,0,W.s("edge.source.offset.elevation")):I.E.splice(0,0,((W.s("edge.source.anchor.elevation")||.5)-.5)*n.getTall()*n.getScaleTall()+n.getElevation()+W.s("edge.source.offset.elevation"));var H=W.getTargetAgent();H instanceof U.Edge?I.E.push(W.s("edge.target.offset.elevation")):I.E.push(((W.s("edge.target.anchor.elevation")||.5)-.5)*H.getTall()*H.getScaleTall()+H.getElevation()+W.s("edge.target.offset.elevation"))}}if(!I.S||!I.S.size()){I.S=new U.List,I.S.add(1);for(var v=0;v<k.length/2-1;v++)I.S.add(2)}if((!A||R)&&c.convertToCubicBezier(u),c.activing&&(R||!c.editing||"realPoint"===c.editing.type)){var F=I.curve.findPairs(c.activing.point);c.activing.pairs=F}},Fc.prototype._convertToNewPoint=function(L,A,i,V){var _,M,J;for(_=0,M=A.length;M>_;_++){if(J=A[_],J._p1.isNearEnough(L)&&(!V||V.indexOf(J._p1)<0))return J._p1;if(J._p4.isNearEnough(L)&&(!V||V.indexOf(J._p4)<0))return J._p4}if(i)for(_=0,M=Math.min(i.length,M);M>_;_++){if(J=i[_],J._p1===L&&(!V||V.indexOf(A[_]._p1)<0))return A[_]._p1;if(J._p4===L&&(!V||V.indexOf(A[_]._p4)<0))return A[_]._p4}},Fc.prototype.convertToCubicBezier=function(i){var L,W,O=this,n=new Cf.Math.Curve,Y=O.screenInfo;if(n.createFromHtShape(Y.P,Y.S,Y.E),Y.curve=n,O.activing){var B=n._curves;L=O.activing.point,W=O._convertToNewPoint(L,B,i);var k=[];if(W&&(O.activing.point=W,k.push(W)),O.activing.selections){var S=-1,o=O.activing.selections;o.forEach(function(p){S++,W=O._convertToNewPoint(p,B,i,k),W&&(o[S]=W,k.push(W))})}}},Fc.prototype.check=function(p,X,L){if(!X||ys(X)||Wl(X)){var b=this;if(b._interactor.setCursor("default"),b.editing=null,b.highlight=null,b.tipInfo=null,b.edgeEditResult=null,b.screenInfo){if(Wc()||X&&Wl(X))return b._interactor._42(),!0;if(b._checkEditCtrlPoint(L))return b._interactor._42(),!0;if(b._checkEditRealPoint(L))return b._interactor._42(),!0;if(b._checkEditElevation(L))return b._interactor._42(),!0;var w=b.screenInfo.curve,J=w.checkPoint(L,b._interactor.getStyle("curveIntersectSize"));if(J){var P=b.highlight={};P.type="insertKnot",P.bezier=J.bezier,P.point=J.intersection}return b._interactor._42(),!0}}},Fc.prototype.getAdjacentBeziers=function(B){var m=this.screenInfo;if(m){var r,p,g,b=m.curve._curves,N=[],j=s;for(r=0,p=b.length;p>r;r++)if(g=b[r],j===s){if(g._p4.isNearEnough(B)){N.push(g),j=r;continue}}else{if(g._p1.isNearEnough(B))return N.push(g),N;if(g._p4.isNearEnough(B)){N[0]=g,j=r;continue}}}},Fc.prototype.roundCorner=function(U){if(this.activing&&this.screenInfo){var L=this.screenInfo.curve,D=L._curves,t=this.getAdjacentBeziers(this.activing.point),B=t[1],T=B._index;B=B.insertKnot(B.getTByPercentage(U/B.length))[1],D[T]=B;var u=B.p1,g=t[0],n=g._index;g=g.insertKnot(g.getTByPercentage(1-U/g.length))[0],D[n]=g;var b=g.p4,X=this.activing.point,Z=new Cf.Math.CubicBezier(b,X.clone().sub(b).multiplyScalar(2/3).add(b),X.clone().sub(u).multiplyScalar(2/3).add(u),u);D.splice(T,0,Z),this._writeToHt(),this.activing=null,this._interactor._42()}},Fc.prototype._checkEditRealPoint=function(B){var h,M,o,f,c,x,w=this,n=w.screenInfo.curve._curves,O=w._interactor.getStyle("curvePointIntersectSize"),A=1/0;for(O*=O,o=0,f=n.length;f>o;o++)h=n[o],c=h._p1,x=B.distanceToSquared(c),A>x&&(A=x,M=c),c=h._p4,x=B.distanceToSquared(c),A>x&&(A=x,M=c);if(A>O)return!1;var H=w.highlight={};return H.type="changeRealPoint",H.point=M,w.editing={type:"realPoint",point:M,shiftGuide:{point:M.clone(),dir:"x",limit:0}},w._interactor.setCursor("crosshair"),!0},Fc.prototype._checkEditElevation=function(l){var O=this;if(!O._interactor.getStyle("curveElevationVisible"))return!1;var L=O.target;if(L instanceof U.Edge&&!O._interactor.getStyle("edgeElevationEditable"))return!1;var w=O.activing;if(!w)return!1;var G=w.getCurrentEditingPoint();if(!G)return!1;var S=O._interactor,g=S.getStyle("curveElevationGuideShift"),o=S.getStyle("curveElevationIntersectSize"),N=l.distanceToSquared({x:G.x+g[0],y:G.y+g[1]});if(!(N>o*o)){var e=O.highlight={};e.type="elevation";var D=new Cf.Math.Vector2(l.x,l.y,G.e);return O.editing={type:"elevation",startPoint:D},O._interactor.setCursor("crosshair"),!0}},Fc.prototype._checkEditCtrlPoint=function(P){var v=this;if(v.activing&&!v.activing.selections){var d=v.getCurrentSelectintStatus();if(d!==Cf.Curve.PointType.Straight){var Z=v.activing.pairs;if(Z){var f=v._interactor.getStyle("curvePointIntersectSize");f*=f;var o,u,F,L,j,b,z,m,O,B=1/0;for(z=0,O=Z.length;O>z;z++)for(L=Z[z],m=0;2>m;m++)j=0===m?"c1":"c2",L[j]&&(b=P.distanceToSquared(L[j]),B>b&&(B=b,o=L,u=z,F=j));if(B>f)return!1;v.activing.hlpair=o,v.activing.hltype=F;var A=v.highlight={};return A.type="changeCtrlPoint",A.point=o[F],v.editing={type:"ctrlPoint",pair:o,pairId:u,ctrlType:F,direction:o[F].clone().sub(v.activing.point).normalize()},v._interactor.setCursor("crosshair"),!0}}}},Fc.prototype.startEdit=function(M,J){M.startDragging(J);var k=this;k.highlight&&"insertKnot"===k.highlight.type&&(k.insertKnot(),k.gatherSingleTarget(k._interactor.gv,k.target),k.activing=null,k._checkEditRealPoint(k._interactor._getLogicalPoint(J)));var t=k._activing;if(t){var r=k.editing?k.editing.type:null;"ctrlPoint"===r?t.editingCtrl={pairId:k.editing.pairId,type:t.hltype}:"realPoint"===r&&(t.editingCtrl=!1)}var d=k.highlight,m=U.Default.isCtrlDown(J);if(!d||Wc()||Wl(J)){var H=k._interactor.gv;if(!H.setFocus(J)||H._scrolling)return;return m?k._multiSelect={startPoint:H.lp(J)}:H.isPannable()&&(ys(J)||Wl(J))&&(k._pan={tx:H.tx(),ty:H.ty()},M.fi({kind:"beginPan",event:J})),void 0}if("changeRealPoint"===d.type){var l,I=k.activing?k.activing.point:null,X=k.activing?k.activing.selections:null;if(m&&k.activing)I===d.point?(X?(k.activing={point:X[0]},X.length>1&&(X.splice(0,1),k.activing.selections=X)):k.activing=null,k.editing=null):X&&(l=X.indexOf(d.point))>=0?(X.length>1?X.splice(l,1):delete k.activing.selections,k.editing=null):X?(X.push(I),k.activing={point:d.point,selections:X}):k.activing={point:d.point,selections:[I]};else if(X)I===d.point||((l=X.indexOf(d.point))>=0?(X.splice(l,1,I),k.activing={point:d.point,selections:X}):k.activing={point:d.point});else{var e;I===d.point&&(e=k.activing.status),k.activing={point:d.point},e&&(k.activing.status=e)}M.fi({kind:"beginEditPoint",event:J})}},Fc.prototype.insertKnot=function(){var r=this,x=r.highlight,U=r.screenInfo.curve;U.insertKnot(x.bezier,x.point.t),r._writeToHt()},Fc.prototype._writeToHt=function(){var e,d,$=this,V=$.screenInfo.curve,j=V.toHtShape(),D=j.points,b=[],r=j.segments,O=$._interactor.gv;O.dm().beginTransaction();var W,Q,Y=$.target,n=Y instanceof U.Edge,w=Cf.getDataMatrix(Y).invert();Q=Y instanceof U.Polyline||n&&$._interactor.getStyle("edgeElevationEditable"),Q&&(W=Y.getElevation&&Y.getElevation()||0);for(var T=0,X=D.length;X>T;T++)e=D[T],d=Cf.toWorldPosition(O,e),d=w.apply(d),isFinite(e.e)&&e.e!==W&&(d.e=e.e),b.push(d);if(Y._writing=!0,n){Y.s("edge.type","points"),Y.setStyle("edge.segments",r),Y.setStyle("edge.points",b.slice(1,b.length-1)),Y.setStyle("edge.source.offset.x",0),Y.setStyle("edge.source.offset.y",0),Y.setStyle("edge.target.offset.x",0),Y.setStyle("edge.target.offset.y",0);var c=$._nextChangeEdgeHost;delete $._nextChangeEdgeHost,c&&("source"===c.type?Y.setSource(c.host):Y.setTarget(c.host)),$._writeEdgeHostAnchor("source",b[0]),$._writeEdgeHostAnchor("target",b[b.length-1])}else b.length?(Y.setSegments(r),Y.setPoints(b,!0)):Y.removeFromDataModel();O.dm().endTransaction(),delete Y._writing},Fc.prototype._writeEdgeHostAnchor=function(R,h){var g=this,r=g.target,b=g._calcHostAnchor(r,R,h);b.index!==s?(r.setStyle("edge."+R+".index",b.index),r.setStyle("edge."+R+".percent",s),r.setStyle("edge."+R+".anchor.x",s),r.setStyle("edge."+R+".anchor.y",s),r.setStyle("edge."+R+".anchor.elevation",s),r.setStyle("edge."+R+".offset.elevation",h.e)):b.percent!==s?(r.setStyle("edge."+R+".percent",b.percent),r.setStyle("edge."+R+".index",s),r.setStyle("edge."+R+".anchor.x",s),r.setStyle("edge."+R+".anchor.y",s),r.setStyle("edge."+R+".anchor.elevation",s),r.setStyle("edge."+R+".offset.elevation",h.e)):(r.s("edge."+R+".anchor.x",b.x),r.s("edge."+R+".anchor.y",b.y),r.s("edge."+R+".anchor.elevation",b.e),b.offsetX||b.offsetY||b.offsetElevation?(r.s("edge."+R+".offset.x",b.offsetX),r.s("edge."+R+".offset.y",b.offsetY),r.s("edge."+R+".offset.elevation",b.offsetElevation)):(r.s("edge."+R+".offset.x",0),r.s("edge."+R+".offset.y",0),r.s("edge."+R+".offset.elevation",0)))},Fc.prototype._calcHostAnchor=function(x,G,d,A){A||(A="source"===G?x.getSource():x.getTarget());var I=this._interactor.gv,R=I.calculateAttachPoint(A,d);if(R)return R.info;if(hg(A)){var O=I.calculateEdgePosition(A,d);return O}var m=A.getRotation(),_=A.getAnchor();ve(A,I)&&(m=0);var c=A.getElevation(),e=A.getTall()*A.getScaleTall();c=((d.e||0)-x.s("edge."+G+".offset.elevation")-c)/e+.5;var X=A.getScale();if(m||X.x<0||X.y<0){var j=A.getMatrix(),T=j.tfi(d),i=A.getSize();return{x:T.x/i.width+_.x,y:T.y/i.height+_.y,e:c}}var r=Ec(I,A),t={x:(d.x-r.x)/r.width,y:(d.y-r.y)/r.height,e:c};return t},Fc.prototype._handlePanning=function(B){var I=this,N=I._pan;if(N){N.started=!0;var u=I._interactor,W=u.gv,k=u._lastClientPoint,Y=vq(B),h=Qf(W,Y,k);W.setTranslate(N.tx+h.x,N.ty+h.y),I.gatherSingleTarget(u.gv,I.target),u._42(),u.fi({kind:"betweenPan",event:B})}},Fc.prototype.handleEdit=function(H,K){var e=this,b=e.editing;if(e._pan)return e._handlePanning(K),void 0;if(e._multiSelect)return e._multiSelect.endPoint=H.lp(K),e._interactor.redraw(),void 0;if(b){b.inEdit=!0;var E,r,V,n=e._interactor._getLogicalPoint(K),h=U.Default.isCtrlDown(K),q=U.Default.isShiftDown(K),X=b.type,W=e.activing;if(e._guideInfo=null,"ctrlPoint"===X&&q){var P=e.editing.direction.clone();E=W.point;var A=P.dot(n.clone().sub(E));n=P.setLength(A).add(E)}else if("ctrlPoint"===X||"realPoint"===X){var P;if("realPoint"===X&&q){var C=e.editing.shiftGuide;r=C.point;var a=Math.abs(n.x-r.x),d=Math.abs(n.y-r.y);a>d&&a>C.limit&&"y"===C.dir&&(C.dir="x"),d>a&&d>C.limit&&"x"===C.dir&&(C.dir="y"),P=C.dir,"x"===P?(n.y=r.y,C.limit=Math.max(C.limit,a)):"y"===P&&(n.x=r.x,C.limit=Math.max(C.limit,d))}if(!h){var F,t=e._isEditEdgeSourceTarget();t&&(F=n.clone());var k=e._guidingToEdit(n,P),y="realPoint"===X?e._interactor.gridGuide.findClosest(n,P,!0):null,$=1/0,Q=1/0;y&&(y.x&&($=y.x),y.y&&(Q=y.y));var O=!1;if(k&&(k.xList&&(Math.abs(k.x)<=Math.abs($)?(O=!0,$=k.x):delete k.xList),k.yList&&(Math.abs(k.y)<=Math.abs(Q)?(O=!0,Q=k.y):delete k.yList),O&&(e._guideInfo=k)),isFinite($)&&(n.x+=$),isFinite(Q)&&(n.y+=Q),O&&(k.v=n),t){var I=O?n.clone():null;n.copy(F);var N=e._editEdgeSourceTarget(t,n,h,I);N&&(e.edgeEditResult=N,V=N.tipText,N.isFixed&&(e._guideInfo=null))}}}var T=e.screenInfo.curve;if("realPoint"===b.type){E=b.point,E.e!==s&&(n.e=E.e),T.moveRealPoint(E,n),b.point=n,e.highlight.point=n;var i=W.status,w=W.selections;if(e.activing={point:n,status:i},w){var g=n.clone().sub(E),f=0;w.forEach(function(e){var I=e.clone().add(g);T.moveRealPoint(e,I),w[f++]=I}),e.activing.selections=w}}else if("ctrlPoint"===b.type){var c=W.pairs,R=c[b.pairId];T.moveCtrlPoint(R,n,b.ctrlType);var o=W.status,B=Cf.Curve.PointType;if((o===B.Mirrored||o===B.Asymmetric)&&R.c1&&R.c2){var E=new Cf.Math.Vector2(W.point),G="c1"===b.ctrlType?"c2":"c1";if(o===Cf.Curve.PointType.Mirrored)T.moveCtrlPoint(R,E.clone().multiplyScalar(2).sub(n),G);else if(o===B.Asymmetric){var A=R[G].clone().sub(E).length(),J=E.clone().sub(R[b.ctrlType]).setLength(A).add(E);isNaN(J.x)||T.moveCtrlPoint(R,J,G)}}W._firePointChange()}else if("elevation"===b.type){r=b.startPoint;var D=r.e+(r.y-n.y)/H._zoom;e._setCurrentPointImpl("e",D),W._firePointChange(),V="E: "+Cf.toFixed(D)}var p=U.Default.getLogicalPoint(K,e._interactor._canvas);if(p.x+=Cf.Icons.TipShiftX,p.y+=Cf.Icons.TipShiftY,!V){var Y=Cf.toWorldPosition(H,n);V=""+Cf.toFixed(Y.x)+", "+Cf.toFixed(Y.y)}e.tipInfo={helperPos:p,text:V,size:V.length},e._writeToHt(),e._interactor.fi({kind:"betweenEditPoint",event:K})}},Fc.prototype._setCurrentPointImpl=function(t,Q){var l=this,q=l._activing;if(!q)return!1;var h=l.target;if(!h)return!1;var X=q.getCurrentEditingPoint();if(!X)return!1;var a=q.editingCtrl;if(!a)var K=X.clone();if("e"===t)X.e=Q;else{var O;if("x"===t||"y"===t){var e=q._lastFirePoint;O="x"===t?{x:Q,y:e?e.y:0}:{x:e?e.x:0,y:Q}}else"object"==typeof t?(O=t,t.e!==s&&(X.e=t.e)):(O={x:arguments[0],y:arguments[1]},arguments[2]!==s&&(X.e=arguments[2]));var g=Cf.getDataMatrix(h);O=Cf.toScreenPosition(l._interactor.gv,g.apply(O)),X.x=O.x,X.y=O.y}if(!a){var B=K.multiplyScalar(-1).add(X);Jr(X.e)&&Jr(K.e)&&(B.e=X.e-K.e);var R=l.screenInfo.curve;R.moveCtrlDueToRealPointMovement(X,B);var H=q.selections;if(H){var G=0;H.forEach(function(d){var O=d.clone().add(B);isFinite(B.e)&&(O.e=(isFinite(d.e)?d.e:h.getElevation()||0)+B.e),R.moveRealPoint(d,O),H[G++]=O}),q.selections=H}}return!0},Fc.prototype.setCurrentPoint=function(R,d){return this._setCurrentPointImpl(R,d)?(this._writeToHt(),!0):!1},Fc.prototype._isEditEdgeSourceTarget=function(){var Z=this,S=Z.target;if(!(S instanceof U.Edge))return!1;var $=Z.editing.point,y=Z.screenInfo.curve._curves;return $===y[0]._p1?"source":$===y[y.length-1]._p4?"target":!1},Fc.prototype._editEdgeSourceTarget=function(c,G,W,S){var Z,V=this,I=V.target;if(Z="source"===c?I.getSource():I.getTarget()){var d,y=V._interactor.gv,r=Cf.toWorldPosition(y,G),n=V._calcHostAnchor(I,c,r,Z);if(d=n.index!==s||n.percent!==s?n.distance*y.getZoom()>V._interactor.getStyle("edgeHostEdgeMaxDistance"):V._interactor.getStyle("edgeHostDetectPerFrame")?!0:n.x<0||n.x>1||n.y<0||n.y>1?!0:!1){var L=y.getDataAt(r,function(j){return y.isSelectable(j)?y.isSourceTargetEditable(I,j,c)?I.canSetSourceTarget(j,c)?!0:!1:!1:!1});if(L){var J=V._calcHostAnchor(I,c,r,L);Z=L,V._nextChangeEdgeHost={type:c,host:L},n=J}}var b,U,h,v=!1;if(W||n.x===s)(n.percent!==s||n.index!==s)&&(v=!0,U=n.point);else{var m=V._interactor.getStyle("anchorRound"),x=V._interactor.getStyle("anchorSensitivity");b=y.calculateAttachPoint(Z,r),b?(n=b.info,v=!0):(S&&(n=V._calcHostAnchor(I,c,Cf.toWorldPosition(y,S),Z)),n.x=Cf.roundTo(n.x,m,x),n.y=Cf.roundTo(n.y,m,x)),U=zb(y,Z,0,n.offsetX||0,n.offsetY||0,n.x,n.y)}U&&(h=Cf.toScreenPosition(y,U),G.x=h.x,G.y=h.y),V._edgeHostGuideInfo={corners:Cf.getTargetCornersOnScreen(y,Z),attach:b?b.index:-1,host:Z};var R;return n.percent!==s?R="percent: "+n.percent.toFixed(2):n.index!==s?R="index: "+n.index:(R=""+n.x.toFixed(2)+", "+n.y.toFixed(2),(n.offsetX||n.offsetY)&&(R+=" offset: "+n.offsetX.toFixed(2)+", "+n.offsetY.toFixed(2))),{host:Z,anchor:n,tipText:R,isFixed:v}}},Fc.prototype._guidingToEdit=function(e,u){var c,j,$=this;if(c=$.screenInfo.curve){j=c._curves;var Q,_,d,D,Y,l,M,v,S=1/0,F=1/0,N=[];for($.editing&&"realPoint"===$.editing.type&&(v=$.editing.point),Y=0,l=2*j.length;l>Y;Y++)M=j[Math.floor(Y/2)][Y%2?"_p4":"_p1"],N.indexOf(M)>=0||(N.push(M),v&&v===M||(d=M.x-e.x,D=M.y-e.y,Math.abs(d)<Math.abs(S)?(S=d,Q=[M]):d===S&&Q.push(M),Math.abs(D)<Math.abs(F)?(F=D,_=[M]):D===F&&_.push(M)));var w=$._interactor.getStyle("smartGuideThreshold");if((Math.abs(S)>w||"y"===u)&&(Q=null),(Math.abs(F)>w||"x"===u)&&(_=null),Q||_){var r=!1,Z={};if(Q&&(r=!0,Z.xList=Q,Z.x=S),_&&(r=!0,Z.yList=_,Z.y=F),r)return Z}}},Fc.prototype._46O=function(h){var S=this;S.editing&&(S.editing=null,S._interactor.fi({kind:"endEditPoint",event:h})),S._guideInfo=null,S._edgeHostGuideInfo=null,S._pan&&(S._pan=null,S._interactor.fi({kind:"endPan",event:h})),S._multiSelect&&(S._handleMultiSelect(S._multiSelect,h),S._multiSelect=null),S.tipInfo=null,S.edgeEditResult=null},Fc.prototype._handleMultiSelect=function(w,f){if(w.startPoint&&w.endPoint){var N,I,g,G,x,r,z=this,u=z._interactor,i=u.gv,O=Cf.toScreenPosition(i,w.startPoint),q=Cf.toScreenPosition(i,w.endPoint),o=U.Default.unionPoint(O,q),L=z.screenInfo.curve._curves,E=[],$=function(H){H.x>=o.x&&H.y>=o.y&&H.x<=o.x+o.width&&H.y<=o.y+o.height&&E.indexOf(H)<0&&E.push(H)};for(N=0,I=L.length;I>N;N++)x=L[N],$(x._p1),$(x._p4);if(E.length){var l=z.activing||{},B=l.selections||[];l.point&&B.push(l.point);var S=U.Default.isShiftDown(f),k=f.altKey;if(k&&!S)for(r=E,E=[],N=0,I=r.length;I>N;N++)g=r[N],G=B.indexOf(g),G>=0&&E.push(g);for(N=0,I=B.length;I>N;N++)g=B[N],G=E.indexOf(g),G>=0?(!S||S&&k)&&(E[G]=s):E.push(g);for(r=E,E=[],N=0,I=r.length;I>N;N++)r[N]&&E.push(r[N]);I=E.length,0===I?z.activing=null:1===I?z.activing={point:E[0]}:(g=E[I-1],z.activing={point:g,selections:E.splice(0,I-1)}),u.redraw()}}},Fc.prototype._canDeletePoint=function(H,a){var e=this.target;if(!(e instanceof U.Edge))return!0;var $=H._curves[0],t=H._curves[H._curves.length-1];return $._p1===a||t._p4===a?!1:!0},Fc.prototype.handleDelete=function(){var S=this;if(S.activing&&S.screenInfo){var M=U.Default.isShiftDown(),z=S.screenInfo.curve;S._canDeletePoint(z,S.activing.point)&&z.deleteRealPoint(S.activing.point,M),S.activing.selections&&S.activing.selections.forEach(function(v){S._canDeletePoint(z,v)&&z.deleteRealPoint(v,M)}),S.activing=null,delete S.editing,delete S.tipInfo,delete S.edgeEditResult,delete S._pan,delete S._multiSelect,S._writeToHt(),S._interactor.fp("deleteShapePoint",!1,!0)}},Fc.prototype.handleDoubleClick=function(B){var J=this,c=J._interactor._getLogicalPoint(B);if(J.screenInfo&&J._checkEditRealPoint(c)){var v=J.getCurrentSelectintStatus(),V=Cf.Curve.PointType;return v=v===V.Mirrored?V.Straight:V.Mirrored,J._setCurrentSelectionStatus(v),J._interactor._42(),!0}},Fc.prototype._drawHighlight=function($){var i=this,j=i.highlight;if(j){var y=j.bezier,d=i._interactor;y&&Cf.Icons.DrawIcon(d,$,Cf.Icons.ShapeHighlightCurve,[y._p1.x,y._p1.y,y._p2.x,y._p2.y,y._p3.x,y._p3.y,y._p4.x,y._p4.y]);var D=j.point;D&&"insertKnot"===j.type&&Cf.Icons.DrawIcon(d,$,Cf.Icons.ShapeHighlighPoint,D)}},Fc.prototype._drawGuide=function(p){var s=this,W=s._guideInfo;if(W){var M,C,c,m,B=W.v;for(M=0;2>M;M++)if(m=0===M?W.xList:W.yList)for(C=0,c=m.length;c>C;C++)Cf.Icons.DrawIcon(s._interactor,p,Cf.Icons.ShapeGuideLine,[B.x,B.y,m[C].x,m[C].y])}},Fc.prototype._drawCurrentPoint=function(F){var o=this;if(o.activing){var X=o.activing,A=o.getCurrentSelectintStatus(),a=o._interactor;if(A!==Cf.Curve.PointType.Straight){var t=X.pairs;X.hlpair,X.hltype;var d=X.selections,G=X.editingCtrl;if(t&&!d){var v,U,g;for(U=0,g=t.length;g>U;U++)v=t[U],G&&U===G.pairId&&v[G.type]?Cf.Icons.DrawIcon(a,F,Cf.Icons.ShapeActivingCtrl,{point:v.point,c1:v.c1,c2:v.c2,hl:G.type}):Cf.Icons.DrawIcon(a,F,Cf.Icons.ShapeActivingCtrl,v)}}Cf.Icons.DrawIcon(a,F,Cf.Icons.ShapeHighlighRealPoint,o.activing.point),d&&d.forEach(function(V){Cf.Icons.DrawIcon(a,F,Cf.Icons.ShapeHighlighRealPoint,V)})}},Fc.prototype.clear=function(){var I=this;I.editing=null,I._guideInfo=null,I.activing=null,I.highlight=null},Fc.prototype._42=function(W){var e=this;e.info={},e.editing||(e.screenInfo=null);var m=e._interactor;if(!m.editDetail)return e.clear(),void 0;var h=m.gv;if(!e.target||!h.isSelected(e.target)||!h.isVisible(e.target))return m.editDetail=!1,e.clear(),void 0;if(e.gatherSingleTarget(h,e.target),Cf.Icons.DrawIcon(m,W,Cf.Icons.ShapeBgCurve,e.screenInfo),e._interactor.getStyle("curveElevationVisible")&&(e.target instanceof U.Polyline||e.target instanceof U.Edge&&e._interactor.getStyle("edgeElevationEditable"))&&e.activing){var N=e.activing.getCurrentEditingPoint();N&&"string"!=typeof N.e&&Cf.Icons.DrawIcon(m,W,Cf.Icons.EdgeElevationGuide,N)}if(e._drawHighlight(W),e._drawCurrentPoint(W),e._getRealPoint().forEach(function(h){Cf.Icons.DrawIcon(m,W,Cf.Icons.ShapePoint,h)}),e._drawGuide(W),e.tipInfo&&e._interactor.getStyle("curveTipVisible")&&Cf.Icons.DrawIcon(m,W,Cf.Icons.TipHelper,e.tipInfo),e._edgeHostGuideInfo&&m._drawHostGuide(e._edgeHostGuideInfo),e.edgeEditResult&&e._drawEdgeHostHighlight(W,e.edgeEditResult.host,e.edgeEditResult.anchor),e._multiSelect&&e._multiSelect.endPoint){var E=U.Default.unionPoint(Cf.toScreenPosition(h,e._multiSelect.startPoint),Cf.toScreenPosition(h,e._multiSelect.endPoint));E.color=h.getRectSelectBorderColor(),W.save(),W.setTransform(1,0,0,1,0,0);var D=p.devicePixelRatio,d=E.borderWidth=Math.round(D);d/=2,E.x=Math.round(E.x*D)+d,E.y=Math.round(E.y*D)+d,E.width=Math.round(E.width*D),E.height=Math.round(E.height*D),Cf.Icons.DrawIcon(m,W,Cf.Icons.SimpleRect,E),W.restore()}},Fc.prototype._drawEdgeHostHighlight=function(p,m,s){this.drawEdgeHostHighlight(p,m,s),this._interactor.redraw()},Fc.prototype.drawEdgeHostHighlight=function(p,P,k){if(hg(P)){var e,A,d,C,I=this,L=I._interactor,$=L.gv,G=$.getDataUI(P),t=Ae(G),f=[];for(d=0,C=t.points.length;C>d;d++)A=Cf.toScreenPosition($,t.points.get(d)),f.push(A.x,A.y);t.segments&&(e=t.segments.toArray());var K=L.getStyle("edgeHostHighlighPeriod"),y=L.getStyle("edgeHostEdgeHighlighColor");Cf.Icons.DrawIcon(L,p,Cf.Icons.ShapeBgCurve,{P:f,S:e,color:y,dynamicVisible:k.index===s,dynamicPeriod:K}),y=L.getStyle("edgeHostPointHighlighColor");var X=tg(G);for(d=0,C=X.length;C>d;d++){var B=X[d],c=Cf.toScreenPosition($,B);Cf.Icons.DrawIcon(L,p,Cf.Icons.ShapePoint,{point:{x:c.x,y:c.y},color:y,size:12,dynamicVisible:d===k.index,dynamicPeriod:K})}}},Fc.prototype._getRealPoint=function(){var q,_=this.screenInfo,R=_.P,U=_.S,v=-1,J=[],P=-1,H=U.length;return U.each(function(K){P++;var B=1;if(3===K)B=2;else if(4===K)B=3;else if(5===K)return;v+=B,q=P+1>=H?!0:1===U.get(P+1)?!0:!1,J.push({point:{x:R[2*v],y:R[2*v+1]},segmentIndex:P,pointIndex:v,isEnd:q})}),J},Fc.prototype.getEditingPointsInfo=function(Z){var F=this,Y=F.activing;if(!Y)return!1;var G=Y.point;if(!G)return!1;var r=this._getRealPoint(),b=[{screen:G}];Y.selections&&Y.selections.forEach(function(u){b.push({screen:u})});var V,B,q=r.length;return b.forEach(function(n){for(V=0;q>V;V++)if(B=r[V],n.screen.isNearEnough(B.point)){n.segmentIndex=B.segmentIndex,n.pointIndex=B.pointIndex,n.point=F.target.getPoints().get(B.pointIndex);break}}),Z&&b.sort(function(y,h){return y.segmentIndex-h.segmentIndex}),b};var ue=Cf.MoveHelper=function(j){var Z=this;Z.catalog="Move",Z._interactor=j};ue.prototype={},ue.prototype.constructor=ue,ue.prototype.calcShift=function(S,o,M){var c,z,j=this,B=j._interactor.gv,d=B.lp(o);if("beginMove"===S&&j._gatherGridInfo(M._lastLogicalPoint||d),c=j._target){var O=c.downPosition;if(O){var J=j._interactor.getStyle("moveSensitivity")/B._zoom;if(O.distanceTo(d)<J)return{x:0,y:0};delete c.downPosition}var Y;z=U.Default.isShiftDown(o),z&&(d=j._dealShiftDown(d),Y=c.shiftGuide.dir);var A,F=c.rawPos={x:c.pos.x+d.x-c.lp.x,y:c.pos.y+d.y-c.lp.y};if(U.Default.isCtrlDown(o)){if(A=j._calcShiftByAddon(),j._target.node instanceof Cf.Group){var g=j._target.node;g._position.x+=A.x,g._position.y+=A.y}return A}var s=j._interactor.rectGuide;if(c.node instanceof U.Data&&c.node.s("2d.attachable")){var E=j._calcAttachNodeShift(c.node,F);if(s.clear(),E)return E}for(var v,K=c.x+F.x,$=c.y+F.y,a={x:K,y:$},D={x:K+c.w/2,y:$+c.h/2},W={x:K+c.w,y:$+c.h},P=j._interactor.gridGuide,q=[s.findClosest(a,Y),s.findClosest(D,Y),s.findClosest(W,Y),P.findClosest(a,Y),P.findClosest(D,Y),P.findClosest(W,Y)],V=1/0,t=1/0,r=0,m=q.length;m>r;r++)v=q[r],v&&(K=v.x,$=v.y,isFinite(K)&&Math.abs(K)<Math.abs(V)&&(V=K),isFinite($)&&Math.abs($)<Math.abs(t)&&(t=$));if(isFinite(V)||(V=0),isFinite(t)||(t=0),A=j._calcShiftByAddon(V,t),j._target.node instanceof Cf.Group){var g=j._target.node;g._position.x+=A.x,g._position.y+=A.y}var Q=c.node;if(!ve(Q,B)){var h=F.x+V,n=F.y+t;j._interactor.rectGuide.gatherLines({node:Q,x:c.x+h,y:c.y+n,w:c.w,h:c.h},Y)}return A}},ue.prototype._calcShiftByAddon=function(j,r){var E=this._target,f=E.rawPos,C=E.node.getPosition();return j=j||0,r=r||0,{x:f.x-C.x+j,y:f.y-C.y+r}},ue.prototype._dealShiftDown=function(f){var B=this,o=B._target.shiftGuide,N=B._target.lp,J=Math.abs(f.x-N.x),T=Math.abs(f.y-N.y);J>T&&J>o.limit&&"y"===o.dir&&(o.dir="x"),T>J&&T>o.limit&&"x"===o.dir&&(o.dir="y");var r=o.dir;return"x"===r?(f.y=N.y,o.limit=Math.max(o.limit,J)):"y"===r&&(f.x=N.x,o.limit=Math.max(o.limit,T)),f},ue.prototype._isAttachableLineShape=function(V){if(!V.getSegments)return!1;var T=V.getSegments();if(!T)return!0;T instanceof U.List&&(T=T.getArray());for(var m=1,Q=T.length;Q>m;m++)if(2!==T[m])return!1;return!0},ue.prototype._calcAttachNodeShift=function(){var K=new vr,S=new vr,f=new vr,D=new vr;return function(A,J){var r=this._interactor.gv,$=A.getHost(),u=r.getDataAt(J,function(n){return n.s("2d.hostable")?!0:!1});if(u&&$!==u&&A.setHost(u),!u)return this._edgeHostGuideInfo=null,A.setHost(null);var m=this._edgeHostGuideInfo={corners:Cf.getTargetCornersOnScreen(r,u),host:u,attach:-1};if(this._isAttachableLineShape(u)){for(var Y,h,Q,G,c,s,l=u.getPoints(),X=l.size(),W=u.getPointsMatrix2d(),w=1/0,n=0;X>n&&(n!==X-1||u.isClosePath());n++)0!==n?S.copy(f):W.apply(l.get(n),S),W.apply(n===X-1?l.get(0):l.get(n+1),f),K.copy(J).sub(S),D.copy(f).sub(S),Y=D.length(),D.divideScalar(Y),h=K.dot(D),0>h?h=0:h>Y&&(h=Y),D.multiplyScalar(h).add(S),Q=K.copy(J).sub(D).lengthSq(),w>Q&&(w=Q,s=n,G=h,c=Y);return Math.sqrt(w)*r.getZoom()>this._interactor.getStyle("attachThreshold")?(A.s({"attach.index":-1}),A.setHost(null),void 0):(A.s("attach.offset.opposite")&&(G=c-G),A.s({"attach.index":s,"attach.offset":A.s("attach.offset.relative")?G/c:G}),{x:0,y:0})}var v=r.calculateAttachPoint(u,J);if(v){var p=v.point;return m.attach=v.index,this._calcShiftByAddon(p.x-J.x,p.y-J.y)}}}(),ue.prototype._gatherGridInfo=function(a){var j,$=this,v=$._interactor,h=v._getValidSelection();if(h.length){if(1===h.length){if(j=h[0],!j.getRect)return $._target=null,void 0}else if(j=Cf.Group.findOrCreateGroup(h,v._uuid),!j)return $._target=null,void 0}else{var h=v.gv.sm().getSelection();if(h.length&&(j=h.get(0),!j.getRect))return $._target=null,void 0}if(j){var Q=j.getPosition(),l=j.getRect();$._target={node:j,x:l.x-Q.x,y:l.y-Q.y,w:l.width,h:l.height,lp:{x:a.x,y:a.y},pos:{x:Q.x,y:Q.y},shiftGuide:{dir:"x",limit:0},downPosition:new Cf.Math.Vector2(a)},v.rectGuide.gatherRects()}},ue.prototype.clear=function(){var O=this;O._edgeHostGuideInfo=null,O._interactor.rectGuide.clear(),O._interactor._42()},ue.prototype._42=function(){var j=this._edgeHostGuideInfo;j&&this._interactor._drawHostGuide(j)};var gq=z.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),be=function(){function Z(T,w){var U=s;
return function(){return U||(U=T.getExtension(w)),U}}function g(l,u){u==s&&(u={}),u.version=f&&(l instanceof WebGL2RenderingContext||z.prototype.toString.call(l)===m)?2:1,u.extensions=function(){for(var F={},E=l.getSupportedExtensions(),u=E.length;u--;)F[name]=Z(l,E[u]);return F}();for(var P=z.keys(L),M=0,G=P.length;G>M;++M){var b=P[M];u[b]=l.getParameter(L[b])}if(u.version>1){P=z.keys(k);for(var M=0,G=P.length;G>M;++M){var b=P[M];u[b]=l.getParameter(k[b])}}return u}var f="undefined"!=typeof WebGL2RenderingContext,m="[object WebGL2RenderingContext]",L={aliasedLineWidthRange:gq.ALIASED_LINE_WIDTH_RANGE,aliasedPointSizeRange:gq.ALIASED_POINT_SIZE_RANGE,maxCombinedTextureImageUnits:gq.MAX_COMBINED_TEXTURE_IMAGE_UNITS,maxCubeMapTextureSize:gq.MAX_CUBE_MAP_TEXTURE_SIZE,maxFragmentUniformVectors:gq.MAX_FRAGMENT_UNIFORM_VECTORS,maxRenderBufferSize:gq.MAX_RENDERBUFFER_SIZE,maxTextureImageUnits:gq.MAX_TEXTURE_IMAGE_UNITS,maxTextureSize:gq.MAX_TEXTURE_SIZE,maxVaryingVectors:gq.MAX_VARYING_VECTORS,maxVertexAttribs:gq.MAX_VERTEX_ATTRIBS,maxVertexTextureImageUnits:gq.MAX_VERTEX_TEXTURE_IMAGE_UNITS,maxVertexUniformVectors:gq.MAX_VERTEX_UNIFORM_VECTORS,maxViewportDIMs:gq.MAX_VIEWPORT_DIMS},k={max3DTextureSize:gq.MAX_3D_TEXTURE_SIZE,maxArrayTextureLayers:gq.MAX_ARRAY_TEXTURE_LAYERS,maxColorAttachments:gq.MAX_COLOR_ATTACHMENTS,maxCombinedFragmentUniformComponents:gq.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,maxCombinedUniformBlocks:gq.MAX_COMBINED_UNIFORM_BLOCKS,maxCombinedVertexUniformComponents:gq.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,maxDrawBuffers:gq.MAX_DRAW_BUFFERS,maxElementIndex:gq.MAX_ELEMENT_INDEX,maxElementsIndices:gq.MAX_ELEMENTS_INDICES,maxElementsVertices:gq.MAX_ELEMENTS_VERTICES,maxFragmentInpuComponents:gq.MAX_FRAGMENT_INPUT_COMPONENTS,maxFragmentUniformBlocks:gq.MAX_FRAGMENT_UNIFORM_BLOCKS,maxFragmentUniformComponents:gq.MAX_FRAGMENT_UNIFORM_COMPONENTS,maxProgramTexelOffset:gq.MAX_PROGRAM_TEXEL_OFFSET,maxSamples:gq.MAX_SAMPLES,maxTextureLODBias:gq.MAX_TEXTURE_LOD_BIAS,maxTransformFeedbackInterleavedComponents:gq.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,maxTransformFeedbackSeparateAttribs:gq.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,maxTransformFeedbackSeparateComponents:gq.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,maxUniformBlockSize:gq.MAX_UNIFORM_BLOCK_SIZE,maxUniformBufferBindings:gq.MAX_UNIFORM_BUFFER_BINDINGS,maxVaryingComponents:gq.MAX_VARYING_COMPONENTS,maxVertexOutputComponents:gq.MAX_VERTEX_OUTPUT_COMPONENTS,maxVertexUniformBlocks:gq.MAX_VERTEX_UNIFORM_BLOCKS,maxVertexUniformComponents:gq.MAX_VERTEX_UNIFORM_COMPONENTS,minProgramTexelOffset:gq.MIN_PROGRAM_TEXEL_OFFSET};return{"for":function(P){var k=P._info;return k||(P._info=k=g(P,k)),k}}}(),Hj=function(){function h(l,K,n){return{def:l,getter:n?function(W){var c=be.for(W);return c.version>1?W.getParameter(K):l}:function(a){return a.getParameter(K)},setter:n?function(R,s){var P=be.for(R);P.version>1&&R.pixelStorei(K,s)}:function(I,o){I.pixelStorei(K,o)}}}function $(V){return"string"==typeof V?Jj(V):V.r!==s?(Q[0]=V.r,Q[1]=V.g,Q[2]=V.b,Q[3]=V.a,Q):V.red!==s?(Q[0]=V.red,Q[1]=V.green,Q[2]=V.blue,Q[3]=V.alpha,Q):V}function B(X){return G(X)?Array.prototype.slice.call(X,0):X}function N(C,c,w){this.gl=c,this._record=w||{},this._branches={},this._leafSync={},this._struct=C;for(var L=C.children,K=L.length;K--;){var t=L[K],b=t.name;t.isLeaf?(this._leafSync[b]=!1,this._record[b]=B(t.desc.def)):this._record[b]={}}}function f(T){function h(L,R){N.call(this,T,L,R);for(var k=d.length;k--;){var Z=d[k];this._branches[Z._name]=new Z._type(L,this._record[Z._name])}}function c(W,Q){function i(U,q){for(var I=r,Q=!1;I--;)U[I]!==q[I]&&(U[I]=q[I],Q=!0);return Q}var E=W.name,J=G(W.desc.def),r=J&&W.desc.def.length;if(W.isLeaf){var s=W.desc.setter,Z=W.desc.parse;z.defineProperty(Q,E,{configurable:!1,enumerable:!0,get:function(){return this._record[E]},set:J?function(q){Z&&(q=Z(q)),(i(this._record[E],q)||!this._leafSync[E])&&(s(this.gl,this._record[E]),this._leafSync[E]=!0)}:function(m){this._record[E]===m&&this._leafSync[E]||(s(this.gl,m),this._record[E]=m,this._leafSync[E]=!0)}})}else d.push({_name:E,_type:f(W)}),z.defineProperty(Q,E,{configurable:!1,enumerable:!0,get:function(){return this._branches[E]},set:function(D){this._branches[E].apply(D)}})}var d=[];return H(h,N),T.forEach(c,h.prototype),h}var Q="undefined"!=typeof Float32Array&&new Float32Array(4),Y={viewport:{def:[0,0,0/0,0/0],getter:function(z){return z.getParameter(z.VIEWPORT)},setter:function(O,X){var u=X[2]!==X[2]?O.drawingBufferWidth-X[0]:X[2],H=X[3]!==X[3]?O.drawingBufferHeight-X[1]:X[3];O.viewport(X[0],X[1],u,H)}},dither:{def:!1,getter:function(P){return P.isEnabled(P.DITHER)},setter:function(F,Y){Y?F.enable(F.DITHER):F.disable(F.DITHER)}},rasterizerDiscard:{def:!1,getter:function(g){var e=be.for(g);return e.version>1&&g.isEnabled(g.RASTERIZER_DISCARD)},setter:function(u,T){var q=be.for(u);1!==q.version&&(T?u.enable(u.RASTERIZER_DISCARD):u.disable(u.RASTERIZER_DISCARD))}},lineWidth:{def:1,getter:function(t){return t.lineWidth?t.getParameter(t.LINE_WIDTH):1},setter:function(p,b){p.lineWidth&&p.lineWidth(b)}},color:{clear:{def:[0,0,0,0],getter:function(E){return E.getParameter(E.COLOR_CLEAR_VALUE)},setter:function(e,h){e.clearColor(h[0],h[1],h[2],h[3])},parse:$},mask:{def:[!0,!0,!0,!0],getter:function(X){return X.getParameter(X.COLOR_WRITEMASK)},setter:function(w,R){w.colorMask(R[0],R[1],R[2],R[3])}}},blend:{enabled:{def:!1,getter:function(n){return n.isEnabled(n.BLEND)},setter:function(A,V){V?A.enable(A.BLEND):A.disable(A.BLEND)}},color:{def:[0,0,0,0],getter:function(W){return W.getParameter(W.BLEND_COLOR)},setter:function(H,o){H.blendColor(o[0],o[1],o[2],o[3])},parse:$},equation:{def:[gq.FUNC_ADD,gq.FUNC_ADD],getter:function(t){return[t.getParameter(t.BLEND_EQUATION_RGB),t.getParameter(t.BLEND_EQUATION_ALPHA)]},setter:function(x,q){x.blendEquationSeparate(q[0],q[1])},parse:function(M){var P=M.length;return P>1?M:1===P?(Q[1]=Q[0]=M[0],Q):(Q[1]=Q[0]=M,Q)}},func:{def:[gq.ONE,gq.ZERO,gq.ONE,gq.ZERO],getter:function(p){return[p.getParameter(p.BLEND_SRC_RGB),p.getParameter(p.BLEND_DST_RGB),p.getParameter(p.BLEND_SRC_ALPHA),p.getParameter(p.BLEND_DST_ALPHA)]},setter:function(r,j){r.blendFuncSeparate(j[0],j[1],j[2],j[3])},parse:function(h){var U=h.length;return U>3?h:(Q[2]=Q[0]=h[0],Q[3]=Q[1]=h[1],Q)}}},cullFace:{enabled:{def:!1,getter:function(P){return P.isEnabled(P.CULL_FACE)},setter:function(q,r){r?q.enable(q.CULL_FACE):q.disable(q.CULL_FACE)}},mode:{def:gq.BACK,getter:function(r){return r.getParameter(r.CULL_FACE_MODE)},setter:function(K,W){K.cullFace(W)}},frontFace:{def:gq.CCW,getter:function(s){return s.getParameter(s.FRONT_FACE)},setter:function(b,I){b.frontFace(I)}}},scissor:{enabled:{def:!1,getter:function(x){return x.isEnabled(x.SCISSOR_TEST)},setter:function(j,m){m?j.enable(j.SCISSOR_TEST):j.disable(j.SCISSOR_TEST)}},box:{def:[0,0,0/0,0/0],getter:function($){return $.getParameter($.SCISSOR_BOX)},setter:function(p,r){var j=r[2]!==r[2]?p.drawingBufferWidth-r[0]:r[2],$=r[3]!==r[3]?p.drawingBufferHeight-r[1]:r[3];p.scissor(r[0],r[1],j,$)}}},depth:{enabled:{def:!1,getter:function(v){return v.isEnabled(v.DEPTH_TEST)},setter:function(o,X){X?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST)}},clear:{def:1,getter:function(M){return M.getParameter(M.DEPTH_CLEAR_VALUE)},setter:function(v,x){v.clearDepth(x)}},mask:{def:!0,getter:function(e){return e.getParameter(e.DEPTH_WRITEMASK)},setter:function(b,C){b.depthMask(C)}},range:{def:[-1,1],getter:function(u){return u.getParameter(u.DEPTH_RANGE)},setter:function(O,d){O.depthRange(d[0],d[1])}},func:{def:gq.LESS,getter:function(d){return d.getParameter(d.DEPTH_FUNC)},setter:function(i,A){i.depthFunc(A)}}},stencil:{enabled:{def:!1,getter:function(N){return N.isEnabled(N.STENCIL_TEST)},setter:function(F,H){H?F.enable(F.STENCIL_TEST):F.disable(F.STENCIL_TEST)}},clear:{def:0,getter:function(E){return E.getParameter(E.STENCIL_CLEAR_VALUE)},setter:function(h,u){h.clearStencil(u)}},frontMask:{def:255,getter:function(I){return I.getParameter(I.STENCIL_WRITEMASK)},setter:function(E,z){E.stencilMaskSeparate(E.FRONT,z)}},frontOp:{def:[gq.KEEP,gq.KEEP,gq.KEEP],getter:function(t){return[t.getParameter(t.STENCIL_FAIL),t.getParameter(t.STENCIL_PASS_DEPTH_FAIL),t.getParameter(t.STENCIL_PASS_DEPTH_PASS)]},setter:function(L,M){L.stencilOpSeparate(L.FRONT,M[0],M[1],M[2])}},frontFunc:{def:[gq.ALWAYS,0,255],getter:function($){return[$.getParameter($.STENCIL_FUNC),$.getParameter($.STENCIL_REF),$.getParameter($.STENCIL_VALUE_MASK)]},setter:function(m,R){m.stencilFuncSeparate(m.FRONT,R[0],R[1],R[2])}},backMask:{def:255,getter:function(h){return h.getParameter(h.STENCIL_BACK_WRITEMASK)},setter:function(P,k){P.stencilMaskSeparate(P.BACK,k)}},backOp:{def:[gq.KEEP,gq.KEEP,gq.KEEP],getter:function(Z){return[Z.getParameter(Z.STENCIL_BACK_FAIL),Z.getParameter(Z.STENCIL_BACK_PASS_DEPTH_FAIL),Z.getParameter(Z.STENCIL_BACK_PASS_DEPTH_PASS)]},setter:function(P,O){P.stencilOpSeparate(P.BACK,O[0],O[1],O[2])}},backFunc:{def:[gq.ALWAYS,0,255],getter:function(F){return[F.getParameter(F.STENCIL_BACK_FUNC),F.getParameter(F.STENCIL_BACK_REF),F.getParameter(F.STENCIL_BACK_VALUE_MASK)]},setter:function(N,U){N.stencilFuncSeparate(N.BACK,U[0],U[1],U[2])}}},hint:{generateMipmap:{def:gq.DONT_CARE,getter:function(A){return A.getParameter(A.GENERATE_MIPMAP_HINT)},setter:function(U,C){U.hint(U.GENERATE_MIPMAP_HINT,C)}},fragmentShaderDerivative:{def:gq.DONT_CARE,getter:function(x){var N=be.for(x);return 1!==N.version||N.extensions.OES_standard_derivatives?x.getParameter(gq.FRAGMENT_SHADER_DERIVATIVE_HINT):gq.DONT_CARE},setter:function(E,F){var y=be.for(E);return y.version>1||y.extensions.OES_standard_derivatives?(E.hint(gq.FRAGMENT_SHADER_DERIVATIVE_HINT,F),void 0):void 0}}},pixelStore:{packAlignment:h(4,gq.PACK_ALIGNMENT,!1),unpackAlignment:h(4,gq.UNPACK_ALIGNMENT,!1),unpackFlipY:h(!1,gq.UNPACK_FLIP_Y_WEBGL,!1),unpackPremultiplyAlpha:h(!1,gq.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),unpackColorspaceConversion:h(gq.BROWSER_DEFAULT_WEBGL,gq.UNPACK_COLORSPACE_CONVERSION_WEBGL,!1),packRowLength:h(0,gq.PACK_ROW_LENGTH,!0),packSkipPixels:h(0,gq.PACK_SKIP_PIXELS,!0),packSkipRows:h(0,gq.PACK_SKIP_ROWS,!0),unpackRowLength:h(0,gq.UNPACK_ROW_LENGTH,!0),unpackImageHeight:h(0,gq.UNPACK_IMAGE_HEIGHT,!0),unpackSkipPixels:h(0,gq.UNPACK_SKIP_PIXELS,!0),unpackSkipRows:h(0,gq.UNPACK_SKIP_ROWS,!0),unpackSkipImages:h(0,gq.UNPACK_SKIP_IMAGES,!0)},polygonOffset:{enabled:{def:!1,getter:function(I){return I.isEnabled(I.POLYGON_OFFSET_FILL)},setter:function(U,L){L?U.enable(U.POLYGON_OFFSET_FILL):U.disable(U.POLYGON_OFFSET_FILL)}},value:{def:[0,0],getter:function($){return[$.getParameter($.POLYGON_OFFSET_FACTOR),$.getParameter($.POLYGON_OFFSET_UNITS)]},setter:function(R,k){R.polygonOffset(k[0],k[1])}}},sampleCoverage:{enabled:{def:!1,getter:function(R){return R.isEnabled(R.SAMPLE_COVERAGE)},setter:function(L,n){n?L.enable(L.SAMPLE_COVERAGE):L.disable(L.SAMPLE_COVERAGE)}},alpha:{def:!1,getter:function(T){return T.isEnabled(T.SAMPLE_ALPHA_TO_COVERAGE)},setter:function(y,N){N?y.enable(y.SAMPLE_ALPHA_TO_COVERAGE):y.disable(y.SAMPLE_ALPHA_TO_COVERAGE)}},value:{def:[1,!1],getter:function(z){return[z.getParameter(z.SAMPLE_COVERAGE_VALUE),z.getParameter(z.SAMPLE_COVERAGE_INVERT)]},setter:function(c,M){c.sampleCoverage(M[0],M[1])}}}},C=lh.create(Y,function(G){return"def"in G});N.prototype.reset=function(){for(var r=this._struct.children,f=r.length;f--;){var c=r[f],K=c.name;c.isLeaf?this[K]=c.desc.def:this._branches[K].reset()}},N.prototype.save=function(Z){Z==s&&(Z={});for(var e=this._struct.children,J=e.length;J--;){var m=e[J],U=m.name;if(m.isLeaf)Z[U]=B(this._record[U]);else{var b=Z[U];b==s&&(Z[U]=b={}),this._branches[U].save(b)}}return Z},N.prototype.sync=function(e,u){for(var s=this._struct.children,d=s.length;d--;){var K=s[d],S=K.name;K.isLeaf?(u||!this._leafSync[S])&&(e?(this._record[S]=K.desc.getter(this.gl),this._leafSync[S]=!0):(K.desc.setter(this.gl,this._record[S]),this._leafSync[S]=!0)):this._branches[S].sync(e,u)}},N.prototype.syncLoss=function(){for(var Y=this._struct.children,O=Y.length;O--;){var u=Y[O];u.isLeaf?this._leafSync[u.name]=!1:this._branches[u.name].syncLoss()}},N.prototype.apply=function(y){for(var Q=this._struct.children,j=Q.length;j--;){var _=Q[j],W=_.name;W in y&&(_.isLeaf?this[W]=y[W]:this._branches[W].apply(y[W]))}},N.prototype.append=function(p){var g=this._struct.childMap;for(var R in p){var $=g[R];$&&($.isLeaf?this[R]=p[R]:this._branches[R].append(p[R]))}};var X=f(C);return function(g){var E=g._state;return E||(g._state=E=new X(g)),E}}(),Ac=function(){function X(Z,z,m,k){if(Z){var d=Z.length;if(d!=s)for(var L=0;k>L;++L)z[m+L]=Z[L];else Z.toArray&&Z.toArray(z,m)}else for(var L=0;k>L;++L)z[m+L]=0}function h(m,L,o){var C=m[0];if(0>=C||C>0)return m;var i=L*o,B=J[i];if(B==s&&(J[i]=B=new Float32Array(i)),0!==L){X(C,B,0,o);for(var c=1,u=0;c!==L;++c)u+=o,X(m[c],B,u,o)}return B}function y(v,k){v.uniform1f(this.addr,k)}function o(I,G){I.uniform1fv(this.addr,G)}function w(I,k){if(k.x!=s)I.uniform2f(this.addr,k.x,k.y);else{var P=J[2];P.set(k,0),I.uniform2fv(this.addr,P)}}function e(J,m){J.uniform2fv(this.addr,h(m,this.size,2))}function R(I,W){if(W.x!=s)I.uniform3f(this.addr,W.x,W.y,W.z);else if(W.r!=s)I.uniform3f(this.addr,W.r,W.g,W.b);else if(W.red!=s)I.uniform3f(this.addr,W.red,W.green,W.blue);else{var v=J[3];v.set(W,0),I.uniform3fv(this.addr,v)}}function W(j,F){j.uniform3fv(this.addr,h(F,this.size,3))}function C(g,G){if("string"==typeof G&&(G=Jj(G)),G.x!=s)g.uniform4f(this.addr,G.x,G.y,G.z,G.w);else if(G.r!=s)g.uniform4f(this.addr,G.r,G.g,G.b,G.a);else if(G.red!=s)g.uniform4f(this.addr,G.red,G.green,G.blue,G.alpha);else{var N=J[4];N.set(G,0),g.uniform4fv(this.addr,N)}}function K(B,O){B.uniform4fv(this.addr,h(O,this.size,4))}function U(Z,o){Z.uniform1i(this.addr,o)}function t(Q,H){Q.uniform1iv(this.addr,H)}function l(H,y){H.uniform2iv(this.addr,y)}function I(R,f){R.uniform3iv(this.addr,f)}function A(b,f){b.uniform4iv(this.addr,f)}function Y(i,w){i.uniform1i(this.addr,a[w?1:0])}function P(B,e){var l=J[4];l.set(e,0),B.uniformMatrix2fv(this.addr,!1,l)}function D(g,v){g.uniformMatrix2fv(this.addr,!1,h(v,this.size,4))}function d(O,k){var f=J[9];f.set(k,0),O.uniformMatrix3fv(this.addr,!1,f)}function $(b,a){b.uniformMatrix3fv(this.addr,!1,h(a,this.size,9))}function M(q,t){var R=J[16];R.set(t,0),q.uniformMatrix4fv(this.addr,!1,R)}function u(B,k){B.uniformMatrix4fv(this.addr,!1,h(k,this.size,16))}function N(_,Q){_.uniform1i(this.addr,this.slots[0]),_.activeTexture(_.TEXTURE0+this.slots[0]),_.bindTexture(_.TEXTURE_2D,Q||_._emptyTexture)}function _(F,$){F.uniform1iv(this.addr,this.slots);for(var M=this.slots.length;M--;)F.activeTexture(F.TEXTURE0+this.slots[M]),F.bindTexture(F.TEXTURE_2D,$[M]||F._emptyTexture)}function G(c,z){c.uniform1i(this.addr,this.slots[0]),c.activeTexture(c.TEXTURE0+this.slots[0]),c.bindTexture(c.TEXTURE_CUBE_MAP,z||c._emptyCubeTexture)}function v(F,i){F.uniform1iv(this.addr,this.slots);for(var z=this.slots.length;z--;)F.activeTexture(F.TEXTURE0+this.slots[z]),F.bindTexture(F.TEXTURE_CUBE_MAP,i[z]||F._emptyCubeTexture)}function q(Q,q,P){f[Q]=[q,P]}function Q(Y,V,_){switch(Y.type){case 35678:case 35680:if("uSampler"===_)return[0];if("uBlendSampler"===_)return[1];for(var X=Y.size,F=new Int32Array(X),y=0;X>y;++y)F[y]=V.usedTextureSlot++;return F}return s}function T(d,c,G,v,Y){this.name=d,this.addr=c,this.size=v?G.size:0,this.activeInfo=G,this.setter=f[G.type][v?1:0],this.slots=Q(G,Y,d),Sg(this)}function E(M,O,z,N){var L=M.name,G=L.length;for(r.lastIndex=0;;){var y=r.exec(L),K=r.lastIndex,U=y[1],c="]"===y[2],v=y[3];if(c&&(U=0|U),v===s||"["===v&&K+2===G){z[U]=new T(U,O,M,v!==s,N);break}var R=z[U];R==s&&(z[U]=R={}),z=R}}function L(o,C,k){this.gl=C,this._program=k,this._leaves={},this._branches={},this._struct=o}function g(F){function y(U,C){L.call(this,F,U,C);for(var V=B.length;V--;){var X=B[V];this._branches[X._name]=new X._type(U,C)}this.uuid=fo.generateUUID()}function k(M,$){var _=M.name;if(M.isLeaf){var H=j("d.setter(this.gl, v);",["v"],["d"],[M.desc]);z.defineProperty($,_,{configurable:!1,enumerable:!0,get:function(){return H},set:H})}else B.push({_name:_,_type:g(M)}),z.defineProperty($,_,{configurable:!1,enumerable:!0,get:function(){return this._branches[_]},set:function(p){this._branches[_].apply(p)}})}var B=[];return H(y,L),F.forEach(k,y.prototype),y}function n(V,y){for(var q=V.getProgramParameter(y,V.ACTIVE_UNIFORMS),Q={},t={usedTextureSlot:2};q--;){var Z=V.getActiveUniform(y,q),M=Z.name,f=V.getUniformLocation(y,M);E(Z,f,Q,t)}var m=lh.create(Q,function(v){return"addr"in v}),_=g(m);return z.defineProperty(_.prototype,"textureCount",{configurable:!1,enumerable:!1,writable:!1,value:t.usedTextureSlot}),new _(V,y)}var J=[];if("function"==typeof Float32Array)for(var B=1;17>B;++B)J[B]=new Float32Array(B);var a=[0,1],f=[];q(gq.FLOAT,y,o),q(gq.FLOAT_VEC2,w,e),q(gq.FLOAT_VEC3,R,W),q(gq.FLOAT_VEC4,C,K),q(gq.INT,U,t),q(gq.INT_VEC2,l,l),q(gq.INT_VEC3,I,I),q(gq.INT_VEC4,A,A),q(gq.BOOL,Y,t),q(gq.BOOL_VEC2,l,l),q(gq.BOOL_VEC3,I,I),q(gq.BOOL_VEC4,A,A),q(gq.FLOAT_MAT2,P,D),q(gq.FLOAT_MAT3,d,$),q(gq.FLOAT_MAT4,M,u),q(gq.SAMPLER_2D,N,_),q(gq.SAMPLER_CUBE,G,v);var r=/([\w\d_]+)(\])?(\[|\.)?/g;return L.prototype.apply=function(u){for(var l=this._struct.children,i=l.length;i--;){var o=l[i],d=o.name;d in u&&(o.isLeaf?this[d]=u[d]:this._branches[d].apply(u[d]))}},L.prototype.append=function(i){var Y=this._struct.childMap;for(var A in i){var u=Y[A];u&&(u.isLeaf?this[A]=i[A]:this._branches[A].append(i[A]))}},function(I,u){var W=u._uniforms;return W||(u._uniforms=W=n(I,u)),W}}(),Vb=function(){function X(n,R,N){R.vertexAttrib1f(n.addr,N)}function Y(g,z,H){if(H.x!=s)z.vertexAttrib2f(g.addr,H.x,H.y);else{var _=K[2];_.set(H,0),z.vertexAttrib2fv(g.addr,_)}}function D(z,V,A){if(A.x!=s)V.vertexAttrib3f(z.addr,A.x,A.y,A.z);else if(A.r!=s)V.vertexAttrib3f(z.addr,A.r,A.g,A.b);else if(A.red!=s)V.vertexAttrib3f(z.addr,A.red,A.green,A.blue);else{var Q=K[3];Q.set(A,0),V.vertexAttrib3fv(z.addr,Q)}}function A(U,Z,x){if("string"==typeof x&&(x=Jj(x)),x.x!=s)Z.vertexAttrib4f(U.addr,x.x,x.y,x.z,x.w);else if(x.r!=s)Z.vertexAttrib4f(U.addr,x.r,x.g,x.b,x.a);else if(x.red!=s)Z.vertexAttrib4f(U.addr,x.red,x.green,x.blue,x.alpha);else{var j=K[4];j.set(x,0),Z.vertexAttrib4fv(U.addr,j)}}function R(q,z,u){u=u.el||u;for(var H=0,Y=0;2>H;++H)z.vertexAttrib2f(q.addr,u[Y++],u[Y++])}function I(L,x,o){o=o.el||o;for(var E=0,e=0;3>E;++E)x.vertexAttrib3f(L.addr,o[e++],o[e++],o[e++])}function C(R,L,k){k=k.el||k;for(var K=0,x=0;4>K;++K)L.vertexAttrib4f(R.addr,k[x++],k[x++],k[x++],k[x++])}function $(W,X,U,V,F,c,$){X.bindBuffer(X.ARRAY_BUFFER,U),X.vertexAttribPointer(W.addr,1,V||X.FLOAT,!!F,c||0,$||0),X.bindBuffer(X.ARRAY_BUFFER,null)}function o(L,A,c,T,a,S,I){A.bindBuffer(A.ARRAY_BUFFER,c),A.vertexAttribPointer(L.addr,2,T||A.FLOAT,!!a,S||0,I||0),A.bindBuffer(A.ARRAY_BUFFER,null)}function i(V,C,i,U,n,H,M){C.bindBuffer(C.ARRAY_BUFFER,i),C.vertexAttribPointer(V.addr,3,U||C.FLOAT,!!n,H||0,M||0),C.bindBuffer(C.ARRAY_BUFFER,null)}function q(N,f,Y,D,t,O,Q){f.bindBuffer(f.ARRAY_BUFFER,Y),f.vertexAttribPointer(N.addr,4,D||f.FLOAT,!!t,O||0,Q||0),f.bindBuffer(f.ARRAY_BUFFER,null)}function y(j,O,R,C,B,G,D){var G=G||4,D=D||0;O.bindBuffer(O.ARRAY_BUFFER,R),O.vertexAttribPointer(j.addr,2,C||O.FLOAT,!!B,G,D),O.vertexAttribPointer(j.addr+1,2,C||O.FLOAT,!!B,G,D+2),O.bindBuffer(O.ARRAY_BUFFER,null)}function t(O,S,X,h,D,V,b){var V=V||9,b=b||0;S.bindBuffer(S.ARRAY_BUFFER,X),S.vertexAttribPointer(O.addr,3,h||S.FLOAT,!!D,V,b),S.vertexAttribPointer(O.addr+1,3,h||S.FLOAT,!!D,V,b+3),S.vertexAttribPointer(O.addr+2,3,h||S.FLOAT,!!D,V,b+6),S.bindBuffer(S.ARRAY_BUFFER,null)}function v(J,U,S,i,M,B,j){var B=B||16,j=j||0;U.bindBuffer(U.ARRAY_BUFFER,S),U.vertexAttribPointer(J.addr,4,i||U.FLOAT,!!M,B,j),U.vertexAttribPointer(J.addr+1,4,i||U.FLOAT,!!M,B,j+4),U.vertexAttribPointer(J.addr+2,4,i||U.FLOAT,!!M,B,j+8),U.vertexAttribPointer(J.addr+3,4,i||U.FLOAT,!!M,B,j+12),U.bindBuffer(U.ARRAY_BUFFER,null)}function g(M,q,V){m[M]=function(N,M,S,f,l,k){this.addr==s||this.addr<0||(M==s||M===!1?N.disableVertexAttribArray(this.addr):Zl(M)===_?(N.enableVertexAttribArray(this.addr),V(this,N,M,S,f,l,k)):(N.disableVertexAttribArray(this.addr),q(this,N,M)))}}function r(W,$,A){this.name=W,this.addr=$,this.activeInfo=A,this.setter=m[A.type],Sg(this)}function f(B,P,k){this.gl=P,this.program=k,this._branches={},this._struct=B}function a(i){function Q(n,A){f.call(this,i,n,A);for(var T=Y.length;T--;){var s=Y[T];this._branches[s._name]=new s._type(n,A)}}function Z(L,O){var h=L.name;if(L.isLeaf){var v=j("d.setter(this.gl, v);",["v"],["d"],[L.desc]);z.defineProperty(O,h,{configurable:!1,enumerable:!0,get:function(){return v},set:v})}else Y.push({_name:h,_type:a(L)}),z.defineProperty(O,h,{configurable:!1,enumerable:!0,get:function(){return this._branches[h]},set:function(Y){this._branches[h].apply(Y)}})}var Y=[];return H(Q,f),i.forEach(Z,Q.prototype),Q}function u(p,i){for(var m=p.getProgramParameter(i,p.ACTIVE_ATTRIBUTES),J={};m--;){var T=p.getActiveAttrib(i,m),Z=T.name,N=p.getAttribLocation(i,Z);J[Z]=new r(Z,N,T)}var x=lh.create(J,function(s){return"addr"in s}),L=a(x);return new L(p,i)}for(var K=[],L=1;17>L;++L)K[L]=new Yp(L);var m=[],_="undefined"!=typeof WebGLBuffer&&WebGLBuffer.prototype;return g(gq.FLOAT,X,$),g(gq.FLOAT_VEC2,Y,o),g(gq.FLOAT_VEC3,D,i),g(gq.FLOAT_VEC4,A,q),g(gq.FLOAT_MAT2,R,y),g(gq.FLOAT_MAT3,I,t),g(gq.FLOAT_MAT4,C,v),f.prototype.disable=function(){for(var v=this._struct.children,Q=v.length;Q--;){var U=v[Q],o=U.name;U.isLeaf?this.gl.disableVertexAttribArray(U.desc.addr):this._branches[o].disable()}},f.prototype.apply=function(M){for(var G=this._struct.children,c=G.length;c--;){var V=G[c],Y=V.name;Y in M&&(V.isLeaf?this[Y]=M[Y]:this._branches[Y].apply(M[Y]))}},f.prototype.append=function(f){var H=this._struct.childMap;for(var O in f){var y=H[O];y&&(y.isLeaf?this[O]=f[O]:this._branches[O].append(f[O]))}},function(O,J){var C=J._attribs;return C||(J._attribs=C=u(O,J)),C}}(),ts=function(t){var A=this;z.defineProperties(this,{gl:{configurable:!1,enumerable:!1,value:t,writable:!1},glState:{configurable:!1,enumerable:!1,value:Hj(t),writable:!1}}),A._currProgram=s,A._currUniforms=s,A._currAttribs=s,A._sync=!0};z.defineProperties(ts.prototype,{program:{configurable:!1,enumerable:!1,get:function(){return this._currProgram},set:function(N){var Q=this;Q._sync&&N===Q._currProgram||(Q.gl.useProgram(N),Q._currProgram=N,Q._currUniforms=Ac(Q.gl,N),Q._currAttribs=Vb(Q.gl,N),Q._sync=!0)}},uniforms:{configurable:!1,enumerable:!1,get:function(){var Q=this;return Q._currProgram&&!Q._sync&&(Q.gl.useProgram(Q._currProgram),Q._sync=!0),Q._currUniforms},set:function(r){var d=this;d._currUniforms&&(d._currProgram&&!d._sync&&(d.gl.useProgram(d._currProgram),this._sync=!0),d._currUniforms.apply(r))}},attribs:{configurable:!1,enumerable:!1,get:function(){var h=this;return h._currProgram&&!h._sync&&(h.gl.useProgram(h._currProgram),h._sync=!0),h._currAttribs},set:function(Y){var W=this;W._currUniforms&&(W._currProgram&&!W._sync&&(W.gl.useProgram(W._currProgram),this._sync=!0),W._currAttribs.apply(Y))}}}),ts.prototype.useProgram=function(Y){var w=this;w._sync&&Y===w._currProgram||(w.gl.useProgram(Y),w._currProgram=Y,w._currUniforms=Ac(w.gl,Y),w._currAttribs=Vb(w.gl,Y),w._sync=!0)},ts.prototype.directState=function(){return this.glState},ts.prototype.directUniforms=function(){return this._currUniforms},ts.prototype.directAttribs=function(){return this._currAttribs},ts.prototype.syncLoss=function(){this._sync=!1,this.glState.syncLoss()},ts.for=function(y){var g=y._renderState;return g||(y._renderState=g=new ts(y)),g};var hl="directional",vd="point",wh="spot",$o="light.color",Be=4294967295,pk=0,Zm={},jg=[],_k=0,Kd=function(E,C){Xj(C)&&nc.test(C)?$j(E,C):Np(C)&&C.modelType?nd(E,C):C===s?delete ps[E]:ps[E]=C},ul=function(N){return N},Ge=function(T){T=p.convertShape3dModelName(T);var P;if(Np(T)){if(T.modelType){if(T.uuid){if(P=ps[T.uuid])return P}else T.uuid=U.Math.generateUUID();return P===s&&(Oh&&Oh[T.uuid]||nd(T.uuid,T)),s}return T}return P=ps[T],T&&P===s&&nc.test(T)&&(Oh&&Oh[T]||$j(T,T)),P},Qg=function(Z,J){Z.frameStack?Z.frameStack.push(J):Z.frameStack=[J],Z.bindFramebuffer(Z.FRAMEBUFFER,J)},hc=function(S){var r=S.frameStack;if(r){if(r.pop(),r.length)return S.bindFramebuffer(S.FRAMEBUFFER,r[r.length-1]),void 0;S.frameStack=null}S.bindFramebuffer(S.FRAMEBUFFER,null)};oi(p,{graph3dViewAttributes:g,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:a/60,graph3dViewSortable:!1,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Tb,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewRotateMaxPhi:a,graph3dViewRotateMinPhi:0,graph3dViewShadowDisabled:!0,graph3dViewShadowQuality:"high",graph3dViewShadowIntensity:.3,graph3dViewShadowBias:-.005,graph3dViewShadowRadius:.1,graph3dViewShadowType:"hard",graph3dViewShadowDegreeX:30,graph3dViewShadowDegreeZ:-10,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewSyncEyeWithOrthoWidth:!1,graph3dViewFovy:a/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewDataNumWarningLine:1e4,graph3dViewHeadlightRange:0,graph3dViewHeadlightGroup:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogMode:"linear",graph3dViewFogDensity:5e-4,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dViewEnvmapType:"legacy",graph3dMaxVectorCacheTime:50,graph3dEnvmapCapabilityRequire:8,setShape3dModel:Kd,getShape3dModel:Ge,convertShape3dModelName:ul,getShape3dModelMap:function(){return ps},getCachedShape3dModelMap:function(){return bm},createMatrix:function(m,_){Vd(m)||(m=[m]);for(var K=m.length-1;K>=0;K--){var N=m[K];_=wi(N.mat,N.s3,N.r3,N.rotationMode,N.t3,_)}return _},transformVec:function(I,u){return aq(I,u)},glBindFrame:Qg,glUnbindFrame:hc,createBoxModel:function(){return{vs:jq,ns:An,uv:Og,is:Pq}},createRoundRectModel:function(Z,g){return _p.roundRect(Z,g)},createStarModel:function(w,E){return _p.star(w,E)},createRectModel:function(L,n){return _p.rect(L,n)},createTriangleModel:function(_,P){return _p.triangle(_,P)},createRightTriangleModel:function(o,C){return _p.rightTriangle(o,C)},createParallelogramModel:function(F,P){return _p.parallelogram(F,P)},createTrapezoidModel:function(h,I){return _p.trapezoid(h,I)},createSmoothSphereModel:function(w,m,B,u,v,D,q){return yc(new Cm(w,m,B,u,v,D,q))},createSphereModel:function(S,Y,B,r,y,K,o){return S?Se(S,Y,B,r,y,K,o):p.createSmoothSphereModel()},createSmoothConeModel:function(P,i,v,M,q){return vm(P,i,v,M,q)},createConeModel:function(s,n,o,X,S,N,W,h){return s?gr(s,n,o,X,S,N,W,h):vm(N)},createSmoothCylinderModel:function(S,G,D,M,k,p,B,d){return yc(new $r(S,G,D,M,k,p,B,d))},createCylinderModel:function(h,T,X,r,o,Z,v,q){return h?Cn(h,T,X,r,o,Z,v,q):Ah(Z,v)},createSmoothTorusModel:function(m,c,Q,H,S,O){return yc(new Yh(m,c,Q,H,S,O))},createTorusModel:function(I,k,y,X,b,C,i,F){return I?Cj(I,k,y,X,b,C,i,F):Bq(C,i)},createExtrusionModel:function(A,v,x,y,q,l,O,Q){return bh(A,v,x,y,q,l,O,Q)},createSmoothRingModel:function(B,E,P,I,q,g){for(var M=[],a=0;a<B.length-1;a+=2)M.push({x:B[a],y:B[a+1]});for(B=Ok(M,E,P)[0],M=[],a=0;a<B.length;a++){var G=B[a];M.push(new Qh(G.x,0,G.y))}return yc(new qq(M,g,I,q))},createTextGeometry:function(m,z){var T=yc(new um(m,z));if(z.cube)for(var M=uq(T),C=M.min,V=M.max,y=C.x,Y=C.y,J=C.z,D=V.x-y||1,g=V.y-Y||1,n=V.z-J||1,E=["vs","top_vs","bottom_vs"],$=0,I=E.length;I>$;$++){var H=T[E[$]];if(H)for(var u=0,r=H.length;r>u;u+=3)H[u]=(H[u]-y)/D-.5,H[u+1]=(H[u+1]-Y)/g-.5,H[u+2]=(H[u+2]-J)/n-.5}return T},loadFontFace:function(s,V){p.xhrLoad(s,function(I){if(!I)return V();var h;try{h=JSON.parse(I)}catch(z){h=JSON.parse(I.substring(65,I.length-2))}hq.loadFace(h),V&&V(h.familyName.toLowerCase())},V?null:{sync:!0})},getShaderErrorLog:function(){return jg.join("\n")},createRingModel:function(n,M,t,s,L,q,z,w,e,a){for(var r=[],G=0;G<n.length-1;G+=2)r.push({x:n[G],y:n[G+1]});q=q||p.shapeSide,z=z||0,w=w||q;var C,D,T,J,F,B,f,d,Q,k,G,N,i,m,x,Y,c,S,y=[],l=[],E=e?[]:g,K=e?[]:g,h=a?[]:g,H=a?[]:g,u=s?[]:g,b=s?[]:g,U=L?[]:g,R=L?[]:g,n=Ok(r,M,t),O=ud(n),v=0,j=2*Math.PI/q;return n.forEach(function(P){if(T=P.length,T>1){if(J=P[0],s)for(B=J.x,d=J.y,G=z;w>G;G++)N=G+1,i=G*j,m=N*j,x=W(i),Y=_(i),c=W(m),S=_(m),u.push(x*B,d,-Y*B,c*B,d,-S*B,0,d,0),b.push(.5-.5*x,.5-.5*Y,.5-.5*c,.5-.5*S,.5,.5);for(k=0;T>k;k++){for(F=P[k],B=J.x,f=F.x,d=J.y,Q=F.y,C=v/O,v+=lr(J,F),D=v/O,G=z;w>G;G++)N=G+1,i=G*j,m=N*j,x=W(i),Y=_(i),c=W(m),S=_(m),y.push(x*f,Q,-Y*f,c*f,Q,-S*f,x*B,d,-Y*B,c*f,Q,-S*f,c*B,d,-S*B,x*B,d,-Y*B),l.push(G/q,D,N/q,D,G/q,C,N/q,D,N/q,C,G/q,C),e&&G===z&&(E.push(0,d,0,0,Q,0,x*f,Q,-Y*f,x*f,Q,-Y*f,x*B,d,-Y*B,0,d,0),K.push(0,.5-d,0,.5-Q,2*f,.5-Q,2*f,.5-Q,2*B,.5-d,0,.5-d)),a&&N===w&&(h.push(0,d,0,c*f,Q,-S*f,0,Q,0,c*f,Q,-S*f,0,d,0,c*B,d,-S*B),H.push(1,.5-d,1-2*f,.5-Q,1,.5-Q,1-2*f,.5-Q,1,.5-d,1-2*B,.5-d));J=F}if(L)for(B=J.x,d=J.y,G=z;w>G;G++)N=G+1,i=G*j,m=N*j,x=W(i),Y=_(i),c=W(m),S=_(m),U.push(c*B,d,-S*B,x*B,d,-Y*B,0,d,0),R.push(.5-.5*c,.5+.5*S,.5-.5*x,.5+.5*Y,.5,.5)}}),{vs:y,uv:l,bottom_vs:U,bottom_uv:R,top_vs:u,top_uv:b,from_vs:E,from_uv:K,to_vs:h,to_uv:H}}},!0),oi(x,{"3d.move.mode":s,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"3d.reflectable":!0,"shape.border.gradient.color":s,"edge.gradient.color":s,"edge.source.t3":s,"edge.target.t3":s,"light.type":vd,"light.group":0,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":a/4,"light.range":0,"light.exponent":1,"light.intensity":1,"light.mask":Be,"headlight.ambientIntensity":s,"wf.visible":!1,"wf.width":1,"wf.color":_l,"wf.short":!1,"wf.mat":s,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:s,"transparent.mask":!1,brightness:s,"select.brightness":.7,"repeat.uv.length":s,"shadow.cast":!0,"shadow.receive":!0,"3d.clipbox":s,"3d.clipbox.mask":Be,"3d.clipbox.group":0,"effect.flow":!1,"effect.flow.gradient":"spread.horizontal","effect.flow.uvshape":"rect","effect.flow.size":512,"effect.flow.group":0,"effect.flow.intensity":1,"effect.flow.blend":s,"effect.flow.mask":Be,bloom:!1,envmap:0,"envmap.probe":0,roughness:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,"texture.cache":!1,"hide.overlapping.group":s,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.type":"hard","highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","highlight.glow":.8,"highlight.strength":2,"color.empty":[0,0,0,0],"label.face":Mh,"label.t3":s,"label.r3":s,"label.texture.scale":2,"label.rotationMode":Aq,"label.light":!1,"label.blend":s,"label.reverse.flip":!1,"label.reverse.color":Ck,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Mh,"label2.t3":s,"label2.r3":s,"label2.texture.scale":2,"label2.rotationMode":Aq,"label2.light":!1,"label2.blend":s,"label2.reverse.flip":!1,"label2.reverse.color":Ck,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Mh,"note.t3":s,"note.r3":s,"note.texture.scale":2,"note.rotationMode":Aq,"note.light":!1,"note.blend":s,"note.reverse.flip":!1,"note.reverse.color":Ck,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Mh,"note2.t3":s,"note2.r3":s,"note2.texture.scale":2,"note2.rotationMode":Aq,"note2.light":!1,"note2.blend":s,"note2.reverse.flip":!1,"note2.reverse.color":Ck,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:s,"shape3d.color":hi,"shape3d.top.color":s,"shape3d.bottom.color":s,"shape3d.from.color":s,"shape3d.to.color":s,"shape3d.image":s,"shape3d.image.projection":s,"shape3d.top.image":s,"shape3d.bottom.image":s,"shape3d.from.image":s,"shape3d.to.image":s,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":s,"shape3d.side.to":s,"shape3d.smooth":s,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":s,"shape3d.opacity":s,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Ck,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":s,"shape3d.uv.scale":s,"shape3d.uv.rotation":s,"shape3d.uv.anchor":s,"shape3d.top.uv.offset":s,"shape3d.top.uv.scale":s,"shape3d.top.uv.rotation":s,"shape3d.top.uv.anchor":s,"shape3d.bottom.uv.offset":s,"shape3d.bottom.uv.scale":s,"shape3d.bottom.uv.rotation":s,"shape3d.bottom.uv.anchor":s,"shape3d.from.uv.offset":s,"shape3d.from.uv.scale":s,"shape3d.from.uv.rotation":s,"shape3d.from.uv.anchor":s,"shape3d.to.uv.offset":s,"shape3d.to.uv.scale":s,"shape3d.to.uv.rotation":s,"shape3d.to.uv.anchor":s,"shape3d.top.cap":s,"shape3d.bottom.cap":s,"shape3d.start.angle":0,"shape3d.sweep.angle":L,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.blur":0,"shape3d.reflector.blur.iterations":1,"shape3d.reflector.background":null,"shape3d.reflector.clip":.003,"shape3d.reflector.shadow":"scene","camera.type":"perspective","camera.aspect":1,"camera.fovy":s,"camera.ortho.width":s,"camera.near":s,"camera.far":s,"camera.background":0,"camera.renderSky":!0,"camera.renderAxis":!1,"camera.renderGrid":!1,"camera.renderEdit":!1,"camera.onlySky":!1,"texture.mipmap.max":s,"texture.filter":s,"texture.filter.min":s,"texture.filter.mag":s,"texture.wrap":s,"points.image":"rect","points.color":"white","points.transparent":!1,"points.size":20,"points.opacity":1,"points.uv.scale":[1,1],"points.uv.offset":[0,0],"points.discard.selectable":!1,"all.light":!0,"all.visible":!0,"all.color":hi,"all.image":s,"all.blend":s,"all.opacity":s,"all.reverse.flip":!1,"all.reverse.color":Ck,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":s,"all.uv.offset":s,"all.uv.scale":s,"all.uv.rotation":s,"all.uv.anchor":s,"all.discard.selectable":!0,mat:s,"left.mat":s,"right.mat":s,"top.mat":s,"bottom.mat":s,"front.mat":s,"back.mat":s,"edge.source.anchor.elevation":s,"edge.target.anchor.elevation":s,"edge.source.offset.elevation":0,"edge.target.offset.elevation":0},!0);
var gf,gb=!1,hp=[0,0,0,0],Dd=function(u){return u instanceof Tr},gm=function(X){return[X.x,X.e||0,X.y]},Lh=function(m,d,L){for(var d=Jj(d||0),W=d[0],S=d[1],k=d[2];L--;)m.push(W,S,k)},$f=function(z,k,o){for(var k=Jj(k||0),L=k[0],d=k[1],A=k[2],_=k[3];o--;)z.push(L,d,A,_)},ln=function(H,u,L){if(u)for(var d,q,n,A=u[0],t=u[1],U=u[2],g=u[4],Q=u[5],m=u[6],v=u[8],O=u[9],f=u[10],i=u[12],Y=u[13],e=u[14],I=L.length,N=0,N=0;I>N;N+=3)d=L[N],q=L[N+1],n=L[N+2],H.push(A*d+g*q+v*n+i,t*d+Q*q+O*n+Y,U*d+m*q+f*n+e);else sb(H,L)},ym=function(U,L,H){var Q=L.s("light.intensity"),A=Jj(L.s($o)),V=A[0],T=A[1],B=A[2];1!==Q&&(V*=Q,T*=Q,B*=Q);var X=L.s("light.disabled");U.push(V,T,B,X?1:0),H.c.push(V,T,B),H.g.push(X?-1:L.s("light.group")),H.e.push(X?1:0)},Eo=function(v,b){var U=ts.for(b),q=U.directUniforms(),a=v._lastLightUploadInfo={c:[],g:[],e:[]};q.uHeadlightRange=v._headlightRange;var M=q.uHeadlightAmbientIntensity=v._headlightAmbientIntensity,g=v._headlightIntensity,l=Jj(v._headlightColor);1!==g&&(l=[l[0]*g,l[1]*g,l[2]*g]);var u;q.uHeadlightColor=[l[0],l[1],l[2],(u=v._headlightDisabled)?1:0],a.c.push(l[0],l[1],l[2]),a.g.push(u?-1:v._headlightGroup),a.e.push(u?1:0);var F=v._59O,f=v._spots,B=v._dirs;if(F.length){var k=[],I=[],Q=[];F.forEach(function(l){ym(k,l,a),sb(I,v._transformPointToViewSpace(l.p3())),Q.push(l.s("light.range"))}),q.uPointColor=k,q.uPointRange=Q,q.uPointPosition=I}if(f.length){var j=[],t=[],w=[],x=[],m=[],S=[];f.forEach(function(P){ym(j,P,a),sb(t,v._transformPointToViewSpace(P.p3())),sb(m,v._transformDirectionToViewSpace(P.p3(),P.s("light.center"))),w.push(P.s("light.range")),x.push(W(P.s("light.angle")/2)),S.push(P.s("light.exponent"))}),q.uSpotColor=j,q.uSpotRange=w,q.uSpotAngle=x,q.uSpotExponent=S,q.uSpotPosition=t,q.uSpotDirection=m}if(B.length){var Y=[],n=[];B.forEach(function(S){ym(Y,S,a),sb(n,v._transformDirectionToViewSpace(S.p3()))}),q.uDirColor=Y,q.uDirDirection=n}v._lastLightMask=Be,v._lastHeadlightAmbientIntensity=M},Hd=function(J,g,Y,T){if(T===s&&(T=J._headlightAmbientIntensity),T!==J._lastHeadlightAmbientIntensity&&(g.uHeadlightAmbientIntensity=J._lastHeadlightAmbientIntensity=T),Y!==J._lastLightMask){J._lastLightMask=Y;var Q=J._lastLightUploadInfo;if(Q){var w,A,r,D=Q.g,h=Q.e,P=D.length,t=new Array(P),x=!1;for(A=0;P>A;A++)w=D[A],r=0>w||w>=32?1:Y&1<<w?0:1,t[A]=r,r!==h[A]&&(x=!0);if(x){Q.e=h=t;var v=Q.c;g.uHeadlightColor=[v[0],v[1],v[2],h[0]];var o,L=J._59O,j=J._spots,p=J._dirs,Z=3,l=1;if(P=L.length){for(A=0,o=[];P>A;A++)o.push(v[Z++],v[Z++],v[Z++],h[l++]);g.uPointColor=o}if(P=j.length){for(A=0,o=[];P>A;A++)o.push(v[Z++],v[Z++],v[Z++],h[l++]);g.uSpotColor=o}if(P=p.length){for(A=0,o=[];P>A;A++)o.push(v[Z++],v[Z++],v[Z++],h[l++]);g.uDirColor=o}}}}},Gi=function(I,w){return Math.max(I.getRotateMinPhi()+bn,Math.min(I.getRotateMaxPhi()-bn,w))},Il=function(){return.05+Eg()/2},Sr=function(f,S,M,K){var i,E=f.getEye();return f.isOrtho()?(i=Nh(f.getCenter(),E),i[0]+=K[0],i[1]+=K[1],i[2]+=K[2]):i=E,ae(S,M,K,i)},ae=function(L,b,t,C){var m=Jq(L,b),D=Nh(C,t,!0),u=Jq(D,b);if(B(u)<bn)return g;var r=(m-Jq(t,b))/u;return[t[0]+D[0]*r,t[1]+D[1]*r,t[2]+D[2]*r]},_g=function(T,q){return{x:2*T.x-q.x,y:2*T.y-q.y}},Jp=function(H,I,P,z){var j,p;if(!H)return j=xb(I.y-P.y,P.x-I.x),{x:I.x+z*_(j),y:I.y+z*W(j)};if(!P)return j=xb(H.y-I.y,I.x-H.x),{x:I.x+z*_(j),y:I.y+z*W(j)};var L=Nh([H.x,H.y,0],[I.x,I.y,0],!0),i=Nh([P.x,P.y,0],[I.x,I.y,0],!0),r=-(L[0]+i[0])/2,X=-(L[1]+i[1])/2,K=w(r*r+X*X);if(bn>K)return j=xb(H.y-I.y,I.x-H.x),{x:I.x+z*_(j),y:I.y+z*W(j)};var q=H.x-I.x,T=H.y-I.y,R=P.x-I.x,u=P.y-I.y,k=w(q*q+T*T),x=w(R*R+u*u);j=Z(Jq(L,i))/2,p=L[1]*i[0]-L[0]*i[1]>0?-1:1,r/=K,X/=K;var d=z/_(j),e=N(k,x)/W(j);K=Math.min(d,e);var l={x:I.x+p*K*r,y:I.y+p*K*X};return P.b&&d>x/W(j)&&(l.adjust=!0),l},Fj=function(_){var r=_[1],Y=_[2],R=_[3],a=_[6],q=_[7],E=_[11];_[1]=_[4],_[2]=_[8],_[3]=_[12],_[4]=r,_[6]=_[9],_[7]=_[13],_[8]=Y,_[9]=a,_[11]=_[14],_[12]=R,_[13]=q,_[14]=E},Pr=function(c){var s=c[0],P=c[1],Y=c[2],U=c[3],v=c[4],D=c[5],q=c[6],f=c[7],n=c[8],m=c[9],W=c[10],_=c[11],M=c[12],R=c[13],L=c[14],d=c[15],w=s*D-P*v,T=s*q-Y*v,i=s*f-U*v,t=P*q-Y*D,k=P*f-U*D,B=Y*f-U*q,z=n*R-m*M,E=n*L-W*M,V=n*d-_*M,Q=m*L-W*R,b=m*d-_*R,A=W*d-_*L,o=w*A-T*b+i*Q+t*V-k*E+B*z;return o?(o=1/o,c[0]=(D*A-q*b+f*Q)*o,c[1]=(Y*b-P*A-U*Q)*o,c[2]=(R*B-L*k+d*t)*o,c[3]=(W*k-m*B-_*t)*o,c[4]=(q*V-v*A-f*E)*o,c[5]=(s*A-Y*V+U*E)*o,c[6]=(L*i-M*B-d*T)*o,c[7]=(n*B-W*i+_*T)*o,c[8]=(v*b-D*V+f*z)*o,c[9]=(P*V-s*b-U*z)*o,c[10]=(M*k-R*i+d*w)*o,c[11]=(m*i-n*k-_*w)*o,c[12]=(D*E-v*Q-q*z)*o,c[13]=(s*Q-P*E+Y*z)*o,c[14]=(R*T-M*t-L*w)*o,c[15]=(n*t-m*T+W*w)*o,void 0):g},Lj=function($,K){if(K){var O=K[0],t=K[1],H=K[2];$[12]=$[0]*O+$[4]*t+$[8]*H+$[12],$[13]=$[1]*O+$[5]*t+$[9]*H+$[13],$[14]=$[2]*O+$[6]*t+$[10]*H+$[14],$[15]=$[3]*O+$[7]*t+$[11]*H+$[15]}},Ng=function(t,I){if(I){var F=I[0],C=I[1],x=I[2];t[0]=t[0]*F,t[1]=t[1]*F,t[2]=t[2]*F,t[3]=t[3]*F,t[4]=t[4]*C,t[5]=t[5]*C,t[6]=t[6]*C,t[7]=t[7]*C,t[8]=t[8]*x,t[9]=t[9]*x,t[10]=t[10]*x,t[11]=t[11]*x}},$c=function(y,R,M){var g=R[0],e=R[1],u=R[2],f=R[3],s=R[4],Y=R[5],$=R[6],c=R[7],v=R[8],n=R[9],h=R[10],Z=R[11],j=R[12],b=R[13],K=R[14],U=R[15],G=M[0],H=M[1],D=M[2],N=M[3];return y[0]=G*g+H*s+D*v+N*j,y[1]=G*e+H*Y+D*n+N*b,y[2]=G*u+H*$+D*h+N*K,y[3]=G*f+H*c+D*Z+N*U,G=M[4],H=M[5],D=M[6],N=M[7],y[4]=G*g+H*s+D*v+N*j,y[5]=G*e+H*Y+D*n+N*b,y[6]=G*u+H*$+D*h+N*K,y[7]=G*f+H*c+D*Z+N*U,G=M[8],H=M[9],D=M[10],N=M[11],y[8]=G*g+H*s+D*v+N*j,y[9]=G*e+H*Y+D*n+N*b,y[10]=G*u+H*$+D*h+N*K,y[11]=G*f+H*c+D*Z+N*U,G=M[12],H=M[13],D=M[14],N=M[15],y[12]=G*g+H*s+D*v+N*j,y[13]=G*e+H*Y+D*n+N*b,y[14]=G*u+H*$+D*h+N*K,y[15]=G*f+H*c+D*Z+N*U,y},hm=function(Y,u,J,G){var $,f,l,m,y,k,L,K,g,C,a=u[0],e=u[1],Q=u[2],F=G[0],V=G[1],O=G[2],E=J[0],M=J[1],o=J[2];return B(a-E)<bn&&B(e-M)<bn&&B(Q-o)<bn?Qd(Y):(L=a-E,K=e-M,g=Q-o,C=1/w(L*L+K*K+g*g),L*=C,K*=C,g*=C,$=V*g-O*K,f=O*L-F*g,l=F*K-V*L,C=w($*$+f*f+l*l),C?(C=1/C,$*=C,f*=C,l*=C):($=0,f=0,l=0),m=K*l-g*f,y=g*$-L*l,k=L*f-K*$,C=w(m*m+y*y+k*k),C?(C=1/C,m*=C,y*=C,k*=C):(m=0,y=0,k=0),Y[0]=$,Y[1]=m,Y[2]=L,Y[3]=0,Y[4]=f,Y[5]=y,Y[6]=K,Y[7]=0,Y[8]=l,Y[9]=k,Y[10]=g,Y[11]=0,Y[12]=-($*a+f*e+l*Q),Y[13]=-(m*a+y*e+k*Q),Y[14]=-(L*a+K*e+g*Q),Y[15]=1,Y)},ls=function(J,h,n,o,K){var N=1/Zo(h/2),m=1/(o-K);return J[0]=N/n,J[1]=0,J[2]=0,J[3]=0,J[4]=0,J[5]=N,J[6]=0,J[7]=0,J[8]=0,J[9]=0,J[10]=(K+o)*m,J[11]=-1,J[12]=0,J[13]=0,J[14]=2*K*o*m,J[15]=0,J},us=function(n,t,W,h,Y,u,L){var S=1/(t-W),p=1/(h-Y),e=1/(u-L);return n[0]=-2*S,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*p,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*e,n[11]=0,n[12]=(t+W)*S,n[13]=(Y+h)*p,n[14]=(L+u)*e,n[15]=1,n},Bd=function(E,U){var e=U[0],Q=U[1],q=U[2],Y=U[3],X=e*e+Q*Q+q*q+Y*Y,J=X?1/X:0;return E[0]=-e*J,E[1]=-Q*J,E[2]=-q*J,E[3]=Y*J,E},Kf=function(S,P){var j=P[0]+P[5]+P[10],s=0;return j>0?(s=2*Math.sqrt(j+1),S[3]=.25*s,S[0]=(P[6]-P[9])/s,S[1]=(P[8]-P[2])/s,S[2]=(P[1]-P[4])/s):P[0]>P[5]&P[0]>P[10]?(s=2*Math.sqrt(1+P[0]-P[5]-P[10]),S[3]=(P[6]-P[9])/s,S[0]=.25*s,S[1]=(P[1]+P[4])/s,S[2]=(P[8]+P[2])/s):P[5]>P[10]?(s=2*Math.sqrt(1+P[5]-P[0]-P[10]),S[3]=(P[8]-P[2])/s,S[0]=(P[1]+P[4])/s,S[1]=.25*s,S[2]=(P[6]+P[9])/s):(s=2*Math.sqrt(1+P[10]-P[0]-P[5]),S[3]=(P[1]-P[4])/s,S[0]=(P[8]+P[2])/s,S[1]=(P[6]+P[9])/s,S[2]=.25*s),S},pf=function(P,o,h){var j=o[0],z=o[1],n=o[2],d=o[3],a=j+j,S=z+z,p=n+n,k=j*a,L=j*S,C=j*p,J=z*S,v=z*p,K=n*p,I=d*a,l=d*S,y=d*p;return P[0]=1-(J+K),P[1]=L+y,P[2]=C-l,P[3]=0,P[4]=L-y,P[5]=1-(k+K),P[6]=v+I,P[7]=0,P[8]=C+l,P[9]=v-I,P[10]=1-(k+J),P[11]=0,P[12]=h[0],P[13]=h[1],P[14]=h[2],P[15]=1,P},rr=function(P,M){if(P.isVREnabled()){var E=P.vr.getViewMatrix(M);if(E)return E}return P._camera?P._camera.getViewMatrix(M):hm(M?M:Wq(),P._eye,P._center,P._up)},Mc=function(v,x){if(v.isVREnabled()){var t=v.vr.getProjectMatrix();if(t)return t}if(v._camera)return v._camera.getProjectMatrix();if(!x&&v._computedProjectMatrix)return Km(v._computedProjectMatrix);var l=v.getAspect(),B=v._near,M=v._far,Q=Wq();if(v._ortho){var o=v._orthoWidth/2,e=o/l;us(Q,-o,o,-e,e,B,M)}else ls(Q,v._fovy,l,B,M);return Q},Cl=function(_,b){if(!_)return g;var r=0,z=1,h=2,L=[],n=0,O=_.length,D=O/3;if(b){for(;O>n;n++)L[n]=0;for(n=0;n<b.length;n+=3){var i=[],c=[],l=[];i[r]=_[3*b[n+1]+r]-_[3*b[n]+r],i[z]=_[3*b[n+1]+z]-_[3*b[n]+z],i[h]=_[3*b[n+1]+h]-_[3*b[n]+h],c[r]=_[3*b[n+2]+r]-_[3*b[n+1]+r],c[z]=_[3*b[n+2]+z]-_[3*b[n+1]+z],c[h]=_[3*b[n+2]+h]-_[3*b[n+1]+h],l[r]=i[z]*c[h]-i[h]*c[z],l[z]=i[h]*c[r]-i[r]*c[h],l[h]=i[r]*c[z]-i[z]*c[r];for(var M=0;3>M;M++)L[3*b[n+M]+r]+=l[r],L[3*b[n+M]+z]+=l[z],L[3*b[n+M]+h]+=l[h]}}else for(n=0;D>n;n+=3){var i=[],c=[],l=[];i[r]=_[3*(n+1)+r]-_[3*n+r],i[z]=_[3*(n+1)+z]-_[3*n+z],i[h]=_[3*(n+1)+h]-_[3*n+h],c[r]=_[3*(n+2)+r]-_[3*(n+1)+r],c[z]=_[3*(n+2)+z]-_[3*(n+1)+z],c[h]=_[3*(n+2)+h]-_[3*(n+1)+h],l[r]=i[z]*c[h]-i[h]*c[z],l[z]=i[h]*c[r]-i[r]*c[h],l[h]=i[r]*c[z]-i[z]*c[r];for(var M=0;3>M;M++)L[3*(n+M)+r]=l[r],L[3*(n+M)+z]=l[z],L[3*(n+M)+h]=l[h]}for(n=0;O>n;n+=3){var v=[];v[r]=L[n+r],v[z]=L[n+z],v[h]=L[n+h];var F=w(v[r]*v[r]+v[z]*v[z]+v[h]*v[h]);0===F&&(F=bn),v[r]=v[r]/F,v[z]=v[z]/F,v[h]=v[h]/F,L[n+r]=v[r],L[n+z]=v[z],L[n+h]=v[h]}return new Yp(L)},Re=function(f,_,F,u){if(F||(F=f.createTexture()),_){var t=f.TEXTURE_2D,O=f.REPEAT,h=f.CLAMP_TO_EDGE,b=f.TEXTURE_MIN_FILTER;u=u||pr;var W=u.minFilter||u.filter||f.LINEAR,M=u.magFilter||u.filter||f.LINEAR;f.activeTexture(f.TEXTURE0),nm(f,F),f.texImage2D(t,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,_),Fo(f,f.TEXTURE_MAG_FILTER,M);var x=_.naturalWidth||_.width,L=_.naturalHeight||_.height;fo.isPOT(x)&&fo.isPOT(L)&&!u.clampToEdge&&!_.clampToEdge?(Fo(f,f.TEXTURE_WRAP_S,O),Fo(f,f.TEXTURE_WRAP_T,O),Fo(f,b,W===f.NEAREST?f.NEAREST_MIPMAP_NEAREST:f.LINEAR_MIPMAP_LINEAR),u.mipmapMaxLevel!==s&&Fo(f,f.TEXTURE_MAX_LEVEL,u.mipmapMaxLevel),f.generateMipmap(t)):(Fo(f,f.TEXTURE_WRAP_S,h),Fo(f,f.TEXTURE_WRAP_T,h),Fo(f,b,W)),nm(f,g)}return F},dp=function(x,q,v){var B=new Uint8Array(v||4);return q=q||x.createTexture(),x.activeTexture(x.TEXTURE0),nm(x,q),Fo(x,x.TEXTURE_MIN_FILTER,x.LINEAR),x.texImage2D(x.TEXTURE_2D,0,x.RGBA,1,1,0,x.RGBA,x.UNSIGNED_BYTE,B),q},Hc=function(B,c,h){var a=new Uint8Array(h||4);return c=c||B.createTexture(),B.activeTexture(B.TEXTURE0),B.bindTexture(B.TEXTURE_CUBE_MAP,c),B.texParameteri(B.TEXTURE_CUBE_MAP,B.TEXTURE_MAG_FILTER,B.LINEAR),B.texParameteri(B.TEXTURE_CUBE_MAP,B.TEXTURE_MIN_FILTER,B.LINEAR),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,B.RGBA,1,1,0,B.RGBA,B.UNSIGNED_BYTE,a),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,B.RGBA,1,1,0,B.RGBA,B.UNSIGNED_BYTE,a),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,B.RGBA,1,1,0,B.RGBA,B.UNSIGNED_BYTE,a),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,B.RGBA,1,1,0,B.RGBA,B.UNSIGNED_BYTE,a),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,B.RGBA,1,1,0,B.RGBA,B.UNSIGNED_BYTE,a),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,B.RGBA,1,1,0,B.RGBA,B.UNSIGNED_BYTE,a),c},Nn=function(h){h._26I&&h._prg&&(h._26I.deleteProgram(h._prg),h._prg=g)},Fd=function(){function l(I){if(I.match(x))return vs(I);var C=K[I];if(C)return C;var L=new RegExp("#define\\s+"+I+"\\s+(\\d+)"),y=v.match(L);return K[I]=y?vs(y[1]):0}function g(m){K={},v=m;var B=m.replace(t,_).replace(L,y);return v=null,K=null,B}function _(c,$,S){S=l(S);for(var b="",O=0;S>O;O++)b+=$+O+";";return b}function y(H,B,D,P){for(var a="",u=l(B);u<l(D);u++)a+=P.replace(/\[\s*i\s*\]/g,"["+u+"]").replace(/\[\s*I\s*\]/g,u);return a}var K,v,t=/(uniform\s+sampler2D\s+\w+)\[([\S\d]+)\];/g,L=/#UNROLL_LOOP_START\s+for\s*\(\s*int\s+i\s*=\s*([\S\d]+)\s*;\s*i\s*<\s*([\S\d]+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#UNROLL_LOOP_END/g,x=/^\d+$/;return function(D){return g(D)}}(),nf=function(G,z,x,h){var P=G.createShader(x);return G.shaderSource(P,Fd(h)),G.compileShader(P),G.attachShader(z,P),P},yg=function(i){return i.createBuffer()},nm=function(b,U){b.bindTexture(b.TEXTURE_2D,U||b._emptyTexture)},Fo=function(u,b,c){u.texParameteri(u.TEXTURE_2D,b,c)},Vj=function(L,W){var G=ts.for(L).directState();G.polygonOffset.enabled=!0,G.polygonOffset.value=W},Ln=function(G){var J=ts.for(G).directState();J.polygonOffset.enabled=!1},Un=function(k,W){if(W){var z=ts.for(k).directState();z.color.clear=Jj(W)}},og=function(R,G,F){if(F!==G._lastClipboxEnabled){var J=R._boxClipperGroups,u=J?J.length:0,x=new Array(u);if(F)for(var _=0;u>_;_++)F&1<<J[_]&&(x[_]=!0);G._lastClipboxEnabled=F,G.uEnableBoxClip=x}},mi=og,ke=function(M){var g=ts.for(M),H=g.directUniforms(),l=g.directAttribs();H.uFix=!0,l.aNormal=!1},Yf=function(r){var j=ts.for(r),I=j.directUniforms();j.directAttribs(),I.uFix=!1},oe=function(B,v,k,i,I,x,E,f){var _=ts.for(B),Q=_.directState(),T=_.directUniforms();B._picking||(k?(T.uBlend=!0,T.uBlendColor=k):T.uBlend=!1,T.uLight=i==g?!0:i,Jr(I)&&1!==I&&(T.uPartOpacity=I),T.uReverseFlip=x==g?!1:x,T.uFixPickReverseColor=E||Ck),Q.cullFace.enabled=f?!0:!1},eq=function(y){if(!y._picking){var $=ts.for(y),p=$.directUniforms();p.uPartOpacity=1}},eh=function(){var c=new U.Math.Matrix2d,w=[1,0,0,0,1,0,0,0,0];return function(y,_,f,I,u,x,e,H,s,l,h){var m=ts.for(y),L=m.directUniforms(),i=m.directAttribs();return f?(L.uTexture=!0,L.uDiscardSelectable=Tg(I)?I:!0,i.aUv=bo(y,u,x,g,2),h?(L.uBlendTexture=!0,L.uBlendSampler=h):(L.uBlendTexture=!1,L.uBlendSampler=y._emptyBlendTexture),L.uSampler=f,L.uUvMatrix=e||H||s||l?le(s,e,H,l,c).toArray9():w,void 0):(L.uSampler=y._emptyTexture,L.uBlendSampler=y._emptyBlendTexture,void 0)}}(),uk=function(o,e,f){var c=ts.for(o),X=c.directUniforms(),Y=c.directAttribs();o.activeTexture(o.TEXTURE0),nm(o,g),o.activeTexture(o.TEXTURE1),nm(o,g),f&&(Y.aUv=!1,X.uTexture=!1,X.uSampler=o._emptyTexture,X.uBlendTexture=!1,X.uBlendSampler=o._emptyBlendTexture)},hr=function(A,H,h,o,p,Q){var M=ts.for(A),s=M.directUniforms(),j=M.directAttribs();!h||uc||rg||A.lineWidth(h),o&&!A._picking&&(s.uFixPickReverseColor=o),p&&(j.aPosition=bo(A,p,Q,g))},Co=function(F,w,i,Q){gf&&(Q=F[gf]),F.drawArrays(Q==g?F.TRIANGLES:Q,w,i);var q=F._renderInfo;q&&(q.calls++,q.vertices+=i,(Q==g||Q===F.TRIANGLES)&&(q.faces+=i/3),Q===F.LINES&&(q.lines+=i/2),Q===F.POINTS&&(q.points+=i))},ih=function(Z,W,G,I,s){gf&&(I=Z[gf]),Z.drawElements(I==g?Z.TRIANGLES:I,G,s==g?Z.UNSIGNED_SHORT:s,W==g?0:2*W);var k=Z._renderInfo;k&&(k.calls++,k.vertices+=G,(I==g||I===Z.TRIANGLES)&&(k.faces+=G/3),I===Z.LINES&&(k.lines+=G/2),I===Z.POINTS&&(k.points+=G))},Yr=function(t,r,P){var B=t.ARRAY_BUFFER;return t.bindBuffer(B,r),P&&t.bufferData(B,P,t.STATIC_DRAW),r},bo=function(z,I,J,c,T){return J?vn(z,z.ARRAY_BUFFER,I,J):Yr(z,I,J,c,T)},rf=function(Z,l,r){var T=Z.ELEMENT_ARRAY_BUFFER;Z.bindBuffer(T,l),r&&Z.bufferData(T,r,Z.STATIC_DRAW)},Zr=function(c,K,E){vn(c,c.ELEMENT_ARRAY_BUFFER,K,E)},vn=function(O,c,P,r){var W=r._bufId;W||(W=r._bufId=U.Math.generateIncreasingID());var P,u=O._bufPool;return(P=u[W])&&P._buf?O.bindBuffer(c,P._buf):(P=u[W]={_buf:yg(O)},O.bindBuffer(c,P._buf),O.bufferData(c,r,O.STATIC_DRAW)),P._fid=O._renderInfo.frame,P._buf},yp=function(k,j){j!=g&&j>=0&&k.enableVertexAttribArray(j)},kq=function(v,p){p!=g&&p>=0&&v.disableVertexAttribArray(p)},ur=function(o,X){var k=o.getGL(),O=ts.for(k),y=O.directUniforms();o._7O=o._8O.pop(),X&&(y.uMVMatrix=o._7O,o._6O=X,y.uNMatrix=X)},$k=function(r,h){return h||(h=Wq()),Yq(h,r),Pr(h),Fj(h),h},hn=function(z,P){var V=z.getGL(),n=z._7O,h=ts.for(V),g=h.directUniforms();P?(z._8O.push(Km(n)),g.uMMatrix=P,$c(n,n,P),z._7O=n):g.uMMatrix=Rp,g.uMVMatrix=n,g.uNMatrix=$k(n,z._6O)},tf={body:0,label:1,label2:2,note:3,note2:4,symbol:5},Im=10,Qo=function(T,h,I,Y,C,L){var K;if(I){var V=Y._pickId;V||(V=Y._pickId=h._pickIdUsed,h._pickIdUsed+=Im);var A,O=tf[C];if(null!=O)A=V+O;else{var R=Y._pickExtraPartMap;R||(R=Y._pickExtraPartMap={}),(A=R[C])||(A=R[C]=h._pickIdUsed++)}h[A]||(h[A]={data:Y.data,part:C}),K=Ks(A)}else K=hp;if(!L){var v=ts.for(T),l=v.directUniforms();l.uFixPickReverseColor=K}return K},bb=Qo,Pn=function(S,U,C){"target"!==C&&(C="source");var i="target"===C?U.getTargetAgent():U.getSourceAgent(),y="edge."+C+".";if(Ob(i)){var R=U.s(y+"anchor.x"),d=U.s(y+"anchor.elevation"),g=U.s(y+"anchor.y"),b=Ph(i,S.getMat(i)),o=i.getAnchor3d(),l=aq([(R===s?.5:R)-o.x,(d===s?.5:d)-o.y,(g===s?.5:g)-o.z],b);return l[1]+=U.s(y+"offset.elevation"),l}var A=U.s(y+"index"),L=S.getData3dUI(i);if(!L.info||!L.info.list)return!1;if(A>=0){var t,Q,W,E,z,M=L.info._lastPointsSegments,K=M.points,c=M.segments,r=-1,V=-1;for(W=0,E=c?c.length:K.length;E>W;W++){if(Q=c?c.get(W):1,3===Q)z=2;else if(4===Q)z=3;else{if(5===Q)continue;z=1}if(r+=z,V++,V===A){t=K.get(r);break}}return t||(t=K.get(K.length-1)),[t.x,(t.e||0)+U.s(y+"offset.elevation"),t.y]}var f=U.s(y+"percent")||.5;if(f=Math.max(0,Math.min(f,1)),!L||!L.getCache)return!1;var h=L.getCache(),E=h[h.length-1].length,M=S.getLineOffset(i,f*E),l=M.point;return[l.x,l.y+U.s(y+"offset.elevation"),l.z]},ef=function(){var i={center:function(S,u,s,$,i){var H=-u[1]/2,Y={x:-u[0]/2,y:H,width:u[0],height:u[1]},d=xm(S,Y,s);return[d.x+$,-d.y-i,p.getPosition3dGap()]},front:function(R,r,A,X,u){var Y=-r[1]/2,j={x:-r[0]/2,y:Y,width:r[0],height:r[1]},O=xm(R,j,A);return[O.x+X,-O.y-u,r[2]/2+p.getPosition3dGap()]},back:function(A,Q,o,G,z){var N=-Q[0]/2,W=-Q[1]/2,x={x:N,y:W,width:Q[0],height:Q[1]},X=xm(A,x,o);return[-X.x-G,-X.y-z,-Q[2]/2-p.getPosition3dGap()]},left:function(K,S,x,Y,N){var V=-S[1]/2,L={x:-S[2]/2,y:V,width:S[2],height:S[1]},v=xm(K,L,x);return[-S[0]/2-p.getPosition3dGap(),-v.y-N,v.x+Y]},right:function(C,o,W,c,d){var b=-o[2]/2,K=-o[1]/2,H={x:b,y:K,width:o[2],height:o[1]},v=xm(C,H,W);return[o[0]/2+p.getPosition3dGap(),-v.y-d,-v.x-c]},top:function(E,m,V,C,q){var L={x:-m[0]/2,y:-m[2]/2,width:m[0],height:m[2]},y=xm(E,L,V);return[y.x+C,m[1]/2+p.getPosition3dGap(),y.y+q]},bottom:function(J,x,m,d,v){var N=-x[2]/2,V={x:-x[0]/2,y:N,width:x[0],height:x[2]},M=xm(J,V,m);return[M.x+d,-x[1]/2-p.getPosition3dGap(),-M.y-v]}};return function(B,Y,e,S,P,q){return i[S](B,Y,e,P||0,q||0)}}(),al=function(i,V,x,g,H,m,F,$,z,E){if(H&&(V[0]+=H[0],V[1]+=H[1],V[2]+=H[2]),Lj(i,x),$){var h=Wq();if(Pl(h,z,E),aq(V,h),Lj(i,V),i.auto=$,i.pos=aq([0,0,0],i),m){var r=i.mat2=Wq();Pl(r,m,F)}}else Pl(i,z,E),Lj(i,V),g===Vn?lq(i,-zp):g===qp?lq(i,zp):g===$l?Ul(i,-zp):g===ep?Ul(i,zp):g===xc&&lq(i,a),Pl(i,m,F);return i},Rb=function(t,N){var v=N.auto,n=N.mat2,R=t.gv;if(v){var V,r=Wq(),D=[0,0,0,0];V="string"==typeof v?[v.indexOf("x")<0?R._eye[0]:R._center[0],v.indexOf("y")<0?R._eye[1]:R._center[1],v.indexOf("z")<0?R._eye[2]:R._center[2]]:R._eye,Kf(D,hm(Wq(),V,R._center,R._up)),pf(r,Bd(D,D),N.pos),n&&$c(r,r,n),hn(R,r)}else hn(R,N)},sk=function(C,a,A,S,x){var Z=C.s,G=C.gv,b=G.getGL(),t=G._prg,W=G._buffer,B=G._1O,H=ts.for(b),J=H.directAttribs();Re(b,tk,B),Rb(C,A),oe(b,t,Z(a+".blend"),Z(a+".light"),Z(a+".opacity"),Z(a+".reverse.flip"),Z(a+".reverse.color"),Z(a+".reverse.cull")),eh(b,t,B,x,W.uv,wf),J.aPosition=bo(b,W.vs,S,g),J.aNormal=bo(b,W.ns,un,g),Zr(b,W.is,Fn),ih(b,0,Fn.length),uk(b,t,B),eq(b,t),ur(G)},vo=function(V,T,E){var w=V.gv,F=V.data,D=V[T]={blend:w.getBodyColor(F)||w.getFaceBlend(F,T),light:w.getFaceLight(F,T),color:w.getFaceColor(F,T),opacity:w.getFaceOpacity(F,T),transparent:w.getFaceTransparent(F,T),reverseFlip:w.getFaceReverseFlip(F,T),reverseColor:w.getFaceReverseColor(F,T),reverseCull:w.getFaceReverseCull(F,T),texture:w.getFaceImage(F,T),blendTexture:w.getFaceBlendImage(F,T),discardSelectable:w.getFaceDiscardSelectable(F,T)};if("csg"!==T){D.uv=w.getFaceUv(F,T)||E&&E[T+"Uv"],D.uvScale=w.getFaceUvScale(F,T)||E&&E[T+"UvScale"],D.uvOffset=w.getFaceUvOffset(F,T)||E&&E[T+"UvOffset"],D.uvRotation=w.getFaceUvRotation(F,T)||E&&E[T+"uvRotation"],D.uvAnchor=w.getFaceUvAnchor(F,T)||E&&E[T+"uvAnchor"];var x=w.getFaceMat(F,T);if(x){var K=Ph(F,x);F.appendAnchorMatrix3d(K),D.mat=K}}return D},hs=function(k,h,l,i,j){var P=k[i];if(P){if(!j(P.transparent))return;var e=k.data,s=k.gv,S=s._buffer,r=s.getTexture(P.texture,e,i),E=s.getTexture(P.blendTexture,e),X=ts.for(h),w=X.directUniforms(),K=X.directAttribs();eh(h,l,r,P.discardSelectable,S.uv,P.tuv,P.uvOffset,P.uvScale,P.uvRotation,P.uvAnchor,E),oe(h,l,P.blend,P.light,P.opacity,P.reverseFlip,P.reverseColor,P.reverseCull),P.cs&&!s._batchColorDisabled?(w.uBatchColor=!0,K.aBatchColor=bo(h,S.batchColor,P.cs,l.aBatchColor,4)):w.uDiffuse=P.color||x["color.empty"],K.aPosition=bo(h,S.vs,P.vs,g),K.aNormal=bo(h,S.ns,P.ns,g),Co(h,0,P.vs.length/3),P.cs&&!s._batchColorDisabled&&(w.uBatchColor=!1,kq(h,l.aBatchColor)),eq(h,l),uk(h,l,r)}},gi=function(F,N,O){Vd(F)?F.forEach(function(w){gi(w,N,O)}):Xj(F)?gi(ub(N,F),N,O):Np(F)?F.shape3d?gi(F.shape3d,N,O):O.push(F):O.push(F)},Jo=function(){for(var $=50,H=arguments.length,k=[],T=0;H>T;T++)k[T]=arguments[T];jg[_k]="Time : "+(new Date).toLocaleString()+", Info :"+k.join(", "),_k=(_k+1)%$,console.error("Failed to create shader.")},le=function(){var e=new fo.Matrix2d;return function(V,l,x,q,h){return h||(h=e),h.identity(),q&&h.translate(-q[0],-q[1]),x&&h.scale(x[0],x[1]),V&&h.rotate(V),q&&h.translate(q[0],q[1]),l&&h.translate(l[0],l[1]),h}}(),Mf=function(h,b,r,u,e,H){var O,g,I,M,Y,P,Q,m,z,y,T,p=[u-b,e-r],U=h?h.length:0;for(I=0;U>I;I++){for(M=2,O=h[I],Y=O[0],P=O[1];M+1<O.length;){if(Q=O[M],m=O[M+1],g=Zh(b,r,u,e,Y,P,Q,m,!0)){z=[Q-Y,m-P],y=lr(z),z[0]/=y,z[1]/=y,y=Jq(p,z),y=y>0?H:-H,T=[z[0]*y,z[1]*y];break}Y=Q,P=m,M+=2}if(T)break}if(T)for(u=b+T[0],e=r+T[1],I=0;U>I;I++)for(M=2,O=h[I],Y=O[0],P=O[1];M+1<O.length;){if(Q=O[M],m=O[M+1],g=Zh(b,r,u,e,Y,P,Q,m,!0))return[0,0];Y=Q,P=m,M+=2}return T?T:[u-b,e-r]},Db=function(L){return"nearest"===L?gq.NEAREST:"linear"===L?gq.LINEAR:L},dd=U.graph3d={WebGLConstants:gq},Mg=function(h,s,T){zs(e+".graph3d."+h,s,T)},No="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<6/1!,!*{/mbdpMwVxpmg!,!z/mbdpMwVxpmg!-y/mbdpMwVxpmg)3dfw!>!^j]wVxpmg<{zy/**1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!^j]yjsubNxpmg)!>!mbdpMwVxpmg|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1>j!uoj)spg<mbdpMwVxpmg!4dfw1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!<*1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!QBNXPEBIT`FTV!gfegj$!!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw!gjeof$!~!1!>>!SFQQJMD`YPC`YBN!gj$!<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!gjeof$!|*ldjQva!%%!yjGva)gj!1!>>!SFQQJMD`YPC`YBN!gj$!<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw<^UDFKCP`XPMG`YBN]yjsubNxpmg!5ubn!nspgjov1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!<esppDxpebit!5dfw!hojzsbw<yjsubNxpebit!5ubn!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<yjsubNwVv!4ubn!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Eb="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVw!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ!gjeof$!<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg!ftmf$!<*iuqfe!+!iuqfe!+!zujtofEhpGv!+!zujtofEhpGv!.)qyf!.!1/2!>!spudbGhpg!ubpmg!3QYF`HPG!gfegj$!<{/yfusfWw.!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!!EOF`QPPM`MMPSOV$!~<chs/*^j]wVxpmg!-^J]fsvuyfUxpmg)E3fsvuyfu!!>,!chs/eJ!****1/1)3dfw!-^j]wVxpmg)obiUsfubfsh)mmb!%%!***1/2)3dfw!-^j]wVxpmg)obiUttfm)mmb!%%!^j]efmcboFxpmg)!gj|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1>j!uoj)!spg!USBUT`QPPM`MMPSOV$!!1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ!gjeof$!<*spmpDwof)sbfojMpUmfyfUqbNwof!>!spmpDwof<**{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv)fcvDfsvuyfu!>!spmpDwof!5dfw!ftmf$!<**ttfoihvps!-*{z/dfWudfmgfs!-y/dfWudfmgfs.)4dfw!-qbNwoFv)WVfcvDfsvuyfu)CHStpUsbfojM!>!spmpDwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!<*mbnspOemspx!-yfusfWpUbsfnbd)udfmgfs!>!dfWudfmgfs!4dfw<*yjsubNxfjWv!-O)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*opjujtpQbsfnbDv!.!emspXw)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!gjeof$!~<fvmbWxpebit!+!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm!~!!<osvufs!<esbdtje!!|!*1/1!>>!fvmbWxpebit!%%!mmvDxpebit)!gj<*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit)xpebiTufh!.!1/2!>!fvmbWxpebit!ubpmg|!*fwjfdfSxpebit)!gj!QBNXPEBIT`FTV!gfegj$!~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*fdobutjEitbEv!?!*fdobutjEqbHitbEv!-fdobutjEfojMw)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~!<osvufs!<*1/2!-1/1!-1/1!-1/1)5dfw!>!spmpDhbsG`mh!|!*uvpldbmc)!gj!gjeof$!~~!<osvufs!<esbdtje!|!****ojNqjmd!-mbdpMw)obiUsfubfsh)mmb!%%!**ybNqjmd!-mbdpMw)obiUttfm)mmb)!>a!^j]sfooJqjmDsfqqjmDv!%%!^j]qjmDypCfmcboFv)!gj<**1/2!-emspXw)5dfw!+!^j]yjsubNsfqqjmDv)4dfw!>!mbdpMw|!*,,j!<SFQQJMD`YPC`YBN!=!j!<1>j!uoj)spg<mbdpMw!4dfw!1!?!SFQQJMD`YPC`YBN!gj$!~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw<uvpldbmc!mppc!nspgjov!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw<^UDFKCP`XPMG`YBN]efmcboFxpmg!mppc!nspgjov<^UDFKCP`XPMG`YBN]fsvuyfUxpmg!E3sfmqnbt!nspgjov!1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!!gjeof$!!~~<*1/2!-*Gqjn!-2spmpd!-1spmpd)yjn)5dfw!osvufs<*1/2!,!uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!2spmpd!4dfw|!ftmf!~<*1/2!-1spmpd)5dfw!osvufs|!*1/1!>>!Gqjn)!gj<*uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!1spmpd!4dfw<*qjn)sppmg!>!uoJqjn!ubpmg<*qjn)udbsg!>!Gqjn!ubpmg<*mfwfMqjNybn`WVfcvd!-1n!-*ttfoihvps)qjNpUttfoihvps)qnbmd!>!qjn!ubpmg|!*ttfoihvps!ubpmg!-sjEfmqnbt!4dfw!-qbNwof!E3sfmqnbt)WVfcvDfsvuyfu!5dfw!~<qjn!osvufs~<*ttfoihvps!+!72/2)3hpm!+!1/3!.!>!qjn|!ftmf!~<6n!,!*7s!.!6s)!0!*6n!.!7n)!+!*ttfoihvps!.!6s)!>!qjn|!*7s!>?!ttfoihvps)!gj!ftmf!~<5n!,!*6s!.!5s)!0!*5n!.!6n)!+!*ttfoihvps!.!5s)!>!qjn|!*6s!>?!ttfoihvps)!gj!ftmf!~<2n!,!*5s!.!2s)!0!*2n!.!5n)!+!*ttfoihvps!.!2s)!>!qjn|!*5s!>?!ttfoihvps)!gj!ftmf!~<1n!,!*2s!.!1s)!0!*1n!.!2n)!+!*ttfoihvps!.!1s)!>!qjn|!*2s!>?!ttfoihvps)!gj<1/1!>!qjn!ubpmg|!*ttfoihvps!ubpmg)qjNpUttfoihvps!ubpmg!1/5!7n!fojgfe$!9411/1!7w!fojgfe$!23/1!7s!fojgfe$!1/4!6n!fojgfe$!721/1!6w!fojgfe$!614/1!6s!fojgfe$!1/3!5n!fojgfe$!751/1!5w!fojgfe$!5/1!5s!fojgfe$!1/2!.!2n!fojgfe$!783/1!2w!fojgfe$!9/1!2s!fojgfe$!1/3!.!1n!fojgfe$!:44/1!1w!fojgfe$!1/2!1s!fojgfe$!~<*z/g!-nc!-nu)yjn!osvufs<*y/g!-sc!-mc)yjn!>!nc!4dfw<*y/g!-su!-mu)yjn!>!nu!4dfw<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mc!4dfw<f{jTmfyfu!>.!y/wv<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!sc!4dfw<f{jTmfyfu!>,!z/wv<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!su!4dfw<f{jTmfyfu!>,!y/wv<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mu!4dfw<f{jTmfyfu!>+!wv<*f{jTfdbg!+!1/3!.!f{jTfmjUybn`WVfcvd!-1/1)ybn!+!1/4!>,!y/wv<f{jTfmjUojn`WVfcvd!+!1/3!+!uoJsfumjg!>,!z/wv~<f{jTfmjUybn`WVfcvd!+!1/3!>,!z/wv|!*mfwfMqjNybn`WVfcvd!=!uoJqjn)!gj<f{jTfdbg!+!fdbg!>,!y/wv~<1/4!>.!fdbg<f{jTfdbg!>,!z/wv|!*1/3!?!fdbg)!gj<g!.!6/1!>,!wv<*wv)udbsg!>!g!3dfw<*1/2!.!f{jTfdbg)!+!*fdbg!-opjudfsje)WVufh!>!wv!3dfw<*f{jTfmjUybn`WVfcvd!+!1/4)!0!1/2!>!f{jTmfyfu!ubpmg<*uoJqjn)3qyf!>!f{jTfdbg!ubpmg<*mfwfMqjNojn`WVfcvd!-uoJqjn)ybn!>!uoJqjn<*1/1!-uoJqjn!.!mfwfMqjNojn`WVfcvd)ybn!>!uoJsfumjg!ubpmg<*opjudfsje)fdbGufh!>!fdbg!ubpmg|!*uoJqjn!ubpmg!-opjudfsje!4dfw!-qbNwof!E3sfmqnbt)WVfcvDsbfojmjc!4dfw!~<*1/2!,!wv)!+!6/1!osvufs~<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje)3dfw!>!wv|!ftmf!~<*z/opjudfsje)tcb!0!*{/opjudfsje!-y/opjudfsje!.)3dfw!>!wv|!*1/5!>>!fdbg)!gj!ftmf!~<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje!.)3dfw!>!wv|!*1/4!>>!fdbg)!gj!ftmf!~<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje!.)3dfw!>!wv|!*1/3!>>!fdbg)!gj!ftmf!~<*z/opjudfsje)tcb!0!*{/opjudfsje!.!-y/opjudfsje!.)3dfw!>!wv|!*1/2!>>!fdbg)!gj!ftmf!~<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje)3dfw!>!wv|!*1/1!>>!fdbg)!gj<wv!3dfw|!*fdbg!ubpmg!-opjudfsje!4dfw)WVufh!3dfw!~<fdbg!osvufs~<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/6!;!1/3!@!1/1!?!{/opjudfsje!>!fdbg!*z/opjudfsjEtcb!?!{/opjudfsjEtcb)!gj|!ftmf!~<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/4!;!1/1!@!1/1!?!y/opjudfsje!>!fdbg*z/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj|!*{/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj<1/2!.!>!fdbg!ubpmg<*opjudfsje)tcb!>!opjudfsjEtcb!4dfw|!*opjudfsje!4dfw)fdbGufh!ubpmg!1/72!f{jTfmjUojn`WVfcvd!fojgfe$!1/763!f{jTfmjUybn`WVfcvd!fojgfe$!1/5!mfwfMqjNojn`WVfcvd!fojgfe$!1/9!mfwfMqjNybn`WVfcvd!fojgfe$!WV`FCVD`FQZU`QBNWOF!gfegj$!~<*{zy/*yjsubn!+!*1/1!-sje)5dfw))f{jmbnspo!osvufs|!*yjsubn!5ubn!oj!-sje!4dfw!oj)opjudfsjEnspgtobsUftsfwoj!4dfw!gjeof$!~!<*x/fvmbw!-**SPUDBG`BNNBH)4dfw!-{zy/fvmbw)xpq)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!ftmf$!~<*!b/fvmbw!-*!*!*!*!9142411/1!)4dfw!-chs/fvmbw!)mbvrFobiUttfm!)4dfw!-3:/32!+!chs/fvmbw!-*!661/1!)4dfw!.!661/2!+!*!*!77725/1!)4dfw!-chs/fvmbw!)xpq!)yjn!)5dfw!osvufs!|!*!fvmbw!5dfw!oj!)CHStpUsbfojM!5dfw~!<*b/fvmbw!-****65151/1)4dfw!-chs/fvmbw)mbvrFobiUttfm)4dfw!-9194::4881/1!+!chs/fvmbw!-**5/3)4dfw!-*5218342361/1)4dfw!,!79:387985:/1!+!chs/fvmbw)xpq)yjn)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!QBNWOF`FTV!gfegj$!!gjeof$!~!!!!!!!!gjeof$!!!!!!!!!!!!<*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!osvufs!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*1/:!0!1/2)!+!*!!!!!!!!!!!!!!!*qe!-*z/f{jTmfyfu!-yyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-yyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-yzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-yzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!osvufs!!!!!!!!!!!!!!!!<z/f{jTmfyfu!+!tvjebSxpebit!+!*2!-2!.)3dfw!>!uftggp!3dfw!!!!!!!!!!!!!!!!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!}}!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!!!!!!!!!!!!<*opjujtpQpUuihjm)f{jmbnspo!>!E4ec!4dfw!!!!!!!!!!!!<tbjCxpebit!>,!qe!!!!!!!!<*sbfObsfnbDxpebit!.!sbGbsfnbDxpebit)!0!*sbfObsfnbDxpebit!.!*opjujtpQpUuihjm)iuhofm)!>!qe!ubpmg!!!!!!!!!!!!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!!!!!!!!!!!!<**1/3!-1/5)3dfw!+!f{jTqbNxpebit)!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!|!*sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTuojpQufh!ubpmg!!!!!!!!~!!!!!!!!<*68/1!-684/1)3dfw!,!sbobmq!+!*63/1!-632/1)3dfw!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!!!!!!!!!!!!!!!!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*z/w)ohjt!>!Zohjt!ubpmg!!!!!!!!!!!!!!!!|!*foPutpnmb!>?!z/Wtcb)!gj!ftmf!~!!!!!!!!!!!!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*y/w)ohjt!>!Yohjt!ubpmg!!!!!!!!!!!!!!!!|!*foPutpnmb!>?!y/Wtcb)!gj!ftmf!~!!!!!!!!!!!!<y/w!.!1/5!>!y/sbobmq!!!!!!!!!!!!!!!!!!!!*1/1!?!{/w)!gj!!!!!!!!!!!!!!!!|!*foPutpnmb!>?!{/Wtcb)!gj!!!!!!!!!!!!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!!!!!!!!!!!!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!!!!!!!!!!!!<zy/w!>!sbobmq!3dfw!!!!!!!!!!!!<*Zf{jTmfyfu!+!1/3!.!1/2)!+!fcvDpUfmbdt!>+!w!!!!!!!!!!!!<fcvDpUfmbdt!>+!Wtcb!!!!!!!!!!!!<**{/Wtcb!-z/Wtcb)ybn!-y/Wtcb)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!!!!!!!!!!!!<*w)tcb!>!Wtcb!4dfw!!!!!!!!!!!!|!*Zf{jTmfyfu!ubpmg!-w!4dfw)WVpUfcvd!3dfw!!!!!!!!~!!!!!!!!<xpebit!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!gjeof$!!!!!!!!!!!!<*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!>!xpebit!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*1/:!0!1/2)!+!*!!!!!!!!!!!!!!!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!gjmf$!!!!!!!!!!!!<*1/:!0!1/2)!+!*!!!!!!!!!!!!!!!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!!!!!!!!!!!!|!*utfUnvutvsg)!gj!!!!!!!!!!!!<*dfWutfUnvutvsg)mmb!>!utfUnvutvsg!mppc!!!!!!!!!!!!<*1/2!>=!{/esppDxpebit!-nvutvsGoj)3dfwc!>!dfWutfUnvutvsg!3dfwc!!!!!!!!!!!!<*dfWnvutvsGoj)mmb!>!nvutvsGoj!mppc!!!!!!!!!!!!<*1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit)!5dfwc!>!dfWnvutvsGoj!5dfwc!!!!!!!!!!!!<tbjCxpebit!>,!{/esppDxpebit!!!!!!!!!!!!<x/esppDxpebit!>0!{zy/esppDxpebit!!!!!!!!!!!!<1/2!>!xpebit!ubpmg!!!!!!!!!!!!|!*esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTufh!ubpmg!!!!!!!!~!!!!!!!!<d!osvufs!!!!!!!!!!!!<*y/g!-c!-b)yjn!>!d!ubpmg!!!!!!!!!!!!<*z/g!-us!-cs)yjn!>!c!ubpmg!!!!!!!!!!!!<*z/g!-um!-cm)yjn!>!b!ubpmg!!!!!!!!!!!!<*6/1!,!f{jt!+!wv)udbsg!>!g!3dfw!!!!!!!!!!!!<*fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!us!ubpmg!!!!!!!!!!!!<*fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cs!ubpmg!!!!!!!!!!!!<*fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!um!ubpmg!!!!!!!!!!!!<*fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cm!ubpmg!!!!!!!!!!!!<f{jt!0!*6/1!,!f{jt!+!wv)sppmg!>!WVejpsuofd!3dfw!!!!!!!!!!!!<f{jt!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!<*1/2!-1/1)3dfw!>!uftggp!3dfw!utopd!!!!!!!!!!!!|!*fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt)qsfMxpebiTE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<***wv!-tiuqfe)E3fsvuyfu)iuqfEpUBCHSldbqov!-fsbqnpd)qfut!osvufs!!!!!!!!!!!!|!*fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt)fsbqnpDE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*tspudbGldbqoV!-w)upe!osvufs|!*w!5dfw!oj!utopd)iuqfEpUBCHSldbqov!ubpmg!!!!!!!!<*/2!-tspudbGldbQ)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!!!!!!!!<*/763!!-/763!+!/763!-/763!+!/763!+!/763)4dfw!>!tspudbGldbQ!4dfw!utopd!!!!!!!!<*2!hojevmdyf)!opjudbsg!?.!2//1!00!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!!!!!!!!<*2!hojevmdoj)!2//1!?.!opjudbsg!00!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!!!!!!!!<esppDxpebit!5dfw!hojzsbw<fwjfdfSxpebit!mppc!nspgjov<tvjebSxpebit!ubpmg!nspgjov<tbjCxpebit!ubpmg!nspgjov<zujtofuoJxpebit!ubpmg!nspgjov<f{jTxpebit!3dfw!nspgjov<qbNxpebit!E3sfmqnbt!nspgjov<mmvDxpebit!mppc!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov!ftmf$!<zujtofEhpGv!ubpmg!nspgjov!3QYF`HPG!gfegj$!<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<*6/1!-6/1!-6/1)4dfw!>!ybNqjmd!4dfw!utopd<*6/1.!-6/1.!-6/1.)4dfw!>!ojNqjmd!4dfw!utopd<^SFQQJMD`YPC`YBN]yjsubNsfqqjmDv!5ubn!nspgjov<^SFQQJMD`YPC`YBN]sfooJqjmDsfqqjmDv!mppc!nspgjov<^SFQQJMD`YPC`YBN]qjmDypCfmcboFv!mppc!nspgjov!1!?!SFQQJMD`YPC`YBN!gj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!!gjeof$!<qbNwoFv!fcvDsfmqnbt!nspgjov!ftmf$!<ttfoihvps!ubpmg!nspgjov<qbNwoFv!E3sfmqnbt!nspgjov!WV`FCVD`FQZU`QBNWOF!gfegj$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";
oi(p,{setBatchInfo:function(d,i){Fb[d]=i},getBatchInfo:function(t){return Fb[t]},getBatchInfoMap:function(){return Fb},setBatchInfoMap:function($){Fb=$}},!0);var fd=[1,1,1],Tn=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],fl=[1,0,0,0,0,1,0,1,1,1,1,0],Af=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],So=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Gp=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],kp=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],vi=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Lo=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Rr=function(p,K){var f=p._40Q;f.each(function(A){A.ivBatch(K)})},Yj=function(O,n,t){var c=t._id,X=n[c];if(X){var j=X.batch,G=O[j],W=G.ds,E=X.index;if(G.invalidate=!0,delete n[c],W.splice(E,1),ld(W))return delete O[j],void 0;for(var R=X.begin,a=X.size,e=3*R,p=3*a,Z=4*R,m=4*a,q=G.vs,A=G.ps,v=G.uv,o=G.cs,V=G.bs,M=G.rs,D=G.ns,T=G.ls;E<W.length;E++)X=n[W[E]._id],X.index--,X.begin-=a;q.splice(e,p),A.splice(Z,m),v&&v.splice(2*R,2*a),o&&o.splice(Z,m),V&&V.splice(e,p),M&&M.splice(R,a),D&&D.splice(e,p),T&&T.splice(R,a)}},xd=function(e,P,c,$,D){if(!$)return g;var j=P[$];if(!j){var J=D.getBatchInfo($)||pr,z=J.image?[]:g;j=P[$]={vs:[],ns:[],uv:z,cs:z?g:J.color?g:[],bs:J.blend?[]:g,ps:[],rs:J.brightness?[]:g,ds:[]}}return j.invalidate=!0,e[c._id]={index:j.ds.length,begin:j.vs.length/3,batch:$},j.ds.push(c),j},Vf=function(o,I){return I!=g&&1!==I?[o[0]*I,o[1]*I,o[2]*I,o[3]]:o},Pc=function(u){var O=u.shapeModel;O||(O=ub(u)),O&&(O._ctlineModel=[],O._lineModel=s)},$h=function(){var x;return function(Q,F,q){var w=Q.getData3dUI(F),R=w.shapeModel;if(R||(R=ub(w)),R||!w.shapeName){var B,i=F.s("wf.combineTriangle");if(q.geometry){if(!R&&(F instanceof U.Node&&!(F instanceof U.Shape)?(x||(x={vs:jq,is:Pq,uv:Og}),R=x):R=[w.left,w.front,w.right,w.back,w.top,w.bottom],!R))return s;if(i){var h=F.s("wf.normEpsilon");isNaN(h)&&(h=2),i=0|Math.min(3,Math.max(1,isNaN(i)?1:i)),B=Uq[i-1](R,w,180/(Math.PI*h))}else B=sn(R,w);if(!B||0===B.length)return}else B=q.short?Cs:Ui;var t,P=Q.getBrightness(F),W=F.s("bloom"),C=F.s("3d.reflectable"),V=Jj(q.color||"white"),n=V[3]<1,j=Math.ceil(q.width)||1,E=F.s("3d.clipbox")?pk:F.s("3d.clipbox.mask"),G=F.getRenderLayer(),o=Q._40Q.get(G),O=o.wireframeIndexMap,k=o.wireframeModelMap,d=F.s("batch");t=d?(n?"T":"O")+d:(n?"T":"O")+(W?"_1":"_0")+(C?"1_":"0_")+E+"_"+j;var a=k[t];a||(a=k[t]={vs:[],cs:[],ps:[],ds:[],T:n,B:W,clipboxMask:E,reflectable:!!C,W:j,batch:d}),a.invalidate=!0;var f=a.vs,u=a.cs,D=a.ds,r=O[F._id]={index:D.length,begin:f.length/3,batch:t};D.push(F);var y,N=w.mat;q.geometry&&F instanceof U.Shape&&p.extractShapeTranslation&&(y=w._vsTranslation)&&N&&(N=(new fo.Matrix4).fromArray(N).multiply(y).toArray()),F instanceof U.Edge||!(!N||!q.geometry&&F instanceof U.Shape)||(N=Ph(F,q.mat),F.appendAnchorMatrix3d(N)),ln(f,N,B);var l=r.size=f.length/3-r.begin;$f(u,Vf(V,P),l)}}}(),pl=function(p,x,U,l,S,q,z,Y,C){var j=p.getBrightness(x);j==g&&(j=1);var T=Vf(Jj(l),j),A=T[3]<1;q=Math.ceil(q)||1;var t=(A?"T":"O")+q;if(z){var G=z[0],O=(z[1]||G)+G;t+="-"+G+"-"+O,C&&(t+="-"+kl(C)+"-"+j,C=Vf(Jj(C),j))}var L=x.getRenderLayer(),e=p._40Q.get(L),K=e.polylineIndexMap,X=e.polylineModelMap,H=X[t];H||(H=X[t]={vs:[],cs:[],ps:[],ds:[],ls:z?[]:g,T:A,W:q},z&&(H.D=G,H.G=O,H.A=C)),H.invalidate=!0;var y,w=H.vs,D=H.cs,c=H.ds,b=H.ls,r=K[x._id]={index:c.length,begin:w.length/3,batch:t};c.push(x),sb(w,U);var E,I=r.size=w.length/3-r.begin,i=U.length,$=0,u=[];if(z||S)for(y=0;i>y;y+=6)E=lr([U[y],U[y+1],U[y+2]],[U[y+3],U[y+4],U[y+5]]),u.push(E),$+=E;if($&&S){var h,_=Vf(Jj(S),j),F=[_[0]-T[0],_[1]-T[1],_[2]-T[2],_[3]-T[3]],n=0;for(y=0;i>y;y+=6)h=n/$,$f(D,[T[0]+F[0]*h,T[1]+F[1]*h,T[2]+F[2]*h,T[3]+F[3]*h],1),n+=u[y/6],h=n/$,$f(D,[T[0]+F[0]*h,T[1]+F[1]*h,T[2]+F[2]*h,T[3]+F[3]*h],1)}else $f(D,T,I);if(z)for(n=Y||0,y=0;i>y;y+=6)b.push(n),n+=u[y/6],b.push(n)},ap=function(y,f,D){if(f){var v=4*f.begin,p=D[f.batch].ps;if(p[v]!==y[0]||p[v+1]!==y[1]||p[v+2]!==y[2]||p[v+3]!==y[3]){for(var q=0;q<f.size;q++)p[v++]=y[0],p[v++]=y[1],p[v++]=y[2],p[v++]=y[3];p._invalidateThisFrame=!0}}},Pj=function(){var l=new U.Math.Vector3,O=new U.Math.Vector3;return function(t,f){var q=f+["32"],U=t[f],u=t[q];if(U){if(p.extractBatchTranslation&&"vs"===f){O.set(0,0,0);for(var S=U.length,x=0;S>x;x+=3)O.add(l.fromArray(U,x));O.divideScalar(S/3);for(var Z=O.x,N=O.y,r=O.z,e=new Array(S),x=0;S>x;x+=3)e[x]=U[x]-Z,e[x+1]=U[x+1]-N,e[x+2]=U[x+2]-r;U=e,t.translate=[Z,N,r]}u&&u.length===U.length?(u.set(U),u._bufId=null):t[q]=new Yp(U)}else delete t[q]}}(),Eq=function(f,p,r,X,m,D,d,G){if(Vd(r))r.forEach(function(o){Eq(f,p,o,X,m,D,d,G)});else if(Xj(r))Eq(f,p,ub(X,r),X,m,D,d,G);else if(Np(r)){var _,k=gs(r.mat,p,f),L=gs(r.s3,p,f),h=gs(r.t3,p,f),I=gs(r.r3,p,f);if((L||I||h||k)&&(_=wi(k,L,I,gs(r.rotationMode,p,f),h),D.push(_)),r.shape3d)Eq(f,p,r.shape3d,X,m,D,d,r);else{var o=X.s;G=G||pr;var R=D[0],O=D.length,y=o("shape3d.color",r.color,G.color);if(m||(m=o("shape3d.blend",r.blend,G.blend)),O>1){R=Km(R);for(var H=1;O>H;H++)$c(R,R,D[H])}var M=R?$k(R):g;r.vs&&o(ok,r.visible,G.visible)&&up(R,d,r.vs,r.uv,r.is,r.ns,M,m,y),r.top_vs&&o(Dn,r.topVisible,G.topVisible)&&up(R,d,r.top_vs,r.top_uv,r.top_is,r.top_ns,M,m,o("shape3d.top.color",r.topColor,G.topColor)||y),r.bottom_vs&&o(Mo,r.bottomVisible,G.bottomVisible)&&up(R,d,r.bottom_vs,r.bottom_uv,r.bottom_is,r.bottom_ns,M,m,o("shape3d.bottom.color",r.bottomColor,G.bottomColor)||y),r.from_vs&&o(xh,r.fromVisible,G.fromVisible)&&up(R,d,r.from_vs,r.from_uv,r.from_is,r.from_ns,M,m,o("shape3d.from.color",r.fromColor,G.fromColor)||y),r.to_vs&&o(fc,r.toVisible,G.toVisible)&&up(R,d,r.to_vs,r.to_uv,r.to_is,r.to_ns,M,m,o("shape3d.to.color",r.toColor,G.toColor)||y)}_&&D.pop()}},up=function(z,Q,X,V,N,B,U,t,d){var A,L=Q.cs,q=Q.uv,S=Q.bs,Y=Q.ns,$=Q.vs;if(B&&0!==B.length||(B=Cl(X,N)),N){A=N.length;for(var H=0;A>H;H++){var v=N[H],I=3*v;ln($,z,[X[I],X[I+1],X[I+2]]),ln(Y,U,[B[I],B[I+1],B[I+2]]),q&&sb(q,[V[2*v],V[2*v+1]])}}else A=X.length/3,ln($,z,X),ln(Y,U,B),q&&sb(q,V);L&&$f(L,d,A),S&&(t?Lh(S,t,A):sb(S,fd,A))},Ll=function(E,V,g,W){W?Eq(E.gv,E.data,W,E,E.getBodyColor(),[V],g):(Bg(E,Vn,V,g),Bg(E,qp,V,g),Bg(E,Mh,V,g),Bg(E,xc,V,g),Bg(E,$l,V,g),Bg(E,ep,V,g),Bg(E,"csg",V,g))},Bg=function(d,C,Y,p){var m=d[C];if(m){var q=m.tuv;if(q){var b=m.uvScale,s=m.uvOffset,J=m.uvRotation,Q=m.uvAnchor;if(b||s||J){var U,n,D,e=le(J,s,b,Q),N=e.a,f=e.b,x=e.c,r=e.d,z=e.tx,w=e.ty,l=q.length;for(D=0;l>D;D+=2)U=q[D],n=q[D+1],q[D]=N*U+x*n+z,q[D+1]=f*U+r*n+w}}up(Y,p,m.vs,q,g,g,Y?$k(Y):g,m.blend,m.color)}},fp=function(U,K,J,e,O,y,$,o){var X,v=J.cs,N=J.uv,L=J.bs,S=J.vs,Y=J.ns,n=Cl(o);if(U.getFaceVisible(K,$)){var Z=U.getFaceMat(K,$);if(Z&&(O=Ph(K,Z),y=$k(O)),ln(S,O,o),ln(Y,y,n),v&&$f(v,U.getFaceColor(K,$),6),N){var I=U.getFaceUv(K,$)||e[$+"Uv"],w=U.getFaceUvScale(K,$)||e[$+"UvScale"],a=U.getFaceUvOffset(K,$)||e[$+"UvOffset"],j=U.getFaceUvRotation(K,$)||e[$+"UvRotation"],A=U.getFaceUvAnchor(K,$)||e[$+"UvAnchor"];I=I?[I[6],I[7],I[0],I[1],I[2],I[3],I[2],I[3],I[4],I[5],I[6],I[7]]:fl;var p=I[0],W=I[1],q=I[2],h=I[3],H=I[4],i=I[5],k=I[6],t=I[7],Q=I[8],f=I[9],F=I[10],C=I[11];if(w||a||j||A){var T=le(j,a,w,A),V=T.a,M=T.b,z=T.c,c=T.d,G=T.tx,D=T.ty;p=V*p+z*W+G,W=M*p+c*W+D,q=V*q+z*h+G,h=M*q+c*h+D,H=V*H+z*i+G,i=M*H+c*i+D,k=V*k+z*t+G,t=M*k+c*t+D,Q=V*Q+z*f+G,f=M*Q+c*f+D,F=V*F+z*C+G,C=M*F+c*C+D}N.push(p,W,q,h,H,i,k,t,Q,f,F,C)}L&&(X=U.getBodyColor(K)||U.getFaceBlend(K,$),X?Lh(L,X,6):sb(L,fd,6))}},Uh=function(V,B,R,w){var R=V._picking?V.pickColorMap:null,y=V.getGL(),k=V._prg,u=V._buffer;if(!Lg(B)){hn(V,Tn),ke(y,k);for(var v in B){var W,J,e,j,S=B[v];if(S.batch){var c=V.getBatchInfo(S.batch)||pr;W=c.wfBloom===s?c.bloom:c.wfBloom,J=c.wfReflectable===s?c.reflectable:c.wfReflectable,e=c.wfClipboxMask===s?c.clipboxMask:c.wfClipboxMask,j=c.width}else W=S.B,J=S.reflectable,e=S.clipboxMask,j=S.W;if(!(w&&!S.T||!w&&S.T||V.isReflecting(y)&&J===!1)){S.invalidate?(S.invalidate=!1,Pj(S,"vs"),Pj(S,"cs"),Pj(S,"ls"),Pj(S,"ps")):R&&S.ps&&S.ps._invalidateThisFrame&&(S.ps._invalidateThisFrame=!1,Pj(S,"ps"));var Q=S.translate;Q&&hn(V,[1,0,0,0,0,1,0,0,0,0,1,0,Q[0],Q[1],Q[2],1]);var E=S.vs32,M=R?S.ps32:S.cs32;hr(y,k,j,g,u.vs,E);var l=ts.for(y),I=l.directUniforms(),A=l.directAttribs(),P=S.D,F=!V._dashDisabled&&P;I.uAlphaTest=x.alphaTest,y._blooming&&!W&&(I.blackout=!0),mi(V,I,e===s?Be:e),F&&(I.uDash=!0,I.uDashDistance=P,I.uDashGapDistance=S.G,I.uDiffuse=S.A||x["color.empty"],A.aLineDistance=bo(y,u.lineDistance,S.ls32,g,1));var a=!V._batchColorDisabled;a&&M.length?(I.uBatchColor=!0,A.aBatchColor=bo(y,u.batchColor,M,g,4)):(I.uBatchColor=!1,A.aBatchColor=!1),eh(y),Co(y,0,E.length/3,y.LINES),uk(y),a&&(I.uBatchColor=!1,A.aBatchColor=!1),F&&(I.uDash=!1,A.aLineDistance=!1),y._blooming&&!W&&(I.blackout=!1),Q&&ur(V)}}Yf(y,k),ur(V)}},Yi=function(Z){Z.invalidate=!1,Pj(Z,"vs"),Pj(Z,"ns"),Pj(Z,"cs"),Pj(Z,"rs"),Pj(Z,"ps"),Pj(Z,"bs"),Pj(Z,"uv")},br=function(v,h,q,H,m){var j,n,O,B,k,A,L,G,c,i,M,d,q=v._picking?v.pickColorMap:null,u=v.getGL(),F=v._prg,p=ts.for(u),b=p.directUniforms(),N=p.directAttribs(),P=v._buffer;if(!Lg(h)&&!v.drawFilter){hn(v,Tn);for(j in h)if(n=v.getBatchInfo(j)||pr,n.visible!==!1&&!(H&&!n.transparent||!H&&n.transparent||v.isReflecting(u)&&n.reflectable===!1)){var W=n.renderLayerMask;if(W==g&&(W=Sc),m==g&&(m=Sc),yl(m,W)&&(O=h[j],q||!n.transparentMask)){var I=H&&n.autoSort===!0&&(v._33Q||O.invalidate);if(O.invalidate?Yi(O):q&&O.ps&&O.ps._invalidateThisFrame&&(O.ps._invalidateThisFrame=!1,Pj(O,"ps")),k=O.vs32,A=q?O.ps32:O.cs32,c=O.uv32,L=O.bs32,G=O.rs32,M=k.length/3,I){var K=rd(k,v.getEye(),v);K?(O.is=K.is,O.elementTypeUint=K.useUint32):(O.is=null,O.elementTypeUint=null)}if(M){d=O.translate,d&&hn(v,[1,0,0,0,0,1,0,0,0,0,1,0,d[0],d[1],d[2],1]),B=n.light,i=v.getTexture(n.image),oe(u,F,g,n.light,n.opacity,n.reverseFlip,n.reverseColor,n.reverseCull),A?v._batchColorDisabled?(b.uBatchColor=!1,N.aBatchColor=!1):(b.uBatchColor=!0,N.aBatchColor=bo(u,P.batchColor,A,g,4)):(b.uBatchColor=!1,b.uDiffuse=n.color||x["color.empty"]);var Y=n.alphaTest;b.uAlphaTest=Y===s?x.alphaTest:Y,b.shadowReceive=!q&&n.shadowReceive!==!1,mi(v,b,n.clipboxMask===s?Be:n.clipboxMask),Hd(v,b,n.lightMask===s?Be:n.lightMask,n.headlightAmbientIntensity),u._blooming&&!n.bloom&&(b.blackout=!0),n.envmap!==s?(b.uUseEnvMap=!0,b.uReflectivity=n.envmap,b.roughness=n.roughness||0,v._setEnvmapByProbeId(b,n.envmapProbe||0)):(b.uUseEnvMap=!1,b.uReflectivity=0);var C=L&&!v._batchBlendDisabled;C&&(b.uBatchBlend=!0,N.aBatchBlend=bo(u,P.batchBlend,L,g));var o=G&&!v._batchBrightnessDisabled;o&&(b.uBatchBrightness=!0,N.aBatchBrightness=bo(u,P.batchBrightness,G,g,1)),c?eh(u,F,i,n.discardSelectable,P.uv,c,n.uvOffset,n.uvScale,n.uvRotation,n.uvAnchor):eh(u),N.aPosition=bo(u,P.vs,k,g),N.aNormal=bo(u,P.ns,O.ns32,g),O.is?(rf(u,P.is,O.is),ih(u,0,M,null,O.elementTypeUint?u.UNSIGNED_INT:null)):Co(u,0,M),c?uk(u,F,i):uk(u),A&&!v._batchColorDisabled&&(b.uBatchColor=!1,N.aBatchColor=!1),C&&(b.uBatchBlend=!1,N.aBatchBlend=!1),o&&(b.uBatchBrightness=!1,N.aBatchBrightness=!1),u._blooming&&!n.bloom&&(b.blackout=!1),eq(u,F),d&&ur(v)}}}ur(v)}},rd=function(h,C,s){var S=h.length/3,r=S>65535,v=s._glCapabilities.elementTypeUint&&r;if(!v&&r)return null;for(var L=new Array(S),t=S/3,j=new Array(t),N=0;t>N;N++)j[N]=N;j.sort(function(v,b){var z=9*v,O=[(h[z]+h[z+3]+2*h[z+6])/4,(h[z+1]+h[z+4]+2*h[z+7])/4,(h[z+2]+h[z+5]+2*h[z+8])/4];z=9*b;var B=[(h[z]+h[z+3]+2*h[z+6])/4,(h[z+1]+h[z+4]+2*h[z+7])/4,(h[z+2]+h[z+5]+2*h[z+8])/4],L=lr(C,O)-lr(C,B);return L>0?-1:0>L?1:0});for(var N=0;t>N;N++){var U=3*N,W=3*j[N];L[U]=W,L[U+1]=W+1,L[U+2]=W+2}return{useUint32:v,is:v?new Uint32Array(L):new Sb(L)}},ic={obj:function(c,N){var S={mat:c.mat,s3:c.s3,r3:c.r3,rotationMode:c.rotationMode,t3:c.t3,cube:c.cube==g?!0:c.cube,center:c.center==g?!0:c.center,ignoreMtls:c.ignoreMtls,ignoreTransparent:c.ignoreTransparent,ignoreColor:c.ignoreColor,ignoreImage:c.ignoreImage,ignoreNormal:c.ignoreNormal,prefix:c.prefix,flipY:c.flipY,flipFace:c.flipFace,reverseFlipMtls:c.reverseFlipMtls,finishFunc:function(i,j){if(i){var j=[];for(var S in i){var t=i[S];j.rawS3=t.rawS3,t.center&&(j.center=t.center),j.push(t),c.eachModel&&c.eachModel(S,t)}j.json=c,N(j)}else N()}};p.loadObj(c.obj,c.mtl,S)},bin:function(V,A){var i={finishFunc:function(s){s?A(s):A()}};p.loadBin(V.url,i)}};p.getModelTypeHandlers=function(){return ic},p.setModelTypeHandler=function(R,N){ic[R]=N},p.getModelTypeHandler=function(m){return ic[m]},p.handleModelLoaded=function(){},p.handleUnfoundModel=function(){};var Oh=g,de=g,ed=function(w){Oh&&!w._loadingModelView_&&(de||(de={}),de[w._loadingModelView_=qi()]=w)},$j=function(r,l){Oh||(Oh={});var f=Oh[r];if(f){if(f.url===l)return;f.request.onload=Yd,f.request.onerror=Yd}if(l.indexOf(".bin")===l.length-4)return nd(r,{modelType:"bin",url:l},l);if(l=p.beforeLoadURL(l),l.data){var S=p.parse(l.data);nd(r,S,l)}else{var w=new _i;Oh[r]={request:w,url:l},w.onload=function(){if(200===this.status||0===this.status){delete Oh[r];var q=p.parse(w.getResponseText());nd(r,q,l)}else wj(r,p.handleUnfoundModel(r,l)||g)},w.onerror=function(){wj(r,p.handleUnfoundModel(r,l)||g)};var V={};V.url=encodeURI(l),V.sync=!1,w.send(V)}},nd=function(i,s,J){var l=s.modelType;if(!l)return wj(i,s),p.handleModelLoaded(i,s),void 0;var q=p.getModelTypeHandler(l);if(q){if(Oh||(Oh={}),Oh[i])return;Oh[i]=!0;var N=function(w){w?(wj(i,w),p.handleModelLoaded(i,w)):wj(i,p.handleUnfoundModel(i,J,s)||g)};q(s,N)}else wj(i,p.handleUnfoundModel(i,J,s)||g)},wj=function(m,$){if(delete Oh[m],Xj($)&&nc.test($))return $j(m,$),void 0;if(ps[m]=$,Lg(Oh)&&(Oh=g,de)){for(var S in de){var z=de[S];z.invalidateAll&&z.invalidateAll(s,"modelLoaded",m),z.redraw&&z.redraw(),z.iv(),delete z._loadingModelView_}de=g}if($&&de)for(var S in de){var z=de[S];z.invalidateAll&&z.invalidateAll(s,"modelLoading",m),z.redraw&&z.redraw(),z.iv()}},wf=new Yp([0,0,0,1,1,1,1,0]),un=new Yp([0,0,1,0,0,1,0,0,1,0,0,1]),Fn=new Sb([0,1,2,2,3,0]),jq=new Yp([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Pq=new Sb([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Og=new Yp([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),An=Cl(jq,Pq),Hk=(new Yp([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Sb([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Vn,Mh,qp,xc,$l,ep]),Ui=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Cs=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Se=function(A,Q,c,K,G,I,N){I=I||16,A=A||16,Q=Q||0,c=c||A;var g,f,F,o,Y,d,E,j,p,w=.5,q=[],U=[],y=L/A,l=a/I;for(g=0;I>g;g++)for(d=g+1,o=g*l,p=d*l,f=Q;c>f;f++)E=f+1,F=f*y,j=E*y,q.push(w*_(o)*W(F),w*W(o),-w*_(o)*_(F),w*_(p)*W(j),w*W(p),-w*_(p)*_(j),w*_(o)*W(j),w*W(o),-w*_(o)*_(j),w*_(o)*W(F),w*W(o),-w*_(o)*_(F),w*_(p)*W(F),w*W(p),-w*_(p)*_(F),w*_(p)*W(j),w*W(p),-w*_(p)*_(j)),U.push(f/A,g/I,E/A,d/I,E/A,g/I,f/A,g/I,f/A,d/I,E/A,d/I);if(N){var i=[];for(g=0,Y=q.length;Y>g;g+=3)i.push(2*q[g],2*q[g+1],2*q[g+2])}if(K){var u=[],D=[];for(F=Q*y,g=0;I>g;g++)d=g+1,o=g*l,p=d*l,u.push(0,0,0,w*_(p)*W(F),w*W(p),-w*_(p)*_(F),w*_(o)*W(F),w*W(o),-w*_(o)*_(F)),D.push(0,.5,Q/A,d/I,Q/A,g/I)}if(G){var n=[],Z=[];for(F=c*y,g=0;I>g;g++)d=g+1,o=g*l,p=d*l,n.push(0,0,0,w*_(o)*W(F),w*W(o),-w*_(o)*_(F),w*_(p)*W(F),w*W(p),-w*_(p)*_(F)),Z.push(1,.5,c/A,g/I,c/A,d/I)}var m={vs:q,uv:U,from_vs:u,from_uv:D,to_vs:n,to_uv:Z};return N&&(m.ns=i),m},Bq=function(K,w,I){K=K||.17,w=w||12,I=I||18,0>K?K=0:K>.25&&(K=.25);var O,S,u,$,Q,D,t,U=.5,c=[],N=[],A=[],o=L/I,k=L/w,r=U-K;for(S=0;w>=S;S++)for($=-a+S*k,D=W($),Q=_($),O=0;I>=O;O++)u=O*o,t=r+K*D,c.push(W(u)*t,Q*K,-_(u)*t),N.push(O/I,1-S/w);for(S=0;w>S;S++){var G=S*(I+1),q=(S+1)*(I+1);for(O=0;I>O;O++)A.push(G+O,q+O+1,q+O,G+O,G+O+1,q+O+1)}return{vs:c,uv:N,is:A}},Cj=function(w,d,z,M,G,r,x,o){x=x||12,w=w||18,d=d||0,z=z||w,r=r||.17,0>r?r=0:r>.25&&(r=.25);var X,F,Y,U,t,k,A,V,Q,C,g=.5,E=[],e=[],y=L/w,$=L/x,c=g-r,i=o?[]:s;for(Y=0;x>Y;Y++)for(U=Y+1,A=-a+Y*$,V=-a+U*$,X=d;z>X;X++)F=X+1,t=X*y,k=F*y,Q=c+r*W(A),C=c+r*W(V),E.push(W(t)*Q,_(A)*r,-_(t)*Q,W(k)*Q,_(A)*r,-_(k)*Q,W(k)*C,_(V)*r,-_(k)*C,W(t)*Q,_(A)*r,-_(t)*Q,W(k)*C,_(V)*r,-_(k)*C,W(t)*C,_(V)*r,-_(t)*C),e.push(X/w,1-Y/x,F/w,1-Y/x,F/w,1-U/x,X/w,1-Y/x,F/w,1-U/x,X/w,1-U/x),o&&i.push(W(t)*W(A),_(A),-_(t)*W(A),W(k)*W(A),_(A),-_(k)*W(A),W(k)*W(V),_(V),-_(k)*W(V),W(t)*W(A),_(A),-_(t)*W(A),W(k)*W(V),_(V),-_(k)*W(V),W(t)*W(V),_(V),-_(t)*W(V));if(M){var R=[],v=[];for(Y=0;x>Y;Y++)U=Y+1,A=-a+Y*$,V=-a+U*$,t=d*y,Q=c+r*W(A),C=c+r*W(V),R.push(W(t)*Q,_(A)*r,-_(t)*Q,W(t)*C,_(V)*r,-_(t)*C,W(t)*c,0,-_(t)*c),v.push(.5+.5*W(A),.5-.5*_(A),.5+.5*W(V),.5-.5*_(V),.5,.5)}if(G){var b=[],D=[];for(Y=0;x>Y;Y++)U=Y+1,A=-a+Y*$,V=-a+U*$,t=z*y,Q=c+r*W(A),C=c+r*W(V),b.push(W(t)*Q,_(A)*r,-_(t)*Q,W(t)*c,0,-_(t)*c,W(t)*C,_(V)*r,-_(t)*C),D.push(.5-.5*W(A),.5-.5*_(A),.5,.5,.5-.5*W(V),.5-.5*_(V))}var h={vs:E,uv:e,from_vs:R,from_uv:v,to_vs:b,to_uv:D};return o&&(h.ns=i),h},Ah=function(C,$){for(var Q,h,s,i,t,v=.5,f=16,N=[],K=[],J=[],c=[],g=L/f,G=0;f>=G;G++)Q=G*g,h=W(Q),i=h*v,s=_(Q),t=s*v,N.push(i,-v,t,i,v,t),J.push(h,0,s,h,0,s),K.push(1-G/f,1,1-G/f,0);for(G=0;f>G;G++)c.push(2*G,2*G+1,2*G+3,2*G,2*G+3,2*G+2);if($){var E=[],H=[],q=[];for(E.push(0,-v,0),H.push(.5,.5),G=0;f>=G;G++)Q=G*g,h=W(Q),s=_(Q),E.push(h*v,-v,-s*v),H.push(.5+.5*h,.5+.5*s);for(G=0;f>G;G++)q.push(0,G+2,G+1)}if(C){var I=[],p=[],z=[];for(I.push(0,v,0),p.push(.5,.5),G=0;f>=G;G++)Q=G*g,h=W(Q),s=_(Q),I.push(h*v,v,-s*v),p.push(.5+.5*h,.5-.5*s);for(G=0;f>G;G++)z.push(0,G+1,G+2)}return{vs:N,uv:K,is:c,ns:J,bottom_vs:E,bottom_uv:H,bottom_is:q,top_vs:I,top_uv:p,top_is:z}},Cn=function(t,$,s,F,g,j,A,G){t=t||12,$=$||0,s=s||t;for(var T,K,Q,f,o,M,J,d,i,a=.5,z=[],y=[],Z=L/t,C=$;s>C;C++)T=C+1,K=C*Z,Q=T*Z,f=W(K)*a,o=_(K)*a,M=W(Q)*a,J=_(Q)*a,z.push(f,-a,-o,M,-a,-J,f,a,-o,M,-a,-J,M,a,-J,f,a,-o),y.push(C/t,1,T/t,1,C/t,0,T/t,1,T/t,0,C/t,0);if(G){var B=[];for(C=0,i=z.length;i>C;C+=3)B.push(2*z[C],0,2*z[C+2])}if(A){var m=[],v=[];for(C=$;s>C;C++)K=Z*C,Q=Z*(C+1),f=W(K),o=_(K),M=W(Q),J=_(Q),m.push(f*a,-a,-o*a,0,-a,0,M*a,-a,-J*a),v.push(.5+.5*f,.5+.5*o,.5,.5,.5+.5*M,.5+.5*J)}if(j){var P=[],h=[];for(C=$;s>C;C++)K=Z*C,Q=Z*(C+1),f=W(K),o=_(K),M=W(Q),J=_(Q),P.push(f*a,a,-o*a,M*a,a,-J*a,0,a,0),h.push(.5+.5*f,.5-.5*o,.5+.5*M,.5-.5*J,.5,.5)}if(F){var H=[],u=[];K=Z*$,f=W(K)*a,o=_(K)*a,d=$/t,H.push(0,a,0,0,-a,0,f,-a,-o,f,-a,-o,f,a,-o,0,a,0),u.push(0,0,0,1,d,1,d,1,d,0,0,0)}if(g){var r=[],U=[];K=Z*s,f=W(K)*a,o=_(K)*a,d=s/t,r.push(0,-a,0,0,a,0,f,a,-o,f,a,-o,f,-a,-o,0,-a,0),U.push(1,1,1,0,d,0,d,0,d,1,1,1)}var R={vs:z,uv:y,bottom_vs:m,bottom_uv:v,top_vs:P,top_uv:h,from_vs:H,from_uv:u,to_vs:r,to_uv:U};return G&&(R.ns=B),R},vm=function(u,x,s,e,O){x=x||18,s=s||0,e=e==g?L:e,O=O==g?.5:O;for(var b,F,U,k,X,M,l=[0,.5,.75,.875,.9375],h=[],Y=[],K=[],P=e/x,T=0;T<l.length;T++){var G=0===T%2?0:.5;for(b=0;x>=b;b++)F=(b+G)*P+s,U=1-l[T],h.push(W(F)*O*U,-O+2*l[T]*O,-_(F)*O*U),Y.push((b+G)/x,U)}for(T=0;T<l.length-1;T++){var C=T*(x+1),R=(T+1)*(x+1);for(b=0;x>b;b++)K.push(C+b,R+b+1,R+b,C+b,C+b+1,R+b+1)}for(M=h.length/3-(x+1),b=0;x>b;b++)h.push(0,O,0),Y.push((b+.5)/x,0);for(b=0;x>b;b++)K.push(M+b,M+b+1,M+(x+1)+b);if(u){var c=[],I=[],V=[];for(c.push(0,-O,0),I.push(.5,.5),b=0;x>=b;b++)F=b*P+s,k=W(F),X=_(F),c.push(k*O,-O,-X*O),I.push(.5+.5*k,.5+.5*X);for(b=0;x>b;b++)V.push(0,b+2,b+1)}return{vs:h,uv:Y,is:K,bottom_vs:c,bottom_uv:I,bottom_is:V}},gr=function($,Z,m,Q,C,A,k,P){$=$||16,Z=Z||0,m=m||$,k=k||1;var u,V,r,p,Y,S,z,n=.5,U=[],K=[],f=L/$,d=Z,i=1/k,V=new Bb,r=new Bb,O=new Bb,l=new Bb,F=new Bb,I=new Bb,D=new Bb;for(P&&(u=[],Y=new Bb,S=new Bb,z=new Bb);m>d;d++){var T=d+1,G=f*d,B=f*T;for(V.set(W(G)*n,-n,-_(G)*n),r.set(W(B)*n,-n,-_(B)*n),O.set(0,n,0),P&&(Y.set(W(G),.5,-_(G)).normalize(),S.set(W(B),.5,-_(B)).normalize(),z.copy(Y).add(S).normalize()),l.lerpVectors(O,V,i),F.lerpVectors(O,r,i),U.push(l.x,l.y,l.z,F.x,F.y,F.z,O.x,O.y,O.z),K.push(d/$,i,T/$,i,(d+T)/2/$,0),P&&u.push(Y.x,Y.y,Y.z,S.x,S.y,S.z,z.x,z.y,z.z),p=1;k>p;p++)l.lerpVectors(O,V,i*(p+1)),F.lerpVectors(O,r,i*(p+1)),I.lerpVectors(O,V,i*p),D.lerpVectors(O,r,i*p),U.push(l.x,l.y,l.z,F.x,F.y,F.z,I.x,I.y,I.z,I.x,I.y,I.z,F.x,F.y,F.z,D.x,D.y,D.z),K.push(d/$,i*(p+1),T/$,i*(p+1),d/$,i*p,d/$,i*p,T/$,i*(p+1),T/$,i*p),P&&u.push(Y.x,Y.y,Y.z,S.x,S.y,S.z,Y.x,Y.y,Y.z,Y.x,Y.y,Y.z,S.x,S.y,S.z,S.x,S.y,S.z)}if(A){var v=[],a=[];for(d=Z;m>d;d++){G=f*d,B=f*(d+1);var E=W(G),X=_(G),R=W(B),j=_(B);v.push(E*n,-n,-X*n,0,-n,0,R*n,-n,-j*n),a.push(.5+.5*E,.5+.5*X,.5,.5,.5+.5*R,.5+.5*j)}}if(Q){var q=[],s=[];G=f*Z,q.push(0,n,0,0,-n,0,W(G)*n,-n,-_(G)*n),s.push(0,0,0,1,Z/$,1)}if(C){var o=[],M=[];G=f*m,o.push(0,-n,0,0,n,0,W(G)*n,-n,-_(G)*n),M.push(1,1,1,0,m/$,1)}var c={vs:U,uv:K,bottom_vs:v,bottom_uv:a,from_vs:q,from_uv:s,to_vs:o,to_uv:M};return P&&(c.ns=u),c},bh=function(U,J,x,V,E,_,v,c){for(var D=[],Z=0;Z<U.length-1;Z+=2)D.push({x:U[Z],y:U[Z+1]});return zc(D,J,x,V,E,_,v,c,!1)},_p={roundRect:function(j,x){return bh([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],j,x,3)},star:function(R,L){return bh([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],R,L)},rect:function(s,U){return bh([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],s,U)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(b,R){return bh([0,-.5,.5,.5,-.5,.5],[1,2,2,5],b,R)},rightTriangle:function(J,t){return bh([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],J,t)},parallelogram:function(V,U){return bh([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],V,U)},trapezoid:function(b,$){return bh([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],b,$)}},yr={sphere:1,cylinder:1,cone:1,torus:1},wb={torus:1,sphere:1,cone:1},Ld=oi(Wi(_p),{cylinder:1}),Cp=oi(Wi(_p),{cylinder:1,cone:1}),df=function(f,C,I){var n,U=gs(f.anchor3d,I,C),z=gs(f.mat,I,C),L=gs(f.s3,I,C),T=gs(f.t3,I,C),x=gs(f.r3,I,C),g=L||x||T||z;if(U||g){n=Km(C._6O);var l=g?wi(z,L,x,gs(f.rotationMode,I,C),T):Wq();U&&Lj(l,[.5-U[0],.5-U[1],.5-U[2]]),hn(C,l)}return n},_h=function(C,N,U,W,Z,x,b){if(Vd(U))U.forEach(function(D){_h(C,N,D,W,Z,x,b)});else if(Xj(U))_h(C,N,ub(W,U),W,Z,x,b);else if(Np(U))if(U.shape3d){var h=df(U,C,N);_h(C,N,U.shape3d,W,Z,x,U),h&&ur(C,h)}else Jn(C,N,U,W.s,Z,x,b)},Jn=function($,w,h,B,W,P,I){if(I=I||pr,!P||P(B("shape3d.transparent",h.transparent,I.transparent))){var Z=df(h,$,w);if(vh(h)){var k=$.getData3dUI(w);k.dispatchBoundingBoxChanged()}var Y=$._26I,V=$._prg,e=$._buffer,v=B("shape3d.color",h.color,I.color);W||(W=B("shape3d.blend",h.blend,I.blend));var o,q=h.opacity==g?I.opacity:h.opacity,U=B("shape3d.opacity");o=U!=g&&q!=g?q*U:q!=g?q:U,oe(Y,V,W,B("shape3d.light",h.light,I.light),o,B("shape3d.reverse.flip",h.reverseFlip,I.reverseFlip),B("shape3d.reverse.color",h.reverseColor,I.reverseColor),B("shape3d.reverse.cull",h.reverseCull,I.reverseCull));var j=B("polygonOffset",h.polygonOffset,I.polygonOffset);h.vs&&B(ok,h.visible,I.visible)&&fb(Y,V,e,v,$.getTexture(B("shape3d.image",h.image,I.image),w),B("shape3d.discard.selectable",h.discardSelectable,I.discardSelectable),h.vs,h.uv,h.ns,h.is,B("shape3d.uv.offset",h.uvOffset,I.uvOffset),B("shape3d.uv.scale",h.uvScale,I.uvScale),B("shape3d.uv.rotation",h.uvRotation,I.uvRotation),B("shape3d.uv.anchor",h.uvAnchor,I.uvAnchor),j),h.top_vs&&B(Dn,h.topVisible,I.topVisible)&&fb(Y,V,e,B("shape3d.top.color",h.topColor,I.topColor)||v,$.getTexture(B("shape3d.top.image",h.topImage,I.topImage),w,"top"),B("shape3d.top.discard.selectable",h.topDiscardSelectable,I.topDiscardSelectable),h.top_vs,h.top_uv,h.top_ns,h.top_is,B("shape3d.top.uv.offset",h.topUvOffset,I.topUvOffset),B("shape3d.top.uv.scale",h.topUvScale,I.topUvScale),B("shape3d.top.uv.rotation",h.topUvRotation,I.topUvRotation),B("shape3d.top.uv.anchor",h.topUvAnchor,I.topUvAnchor),j),h.bottom_vs&&B(Mo,h.bottomVisible,I.bottomVisible)&&fb(Y,V,e,B("shape3d.bottom.color",h.bottomColor,I.bottomColor)||v,$.getTexture(B("shape3d.bottom.image",h.bottomImage,I.bottomImage),w,"bottom"),B("shape3d.bottom.discard.selectable",h.bottomDiscardSelectable,I.bottomDiscardSelectable),h.bottom_vs,h.bottom_uv,h.bottom_ns,h.bottom_is,B("shape3d.bottom.uv.offset",h.bottomUvOffset,I.bottomUvOffset),B("shape3d.bottom.uv.scale",h.bottomUvScale,I.bottomUvScale),B("shape3d.bottom.uv.rotation",h.bottomUvRotation,I.bottomUvRotation),B("shape3d.bottom.uv.anchor",h.bottomUvAnchor,I.bottomUvAnchor),j),h.from_vs&&B(xh,h.fromVisible,I.fromVisible)&&fb(Y,V,e,B("shape3d.from.color",h.fromColor,I.fromColor)||v,$.getTexture(B("shape3d.from.image",h.fromImage,I.fromImage),w,"from"),B("shape3d.from.discard.selectable",h.fromDiscardSelectable,I.fromDiscardSelectable),h.from_vs,h.from_uv,h.from_ns,h.from_is,B("shape3d.from.uv.offset",h.fromUvOffset,I.fromUvOffset),B("shape3d.from.uv.scale",h.fromUvScale,I.fromUvScale),B("shape3d.from.uv.rotation",h.fromUvRotation,I.fromUvRotation),B("shape3d.from.uv.anchor",h.fromUvAnchor,I.fromUvAnchor),j),h.to_vs&&B(fc,h.toVisible,I.toVisible)&&fb(Y,V,e,B("shape3d.to.color",h.toColor,I.toColor)||v,$.getTexture(B("shape3d.to.image",h.toImage,I.toImage),w,"to"),B("shape3d.to.discard.selectable",h.toDiscardSelectable,I.toDiscardSelectable),h.to_vs,h.to_uv,h.to_ns,h.to_is,B("shape3d.to.uv.offset",h.toUvOffset,I.toUvOffset),B("shape3d.to.uv.scale",h.toUvScale,I.toUvScale),B("shape3d.to.uv.rotation",h.toUvRotation,I.toUvRotation),B("shape3d.to.uv.anchor",h.toUvAnchor,I.toUvAnchor),j),eq(Y,V),Z&&ur($,Z)}},fb=function(t,L,J,Y,W,l,K,o,I,A,v,Z,T,p,i){if(K){i&&Vj(t,i);var $=ts.for(t),b=$.directUniforms(),R=$.directAttribs();b.uDiffuse=Y||x["color.empty"],o?eh(t,L,W,l,J.uv,o,v,Z,T,p):eh(t),R.aPosition=bo(t,J.vs,K,g),R.aNormal=bo(t,J.ns,I,g),A?(Zr(t,J.is,A),ih(t,0,A.length,null,A instanceof Uint32Array?t.UNSIGNED_INT:null)):Co(t,0,K.length/3),o?uk(t,L,W):uk(t),i&&Ln(t)}},ub=function(T,d){var N=T.s;if(d||(d=N(wq)),!d)return g;var f=Ge(d);if(f)return f;if("text"===d){var z={amount:N("shape3d.text.amount"),size:N("shape3d.text.size"),font:N("shape3d.text.font"),style:N("shape3d.text.style"),weight:N("shape3d.text.weight"),fill:N("shape3d.text.fill"),curveSegments:N("shape3d.text.curveSegments"),spacing:N("shape3d.text.spacing"),cube:N("shape3d.text.cube")},K=T.gv.getShape3dText(T.data),G=K;for(var m in z)G+="_"+(z[m]===s?"U":z[m]);return T._cachedTextKey===G?T._cachedTextGeometry:(T._cachedTextKey=G,T._cachedTextGeometry=p.createTextGeometry(K,z))}var m=d;if(yr[d]){var F=N("shape3d.side"),R=N("shape3d.side.from"),w=N("shape3d.side.to"),k=N(xh),$=N(fc);3>F?(F=0,R=0,w=0,k=!1,$=!1):((R==g||0>R)&&(R=0),(w==g||w>F)&&(w=F),0===R&&w===F&&(k=!1,$=!1));var r=N("shape3d.smooth");m+="-"+F+"-"+R+"-"+w+"-"+k+"-"+$+(r?1:0)}if(Ld[d]){var b=N(Dn);m+="-"+b}if(Cp[d]){var y=N(Mo);m+="-"+y}if("torus"===d){var q=N("shape3d.torus.radius");0>q?q=0:q>.25&&(q=.25),m+="-"+q}if(wb[d]){var D=N(Ol);m+="-"+D}return f=bm[m],f||("box"===d?f=p.createBoxModel():_p[d]?f=_p[d](b,y):"sphere"===d?f=p.createSphereModel(F,R,w,k,$,D,r):d===tj?f=p.createCylinderModel(F,R,w,k,$,b,y,r):"cone"===d?f=p.createConeModel(F,R,w,k,$,y,D,r):"torus"===d&&(f=p.createTorusModel(F,R,w,k,$,q,D,r)),bm[m]=f),f},vh=function(){var i=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],K=["is","top_is","bottom_is","from_is","to_is"];return f=yj(No.substr(No.indexOf("^#")+2)),Od(p[wd(Bh+i[15]+"n"+i[16])]())&&Ub()?function(c){return c&&!c._complete_?(c._complete_=!0,c.vs&&ld(c.ns)&&(c.ns=Cl(c.vs,c.is),c.boundingBox=s),c.top_vs&&ld(c.top_ns)&&(c.top_ns=Cl(c.top_vs,c.top_is),c.top_boundingBox=s),c.bottom_vs&&ld(c.bottom_ns)&&(c.bottom_ns=Cl(c.bottom_vs,c.bottom_is),c.bottom_boundingBox=s),c.from_vs&&ld(c.from_ns)&&(c.from_ns=Cl(c.from_vs,c.from_is),c.from_boundingBox=s),c.to_vs&&ld(c.to_ns)&&(c.to_ns=Cl(c.to_vs,c.to_is),c.to_boundingBox=s),i.forEach(function(h){var y=c[h];Vd(y)&&(c[h]=new Yp(y))}),K.forEach(function(M){var A=c[M];Vd(A)&&(c[M]=new Sb(A))}),!0):!1}:void 0}(),Vr=function(C,H){var p=C[H];Vd(p)&&(C[H]=new Yp(p))};oi(xn,{_25Q:function(w){w._16O=function(e,s,L,p,A,E,a,V,u){var l=this.info;if(l){var F,X,Z,S,b,H,d=Wq();if(yb[s]?(F=l.p3,X=l.c1,Z=l.c2):Bc[s]?(X=l.s1||l.c1,Z=l.s2||l.c2):(X=l.t1||l.c1,Z=l.t2||l.c2),F)H=ef(s,He,L,p,V,u);else{var W=Nh(Z,X),x=lr(X,Z);S=[0,-xb(W[2],W[0]),m(W[1]/x)],b="zyx",F=[(X[0]+Z[0])/2,(X[1]+Z[1])/2,(X[2]+Z[2])/2],H=ef(s,[x,0,0],L,p,V,u)}return al(d,H,F,p,A,E,a,e,S,b)}return Rp},w._80o=function(z,r,S){var q=this,T=q.shapeModel;if(T){var I=q.gv;hn(I),_h(I,q.data,T,q,q.getBodyColor(),S)}},w.createLineModel=function(D,C,k,X,t){var u=this,q=u.s,B=Ne(D,C,q(Ol)),G=q(X+".color");if(G){for(var F=[],L=0;L<B.length;L++){var M=B[L],s=M.length;if(s>1){var z=M[0];F.push(z.x,z.y,z.z);for(var K=1;s-1>K;K++)z=M[K],F.push(z.x,z.y,z.z),F.push(z.x,z.y,z.z);z=M[s-1],F.push(z.x,z.y,z.z)}}var f,m,W,U=q(t),V=0;U&&(m=q(t+".color"),f=q(t+".pattern"),V=q(t+".offset"),W=G),pl(u.gv,u.data,F,m||G,W?g:q(X+".gradient.color"),k,f||q(X+".pattern"),V,W)}return B},w.createTubeModel=function(K,z,i,J){for(var s=this,c=s.s,X=c("shape3d.side")||Sq,_=c("shape3d.start.angle"),V=c("shape3d.sweep.angle"),u=c(Dn)?c("shape3d.top.cap"):g,M=c(Mo)?c("shape3d.bottom.cap"):g,I="flat"===u,p="flat"===M,v=I&&(J?J.uv:c("shape3d.top.image")),H=p&&(J?J.uv:c("shape3d.bottom.image")),U=J?J.uv:c("shape3d.image"),N=c("shape3d.smooth"),y={vs:[],uv:U?[]:g,ns:N?[]:g,top_vs:I?[]:g,top_uv:v?[]:g,bottom_vs:p?[]:g,bottom_uv:H?[]:g},F=Ne(K,z,c(Ol),i),w=0,d=F.length;d>w;w++)am(y,F[w],c(xf),i,X,_,V,u,M);return J?Eq(s.gv,s.data,y,s,s.getBodyColor(),s.mat?[s.mat]:[],J):s.shapeModel=y,s.lineShapeModel=y,F},w.getCache=function(){var F=this.info;if(F){var Q=F.list;if(Q){var T=F.cache;return T||(T=F.cache=qk(Q)),T}}return g}}});var rh=function(w,N){for(var F,p=0,S=w.length,x=0,L=S-1;L>=x;)if(p=l(x+(L-x)/2),F=w[p].length-N,0>F)x=p+1;else{if(!(F>0)){L=p;break}L=p-1}p=L;var X=w[p],M=X.point;return p===S-1||X.length===N||(M=(new Qh).subVectors(w[p+1].point,M).normalize().multiplyScalar(N-X.length).add(M)),{point:M,tangent:X.tangent}},qk=function(p){for(var m,U,h=[],H=0,F=0;F<p.length;F++){for(var u=p[F],x=0;x<u.length;x++){m=u[x],U&&(H+=U.distanceTo(m));var i=new Qh,t=u[x+1];t?i.subVectors(t,m):U?i.subVectors(m,U):i.x=1,i.normalize(),h.push({point:m,length:H,tangent:i}),U=m}U=null}return h},Ne=function(S,x,f,B){f=f||cm;for(var z=[],n=0,L=S.size();L>n;n++){var W=S.get(n);z.push(new Qh(W.x,W.e||0,W.y))}x&&(Qq(x)&&(x=x._as),x.length||(x=null));for(var a,$,w,U,j,r=[],F=[],X=0,s=0,k=x?x.length:L;k>s;s++){if(j=x?x[s]:0===s?1:2,1===j)r.push(w=[]),w.push(z[X++]);else if(2===j||5===j)if(U=2===j?z[X++]:w[0],B){var T=x?x[s+1]:k>s+1?2:g;if(2===T||5===T){var H=w[w.length-1],p=2===T?z[X]:w[0],I=(new Qh).subVectors(H,U),u=(new Qh).subVectors(p,U),m=I.length(),A=u.length();if(m&&A)if(B>m/2&&B>A/2)w.push(U);else for(I.multiplyScalar(Q(B,m/2)/m).add(U),u.multiplyScalar(Q(B,A/2)/A).add(U),a=new sr(I,U,u).getPoints(f),$=0;f>=$;$++)w.push(a[$])
}else w.push(U)}else w.push(U);else if(3===j)for(a=new sr(w[w.length-1],z[X++],z[X++]).getPoints(f),$=1;f>=$;$++)w.push(a[$]);else if(4===j)for(a=new vf(w[w.length-1],z[X++],z[X++],z[X++]).getPoints(f),$=1;f>=$;$++)w.push(a[$]);F.push(r.length,w.length)}return r.indexMark=F,r},Ad=function(y){for(var $,F,w=new Qh,j=[],O=[],k=[],M=0,e=y.length;e>M;M++)$=y[M],F=y[M+1],F?w.subVectors(F,$):w.subVectors($,y[M-1]),j.push(w.normalize().clone());var X,z=new Qh,I=new Qh,D=new cr,L=1e-4,x=j[0],E=O[0]=new Qh,H=k[0]=new Qh;for(Math.abs(Math.abs(x.y)-1)<L?z.set(1,0,0):z.set(0,1,0),I.crossVectors(x,z).normalize(),E.crossVectors(x,I),H.crossVectors(x,E),M=1;e>M;M++)O[M]=O[M-1].clone(),k[M]=k[M-1].clone(),I.crossVectors(j[M-1],j[M]),I.length()>L&&(I.normalize(),X=Z(ir(j[M-1].dot(j[M]),-1,1)),O[M].applyMatrix4(D.makeRotationAxis(I,X))),k[M].crossVectors(j[M],O[M]);return{B:k,T:j,N:O}},am=function(){var H=function(N){for(var l=1;l<arguments.length;l++){var T=arguments[l];N.push(T.x,T.y,T.z)}},G=function(F){for(var k=1;k<arguments.length;k++){var W=arguments[k].uv;F.push(W[0],W[1])}},j=function(E){for(var i=1;i<arguments.length;i++){var k=arguments[i].ns;E.push(k[0],k[1],k[2])}},x=function(Q,i,O,N,V){var C=-N*W(V),G=N*_(V);return new Qh(Q.x+C*O.x+G*i.x,Q.y+C*O.y+G*i.y,Q.z+C*O.z+G*i.z)},h=function($,F,f,V,S,u,H,h,j){H=H||L;for(var J,O=[],n=H/S,J=j?new Bb:g,v=0;S>=v;v++){var I=x($,F,f,V,v*n+u);O.push(I),h!=g&&(I.uv=[h,1-v/S]),j&&(I.ns=J.subVectors(I,$).normalize().toArray())}return O},B=function(I,d,t,D,k,F,P,u,A){A=A||L;var y=d?I.top_vs:I.bottom_vs;if(y)for(var J=d?I.top_uv:I.bottom_uv,o=A/P,j=0;P>j;j++){var O,S;d?(O=j*o+u,S=(j+1)*o+u):(S=j*o+u,O=(j+1)*o+u),H(y,x(t,D,k,F,O),x(t,D,k,F,S),t),J&&J.push(.5-.5*W(O),.5-.5*_(O),.5-.5*W(S),.5-.5*_(S),.5,.5)}};return function(W,z,t,S,T,e,k,E,p){var Z=z.length;if(Z>1){var X,v,a,L,P,d,O,r=Ad(z),$=r.T,Q=r.N,x=r.B;"flat"===E&&B(W,!0,z[0],x[0],Q[0],S,T,e,k),"flat"===p&&B(W,!1,z[Z-1],x[Z-1],Q[Z-1],S,T,e,k);var A,b,m=[],U=y(T/2),D="round"===E,R="round"===p,l=z[0],n=$[0],K=x[0],N=Q[0],I=z[Z-1],f=$[Z-1],u=x[Z-1],C=Q[Z-1];if(D){for(a=1;U>=a;a++)Q.splice(0,0,N),x.splice(0,0,K),$.splice(0,0,n),b=-a/U*S,z.splice(0,0,n.clone().multiplyScalar(b).add(l)),m[U-a]=w(S*S-b*b);Z+=U}if(R){for(a=1;U>=a;a++)Q.push(C),x.push(u),$.push(f),b=a/U*S,z.push(f.clone().multiplyScalar(b).add(I)),m[z.length-1]=w(S*S-b*b);Z+=U}if(W.uv){var Y=0,i=0,F=[];for(t&&(Y=t),P=z[0],F[0]=0,a=1;Z>a;a++)L=z[a],F[a]=P.distanceTo(L),P=L,t||(Y+=F[a]);for(A=[],a=0;Z>a;a++)i+=F[a],A[a]=Y?i/Y:0}var o=W.ns?!0:!1;for(a=0;Z>a;a++){if(L=z[a],d=x[a],O=Q[a],X=h(L,d,O,m[a]===s?S:m[a],T,e,k,A?A[a]:g,o),v)for(var c=0;T>c;c++){var V=v[c],_=v[c+1]||v[0],J=X[c],M=X[c+1]||X[0];H(W.vs,_,V,J,J,M,_),W.uv&&G(W.uv,_,V,J,J,M,_),o&&j(W.ns,_,V,J,J,M,_)}v=X}}}}();oi(p,{getLineLength:function(j){return j[j.length-1].length},getLineOffset:function(U,N){return rh(U,N)},getLineCacheInfo:function(p,H,X,w){return qk(Ne(p,H,X,w))}});var Dl=U.graph3d.RenderLite={},Hg=new Array(0),qe=Dl.Buffer=function(N,T,A,t){this.gl=N,this.buffer=N.createBuffer(),this.type=T||N.ARRAY_BUFFER,this.drawType=t||N.STATIC_DRAW,this.data=Hg,A&&this.upload(A)};qe.prototype.upload=function(x,v,k){k||this.bind();var o=this.gl;x=x||this.data,v=v||0,this.data.byteLength>=x.byteLength?o.bufferSubData(this.type,v,x):o.bufferData(this.type,x,this.drawType),this.data=x},qe.prototype.bind=function(){var z=this.gl;z.bindBuffer(this.type,this.buffer)},qe.createVertexBuffer=function(R,X,S){return new qe(R,R.ARRAY_BUFFER,X,S)},qe.createIndexBuffer=function(l,g,h){return new qe(l,l.ELEMENT_ARRAY_BUFFER,g,h)},qe.create=function(d,b,x,Q){return new qe(d,b,Q)},qe.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var od=Dl.Shader=function(W,U,v){this.gl=W,this.program=Md(W,U,v),this.attributes=Ep(W,this.program);var g=ds(W,this.program);this.uniforms=Vl(W,g)};od.prototype.bind=function(){this.gl.useProgram(this.program)},od.prototype.destroy=function(){this.gl};var Md=function(c,L,n){var A=so(c,c.VERTEX_SHADER,L),j=so(c,c.FRAGMENT_SHADER,n),H=c.createProgram();return c.attachShader(H,A),c.attachShader(H,j),c.linkProgram(H),c.getProgramParameter(H,c.LINK_STATUS)||(Jo("LINK","LITE",c.getProgramParameter(H,c.VALIDATE_STATUS),c.getError(),c.getProgramInfoLog(H)),c.deleteProgram(H),H=null),c.deleteShader(A),c.deleteShader(j),H},so=function(M,p,b){var g=M.createShader(p);return M.shaderSource(g,b),M.compileShader(g),M.getShaderParameter(g,M.COMPILE_STATUS)?g:(Jo("COMPILE","LITE",p,M.getError(),M.getShaderInfoLog(g)),null)},ds=function(x,D){for(var n={},o=x.getProgramParameter(D,x.ACTIVE_UNIFORMS),s=0;o>s;s++){var R=x.getActiveUniform(D,s),X=R.name.replace(/\[.*?\]/,""),$=Gc(x,R.type);n[X]={type:$,size:R.size,location:x.getUniformLocation(D,X),value:me($,R.size)}}return n},Ep=function($,V){for(var W={},b=$.getProgramParameter(V,$.ACTIVE_ATTRIBUTES),w=0;b>w;w++){var X=$.getActiveAttrib(V,w),l=Gc($,X.type);W[X.name]={type:l,size:ej(l),gl:$,location:$.getAttribLocation(V,X.name),pointer:Th}}return W},Th=function(V,R,x,U,B){var b=this.gl;b.enableVertexAttribArray(this.location),V instanceof Dl.Buffer||(V=Dl.Buffer.createVertexBuffer(b,V)),b.bindBuffer(V.type,V.buffer),b.vertexAttribPointer(this.location,this.size,R||b.FLOAT,x||!1,U||0,B||0)},ej=function(P){return oh[P]},oh={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},Gc=function(C,R){if(!rl){var h=z.keys(cp);rl={};for(var r=0;r<h.length;++r){var j=h[r];rl[C[j]]=cp[j]}}return rl[R]},rl=null,cp={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},me=function(D,y){switch(D){case"float":return 0;case"vec2":return new Float32Array(2*y);case"vec3":return new Float32Array(3*y);case"vec4":return new Float32Array(4*y);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*y);case"ivec3":return new Int32Array(3*y);case"ivec4":return new Int32Array(4*y);case"bool":return!1;case"bvec2":return sc(2*y);case"bvec3":return sc(3*y);case"bvec4":return sc(4*y);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},sc=function(V){for(var y=new Array(V),E=0;E<y.length;E++)y[E]=!1;return y},Vl=function(f,V){var M={data:{}};M.gl=f;for(var l=z.keys(V),h=0;h<l.length;h++){var t=l[h],A=t.split("."),J=A[A.length-1],Z=Bi(A,M),L=V[t];Z.data[J]=L,Z.gl=f,z.defineProperty(Z,J,{get:ki(J),set:ws(J,L)})}return M},ki=function(X){var A=Jh.replace("%%",X);return new Function(A)},ws=function(O,h){var S,f=kc.replace(/%%/g,O);return S=1===h.size?Pp[h.type]:vl[h.type],S&&(f+="\nthis.gl."+S+";"),new Function("value",f)},Bi=function(D,C){for(var V=C,u=0;u<D.length-1;u++){var L=V[D[u]]||{data:{}};V[D[u]]=L,V=L}return V},Jh=["return this.data.%%.value;"].join("\n"),kc=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),Pp={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},vl={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},Vg=function(G){function R(W){if("string"!=typeof W)return 0|W;switch(W){case"low":return 512;case"medium":return 1024;case"ultra":return 4096;default:return 2048}}function M(){A.enable=!p.graph3dViewShadowDisabled,u=p.graph3dViewShadowType,H=p.graph3dViewShadowIntensity,c=p.graph3dViewShadowBias,o=p.graph3dViewShadowQuality,w=p.graph3dViewShadowRadius,b=p.graph3dViewShadowDegreeX,v=p.graph3dViewShadowDegreeZ}var A=this;A.enable=!1;var u,H,c,o,w,b,v;M();var K,T,I,Q,t=1,N=R(o),y=!1,C=new U.Math.Matrix4,B=new U.Math.Matrix4,h=A.pvMatrix=new U.Math.Matrix4,X=0;A.render=function(){if(!G._picking&&A.enable){var g=G.getGL();if(g){if(y&&A.setupShadowCamera(),G._glCapabilities&&(N=Math.min(N,G._glCapabilities.maxTextureSize)),Q=G.isReflecting(g)){if(X===g._renderInfo.frame)return;X=g._renderInfo.frame}var l=Q?"mapForReflector":"map";if((K=A[l])?K.setSize(N,N):K=A[l]=new Zp(G,G.getGL(),0,0,{samples:1,minFilter:gq.NEAREST,magFilter:gq.NEAREST,width:N,height:N}),!g._shadowShader){var i="#define MAX_BOX_CLIPPER "+G._boxClippers.length;g._shadowShader=new Dl.Shader(g,Vg.shaderSrc.vs.replace("$DEFINE",i),Vg.shaderSrc.fs.replace("$DEFINE",i))}var Y=G._frameState,O=Y.renderState.glState;O.blend.enabled=!1,O.depth.enabled=!0,O.depth.mask=!0;var I=O.color.clear.slice(0);Un(g,[1,1,1,1]),Y.renderState.useProgram(g._shadowShader.program),S(),Un(g,I)}}},A.deleteShadowProgram=function(){var I=G.getGL();I&&I._shadowShader&&(I.deleteProgram(I._shadowShader.program),I._shadowShader=null)},A.getShadow=function(){var l={degreeX:b,degreeZ:v,intensity:H,quality:o,type:u,radius:w,bias:c};return 1!==t&&(l.boundExtend=t),l},A.setShadow=function(F,Z){F=!!F;var Y=A.enable!==F;A.enable=F,"object"==typeof Z&&(Z.intensity!==s&&(H=Z.intensity),Z.bias!==s&&(c=Z.bias),Z.radius!==s&&(w=Z.radius),Z.degreeX!==s&&(b=Z.degreeX),Z.degreeZ!==s&&(v=Z.degreeZ),Z.quality!==s&&(o=Z.quality),Z.type!==s&&u!==Z.type&&(u=Z.type,Y=!0),N=R(o),Z.boundExtend!==s&&(t=Z.boundExtend)),F&&A.setupShadowCamera(),Y&&Nn(G),G.iv()};var d=null;A.tryInvalidateLater=function(m,Y){"modelLoaded"===Y&&(d&&es(d,!0),d=oq(function(){d=null,A.refresh()},A,s,200))},A.refresh=function(){this.enable&&(this.setupShadowCamera(),G.iv())},A.tryUpdateBounding=function(D){var d=this.boundingSphere;if(d){var u=(new cr).fromArray(Ph(D,G.getMat(D))),V=D.getAnchor3d(),s=new Bb;d.containsPoint(s.set(0-V.x,0-V.y,0-V.z).applyMatrix4(u))&&d.containsPoint(s.set(0-V.x,0-V.y,1-V.z).applyMatrix4(u))&&d.containsPoint(s.set(0-V.x,1-V.y,0-V.z).applyMatrix4(u))&&d.containsPoint(s.set(0-V.x,1-V.y,1-V.z).applyMatrix4(u))&&d.containsPoint(s.set(1-V.x,0-V.y,0-V.z).applyMatrix4(u))&&d.containsPoint(s.set(1-V.x,0-V.y,1-V.z).applyMatrix4(u))&&d.containsPoint(s.set(1-V.x,1-V.y,0-V.z).applyMatrix4(u))&&d.containsPoint(s.set(1-V.x,1-V.y,1-V.z).applyMatrix4(u))||A.setupShadowCamera()}},A.createShadow=function(t){if(t||(t=G._frameState.renderState.directUniforms()),t.shadowMatrix=h.toArray(),G._getFrameRenderOptions("renderShadow")===!1){var g,k=G.getGL();(g=k._emptyShadowTexture)||(g=k._emptyShadowTexture=dp(k,null,[255,255,255,255])),t.shadowMap=g}else{var X=G._getFrameRenderOptions("useReflectorSelfShadowMap")&&A.mapForReflector;t.shadowMap=X?A.mapForReflector.texture:A.map.texture}t.shadowSize=[K.width,K.height],t.shadowIntensity=H,t.shadowBias=c,t.shadowRadius=w},A.genShaderDefine=function(){var s="#define USE_SHADOWMAP\n";return"hard"===u?s+="#define SHADOWMAP_TYPE_PCF\n":"soft"===u&&(s+=G.isGLTempRegisterLimited()?"#define SHADOWMAP_TYPE_PCF\n":"#define SHADOWMAP_TYPE_PCF_SOFT\n"),s};var P;A.setupShadowCamera=function(){T||(T=A.boundingSphere=new U.Math.Sphere),y=!1;var s,q,k=G.getBoundingBox(G.dm().toDatas(function(O){return O.s("shadow.cast")&&G.isVisible(O)}));k?(s=new Bb(k.min),q=new Bb(k.max)):(s=new Bb(-256,-256,-256),q=new Bb(256,256,256),y=!0),T.set(s.clone().add(q).multiplyScalar(.5),.5*s.distanceTo(q)*t);var p,S=T.radius,M=G.getBoundingBox(G.dm().toDatas(function(n){return(n.s("shadow.cast")||n.s("shadow.receive"))&&G.isVisible(n)}));if(M){s.copy(M.min),q.copy(M.max);var l=.5*s.distanceTo(q);p=l+Math.min(l,S+T.center.distanceTo(s.add(q).multiplyScalar(.5)))}else p=2*S;P=us(Wq(),-S,S,-S,S,p/1e3,p),h.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),h.multiply(C.fromArray(P));var o=Math.tan(-b*Math.PI/180),i=Math.tan(-v*Math.PI/180),j=S/Math.sqrt(o*o+i*i+1),E=new Bb(j*o,j,j*i);C.lookAt(E,new Bb(0,0,0),new Bb(0,1,0)).setPosition(E.add(T.center)),C.getInverse(C),h.multiply(C)};var S=function(){var L=G.getGL(),t=N,r=N;K.setSize(L,t,r),K.bind(L),L.clear(gq.COLOR_BUFFER_BIT|gq.DEPTH_BUFFER_BIT);var Q=G._frameState,e=Q.renderState,C=e.directUniforms(),E=e.directAttribs(),U=e.directState();C.projectionMatrix=P,(I=G._boxClippers.length>0)&&(mi(G,C,pk),C.uClipperMatrix=G._boxClipperMatrixes,C.uClipperClipInner=G._boxClipperClipInner);var M=G._viewport;G.setViewport(L,0,0,t,r);var k,w,q,S;for(k=0,w=tq.length;w>k;k++)if(q=tq[k],!wk[q].ignore&&(S=G._40Q.get(q))){var J=S.batchIndexMap;A.renderItems(L,C,E,U,S.opaque,J),A.renderItems(L,C,E,U,S.transparent,J),A.renderBatch(L,C,E,U,S.batchModelMap,J)}K.unbind(L),G.setViewport(L,M[0],M[1],M[2],M[3])};A._renderDirect=function(B,X,x,W){x&&x.length&&(X.position=bo(B,G._buffer.vs,x,g),W?(Zr(B,G._buffer.is,W),ih(B,0,W.length,null,W instanceof Uint32Array?B.UNSIGNED_INT:null)):Co(B,0,x.length/3))},A.renderShapeModel=function(F,K,z,G){var c,N,E;if(Vd(z))for(N=0,E=z.length;E>N;N++)c=z[N],c&&A.renderShapeModel(F,K,c,G);else Xj(z)?A.renderShapeModel(F,K,ub(G,z),G):Np(z)&&(z.shape3d?A.renderShapeModel(F,K,z.shape3d,G):A.renderShapeModelImpl(F,K,z))},A.renderShapeModelImpl=function(e,L,Z){vh(Z),A._renderDirect(e,L,Z.vs,Z.is),A._renderDirect(e,L,Z.top_vs,Z.top_is),A._renderDirect(e,L,Z.bottom_vs,Z.bottom_is),A._renderDirect(e,L,Z.from_vs,Z.from_is),A._renderDirect(e,L,Z.to_vs,Z.to_is)},A.renderBatch=function(b,H,v,q,O){if(!Lg(O)&&!G.drawFilter){H.modelViewMatrix=B.identity().premultiply(C).toArray();var N,n,$;for(N in O)$=G.getBatchInfo(N)||pr,$.visible!==!1&&$.shadowCast!==!1&&(Q&&$.reflectable===!1||(n=O[N],n.invalidate&&Yi(n),I&&(H.modelMatrix=Tn,mi(G,H,$.clipboxMask===s?Be:$.clipboxMask)),A._renderDirect(b,v,n.vs32,n.is)))}},A.renderItems=function(H,j,E,e,m,X){var h,g,u,W,s,F,r=m.length;for(h=0;r>h;h++)if(g=m[h],W=g.ui,u=g.data,!(Dd(u)||!u.s("shadow.cast")||u instanceof Ur||u.s("effect.flow")||!G.isVisible(u)||X[u._id]||Q&&u.s("3d.reflectable")===!1)){var a=W.s("3d.clip.direction");if(a){var R=W.s("3d.clip.percentage");if(0===R)continue;var n=W._formatClipUniforms(a,R,u);j.uClipPercent=n[1],j.uClipDirection=n[0]}else j.uClipDirection=0;if(s=W.shapeModel||ub(W),s||(s=u instanceof U.Node&&!(u instanceof U.Shape)?{vs:jq,is:Pq}:[W.left,W.front,W.right,W.back,W.top,W.bottom]),F=W.mat?B.fromArray(W.mat):B.identity(),p.extractShapeTranslation){var M=W._vsTranslation;M&&F.multiply(M)}I&&(j.modelMatrix=F.toArray(),mi(G,j,u.s("3d.clipbox")?pk:u.s("3d.clipbox.mask"))),j.modelViewMatrix=F.premultiply(C).toArray(),e.cullFace.enabled=!!u.s("shape3d.reverse.cull"),A.renderShapeModel(H,E,s,W)}},A.resetProperties=M};Vg.shaderSrc={vs:["$DEFINE","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","attribute vec3 position;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform mat4 modelMatrix;","varying vec3 vWorld;","\n #endif \n","varying vec3 vPosition;","void main() {","vec3 transformed = vec3( position );","vPosition = vec3(position);","vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );","\n #if MAX_BOX_CLIPPER > 0 \n","vWorld = vec3(modelMatrix * vec4(transformed, 1.0));","\n #endif \n","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fs:["$DEFINE","precision highp float;","const float PackUpscale = 256. / 255.;","const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );","const float ShiftRight8 = 1. / 256.;","varying vec3 vPosition;","uniform int uClipDirection;","uniform float uClipPercent;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform bool uEnableBoxClip[MAX_BOX_CLIPPER];","uniform bool uClipperClipInner[MAX_BOX_CLIPPER];","uniform mat4 uClipperMatrix[MAX_BOX_CLIPPER];","const vec3 clipMin = vec3(-0.5, -0.5, -0.5);","const vec3 clipMax = vec3(0.5, 0.5, 0.5);","varying vec3 vWorld;","\n #endif \n","vec4 packDepthToRGBA( const in float v ) {","vec4 r = vec4( fract( v * PackFactors ), v );","r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;","}","void main() {","if (uClipDirection > 0) {","vec3 dir = vec3(0.0, 0.0, 0.0);","if (uClipDirection < 2) { dir.x = 1.0; }","else if (uClipDirection < 3) { dir.x = -1.0; }","else if (uClipDirection < 4) { dir.y = 1.0; }","else if (uClipDirection < 5) { dir.y = -1.0; }","else if (uClipDirection < 6) { dir.z = 1.0; }","else if (uClipDirection < 7) { dir.z = -1.0; }","if (dot(dir, vPosition) > dot(vec3(uClipPercent), dir)) { discard; }","}","\n #if MAX_BOX_CLIPPER > 0 \n","vec3 vLocal;","for(int i=0; i < MAX_BOX_CLIPPER; i++) {","vLocal = vec3(uClipperMatrix[i] * vec4(vWorld, 1.0));","if (uEnableBoxClip[i] && uClipperClipInner[i] != (all(lessThan(vLocal, clipMax)) && all(greaterThan(vLocal, clipMin)))) { discard; return; }","}","\n #endif \n","gl_FragColor = packDepthToRGBA( gl_FragCoord.z );","}"].join("\n")},Vg.PARAMS=["quality","intensity","bias","radius","type","degree.x","degree.z"],xn.ms_shadow=function(B){Vg.PARAMS.forEach(function(R){var G=R.replace(/(^|\.)[a-z]/g,function(F){return F[F.length-1].toUpperCase()}),S=G.charAt(0).toLowerCase()+G.substr(1);B["getShadow"+G]=function(){return this._getShadowParam(S)},B["setShadow"+G]=function(E){this._setShadowParam(S,E)}}),B.enableShadow=function(E){this.shadowMap.setShadow(!0,E)},B.disableShadow=function(){this.shadowMap.setShadow(!1)},B._getShadowParam=function(N){return this.shadowMap.getShadow()[N]},B._setShadowParam=function(b,y){var r=this._getShadowParam(b),M={};M[b]=y;var h=this.shadowMap;h.setShadow(h.enable,M),this.firePropertyChange("shadow"+b.charAt(0).toUpperCase()+b.substr(1),r,y)}};var mm=function(e){function J(C,S,I,J,M){var K=e.getData3dUI(I),B=K.s("shape3d");if("billboard"===B||"plane"===B){var s;(s=P[S])||(s=P[S]=new Zp(e));var $=I.s("effect.flow.size"),d=I.s("effect.flow.uvshape");s.setSize(C,$,$),s.bind(C);var V=e.getViewport(C);e.setViewport(C,0,0,$,$),C.clear(C.COLOR_BUFFER_BIT|C.DEPTH_BUFFER_BIT);var t,K=e.getData3dUI(I),u=ub(K,B);if(!u)return!1;!u.ns&&u.length&&(u=u[0]),vh(u),t=u.vs;var D,b=I.s("effect.flow.gradient");if(b){if(D="Flow3d.Cached."+b,!U.Default.getImageMap()[D]){var m=100;U.Default.setImage(D,U.Default.toCanvas({width:m,height:m,comps:[{type:"rect",background:"rgb(0,0,0)",gradient:b,rect:[0,0,m,m]}]},m,m))}}else D=I.s("shape3d.image");J.useXZ="plane"===B,J.image=e.getTexture(D,I),J.blend=I.s("effect.flow.blend")||R,J.uvMatrix=le(K.s("shape3d.uv.rotation"),K.s("shape3d.uv.offset"),K.s("shape3d.uv.scale"),K.s("shape3d.uv.anchor"),Z).toArray9(),J.intensity=I.s("effect.flow.intensity");var H=A.indexOf(d);-1===H&&0===d.indexOf("polygon")&&(H=hk(1*d.substring(7),3,1024)-1),J.shape=H,M.position=bo(C,null,t,g,3),Co(C,0,t.length/3),s.unbind(C),e.setViewport(C,V[0],V[1],V[2],V[3]);var f=I.getMatrix4();f.getInverse(f);var O=f.getElements();"plane"===B?O[1]=O[5]=O[9]=O[13]=0:O[2]=O[6]=O[10]=O[14]=0,Q[S]={matrix:f,group:I.s("effect.flow.group")}}}var Z,q=this,P=this.renderTargetPool=[],Q=[],A=["rect","circle","polygon"];q.render=function(){if(!e._picking){var j=e._flowObjects;if(j.length){var L=e.getGL();if(L){var G;(G=L._flowShader)||(G=L._flowShader=new Dl.Shader(L,mm.shaderSrc.vs,mm.shaderSrc.fs));var K=e._frameState.renderState,w=K.glState;w.blend.enabled=!1,w.depth.enabled=!1,w.cullFace.enabled=!1;var v=w.color.clear.slice(0);Un(L,[0,0,0,1]),K.useProgram(G.program);var A,B,k=K.directUniforms(),c=K.directAttribs();for(A=0,B=j.length;B>A;A++)J(L,A,j[A],k,c);Un(L,v),P.length!==B&&P.splice(B,P.length-B)}}}},q.createFlow=function(Y){var s;if(s=P.length){Y||(Y=e._frameState.renderState.directUniforms());for(var G=[],U=[],A=[],i=0;s>i;i++)G[i]=Q[i].matrix.toArray(),U[i]=P[i].texture,A[i]=!1;Y.flowMatrix=G;for(var i=0;s>i;i++)Y["flowTexture"+i]=U[i];Y.flowEnabled=A}},q.disableFlow=function(W){var n;if(n=P.length){W||(W=e._frameState.renderState.directUniforms());for(var Z=[],S=0;n>S;S++)Z[S]=!1;W.flowEnabled=Z}},q.resetDataFlowEnabld=function(H,f){var d=H.s("effect.flow.mask"),A=P.length,K=new Array(A);if(d)for(var J=0;A>J;J++)d&1<<Q[J].group&&(K[J]=!0);f.flowEnabled=K};var R="white"};mm.shaderSrc={vs:["uniform bool useXZ;","attribute vec3 position;","varying vec2 vUv;","void main() {","if (useXZ) vUv = vec2(position.x, position.z);","else vUv = vec2(position.x, position.y);","gl_Position = vec4(vUv * 2.0, 0.0, 1.0);","}"].join("\n"),fs:["precision highp float;","const float pi2 = 6.2831853;","uniform sampler2D image;","uniform mat3 uvMatrix;","uniform int shape;","uniform vec4 blend;","uniform float intensity;","varying vec2 vUv;","void main() {","vec2 uv;","float angle = atan(vUv.y, vUv.x) / pi2 + 0.5;","if (shape == 0) {","uv = vUv + 0.5;","}","else if (shape == 1) {","uv = vec2(length(vUv) * 2.0, angle);","}","else {","float step = 1.0 / float(shape + 1);","float modAngle = mod(angle, step) - step * 0.5;","uv = vec2(length(vUv) * 2.0 * cos(modAngle * pi2) , angle);","}","vec4 color = texture2D(image, vec2((uvMatrix * vec3(uv, 1.0)).xy)) * blend;","gl_FragColor = color * color.a * intensity;","}"].join("\n")};var or=function(v){this.gv=v,this.onMouseOver=this.onMouseOver.bind(this),this.resetProperties()};or.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},xn.ms_highlight=function(m){m.setHighlightMode=function($){var J;J="selection"===$||"selected"===$?or.Mode.Selection:"mouseover"===$||"hover"===$?or.Mode.MouseOver:"style"===$?or.Mode.Style:or.Mode.Disable;var K=this.getHighlightMode();this._highlightHelper.mode=J,this.firePropertyChange("highlightMode",K,$)},m.getHighlightMode=function(){var n=this._highlightHelper.mode;return n===or.Mode.Selection?"selected":n===or.Mode.MouseOver?"hover":n===or.Mode.Style?"style":"disabled"},["type","color","width","glow","strength"].forEach(function(V){var B=V.replace(/(^|\.)[a-z]/g,function(E){return E[E.length-1].toUpperCase()});m["getHighlight"+B]=function(){return this._highlightHelper[V]},m["setHighlight"+B]=function(w){var X=this._highlightHelper,G=X[V];w!==G&&(X[V]=w,this.firePropertyChange("highlight"+B,G,w))}})},zs(or,z,{onMouseOver:function(v){p.preventDefault(v);var j=this.gv;if(!j._48Q){var T=j.getDataAt(v);T!==this.mouseOverData&&(this.mouseOverData=T,j.iv())}},setFetchTargetFunc:function(N){this.fetchTargetFunc=N},_42:function(i,M){var D,V,c=this,x=c._mode,y=c.gv;if(!i._renderInfo.reflectDepth&&x!==or.Mode.Disable){if(x===or.Mode.Selection?D=y.sm().getSelection().toArray(function(Q){return Q.s("highlight.visible")}):x===or.Mode.MouseOver&&c.mouseOverData&&c.mouseOverData.s("highlight.visible")&&(D=[c.mouseOverData]),c.fetchTargetFunc&&(D=c.fetchTargetFunc(D)),x===or.Mode.Style)D=D||[],V=function(h){if(D.indexOf(h)>=0)return!1;var q=y.getDataHighlightMode(h);return q===!1?!0:q===!0?!1:"selected"===q?y.isSelected(h)?!1:!0:"hover"===q?h===c.mouseOverData?!1:!0:!0};else{if(!D||!D.length)return;V=function(c){return D.indexOf(c)<0?!0:void 0}}var U=y.isVRPresenting(),d=y.getWidth();if(U){var f=y.getWidth;d/=2,y.getWidth=function(){return d};var $=y.getViewport()}var X,O=y.getDevicePixelRatio(),s=Math.floor(d*O),k=Math.floor(y.getHeight()*O);(X=c._renderTarget)?X.setSize(i,s,k):c._renderTarget=X=new dd.RenderTarget(y,i,s,k);var P="soft"===c.type;if(X.bind(i),P){var A=i.getParameter(i.COLOR_CLEAR_VALUE);Un(i,[1,1,1,1]),i.clear(i.COLOR_BUFFER_BIT),Un(i,A)}else i.clear(i.COLOR_BUFFER_BIT);y.setViewport(i,0,0,s,k),y.drawFilter=V,Qo=function(G,U,E,X,Q,e){var s=[E?0:1,1,1,1];return e||(ts.for(G).directUniforms().uFixPickReverseColor=s),s},y.renderPickScene(),Qo=bb,y.drawFilter=null,X.unbind(i),uc&&kq(i,M.aPosition),kq(i,M.aNormal),U&&(y.getWidth=f,y.setViewport(i,$[0],$[1],$[2],$[3]));var t=y.getHighlightColor();if(c._lastHighlightColor!==t){var B=kl(c._lastHighlightColor=t);c._highlightColorData=[B[0]/255,B[1]/255,B[2]/255,B[3]/255]}return P?c.renderSoftOutline(i,s,k):c.renderHardOutline(i,s,k),i.useProgram(M=y._prg),uc&&yp(i,M.aPosition),!0}},_assureShader:function(K,s){var o=K._compiledShader[s];return o||(o=K._compiledShader[s]=new Dl.Shader(K,or.CommonShaderVs,or[s].fs)),o},renderHardOutline:function(K,F,y){var U=this,d=U.gv,P=d._postProcessing,g=ts.for(K),I=g.directState();I.blend.enabled=!0,I.depth.enabled=!1,P.blitScreen(null,U._renderTarget.texture,U._assureShader(K,"HighlightHard"),{textureSize:[F,y],edgeWidth:d.getHighlightWidth(),edgeColor:U._highlightColorData},{clear:!1}),I.blend.enabled=!1,I.depth.enabled=!0},renderSoftOutline:function(p,w,F){var D,n,M,e,l,O=this,W=O.gv,Q=W._postProcessing,k=Math.floor(w/2),g=Math.floor(F/2),m=Math.floor(w/4),J=Math.floor(F/4),I=O._downSampleRenderTarget;I?(D=O._edgeDetectionRenderTarget,n=O._blurV2,M=O._blurH2,e=O._blurV4,l=O._blurH4,(I.width!==k||I.height!==g)&&(I.setSize(k,g),D.setSize(k,g),n.setSize(k,g),M.setSize(k,g),e.setSize(m,J),l.setSize(m,J))):(I=O._downSampleRenderTarget=new dd.RenderTarget(W,p,k,g),D=O._edgeDetectionRenderTarget=new dd.RenderTarget(W,p,k,g),n=O._blurV2=new dd.RenderTarget(W,p,k,g),M=O._blurH2=new dd.RenderTarget(W,p,k,g),e=O._blurV4=new dd.RenderTarget(W,p,m,J),l=O._blurH4=new dd.RenderTarget(W,p,m,J));var R=p.getParameter(p.COLOR_CLEAR_VALUE),y=W.getViewport(),t=O.width,j=O.strength,Y=O.glow,d=ts.for(p).glState,f=d.depth,b=d.blend,i=f.enabled;Un(p,[1,1,1,1]),f.enabled=!1,b.apply({func:[p.SRC_ALPHA,p.ONE]}),Q.blitScreen(I,O._renderTarget.texture),Q.blitScreen(D,I.texture,O._assureShader(p,"EdgeDetection"),{texSize:[k,g],color:O._highlightColorData}),Q.blitScreen(M,D.texture,O._assureShader(p,"Blur"),{direction:[1,0],texSize:[k,g],radius:t}),Q.blitScreen(n,M.texture,O._assureShader(p,"Blur"),{direction:[0,1],texSize:[k,g],radius:t}),Q.blitScreen(l,n.texture,O._assureShader(p,"Blur"),{direction:[1,0],texSize:[m,J],radius:t}),Q.blitScreen(e,l.texture,O._assureShader(p,"Blur"),{direction:[0,1],texSize:[m,J],radius:t}),b.apply({enabled:!0}),W.setViewport(p,y[0],y[1],y[2],y[3]),Q.blitScreen(null,O._renderTarget.texture,O._assureShader(p,"BlendTogether"),{edgeTexture1:n.texture,edgeTexture2:e.texture,edgeStrength:j*t,edgeGlow:Y},{clear:!1}),b.apply({func:[p.SRC_ALPHA,p.ONE_MINUS_SRC_ALPHA,p.ONE,p.ONE_MINUS_SRC_ALPHA]}),f.enabled=i,Un(p,R)},resetProperties:function(){this.mode=or.Mode.Style,this.type=x["highlight.type"],this.color=x["highlight.color"],this.width=x["highlight.width"],this.glow=x["highlight.glow"],this.strength=x["highlight.strength"]}}),z.defineProperties(or.prototype,{mode:{get:function(){return this._mode},set:function(u){var Y=this._mode;if(u!==Y){this._mode=u;var L=Y===or.Mode.MouseOver||Y===or.Mode.Style,c=u===or.Mode.MouseOver||u===or.Mode.Style;c&&L||(L&&J(this.gv.getView(),"mousemove",this.onMouseOver),c&&C(this.gv.getView(),"mousemove",this.onMouseOver))}}}}),or.CommonShaderVs=["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),or.HighlightHard={fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},or.EdgeDetection={fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","uniform vec2 texSize;","uniform vec4 color;","void main() {","vec2 invSize = 1.0 / texSize;","vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);","vec4 c1 = texture2D( image, vUv + uvOffset.xy);","vec4 c2 = texture2D( image, vUv - uvOffset.xy);","vec4 c3 = texture2D( image, vUv + uvOffset.yw);","vec4 c4 = texture2D( image, vUv - uvOffset.yw);","float diff1 = (c1.r - c2.r)*0.5;","float diff2 = (c3.r - c4.r)*0.5;","float d = length( vec2(diff1, diff2) );","gl_FragColor = color * vec4(d);","}"].join("\n")},or.Blur={fs:["#define MAX_RADIUS 4","precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform vec2 texSize;","uniform vec2 direction;","uniform float radius;","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float weightSum = gaussianPdf(0.0, radius);","vec4 diffuseSum = texture2D( image, vUv) * weightSum;","vec2 delta = direction * invSize * radius/float(MAX_RADIUS);","vec2 uvOffset = delta;","for( int i = 1; i <= MAX_RADIUS; i ++ ) {","float w = gaussianPdf(uvOffset.x, radius);","vec4 sample1 = texture2D( image, vUv + uvOffset);","vec4 sample2 = texture2D( image, vUv - uvOffset);","diffuseSum += ((sample1 + sample2) * w);","weightSum += (2.0 * w);","uvOffset += delta;","}","gl_FragColor = diffuseSum/weightSum;","}"].join("\n")},or.BlendTogether={fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform sampler2D edgeTexture1;","uniform sampler2D edgeTexture2;","uniform float edgeStrength;","uniform float edgeGlow;","void main() {","vec4 edgeValue1 = texture2D(edgeTexture1, vUv);","vec4 edgeValue2 = texture2D(edgeTexture2, vUv);","vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;","float vv = texture2D(image, vUv).r;","vec4 finalColor = edgeStrength * vv * edgeValue;","gl_FragColor = finalColor;","}"].join("\n")};var Tr=U.Light=function(){$e(Tr,this),this.s($o,x[$o]),this.s(wq,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};jn("Light",rk,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(z,o,F){Tr.superClass.onStyleChanged.apply(this,arguments),z===$o&&this.s("shape3d.color",F)}});var cg=dd.FrameState=function(f,I){this.renderState=ts.for(I),this.picking=!1,this.envmapReflectivity=.5,this.cameraPosition=s,this.projectMatrix=s,this.viewMatrix=s,this.view=f,this.defaultProgram=s,this.pickColorMap=s,this._pvStack=[],this._renderStateStack=[]};cg.prototype.savePV=function(){var x=this.view;this._pvStack.push([Km(this.projectMatrix),Km(this.viewMatrix),x._18Q,Km(x._7O)])},cg.prototype.restorePV=function(){var q=this._pvStack.pop();if(q){var J=this.view;this.projectMatrix=J._projectMatrix=q[0],this.viewMatrix=J._viewMatrix=q[1],J._18Q=q[2],J._7O=q[3]}},cg.prototype.setPV=function(w,U){var L=this.view,G=!1;if(w&&(this.projectMatrix=L._projectMatrix=w,G=!0),U&&(this.viewMatrix=L._viewMatrix=U,L._7O=Km(U),G=!0),G){var e=L.getWidth(),i=L.getHeight(),Y=Km(this.projectMatrix);L._18Q=$c(Y,Y,U),L._18Q._wh=e/i}},cg.prototype.syncEnv=function(Z){var e=this,C=e.view;e.envmapReflectivity=C._envmapReflectivity||.5,e.cameraPosition=C.getEye(),e.projectMatrix=C._projectMatrix,e.viewMatrix=C._viewMatrix,e.pickColorMap=Z,e.picking=C.getGL()._picking},cg.prototype.setGLState=function(){var G=[0,0,0,0],O=[!0,!0,!0,!0],L=[-1,1],F=[gq.FUNC_ADD,gq.FUNC_ADD],h=[gq.SRC_ALPHA,gq.ONE_MINUS_SRC_ALPHA,gq.ONE,gq.ONE_MINUS_SRC_ALPHA];
return function(z,t){var r=this,_=r.renderState.gl,I=r.renderState.glState;I.dither=!1,t?I.color.mask=O:I.color.reset(),I.pixelStore.reset(),I.blend.color=G,I.blend.equation=F,I.blend.func=h,I.cullFace.enabled=!1,I.scissor.enabled=!1,I.depth.enabled=!0,I.depth.clear=1,I.depth.func=_.LEQUAL,I.depth.range=L,I.stencil.enabled=!1,I.polygonOffset.enabled=!1,z?(I.depth.mask=!1,I.blend.enabled=!0):(I.depth.mask=!0,I.blend.enabled=!1)}}(),cg.prototype.setUniforms=function(S){var W=this,_=W.view,a=W.renderState,V=a.gl,C=a.uniforms;C.uBrightness=1,C.uOpacity=1,C.uPartOpacity=1,C.uPick=W.picking,C.uTexture=!1,C.uBlendTexture=!1,C.uAlphaTest=x.alphaTest,C.uTransparent=!!S,C.uFix=!1,C.uBatchColor=!1,C.uBatchBlend=!1,C.uBatchBrightness=!1,C.uReflectivity=W.envmapReflectivity||.5,C.uCameraPosition=W.cameraPosition,C.uPMatrix=W.projectMatrix,C.uViewMatrix=W.viewMatrix,C.uEnvMap=null,mi(_,C,pk),C.uClipperMatrix=_._boxClipperMatrixes,C.uClipperClipInner=_._boxClipperClipInner,_._envmapRenderer.resetUniformCache(),W.picking||(Eo(_,V,s),_._fogDisabled||(C.uFogColor=_._fogColor,C.uFogDensity=_._fogDensity,C.uFogNear=_._fogNear,C.uFogFar=_._fogFar))},cg.prototype.drawLayer=function(e){return this.view.renderLayers(e,!0)},cg.prototype.drawData=function(o,N,M){var n=this.view;if(n.isVisible(o)){var U=this.renderState,Q=U.uniforms,k=n.getData3dUI(o);if(k){var g=U.gl,A=g._picking,I=n._picking,Y=k._pickId;M&&(k._pickId=M),Q.uPick=g._picking=n._picking=!!M,Q.uTransparent=!!N,k._42(U.gl,U.program,N?V:d),Q.uPick=g._picking=A,n._picking=I,k._pickId=Y}}};var Ud=dd.Graph3dView=function(y,U){var t=this;t.resetHeadlightProperties(),t.resetFogProperties(),t._webGLVersion=1,t._attributes=U||p.graph3dViewAttributes,t._25I={},t._view=_f(1,t);var w=t._canvas=gj(t._view);C(w,"webglcontextlost",function(x){x.preventDefault(),Nn(t),t._26I&&t._doBufferGC(t._26I,!0),t._26I=g,t._1o.onContextLost(),t._35O=!0}),C(w,"webglcontextrestored",function(){t._35O=!1,t.iv()}),t._40Q=new Gm,t._43Q={},t._44Q=-1,t._batchIndexMap={},t._batchModelMap={},t._wireframeIndexMap={},t._wireframeModelMap={},t._wireframeIndexMapSwap={},t._wireframeModelMapSwap={},t._polylineIndexMap={},t._polylineIndexMap={},t._polylineIndexMapSwap={},t._polylineIndexMapSwap={},t._8O=[],t._7O=Wq(),t._6O=Wq(),t._1o=new Ls(t),t._30O=new Os(t),t._31O=new Ms(t),t._32O=new Ns(t),t._raycaster=new Zs(t),t._highlightHelper=new or(t),t._postProcessing=new ht(t),t._41Q=[],t._42Q=0,t._frameRenderOptionStack=[],dd.VR?(t.vr=new dd.VR(t),t.isVREnabled=function(){return this.vr.enable},t.isVRPresenting=function(){return this.vr.isPresenting()}):(t.vr={enable:!1,isPresenting:h},t.isVREnabled=h,t.isVRPresenting=h),t.shadowMap=new Vg(t),t.flowMap=new mm(t),t._33Q=!0,t._eye=Wi(p.graph3dViewEye),t._center=Wi(p.graph3dViewCenter),t._up=Wi(p.graph3dViewUp),t._lightChanged=!1,t._59O=[],t._spots=[],t._dirs=[],t._boxClippers=[],t._flowObjects=[],t._frameId=0,t._picking=!1,t._batchInfoMap={},t.overlappingBox=new nk(t),t.dm(y?y:new _m),t._coreInteractor=new Uc(this),t._envmapRenderer=new dd.EnvmapRenderer(this),t.setInteractors([new Es(t)]),t._initView()},fn={fogDisabled:1,fogMode:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},pd=0;Mg("Graph3dView",z,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_shadow:1,ms_highlight:1,ms_quickVisible:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",zj,Nl,"firstPersonMode",ci,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","headlightGroup","ortho","orthoWidth","syncEyeWithOrthoWidth","fovy","near","far",_n,ii,"up","aspect","fogDisabled","fogMode","fogDensity","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay","batchInfoMap","rotateMinPhi","rotateMaxPhi","sortable","sortFunc"],_editable:!1,_sortable:p.graph3dViewSortable,_editHelperDisabled:p.graph3dViewEditHelperDisabled,_blockSelectable:p.graph3dViewBlockSelectable,_devicePixelRatio:s,_boundaries:s,_moveStep:p.graph3dViewMoveStep,_rotateStep:p.graph3dViewRotateStep,_rotateMinPhi:p.graph3dViewMinPhi===s?p.graph3dViewRotateMinPhi:p.graph3dViewMinPhi,_rotateMaxPhi:p.graph3dViewMaxPhi===s?p.graph3dViewRotateMaxPhi:p.graph3dViewMaxPhi,_pannable:p.graph3dViewPannable,_rotatable:p.graph3dViewRotatable,_walkable:p.graph3dViewWalkable,_resettable:p.graph3dViewResettable,_zoomable:p.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:p.graph3dViewFirstPersonMode,_mouseRoamable:p.graph3dViewMouseRoamable,_gridVisible:p.graph3dViewGridVisible,_gridSize:p.graph3dViewGridSize,_gridGap:p.graph3dViewGridGap,_gridColor:p.graph3dViewGridColor,_originAxisVisible:p.graph3dViewOriginAxisVisible,_centerAxisVisible:p.graph3dViewCenterAxisVisible,_axisXColor:p.graph3dViewAxisXColor,_axisYColor:p.graph3dViewAxisYColor,_axisZColor:p.graph3dViewAxisZColor,_ortho:p.graph3dViewOrtho,_orthoWidth:p.graph3dViewOrthoWidth,_syncEyeWithOrthoWidth:p.graph3dViewSyncEyeWithOrthoWidth,_fovy:p.graph3dViewFovy,_near:p.graph3dViewNear,_far:p.graph3dViewFar,_rectSelectable:p.graph3dViewRectSelectable,_rectSelectBackground:p.graph3dViewRectSelectBackground,_editSizeColor:p.graph3dViewEditSizeColor,_autoMakeVisible:Ql,_pickerResolution:p.graph3dViewPickerResolution,_dashDisabled:p.graph3dViewDashDisabled,_batchColorDisabled:p.graph3dViewBatchColorDisabled,_batchBlendDisabled:p.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:p.graph3dViewBatchBrightnessDisabled,addCamera:function(H){var N=this,n=z.freeze({id:N._42Q++,priority:H.priority||0,ignoreInPick:!!H.ignoreInPick,render:H.render});H.switch3DStatus&&(N._43Q[n.id]=!0),N._41Q.push(n),N._41Q.sort(function(P,C){return P.priority!==C.priority?P.priority-C.priority:P.id-C.id})},setEye:function(F,y,v){1===arguments.length&&(y=F[1],v=F[2],F=F[0]);var o=this._eye;o[0]=F,o[1]=y,o[2]=v,this.fp(_n,g,o)},setCenter:function(U,Q,M){1===arguments.length&&(Q=U[1],M=U[2],U=U[0]);var P=this._center;P[0]=U,P[1]=Q,P[2]=M,this.fp(ii,g,P)},setUp:function(z,O,B){1===arguments.length&&(O=z[1],B=z[2],z=z[0]);var Z=this._up;Z[0]=z,Z[1]=O,Z[2]=B,this.fp("up",g,Z)},getDevicePixelRatio:function(){return this._picking?this._1o._resolution:this._devicePixelRatio||Kn},isTransparentMask:function(X){return X.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var d=this,I=d._aspect;return I?I:(I=d.getWidth()/d.getHeight(),I||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(S){var i=this,I=i._dataModel,V=i._selectionModel;I!==S&&(I&&(I.ump(i.handleDataModelPropertyChange,i),I.umm(i.handleDataModelChange,i),I.umd(i.handleDataPropertyChange,i),V||I.sm().ums(i.handleSelectionChange,i)),i._dataModel=S,S.mp(i.handleDataModelPropertyChange,i),S.mm(i.handleDataModelChange,i),S.md(i.handleDataPropertyChange,i),V?V._21I(S):S.sm().ms(i.handleSelectionChange,i),i._postProcessing.handleDataModleChange(I,S),i._tryInvalidateEnvmap(),i.invalidateAll(!0),i.invalidateLight(),i.invalidateboxClipper(),i.invalidateFlowObjects(),i._49Q(),i.fp(Mi,I,S),i._canvas.style.background=S.getBackground()||"")},handleDataModelPropertyChange:function(q){var Y=q.property;if("background"===Y){var W=this._canvas.style.background,v=q.newValue||"";this._canvas.style.background=v,this.fp("canvasBackground",W,v)}else"envmapType"===Y?this._tryInvalidateEnvmap():"envmap"===Y&&this.iv()},handleDataPropertyChange:function(n){var y=n.data;this.invalidateData(y);var G=n.property;Dd(y)&&"s:light.type"===G?this.invalidateLight():"s:3d.clipbox"===G?this.invalidateboxClipper(y,!0):"s:effect.flow"===G?this.invalidateFlowObjects(y,!0):"s:shadow.cast"===G?this.shadowMap.tryUpdateBounding(y):"s:3d.visible"===G&&this.invalidateQuickVisible(y)},invalidateboxClipper:function(C,z){var M=this._boxClippers,Z=M.length;if(C){var m=!!C.s("3d.clipbox");if(z=!!z,m===z)M.indexOf(C)<0&&M.push(C);else{var I=M.indexOf(C);I>=0&&M.splice(I,1)}}else M=this._boxClippers=[],this.dm().each(function(I){I.s("3d.clipbox")&&M.push(I)});var T=M.length;Z!==T&&(Nn(this),this.shadowMap.deleteShadowProgram(),this._updateBoxClipperMatrix(),mi=T?og:Yd),this.iv()},_updateBoxClipperMatrix:function(){for(var w,G,k=this._boxClippers,F=this._boxClipperMatrixes=[],E=this._boxClipperClipInner=[],l=this._boxClipperGroups=[],J=new cr,h=0,x=k.length;x>h;h++)w=k[h],w.appendAnchorMatrix3d(G=Ph(w,this.getMat(w))),F.push(J.getInverse(J.fromArray(G)).toArray()),E.push("inner"===w.s("3d.clipbox")),l.push(w.s("3d.clipbox.group"))},_49Q:function(){this._4AQ||this._48Q||this.dm().size()<p.graph3dViewDataNumWarningLine||(this._48Q=!0,console.log("Too many datas so than disable some feature to speed up.\nYou can set global Default.graph3dViewDataNumWarningLine to largeEnoughNum to avoid this, or call graph3dView.quitDataNumWarning() to quit.\n"),this.enableQuickVisibleMode(),this.getHighlightHelper().mouseOverData=null)},quitDataNumWarning:function(){this.disableQuickVisibleMode(),this._48Q=!1,this._4AQ=!0},invalidateFlowObjects:function(G,I){var b=this._flowObjects,W=b.length;if(G){var n=!!G.s("effect.flow");if(I=!!I,n===I)b.indexOf(G)<0&&b.push(G);else{var d=b.indexOf(G);d>=0&&b.splice(d,1)}}else b=this._flowObjects=[],this.dm().each(function(y){y.s("effect.flow")&&b.push(y)});W!==b.length&&Nn(this),this.iv()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(e){var H=this,l=e.property;H.iv(),H._18Q=g,"eye"===l?H._33Q=!0:"devicePixelRatio"===l?H._42(H.getDevicePixelRatio()):fn[l]&&Nn(H)},_5O:function(H){var o=H._22Q();return o?new o(this,H):g},getData3dUI:function(L){var j=this._25I[L._id];return j===s&&(j=this._5O(L),this._25I[L._id]=j),j},invalidateAll:function(F,k){var r=this;if(F){for(var o in r._25I){var H=r._25I[o];H&&H.dispose()}r._25I={},r.iv(),Rr(r)}else Rr(r),r.dm().each(function(C){r.invalidateData(C)});r.shadowMap.tryInvalidateLater(F,k)},invalidateSelection:function(){var Z=this;Z.sm().each(function(v){Z.invalidateData(v)})},invalidateData:function(i){var b=this,q=b.getData3dUI(i);q&&(q.iv(),b.iv()),Rr(b,i)},getShape3dText:function(b){return b.getStyle("shape3d.text")||this.getLabel(b)},invalidateBatch:function(R){var k=this,n=k._40Q;n.each(function(B){k._invalidateBatch(R,B.batchModelMap,B.batchIndexMap),k._invalidateBatch("T"+R,B.wireframeModelMap,B.wireframeIndexMap),k._invalidateBatch("O"+R,B.wireframeModelMap,B.wireframeIndexMap),B.markBatchInvalid()}),k.iv()},_invalidateBatch:function(N,X,G){var y=this,D=X[N];D&&(D.ds.forEach(function(I){var A=y.getData3dUI(I);A&&A.iv(),delete G[I._id]}),delete X[N])},handleDataModelChange:function(f){var b=this,U=f.kind,K=f.data;if("add"===U)b.invalidateData(K),hg(K)&&K.getEdgeGroup()&&K.getEdgeGroup().eachSiblingEdge(b.invalidateData,b),Dd(K)&&b.invalidateLight(),K.s("3d.clipbox")&&b.invalidateboxClipper(K,!0),K.s("effect.flow")&&b.invalidateFlowObjects(K,!0),b._49Q();else if(U===Lf){var s=K._id,E=b._25I[s];E&&(E.dispose(),delete b._25I[s],b.iv()),K===b._currentSubGraph&&b.setCurrentSubGraph(g),Rr(b,K),Dd(K)&&b.invalidateLight(),K.s("3d.clipbox")&&b.invalidateboxClipper(K,!1),K.s("effect.flow")&&b.invalidateFlowObjects(K,!1)}else U===rm&&(b.invalidateAll(!0),b.setCurrentSubGraph(g),Rr(b),b.invalidateLight(),b.invalidateboxClipper(),b.invalidateFlowObjects())},toCanvas:function(g,P,D){var x=this,N=x.getGL();if(x.validate(),g){var U=N.getParameter(N.COLOR_CLEAR_VALUE);Un(N,g)}x._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var C=x.getWidth()||1,b=x.getHeight()||1,Y=new Uint8Array(4*C*b),f=gj(),A=f.getContext("2d");N.readPixels(0,0,C,b,N.RGBA,N.UNSIGNED_BYTE,Y),Df(f,C,b,1);for(var h=A.getImageData(0,0,C,b),q=h.data,W=0;W<q.length;W+=4){var M=W/4,v=l(M/C),m=M-v*C;M=4*((b-1-v)*C+m),q[M]=Y[W],q[M+1]=Y[W+1],q[M+2]=Y[W+2],q[M+3]=Y[W+3]}if(A.putImageData(h,0,0),g&&Un(N,U),x._42(x.getDevicePixelRatio()),P&&D){var d=gj(),u=d.getContext("2d");return Df(d,P,D,1),p.drawImage(u,f,0,0,P,D),d}return f},toDataURL:function(H,P){var Z=this,$=Z.getGL();if(Z.validate(),H){var e=$.getParameter($.COLOR_CLEAR_VALUE);Un($,H)}Z._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var f=Z._canvas.toDataURL(P||"image/png",1);return H&&Un($,e),Z._42(Z.getDevicePixelRatio()),f},isWebGL2:function(){return 2===this._webGLVersion},getGL:function(){var o=this._26I;if(o)return this.acquireProgram(),o;if(!this._35O){var C=this,x=C._canvas,p=C._attributes;if(!p||p.requestWebGL2!==!1)try{o=x.getContext("webgl2",p)||x.getContext("experimental-webgl2",p),o&&(C._webGLVersion=2,C._26I=o)}catch(a){}if(!o)try{o=x.getContext("webgl",p)||x.getContext("experimental-webgl",p)}catch(a){throw new Error("WebGL not supported")}if(!o)throw new Error("WebGL not supported");C._26I=o;var D=C._frameState=new cg(this,o);C._glExtensions=new k(o),C._glCapabilities=new t(o,C._glExtensions),C._2O={},o._emptyCubeTexture=Hc(o),o._compiledShader={},o._emptyTexture=dp(o),o._emptyBlendTexture=dp(o),o._bufPool={},o._id=++pd,D.setGLState(),C._buffer={vs:yg(o),ns:yg(o),is:yg(o),uv:yg(o),batchColor:yg(o),batchBlend:yg(o),batchBrightness:yg(o),lineDistance:yg(o)},C._1O=Re(o);var S=C._cube={vs:yg(o),ns:yg(o),is:yg(o),uv:yg(o)};return Yr(o,S.vs,jq),Yr(o,S.ns,An),Yr(o,S.uv,Og),rf(o,S.is,Pq),C.acquireProgram(),o._renderInfo={calls:0,vertices:0,faces:0,lines:0,points:0,frame:0,cacheTimeCost:0},o}},getGLCapabilities:function(){var w=this.getGL();return w?this._glCapabilities:void 0},getGLExtensions:function(){var x=this.getGL();return x?this._glExtensions:void 0},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<p.graph3dEnvmapCapabilityRequire?null:this.dm().getEnvmap()},getEnvmapType:function(){var X,P=this.dm();return P&&(X=P.getEnvmapType()),X||"legacy"},invalidateEnvmap:function(W){return this._envmapRenderer.invalidateEnvmap(W)},_setEnvmapByProbeId:function(A,$){return this._envmapRenderer.setEnvmapByProbeId(A,$)},_tryInvalidateEnvmap:function(){var l=this.getEnvmapType();l!==this._lastProgramEnvmapType&&(Nn(this),this.iv())},acquireProgram:function(){var q=this,r=q._26I;if(r&&!q._prg){var C=q._prg=r.createProgram();if(!C)return g;var N=q._dirs.length,I=q._spots.length,i=q._59O.length,s=q._boxClippers.length,x=q._flowObjects.length,J=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uUvMatrix","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogDensity","uFogNear","uFogFar"];N&&J.push("uDirColor","uDirDirection"),I&&J.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),i&&J.push("uPointColor","uPointRange","uPointPosition"),gb||(No=yj(No.substring(0,No.indexOf("^#"))),Eb=yj(Eb),gb=!0);var E=q.getEnvmapType(),W=["#define MAX_DIR "+N,"#define MAX_SPOT "+I,"#define MAX_POINT "+i,"#define MAX_BOX_CLIPPER "+s,"#define MAX_FLOW_OBJECT "+x,q._fogDisabled?"":"#define FOG","exp2"===q.getFogMode()?"#define FOG_EXP2":"",q._dashDisabled?"":"#define DASH","#define USE_ENVMAP","legacy"!==E?"#define ENVMAP_TYPE_CUBE_UV":"",q.isOrtho()?"#define ORTHOGRAPHIC":"",q._batchColorDisabled?"":"#define BATCHCOLOR",q._batchBlendDisabled?"":"#define BATCHBLEND",q._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",q.shadowMap.enable?q.shadowMap.genShaderDefine():"",""].join("\n"),d=nf(r,C,r.VERTEX_SHADER,No.replace("PREFIX",W));r.getShaderParameter(d,r.COMPILE_STATUS)||Jo("COMPILE",r.VERTEX_SHADER,r.getError(),r.getShaderInfoLog(d));var z=nf(r,C,r.FRAGMENT_SHADER,Eb.replace("PREFIX",W));if(r.getShaderParameter(z,r.COMPILE_STATUS)||Jo("COMPILE",r.FRAGMENT_SHADER,r.getError(),r.getShaderInfoLog(z)),uc?J.push("aPosition"):(C.aPosition=0,r.bindAttribLocation(C,0,"aPosition")),r.linkProgram(C),!r.getProgramParameter(C,r.LINK_STATUS)){var U=r.getProgramInfoLog(C);return q._prg=g,U.indexOf("maximum temp register")>=0&&!q._glTempRegisterLimited?(q._glTempRegisterLimited=!0,r.deleteProgram(C),q.acquireProgram()):(Jo("LINK",r.getProgramParameter(C,r.VALIDATE_STATUS),r.getError(),U),r.deleteProgram(C),g)}J.forEach(function(z){C[z]=/^u/.test(z)?r.getUniformLocation(C,z):r.getAttribLocation(C,z)});var v=q._frameState;v.renderState.program=v.defaultProgram=C,q._envmapRenderer.changeEnvmapType(q._lastProgramEnvmapType=E),r.deleteShader(d),r.deleteShader(z)}},isGLTempRegisterLimited:function(){return this._glTempRegisterLimited},getBrightness:function(x){var Q=x.s("brightness"),T=this.isSelected(x)?x.s("select.brightness"):g;return Q==g?T:T==g?Q:Q*T},getDataHighlightMode:function(r){return r.s("highlight.mode")},getWireframe:function(a){var S=a.s("wf.visible"),C=a.s("wf.width");return S===!0||C>0&&"selected"===S&&this.isSelected(a)?{color:a.s("wf.color"),width:C,"short":a.s("wf.short"),mat:a.s("wf.mat")}:void 0},_transformPointToViewSpace:function(y){var m=[y[0],y[1],y[2]];return aq(m,this._viewMatrix),m},_transformDirectionToViewSpace:function(E,d){var O=[E[0],E[1],E[2]];aq(O,this._viewMatrix);var G=d?[d[0],d[1],d[2]]:[0,0,0];aq(G,this._viewMatrix);var w=G[0]-O[0],C=G[1]-O[1],p=G[2]-O[2],Y=Math.sqrt(w*w+C*C+p*p);return Y?[w/Y,C/Y,p/Y]:[w,C,p]},getWireframeGeometry:function(E){return E.s("wf.geometry")?{color:E.s("wf.color"),width:E.s("wf.width"),mat:E.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(g){return g.s("body.color")},getMat:function(y){return y.getMat?y.getMat():y.s("mat")},getFaceMat:function(I,q){return I.getFaceMat?I.getFaceMat(q):I.s(q+".mat")},getFaceBlend:function(i,a){return i.s(a+".blend")||i.s("all.blend")},getFaceColor:function(R,f){return R.s(f+".color")||R.s("all.color")},getFaceImage:function(g,Q){return g.s(Q+".image")||g.s("all.image")},getFaceBlendImage:function(p,y){return p.s(y+".blend.image")||p.s("all.blend.image")},getFaceDiscardSelectable:function(e,_){var k=e.s(_+".discard.selectable");return k==g?e.s("all.discard.selectable"):k},getFaceUv:function(B,Y){return B.s(Y+".uv")||B.s("all.uv")},getFaceUvOffset:function(S,P){return S.s(P+".uv.offset")||S.s("all.uv.offset")},getFaceUvScale:function(i,t){return i.s(t+".uv.scale")||i.s("all.uv.scale")},getFaceUvRotation:function(c,X){return c.s(X+".uv.rotation")||c.s("all.uv.rotation")},getFaceUvAnchor:function(G,L){return G.s(L+".uv.anchor")||G.s("all.uv.anchor")},getFaceLight:function(m,Y){var R=m.s(Y+".light");return R==g?m.s("all.light"):R},getFaceVisible:function(K,S){var U=K.s(S+".visible");return U==g?K.s("all.visible"):U},getFaceOpacity:function(J,i){var U=J.s(i+".opacity");return U==g?J.s("all.opacity"):U},getFaceTransparent:function(s,C){var c=s.s(C+".transparent");return c==g?s.s("all.transparent"):c},getFaceReverseColor:function(z,G){return z.s(G+".reverse.color")||z.s("all.reverse.color")},getFaceReverseFlip:function(q,A){var l=q.s(A+".reverse.flip");return l==g?q.s("all.reverse.flip"):l},getFaceReverseCull:function(X,V){var A=X.s(V+".reverse.cull");return A==g?X.s("all.reverse.cull"):A},getTextureMap:function(){return this._2O},_2Oi:function(E,S,r){r=r||"";var L;(L=this._2O[E])||(L=this._2O[E]={}),L[r]=S},deleteTexture:function(o){var W=this,V=W._2O[o];if(V){delete W._2O[o];var n=W.getGL();for(var O in V)n.deleteTexture(V[O])}},renderPickScene:function(){var W=this.getGL();this.syncRenderState(),this._picking=W._picking=!0,this.renderScene(),this._picking=W._picking=!1},invalidateCachedTexture:function(t){var e=this.getData3dUI(t);e.invalidateCachedTexture(this.getGL()),this.invalidateData(t)},invalidateShape3dCachedImage:function(o){this.invalidateCachedTexture(o)},invalidateCachedGeometry:function(i){var u=this.getData3dUI(i);u.invalidateCachedGeometry(),this.invalidateData(i)},isInteractive:function(r){return r.s("interactive")},getTexture:function(I,e,P,B){if(!I)return g;var y,$,z=this,h=z.getGL(),u=z._2O[I];if(u&&(e&&($=e.s("texture.mipmap.max")),y=u[$||""]||u.default),!y){var k=dg(I);if(B||(B={}),!k)return h._emptyTexture;if(e){B.mipmapMaxLevel=$=e.s("texture.mipmap.max");var m=e.s("texture.wrap");B.clampToEdge="clampToEdge"===m?!0:"repeat"===m?!1:s}if(k.uuid||(k.uuid=U.Math.generateUUID()),k.tagName){if(k.dynamic)return Re(h,k,z._1O,B);y=Re(h,k,s,B),z._2Oi(I,y,$)}else{var Z,T=e&&(e.s("texture.cache")||e.s("shape3d.image.cache")||k.textureCache),c=z.isVRPresenting();if(c&&(e._textureUpdateFrame===h._renderInfo.frame?T=!0:e._textureUpdateFrame=h._renderInfo.frame),T&&(Z=z.getData3dUI(e),y=Z.getCachedTexture(P),y&&Z.interactiveInfo&&y.interactiveInfo&&(Z.interactiveInfo[y.interactiveInfo.key]=y.interactiveInfo.info)),!y){var H=h._renderInfo.textureCache;if(T){if(H.time>p.graph3dMaxVectorCacheTime)return z.redraw(),h._emptyTexture;if(!mk(k,e))return h._emptyTexture}var J;e&&(1!==e.s("texture.scale")?J=e.s("texture.scale"):1!==e.s("shape3d.texture.scale")&&(J=e.s("shape3d.texture.scale"))),J||(J=1);var f=e&&(e.s("fixSizeOnScreen")||e.s("shape3d.fixSizeOnScreen")),K=f?h.NEAREST:h.LINEAR;f?"number"==typeof f&&(J*=0>f?1:f):e&&(e.s("vector.dynamic")||e.s("shape3d.vector.dynamic"))&&(Z||(Z=z.getData3dUI(e)),f=Z.getVectorDynamicSize());var x,N,F,n=e&&e.s("shape3d");"billboard"===n?F=e.getTall()/e.getWidth():"plane"===n&&(F=e.getHeight()/e.getWidth());var d=Oo(k,e);if(f){var V;V=T?z._devicePixelRatio||Kn:z.getDevicePixelRatio(),x=f[0]>0?f[0]*V:J*d*V,N=f[1]>0?f[1]*V:J*(F?Gl(k,e,z,Math.min(4096,d*F)):Gl(k,e))*V}else x=J*d,N=J*(F?Gl(k,e,z,Math.min(4096,d*F)):Gl(k,e));if(x>=1&&N>=1){var M=0;(T||c)&&(M=Date.now());var E=z._glCapabilities.maxTextureSize;x=Math.min(x,E),N=Math.min(N,E);var a=Wb(x,N);if(!Z&&e&&(Z=z.getData3dUI(e)),Z&&Z.interactiveInfo){var t=I;"object"==typeof t&&(t=t.uuid||(t.uuid=U.Math.generateUUID()));var A=Z.interactiveInfo[t]={};a.interactiveInfo=A.bodyInfo={compInfos:[],matrix:new Wg,rect:{x:0,y:0,width:x,height:N}}}jj(a,k,0,0,x,N,e,z),a.interactiveInfo&&(a.interactiveInfo=null),a.restore(),H.count++,H.pixels+=x*N,e?(B.minFilter=Db(e.s("texture.filter.min")||e.s("texture.filter"))||K,B.magFilter=Db(e.s("texture.filter.mag")||e.s("texture.filter"))||K):B.minFilter=B.magFilter=K,T||c?(y=Re(h,tk,null,B),Z.setCachedTexture(y,P),H.time+=Date.now()-M,A&&(y.interactiveInfo={key:t,info:A}),tk=null):y=Re(h,tk,z._1O,B)}}}}return y},redraw:function(){this.iv()},validateImpl:function(){var t=this;if(t._lightChanged){t._lightChanged=!1;var i=[],C=[],B=[];t.dm().each(function(h){if(Dd(h)){var W=h.s("light.type");W===vd?i.push(h):W===wh?C.push(h):W===hl&&B.push(h)}}),(i.length!==t._59O.length||C.length!==t._spots.length||B.length!==t._dirs.length)&&Nn(t),t._59O=i,t._spots=C,t._dirs=B}var j=t.getAspect();j!==t.__cachedAspect__&&(t._updateSkybox({property:"asceptChanged"}),t.__cachedAspect__=j),t._42(),t._1o.iv()},getRenderInfo:function(){var p=this.getGL();return p?p._renderInfo:void 0},getDebugTip:function(){var l=this,v=l.getRenderInfo();if(v){var T=l.getGL()._validBufCount||0,q="Draw Calls: "+v.calls+"<br/>"+"Vertices: "+v.vertices+"<br/>"+"Faces: "+v.faces+"<br/>"+"Lines: "+v.lines+"<br/>"+(v.points?"Points: "+v.points+"<br/>":"")+"Buffers: "+T+"<br/>"+"Cache Models: "+z.keys(bm).length+"<br/>"+"Shape3d Models: "+z.keys(ps).length;if(l.isVRPresenting()&&(q+="<br/>VR fps: "+l.vr.getFps()),v.textureCache){var E=v.textureCache.count;if(q+="<br/>2D Dynamic Textures: "+v.textureCache.count,E>0){var s,P=v.textureCache.pixels;s=P>1e6?Math.round(P/1e6)+"M":P>1e3?Math.round(P/1e3)+"K":Math.round(P),q+="<br/>2D Dynamic pixels: "+s}}return q}},getFrameState:function(){return this._frameState},isBoundingBoxInView:function(){var W=new U.Math.Box3,R=new U.Math.Matrix4;return function(z){var y=z;if(y instanceof U.Data&&(y=this.getData3dUI(y)),!y.mat)return!0;var c=y.getBoundingBox();W.copy(c).applyMatrix4(R.fromArray(y.mat));var x=this.getFrustum();return x.intersectsBox(W)}}(),updateScene:function(){var X=this;X._81O=g,X.overlappingBox.clear();var i=X._40Q;i.init();var U=X.getGL(),F=X.dm();if(F.isHierarchicalRendering())F.eachByHierarchical(function(I){var J=X.getData3dUI(I);J&&J.update(X,U,i)});else{var C,Y,j,R=F.getDatas().getArray(),e=R.length;for(C=0;e>C;C++)Y=R[C],j=X.getData3dUI(Y),j&&j.update(X,U,i)}this._updateBoxClipperMatrix(),i.onUpdated()},_pushFrameRenderOptions:function(s){this._frameRenderOptionStack.push(this._currentFrameRenderOptions),this._currentFrameRenderOptions=s},_popFrameRenderOptions:function(){this._currentFrameRenderOptions=this._frameRenderOptionStack.pop()},_getFrameRenderOptions:function(r){var e=this._currentFrameRenderOptions;return e&&e[r]},getRenderLists:function(){return this._40Q},renderScene:function(C){function z(o,h){y.setGLState(o,h),y.setUniforms(o),y.renderState.attribs.disable(),T=v.directUniforms(),t=v.directAttribs(),t.disable()}function P(U){for(;e>n;n++){var r=$[n];if(!b||!r.ignoreInPick){if(r.priority>=U)break;(!L._43Q[L._44Q=r.id]||Xc[mc.length])&&(r.render(J,L,y),z())}}}var L=this;L._pushFrameRenderOptions(C),L._getFrameRenderOptions("createShadowMap")!==!1&&L.shadowMap.render(),L.flowMap.render();var J=L.getGL();L._envmapRenderer.onBeforeRender(J),L._44Q=-1;var T,t,y=L._frameState,v=y.renderState,V=v.glState,N=L._prg;L._projectMatrix=Mc(L),rr(L,L._7O),L._viewMatrix=Km(L._7O),L.isReflecting(J)||$c(L._projScreenMatrix=Wq(),L._projectMatrix,L._viewMatrix),y.syncEnv(this._picking?this.pickColorMap:s),v.useProgram(N),z(!1,!0),J.clear(J.DEPTH_BUFFER_BIT);var b=L._picking,$=this._41Q,n=0,e=$.length;if(P(p.cameraPriority.skybox),b){var W=V.color.clear.slice(0);Un(J,[0,0,0,0])}else Un(J,[0,0,0,0]),V.blend.enabled=!1,V.depth.enabled=!1,V.depth.mask=!1,L._camera&&L._camera.s("camera.renderSky")===!1||L.drawSky(J,N),L._getFrameRenderOptions("renderReflector")!==!1&&L.drawReflectors(J)&&(L._projectMatrix=Mc(L),rr(L,L._7O),L._viewMatrix=Km(L._7O),y.syncEnv(),z()),V.blend.enabled=!1,V.depth.enabled=!0,V.depth.mask=!0,T.uTransparent=!1,L._getFrameRenderOptions("renderGrid")!==!1&&L._31O._42(J,N);if(!J.textureBatch||Xc[(ONE_FRAME_TIME-6)/2]){b||(L.shadowMap.enable&&L.shadowMap.createShadow(T),L.flowMap.createFlow(T));for(var a=0,Q=tq.length;Q>a;a++){var G=tq[a],m=wk[G];if(!(!L._camera&&m.ignore||L._camera&&!L._camera.isLayerVisible(G))){var E=m.priority;P(E),this.renderLayer(G)}}P(p.cameraPriority.infinity),b||L.flowMap.disableFlow(T),Hd(L,T,0,p.graph3dViewHeadlightAmbientIntensity),T.uHeadlightColor=[1,1,1,0],T.uUseEnvMap=!1,V.depth.enabled=!1,T.uTransparent=!1,T.shadowReceive=!1,mi(L,T,pk),b?L.drawFilter||L._30O._42(J,N):(L._highlightHelper._42(J,N),this._renderAxisAndEditHelper(L._getFrameRenderOptions("renderAxis")!==!1,L._getFrameRenderOptions("renderEdit")!==!1),V.blend.enabled=!1,V.depth.mask=!0),V.depth.enabled=!0,b&&Un(J,W),Yr(J,g),rf(J,g),L._44Q=-1,L._popFrameRenderOptions(null)}},_renderAxisAndEditHelper:function(O,M){if(O||M){var R=this,N=R.getGL(),E=R._prg,z=R._frameState,j=z.renderState,w=j.glState,s=j.directUniforms();z.renderState.attribs.disable(),w.depth.enabled=!1,s.uTransparent=!1,s.shadowReceive=!1,w.blend.enabled=!1,w.depth.mask=!0,s.uPick=R._picking,O&&R._32O._42(N,E),M&&R._30O._42(N,E),Yr(N,g),rf(N,g)}},renderLayers:function(d,Y){Y&&(d=En(d));for(var q=0,N=d.length;N>q;q++)this.renderLayer(d[q])},renderSky:function(){var m=this,H=m._frameState,x=H.renderState,R=x.glState,N=m.getGL(),b=m._prg;m._projectMatrix=Mc(m),rr(m,m._7O),m._viewMatrix=Km(m._7O),$c(m._projScreenMatrix=Wq(),m._projectMatrix,m._viewMatrix),H.syncEnv(),x.useProgram(b),H.setGLState(!1,!0),H.setUniforms(!1),H.renderState.attribs.disable(),N.clear(N.DEPTH_BUFFER_BIT),Un(N,[0,0,0,0]),R.blend.enabled=!1,R.depth.enabled=!1,R.depth.mask=!1,m.drawSky(N,b),R.depth.mask=!0,R.depth.enabled=!0,Yr(N,g),rf(N,g)},addRenderLayerListener:function(r,E,X){var W=this;W._renderLayerNotifier||(W._renderLayerNotifier=new Ri),W._renderLayerNotifier.add(r,E,X)},removeRenderLayerListener:function(J,V){this._renderLayerNotifier&&this._renderLayerNotifier.remove(J,V)},fireRenderLayerEvent:function(c,H){var I=this._renderLayerNotifier;I&&I.fire({layer:c,phase:H})},renderLayer:function(k){var b=this,q=b._picking,I=b._40Q.get(k);if(I){b.fireRenderLayerEvent(k,"prepare");var Y=b.getGL(),n=wk[k],r=b._frameState,O=r.renderState,W=O.glState,i=O.directUniforms();!q&&b.isSortable()&&I.sort(b._sortFunc,b._projScreenMatrix);var M,h,c,p=I.opaque,$=I.transparent,x=I.batchModelMap,B=I.polylineModelMap,u=I.wireframeModelMap,Y=b.getGL(),S=b._prg;q||(W.blend.enabled=!1,W.depth.enabled=!0,W.depth.mask=!0),i.uTransparent=!1,n.clearDepth!==!1&&Y.clear(Y.DEPTH_BUFFER_BIT);var v=this.drawFilter;if(v)for(c=p,M=0,h=c.length;h>M;M++)v(c[M].data)!==!0&&c[M].ui._42(Y,S,d);else{for(c=p,M=0,h=c.length;h>M;M++)c[M].ui._42(Y,S,d);if(q)for(c=$,M=0,h=c.length;h>M;M++)c[M].ui._46Q(Y);br(b,x),Uh(b,B),Uh(b,u)}if(q||(W.blend.enabled=!0,W.depth.mask=!1),b._45Q=i.uTransparent=!0,v)for(c=$,M=0,h=c.length;h>M;M++)v(c[M].data)!==!0&&c[M].ui._42(Y,S,V);else{for(c=$,M=0,h=c.length;h>M;M++)c[M].ui._42(Y,S,V);br(b,x,null,!0),Uh(b,B,null,!0),Uh(b,u,null,!0)}b._45Q=null,b.fireRenderLayerEvent(k,"post")}},_42:function(c,z){var q=this;if(!q._35O&&(!Ko||Xc(Ko))){var S=q.getWidth(),E=q.getHeight();if(S&&E){var Z=q.getGL();if(Z){var e,p=q._canvas;if(c?e=!0:c=q.getDevicePixelRatio(),!q._picking&&(e||S!==p.clientWidth||E!==p.clientHeight)){Df(p,S,E,c);var $=c;S&&Math.abs(Z.drawingBufferWidth-S*c)>1&&($=Math.min($,Z.drawingBufferWidth/S)),E&&Math.abs(Z.drawingBufferHeight-E*c)>1&&($=Math.min($,Z.drawingBufferHeight/E)),$!==c&&(q.setDevicePixelRatio(c=$),Df(p,S,E,c)),q._18Q=null}Z.clear(Z.COLOR_BUFFER_BIT);var F=Z._renderInfo;F.calls=0,F.vertices=0,F.faces=0,F.lines=0,F.points=0,F.textureCache={time:0,count:0,pixels:0},F.frame=++q._frameId,F.cacheTimeCost=0,F.reflectDepth=0,S*=c,E*=c,this.syncRenderState();do{if(q.isVREnabled()&&q.vr.render(Z,S,E,z))break;if(q.updateScene(),q._postProcessing.render(Z,S,E,z))break;q.setViewport(Z,0,0,S,E),q.renderScene(z)}while(!1);q._33Q=!1,q.countFrame(),q._doBufferGC(Z)}}}},syncRenderState:function(){var V,x;(V=this._frameState)&&(x=V.renderState)&&x.syncLoss()},drawReflectors:function(d){d._renderInfo.reflectDepth++;var t,A,s,T=this,M=T._dataModel.getReflectors(),r=!1;for(t in M)A=M[t],T.isVisible(A)&&(s=T.getData3dUI(A),s&&s.drawReflector&&s.drawReflector(d)&&(r=!0));return d._renderInfo.reflectDepth--,r},isReflecting:function(v){return v._renderInfo.reflectDepth},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(G,A){return this._postProcessing.enableModule(G,A)},getPostProcessingModule:function(t){return this._postProcessing.getModule(t)},getPostProcessingValue:function(x,Y){var k=this._postProcessing.getModule(x);return k?k[Y]:s},setPostProcessingValue:function(Y,I,N){var M=this.getPostProcessingValue(Y,I),X=this._postProcessing.getModule(Y);X&&M!==N&&("enable"===I?this.enablePostProcessing(Y,N):X[I]=N,this.firePropertyChange("postProcessing."+Y+"."+I,M,N))},setDofImageFromGraphView:function(j,A,f){return this._postProcessing.getModule("Dof").setImageFromGraphView(j,A,f)},setViewport:function(C,A,u,x,a){this._viewport=[A,u,x,a],ts.for(C).directState().viewport=this._viewport},getRenderState:function(){return ts.for(this._26I)},getViewport:function(){return this._viewport},setBufferGCInterval:function(M){this._bufferGCInterval=M},_doBufferGC:function(z,B){var y,t,Y=z._bufPool,u=0,V=0,Q=z._renderInfo.frame,Z=this._bufferGCInterval||10;
for(y in Y)u++,t=Y[y],t&&(B||Q-t._fid>Z?(z.deleteBuffer(t._buf),t._buf=null,Y[y]=null):V++);if(u/2>V&&u>128){var r={};for(y in Y)Y[y]&&(r[y]=Y[y]);z._bufPool=r}z._validBufCount=V},_swapLineMap:function(){var H=this;Hf=H._polylineModelMap,H._polylineModelMap=H._polylineModelMapSwap,H._polylineModelMapSwap=Hf,Hf=H._wireframeModelMap,H._wireframeModelMap=H._wireframeModelMapSwap,H._wireframeModelMapSwap=Hf,Hf=H._polylineIndexMap,H._polylineIndexMap=H._polylineIndexMapSwap,H._polylineIndexMapSwap=Hf,Hf=H._wireframeIndexMap,H._wireframeIndexMap=H._wireframeIndexMapSwap,H._wireframeIndexMapSwap=Hf},_updateSkybox:function(M){if(this._skybox&&M){var i=M.property,J=!1,z=this._skybox;if("eye"===i||"forceUpdate"===i){var l=this._eye;z.p3(l[0],l[1],l[2]),J=!0}if("near"===i||"far"===i||"forceUpdate"===i||"asceptChanged"===i){var K=z.__cachedS3__;K||(K=z.__cachedS3__=z.getFinalScale3d());var H=Math.sqrt(3),Y=1/0,L=-1/0;K.forEach(function(U){U/=2,Y=Q(U,Y),L=N(U,L)}),L*=H;var m=this._near,c=this._far,D=Math.tan(this.getFovy()/2)*m,n=this.getAspect()*D,p=1.1*Math.sqrt(n*n+D*D+m*m),G=1;if(p>Y)G=p/Y;else if(L>=c){var S=c*c/(m+c);G=S/L}if(1!==G){z.__updatingSkybox__=!0;var h=K.map(function(X){return G*X});z.s3(h),z.setScale3d(1,1,1),J=!0,delete z.__updatingSkybox__}}J&&this.invalidateData(z)}},getSkyBox:function(){return this.getSkybox()},setSkyBox:function(n){return this.setSkybox(n)},getSkybox:function(){return this._skybox},setSkybox:function(R){var C=this._skybox;if(C===R)return R&&this._updateSkybox({property:"forceUpdate"}),void 0;if(C&&(this._skyboxStyleMap&&C.setStyleMap(this._skyboxStyleMap),this._skyboxStyleMap=null,this._skyboxAnchor3d&&C.setAnchor3d(this._skyboxAnchor3d),this._skyboxAnchor3d=null,this._skyboxP3&&C.p3(this._skyboxP3),this._skyboxP3=null,this.handleDataModelChange({kind:Lf,data:C})),this._skybox=R,this.ump(this._updateSkybox,this),R){R.dm()&&R.dm().remove(R),this._skyboxStyleMap=U.Default.clone(R.getStyleMap()),this._skyboxAnchor3d=R.getAnchor3d(),R.setAnchor3d(.5,.5,.5),this._skyboxP3=R.p3().slice(0),R.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1});var p=R.onPropertyChanged;R.onPropertyChanged=function(K){p.call(R,K),!R.__updatingSkybox__&&["width","height","tall","scale","scaleTall"].indexOf(K.property)>=0&&(R.__cachedS3__=s)},this.mp(this._updateSkybox,this),this._updateSkybox({property:"forceUpdate"})}this.fp("skybox",C,R)},drawSky:function(R,f){var H=this,p=H._skybox;if(p){var A=ts.for(R).directUniforms(),Q=H._headlightIntensity,D=Jj(H._headlightColor),f=H._prg;1!==Q&&(D=[D[0]*Q,D[1]*Q,D[2]*Q]),A.uHeadlightColor=[D[0],D[1],D[2],1];var S=H.getData3dUI(p);if(S){var _=H.isOrtho(),e=_||this._computedProjectMatrix;if(e){var N=H._projectMatrix;_&&(H._ortho=!1),A.uPMatrix=H._projectMatrix=Mc(H,!0)}var x=p.p3(),F=this.getEye();(x[0]!==F[0]||x[1]!==F[1]||x[2]!==F[2])&&(p._position.x=F[0],p._54O=F[1],p._position.y=F[2]),S.validate(),S._42(R,f,T),e&&(_&&(H._ortho=!0),A.uPMatrix=H._projectMatrix=N)}R.clear(R.DEPTH_BUFFER_BIT),A.uHeadlightColor=[D[0],D[1],D[2],H._headlightDisabled?1:0]}},getLogicalPoint:function(q){return dc(q,this._canvas)},isRectOverlapping:function(O){var W=this.getData3dUI(O);return W._rectOverlapping},getHitFaceInfo:function(z){z.target&&(z=this.lp(z));var L=this.getDataInfoAt(z);if(L){var Q=this.intersectObject(z,L.data);if(Q)return{data:L.data,face:Q.part}}return g},unproject:function(L,g){var S=this,Y=S.getWidth(),G=S.getHeight(),O=L.target?S.lp(L):L,s=O.x-Y/2,u=O.y-G/2,P=2*(s/Y),U=2*(-1*u/G);g=g||0;var A=Wq(),N=Mc(S),r=rr(S);$c(A,N,r),Pr(A);var F=ob([P,U,g,1],A);return[F[0]/F[3],F[1]/F[3],F[2]/F[3]]},getDataAt:function(q){var Q=this.getDataInfoAt(q);return Q?Q.data:g},getDataInfoAt:function(L,u,B){return L.target&&(L=this.lp(L)),this._1o.get(Ii(L.x,L.y,u),!0,B)},getDatasInRect:function(r,c){return this._1o.get(r,!1,c)},setEditable:function(I){var r=this,S=r._editable;r._editable=I,this.fp(Xf,S,I)},isEditable:function(w){var J=this;return w?J._editable?Ob(w)?w.s("3d.editable")?J._editableFunc?J._editableFunc(w):!0:!1:!1:!1:J._editable},isSelectable:function(K){return K.s("3d.selectable")&&this.sm().isSelectable(K)},isMovable:function(A){var P=this;return hg(A)&&A.getStyle(Qj)!==tp?!1:A.s("3d.movable")?P._movableFunc?P._movableFunc(A):!0:!1},isSizeEditable:function(L){return Ob(L)?this._sizeEditableFunc?this._sizeEditableFunc(L):!0:!1},isRotationEditable:function(n){return Ob(n)&&n.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(n):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(k){this.setZoom(dk,k)},zoomOut:function(F){this.setZoom(1/dk,F)},setZoom:function(){var D=new Bb,l=new Bb,i=new Bb,H=new Bb;return function(S,G){if(1!==S){var N=this;N._14o&&N._14o.stop(!0);var x,p=1/S;D.copy(N.getCenter()),l.copy(N.getEye());var v=N._ortho;if(v){if(x=N._orthoWidth,x<N._moveStep&&S>1)return}else if(D.distanceTo(l)<N._moveStep&&1>p)return;var U=!1;return N._zoomToCenter===!1&&N._lastZoomLP&&(i.copy(l).sub(D).normalize(),N._81O=null,H.copy(N.getHitPosition(N._lastZoomLP,D.toArray(),i.toArray())),U=!0,N._lastZoomHit=H),(G=sj(G))?(G.action=function(B){N.fi({kind:N._zooming?"betweenZoom":"beginZoom"}),N._zooming=1;var m=(p-1)*B+1;v&&N.setOrthoWidth(x*m),U?(N.setEye(i.lerpVectors(H,l,m).toArray()),N.setCenter(i.lerpVectors(H,D,m).toArray())):v||N.setEye(i.lerpVectors(D,l,m).toArray())},G._37o=function(){delete N._14o,delete N._zooming,N.fi({kind:"endZoom"}),N.onZoomEnded()},N._14o=Qc(G)):(v&&N.setOrthoWidth(x*p),U?(N.setEye(i.lerpVectors(H,l,p).toArray()),N.setCenter(i.lerpVectors(H,D,p).toArray())):v||N.setEye(i.lerpVectors(D,l,p).toArray()),void 0)}}}(),setOrthoZoom:function(q,e){return this.setZoom(q,e)},getPositionInfo:function(q){var O=this,C=O._eye,W=O._center,i=O.getAspect(),$=q?Jq(Nh(W,C,!0),Nh(q,C)):lr(C,W);if(O._ortho){var N=O._orthoWidth;return{length:$,height:N/i,width:N}}var e=2*Zo(O._fovy/2)*$;return{length:$,height:e,width:e*i}},getCenterInfo:function(){var r=this;return r._81O||(r._81O=r.getPositionInfo()),Wi(r._81O)},rotate:function(K,m,M,F){var R=this;if(K||m){F==g&&(F=R._firstPersonMode),R._88O&&R._88O.stop(!0);var d=R._center,z=R._eye,T=R.getCenterInfo().length,q=F?d:z,Z=F?z:d,b=Nh(q,Z),X=xb(b[0],b[2]),v=xb(w(b[0]*b[0]+b[2]*b[2]),b[1]),o=F?ii:_n;return F&&(m=-m),(M=sj(M))?(M.action=function(Y){R.fi({kind:R._rotating?"betweenRotate":"beginRotate"}),R._rotating=1;var Q=X+K*Y,O=v+m*Y;O=F?a-Gi(R,a-O):Gi(R,O),b[0]=T*_(O)*_(Q),b[1]=T*W(O),b[2]=T*_(O)*W(Q),q[0]=Z[0]+b[0],q[1]=Z[1]+b[1],q[2]=Z[2]+b[2],R.fp(o,g,q)},M._37o=function(){delete R._88O,delete R._rotating,R.fi({kind:"endRotate"}),R.onRotateEnded()},R._88O=Qc(M)):(X+=K,v+=m,v=F?a-Gi(R,a-v):Gi(R,v),b[0]=T*_(v)*_(X),b[1]=T*W(v),b[2]=T*_(v)*W(X),q[0]=Z[0]+b[0],q[1]=Z[1]+b[1],q[2]=Z[2]+b[2],R.fp(o,g,q),void 0)}},pan:function(t,l,h,Z){if(t||l){var V=this;Z==g&&(Z=V._firstPersonMode),V._89O&&V._89O.stop(!0);var c=rr(V),P=[c[0]*t,c[4]*t,c[8]*t],O=[c[1]*l,c[5]*l,c[9]*l],S=P[0]+O[0],b=P[1]+O[1],n=P[2]+O[2],r=V._center,U=V._eye;if(Z){var G=Mf(V.getBoundaries(),U[0],U[2],U[0]+S,U[2]+n,w(S*S+n*n));S=G[0],n=G[1]}if(h=sj(h)){var v=Wi(U),z=Wi(r);return h.action=function(C){V.fi({kind:V._panning?"betweenPan":"beginPan"}),V._panning=1,r[0]=z[0]+S*C,r[1]=z[1]+b*C,r[2]=z[2]+n*C,U[0]=v[0]+S*C,U[1]=v[1]+b*C,U[2]=v[2]+n*C,V.fp(_n,g,U),V.fp(ii,g,r)},h._37o=function(){delete V._89O,delete V._panning,V.fi({kind:"endPan"}),V.onPanEnded()},V._89O=Qc(h)}r[0]+=S,r[1]+=b,r[2]+=n,U[0]+=S,U[1]+=b,U[2]+=n,V.fp(_n,g,U),V.fp(ii,g,r)}},walk:function(r,H,V){if(r){var y=this;V==g&&(V=y._firstPersonMode),y._90O&&y._90O.stop(!0);var G=y._center,D=y._eye,$=Nh(G,D,!0);if(V){var x=Mf(y.getBoundaries(),D[0],D[2],D[0]+$[0]*r,D[2]+$[2]*r,B(r));if(r=lr(x),!r)return;$=[x[0]/r,0,x[1]/r]}if(H=sj(H)){var N=Wi(D),i=Wi(G);return H.action=function(e){y.fi({kind:y._walking?"betweenWalk":"beginWalk"}),y._walking=1;var L=r*e;D[0]=N[0]+$[0]*L,D[1]=N[1]+$[1]*L,D[2]=N[2]+$[2]*L,G[0]=i[0]+$[0]*L,G[1]=i[1]+$[1]*L,G[2]=i[2]+$[2]*L,y.fp(_n,g,D),y.fp(ii,g,G)},H._37o=function(){delete y._90O,delete y._walking,y.fi({kind:"endWalk"}),y.onWalkEnded()},y._90O=Qc(H)}D[0]+=$[0]*r,D[1]+=$[1]*r,D[2]+=$[2]*r,G[0]+=$[0]*r,G[1]+=$[1]*r,G[2]+=$[2]*r,y.fp(_n,g,D),y.fp(ii,g,G)}},handleScroll:function(U,I){fk(U);var Q=this,j=Q._moveStep,m=Q.getDataInfoAt(U);if(m){var X=m.data;if(X&&Q.isInteractive(X)){var d=Q.intersectObject(U,X);if(d){var E=d.part,a=dg(X.s(E+".image")||X.s("shape3d."+E+".image")||X.s("all.image")||X.s("shape3d.image"));if(a&&gs(a.scrollable,X,Q))return}}}return Q.isFirstPersonMode()?(Q.isPannable()&&Q.pan(0,I>0?j:-j),void 0):(Q.isZoomable()&&(Q._lastZoomLP=Q.lp(U),Q.setZoom(0>I?1/Ml:Ml),Q._lastZoomLP=Q._lastZoomHit=null),void 0)},handlePinch:function(g,G){if(this.isZoomable()){if(Math.abs(g-G)<p.pinchZoomThreshold)return;this.setZoom(G>g?1/Ki:Ki)}},reset:function(Q){this.setUp(p.graph3dViewUp),this.moveCamera(p.graph3dViewEye,p.graph3dViewCenter,Q)},moveSelection:function(Z,G,m){var o=this;o.dm().beginTransaction(),qm(this.sm().toSelection(this.isMovable,this),Z,G,m),o.dm().endTransaction()},getMoveMode:function(y,w){var k=w.s("3d.move.mode");if(k)return k;var c="88",Q="89",A="90";return te(y)||Xd[c]&&Xd[Q]&&Xd[A]?"xyz":Xd[c]&&Xd[Q]?"xy":Xd[c]&&Xd[A]?"xz":Xd[Q]&&Xd[A]?"yz":Xd[c]?"x":Xd[Q]?"y":Xd[A]?"z":"xz"},handleTick:function(){var i=this,m=!1,k=i._moveStep,v=k,R=!1,D=!0,x=i._rotateStep*(D?-1:1);if(i.isWalkable()||(v=0),i.isPannable()||(k=0),i.isRotatable()||(x=0),i._32Q){var s=(rp()-i._32Q)/50;v*=s,k*=s,x*=s}i._31Q&&(es(i._31Q),delete i._31Q,delete i._32Q),Cg()&&(m=!0,i.pan(-k,0,R,D)),bk()&&(m=!0,i.pan(k,0,R,D)),je()&&(m=!0,te()?i.pan(0,k,R,D):i.walk(v,R,D)),Pd()&&(m=!0,te()?i.pan(0,-k,R,D):i.walk(-v,R,D)),qh()&&(m=!0,i.rotate(-x,0,R,D)),Nf()&&(m=!0,i.rotate(x,0,R,D)),ol()&&(m=!0,i.rotate(0,-x/2,R,D)),lg()&&(m=!0,i.rotate(0,x/2,R,D)),m&&(i._32Q=rp(),i._31Q=oq(i.handleTick,i))},handleKeyDown:function(a){var c=this;!wc(a)&&wp[a.keyCode]?c.handleTick():om(a)?c.selectAll():Lk(a)?c.handleDelete(a):Wc(a)&&this.isResettable()&&c.reset()},checkDoubleClickOnNote:function(j,d,B){var J=this;if(B===zg){if(d.s("note.toggleable"))return d.s(xk,!d.s(xk)),J.fi({kind:"toggleNote",event:j,data:d,part:B}),!0}else if(B===Zb&&d.s("note2.toggleable"))return d.s(Jl,!d.s(Jl)),J.fi({kind:"toggleNote2",event:j,data:d,part:B}),!0;return!1},checkDoubleClickOnRotation:function(h,v,V){return V===Ss?(v.setRotationX(0),!0):V===Ts?(v.setRotationY(0),!0):V===Us?(v.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(a){var H=this;if(H.isOrtho())return H.getWidth()/H.getOrthoWidth();var g=H.getCenter(),G=H.getHeight(),W=H.getEye(),d=[g[0]-W[0],g[1]-W[1],g[2]-W[2]],b=[a[0]-W[0],a[1]-W[1],a[2]-W[2]],z=Math.sqrt(d[0]*d[0]+d[1]*d[1]+d[2]*d[2]),y=1/Math.tan(H.getFovy()/2);return G*z*y/(b[0]*d[0]+b[1]*d[1]+b[2]*d[2])},inViewSpace:function(Y){var N,n=this,s=n._transformPointToViewSpace(Y),g=n.getAspect(),h=n.getNear(),F=n.getFar();return-s[2]<h||-s[2]>F?!1:n.isOrtho()?(N=n.getOrthoWidth()/2,Math.abs(s[0])<=N&&Math.abs(s[1]*g)<=N):(N=Math.sqrt(s[0]*s[0]+s[1]*s[1]+s[2]*s[2])*Math.tan(n.getFovy()/2),Math.abs(s[1]<=N)&&Math.abs(s[0])<=N*g)},getPVMatrix:function(){var T,f=this;return(T=f._18Q)||(T=Mc(f),f._18Q=$c(T,T,rr(f)),f._18Q._wh=f.getWidth()/2/f.getHeight()),T},getFrustum:function(){var s=new cr,Z=new qg,Y=new Array(16);return function(){for(var u=this.getPVMatrix(),f=!1,M=0;16>M;M++)u[M]!==Y[M]&&(f=!0,Y[M]=u[M]);return f&&Z.setFromMatrix(s.fromArray(u)),Z}}(),toViewPosition:function(A){var k=this,P=k.getWidth()/2,z=k.getHeight()/2,p=k.getPVMatrix();return A=ob([A[0],A[1],A[2],1],p),{x:P+P*A[0]/A[3],y:z-z*A[1]/A[3],z:A[2]/A[3]}},getHitPosition:function(S,G,u){var K=this,I=K.getWidth(),l=K.getHeight(),d=S.target?K.lp(S):S,X=d.x-I/2,N=d.y-l/2,Q=K.getCenterInfo(),B=rr(K);G=G?G:[0,0,0],u=u?u:[0,1,0],X=X/I*Q.width,N=-1*N/l*Q.height;var M=[B[0]*X,B[4]*X,B[8]*X],L=[B[1]*N,B[5]*N,B[9]*N],A=[M[0]+L[0],M[1]+L[1],M[2]+L[2]],g=K.getCenter(),i=Sr(K,G,u,[A[0]+g[0],A[1]+g[1],A[2]+g[2]]);return i?i:[0,0,0]},intersectObject:function(r,n){return this._raycaster.intersectObject(r,n)},intersectObjects:function(B,I,n){return this._raycaster.intersectObjects(B,I,n)},getLineLength:function(t){this.validate();var I=this.getData3dUI(t);if(I&&I.getCache){var o=I.getCache();if(o)return o[o.length-1].length}return 0},getLineOffset:function(O,J){var C=this.getData3dUI(O);if(C&&C.getCache){var D=C.getCache();if(D){var Q=rh(D,J);if(!O.r3)return Q;var y=O.r3();if(0===y[0]&&0===y[1]&&0===y[2])return Q;var $=new Bb(O.p3()),r=new Bb(Q.point).sub($),R=new Bb(Q.tangent).add(r),z=(new kg).setFromEuler(new qj(y,O.getRotationMode(),!0));return r.applyQuaternion(z),R.applyQuaternion(z),{point:r.add($),tangent:R.sub(r).normalize()}}}return g},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(P,y,b){var E=this,o=E.getEye();o=[o[0],o[1],o[2]];var z=E.getCenter();if(z=[z[0],z[1],z[2]],P||(P=o),y||(y=z),E._flyAnim&&E._flyAnim.stop(!0),b=sj(b),!b)return E.setEye(P[0],P[1],P[2]),E.setCenter(y[0],y[1],y[2]),delete E._flyAnim,!0;var R=[P[0]-o[0],P[1]-o[1],P[2]-o[2]],j=[y[0]-z[0],y[1]-z[1],y[2]-z[2]];return b.action=function(x){E.setCenter(z[0]+j[0]*x,z[1]+j[1]*x,z[2]+j[2]*x),E.setEye(o[0]+R[0]*x,o[1]+R[1]*x,o[2]+R[2]*x)},b._37o=function(){delete E._flyAnim},E._flyAnim=Qc(b)},flyTo:function(){function C(Z,A,K){if(K instanceof U.Node){$.fromArray(Ph(K,A.getMat(K)));var t=K.getAnchor3d();Z.push((new Bb).set(0-t.x,0-t.y,0-t.z).applyMatrix4($)),Z.push((new Bb).set(0-t.x,0-t.y,1-t.z).applyMatrix4($)),Z.push((new Bb).set(0-t.x,1-t.y,0-t.z).applyMatrix4($)),Z.push((new Bb).set(0-t.x,1-t.y,1-t.z).applyMatrix4($)),Z.push((new Bb).set(1-t.x,0-t.y,0-t.z).applyMatrix4($)),Z.push((new Bb).set(1-t.x,0-t.y,1-t.z).applyMatrix4($)),Z.push((new Bb).set(1-t.x,1-t.y,0-t.z).applyMatrix4($)),Z.push((new Bb).set(1-t.x,1-t.y,1-t.z).applyMatrix4($))}}var T=new Bb,r=new Bb,W=new Bb,x=new Bb,V=new Bb,$=new cr,K=new U.Math.Quaternion,d=new qj,E=new el;return function(Q,k,M){var Z=this;"boolean"==typeof k&&(k={animation:k}),k=k||{};var _=k.center,l=k.distance,t=k.direction,c=k.worldDirection,y=M||k.ratio||.8,i=k.xRatio||y,v=k.yRatio||y;(M!==s||k.duration||k.frames)&&(k={animation:k});var R,g,a=[],q=l===s;if(_&&W.fromArray(_),!_||q)if(Q||(Q=Z.dm().getDatas()),1===Q.length&&(Q=Qq(Q)?Q.get(0):Q[0]),Q instanceof U.Node)_||W.fromArray(Q.p3()),q&&(C(a,Z,Q),R=a.length);else{if(!Q.length)return;if((q||!_)&&(a=[],Q.forEach(function(J){C(a,Z,J)}),R=a.length,!R))return;_||(E.setFromPoints(a),W.copy(E.min).add(E.max).multiplyScalar(.5))}if(Z._flyAnim&&Z._flyAnim.stop(!0),T.fromArray(Z.getEye()),r.fromArray(Z.getCenter()),Z.setCenter(W.x,W.y,W.z),x.subVectors(T,r),t||c){!c&&Q instanceof U.Node?K.setFromEuler(d.set(Q.r3(),Q.getRotationMode(),!0)):K.set(0,0,0,1);var D=x.length();x.fromArray(c||t).applyQuaternion(K).setLength(D)}var I=new Bb(Z.getUp()),f=fo.fequal(I.x,0,1e-5)&&fo.fequal(I.z,0,1e-5);if(f&&0===x.x&&0===x.z){var e=.001,j=x.y;x.y=j*(1-e),x.z=Math.sign(j)*e}var b=0;if(q){var n,O,A,L=i,P=v;if(V.copy(x),Z.isOrtho()){var z=-1/0;for(Z._eye[0]=x.x+W.x,Z._eye[1]=x.y+W.y,Z._eye[2]=x.z+W.z,n=Mc(Z),$c(n,n,rr(Z)),g=0;R>g;g++)A=a[g],O=ob([A.x,A.y,A.z,1],n),z=Math.max(z,Math.max(Math.abs(O[0])/L,Math.abs(O[1])/P));b=Z.getOrthoWidth()*z}else{for(var B,G,X=Z.getNear(),J=10;J--;){for(Z._eye[0]=x.x+W.x,Z._eye[1]=x.y+W.y,Z._eye[2]=x.z+W.z,n=Mc(Z),$c(n,n,rr(Z)),B=!0,G=-1/0,g=0;R>g;g++){if(A=a[g],O=ob([A.x,A.y,A.z,1],n),O[3]<X&&J){x.multiplyScalar(2),B=!1;break}G=Math.max(G,Math.max(Math.abs(O[0])/L,Math.abs(O[1])/P)-O[3])}if(B)break}x.setLength(G+x.length())}x.manhattanLength()<1e-6&&x.copy(V)}else x.setLength(l);var $=x.add(W),m=sj(k.animation);if(m){Z.setEye(T.x,T.y,T.z),Z.setCenter(r.x,r.y,r.z);var w=$.clone().sub(W),S=w.length();S&&w.multiplyScalar(1/S);var h=T.clone().sub(r),o=h.length();o&&h.multiplyScalar(1/o);var F=(new cr).lookAtDirection(h,I),H=(new cr).lookAtDirection(w,I),N=(new kg).setFromRotationMatrix(F),Y=(new kg).setFromRotationMatrix(H),u=(new Bb).subVectors(W,r);if(b)var oq=Z.getOrthoWidth();var nq=new Bb,km=new Bb,qn=new Bb,el=m.action,Ab=m._37o,Ao=r.clone();return m.action=function(t,i){km.copy(Ao).addScaledVector(u,t);var f=N.clone().slerp(Y,t);nq.set(0,0,1).applyQuaternion(f).setLength(o+(S-o)*t).add(km),qn.set(0,1,0).applyQuaternion(f),Z.setCenter(km.x,km.y,km.z),Z.setEye(nq.x,nq.y,nq.z),Z.setUp(qn.x,qn.y,qn.z),b&&Z.setOrthoWidth((b-oq)*t+oq),el&&el(t,i)},m._37o=function(){delete Z._flyAnim;var s=Z.getUp(),C=f?p.graph3dViewUp:I.toArray();(s[0]!==C[0]||s[1]!==C[1]||s[2]!==C[2])&&Z.setUp(C),Ab&&Ab()},{lastEye:T,lastCenter:r,eye:$,center:W,orthoWidth:b,animation:Z._flyAnim=Qc(m)}}return Z.setEye($.x,$.y,$.z),Z.setCenter(W.x,W.y,W.z),b&&Z.setOrthoWidth(b),delete Z._flyAnim,{lastEye:T,lastCenter:r,eye:$,center:W,orthoWidth:b}}}(),getBoundingBox:function(){function z(H,k,l){L.fromArray(Ph(l,k.getMat(l)));var Q=l.getAnchor3d();H.push((new Bb).set(0-Q.x,0-Q.y,0-Q.z).applyMatrix4(L)),H.push((new Bb).set(0-Q.x,0-Q.y,1-Q.z).applyMatrix4(L)),H.push((new Bb).set(0-Q.x,1-Q.y,0-Q.z).applyMatrix4(L)),H.push((new Bb).set(0-Q.x,1-Q.y,1-Q.z).applyMatrix4(L)),H.push((new Bb).set(1-Q.x,0-Q.y,0-Q.z).applyMatrix4(L)),H.push((new Bb).set(1-Q.x,0-Q.y,1-Q.z).applyMatrix4(L)),H.push((new Bb).set(1-Q.x,1-Q.y,0-Q.z).applyMatrix4(L)),H.push((new Bb).set(1-Q.x,1-Q.y,1-Q.z).applyMatrix4(L))}var L=new cr;return function($){if($=$||this.sm().getSelection(),$ instanceof U.Node&&($=[$]),0===$.length)return g;var r=[];$.forEach(function(m){Ob(m)&&z(r,this,m)},this);var j=[1/0,1/0,1/0],R=[-1/0,-1/0,-1/0];return r.forEach(function(L){j[0]=Math.min(L.x,j[0]),j[1]=Math.min(L.y,j[1]),j[2]=Math.min(L.z,j[2]),R[0]=Math.max(L.x,R[0]),R[1]=Math.max(L.y,R[1]),R[2]=Math.max(L.z,R[2])}),{min:j,max:R}}}(),setBatchInfo:function(d,b){var E=this._batchInfoMap[d];this._batchInfoMap[d]=b,this.fp("batchInfo",E,b)},getBatchInfo:function(n){return this._batchInfoMap[n]||Fb[n]},setOrthoWidth:function(A){var g=this._orthoWidth;if(this._orthoWidth=A,this._syncEyeWithOrthoWidth){var y=A/this.getAspect(),X=y/2/Zo(this.getFovy()/2),h=(new Bb).fromArray(this.getEye()),B=(new Bb).fromArray(this.getCenter());h.sub(B).setLength(X).add(B),this.setEye(h.toArray())}this.fp("orthoWidth",g,A)},getCamera:function(C){var E=this;C||(C=E._mainCamera,C||(C=E._mainCamera=new U.Camera)),C.s({"camera.type":E.isOrtho()?"ortho":"perspective","camera.aspect":E.getAspect(),"camera.fovy":E.getFovy(),"camera.ortho.width":E.getOrthoWidth(),"camera.near":E.getNear(),"camera.far":E.getFar()});var T=E.getEye();return C.p3(T.slice()),C.lookAt(E.getCenter(),E.getUp()),C},resetHeadlightProperties:function(){this._headlightColor=p.graph3dViewHeadlightColor,this._headlightIntensity=p.graph3dViewHeadlightIntensity,this._headlightRange=p.graph3dViewHeadlightRange,this._headlightGroup=p.graph3dViewHeadlightGroup,this._headlightAmbientIntensity=p.graph3dViewHeadlightAmbientIntensity,this._headlightDisabled=p.graph3dViewHeadlightDisabled},resetFogProperties:function(){this._fogDisabled=p.graph3dViewFogDisabled,this._fogMode=p.graph3dViewFogMode,this._fogDensity=p.graph3dViewFogDensity,this._fogColor=p.graph3dViewFogColor,this._fogNear=p.graph3dViewFogNear,this._fogFar=p.graph3dViewFogFar}}),function(){function r(_,z,U){var Q=_[z];Q&&Q.releaseTexture(),_[z]=U}function y(){return["\n #ifdef ENVMAP_TYPE_CUBE_UV \n","#define cubeUV_maxMipLevel 8.0 \n","#define cubeUV_minMipLevel 4.0 \n","#define cubeUV_maxTileSize 256.0 \n","#define cubeUV_minTileSize 16.0 \n","float getFace(vec3 direction) {","vec3 absDirection = abs(direction);","float face = - 1.0;","if (absDirection.x > absDirection.z) {","if (absDirection.x > absDirection.y)","face = direction.x > 0.0 ? 0.0 : 3.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","} else {","if (absDirection.z > absDirection.y) ","face = direction.z > 0.0 ? 2.0 : 5.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","}","return face;","} ","vec2 getUV(vec3 direction, float face) {","vec2 uv;","if (face == 0.0) {","uv = vec2(direction.z, direction.y) / abs(direction.x);","} else if (face == 1.0) {","uv = vec2(- direction.x, - direction.z) / abs(direction.y);","} else if (face == 2.0) {","uv = vec2(- direction.x, direction.y) / abs(direction.z);","} else if (face == 3.0) {","uv = vec2(- direction.z, direction.y) / abs(direction.x);","} else if (face == 4.0) {","uv = vec2(- direction.x, direction.z) / abs(direction.y);","} else {","uv = vec2(direction.x, direction.y) / abs(direction.z);","}","return 0.5 * (uv + 1.0);","} ","vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {","float face = getFace(direction);","float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);","mipInt = max(mipInt, cubeUV_minMipLevel);","float faceSize = exp2(mipInt);","float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);","vec2 uv = getUV(direction, face) * (faceSize - 1.0);","vec2 f = fract(uv);","uv += 0.5 - f;","if (face > 2.0) {","uv.y += faceSize;","face -= 3.0;","}","uv.x += face * faceSize;","if (mipInt < cubeUV_maxMipLevel) {","uv.y += 2.0 * cubeUV_maxTileSize;","}","uv.y += filterInt * 2.0 * cubeUV_minTileSize;","uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);","uv *= texelSize;","vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x += texelSize;","vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.y += texelSize;","vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x -= texelSize;","vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","vec3 tm = mix(tl, tr, f.x);","vec3 bm = mix(bl, br, f.x);","return mix(tm, bm, f.y);","}","\n #define r0 1.0 \n","#define v0 0.339 \n","#define m0 - 2.0 \n","#define r1 0.8 \n","#define v1 0.276 \n","#define m1 - 1.0 \n","#define r4 0.4 \n","#define v4 0.046 \n","#define m4 2.0 \n","#define r5 0.305 \n","#define v5 0.016 \n","#define m5 3.0 \n","#define r6 0.21 \n","#define v6 0.0038 \n","#define m6 4.0 \n","float roughnessToMip(float roughness) {","float mip = 0.0;","if (roughness >= r1) {","mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;","} else if (roughness >= r4) {","mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;","} else if (roughness >= r5) {","mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;","} else if (roughness >= r6) {","mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;","} else {","mip = - 2.0 * log2(1.16 * roughness);","}","return mip;","} ","vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {","float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);","float mipF = fract(mip);","float mipInt = floor(mip);","vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);","if (mipF == 0.0) {","return vec4(color0, 1.0);","} else {","vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);","return vec4(mix(color0, color1, mipF), 1.0);","}","} ","\n #endif \n"].join("")}function P(){return["vec4 sRGBToLinear( in vec4 value ) {","return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );","}","vec4 LinearTosRGB( in vec4 value ) {","return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );","}","vec4 inputTexelToLinear( vec4 value ) { return sRGBToLinear( value ); }","vec4 linearToOutputTexel( vec4 value ) { return LinearTosRGB( value ); }","vec4 envMapTexelToLinear( vec4 color ) { return inputTexelToLinear( color ); }"].join("")}function I(){return["precision mediump float;\n","precision mediump int;\n","attribute vec3 position;","attribute vec2 uv;","attribute float faceIndex;","varying vec3 vOutputDirection;","vec3 getDirection( vec2 uv, float face ) {","uv = 2.0 * uv - 1.0;","vec3 direction = vec3( uv, 1.0 );","if ( face == 0.0 ) { direction = direction.zyx; } ","else if ( face == 1.0 ) { direction = direction.xzy; direction.xz *= -1.0; } ","else if ( face == 2.0 ) { direction.x *= -1.0; }","else if ( face == 3.0 ) { direction = direction.zyx; direction.xz *= -1.0; } ","else if ( face == 4.0 ) { direction = direction.xzy; direction.xy *= -1.0; } ","else if ( face == 5.0 ) { direction.z *= -1.0; }","return direction;","}","void main() {","vOutputDirection = getDirection( uv, faceIndex );","gl_Position = vec4( position, 1.0 );","}"].join("")}function N(){return{vs:I(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform samplerCube envMap;\n",P(),"\n void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3(- vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function V(){return{vs:I(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform vec2 texelSize;\n",P(),"\n #define RECIPROCAL_PI 0.3183098861837907 \n","\n #define RECIPROCAL_PI2 0.15915494309189535 \n","vec2 equirectUv( in vec3 dir ) {","float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;","float v = 0.5 - asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI;","return vec2( u, v );","}","void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","vec3 outputDirection = normalize( vOutputDirection );","vec2 uv = equirectUv( outputDirection );","vec2 f = fract( uv / texelSize - 0.5 );","uv -= f * texelSize;","vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x += texelSize.x;","vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.y += texelSize.y;","vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x -= texelSize.x;","vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","vec3 tm = mix( tl, tr, f.x );","vec3 bm = mix( bl, br, f.x );","gl_FragColor.rgb = mix( tm, bm, f.y );","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function z(Y){return{vs:I(),fs:["precision mediump float;\n","precision mediump int;\n","#define n "+Y+"\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform int samples;","uniform float weights[ n ];","uniform bool latitudinal;","uniform float dTheta;","uniform float mipInt;","uniform vec3 poleAxis; \n",P(),"\n #define ENVMAP_TYPE_CUBE_UV \n",y(),"\n vec3 getSample( float theta, vec3 axis ) {","float cosTheta = cos( theta );","vec3 sampleDirection = vOutputDirection * cosTheta + cross(axis, vOutputDirection) * sin(theta) + axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);","return bilinearCubeUV( envMap, sampleDirection, mipInt );","}","void main() {","vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );","if ( all( equal( axis, vec3( 0.0 ) ) ) ) {","axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );","}","axis = normalize( axis );","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );","for ( int i = 1; i < n; i++ ) {","if ( i >= samples ) { break; }","float theta = dTheta * float( i );","gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );","gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );","}","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}var T=dd.EnvmapRenderer=function(U){this.gv=U,this._envmaps={},this._envmapHash={},this._probeCaptureTime={},this._pingPongRenderTarget=null,this._equirectShader=null,this._cubemapShader=null,this._blurMaterial=null,this._lastCaptureFrame=0};T.prototype={},T.prototype.constructor=T,T.prototype.changeEnvmapType=function(K){"legacy"===K?(this.setEnvmapByProbeId=this.setEnvmapLegacy,this.onBeforeRender=this.onBeforeRenderLegacy):(this.setEnvmapByProbeId=this.setEnvmap,this.onBeforeRender=this.onBeforeRenderNew)},T.prototype.invalidateEnvmap=function(C){var J=this.gv;if("legacy"!==J.getEnvmapType()){var I=J.getGL();I&&(C?(delete this._envmapHash[C],delete this._probeCaptureTime[C]):(this._envmapHash={},this._probeCaptureTime={}),J.iv())}},T.prototype.onBeforeRenderLegacy=function(v){this.assureTextureLegacy(v)},T.prototype.assureTextureLegacy=function(t){var q=this,h=q.gv,T=h.getEnvmap();if(T!==q._lastLegacyImage){if(q._envmapLegacy&&(t.deleteTexture(q._envmapLegacy),q._envmapLegacy=null),!T)return q._lastLegacyImage=T,void 0;var A=p.getImage(T);if(A&&A.tagName){A=p.resizeImagePOT(A,!0);var j=q._envmapLegacy=t.createTexture();t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_CUBE_MAP,j),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,A),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,A),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,A),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,A),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,A),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,A),t.bindTexture(t.TEXTURE_CUBE_MAP,t._emptyCubeTexture),q._lastLegacyImage=T}}},T.prototype.setEnvmapLegacy=function(X){X.uEnvMap=this._envmapLegacy},T.prototype.onBeforeRenderNew=function(E){this.assureTextureNew(E),this.resetUniformCache()},T.prototype.assureTextureNew=function(q){var J=this,L=J.gv,s=L.getEnvmap(),I=J._envmapHash,A=J._envmaps,k=q._renderInfo.frame;if(!(this._lastCaptureFrame>=k||L._picking))for(var $ in s){var n,f=s[$],P=f.type;switch(P){case"sphere":n=f.image,n!==I[$]&&(im=p.getImage(n),im&&(I[$]=n,r(A,$,J.fromEquirectangular(n))));break;case"cube":var N=f.images;if(N&&6===N.length&&(n=N.join(","),n!==I[$])){for(var M=!0,t=0;6>t;t++)if(!p.getImage(N[t])){M=!1;break}M&&(I[$]=n,r(A,$,J.fromCubemap(N)))}break;case"skybox":var R=L.getSkybox();if(R){var Y=R.s("shape3d");if(n="sphere"===Y?R._id+"_"+R.s("shape3d.image"):R._id+"_"+R.s("front.image"),n!==I[$]){var M;if("sphere"===Y)M=p.getImage(R.s("shape3d.image"));else{M=!0;for(var E=["front","back","left","right","top","bottom"],t=0;6>t;t++)if(!p.getImage(R.s(E[t]+".image"))){M=!1;break}}M&&(I[$]=n,r(A,$,J.fromSkybox()))}}break;case"probe":var H=f.pos,K=f.size;if(n=H[0]+"_"+H[1]+"_"+H[2]+"_"+K,n!==I[$]){var z=this._probeCaptureTime[n],F=Date.now();z||(this._probeCaptureTime[n]=z=F),F-z>p.envmapProbeMinWaitTime&&!jd&&!Oh||F-z>p.envmapProbeMaxWaitTime?(delete this._probeCaptureTime[n],I[$]=n,r(A,$,J.fromSceneProbe(H,K,f.filter))):L.iv()}}}},T.prototype.resetUniformCache=function(){this._frameUniformCache={}},T.prototype.setEnvmap=function(y,b){var L=y.uuid,f=this._frameUniformCache,q=this._envmaps[b];q&&(q=q.texture),f[L]!==q&&(f[L]=q,y.uEnvMap=q)},T.prototype.fromEquirectangular=function(c){var z=U.Default.getImage(c);return this.rectSize=[1/z.width,1/z.height],c=this.gv.getTexture(c),this.fromTexture(c)},T.prototype.fromCubemap=function(B){var n=this.gv.getGL(),Z=n.createTexture();n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_CUBE_MAP,Z),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MIN_FILTER,n.LINEAR);for(var z=[],j=L/3,y=0;6>y;y++)z[y]=p.resizeImage(U.Default.getImage(B[y]),j);return n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,z[0]),n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,z[1]),n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,z[2]),n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,z[3]),n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,z[4]),n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,z[5]),n.bindTexture(n.TEXTURE_CUBE_MAP,n._emptyCubeTexture),this.fromTexture(Z,!0)
},T.prototype.fromTexture=function(l,O){var z=this._allocateTargets();this._pingPongRenderTarget||(this._pingPongRenderTarget=this._allocateTargets());var Y=this.gv,P=Y.getGL(),p=ts.for(P).directState(),v=p.depth.enabled;p.scissor.enabled=!0,p.depth.enabled=!1;var k=Y.getViewport(P);return this._textureToCubeUV(l,z,O),this._applyPMREM(z),z.unbind(P),Y.setViewport(P,k[0],k[1],k[2],k[3]),p.depth.enabled=v,p.scissor.enabled=!1,z},T.prototype.fromSkybox=function(){return this._fromCamera(function(W){W.s({"camera.onlySky":!0})})},T.prototype.fromScene=function(N){return this._fromCamera(function(G){G.s({"camera.onlySky":!1}),N&&N(G)})},T.prototype.fromNode=function(h){var f=this.gv.getData3dUI(h),K=f._42;f._42=Yd;var F=this.gv.getSkybox(),E=h.p3();if(F){var R=F.p3();F.p3(E)}var p=this.fromScene(function(H){H.p3(E)});return f._42=K,F&&F.p3(R),p},T.prototype.fromSceneProbe=function(J,u,t){var D=this.gv,I=D.getSkybox();if(I){var B=I.p3();I.p3(J)}if(t){var f=D.isVisible;D.isVisible=function(g){var o=t(g);return o!==s?o:f.call(D,g)}}var _=this.fromScene(function(q){q.p3(J),q.s("camera.near",u)});return t&&(D.isVisible=f),I&&I.p3(B),_},T.prototype._fromCamera=function($){var f=this.gv,k=f.getCamera();$&&$(k);var o=new Zp(f,L,L,{cube:!0}),J=f.getGL(),z=f.getViewport(J),y=this.setEnvmapByProbeId,v=this.onBeforeRender;this.setEnvmapByProbeId=function(k){k.envMap=J._emptyTexture},this.onBeforeRender=Yd,k.attachRenderTarget(o),k.render(f),k.detachRenderTarget(),this.setEnvmapByProbeId=y,this.onBeforeRender=v,f.setViewport(J,z[0],z[1],z[2],z[3]);var G=this.fromTexture(o.texture,!0);return o.releaseTexture(),G},T.prototype._allocateTargets=function(){return new Zp(this.gv,3*q,3*q,{magFilter:gq.NEAREST,minFilter:gq.NEAREST})},T.prototype._textureToCubeUV=function(i,S,P){var o,I=this.gv;P?null==(o=this._cubemapShader)&&(this._cubemapShader=o=this.createShader(N())):null==(o=this._equirectShader)&&(this._equirectShader=o=this.createShader(V()));var s=I.getGL();S.bind(s),this._setViewport(S,0,0,3*q,2*q);var k=I.getRenderState();k.useProgram(o);var v=k.directUniforms(),r=k.directAttribs();v.envMap=i,P||(v.texelSize=this.rectSize);var G=A[0];r.position=bo(s,null,G.vs,g,3),r.uv=bo(s,null,G.uv,g,2),r.faceIndex=bo(s,null,G.faceIs,g,1),Co(s,0,G.vs.length/3)},T.prototype._applyPMREM=function(t){for(var T,h,o,T=1;F>T;T++)h=Math.sqrt(O[T]*O[T]-O[T-1]*O[T-1]),o=S[(T-1)%S.length],this._blur(t,T-1,T,h,o)},T.prototype._setViewport=function(b,i,M,u,C){var c=this.gv;c.setViewport(c.getGL(),i,M,u,C),c.getRenderState().directState().scissor.box=[i,M,u,C]},T.prototype._blur=function(a,Q,X,s,R){var u=this._pingPongRenderTarget;this._halfBlur(a,u,Q,X,s,"latitudinal",R),this._halfBlur(u,a,X,X,s,"longitudinal",R)},T.prototype.createShader=function(g){var C=this.gv;return C.getPostProcessing().createShader(C.getGL(),g).program},T.prototype._halfBlur=function(u,D,n,p,R,P,y){var r=this.gv,W=this._blurMaterial;if("latitudinal"===P||"longitudinal"===P){W||(this._blurMaterial=W=this.createShader(z(M)));var m=r.getGL();D.bind(m);var x=3,V=r.getRenderState();V.useProgram(W);var X,K,C,w=V.directUniforms(),k=V.directAttribs(),s=o[n]-1,Z=isFinite(R)?Math.PI/(2*s):2*Math.PI/(2*M-1),L=R/Z,$=isFinite(R)?1+Math.floor(x*L):M,B=[],O=0;for(X=0;M>X;++X)K=X/L,C=Math.exp(-K*K/2),B.push(C),0==X?O+=C:$>X&&(O+=2*C);for(X=0;X<B.length;X++)B[X]=B[X]/O;w.envMap=u.texture,w.samples=$,w.weights=B,w.latitudinal="latitudinal"===P,y&&(w.poleAxis=y),w.dTheta=Z,w.mipInt=_-n;var a=o[p],K=3*Math.max(0,q-2*a),H=(0===p?0:2*q)+2*a*(p>_-e?p-_+e:0);this._setViewport(D,K,H,3*a,2*a);var I=A[p];k.position=bo(m,null,I.vs,g,3),k.uv=bo(m,null,I.uv,g,2),k.faceIndex=bo(m,null,I.faceIs,g,1),Co(m,0,I.vs.length/3),D.unbind(m)}};var e=4,_=8,q=Math.pow(2,_),v=[.125,.215,.35,.446,.526,.582],F=_-e+1+v.length,M=20,u=(1+Math.sqrt(5))/2,B=1/u,S=[new Bb(1,1,1),new Bb(-1,1,1),new Bb(1,1,-1),new Bb(-1,1,-1),new Bb(0,u,B),new Bb(0,u,-B),new Bb(B,0,u),new Bb(-B,0,u),new Bb(u,B,0),new Bb(-u,B,0)],Z=function(){for(var Y=[],t=[],S=[],$=_,y=0;F>y;y++){var x=Math.pow(2,$);t.push(x);var f=1/x;y>_-e?f=v[y-_+e-1]:0==y&&(f=0),S.push(f);for(var g=1/(x-1),w=-g/2,j=1+g/2,P=6,h=[],i=[],k=[],z=0;P>z;z++){var H=2*(z%3)/3-1,R=z>2?0:-1;h.push(H,R,0,H+2/3,R,0,H+2/3,R+1,0,H,R,0,H+2/3,R+1,0,H,R+1,0),i.push(w,w,j,w,j,j,w,w,j,j,w,j),k.push(z,z,z,z,z,z)}Y.push({vs:new Yp(h),uv:new Yp(i),faceIs:new Yp(k)}),$>e&&$--}return{_lodPlanes:Y,_sizeLods:t,_sigmas:S}}(),A=Z._lodPlanes,o=Z._sizeLods,O=Z._sigmas,L=p.EnvmapTextureSize}();var ah=["left","front","right","back","top","bottom"],Rd=dd._RenderList=function(){function A(){l.length=0,v.length=0,n={}}function u(k){var F,q,L,v,Y=k.gv,J=k.data,G=k.shapeModel;if(G){var g,n,M,t=J.s("shape3d.transparent")||J.s("points.transparent");for(Vd(G)||(g=gs(G.transparent,J,Y),G=[G]),L=0,v=G.length;v>L;L++)M=G[L],n=gs(M.transparent,J,Y),n===s&&(n=g),n===s&&(n=t),n?q=!0:F=!0}for(L=0,v=ah.length;v>L;L++){var r=k[ah[L]];r&&(r.transparent?q=!0:F=!0)}Y.isLabelVisible(J)&&(k.labelInfo&&(J.s(pp+".transparent")?q=!0:F=!0),k.label2Info&&(J.s(rb+".transparent")?q=!0:F=!0)),Y.isNoteVisible(J)&&(k.noteInfo&&(J.s(zg+".transparent")?q=!0:F=!0),k.note2Info&&(J.s(Zb+".transparent")?q=!0:F=!0)),k._38o&&(q=F=!0),q||(F=!0),k._renderParams={opaque:F,transparent:q}}function k(O,m){m&&u(O);var h=O.data,q=h._id;if(!n[q]){n[q]=!0;var Y=O._renderParams;Y&&Y.visible!==!1&&(O={ui:O,data:h,z:0,id:q},Y.opaque&&l.push(O),Y.transparent&&v.push(O))}}function t(a,d){if(v.length>1){for(var U,H,N=[0,0,0,0],m=0,A=v.length;A>m;m++)U=v[m].data,(H=U._position)?(N[0]=H.x,N[1]=U._54O,N[2]=H.y,N[3]=1,ob(N,d),v[m].z=N[2]/N[3]):v[m].z=0;v.sort(a||O)}}function m(q){q?(Yj(I,j,q),Yj(f,S,q),Yj($,E,q)):(I=this.batchModelMap={},j=this.batchIndexMap={},f=this.polylineModelMap={},S=this.polylineIndexMap={},$=this.wireframeModelMap={},E=this.wireframeIndexMap={}),this.markBatchInvalid()}function M(c){c?Yj(I,j,c):(I=this.batchModelMap={},j=this.batchIndexMap={}),this.markBatchInvalid()}function p(g){g?Yj(f,S,g):(f=this.polylineModelMap={},S=this.polylineIndexMap={}),this.markBatchInvalid()}function Z(q){q?Yj($,E,q):($=this.wireframeModelMap={},E=this.wireframeIndexMap={}),this.markBatchInvalid()}function L(){return this._batchInvalid}function X(){this._batchInvalid=!0}function x(){this._batchInvalid=null}var l=[],v=[],I={},j={},f={},S={},$={},E={},n={};return{opaque:l,transparent:v,init:A,push:k,batchModelMap:I,batchIndexMap:j,polylineModelMap:f,polylineIndexMap:S,wireframeModelMap:$,wireframeIndexMap:E,ivBatch:m,ivModelBatch:M,ivPolylineBatch:p,ivWireframeBatch:Z,markBatchInvalid:X,isBatchInvalid:L,onUpdated:x,sort:t}},Gm=dd._RenderLists=function(){function J(){for(var X in r)r[X].init()}function P(){for(var w in r)r[w].onUpdated()}function C(i,Q){i=i||"main";var K=r[i];return!K&&Q&&(K=r[i]=new Rd),K}function l(p,A){var f=p.data.getRenderLayer(),z=C(f,!0);z.push(p,A)}function _(w){for(var d in r)w(r[d])}var r={};return{init:J,onUpdated:P,get:C,push:l,each:_,lists:r}},Zp=dd.RenderTarget=function(X,z,S,d){var u,b=this;null!=z&&z.canvas?(u=z,z=S,S=d,d=arguments[4]):u=X.getGL(),d=d||{},d.cube===!!d.cube,d.samples=d.cube?0:Math.min(X._glCapabilities.maxSamples,d.samples&&d.samples>1&&2===X._webGLVersion?d.samples:0),b.options=d,b.uuid=U.Math.generateUUID(),b.gv=X,b.init(X,u,d),b.format=d.format||gq.RGBA,b.generateMipmaps=!!d.generateMipmaps,d.samples&&!X._glCapabilities._maxSamplesChecked?b.setSize(u,z||1,S||1):b.setSize(u,z,S)};z.assign(dd.RenderTarget.prototype,{bind:function(A,G){var U=this.options;if(U.autoSize){var K=this.gv,D=K.getDevicePixelRatio(),a=K.getWidth()*D,L=K.getHeight()*D;this.setSize(A,a,L)}U.cube?Qg(A,this.frame[G]):Qg(A,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(w){hc(w),this.options.samples&&(w.bindFramebuffer(w.READ_FRAMEBUFFER,this._MSAAFbo),w.bindFramebuffer(w.DRAW_FRAMEBUFFER,this.frame),w.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,w.COLOR_BUFFER_BIT,w.NEAREST),w.bindFramebuffer(w.READ_FRAMEBUFFER,null),w.bindFramebuffer(w.DRAW_FRAMEBUFFER,null))},isCube:function(){return this.options.cube},init:function(m,t,O){var e=this,Y=O.samples,G=O.cube,S=e.texture=t.createTexture(),u=G?gq.TEXTURE_CUBE_MAP:gq.TEXTURE_2D;t.activeTexture(t.TEXTURE0),t.bindTexture(u,S),t.texParameteri(u,t.TEXTURE_WRAP_S,O.wrapS||t.CLAMP_TO_EDGE),t.texParameteri(u,t.TEXTURE_WRAP_T,O.wrapT||t.CLAMP_TO_EDGE);var s=Y?t.NEAREST:t.LINEAR;if(t.texParameteri(u,t.TEXTURE_MIN_FILTER,O.minFilter||s),t.texParameteri(u,t.TEXTURE_MAG_FILTER,O.magFilter||s),t.bindTexture(u,null),G){e.depth=[],e.frame=[];for(var x=0;6>x;x++)e.depth[x]=t.createRenderbuffer(),e.frame[x]=t.createFramebuffer()}else e.depth=t.createRenderbuffer(),e.frame=t.createFramebuffer();e.assureTexture()},assureTexture:function(){var I=this;I.gv._2Oi(I.uuid,I.texture,"default")},releaseTexture:function(){this.gv.deleteTexture(this.uuid)},setSize:function(T,i,Y){var c=this;if(i=Math.round(i),Y=Math.round(Y),i&&Y&&(c.width!==i||c.height!==Y)){c.width=i,c.height=Y;var A=T.RENDERBUFFER,Z=T.FRAMEBUFFER,k=c.options.samples,b=c.options.cube,U=b?gq.TEXTURE_CUBE_MAP:gq.TEXTURE_2D;if(k){var z=c.gv._glCapabilities;if(!z._maxSamplesChecked){for(T.bindRenderbuffer(A,c.depth),T.getError();k>1&&(T.renderbufferStorageMultisample(A,k,T.DEPTH_COMPONENT16,i,Y),T.getError());)k=Math.floor(k>>1);1>=k&&(k=0,T.texParameteri(U,T.TEXTURE_MIN_FILTER,c.options.minFilter||T.LINEAR),T.texParameteri(U,T.TEXTURE_MAG_FILTER,c.options.magFilter||T.LINEAR),T.renderbufferStorage(A,T.DEPTH_COMPONENT16,i,Y)),z._maxSamplesChecked=!0,z.maxSamples=c.options.samples=k,T.bindRenderbuffer(A,g)}}if(k&&(c._MSAAFbo||(c._MSAAFbo=T.createFramebuffer(),c._MSAARbO=T.createRenderbuffer()),T.bindRenderbuffer(A,c._MSAARbO),T.renderbufferStorageMultisample(T.RENDERBUFFER,k,T.RGBA8,i,Y),T.bindFramebuffer(Z,c._MSAAFbo),T.framebufferRenderbuffer(Z,T.COLOR_ATTACHMENT0,A,c._MSAARbO),T.framebufferRenderbuffer(Z,T.DEPTH_ATTACHMENT,A,c.depth),T.bindFramebuffer(Z,null),T.bindRenderbuffer(A,null)),T.activeTexture(T.TEXTURE0),T.bindTexture(U,c.texture),b)for(var w=T.TEXTURE_CUBE_MAP_POSITIVE_X,e=0;6>e;e++)c.setupFrameBufferTextureAndDepth(T,c.frame[e],c.depth[e],w+e);else c.setupFrameBufferTextureAndDepth(T,c.frame,c.depth,T.TEXTURE_2D);if(c.generateMipmaps&&(2===gv._webGLVersion||fo.isPOT(i)&&fo.isPOT(Y))){T.generateMipmap(U);var $=c.options.minFilter||(k?T.NEAREST:T.LINEAR);T.texParameteri(U,T.TEXTURE_MIN_FILTER,$===T.NEAREST?T.NEAREST_MIPMAP_NEAREST:T.LINEAR_MIPMAP_LINEAR)}T.bindTexture(U,null)}},setupFrameBufferTextureAndDepth:function(o,x,f,T){var h=this,K=h.format;o.texImage2D(T,0,K,this.width,this.height,0,K,o.UNSIGNED_BYTE,null),o.bindFramebuffer(o.FRAMEBUFFER,x),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,T,h.texture,0),this.setupRenderBufferStorage(o,f),o.bindFramebuffer(o.FRAMEBUFFER,null)},setupRenderBufferStorage:function(b,p){var R=this,j=b.RENDERBUFFER;b.bindRenderbuffer(j,p);var K=R.options.samples;K?b.renderbufferStorageMultisample(j,K,b.DEPTH_COMPONENT16,R.width,R.height):(b.renderbufferStorage(j,b.DEPTH_COMPONENT16,R.width,R.height),b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,j,p)),b.bindRenderbuffer(b.RENDERBUFFER,null)},toCanvas:function(){var Q=this,t=Q.gv.getGL();Qg(t,Q.frame);var G=Q.width,b=Q.height,l=new Uint8Array(4*G*b);t.readPixels(0,0,G,b,Q.format,t.UNSIGNED_BYTE,l),hc(t);var E=o.createElement("canvas");E.width=G,E.height=b;var n=E.getContext("2d"),m=n.createImageData(G,b);return m.data.set(l),n.putImageData(m,0,0),E}});var Ds=dd.Interactor=function(E){this.gv=this.g3d=E};Mg("Interactor",z,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()},fi:function(z){this.gv.fi(z)},startDragging:function(F){Nm(this,F)}});var Es=dd.DefaultInteractor=function(Z){$e(Es,this,[Z])};Mg("DefaultInteractor",Ds,{getState:function(){return this._62O},setState:function(n){this._62O=n},getDataInfoAt:function(Y,Z){var e=this.gv,M=e.getDataInfoAt(Y);if(!e.isBlockSelectable()||!M||!M.data)return M;if(!Z&&e.isSelected(M.data))return M;for(var j=M.data;(j=j.getParent())&&j instanceof U.Block&&e.isSelectable(j);){var x=e.isSelected(j);if(x&&Z)break;if(M={data:j,part:M.part},x&&!Z)break}return M},handle_contextmenu:function($){fk($)},handle_mousewheel:function(e){this.gv.handleScroll(e,e.wheelDelta/40)},handle_DOMMouseScroll:function(r){2===r.axis&&this.gv.handleScroll(r,-r.detail)},handle_keydown:function(q){this.gv.handleKeyDown(q)},handle_mousedown:function(D){this.handle_touchstart(D)},handle_touchstart:function(U){fk(U);var a=this,K=a.gv,F=ys(U),Z=a.getDataInfoAt(U),R=Z?Z.data:g,B=Z?Z.part:g,T=K.sm(),d=kk(U),p=ns(U);K.setFocus(U)&&(a._62O=g,a._57I=g,a.pendingClickThrough=g,a.__lastClientPoint__=vq(U),R?wc(U)?T.co(R)?T.rs(R):T.as(R):T.co(R)?R instanceof vc&&R.isClickThroughEnabled()&&ys(U)&&(a.pendingClickThrough=vq(U)):T.ss(R):F&&(wc(U)?K.isRectSelectable()&&(a._62O=ph):a._57I=vq(U)),a._31Q&&(es(a._31Q),delete a._31Q,delete a._32Q),a._62O||(K.isFirstPersonMode()&&(te(U)||Wl(U)||p>2?a._62O="pan":K.isMouseRoamable()||jc(U)?(a._62O="roaming",a.foward=d&&ys(U),a._32Q=rp(),a._31Q=oq(a.tick,a)):F||(a._62O="roaming")),a._62O||(F&&d&&Ys[B]?(a._62O=B,a.p3=R.p3()):F&&d&&Ob(R)&&K.isSelected(R)?K.isMovable(R)?(a._62O="move",a.p3=R.p3(),a.movedata=R):K._39Q(R)&&(a._62O="none"):jc(U)&&(p>2?a._62O="pan":2===p&&(a.dist=Kq(U),a._62O="pinch")))),a.point=K.lp(U),Nm(a,U),Sf(U)?K.handleDoubleClick(U,R,B):K.handleClick(U,R,B))},tick:function(){var u=this,V=u.gv,v=V._moveStep;u.point&&V.isWalkable()&&(u._32Q&&(v*=(rp()-u._32Q)/50),V.walk(u.foward?v:-v),u._32Q=rp(),u._31Q=oq(u.tick,u))},handle_mouseup:function(n){this.handle_touchend(n)},handle_touchend:function(P){var S=this._57I;if(S&&(lr(S,vq(P))<=1&&this.gv.sm().cs(),this._57I=g),S=this.pendingClickThrough){if(lr(S,vq(P))<=1){var D=this.getDataInfoAt(P);D&&D.data instanceof vc&&D.data.isClickThroughEnabled()&&(D=this.getDataInfoAt(P,!0),D&&(P.clickThrough=!0,this.gv.sm().ss(D.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(f){this.handleWindowTouchMove(f)},handleWindowTouchMove:function(O){var v,I,c=this,R=c.gv,z=c._62O,w=c.point,C=R.dm(),$=R.lp(O),K=$.x-w.x,q=$.y-w.y,t=R.getWidth(),Y=R.getHeight();if(t&&Y){var g=vq(O),N=Qf(R,g,c.__lastClientPoint__),W=lr({x:0,y:0},N),U=-L*K/t,f=-L*q/Y;if("roaming"===z)c.rotate(O,U/2,f/2);else if(z===Ss||z===Ts||z===Us)R._86O||C.beginTransaction(),R.fi({kind:R._86O?"betweenEditRotation":"beginEditRotation",event:O}),R._86O=1,R.sm().each(function(y){if(Ob(y)&&R.isRotationEditable(y)){var O=B(U)>B(f)?U:f;z===Ss?y.setRotationX(y.getRotationX()+O):z===Ts?y.setRotationY(y.getRotationY()+O):z===Us&&y.setRotationZ(y.getRotationZ()+O)}});else if("move"===z||Ys[z]){if(z===Vs||z===Ws||z===Xs)R._87O||C.beginTransaction(),R.fi({kind:R._87O?"betweenEditScale":"beginEditScale",event:O}),R._87O=1;else{if(!R._moving){if(W<p.touchMoveThreshold)return;C.beginTransaction()}R.fi({kind:R._moving?"betweenMove":"beginMove",event:O}),R._moving=1}var T,h=c.p3,a=R.getPositionInfo(h),r=rr(R);T=z===Ps?"x":z===Qs?"y":z===Rs?"z":z===Vs?"sx":z===Ws?"sy":z===Xs?"sz":R.getMoveMode(O,c.movedata),K=K/t*a.width,q=-1*q/Y*a.height;var Q,E,o=[r[0]*K,r[4]*K,r[8]*K],J=[r[1]*q,r[5]*q,r[9]*q],s=o[0]+J[0],S=o[1]+J[1],e=o[2]+J[2],P=[h[0]+s,h[1]+S,h[2]+e],u=Nh(R.getEye(),P,!0);if("xyz"===T?(Q=P,R.moveSelection(s,S,e)):"xz"===T?(Q=Sr(R,h,[0,1,0],P),Q&&R.moveSelection(Q[0]-h[0],0,Q[2]-h[2])):"xy"===T?(Q=Sr(R,h,[0,0,1],P),Q&&R.moveSelection(Q[0]-h[0],Q[1]-h[1],0)):"yz"===T?(Q=Sr(R,h,[1,0,0],P),Q&&R.moveSelection(0,Q[1]-h[1],Q[2]-h[2])):"x"===T||"sx"===T?(u[0]=0,Q=Sr(R,h,u,P),Q&&(E=Q[0]-h[0],"x"===T?R.moveSelection(E,0,0):R.sm().each(function(m){Ob(m)&&R.isSizeEditable(m)&&(v=m.getScaleX()+E/100,I=v/m.getScaleX(),m.setScaleX(v),te(O)&&(m.setScaleY(m.getScaleY()*I),m.setScaleTall(m.getScaleTall()*I)))}))):"y"===T||"sy"===T?(u[1]=0,Q=Sr(R,h,u,P),Q&&(E=Q[1]-h[1],"y"===T?R.moveSelection(0,E,0):R.sm().each(function(f){Ob(f)&&R.isSizeEditable(f)&&(v=f.getScaleTall()+E/100,I=v/f.getScaleTall(),f.setScaleTall(v),te(O)&&(f.setScaleY(f.getScaleY()*I),f.setScaleX(f.getScaleX()*I)))}))):("z"===T||"sz"===T)&&(u[2]=0,Q=Sr(R,h,u,P),Q&&(E=Q[2]-h[2],"z"===T?R.moveSelection(0,0,E):R.sm().each(function(m){Ob(m)&&R.isSizeEditable(m)&&(v=m.getScaleY()+E/100,I=v/m.getScaleY(),m.setScaleY(v),te(O)&&(m.setScaleX(m.getScaleX()*I),m.setScaleTall(m.getScaleTall()*I)))}))),!Q)return;c.p3=Q}else if(z===ph){var D=c.div;D||(D=c.div=lp(),ib(c.getView(),D),D.op=w,D.style.background=R.getRectSelectBackground()),R.fi({kind:R._rectSelecting?"betweenRectSelect":"beginRectSelect",event:O}),R._rectSelecting=1,D.rect=In(D.op,$),Iq(D,D.rect)}else if("pinch"===z&&2===ns(O)){R.fi({kind:R._pinching?"betweenPinch":"beginPinch",event:O}),R._pinching=1;var E=Kq(O);R._lastZoomLP||(R._lastZoomLP=bj(O)),R.handlePinch(E,c.dist),c.dist=E}else"pan"===z||te(O)||Wl(O)?c.pan(O,K,q):"none"===z||R.isFirstPersonMode()||c.rotate(O,U,f);c.point=$}},pan:function(R,t,I){var B=this.gv;if(B.isPannable()){var s=B.getWidth(),o=B.getHeight();if(!s||!o)return;var v=B.getCenterInfo(),D=t/s*v.width,K=-1*I/o*v.height;B.fi({kind:B._panning?"betweenPan":"beginPan",event:R}),B._panning=1,B.pan(-D,-K)}},rotate:function(X,c,g){var m=this.gv;m.isRotatable()&&(m.fi({kind:m._rotating?"betweenRotate":"beginRotate",event:X}),m._rotating=1,m.rotate(c,g))},handleWindowMouseUp:function(K){this.handleWindowTouchEnd(K)},handleWindowTouchEnd:function(w){var Z=this,I=Z.gv,v=I.dm(),F=Z.div;if(F){var P=I.getDatasInRect(F.rect);if(!P.isEmpty()){var V=I.sm(),b=V.toSelection(),L=te(w),K=w.altKey;P.each(function(W){V.co(W)?(!L||L&&K)&&b.remove(W):(!K||L&&K)&&b.add(W)}),V.ss(b)}cn(F)}I._moving&&(delete I._moving,I.fi({kind:"endMove",event:w}),I.onMoveEnded(),v.endTransaction()),I._panning&&(delete I._panning,I.fi({kind:"endPan",event:w}),I.onPanEnded()),I._rotating&&(delete I._rotating,I.fi({kind:"endRotate",event:w}),I.onRotateEnded()),I._86O&&(delete I._86O,I.fi({kind:"endEditRotation",event:w}),v.endTransaction()),I._87O&&(delete I._87O,I.fi({kind:"endEditScale",event:w}),v.endTransaction()),I._pinching&&(delete I._pinching,I.fi({kind:"endPinch",event:w}),I.onPinchEnded()),I._rectSelecting&&(delete I._rectSelecting,I.fi({kind:"endRectSelect",event:w}),I.onRectSelectEnded()),I._walking&&(delete I._walking,I.fi({kind:"endWalk",event:w}),I.onWalkEnded()),I._lastZoomLP=I._lastZoomHit=null,Z.dist=Z.point=Z._62O=Z.p3=Z.movedata=Z.div=Z._57I=Z.pendingClickThrough=Z._32Q=Z._31Q=Z.foward=g,Z.__lastClientPoint__=g}});var Fs=dd.MapInteractor=function(S){$e(Fs,this,[S]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this._minPhi=0,this._maxPhi=5*Math.PI/12};Mg("MapInteractor",Ds,{setUp:function(){Fs.superClass.setUp.call(this);var N=this.gv;this.__oldMinPhi__=N.getRotateMinPhi(),this.__oldMaxPhi__=N.getRotateMaxPhi(),N.setRotateMinPhi(this._minPhi),N.setRotateMaxPhi(this._maxPhi)},tearDown:function(){Fs.superClass.tearDown.call(this);var $=this.gv;$.setRotateMinPhi(this.__oldMinPhi__),$.setRotateMaxPhi(this.__oldMaxPhi__),delete this.__oldMinPhi__,delete this.__oldMaxPhi__},handle_contextmenu:function(o){fk(o)},handle_mousewheel:function(U){this.gv.handleScroll(U,U.wheelDelta/40)},handle_DOMMouseScroll:function(A){2===A.axis&&this.gv.handleScroll(A,-A.detail)},handle_keydown:function(O){this.gv.handleKeyDown(O)},handle_mousedown:function(l){this.handle_touchstart(l)},handle_touchstart:function(K){fk(K);var m=this,a=m.gv;if(a.setFocus(K)){var W=a.getDataInfoAt(K),j=W?W.data:g,I=W?W.part:g;m.__lastClientPoint__=vq(K);var O=m.editing={point:a.lp(K),data:j,part:I};jc(K)?O.touch=!0:(O.touch=!1,O.clickLeft=ys(K),O.pan=Wl(K)?!0:"left"===this.panButton===O.clickLeft),j&&a._39Q(j)&&(O.preventDefault=!0),Nm(m,K),Sf(K)?a.handleDoubleClick(K,j,I):a.handleClick(K,j,I)}},handle_mouseup:function(n){this.handle_touchend(n)},handle_touchend:function(){},handleWindowMouseMove:function(B){this.handleWindowTouchMove(B)},handleWindowTouchMove:function(l){var X=this,r=X.gv,h=X.editing;if(h){var q=r.lp(l),t=h.point,Z=q.x-t.x,P=q.y-t.y;if(!h.moved){if(Math.abs(Z)<X.threshold&&Math.abs(P)<X.threshold&&!(l.touches&&l.touches.length>1))return;h.moved=!0}if(!h.preventDefault){h.point=q;var A=h.part;if(Ys[A]){var s=h.data,E=r.dm(),e=r.getWidth(),D=r.getHeight(),H=-L*Z/e,M=-L*P/D;if(A===Ss||A===Ts||A===Us){r._86O||E.beginTransaction(),r.fi({kind:r._86O?"betweenEditRotation":"beginEditRotation",event:l}),r._86O=1;var W=B(H)>B(M)?H:M;r.sm().each(function(k){Ob(k)&&r.isRotationEditable(k)&&(A===Ss?k.setRotationX(k.getRotationX()+W):A===Ts?k.setRotationY(k.getRotationY()+W):A===Us&&k.setRotationZ(k.getRotationZ()+W))})}else{var j=s.p3(),x=r.getPositionInfo(j);Z=Z/e*x.width,P=-1*P/D*x.height;var G,K=rr(r),b=[K[0]*Z,K[4]*Z,K[8]*Z],z=[K[1]*P,K[5]*P,K[9]*P],R=b[0]+z[0],U=b[1]+z[1],F=b[2]+z[2],o=[j[0]+R,j[1]+U,j[2]+F],n=Nh(r.getEye(),o,!0);if(A===Vs||A===Ws||A===Xs){if(r._87O||E.beginTransaction(),r.fi({kind:r._87O?"betweenEditScale":"beginEditScale",event:l}),r._87O=1,G=Sr(r,j,n,o)){var Y,I=0,w=["X","Y","Tall"];A===Vs?Y="X":A===Ws?(Y="Tall",I=1):A===Xs&&(Y="Y",I=2),w.splice(w.indexOf(Y),1);var m=te(l),S=(G[I]-j[I])/100;r.sm().each(function(g){if(Ob(g)&&r.isSizeEditable(g)){var $=g["getScale"+Y](),X=$+S;if(g["setScale"+Y](X),m){var Q=X/$;w.forEach(function(W){g["setScale"+W](g["getScale"+W]()*Q)})}}})}}else if(A===Ps||A===Qs||A===Rs){if(!r._moving){var y=vq(l),T=Qf(r,y,X.__lastClientPoint__),O=lr({x:0,y:0},T);if(O<p.touchMoveThreshold)return;E.beginTransaction()}r.fi({kind:r._moving?"betweenMove":"beginMove",event:l}),r._moving=1;var I=0;if(A===Ps?I=0:A===Qs?I=1:A===Rs&&(I=2),n[I]=0,G=Sr(r,j,n,o)){var S=G[I]-j[I],C=[0,0,0];C[I]=S,r.moveSelection.apply(r,C)}}}}else if(h.touch){var f=l.touches.length;if(2!==f)X.pan(l,Z,P);else{if(1>=f)return;var Q=l.touches,N={x:Q[0].clientX,y:Q[0].clientY},k={x:Q[1].clientX,y:Q[1].clientY},J={x:k.x-N.x,y:k.y-N.y},d=h.lastCenter,u=Math.atan2(J.y,J.x),i=h.theta,V=0;i==g?i=h.theta=u:(V=u-i,h.thetaStarted||Math.abs(V)>X.touchRotateThreshold?(h.thetaStarted=!0,h.theta=u):V=0);var $=a*(N.y+k.y)/2/r.getHeight(),v=h.phi,_=0;v==g?v=h.phi=$:(_=$-v,h.phiStarted||Math.abs(_)>X.touchRotateThreshold?(h.phiStarted=!0,h.phi=$):_=0);var c,An=Math.sqrt(J.x*J.x+J.y*J.y),Xp=h.vlen;if(Xp){var Tn=N.x-d.x,Np=N.y-d.y,rk=k.x-d.x,ln=k.y-d.y,is=Math.sqrt(Tn*Tn+Np*Np),Uh=Math.sqrt(rk*rk+ln*ln),Pb=Xp/2,Bb=X._sign2(is-Pb),ih=X._sign2(Uh-Pb);0>Bb*ih||0===Bb&&0===ih?(c=1,h.vlen=An):(c||(c=An/Xp),h.scaleStarted||Math.abs(c-1)>X.touchScaleThreshold?(h.vlen=An,h.scaleStarted=!0):c=1)}else Xp=h.vlen=An,c=1;1!==c&&r.setZoom(c),(_||V)&&X.rotate(l,V,-_),h.lastCenter={x:(k.x+N.x)/2,y:(k.y+N.y)/2}}}else if(h.pan)X.pan(l,Z,P);else{var e=r.getWidth(),D=r.getHeight();if(!e||!D)return;var H=-L*Z/e,M=-L*P/D;X.rotate(l,H,M)}}}},_sign2:function(B){return Math.abs(B)<this._touchScaleCheckAccuracy?0:B>0?1:-1},handleWindowMouseUp:function(J){this.handleWindowTouchEnd(J)},getDataInfoAt:function(w,y){var a=this.gv,c=a.getDataInfoAt(w);if(!a.isBlockSelectable()||!c||!c.data)return c;if(!y&&a.isSelected(c.data))return c;for(var l=c.data,W=c.part;(l=l.getParent())&&l instanceof U.Block&&a.isSelectable(l);){var I=a.isSelected(l);if(I&&y)break;if(c={data:l,part:W},I&&!y)break}return c},handleWindowTouchEnd:function(A){var B=this,n=B.editing;if(B.editing=null,n){var f=B.gv;if(n.moved||!n.clickLeft&&!n.touch)f._panning=null,f._rotating=null,f.fi({kind:n.pan?"endPan":"endRotate",event:A});else{var d=B.getDataInfoAt(A),g=d&&d.data;g instanceof vc&&g.isClickThroughEnabled()&&(d=B.getDataInfoAt(A,!0),d&&(g=d.data)),g?f.sm().setSelection([g]):f.sm().clearSelection()}var X=f.dm();f._moving&&(delete f._moving,f.fi({kind:"endMove",event:A}),f.onMoveEnded(),X.endTransaction()),f._86O&&(delete f._86O,f.fi({kind:"endEditRotation",event:A}),X.endTransaction()),f._87O&&(delete f._87O,f.fi({kind:"endEditScale",event:A}),X.endTransaction())}},pan:function(F,z,W){var R=this,J=R.gv;if(J.isPannable()){var w=J.getWidth(),x=J.getHeight();if(w&&x){var H=J.getCenterInfo(),a=-z/w*H.width,A=1*W/x*H.height;J.fi({kind:J._panning?"betweenPan":"beginPan",event:F}),J._panning=1;var P=R.keepHorizon,Z=R.editing.touch;if((Z&&F.touches&&F.touches.length>1||!Z&&te(F))&&(P=!P),!P)return J.pan(a,A);if(a||A){var b=rr(J),S=[b[0]*a,b[4]*a,b[8]*a],v=[b[1],0,b[9]],e=Math.sqrt(v[0]*v[0]+v[2]*v[2]);e&&(v=[v[0]/e*A,0,v[2]/e*A]);var d=S[0]+v[0],o=S[1]+v[1],c=S[2]+v[2],$=J._center,s=J._eye;$[0]+=d,$[1]+=o,$[2]+=c,s[0]+=d,s[1]+=o,s[2]+=c,J.fp(_n,g,s),J.fp(ii,g,$)}}}},rotate:function(N,i,e){var J=this,_=J.gv;if(_.isRotatable()){var H=_._center,W=_._eye,k=Nh(W,H),d=xb(w(k[0]*k[0]+k[2]*k[2]),k[1]),T=Gi(_,d+e);e=T-d,_.fi({kind:_._rotating?"betweenRotate":"beginRotate",event:N}),_._rotating=1,_.rotate(i,e)}}}),z.defineProperties(Fs.prototype,{panButton:{get:function(){return this._panButton},set:function(o){this._panButton=o}},minPhi:{get:function(){return this._minPhi},set:function(R){this.gv.setRotateMinPhi(this._minPhi=R)}},maxPhi:{get:function(){return this._maxPhi},set:function(d){this.gv.setRotateMaxPhi(this._maxPhi=d)}},keepHorizon:{get:function(){return this._keepHorizon},set:function(I){this._keepHorizon=I}},threshold:{get:function(){return this._threshold},set:function(_){this._threshold=_}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(U){this._touchScaleThreshold=U}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(v){this._touchRotateThreshold=v}}});var Gs,Hs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",Is=32,Js=dd.GlobeInteractor=function(M,j){$e(Js,this,[M]);var r,F=j.radius||6378137,f=this,T=null;Gs||(Gs=lp(),Gs.style.border="",Gs.style.backgroundImage="url("+Hs+")");var n=new kg,l=new Bb,R=new Bb,B=new Bb,G=new gc,m="number"==typeof F?{x:F,y:F,z:F}:F,u={center:new Bb(0,0,0),radius:m},p=function(n){M._81O=null;var r=M.getHitPosition(n,M.getCenter(),l.copy(M.getEye()).sub(R.copy(M.getCenter())).toArray());return G.origin.copy(M.getEye()),G.direction.copy(r).sub(G.origin).normalize(),G.intersectEllipsoid(u)},Q=function(q,c){M._81O=null,G.origin.copy(M.getEye());for(var t,F,x=M.getCenter(),I=l.copy(M.getEye()).sub(R.copy(M.getCenter())).toArray(),J=1,i=16,z=0,C=1,X={x:0,y:0};i--;){if(X.x=c.x+(q.x-c.x)*J,X.y=c.y+(q.y-c.y)*J,t=M.getHitPosition(X,x,I),G.direction.copy(t).sub(G.origin).normalize(),F=G.intersectEllipsoid(u),F&&1===J)return{hit:F};F?z=J:C=J,J=(z+C)/2}return{hit:F,out:1>J}},$=function(Q,x){if(T){var G=Date.now();T.deltaTime=T.lastTime?G-T.lastTime:1e3,T.lastTime=G,T.lastAxis=Q,T.lastAngle=x}x&&(n.setFromAxisAngle(Q,x),M.setEye(l.copy(M.getEye()).applyQuaternion(n).toArray()),M.setCenter(l.copy(M.getCenter()).applyQuaternion(n).toArray()),M.setUp(l.copy(M.getUp()).applyQuaternion(n).toArray()))};f._showCrossIcon=function(L){ib(f.getView(),Gs),Iq(Gs,{x:L.clientX-Is/2,y:L.clientY-Is/2,width:Is,height:Is})},f._hideCrossIcon=function(){cn(Gs)},f._scrollImpl=function(b,q){T={point:M.lp(b),screen:vq(b),hit:p(b),type:"right"},T.hitNormalize=T.hit?T.hit.clone().normalize():new Bb;var j={clientX:T.screen.x,clientY:T.screen.y+10*q};f._handleMoveImpl(j),f._endMoveImpl(j)},f._startMoveImpl=function(L){r&&(r.stop(!0),r=null),T={point:M.lp(L),screen:vq(L),hit:p(L)},T.hitNormalize=T.hit?T.hit.clone().normalize():new Bb,jc(L)?1===L.touches.length?T.hit&&(T.type="left"):2===L.touches.length&&(T.type="touch2"):(ys(L)?T.hit&&(T.type="left"):cj(L)?T.type="right":Wl(L)&&T.hit&&(T.type="middle"),!T.hit||"right"!==T.type&&"middle"!==T.type||f._showCrossIcon(L)),T.type&&Nm(f,L)},f._handleMoveImpl=function($){if(T)switch(T.type){case"left":return f._handleLeft($);case"right":return f._handleRight($);case"middle":return f._handleMiddle($);case"touch2":return f._handleTouch2($)}},f._endMoveImpl=function(){if(T){if(this._hideCrossIcon(),"left"===T.type||"middle"===T.type){var B=1e3*(T.lastAngle/(T.deltaTime||30)),E=T.lastAxis,m=T.lastTime,q=function(){var V=Date.now(),S=(V-m)/1e3;return m=V,B*=Math.pow(Math.abs(f.decelerationRate),3*S),Math.abs(B)<.01?(B=0,r&&r.stop(),void 0):($(E,B*S),void 0)};r=Qc({action:function(){q(arguments)},duration:5e3})}T=null}},f._handleLeft=function(n){if(!T.finished){var g=vq(n),V=Q(g,T.lastScreen||T.screen);if(T.lastScreen=g,!V.hit)return T.finished=!0,f._endMoveImpl(n),void 0;var t=V.hit;t.normalize();var w=T.hitNormalize,S=Math.acos(t.dot(w)),U=t.cross(w).normalize();$(U,S),V.out&&(T.finished=!0,f._endMoveImpl(n))}},f._handleRight=function(V){var j=T.lastScreen||T.screen,P=j.y;j=T.lastScreen=vq(V);var d=j.y,o=d-P;if(o){var s=Math.min(.5,o*f.scaleSpeed);l.copy(M.getEye());var A=T.hit;A||(A=l.clone().divide(m).normalize().multiply(m)),R.copy(l).lerp(A,s),M.setEye(R.toArray()),l.copy(M.getUp()),R.normalize();var Q=l.clone().cross(R).normalize();if(B.copy(M.getCenter()),B.sub(Q.multiplyScalar(B.dot(Q))),M.setCenter(B.toArray()),T.hit){var n=p(T.screen),e=T.hitNormalize;if(n){n.normalize();var h=Math.acos(n.dot(e)),g=n.cross(e).normalize();h&&$(g,h)}}}};var t=function(M){return Math.abs(M)<.01?0:M>0?1:-1};f._handleTouch2=function(W){var j=W.touches.length;if(2===j){var Q=W.touches,U={x:Q[0].clientX,y:Q[0].clientY},b={x:Q[1].clientX,y:Q[1].clientY},s={x:b.x-U.x,y:b.y-U.y},d=T.lastCenter,e=Math.atan2(s.y,s.x),f=T.theta,o=0;f==g?f=T.theta=e:(o=e-f,T.thetaStarted||Math.abs(o)>.03?(T.thetaStarted=!0,T.theta=e):o=0);var z,P=Math.sqrt(s.x*s.x+s.y*s.y),u=T.vlen;if(u){var C=U.x-d.x,N=U.y-d.y,X=b.x-d.x,k=b.y-d.y,Y=Math.sqrt(C*C+N*N),L=Math.sqrt(X*X+k*k),Z=u/2,I=t(Y-Z),V=t(L-Z);0>I*V||0===I&&0===V?(z=1,T.vlen=P):(z||(z=P/u),T.scaleStarted||Math.abs(z-1)>.05?(T.vlen=P,T.scaleStarted=!0):z=1)}else u=T.vlen=P,z=1;var s=R.copy(M.getEye()).clone();1!==z&&M.setEye(s.setLength((s.length()-F)/z+F).toArray()),o&&$(s.normalize(),o),T.lastCenter={x:(b.x+U.x)/2,y:(b.y+U.y)/2}}},f._handleMiddle=function(k){var d=vq(k),h=T.screen;T.screen=d;var r=(d.y-h.y)/180*Math.PI*f.rollSpeed;R.copy(M.getCenter()).sub(l.copy(M.getEye())).normalize(),l.copy(M.getUp()).cross(R).normalize(),R.copy(M.getEye()).sub(T.hit).applyAxisAngle(l,r).add(T.hit);var q=R.clone();R.copy(M.getCenter()).sub(T.hit).applyAxisAngle(l,r).add(T.hit);var x=R.clone(),t=R.copy(M.getUp()).applyAxisAngle(l,r).clone(),S=!1;r>0&&(B.copy(t),R.copy(x).sub(q).normalize(),l.copy(q).multiplyScalar(-1).normalize(),l.dot(B)-R.dot(B)>0&&(S=!0)),S||B.copy(T.hit).sub(q).dot(T.hitNormalize)>=0&&(S=!0),S||(M.setEye(q.toArray()),M.setCenter(x.toArray()),M.setUp(t.toArray()));
var z=-(d.x-h.x)/180*Math.PI*f.rotateSpeed;$(T.hitNormalize,z)}};Mg("GlobeInteractor",Ds,{handle_contextmenu:function(U){fk(U)},handle_mousewheel:function(y){this._scrollImpl(y,y.wheelDelta/40)},handle_DOMMouseScroll:function(z){2===z.axis&&this._scrollImpl(z,-z.detail)},handle_keydown:function(E){this.gv.handleKeyDown(E)},handle_mousedown:function(C){this.handle_touchstart(C)},handle_touchstart:function(q){fk(q);var V=this.gv;if(V.setFocus(q)){var f=V.getDataInfoAt(q),X=f?f.data:g;X&&V.isInteractive(X)||this._startMoveImpl(q);var U=f?f.part:g;Sf(q)?V.handleDoubleClick(q,X,U):V.handleClick(q,X,U)}},handle_mouseup:function(t){this.handle_touchend(t)},handle_touchend:function(){},handleWindowMouseMove:function(s){this.handleWindowTouchMove(s)},handleWindowTouchMove:function(U){this._handleMoveImpl(U)},handleWindowMouseUp:function(W){this.handleWindowTouchEnd(W)},handleWindowTouchEnd:function(R){this._endMoveImpl(R)}}),z.defineProperties(Js.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(U){this._rotateSpeed=U}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(u){this._rollSpeed=u}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(C){this._scaleSpeed=C}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(g){this._decelerationRate=g}}});var Ks=function(m){var b=2147483648|m;return[(255&b>>16)/255,(255&b>>8)/255,(255&b)/255,(255&b>>24)/255]},Ls=function(U){this.gv=U,this.gv.pickColorMap={_pickIdUsed:2e3}};zs(Ls,z,{_iv:!0,iv:function(){this._iv=!0},get:function(E,S,F){this.validate();var i=this,x=i.gv.getGL();if(!x)return g;var H,j,J=i._resolution,r=Math.round(E.x*J),h=Math.ceil(E.width*J),p=Math.ceil(E.height*J),M=i.height-Math.round(E.y*J)-p,z=l(h/2),Z=new Uint8Array(4*h*p),C=0,Q=Z.length,U=S?g:new Yn,u=S?g:{};if(Qg(x,i.frame),x.readPixels(r,M,h,p,x.RGBA,x.UNSIGNED_BYTE,Z),hc(x),S){for(;z>=C;C++)for(var W=z-C,m=z+C,c=W;m>=c;c++)for(var T=W;m>=T;T++)if((c===W||c===m||T===W||T===m)&&(H=i.info(Z,4*(c*h+T)))){if(F&&F(H)===!1)continue;return H}}else for(;Q>C;C+=4)if(H=i.info(Z,C)){if(F&&F(H)===!1)continue;j=H.data,u[j._id]||(U.add(j),u[j._id]=j)}return U},info:function(M,j){return this.gv.pickColorMap[(M[j]<<16)+(M[j+1]<<8)+M[j+2]+((127&M[j+3])<<24)]},getResolution:function(){return this._resolution},onContextLost:function(){this.texture=null,this.width=this.height=-1},validate:function(){var u=this,i=u.gv,l=i.getGL();if(l){var k=u._resolution=i._pickerResolution*i.getDevicePixelRatio(),I=Math.round(k*i.getWidth()),G=Math.round(k*i.getHeight()),s=l.RGBA,$=l.TEXTURE_2D,O=l.RENDERBUFFER,q=l.FRAMEBUFFER;if(u.texture||(u.texture=Re(l),u.render=l.createRenderbuffer(),u.frame=l.createFramebuffer()),(u.width!==I||u.height!==G)&&(l.activeTexture(l.TEXTURE0),nm(l,u.texture),l.texImage2D($,0,s,I,G,0,s,l.UNSIGNED_BYTE,g),Fo(l,l.TEXTURE_MIN_FILTER,l.LINEAR),l.bindRenderbuffer(O,u.render),l.renderbufferStorage(O,l.DEPTH_COMPONENT16,I,G),Qg(l,u.frame),l.framebufferTexture2D(q,l.COLOR_ATTACHMENT0,$,u.texture,0),l.framebufferRenderbuffer(q,l.DEPTH_ATTACHMENT,O,u.render),nm(l,g),l.bindRenderbuffer(O,g),hc(l),u.width=I,u.height=G),u._iv){u._iv=!1;var P=!1;i._40Q.each(function(c){!P&&c.isBatchInvalid()&&(P=!0)}),P&&i.updateScene(),Qg(l,u.frame),l.clear(l.COLOR_BUFFER_BIT),i.overlappingBox.clear(),i.setViewport(l,0,0,I,G),i.renderPickScene(),hc(l)}}}});var Ms=function(m){this.gv=m};zs(Ms,z,{gap:0,size:0,_42:function(B,G){var _=this,L=_.gv,J=L._gridGap,q=L._gridSize;if(L._gridVisible){if(_.gap!==J||_.size!==q){for(var l=[],x=L._gridSize/2,n=J*x,E=0;2*x+1>E;E++){var Q=6*E,P=6*(2*x+1)+Q;l[Q]=-n,l[Q+1]=0,l[Q+2]=-n+E*J,l[Q+3]=n,l[Q+4]=0,l[Q+5]=-n+E*J,l[P]=-n+E*J,l[P+1]=0,l[P+2]=-n,l[P+3]=-n+E*J,l[P+4]=0,l[P+5]=n}_.vs=new Yp(l),_.gap=J,_.size=q}hn(L),ke(B,G),eh(B),hr(B,G,1,L._gridColor,L._buffer.vs,_.vs),Co(B,0,_.vs.length/3,B.LINES),uk(B),Yf(B,G)}else _.vs=_.gap=_.size=g}});var Ns=function(z){this.gv=z};zs(Ns,z,{_42:function(b,s){var z=this.gv,H=z._buffer.vs,J=z._axisXColor,V=z._axisYColor,K=z._axisZColor,o=z._originAxisVisible,x=z._centerAxisVisible;if(o||x){var C=uc?b.TRIANGLES:b.TRIANGLE_FAN,Y=b.LINES;if(hn(z),ke(b,s),eh(b),o){var U=z.getCenterInfo(),D=Q(U.width,U.height)/5,n=.8*D,O=.05*D;hr(b,s,1.5,J,H,new Yp([0,0,0,D,0,0,n,O,0,n,0,O,n,-O,0,n,0,-O,n,O,0,0,0,0,0,D,0,O,n,0,0,n,O,-O,n,0,0,n,-O,O,n,0,0,0,0,0,0,D,O,0,n,0,O,n,-O,0,n,0,-O,n,O,0,n])),Co(b,0,2,Y),Co(b,1,6,C),hr(b,s,g,V),Co(b,7,2,Y),Co(b,8,6,C),hr(b,s,g,K),Co(b,14,2,Y),Co(b,15,6,C)}if(x){var E=z._center,W=E[0],I=E[1],P=E[2],U=z.getPositionInfo(E);D=Q(U.width,U.height)/20,hr(b,s,1.5,J,H,new Yp([W,I,P,W+D,I,P,W,I,P,W,I+D,P,W,I,P,W,I,P+D])),Co(b,0,2,Y),hr(b,s,g,V),Co(b,2,2,Y),hr(b,s,g,K),Co(b,4,2,Y)}uk(b),Yf(b,s)}}});var Os=function(Y){this.gv=Y},Ps="edit_tx",Qs="edit_ty",Rs="edit_tz",Ss="edit_rx",Ts="edit_ry",Us="edit_rz",Vs="edit_sx",Ws="edit_sy",Xs="edit_sz",Ys={};Ys[Ps]=101,Ys[Qs]=102,Ys[Rs]=103,Ys[Ss]=104,Ys[Ts]=105,Ys[Us]=106,Ys[Vs]=107,Ys[Ws]=108,Ys[Xs]=109,zs(Os,z,{_42:function(f,G,R){var a=this,l=a.gv,g=l.sm().ld();if(g&&l.isEditable(g)&&!l.isEditHelperDisabled()&&Ob(g)&&(!l.isFirstPersonMode()||!l.isMouseRoamable()&&!Pb)){hn(l);var r,o=l.isMovable(g),W=l.isRotationEditable(g),j=l.isSizeEditable(g),A=l._axisXColor,F=l._axisYColor,u=l._axisZColor,q=l._editSizeColor,U=g.p3();if(l.isOrtho()){var v=l.getCenterInfo();r=Q(v.width,v.height)/8}else r=lr(l.getEye(),U)/10;var V,S,d=r/(R?5:10),C=.7*r,Z=.4*C,M=U[0],$=U[1],Y=U[2];V=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],o&&a._17O(f,G,g,R,Ps,A,V,[M,$-d,Y,M+C,$-d,Y,M+C,$,Y,M+C,$,Y,M,$,Y,M,$-d,Y,M,$-d,Y+d,M+C,$-d,Y+d,M+C,$-d,Y,M+C,$-d,Y,M,$-d,Y,M,$-d,Y+d]),S=M+C,j&&a._17O(f,G,g,R,Vs,q,V,[S,$-d,Y,S+Z,$-d,Y,S+Z,$,Y,S+Z,$,Y,S,$,Y,S,$-d,Y,S,$-d,Y+d,S+Z,$-d,Y+d,S+Z,$-d,Y,S+Z,$-d,Y,S,$-d,Y,S,$-d,Y+d]),S+=Z,W&&a._17O(f,G,g,R,Ss,A,V,[S,$-d,Y,S+Z,$-d,Y,S+Z,$,Y,S+Z,$,Y,S,$,Y,S,$-d,Y,S,$-d,Y+d,S+Z,$-d,Y+d,S+Z,$-d,Y,S+Z,$-d,Y,S,$-d,Y,S,$-d,Y+d]),V=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],o&&a._17O(f,G,g,R,Qs,F,V,[M,$,Y,M,$+C,Y,M-d,$+C,Y,M-d,$+C,Y,M-d,$,Y,M,$,Y,M,$,Y,M,$,Y-d,M,$+C,Y-d,M,$+C,Y-d,M,$+C,Y,M,$,Y]),S=$+C,j&&a._17O(f,G,g,R,Ws,q,V,[M,S,Y,M,S+Z,Y,M-d,S+Z,Y,M-d,S+Z,Y,M-d,S,Y,M,S,Y,M,S,Y,M,S,Y-d,M,S+Z,Y-d,M,S+Z,Y-d,M,S+Z,Y,M,S,Y]),S+=Z,W&&a._17O(f,G,g,R,Ts,F,V,[M,S,Y,M,S+Z,Y,M-d,S+Z,Y,M-d,S+Z,Y,M-d,S,Y,M,S,Y,M,S,Y,M,S,Y-d,M,S+Z,Y-d,M,S+Z,Y-d,M,S+Z,Y,M,S,Y]),V=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],o&&a._17O(f,G,g,R,Rs,u,V,[M,$,Y,M,$,Y+C,M,$-d,Y+C,M,$-d,Y+C,M,$-d,Y,M,$,Y,M,$-d,Y,M-d,$-d,Y,M-d,$-d,Y+C,M-d,$-d,Y+C,M,$-d,Y+C,M,$-d,Y]),S=Y+C,j&&a._17O(f,G,g,R,Xs,q,V,[M,$,S,M,$,S+Z,M,$-d,S+Z,M,$-d,S+Z,M,$-d,S,M,$,S,M,$-d,S,M-d,$-d,S,M-d,$-d,S+Z,M-d,$-d,S+Z,M,$-d,S+Z,M,$-d,S]),S+=Z,W&&a._17O(f,G,g,R,Us,u,V,[M,$,S,M,$,S+Z,M,$-d,S+Z,M,$-d,S+Z,M,$-d,S,M,$,S,M,$-d,S,M-d,$-d,S,M-d,$-d,S+Z,M-d,$-d,S+Z,M,$-d,S+Z,M,$-d,S])}},_17O:function(F,h,U,T,y,j,b,$){var v=this.gv,r=v._buffer,q=ts.for(F),B=q.directUniforms(),N=q.directAttribs();if(v._picking){T=v.pickColorMap;var l=Ys[y];T[l]={data:U,part:y},B.uFixPickReverseColor=Ks(l)}oe(F,h,g,!0,g,!0,g,!1),B.uDiffuse=j,N.aPosition=Yr(F,r.vs,new Yp($),g),N.aNormal=Yr(F,r.ns,new Yp(b),g),eh(F),Co(F,0,12),uk(F),eq(F,h)}});var Zs=U.Raycaster=function(G){this.gv=G,this.maxTriangleTest=1/0,this.backfaceCulling=!0};jn("Raycaster",z,{intersect:function(R){var p=this,b=p.gv,U=b.getDataAt(R);return U?p.intersectObject(R,U):null},intersectObjects:function(C,m,A){var I,N,x,R,u=this,t=1/0,s=C.origin||(new Bb).fromArray(u.gv.getEye()),f=u.maxTriangleTest,j=[];m.forEach(function(U){A&&A(U)===!1||U.s("intersect")!==!1&&j.push(U)});var Q=s.distanceToSquared2([0,0,0]);return j.sort(function(J,$){return(J.p3?s.distanceToSquared2(J.p3()):Q)-($.p3?s.distanceToSquared2($.p3()):Q)}),u.countTriangles=0,j.forEach(function(a){u.countTriangles>f||(I=u.intersectObject(C,a),I&&(N=s.distanceToSquared(I.world),t>N&&(x=a,R=I,t=N)))}),u.countTriangles=0,{data:x,intersect:R}},intersectObjectAndRecordTriangle:function($,f){this._4GQ=!0;var r=this.intersectObject($,f);return this._4GQ=!1,r},intersectLastTriangle:function(m,L){var n=this.getRay(m);n.applyMatrix4(L.inverseMatrix);var P=n.intersectPlane(L.plane);if(!P)return null;var l=jk.uvIntersection(P,L.p1,L.p2,L.p3,L.uv1.clone(),L.uv2.clone(),L.uv3.clone());return{world:P.clone().applyMatrix4(L.matrixWorld),local:P.clone(),uv:l}},getRay:function(f){if(f instanceof gc)return f;var I=this,G=I.gv,y=G.unproject(f),K=new Bb,L=G.getEye(),F=new Bb;if(G.isOrtho()){var J=new Bb(L);F.copy(G.getCenter()).sub(J).normalize();var p=K.copy(y).sub(J).dot(F);K.copy(F).setLength(-p).add(J.copy(y))}else K.copy(L),F.copy(y).sub(K).normalize();return new U.Math.Ray(K,F)},intersectObject:function(u,x){return this._intersectObjectImpl(this.getRay(u),x)},_intersectObjectImpl:function(){function u(){var F=new Bb;return F.subVectors(e,r),o.subVectors(y,r),F.cross(o).normalize(),F}var B=new cr,F=new cr,O=new gc,A=new Bb,x=new Bb,m=new Bb,q=new Bb,M=new Bb,y=new Bb,r=new Bb,e=new Bb,L=new vr,P=new vr,j=new vr,o=new Bb,g={vs:jq,is:Pq,uv:Og},J=Hk.slice(0);return J.push("csg"),function(v,s){var D=this.gv.getData3dUI(s),i=s.mat||D.mat;i?B.fromArray(i):B.identity(),F.getInverse(B),O.copy(v).applyMatrix4(F);var l,E,W,C="body",K=D.shapeModel;if(!K&&(s instanceof U.Polyline||s instanceof U.Edge)&&D.lineShapeModel&&(K=D.lineShapeModel),K||(K=ub(D)),K||(U.CSGNode&&s instanceof U.CSGNode||U.CSGShape&&s instanceof U.CSGShape?(W=!0,K=[D.left,D.front,D.right,D.back,D.top,D.bottom,D.csg]):s instanceof U.Node&&!(s instanceof U.Shape)?(l=!0,K=g):(E=!0,K=[D.left,D.front,D.right,D.back,D.top,D.bottom])),!K)return console.log("Can not find shape model."),null;Vd(K)||(K=[K]);var Y,R,t,n,d,Q,$,k,f,S,b,h,H,I,z,c,V=1/0,Z=["","top_","bottom_"],G=!1,a=this.backfaceCulling,X=[];for(gi(K,D,X),Y=0,R=X.length;R>Y;Y++)if(H=X[Y])for(t=0,n=Z.length;n>t;t++)if(I=Z[t],$=H[I+"vs"],k=H[I+"is"],f=H[I+"uv"]||H[I+"tuv"],$){if(z=H[I+"boundingBox"]){var b=O.intersectBox(z);if(!b)continue;if(O.origin.distanceTo(b)>V)continue;c=!1}else H[I+"boundingBox"]=z=new U.Math.Box3,c=!0;for(d=0,Q=k?k.length:$.length/3;Q>d;d+=3)this.countTriangles++,k?(x.fromArray($,3*k[d]),m.fromArray($,3*k[d+1]),q.fromArray($,3*k[d+2])):(x.fromArray($,3*d),m.fromArray($,3*(d+1)),q.fromArray($,3*(d+2))),c&&(z.expandByPoint(x),z.expandByPoint(m),z.expandByPoint(q)),S=O.intersectTriangle(x,m,q,a,A),S&&(h=O.origin.distanceTo(S),V>h&&(V=h,M.copy(S),y.copy(x),r.copy(m),e.copy(q),""!==I?C=I.slice(0,-1):l?C=Hk[Math.floor(d/6)]:E?C=Hk[Y]:W&&(C=J[Y]),f&&(G=!0,k?(L.fromArray(f,2*k[d]),P.fromArray(f,2*k[d+1]),j.fromArray(f,2*k[d+2])):(L.fromArray(f,2*d),P.fromArray(f,2*(d+1)),j.fromArray(f,2*(d+2))))))}if(!isFinite(V))return null;var T,N,_=M.clone().applyMatrix4(B),w=this._4GQ;G&&(w&&(N={inverseMatrix:F.clone(),matrixWorld:B.clone(),p1:y.clone(),p2:r.clone(),p3:e.clone(),uv1:L.clone(),uv2:P.clone(),uv3:j.clone(),plane:(new U.Math.Plane).setFromCoplanarPoints(y,r,e)}),T=jk.uvIntersection(M,y,r,e,L,P,j));var p=u(y,r,e),o=u(y.applyMatrix4(B),r.applyMatrix4(B),e.applyMatrix4(B)),ne=O.direction.dot(p);ne>0&&(p.multiplyScalar(-1),o.multiplyScalar(-1));var td={world:_,local:M.clone(),worldNormal:o,normal:p,uv:T,part:C};return N&&(td.triangleInfo=N),td}}()});var $s=function(G,F){this.gv=G,this.s=function(Z,n,s){return n==g&&(n=s),n==g?F.getStyle(Z):gs(n,F,G)},this.data=F};zs($s,z,{I3d:!0,ms_icons:1,_iv:!0,_cacheBoundingBox:s,iv:function(){this._iv=!0},update:function(O,U,P){var H=this,q=H.data;if(O||(O=H.gv,U=O.getGL(),P=O._40Q),!H.needValidate(U)||!O.isVisible(q))return P.push(this,!1),void 0;var $,Q,G,S,V,B=q._id,z=q._47Q?null:H.s("batch"),x=q.getRenderLayer(),R=P.get(x,!0),m=R.batchIndexMap,A=R.batchModelMap,Z=O.getBrightness(q),b=Z!=g&&1!==Z;$=xd(m,A,q,z,O);var h=H.validate($,z?O.getBatchInfo(z)||pr:g);if($&&(Q=m[B],G=Q.size=$.vs.length/3-Q.begin,V=$.rs))for(Z=b?Z:1,S=0;G>S;S++)V.push(Z);var L=O.getWireframeGeometry(q);if(L)$h(O,q,L);else if(Ob(q)){var i=O.getWireframe(q);i&&$h(O,q,i)}H.labelInfo=H.label2Info=H.noteInfo=H.note2Info=H._38o=g,H._24O(pp,"getLabel"),H._24O(rb,"getLabel2"),H._26O(zg,"getNote"),H._26O(Zb,"getNote2"),H._15O(),H.interactiveInfo=O.isInteractive(q)?{}:g,R.push(this,!0),h!==!1&&(H._iv=!1)},clearWireframeGeometryCache:function(){var f=this;Pc(f),f.data.iv()},_46Q:function(w){var v=this,g=v.data,H=v.gv;if(H.isVisible(g)){var P=g._id,q=H._40Q.get(g._renderLayer,!0),X=q.batchIndexMap[P],k=q.polylineIndexMap[P],e=q.wireframeIndexMap[P];if(X||k||e){var $=Qo(w,H.pickColorMap,H.isSelectable(g),v,Hp,!0);$&&(ap($,X,q.batchModelMap),ap($,k,q.polylineModelMap),ap($,e,q.wireframeModelMap))}}},_42:function(_,w,y){function R(U,l,X){var x=l.getBrightness(X),i=X.s("alphaTest"),d=X.s("envmap"),W=ts.for(U),Z=W.directUniforms();x!=g&&1!==x&&(Z.uBrightness=x),Z.uAlphaTest=i,Z.uUseEnvMap=d?!0:!1,Z.uReflectivity=d||.01,Z.roughness=X.s("roughness"),l._setEnvmapByProbeId(Z,X.s("envmap.probe")),Z.shadowReceive=!D&&X.s("shadow.receive"),Z.shadowCull=!D&&!!X.s("shadow.cull"),mi(l,Z,X.s("3d.clipbox")?pk:X.s("3d.clipbox.mask"));var y=G.s("3d.clip.direction");if(y){var T=G.s("3d.clip.percentage");0===T&&(P=!1);var C=G._formatClipUniforms(y,T,X);Z.uClipPercent=C[1],Z.uClipDirection=C[0]}else Z.uClipDirection=0;U._blooming&&!X.s("bloom")&&(Z.blackout=!0),D||(l._flowObjects.length&&l.flowMap.resetDataFlowEnabld(X,Z),Hd(l,Z,X.s("light.mask"),X.s("headlight.ambientIntensity")))}var G=this,o=G.data,K=G.gv;if(K.isVisible(o)){var l,D=K._picking;if(D)l=K.pickColorMap;else{if(K.isTransparentMask(o)||K.isReflecting(_)&&o.s("3d.reflectable")===!1)return;l=s}if($s.getTitle===s){$s.getTitle=0;for(var k in p)if(k.length===rb.length+1&&k[rb.length]===Jf[4].toUpperCase()&&k[rb.length-1]===Jf[rb.length+1].toUpperCase()){$s.getTitle=$g;break}}if(!$s.getTitle||Xc[rb.length+2]){if($s.getHead===s){$s.getHead=0;for(var k in $){var z="box-sizing";6===k.length&&k[0]===Jf[4]&&k[3]===z[0]&&k[4]===z[1]&&k[5]===z[2]&&($s.getHead=er)}}if(!$s.getHead||Xc[rb.length]){if($s.getTitle2===s){$s.getTitle2=0;for(var k in $){var E="uv";6===k.length&&k[0]===em[1].toUpperCase()&&k[1]===E[0]&&($s.getTitle2=Fl)}}if(!$s.getTitle2||Xc[Mq.length]){var M,Y,V=o._id,A=K._40Q.get(o._renderLayer,!0),u=A.batchIndexMap,e=A.batchModelMap,Q=K.isSelectable(o),X=!1,P=!0,Z=u[V];if(D&&(Y=Qo(_,l,Q,G,Hp,Z),Y&&!K._45Q&&(ap(Y,Z,e),ap(Y,A.polylineIndexMap[V],A.polylineModelMap),ap(Y,A.wireframeIndexMap[V],A.wireframeModelMap))),Z||(X||(X=!0,R(_,K,o)),P&&G._80o(_,w,y)),K.isLabelVisible(o)&&((M=G.labelInfo)&&(D&&Qo(_,l,Q,G,pp),X||(X=!0,R(_,K,o)),G._28O(M,pp,y)),(M=G.label2Info)&&(D&&Qo(_,l,Q,G,rb),X||(X=!0,R(_,K,o)),G._28O(M,rb,y))),K.isNoteVisible(o)&&((M=G.noteInfo)&&(D&&Qo(_,l,Q,G,zg),X||(X=!0,R(_,K,o)),G._29O(M,zg,y)),(M=G.note2Info)&&(D&&Qo(_,l,Q,G,Zb),X||(X=!0,R(_,K,o)),G._29O(M,Zb,y))),(M=G._38o)&&(X||(X=!0,R(_,K,o)),G._99O(_,w,M,l,Q,y)),X){var H=ts.for(_).directUniforms();H.uBrightness=1,H.uClipDirection=0,_._blooming&&(H.blackout=!1)}}}}}},_formatClipUniforms:function(s,B,K){switch(s){case"left":s=2;break;case"top":s=3;break;case"bottom":s=4;break;case"front":s=5;break;case"back":s=6;break;case"right":default:s=1}if(0===s%2&&(B=1-B),K instanceof U.Shape){var q=K.s3(),Q=K.p3(),j=K.getAnchor3d();B=3>s?(B-j.x)*q[0]+Q[0]:5>s?(B-j.y)*q[1]+Q[1]:(B-j.z)*q[2]+Q[2]}else B-=.5;return[s,B]},prepare:function(){var S=this,s=S.data;if(!(s instanceof vc)){var B,v,b,w,y,D=S.gv,l=D.getGL(),Y=s._id,L=S.s("batch"),t=D._batchIndexMap,E=D._batchModelMap,u=D.getBrightness(s),z=u!=g&&1!==u;if(S.needValidate(l)){if(B=xd(t,E,s,L,D),S.validate(B,L?D.getBatchInfo(L)||pr:g),B&&(v=t[Y],b=v.size=B.vs.length/3-v.begin,y=B.rs))for(u=z?u:1,w=0;b>w;w++)y.push(u);if(Ob(s)){var P=D.getWireframeGeometry(s);if(P)$h(D,s,P);else{var K=D.getWireframe(s);K&&$h(D,s,K)}}S.labelInfo=S.label2Info=S.noteInfo=S.note2Info=S._38o=g,S._24O(pp,"getLabel"),S._24O(rb,"getLabel2"),S._26O(zg,"getNote"),S._26O(Zb,"getNote2"),S._15O(),S.interactiveInfo=D.isInteractive(s)?{}:g,S._iv=!1}}},dispatchBoundingBoxChanged:function(){this._cacheBoundingBox=s},getBoundingBox:function(){var Z,F,h,p,c,S;return function(){if(this._cacheBoundingBox)return this._cacheBoundingBox;Z||(Z={vs:jq,is:Pq,uv:Og},F=new Bb,h=new Bb,p=new Bb,c=new Bb,S=new Bb);var o=this,K=o.data,E=o.shapeModel;if(E||K instanceof U.Shape||(E=ub(o)),!E&&K instanceof U.Shape&&(o.prepare(),E=o.shapeModel),E||(K instanceof U.Node&&!(K instanceof U.Shape)?E=Z:(o.left||o.front||o.right||o.back||o.top||o.bottom)&&(E=[o.left,o.front,o.right,o.back,o.top,o.bottom])),!E)return s;Vd(E)||(E=[E]);var C,e,j,M,I,B,i,m,f,O,D,W,P=["","top_","bottom_"],v=new U.Math.Box3,l=!1;if(o._needRecoverPosition){c.set.apply(c,K.p3());var w=K.s3();S.set(1/(w[0]||1),1/(w[1]||1),1/(w[2]||1))}else c.set(0,0,0),S.set(1,1,1);for(C=0,e=E.length;e>C;C++)if(f=E[C])for(j=0,M=P.length;M>j;j++)if(O=P[j],i=f[O+"vs"],m=f[O+"is"],i){if(W=O+"boundingBox",D=f[W],!D)for(f[W]=D=new U.Math.Box3,I=0,B=m?m.length:i.length/3;B>I;I+=3)m?(F.fromArray(i,3*m[I]).sub(c).multiply(S),h.fromArray(i,3*m[I+1]).sub(c).multiply(S),p.fromArray(i,3*m[I+2]).sub(c).multiply(S)):(F.fromArray(i,3*I).sub(c).multiply(S),h.fromArray(i,3*(I+1)).sub(c).multiply(S),p.fromArray(i,3*(I+2)).sub(c).multiply(S)),!F.isNaN()&&D.expandByPoint(F),!h.isNaN()&&D.expandByPoint(h),!p.isNaN()&&D.expandByPoint(p);v.expandByBox(D),l=!0}return l?(this._cacheBoundingBox=v,z.freeze(v),z.freeze(v.min),z.freeze(v.max),Rr(o.gv,K),v):s}}(),needValidate:function(){return this._iv},validate:function(){},_16O:function(){return Rp},_80o:function(){},dispose:function(){var m=this,n=m._pickId;if(n){var U=m.gv.pickColorMap;U[n]&&delete U[n]}},getBodyColor:function(v){var O=this.data,u=this.gv.getBodyColor(O);return u?u:v?O.getStyle(v):g},getCachedTexture:function(U){var W=this._cachedTextures;return W?W[U||"main"]:null},setCachedTexture:function(Z,R){var h=this._cachedTextures;return h||(h=this._cachedTextures={}),h[R||"main"]=Z,Z},invalidateCachedTexture:function(Y){var X=this._cachedTextures;if(X){for(var J in X)Y.deleteTexture(X[J]);this._cachedTextures={}}},invalidateCachedGeometry:function(){},_24O:function(J,M){var E=this,C=E.data,O=E.gv,c=E.s,o=O[M](C);if(o!=g){var F=c(J+".scale"),G=c(J+".max"),r=E[J+"Info"]={label:o,textureScale:c(J+".texture.scale"),color:O[M+"Color"](C),font:c(J+".font"),align:c(J+".align"),background:O[M+"Background"](C)},x=r.rect=uf(r,o);G>0&&G<x.width&&(r.labelWidth=x.width,x.width=G),x.x=x.y=0,x.width*=F,x.height*=F,r.mat=E._16O(c(J+".autorotate"),c(J+".position"),x,c(J+".face"),c(J+".t3"),c(J+".r3"),c(J+".rotationMode"));var b=x.width/2,h=x.height/2;r.vs=new Yp([-b,h,0,-b,-h,0,b,-h,0,b,h,0]),x.width/=F,x.height/=F}},_26O:function(z,O){var M=this,X=M.data,s=M.gv,V=M.s,c=s[O](X);if(c!=g){var n=V(z+".scale"),N=this[z+"Info"]={note:c,textureScale:V(z+".texture.scale"),expanded:V(z+".expanded"),font:V(z+".font"),color:V(z+".color"),align:V(z+".align"),borderWidth:V(z+".border.width"),borderColor:V(z+".border.color"),background:s[O+"Background"](X)};if(N.expanded){var $=V(z+".max"),D=uf(N,c);D.width+=6,D.height+=2,$>0&&$<D.width&&(N.labelWidth=D.width,D.width=$);var J={x:-D.width/2,y:-8-D.height,width:D.width,height:D.height+8}}else J={x:-6,y:-18,width:12,height:18};N.mat=M._16O(V(z+".autorotate"),V(z+".position"),g,V(z+".face"),V(z+".t3"),V(z+".r3"),V(z+".rotationMode")),N.rect=J,1!==n&&(J=Wi(J),J.x*=n,J.height*=n,J.y=-J.height,J.width*=n);var u=J.x,x=J.y,R=J.width,p=J.height;N.vs=new Yp([u,-x,0,u,-x-p,0,u+R,-x-p,0,u+R,-x,0])}},eachShapeModel:function(n,L){function A(H){vh(H),H.vs&&n(H.vs,H.is,H.ns,H.uv),H.top_vs&&n(H.top_vs,H.top_is,H.top_ns,H.top_uv),H.bottom_vs&&n(H.bottom_vs,H.bottom_is,H.bottom_ns,H.bottom_uv),H.from_vs&&n(H.from_vs,H.from_is,H.from_ns,H.from_uv),H.to_vs&&n(H.to_vs,H.to_is,H.to_ns,H.to_uv)}function d(t){var W,K,v;if(Vd(t))for(K=0,v=t.length;v>K;K++)W=t[K],W&&d(W);else Xj(t)?d(ub(G,t),G):Np(t)&&(t.shape3d?d(t.shape3d):A(t))}var G=this,h=G.data,L=L||G.shapeModel||ub(G);L||(L=h instanceof U.Node&&!(h instanceof U.Shape)?{vs:jq,is:Pq}:[G.left,G.front,G.right,G.back,G.top,G.bottom]),d(L)},_28O:function(k,Y,R){if(R(this.s(Y+".transparent"))){var A=k.rect,F=k.textureScale,H=A.width*F,N=A.height*F;if(H>=1&&N>=1){var j=Wb(H,N);1!==F&&(j.translate(A.x,A.y),j.scale(F,F),j.translate(-A.x,-A.y)),Ue(j,k),j.restore(),sk(this,Y,k.mat,k.vs,!0)}}},_29O:function(i,L,H){if(H(this.s(L+".transparent"))){var a=i.rect,O=i.textureScale,g=a.x,P=a.y,s=a.width*O,F=a.height*O;if(s>=1&&F>=1){a.x=a.y=0;var q=Wb(s,F);1!==O&&q.scale(O,O),ge(q,i),q.restore(),a.x=g,a.y=P,sk(this,L,i.mat,i.vs,!1)}}},_99O:function(E,m,S,W,l,H){if(S){var V=this,O=V.gv,t=V.data,q=O._buffer,s=O._1O,u=S.icons,k=ts.for(E),L=k.directAttribs();for(var Q in u){var r=u[Q],G=S.rects[Q];if(G&&H(gs(r.transparent,t,O))){O._picking&&Qo(E,W,l,V,Q);var A=gs(r.shape3d,t,O),i=A?[A]:gs(r.names,t,O),a=i?i.length:0,X=gs(r.textureScale,t,O)||1,R=gs(r.light,t,O);R==g&&(R=A?!0:!1),oe(E,m,gs(r.blend,t,O),R,gs(r.opacity,t,O),gs(r.reverseFlip,t,O),gs(r.reverseColor,t,O),gs(r.reverseCull,t,O));for(var n=0;a>n;n++){var I=i[n],j=G[n];if(Rb(V,j.mat),A)_h(O,t,ub(V,A),V);else{var C=dg(I);if(C){var M=j.width*X,P=j.height*X;if(M>=1&&P>=1){var B=Wb(M,P);id(B,C,gs(r.stretch,t,O),0,0,M,P,t,O),B.restore(),Re(E,tk,s),eh(E,m,s,gs(r.discardSelectable,t,O),q.uv,wf),L.aPosition=Yr(E,q.vs,j.vs,g),L.aNormal=bo(E,q.ns,un,g),Zr(E,q.is,Fn),ih(E,0,Fn.length),uk(E,m,s)}}}ur(O)}eq(E,m)}}}}});var _s=function(r,U){$e(_s,this,[r,U])};zs(_s,$s,{_16O:function(k,K,p,C,x,O,v,U,D){var o=this.data,c=o.getFinalScale3d(),X=ef(K,c,p,C,U,D);if(o.hasOwnProperty("_anchor")||o.hasOwnProperty("_anchorElevation")){var g=o.getAnchor3d();X[0]-=(g.x-.5)*c[0],X[1]-=(g.y-.5)*c[1],X[2]-=(g.z-.5)*c[2]}return al(Wq(),X,o.p3(),C,x,O,v,k,o.getFinalRotation3d(),o.getRotationMode())},clear:function(){var z=this;z.faceMat=z.mat=z.shapeModel=z.left=z.right=z.front=z.back=z.top=z.bottom=z.csg=g},needValidate:function(T){if(this._iv)return this._validateFrameId=T._renderInfo.frame,!0;if(this.data._47Q){var W=T._renderInfo.frame;if(this._validateFrameId!==W)return this._validateFrameId=W,!0}return!1},validate:function(L,y){var B=this,n=B.gv,H=B.data,h=B.shapeName=B.s(wq),X=ub(B,h);if(B._updateAutoRotation(),B._updateFixSize2d(),B._updateOverlapping(),B.dispatchBoundingBoxChanged(),H._47Q){var K=H.getRenderLayer(),i=n._40Q.get(K);i&&i.ivWireframeBatch(H)}var M=Ph(H,n.getMat(H),X?B.s("shape3d.scaleable"):!0);if(H.appendAnchorMatrix3d(M),B.clear(),B.mat=H.mat=M,X||!h)if(B.shapeModel=X,L)if(X)Eq(n,H,X,B,B.getBodyColor(),[M],L);else{var N=$k(M);fp(n,H,L,y,M,N,Vn,Af),fp(n,H,L,y,M,N,qp,So),fp(n,H,L,y,M,N,$l,Gp),fp(n,H,L,y,M,N,ep,kp),fp(n,H,L,y,M,N,Mh,vi),fp(n,H,L,y,M,N,xc,Lo)}else X||(B._cubeUvs=null,B.vf(Vn,0),B.vf(qp,16),B.vf(Mh,8),B.vf(xc,24),B.vf($l,32),B.vf(ep,40))},_updateAutoRotation:function(){var d=new qj,P=new cr,$=new Bb,t=new Bb,R=new Bb;return function(){var M=this,j=M.data,x=M.s("autorotate")||M.s("shape3d.autorotate");if(!x)return j._dynamicRotation&&delete j._dynamicRotation,void 0;var V=M.gv;R.copy(M.s("shape3d.autorotate.up")||V._up);var b;b="string"==typeof x?[x.indexOf("x")<0?V._eye[0]:V._center[0],x.indexOf("y")<0?V._eye[1]:V._center[1],x.indexOf("z")<0?V._eye[2]:V._center[2]]:V._eye;var u=V._center,n=j.p3();$.copy(n),t.set(b[0]-u[0],b[1]-u[1],b[2]-u[2]).add($),P.lookAt(t,$,R),d.set(0,0,0,j.getRotationMode(),!0).setFromRotationMatrix(P);var O=j._dynamicRotation;O&&Math.abs(O[0]-d.x)<1e-5&&Math.abs(O[1]-d.y)<1e-5&&Math.abs(O[2]-d.z)<1e-5||(j._dynamicRotation=[d.x,d.y,d.z])}}(),_updateFixSize2d:function(){var d=this,W=d.data,X=d.s("fixSizeOnScreen")||d.s("shape3d.fixSizeOnScreen");if(!X)return W._dynamicScale3d&&delete W._dynamicScale3d,void 0;var w=d.gv,E=Ph(W,w.getMat(W)),m=aq([0,0,0],E),V=w.toViewPosition(m);if(!isNaN(V.x)&&!isNaN(V.y)){var i=aq([1,0,0],E),b=w.toViewPosition(i),Z=aq([0,1,0],E),L=w.toViewPosition(Z),h=b.x-V.x,q=L.y-V.y;if(h&&q){var v,j,R=W._dynamicScale3d||[1,1,1],Y=dg(W.s("shape3d.image"));if(X[0]>0&&(v=X[0]),X[1]>0&&(j=X[1]),!v||!j){var o=X>0?X:1;v||(v=(Oo(Y,W)||W.getWidth())*o),j||(j=(Gl(Y,W)||W.getTall())*o)}var e=Math.abs(h/v),N=Math.abs(q/j);Math.abs(e-1)<.001&&Math.abs(N-1)<.001||(W._dynamicScale3d=[R[0]/e,R[1]/N,R[2]])}}},_updateOverlapping:function(){var Z=this,b=Z.s("hide.overlapping.group");if(!b)return Z._rectOverlapping&&(Z._rectOverlapping=s),void 0;var B,U,o,f=Z.gv,t=Z.data,l=Ph(t,f.getMat(t)),A=1/0,E=1/0,I=-1/0,_=-1/0,m=t.getAnchor3d(),H=m.x,i=m.y,x=m.z;for(B=0;8>B;B++){if(U=aq([(B>>2)-H,(1&B>>1)-i,(1&B)-x],l),o=f.toViewPosition(U),isNaN(o.x)||isNaN(o.y))return;A=Math.min(A,o.x),I=Math.max(I,o.x),E=Math.min(E,o.y),_=Math.max(_,o.y)}var q={x:A,y:E,w:I-A,h:_-E};Z._rectOverlapping=f.overlappingBox.isOverlapping(b,q)},getVectorDynamicSize:function(){var S,X=this,x=X.s("shape3d"),J=X.data;if("billboard"===x||"plane"===x||(S=J._currentCubeElementId)!=g){var p,d,u=X.gv,Q=Ph(J,u.getMat(J)),H=J.getAnchor3d(),P=.5-H.x,G=.5-H.y,M=.5-H.z,z=Math.min(X.s("vector.dynamic.maxsize"),u._glCapabilities.maxTextureSize)/u.getDevicePixelRatio(),V=function(W,Y){W[0]+=P,W[1]+=G,W[2]+=M,Y[0]+=P,Y[1]+=G,Y[2]+=M;var $=u.toViewPosition(aq(W,Q)),J=u.toViewPosition(aq(Y,Q)),n=$.x-J.x,A=$.y-J.y;return Math.min(z,Math.sqrt(n*n+A*A))};if("billboard"===x)p=V([-.5,0,0],[.5,0,0]),d=V([0,-.5,0],[0,.5,0]);else if("plane"===x)p=V([-.5,0,0],[.5,0,0]),d=V([0,0,-.5],[0,0,.5]);else if(J._currentCubeElementId!=g){var Y=3*Pq[S+1],W=3*Pq[S],N=3*Pq[S+2];p=V([jq[Y],jq[Y+1],jq[Y+2]],[jq[N],jq[N+1],jq[N+2]]),d=V([jq[Y],jq[Y+1],jq[Y+2]],[jq[W],jq[W+1],jq[W+2]])}return[p,d]}},vf:function(G,$){var b=this;if(b.gv.getFaceVisible(b.data,G)){var l=vo(b,G);l.mat&&(b.faceMat=!0);var x=l.uv;if(x){var L=b._cubeUvs;L||(L=b._cubeUvs=new Yp([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var f=0;8>f;f++)L[$+f]=x[f]}return l}},_billboardInView:function(){var q=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],L=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],p=new el,m=new Bb,z=new cr;return function(D){var d=this;if(!d.mat)return!0;var V=d.gv.getFrustum(),h="billboard"===D?q:L;p.makeEmpty(),z.fromArray(d.mat);for(var P=0,e=h.length;e>P;P+=3)p.expandByPoint(m.fromArray(h,P).applyMatrix4(z));return V.intersectsBox(p)}}(),_80o:function(H,v,J){var m=this;if(m._rectOverlapping)return!0;var d=m.shapeModel;if(d||!m.shapeName){var k=m.s("shape3d");if(("billboard"===k||"plane"===k)&&!m._billboardInView(k))return!0;var Z=m.gv,K=m.data,A=Z._cube,s=ts.for(H),j=s.directAttribs();if(Ag&&!Dp){var y=m.mat;if(y)for(var x=0;x<y.length;x++)m.mat[x]=y[y.length-x-1]}hn(Z,m.mat),!H._picking&&m.s("shape3d.reflector")||m.s("effect.flow")||(d?_h(Z,K,d,m,m.getBodyColor(),J):(j.aPosition=Yr(H,A.vs,g,g),j.aNormal=Yr(H,A.ns,g,g),rf(H,A.is),m._18O(H,v,"left",0,J),m._18O(H,v,"front",6,J),m._18O(H,v,"right",12,J),m._18O(H,v,"back",18,J),m._18O(H,v,"top",24,J),m._18O(H,v,"bottom",30,J))),ur(Z),m.faceMat&&(m._18O(H,v,"left",0,J,!0),m._18O(H,v,"front",6,J,!0),m._18O(H,v,"right",12,J,!0),m._18O(H,v,"back",18,J,!0),m._18O(H,v,"top",24,J,!0),m._18O(H,v,"bottom",30,J,!0))}},_18O:function(B,w,E,T,G,l){var y=this[E];if(y){if(!G(y.transparent))return;if(l&&!y.mat||!l&&y.mat)return;var c=this.data.s("polygonOffset");c&&Vj(B,c),l&&hn(this.gv,y.mat);var M=this,Q=M.data,R=ts.for(B),f=R.directUniforms();Q._currentCubeElementId=T;var $=M.gv,e=$.getTexture(y.texture,Q,E),F=y.uv,L=y.uvScale,p=y.uvOffset,d=y.uvRotation,A=y.uvAnchor,n=y.discardSelectable;e?F?eh(B,w,e,n,$._buffer.uv,M._cubeUvs,p,L,d,A):eh(B,w,e,n,$._cube.uv,g,p,L,d,A):eh(B),oe(B,w,y.blend,y.light,y.opacity,y.reverseFlip,y.reverseColor,y.reverseCull),f.uDiffuse=y.color||x["color.empty"],ih(B,T,6),eq(B,w),uk(B,w,e),l&&ur($),c&&Ln(B),Q._currentCubeElementId=null}},drawReflector:function(){var B=new Bb,d=new Bb,K=new qj,E=new cr,t=new Bb,Y=new Bb,C=new Bb,h=new Bb,M=new cr,H=new cr,p=new Hn,V=new Gk,N=new Gk,v=function(G,I,o){G[o]=I[0],G[o+1]=I[1],G[o+2]=I[2]},i=function(q,z,x){x=x||0,q[0]=z[x],q[1]=z[x+1],q[2]=z[x+2]},c=function(T,U){v(T,U.getEye(),0),v(T,U.getCenter(),3),v(T,U.getUp(),6)},w=function(P,d){i(d._eye,P,0),i(d._center,P,3),i(d._up,P,6),d._18Q=g;var Q=d._skybox;Q&&(Q.p3([P[0],P[1],P[2]]),d.getData3dUI(Q).iv())};return function(I){var R=this;R._reflectorInfo=null;var x=R.data;if(x._reflecting)return!1;var G=R.gv;if(G._picking)return!1;var W=x instanceof Uj,k=R._reflectorRenderTarget,O=G._canvas.width,j=G._canvas.height;if(k?k.setSize(I,O,j):k=R._reflectorRenderTarget=new dd.RenderTarget(G,I,O,j),W){var e=x.getPointsMatrix3d().getElements(),$=x.p3();$[1]+=(1-x.getAnchorElevation())*x.getTall(),B.copy(aq($,e))}else B.copy(x.p3());if(d.copy(G.getEye()),E.makeRotationFromEuler(K.set(x.r3(),x.getRotationMode(),!0)),!R._reflectNormal){var r;if(W&&x.getThickness()<0){if(!R.shapeModel||!R.shapeModel.top_vs)return!1;r={vs:R.shapeModel.top_vs,ns:R.shapeModel.top_ns}}else{if(r=ub(R,R.s("shape3d")),!r)return!1;!r.ns&&r.length&&(r=r[0])}if(!r.ns||!r.vs)return!1;R._reflectNormal=[r.ns[0],r.ns[1],r.ns[2]],R._reflectorVbuffer=Dl.Buffer.createVertexBuffer(I,new Float32Array(r.vs))}if(t.copy(R._reflectNormal),t.applyMatrix4(E),Y.subVectors(B,d),Y.dot(t)>0)return!1;Y.reflect(t).negate(),Y.add(B),C.copy(G.getCenter()).negate().add(B),C.reflect(t).negate(),C.add(B),h.copy(G.getUp()),h.reflect(t);var y=[0,0,0,0,0,0,0,0,0];c(y,G),i(G._eye,Y.toArray()),i(G._center,C.toArray()),i(G._up,h.toArray()),G._18Q=g;var Q=G._skybox;Q&&(Q.p3(G._eye),G.getData3dUI(Q).iv()),Qg(I,k.frame),G.setViewport(I,0,0,k.width,k.height);var Z=x.s("shape3d.reflector.background");if(Z){var J=I.getParameter(I.COLOR_CLEAR_VALUE);Un(I,Z)}else Un(I,[0,0,0,1]);ts.for(I).glState.depth.mask=!0,I.clear(I.COLOR_BUFFER_BIT|I.DEPTH_BUFFER_BIT);var S=x.s("shape3d.reflector.clip"),u=S===s?.003:S,D=Mc(G),b=rr(G);p.setFromNormalAndCoplanarPoint(t,B.add(t.clone().multiplyScalar(u))),p.applyMatrix4(H.fromArray(b)),V.set(p.normal.x,p.normal.y,p.normal.z,p.constant),H.fromArray(D).getInverse(H),N.set(Math.sign(V.x),Math.sign(V.y),1,1).applyMatrix4(H),V.multiplyScalar(2/V.dot(N)),D[2]=V.x-D[3],D[6]=V.y-D[7],D[10]=V.z-D[11],D[14]=V.w-D[15];var l=G._computedProjectMatrix;G._computedProjectMatrix=D,x._reflecting=!0;var X=x.s("shape3d.reflector.shadow"),o={renderAxis:!1,renderEdit:!1,renderGrid:!1};"disabled"===X?(o.createShadowMap=!1,o.renderShadow=!1):"scene"===X?o.createShadowMap=!1:o.useReflectorSelfShadowMap=!0,G.renderScene(o),G._computedProjectMatrix=l,M.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),M.multiply(H.fromArray(G._projectMatrix)),M.multiply(H.fromArray(G._viewMatrix)),Z&&Un(I,J),hc(I),w(y,G);var a=x.s("shape3d.reflector.blur");if(a){var A=G.getPostProcessingModule("Blur");A&&A.drawImpl(I,k,a,a>=3,x.s("shape3d.reflector.blur.iterations"))}var L=G.getPostProcessingModule("Glitch");L&&L.enable&&L.onlyReflector&&(k=L._42(I,k));var P=I._compiledShader.reflector;P||(P=I._compiledShader.reflector=new Dl.Shader(I,Zm.Reflector.vs,Zm.Reflector.fs)),P.bind(),I.activeTexture(I.TEXTURE0),nm(I,k.texture),P.uniforms.tDiffuse=0,P.uniforms.color=Jj(x.s("shape3d.reflector.color")||"rgb(128,128,128)"),P.uniforms.textureMatrix=M.toArray(),P.uniforms.modelMatrix=W?e:Ph(x),P.uniforms.viewMatrix=rr(G),P.uniforms.projectionMatrix=Mc(G);var f=R._reflectorVbuffer;f.upload(),P.attributes.pos.pointer(f);var U=this.s("shape3d.transparent");if(U){var F=ts.for(I).glState,n=F.depth.mask;F.depth.mask=!1}return I.drawArrays(I.TRIANGLES,0,f.data.length/3),U&&(F.depth.mask=n),x._reflecting=!1,I.useProgram(G._prg),nm(I,g),!0}}()}),Zm.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );","}"].join("\n")};
var at=function(G,M){$e(at,this,[G,M])};zs(at,_s,{_80o:function(){}});var bt=function(e,U){$e(bt,this,[e,U])};zs(bt,$s,{_25Q:1,validate:function(z){var b=this;if(!b.s("geometry.cache")||!b.info){var O=b.gv,a=b.data,d=b.s,Z=d("edge.width"),B=a._40I,e=a._41I;if(b.shapeModel=b.info=b.lineShapeModel=g,B&&e){var N,o,f,K,H,v,T,x,F,u,s=a.isLooped(),X=d(Qj),D=p.getEdgeType(X);if(D){var q=D(a,Cb(b,O,a,s,X),O,b._19Q);if(!q.points||q.points.isEmpty())return;v=b.info={},T=q.segments,H=q.points,x=H.size();for(var W=B.getElevation(),J=e.getElevation(),A=0;x>A;A++){var R=H.get(A);R.e==g&&(R.e=W+(J-W)*A/(x-1))}F=gm(H.get(0)),u=gm(H.get(x-1));var $=x%2;0===$?(v.c1=gm(H.get(x/2-1)),v.c2=gm(H.get(x/2))):v.p3=gm(H.get((x-$)/2)),v.s1=F,v.s2=gm(H.get(1)),v.t1=gm(H.get(x-2)),v.t2=u}else{H=new Yn,v=b.info={};var Y=d("edge.offset"),V=d("edge.center"),M=d("edge.source.t3"),l=d("edge.target.t3"),w=Pn(O,a,"source"),j=Pn(O,a,"target");if(!w||!j)return O.invalidateData(a),delete b.info,!1;if(M&&(w[0]+=M[0],w[1]+=M[1],w[2]+=M[2]),l&&(j[0]+=l[0],j[1]+=l[1],j[2]+=l[2]),X===tp){T=d("edge.segments");var c=v.points=d(sm)||Bn;if(x=c.size()){F=gm(c.get(0)),u=gm(c.get(x-1)),!V&&Y&&(f=Nh(F,w,!0),Y=Q(Y,lr(w,F)),w=[w[0]+f[0]*Y,w[1]+f[1]*Y,w[2]+f[2]*Y],f=Nh(j,u,!0),Y=Q(Y,lr(u,j)),j=[j[0]-f[0]*Y,j[1]-f[1]*Y,j[2]-f[2]*Y]);var $=x%2;0===$?(N=gm(c.get(x/2-1)),o=gm(c.get(x/2))):v.p3=gm(c.get((x-$)/2)),v.s1=w,v.s2=F,v.t1=u,v.t2=j}else!V&&Y&&(f=Nh(j,w,!0),K=lr(w,j),Y=_e(Y,K),w=[w[0]+f[0]*Y,w[1]+f[1]*Y,w[2]+f[2]*Y],j=[j[0]-f[0]*Y,j[1]-f[1]*Y,j[2]-f[2]*Y]),N=w,o=j;H.add({x:w[0],y:w[2],e:w[1]}),H.addAll(c),H.add({x:j[0],y:j[2],e:j[1]})}else{var S=Cb(b,O,a,s,X);if(b._19Q||(S=-S),s){var m=w[0],C=w[1],G=w[2],i=B.getTall()/2+S;N=[m-S,C+i,G],o=[m+S,C+i,G],H.add({x:m-S,y:G,e:C}),H.add({x:m-S,y:G,e:C+i}),H.add({x:m+S,y:G,e:C+i}),H.add({x:m+S,y:G,e:C})}else{f=Nh(j,w,!0),K=lr(w,j);var r={x:w[0],y:w[2]},U={x:j[0],y:j[2]},k=Jp(g,r,U,S),y=k.x-r.x,P=k.y-r.y;Y=_e(Y,K),f[0]*=Y,f[1]*=Y,f[2]*=Y,N=[w[0]+f[0]+y,w[1]+f[1],w[2]+f[2]+P],o=[j[0]-f[0]+y,j[1]-f[1],j[2]-f[2]+P],V?(H.add({x:w[0],y:w[2],e:w[1]}),H.add({x:N[0],y:N[2],e:N[1]}),H.add({x:o[0],y:o[2],e:o[1]}),H.add({x:j[0],y:j[2],e:j[1]})):(H.add({x:N[0],y:N[2],e:N[1]}),H.add({x:o[0],y:o[2],e:o[1]}))}}v.c1=N,v.c2=o}v._lastPointsSegments={points:H,segments:T},v.list=d(wq)===tj?b.createTubeModel(H,T,Z/2,z):b.createLineModel(H,T,Z,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=g}});var ct=function(a,Z){$e(ct,this,[a,Z]),this._needRecoverPosition=!0};zs(ct,_s,{_80o:function(Y,d,t){var G=this,K=G.mat;if(K&&(!G.s("shape3d.reflector")||Y._picking)){var h=G.gv,V=G.shapeModel;if(p.extractShapeTranslation){var k=G._vsTranslation;k&&(K=(new fo.Matrix4).fromArray(K).multiply(k).toArray())}hn(h,K),V?_h(h,G.data,V,G,G.getBodyColor(),t):(hs(G,Y,d,"left",t),hs(G,Y,d,"front",t),hs(G,Y,d,"right",t),hs(G,Y,d,"back",t),hs(G,Y,d,"top",t),hs(G,Y,d,"bottom",t)),ur(h)}},validate:function(w,h){var I,V,m=this,j=m.s,y=m.data,P=y._thickness/2,W=y.isClosePath(),_=y.getPoints(),E=y.getSegments(),v=j(Ol),b=w&&w.uv;if(m.clear(),m.dispatchBoundingBoxChanged(),!w&&p.extractShapeTranslation){var l=new fo.Vector3(y.p3());_=Wi(_),_.forEach(function(N){N.x-=l.x,N.y-=l.z}),m._vsTranslation=(new fo.Matrix4).setPosition(l);var X=y.getShapeElevation;y.getShapeElevation=function(){return-(this.getTall()||0)*(this._anchorElevation-.5)}}else m._vsTranslation=null;if(0>P){m.s("shape3d.reflector")&&(m._reflectNormal=null);try{var x=j("shape3d.image.projection");if(x&&x[4]){var k=y.p3(),J=k[0],N=k[2];x=[J+x[0],x[1]+N,J+x[2],x[3]+N]}V=m.shapeModel=zc(_,E,j(Dn),j(Mo),v,j(xf),y.getTall(),y.getShapeElevation(),W,x)}catch(G){V=m.shapeModel={}}j(ok)?j("shape3d.image")||delete V.uv:(delete V.vs,delete V.ns,delete V.uv),j("shape3d.top.image")||delete V.top_uv,j("shape3d.bottom.image")||delete V.bottom_uv}else if(j(wq)===tj)I=Ok(_,E,v,W),V=m.shapeModel={vs:[]},j("shape3d.image")&&(V.uv=[],V.sum=j(xf)||ud(I)||1,V.len=0),j(Dn)&&!W&&(V.top_vs=[],j("shape3d.top.image")&&(V.top_uv=[])),j(Mo)&&!W&&(V.bottom_vs=[],j("shape3d.bottom.image")&&(V.bottom_uv=[])),m._12O(I,P);else{var S,Z,z,D,f,L,Q,a,r,i;if(I=Ok(_,E,v,W),f=m.vf(Mh,b,!1,h),P&&(L=m.vf(xc,b,!1,h),Q=W?g:m.vf(Vn,b,!1,h),a=W?g:m.vf(qp,b,!1,h),r=m.vf($l,b,!1,h),i=m.vf(ep,b,!1,h)),P){for(var T=0,Y=I.length;Y>T;T++)I[T]=m._tryRemoveBezierPoints(I[T],P);m._12O(I,P)}else f&&I.forEach(function(T){if(D=T.length,D>0)for(S=T[0],z=1;D>z;z++)Z=T[z],m.addV(f.vs,S,Z),S=Z});m._20Q(I),w||(f&&(f.ns=Cl(f.vs),Vr(f,"vs"),Vr(f,ui)),P&&(L&&(L.ns=Cl(L.vs),Vr(L,"vs"),Vr(L,ui)),Q&&(Q.ns=Cl(Q.vs),Vr(Q,"vs"),Vr(Q,ui)),a&&(a.ns=Cl(a.vs),Vr(a,"vs"),Vr(a,ui)),r&&(r.ns=Cl(r.vs),Vr(r,"vs"),Vr(r,ui)),i&&(i.ns=Cl(i.vs),Vr(i,"vs"),Vr(i,ui))))}var e=m.mat=y.getPointsMatrix3d().getElements();w&&(Ll(m,e,w,V),m.clear()),X!=g&&(y.getShapeElevation=X)},_20Q:function(p){var l,b,j,v,k,y,U,s=this,o=s.front,u=s.back,F=s.top,A=s.bottom,E=o?o.tuv:g,H=u?u.tuv:g,L=F?F.tuv:g,I=A?A.tuv:g,R=0;(E||H||L||I)&&(l=s.s(xf)||ud(p)||1,p.forEach(function(M){if(b=M.length,b>0)for(y=M[0],j=1;b>j;j++)U=M[j],v=R/l,R+=lr(y,U),k=R/l,s._14O(o,v,k),s._14O(u,1-k,1-v),s._14O(F,v,k),s._14O(A,v,k),y=U}))},_14O:function(k,h,Z){if(k){var q=k.uv,s=k.tuv;if(s){if(q)var l=q[0]+(q[6]-q[0])*h,S=q[1]+(q[7]-q[1])*h,O=q[2]+(q[4]-q[2])*h,o=q[3]+(q[5]-q[3])*h,c=q[2]+(q[4]-q[2])*Z,z=q[3]+(q[5]-q[3])*Z,R=q[0]+(q[6]-q[0])*Z,M=q[1]+(q[7]-q[1])*Z;else l=h,S=0,O=h,o=1,c=Z,z=1,R=Z,M=0;s.push(O,o,c,z,R,M,R,M,l,S,O,o)}}},_13O:function(s){var N=s.uv,A=s.tuv;A&&(N?A.push(N[2],N[3],N[4],N[5],N[6],N[7],N[6],N[7],N[0],N[1],N[2],N[3]):A.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(L,y){var p=L.length;if(4>p)return L;var Z,a,j,q,N,E,d=!1,Q=function(F){return L[F]},C=function(z){return L[p-1-z]};for(N=0;1>=N;N++)for(E=N?C:Q,a=E(0),j=E(1),Z=2;p-1>Z;Z++)if(q=E(Z),!q.remove)if(q.b){var W=Jp(a,j,q,y);W.adjust?(q.remove=!0,d=!0):(a=j,j=q)}else a=j,j=q;if(!d)return L;var w=[];for(Z=0;p>Z;Z++)L[Z].remove||w.push(L[Z]);return w},_12O:function(L,V){var W,B,$,a,j,h=this.s("shape3d.point.epsilon"),e=this;L.forEach(function(Y){if(j=Y.length,j>0)for(W={p:Y[0],n:!0},a=1;j>a;a++)B=Y[a],$=j-1>a?Y[a+1]:g,$&&Math.abs(B.x-$.x)<h&&Math.abs(B.y-$.y)<h||e.addPoint(W,B,$,V,Y)})},addPoint:function(W,z,p,O,P){var a,Z,$,S,f,C,_,w,G,u=this,T=W.p,l=W.f,U=W.b,q=u.s("shape3d.side")||Sq,k=u.s("shape3d.start.angle"),h=u.s("shape3d.sweep.angle"),v=u.shapeModel,s=u.data.isClosePath();if(W.n&&(W.n=!1,l=s&&P.length>2?Jp(P[P.length-2],T,z,O):Jp(g,T,z,O),U=_g(T,l),v?v.top_vs&&u._10O(U,l,q,k,h,v.top_vs,v.top_uv):(a=u.left)&&(u.addV(a.vs,U,l),u._13O(a))),Z=p?Jp(T,z,p,O):s&&P.length>2?Jp(T,z,P[1],O):Jp(T,z,g,O),$=_g(z,Z),v){var V,A,B=v.vs,N=v.uv,J=v.sum;for(N&&(V=v.len/J,v.len+=lr(T,z),A=v.len/J),C=u._9O(U,l,q,k,h),_=u._9O($,Z,q,k,h),w=0;q>w;w++)G=w+1,sb(B,C[G]),sb(B,_[w]),sb(B,C[w]),sb(B,_[w]),sb(B,C[G]),sb(B,_[G]),N&&(S=w/q,f=G/q,N.push(V,f,A,S,V,S,A,S,V,f,A,f));!p&&v.bottom_vs&&u._10O($,Z,q,k,h,v.bottom_vs,v.bottom_uv,!0)}else!p&&(a=u.right)&&(u.addV(a.vs,Z,$),u._13O(a)),(a=u.front)&&u.addV(a.vs,l,Z),(a=u.back)&&u.addV(a.vs,$,U),(a=u.top)&&u.addH(a.vs,l,Z,$,U,!0),(a=u.bottom)&&u.addH(a.vs,U,$,Z,l);W.p=z,W.f=Z,W.b=$},_10O:function(d,y,B,s,o,J,l,X){var R,t,p=this,N=p.data,O=p._9O(d,y,B,s,o),f=(d.x+y.x)/2,P=(d.y+y.y)/2,b=N.getShapeElevation(),i=0;for(i=0;B>i;i++)X?(sb(J,O[i]),sb(J,O[i+1])):(sb(J,O[i+1]),sb(J,O[i])),sb(J,[f,b,P]),l&&(X?(R=L*(i+1)/B+s,t=L*i/B+s):(R=L*i/B+s,t=L*(i+1)/B+s),l.push(.5-.5*W(t),.5-.5*_(t),.5-.5*W(R),.5-.5*_(R),.5,.5))},_9O:function(u,k,q,B,R){var S,G,x=this,b=x.data,D=[],y=(u.x+k.x)/2,m=(u.y+k.y)/2,O=b.getTall()/2,e=b.getShapeElevation(),F=0;for(R==g&&(R=L);q>=F;F++)S=R*F/q+B,G=W(S),D.push([y+(u.x-y)*G,e+O*_(S),m+(u.y-m)*G]);return D},addV:function(E,g,M){var r=g.x,n=g.y,F=M.x,A=M.y,u=this.data,K=u.getShapeElevation(),Y=u.getTall()/2;E.push(r,K-Y,n,F,K-Y,A,F,K+Y,A,F,K+Y,A,r,K+Y,n,r,K-Y,n)},addH:function(E,F,z,M,d,O){var h=this.data,D=h.getTall()/2,w=h.getShapeElevation()+(O?D:-D);E.push(F.x,w,F.y,z.x,w,z.y,M.x,w,M.y,M.x,w,M.y,d.x,w,d.y,F.x,w,F.y)},vf:function(P,l,y,G){var L,i=this,H=i.gv.getFaceVisible(i.data,P);return(y||H)&&(L=vo(i,P,G),L.vs=[],L.tuv=H&&(L.texture||l)?[]:g,L.visible=H),L}});var dt=function(P,s){$e(dt,this,[P,s])},et={},ft=function(l){return/\.(png|jpg|gif|jpeg|bmp|svg)$/i.test(l)};zs(dt,_s,{validate:function(){var X=this,i=X.gv,z=X.data,K=X.s,G=Jj(K("points.color")),y=K("points.size"),q=K("points.uv.offset"),R=K("points.image");!R||ft(R)||mj.test(R)||(et[R]||(et[R]=X._createCachedImage(R)),R=et[R]);var B,E,v=z._modelDirty,H=K("points.model");if(H){if(X._lastShapeModel!==H||!X.shapeModel){var U=ub(X,H);if(!U)return;var J=[],A={};X.eachShapeModel(function(U){for(var Y=0,l=U.length;l>Y;Y+=3){var s=U[Y],g=U[Y+1],a=U[Y+2],S=""+s+"_"+g+"_"+a;A[S]||(A[S]=!0,J.push(s,g,a))}},U),X._setShapeModelPoints(new Yp(J)),X._lastShapeModel=H,v=!0}B=X.shapeModel.vs.length,E=B/3}else{var r=z.getPoints();if(E=B=r.length,v||z._pointsDirty||!X.shapeModel){for(var o=[],Q=0;E>Q;Q++){var P=r[Q];P&&o.push(P.x,P.e,P.y)}X._setShapeModelPoints(new Yp(o)),z._pointsDirty=!1,X._lastShapeModel=null,v=!0}}if(X.info={mat:Ph(z),size:y,diffuse:G,opacity:K("points.opacity"),texture:R,alphaTest:K("points.transparent")?0:K("alphaTest"),uvScale:K("points.uv.scale"),uvOffset:q,discardSelectable:K("points.discard.selectable")},v||z._colorsDirty){var t=!1,w=z.getColors();if(w&&w.length>0)for(var C=[],Q=0;E>Q;Q++)for(var e=w[Q],n=e?(t=!0,Jj(e)):G,O=4*Q,h=0;4>h;h++)C[O+h]=n[h];X.shapeModel.cs=t?new Yp(C):null,z._colorsDirty=!1}if(v||z._sizesDirty){var g=!1,T=z.getSizes();if(T&&T.length>0)for(var F,f=[],Q=0;E>Q;Q++)F=T[Q],F>=0?(f.push(F),g=!0):f.push(y);X.shapeModel.ss=g?new Yp(f):null,z._sizesDirty=!1}if(v||z._offsetsDirty){var D=!1,V=z.getUvoffsets();if(V&&V.length>0)for(var I,M,x,c=[],Q=0;E>Q;Q++)I=2*Q,M=V[I],x=V[I+1],M!=s&&x!=s?(c.push(M,x),D=!0):c.push(q[0],q[1]);X.shapeModel.os=D?new Yp(c):null,z._offsetsDirty=!1}if(v||X._lastPointNumber!==E){this.dispose();var Y=i.pickColorMap,$=X._startPickId=Y._pickIdUsed;Y._pickIdUsed=$+E;for(var o=[],Q=0;E>Q;Q++){var u=$+Q,j=Ks(u);o.push(j[0],j[1],j[2],j[3]),Y[u]||(Y[u]={data:z,part:Q})}X.shapeModel.ps=new Yp(o),X._lastPointNumber=E}z._modelDirty=!1,this.dispatchBoundingBoxChanged()},_setShapeModelPoints:function(M){var k=this,J=k.shapeModel,m=k.shapeModel={vs:M};if(!J)return m;var C=M.length,n=Math.round(C/3);return J.cs&&J.cs.length==4*n&&(m.cs=J.cs),J.ss&&J.ss.length==n&&(m.ss=J.ss),J.os&&J.os.length==2*n&&(m.os=J.os),J.ps&&J.ps.length==4*n&&(m.ps=J.ps),m},_createCachedImage:function(z){var K=128,Z=gj(),y=Z.getContext("2d");Df(Z,K,K,1),jj(y,{width:K,height:K,comps:[{type:z,background:"white",borderWidth:0,rect:[0,0,K,K]}]},0,0,K,K);var A=U.Math.generateUUID();return Dr[A]=Z,A},_80o:function(C,r){var N=this,X=N.gv,k=X._picking;if(!k||X.isSelectable(N.data)){var O=N.shapeModel,W=N.info;if(O&&O.vs&&O.vs.length){var p=ts.for(C);p.useProgram(N._asureProgram(C));var s=p.directUniforms(),H=p.directAttribs();s.modelMatrix=W.mat,s.modelViewMatrix=$c([],X._viewMatrix,W.mat),s.projectionMatrix=X._projectMatrix,s.viewMatrix=X._viewMatrix,s.scale=X.getHeight()/2,s.size=W.size,s.diffuse=W.diffuse,s.opacity=W.opacity,s.map=X.getTexture(W.texture,N.data),s.alphaTest=W.alphaTest,s.resolution=X.getDevicePixelRatio(),s.discardSelectable=W.discardSelectable,s.uvScale=W.uvScale,H.uvOffset=!k&&O.os?bo(C,X._buffer.os,O.os,g):W.uvOffset,s.blackout=C._blooming&&!N.data.s("bloom"),H.position=bo(C,X._buffer.vs,O.vs,g),k?(s.picking=!0,H.pickColor=bo(C,X._buffer.ps,O.ps,g),s.useColor=!1,H.color=null):(s.picking=!1,H.pickColor=null,O.cs?(s.useColor=!0,H.color=bo(C,X._buffer.cs,O.cs,g)):(s.useColor=!1,H.color=null)),O.ss?(s.useSizeArray=!0,H.sizeArray=bo(C,X._buffer.ss,O.ss,g)):(s.useSizeArray=!1,H.sizeArray=null),Co(C,0,O.vs.length/3,C.POINTS),p.useProgram(r),H.disable(),X.shadowMap.enable&&X.shadowMap.createShadow(),X.flowMap.createFlow(s)}}},_asureProgram:function(N){return N._pointsShader||(N._pointsShader=this.gv._postProcessing.createShader(N,dt.shaderSrc)),N._pointsShader.program},dispose:function(){dt.superClass.dispose.call(this);var o=this._startPickId,W=this._lastPointNumber;if(o&&W){for(var y=this.gv.pickColorMap,t=0;W>t;t++){var z=o+t;y[z]&&delete y[z]}delete this._startPickId,delete this._lastPointNumber}}}),dt.shaderSrc="!!~v!oj<g*p!s{n/!onpbjuu5j!tnppQewfnm!N.b!u0s!jfym<bd!tv!o)j!g>p+s!nf!{njbTuu5o!jnppQe`fmmhW!j*f!xfNwbjuusdjfyq<ts!fvQotjjg!p)s!ng!jn!bu<5*!!q1s/p2k!f.d!u>j>p!o^N!b4u!s]j^y!<3!!]vyojjsgupbsNno!pnjbuud5f!kwpjsfqx!N)b!u>s!jfyw<ju!dvfoqjtgspfsQnt!jg!mmppbpuc!!tdbm~f!<<o!pbjuuuvsmjpctvfusf!!+w!ffd{4j!tq!p>t!jfu{jjpTou<ojp!Qv`omjhg!ps|n!!fctpmpfm!!~v!tf<Doppmjpusv<mp!tbfusu!s+j!czvbusfs!Bwff{dj5t!!d>p!mfp{sj<Tu!owjbpsQz`jmohh!!w|f!d*5z!bwsDspBmfp{sj<Tft!vb)u!ugsjj!cv<uofp!jwufjdt3p!QvwwnP!g+g!tyfjus<ub!Nwobpsjzujdofhk!pwsfqd!3>!!woPpgjgutjftup<Q`m!hv!oj<goppsjnu!jctpppQmw!nq!j+d!lyjjoshu<bN!xbfujuWsmjfcevpunf!!>w!fodp5j!uqjjtdplQDwpnm!ps<<*!1!/v2o!j-gepfsnns!pggmtpobbus!ut!j){5fd<fw!!v>o!jogppjsunj!tgpmQpwbnu!!5sdfftwp!mv<u*j!poop<ju!jvtopjqg!p)s4nd!fcwp!p>m!!evftnfsTpjg{tfoBbsssub!z4<df!wb!uu<s*jucfvtugfg!Pgwmvp)b3ud!ftwj!{>f!Busfstbgzg<Pw!!c~p!pm<!sjptmQpfds!t>q!fsdpumjpwDfwN!bu|s!j*ys)p!mnpbDuf5t!vn)!!*g!j|!f!tsmffu!vs~o!!n<]s!p3m!p^D]l!d4j!q^!!>>!>s!p.m!p2D/w1!<|!!~*ho!jwlpdjjeq!)n!bgjjo!)*|!^#!!~qs~f!dj<tsjppmop!Difjthvigqg!jgem!p>b!us<pm!p$DehfbgsjGo`fm!hV!TF|`!NfBtQmf!!v~o!jg<psspnm!pwDfwd!5>!!esjpgmgpvDthfb<sG!`vmohj!gp<sens!bgdmtpjbeu!!*p1q/b1d!j>u>z!<b/!svpomjpgDpfstnv!gggmjpeb)u!!gbjm!qi|b!U*fhtouj<ldj!qv)o!jggjp!sn<!ecspbpdmt!jvet!f*DuptmfpUsb<iq!mwbb!s=z!jbo/hs!pwmfpdD5f!twvDgpgmjpes)<!gj!!vogjjgeposfn$!!cp~p!m!<q*jwdvl!j-oqhb<n!!)vEo3jfgspvsuny!fcup!p>m+!!esjptmdpbDsfetTvfgmgfjdeu!bc<muff<tgg!Pvwo!j>g,p!swnv!!cp<pfmm!bcdmTbwdvl!p+v!ue<spp!DvuoojjgppQs`nm!hw!f>d!3w!vv!w3Tddfbwm!f<|!!*wfbmsczbjuodhf!mwffTde3s!bwdPtgjgetaf!u}<}!h$ojjgl!dejfqgaj)o!fgej)!!V*T!FQ`BNNB`QF!T*V!!)veofjogjpgsfne!!tgbjn$q!mf~s!3E<!*n!bzqu<jd$bfqope!j+g!b/wfptjveg!gnjbej!o-){*z!y|/f!tjvgg!g)jcem!b)d5ldpfvwu!*>!!|s!phmmp`DGfstbvhgDgpjmep!s!|>!!fwtfmdf5!)~1!/1<-*!!1z/u1j-d!b1q/p1!-+!!2b//1s*p<m!psDfwu!v-s{oz<y!/~spm!pwDfwd!5)!5edjfgwg!v>t!fsDppmmppDsf<tv!gjggj!e)!aq|j!d*lsjpomhp!D%f%t!v";var gt=function(E,S){$e(gt,this,[E,S]),this._needRecoverPosition=!0};zs(gt,$s,{_25Q:1,validate:function(v){var y=this,r=y.data,J=y.s,w=r.getPoints(),o=w.size();y.dispatchBoundingBoxChanged();var F=r.p3(),n=y.mat=Wq();Lj(n,F),Pl(n,r.getFinalRotation3d(),r.getRotationMode());var X=r.getScale3d(),Z=r._dynamicScale3d;if(Z&&(X[0]*=Z[0],X[1]*=Z[1],X[2]*=Z[2]),Ng(n,X),Lj(n,zl(F)),(!y.s("geometry.cache")||!y.shapeModel)&&(y.shapeModel=y.info=y.lineShapeModel=g,o>1)){var O=y.info={},i=r.getSegments(),h=r.getThickness(),$=gm(w.get(0)),u=gm(w.get(o-1)),d=o%2;0===d?(O.c1=gm(w.get(o/2-1)),O.c2=gm(w.get(o/2))):O.p3=gm(w.get((o-d)/2)),O.s1=$,O.s2=gm(w.get(1)),O.t1=gm(w.get(o-2)),O.t2=u,O.list=J(wq)===tj?y.createTubeModel(w,i,h/2,v):y.createLineModel(w,i,h,"shape.border","shape.dash")}},invalidateCachedGeometry:function(){this.shapeModel=this.info=this.lineShapeModel=g},_80o:function(H,f,j){var l=this,h=l.shapeModel;if(h){var K=l.gv;hn(K,l.mat),_h(K,l.data,h,l,l.getBodyColor(),j),ur(K)}}});var ht=U.graph3d.PostProcessing=function(t){function o(){if(!d){var o=t.getGL();d=new dd.RenderTarget(t,o,null,null,{samples:x.renderTextureSamples||1,minFilter:o.LINEAR,magFilter:o.LINEAR}),i=new Dl.Shader(o,j.vs,j.fs),$=Dl.Buffer.createIndexBuffer(o,new Uint16Array([0,2,1,1,2,3])),g=Dl.Buffer.createVertexBuffer(o,new Float32Array([0,0,1,0,0,1,1,1]))}}var d,i,$,g,C=this,Y={},F=!1;!function(){z.keys(ht).forEach(function(B){Y[B]=new ht[B](t)})}(),C.getModule=function(v){return v?Y[v]:C},C.getModuleList=function(){return z.keys(Y)},C._serializable=!0,C.handleDataModleChange=function(n,Z){n&&(C._serializable&&n.setPostProcessingData(C.serialize()),n.removeSerializeListener(C.onDataModelSerialize,C)),Z&&(Z.addSerializeListener(C.onDataModelSerialize,C),C.deserialize(Z))},C.onDataModelSerialize=function(i){"serialize"===i.type?C._serializable&&(t.dm()._postProcessingData=C.serialize()):"deserialize"===i.type&&C.deserialize(t.dm())},C.isDeserializeDisabled=function(o){return!C._serializable||o.a("sceneBloom")!==s},C.isSerializable=function(){return C._serializable},C.setSerializable=function(K){C._serializable=K,K||t.dm().setPostProcessingData(s)},C.serialize=function(){var w,y,N,t,x={};for(y in Y)if(N=Y[y],t=N.serializeProperties){w={},N.enable&&(w.enable=!0);for(var r in t){var u=N[r];u!=t[r]&&(w[r]=u)}z.keys(w).length&&(x[y.toLowerCase()]=w)}return x},C.deserialize=function(X){var E,R,l,_,W,L={},k={};for(E in Y){l=Y[E],_=l.serializeProperties;var r={},M="scene"+E,h=X.a(M);h!==s&&(r.enable=h);for(var W in _)h=X.a(M+W[0].toUpperCase()+W.slice(1)),h!==s&&h!==_[W]&&(r[W]=h);Lg(r)||(k[E[0].toLowerCase()+E.slice(1)]=r)}if(Lg(k)&&(k=X.getPostProcessingData()),k)for(R in k)if(R&&(E=R[0].toUpperCase()+R.slice(1),l=Y[E])){L[E]=!0,_=k[R];var o=!!_.enable;C.enableModule(E,o),E="scene"+E,X.a(E,o),l.resetProperties&&l.resetProperties();for(W in _)if("enable"!==W){var h=_[W];l[W]=h,X.a(E+W[0].toUpperCase()+W.slice(1),h)}}for(E in Y)L[E]||(l=Y[E],l.enable=!1,l.resetProperties&&l.resetProperties())},C.getRenderTarget=function(){return d},C.blitScreen=function(S,l,P,d,K){var O=t.getGL();if(O){S&&(S.bind(O),t.setViewport(O,0,0,S.width,S.height)),K&&K.clear===!1||O.clear(O.COLOR_BUFFER_BIT|O.DEPTH_BUFFER_BIT),o(),P||(P=i),P.bind(),O.activeTexture(O.TEXTURE0+0),nm(O,l||O._emptyTexture);var b=P.uniforms;b.image=0;var B=1;if(d)for(var f in d){var C=d[f];C instanceof WebGLTexture&&(O.activeTexture(O.TEXTURE0+B),nm(O,C),C=B,B++),b[f]=C}if($.upload(),g.upload(),P.attributes.pos.pointer(g),O.drawElements(O.TRIANGLES,6,O.UNSIGNED_SHORT,0),B>1)for(;--B>=0;)O.activeTexture(O.TEXTURE0+B),nm(O,null);else nm(O,null);S&&S.unbind(O)}},C.decodeShader=function(O){var z,n,b,P="",V="";for(b=0;b<O.length;b++)z=O[b],"%"===z?z="'":"a"===z?z='"':"]"===z&&(z="\\"),n=String.fromCharCode(z.charCodeAt(0)-1),b%2?V+=n:P=n+P;return V+P},C.createShader=function(L,g,Z){var Q,S;if("string"==typeof g){var l=g.indexOf("^#");Q=C.decodeShader(g.substr(0,l)),S=C.decodeShader(g.substr(l+2))}else Q=g.vs,S=g.fs;if(Z){var D=Z(Q,S);D&&D.vs&&(Q=D.vs),D&&D.fs&&(S=D.fs)}return new Dl.Shader(L,Q,S)},C.enableModule=function(y,N){var g,b,X,z=y.split(",");for(g=0,b=z.length;b>g;g++)X=z[g].trim(),Y[X]&&(Y[X].enable=N);F=!1;for(X in Y)if(Y[X].enable){F=!0;break}F&&o()};var j=C.blitScreenShaderSrc={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};C.render=function(x,T,u,j){if(F){d.setSize(x,T,u),d.bind(x);var q=x.getParameter(x.COLOR_CLEAR_VALUE);q&&0===q[0]&&0===q[1]&&0===q[2]&&0===q[3]?q=null:Un(x,[0,0,0,0]),x.clear(x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT),t.setViewport(x,0,0,T,u),j=j||{};var a=j.renderAxis!==!1,y=j.renderEdit!==!1;j.renderAxis=j.renderEdit=!1,t.renderScene(j),d.unbind(x);for(var A=0,o=t._glCapabilities.maxAttributes;o>A;A++)x.disableVertexAttribArray(A);var h,v=d;for(h in Y)v=Y[h]._42(x,v)||v;t.setViewport(x,0,0,T,u),q&&Un(x,q);var P=C.getModule("Fxaa");return P&&P.enable?C.blitScreen(null,v.texture,P.getShader(x),{resolution:[1/T,1/u]}):C.blitScreen(null,v.texture),x.useProgram(t._prg),t._renderAxisAndEditHelper(a,y),!0}}},it=U.graph3d.PostProcessing.HueSaturation=function(u){function D(){O=!0;var y=u.getGL();A=new dd.RenderTarget(u,y),b=u._postProcessing.createShader(y,it.hueSaturationShader),S=Dl.Buffer.createIndexBuffer(y,new Uint16Array([0,2,1,1,2,3])),Z=Dl.Buffer.createVertexBuffer(y,new Float32Array([0,0,1,0,0,1,1,1]))}var S,Z,b,A,_=this,P=!1,O=!1,m=[],B=[],J=[];this.serializeProperties={hue:[0,0,0,0,0,0,0],saturation:[0,0,0,0,0,0,0],lightness:[0,0,0,0,0,0,0]},this.resetProperties=function(){var U=this.serializeProperties;for(var Y in U)this[Y]=U[Y]},this.resetProperties(),z.defineProperties(_,{enable:{get:function(){return P},set:function(s){!!P!=!!s&&(P=s,s&&!O&&D(),u.iv())}},hue:{get:function(){return m.map(function(R){return l(180*R)})},set:function(c){if(m!==c&&7===c.length){for(var g=0;7>g;g++)m[g]=c[g]/180;u.iv()}}},saturation:{get:function(){return B.map(function(_){return l(100*_)})},set:function(Z){if(B!==Z&&7===Z.length){for(var v=0;7>v;v++)B[v]=Z[v]/100;u.iv()}}},lightness:{get:function(){return J.map(function(_){return l(100*_)})},set:function(h){if(J!==h&&7===h.length){for(var L=0;7>L;L++)J[L]=h[L]/100;u.iv()}}}}),_._42=function(i,y){if(P){O||D();var f=y.width,r=y.height;if(f&&r){A.setSize(i,f,r),Qg(i,A.frame),u.setViewport(i,0,0,A.width,A.height),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),b.bind(),i.activeTexture(i.TEXTURE0+0),nm(i,y.texture);var e=b.uniforms;return e.image=0,e.hue=m,e.saturation=B,e.lightness=J,S.upload(),Z.upload(),b.attributes.pos.pointer(Z),i.drawElements(i.TRIANGLES,6,i.UNSIGNED_SHORT,0),nm(i,null),hc(i),A}}}};it.hueSaturationShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j*txj/psop!mipjdh!i-q*!mgtmip)bcuh<s3!mvtoij)g5pdsfnw!!t>b!nsqpmmfpsD3hEb!sjGn`bmhhf!<<!*w!bs*zfjhoohb!Swtftdf3o!uwiVhwj<m!-!^$1e]ftgtjfoofu!iNhBjYm`!S-B{O/HmFt!i8)t!t$feofugijhojfm!`SqBbOnH!F`-B*MfMh!o1bSo!pvjoujbgspvsunb!tg!m-p^b1u]!oipvjfu]bNsBvYu`bStB!O-HzF/^m<ti!)voopjjgupbssnv!ugbmtp`bqub!nt!bu-v*sfbhuojbpSof]vNiB!Y-`^S1B]OfHvFi^!<-y!/vmotjig)pfsvni!`gqmbpnb!u!)m4jdhfiwu!o>f!tmtt]iN!BY`~S!BO~H!F^<<lbf!sgcm!pb<u^!snfbuqo`vipvdf`)fgvmip]btut!fjoouWibhmjvmf!->!!gfmhpobbuS!titvffoBumimh-j!mg!mp<b^us!fiuvofvSpbdo`hffv*i!]|op!jgumbpsbvuu!bwtb!m>v!ff!h>o!bjSooWpbjmuvbfs!v,u!b)ti!vf<B^msmf!u,o!vipvdf`Sfbvoih]ff*v!i0!!>3!/f1h<obS!fjvgi!!)w|b!m*vffh!o=b!s1!/>1>*!!ssffuuovvspod!`wfbvmiv)f!!g,j!!2/|1!<*,!,fsmftufo!vjpgd!`)fwvbim!v<fF!H?O!B2S/`1Y*B!Ns!f=u!vssfou!owvbpmdv`ff!v.i!!2</11!<>!!sffmutofv!psdf`ufvvsio!!uwobjm)v!fs<pg!!~<!2g!m,p!bfuh!onbbsq!`>t!bfuhvosbbsu!jp<o1)!g>m!pfbhuo!bjso!W*b7m!v>f?-!!fghmopbbsu)!!tgbju!vs~b!uj~p!oB<mlmb-f!sgcm!pb<us!ftubouvvpsdb`ufjvpio!S>b!ofhhfo*b!s|!!|g!m*p6b/u1!!w,b!m*vsff!u>o!vjpodW`bfmvvif)!u+b!p)m2g/!1=!!,i!)t!bgujv!sb|u!j*p,o,Bsmfmu!o,v!ptdb`ufvvsib!u<jFpHoOSBbSo`hYfB*N<!=!!ssffuuvosvop!dd`mfbvniq!)<w1b!m>v!fs-f!u1o/v1p-d!`2f/v1i*!<uo!j~)!!sgpmgp!bu!<nfbhqo`bmSjthtifuooufithtj)mg!m-pfbhuo!bjSooWpbjmuvbfs-v!ugbmtp!b-uf!hmojbhSifuvoif!tutbBpmmmg-!!g<m1p!b>u!!fmhjohbisu!oufotjt!Sb<oehmfp*i!t|fs!igum`pfbvui!!wu!b>p!mmgj!hi<u1o/f7t!t+B!mym/!m,t!im!j>h!iiu!oufbtptmSgb!oh<f*<{z!yj/gs!p)mwp!d=)!m1t/i13*ch!ss!f>u!vmstoi!!j4odWfbwm!vf<!*+w!V)ww!!-,f!h2b/n1j*)<E3!ffsmvtufyf!us!f>u!vsspom!pjdo!W5bdmfvwf!!,|!!)*w)!o+j!b)n2!/e1j!p.w!!joW~b!mv<f**m*!<-t!!~-i!)g4mdpfbwu!!oisvvfu3fssh!c)~g!mp<b1u/!7g!20-!!ig!m>p!biu!!g~3!-!<g1m/p7b!u>!,i!vif!*!||!*!1j/g1!!)=i!vif)!!=g!j1!/1*~!!i<vbfu!m,f>E!d2!/01!<*h!!f.m!tsf)!!j,g!!1)/i5v!f>!!?i!!2/|1!*ft!mifv!f~!!.><!b2u/m1f<Ed!!g0m!p*bsu!!.s!fct)<!,!!j1g/!3)!)>7!/i1!!+|!!i*vyfb*N!d=!!>2>/!1h*)!!gsjf!tf!t>m!fg!2~!!,!<)bgu3m!f.E!dg!20*!!*+c!!7./!1h!)+!!>i!vif!<|!!f*mytbfN!dj!g>!>)!)s3)/!1g!j+!!iv<f***!o=j!N2d/!1,*!y!bsNfdt)!!>.!!g13/<3)!!f0m!tbfu!mjfgE!d)!);4!/*1o!j+N!di!v,f!*y!b=N!d3)/!10*!b!usmfftE!d>!!@g!26!/,1!!)=g!3m!!.>!!gt2!*!+<!o)j)N3d/!1.!!0y!b4N/d1!*>!!.b!uimvffE*d!!+u!b7p/m1g<!!|f!m*tofjN!ds!f?t!!y>b!Ngd2)<!g!js!fuv<s1o/!3s!f0t!<*o!j~Nd!!,w!fydb4N!di)t!m>3!smh!c)w<f*d*4c!!i-thm)*y!b|n!!-wsf)dy4b!ns!h>c!<ybN!dj!gu!b)pimtgm!/z<!*>*>c!!1-/h1)*o!j|n!!-ssh)co!j>n!!w>f!do4j)Nidt!mu/b{p*m<g!!~<!cf/mdt!f>!!|c!!ugbmppmbgu!!g<3h</d!!>j!gh!!)uibtpmm/g{!!=<!s1//d6!*>!!sg!3u!b>p!migt!m/<{1!/+1!!)>2!/m1!!u,b!pimtgm!/z<*1</1!!f>m!ttf!u!bgp3m!g>!!i<t1m//2{.!!,>!!iit!mu/bzp!m.g!!it|m!/*zd!!+4!diftwm)/m{t<i3c!hgsm!p4bduf!wg!2!>~!!3/<1c!h+s!!iotsmv/u{f!s.!!g~3!<<*!*s1h/c4/0s1!/>2!)i!v.f!3ys/hmct)ig!2--3!gg!3--2!gi)tcmh/sy3!f,v!i)!2>/!1c0/4c/h1s*!*<<*!ys/hmct/ih!!->3!gi!v-f23gs)hc";var jt=U.graph3d.PostProcessing.Bloom=function(P){function k(){var N=P.getGL();if(N)for(var F=P._postProcessing,j=0;J>j;j++)q[j]=F.createShader(N,jt._35Q,function(E,R){return{fs:R.replace(/DEFINE_VALUE/g,K[j]).replace("%OVERRIDE_ALPHA_DEFINE%",Z?"#define OVERRIDE_ALPHA":"")}})}function f(){var x=P.getWidth(),W=P.getHeight();if(x&&W){m=[x,W],H=!0;var y,O=P.getGL(),I=Math.round(m[0]/2),A=Math.round(m[1]/2);for(w=new dd.RenderTarget(P,O,I,A),y=0;J>y;y++)s.push(new dd.RenderTarget(P,O,I,A)),g.push(new dd.RenderTarget(P,O,I,A)),I=Math.round(I/2),A=Math.round(A/2);var V=P._postProcessing;X=V.createShader(O,jt._34Q),k(),p=V.createShader(O,jt._36Q,function(W,U){return{fs:U.replace(/NUM_MIPS/g,J)}}),i=V.createShader(O,jt.finalShader),u=Dl.Buffer.createIndexBuffer(O,new Uint16Array([0,2,1,1,2,3])),e=Dl.Buffer.createVertexBuffer(O,new Float32Array([0,0,1,0,0,1,1,1]))}}var V,_,W,Z,I,u,e,l,L=this,E=!1,H=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0,selective:!1},this.resetProperties=function(){var S=this.serializeProperties;for(var y in S)this[y]=S[y]},z.defineProperties(L,{enable:{get:function(){return E},set:function(O){!!E!=!!O&&(E=O,O&&!H&&f(),P.iv())}},strength:{get:function(){return V},set:function(J){V!==J&&(V=J,P.iv())}},threshold:{get:function(){return _},set:function(X){_!==X&&(_=X,P.iv())}},radius:{get:function(){return W},set:function(Q){W!==Q&&(W=Q,P.iv())}},overrideAlpha:{get:function(){return Z},set:function(J){!!Z!=!!J&&(Z=J,H&&k(),P.iv())}},selective:{get:function(){return I},set:function(U){!!I!=!!U&&(I=!!U,P.iv())}}}),this.resetProperties();var w,X,p,i,m=[256,256],s=[],g=[],J=5,K=[3,5,7,9,11],q=[];L._42=function(U,n){function o(O,M,N,x){Qg(U,M.frame),P.setViewport(U,0,0,M.width,M.height),x?x(U):U.clear(U.COLOR_BUFFER_BIT|U.DEPTH_BUFFER_BIT),r!==O&&O.bind();var t=0;for(var $ in N){var b=N[$];b instanceof WebGLTexture&&(U.activeTexture(U.TEXTURE0+t),nm(U,b),b=t,t++),O.uniforms[$]=b}for(r!==O&&(u.upload(),e.upload(),O.attributes.pos.pointer(e),r=O),U.drawElements(U.TRIANGLES,6,U.UNSIGNED_SHORT,0);t--;)U.activeTexture(U.TEXTURE0+t),nm(U,null);hc(U)}if(E&&(H||(f(),H))){var r;if(I){l||(l=new dd.RenderTarget(P,U)),l.setSize(U,n.width,n.height),l.bind(U);var b=U.getParameter(U.COLOR_CLEAR_VALUE);b&&0===b[0]&&0===b[1]&&0===b[2]&&1===b[3]?b=null:Un(U,[0,0,0,1]),U.clear(U.COLOR_BUFFER_BIT|U.DEPTH_BUFFER_BIT),P.setViewport(U,0,0,n.width,n.height),U._blooming=!0,P.syncRenderState(),P.renderScene({renderAxis:!1,renderGrid:!1,renderEdit:!1}),U._blooming=!1,b&&Un(U,b),l.unbind(U)}o(X,w,{smoothWidth:.01,luminosityThreshold:_,tDiffuse:I?l.texture:n.texture});var G,S=w,B=Math.round(m[0]/2),$=Math.round(m[1]/2);for(G=0;J>G;G++)o(q[G],s[G],{colorTexture:S.texture,direction:[1,0],texSize:[B,$]}),o(q[G],g[G],{colorTexture:s[G].texture,direction:[0,1],texSize:[B,$]}),B=Math.round(B/2),$=Math.round($/2),S=g[G];return o(p,s[0],{blurTexture1:g[0].texture,blurTexture2:g[1].texture,blurTexture3:g[2].texture,blurTexture4:g[3].texture,blurTexture5:g[4].texture,bloomStrength:V,bloomRadius:W,bloomTintColor:[1,1,1]}),o(i,n,{image:s[0].texture},function(z){ts.for(z).glState.blend.apply({enabled:!0,equation:z.FUNC_ADD,func:[z.SRC_ALPHA,z.ONE]})}),ts.for(U).glState.blend.apply({equation:U.FUNC_ADD,func:[U.SRC_ALPHA,U.ONE_MINUS_SRC_ALPHA,U.ONE,U.ONE_MINUS_SRC_ALPHA]}),n}}};jt._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",jt._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",jt._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",jt.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var kt=U.graph3d.PostProcessing.Dof=function(K){function x(){q=!0;var I=K.getGL();y=new dd.RenderTarget(K,I),f=K._postProcessing.createShader(I,kt._38Q),J=Dl.Buffer.createIndexBuffer(I,new Uint16Array([0,2,1,1,2,3])),c=Dl.Buffer.createVertexBuffer(I,new Float32Array([0,0,1,0,0,1,1,1]))}function Q(v,h,n,y){i=null;var N=v.getCanvas(),d=N.width,w=N.height;if(n=n||1024,d>n||w>n){var Y=n/Math.max(d,w);d=Math.round(d*Y),w=Math.round(w*Y),E||(E=gj()),N=p.resizeImage(N,d,w,E)}var U=K.getGL();if(b||(b=U.createTexture()),T=Re(U,N,b),V=h||.01,k=!0,K.iv(),y--){if(i)return;i=p.callLater(function(){Q(v,h,n,y)})}}var y,f,J,c,T,O,s,e,E,b,i,X=this,I=!1,q=!1,V=0,k=!1,a=fo.generateUUID();this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var $=this.serializeProperties;for(var f in $)this[f]=$[f]},z.defineProperties(X,{enable:{get:function(){return I},set:function(U){!!I!=!!U&&(I=U,U&&!q&&x(),U||(k=!1),K.iv())}},image:{get:function(){return O},set:function(X){O!==X&&(O=X,k=!1,T&&(K.deleteTexture(a),T=null),K.iv())}},maxblur:{get:function(){return s},set:function(M){s!==M&&(s=M,K.iv())}},aperture:{get:function(){return e},set:function(m){e!==m&&(e=m,K.iv())}}}),this.resetProperties(),X.setImageFromGraphView=function(p,$,D){this.image=null,Q(p,$,D,2)
},X._42=function(L,Q){function g(T,e,S,i){Qg(L,e.frame),K.setViewport(L,0,0,e.width,e.height),i?i(L):L.clear(L.COLOR_BUFFER_BIT|L.DEPTH_BUFFER_BIT),E!==T&&T.bind();var s=0;for(var Q in S){var v=S[Q];v instanceof WebGLTexture&&(L.activeTexture(L.TEXTURE0+s),nm(L,v),v=s,s++),T.uniforms[Q]=v}for(E!==T&&(J.upload(),c.upload(),T.attributes.pos.pointer(c),E=T),L.drawElements(L.TRIANGLES,6,L.UNSIGNED_SHORT,0);s--;)L.activeTexture(L.TEXTURE0+s),nm(L,null);hc(L)}if(I){q||x();var E;if(!T){var A=dg(this.image);if(!A||!A.comps&&!A.tagName)return Q;U.Default.setImage(a,A),T=K.getTexture(a)}var O=Q.width,W=Q.height;if(O&&W)return y.setSize(L,O,W),g(f,y,{tColor:Q.texture,tDepth:T,aspect:O/W,aperture:this.aperture,maxblur:this.maxblur,useG2d:k,threshold:V}),y}}};kt._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vcupypfmu!!v>t,f!Hm3ped<<v*o!j5gspvsmnc!ggpmep!b+u!!*u!iusdfftsisppmdeu<dfvqotjbg!p+s!n*!!g:m3p/b1u.!!n-b:y3c/m1v.s!<)3vdofjwg!p)s!n,!!gzmyp/bwuV!wb!q-fsspumvpsDfu<!)vEo3jfgspvsuny!fgum!p>b,u!!mopfdbs<D*m!j5qs<vmvcogjpgep!s+n!!*g!mupdbfus!sgpbdsuDdmfjqqt<b!v+o!j*g!p1s/n1!!g-m5p/b1u.!!g)p3ddvftw<!)v!o,j!gzpys/nw!Vgwm!p-bsup!mbptDquf!d)uE<3fdspvoutyuf!ug!m>p,b!um!pVdoq<b*d!l5Espvxmoctgdpbem!f+!!>*!!3u6d6f/s!s0p!d3u6d7f/q<t!b0!0+!!1*/!/:23!/.1?!!-g:s3b/d1u.j!p)o3!d)ffwy!d)m!v,e!jzoyh/!w2V*w!d-psoptmup!Dwuf!d)4E!3QfbsdvluGybfduu!p>s,t!!m>p!dwf<d*4!)5!s3v6m7c/g!p+e!!3+6!7*/!!u+d!f3s6s7p/d-u!d3f6q7t/b!!++!!3*6!75//-1!.3!6-71//!1*!<)3ddpfowt!u)!!w,f!dz5y!/VwoVqwb!d-lsGpbmdpuDpus!t)!E>3!fVsovqubydfluE!p>x,o!tmdpbdmf<!*0!!5wsfvdm5c)g!pQeb!d+l!G*b!duudpfssts-p!d2u/d!f*q<tbg!m+p!b*u!!:v3o/q1b.d!l-S:H3C/B1U!p)E3fdqfuwi!))!!d,p!oztyu/!wjVow!!w-fsdp5m!pwD!u*!!)|E3!fssfvuuvysfou!!e>p,u!)m!pwd-!<V*o!q5bsdvlmGcbgdpuep!s+t!!**!<ud~fsgsmppdbuud!fhqftubE!f+q!u*i!)1!/d1p!o-t5u/!1j!o)!3wdffdw3!!)t!d,s!fzfyo/QwpVtwj!u-jsppom!p*D!u|!)\nEs3ffusvvsuoy!fvuo!q>b,d!lmSpHdCB<U*p!E5fsqvumic)g!puef!y+u!v*s!fu3dEf)s!supEdfuqdufiq-t!bt!d+s!f*f!o:Q3p/t1j!u-j:p3o/!1*!!)*3<df~w!g)m!p,b!uz!yq/fwsVtwq!f-dsupjmwpfDEuf!q)uEi3UfpsWvjufyxf[u)!!>d,p!omtpud!j<o*!!g8mspvbmuc!gjpoew!D+m!j*q![u-d!fdspsoptduu!djfoq!tgbm!p+b!u*!!o5f/b1s!--!1d/p1o!t)u3!djfow!!g)m!p,b!uz!yg/bwsV!w*!!-|sp!mspfDuuv!s)oE!3)f!sovfubysf!u+!!>g,b!sm!p*d!0<!*)!!8)s!vgmbcsg!p.e!!o+f!b*s!!u*d!f+s!sjpodwuDdmfjqqt[b!!.+!!g*b!s:!3*/<1.~!-g:m3p/b1u.!!h)f3udWfjwf!x)[!),!!dzpyo/twuV!wj!o-!sgpmmppbDuu!!e)fEq3ufis!v*u!y|fu\n!s>f,u!vmspod!q<f*s!t8qsfvdmucjgwpfeE!f+q!u*i!UupdWfjsfsxp[d)u!deffqqtubi!-+!!o*f!b1s/D1m!j-q5-/!1g.b!s)D3mdjfqw!!*)<!,~!zwyp/jweV!wn!b-jsop)m*p!D|u!w)fEd33f!sevpugycfmuv!s><,!wmfpdd3!<b*t!q8fsdvumdcpgspsef!d+u!!*>!!uwdffds3s)p!d2u/d1f-q!tbbt!q+f!d*u!!:*3</1j!g-!:)3v/t1f.E!f)q3udif*w!!|)!!,g!mzpyb/uw!Vwwj!f-xs[p!m>p!Dhuf!u)WEj3ffxs[v)u!yhffuu!E>f,q!umip)d!w<V*w!!8*s!v*m<cg!pgem!p+b!u*!!gubddfuspssp!d>u!d)f!qgtpbd!v+t!!*,!!5w/j1f.x![-!1*/<1!!)e3pdgfcwm!v)s!!,>!!zwyf/dw3V!w)!!-dsmpbmnpqD)u!!g)bEd3ufpssv!u+y!fbuq!f>s,u!vmspfd-!<.*n!b8yscvmmvcsg-p!en!b+y!c*m!vusd!f*s!s*p<du~dffqmttbf!!+|!*w!f:d35/!1u.f!y-f:m3!/>1!!u)f3ydufvws!f)3!E,)!!zuyE/fwqVuwi!--!swpfmdp3D)uw!V)wE/3yf-s!v2u/y1f!u.!!>w,V!wm/pzd*!<**<!8gsmvpmbcug!pbem!q+i!b*<!ujdgf!s)svptdfuHd3feq*t!b|!+b!m*q!i1b/!1>!!-t1n5p/p1u!i)t3udffqw)!!)u!i,s!fztyi/pwmVew-!!-usipsmfptDiup!m)eE!3,f!s1v/u1y2f-u!!u>f,y!fmmp/db!<**<!8~s!vfmmctgfp!e|!!+b!m*q!iubd!f>s!supfdyufdmf/qbt<b!!~+!!*e!p:g3c/m1v!s-!:>3!/w1f!d)33!d)f!wd!m)b!n,q!)z!yb/mwqViwb!!-+s!pbmqpfDsuu!v)sEf3-f!s.vnubyyfcum!v>s,-!!mnpbdyc<m*v!s:!s*v!m*c<gp~e!w+f!d*3!!uedpfgscsmpvdsu:d!f>q!tebp!g+c!m*v!s8!4+/!11./!:-<62w/f1d!3)!3edpfgwc!m)v!s,8!!z>y!/ewpVgwc!m-vssp!m+p!D1u/!8)<E3wffsdv3u!yefpug!c>m,v!sm5p!d>!<e*p!g:csmvvmsc!g+p!e1!/+5!<*!wufddf5s!sdppdmu!d>f!qwtfbd!5+)!!*1!/612!/*1<.!d-p8m4!/,1>.!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!16/25/!1*!!-+8!4b/t1q!f)d3uddfpws!s)f!d,u!!z*y!/+w!Vewp!g-csmpvmsp!D*u<!)dEp3mf!s,v>u!yuffuy!u>v,s!fm3pEd)!<u*D!p:mspvsm-c!gwpVew!/+y!z*!!,u!d)f!swsfpdd3u)d!f1q/t2b6!-+!!1*/!4884!/*1!!+-!6b2t/q1f.d!u)d3pdsfswf!d)u!!,*!!z+y!/ewpVgwc!m-vssp!m*p<Dud!p)mE!3,f>s!vuufyyfuuv!s>f,3!Em)p!duD<p*m!p:ss-v!mwcVgwp/ey!z+!!,*!!)u!dwffsds3p)d!u1d/f3q:t-b!!1+/!3*:!!8*4!/+1!.b!t-q6f2d/u1d.p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!6+2!/b1t.q!f-d8u4d/p1s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b6t2q/f1d!u-d8p4s/s1f.d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/:yszv!m,c!g)p!ew!f+d!3*)!!u1d/f4s8s-p!d.u1d/f2q6t!b*!!++!!*b!t8q4f/d1u!d-p6s2s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d1f/s3s:p-d!u.d1f/q3t:b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d.f1s/s2p6d-u!d.f1q/t4b8!!+*!!*+!!:b3t/q1f.d!u-d:p3s/s1f.d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d1f/s1s-p!d.u1d/f5q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!s,v!m)c!gwpfed!3+)!!*.!1u/d2f6s-s!p1d/u4d8f!q*t!b+!!+b!t*q!f1d/u1d!p-s5s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!yszv!m,c!g)p!ew!f+d!3*)!!u.d1f/s3s:p-d!u1d/f3q:t!b*!!++!!*b!t6q2f/d1u!d-p8s4s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfs";var lt=U.graph3d.PostProcessing.Blur=function(s){function r(){W=!0;var _=s.getGL();X=new dd.RenderTarget(s,_),k=s._postProcessing.createShader(_,lt.hBlurShader),l=s._postProcessing.createShader(_,lt.vBlurShader)}var k,l,X,j,a,C,D,x,u,U=this,m=!1,W=!1;this.serializeProperties={value:0,downSample:!1,iterations:1,layer:"main"},this.resetProperties=function(){var R=this.serializeProperties;for(var V in R)this[V]=R[V]},z.defineProperties(U,{enable:{get:function(){return m},set:function(q){!!m!=!!q&&(m=q,q?s.addRenderLayerListener(H,this):s.removeRenderLayerListener(H,this),q&&!W&&r(),s.iv())}},downSample:{get:function(){return D},set:function(G){D!==G&&(D=G,s.iv)}},value:{get:function(){return C},set:function(p){C!==p&&(C=p,s.iv())}},iterations:{get:function(){return x},set:function(J){x!==J&&(x=J,s.iv())}},layer:{get:function(){return u},set:function(z){u!==z&&(u=z,s.iv())}}}),this.resetProperties();var H=function(L){if(m&&L.layer===u&&"post"===L.phase){var $=s.getGL();if(!s._picking&&!s.isReflecting($)){var v=s._postProcessing.getRenderTarget();v.unbind($);for(var H=0,o=s._glCapabilities.maxAttributes;o>H;H++)$.disableVertexAttribArray(H);U.drawImpl($,v),v.bind($),$.useProgram(s._prg)}}};U._42=function(){},U.drawImpl=function(c,O,q,M,Y){W||r();var p,G;if(O?(p=O.width,G=O.height):(p=s._viewport[2],G=s._viewport[3]),p&&G){var _=s._postProcessing;"boolean"!=typeof M&&(M=D),q==g&&(q=C),Y==g&&(Y=x),Y=Math.max(1,Math.round(Y));var y=ts.for(c).glState.depth,S=y.enabled;if(y.enabled=!1,M){q/=2;var N=[p,G];p/=2,G/=2,j||(j=new dd.RenderTarget(s,c),a=_.createShader(c,lt.downSampleShader)),j.setSize(c,p,G),_.blitScreen(j,O.texture,a,{texelSize:[1/N[0],1/N[1]]}),O.setSize(c,p,G)}else j&&j.setSize(0,0);X.setSize(c,p,G);for(var B=[],n=0;Y>n;n++)B.push(q),q=Math.max(1,Math.floor(q/2));for(var n=0;Y>n;n++){var v=B[Y-n-1],R=M&&0===n?j.texture:O.texture;_.blitScreen(X,R,k,{value:v/p}),M&&n===Y-1&&O.setSize(c,N[0],N[1]),_.blitScreen(O,X.texture,l,{value:v/G})}return y.enabled=S,O}}};lt.hBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sz3/Ew!Vjwn!b-hffv<mb!ww!b+s!z1j/o5h!!,w!fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!zt/vwnV!w>!!-wffvdm5b)w!!1+/!11!/*4<!,!!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!!.<!655/313!2+/!1w!b+m!v*f!-*!!wzV/ww/Vzw!!*-!f*v!m+b!w1!/+1!612/<3!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!4</214!6+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*f!v+m!b1w/!1+:!219/<2!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!3</414!7+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!!*.!!z2//w1V!w+!!-wfbvm",lt.vBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sf3vEm!bjwn!b+h!f1</5!!w,b!szz/jwoVhw!!w-fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!ftvvmnb!w>!!+w!f1d/54)!!,1!/z1/!w*V<w!-!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!-!<w6V5w3/3z2!/.1!!5+/!1*!!+*!!wfbvmmvbfw!!*+!!*1!/+3!!1,/!1z6/2w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w2/4z6!2./!14!/+1!!*+!!*w!bfmvvmfb!w*!!+*!!1+/!21!/,1!:z2/9w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w4/4z7!2./!13!/+1!!*+!!*w!bzm/vwfV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!-*!!wfVvwm/bzw!!.+!!21/",lt.downSampleShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j1t/j5p!o0!!i*j*h*i1q/!2g!m-p1b/u1<)3!dvfowj!g+p!sfn{!jtTbmnfqymffus!3,E!!wjVnwb!h-ff<hb!nwjb)sEz3jfoshv!uwyffdu3!!w,V!w*<*1!/v2o.j!g-p1s/n1!)w3fddf3w!!u+f!yff{mjTTjm{ffy<fu!!,w!pwjVew!!n-bfjhob)n*j)!E|3f!shvmu`yGfsub!hD,p!m*p*s1!/>1!!)-u1f/y2u.v)s3fd3fEw)!j+n!bfh{fj-T!mwfVywf!u,!!,u!fwyVfwm!T-jf{hfb!n+j!)wEf3df3s)v2u/y1f-u!!1/,1!**";var mt=U.graph3d.PostProcessing.Glitch=function(r){function B(){if(t&&m){k=Date.now(),W=0,Q=1e3*N(m[0],m[1]),d=[];for(var $=1,c=t.length;c>$;$+=2)d.push(($>1?d[d.length-1]:0)+Q*t[$]/b)}}function H(){r.redraw()}function E(){j=!0;var q=r.getGL();_=new dd.RenderTarget(r,q),U=r._postProcessing.createShader(q,mt.Shader);for(var H=K*K,i=Wb(K,K),x=i.getImageData(0,0,K,K),D=x.data,v=0;H>v;v++)D[3*v+0]=f(256),D[3*v+1]=f(256),D[3*v+2]=f(256),D[3*v+3]=f(256);i.putImageData(x,0,0),F=Re(q,tk)}var _,U,Q,k,W,d,F,i,m,t,l=this,R=!1,j=!1,N=fo.randomFloat,f=fo.randomInt,b=0,K=64;this.serializeProperties={onlyReflector:!1,period:[2,3],intensity:[3,.3,1,.1,0,.4]},this.resetProperties=function(){var Q=this.serializeProperties;for(var p in Q)this[p]=Q[p]},z.defineProperties(l,{enable:{get:function(){return R},set:function(k){!!R!=!!k&&(R=k,k&&(B(),j||E()),r.iv())}},onlyReflector:{get:function(){return i},set:function(n){!!i!=!!n&&(i=n,r.iv())}},period:{get:function(){return m},set:function(z){m=z,B(),r.iv()}},intensity:{get:function(){return t},set:function(u){u||(u=[1,1]),t=u,b=0;for(var U=1,m=u.length;m>U;U+=2)b+=u[U];B(),r.iv()}}}),this.resetProperties(),l._42=function(K,G){if(R){j||E();var e=!!r.isReflecting(K);if(e===!!i){var T=G.width,w=G.height;if(T&&w){var p=r._postProcessing,$=ts.for(K).glState.depth,h=$.enabled;$.enabled=!1,_.setSize(K,T,w);var A,C=Date.now();C-k>d[W]&&(W++,W>=d.length&&B()),A=t[2*W];var c={seed:Math.random(),byp:A?0:1,tDisp:F};return A&&(c.angle=N(-Math.PI,Math.PI),c.distortion_x=N(0,1),c.distortion_y=N(0,1),c.amount=Math.random()/30*A,c.seed_x=N(-1,1)*A,c.seed_y=N(-1,1)*A),p.blitScreen(_,G.texture,U,c),$.enabled=h,requestAnimationFrame(H),_}}}}};mt.Shader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd~j!tj<p*ow!Viwj!h-ifqh!bgnmjp)b!uE<3f!svvoujygfpus>ns!pjmopuD!hcbzsqG<`m!hv!oj|g!pfstnm!ft!bn~q!mf<sx3pEo!tj!n,bshpfm<pD!hvbosjGg`pmshn!!>t!bsnpqmmpfDsh3bEs!Gu`Emjht!q<<*3!/v1o+j*g*p/s1n6!+gemfpfbtu!!+b!ntpzv-oeuf<ft!!v+o!jtgyp)s3nd!fgwm)peboub!sb)o5hdmffw<+u!ovvopjngbp+s/n1!1g3m!p>b!ux!ptoftf!e5<df!wv!ojfgtpjspno!!gemepbb0u0!!tf<f*eb`/yb<hd!!v-ocj/gcpds!n-!hg/mbphbdu!!-tsf/fsed`)z5<df!wv!o>j!gsppsmnp!DghmbpsbGu`!mehj!tu<p*suufjtpgog`py!<.!!qv!o-jfghpbsnnj!)gEm3pfbsuv!ueyjftuu!p>s!ucjdp!o5`dzf<w!!v<o*jqg!p-sfnh!bgnmjp)bEu3!fdspvmu`ytf<u!>!!wbbhsdz!j5odhf!ww!fd<3*!uwfVtwg<gp!!,d!pqo!t-uf!hgbmnpjb)uE!3VfosqvbudylfEup!x>o!tsddb!m5fd!f>w!!36<6*/*!f0m!h3o6b7)/o<jt!!d-p*oftmuh!owbf)dt4p!dQ)b3ddlfGwb!d+u!pusotv!p>n!bw!f>d!4u)f!t3g6g7p/!!3+d!f3w6!7/s!f+e!b3i6t7!/u-g!j3i6t7!/C!H+S!!3n6p7s/g-!!f3t6b7c/0!0*!<<!*d/p6o0teuf!fwtf)d+5z!`Veofqfbtd+lmGbbndsuppos>t,!z>/!qV!oq<b*d/l6E0pexfofttd)b+myf`!e0f!fwtf+dm5b)n!sQpbod>l,Gyb/dqu!ps~t!-!~2!/!<**<y`!ogpmjpubsup!uvtojqeb!d,l!SyH/CqB)U!p.E!f/q2u!i>)!!yd/pqo!tu|!!jfot!mwff!d5~!!w!<*y!`|op!jsufsupvustoj!ee>pyu/)q!!w-|!*V/o1q?bzd`leGfbfdtu)pgsjt!!*|<!*!e~fft!+gtm`pmbpud!.szb`ooep)jwufsdp3u!tdjpe*?|y/!qs!f%u%v!sto`!mgpsdb,dzu`)otpjjou)seppuut)jdep=/yy/zq!)-gwjf!d3~)!23~/!:9<:z9`-o8p9j/u3s4p4u*t*j*e!!+>!!5z4/8q6!9/|6!5f6t4m*f<!!~~!<!*wzp`joep!jnubsjpou)t*j!e|!,!!jzg/)qc)z!q.=!2/*2!!|>!!zw/fqd!3!|q*!/>1!?wyV`we<ff!tg)mgpjb!u!|y!t*!e>f!fgtm+ptp`sm)phdm.`yG`sobphjDupsppsuet/jye!?0z!/1q/!6%*%<!t!`gmmppdb,uy!`zotp!j>u!sgpmuptpjse)=hzm/`qG)sgbjh!Dp<p*s*ee/fzf!t0+!e1f/f6t*+<q!!-gqmtpjbEuu!)o!pEs3nfbsmv!u>y!fvuo)qibudqlfSEHpCUB";var nt=U.graph3d.PostProcessing.Fxaa=function(O){var c,n=this,N=!1;z.defineProperties(n,{enable:{get:function(){return N},set:function(H){!!N!=!!H&&(N=H,O.iv())}}}),n.getShader=function(f){if(c)return c;var m=O.getPostProcessingModule();return c=m.createShader(f,{vs:m.blitScreenShaderSrc.vs,fs:m.decodeShader(nt.ShaderSourceFs)})},n._42=function(){}};nt.ShaderSourceFs="~!!q<sbf/d*jwtVjwp!o-!fihjbhnijq)!Eg3mfpsbvuu<yf!uv>obj/gsppsmnp!DthbbnsqGm`fmsh3!E!<j*n!bh*f1</1!)v5odjfgwp!sn-!1w/f1d!3!-s1f/t1p!mv-u1j/p1o!<-!4w4b9s1z/j1o!h!-w7f7d23/!1w!Vw-<68/!1$!ef-g*j1o/f1!)G5YdBfBw`!RV-B*M1J/U1Z)`5Qd1f!w2!/1-*!1$/e1f)g5jdoffw!!GY-BoBp`jRuVvBmMpJtUfZs`!Q2-!f2h/b6nj!!$e-ffghjbonfj!!GY-BfBh`bRnVjB!MJ-U*Z1`/Q13)!53d/f1w!!$-ewfVgwj!of)!sGfYeBbBi`TRmVfByMjJQUbZb`yQG4>!s5p/m1pD!h$besfGg`jmohf!!G|Y!B*B)`oRjVbBnM!JeUjZp`wQ!5!~2!3/<1*N!b$nevfmg!j-o{fz!yG/y*bNbtCppqp!m-!ycfpup)mqpU!y$feUfbgbjyoGf)!5GuybbpbmGGmbpbbyuG!!gomspvbuufs!!$e<foghjjoTfi!uGhyobfbmG!m+p!byuj3q!cwvfTdu3ft!g$gePfmgfjyojfq!>G,yzb/bNGtmppqb!u*4o!bwqfTd{4sp!i$!e)fggjj!of<!oGhyjbTbiGumhpobfum5!!+w!fydj5qcv!T$uefftggjgoPfm!fGyyjbqb>T,byu/)Nyt*p!qd!m*bonbqq)Ty{-s!p1i/a1)-g!j2!/1<**I!y$jeqfcgvjto!f-!eGpypbHbuUfftyg!gtPbmnfqymjfqs)3yEbn!>$yejfqgcjvoTfu!fGtygbgbPUmffyyUjpqq!)uub-p!mqG*b!buyfGy!uv<s1f/31E!);u!-u!fqt-g!g1P/m1f*yj!q$!e@f!gojboqfT!eGpypbhb>UefpypPHgugf)tug-g!Pqm-f!ypj-q!!su*b!pumfGybubvysGf!3E<)yuj-q!cqv,T)zpu!j+m!bsv*R-b!b1y/g1!*+!!HGyyjbqbcGvmtp>bIuy!jGqycbvbtM!vunbbp)mGGybbbbyGGm!pb<u65/!1s,h*c*bq*d!S|i!ushfoufvMsoob!qsth.c)b!/+z!<u!t~e)!>GuyfbtbgGgmPpmbfuy5j!qG!yubbbpQmjGybfbmyTGi!be<fGsy)jq!cGvytb!b+G!mGpybjuq3c!vqtp>tH-yj!qGcyvbtb!GumbppbmuG5b!bgyyGb!bD<pQootbpqmTfeQpppthQ!p;t!-Oo!bGqyTbebpUpfhy!!@u!fOyo-pj!uGdyfbsbjUef>yo!bgqyTbebpDppho!tmppmpfC4b7b1yUGf!yF<y*qQCujtbet!O-fOhuPtoef)-oj!nG>yubtbeU!fuyb!pgmyGbbbbDypGo!tp<mQfu4t7e1!U=f!yOFuytqeC>jObotpOjfuhdUfxspj-e!!mGpypbCbbGbmypGb!u3<!iguyhbobfRMvobbmqjtu0z1S/d2q>GqsdbSnifu-ho!fGMyobbbqGtm!pubbup5m!GgbybbybGD!po<tppsmff[SUdMqNGbsnbvnmf!P>qau!-*1!/G1y!b=b!GQmepobFub5n!vgmy)b>bQDopboqtTpempfpShd!qmGpspbCnbfbPyqGu!3-<*!OGuytbeb,GQmuptbeu)5>!iguyhbobfDMpoobtqptm!fu4b7p1mSGdbqbGysGb!nf<Ppqsuf3[-UM!NGbynbvbmG!m>pab!u*!1g/y1b!b=R!vObemojFubznTvvmc)q>jOyo-bq!TGeypbpbhG!mmppbpuC!bgbyybGb!Rv<bzm/jNutzpFqe.hzf/UQitspfqt>iQpumtee-!*!oGbyqbTb{Gsmppibau)!ggjy!bb<Rzv/bOmtjpuqz.Fze/hNftUpiqs>fOtuitpem!e*Nojboq-T{!sGpyibab)Ggmjp!bu<!yg/yNbtbpDqp.oyt/pQmtfpFqe>hQfuTtieb!suqbopfmtGtb-by!GG!yb<byG/mOptbpuq!.gyy/bNbtDppqo>tOpumtfeF!euhbfpUmiGsbfbtyiGp!me~-!!~G!yb~b!Gm<p5bQu`!ZgUyJbMbBDVpRo`tBpBmYfGF!e+h!fzU/iQsOfgtgipp>m,ezN/jQot-pq!!G*yQbfboGpmepab)ug5j!!gy<b5bQD`pZoUtJpMmBfV4R7`1BDBpYoGt!u+E!jys/Q!O*g!g|p>!,Gyy/bQbtGpmqp!b*uQ3f!oqppetaN)<gj!!qp<t*NQ/fyo>pqepat)/!y}<}!!*qOpftoNp/eza>)q>pQtO/fzo<pe!!Gy<b5bQG`mZpUbJuM5B!VsRh`cBzBNY>GG!y+b!bzU/fQyOUgpgqp)>u.fzy/-O!tqppqt!N**O<fo!p$eeaf)ggjjo!f!<m5vQn`bZNU!JsMhBcVzRN`/BzBY!GG!y+b!byG/mQpObgug!pm>v.nyb/TO>tGpyqb!b*MOvfnobp)eGay)bgbjU!fy<Pegfgm)budfTyu-o!fqjpetbNs-h!!G>y?b!b*GQmepobFub3n)v!m1)/t1c-b!>2Q/f1o*p-e!!gy<bebfRmvbbdmTjuuozfSjdeqbGsshb!n>f?/!y*zO*e*o<Fb!nGvymb)btGcmbp>bOuf!ompven!bF<>6G/y1b!b+M!vOnObb)nGvymb.bQUefoyFPbgngv)mu>fQye-o!FqbpntvNm-!!*GQyfbobpGemap)bguj3!)!<26//11-!!+1!/O1O*b-n!vgmy.bObeRovFbbmnjvumz>SOdeqoGFsbbnnvfm/!y*zO*f*o<pe!aG)ygbjb!Gm<p*b*uz!ym/vQntbpOq>!G-yybfbuM)vqnpbU)yGfyUbbbbUyfGy)Pbgngv)Mubfbyy-G!>qQpetoNF-b!nGvymb!b*GQmfpobpue3a))!g1j/!1-<.*2*/z1y*/-O!tgpyqb!b-Ryvfbum)jqupzUSydfqUGbsbbynGf)/bynzv*M*b<by!GG>yObeboGFmbpnbvum!!m*vOnfboXp>eGay)bgbjM!vn|b!)*GQyObfboUpfey)Pggjg!)u<f4yQ-`!ZqUpJtMNB-V!RG`yBbBbYGGm!p+b!uz3/)Q.O2g/g1p->!,1z//1Q*t-p!qg!y*bQbfRovpbemaj)ugzjS!dq<G4sQb`nZfU/JyMzB*V*R<`B!BGYyGb!b+G!myp/bQuO!gngbpy>T,Ny>/nQbtyp)qm!v*nQbfTo-p!emav)ngbjN!*<<*!QGfyobpbeGam)p!b}u}!!n*jOofToNp>enaj)o>)QmOvfnobpTe-!!m<v4nQb`NZ*U<JM!BGVyRb`bBGBmYpGb!u+!!nzb/yQFOTgNg>pn>b.yz)/mOvtnpbqF!-*!OnfboypTeNa*)<gj!!Gy<b4bQG`mZpUbJuM!BnVjRo`FBTBNY>Gn!j+o!)ym/vQnObgFg-p!>n.jyo/TONt*p<q!!*GOyfbobpGemap)bguj!!nb<yeXfOm>bndbTyu)omfvjnebbOs-h!!m>v?n!b*XQ*e<oF!bGnyvbmb)Gtmcpbb>uQ!fnojpoeX!O><nejfom)bmdvTnuboOf-j!embvsnhb!X>*?<!*!OGeyobFbbGnmvpmb)ut!csbb>oOhffoNpbey!>n<b6y/)1n!b+y!XOOO-b!nnvbmy.FQTeNo*F<bn!vGmy>bQbeGomFpbbnuv!ms!b*oQhffoNpjeoa>)ngjjo!)n<j6o/X1O!-+!!nOjOobFnTvNm*.<Oe!oGFybbnbvGmm>pObeuo!Fsbbnovhmf!N*bOyfTodpbemaf)eg>js!bo<h*f*Nzbyy/!Q+t!pgqy!b-byRfvub)mqjpuUzyFfeUhbfbUyiGs)fbtnivpMmbeb<yG!>GQyebobFGbmnpvbmu!!*sQbfoohpfe>as)bgojh!fN<b*y*.zsyb/oOhtfpNqj!o-<yf!uG)yqbpbUGymfpUbbub!ysGb)obhnfvNMbbybDymGb>nOqefoeF>bnnbvym)!g*yObfboRpvebam)jgujz!Fe|h!f*UQiOsffotpiep)mgejN!jo<-3!Qs`bZoUhJfMNBbVyRT`dBbBmYfGe!*+<!z!/GQyObgbgCpp>p,mz!/fQbtspmqz!F*yQjfuo>psebao)hgfj!!=!<s3bQo`hZfUNJbMyBDVmRb`nBqBfYeG<!+!!jyg/)QfObgsgmpz>F,yyj/uQ*tp!qs!f*uQvfsoop!esah)cgzjN!<<!*GQyfbobpGemap)b!u}!}m!v*nObfOoXp>eGay)b>bQMOvfnobp)eG!yb<b3UQf`yZPUgJgM)BuVfRy`-B!BqYpGt!N+-!!zG/yQbObgGgmpp>b.uz3/)O.t2p/q1!-*.O2f/o1p*e-a!)ggyjb!bR<v3bQm`jZuUzJSMdBqVGRs`bBnBfY/Gy!z+*!*y</Q!OGgygbpb>G.myp/bOut!pmqv!n*bOTfFo>pGeyab)bgMjv!nb<)eGfymbbbdUTfuyoPfgjge)busfhy!->!?q!p*tQNe-o!FGbynbvbmG)mtpcbbu>3Q)f!o2p/e1!-!<2e/f1m*b-d!TguyobfbjRevbbsmhj!u>z?S!d*qOGesobFnbfn/vymz)*t*c<b>!OGfyobpbeG!mp<b6u/!1m!v+n!bOOOFb>nGvymb.bQMevonFbb)nGvymb>bQUefoyFPbgngv)mu!f*yQ-f!oqppetaN)-g!jG!yb<b6G/m1p!b+u!3O)O!b2n/v1m-..O2e/o1F*b-n!vgmy>bObeRovFbbmnjvumz!S*dOqfGospbenaf)/gyjz!**<<**!zGyy/bQbtGpmqp!b-uy!fmuv)nqbpTUXy>fGUybbbbyMGv)nbbn)vGMybbbbyUGf>yQPegogF)bunfvym-!!*qQpftoNp-e!aG)ygbjb!Gm<p*b*uz3y)/.O2t/p1q-!!-2y/f1u*)-q!pgUyybfbURbvbbymGj)ubznSvdMqbGbsybGn>fO/eyozF*b*n<vm!!G*yObfboGpmepab)ug!jm!vn|b!O*TQ>OmfvonpbeO),gmjv!nb<T2<Q`!ZGUyJbMbBGVmRp`bBuB!YmGv!n+b!XzF/>QmOvgngbpX>,,mzv/nQbtFp<q!!*GQyfbobpGemap)bguj!!tv<c2qQj`yZSUdJqMSBbVoRh`fB>B2Y/G1!0+s!byo/hQfO<gg!pG>y,byb/GQmtppbqu!!*tQvfcoqpjeyaO)TgXjF!>m<v*nQbfOoTp,emav)n!b}X}F!<*O!fGoypbebaG)m>pQbOuf!ofpeeh!fmIpppsC{b2b>y)G.!3/<12!Q+`!ZmUvJnMbBNV*R,`mBvBnYbGO!T+<!z!/GQyObgbgGpm>p.bzu/!Oftephqf!W*fOsfuo2p>e)a.)3g/j1!!+<!2mQv`nZbUNJ*M,BmVvRn`bBXBFY<G!!+G!yyb/bQGOmgpgbpu>!.myv/nObtOpFqT!F*>OmfvonpbeOaF),gmjv!nb<TeFf<mb!dGTyubobfGjmepbbsuh!!m>v?n!b*OQXeOoFF>bmnvvnmb)OtXc,bm>vQnfboOpFe<!m!pGpyCbbbbGymGp!bu<!effemhbfdITpuso{f3j>e)b.s3h/!1>!?+!!*mOvenobFFb*n,vmmv)ntbcObF>TOFf<op!eG!ymbpbpGCmbpbbyuG!!fe<h6f/W1f!s+u!3O>O)b.n3v/m1>!.+Q!emovFnbbnOv*m,!mv<n6b/O1X!O+F!<OO!bGnyvbmb>G.mOpebouF!bmnvvnmb!OX<T1X/>1m!v=n!bNONXb,nmvvmn>bpTsXf<[U!MGNybbnbvGmm!pmbpup!CmbvbnybGT!XT<FF>ymjvqncbvTtX!,+m!vEnybjTqFc<vt!>GGyybjbqGcmvptb!uu!bfpemhGfbIbpysG{!5><)6b/c1t!)+f!eOhOfbInpvsm{.2N*b!n+v!m3>/N1N*b,nbvcmt!)ufbephmfGIbpbsy{G3!*<<1!/G5y0b1b/G2m!p+b!uu!offejhefbWsfhs>ue5f>m)bbdcTtu)offejhefbWsfhs!uu2b*p!m+G!b3b/y1G*!,b<cTtT)bfnevhmf>WOfOsbun3v*m<!*!OGsyjbbbqGam)pgbju!!f<e*h*fQItppsq{!4->y)f.u3)/q1p!U+y!fmUvbnbbyXG*),bmnvvnMbbObXyTGX><Qe!oGFybbnbvGmm!pubbup!mfGebhbfyWGf!su<4D>y)j.q3c/v1t!!++!!mDvynjbqTc*v,tm>vFnybjTqXcTvFt<!u!bGpymbGbbGbmypGb!u!<f*e*hOftIppqs!{->ybfcut))qfpeUhyffIUpbsb{y4G*),bfnevhMfbIbpysG{>5O<eo!FGbynbvbmG!mupbbpum!GfbebhyfGW!fs<u1>/b4c,t*)DfyejhqfcWvfts+u*41*/,3f.e)h)f>WEfysjuq5c<vt!!GuybbpbmGGmbpbbyuG!!tv<c1qQj`yZOUXJTMXBOVFRT`FB>BmYvGn!b+O!XzT/XQ,Omgvgnpb,OzF/TCFt<pq!>Gzy/bQbtGpmqp!bu<!1mQf`oZhUuJiMTBjVhRo`>BgByYbGb!R+v!bym/jQuOzgSgdpq,Gys/bCntfp/qy><y/!QGtypbqb!Cp<pQmt!piqp!s3{uTbqpbmoG>bfbeyhGf!Ip<s1{Q!`?Z>U!JfMeBhVfRW`fBsBuY<G!!+G!yzb/bQGOmgpgbpu.!zt/vCctqpjqy>Bz>/tOvtcpqqj!yO<T1XQF`!Z+U!J3M/B1V,Rt`vBcBqYjGy!O+X!TyX/OQFOTgFg<p.!yj/gC)tapiqp>sy{/TOqtbpoq*!!m<vOntbpOq>!m3vunbbpXm<Gb!bjygG)!ai<p6s/{1T!q+b!oo*h!jmTvinubhTo>fmmv>n,bzF/<Ct!pjqg!)*iopbsq{TT{qsbpoi*!!)mgfjo!hu<i6T/j1h!o+>!goyhbjbTRivubhmojfumz>S,dyq/GCstbpnqf!/*zo<bq!TG{ysbpbiGam)pgbju!!t<vzc/qfjnybCs>G)qtdvSczqujjymBb!v+R!b)b2y/g1!0;2!31//11*!*@.!m*vonbbqNT<{s!pGiy!b)b>Gzm/pQbOug!ghps!be<jyf/ofunOb>smGvqndbSOz.umjvmnbbvNR<bb!yGgy!b;b!G1m/p1b!u@!!h*sobbeqjTf{osupTi>am)v>nyb/TQ.Omgvgnpb!N<<Q!OGgygbpb!G3mupbbpum!GmbvbnybGO!O><mzv/nNbtOp,qm>vzn/bCNt<pq!!Gy<byb/GNmtppbqu>!ym/vCntbpTqT!>m<vCntbpTq,!m3vunbbpNm<Gb!bGyyGb!bC<p*pfmh!oqbbSjqsdOS>ybjcqtc)vhts!b+e!j*fCoyujOq*c!v?t>)!tbccbt))uhbsTbbebjyfGo>uDTy*j<qc!vGty!bubbGpmmpGbbub!yhGs!be<jofhojuT>inubhyo)fbmc.t>)ohhsjbTeijufhooufOm*!-*!Obscjtb)qh)sgbje!jf<o*u*T",oi(p,{accordionViewExpandIcon:er(zo),accordionViewCollapseIcon:er(zo,!0),accordionViewLabelColor:wn,accordionViewLabelFont:zq,accordionViewTitleBackground:nl,accordionViewSelectBackground:_l,accordionViewSelectWidth:3,accordionViewSeparatorColor:s,splitViewDividerSize:1,splitViewDividerBackground:nl,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:ks,rect:[2,2,12,12],background:zo}]},propertyViewLabelColor:Lm,propertyViewLabelSelectColor:wn,propertyViewLabelFont:zq,propertyViewExpandIcon:er(oj),propertyViewCollapseIcon:er(oj,!0),propertyViewBackground:Yb,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:tn,propertyViewColumnLineColor:tn,propertyViewSelectBackground:_l,listViewLabelColor:Lm,listViewLabelSelectColor:wn,listViewLabelFont:zq,listViewRowLineVisible:!1,listViewRowLineColor:tn,listViewSelectBackground:_l,treeViewLabelColor:Lm,treeViewLabelSelectColor:wn,treeViewLabelFont:zq,treeViewExpandIcon:er(op),treeViewCollapseIcon:er(op,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:tn,treeViewSelectBackground:_l,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Lm,tableViewLabelSelectColor:wn,tableViewLabelFont:zq,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:tn,tableViewColumnLineColor:tn,tableViewSelectBackground:_l,treeTableViewLabelColor:Lm,treeTableViewLabelSelectColor:wn,treeTableViewLabelFont:zq,treeTableViewExpandIcon:er(op),treeTableViewCollapseIcon:er(op,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:tn,treeTableViewColumnLineColor:tn,treeTableViewSelectBackground:_l,tableHeaderLabelColor:Lm,tableHeaderLabelFont:zq,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:zi,tableHeaderBackground:Yb,tableHeaderMoveBackground:lf,tableHeaderInsertColor:_l,tableHeaderSortDescIcon:Cd(oj,!0),tableHeaderSortAscIcon:Cd(oj),tabViewTabGap:1,tabViewLabelColor:wn,tabViewLabelFont:zq,tabViewTabBackground:nl,tabViewSelectWidth:3,tabViewSelectBackground:_l,tabViewMoveBackground:lf,tabViewInsertColor:_l,toolbarLabelColor:Lm,toolbarLabelSelectColor:wn,toolbarLabelFont:zq,toolbarBackground:Yb,toolbarSelectBackground:_l,toolbarItemGap:8,toolbarSeparatorColor:Ik},!0);var ot={translateX:1,sortColumn:1},pt={sortable:1,sortOrder:1,sortFunc:1},qt={focusData:1},rt={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},st={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},tt=function(v,k){k.add(v),v.hasChildren()&&v.eachChild(function(N){tt(N,k)})},ut=function(F,R,X,k,f,e,j,z,h,Y,y){var n,q=X.getValueType(Y),T=X.getAlign(Y);if(X.getEnumValues(Y)){var r=X.toEnumLabel(R,Y),N=fr||0,b=0,u=e,t=p.getTextSize(k,r).width;return n=dg(X.toEnumIcon(R,Y)),n&&(b=e+fr/2,"center"===T?b+=(z-(N+t))/2:"right"===T&&(b=b+z-(N+t)),kn(F,n,b,j+h/2,Y,y),u=b+fr/2),r!=g&&(n?kf(F,r,k,f,u,j,z-(u-e),h):kf(F,r,k,f,e,j,z,h,T)),void 0}return R=X.formatValue(R),R!=g?q===ml?(lc(F,e,j,z,h,R),void 0):q===Bk||!q&&Tg(R)?(n=dg(R?fm:Qk),kn(F,n,e+z/2,j+h/2,Y,y),void 0):(kf(F,R,k,f,e,j,z,h,T),void 0):void 0},vt=function(H,F){var f=F.view,y=yh(H),R=F.column||F.property;f.getDataModel().beginTransaction(),F.editor=H,H.info=F,f.setCurrentEditor(H),f.getView().insertBefore(y,f._79O),Iq(H,F.editorRect),H.setFocus?H.setFocus():jf(H),H.commitValue=function(m,k){H._17Q&&(H=H._17Q),k||f.setValue(F.data,R,H.getValue?H.getValue():H.value),H.close&&H.close(),cn(y)},R.onEditorCreated&&R.onEditorCreated(F)},wt=function(X,D,T,w,L){var Q=$q(X,T),q=D.value,I=D.view,J=L.getValueType(D.data);return Q.onblur=Q.onchange=function(){I.endEditing()},"input"===X?(q=L.formatValue(q),q!=g&&(Q.value=q),Q.onkeydown=function(A){Um(A)?I.endEditing():Pi(A)&&I.endEditing(!0)},(J===Bh||J===Tq)&&C(Q,Rk,p.numberListener)):X===ph&&w.forEach(function(d){var O=o.createElement("option");O.innerHTML=L.toEnumLabel(d),O.value=d,L.isEnumEqual(q,d)&&(O.selected=!0),ib(Q,O)}),vt(Q,D),Q},xt=U.widget={},yt=function(x,Q,D){zs(e+".widget."+x,Q,D)};oi(xn,{ms_value:function(N){N.getValue=function(N){var V=this.getItemById(N),G=V.element;return Xj(G)?G:G?G.getValue?G.getValue():G.value:V.selected},N.setValue=function(q,Y){var e=this.getItemById(q);if(e){var p=e.element;p&&!Xj(p)?p.setValue?p.setValue(Y):p.value=Y:Tg(Y)?(e.selected=Y,this.iv()):(e.element=Y,this.iv())}},N.v=function($,T){var B=this;if(2===arguments.length)B.setValue($,T);else{if(!Np($))return B.getValue($);for(var o in $)B.setValue(o,$[o])}return B}},_46o:function(Y){Y._icon=g,Y._accessType=g,Y._valueType=g,Y._editable=!1,Y._batchEditable=!0,Y._align=Vn,Y._nullable=!0,Y._emptiable=!1,Y.setParent=tb,Y.formatValue=function(d){var l=this,m=l._valueType;return l.getEnumValues()?l.toEnumLabel(d):m===Bk?!!d:d!=g&&m===Bh?A(d):d},Y.setEnum=function(E,d,j,u,Z,X,H){var G=this;E&&!Vd(E)&&E.values&&(u=E.editable,j=E.icons,d=E.labels,Z=E.strict,X=E.maxHeight,H=E.dropDownWidth,E=E.values),Qq(E)&&(E=E._as),Qq(d)&&(d=d._as),Qq(j)&&(j=j._as),G._enumValues=E,G._enumLabels=d,G._enumIcons=j,G._enumEditable=u,G._enumStrict=Z==g?!0:Z,G._enumMaxHeight=X,G._enumDropDownWidth=H,E&&E.length&&Jr(E[0])&&(G._valueType=Tq),G.fp("enum",!1,!0)},Y.getEnumDropDownWidth=function(){return this._enumDropDownWidth},Y.getEnumMaxHeight=function(){return this._enumMaxHeight},Y.isEnumEditable=function(){return this._enumEditable},Y.getEnumValues=function(){return this._enumValues},Y.getEnumLabels=function(){return this._enumLabels},Y.getEnumIcons=function(){return this._enumIcons},Y.isEnumStrict=function(){return this._enumStrict},Y.isEnumEqual=function(D,E){return this._enumStrict?D===E:D==E},Y.toEnumLabel=function(r,z){var m=this,S=m.getEnumValues(z),V=m.getEnumLabels(z);if(S&&V)for(var t=0;t<S.length;t++)if(m.isEnumEqual(r,S[t]))return V[t];return r},Y.toEnumIcon=function(M,K){var Z=this,x=Z.getEnumValues(K),m=Z.getEnumIcons(K);if(x&&m)for(var W=0;W<x.length;W++)if(Z.isEnumEqual(M,x[W]))return m[W];return s}},_45o:function(H){H._87o=function(W,z,M,o,A,T){if(W){var S=this,D=S._90I,k=lp(1);S._columnLineVisible&&(A-=1),S._rowLineVisible&&(T-=1),0>=A||0>=T||(S._90I||(D=S._90I={}),D[z]||(D[z]=new Yn),Iq(k,S.tx()+M,S.ty()+o,A,T),ib(k,W),S._view.insertBefore(k,S._79O),W.onParentAdded&&W.onParentAdded(k),D[z].add(k))}},H._76o=function(){var I=this,h=I._90I;if(h){for(var L in h)h[L].each(function(w){cn(w)});delete I._90I}},H._77o=function(X){var M=this;if(M._90I){var Z=M._90I[X];Z&&(Z.each(function(C){cn(C)}),delete M._90I[X])}}},_47o:function(n){n.getValue=function(B,k){return k.getValue?k.getValue(B,k,this):$g(B,k.getAccessType(),k.getName())},n.setValue=function(l,W,_){if(W.isEmptiable(l)||""!==_||(_=s),W.isNullable(l)||_!=g){var F=this,y=W.getName(l),O=W.getAccessType(l),T=W.getValueType(l);T===Bh&&Xj(_)?_=vs(_):T===Tq&&Xj(_)?_=parseFloat(_):T===Bk&&Xj(_)&&(_="true"===_),F._batchEditable&&W._batchEditable&&F.isSelected(l)?F.sm().each(function(k){W.setValue?W.setValue(k,W,_,F):To(k,O,y,_)}):W.setValue?W.setValue(l,W,_,F):To(l,O,y,_)}},n.setCurrentEditor=function(L){this.endEditing(),this._currentEditor=L,this.redraw()},n.isEditing=function(L,k){var y=this,x=y._currentEditor;if(!x)return!1;if(k){var t=x.info;return t?(t.column||t.property)===k&&t.data===L:!1}return!0},n.endEditing=function($){var t=this,q=t._currentEditor;q&&(delete t._currentEditor,q.commitValue&&q.commitValue(q.info,$),t.redraw(),t.getDataModel().endTransaction())},n.beginEditing=function(M){this.endEditing();var X=this,p=M.column||M.property;if(p.beginEditing)p.beginEditing(M);else{var h=M.data,s=M.value,m=X.getSelectBackground(h),a=p.getEnumValues(h),V=p.getSlider(h),l=p.getColorPicker(h);if(V){var u=Op(xt.Slider,V);return u.setValue(s),u.getView().onblur=function(){X.endEditing()},u.isInstant()&&(u.onValueChanged=function(){X.setValue(h,p,u.getValue())}),vt(u,M),void 0}if(l||p.getValueType(h)===ml){var D=Op(xt.ColorPicker,l);return D.setValue(s),D.onClosed=function(){X.endEditing()},D.isInstant()&&(D.onValueChanged=function(A,P){X.setValue(h,p,P)}),vt(D,M),D.open(),void 0}if(a){if(xt.ComboBox){var q=new xt.ComboBox;q.setValue(s),q.setValues(a),q.setLabels(p.getEnumLabels(h)),q.setIcons(p.getEnumIcons(h)),q.setEditable(p.isEnumEditable(h)),q.setStrict(p.isEnumStrict(h)),q.setMaxHeight(p.getEnumMaxHeight(h)),q.setDropDownWidth(p.getEnumDropDownWidth(h)),q.onClosed=function(){X.endEditing()},vt(q,M),q.open()}else wt(ph,M,m,a,p);return}var I=p.getValueType(h);if(I===Bk||Tg(s))return X.setValue(h,p,!s),void 0;if(p.getItemEditor(h)){var o=Uf(p.getItemEditor(h)),W=new o(h,p,X,M),k=W.getView();return k._17Q=W,W.setValue(s),Ym(k),vt(k,M),W.editBeginning&&W.editBeginning(),void 0}wt("input",M,m,g,p)}}},_44o:function(k){k.init=function(Z){var n=this,W=n.th=new Nt(Z),F=n._view=_f(1,n);n.tv=n._tableView=Z,ib(F,W.getView()),ib(F,Z.getView()),W.mp(function(Z){Z.property===Xk&&n.iv()}),n.iv()},k.getTableView=function(){return this.tv},k.getTableHeader=function(){return this.th},k.getDataModel=function(){return this.tv.dm()},k.getColumnModel=function(){return this.tv.getColumnModel()},k.setColumns=function(D){this.tv.setColumns(D)},k.addColumns=function(v){this.tv.addColumns(v)},k.endEditing=function(){this.tv.endEditing()},k.validateImpl=function(){var M=this,n=M.th,X=ri(n),w={x:0,y:0,width:M.getWidth(),height:X};Iq(n,w),w.y=X,w.height=N(0,M.getHeight()-X),Iq(M.tv,w)}},ms_vs:function(R){R._41o=function(){return this._29I.height<this._59I},R._43o=function(){var N=this;N._41o()&&(N._58I||(yo(function(){N._94O()},Nq),N.iv()),N._58I=new Date)},R._94O=function(){var m=this;if(m._58I){var z=new Date;z.getTime()-m._58I.getTime()>=Nq?(delete m._58I,m.iv()):yo(function(){m._94O()
},Nq)}},R._93I=function(){var a=this,w=a._27I;if(a._58I||!a._autoHideScrollBar){w||ib(a._79O,w=a._27I=lp());var g=a._29I,X=g.height,L=a._59I,B=a.getScrollBarSize(),W=g.width-B-2,R=X*(-a.ty()/L),Z=X*(X/L),A=w.style;L>X?(is>Z&&(R=R+Z/2-is/2,0>R&&(R=0),R+is>X&&(R=X-is),Z=is),A.visibility=ar,A.background=a.getScrollBarColor(),A.borderRadius=B/2+zk,Iq(w,W,R,B,Z)):A.visibility=lb}else w&&(w.style.visibility=lb)}},ms_hs:function(i){i._40o=function(){return this._29I.width<this._91I},i._42o=function(){var e=this;e._40o()&&(e._95O||(yo(function(){e._94I()},Nq),e.iv()),e._95O=new Date)},i._94I=function(){var f=this;if(f._95O){var r=new Date;r.getTime()-f._95O.getTime()>=Nq?(delete f._95O,f.iv()):yo(function(){f._94I()},Nq)}},i._92I=function(){var u=this,U=u._28I;if(u._95O||!u._autoHideScrollBar){U||ib(u._79O,U=u._28I=lp());var K=u._29I,l=K.width,C=u._91I,h=u.getScrollBarSize(),W=K.height-h-2,G=l*(-u.tx()/C),L=l*(l/C),y=U.style;C>l?(is>L&&(G=G+L/2-is/2,0>G&&(G=0),G+is>l&&(G=l-is),L=is),y.visibility=ar,y.background=u.getScrollBarColor(),y.borderRadius=h/2+zk,Iq(U,G,W,L,h)):y.visibility=lb}else U&&(U.style.visibility=lb)}}}),gk(fm,pm(16,16,[{type:Em,rect:[1,1,14,14],background:_l},{type:sp,rect:[1,1,14,14],width:1,color:Oq},{type:pc,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),gk(Qk,pm(16,16,{type:sp,rect:[1,1,14,14],width:1,color:Oq})),gk(Rn,pm(16,16,[{type:Dq,rect:[2,2,12,12],borderWidth:1,borderColor:Oq,background:"#FFF"},{type:Dq,rect:[4,4,8,8],background:_l}])),gk(Zf,pm(16,16,{type:Dq,rect:[2,2,12,12],borderWidth:1,borderColor:Oq})),xn._15Q=function(M){M._29I=Pf,M._59I=0,M._91I=0,M._5o=function(s){var x=this;x._30I=new Yn,x._rows=new Yn,x._rowMap={},x._31I=0,x._14I=0,x._view=_f(1,x),x._canvas=gj(x._view),ib(x._view,x._79O=lp()),x.dm(s?s:new _m)},M.getCheckIcon=function(H){var R=this.sm(),s=R.co(H);return R.sg()?dg(s?Rn:Zf):dg(s?fm:Qk)},M.checkData=function(t){var v=this.sm(),x=v.co(t);v.sg()&&x||(this._32o=1,x?v.rs(t):v.as(t),delete this._32o)},M.getDataAt=function(S){S.target&&(S=this.lp(S));var E=l(S.y/this._rowHeight),C=this._rows;return 0>E||E>=C.size()?g:C.get(E)},M.onDataDoubleClicked=function(){},M.onDataClicked=function(){},M.adjustTranslateX=function(){return 0},M.adjustTranslateY=function(a){var N=this.getHeight()-this._59I;return N>a&&(a=N),a>0?0:A(a)},M.onPropertyChanged=function(L){var y=this,p=L.property;rt[p]?y.ivm():qt[p]||y.redraw(),p===Sj?y._42o():p===Hq&&y._43o()},M.getLabel=function(w){return w.toLabel()},M.getLabelFont=function(){return this._labelFont},M.getLabelColor=function(f){var o=this;if(o.isCheckMode()){if(o._focusData===f)return o._labelSelectColor}else if(o.isSelected(f))return o._labelSelectColor;return o._labelColor},M.getStartRowIndex=function(){return this._31I},M.getEndRowIndex=function(){return this._14I},M.getRowDatas=function(){return this._rows},M.getRowIndex=function(L){return this._rowMap[L._id]},M.getRowSize=function(){return this._rows.size()},M.getViewRect=function(){return Wi(this._29I)},M.isVisible=function(u){return this._visibleFunc?this._visibleFunc(u):!0},M.getCurrentSortFunc=function(){return this._sortFunc},M.setDataModel=function(j){var H=this,Y=H._dataModel,M=H._selectionModel;Y!==j&&(Y&&(Y.umm(H.handleDataModelChange,H),Y.umd(H.handleDataPropertyChange,H),Y.umh(H.handleHierarchyChange,H),M||Y.sm().ums(H.handleSelectionChange,H)),H._dataModel=j,j.mm(H.handleDataModelChange,H),j.md(H.handleDataPropertyChange,H),j.mh(H.handleHierarchyChange,H),M?M._21I(j):j.sm().ms(H.handleSelectionChange,H),H.fp("dataModel",Y,j))},M.validateModel=function(){var w=this;w._rows.clear(),w._rowMap={},w.buildChildren(w._dataModel._roots);var V=w._rows=w._rows.toList(w.isVisible,w),O=0,A=w.getCurrentSortFunc(),S=V.size();for(A&&V.sort(A);S>O;O++)w._rowMap[V.get(O)._id]=O},M.buildChildren=function(y){var Q=this;y.each(function(o){Q._rows.add(o),Q.buildChildren(o._children)})},M.handleDataModelChange=function(){this.ivm()},M.handleDataPropertyChange=function(o){"parent"===o.property?this.ivm():this.invalidateData(o.data)},M.handleHierarchyChange=function(){this.ivm()},M.handleSelectionChange=function(K){K.datas.each(this.invalidateData,this),this.onSelectionChanged(K)},M.onSelectionChanged=function(O){var V=this,B=V.sm();!V.isAutoMakeVisible()||1!==B.size()||"set"!==O.kind&&"append"!==O.kind||V._32o||V.makeVisible(B.ld())},M.handleBackgroundClick=function(h){ys(h)&&!this.isCheckMode()&&this.sm().cs()},M.makeVisible=function(F){F&&(this._23I=F,this.iv())},M.scrollToIndex=function(l){var i=this,B=i._29I,x=B.height,Z=i._rowHeight,T=Z*l;l>=0&&l<i._rows.size()&&x>0&&(T+Z>B.y+x?i.ty(-T+x-Z):T<B.y&&i.ty(-T))},M.autoScroll=function(K,o){var n=this,S=n._rowHeight,V=S,m=S/4,g=n._29I,X=n.lp(K),f={x:n.tx(),y:n.ty()};return S>0&&g&&(X.x-g.x<V?n.translate(m,0):g.x+g.width-X.x<V&&n.translate(-m,0),X.y-g.y<V?n.translate(0,m):g.y+g.height-X.y<V&&n.translate(0,-m)),f.x=n.tx()-f.x,f.y=n.ty()-f.y,o&&(o.x+=f.x,o.y+=f.y),f},M.getTopRowOrderSelection=function(){var z=this.sm().getTopSelection(),K={},B=new Yn;return z.each(function(q){K[q._id]=q}),this._rows.each(function(X){K[X._id]&&B.add(X)}),B},M.getRowOrderSelection=function(){var r=new Yn;return this._rows.each(function(R){this.isSelected(R)&&r.add(R)},this),r},M.ivm=function(){this.invalidateModel()},M.invalidateModel=function(){var e=this;e._96I||(e._96I=1,e._32I=1,delete e._24I),e.iv()},M.redraw=function(){var f=this;f._32I||(f._32I=1,delete f._24I,f.iv())},M.invalidateData=function(t){var A=this;hd?A.redraw():A._32I||(A._24I||(A._24I={}),A._24I[t._id]=t,A.iv())},M.getFocusData=function(){return this._focusData},M.setFocusDataById=function(B){this.setFocusData(this.dm().getDataById(B))},M.setFocusData=function(q){var S=this,c=S._focusData;c!==q&&(S._focusData=q,S.fp("focusData",c,q),c&&S.invalidateData(c),q&&(S.invalidateData(q),S.isAutoMakeVisible()&&S.makeVisible(q)))},M.drawRowBackground=function(o,S,M,$,h,u,k){var I=this,c=I.isCheckMode();(S===I._focusData&&c||M&&!c)&&lc(o,$,h,u,k,I.getSelectBackground(S))},M.drawData=function(W,P,r){var A=this,s=A._rowHeight,L=s*r,Q=A._29I,j=Q.x,w=Q.width;W.save(),W.beginPath(),W.rect(j,L,w,s),W.clip(),A._87o(A.drawRow(W,P,A.isSelected(P),j,L,w,s),r,j,L,w,s),W.restore(),A._rowLineVisible&&lc(W,j,L+s-1,w,1,A._rowLineColor)},M._12I=function(n){var z=this,b=z._31I,x=z._29I,o=x.x,X=x.y,N=x.width,I=x.height;for(n.beginPath(),n.rect(o,X,N,I),n.clip(),n.clearRect(o,X,N,I),z._76o(),z._93db(n);b<z._14I;b++)z.drawData(n,z._rows.get(b),b);z._92db(n)},M._13I=function(u){for(var j,J=this,h=J._rowHeight,c=J._29I,m=c.x,A=c.width,L=J._31I,p=J._30I;L<J._14I;L++)j=J._rows.get(L),J._24I[j._id]&&p.add({data:j,index:L});p.isEmpty()||(u.beginPath(),p.each(function(x){u.rect(m,x.index*h,A,h)}),u.clip(),p.each(function(o){u.clearRect(m,o.index*h,A,h)}),p.each(function(k){J._77o(k.index)}),J._93db(u),p.each(function(X){J.drawData(u,X.data,X.index)}),J._92db(u),p.clear())},M.preValidateModel=function(){this.endEditing&&this.endEditing()},M.validateImpl=function(){var N=this,$=N._canvas,O=N.getWidth(),P=N.getHeight(),j=N._rowHeight,Q=N._32I;(O!==$.clientWidth||P!==$.clientHeight)&&(Df($,O,P),Q=1),N._96I&&(N.preValidateModel(),N.validateModel());var C=N._29I,F={x:-N.tx(),y:-N.ty(),width:O,height:P},d=N._rows.size(),f=Rl($),u=N._23I;Q||Yl(F,C)||(Q=1),N._29I=F,N._59I=d*j,N._31I=l(F.y/j),N._14I=y((F.y+F.height)/j),N._31I<0&&(N._31I=0),N._14I>d&&(N._14I=d),N._99I&&Q&&N._99I();var K=N.tx(),a=N.ty();(N._40o()||N._41o())&&(N._59I+=N.getScrollBarSize(),N._99I&&Q&&(N._91I+=N.getScrollBarSize())),Ag&&!Dp&&(f.save(),Bl(f,O/tj.length,P/tj.length,1)),Bl(f,K,a,1),Q?N._12I(f):N._24I&&N._13I(f),N._93I(),N._92I(),f.restore(),N._32I=N._24I=N._96I=g,u&&(N.scrollToIndex(N.getRowIndex(u)),delete N._23I),N.tx(N.tx()),N.ty(N.ty())},M.canHandleSelectMode=function(){return!0}},xn._48o=function(W){W._rootVisible=!0,W._rootData=g,W._35o=function(){this._expandMap={},this._levelMap={}},W.validateModel=function(){var L=this,_=L._rootData;L._rows.clear(),L._levelMap={},L._rowMap={},L._currentLevel=0,_?L._rootVisible?L.isVisible(_)&&L.buildData(_):L.buildChildren(_):L.buildChildren(),delete L._currentLevel},W.buildData=function(M){var A=this,q=M._id,a=A._rows;A._rowMap[q]=a.size(),a.add(M),A._levelMap[q]=A._currentLevel,A.isExpanded(M)&&(A._currentLevel++,A.buildChildren(M),A._currentLevel--)},W.buildChildren=function(r){var m=this,T=r?r._children:m._dataModel._roots,N=m.getCurrentSortFunc();N&&m.isChildrenSortable(r)?T.toList(m.isVisible,m).sort(N).each(m.buildData,m):T.each(function(l){m.isVisible(l)&&m.buildData(l)})},W.getLevel=function(I){return this._levelMap[I._id]},W.getToggleIcon=function(m){var t=this,V=t._loader,Y=t._collapseIcon;return V&&!V.isLoaded(m)?Y:m.hasChildren()?t.isExpanded(m)?t._expandIcon:Y:g},W.isCheckMode=function(){return this._checkMode!=g},W.isChildrenSortable=function(){return!0},W.handleDataModelChange=function(h){var V=this;h.kind===Lf?delete V._expandMap[h.data._id]:h.kind===rm&&(V._expandMap={}),V.ivm()},W.toggle=function(b){var K=this;K.isExpanded(b)?K.collapse(b):K.expand(b)},W.isExpanded=function(F){return 1===this._expandMap[F._id]},W.expand=function(B){var y=this,Q=y._loader;y.isExpanded(B)||(Q&&!Q.isLoaded(B)&&Q.load(B),y._expandMap[B._id]=1,y.ivm(),y.onExpanded(B))},W.onExpanded=function(){},W.collapse=function(L){var l=this;l.isExpanded(L)&&(delete l._expandMap[L._id],l.ivm(),l.onCollapsed(L))},W.onCollapsed=function(){},W.expandAll=function(A){if(A)this.expand(A),A.eachChild(function(C){this.expandAll(C)},this);else{var J=this;J._dataModel.each(function(v){v.hasChildren()&&(J._expandMap[v._id]=1)}),J.ivm()}},W.collapseAll=function(){this._expandMap={},this.ivm()},W.makeVisible=function(o){if(o){var e=this;if(!e._rootData||o.isDescendantOf(e._rootData)){for(var l=o._parent;l;)e.expand(l),l=l._parent;e._23I=o,e.iv()}}},W.checkData=function(E){var o,A=this,V=A._checkMode,n=A.sm(),u=n.co(E);if(!n.sg()||!u){if(A._32o=1,V===Wh)u?n.rs(E):n.as(E);else if(V===Xr)o=new Yn(E),o.addAll(E._children);else if("descendant"===V)o=new Yn,tt(E,o);else if("all"===V&&(o=new Yn,tt(E,o),!u))for(var O=E._parent;O;)o.add(O),O=O._parent;o&&(u?n.rs(o):n.as(o)),delete A._32o}},W.drawTree=function(T,W,y,P,H,I,M){var U=this,L=U._indent,g=U._levelMap[W._id],K=U.getIconWidth(W),r=dg(U.getToggleIcon(W));r?(P+=L*g,kn(T,r,P+L/2,H+M/2,W,U),P+=L):P+=L*(g+1),U._checkMode&&(kn(T,U.getCheckIcon(W),P+L/2,H+M/2,W,U),P+=L),U.drawIcon(T,W,P,H,K,M),U.drawLabel(T,W,P+K,H,M)}},xn._14Q=function(J){J.getIcon=function(w){return w.getIcon()},J.getIconWidth=function(Z){return this.getIcon(Z)?this._indent:0},J.drawIcon=function(O,d,c,r,I,F){if(I){var q=this,w=q.getBodyColor(d),j=dg(q.getIcon(d),w);j&&(F-=q.isRowLineVisible()?1:0,id(O,j,pq,c,r,I,F,d,q,w),El(O,q.getBorderColor(d),c,r,I,F))}},J.drawLabel=function(q,L,E,I,e){var o=this;kf(q,o.getLabel(L),o.getLabelFont(L),o.getLabelColor(L),E,I,0,e)}},xn._50o=function(B){B._98I=function(){var B=this,p=B._39o=new _m;B._60I=new Yn,p.mm(B._17o,B),p.md(B._18o,B),p.mh(B._19o,B)},B.setColumns=function(H){this._39o.clear(),this.addColumns(H)},B.addColumns=function(U){var W=this._39o;U.forEach(function(u){if(!(u instanceof At)){var H=Uf(u.className);u=Op(H?H:At,u)}W.add(u)})},B.onColumnClicked=function(){},B.onCheckColumnClicked=function(){},B._3Q=function(W){for(var a,M=0,D=this._60I,o=D.size();o>M;M++)if(a=D.get(M),a.column===W)return a;return g},B.getColumnAt=function(y){var Z=this._4Q(y);return Z?Z.column:g},B._4Q=function(H){for(var i=this,q=H.target?i.lp(H).x:H.x,L=i._60I,w=0;w<L.size();w++){var B=L.get(w),R=B.startX;if(q>=R&&q<R+B.column.getWidth())return B}return g},B.getToolTip=function(t){var N=this,V=N.getDataAt(t),h=N.getColumnAt(t);return V&&h?h.getToolTip(V,N):g},B.adjustTranslateX=function(W){var s=this.getWidth()-this._91I;return s>W&&(W=s),W>0?0:A(W)},B._99I=function(){var d=this,L=d._29I,f=d._60I;f.clear(),d._91I=0,d._39o._roots.each(function(g){if(g.isVisible()){var K=d._91I+g.getWidth();d._91I<=L.x+L.width&&K>=L.x&&f.add({column:g,startX:d._91I}),d._91I=K}})},B.drawData=function(K,m,b){var l=this,u=l._rowHeight,s=u*b,H=l.isSelected(m),W=l._29I,h=W.x,j=W.width;l.drawRowBackground(K,m,H,h,s,j,u),l._60I.each(function(Q){var J=Q.column,S=Q.startX,R=J.getWidth();R>0&&!l.isEditing(m,J)&&(K.save(),K.beginPath(),K.rect(S,s,R,u),K.clip(),l._87o(l.drawCell(K,m,H,J,S,s,R,u),b,S,s,R,u),l._columnLineVisible&&lc(K,S+R-1,s,1,u,l._columnLineColor),K.restore())}),l._rowLineVisible&&lc(K,h,s+u-1,j,1,l._rowLineColor)},B.drawCell=function(P,v,$,I,M,Y,q,_){var B=this;if(I.drawCell)return I.drawCell(P,v,$,I,M,Y,q,_,B);var y=B.getValue(v,I);ut(P,y,I,B.getLabelFont(v,I,y),B.getLabelColor(v,I,y),M,Y,q,_,v,B)},B.getColumnModel=function(){return this._39o},B._17o=function(){this.redraw()},B._18o=function(b){var H=this;b.data===H._sortColumn&&pt[b.property]?H.ivm():(H._42o(),H.redraw())},B._19o=function(){this.redraw()},B.getCurrentSortFunc=function(){var V=this,w=V._sortColumn;if(w&&w.isSortable()){var m=w.getSortFunc(),e=Oc===w.getSortOrder()?1:-1;return m||(m=Kc),function(Z,S){return m.call(V,V.getValue(Z,w),V.getValue(S,w),Z,S)*e}}return V._sortFunc},B.isCellEditable=function(I,i,K){return i.isEditable()&&this.isEditable()?i.isCellEditable?i.isCellEditable(I,i,K,this):!0:!1},B._37O=function(C,X){if(ys(X))for(var M=this,Y=M.lp(X),j=M._60I,N=M._rowHeight,O=M._29I,b=O.x,Z=O.y,E=O.width,s=O.height,c=0;c<j.size();c++){var u=j.get(c),e=u.startX,$=u.column,I=$.getWidth();if($!==M._31o&&$!==M._4o&&Y.x>=e&&Y.x<e+I&&M.isCellEditable(C,$,X)){var g={x:e,y:M.getRowIndex(C)*N,width:I,height:N},h={x:g.x+M.tx(),y:g.y+M.ty(),width:g.width,height:g.height},v=0,W=0;return g.x<b?v=g.x-b:g.x+g.width>b+E&&(v=g.x+g.width-b-E),v&&(M.tx(M.tx()-v),h.x-=v),g.y<Z?W=g.y-Z:g.y+N>Z+s&&(W=g.y+N-Z-s),W&&(M.ty(M.ty()-W),h.y-=W),M.beginEditing({data:C,column:$,value:M.getValue(C,$),event:X,rect:g,editorRect:h,view:M}),void 0}}}},xt.BaseItemEditor=function(c,l,F,e){this._data=c,this._column=l,this._master=F,this._editInfo=e},yt("BaseItemEditor",z,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var zt=U.Tab=function(){$e(zt,this)};jn("Tab",Zc,{ms_ac:["view","closable","disabled","visible"],_icon:g,_closable:!1,_disabled:!1,_visible:!0,setParent:tb});var At=U.Column=function(){$e(At,this)};jn("Column",Zc,{_46o:1,ms_ac:["accessType","valueType",ar,Xf,lj,Ap,"align",ml,"sortOrder",of,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Oc,_sortFunc:g,_sortable:!0,_clickable:!0,setWidth:function(l){16>l&&(l=16);var n=this._width;this._width=l,this.fp(Ap,n,l)},getToolTip:function(j,N){return this.formatValue(N.getValue(j,this))}});var Bt=U.Property=function(){$e(Bt,this)};jn("Property",Zc,{_46o:1,ms_ac:["accessType","valueType",Xf,lj,"categoryName",ml,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:g,getToolTip:function(w,$,H){var b=this;return $?b.formatValue(H.getValue(w,b)):H.getPropertyName(b)}}),xt.AccordionView=function(){var z=this;z._20o={},z._21o=new Yn,z._10o=g,z._9o=g,z._11o=g,z._view=_f(0,z),z.iv()},yt("AccordionView",z,{ms_v:1,ms_fire:1,ms_ac:[Hh,Vh,"titleHeight",We,ig,"titleBackground","selectWidth",Lq,"orientation","separatorColor"],_expandIcon:p.accordionViewExpandIcon,_collapseIcon:p.accordionViewCollapseIcon,_titleHeight:Go,_labelColor:p.accordionViewLabelColor,_labelFont:p.accordionViewLabelFont,_titleBackground:p.accordionViewTitleBackground,_selectBackground:p.accordionViewSelectBackground,_selectWidth:p.accordionViewSelectWidth,_orientation:"v",_separatorColor:p.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(a,Z,$,i){var j=this,t=lp(),h={content:Z,div:t,canvas:gj(t),icon:i};if(j._20o[a])throw a+" already exists";var L=h.downEventFunc=function(C){fk(C)},o=h.upEventFunc=function(I){fk(I),ys(I)&&(j._10o===a?j.collapse():j.expand(a))};[bi,Ke].forEach(function(V){C(t,V,L)}),[Xi,xp].forEach(function(d){C(t,d,o)}),t.style.cursor=fg,ib(j._view,t),j._20o[a]=h,j._21o.add(a),$&&j.expand(a),j.iv()},remove:function(e){var T=this,c=T._20o[e];if(c){var Q=c.div;cn(Q),[bi,Ke].forEach(function(I){J(Q,I,c.downEventFunc)}),[Xi,xp].forEach(function(q){J(Q,q,c.upEventFunc)}),delete T._20o[e],T._21o.remove(e),T.iv()}},clear:function(){var V=this;V._21o.toArray().forEach(V.remove,V),V._20o={},V._21o.clear(),V.iv()},isExpanded:function(S){return this._10o===S},expand:function(H){var d=this;d._20o[H]&&d._10o!==H&&(d._10o=H,d.onExpanded(H),d.iv())},onExpanded:function(){},collapse:function(){var C=this;C._10o&&(C.onCollapsed(C._10o),delete C._10o,C.iv())},onCollapsed:function(){},initCanvas:function(Q,l,N){Df(Q,l,N);var k=Rl(Q);return Bl(k,0,0,1),k.clearRect(0,0,l,N),k},drawTitle:function(O,$,Y,X,u){var B=this,b=dg(u.icon),o=B.isExpanded($),D=B._titleHeight,z=B._titleBackground,r=B._selectWidth,L=B._separatorColor,V=dg(o?B._expandIcon:B._collapseIcon),F=r+4;lc(O,0,0,Y,X,z),o&&r&&lc(O,0,0,r,X,B._selectBackground),(o||B._21o.get(B._21o.size()-1)!==$)&&lc(O,0,X-1,Y,1,L?L:Xg(z)),b&&(kn(O,b,F+Oo(b)/2,D/2),F+=Oo(b)+2),kf(O,$,B.getLabelFont($),B.getLabelColor($),F,0,0,D),V&&kn(O,V,Y-Oo(V)/2-4,D/2)},validateImpl:function(){var S=this,v=S._view,L=0,X=0,E=S.getWidth(),f=S.getHeight(),g=S._titleHeight,l=S._21o.size()*g,e=S._11o,R=S._9o;delete S._11o,delete S._9o,S._21o.each(function(c){var V,T,P=S._20o[c],q=P.content,h=S._10o===c;io(S)?(Iq(P.div,L,0,g,f),V=S.initCanvas(P.canvas,g,f),bs(V,0,f),no(V,-zp),S.drawTitle(V,c,f,g,P),V.restore(),h?(T=N(0,E-l),q&&(S._11o=q,S._9o=yh(q),Iq(q,L+g,0,T,f)),L+=g+T):L+=g):(Iq(P.div,0,X,E,g),V=S.initCanvas(P.canvas,E,g),S.drawTitle(V,c,E,g,P),V.restore(),h?(T=N(0,f-l),q&&(S._11o=q,S._9o=yh(q),Iq(q,0,X+g,E,T)),X+=g+T):X+=g)});var k=S._9o;e&&e!==S._11o&&e.endEditing&&e.endEditing(),k&&k!==R&&ib(v,k),R&&R!==k&&cn(R)}}),xt.SplitView=function(y,H,X,v){var q=this,Q=q._dividerDiv=lp(),J=q._60O=gj(),I=q._61O=gj(),T=J.style,d=I.style;q._view=_f(1,q),ib(q._view,Q),T.msTouchAction=hf,T.pointerEvents=hf,T.cursor=fg,d.msTouchAction=hf,d.pointerEvents=hf,d.cursor=fg,y&&q.setLeftView(y),H&&q.setRightView(H),X&&q.setOrientation(X),v!=g&&q.setPosition(v),q.setStatus(xo),new Ct(q)},yt("SplitView",z,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:p.splitViewDividerSize,_dividerBackground:p.splitViewDividerBackground,_dragOpacity:p.splitViewDragOpacity,_toggleIcon:p.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(z,V){var n=this,B=n._position;isNaN(z)||(V||(n._82O=0>z?-1:z>1?1:0),n._position=z,n.fp(kh,B,z))},getLeftView:function(){return this._leftView},setLeftView:function(t){var R=this,K=R._leftView,N=R._view;if(R._leftView!==t){if(K&&K!==R._rightView){var U=yh(K);U.parentNode===N&&cn(U)}if(R._leftView=t,t){var G=yh(t);G.parentNode!==N&&N.insertBefore(G,R._dividerDiv)}R.fp("leftView",K,t)}},getRightView:function(){return this._rightView},setRightView:function(_){var I=this,C=I._rightView,H=I._view;if(I._rightView!==_){if(C&&C!==I._leftView){var V=yh(C);V.parentNode===H&&cn(V)}if(I._rightView=_,_){var d=yh(_);d.parentNode!==H&&H.insertBefore(d,I._dividerDiv)}I.fp("rightView",C,_)}},validateImpl:function(){var r=this,$=r._draggable,H=r._position,k=r.getWidth(),l=r.getHeight(),i=r._dividerSize,h=r._dividerBackground,O=Pb?18:8,o=r._dividerDiv,g=r._82O,y=r._60O,D=r._61O,p=r._toggleIcon,T=r._status,L=o.style,d=null,m=Pb?20:4,j=p.comps[0];i>=O||0===i?r._coverDiv&&(cn(r._coverDiv),delete r._coverDiv):r._coverDiv||(r._coverDiv=lp(),uc&&(r._coverDiv.style.background=ye),ib(o,r._coverDiv)),r._togglable?y.parentNode||(ib(o,y),ib(o,D)):(cn(y),cn(D));var _=r._coverDiv,B=r._leftView,u=r._rightView;if(io(r)){if(i>k&&(i=k),T===xo)if(1===g)var Y=Q(H,k),z=N(0,k-i-Y);else-1===g?(z=Q(-H,k),Y=N(0,k-i-z)):(Y=A((k-i)*H),z=N(0,k-i-Y));else"cl"===T?(Y=0,z=N(0,k-i)):"cr"===T&&(z=0,Y=N(0,k-i));B&&Iq(B,0,0,Y,l),u&&Iq(u,Y+i,0,z,l),Iq(o,Y,0,i,l),r._22o=Y,_&&(Iq(_,i/2-O/2,0,O,l),_.style.cursor=$?Nk:""),o.style.cursor=$?Nk:"";var W=o.clientHeight/2,b=o.clientWidth;Df(y,b,b),Iq(y,0,W-b-m,b,b),d=Rl(y),Bl(d,0,0,1),j.rotation=-zp,jj(d,p,0,0,b,b),d.restore(),Df(D,b,b),Iq(D,0,W+m,b,b),d=Rl(D),Bl(d,0,0,1),j.rotation=zp,jj(d,p,0,0,b,b),d.restore()}else{if(i>l&&(i=l),T===xo)if(1===g)var F=Q(H,l),C=N(0,l-i-F);else-1===g?(C=Q(-H,l),F=N(0,l-i-C)):(F=A((l-i)*H),C=N(0,l-i-F));else"cl"===T?(F=0,C=N(0,l-i)):"cr"===T&&(C=0,F=N(0,l-i));B&&Iq(B,0,0,k,F),u&&Iq(u,0,F+i,k,C),Iq(o,0,F,k,i),r._22o=F,_&&(Iq(_,0,i/2-O/2,k,O),_.style.cursor=$?jb:""),L.cursor=$?jb:"";var s=o.clientWidth/2,b=o.clientHeight;Df(y,b,b),Iq(y,s-b-m,0,b,b),d=Rl(y),Bl(d,0,0,1),j.rotation=0,jj(d,p,0,0,b,b),d.restore(),Df(D,b,b),Iq(D,s+m,0,b,b),d=Rl(D),Bl(d,0,0,1),j.rotation=a,jj(d,p,0,0,b,b),d.restore()}L.background=h}});var Ct=function(g){this.sv=g,this.addListeners()};zs(Ct,z,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(s){var Z=this,U=Z.sv,o=U._dividerDiv,b=U._60O,Q=U._61O,v=U._status,$=s.target;if($===b)v===xo?U.setStatus("cl"):"cr"===v&&U.setStatus(xo);else if($===Q)v===xo?U.setStatus("cr"):"cl"===v&&U.setStatus(xo);else if(kk(s)&&($===o||$===U._coverDiv)&&(fk(s),U.isDraggable())){U.getLeftView(),U.getRightView();var _=Z.maskDiv=lp();if(_.style.left=0,_.style.top=0,_.style.width=U.getWidth()+"px",_.style.height=U.getHeight()+"px",U.getView().appendChild(_),!U.isContinuousLayout()){var O=Z.resizeDiv=lp();O.style.left=o.style.left,O.style.top=o.style.top,O.style.width=o.style.width,O.style.height=o.style.height,O.style.opacity=U.getDragOpacity(),O.style.background=U.getDividerBackground(),ib(Z.getView(),O)}Z._lastAbsPosition=U._22o,Z._86o=io(U)?vq(s).x:vq(s).y,Nm(Z,s)}},handleWindowTouchMove:function(C){kk(C)&&this.update(C,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(K){var D=this;D.update(K,!0),D.sv.setStatus(xo),D.maskDiv&&cn(D.maskDiv),D.resizeDiv&&cn(D.resizeDiv),D.maskDiv=D.resizeDiv=g},handle_mousedown:function(L){ys(L)&&this.handle_touchstart(L)},handleWindowMouseMove:function(R){this.handleWindowTouchMove(R)},handleWindowMouseUp:function($){this.handleWindowTouchEnd($)},update:function(Y,M){var Q=this,p=Q.sv,o=io(p)?p.getWidth():p.getHeight(),R=p._dividerSize,s=Q._lastAbsPosition-Q._86o;io(p)?(s+=vq(Y).x,s>o-R&&(s=o-R),0>s&&(s=0),Q.resizeDiv&&(Q.resizeDiv.style.left=s+zk)):(s+=vq(Y).y,s>o-R&&(s=o-R),0>s&&(s=0),Q.resizeDiv&&(Q.resizeDiv.style.top=s+zk)),M&&o!==R&&(1===p._82O?p.setPosition(s,1):-1===p._82O?p.setPosition(s-o+R,1):p.setPosition(s/(o-R),1))}}),xt.TabView=function(){var I=this,v=I._view=_f(1,I),H=I._91O=lp(1),O=I._tabModel=new _m,m=O.sm(),W=I.invalidate;I._7o=new Yn,I._canvas=gj(H),ib(v,H),ib(v,I._92O=lp(1)),m.setSelectionMode(hb),m.ms(I.handleSelectionChange,I),O.mm(W,I),O.mh(W,I),O.md(W,I),I._interactor=new Dt(I),I.iv()},yt("TabView",z,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",We,ig,"tabHPadding","tabBackground","selectWidth",Lq,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:$l,_tabHeight:Go,_tabGap:p.tabViewTabGap,_labelColor:p.tabViewLabelColor,_labelFont:p.tabViewLabelFont,_tabBackground:p.tabViewTabBackground,_selectWidth:p.tabViewSelectWidth,_selectBackground:p.tabViewSelectBackground,_moveBackground:p.tabViewMoveBackground,_insertColor:p.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(x,R,A){var b,J=this._tabModel;return x instanceof zt?(b=x,R&&b.setView(R)):(b=new zt,b.setName(x),b.setView(R)),J.add(b),A&&J.sm().ss(b),b},getLabel:function(M){return M.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(Z){this._23o=Z,this.iv()},get:function(q){var t=this,T=t._tabModel;if(Jr(q))return T._roots.get(q);if(Xj(q)){var e;return T.each(function(T){q===t.getLabel(T)&&(e=T)}),e}return q instanceof zt?q:g},select:function(b){this._tabModel.sm().ss(this.get(b))},remove:function(m){var $=this;if(m=$.get(m)){var _=$._tabModel,F=_._roots.indexOf(m);$._tabModel.remove(m),$.selectByIndex(--F)}},getCurrentTab:function(){return this._8o},hideTabView:function(K,k){k.parentNode===this._92O&&(wo(k)?(k.style.display=km,k._tab_=K):cn(k),Pm())},showTabView:function(e,Z){wo(Z)&&(Z.style.display="block",Z._tab_=e),Z.parentNode!==this._92O&&(ib(this._92O,Z),Pm())},_24o:function(){var k,_=this,E=_._8o,O=_._9o,t=_._tabModel.sm().ld();t&&(k=yh(t.getView())),k!==O&&(O&&(E.getView()&&E.getView().endEditing&&E.getView().endEditing(),_.hideTabView(E,O)),k&&_.showTabView(t,k)),_._8o=t,_._9o=k,E!==t&&_.onTabChanged(E,t)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(q,U){this.selectByIndex(--U)},selectByIndex:function(R){var D=this,L=D._tabModel,l=L.size();if(l&&!L.sm().ld()){R==g&&(R=0),R>=l&&(R=l-1),0>R&&(R=0);for(var A=R;A>=0;A--){var n=D.get(A);if(!n.isDisabled())return D.select(n),n}for(A=R+1;l>A;A++)if(n=D.get(A),!n.isDisabled())return D.select(n),n}},getTabWidth:function(Y){var w=this.getTabHPadding(),a=4+2*w,D=dg(Y.getIcon());D&&(a+=Oo(D,Y)+4);var r=this.getLabel(Y);return r&&(a+=Lr(this.getLabelFont(Y),r).width+4),Y.isClosable()&&(a+=10),a},drawTab:function(v,J,u,e,T,q,N){var S,i=this,n=i._tabPosition,o=this.getTabHPadding(),Z=u+4+o,B=i._selectWidth,I=dg(J.getIcon()),M=J.isDisabled(),X=i.getLabelColor(J),m=i.getLabelFont(J),W=i.getLabel(J),b=i._selectBackground,s=n===Vn+"-vertical",O=n===qp+"-vertical";(s||O)&&(Z=e+4+o),M&&(v.globalAlpha=_j),lc(v,u,e,T,q,N),J===i._8o&&B&&(n===$l?lc(v,u,e+q-B,T,B,b):n===Vn?lc(v,u+T-B,e,B,q,b):n===qp?lc(v,u,e,B,q,b):s?lc(v,u+T-B,e,B,q,b):O?lc(v,u,e,B,q,b):lc(v,u,e,T,B,b));var r=T/2;if(s&&(bs(v,r,e+q/2),no(v,a),bs(v,-r,-e-q/2)),I){var P=Gl(I,J),k=Oo(I,J);if(s||O){var U=u+T/2,w=Z+P/2;bs(v,U,w),no(v,zp),bs(v,-U,-w),kn(v,I,u+T/2,Z+P/2,J,i),bs(v,U,w),no(v,-zp),bs(v,-U,-w),Z+=P+4}else kn(v,I,Z+k/2,e+q/2,J,i),Z+=k+4}return s||O?(bs(v,T/2,Z+T/2),no(v,zp),bs(v,-T/2,-Z-T/2),kf(v,W,m,X,u,Z,q,T),bs(v,T/2,Z+T/2),no(v,-zp),bs(v,-T/2,-Z-T/2)):kf(v,W,m,X,Z,e,T,q),s&&(bs(v,r,e+q/2),no(v,-a),bs(v,-r,-e-q/2)),J.isClosable()&&(S=O?{x:u+T-12,y:e+q-12,width:12,height:12}:{x:u+T-12,y:e+2,width:12,height:12},this.drawCloseIcon(J,v,X,S)),M&&(v.globalAlpha=1),S},drawCloseIcon:function(C,u,d,w){var m=w.x,v=w.y;u.strokeStyle=d,u.lineWidth=1,u.beginPath(),u.moveTo(m+2,v+8),u.lineTo(m+8,v+2),u.moveTo(m+8,v+8),u.lineTo(m+2,v+2),u.stroke()},getTabAt:function(b){var l=this._interactor._8Q(b);return l?l.tab:null},validateImpl:function(){var z=this;z._24o();var T,i=z._canvas,X=z._tabPosition,V=z._91O,O=z._92O,m=z._tabModel,v=z.getWidth(),J=z.getHeight(),b=z._tabHeight,S=z._7o,R=z._tabGap,I=X===$l,q=X===Vn,e=X===qp,k=X===Vn+"-vertical",D=X===qp+"-vertical",g=z._23o,y=0;if((q||e)&&m._roots.each(function(s){y=N(z.getTabWidth(s),y)}),I?(Iq(V,0,0,v,b),T={x:0,y:b,width:v,height:N(0,J-b)}):q?(Iq(V,0,0,y,J),T={x:y,y:0,width:N(0,v-y),height:J}):e?(Iq(V,v-y,0,y,J),T={x:0,y:0,width:N(0,v-y),height:J}):k?(Iq(V,0,0,b,J),T={x:b,y:0,width:N(0,v-b),height:J}):D?(Iq(V,v-b,0,b,J),T={x:0,y:0,width:N(0,v-b),height:J}):(Iq(V,0,J-b,v,b),T={x:0,y:0,width:v,height:N(0,J-b)}),Iq(O,T),k||D){z._9o&&(T.x=0,Iq(z._8o.getView(),T)),Df(i,b,J);var s=Rl(i),p=0;if(Bl(s,0,z.ty(),1),s.clearRect(0,0,b,J),S.clear(),m._roots.each(function(V){if(V.isVisible()){var y,O=z.getTabWidth(V);if(!g||g.tab!==V){var t=z.getTabBackground(V);y=z.drawTab(s,V,0,p,b,O,t)}S.add({_75o:y,tab:V,startY:p,endY:p+O,height:O}),p+=O+R}}),z._23Q=N(0,p-R),g){var f=g.position;z.drawTab(s,g.tab,0,g.startY,b,g.height,z._moveBackground),lc(s,0,f,b,1,z._insertColor)}if(s.restore(),z._selectionChanged){z._selectionChanged=!1;for(var E=z.ty(),U=0;U<S.size();U++){var C=S.get(U);if(C.tab===z._8o){if(C.endY+E<0){z.ty(-C.startY);break}if(C.startY+E>J){z.ty(J-C.endY);break}}}}z.ty(z.ty())}else if(q||e){z._9o&&(T.x=0,Iq(z._8o.getView(),T)),Df(i,y,J);var s=Rl(i),p=0;if(Bl(s,0,z.ty(),1),s.clearRect(0,0,y,J),S.clear(),m._roots.each(function(N){if(N.isVisible()){var F;if(!g||g.tab!==N){var D=z.getTabBackground(N);F=z.drawTab(s,N,0,p,y,b,D)}S.add({_75o:F,tab:N,startY:p,endY:p+b,height:b}),p+=b+R}}),z._23Q=N(0,p-R),g){var f=g.position;z.drawTab(s,g.tab,0,g.startY,y,g.height,z._moveBackground),lc(s,0,f,y,1,z._insertColor)}if(s.restore(),z._selectionChanged){z._selectionChanged=!1;for(var E=z.ty(),U=0;U<S.size();U++){var C=S.get(U);if(C.tab===z._8o){if(C.endY+E<0){z.ty(-C.startY);break}if(C.startY+E>J){z.ty(J-C.endY);break}}}}z.ty(z.ty())}else{z._9o&&(T.y=0,Iq(z._8o.getView(),T)),Df(i,v,b);var s=Rl(i),F=0;if(Bl(s,z.tx(),0,1),s.clearRect(0,0,v,b),S.clear(),m._roots.each(function($){if($.isVisible()){var X,U=z.getTabWidth($);if(!g||g.tab!==$){var I=z.getTabBackground($);X=z.drawTab(s,$,F,0,U,b,I)}S.add({_75o:X,tab:$,startX:F,endX:F+U,width:U}),F+=U+R}}),z._64I=N(0,F-R),g){var f=g.position;z.drawTab(s,g.tab,g.startX,0,g.width,b,z._moveBackground),Tm(s,z._insertColor,f,0,b)}if(s.restore(),z._selectionChanged){z._selectionChanged=!1;for(var r=z.tx(),U=0;U<S.size();U++){var C=S.get(U);if(C.tab===z._8o){if(C.endX+r<0){z.tx(-C.startX);break}if(C.startX+r>v){z.tx(v-C.endX);break}}}}z.tx(z.tx())}for(var n=[],A=O.children,U=0;U<A.length;U++){var M=A[U],u=M._tab_;u&&!m.contains(u)&&n.push(M)}n.forEach(function(U){O.removeChild(U)})}});var Dt=function(v){this.tv=v,this.addListeners()};zs(Dt,z,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(b){this.handleScroll(b,10*(b.wheelDelta/40))},handle_DOMMouseScroll:function(X){this.handleScroll(X,10*-X.detail)},handleScroll:function(t,O){fk(t);var H=this.tv,o=H._tabPosition;!H._40o()||o!==$l&&o!==ep||H.tx(this.tv.tx()+O),!H._41o()||o!==Vn&&o!==qp&&o!==Vn+"-vertical"&&o!==qp+"-vertical"||H.ty(this.tv.ty()+O)},_8Q:function(H){var f,b,G=this.tv,R=G._tabPosition,z=G._7o;if(R===$l||R===ep){var A=G.lp(H).x;for(f=0;f<z.size();f++)if(b=z.get(f),b.startX<=A&&A<=b.endX)return b}else if(R===Vn||R===qp||R===Vn+"-vertical"||R===qp+"-vertical"){var X=G.lp(H).y;for(f=0;f<z.size();f++)if(b=z.get(f),b.startY<=X&&X<=b.endY)return b}return g},isClickable:function(j){var S=this.tv,l=S._tabPosition,C=this._73o=this._8Q(j);return!S._40o()||l!==$l&&l!==ep?!S._41o()||l!==Vn&&l!==qp&&l!==Vn+"-vertical"&&l!==qp+"-vertical"?C&&(!C.tab.isDisabled()||S.isMovable()):!0:!0},handle_mousemove:function(d){var E=this;Fe?E._74o=E._8Q(d):E.getView().style.cursor=E.isClickable(d)?fg:""},handle_mousedown:function(x){this.handle_mousemove(x),this.handle_touchstart(x)},handle_touchstart:function(j){var q=this,s=q.tv,f=s._tabPosition;fk(j),ys(j)&&q.isClickable(j)&&(f===$l||f===ep?(q.x=vq(j).x,q.lp=s.lp(j),q.tx=s.tx()):(q.y=vq(j).y,q.lp=s.lp(j),q.ty=s.ty()),Nm(q,j))},handle_mouseup:function(i){this.handle_touchend(i)},handle_touchend:function(Q){if(Wl(Q)){var Z=this._73o;if(!Z)return;var e=this.tv,B=e.getTabModel(),F=Z.tab;if(!F.isDisabled()&&F.isClosable()){var i=function(){var D=B._roots.indexOf(F);B.remove(F),e.onTabClosed(F,D)};e.onTabClosing(F,i)&&i()}}},handleWindowMouseMove:function(i){this.handleWindowTouchMove(i)},handleWindowTouchMove:function(y){var z,j=this,G=j.tv,d=G._tabPosition,U=j._73o;if(d===$l||d===ep){if(z=vq(y).x-j.x,!j._25o&&!j.moving&&B(z)>2&&(G._40o()&&!wc(y)?j._25o=1:U&&G.isMovable()&&(j.moving=1)),j._25o)G.tx(j.tx+z);else if(j.moving){var q=j.lp.x+z,M=G._tabGap/2;G._7o.each(function(J){var v=J.endX,x=q-J.startX<v-q;q>=J.startX&&v>=q&&G._7Q({tab:U.tab,startX:U.startX+z,width:U.width,front:x,insertTab:J.tab,position:x?N(0,J.startX-M):Q(G._64I,v+M)})})}}else if(z=vq(y).y-j.y,!j._25o&&!j.moving&&B(z)>2&&(G._41o()&&!wc(y)?j._25o=1:U&&G.isMovable()&&(j.moving=1)),j._25o)G.ty(j.ty+z);
else if(j.moving){var t=j.lp.y+z,M=G._tabGap/2;G._7o.each(function(T){var s=T.endY,y=t-T.startY<s-t;t>=T.startY&&s>=t&&G._7Q({tab:U.tab,startY:U.startY+z,height:U.height,front:y,insertTab:T.tab,position:y?N(0,T.startY-M):Q(G._23Q,s+M)})})}},handleWindowMouseUp:function(W){this.handleWindowTouchEnd(W)},handleWindowTouchEnd:function(){var V=this,s=V.tv,d=s._tabPosition,t=s.getTabModel(),$=t._roots,H=V._73o;if(V.moving){var F=s._23o;if(F&&F.insertTab!==F.tab){var f=F.tab,T=$.remove(f),Q=$.indexOf(F.insertTab);Q>=0&&(F.front||Q++,Q<=$.size()&&($.add(f,Q),t._38I(f,T,Q)))}s._7Q(g),delete V.moving}else if(!V._25o&&H){f=H.tab;var Z=V._74o;if(!Z||Z.tab===f)if(!f.isDisabled()&&vb(H._75o,V.lp)){var P=function(){var N=$.indexOf(f);t.remove(f),s.onTabClosed(f,N)};s.onTabClosing(f,P)&&P()}else f.isDisabled()||s._8o===f||t.sm().ss(f)}V._25o=V._73o=V._74o=d===$l||d===ep?V.x=V.lp=V.tx=g:V.y=V.lp=V.ty=g}}),xt.PropertyView=function(p){var X=this;X._view=_f(1,X),X._canvas=gj(X._view),ib(X._view,X._79O=lp()),X._rows=new Yn,X._28o=new Yn,X._26o={},X._26Q={};var K=X._propertyModel=new _m,a=X.ivm;K.mm(a,X),K.md(a,X),K.mh(a,X),X.dm(p?p:new _m),new Et(X)},yt("PropertyView",z,{ms_ac:[We,as,ig,Xf,lj,"categorizable",Ab,of,ci,Hh,Vh,qd,Uo,re,"selectRowIndex",Lq,"background",ms,Dc,xj,ch,Jf],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Pf,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:fr,_background:p.propertyViewBackground,_expandIcon:p.propertyViewExpandIcon,_collapseIcon:p.propertyViewCollapseIcon,_scrollBarColor:os,_scrollBarSize:se,_autoHideScrollBar:Ye,_selectBackground:p.propertyViewSelectBackground,_rowHeight:Vp,_rowLineVisible:p.propertyViewRowLineVisible,_rowLineColor:p.propertyViewRowLineColor,_10I:.5,_columnLineVisible:p.propertyViewColumnLineVisible,_columnLineColor:p.propertyViewColumnLineColor,_labelColor:p.propertyViewLabelColor,_labelSelectColor:p.propertyViewLabelSelectColor,_labelFont:p.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(T){0>T&&(T=0),T>1&&(T=1);var y=this,z=y._10I;y._10I=T,y.fp("columnPosition",z,T)},getPropertyName:function(c){return c.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(Z,k,w){return w===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(i,o){return o===this._selectRowIndex?this._labelSelectColor:i.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(b){var C=this.getHeight()-this._59I;return C>b&&(b=C),b>0?0:A(b)},isExpanded:function(l){if(!l)return!0;var I=this._26o[l];return I?I.isExpanded:!(this._26Q[l]===!1)},toggle:function(F){var v=this;v.isExpanded(F)?v.collapse(F):v.expand(F)},expandAll:function(){this.validate();for(var e in this._26o)this.expand(e)},expand:function(F){if(F&&F!==km){var k=this,g=k._26o[F];g&&!g.isExpanded&&(g.isExpanded=!0,k.onExpanded(F),k.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var X in this._26o)this.collapse(X)},collapse:function(Z){if(Z&&Z!==km){var W=this,Q=W._26o[Z];Q&&Q.isExpanded&&(Q.isExpanded=!1,W.onCollapsed(Z),W.ivm())}},onCollapsed:function(){},getCategoryName:function(l){if(!this.isCategorizable())return km;var A=l.getCategoryName();return A?A:km},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(l){var U=this,i=U._dataModel;i!==l&&(i&&(i.umd(U.handlePropertyChange,U),U._selectionModel||i.sm().ums(U.handleSelectionChange,U)),U._dataModel=l,l.md(U.handlePropertyChange,U),U._selectionModel?U._selectionModel._21I(l):l.sm().ms(U.handleSelectionChange,U),U.fp(Mi,i,l))},isVisible:function(Y){return this._visibleFunc?this._visibleFunc(Y):!0},onPropertyChanged:function(I){var o=this,b=I.property;st[b]?o.ivm():o.iv(),b===Hq&&o._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Bn},handlePropertyChange:function(b){this._27o===b.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var o=this;o._96I||(o.setSelectRowIndex(-1),o._96I=1,o.iv())},redraw:function(){this.iv()},validateModel:function(){var O=this,T=O._rows,f=O._28o,b={},n=new Yn,V=O._27o;O.updateCurrentData(),V!==O._27o&&O.endEditing(),T.clear(),f.clear(),O.getRawProperties().each(function(Z){if(O.isVisible(Z)){n.add(Z);var P=O.getCategoryName(Z);b[P]||(f.add(P,P===km?0:s),b[P]={isExpanded:O.isExpanded(P),properties:new Yn})}}),O._sortFunc&&n.sort(O._sortFunc);for(var C in O._26o)O._26Q[C]=O.isExpanded(C);O._26o=b,f.each(function(l){l!==km&&T.add(l);var e=b[l];e.isExpanded&&n.each(function(E){O.getCategoryName(E)===l&&(e.properties.add(E),T.add({property:E,data:O._27o}))},O)})},validateImpl:function(){var S=this;S._76o(),S._96I&&(S.validateModel(),delete S._96I);var O=S._canvas,G=S.getWidth(),Z=S.getHeight(),V=-S.ty(),P=S._rowHeight,o=S._indent,N=G-o,t=S._rows,i=t.size(),e=S._9I=o+N*S._10I,s=S._59I=i*P;Df(O,G,Z),S._29I={x:0,y:V,width:G,height:Z},S._31I=l(V/P),S._14I=y((V+Z)/P),S._31I<0&&(S._31I=0),S._14I>i&&(S._14I=i);var c,X=Rl(O),m=S._background;Bl(X,0,-V,1),X.beginPath(),X.rect(0,V,G,Z),X.clip(),X.clearRect(0,V,G,Z),S._93db(X),m&&lc(X,0,0,o,s,m);for(var A=S._31I;A<S._14I;A++){var k=t.get(A),V=P*A;if(Xj(k))m&&lc(X,o,V,N,P,m),c=dg(S.isExpanded(k)?S._expandIcon:S._collapseIcon),c&&id(X,c,pq,0,V,o,P),X.save(),X.beginPath(),X.rect(o,V,N,P),X.clip(),S.drawCategoryName(X,k,A,o,V,N,P),X.restore();else{var f=k.property,j=k.data,c=dg(f.getIcon()),J=S._selectRowIndex===A?S.getSelectBackground():g;if(c&&id(X,c,pq,0,V,o,P),J&&lc(X,o,V,N,P,J),X.save(),X.beginPath(),X.rect(o,V,e-o,P),X.clip(),S.drawPropertyName(X,f,A,o,V,e-o,P),X.restore(),!S.isEditing(j,f)){var Y=e+1,h=G-e-1;X.save(),X.beginPath(),X.rect(Y,V,h,P),X.clip(),S._87o(S.drawPropertyValue(X,f,S.getValue(j,f),A,Y,V,h,P,j),A,Y,V,h,P),X.restore()}}S._rowLineVisible&&lc(X,o,V+P-1,N,1,S._rowLineColor)}S._columnLineVisible&&(lc(X,e,0,1,s,S._columnLineColor),lc(X,G-1,0,1,s)),S._92db(X),S._93I(),X.restore(),S.ty(S.ty())},drawCategoryName:function(o,V,R,Y,e,l,T){kf(o,V,this.getCategoryFont(V),this.getCategoryColor(V),Y,e,l,T)},drawPropertyName:function(i,o,K,A,p,n,y){return o.drawPropertyName?(o.drawPropertyName(i,o,K,A,p,n,y,this),void 0):(kf(i,this.getPropertyName(o),this.getPropertyFont(o,K),this.getPropertyColor(o,K),A,p,n,y),void 0)},drawPropertyValue:function(U,P,S,F,V,r,Y,i,R){return P.drawPropertyValue?P.drawPropertyValue(U,P,S,F,V,r,Y,i,R,this):(ut(U,S,P,this.getLabelFont(P,S,F),this.getLabelColor(P,S,F),V,r,Y,i,R,this),void 0)},isPropertyEditable:function(R){return R.isEditable()&&this.isEditable()},setProperties:function(r){this._propertyModel.clear(),this.addProperties(r)},addProperties:function(z){if(z){var X=this._propertyModel;z.forEach(function(h){if(!(h instanceof Bt)){var n=Uf(h.className);h=Op(n?n:Bt,h)}X.add(h)})}},getRowIndexAt:function(J){var K=this,j=l(K.lp(J).y/K._rowHeight);return j>=0&&j<K._rows.size()?j:-1},getPropertyAt:function(Q){var R=this,F=R.getRowIndexAt(Q);return F>=0?R._rows.get(F).property:g},getToolTip:function(M){var H=this,m=H.getPropertyAt(M),T=H._27o;return m&&T?m.getToolTip(T,H._9I<H.lp(M).x,H):g}});var Et=function(r){this.pv=r,this.addListeners()};zs(Et,z,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(S){this.getView().style.cursor=S},clear:function(){var _=this;_._62O=_.cp=_.ty=_.p=g,_.setCursor(Wh)},handle_mousedown:function(x){this.handle_touchstart(x)},handle_touchstart:function(n){var S=this,Y=S.pv;fk(n),Y.setFocus(n)&&(ys(n)?(S.cp=vq(n),S.ty=Y.ty(),S.p=Y.getColumnPosition(),S.handle_touchmove(n)):Y.setSelectRowIndex(Y.getRowIndexAt(n)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(C){this.handle_touchend(C)},handle_touchend:function(J){var t=this;if(t.cp&&!t._62O){var N=t.pv,T=N.lp(J),V=T.x,f=T.y,M=N._indent,e=N.getRowIndexAt(J),C=N._9I;if(e>=0){var k=N._rowHeight,s=k*e,g=N._rows.get(e),W=g.property;if(Xj(g))dg(N.isExpanded(g)?N._expandIcon:N._collapseIcon)&&V>=0&&M>=V&&f>=s&&s+k>=f?N.toggle(g):Sf(J)&&N.toggle(g);else if(V>C&&N.isPropertyEditable(W,J)){var $={x:C+1,y:s,width:N.getWidth()-C-1,height:k},_={x:$.x+N.tx(),y:$.y+N.ty(),width:$.width,height:$.height},K=0,G=N._29I;$.y<G.y?K=$.y-G.y:$.y+k>G.y+G.height&&(K=$.y+k-G.y-G.height),K&&(N.ty(N.ty()-K),_.y-=K),N.beginEditing({data:g.data,property:W,value:N.getValue(g.data,W),event:J,rect:$,editorRect:_,view:N})}}N.setSelectRowIndex(e)}t.clear()},handleWindowMouseMove:function(T){this.handleWindowTouchMove(T)},handleWindowTouchMove:function(K){var B=this,d=B.pv,p=B.ty,D=B.cp,L=vq(K),X=B._62O;if("p"===X)d.setTranslateY(p+L.y-D.y);else if("c"===X){var s=d.getWidth()-d._indent;if(s>16){var I=B.p-(D.x-L.x)/s,$=16/s;$>I&&(I=$),I>1-$&&(I=1-$),d.setColumnPosition(I)}}else"s"===X&&d.setTranslateY(p+(D.y-L.y)*d._59I/d._29I.height)},handle_mousemove:function(o){this.handle_touchmove(o)},handle_touchmove:function(l){if(!Fe&&ys(l)){var t=this,Z=t.pv,h=B(Z.lp(l).x-Z._9I)<=(Pb?8:3);t.cp?t._62O||(h?(t._62O="c",Nm(t,l)):B(vq(l).y-t.cp.y)>=2&&(t._62O=t.isV(l)?"s":"p",Nm(t,l))):(h?t.setCursor(Nk):t.setCursor(Wh),t.isV(l)&&Z._43o())}},isV:function(l){var h=this.pv,u=h._29I;return h._41o()&&u.x+u.width-h.lp(l).x<eo},handle_mousewheel:function(S){this.handleScroll(S,S.wheelDelta/40)},handle_DOMMouseScroll:function(X){2===X.axis&&this.handleScroll(X,-X.detail)},handleScroll:function(d,Z){var F=this.pv;fk(d),F.endEditing(),F.translate(0,Z*F.getRowHeight())},handle_keydown:function(F){var G=this.pv,j=G._rows.size(),V=G._selectRowIndex+(ol(F)?-1:1);(ol(F)||lg(F))&&(0>V&&(V=0),V>=j&&(V=j-1),G.setSelectRowIndex(V))}}),xt.ListView=function(o){this._5o(o),new Ft(this)},yt("ListView",z,{ms_ac:[We,as,ig,ms,Ab,Dc,xj,of,ci,qd,Uo,re,Nl,Lq],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:fr,_rowHeight:Vp,_rowLineVisible:p.listViewRowLineVisible,_rowLineColor:p.listViewRowLineColor,_scrollBarColor:os,_scrollBarSize:se,_autoMakeVisible:Ql,_autoHideScrollBar:Ye,_selectBackground:p.listViewSelectBackground,_labelColor:p.listViewLabelColor,_labelSelectColor:p.listViewLabelSelectColor,_labelFont:p.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(f){var b=this,r=b._checkMode;b._checkMode=f,b.fp(Mq,r,f)},drawRow:function(P,C,f,w,u,T,t){var l=this,J=0,r=l._indent,g=l.getIconWidth(C);l.drawRowBackground(P,C,f,w,u,T,t),l._checkMode&&(kn(P,dg(l.getCheckIcon(C)),J+r/2,u+t/2,C,l),J+=r),l.drawIcon(P,C,J,u,g,t),l.drawLabel(P,C,J+g,u,t)}});var Ft=function(J){this.list=J,this.addListeners()};zs(Ft,z,{ms_listener:1,getView:function(){return this.list._view},clear:function(X){var p=this,D=p.list;X&&"d"===p._62O&&!p.dragCancel&&D.handleDragAndDrop(X,"end"),D.draggingData&&(D.draggingData=null,D.redraw()),p.dragCancel=p._62O=p._isV=p._isH=p.cp=p.tx=p.ty=g},handle_mousedown:function(m){this.handle_touchstart(m)},handle_touchstart:function(M){var G=this,U=G.list;if(fk(M),U.setFocus(M)){var A=U.getDataAt(M);G.cp=vq(M),G.tx=U.tx(),G.ty=U.ty(),ys(M)?A&&U.handleDragAndDrop&&!G.isV(M)&&!G.isH(M)&&(U.draggingData=A,U.redraw(),U.handleDragAndDrop(M,"prepare")):(A?G._33o(M,A):this._cancelDataDoubleSelect(),G.clear(M))}},handleWindowMouseUp:function(N){this.clear(N)},handleWindowTouchEnd:function(E){this.clear(E)},handle_mouseup:function(Z){this.handle_touchend(Z)},handle_touchend:function(h){var s=this,Q=s.list;if(!s._isV&&!s._isH&&s.cp&&!s._62O){var j=Q.getDataAt(h);j?(Q.isCheckMode()?s._34o(h,j):s._33o(h,j),Sf(h)?Q.onDataDoubleClicked(j,h):Q.onDataClicked(j,h)):(s._cancelDataDoubleSelect(),Q.handleBackgroundClick(h))}s.clear(h)},handleWindowMouseMove:function(r){this.handleWindowTouchMove(r)},handleWindowTouchMove:function(f){var p=this,j=p.list,o=p._62O,e=p.tx,_=p.ty,M=p.cp,T=vq(f),b=j._29I;"p"===o?j.setTranslate(e+T.x-M.x,_+T.y-M.y):"v"===o?j.ty(_+(M.y-T.y)*j._59I/b.height):"h"===o?j.tx(e+(M.x-T.x)*j._91I/b.width):"d"===o&&(p.dragCancel||j.handleDragAndDrop(f,"between"))},handle_mousemove:function(A){this.handle_touchmove(A)},handle_touchmove:function(S){if(!Fe&&ys(S)){var C=this,d=C.list;if(C._isV=C.isV(S),C._isH=C.isH(S),C.cp){if(!C._62O){if(lr(vq(S),C.cp)<2)return;C._isV?C._62O="v":C._isH?C._62O="h":d.draggingData&&!this.dragCancel?(C._62O="d",d.handleDragAndDrop(S,"begin")):C._62O="p",C._62O&&"d"!==C._62O&&d.draggingData&&(d.draggingData=null,d.redraw()),Nm(C,S)}}else C._isV&&d._43o(),C._isH&&d._42o()}},isV:function(E){var z=this.list,B=z._29I;return z._41o()&&B.x+B.width-z.lp(E).x<eo},isH:function(A){var i=this.list,m=i._29I;return i._40o()&&m.y+m.height-i.lp(A).y<eo},handle_mousewheel:function(g){this.handleScroll(g,g.wheelDelta/40,g.wheelDelta!==g.wheelDeltaX)},handle_DOMMouseScroll:function(T){this.handleScroll(T,-T.detail,1)},handleScroll:function(p,s,v){var H=this.list;fk(p),H.endEditing&&H.endEditing(),v&&H._41o()?H.translate(0,s*H.getRowHeight()):H._40o()&&H.translate(10*s,0)},handle_keydown:function(V){if(!p.isInput(V.target)){var v,M=this.list,y=M.sm(),q=M._rows,b=q.size();if(om(V))M.selectAll();else if(Lk(V))M.handleDelete&&M.handleDelete(V);else if(Pi(V))"d"!==this._62O||this.dragCancel||(M.handleDragAndDrop(V,"cancel"),this.dragCancel=!0);else if(Wc(V))M.isCheckMode()&&(v=M.getFocusData(),v&&M.checkData(v));else if(ol(V)||lg(V)){var H=M.isCheckMode();if(v=H?M.getFocusData():y.ld()){var G=M.getRowIndex(v);G>=0&&(ol(V)?0!==G&&(v=q.get(G-1),H?M.setFocusData(v):y.ss(v)):G!==b-1&&(v=q.get(G+1),H?M.setFocusData(v):y.ss(v)))}else b>0&&(v=q.get(0),H?M.setFocusData(v):y.ss(v))}}},_34o:function(c,U){var r=this.list,v=r.lp(c).x;return v>=0&&v<=r._indent?(r.checkData(U),void 0):(r.setFocusData(U),void 0)},_33o:function(o,t){var i=this.list,M=i.sm(),$=M.ld();if(!i.canHandleSelectMode(o,t))return this._cancelDataDoubleSelect(),void 0;if(wc(o))i.isSelected(t)?M.rs(t):M.as(t);else if(te(o))if($)for(var O=i.getRowIndex($),k=i.getRowIndex(t);O!==k;)O+=k>O?1:-1,M.as(i._rows.get(O));else M.ss(t);else ys(o)?(M.contains(t)?i.handleDataDoubleSelect&&(this._handleDataDoubleSelect(o,t),Sf(o)&&this._cancelDataDoubleSelect()):this._cancelDataDoubleSelect(),M.ss(t)):M.contains(t)||M.ss(t)},_handleDataDoubleSelect:function(w,b){this._cancelDataDoubleSelect(),this._doubleSelectTimer=yo(function(){this.list.handleDataDoubleSelect(w,b),this._doubleSelectTimer=s}.bind(this),p.doubleClickSpeed)},_cancelDataDoubleSelect:function(){this._doubleSelectTimer&&(pg(this._doubleSelectTimer),this._doubleSelectTimer=s)}}),xt.TreeView=function(J){var o=this;o._35o(),o._5o(J),new Gt(o)},yt("TreeView",z,{ms_ac:[We,as,ig,"rootVisible",Mq,"rootData",of,ci,qd,Uo,re,Ab,ms,Dc,xj,Hh,Vh,Nl,Lq,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:g,_indent:fr,_rowHeight:Vp,_rowLineVisible:p.treeViewRowLineVisible,_rowLineColor:p.treeViewRowLineColor,_scrollBarColor:os,_scrollBarSize:se,_autoHideScrollBar:Ye,_expandIcon:p.treeViewExpandIcon,_collapseIcon:p.treeViewCollapseIcon,_autoMakeVisible:Ql,_selectBackground:p.treeViewSelectBackground,_labelColor:p.treeViewLabelColor,_labelSelectColor:p.treeViewLabelSelectColor,_labelFont:p.treeViewLabelFont,_doubleClickToToggle:p.treeViewDoubleClickToToggle,drawRow:function(e,o,l,b,s,i,m){var M=this;M.drawRowBackground(e,o,l,b,s,i,m),M.drawTree(e,o,l,0,s,i,m)},isOnToggleIcon:function(Y){var F=this.getDataAt(Y);if(F){var L=this.getIndent(),m=this.lp(Y).x;if(dg(this.getToggleIcon(F))){var h=L*this.getLevel(F);if(m>=h&&h+L>=m)return!0}}return!1}});var Gt=function(v){$e(Gt,this,[v])};zs(Gt,Ft,{toggle:function(D,v,z,s){var J=this.list,G=J.lp(D).x;if(dg(J.getToggleIcon(v))){var p=z*s;if(G>=p&&p+z>=G)return J.toggle(v),!0}return J.isDoubleClickToToggle()&&Sf(D)?(J.toggle(v),!0):!1},_34o:function(u,n){var H=this.list,J=H.lp(u).x,p=H._levelMap[n._id],S=H._indent,B=S*(p+1);return J>=B&&B+S>=J?(H.checkData(n),void 0):(this.toggle(u,n,S,p)||H.setFocusData(n),void 0)},_33o:function(i,u){var w=this,o=w.list;if(!w.toggle(i,u,o._indent,o.getLevel(u)))if(te(i)){var M=o.sm();if(M.size()>0){for(var d=o._rows,I=null,R=0,W=d.size();W>R;R++)if(o.isSelected(d.get(R))){I=R;break}for(var g=null,R=d.size()-1;R>=0;R--)if(o.isSelected(d.get(R))){g=R;break}var l,h,Y=o.getRowIndex(u);for(I>Y?(l=Y-1,h=I):Y>g?(l=g,h=Y):(l=I,h=g);l!==h;)l++,M.as(o._rows.get(l))}else M.ss(u)}else Gt.superClass._33o.call(w,i,u)},handle_keydown:function(n){if(qh(n)||Nf(n)){var $=this.list,T=$._rows,A=$.isCheckMode(),x=$.sm(),r=A?$.getFocusData():x.ld();r?r.hasChildren()&&(qh(n)?$.collapse(r):$.expand(r)):T.size()>0&&(r=T.get(0),A?$.setFocusData(r):x.ss(r))}else Gt.superClass.handle_keydown.call(this,n)}});var Ht=xt.TableView=function(O){this._98I(),this._5o(O),new It(this)};yt("TableView",z,{ms_ac:[We,as,ig,"sortMode",Xf,lj,ms,Dc,xj,ch,Jf,"sortColumn",of,ci,qd,Uo,re,Nl,Lq],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:ne,_editable:!0,_batchEditable:!1,_rowHeight:Vp,_rowLineVisible:p.tableViewRowLineVisible,_rowLineColor:p.tableViewRowLineColor,_columnLineVisible:p.tableViewColumnLineVisible,_columnLineColor:p.tableViewColumnLineColor,_scrollBarColor:os,_scrollBarSize:se,_autoHideScrollBar:Ye,_autoMakeVisible:Ql,_selectBackground:p.tableViewSelectBackground,_labelColor:p.tableViewLabelColor,_labelSelectColor:p.tableViewLabelSelectColor,_labelFont:p.tableViewLabelFont,getCheckColumn:function(){var Z=this;if(!Z._31o){var o=Z._31o=new At;o.setEditable(!0),o.setWidth(40),o.getValue=Z.getCheckColumValue,o.drawCell=Z.drawCheckColumnCell}return Z._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(A){var P=this,u=P._39o,o=P.getCheckColumn();A!==P.isCheckMode()&&(A?u.add(o,0):u.remove(o),P.fp(Mq,!A,A))},getCheckColumValue:function(l,b,Q){return Q.isSelected(l)},drawCheckColumnCell:function(Q,t,o,v,g,f,R,C,s){kn(Q,s.getCheckIcon(t),g+R/2,f+C/2,t,s)}});var It=function(m){$e(It,this,[m])};zs(It,Ft,{_34o:function(I,v){var f=this.list,i=f._31o;if(f.isCellEditable(v,i,I)){var j=f._3Q(i),o=f.lp(I).x;if(j&&o>=j.startX&&o<j.startX+i.getWidth())return f.checkData(v),void 0}f._37O(v,I),f.setFocusData(v)},_33o:function(l,$){this.list._37O($,l),It.superClass._33o.apply(this,arguments)}});var Jt=xt.TreeTableView=function(Y){var t=this,q=t._4o=new At;t._35o(),t._98I(),t._5o(Y),q.setDisplayName("Name"),q.setEditable(!0),q.setWidth(180),q.drawCell=Kt,q.getValue=Lt,t._39o.add(q),new Mt(t)},Kt=function(x,J,W,U,E,p,F,e,N){N.drawTree(x,J,W,E,p,F,e)},Lt=function(r,K,i){return i.getLabel(r)};yt("TreeTableView",z,{ms_ac:[We,as,ig,"sortMode",Xf,lj,Ab,Mq,"rootData","rootVisible",of,ci,"sortColumn",Hh,Vh,qd,Uo,re,Nl,xj,ms,Dc,ch,Jf,Lq,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:ne,_checkMode:g,_editable:!0,_batchEditable:!1,_indent:fr,_rowHeight:Vp,_rowLineVisible:p.treeTableViewRowLineVisible,_rowLineColor:p.treeTableViewRowLineColor,_columnLineVisible:p.treeTableViewColumnLineVisible,_columnLineColor:p.treeTableViewColumnLineColor,_expandIcon:p.treeTableViewExpandIcon,_collapseIcon:p.treeTableViewCollapseIcon,_scrollBarColor:os,_scrollBarSize:se,_autoHideScrollBar:Ye,_autoMakeVisible:Ql,_selectBackground:p.treeTableViewSelectBackground,_labelColor:p.treeTableViewLabelColor,_labelSelectColor:p.treeTableViewLabelSelectColor,_labelFont:p.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Mt=function(A){$e(Mt,this,[A])};zs(Mt,Ft,{_34o:function(f,I){var O=this.list,E=O._4o,q=O._3Q(E),V=O.lp(f).x;if(q){var g=O._indent,B=q.startX+g*O.getLevel(I);if(dg(O.getToggleIcon(I))&&V>=B&&B+g>=V)return O.toggle(I),void 0;if(O.isCellEditable(I,E)&&(B+=g,V>=B&&B+g>=V))return O.checkData(I),void 0}O._37O(I,f),O.setFocusData(I)},_33o:function(U,j){var v=this.list,q=v.lp(U).x;if(dg(v.getToggleIcon(j))){var f=v._3Q(v._4o);if(f){var i=v._indent,P=f.startX+i*v.getLevel(j);if(q>=P&&P+i>=q)return v.toggle(j),void 0}}v._37O(j,U),Mt.superClass._33o.apply(this,arguments)}});var Nt=xt.TableHeader=function(u){var S=this,d=S._view=_f(1,S),n=S._39o=u.getColumnModel(),j=S.iv;S.tv=S._tableView=u,S._60I=new Yn,S._canvas=gj(d),d.style.background=p.tableHeaderBackground||"",d.style.height=sl+zk,n.mm(j,S),n.md(j,S),n.mh(j,S),u.mp(function(o){ot[o.property]&&S.iv()},S),new Ot(S),S.iv()};yt("TableHeader",z,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",We,ig,Ab,"moveBackground","insertColor",ch,Jf,"resizable","movable"],_checkIcon:Qk,_movable:!0,_resizable:!0,_labelColor:p.tableHeaderLabelColor,_labelFont:p.tableHeaderLabelFont,_columnLineColor:p.tableHeaderColumnLineColor,_columnLineVisible:p.tableHeaderColumnLineVisible,_sortDescIcon:p.tableHeaderSortDescIcon,_sortAscIcon:p.tableHeaderSortAscIcon,_moveBackground:p.tableHeaderMoveBackground,_insertColor:p.tableHeaderInsertColor,_indent:fr,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(N){return N.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(F){return F.getColor()||this._labelColor},getLabelAlign:function(x){return x._align},onPropertyChanged:function(){this.iv()},_5Q:function(L){this._61I=L,this.iv()},getLogicalPoint:function(m){return dc(m,this._canvas,this.tv.tx())},validateImpl:function(){var X=this,w=X._canvas,r=X.getWidth(),b=X.getHeight(),h=X.tv,I=X._60I,k=X._61I,O=-h.tx(),y=0;(r!==w.clientWidth||b!==w.clientHeight)&&Df(w,r,b),I.clear(),X._39o._roots.each(function(S){if(S.isVisible()){var M=y+S.getWidth();O+r>=y&&M>=O&&I.add({column:S,startX:y}),y=M}});var d=Rl(w);if(Bl(d,-O,0,1),d.beginPath(),d.rect(O,0,r,b),d.clip(),d.clearRect(O,0,r,b),I.each(function(Q){var H=Q.column,D=Q.startX,$=H.getWidth();$>0&&(d.save(),d.beginPath(),d.rect(D,0,$,b),d.clip(),k&&k.column===H||X.drawColumn(d,H,D,0,$,b),X._columnLineVisible&&lc(d,D+$-1,0,1,b,X._columnLineColor),d.restore())}),k){var q=k.column,y=k.startX,L=k.position,j=q.getWidth();d.save(),d.beginPath(),d.rect(y,0,j,b),d.clip(),d.fillStyle=X._moveBackground,d.fill(),X.drawColumn(d,q,y,0,j,b),d.restore(),Tm(d,X._insertColor,L,0,b)}d.restore()},_6Q:function(H){var M=this.tv;return M._31o===H&&M.sm().getSelectionMode()===Bm},drawColumn:function(V,O,$,C,R,J){var X=this,m=X.tv,Q=dg(O.getIcon()),l=X.getLabelAlign(O);if(X._6Q(O)){var k=dg(X._checkIcon);kn(V,k,$+R/2,C+J/2,O,X)}else{var b=X.getLabel(O),d=X.getLabelFont(O),G=X.getLabelColor(O),D=Lr(d,b).width,_=Q?X._indent:0;l===Vn?(Q&&id(V,Q,pq,$,C,_,J),kf(V,b,d,G,$+_,C,R,J,Vn)):l===qp?(Q&&id(V,Q,pq,$+R-D-_,C,_,J),kf(V,b,d,G,$,C,R,J,qp)):(Q&&id(V,Q,pq,$+(R-D-_)/2,C,_,J),kf(V,b,d,G,$+(R-D+_)/2,C,0,J,Vn))}if(O.isSortable()&&m.getSortColumn()===O&&(Q=dg(O.getSortOrder()===Oc?X._sortAscIcon:X._sortDescIcon))){var q=Oo(Q,O)/2+2;kn(V,Q,l===qp?$+q:$+R-q,C+J/2,O,m)}}});var Ot=function(B){var X=this;X.th=B,X.tv=B._tableView,X.addListeners()};zs(Ot,z,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(D){this.getView().style.cursor=D},handle_mousemove:function(A){if(!Fe){var o=this;delete o._29o,o.setCursor(Wh);for(var l=o.th,_=l._60I,N=l.lp(A).x,M=_.size()-1;M>=0;M--){var y=_.get(M),R=y.column,n=y.startX+R.getWidth();if(l.isResizable()&&B(n-N)<=(Pb?10:3))return o._29o=y,o.setCursor(Nk),void 0;N>y.startX&&n>N&&(o._29o=y),(R.isClickable()||R.isSortable()||l.isMovable()||o.tv.getCheckColumn&&R===o.tv.getCheckColumn())&&N>y.startX&&n>N&&o.setCursor(fg)}}},handle_mousedown:function(r){this.handle_touchstart(r)},handle_touchstart:function(D){var q=this;fk(D),q.tv.endEditing(),q.handle_mousemove(D),q._29o&&(q.x=vq(D).x,q.lx=q.th.lp(D).x,q.w=q._29o.column.getWidth(),Nm(q,D))},handleWindowMouseMove:function(l){this.handleWindowTouchMove(l)},handleWindowTouchMove:function(N){var R=this,u=R.th,k=R.getView().style.cursor,T=R._29o,P=vq(N).x-R.x;if(R.resizing||R.moving||(k===Nk?R.resizing=1:u.isMovable()&&k===fg&&B(P)>2&&(R.moving=1)),R.resizing)T.column.setWidth(R.w+P);else if(R.moving){var f=R.lx+P;u._60I.each(function(Y){var G=Y.startX,p=G+Y.column.getWidth();if(f>=G&&p>=f){var t={column:T.column,startX:T.startX+P,front:p-f>f-G,insertColumn:Y.column};t.position=t.front?G:p,u._5Q(t)}})}},_16Q:function(e,r){var K=this,p=K.tv,N=K.th,s=N._checkIcon;if(N._6Q(e)){var q=dg(s),Y=K.lx,W=e.getWidth(),x=Oo(q,e);if(Y>=r+W/2-x&&r+W/2+x>=Y){N.setCheckIcon(s===fm?Qk:fm);var M=p.sm(),T=p._rows;return s===fm?M.rs(T):M.ss(T),p.onCheckColumnClicked(e),!0}}return!1},handleWindowMouseUp:function(p){this.handleWindowTouchEnd(p)},handleWindowTouchEnd:function(Z){var B=this,i=B.tv,R=B.th,M=B._29o;if(B.moving){var f=R._61I;if(f&&f.insertColumn!==f.column){var X=f.column,j=i.getColumnModel()._roots,N=j.remove(X),q=j.indexOf(f.insertColumn);q>=0&&(f.front||q++,q<=j.size()&&(j.add(X,q),i.getColumnModel()._38I(X,N,q)))}R._5Q(g),delete B.moving}else if(!B.resizing&&M){X=M.column;var z=R.lp(Z).x,t=M.startX,l=!0;if(R.onColumnClicked){var y=R.onColumnClicked(X,Z,t);y===!1&&(l=!1)}if(l&&z>=t&&z<=t+X.getWidth()&&!B._16Q(X,t)){if(X.isSortable()){var W=i.getSortMode(),m=X.getSortOrder();W===ne?i.getSortColumn()===X?(m===Hr&&i.setSortColumn(g),X.setSortOrder(m===Oc?Hr:Oc)):i.setSortColumn(X):"bistate"===W&&(i.getSortColumn()===X?X.setSortOrder(m===Oc?Hr:Oc):i.setSortColumn(X))}i.onColumnClicked(X,Z,t)}}B._29o=B.resizing=B.x=B.lx=B.w=g}}),xt.TablePane=function(o){this.init(new Ht(o))},yt("TablePane",z,{ms_v:1,_44o:1}),xt.TreeTablePane=function(r){this.init(new Jt(r))},yt("TreeTablePane",z,{ms_v:1,_44o:1}),xt.Toolbar=function(P){var A=this,E=A._view=_f(1,A),V=E.style;V.background=p.toolbarBackground||"",V.height=Go+zk,A._canvas=gj(E),A._30o=new Yn,A._90I=new Yn,A.setItems(P||[]),E.handleGroupSelectedChanged=function(G){if(G.isSelected()){var g=G.getGroupId();null!=g&&A._items.forEach(function(z){var y=z.element;y&&y!==G&&y.setSelected&&y.getGroupId&&y.getGroupId()===g&&y.setSelected(!1)})}},new Pt(A)},yt("Toolbar",z,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[cs,We,ig,as,Lq,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:p.toolbarLabelColor,_labelSelectColor:p.toolbarLabelSelectColor,_labelFont:p.toolbarLabelFont,_selectBackground:p.toolbarSelectBackground,_itemGap:p.toolbarItemGap,_separatorColor:p.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(a){var d=this.getItemInfoAt(a);return d?d.item.toolTip:g},getLabelColor:function(G){return G&&G.selected&&G.type!==fm&&G.type!==ng?this._labelSelectColor:this._labelColor},onPropertyChanged:function(M){this.iv(),M.property===cs&&this._items.forEach(function(f){Ff(f)})},redraw:function(){this.iv()},addItem:function(n,S){var d=this._items;S==g?d.push(n):d.splice(S,0,n),this.fp(cs,g,d)},removeItem:function(E){if(E)for(var Y=this._items,l=0;l<Y.length;l++)E===Y[l]&&(Y.splice(l,1),this.fp(cs,g,Y))},removeItemById:function(Q){if(Q!=g)for(var Y=this._items,x=0;x<Y.length;x++)if(Q===Y[x].id){var X=Y.splice(x,1)[0];return this.fp(cs,g,Y),X}},getItemById:function(x){if(x!=g)for(var E=this._items,f=0;f<E.length;f++){var F=E[f];if(x===F.id)return F}},setItemVisible:function(s,E){var S=this.getItemById(s);S&&(S.visible=E)},getItemInfos:function(){return this._30o},getItemInfoAt:function(f){var U=this,h=0,I=U._30o,D=U.lp(f),i=D.x,Q=D.y;if(Q>=0&&Q<=U.getHeight())for(;h<I.size();h++){var u=I.get(h);if(u.startX<=i&&i<=u.endX)return u}return g},drawItem:function(S,x,O,u,_){if(x.visible===!1)return 0;if(qr(x.visible)&&!x.visible())return 0;var U=this,M=x.disabled;M&&(S.globalAlpha=_j);var R=U.drawItemImpl(S,x,O,u,_),T=U._itemGap;return M&&(S.globalAlpha=1),this._currentItem!==x||"separator"===x||x.separator===!0||x.unfocusable||El(S,U._separatorColor,O-T/2,0,R+T,u),R},drawItemImpl:function(X,V,T,$,E){var Z=this,m=Z._view,w=Z._itemGap,v=$/2,h=V.type,C=V.element,W=V.label;Xj(C)&&(W=C,C=g);var i,p=Z.getLabelFont(V),H=Z.getLabelColor(V),u=V.selected,z=dg(V.icon),j=Oo(z,V),O=0,F=j+(W?Lr(p,W).width:0);if("separator"===V||V.separator===!0)return Tm(X,Z._separatorColor,T,$/4,v),1;if(C){z&&kn(X,z,T+j/2,v,V,Z),kf(X,W,p,H,T+j,0,0,$);var t=yh(C);E||Z._90I.add(t),t.parentNode!==m&&ib(m,t),C.iv&&C.iv(),C.validate&&C.validate();var S=t.getBoundingClientRect(),o=S.width,k=t.style;return Ym(t),k.left=Z.tx()+T+F+zk,k.top=($-S.height)/2+zk,F+o}return h===ng?i=dg(u?Rn:Zf):h===fm&&(i=dg(u?fm:Qk)),i?(O=Oo(i,V),kn(X,i,T+O/2,v,V,Z),T+=O,F+=O):u&&lc(X,T-w/2,0,F+w,$,Z.getSelectBackground(V)),z&&kn(X,z,T+j/2,v,V,Z),kf(X,W,p,H,T+j,0,0,$),F},validateImpl:function(){var v=this,Q=v._canvas,L=v.getWidth(),o=v.getHeight(),E=v._30o,$=v._items;Df(Q,L,o);var I=Rl(Q),K=v._itemGap,l=K/2;Bl(I,v.tx(),0,1),I.clearRect(0,0,L,o);var m=v._90I;v._90I=new Yn,E.clear(),$.forEach(function(D){var C=v.drawItem(I,D,l,o);E.add({item:D,startX:l,endX:l+C,width:C}),C&&(l+=C+K)}),m.each(function(s){v._90I.contains(s)||cn(s)});var g=v._64I;v._64I=N(0,l-K/2),I.restore(),v._stickToRight?(v._65O=0,I=Rl(Q),l=L-v._64I+K/2,Bl(I,0,0,1),I.clearRect(0,0,L,o),E.clear(),$.forEach(function(J){var L=v.drawItem(I,J,l,o,!0);E.add({item:J,startX:l,endX:l+L,width:L}),L&&(l+=L+K)}),I.restore()):v.tx(v.tx()),g!==v._64I&&v.onSumWidthChanged(g,v._64I)},onSumWidthChanged:function(){},handleClick:function(Y,N){var e=this,J=Y.type,I=Y.action,C=Y.groupId,c=Y.selected;Y.disabled||(C!=g?c||(Y.selected=!0,this._items.forEach(function(J){J.groupId===C&&Y!==J&&(J.selected=!1)}),I&&Y.action(Y,e,N)):J===fm||"toggle"===J?(Y.selected=!c,I&&Y.action(Y,e,N)):I&&Y.action(Y,e,N)),Pm(),e.iv()}});var Pt=function(h){this.tb=h,this.addListeners()};zs(Pt,z,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(z){this.handleScroll(z,10*(z.wheelDelta/40))},handle_DOMMouseScroll:function(u){this.handleScroll(u,10*-u.detail)},handleScroll:function(p,q){fk(p);var N=this.tb;N.isScrollable()&&!N._stickToRight&&(N.tx(N.tx()+q),mf())},handle_mousemove:function(a){var n=this;Fe||n.setItem(a)},handle_mouseout:function(y){var G=this;y.target===G.getView()?G.tb.setCurrentItem(g):G.handle_mousemove(y)},handle_mousedown:function(w){this.handle_mousemove(w),this.handle_touchstart(w)},handle_touchstart:function(T){var j=this,K=j.tb,y=T.target;ys(T)&&(y===j.getView()||y===K._canvas)&&(fk(T),K.setFocus(T)&&(this.setItem(T,!0),(K.isScrollable()||j.info&&!j.info.item.disabled)&&(j.x=vq(T).x,j.tx=K.tx(),Nm(j,T))))},handleWindowMouseMove:function(y){this.handleWindowTouchMove(y)},handleWindowTouchMove:function(S){var I=this,Q=I.tb;if(!Q._stickToRight){var s=vq(S).x-I.x;!I._25o&&B(s)>2&&Q.isScrollable()&&(I._25o=1),I._25o&&Q.tx(I.tx+s)}},handleWindowMouseUp:function(D){this.handleWindowTouchEnd(D)},handleWindowTouchEnd:function(l){var p=this,a=p.tb,o=p.info,q=p.tb.getItemInfoAt(l);if(!p._25o&&o){var I=o.item;q&&q.item===I&&a.handleClick(I,l)}p._25o=p.x=p.tx=g,p.setItem()},setItem:function(i,D){var j=this,w=j.tb,u=j.info=i?w.getItemInfoAt(i):g,R=u?u.item:g;w.setCurrentItem(R),D&&R&&qr(R.onDown)&&R.onDown(i)}}),xt.BorderPane=function(){this._view=_f(1,this),this.iv()},yt("BorderPane",z,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(G,c){this._12o("leftView",G),c!=g&&this.setLeftWidth(c)},getRightView:function(){return this._rightView},setRightView:function(z,n){this._12o("rightView",z),n!=g&&this.setRightWidth(n)},getTopView:function(){return this._topView},setTopView:function(j,b){this._12o("topView",j),b!=g&&this.setTopHeight(b)},getBottomView:function(){return this._bottomView},setBottomView:function(Y,d){this._12o("bottomView",Y),d!=g&&this.setBottomHeight(d)
},getCenterView:function(){return this._centerView},setCenterView:function(R){this._12o("centerView",R)},_12o:function(Y,B){var X=this,E="_"+Y,K=X._view,k=X[E];k!==B&&(k&&(k.getView?cn(k.getView()):cn(k)),X[E]=B,B&&(B.getView?ib(K,B.getView(),1):ib(K,B,1)),X.fp(Y,k,B))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var Z=this,v=Z._topView,F=Z._bottomView,K=Z._leftView,G=Z._rightView,H=Z._centerView,O=Z.getWidth(),U=Z.getHeight(),u=0,z=0,w=O,r=U,i=0,S=0,s=0,M=0;v&&(i=Z._topHeight==g?ri(v):Z._topHeight,z=i),F&&(S=Z._bottomHeight==g?ri(F):Z._bottomHeight,r=U-S),K&&(s=Z._leftWidth==g?dr(K):Z._leftWidth,u=s),G&&(M=Z._rightWidth==g?dr(G):Z._rightWidth,w=O-M);var D=N(0,w-u),l=N(0,r-z);v&&Iq(v,0,0,O,i),F&&Iq(F,0,r,O,S),K&&Iq(K,0,z,s,l),G&&Iq(G,w,z,M,l),H&&Iq(H,u,z,D,l)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);