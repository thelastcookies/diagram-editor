!function(F,j,s){"use strict";function M(){this.el=[1,0,0,0,1,0,0,0,1]}function y(f){var q={};return{get:function(N){if(q[N]!==s)return q[N];var K;switch(N){case"WEBGL_depth_texture":K=f.getExtension("WEBGL_depth_texture")||f.getExtension("MOZ_WEBGL_depth_texture")||f.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":K=f.getExtension("EXT_texture_filter_anisotropic")||f.getExtension("MOZ_EXT_texture_filter_anisotropic")||f.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":K=f.getExtension("WEBGL_compressed_texture_s3tc")||f.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||f.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":K=f.getExtension("WEBGL_compressed_texture_pvrtc")||f.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":K=f.getExtension("WEBGL_compressed_texture_etc1");break;default:K=f.getExtension(N)}return q[N]=K,K}}}function d(G,g,o){function t(){if(H!==s)return H;var A=g.get("EXT_texture_filter_anisotropic");return H=null!==A?G.getParameter(A.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function O(W){if("highp"===W){if(G.getShaderPrecisionFormat(G.VERTEX_SHADER,G.HIGH_FLOAT).precision>0&&G.getShaderPrecisionFormat(G.FRAGMENT_SHADER,G.HIGH_FLOAT).precision>0)return"highp";W="mediump"}return"mediump"===W&&G.getShaderPrecisionFormat(G.VERTEX_SHADER,G.MEDIUM_FLOAT).precision>0&&G.getShaderPrecisionFormat(G.FRAGMENT_SHADER,G.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var H;o=o||{};var B="undefined"!=typeof WebGL2RenderingContext&&G instanceof WebGL2RenderingContext,a=o.precision!==s?o.precision:"highp",j=O(a);j!==a&&(console.warn("WebGL:",a,"not supported, using",j,"instead."),a=j);var T=o.logarithmicDepthBuffer===!0,$=G.getParameter(G.MAX_TEXTURE_IMAGE_UNITS),i=G.getParameter(G.MAX_VERTEX_TEXTURE_IMAGE_UNITS),K=G.getParameter(G.MAX_TEXTURE_SIZE),A=G.getParameter(G.MAX_CUBE_MAP_TEXTURE_SIZE),x=G.getParameter(G.MAX_VERTEX_ATTRIBS),W=G.getParameter(G.MAX_VERTEX_UNIFORM_VECTORS),P=G.getParameter(G.MAX_VARYING_VECTORS),N=G.getParameter(G.MAX_FRAGMENT_UNIFORM_VECTORS),h=i>0,f=B||!!g.get("OES_texture_float"),Y=h&&f,z=B?G.getParameter(G.MAX_SAMPLES):0;return{getMaxAnisotropy:t,getMaxPrecision:O,precision:a,logarithmicDepthBuffer:T,maxTextures:$,maxVertexTextures:i,maxTextureSize:K,maxCubemapSize:A,maxAttributes:x,maxVertexUniforms:W,maxVaryings:P,maxFragmentUniforms:N,vertexTextures:h,floatFragmentTextures:f,floatVertexTextures:Y,maxSamples:z}}var E="ht";if(!F[E]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),F.performance&&F.performance.now||function(){var e=Date.now();F.performance||(F.performance={}),F.performance.now=function(){return Date.now()-e}}();for(var e=Date.now(),C=16,N=["ms","moz","webkit","o"],d=0;d<N.length&&!F.requestAnimationFrame;++d)F.requestAnimationFrame=F[N[d]+"RequestAnimationFrame"],F.cancelAnimationFrame=F[N[d]+"CancelAnimationFrame"]||F[N[d]+"CancelRequestAnimationFrame"];F.requestAnimationFrame||(F.requestAnimationFrame=function(p){var G=Date.now(),x=C+e-G;return 0>x&&(x=0),e=G,F.setTimeout(function(){e=Date.now(),p(performance.now())},x)}),F.cancelAnimationFrame||(F.cancelAnimationFrame=function(n){return F.clearTimeout(n)}),j.assign===s&&(j.assign=function(p){if(p===s||null===p)throw new TypeError("Cannot convert undefined or null to object");for(var G=j(p),n=1;n<arguments.length;n++){var D=arguments[n];if(D!==s&&null!==D)for(var Y in D)j.prototype.hasOwnProperty.call(D,Y)&&(G[Y]=D[Y])}return G})}();var B=F.document,i=null,r=F[E]={},p=F[E+"config"],z=r.Default=p&&p.Default||{},q=r.Style=p&&p.Style||{},A=r.Attr=p&&p.Attr||{},f=r.Color=p&&p.Color||{},S=r.IsGetter=p&&p.IsGetter||{};!function(){var $=!1;try{var L=j.defineProperty({},"passive",{get:function(){$=!0}});F.addEventListener("test",L,L),F.removeEventListener("test",L,L)}catch(I){$=!1}z.passiveSupported=$}();var T,n,v,C,D=z.passiveSupported,c=z.eventListenerOptionsFalse=D?{passive:!1,capture:!1}:!1,h=z.eventListenerOptionsTrue=D?{passive:!1,capture:!0}:!0,Z=function(u,U,A,B){u.addEventListener(U,A,B?h:c)},m=function(q,U,Z,A){q.removeEventListener(U,Z,A?h:c)},W=Math,G=W.round,O=W.floor,H=W.ceil,k=W.sqrt,$=W.max,_=W.min,R=W.abs,X=W.cos,I=W.acos,U=W.sin,V=W.pow,l=W.asin,J=W.PI,b=2*J,L=J/2,N=W.tan,K=W.atan2,w=W.random,P=W.log,t=!1,a=!1,u=F.parseInt||global.parseInt,g="2020-06-15",Q=F.navigator?F.navigator.platform.indexOf("Win")>-1:!1,o=function(V){return V*V},e=F.setTimeout,Y=F.clearTimeout,x=F.location,Uc=F.navigator?F.navigator.userAgent.toLowerCase():"",ed=function(k){return k.test(Uc)},Dp=ed(/msie/),Ph=ed(/msie/)||ed(/trident/),uk=ed(/msie 10/),Fp=ed(/edge/),Rr=ed(/firefox/),qi=ed(/mac/),Aj=z.isTouchable===s?Q?!1:B?"ontouchend"in B:!1:z.isTouchable,jp="default",vl="single",rl="multiple",wg="front",xs="back",br="left",lk="right",bm="top",Lp="bottom",io="center",Hh="eye",Tr="middle",Eh="east",ds="west",Br="north",Gi="none",De="px",rn="absolute",We="border",gc="triangle",kk="rect",oj="circle",Gd="cylinder",rd="shape",bb="items",ne="normal",lb="remove",th="clear",as="width",wr="height",$r="ingroup",vg="check",Ic="uncheck",Qg="radio",Bd="radioOn",Gf="radioOff",hb="points",fr="values",bs="series",Oj="body",Kr="label",al="label2",ol="note",Al="note2",Wj="icons",ni="labelFont",je="labelColor",vk="labelSelectColor",ih="note.expanded",aq="note2.expanded",Hl="edge.expanded",yf="edge.points",$o="edge.type",oq="rotation",jg="hidden",mf="visible",ve="tuv",on="no",Rg="draw",Hg="select",ys="currentSubGraph",te="selectBackground",lh="autoMakeVisible",cr="autoHideScrollBar",om="scrollBarColor",Zj="scrollBarSize",Dl="indent",hm="rowHeight",_d="columnLineColor",Hn="rowLineColor",Hm="columnLineVisible",ee="rowLineVisible",Yq="visibleFunc",jb="expandIcon",sn="collapseIcon",mb="checkMode",Ki="sortFunc",Qj="editable",Si="batchEditable",ho="tristate",hd="asc",$h="desc",Up="position",Cf="elevation",Ll="children",Bl="translateX",Fq="translateY",so="dataModel",ql="maxSize",pg="state",il="shape3d",Xe="shape3d.resolution",ki="shape3d.visible",cm="shape3d.from.visible",bl="shape3d.to.visible",Ul="shape3d.top.visible",jr="shape3d.bottom.visible",Cs="repeat.uv.length",Nh="serializeValue",fc="deserializeValue",ci="centerUniform",uq="uniform",Bq="rgba(255,255,255,0)",dp="style",Lj="attr",Gr="field",Fi="string",ck="boolean",nb="color",Vd="int",wb="number",ko="ew-resize",wd="ns-resize",zc="pointer",bc="auto",yr="mousedown",_h="mousemove",ar="mouseup",lc="mouseout",Do="touchstart",me="touchmove",Mh="touchend",tk="keydown",Rc="keyup",Sf=["DOMMouseScroll","mousewheel"],pm=Rr?Sf[0]:Sf[1],Ip=Aj?[Do,me,Mh,tk,Rc,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[tk,Rc,"keypress","input",yr,_h,ar,lc,pm,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],uf=i,ae=i,lq=i,Yr=ar.length,Zl=function(){lq&&(Y(lq.timeout),lq=i)},dl=function(){lq&&rq(lq.e,lq.info)};F.addEventListener&&(Aj||(Z(F,lc,function(){Zl()}),Z(F,pm,function(){Ui()})),Z(F,Rc,function(C){91===C.keyCode?kp={}:delete kp[C.keyCode]},!0),Z(F,tk,function(q){kp[q.keyCode]=!0},!0),Z(F,"blur",function(){kp={}}));var sl,$m,mo,Ji=0,sk=i,Ec=function(t,Y){var F=e(function(){delete sk[F],rg(sk)&&(sk=i),t()},Y);return F},Db=i,vm=i,ue={},Ff={},lp={},Kc={},ls={},kp={},Ah={},Yo={},Jc={},sp={},cp=/.json$/,uo=/^data:image\/svg\+xml/,Er={},zq=[],ej={},Tn=i,Rf=i,$i=function(){},Nn=function(){throw"Oops!"},Gh=[0,0,0],qm={x:0,y:0,width:0,height:0},Jj=i,we=i,Uj=i,lf=function(t,I){Ff[t]=I,I&&I.comps&&!I.uuid&&(I.uuid=r.Math.generateUUID()),le[t]&&(I.cacheRule=le[t],delete le[t])},tb=function(G){we&&!G._72O&&(Uj||(Uj={}),Uj[G._72O=xj()]=G),sl!=i?Sq()<.05&&C&&!$m&&(kb=Zl):kb=Zo},Zm=function(c,h,p,x){we||(we={});var $=we[c];if($){if($.url===h)return;$.image?($.image.onload=$i,$.image.onerror=$i):$.request&&($.request.onload=$i,$.request.onerror=$i)}if(cp.test(h)){var U=new Lr;if(we[c]={request:U,url:h},h=z.beforeLoadURL(h),h.data){var Z=z.parse(h.data);Ur(c,Z),z.handleImageLoaded(c,Z)}else{U.onload=function(){if(200===this.status||0===this.status){var t=z.parse(U.getResponseText());Ur(c,t),z.handleImageLoaded(c,t)}else Ur(c,z.handleUnfoundImage(c,h)||i)},U.onerror=function(){Ur(c,z.handleUnfoundImage(c,h)||i)};var K={};K.url=encodeURI(h),K.sync=!1,U.send(K)}}else{var Z=new Image;we[c]={image:Z,url:h},/^data:image/.test(h)||(h=z.beforeLoadURL(h),h=z.appendTimeStamp(h),h=encodeURI(h),Z.crossOrigin=z.crossOrigin),z.convertImageSrc(h,function(U){Ph&&(h.toLowerCase().indexOf(".svg")>0||uo.test(h))?(B.body.appendChild(Z),Z.style.visibility="hidden",Z.onload=function(){e(function(){if(p&&(Z.width=p),x&&(Z.height=x),!Z.width||!Z.height){var b=Z.width||Z.clientWidth,T=Z.height||Z.clientHeight;Z.width=b,Z.height=T}z.handleImageLoaded(c,Z),Ur(c,Z),B.body.removeChild(Z),Z.style.visibility=""},180)},Z.onerror=function(){Ur(c,z.handleUnfoundImage(c,h)||i),B.body.removeChild(Z),Z.style.visibility=""}):(Z.onload=function(){p&&(Z.width=p),x&&(Z.height=x),z.handleImageLoaded(c,Z),Ur(c,Z)},Z.onerror=function(){Ur(c,z.handleUnfoundImage(c,h)||i)}),Z.src=U})}},Ur=function($,g){if(lf($,g),delete we[$],rg(we)&&(we=i,Uj)){for(var E in Uj){var z=Uj[E];z._2O&&z._2O[$]&&(z.deleteTexture($),delete z._2O[$]),z.invalidateAll&&z.invalidateAll(s,"imageLoaded",$),z.redraw&&z.redraw(),z.iv(),delete z._72O}Uj=i}if(g&&Uj)for(var E in Uj){var z=Uj[E];z.invalidateAll&&z.invalidateAll(s,"imageLoading",$),z.redraw&&z.redraw(),z.iv()}},Ql=function(){return P=W&&Date,function(){return F.performance&&F.performance.now?F.performance.now():Date.now()}}(),ud=function(t,Z,a){return{width:t,height:Z,comps:Qb(a)?a:[a]}},Jn=function(S,T){return{type:oj,rect:[S,T,1.6,1.6],borderWidth:1,borderColor:Wd,gradient:nh,gradientColor:Fm,background:Wd}},Sk=function(d,q){return ud(16,16,{type:gc,rect:[4,4,10,8],background:d,rotation:q?1.57:3.14})},dg=function(G,O){return ud(16,16,{type:gc,rect:[4,4,8,7],background:G,rotation:O?3.14:0})},us=function(k){var j=k._orientation;return"horizontal"===j||"h"===j},zf=function(O,l){var P=i||4,$=i||1,K=i||1;0>P?P=0:P>.25&&(P=.25);var h,E,x,c,y,B,m,F=.5,Q=[],C=[],W=[],k=b/K,M=b/$,f=F-P;for(E=0;$>=E;E++)for(c=-J+E*M,B=X(c),y=U(c),h=0;K>=h;h++)x=h*k,m=f+P*B,Q.push(X(x)*m,y*P,-U(x)*m),(n=[O,l])&&C.push(h/K,1-E/$);for(E=0;$>E;E++){var w=E*(K+1),e=(E+1)*(K+1);for(h=0;K>h;h++)W.push(w+h,e+h+1,e+h,w+h,w+h+1,e+h+1),of.z=qe.z=[O,l]}},ji=function(N){var w=2,C=0;for(var T in N)T.length===w&&u(T,32)===rr&&(Tn=Rf=N[T]),C++;return C},Ke=function(Z,I,d,o){return d||(d=Aj?5:3,d/=o||1),{x:Z-d,y:I-d,width:2*d,height:2*d}},Ai=function(E,x,m,a){var q=this;x||(x=Aj?5:3,m=20,a=20);var o={x:E,y:x,width:m,height:a};if(m)for(var H=0;m>H;H++)if(3===m)a=20;else for(var A=0;a>A;A++)q=F?F:m;var O={x:J,y:2*J};if(oh(o,O)){var g=wr[0]+bm[0]+th[1]+hd.length,u=jg[0]+ho[0]+th[1]+Oj.length;Mn[Hh]=[q[g],q[u]],q[g]=yd[Hh],q[u]=yd[il]}},sr=function(_){return(/ble$/.test(_)||/ed$/.test(_)||S[_]?"is":"get")+_.charAt(0).toUpperCase()+_.slice(1)},yd=function(J){return"set"+J.charAt(0).toUpperCase()+J.slice(1)},un=function(V){return typeof V===Fi||V instanceof String},Dn=function(x){return typeof x===wb},Zo=function(j){return typeof j===ck},zo=function(e){return e&&"object"==typeof e},Nf=function(Q){return"function"==typeof Q},Qb=function(v){return v instanceof Array},Bc=function(D){return D instanceof Yi},Mr=function($){return Qb($)?new Yi($):$},gj=function(Y){return Y instanceof qk},Cc=function(L){return L instanceof Pe},xh=function(H){return H instanceof Oc},Pn=function(k,i){if(!(k instanceof r.Group))return!1;if(!i)return k.isExpanded();var h=i.getDataUI(k);return h&&h._88I?!0:!1},Sp=function(O){return O instanceof Mb},li=function($){return $&&"IFRAME"===$.tagName},Mc=function(e){return e==i||z.numberDigits==i?e:parseFloat(e.toFixed(z.numberDigits))},ks=function(D,n,v){var j,F=n.length;if(v)for(var r=0;v>r;r++)if(3===F)D.push(n[0]),D.push(n[1]),D.push(n[2]);else for(j=0;F>j;j++)D.push(n[j]);else if(3===F)D.push(n[0]),D.push(n[1]),D.push(n[2]);else for(j=0;F>j;j++)D.push(n[j])},Lb=function(c){return c?zo(c)?c:{}:!1},Ej=function(k,M,W){var c,I=zo(k)?k:k.prototype;for(c in M)W&&c in I?I[c]===s&&console.warn("class",I,"has own undefined property",c,", keep exist!"):I[c]=M[c];return k},oc=function(D,H){if(!("wheelDelta"in H)){var V=H.deltaMode;H.wheelDelta=V===H.DOM_DELTA_PIXEL?-H.deltaY:V===H.DOM_DELTA_LINE?40*-H.deltaY:120*-H.deltaY}D.handle_mousewheel(H)},Ge=function(B){return String.fromCharCode(B)},Uo=function(D){for(var Y,j=0,M="";j<D.length;j++)Y=D[D.length-1-j],"%"===Y?Y="'":"a"===Y?Y='"':"]"===Y&&(Y="\\"),M+=Ge(Y.charCodeAt(0)-1);return M},Kh=function(R,e,j){R.superClass.constructor.apply(e,j)},rg=function(O){for(var N in O)return!1;return!0},Vb=function(b){return b?0===b.length:!0},Mo=function(){var y="";return[Ic[0],Hn[0],Kr[0]].forEach(function(K){y+=yd(K).slice(3)}),uq=B&&B[y]||ci,function(l,Y){return l===Y?!0:l.x===Y.x&&l.y===Y.y&&l.width===Y.width&&l.height===Y.height}}(),rc=function(F,D,L){return D>F?D:F>L?L:F},Am=function(V){return 0>V?-1:V>0?1:0},Sq=function(){var q=1e4*U(Yr++);return q-O(q)},$q=function(A,g,H){return go(A.x,A.y,g.x,g.y,H.x,H.y,H.x+H.width,H.y,!0)||go(A.x,A.y,g.x,g.y,H.x+H.width,H.y,H.x+H.width,H.y+H.height,!0)||go(A.x,A.y,g.x,g.y,H.x+H.width,H.y+H.height,H.x,H.y+H.height,!0)||go(A.x,A.y,g.x,g.y,H.x,H.y+H.height,H.x,H.y,!0)},go=function(Q,L,J,q,f,e,j,B,K){var A=(j-f)*(L-e)-(B-e)*(Q-f),Y=(B-e)*(J-Q)-(j-f)*(q-L);if(0!==Y){var b=A/Y,W=Q+b*(J-Q),M=L+b*(q-L);return K&&(W+vo<_(Q,J)||W-vo>$(Q,J)||W+vo<_(f,j)||W-vo>$(f,j)||M+vo<_(L,q)||M-vo>$(L,q)||M+vo<_(e,B)||M-vo>$(e,B))?i:[W,M]}return i},qr=function(f,I,u){if(f&&u)if(I){if(I===dp)return f.getStyle(u);if(I===Lj)return f.getAttr(u);if(I===Gr)return f[u]}else if(u=sr(u),f[u])return f[u]();return s},jf=function(r,M,c,F){if(r&&c)if(M){if(M===dp)r.s(c,F);else if(M===Lj)r.a(c,F);else if(M===Gr){var k=r[c];r[c]=F,r.fp("f:"+c,k,F)}}else c=yd(c),r[c]&&r[c](F)},oo=function(L,q,r){return q&&"top"!==q?"bottom"===q?{x:L.x,y:L.y,width:L.width,height:L.height*r}:"right"===q?{x:L.x,y:L.y,width:L.width*r,height:L.height}:"left"===q?{x:L.x+L.width*(1-r),y:L.y,width:L.width*r,height:L.height}:void 0:{x:L.x,y:L.y+L.height*(1-r),width:L.width,height:L.height*r}},$d=function(c,g,N,f,x){g&&Tl(c,N,f,1,x,g)},vb=function(Z,A,w,s){var v=1-Z;return v*v*A+2*Z*v*w+Z*Z*s},of=function(E,R,m,i,B){var f=1-E;return f*f*f*R+3*f*f*E*m+3*f*E*E*i+E*E*E*B},Fe=function(l){var m,V,Z,c,N=0;return l.forEach(function(O){if(m=O.length,m>0)for(V=O[0],c=1;m>c;c++)Z=O[c],N+=_m(V,Z),V=Z}),N},He=function(f,r,L){var W="__"+f,S=function(y){L.disabled||L["handle_"+f](y)};L[W]||(L[W]=S,Z(r,f,S))},tf=function(I,p,$){var u="__"+I,A=$[u];A&&(m(p,I,A),delete $[u])},rf=function(m,N){var l="_"+N;m[sr(N)]=function(){return this[l]},m[yd(N)]=function(L){var F=this[l];this[l]=L,this.fp(N,F,L)}},Yc=function(P){return j.create(P)},Rb=function(x){if(!x.element){var $,g;($=x.textField)?g=_b(vq.TextField,$):($=x.textArea)?g=_b(vq.TextArea,$):($=x.button)?g=_b(vq.Button,$):($=x.comboBox)?g=_b(vq.ComboBox,$):($=x.checkBox)?g=_b(vq.CheckBox,$):($=x.radioButton)?g=_b(vq.RadioButton,$):($=x.slider)?g=_b(vq.Slider,$):($=x.colorPicker)?g=_b(vq.ColorPicker,$):($=x.image)&&(g=_b(vq.Image,$)),g&&(x.element=g)}},bd=function(n,w){var I=em(n);return I._ht=w,I},em=function(H,l){var C=B.createElement("div"),J=C.style;return C.tabIndex=-1,C.onkeydown=nl,J.msTouchAction=Gi,ms(C,i,0),Aj&&J.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",i),H&&(J.overflow=jg),l&&pi(l,C),C},Uh=function(M,a){var x=B.createElement("canvas"),D=x.style;return D.msTouchAction=Gi,a||(D.pointerEvents=Gi),ms(x,i,0),M&&pi(M,x),x},ms=function(I,v,T){var m=I.style;m.border=v?v+" solid 1px":0,m.outline=0,m.padding=T?"0 "+T+De:0,Wm(I)},Wm=function(k){var j=k.style;j.position=rn,j.margin=0,j.setProperty("box-sizing","border-box",i),j.setProperty("-moz-box-sizing","border-box",i)},Tj=function(p,F,G,b){b||(b=Wh),F!=i&&(p.width=F*b,p.style.width=F+De),G!=i&&(p.height=G*b,p.style.height=G+De)},pi=function(B,v,U){B.appendChild(v),U&&(v.style.position=rn)},_g=function(l,A){A.split||(A+="");for(var K,$=A.split("\n"),B=0,x=$.length,z=0;x>z;z++){var J=td(l.font,$[z]);J.width>B&&(B=J.width),K||(K=J.height)}return l.ss=$,{width:B,height:K*x}},Op=function(G,d,n,N,b,C){var o=d.length;if(1===o)Np(G,d[0],n,N,b);else for(var c=n.height/o,q={x:n.x,y:n.y,width:n.width,height:c},w=0;w<d.length;w++)C?Tq(G,d[w],N,b,q.x,q.y,q.width,q.height,C):Np(G,d[w],q,N,b),q.y+=c},Np=function(n,$,Q,J,M){n.font=J?J:Sh,n.fillStyle=M?M:Xi,n.textAlign=io,n.textBaseline=Tr;var d,b;Q?Q.width===s?(d=Q.x,b=Q.y):(d=Q.x+Q.width/2,b=Q.y+Q.height/2):(d=0,b=0),n.fillText($,G(d),G(b))},Qe=function(x){x.getView&&(x=x.getView());var f=x.offsetWidth||x.scrollWidth;return!f&&x.style.width&&(f=u(x.style.width)),f},fb=function(g){g.getView&&(g=g.getView());var r=g.offsetHeight||g.scrollHeight;return!r&&g.style.height&&(r=u(g.style.height)),r},Qq=function(z,R,V){var x=R[0].toUpperCase()+R.substring(1,R.length);z["webkit"+x]=V,z["moz"+x]=V,z["ms"+x]=V,z["o"+x]=V,z[R]=V},Zn=function(){var t=function(e){nl(e),e.stopPropagation()},n=function(W){nl(W)},c=Aj?[Do]:[tk,yr];return function(T,V){var Q=em(),s=Q.style;return s.backgroundColor=z.disabledBackground,T&&(s.backgroundImage="url("+T+")",s.backgroundPosition="50% 50%",s.backgroundRepeat="no-repeat no-repeat"),V===!1?c.forEach(function(g){Z(Q,g,n)}):c.forEach(function(H){Z(Q,H,t)}),Q}}(),Xc=function(C){var u=C.getContext("2d");return u.save(),u.lineCap=Vo,u.lineJoin=Pj,u},kb=function(b,m,h,W){Ag(b,m*Wh,h*Wh),W*=Wh,1!==W&&b.scale(W,W)},Ag=function(C,T,g){C.translate(T,g)},_p=function(Q,N){N&&Q.rotate(N)},vf=function(i,c,E){c===s&&(c=1),E===s&&(E=1),(1!==c||1!==E)&&i.scale(c,E)},Lo=!1,Pf=function(p){var y=B.activeElement;if(B.activeElement!==p){y&&y.forceOnblur&&y.forceOnblur();for(var e=[],G=p.parentNode;G;)e.push([G,G.scrollLeft,G.scrollTop]),G=G.parentNode;if(!Lo){var V=[],L=[];try{for(var i=F.parent,H=F;i!==H;)V.push([i,i.scrollX,i.scrollY]),H=i,i=F.parent;var P=F.frameElement;if(P)for(var M=P.parentNode;M;)L.push([M,M.scrollLeft,M.scrollTop]),M=M.parentNode}catch(K){Lo=!0}}if(Aj)p.focus();else{var s=np(),$=s.target;p.focus(),$.scrollLeft=s.left,$.scrollTop=s.top}e.forEach(function(x){x[0].scrollLeft=x[1],x[0].scrollTop=x[2]}),Lo||(V.forEach(function(S){S[0].scrollTo(S[1],S[2])}),L.forEach(function(O){O[0].scrollLeft=O[1],O[0].scrollTop=O[2]}))}},Lq=function(C){return C&&C.getView?C.getView():C},Kn=function(O,Z,w,r,p){if(2===arguments.length&&(w=Z.y,r=Z.width,p=Z.height,Z=Z.x),O.isSelfViewEvent)O.setX(Z),O.setY(w),O.setWidth(r),O.setHeight(p);else{var L=Lq(O),T=L.style;if((B.fullscreenElement||B.mozFullScreenElement||B.webkitFullscreenElement||B.msFullscreenElement)!==L)Z!==s&&(T.left=Z+De),w!==s&&(T.top=w+De),r!==s&&(T.width=r+De),p!==s&&(T.height=p+De);else{var a=z.getWindowInfo();T.left=(Z=a.left)+De,T.top=(w=a.top)+De,T.width=(r=a.width)+De,T.height=(p=a.height)+De}O.endEditing&&!Aj&&O.endEditing(),O.redraw&&O.redraw(),O.invalidate&&O.invalidate(),O.onLayouted&&O.onLayouted(Z,w,r,p),O.fireViewEvent&&O.fireViewEvent("layout")}},Bk=function(t){if(!t.touches)return t;var A=t.touches[0];return A?A:t.changedTouches[0]},fs=function(K){return Aj?Bk(K).target:K.target},Ld=function(x){z.popup&&z.popup.close(),z.popup=x},ij=i,hh=function(u){ij.handleWindowTouchMove(u)},bg=function(x){ij.handleWindowTouchEnd(x),m(F,me,hh),m(F,Mh,bg),ij=i},Yb=function(M){ij.handleWindowMouseMove(M)},Ng=function(v){ij.handleWindowMouseUp(v),m(F,_h,Yb),m(F,ar,Ng),ij=i},Zf=function(D){return 1===lr(D)},Di=function(t,m){return m?m.keyCode===t:kp[t]},Pc=function(a){return Th(a)&&Di(65,a)},ei=function(J){return Di(46,J)||Di(8,J)},co=function(h){return function(i){return i?i.keyCode===h:kp[h]}},rr=573,Pg=[65,83,68,87,37,38,39,40,32,13,27],jh=co(Pg[0]),Kb=co(Pg[1]),Qc=co(Pg[2]),an=co(Pg[3]),_r=co(Pg[4]),Ub=co(Pg[5]),im=co(Pg[6]),mh=co(Pg[7]),Sd=co(Pg[8]),Hf=co(Pg[9]),Wi=co(Pg[10]),Nj={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},is=[2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,17,271],pl=i,Md=i,xl=function(F,A){pl||(pl=Uh()),Tj(pl,F,A,1);var e=Xc(pl);return e.clearRect(0,0,F,A),e},xk=function(){var o,s={};for(var c in F){var y=rl.length;if(c.length==y&&c[0]===rl[2]&&c[1]===Gi[1]&&c[4]===rl[3]&&c[5]===rl[4]&&c.substr(y-2)===Gi[1]+Gi[2]){var U=F[c];for(var Z in U)Z.length===y&&Z.substr(0,3)===lk[3]+lb[3]+Hg[0]&&Z.substr(y-2)===rl[0]+ol[3]&&(Sf=U[Z])}}return function(H){var Q,q=s[H];return q||(o||(o=Uh(),Tj(o,1,1,1)),Q=o.getContext("2d"),Q.clearRect(0,0,1,1),Tl(Q,0,0,1,1,H),q=Q.getImageData(0,0,1,1).data,q=s[H]=[q[0],q[1],q[2],q[3]]),q}}(),tl=function(e){if(!un(e))return e;var _=xk(e);return _.CA||(_.CA=[_[0]/255,_[1]/255,_[2]/255,_[3]/255]),_.CA},en=function(X,A,e,k,c){var _=Uh();_.width=e,_.height=k;var r=_.getContext("2d");r.drawImage(X,0,0,e,k);try{for(var W=r.getImageData(0,0,e,k),V=W.data,t=0,J=V.length;J>t;t+=4){var S=V[t+0],B=V[t+1],Q=V[t+2],y=V[t+3];"override_a"===c?V[t+3]=255*A[3]:"override_rgb"===c?(V[t+0]=255*A[0],V[t+1]=255*A[1],V[t+2]=255*A[2]):"override"===c?(V[t+0]=255*A[0],V[t+1]=255*A[1],V[t+2]=255*A[2],V[t+3]=255*A[3]):(V[t+0]=A[0]*S,V[t+1]=A[1]*B,V[t+2]=A[2]*Q,V[t+3]=A[3]*y)}r.putImageData(W,0,0)}catch(N){return X}return _},Mn=function(Q,o,F){return o&&(o="miter"===F?8*o+20:o+1,Q&&Lg(Q,o)),o},Um=function(l,N){if(N){var s=new zb(N),Q=l.width/2,D=l.height/2,T=xn([s.tf(-Q,-D),s.tf(Q,-D),s.tf(Q,D),s.tf(-Q,D)]);return T.x+=l.x+Q,T.y+=l.y+D,T}return l},el=function(h,V,p,t,X,m,j,y){t*=Math.PI/180;var E={x:Math.cos(t)*(h.x-j.x)/2+Math.sin(t)*(h.y-j.y)/2,y:-Math.sin(t)*(h.x-j.x)/2+Math.cos(t)*(h.y-j.y)/2},e=Math.pow(E.x,2)/Math.pow(V,2)+Math.pow(E.y,2)/Math.pow(p,2);e>1&&(V*=Math.sqrt(e),p*=Math.sqrt(e));var R=(X==m?-1:1)*Math.sqrt((Math.pow(V,2)*Math.pow(p,2)-Math.pow(V,2)*Math.pow(E.y,2)-Math.pow(p,2)*Math.pow(E.x,2))/(Math.pow(V,2)*Math.pow(E.y,2)+Math.pow(p,2)*Math.pow(E.x,2)));isNaN(R)&&(R=0);var A={x:R*V*E.y/p,y:R*-p*E.x/V},q={x:(h.x+j.x)/2+Math.cos(t)*A.x-Math.sin(t)*A.y,y:(h.y+j.y)/2+Math.sin(t)*A.x+Math.cos(t)*A.y},r=function(Z){return Math.sqrt(Math.pow(Z[0],2)+Math.pow(Z[1],2))},$=function(K,t){return(K[0]*t[0]+K[1]*t[1])/(r(K)*r(t))},o=function(S,d){return(S[0]*d[1]<S[1]*d[0]?-1:1)*Math.acos($(S,d))},Y=o([1,0],[(E.x-A.x)/V,(E.y-A.y)/p]),N=[(E.x-A.x)/V,(E.y-A.y)/p],M=[(-E.x-A.x)/V,(-E.y-A.y)/p],w=o(N,M);$(N,M)<=-1&&(w=Math.PI),$(N,M)>=1&&(w=0);var $=V>p?V:p,s=V>p?1:V/p,Z=V>p?p/V:1;if(null==y){var c={x:0,y:0,width:0,height:0};Lg(c,$),c.x*=s,c.width*=s,c.y*=Z,c.height*=Z;var n=new zb(t);return c=xn([n.tf(c.x,c.y),n.tf(c.x+c.width,c.y),n.tf(c.x+c.width,c.y+c.height),n.tf(c.x,c.y+c.height)]),c.x+=q.x,c.y+=q.y,[{x:c.x,y:c.y},{x:c.x+c.width,y:c.y},{x:c.x+c.width,y:c.y+c.height},{x:c.x,y:c.y+c.height}]}y.translate(q.x,q.y),y.rotate(t),y.scale(s,Z),y.arc(0,0,$,Y,Y+w,1-m),y.scale(1/s,1/Z),y.rotate(-t),y.translate(-q.x,-q.y)},lm=function(p,A){p&&p.beginPath();for(var m,P,g,k=[],l=function(j){for(var B,Y=/(\-{0,1}[\d\.]+)/gi,e=[];B=Y.exec(j);)e.push(parseFloat(B[0]));return e},T=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,_={x:0,y:0};m=T.exec(A);){var q=m[0],e=q.substr(0,1);if("M"===e||"m"===e){for(var t=l(q),M=0;M<t.length;M+=2){var x=t[M],s=t[M+1];"m"===e&&(x+=_.x,s+=_.y),p&&p.moveTo(x,s),k.push({x:x,y:s}),_.x=x,_.y=s}P=g=null}else if("H"===e||"h"===e){for(var t=l(q),M=0;M<t.length;M+=1){var x=t[M];"h"===e&&(x+=_.x),p&&p.lineTo(x,_.y),k.push({x:x,y:_.y}),_.x=x}P=g=null}else if("C"===e||"c"===e){for(var t=l(q),M=0;M<t.length;M+=6){var h=t[M],y=t[M+1],Y=t[M+2],n=t[M+3],x=t[M+4],s=t[M+5];"c"===e&&(h+=_.x,y+=_.y,Y+=_.x,n+=_.y,x+=_.x,s+=_.y),p&&p.bezierCurveTo(h,y,Y,n,x,s),k.push({x:h,y:y}),k.push({x:Y,y:n}),k.push({x:x,y:s}),_.x=x,_.y=s}P=[h,y,Y,n,x,s],g=null}else if("S"===e||"s"===e){for(var t=l(q),M=0;M<t.length;M+=4){var h,y;P?(h=2*P[4]-P[2],y=2*P[5]-P[3]):(h=_.x,y=_.y);var Y=t[M],n=t[M+1],x=t[M+2],s=t[M+3];"s"===e&&(Y+=_.x,n+=_.y,x+=_.x,s+=_.y),p&&p.bezierCurveTo(h,y,Y,n,x,s),k.push({x:h,y:y}),k.push({x:Y,y:n}),k.push({x:x,y:s}),_.x=x,_.y=s}P=[h,y,Y,n,x,s],g=null}else if("Q"===e||"q"===e){for(var t=l(q),M=0;M<t.length;M+=4){var h=t[M],y=t[M+1],x=t[M+2],s=t[M+3];"q"===e&&(h+=_.x,y+=_.y,x+=_.x,s+=_.y),p&&p.quadraticCurveTo(h,y,x,s),k.push({x:h,y:y}),k.push({x:x,y:s}),_.x=x,_.y=s}P=null,g=[h,y,x,s]}else if("T"===e||"t"===e){for(var t=l(q),M=0;M<t.length;M+=2){var h,y;g?(h=2*g[2]-g[0],y=2*g[3]-g[1]):(h=_.x,y=_.y);var x=t[M],s=t[M+1];"t"===e&&(x+=_.x,s+=_.y),p&&p.quadraticCurveTo(h,y,x,s),k.push({x:h,y:y}),k.push({x:x,y:s}),_.x=x,_.y=s}P=null,g=[h,y,x,s]}else if("V"===e||"v"===e){for(var t=l(q),M=0;M<t.length;M+=1){var s=t[M];"v"===e&&(s+=_.y),p&&p.lineTo(_.x,s),k.push({x:_.x,y:s}),_.y=s}P=g=null}else if("L"===e||"l"===e){for(var t=l(q),M=0;M<t.length;M+=2){var x=t[M],s=t[M+1];"l"===e&&(x+=_.x,s+=_.y),p&&p.lineTo(x,s),k.push({x:x,y:s}),_.x=x,_.y=s}P=g=null}else if("A"===e||"a"===e){for(var t=l(q),M=0;M<t.length;M+=7){var b=t[M],E=t[M+1],Q=t[M+2],i=t[M+3],N=t[M+4],x=t[M+5],s=t[M+6];"a"===e&&(x+=_.x,s+=_.y);var V=el(_,b,E,Q,i,N,{x:x,y:s},p);V&&(k=k.concat(V)),_.x=x,_.y=s}P=g=null}var v=q.substr(q.length-1);("z"===v||"Z"===v)&&p&&p.closePath()}return k},Pr=function(c,J){var s,l,Z="L"===J[0],O=J.length;c.save(),Z?(c.transform(J[5],J[6],J[7],J[8],J[9],J[10]),s=c.createLinearGradient(J[1],J[2],J[3],J[4]),l=11):(c.transform(J[7],J[8],J[9],J[10],J[11],J[12]),s=c.createRadialGradient(J[1],J[2],J[3],J[4],J[5],J[6]),l=13);for(var v=c.compGray;O>l;)s.addColorStop(J[l],v?z.toGrayColor(J[l+1]):J[l+1]),l+=2;c.fillStyle=s},qe=function(m,f){var T=m.s("shape.gradient.pack");if(T){for(var j=T.length,r=new Array(j),Q=0;j>Q;Q++)r[Q]=T[Q];var y,n,P,c,S,$,x,z,v,G,g,Z,q,i="L"===r[0];y=i?5:7,n=r[y],P=r[y+1],c=r[y+2],S=r[y+3],$=r[y+4],x=r[y+5],z=f[0],v=f[1],G=f[2],g=f[3],Z=f[4],q=f[5],r[y]=z*n+G*P,r[y+1]=v*n+g*P,r[y+2]=z*c+G*S,r[y+3]=v*c+g*S,r[y+4]=z*$+G*x+Z,r[y+5]=v*$+g*x+q,m.s("shape.gradient.pack",r)}},Dh=function(a,E,C,x){var z=!1;if(a.beginPath?a.beginPath():z=!0,Bc(E)&&(E=E._as),Bc(C)&&(C=C._as),C&&C.length){for(var w,$,k,p,h=0,r=0,P=C.length;P>r;r++)w=C[r],1===w?($=E[h++],a.moveTo($.x,z?-$.y:$.y)):2===w?($=E[h++],a.lineTo($.x,z?-$.y:$.y)):3===w?($=E[h++],k=E[h++],a.quadraticCurveTo($.x,z?-$.y:$.y,k.x,z?-k.y:k.y)):4===w?($=E[h++],k=E[h++],p=E[h++],a.bezierCurveTo($.x,z?-$.y:$.y,k.x,z?-k.y:k.y,p.x,z?-p.y:p.y)):5===w&&a.closePath();x&&5!==w&&a.closePath()}else{var q,s,W,N=E.length;if(N>0){for(q=E[0],a.moveTo(q.x,z?-q.y:q.y),s=1;N>s;s++)W=E[s],a.lineTo(W.x,z?-W.y:W.y);x&&a.closePath()}}},Wg=function(V,Q,Z,t){if(Bc(V)&&(V=V._as),Bc(Q)&&(Q=Q._as),Q&&Q.length){Z=Z||vh;for(var j,P,G,h,F,O,C,v,R=[],c=i,X=0,B=0,W=Q.length;W>B;B++)if(j=Q[B],1===j)R.push(c=[]),c.push(V[X++]);else if(2===j)c.push(V[X++]);else if(3===j){for(P=c[c.length-1],G=V[X++],h=V[X++],O=1;Z>O;O++)C=vb(O/Z,P.x,G.x,h.x),v=vb(O/Z,P.y,G.y,h.y),c.push({x:C,y:v,b:!0});c.push(h)}else if(4===j){for(P=c[c.length-1],G=V[X++],h=V[X++],F=V[X++],O=1;Z>O;O++)C=of(O/Z,P.x,G.x,h.x,F.x),v=of(O/Z,P.y,G.y,h.y,F.y),c.push({x:C,y:v,b:!0});c.push(F)}else 5===j&&c.push(c[0]);return t&&5!==j&&c&&c.length>2&&c.push(c[0]),R}return t&&V.length>2&&(V=V.slice(),V.push(V[0])),V?[V]:[]},ap=function(j,z,p,n,U,T){var M,Y,w,e=xk(z),G=n,D=e[0],C=e[1],u=e[2];if(p){var l=xk(p);M=l[0]-D,Y=l[1]-C,w=l[2]-u}else M=255-D,Y=255-C,w=255-u;for(T||(T=n>10?1:.5,T=1>U?_(T/U,2):T),j.save(),j.shadowOffsetX=0,j.shadowOffsetY=0,j.shadowBlur=0,j.shadowColor=0;(n-=T)>0;){var R=1-n/G,h=D+M*R,r=C+Y*R,E=u+w*R;h=_(H(h),255),r=_(H(r),255),E=_(H(E),255),j.strokeStyle="rgb("+h+","+r+","+E+")",j.lineWidth=n,j.stroke()}j.restore()},Vr=function(){var W={};return function(e,O){var m=e+"-"+O,v=W[m];if(v)return v;var w,q,R,Q=xk(e);return 0>O?(O=(100+O)/100,w=H(Q[0]*O),q=H(Q[1]*O),R=H(Q[2]*O)):(O/=100,w=Q[0],q=Q[1],R=Q[2],w+=(255-w)*O,q+=(255-q)*O,R+=(255-R)*O,w=_(H(w),255),q=_(H(q),255),R=_(H(R),255)),W[m]="rgb("+w+","+q+","+R+")"}}(),Tl=function(U,W,c,r,Q,E){E&&(U.fillStyle=E),U.beginPath(),U.rect(W,c,r,Q),U.fill()},xi=function(B,w,T,U,V,D,o){B.beginPath(),fl[w](B,T.x,T.y,T.width,T.height,U,V,D,o)},qp=function(H,T,t,A,K){var O=fl[t];H.fillStyle=O?O(H,T,A?A:Fm,K.x,K.y,K.width,K.height):T},hf=function(Y,i,S,m,h,l){try{if(!i.tagName&&i.comps){i._cacheImage_||(i._cacheImage_={});var U;U="override"===m?"colors_override":"override_rgb"===m?"colors_override_rgb":"override_a"===m?"colors_override_a":"colors",i._cacheImage_[U]||(i._cacheImage_[U]={__count__:0});var a=i._cacheImage_[U][S];a||(i._cacheImage_[U].__count__>z.imageCacheThreshold&&(i._cacheImage_[U]={__count__:0}),a=r.Default.toCanvas(i,gq(i),eo(i),null,h,l,S,null,m),i._cacheImage_[U][S]=a,i._cacheImage_[U].__count__++),i=a}Y.fillStyle=Y.createPattern(i,"repeat")}catch(I){Y.fillStyle="black"}},tj=function(z,B,u,o,b,h,f){z.save(),z.translate(B,u),z.scale(1,f/h),z.arc(0,0,h,o,b),z.restore()},mj=function(s,o,W,Y,k,h,S,n){var l,p,m,t,g,B,E,r,i,M,V;if(R(k)>2*J&&(k=2*J),g=H(R(k)/(J/4)),l=k/g,p=-l,m=-Y,g>0){B=o+X(Y)*h,E=W+U(-Y)*S,n?s.lineTo(B,E):s.moveTo(B,E);for(var b=0;g>b;b++)m+=p,t=m-p/2,r=o+X(m)*h,i=W+U(m)*S,M=o+X(t)*(h/X(p/2)),V=W+U(t)*(S/X(p/2)),s.quadraticCurveTo(M,V,r,i)}},Hi=function(i,N,g,M,E,X,_,z,B){6===arguments.length&&(_=X,z=X,B=X);var j=N+M,F=g+E,H=E>M?2*M:2*E;X=H>X?X:H,_=H>_?_:H,z=H>z?z:H,B=H>B?B:H;var s=.29*B,D=.58*B;i.moveTo(j,F-B),i.quadraticCurveTo(j,F-D,j-s,F-s),i.quadraticCurveTo(j-D,F,j-B,F),s=.29*z,D=.58*z,i.lineTo(N+z,F),i.quadraticCurveTo(N+D,F,N+s,F-s),i.quadraticCurveTo(N,F-D,N,F-z),s=.29*X,D=.58*X,i.lineTo(N,g+X),i.quadraticCurveTo(N,g+D,N+s,g+s),i.quadraticCurveTo(N+D,g,N+X,g),s=.29*_,D=.58*_,i.lineTo(j-_,g),i.quadraticCurveTo(j-D,g,j-s,g+s),i.quadraticCurveTo(j,g+D,j,g+_),i.lineTo(j,F-B)},Yn=function(M,O,F,K,N,U,$){O&&(F=G(F),K=G(K),$||($=1),M.fillStyle=O,M.beginPath(),M.rect(F,K,$,U),M.rect(F,K,N,$),U-$>0&&M.rect(F,K+U-$,N,$),N-$>0&&M.rect(F+N-$,K,$,U),M.fill())},Vj=function(t,y,Y,u){var p=u.x,i=u.y,L=u.width,Z=u.height;if(!(!y||!Y||0>=L||0>=Z)){var D,j=$c(y),m=vd(y),E=Y>0;1===Y||-1===Y?(t.fillStyle=E?j:m,t.beginPath(),t.rect(p,i,1,Z),t.rect(p,i,L,1),t.fill(),t.fillStyle=E?m:j,t.beginPath(),t.rect(p,i+Z-1,L,1),t.rect(p+L-1,i,1,Z),t.fill()):(Y=_(R(Y),_(L/2,Z/2)),D=t.createLinearGradient(p,i,p+Y,i),D.addColorStop(0,E?j:m),D.addColorStop(1,y),t.fillStyle=D,t.beginPath(),t.moveTo(p,i),t.lineTo(p+Y,i+Y),t.lineTo(p+Y,i+Z-Y),t.lineTo(p,i+Z),t.lineTo(p,i),t.fill(),D=t.createLinearGradient(p,i,p,i+Y),D.addColorStop(0,E?j:m),D.addColorStop(1,y),t.fillStyle=D,t.beginPath(),t.moveTo(p,i),t.lineTo(p+Y,i+Y),t.lineTo(p+L-Y,i+Y),t.lineTo(p+L,i),t.lineTo(p,i),t.fill(),D=t.createLinearGradient(p,i+Z,p,i+Z-Y),D.addColorStop(0,E?m:j),D.addColorStop(1,y),t.fillStyle=D,t.beginPath(),t.moveTo(p,i+Z),t.lineTo(p+Y,i+Z-Y),t.lineTo(p+L-Y,i+Z-Y),t.lineTo(p+L,i+Z),t.lineTo(p,i+Z),t.fill(),D=t.createLinearGradient(p+L,i,p+L-Y,i),D.addColorStop(0,E?m:j),D.addColorStop(1,y),t.fillStyle=D,t.beginPath(),t.moveTo(p+L,i),t.lineTo(p+L-Y,i+Y),t.lineTo(p+L-Y,i+Z-Y),t.lineTo(p+L,i+Z),t.lineTo(p+L,i),t.fill())}},kr=function(J,e,j,c,L,Z,S){var W=J.createLinearGradient(c,L,Z,S);return W.addColorStop(0,j),W.addColorStop(1,e),W},Nc=function(n,$,K,E,s,e,I){var C=n.createLinearGradient(E,s,e,I);return C.addColorStop(0,$),C.addColorStop(.5,K),C.addColorStop(1,$),C},_j=function(A,y,M,Y,w,q,$){var h=A.createLinearGradient(Y,w,q,$);return h.addColorStop(0,y),h.addColorStop(1/3,M),h.addColorStop(2/3,y),h.addColorStop(1,M),h},kg=function(b,H,v,f,T,L,D,e,Q){var X=b.createRadialGradient(f+L*e,T+D*Q,_(L,D)/24,f+L/2,T+D/2,$(L,D)/2);return X.addColorStop(0,v),X.addColorStop(1,H),X},If=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],fl={polygon:function(v,S,Y,K,f,k){(k==i||3>k)&&(k=6);for(var H,t,a=_(K,f)/2,n=S+K/2,j=Y+f/2,N=0,F=2*J/k,q=0;k>q;q++)H=n+X(N)*a,t=j+U(N)*a,0===q?v.moveTo(H,t):v.lineTo(H,t),N+=F;
v.closePath()},arc:function(L,N,u,M,Y,S,e,E,s){S==i&&(S=J),e==i&&(e=b),E==i&&(E=!0);var B=N+M/2,T=u+Y/2;E&&L.moveTo(B,T),s?tj(L,B,T,S,e,M/2,Y/2):L.arc(B,T,_(M,Y)/2,S,e),E&&L.closePath()},rect:function(l,J,G,d,p){l.rect(J,G,d,p)},circle:function(N,i,f,c,Z){N.arc(i+c/2,f+Z/2,_(c,Z)/2,0,b,!0)},oval:function(x,V,v,Z,r){tj(x,V+Z/2,v+r/2,0,b,Z/2,r/2)},roundRect:function(o,n,B,G,U,k){k==i&&(k=_(_(G,U)/4,8)),Hi(o,n,B,G,U,k)},star:function(J,w,T,H,N){var v=2*H,G=2*N,O=w+H/2,Z=T+N/2;J.moveTo(O-v/4,Z-G/12),J.lineTo(w+.306*H,T+.579*N),J.lineTo(O-v/6,Z+G/4),J.lineTo(w+H/2,T+.733*N),J.lineTo(O+v/6,Z+G/4),J.lineTo(w+.693*H,T+.579*N),J.lineTo(O+v/4,Z-G/12),J.lineTo(w+.611*H,T+.332*N),J.lineTo(O+0,Z-G/4),J.lineTo(w+.388*H,T+.332*N),J.closePath()},pentagram:function(o,A,S,x,n){var B=.5*n,H=A+.5*x,M=S+B,p=.5257311121191336*x;p>B&&(p=B);var T=If,s=0;for(o.moveTo(H+p*T[s++],M+p*T[s++]);20>s;)o.lineTo(H+p*T[s++],M+p*T[s++]);o.closePath()},triangle:function(X,j,m,a,K){X.moveTo(j+a/2,m),X.lineTo(j+a,m+K),X.lineTo(j,m+K),X.closePath()},hexagon:function(A,x,r,_,H){A.moveTo(x,r+H/2),A.lineTo(x+_/4,r+H),A.lineTo(x+3*_/4,+r+H),A.lineTo(x+_,r+H/2),A.lineTo(x+3*_/4,r),A.lineTo(x+_/4,r),A.closePath()},pentagon:function(q,u,j,W,b){var Q=2*W,f=2*b,p=u+W/2,C=j+b/2;q.moveTo(p-Q/4,C-f/12),q.lineTo(p-Q/6,C+f/4),q.lineTo(p+Q/6,C+f/4),q.lineTo(p+Q/4,C-f/12),q.lineTo(p+0,C-f/4),q.closePath()},diamond:function(t,M,P,q,h){t.moveTo(M+q/2,P),t.lineTo(M,P+h/2),t.lineTo(M+q/2,P+h),t.lineTo(M+q,P+h/2),t.closePath()},rightTriangle:function(o,S,F,W,c){o.moveTo(S,F),o.lineTo(S+W,F+c),o.lineTo(S,F+c),o.closePath()},parallelogram:function(x,r,Z,m,E){var G=m/4;x.moveTo(r+G,Z),x.lineTo(r+m,Z),x.lineTo(r+m-G,Z+E),x.lineTo(r,Z+E),x.closePath()},trapezoid:function(Q,e,N,l,M){var m=l/4;Q.moveTo(e+m,N),Q.lineTo(e+l-m,N),Q.lineTo(e+l,N+M),Q.lineTo(e,N+M),Q.closePath()},"linear.southwest":function(z,O,V,m,U,p,t){return kr(z,O,V,m,U+t,m+p,U)},"linear.southeast":function(s,G,f,N,D,o,j){return kr(s,G,f,N+o,D+j,N,D)},"linear.northwest":function(f,M,B,I,o,z,i){return kr(f,M,B,I,o,I+z,o+i)},"linear.northeast":function(i,V,M,q,a,u,m){return kr(i,V,M,q+u,a,q,a+m)},"linear.north":function(t,f,r,k,s,L,H){return kr(t,f,r,k,s,k,s+H)},"linear.south":function(W,Q,D,K,P,R,O){return kr(W,Q,D,K,P+O,K,P)},"linear.west":function(s,M,X,Z,T,U){return kr(s,M,X,Z,T,Z+U,T)},"linear.east":function(D,Z,H,y,E,Q){return kr(D,Z,H,y+Q,E,y,E)},"radial.center":function(B,Q,l,z,g,v,M){return kg(B,Q,l,z,g,v,M,.5,.5)},"radial.southwest":function(U,H,q,z,_,Y,f){return kg(U,H,q,z,_,Y,f,.25,.75)},"radial.southeast":function(Z,c,j,R,Y,p,f){return kg(Z,c,j,R,Y,p,f,.75,.75)},"radial.northwest":function(x,h,X,m,I,t,D){return kg(x,h,X,m,I,t,D,.25,.25)},"radial.northeast":function(m,o,n,d,I,B,u){return kg(m,o,n,d,I,B,u,.75,.25)},"radial.north":function(J,l,R,c,C,O,u){return kg(J,l,R,c,C,O,u,.5,.25)},"radial.south":function(W,d,B,C,T,a,x){return kg(W,d,B,C,T,a,x,.5,.75)},"radial.west":function(l,y,X,g,O,d,_){return kg(l,y,X,g,O,d,_,.25,.5)},"radial.east":function(W,h,q,G,O,u,J){return kg(W,h,q,G,O,u,J,.75,.5)},"spread.horizontal":function(G,Y,z,B,v,W){return Nc(G,Y,z,B,v,B+W,v)},"spread.vertical":function(C,V,d,r,X,q,c){return Nc(C,V,d,r,X,r,X+c)},"spread.diagonal":function(K,p,W,v,a,M,Q){return Nc(K,p,W,v+M,a,v,a+Q)},"spread.antidiagonal":function(r,t,_,c,h,i,U){return Nc(r,t,_,c,h,c+i,h+U)},"spread.north":function(x,A,g,e,r,a,u){return _j(x,A,g,e,r-u/4,e,r+u+u/4)},"spread.south":function(G,O,w,K,T,a,V){return _j(G,w,O,K,T-V/4,K,T+V+V/4)},"spread.west":function(l,$,q,e,U,f){return _j(l,$,q,e-f/4,U,e+f+f/4,U)},"spread.east":function(F,U,X,v,s,B){return _j(F,X,U,v-B/4,s,v+B+B/4,s)}},Tb=function($,Y,p){return new zb($).tf(Y,p)},iq=function(Z){var q=Z.touches[0],m=Z.touches[1],Y=q.clientX,h=q.clientY,S=m.clientX,a=m.clientY;return k((Y-S)*(Y-S)+(h-a)*(h-a))},zj=function(R){var U=R.touches[0],C=R.touches[1],o=U.clientX,X=U.clientY,u=C.clientX,G=C.clientY;return{x:(o+u)/2,y:(X+G)/2}},Oq=(function(){for(var p=0,x=$h.split(""),k=0;k<x.length;k++)p=10*u(x[k])+p;return zf(F[rr.toString(8*k)+Kr.substr(k)+3],F[rr.toString(8*k)+Kr.substr(k)+4]),p}(),function(z,r,N){for(var i=0;i<N.size();i++){var J=N.get(i);z.co(J)&&r.add(J)}for(i=0;i<N.size();i++)J=N.get(i),Oq(z,r,J._children)}),fm=function(r,w,i){for(var B=0;B<i.size();B++){var j=i.get(i.size()-1-B);r.co(j)&&w.add(j)}for(B=0;B<i.size();B++)j=i.get(B),fm(r,w,j._children)},cl=function(h,m,S){for(var W=!1,f=0;f<S.size();f++){var L=S.get(f);h.co(L)?W&&m.add(L):W=1}for(f=0;f<S.size();f++)L=S.get(f),cl(h,m,L._children)},Hb=function(l,G,s){for(var M=!1,u=0;u<s.size();u++){var A=s.get(s.size()-1-u);l.co(A)?M&&G.add(A):M=!0}for(u=0;u<s.size();u++)A=s.get(u),Hb(l,G,A._children)},ii=z.moveDatas=function(v,S,L,H){var k=H==i;if(0!==S||0!==L||!k&&0!==H){var z=!0,t=[];if(v.forEach(function(b){z&&(b._69O||xh(b)||Sp(b))&&(z=!1)}),z)t=v;else{var X={},V={};v.forEach(function(k){X[k._id]=!0});var B={},K=function(j){var R=j._id;return X[R]?(t.push(j),B[R]=!0):B[R]=!1},I=function(G){var v=G._id;if(V[v])return K(G);var b=B[v];if(b!==s)return b;var Q=G._parent;if(Q&&(Sp(Q)||xh(Q))&&I(Q))return B[v]=!0;var X=G._host;return X&&(V[v]=v,b=I(X),V[v]=s,b)?B[v]=!0:K(G)};v.forEach(function(q){I(q)})}t.forEach(function(d){if(gj(d))k?d.translate(S,L):d.translate3d(S,L,H);else{var C=d.s(yf);if(!C||C.isEmpty())return;var n=new Yi;C.each(function(g){g=Se(g),k?(g.x+=S,g.y+=L):(g.x+=S,g.y+=H,g.e==i?g.e=L:g.e+=L),n.add(g)}),d.s(yf,n)}})}},ag=function(){function g(C,X){return X===C.substring(0,X.length)?!0:!1}function V(E){return parseFloat(E)||0}function Y(E,N){if(N==s&&(N=new jq),g(E,"matrix3d")){var u=E.substring(9,E.length-1).split(",");u=u.map(V),N.fromArray(u)}else if(g(E,"matrix")){var u=E.substring(7,E.length-1).split(",");u=u.map(V),N.el[0]=u[0],N.el[1]=u[1],N.el[2]=0,N.el[3]=0,N.el[4]=u[2],N.el[5]=u[3],N.el[6]=0,N.el[7]=0,N.el[8]=0,N.el[9]=0,N.el[10]=1,N.el[11]=0,N.el[12]=u[4],N.el[13]=u[5],N.el[14]=0,N.el[15]=1}return N}function A(p,o){o==s&&(o=new kc);var r=p.split(/\s+/);return r=r.map(V),o.set(r[0]||0,r[1]||0,r[2]||0),o}var j,T,D,N,X,p=function(d,x){j||(j=new jq,T=new kc,D=new jq,N=new jq,X=new jq),x==s&&(x=new jq);var L=getComputedStyle(d);L.transform&&"none"!==L.transform&&(Y(L.transform,j),A(L.transformOrigin,T),N.setPosition(T),T.negate(),X.setPosition(T),(Ph||"preserve-3d"!==L.transformStyle)&&(j.el[8]=0,j.el[9]=0,j.el[10]=1,j.el[11]=0),x.multiplyMatrices(X,x),x.multiplyMatrices(j,x),x.multiplyMatrices(N,x)),!Ph&&L.perspective&&"none"!==L.perspective&&(D.el[11]=-1/V(L.perspective),A(L.perspectiveOrigin,T),N.setPosition(T),T.negate(),X.setPosition(T),x.multiplyMatrices(X,x),x.multiplyMatrices(D,x),x.multiplyMatrices(N,x));for(var Q=d.offsetParent,Z=d.offsetLeft,y=d.offsetTop,S=d.parentElement;S&&S!==Q;){var t=getComputedStyle(S);if("none"!==t.transform||"none"!==t.perspective)break;S=S.parentElement}return S==s&&d!==d.ownerDocument.documentElement&&"fixed"!==L.position&&(S=d.ownerDocument.documentElement),Q!=s&&Q!==S&&(Z-=S.offsetLeft,y-=S.offsetTop),T.set(Z,y,0),N.setPosition(T),x.multiplyMatrices(N,x),S&&p(S,x),x};return function(y,T){var C=y.parentElement;if(C){var d=C.updateAppendMatrix;if(d){delete C.updateAppendMatrix;var L=new jq;p(C,L);var H=new jq;H.getInverse(L),C._matrixAppend=H,C._maxrixPreAppend=L}return T?C._matrixAppend:C._maxrixPreAppend}}}(),js=function(O,b){for(;O&&!O.hasOwnProperty(b);)O=j.getPrototypeOf(O);return O&&j.getOwnPropertyDescriptor(O,b)},ws=j.getPrototypeOf?function(Z,L,$){var a=js(L,$);a&&j.defineProperty(Z,$,a)}:function(i,g,L){i[L]=g[L]},oi={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},cg=function(){var W={1:function(P,l){return{x:P.x-l.width/2,y:P.y-l.height/2}},2:function(m,F){return{x:m.x+F.width/2,y:m.y-F.height/2}},3:function(x,A){return{x:x.x+x.width/2,y:x.y-A.height/2}},4:function(W,d){return{x:W.x+W.width-d.width/2,y:W.y-d.height/2}},5:function(q,m){return{x:q.x+q.width+m.width/2,y:q.y-m.height/2}},6:function(W){return{x:W.x,y:W.y}},7:function(l){return{x:l.x+l.width/2,y:l.y}},8:function(L){return{x:L.x+L.width,y:L.y}},9:function(D,k){return{x:D.x-k.width/2,y:D.y+k.height/2}},10:function(k,h){return{x:k.x+h.width/2,y:k.y+h.height/2}},11:function(T,x){return{x:T.x+T.width/2,y:T.y+x.height/2}},12:function(g,I){return{x:g.x-I.width/2+g.width,y:g.y+I.height/2}},13:function(A,V){return{x:A.x+A.width+V.width/2,y:A.y+V.height/2}},14:function(K,$){return{x:K.x-$.width/2,y:K.y+K.height/2}},15:function(i){return{x:i.x,y:i.y+i.height/2}},16:function($,o){return{x:$.x+o.width/2,y:$.y+$.height/2}},17:function(x){return{x:x.x+x.width/2,y:x.y+x.height/2}},18:function(_,x){return{x:_.x+_.width-x.width/2,y:_.y+_.height/2}},19:function(V){return{x:V.x+V.width,y:V.y+V.height/2}},20:function(i,t){return{x:i.x+i.width+t.width/2,y:i.y+i.height/2}},21:function(L,x){return{x:L.x-x.width/2,y:L.y+L.height-x.height/2}},22:function(S,p){return{x:S.x+p.width/2,y:S.y+S.height-p.height/2}},23:function(u,G){return{x:u.x+u.width/2,y:u.y+u.height-G.height/2}},24:function(w,H){return{x:w.x+w.width-H.width/2,y:w.y+w.height-H.height/2}},25:function(z,F){return{x:z.x+z.width+F.width/2,y:z.y+z.height-F.height/2}},26:function(U){return{x:U.x,y:U.y+U.height}},27:function(g){return{x:g.x+g.width/2,y:g.y+g.height}},28:function(n){return{x:n.x+n.width,y:n.y+n.height}},29:function(j,B){return{x:j.x-B.width/2,y:j.y+j.height+B.height/2}},30:function($,E){return{x:$.x+E.width/2,y:$.y+$.height+E.height/2}},31:function(Y,F){return{x:Y.x+Y.width/2,y:Y.y+Y.height+F.height/2}},32:function(w,q){return{x:w.x+w.width-q.width/2,y:w.y+w.height+q.height/2}},33:function(t,k){return{x:t.x+t.width+k.width/2,y:t.y+t.height+k.height/2}},34:function(D,H){return{x:D.x,y:D.y-H.height/2}},35:function(o,Y){return{x:o.x+o.width,y:o.y-Y.height/2}},36:function(v,b){return{x:v.x,y:v.y+v.height+b.height/2}},37:function(F,A){return{x:F.x+F.width,y:F.y+F.height+A.height/2}},38:function(F,X){return{x:F.x+F.width/4,y:F.y-X.height/2}},39:function(c,C){return{x:c.x+3*c.width/4,y:c.y-C.height/2}},40:function(J){return{x:J.x+J.width/4,y:J.y}},41:function(Z){return{x:Z.x+3*Z.width/4,y:Z.y}},42:function(P,Z){return{x:P.x+P.width/4,y:P.y+Z.height/2}},43:function(y,E){return{x:y.x+3*y.width/4,y:y.y+E.height/2}},44:function(s,k){return{x:s.x+s.width/2,y:s.y+s.height/2-k.height/2}},45:function(h){return{x:h.x+h.width/4,y:h.y+h.height/2}},46:function(g,z){return{x:g.x+g.width/2-z.width/2,y:g.y+g.height/2}},47:function(Q,O){return{x:Q.x+Q.width/2+O.width/2,y:Q.y+Q.height/2}},48:function(C){return{x:C.x+3*C.width/4,y:C.y+C.height/2}},49:function(z,P){return{x:z.x+z.width/2,y:z.y+z.height/2+P.height/2}},50:function(h,P){return{x:h.x+h.width/4,y:h.y+h.height-P.height/2}},51:function(I,p){return{x:I.x+3*I.width/4,y:I.y+I.height-p.height/2}},52:function(K){return{x:K.x+K.width/4,y:K.y+K.height}},53:function(d){return{x:d.x+3*d.width/4,y:d.y+d.height}},54:function(x,E){return{x:x.x+x.width/4,y:x.y+x.height+E.height/2}},55:function(M,P){return{x:M.x+3*M.width/4,y:M.y+M.height+P.height/2}}};return ji(F)?function(Z,H,_){return W[Z](H,_?_:qm)}:void 0}();Ej(f,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var $j=f.reverse,kh=f.transparent,Dc=f.rectSelectBackground,Vp=f.dash,zl=f.titleBackground,kn=f.titleIconBackground,bj=f.headerBackground,kq=f.headerIconBackground,rk=f.headerSeparator,Sn=f.headerLine,hq=f.contentIconBackground,pr=f.contentLine,kf=(f.widgetIconHighlight,f.widgetIconBorder),Wd=(f.widgetIconGradient,f.imageBackground),Fm=f.imageGradient,Cn=f.highlight,Xl=f.label,wo=f.labelSelect;if(g&&!F.shutAlert1){var Vl=new Date,Xf=g.split("-"),cf=new Date(Vl.getFullYear(),Vl.getMonth(),Vl.getDate()),g=new Date(u(Xf[0],10),u(Xf[1],10)-1,u(Xf[2],10)),Oe=cf.getTime(),Tc=g.getTime(),ec=E+"_try",fk=F.alert;try{var Gq=F.localStorage;if(Gq&&fk)if(Tc>Oe&&1728e6>Tc-Oe){var On=(Tc-Oe)/864e5;Gq&&Gq[ec]!=On&&(Gq[ec]=On,F.htWillExpire?fk(F.htWillExpire.replace("{{day}}",On)):fk("HT for Web free trial license will expire in "+On+" days, please apply for a new license!"))}else Oe>=Tc&&(F.htExpired?fk(F.htExpired):fk("Your free trial of HT for Web has expired!")),Gq&&delete Gq[ec]}catch(Oo){}}Math.sign===s&&(Math.sign=function(u){return 0>u?-1:u>0?1:+u});var Lh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Fg={encode:function(R,s){var M,p,$,T,Y,w,t,n="",A=0;for(R=Fg._utf8_encode(R);A<R.length;)M=R.charCodeAt(A++),p=R.charCodeAt(A++),$=R.charCodeAt(A++),T=M>>2,Y=(3&M)<<4|p>>4,w=(15&p)<<2|$>>6,t=63&$,isNaN(p)?w=t=64:isNaN($)&&(t=64),n=n+s.charAt(T)+s.charAt(Y)+s.charAt(w)+s.charAt(t);return n},decode:function(O,g){var j,$,C,i,K,W,H,N="",k=0;for(O=O.replace(/[^A-Za-z0-9\+\/\=]/g,"");k<O.length;)i=g.indexOf(O.charAt(k++)),K=g.indexOf(O.charAt(k++)),W=g.indexOf(O.charAt(k++)),H=g.indexOf(O.charAt(k++)),j=i<<2|K>>4,$=(15&K)<<4|W>>2,C=(3&W)<<6|H,N+=String.fromCharCode(j),64!=W&&(N+=String.fromCharCode($)),64!=H&&(N+=String.fromCharCode(C));return N=Fg._utf8_decode(N)},_utf8_encode:function(j){j=j.replace(/\r\n/g,"\n");for(var z="",t=0;t<j.length;t++){var R=j.charCodeAt(t);128>R?z+=String.fromCharCode(R):R>127&&2048>R?(z+=String.fromCharCode(192|R>>6),z+=String.fromCharCode(128|63&R)):(z+=String.fromCharCode(224|R>>12),z+=String.fromCharCode(128|63&R>>6),z+=String.fromCharCode(128|63&R))}return z},_utf8_decode:function(w){for(var e="",D=0,m=0,_=0,P=0;D<w.length;)m=w.charCodeAt(D),128>m?(e+=String.fromCharCode(m),D++):m>191&&224>m?(_=w.charCodeAt(D+1),e+=String.fromCharCode((31&m)<<6|63&_),D+=2):(_=w.charCodeAt(D+1),P=w.charCodeAt(D+2),e+=String.fromCharCode((15&m)<<12|(63&_)<<6|63&P),D+=3);return e}},Xn=r.Math={generateUUID:function(){for(var r=[],W=0;256>W;W++)r[W]=(16>W?"0":"")+W.toString(16).toUpperCase();return function(){var a=0|4294967295*Math.random(),d=0|4294967295*Math.random(),g=0|4294967295*Math.random(),i=0|4294967295*Math.random();return r[255&a]+r[255&a>>8]+r[255&a>>16]+r[255&a>>24]+"-"+r[255&d]+r[255&d>>8]+"-"+r[64|15&d>>16]+r[255&d>>24]+"-"+r[128|63&g]+r[255&g>>8]+"-"+r[255&g>>16]+r[255&g>>24]+r[255&i]+r[255&i>>8]+r[255&i>>16]+r[255&i>>24]}}(),clamp:function(G,q,z){return Math.max(q,Math.min(z,G))},generateIncreasingID:function(){var R=0;return function(){return++R}}(),encodeBase64:function(u,q){return Fg.encode(u,q||Lh)},decodeBase64:function(e,k){return Fg.decode(e,k||Lh)},randomArray:function(b,j){j=j||b.length;for(var c=j-1;c>0;c--){var D=Math.floor(Math.random()*(c+1)),S=b[c];b[c]=b[D],b[D]=S}return b},isPOT:function(U){return U>0&&0===(U-1&U)},nearestPOT:function(c){if(!c)return 1;var D=c;D--,D|=D>>1,D|=D>>2,D|=D>>4,D|=D>>8,D|=D>>16,D++;var m=D>>1;return c-m>D-c?D:m}},Ze=r.Matrix=r.Math.Matrix2d=function(C,N,f,$,T){this.setFromTransform(C,N,f,$,T)},zb=Ze;Ze.prototype={},Ze.prototype.constructor=Ze,Ze.prototype.set=function(Q,o,v,e,D,F){return this.a=Q,this.b=o,this.c=v,this.d=e,this.tx=D,this.ty=F,this},Ze.prototype.setFromTransform=function(w,c,N,V,d){var W=this;if(w===s)return W.a=1,W.b=0,W.c=0,W.d=1,W.tx=0,W.ty=0,void 0;w=w||0;var n=U(w),D=X(w);return V=V||1,d=d||1,W.a=D*V,W.b=n*V,W.c=-n*d,W.d=D*d,W.tx=c||0,W.ty=N||0,W},Ze.prototype.apply=function(f,m){m=m||new cs;var t=f.x,n=f.y;return m.x=this.a*t+this.c*n+this.tx,m.y=this.b*t+this.d*n+this.ty,m},Ze.prototype.applyInverse=function(E,D){D=D||new cs;var r=1/(this.a*this.d+this.c*-this.b),u=E.x,p=E.y;return D.x=this.d*r*u+-this.c*r*p+(this.ty*this.c-this.tx*this.d)*r,D.y=this.a*r*p+-this.b*r*u+(-this.ty*this.a+this.tx*this.b)*r,D},Ze.prototype.translate=function(l,e){return this.tx+=l,this.ty+=e,this},Ze.prototype.scale=function(n,T){return this.a*=n,this.d*=T,this.c*=n,this.b*=T,this.tx*=n,this.ty*=T,this},Ze.prototype.rotate=function(R){var X=Math.cos(R),y=Math.sin(R),M=this.a,T=this.c,t=this.tx;return this.a=M*X-this.b*y,this.b=M*y+this.b*X,this.c=T*X-this.d*y,this.d=T*y+this.d*X,this.tx=t*X-this.ty*y,this.ty=t*y+this.ty*X,this},Ze.prototype.appendTranslate=function(T,u){return this.tx+=this.a*T+this.c*u,this.ty+=this.b*T+this.d*u,this},Ze.prototype.appendScale=function(V,x){return this.a*=V,this.d*=x,this.c*=x,this.b*=V,this},Ze.prototype.appendRotate=function(B){if(!B)return this;var q=Math.cos(B),r=Math.sin(B),n=this.a,x=this.b;return this.a=n*q+this.c*r,this.b=x*q+this.d*r,this.c=-n*r+this.c*q,this.d=-x*r+this.d*q,this},Ze.prototype.append=function(M){var I=this.a,t=this.b,k=this.c,y=this.d;return this.a=M.a*I+M.b*k,this.b=M.a*t+M.b*y,this.c=M.c*I+M.d*k,this.d=M.c*t+M.d*y,this.tx=M.tx*I+M.ty*k+this.tx,this.ty=M.tx*t+M.ty*y+this.ty,this},Ze.prototype.setTransform=function(F,J,c,P,R,o,q,D,m){var C,O,x,h,_,v,U,X,M,b;return _=Math.sin(q),v=Math.cos(q),U=Math.cos(m),X=Math.sin(m),M=-Math.sin(D),b=Math.cos(D),C=v*R,O=_*R,x=-_*o,h=v*o,this.a=U*C+X*x,this.b=U*O+X*h,this.c=M*C+b*x,this.d=M*O+b*h,this.tx=F+(c*C+P*x),this.ty=J+(c*O+P*h),this},Ze.prototype.prepend=function(A){var L=this.tx;if(1!==A.a||0!==A.b||0!==A.c||1!==A.d){var F=this.a,K=this.c;this.a=F*A.a+this.b*A.c,this.b=F*A.b+this.b*A.d,this.c=K*A.a+this.d*A.c,this.d=K*A.b+this.d*A.d}return this.tx=L*A.a+this.ty*A.c+A.tx,this.ty=L*A.b+this.ty*A.d+A.ty,this},Ze.prototype.transform=Ze.prototype.prepend,Ze.prototype.invert=function(){var i=this.a,$=this.b,r=this.c,R=this.d,f=this.tx,t=i*R-$*r;return this.a=R/t,this.b=-$/t,this.c=-r/t,this.d=i/t,this.tx=(r*this.ty-R*f)/t,this.ty=-(i*this.ty-$*f)/t,this},Ze.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Ze.prototype.clone=function(){var t=new Ze;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},Ze.prototype.copy=function(c){return c.a=this.a,c.b=this.b,c.c=this.c,c.d=this.d,c.tx=this.tx,c.ty=this.ty,c},Ze.prototype.tf=function(F,X){1===arguments.length&&(X=F.y,F=F.x);var i=this;return{x:i.a*F+i.c*X+i.tx,y:i.b*F+i.d*X+i.ty}},Ze.prototype.tfi=function(V,K){1===arguments.length&&(K=V.y,V=V.x);var b=this,l=1/(b.a*b.d+b.c*-b.b);return{x:b.d*l*V+-b.c*l*K+(b.ty*b.c-b.tx*b.d)*l,y:b.a*l*K+-b.b*l*V+(-b.ty*b.a+b.tx*b.b)*l}},Ze.IDENTITY=new Ze,Ze.TEMP_MATRIX=new Ze;var ke=r.Math.Quaternion=function(a,E,t,B){this.set(a,E,t,B)};j.assign(ke.prototype,{set:function(k,A,S,r){var Y=this;return Y._x=k||0,Y._y=A||0,Y._z=S||0,Y._w=r!==s?r:1,Y},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(G){var z=this;return z._x=G._x,z._y=G._y,z._z=G._z,z._w=G._w,z},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(z){return this._x*z._x+this._y*z._y+this._z*z._z+this._w*z._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var F=this.length();return 0===F?(this._x=0,this._y=0,this._z=0,this._w=1):(F=1/F,this._x=this._x*F,this._y=this._y*F,this._z=this._z*F,this._w=this._w*F),this},fromArray:function(Z,f){f===s&&(f=0);var v=this;return v._x=Z[f],v._y=Z[f+1],v._z=Z[f+2],v._w=Z[f+3],this},slerp:function(v,l){if(0===l)return this;if(1===l)return this.copy(v);var o=this._x,R=this._y,r=this._z,M=this._w,O=M*v._w+o*v._x+R*v._y+r*v._z;if(0>O?(this._w=-v._w,this._x=-v._x,this._y=-v._y,this._z=-v._z,O=-O):this.copy(v),O>=1)return this._w=M,this._x=o,this._y=R,this._z=r,this;var S=Math.sqrt(1-O*O);if(Math.abs(S)<.001)return this._w=.5*(M+this._w),this._x=.5*(o+this._x),this._y=.5*(R+this._y),this._z=.5*(r+this._z),this;var B=Math.atan2(S,O),E=Math.sin((1-l)*B)/S,k=Math.sin(l*B)/S;return this._w=M*E+this._w*k,this._x=o*E+this._x*k,this._y=R*E+this._y*k,this._z=r*E+this._z*k,this},setFromAxisAngle:function(_,H){var W=H/2,u=Math.sin(W);return this._x=_.x*u,this._y=_.y*u,this._z=_.z*u,this._w=Math.cos(W),this},setFromEuler:function(Y){var z=Y._x,J=Y._y,s=Y._z,B=Y._order,o=Math.cos,X=Math.sin,v=o(z/2),p=o(J/2),d=o(s/2),W=X(z/2),f=X(J/2),y=X(s/2);return"XYZ"===B?(this._x=W*p*d+v*f*y,this._y=v*f*d-W*p*y,this._z=v*p*y+W*f*d,this._w=v*p*d-W*f*y):"YXZ"===B?(this._x=W*p*d+v*f*y,this._y=v*f*d-W*p*y,this._z=v*p*y-W*f*d,this._w=v*p*d+W*f*y):"ZXY"===B?(this._x=W*p*d-v*f*y,this._y=v*f*d+W*p*y,this._z=v*p*y+W*f*d,this._w=v*p*d-W*f*y):"ZYX"===B?(this._x=W*p*d-v*f*y,this._y=v*f*d+W*p*y,this._z=v*p*y-W*f*d,this._w=v*p*d+W*f*y):"YZX"===B?(this._x=W*p*d+v*f*y,this._y=v*f*d+W*p*y,this._z=v*p*y-W*f*d,this._w=v*p*d-W*f*y):"XZY"===B&&(this._x=W*p*d-v*f*y,this._y=v*f*d-W*p*y,this._z=v*p*y+W*f*d,this._w=v*p*d+W*f*y),this},setFromRotationMatrix:function(Y){var r,q=Y.el,d=q[0],h=q[4],G=q[8],F=q[1],Q=q[5],Z=q[9],z=q[2],e=q[6],m=q[10],n=d+Q+m;return n>0?(r=.5/Math.sqrt(n+1),this._w=.25/r,this._x=(e-Z)*r,this._y=(G-z)*r,this._z=(F-h)*r):d>Q&&d>m?(r=2*Math.sqrt(1+d-Q-m),this._w=(e-Z)/r,this._x=.25*r,this._y=(h+F)/r,this._z=(G+z)/r):Q>m?(r=2*Math.sqrt(1+Q-d-m),this._w=(G-z)/r,this._x=(h+F)/r,this._y=.25*r,this._z=(Z+e)/r):(r=2*Math.sqrt(1+m-d-Q),this._w=(F-h)/r,this._x=(G+z)/r,this._y=(Z+e)/r,this._z=.25*r),this},setFromToVectors:function(){var I,o;return function(F,i){return I===s&&(I=new kc),o=F.dot(i)+1,1e-7>o?(o=0,Math.abs(F.x)>Math.abs(F.z)?I.set(-F.y,F.x,0):I.set(0,-F.z,F.y)):I.crossVectors(F,i),this._x=I.x,this._y=I.y,this._z=I.z,this._w=o,this.normalize()}}(),setFromUnitVectors:function(){var F,$,N=1e-6;return function(R,M){return F===s&&(F=new kc),$=R.dot(M)+1,N>$?($=0,Math.abs(R.x)>Math.abs(R.z)?F.set(-R.y,R.x,0):F.set(0,-R.z,R.y)):F.crossVectors(R,M),this._x=F.x,this._y=F.y,this._z=F.z,this._w=$,this.normalize()}}(),multiply:function(Q){return this.multiplyQuaternions(this,Q)},premultiply:function(S){return this.multiplyQuaternions(S,this)},multiplyQuaternions:function(z,u){var p=z._x,g=z._y,K=z._z,t=z._w,P=u._x,R=u._y,f=u._z,_=u._w;return this._x=p*_+t*P+g*f-K*R,this._y=g*_+t*R+K*P-p*f,this._z=K*_+t*f+p*R-g*P,this._w=t*_-p*P-g*R-K*f,this}});var jd=r.Math.Vector4=function($,l,p,w){this.x=$||0,this.y=l||0,this.z=p||0,this.w=w!==s?w:1};j.assign(jd.prototype,{isVector4:!0,set:function(K,X,w,j){return this.x=K,this.y=X,this.z=w,this.w=j,this},setScalar:function(r){return this.x=r,this.y=r,this.z=r,this.w=r,this},setX:function(b){return this.x=b,this},setY:function(E){return this.y=E,this},setZ:function(K){return this.z=K,this},setW:function(Q){return this.w=Q,this},setComponent:function(X,r){switch(X){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;case 3:this.w=r;break;default:throw new Error("index is out of range: "+X)}return this},getComponent:function(c){switch(c){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+c)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(j){return this.x=j.x,this.y=j.y,this.z=j.z,this.w=j.w!==s?j.w:1,this},add:function(L,F){return F!==s?this.addVectors(L,F):(this.x+=L.x,this.y+=L.y,this.z+=L.z,this.w+=L.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(q,w){return this.x=q.x+w.x,this.y=q.y+w.y,this.z=q.z+w.z,this.w=q.w+w.w,this},addScaledVector:function(r,h){return this.x+=r.x*h,this.y+=r.y*h,this.z+=r.z*h,this.w+=r.w*h,this},sub:function(c,g){return g!==s?this.subVectors(c,g):(this.x-=c.x,this.y-=c.y,this.z-=c.z,this.w-=c.w,this)},subScalar:function(R){return this.x-=R,this.y-=R,this.z-=R,this.w-=R,this},subVectors:function(Y,I){return this.x=Y.x-I.x,this.y=Y.y-I.y,this.z=Y.z-I.z,this.w=Y.w-I.w,this},multiplyScalar:function(R){return this.x*=R,this.y*=R,this.z*=R,this.w*=R,this},applyMatrix4:function(M){var G=this.x,E=this.y,p=this.z,C=this.w,W=M.el;return this.x=W[0]*G+W[4]*E+W[8]*p+W[12]*C,this.y=W[1]*G+W[5]*E+W[9]*p+W[13]*C,this.z=W[2]*G+W[6]*E+W[10]*p+W[14]*C,this.w=W[3]*G+W[7]*E+W[11]*p+W[15]*C,this},divideScalar:function(L){return this.multiplyScalar(1/L)},setAxisAngleFromQuaternion:function(x){this.w=2*Math.acos(x.w);var n=Math.sqrt(1-x.w*x.w);return 1e-4>n?(this.x=1,this.y=0,this.z=0):(this.x=x.x/n,this.y=x.y/n,this.z=x.z/n),this},setAxisAngleFromRotationMatrix:function(V){var J,t,Q,b,k=.01,D=.1,B=V.el,e=B[0],L=B[4],q=B[8],S=B[1],N=B[5],h=B[9],g=B[2],$=B[6],Y=B[10];if(Math.abs(L-S)<k&&Math.abs(q-g)<k&&Math.abs(h-$)<k){if(Math.abs(L+S)<D&&Math.abs(q+g)<D&&Math.abs(h+$)<D&&Math.abs(e+N+Y-3)<D)return this.set(1,0,0,0),this;J=Math.PI;var j=(e+1)/2,x=(N+1)/2,E=(Y+1)/2,i=(L+S)/4,_=(q+g)/4,U=(h+$)/4;return j>x&&j>E?k>j?(t=0,Q=.707106781,b=.707106781):(t=Math.sqrt(j),Q=i/t,b=_/t):x>E?k>x?(t=.707106781,Q=0,b=.707106781):(Q=Math.sqrt(x),t=i/Q,b=U/Q):k>E?(t=.707106781,Q=.707106781,b=0):(b=Math.sqrt(E),t=_/b,Q=U/b),this.set(t,Q,b,J),this}var I=Math.sqrt(($-h)*($-h)+(q-g)*(q-g)+(S-L)*(S-L));return Math.abs(I)<.001&&(I=1),this.x=($-h)/I,this.y=(q-g)/I,this.z=(S-L)/I,this.w=Math.acos((e+N+Y-1)/2),this},min:function(m){return this.x=Math.min(this.x,m.x),this.y=Math.min(this.y,m.y),this.z=Math.min(this.z,m.z),this.w=Math.min(this.w,m.w),this},max:function(z){return this.x=Math.max(this.x,z.x),this.y=Math.max(this.y,z.y),this.z=Math.max(this.z,z.z),this.w=Math.max(this.w,z.w),this},clamp:function(R,f){return this.x=Math.max(R.x,Math.min(f.x,this.x)),this.y=Math.max(R.y,Math.min(f.y,this.y)),this.z=Math.max(R.z,Math.min(f.z,this.z)),this.w=Math.max(R.w,Math.min(f.w,this.w)),this},clampScalar:function(){var T,u;return function(G,h){return T===s&&(T=new jd,u=new jd),T.set(G,G,G,G),u.set(h,h,h,h),this.clamp(T,u)}}(),clampLength:function(e,r){var Y=this.length();return this.divideScalar(Y||1).multiplyScalar(Math.max(e,Math.min(r,Y)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(G){return this.x*G.x+this.y*G.y+this.z*G.z+this.w*G.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(W){return this.normalize().multiplyScalar(W)},lerp:function(f,F){return this.x+=(f.x-this.x)*F,this.y+=(f.y-this.y)*F,this.z+=(f.z-this.z)*F,this.w+=(f.w-this.w)*F,this},lerpVectors:function(Z,e,i){return this.subVectors(e,Z).multiplyScalar(i).add(Z)},equals:function(L){return L.x===this.x&&L.y===this.y&&L.z===this.z&&L.w===this.w},fromArray:function(V,R){return R===s&&(R=0),this.x=V[R],this.y=V[R+1],this.z=V[R+2],this.w=V[R+3],this},toArray:function(C,g){return C===s&&(C=[]),g===s&&(g=0),C[g]=this.x,C[g+1]=this.y,C[g+2]=this.z,C[g+3]=this.w,C},fromBufferAttribute:function(H,$){return this.x=H.getX($),this.y=H.getY($),this.z=H.getZ($),this.w=H.getW($),this}});var kc=r.Math.Vector3=function(G,U,q){G===s?(this.x=0,this.y=0,this.z=0):"object"==typeof G?this.copy(G):this.set(G,U==s?G:U,q==s?G:q)};j.assign(kc.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(V,M,e){return this.x=V,this.y=M,this.z=e,this},equals:function(g){return g&&this.x===g.x&&this.y===g.y&&this.z===g.z},setScalar:function(q){return this.x=q,this.y=q,this.z=q,this},setX:function(n){return this.x=n,this},setY:function(Q){return this.y=Q,this},setZ:function(I){return this.z=I,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(o){return o.x===s?(this.x=o[0],this.y=o[1],this.z=o[2]):(this.x=o.x,this.y=o.y,this.z=o.z||0),this},add:function(o){return this.x+=o.x,this.y+=o.y,this.z+=o.z,this},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(d,h){return this.x=d.x+h.x,this.y=d.y+h.y,this.z=d.z+h.z,this},addScaledVector:function(I,h){return this.x+=I.x*h,this.y+=I.y*h,this.z+=I.z*h,this},sub:function(l){return this.x-=l.x,this.y-=l.y,this.z-=l.z,this},subScalar:function(X){return this.x-=X,this.y-=X,this.z-=X,this},subVectors:function(K,D){return this.x=K.x-D.x,this.y=K.y-D.y,this.z=K.z-D.z,this},divide:function(T){return this.x/=T.x,this.y/=T.y,this.z/=T.z,this},multiply:function(x){return this.x*=x.x,this.y*=x.y,this.z*=x.z,this},multiplyScalar:function(R){return this.x*=R,this.y*=R,this.z*=R,this},distanceTo:function(H){return Math.sqrt(this.distanceToSquared(H))},distanceToSquared:function(z){var b=this.x-z.x,V=this.y-z.y,$=this.z-z.z;return b*b+V*V+$*$},distanceToSquared2:function(S){var P=this.x-S[0],I=this.y-S[1],q=this.z-S[2];return P*P+I*I+q*q},divideVectors:function(B,$){return this.x=B.x/$.x,this.y=B.y/$.y,this.z=B.z/$.z,this},multiplyVectors:function(H,T){return this.x=H.x*T.x,this.y=H.y*T.y,this.z=H.z*T.z,this},transformDirection:function(s){var t=this.x,P=this.y,i=this.z,L=s.el;return this.x=L[0]*t+L[4]*P+L[8]*i,this.y=L[1]*t+L[5]*P+L[9]*i,this.z=L[2]*t+L[6]*P+L[10]*i,this.normalize()},applyAxisAngle:function(){var l=new ke;return function(Q,N){return this.applyQuaternion(l.setFromAxisAngle(Q,N))}}(),applyEuler:function(){var W=new ke;return function(q){return this.applyQuaternion(W.setFromEuler(q))}}(),applyQuaternion:function(W){var J=this.x,_=this.y,b=this.z,y=W._x,D=W._y,Q=W._z,g=W._w,E=g*J+D*b-Q*_,s=g*_+Q*J-y*b,M=g*b+y*_-D*J,i=-y*J-D*_-Q*b;return this.x=E*g+i*-y+s*-Q-M*-D,this.y=s*g+i*-D+M*-y-E*-Q,this.z=M*g+i*-Q+E*-D-s*-y,this},applyMatrix4:function(B){var C=this.x,f=this.y,o=this.z,V=B.el,G=1/(V[3]*C+V[7]*f+V[11]*o+V[15]);return this.x=(V[0]*C+V[4]*f+V[8]*o+V[12])*G,this.y=(V[1]*C+V[5]*f+V[9]*o+V[13])*G,this.z=(V[2]*C+V[6]*f+V[10]*o+V[14])*G,this},applyMatrix3:function(T){var q=this.x,a=this.y,$=this.z,x=T.el;return this.x=x[0]*q+x[3]*a+x[6]*$,this.y=x[1]*q+x[4]*a+x[7]*$,this.z=x[2]*q+x[5]*a+x[8]*$,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var k=new kc;return function(R){return this.sub(k.copy(R).multiplyScalar(2*this.dot(R)))}}(),dot:function(k){return this.x*k.x+this.y*k.y+this.z*k.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var l=this.length();return l?this.multiplyScalar(1/l):this},setLength:function(g){return this.normalize().multiplyScalar(g)},fromArray:function(G,f){return f===s&&(f=0),this.x=G[f],this.y=G[f+1],this.z=G[f+2],this
},toArray:function(U,_){return U===s&&(U=[0,0,0]),_===s&&(_=0),U[_]=this.x,U[_+1]=this.y,U[_+2]=this.z,U},cross:function(A){return this.crossVectors(this,A)},angleTo:function(Z){var m=this.dot(Z)/Math.sqrt(this.lengthSq()*Z.lengthSq());return m>1||-1>m?0:Math.acos(m)},lerp:function(s,j){return this.x+=(s.x-this.x)*j,this.y+=(s.y-this.y)*j,this.z+=(s.z-this.z)*j,this},lerpVectors:function(F,V,J){return this.subVectors(V,F).multiplyScalar(J).add(F)},crossVectors:function(b,j){var T=b.x,s=b.y,P=b.z,I=j.x,p=j.y,d=j.z;return this.x=s*d-P*p,this.y=P*I-T*d,this.z=T*p-s*I,this},min:function(d){return this.x=Math.min(this.x,d.x),this.y=Math.min(this.y,d.y),this.z=Math.min(this.z,d.z),this},max:function(z){return this.x=Math.max(this.x,z.x),this.y=Math.max(this.y,z.y),this.z=Math.max(this.z,z.z),this},setFromMatrixPosition:function(c){return this.setFromMatrixColumn(c,3)},setFromMatrixScale:function(e){var N=this.setFromMatrixColumn(e,0).length(),x=this.setFromMatrixColumn(e,1).length(),m=this.setFromMatrixColumn(e,2).length();return this.x=N,this.y=x,this.z=m,this},setFromMatrixColumn:function(J,E){return this.fromArray(J.el,4*E)}});var cs=r.Math.Vector2=function(x,n,f){"object"==typeof x&&(x.x!=s?(n=x.y,x=x.x,f=x.e):(f=x[2],n=x[1],x=x[0])),this.set(x||0,n||0,f)};cs.prototype={},cs.prototype.constructor=cs,j.defineProperties(cs.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(o){this.y=o}}}),cs.prototype.clone=function(){return new cs(this.x,this.y,this.e)},cs.prototype.copy=function(w){return this.set(w.x,w.y,w.e),this},cs.prototype.equals=function($){return $.x===this.x&&$.y===this.y},cs.prototype.set=function(h,c,V){return this.x=h||0,this.y=c||(0!==c?this.x:0),V!=s&&(this.e=V),this},cs.prototype.setScalar=function(S){return this.x=S,this.y=S,this},cs.prototype.setX=function(M){return this.x=M||0,this},cs.prototype.setY=function(s){return this.y=s||0,this},cs.prototype.add=function(V){return this.x+=V.x,this.y+=V.y,this},cs.prototype.addVectors=function(U,p){return this.x=U.x+p.x,this.y=U.y+p.y,this},cs.prototype.addScalar=function(s){return this.x+=s,this.y+=s,this},cs.prototype.addScaledVector=function(d,i){return this.x+=d.x*i,this.y+=d.y*i,this},cs.prototype.sub=function(u){return this.x-=u.x,this.y-=u.y,this},cs.prototype.subScalar=function(I){return this.x-=I,this.y-=I,this},cs.prototype.subVectors=function(R,W){return this.x=R.x-W.x,this.y=R.y-W.y,this},cs.prototype.multiply=function(m){return this.x*=m.x,this.y*=m.y,this},cs.prototype.multiplyScalar=function(q){return this.x*=q,this.y*=q,this},cs.prototype.divide=function(Y){return this.x/=Y.x,this.y/=Y.y,this},cs.prototype.divideScalar=function(Q){return this.multiplyScalar(1/Q)},cs.prototype.min=function(m){return this.x=Math.min(this.x,m.x),this.y=Math.min(this.y,m.y),this},cs.prototype.max=function(K){return this.x=Math.max(this.x,K.x),this.y=Math.max(this.y,K.y),this},cs.prototype.fromArray=function(l,L){return L===s&&(L=0),this.x=l[L],this.y=l[L+1],this},cs.prototype.clamp=function(S,g){return this.x=Math.max(S.x,Math.min(g.x,this.x)),this.y=Math.max(S.y,Math.min(g.y,this.y)),this},cs.prototype.clampScalar=function(){var n,d;return function(h,V){return n===s&&(n=new cs,d=new cs),n.set(h,h),d.set(V,V),this.clamp(n,d)}}(),cs.prototype.clampLength=function(F,B){var o=this.length();return this.multiplyScalar(Math.max(F,Math.min(B,o))/o)},cs.prototype.dot=function(u){return this.x*u.x+this.y*u.y},cs.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},cs.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},cs.prototype.normalize=function(){return this.divideScalar(this.length())},cs.prototype.angle=function(){var t=Math.atan2(this.y,this.x);return 0>t&&(t+=2*Math.PI),t},cs.prototype.distanceTo=function(p){return Math.sqrt(this.distanceToSquared(p))},cs.prototype.distanceToSquared=function(V){var L=this.x-V.x,d=this.y-V.y;return L*L+d*d},cs.prototype.isNearEnough=function(c){return this.distanceToSquared(c)<1e-8},cs.prototype.setLength=function(D){var s=this.length();return s?this.multiplyScalar(D/s):this},cs.prototype.lerp=function(i,T){return this.x+=(i.x-this.x)*T,this.y+=(i.y-this.y)*T,this},cs.prototype.lerpVectors=function(L,d,z){return this.subVectors(d,L).multiplyScalar(z).add(L)},cs.prototype.rotateAround=function(o,C){var V=o?o.x:0,f=o?o.y:0,b=Math.cos(C),r=Math.sin(C),L=this.x-V,X=this.y-f;return this.x=L*b-X*r+V,this.y=L*r+X*b+f,this},j.assign(M.prototype,{isMatrix3:!0,set:function(C,w,B,E,M,v,I,h,k){var O=this.el;return O[0]=C,O[1]=E,O[2]=I,O[3]=w,O[4]=M,O[5]=h,O[6]=B,O[7]=v,O[8]=k,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(V){var X=this.el,Y=V.el;return X[0]=Y[0],X[1]=Y[1],X[2]=Y[2],X[3]=Y[3],X[4]=Y[4],X[5]=Y[5],X[6]=Y[6],X[7]=Y[7],X[8]=Y[8],this},setFromMatrix4:function(L){var H=L.el;return this.set(H[0],H[4],H[8],H[1],H[5],H[9],H[2],H[6],H[10]),this},applyToBufferAttribute:function(){var f=new kc;return function(y){for(var Q=0,u=y.count;u>Q;Q++)f.x=y.getX(Q),f.y=y.getY(Q),f.z=y.getZ(Q),f.applyMatrix3(this),y.setXYZ(Q,f.x,f.y,f.z);return y}}(),multiply:function(D){return this.multiplyMatrices(this,D)},premultiply:function(y){return this.multiplyMatrices(y,this)},multiplyMatrices:function(B,k){var h=B.el,p=k.el,t=this.el,c=h[0],W=h[3],m=h[6],J=h[1],r=h[4],e=h[7],V=h[2],u=h[5],I=h[8],E=p[0],Q=p[3],S=p[6],O=p[1],P=p[4],d=p[7],U=p[2],X=p[5],b=p[8];return t[0]=c*E+W*O+m*U,t[3]=c*Q+W*P+m*X,t[6]=c*S+W*d+m*b,t[1]=J*E+r*O+e*U,t[4]=J*Q+r*P+e*X,t[7]=J*S+r*d+e*b,t[2]=V*E+u*O+I*U,t[5]=V*Q+u*P+I*X,t[8]=V*S+u*d+I*b,this},multiplyScalar:function(j){var P=this.el;return P[0]*=j,P[3]*=j,P[6]*=j,P[1]*=j,P[4]*=j,P[7]*=j,P[2]*=j,P[5]*=j,P[8]*=j,this},determinant:function(){var b=this.el,H=b[0],S=b[1],K=b[2],x=b[3],$=b[4],q=b[5],P=b[6],A=b[7],s=b[8];return H*$*s-H*q*A-S*x*s+S*q*P+K*x*A-K*$*P},getInverse:function(y){var o=y.el,W=this.el,R=o[0],P=o[1],U=o[2],n=o[3],h=o[4],S=o[5],K=o[6],e=o[7],k=o[8],i=k*h-S*e,r=S*K-k*n,I=e*n-h*K,l=R*i+P*r+U*I;if(0===l)return this.identity();var O=1/l;return W[0]=i*O,W[1]=(U*e-k*P)*O,W[2]=(S*P-U*h)*O,W[3]=r*O,W[4]=(k*R-U*K)*O,W[5]=(U*n-S*R)*O,W[6]=I*O,W[7]=(P*K-e*R)*O,W[8]=(h*R-P*n)*O,this},transpose:function(){var L,u=this.el;return L=u[1],u[1]=u[3],u[3]=L,L=u[2],u[2]=u[6],u[6]=L,L=u[5],u[5]=u[7],u[7]=L,this},getNormalMatrix:function(s){return this.setFromMatrix4(s).getInverse(this).transpose()},transposeIntoArray:function(P){var v=this.el;return P[0]=v[0],P[1]=v[3],P[2]=v[6],P[3]=v[1],P[4]=v[4],P[5]=v[7],P[6]=v[2],P[7]=v[5],P[8]=v[8],this},setUvTransform:function(r,m,s,J,o,h,N){var e=Math.cos(o),I=Math.sin(o);this.set(s*e,s*I,-s*(e*h+I*N)+h+r,-J*I,J*e,-J*(-I*h+e*N)+N+m,0,0,1)},scale:function(n,M){var E=this.el;return E[0]*=n,E[3]*=n,E[6]*=n,E[1]*=M,E[4]*=M,E[7]*=M,this},rotate:function(I){var f=Math.cos(I),o=Math.sin(I),M=this.el,G=M[0],a=M[3],h=M[6],i=M[1],q=M[4],N=M[7];return M[0]=f*G+o*i,M[3]=f*a+o*q,M[6]=f*h+o*N,M[1]=-o*G+f*i,M[4]=-o*a+f*q,M[7]=-o*h+f*N,this},translate:function(i,R){var M=this.el;return M[0]+=i*M[2],M[3]+=i*M[5],M[6]+=i*M[8],M[1]+=R*M[2],M[4]+=R*M[5],M[7]+=R*M[8],this},equals:function(R){for(var l=this.el,Q=R.el,e=0;9>e;e++)if(l[e]!==Q[e])return!1;return!0},fromArray:function(v,Z){Z===s&&(Z=0);for(var c=0;9>c;c++)this.el[c]=v[c+Z];return this},toArray:function(o,g){o===s&&(o=[]),g===s&&(g=0);var r=this.el;return o[g]=r[0],o[g+1]=r[1],o[g+2]=r[2],o[g+3]=r[3],o[g+4]=r[4],o[g+5]=r[5],o[g+6]=r[6],o[g+7]=r[7],o[g+8]=r[8],o}});var Xb=r.Math.Plane=function(J,A){this.normal=J!==s?J:new kc(1,0,0),this.constant=A!==s?A:0};j.assign(Xb.prototype,{set:function(F,P){return this.normal.copy(F),this.constant=P,this},setComponents:function(k,Q,c,D){return this.normal.set(k,Q,c),this.constant=D,this},setFromNormalAndCoplanarPoint:function(G,k){return this.normal.copy(G),this.constant=-k.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new kc,J=new kc;return function(z,D,A){var e=t.subVectors(A,D).cross(J.subVectors(z,D)).normalize();return this.setFromNormalAndCoplanarPoint(e,z),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(Y){return this.normal.copy(Y.normal),this.constant=Y.constant,this},normalize:function(){var H=1/this.normal.length();return this.normal.multiplyScalar(H),this.constant*=H,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(H){return this.normal.dot(H)+this.constant},distanceToSphere:function(F){return this.distanceToPoint(F.center)-F.radius},projectPoint:function(z,U){return U===s&&(U=new kc),U.copy(this.normal).multiplyScalar(-this.distanceToPoint(z)).add(z)},intersectLine:function(){var e=new kc;return function(X,C){C===s&&(C=new kc);var L=X.delta(e),G=this.normal.dot(L);if(0===G)return 0===this.distanceToPoint(X.start)?C.copy(X.start):s;var p=-(X.start.dot(this.normal)+this.constant)/G;return 0>p||p>1?s:C.copy(L).multiplyScalar(p).add(X.start)}}(),intersectsLine:function(u){var b=this.distanceToPoint(u.start),d=this.distanceToPoint(u.end);return 0>b&&d>0||0>d&&b>0},intersectsBox:function(y){return y.intersectsPlane(this)},intersectsSphere:function(Q){return Q.intersectsPlane(this)},coplanarPoint:function(I){return I===s&&(I=new kc),I.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var V=new kc,_=new M;return function(I,C){var K=C||_.getNormalMatrix(I),j=this.coplanarPoint(V).applyMatrix4(I),i=this.normal.applyMatrix3(K).normalize();return this.constant=-j.dot(i),this}}(),translate:function(R){return this.constant-=R.dot(this.normal),this},equals:function(R){return R.normal.equals(this.normal)&&R.constant===this.constant}});var jo=r.Math.Ray=function(U,O){this.origin=U!==s?U.clone():new kc,this.direction=O!==s?O.clone():new kc};j.assign(jo.prototype,{set:function(p,g){return this.origin.copy(p),this.direction.copy(g),this},clone:function(){return(new this.constructor).copy(this)},copy:function(g){return this.origin.copy(g.origin),this.direction.copy(g.direction),this.maxHitLen=g.maxHitLen,this},at:function(V,N){var P=N||new kc;return P.copy(this.direction).multiplyScalar(V).add(this.origin)},setMaxHitLength:function(i){this.maxHitLen=i},lookAt:function(m){return this.direction.copy(m).sub(this.origin).normalize(),this},applyMatrix4:function(Q){var X=this.maxHitLen;if(X){var R=this.direction.clone().multiplyScalar(X).add(this.origin);R.applyMatrix4(Q)}return this.origin.applyMatrix4(Q),this.direction.transformDirection(Q),X&&(this.maxHitLen=this.origin.distanceTo(R)),this},intersectSphere:function(){var E=new kc;return function(H,W){E.subVectors(H.center,this.origin);var y=E.dot(this.direction),c=E.dot(E)-y*y,Y=H.radius*H.radius;if(c>Y)return null;var h=Math.sqrt(Y-c),r=y-h,d=y+h;return 0>r&&0>d?null:0>r?this.at(d,W):this.at(r,W)}}(),intersectEllipsoid:function(){var n=new kc,z=new kc;return function(p,h){n.subVectors(p.center,this.origin),n.divide(p.radius),z.divideVectors(this.direction,p.radius);var j=z.lengthSq(),S=n.dot(z),W=n.dot(n)*j-S*S;if(W>j)return null;var Y=Math.sqrt(j-W),t=(S-Y)/j,i=(S+Y)/j;return 0>t&&0>i?null:0>t?this.at(i,h):this.at(t,h)}}(),intersectBox:function(w,v){var F,C,E,J,d,B,T=1/this.direction.x,b=1/this.direction.y,o=1/this.direction.z,h=this.origin;if(T>=0?(F=(w.min.x-h.x)*T,C=(w.max.x-h.x)*T):(F=(w.max.x-h.x)*T,C=(w.min.x-h.x)*T),b>=0?(E=(w.min.y-h.y)*b,J=(w.max.y-h.y)*b):(E=(w.max.y-h.y)*b,J=(w.min.y-h.y)*b),F>J||E>C)return null;if((E>F||F!==F)&&(F=E),(C>J||C!==C)&&(C=J),o>=0?(d=(w.min.z-h.z)*o,B=(w.max.z-h.z)*o):(d=(w.max.z-h.z)*o,B=(w.min.z-h.z)*o),F>B||d>C)return null;if((d>F||F!==F)&&(F=d),(C>B||C!==C)&&(C=B),0>C)return null;var f=F>=0?F:C,g=this.maxHitLen;return g&&f>g?null:this.at(f,v)},intersectTriangle:function(){var m=new kc,o=new kc,s=new kc,h=new kc;return function(f,X,x,g,S){o.subVectors(X,f),s.subVectors(x,f),h.crossVectors(o,s);var c,k=this.direction.dot(h);if(k>0){if(g)return null;c=1}else{if(!(0>k))return null;c=-1,k=-k}m.subVectors(this.origin,f);var L=c*this.direction.dot(s.crossVectors(m,s));if(0>L)return null;var $=c*this.direction.dot(o.cross(m));if(0>$||L+$>k)return null;var J=-c*m.dot(h);if(0>J)return null;var I=J/k,v=this.maxHitLen;return v&&I>v?null:this.at(I,S)}}()});var id=r.Math.Box3=function(K,C){this.min=K!==s?K:new kc(1/0,1/0,1/0),this.max=C!==s?C:new kc(-1/0,-1/0,-1/0)};j.assign(id.prototype,{set:function(u,e){return this.min.copy(u),this.max.copy(e),this},setFromArray:function(D){for(var A=1/0,z=1/0,K=1/0,b=-1/0,a=-1/0,O=-1/0,m=0,C=D.length;C>m;m+=3){var u=D[m],y=D[m+1],n=D[m+2];A>u&&(A=u),z>y&&(z=y),K>n&&(K=n),u>b&&(b=u),y>a&&(a=y),n>O&&(O=n)}return this.min.set(A,z,K),this.max.set(b,a,O),this},setFromPoints:function(T){this.makeEmpty();for(var e=0,Q=T.length;Q>e;e++)this.expandByPoint(T[e]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(y){return y.max.x<this.min.x||y.min.x>this.max.x||y.max.y<this.min.y||y.min.y>this.max.y||y.max.z<this.min.z||y.min.z>this.max.z?!1:!0},copy:function(q){return this.min.copy(q.min),this.max.copy(q.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(j){return this.min.min(j),this.max.max(j),this},expandByBox:function(p){return this.min.min(p.min),this.max.max(p.max),this},applyMatrix4:function(){var w=[new kc,new kc,new kc,new kc,new kc,new kc,new kc,new kc];return function(y){return this.isEmpty()?this:(w[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(y),w[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(y),w[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(y),w[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(y),w[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(y),w[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(y),w[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(y),w[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(y),this.setFromPoints(w),this)}}()});var zh=r.Math.Sphere=function(O,m){this.center=O!==s?O:new kc,this.radius=m!==s?m:0};j.assign(zh.prototype,{set:function(d,k){return this.center.copy(d),this.radius=k,this},setFromPoints:function(){var G=new id;return function(c,z){var B=this.center;z!==s?B.copy(z):G.setFromPoints(c).getCenter(B);for(var v=0,n=0,o=c.length;o>n;n++)v=Math.max(v,B.distanceToSquared(c[n]));return this.radius=Math.sqrt(v),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(C){return this.center.copy(C.center),this.radius=C.radius,this},empty:function(){return this.radius<=0},containsPoint:function(O){return O.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(W){return W.distanceTo(this.center)-this.radius},intersectsSphere:function(x){var _=this.radius+x.radius;return x.center.distanceToSquared(this.center)<=_*_},intersectsBox:function(P){return P.intersectsSphere(this)},intersectsPlane:function(g){return Math.abs(g.distanceToPoint(this.center))<=this.radius},clampPoint:function(i,c){var E=this.center.distanceToSquared(i);return c===s&&(c=new kc),c.copy(i),E>this.radius*this.radius&&(c.sub(this.center).normalize(),c.multiplyScalar(this.radius).add(this.center)),c},getBoundingBox:function(G){return G===s&&(G=new id),G.set(this.center,this.center),G.expandByScalar(this.radius),G},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(l){return this.center.add(l),this},equals:function(l){return l.center.equals(this.center)&&l.radius===this.radius}});var qs=r.Math.Frustum=function(X,L,I,$,m,u){this.planes=[X!==s?X:new Xb,L!==s?L:new Xb,I!==s?I:new Xb,$!==s?$:new Xb,m!==s?m:new Xb,u!==s?u:new Xb]};j.assign(qs.prototype,{set:function(g,b,y,N,Q,u){var G=this.planes;return G[0].copy(g),G[1].copy(b),G[2].copy(y),G[3].copy(N),G[4].copy(Q),G[5].copy(u),this},clone:function(){return(new this.constructor).copy(this)},copy:function(Q){for(var k=this.planes,r=0;6>r;r++)k[r].copy(Q.planes[r]);return this},setFromMatrix:function(i){var N=this.planes,X=i.el,w=X[0],o=X[1],W=X[2],h=X[3],y=X[4],q=X[5],e=X[6],K=X[7],c=X[8],L=X[9],S=X[10],T=X[11],p=X[12],s=X[13],Q=X[14],E=X[15];return N[0].setComponents(h-w,K-y,T-c,E-p).normalize(),N[1].setComponents(h+w,K+y,T+c,E+p).normalize(),N[2].setComponents(h+o,K+q,T+L,E+s).normalize(),N[3].setComponents(h-o,K-q,T-L,E-s).normalize(),N[4].setComponents(h-W,K-e,T-S,E-Q).normalize(),N[5].setComponents(h+W,K+e,T+S,E+Q).normalize(),this},intersectsObject:function(){var p=new zh;return function(n){var L=n.geometry;return null===L.boundingSphere&&L.computeBoundingSphere(),p.copy(L.boundingSphere).applyMatrix4(n.matrixWorld),this.intersectsSphere(p)}}(),intersectsSprite:function(){var S=new zh;return function(L){return S.center.set(0,0,0),S.radius=.7071067811865476,S.applyMatrix4(L.matrixWorld),this.intersectsSphere(S)}}(),intersectsSphere:function(E){for(var P=this.planes,D=E.center,p=-E.radius,c=0;6>c;c++){var u=P[c].distanceToPoint(D);if(p>u)return!1}return!0},intersectsBox:function(){var N=new kc;return function(f){for(var u=this.planes,W=0;6>W;W++){var R=u[W];if(N.x=R.normal.x>0?f.max.x:f.min.x,N.y=R.normal.y>0?f.max.y:f.min.y,N.z=R.normal.z>0?f.max.z:f.min.z,R.distanceToPoint(N)<0)return!1}return!0}}(),containsPoint:function(C){for(var y=this.planes,p=0;6>p;p++)if(y[p].distanceToPoint(C)<0)return!1;return!0}});var jq=r.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};j.assign(jq.prototype,{set:function(w,e,X,B,A,u,I,i,T,s,Z,Q,E,K,R,W){var M=this.el;return M[0]=w,M[4]=e,M[8]=X,M[12]=B,M[1]=A,M[5]=u,M[9]=I,M[13]=i,M[2]=T,M[6]=s,M[10]=Z,M[14]=Q,M[3]=E,M[7]=K,M[11]=R,M[15]=W,this},clone:function(){return(new jq).fromArray(this.el)},fromArray:function(j,J){J===s&&(J=0);for(var X=this.el,W=0;16>W;W++)X[W]=j[W+J];return this},scale:function(l){var V=this.el,R=l.x,C=l.y,c=l.z;return V[0]*=R,V[4]*=C,V[8]*=c,V[1]*=R,V[5]*=C,V[9]*=c,V[2]*=R,V[6]*=C,V[10]*=c,V[3]*=R,V[7]*=C,V[11]*=c,this},makeRotationFromEuler:function(c){var s=this.el,n=c._x,v=c._y,d=c._z,e=c._order,W=Math.cos(n),R=Math.sin(n),b=Math.cos(v),w=Math.sin(v),x=Math.cos(d),p=Math.sin(d);if("XYZ"===e){var T=W*x,y=W*p,L=R*x,Z=R*p;s[0]=b*x,s[4]=-b*p,s[8]=w,s[1]=y+L*w,s[5]=T-Z*w,s[9]=-R*b,s[2]=Z-T*w,s[6]=L+y*w,s[10]=W*b}else if("YXZ"===e){var k=b*x,J=b*p,u=w*x,X=w*p;s[0]=k+X*R,s[4]=u*R-J,s[8]=W*w,s[1]=W*p,s[5]=W*x,s[9]=-R,s[2]=J*R-u,s[6]=X+k*R,s[10]=W*b}else if("ZXY"===e){var k=b*x,J=b*p,u=w*x,X=w*p;s[0]=k-X*R,s[4]=-W*p,s[8]=u+J*R,s[1]=J+u*R,s[5]=W*x,s[9]=X-k*R,s[2]=-W*w,s[6]=R,s[10]=W*b}else if("ZYX"===e){var T=W*x,y=W*p,L=R*x,Z=R*p;s[0]=b*x,s[4]=L*w-y,s[8]=T*w+Z,s[1]=b*p,s[5]=Z*w+T,s[9]=y*w-L,s[2]=-w,s[6]=R*b,s[10]=W*b}else if("YZX"===e){var S=W*b,o=W*w,N=R*b,i=R*w;s[0]=b*x,s[4]=i-S*p,s[8]=N*p+o,s[1]=p,s[5]=W*x,s[9]=-R*x,s[2]=-w*x,s[6]=o*p+N,s[10]=S-i*p}else if("XZY"===e){var S=W*b,o=W*w,N=R*b,i=R*w;s[0]=b*x,s[4]=-p,s[8]=w*x,s[1]=S*p+i,s[5]=W*x,s[9]=o*p-N,s[2]=N*p-o,s[6]=R*x,s[10]=i*p+S}return s[3]=0,s[7]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,this},makeRotationFromQuaternion:function(y){var d=this.el,f=y._x,u=y._y,D=y._z,R=y._w,g=f+f,k=u+u,P=D+D,W=f*g,$=f*k,n=f*P,w=u*k,M=u*P,I=D*P,p=R*g,J=R*k,S=R*P;return d[0]=1-(w+I),d[4]=$-S,d[8]=n+J,d[1]=$+S,d[5]=1-(W+I),d[9]=M-p,d[2]=n-J,d[6]=M+p,d[10]=1-(W+w),d[3]=0,d[7]=0,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(X){var W=this.el,V=X.el,E=V[0],p=V[1],l=V[2],F=V[3],$=V[4],u=V[5],T=V[6],r=V[7],w=V[8],J=V[9],g=V[10],h=V[11],L=V[12],M=V[13],i=V[14],G=V[15],K=J*i*r-M*g*r+M*T*h-u*i*h-J*T*G+u*g*G,Z=L*g*r-w*i*r-L*T*h+$*i*h+w*T*G-$*g*G,j=w*M*r-L*J*r+L*u*h-$*M*h-w*u*G+$*J*G,H=L*J*T-w*M*T-L*u*g+$*M*g+w*u*i-$*J*i,x=E*K+p*Z+l*j+F*H;if(0===x)return this.identity();var y=1/x;return W[0]=K*y,W[1]=(M*g*F-J*i*F-M*l*h+p*i*h+J*l*G-p*g*G)*y,W[2]=(u*i*F-M*T*F+M*l*r-p*i*r-u*l*G+p*T*G)*y,W[3]=(J*T*F-u*g*F-J*l*r+p*g*r+u*l*h-p*T*h)*y,W[4]=Z*y,W[5]=(w*i*F-L*g*F+L*l*h-E*i*h-w*l*G+E*g*G)*y,W[6]=(L*T*F-$*i*F-L*l*r+E*i*r+$*l*G-E*T*G)*y,W[7]=($*g*F-w*T*F+w*l*r-E*g*r-$*l*h+E*T*h)*y,W[8]=j*y,W[9]=(L*J*F-w*M*F-L*p*h+E*M*h+w*p*G-E*J*G)*y,W[10]=($*M*F-L*u*F+L*p*r-E*M*r-$*p*G+E*u*G)*y,W[11]=(w*u*F-$*J*F-w*p*r+E*J*r+$*p*h-E*u*h)*y,W[12]=H*y,W[13]=(w*M*l-L*J*l+L*p*g-E*M*g-w*p*i+E*J*i)*y,W[14]=(L*u*l-$*M*l-L*p*T+E*M*T+$*p*i-E*u*i)*y,W[15]=($*J*l-w*u*l+w*p*T-E*J*T-$*p*g+E*u*g)*y,this},makeRotationAxis:function(j,C){var i=Math.cos(C),V=Math.sin(C),F=1-i,R=j.x,U=j.y,Y=j.z,v=F*R,h=F*U;return this.set(v*R+i,v*U-V*Y,v*Y+V*U,0,v*U+V*Y,h*U+i,h*Y-V*R,0,v*Y-V*U,h*Y+V*R,F*Y*Y+i,0,0,0,0,1),this},multiply:function(I){return this.multiplyMatrices(this,I)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(Z,A){var R=Z.el,j=A.el,J=this.el,z=R[0],o=R[4],_=R[8],u=R[12],g=R[1],L=R[5],V=R[9],G=R[13],Y=R[2],I=R[6],n=R[10],i=R[14],U=R[3],d=R[7],m=R[11],k=R[15],x=j[0],P=j[4],W=j[8],p=j[12],K=j[1],Q=j[5],t=j[9],S=j[13],B=j[2],F=j[6],D=j[10],N=j[14],C=j[3],T=j[7],l=j[11],w=j[15];return J[0]=z*x+o*K+_*B+u*C,J[4]=z*P+o*Q+_*F+u*T,J[8]=z*W+o*t+_*D+u*l,J[12]=z*p+o*S+_*N+u*w,J[1]=g*x+L*K+V*B+G*C,J[5]=g*P+L*Q+V*F+G*T,J[9]=g*W+L*t+V*D+G*l,J[13]=g*p+L*S+V*N+G*w,J[2]=Y*x+I*K+n*B+i*C,J[6]=Y*P+I*Q+n*F+i*T,J[10]=Y*W+I*t+n*D+i*l,J[14]=Y*p+I*S+n*N+i*w,J[3]=U*x+d*K+m*B+k*C,J[7]=U*P+d*Q+m*F+k*T,J[11]=U*W+d*t+m*D+k*l,J[15]=U*p+d*S+m*N+k*w,this},lookAt:function(){var J=new kc,E=new kc,r=new kc;return function(A,c,v){var F=this.el;return r.subVectors(A,c),0===r.lengthSq()&&(r.z=1),r.normalize(),J.crossVectors(v,r),0===J.lengthSq()&&(1===Math.abs(v.z)?r.x+=1e-4:r.z+=1e-4,r.normalize(),J.crossVectors(v,r)),J.normalize(),E.crossVectors(r,J),F[0]=J.x,F[4]=E.x,F[8]=r.x,F[1]=J.y,F[5]=E.y,F[9]=r.y,F[2]=J.z,F[6]=E.z,F[10]=r.z,this}}(),extractScale:function(){var D;return function(G){D===s&&(D=new kc),G===s&&(G=new kc);var J=D.setFromMatrixColumn(this,0).length(),b=D.setFromMatrixColumn(this,1).length(),h=D.setFromMatrixColumn(this,2).length();return G.set(J,b,h),G}}(),extractRotation:function(){var f;return function(X){f===s&&(f=new kc),X===s&&(X=new jq);var O=this.el,l=X.el,$=1/f.setFromMatrixColumn(X,0).length(),z=1/f.setFromMatrixColumn(X,1).length(),d=1/f.setFromMatrixColumn(X,2).length();return O[0]=l[0]*$,O[1]=l[1]*$,O[2]=l[2]*$,O[4]=l[4]*z,O[5]=l[5]*z,O[6]=l[6]*z,O[8]=l[8]*d,O[9]=l[9]*d,O[10]=l[10]*d,this}}(),multiplyScalar:function(H){var C=this.el;return C[0]*=H,C[4]*=H,C[8]*=H,C[12]*=H,C[1]*=H,C[5]*=H,C[9]*=H,C[13]*=H,C[2]*=H,C[6]*=H,C[10]*=H,C[14]*=H,C[3]*=H,C[7]*=H,C[11]*=H,C[15]*=H,this},getPosition:function(e){return e===s&&(e=new kc),e.setFromMatrixColumn(this,3)},setPosition:function(m){var Y=this.el;return Y[12]=m.x,Y[13]=m.y,Y[14]=m.z,this},toArray:function(L,F){L===s&&(L=[]),F===s&&(F=0);var r=this.el;return L[F]=r[0],L[F+1]=r[1],L[F+2]=r[2],L[F+3]=r[3],L[F+4]=r[4],L[F+5]=r[5],L[F+6]=r[6],L[F+7]=r[7],L[F+8]=r[8],L[F+9]=r[9],L[F+10]=r[10],L[F+11]=r[11],L[F+12]=r[12],L[F+13]=r[13],L[F+14]=r[14],L[F+15]=r[15],L},determinant:function(){var W=this.el,e=W[0],z=W[4],S=W[8],A=W[12],V=W[1],j=W[5],D=W[9],G=W[13],H=W[2],$=W[6],t=W[10],c=W[14],T=W[3],f=W[7],n=W[11],Z=W[15];return T*(+A*D*$-S*G*$-A*j*t+z*G*t+S*j*c-z*D*c)+f*(+e*D*c-e*G*t+A*V*t-S*V*c+S*G*H-A*D*H)+n*(+e*G*$-e*j*c-A*V*$+z*V*c+A*j*H-z*G*H)+Z*(-S*j*H-e*D*$+e*j*t+S*V*$-z*V*t+z*D*H)},copy:function(r){var u=this.el,K=r.el;return u[0]=K[0],u[1]=K[1],u[2]=K[2],u[3]=K[3],u[4]=K[4],u[5]=K[5],u[6]=K[6],u[7]=K[7],u[8]=K[8],u[9]=K[9],u[10]=K[10],u[11]=K[11],u[12]=K[12],u[13]=K[13],u[14]=K[14],u[15]=K[15],this},compose:function(K,B,y){var b=this.el,s=B._x,o=B._y,l=B._z,Q=B._w,Z=s+s,V=o+o,X=l+l,k=s*Z,R=s*V,U=s*X,E=o*V,M=o*X,v=l*X,t=Q*Z,J=Q*V,C=Q*X,F=y.x,D=y.y,Y=y.z;return b[0]=(1-(E+v))*F,b[1]=(R+C)*F,b[2]=(U-J)*F,b[3]=0,b[4]=(R-C)*D,b[5]=(1-(k+v))*D,b[6]=(M+t)*D,b[7]=0,b[8]=(U+J)*Y,b[9]=(M-t)*Y,b[10]=(1-(k+E))*Y,b[11]=0,b[12]=K.x,b[13]=K.y,b[14]=K.z,b[15]=1,this},decompose:function(){var H=new kc,$=new jq;return function(V,L,N){var f=this.el,g=H.set(f[0],f[1],f[2]).length(),G=H.set(f[4],f[5],f[6]).length(),U=H.set(f[8],f[9],f[10]).length(),D=this.determinant();0>D&&(g=-g),V.x=f[12],V.y=f[13],V.z=f[14],$.copy(this);var o=1/g,h=1/G,B=1/U;return $.el[0]*=o,$.el[1]*=o,$.el[2]*=o,$.el[4]*=h,$.el[5]*=h,$.el[6]*=h,$.el[8]*=B,$.el[9]*=B,$.el[10]*=B,L.setFromRotationMatrix($),N.x=g,N.y=G,N.z=U,this}}()});var Ud=r.Math.Triangle=function(g,Z,t){this.a=g!==s?g:new kc,this.b=Z!==s?Z:new kc,this.c=t!==s?t:new kc};j.assign(Ud,{barycoordFromPoint:function(){var x=new kc,A=new kc,L=new kc;return function(F,w,K,O,n){x.subVectors(O,w),A.subVectors(K,w),L.subVectors(F,w);var D=x.dot(x),Z=x.dot(A),$=x.dot(L),V=A.dot(A),m=A.dot(L),y=D*V-Z*Z,I=n||new kc;if(0===y)return I.set(-2,-1,-1);var o=1/y,z=(V*$-Z*m)*o,e=(D*m-Z*$)*o;return I.set(1-z-e,e,z)}}()});var Ug=r.Math.Euler=function(f,x,g,F,c){this.set(f,x,g,F,c)};Ug.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Ug.DefaultOrder="XYZ",Ug.ReverseOrder=function(v){return v=v[2]+v[1]+v[0],v.toUpperCase()},j.defineProperties(Ug.prototype,{x:{get:function(){return this._x},set:function(P){this._x=P,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(S){this._y=S,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(M){this._z=M,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(M){this._order=M,this.onChangeCallback()}}}),j.assign(Ug.prototype,{set:function(Y,t,b,J,I){return Qb(Y)&&(I=b,J=t,b=Y[2],t=Y[1],Y=Y[0]),J?I&&(J=Ug.ReverseOrder(J)):J="ZYX",this._x=Y||0,this._y=t||0,this._z=b||0,this._order=J||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(m){return this._x=m._x,this._y=m._y,this._z=m._z,this._order=m._order,this.onChangeCallback(),this},setFromRotationMatrix:function(l,_,$){var x=r.Math.clamp,a=l.el||l,q=a[0],V=a[4],k=a[8],K=a[1],G=a[5],X=a[9],L=a[2],N=a[6],Q=a[10];return _=_||this._order,"XYZ"===_?(this._y=Math.asin(x(k,-1,1)),Math.abs(k)<.99999?(this._x=Math.atan2(-X,Q),this._z=Math.atan2(-V,q)):(this._x=Math.atan2(N,G),this._z=0)):"YXZ"===_?(this._x=Math.asin(-x(X,-1,1)),Math.abs(X)<.99999?(this._y=Math.atan2(k,Q),this._z=Math.atan2(K,G)):(this._y=Math.atan2(-L,q),this._z=0)):"ZXY"===_?(this._x=Math.asin(x(N,-1,1)),Math.abs(N)<.99999?(this._y=Math.atan2(-L,Q),this._z=Math.atan2(-V,G)):(this._y=0,this._z=Math.atan2(K,q))):"ZYX"===_?(this._y=Math.asin(-x(L,-1,1)),Math.abs(L)<.99999?(this._x=Math.atan2(N,Q),this._z=Math.atan2(K,q)):(this._x=0,this._z=Math.atan2(-V,G))):"YZX"===_?(this._z=Math.asin(x(K,-1,1)),Math.abs(K)<.99999?(this._x=Math.atan2(-X,G),this._y=Math.atan2(-L,q)):(this._x=0,this._y=Math.atan2(k,Q))):"XZY"===_?(this._z=Math.asin(-x(V,-1,1)),Math.abs(V)<.99999?(this._x=Math.atan2(N,G),this._y=Math.atan2(k,q)):(this._x=Math.atan2(-X,Q),this._y=0)):console.warn("unsupported order: "+_),this._order=_,$!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var s=new jq;return function(h,C,E){return s.makeRotationFromQuaternion(h),this.setFromRotationMatrix(s,C,E)}}(),setFromVector3:function($,J){return this.set($.x,$.y,$.z,J||this._order)},reorder:function(){var l=new ke;return function(Y){return l.setFromEuler(this),this.setFromQuaternion(l,Y)}}(),equals:function(C){return C._x===this._x&&C._y===this._y&&C._z===this._z&&C._order===this._order},fromArray:function(_){return this._x=_[0],this._y=_[1],this._z=_[2],_[3]!==s&&(this._order=_[3]),this.onChangeCallback(),this},toArray:function(M,N){return M===s&&(M=[]),N===s&&(N=0),M[N]=this._x,M[N+1]=this._y,M[N+2]=this._z,M[N+3]=this._order,M},toVector3:function(Z){return Z?Z.set(this._x,this._y,this._z):new kc(this._x,this._y,this._z)},onChange:function(Y){return this.onChangeCallback=Y,this},onChangeCallback:function(){}});var Re={ms_ac:function(z,p){for(var k=p.ms_ac,m=0;m<k.length;m++)rf(z,k[m])},ms_listener:function(I){I.addListeners=function(){for(var U=this,S=0;S<Ip.length;S++){var Q=Ip[S];"wheel"===Q&&!U.handle_wheel&&U.handle_mousewheel&&(U.handle_wheel=function(W){oc(U,W)}),U["handle_"+Q]&&He(Q,U.getView(),U)}},I.removeListeners=function(){for(var i=this,b=0;b<Ip.length;b++)i["handle_"+Ip[b]]&&tf(Ip[b],i.getView(),i)}},ms_fire:function(M){M.mp=function(e,M,V){this.addPropertyChangeListener(e,M,V)},M.ump=function(z,Y){this.removePropertyChangeListener(z,Y)},M.fp=function(l,p,v,i,C){return this.firePropertyChange(l,p,v,i,C)},M.addPropertyChangeListener=function(g,n,c){var v=this;v._62I||(v._62I=new gs),v._62I.add(g,n,c)},M.removePropertyChangeListener=function(g,P){this._62I&&this._62I.remove(g,P)},M.firePropertyChange=function(C,R,k,N,Y){if(N){if(N(R,k))return!1}else if(R===k)return!1;var D=this,t=Y||{};return t.property=C,t.oldValue=R,t.newValue=k,t.source=D,t.data=D,D._62I&&D._62I.fire(t),D.onPropertyChanged&&D.onPropertyChanged(t),!0}},ms_attr:function(n){n.a=function(j,B){var a=this;if(2===arguments.length)a.setAttr(j,B);else{if(!zo(j))return a.getAttr(j);for(var v in j)a.setAttr(v,j[v])}return a},n.getAttr=function(c,p){if(p===s&&(p=1),this._attrObject&&c in this._attrObject)return this._attrObject[c];if(this.getImage){var q=this.getImage();if(un(q)&&(q=Ff[q]),zo(q)&&"dataBindings"in q)for(var Z=q.dataBindings,D=Z.length-1;D>=0;D--){var $=Z[D];if($.attr===c){if("defaultValue"in $)return $.defaultValue;break}}}return p?A[c]:s},n.setAttr=function(T,S){var O=this;O._attrObject||(O._attrObject={});var D=O._attrObject[T];S===s?delete O._attrObject[T]:O._attrObject[T]=S,O.fp&&O.fp("a:"+T,D,S)&&O.onAttrChanged&&O.onAttrChanged(T,D,S)},n.getSerializableAttrs=function(){var W,N={};for(W in this._attrObject)N[W]=1;return N}},ms_bnb:function(Q){Q.getBodyColor=function(C){return C.s("body.color")},Q.getBorderColor=function(x){return x.s("border.color")}},_51o:function(i){i.mi=function(P,S,A){this.addInteractorListener(P,S,A)},i.umi=function(p,h){this.removeInteractorListener(p,h)},i.fi=function(m){this.fireInteractorEvent(m)},i.addInteractorListener=function(u,i,R){var h=this;h._63I||(h._63I=new gs),h._63I.add(u,i,R)},i.removeInteractorListener=function(j,D){this._63I&&this._63I.remove(j,D)},i.fireInteractorEvent=function(W){this._63I&&this._63I.fire(W)},i.setInteractors=function(x){var c=this,h=c._interactors;h&&h.each(function(w){w.tearDown()}),Qb(x)&&(x=new Yi(x)),c._interactors=x,x&&x.each(function(I){I.setUp()}),c.fp("interactors",h,x),c.invalidateSelection()},i.getInteractors=function(){return this._interactors}},_49o:function(B){B._44O=i,B._45O=i,B.getTopPainters=function(){return this._44O},B.getBottomPainters=function(){return this._45O},B.addTopPainter=function($){var O=this;O._44O||(O._44O=new Yi),O._44O.contains($)||(O._44O.add($),O.redraw&&O.redraw())},B.removeTopPainter=function(I){var U=this;U._44O&&(U._44O.remove(I),U.redraw&&U.redraw())},B.addBottomPainter=function(u){var c=this;c._45O||(c._45O=new Yi),c._45O.contains(u)||(c._45O.add(u),c.redraw&&c.redraw())},B.removeBottomPainter=function(D){var P=this;P._45O&&(P._45O.remove(D),P.redraw&&P.redraw())},B._93db=function(x,o){var P=this;P._45O&&P._45O.each(function(V){V.draw?V.draw(x,o):V.call(P,x,o)})},B._92db=function(d,N){var l=this;l._44O&&l._44O.each(function(j){j.draw?j.draw(d,N):j.call(l,d,N)})}},ms_sm:function(b){b.sm=function(){return this.getSelectionModel()},b.setSelectableFunc=function(R){this.sm().setFilterFunc(R)},b.getSelectableFunc=function(){return this.sm().getFilterFunc()},b.getSelectionModel=function(){var q=this;return q._selectionModel?q._selectionModel:q.dm().sm()},b.isSelectionModelShared=function(){return!this._selectionModel},b.setSelectionModelShared=function(L){var X=this,r=!X._selectionModel,Q=X.handleSelectionChange,o=X.dm();r!==L&&(X.invalidateSelection&&X.invalidateSelection(),L?(o.sm().ms(Q,X),X._selectionModel.ums(Q,X),X._selectionModel.dispose(),X._selectionModel=i):(o.sm().ums(Q,X),X._selectionModel=new um(o),X._selectionModel.ms(Q,X)),X.onSelectionModelSharedChanged(),X.fp("selectionModelShared",r,L))
},b.onSelectionModelSharedChanged=function(){var o=this;o.redraw(),o.invalidateSelection&&o.invalidateSelection()},b.removeSelection=function(){var D=this.dm();D.beginTransaction(),this.sm().toSelection().each(D.remove,D),D.endTransaction()},b.selectAll=function(){var p=this;p.sm().ss(p.dm().toDatas(function(r){return p.isVisible(r)&&p.isSelectable(r)}))},b.isSelected=function(D){return this.sm().co(D)},b.isSelectedById=function(o){var t=this.dm().getDataById(o);return t?this.isSelected(t):!1},b.isSelectable=function(x){return this.sm().isSelectable(x)}},ms_tx:function(H){H._64I=0,H._65O=0,H.isScrollable=function(){return this.getWidth()<this._64I},H._40o=function(){return this.isScrollable()},H.getLogicalPoint=function(L){return Eg(L,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},H.tx=function(p){return p===s?this.getTranslateX():(this.setTranslateX(p),void 0)},H.getTranslateX=function(){return this._65O},H.setTranslateX=function(L){var j=this,S=j.getWidth()-j._64I;S>L&&(L=S),L>0&&(L=0),L=G(L);var V=j._65O;j._65O=L,j.fp(Bl,V,L)}},ms_ty:function(R){R._23Q=0,R._66O=0,R._41o=function(){return this.getHeight()<this._23Q},R.getLogicalPoint=function(N){return Eg(N,this._canvas||this._view,this.tx?this.tx():0,this.ty())},R.ty=function(n){return n===s?this.getTranslateY():(this.setTranslateY(n),void 0)},R.getTranslateY=function(){return this._66O},R.setTranslateY=function(y){var B=this,i=B.getHeight()-B._23Q;i>y&&(y=i),y>0&&(y=0),y=G(y);var n=B._66O;B._66O=y,B.fp(Fq,n,y)}},ms_txy:function(b){b._65O=0,b._66O=0,b.tx=function(E){return E===s?this.getTranslateX():(this.setTranslateX(E),void 0)},b.ty=function(l){return l===s?this.getTranslateY():(this.setTranslateY(l),void 0)},b.onTranslateEnded=function(){},b.setTranslate=function(S,E,F){var e=this;if(F=Lb(F)){e._65I&&e._65I.stop(!0);var R=e.tx(),o=e.ty();F.action=function(K){e.setTranslate(R+(S-R)*K,o+(E-o)*K)},F._37o=function(){delete e._66I,delete e._65I,e.onTranslateEnded()},e._66I=1,e._65I=Tk(F)}else e.tx(S),e.ty(E)},b.getTranslateX=function(){return this._65O},b.setTranslateX=function(V){var Y=this;V=Y.adjustTranslateX(V);var h=Y._65O;Y._65O=V,Y.fp(Bl,h,V)},b.getTranslateY=function(){return this._66O},b.setTranslateY=function(m){var q=this;m=q.adjustTranslateY(m);var k=q._66O;q._66O=m,q.fp(Fq,k,m)},b.adjustTranslateX=function(_){return G(_)},b.adjustTranslateY=function(i){return G(i)},b.translate=function(F,l,W){this.setTranslate(this.tx()+F,this.ty()+l,W)},b.getLogicalPoint=function($){var F=this;return Eg($,this._canvas||F._view,F.tx(),F.ty())}},ms_dm:function(r){r.dm=function(T){return T?(this.setDataModel(T),void 0):this.getDataModel()},r.getDataModel=function(){return this._dataModel}},ms_lp:function(d){d.lp=function(q){return this.getLogicalPoint(q)}},ms_v:function(f){f._disabled=!1,f.setDisabled=function(H,s){var w=this,D=w._disabled;D!==H&&(D&&(As(w._63O),delete w._63O),H&&(pi(w._view,w._63O=Zn(s)),w.iv()),w._disabled=H,w.fp("disabled",D,H))},f.isDisabled=function(){return this._disabled},f.getDisabledDiv=function(){return this._63O},f.getView=function(){return this._view},f.addToDOM=function(S){var D=this,h=D.getView(),W=h.style;S=S||B.body,S.appendChild(h),W.left="0",W.right="0",W.top="0",W.bottom="0",Z(F,"resize",function(){D.iv()}),D.iv()},f.getWidth=function(){return this._view.clientWidth},f.getHeight=function(){return this._view.clientHeight},f.setWidth=function(I){var X=this;X._view.style.width=I+De,X.iv(),X.fp&&X.fp(as,i,I)},f.setHeight=function(x){var o=this;o._view.style.height=x+De,o.iv(),o.fp&&o.fp(wr,i,x)},f.setFocus=function(y){var K=this,A=K._currentEditor;return y&&A&&(A.getView&&(A=A.getView()),A.contains(y.target))?!1:(Pf(K._view),K.endEditing&&K.endEditing(),K.fireViewEvent("focus"),!0)},f.iv=function(M){this.invalidate(M)},f.invalidate=function(t){var k=this;k._68I||(k._68I=1,ur(k.validate,k,i,t),k.onInvalidated&&k.onInvalidated(),k.fireViewEvent("invalidate"))},f.validate=function(){var C=this,e=C._view;if(C._68I&&(delete C._68I,e.parentNode))if(0===e.offsetWidth&&0===e.offsetHeight&&C._67I!==i)C._67I===s&&(C._67I=z.reinvalidateCount),C._67I>0?C._67I--:C._67I=i,C.iv();else{C.fireViewEvent("beginValidate"),C.validateImpl(),C.onValidated&&C.onValidated(),C.fireViewEvent("validate");var U=C._63O;U&&(e.lastChild!==U&&(As(U),pi(e,U)),Kn(U,0,0,C.getWidth(),C.getHeight())),tb(C),hj(C),Vi(C)}},f.layout=function(m,$,g,r){1===arguments.length?Kn(this,m):Kn(this,m,$,g,r)},f.addViewListener=function(M,o,j){var O=this;O._67O||(O._67O=new gs),O._67O.add(M,o,j)},f.removeViewListener=function(l,z){this._67O.remove(l,z)},f.fireViewEvent=function(b){var M=this;M._67O&&(un(b)&&(b={kind:b}),M._67O.fire(b)),z.viewListener&&z.viewListener(M,b)}},ms_tip:function(g){g.setToolTipEnabled=function(b){var T=this;b?Aj||T._13o||(T.enableToolTip(),T.fp("toolTipEnabled",!1,!0)):T._13o&&(T.disableToolTip(),T.fp("toolTipEnabled",!0,!1))},g.isToolTipEnabled=function(){return!!this._13o},g.enableToolTip=function(){var l=this;if(!Aj&&!l._13o){l._13o=function(W){var P=l.getToolTip(W);P!=i?z.toolTipContinual&&z.isToolTipShowing()?rq(W,P):(Ui(),lq={timeout:e(dl,Nr),e:W,info:P}):Ui()};var Y=l.getView();Z(Y,_h,l._13o),Z(Y,"mouseleave",z.hideToolTip)}},g.disableToolTip=function(){var X=this;if(X._13o){var Y=X.getView();m(Y,_h,X._13o),m(Y,"mouseleave",z.hideToolTip),delete X._13o}},g.getToolTip=function(s){var G=this;if(G.getDataAt){var d=G.getDataAt(s);return d?d.getToolTip():i}return G.getValue?G.getValue():void 0}},_52o:function(u){u._zoom=1,u._29I=qm,u.zoomIn=function(G,i){this.setZoom(this._zoom*Xg,G,i)},u.zoomOut=function(v,D){this.setZoom(this._zoom/Xg,v,D)},u.zoomReset=function(j,g){this.setZoom(1,j,g)},u.scrollZoomIn=function(x){this.setZoom(this._zoom*hg,i,x)},u.scrollZoomOut=function(m){this.setZoom(this._zoom/hg,i,m)},u.pinchZoomIn=function(K){this.setZoom(this._zoom*fi,i,K)},u.pinchZoomOut=function(V){this.setZoom(this._zoom/fi,i,V)},u.adjustZoom=function(q){return Fr>q?Fr:q>ro?ro:q},u.getZoom=function(){return this._zoom},u.setZoom=function(s,J,y){var B=this;if(J=Lb(J)){B._14o&&B._14o.stop(!0);var T=B._zoom;J.action=function(K){B._96O(T+(s-T)*K,y)},J._37o=function(){delete B._zooming,delete B._14o,B.onZoomEnded()},B._zooming=1,B._14o=Tk(J)}else B._96O(s,y)},u._96O=function(U,P){var b=this;if(U=b.adjustZoom(U),U!==b._zoom){b.validate();var r=b._29I,I=b._zoom;0!==r.width&&0!==r.height&&(P=P?P:{x:r.x+r.width/2,y:r.y+r.height/2},b.tx((P.x-r.x)*I-P.x*U),b.ty((P.y-r.y)*I-P.y*U)),b._zoom=U,b.fp("zoom",I,U)}}},ms_edge:function(f){f._2I=function(s){var G=this;G._44I||(G._44I=new Yi),G._42I||(G._42I=new Yi),G._44I.add(s),G._42I.add(s),G._20I()},f._4I=function(m){var U=this;U._44I||(U._44I=new Yi),U._43I||(U._43I=new Yi),U._44I.add(m),U._43I.add(m),U._20I()},f._16I=function(O){var B=this;B._44I.remove(O),B._42I.remove(O),B._44I.isEmpty()&&delete B._44I,B._42I.isEmpty()&&delete B._42I,B._20I()},f._18I=function(B){var v=this;v._44I.remove(B),v._43I.remove(B),v._44I.isEmpty()&&delete v._44I,v._43I.isEmpty()&&delete v._43I,v._20I()},f._20I=function(){var Q=this;if(delete Q._45I,!Q._44I||Q._44I.isEmpty())return delete Q._70O,void 0;var O;Q._44I.each(function(c){c.isLooped()&&(O||(O={}),O[c._id]||(Q._45I||(Q._45I=new Yi),Q._45I.add(c),O[c._id]=c))}),O?(Q._70O=new Yi,Q._44I.each(function(i){O[i._id]?"A"===O[i._id]||(O[i._id]="A",Q._70O.add(i)):Q._70O.add(i)})):Q._70O=Q._44I},f.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},f.getSourceAgentEdges=function(){return this._46I},f.getTargetAgentEdges=function(){return this._47I},f._1I=function(b){var x=this;x._46I||(x._46I=new Yi),x._48I||(x._48I=new Yi),x._46I.add(b),x._48I.add(b),x._19I()},f._3I=function(P){var q=this;q._47I||(q._47I=new Yi),q._48I||(q._48I=new Yi),q._47I.add(P),q._48I.add(P),q._19I()},f._15I=function(h){var X=this;X._46I.remove(h),X._48I.remove(h),X._46I.isEmpty()&&delete X._46I,X._48I.isEmpty()&&delete X._48I,X._19I()},f._17I=function(y){var A=this;A._47I.remove(y),A._48I.remove(y),A._47I.isEmpty()&&delete A._47I,A._48I.isEmpty()&&delete A._48I,A._19I()},f._19I=function(){var r=this;delete r._49I;var R=r._48I;if(R&&!R.isEmpty()){var f={};R.each(function(p){f[p._id]?r._49I||(r._49I=new Yi):f[p._id]=p}),r._49I?R.each(function(X){f[X._id]&&(r._49I.add(X),delete f[X._id])}):r._49I=R}},f.getLoopedEdges=function(){return this._45I},f.getEdges=function(){return this._70O},f.getAgentEdges=function(){return this._49I},f.getSourceEdges=function(){return this._42I},f.getTargetEdges=function(){return this._43I},f._8I=function(){this._70O&&this._70O.each(function(Z){Z._7I()})}}};Ej(z,{numberDigits:5,crossOrigin:"",baseZIndex:s,isTouchable:Aj,devicePixelRatio:F.devicePixelRatio?F.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:f.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return ij},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],encodeStringKey:null,doubleClickRange:Aj?20:1,animDuration:200,animEasing:function(f){return f*f},labelColor:Xl,labelSelectColor:wo,labelFont:(Aj?"15":"12")+"px arial, sans-serif",widgetIndent:Aj?30:20,widgetRowHeight:Aj?30:20,widgetHeaderHeight:Aj?32:22,widgetTitleHeight:Aj?34:24,scrollBarColor:kh,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Aj?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:$q,intersectionLineLine:go,isEnter:Hf,isEsc:Wi,isDelete:ei,isSpace:Sd,isLeft:_r,isUp:Ub,isRight:im,isDown:mh,getTarget:fs,isString:un,isNumber:Dn,isBoolean:Zo,isArray:Qb,isSelectAll:Pc,isFunction:Nf,isObject:zo,getPropertyValue:qr,setPropertyValue:jf,addMethod:Ej,getVersion:function(){return"7.0.7"},isMobile:function(){var D;return function(){return D!==s?D:(D=!1,function(f){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(f)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(f.substr(0,4)))&&(D=!0)}(navigator.userAgent||navigator.vendor||F.opera),D)}}(),createGradient:function(R,o,p,S,G,g,$,w){var m=fl[o];return m(R,p,S,G,g,$,w)},appendToScreen:function(i){i=i.getView?i.getView():i,(B.fullscreenElement||B.mozFullScreenElement||B.webkitFullscreenElement||B.msFullscreenElement||B.body).appendChild(i)},encodeString:function(N){return r.Math.encodeBase64(N,z.encodeStringKey)},decodeString:function(I){return r.Math.decodeBase64(I,z.encodeStringKey)},findView:function(T){var Z=function(l,q){var R=q._ht;R&&l.push(R);var T=q.children,r=T.length;if(r)for(var Q=0;r>Q;Q++)Z(l,T[Q])},u=[];Z(u,B.body);var b=function(r,E){for(var s="2d"===E?gk.GraphView:Ri.Graph3dView,G=0,d=r.length;d>G;G++)if(r[G]instanceof s)return u[G];return null};return"all"===T?u:"2d"===T?b(u,"2d"):"3d"===T?b(u,"3d"):b(u,"3d")||b(u,"2d")},toggleFullscreen:function(W){var I=W.getView();if(B.fullscreenElement||B.mozFullScreenElement||B.webkitFullscreenElement||B.msFullscreenElement)B.exitFullscreen?B.exitFullscreen():B.msExitFullscreen?B.msExitFullscreen():B.mozCancelFullScreen?B.mozCancelFullScreen():B.webkitExitFullscreen&&B.webkitExitFullscreen();else{var d=!0;if(W.isSelfViewEvent){var p=W.getX(),T=W.getY(),e=W.getWidth(),y=W.getHeight(),E=I.style.background,P=I.style.backgroundColor;E||P||(I.style.backgroundColor="white"),I.requestFullscreen?I.requestFullscreen():I.msRequestFullscreen?I.msRequestFullscreen():I.mozRequestFullScreen?I.mozRequestFullScreen():I.webkitRequestFullscreen&&I.webkitRequestFullscreen();var _=setInterval(function(){if(I!==(B.fullscreenElement||B.mozFullScreenElement||B.webkitFullscreenElement||B.msFullscreenElement))clearInterval(_),W.setX(p),W.setY(T),W.setWidth(e),W.setHeight(y),W._fullscreen=!1,I.style.oldBackgroundColor=P,W.iv();else{var h=r.Default.getWindowInfo();(d||h.width!==W.getWidth()||h.height!==W.getHeight())&&(W.setX(h.left),W.setY(h.top),W.setWidth(h.width),W.setHeight(h.height),W._fullscreen=!0,W.iv(),d=!1)}},500)}else{var J=I.style.left,i=I.style.top,e=I.style.width,y=I.style.height,E=I.style.background,P=I.style.backgroundColor;E||P||(I.style.backgroundColor="white"),I.requestFullscreen?I.requestFullscreen():I.msRequestFullscreen?I.msRequestFullscreen():I.mozRequestFullScreen?I.mozRequestFullScreen():I.webkitRequestFullscreen&&I.webkitRequestFullscreen();var _=setInterval(function(){if(I!==(B.fullscreenElement||B.mozFullScreenElement||B.webkitFullscreenElement||B.msFullscreenElement))clearInterval(_),I.style.left=J,I.style.top=i,I.style.width=e,I.style.height=y,I.style.oldBackgroundColor=P,W.iv();else{var L=r.Default.getWindowInfo();(d||L.width!==W.getWidth()||L.height!==W.getHeight())&&(Kn(W),d=!1)}},500)}}},appendTimeStamp:function(F){return F},setCompType:function(S,C){Nf(C)||zo(C)?Ah[S]=C:Ep(S)},getCompType:function(g){var $=Ah[g];return $===s&&cp.test(g)&&Ep(g),$},getCompTypeMap:function(){return Ah},drawCompType:function(L,M,D,U,g,x){L(M,D,U,g,x)},numberListener:function(){var Y={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(X){var s=X.keyCode;Y[s]||65===s&&z.isCtrlDown(X)||86===s&&z.isCtrlDown(X)||67===s&&z.isCtrlDown(X)||88===s&&z.isCtrlDown(X)||s>=35&&40>=s||(X.shiftKey||48>s||s>57)&&(96>s||s>105)&&X.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(b){var M=b.target.tagName;("DIV"===M||"CANVAS"===M)&&!(z.ignoreKeyCodes.indexOf(b.keyCode)>=0)&&("keydown"!==b.type||_r(b)||im(b)||Ub(b)||mh(b)||ei(b)||65===b.keyCode&&(b.metaKey||b.ctrlKey))&&(b.preventDefault(),b.preventManipulation&&b.preventManipulation())},getWindowInfo:function(){var K=B.documentElement,r=K&&(K.scrollLeft||K.scrollTop)?K:B.body;return{target:r,left:r.scrollLeft,top:r.scrollTop,width:F.innerWidth||r.clientWidth,height:F.innerHeight||r.clientHeight}},isDragging:function(){return!!ij},isLeftButton:function(y){return Aj?!0:0===y.button},isMiddleButton:function(t){return Aj?!1:t&&(1===t.button||4&(t.buttons||0))},isRightButton:function(U){return Aj?!1:U&&(2===U.button||2&(U.buttons||0))},isInput:function(h){if(!h)return!1;var T=h.tagName;return"INPUT"===T||"TEXTAREA"===T||"SELECT"===T},getTouchCount:function(H){return Aj?H.touches.length:1},isDoubleClick:function(){function H(A){A.details=0,A.timeout=null,A.lastPoint=null}var f={};return Db=new P,vm=Db.getTime(),function(h){if(h.touches&&h.touches.length>1)return!1;var q=h.button==i?"":h.button,T=h.type+q,A=T+"_isDoubleClick",O=f[T];if(O||(O=f[T]={details:0,timeout:null,lastPoint:null}),h[A]===s){h[A]=!0;var w=Mi(h);O.timeout&&(Y(O.timeout),O.timeout=null),O.lastPoint&&_m(O.lastPoint,w)>z.doubleClickRange&&H(O),O.lastPoint=w,O.details++,O.timeout=e(function(){H(this)}.bind(O),500)}return 2===O.details}}(),isShiftDown:function(w){return w?w.shiftKey:kp["16"]},isCtrlDown:function(m){return m?qi?m.metaKey:m.ctrlKey:qi?kp["91"]:kp["17"]},getClientPoint:function(e){return Aj&&(e=Bk(e)),{x:e.clientX,y:e.clientY}},isMouseEvent:function(a){return a instanceof MouseEvent||0===a.type.indexOf("mouse")},getTargetElement:function(c){if(z.isMouseEvent(c)||!B.elementFromPoint)return c.target;var A=hp(c);return B.elementFromPoint(A.x,A.y)},getPagePoint:function(Y){return Aj&&(Y=Bk(Y)),{x:Y.pageX,y:Y.pageY}},createObject:function(Z,r){var z=new Z;for(var P in r){var l=r[P];if(Nf(l))z[P]=l;else if(0===P.indexOf("s:"))z.s(P.substr(2),r[P]);else if(0===P.indexOf("a:"))z.a(P.substr(2),r[P]);else{var U=yd(P),l=r[P];z[U]?(z[U](l),"setToolTip"===U&&z.enableToolTip&&z.enableToolTip()):z[P]=l}}return z},setImage:function(s,u,p,E){var M=arguments.length;4===M?Zm(s,E,u,p):2===M?un(u)?Zm(s,u):lf(s,u):1===M&&Zm(s,s)},getImage:function(c,L,S){var A;if(c==i)return i;if(zo(c)?A=c:(A=Ff[c],c&&A===s&&(we&&we[c]||Zm(c,c))),L&&A&&A.tagName){var e;e="override"===S?"colors_override":"override_rgb"===S?"colors_override_rgb":"override_a"===S?"colors_override_a":"colors",A[e]||(A[e]={__count__:0});var X=A[e][L];return X||(A[e].__count__>z.imageCacheThreshold&&(A[e]={__count__:0}),X=en(A,tl(L),A.width,A.height,S),A[e][L]=X,A[e].__count__++),X}return A},isImageComplete:function(T,L,M){var X=Ij(T);if(!X)return!1;if(X.tagName)return X.complete;for(var H,T,P,f=X.comps,V=!0,c=0,q=f.length;q>c;c++)if(H=f[c],P=H.type,"image"===H.type){T=H.name,T&&T.func&&(T=gf(T,L));var Z=Tf(T,L,M);if(!Z){V=!1;break}}else if(cp.test(P)&&z.getCompType(P)===s){V=!1,Ep(P);break}return V},getId:function(){var l=1;return function(){return++l}}(),callLater:function(E,M,y,x){var Q=function(){E.apply(M,y)};return x?e(Q,x):F.requestAnimationFrame(Q)},cancelLater:function(I,v){v?Y(I):F.cancelAnimationFrame(I)},clone:function(_){if(null==_||"object"!=typeof _)return _;if(_ instanceof Date){var e=new Date;return e.setTime(_.getTime()),e}if(_ instanceof Array){for(var e=[],O=0,X=_.length;X>O;O++)e[O]=Se(_[O]);return e}if(_ instanceof Yi){for(var e=new Yi,O=0,X=_.length;X>O;O++)e.set(O,Se(_.get(O)));return e}if(_ instanceof El)return _;if(_ instanceof j){var e={};for(var c in _)_.hasOwnProperty(c)&&(e[c]=Se(_[c]));return e}return _},callWhenLoaded:function(h,F){F=F||100;var w=Ec(h,F);sk||(sk={}),sk[w]={tick:w,cb:h,delay:F}},beforeLoadURL:function(X){if(sk){var I={};for(var B in sk){var b=sk[B];Y(b.tick);var $=Ec(b.cb,b.delay);I[$]={tick:$,delay:b.delay,cb:b.cb}}sk=I}return z.convertURL?z.convertURL(X):X},convertURL:function(U){return U},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return z.getImage("default_blank")},resizeImagePOT:function(G,i){if(!G||!G.tagName)return G;var x=G.width,K=G.height;if(!x||!K)return G;if(Xn.isPOT(x)&&Xn.isPOT(K)&&(!i||x===K))return G;var T,M;i?M=T=Xn.nearestPOT(Math.min(x,K)):(T=Xn.nearestPOT(x),M=Xn.nearestPOT(K));var a=Uh(),m=a.getContext("2d");return Tj(a,T,M,1),m.drawImage(G,0,0,x,K,0,0,T,M),a},sortFunc:function(Q,E){if(Q===E)return 0;if(Q==i&&E!=i)return 1;if(Q!=i&&E==i)return-1;if(Q==i&&E==i)return 0;var X,k=typeof Q,f=typeof E;return k===Fi&&f===Fi?X=Q.localeCompare(E):k===wb&&f===wb&&(X=Q-E),X===s&&(X=(""+Q).localeCompare(""+E)),X>0?1:0>X?-1:0},getClassMap:function(){return ue},getClass:function(R){if(un(R)){var x,N=ue[R];if(!N){x=R.split("."),N=F;for(var A=0;A<x.length;A++)N=N[x[A]];ue[R]=N}return N}return R},def:function(U,K,B){var d,h,q,r=function(){};if(r.prototype=K.prototype,d=new r,un(U)){if(ue[U])throw"'"+U+"' already defined";q=yi(U),d.getClassName=function(){return U}}else q=U;if(d.constructor=q,d.getClass=function(){return q},d.getSuperClass=function(){return K},B)for(h in B)Re[h]&&Re.hasOwnProperty(h)?Re[h](d,B):ws(d,B,h);q.prototype=d,q.superClass=K.prototype},startAnim:function(){var m=function(O){O.duration&&(O.startTime=Ql()),O.timeId=ur(O.tick,i,i,O.interval)};return function(d){return d=Se(d),d.easing=d.easing||z.animEasing,d.duration||d.frames||(d.duration=z.animDuration),d.t=0,d.duration?d.interval=0:(d.frame=0,d.interval=d.interval||10),d.tick=function(){if(d.duration){var F=(Ql()-d.startTime)/d.duration;if(F>1&&(F=1),d.t=F,d.action(d.easing(F),F),!d.isRunning())return;1===F?d.stop():d._isPaused||(d.timeId=ur(d.tick))}else{if(d.frame++,F=d.t=d.frame/d.frames,d.action(d.easing(F),F),!d.isRunning())return;d.frame<d.frames?d._isPaused||(d.timeId=ur(d.tick,i,i,d.interval)):d.stop()}},d.resume=function(){d._isPaused&&(delete d._isPaused,d.duration?d.t<1&&(d.startTime=Ql()-d.duration*d.t,d.timeId=ur(d.tick)):d.frame<d.frames&&(d.timeId=ur(d.tick,i,i,d.interval)))},d.pause=function(){Zh(d.timeId,!d.duration),d._isPaused=!0},d.isPaused=function(){return this._isPaused},d.stop=function(s){d.isRunning()&&(Zh(d.timeId,!d.duration),delete d.timeId,d.duration?d.t<1&&s&&(d.t=1,d.action(d.easing(1),1)):d.frame<d.frames&&s&&(d.frame=d.frames,d.action(d.easing(1),1)),d._37o&&d._37o(),d.finishFunc&&d.finishFunc())},d.isRunning=function(){return d.timeId!=i},d.delay?ur(m,i,[d],d.delay):m(d),d}}(),getTextSize:function(){var L={},_=B?Uh().getContext("2d"):i;return function(I,T){_.font=I?I:Sh;var A=L[_.font];return A||(A=2*_.measureText("e").width+4,L[_.font]=A),{width:_.measureText(T).width+4,height:A}}}(),drawText:function(K,q,d,J,y,B,P,c,I,T){if(q!=i){var M=td(d,q),g={};g.y=T&&T!==Tr?T===bm?B+M.height/2:B+c-M.height/2:B+c/2,g.x=I&&I!==br?I===lk?y+P-M.width/2:y+P/2:y+M.width/2,Np(K,q,g,d,J)}},getDistance:function(V,n){var W=V.length;return n?3===W?k(o(V[0]-n[0])+o(V[1]-n[1])+o(V[2]-n[2])):2===W?k(o(V[0]-n[0])+o(V[1]-n[1])):V.z===s?k(o(n.x-V.x)+o(n.y-V.y)):k(o(n.x-V.x)+o(n.y-V.y)+o(n.z-V.z)):3===W?k(o(V[0])+o(V[1])+o(V[2])):2===W?k(o(V[0])+o(V[1])):void 0},brighter:function(n,c){return 0>c&&(c=-c),Vr(n,c?c:40)},darker:function(b,I){return I>0&&(I=-I),Vr(b,I?I:-40)},unionPoint:function(O,m){if(!O)return i;if(2===arguments.length)return O&&m?{x:_(O.x,m.x),y:_(O.y,m.y),width:R(O.x-m.x),height:R(O.y-m.y)}:i;var t=O;if(t._as&&(t=t._as),t.length===s)return i;var A=t.length;if(0>=A)return i;for(var C=1,o=t[0],z={x:o.x,y:o.y,width:0,height:0};A>C;C++){o=t[C];var x=_(z.x,o.x),L=$(z.x+z.width,o.x),E=_(z.y,o.y),U=$(z.y+z.height,o.y);z.x=x,z.y=E,z.width=L-x,z.height=U-E}return z},unionRect:function(x,P){if(x&&!P)return Se(x);if(!x&&P)return Se(P);if(x&&P){var n={x:_(x.x,P.x),y:_(x.y,P.y)};return n.width=$(x.x+x.width,P.x+P.width)-n.x,n.height=$(x.y+x.height,P.y+P.height)-n.y,n}return i},containsPoint:function(p,G,o,M){if(M!=i&&1!==M){var W=p.x+p.width/2,e=p.y+p.height/2;p={x:W-p.width/2*M,y:e-p.height/2*M,width:p.width*M,height:p.height*M}}if(o){var N=p.width/2,S=p.height/2,j=U(-o),K=X(-o),u=G.x-p.x-N,c=G.y-p.y-S;return G={x:K*u-j*c,y:j*u+K*c},oh({x:-N,y:-S,width:p.width,height:p.height},G)}return!(!p||G.x<p.x||G.y<p.y||G.x>p.x+p.width||G.y>p.y+p.height)},containsRect:function(Q,G){if(!Q||!G)return!1;var d=G.x,q=G.y,M=G.width,C=G.height,V=Q.width,k=Q.height;if(0>(V|k|M|C))return!1;var X=Q.x,y=Q.y;if(X>d||y>q)return!1;if(V+=X,M+=d,d>=M){if(V>=X||M>V)return!1}else if(V>=X&&M>V)return!1;if(k+=y,C+=q,q>=C){if(k>=y||C>k)return!1}else if(k>=y&&C>k)return!1;return!0},intersectsRect:function(u,s){if(!u||!s)return!1;var B=s.width,F=s.height,C=u.width,o=u.height;if(0>=C||0>=o||0>=B||0>=F)return!1;var h=s.x,k=s.y,N=u.x,v=u.y;return C+=N,o+=v,B+=h,F+=k,C>h&&o>k&&B>N&&F>v},intersection:function(h,w){if(!h||!w)return i;var f=w.x,q=w.y,$=h.x,p=h.y,o=f,R=q,y=$,E=p;return o+=w.width,R+=w.height,y+=h.width,E+=h.height,$>f&&(f=$),p>q&&(q=p),o>y&&(o=y),R>E&&(R=E),o-=f,R-=q,0>=o||0>=R?i:{x:f,y:q,width:o,height:R}},grow:function(w,P,E){E===s&&(E=P),w.x-=P,w.y-=E,w.width=w.width+2*P,w.height=w.height+2*E},getScreenPoint:function(x,z,G,o,r,a,l){var H=G.getBoundingClientRect(),e=x*(a||1)-G.scrollLeft+(o||0),V=z*(l||1)-G.scrollTop+(r||0),w=ag(G,!1);if(w){var R=new kc(e,V,0);return R.applyMatrix4(w),console.log(R),{x:R.x,y:R.y}}return{x:e+H.left,y:V+H.top}},getLogicalPoint:function(Y,i,W,$,J,p){var K,L,R=i.getBoundingClientRect();Y.target?(Th(Y)?qi?kp["91"]=!0:kp["17"]=!0:qi?kp["91"]=!1:kp["17"]=!1,kp["16"]=Kq(Y)?!0:!1,Y=Aj?Bk(Y):Y,K=Y.clientX,L=Y.clientY):(K=Y.x,L=Y.y);var U=ag(i,!0);if(U){var G=new kc(K,L,0);G.applyMatrix4(U);do{if(Math.abs(G.z)<=1e-6)break;var k=new kc(K,L,1);if(k.applyMatrix4(matrix),Math.abs(k.z)<=1e-6){G=k;break}if(k.sub(G),Math.abs(k.z)<=1e-6)break;G.addScaledVector(k,-G.z/k.z)}while(!1);return{x:(G.x+i.scrollLeft-(W||0))/(J||1),y:(G.y+i.scrollTop-($||0))/(p||1)}}return{x:(K-R.left+i.scrollLeft-(W||0))/(J||1),y:(L-R.top+i.scrollTop-($||0))/(p||1)}},removeHTML:function(){var B;return function(X){return X&&X.getView&&(X=X.getView()),X&&X.parentNode?B===X?!0:(B=X,X.parentNode.removeChild(X),B=i,!0):!1}}(),getToolTipDiv:function(){if(!uf){uf=em(),ae=em();var v=uf.style;z.baseZIndex!=i&&(v.zIndex=u(z.baseZIndex)+3+""),v.whiteSpace="nowrap",v.color=z.toolTipLabelColor,v.background=z.toolTipBackground,v.font=z.toolTipLabelFont,v.padding="5px",v.boxShadow="0px 0px 3px "+z.toolTipShadowColor}return uf},isToolTipShowing:function(){return uf&&uf.parentNode?!0:ae&&ae.parentNode?!0:!1},hideToolTip:function(){As(uf),As(ae),Zl()},showToolTip:function(s,d){if(!s||d==i)return Ui(),void 0;z.getToolTipDiv();var h,E;if(d.html?(d=d.html,h=ae,As(uf)):(h=uf,As(ae)),E=h.style,h.innerHTML=d,h.parentNode||r.Default.appendToScreen(h),s.target){s=hp(s);var t=np(),N=s.x,S=s.y,Y=Aj?60:12;if(Aj){var l=h.getBoundingClientRect();E.left=N-l.width/2+De,E.top=S-l.height-Y<t.top?S+Y+De:S-l.height-Y+De}else{E.left=N+Y+De,E.top=S+Y+De;var l=h.getBoundingClientRect();l.left+l.width>t.width&&(E.left=N-Y-l.width+De),l.top+l.height>t.height&&(E.top=S-Y-l.height+De),l.left<0&&(E.left=N+Y+De),l.top<0&&(E.top=S+Y+De)}}else E.left=s.x+De,E.top=s.y+De;Zl()},startDragging:function(b,C,l){l==s&&(l=!0),b!==ij&&(ij?l&&(Aj?ij.handleWindowTouchEnd(C):ij.handleWindowMouseUp(C)):Aj?(Z(F,me,hh),Z(F,Mh,bg)):(Z(F,_h,Yb),Z(F,ar,Ng)),ij=b)},getImageMap:function(){return Ff},toBoundaries:function(D,A,q,n){var y=[];return Wg(D,A,q,n).forEach(function(F){var d=[];F.forEach(function(b){d.push(b.x,b.y)}),y.push(d)}),y},getCurrentKeyCodeMap:function(){return kp},drawCenterImage:function(F,W,o,T,j,h,q,A){!j&&h&&h.isSelfViewEvent&&(j=h);var d=gq(W,j,h),D=eo(W,j,h);ui(F,W,G(o-d/2),G(T-D/2),d,D,j,h,q,A)},drawStretchImage:function(o,h,S,B,Y,q,V,f,U,j,t,F){!f&&U&&U.isSelfViewEvent&&(f=U);var v,s=gq(h,f,U,q),$=eo(h,f,U,V);"uniform"===S?(v=_(q/s,V/$),s*=v,$*=v,B+=G((q-s)/2),Y+=G((V-$)/2),q=s,V=$):"centerUniform"===S&&((s>q||$>V)&&(v=_(q/s,V/$),s*=v,$*=v),B+=G((q-s)/2),Y+=G((V-$)/2),q=s,V=$);var H=o.interactiveInfo;if(H){var Z;if(Z="center"===S?{x:B+q/2-s/2,y:Y+V/2-$/2,width:s,height:$}:{x:B,y:Y,width:q,height:V},H.rect){var b=H.compInfos,y=b.length;y&&(b[y-1].rect.image=h)}else H.rect=Z}if("center"===S){var Q=t!==!1&&(s>q||$>V);Q&&(o.save(),o.beginPath(),o.rect(B,Y,q,V),o.clip()),ui(o,h,B+q/2-s/2,Y+V/2-$/2,s,$,f,U,j,F),Q&&o.restore()}else ui(o,h,B,Y,q,V,f,U,j,F)},toCanvas:function(g,$,K,E,h,u,O,l,w){g=Ij(g,O),$=$||gq(g,h),K=K||eo(g,h);var N=Uh(),V=Xc(N);return l?(Tj(N,$,K,l),V.scale(l,l)):Tj(N,$,K,1),ml(V,g,E,0,0,$,K,h,u,O,w),g&&g.clampToEdge&&(N.clampToEdge=g.clampToEdge),V.restore(),N},toGrayColor:function(v){if(!v)return v;var b=xk(v),S=G(.299*b[0]+.587*b[1]+.114*b[2]);return"rgba("+S+","+S+","+S+","+b[3]/255+")"},createGradientImage:function(S,l,b,$){for(var w=["L",0,0,S,0,1,0,0,1,0,0],P=0,U=Math.min(l.length,b.length);U>P;P++)w.push(b[P],l[P]);var o=r.Default.toCanvas({width:S,height:S,clampToEdge:!0,comps:[{type:"shape",rotation:$||0,points:[0,0,S,0,S,S,0,S],background:"#ffffff",gradientPack:w}]});return o},createElement:function(j,R,w,G){var a=B.createElement(j);return ms(a,R||f.widgetBorder,2),a.style.font=w?w:Sh,G!=i&&(a.value=G),z.onElementCreated&&z.onElementCreated(a),a},containedInView:function(d,N){var I=Lq(N).getBoundingClientRect();return oh({x:I.left,y:I.top,width:I.width,height:I.height},Mi(d))},isIsolating:function(){return Ji>0},setIsolating:function(j){j?Ji++:Ji--},getMSMap:function(){return Re},stringify:function(Z,A,g){var V=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var y=JSON.stringify(Z,function(I,s){return"function"==typeof s?"__ht__"+(s.__ht__||s.toString()):Dn(s)?Mc(s):s instanceof r.List?"__ht__list"+(s.__ht__list||z.stringify(s._as)):s},A==i?2:A);return Date.prototype.toJSON=V,g&&(y="__ht__encode"+z.encodeString(y)),y},parse:function(f){return un(f)?"__ht__encode"!=f.substr(0,12)||(f=z.decodeString(f.substr(12)),un(f))?JSON.parse(f,function(g,C){if(un(C))if("__ht__function"==C.substr(0,14)){var W=C.indexOf("{")+1,$=C.lastIndexOf("}"),M=C.indexOf("(")+1,h=C.indexOf(")");if(W&&$&&M&&h){var T=new Function(C.substring(M,h),C.substring(W,$));return T.__ht__=C.substr(6),T}}else{if("__ht__date"==C.substr(0,10))return new Date(u(C.substr(10)));if("__ht__list"===C.substr(0,10))return new Yi(z.parse(C.substr(10)))}return C}):f:f},loadJS:function(N,C){C&&N.push(C);var R=N.shift();if(Qb(R))N=R.contact(N),z.loadJS(N);else if(Nf(R))R(),z.loadJS(N);else if(un(R)){var t=B.createElement("script");t.onload=function(){z.loadJS(N)},t.setAttribute("src",R),B.getElementsByTagName("head")[0].appendChild(t)}else N.length&&z.loadJS(N)},toRoundedCorner:function(){function T(b,R,p){b.x=R.x,b.y=R.e||p,b.z=R.y}var c=new kc,J=new kc,h=new kc,o=new kc;return function(q,A){var j,C=0;q.getPoints&&(C=q.getElevation(),q=q.getPoints()),j=q instanceof Yi?q:new Yi(q);var t=j.size();if(0>=A)return{points:j};var Q=new Yi,S=new Yi,B=j.get(0);T(c,B,C),Q.add(B),S.add(1);for(var U=1;t>U;U++)if(t>U+1){var R=j.get(U),H=j.get(U+1);T(J,R,C),T(h,H,C),o.subVectors(c,J).setLength(Math.min(.99*o.length(),A)).add(J),R.e!==s||B.e!==s?Q.add({x:o.x,y:o.z,e:o.y}):Q.add({x:o.x,y:o.z}),Q.add(R),o.subVectors(h,J).setLength(Math.min(.99*o.length(),A)).add(J),R.e!==s||H.e!==s?Q.add(B={x:o.x,y:o.z,e:o.y}):Q.add(B={x:o.x,y:o.z}),c.copy(o),S.addAll([2,3])}else Q.add(j.get(U)),S.add(2);return{points:Q,segments:S}}}(),toColorData:xk,setCanvas:Tj,createDiv:em,createDisabledDiv:Zn,createView:bd,createCanvas:Uh,appendChild:pi,initContext:Xc,checkLoadingImage:tb,translateAndScale:kb,layout:Kn,getPosition:cg,drawPoints:Dh,drawRoundRect:Hi,drawBorder:Yn,setFocus:Pf,getter:sr,setter:yd,isEmptyObject:rg,cameraPriority:function(){var U={skybox:0,main:1e4,top:1e7};return j.seal(j.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return U.skybox},set:function(j){if(j>=U.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");U.skybox=Number(j)}},main:{configurable:!1,enumerable:!1,get:function(){return U.main},set:function($){if($<=U.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if($>=U.top)throw new RangeError("Main camera must have lower priority than the top camera.");U.main=Number($)}},top:{configurable:!1,enumerable:!1,get:function(){return U.top},set:function(o){if(o<=U.main)throw new RangeError("Top camera must have higher priority than the main camera.");U.top=Number(o)}}}))}()},!0),Ej(S,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var sb=z.disabledOpacity,Nr=z.toolTipDelay,Wh=z.devicePixelRatio,Ok=z.autoMakeVisible,rm=z.autoHideScrollBar,nh=z.imageGradient,rq=z.showToolTip,Ui=z.hideToolTip,Co=z.dashPattern,Vo=z.lineCap,Pj=z.lineJoin,Xi=z.labelColor,sj=z.labelSelectColor,Sh=z.labelFont,Wo=z.widgetIndent,yc=z.widgetRowHeight,fg=z.widgetHeaderHeight,Qp=z.widgetTitleHeight,Cl=z.scrollBarColor,Bb=z.scrollBarSize,eb=z.scrollBarTimeout,ge=z.scrollBarMinLength,Fd=z.scrollBarInteractiveSize,Xg=z.zoomIncrement,hg=z.scrollZoomIncrement,fi=z.pinchZoomIncrement,ro=z.zoomMax,Fr=z.zoomMin,_b=z.createObject,nl=z.preventDefault,Jh=z.setImage,Ij=z.getImage,Tf=z.isImageComplete,tp=z.drawCenterImage,ml=z.drawStretchImage,xj=z.getId,ur=z.callLater,Zh=z.cancelLater,_l=z.sortFunc,Se=z.clone,yi=z.getClass,Tk=z.startAnim,$c=z.brighter,vd=z.darker,Tq=z.drawText,td=z.getTextSize,pn=z.isLeftButton,wl=z.isMiddleButton,Nk=z.isRightButton,lr=z.getTouchCount,Ae=z.isDoubleClick,Kq=z.isShiftDown,Th=z.isCtrlDown,Mi=z.getClientPoint,hp=z.getPagePoint,_m=z.getDistance,xn=z.unionPoint,qh=z.unionRect,oh=z.containsPoint,Sb=z.containsRect,Xh=z.intersectsRect,ff=z.intersection,np=z.getWindowInfo,Lg=z.grow,Eg=z.getLogicalPoint,kj=z.getScreenPoint,Vn=z.startDragging,As=z.removeHTML,kl=z.createElement,vh=z.segmentResolution,cn=z.shapeResolution,Bn=z.shapeSide,Zi=z.def,zr=function(t,P,V){Zi(E+"."+t,P,V)
},sh=function(e,P){e.childNodes.forEach(function(U){P(U),sh(U,P)})};Ej(z,{toolTipLabelColor:Xi,toolTipLabelFont:Sh,toolTipBackground:f.toolTipBackground,toolTipShadowColor:kh,drawBreakableText:Op,setDevicePixelRatio:function(h){Wh=z.devicePixelRatio="number"==typeof h?h:F.devicePixelRatio,sh(B.body,function(C){var L=C._ht;L&&L._canvas&&(Tj(L._canvas,L.getWidth(),L.getHeight()),L.redraw?L.redraw():L.iv())})}},!0);var vo=1e-6,Wr="undefined"!=typeof Uint16Array?Uint16Array:Array,$g="undefined"!=typeof Float32Array?Float32Array:Array,_c=function(g,h,q){var b=[g[0]-h[0],g[1]-h[1],g[2]-h[2]];if(q){var $=_m(b);$>0&&(b[0]/=$,b[1]/=$,b[2]/=$)}return b},tc=function(){var t="charCodeAt",O=2*(2*rn.length+1);for(var u in F)if(u===E+br[0]+(De.length+2)){var J=F[u];if(!J)break;for(var W=J.length,m=0;W>m;m++)if(J[m][t](0)===O&&J[m+1]!=i&&J[m+1]===De[0]&&J[m+2]!=i&&J[m+2][t](0)===O){for(var U=m+3;W>U;U++)if(J[U][t](0)===O){if(0==J[U+1])for(var x,e=U+2;W>e;e++){if(J[e][t](0)===O){0==J[e-1]&&x&&(Dp=x.substr(0,x.length-1));break}x==i?x=J[e]:x+=J[e]}break}break}break}return function(H){return[-H[0],-H[1],-H[2]]}}(),Wc=function(b,F){return 3===b.length?b[0]*F[0]+b[1]*F[1]+b[2]*F[2]:b[0]*F[0]+b[1]*F[1]},Fc=function(){var x=new $g(16);return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},nn=Fc(),Hq=function(M){var D=new $g(16);return D[0]=M[0],D[1]=M[1],D[2]=M[2],D[3]=M[3],D[4]=M[4],D[5]=M[5],D[6]=M[6],D[7]=M[7],D[8]=M[8],D[9]=M[9],D[10]=M[10],D[11]=M[11],D[12]=M[12],D[13]=M[13],D[14]=M[14],D[15]=M[15],D},dh=function(b,y){return b[0]=y[0],b[1]=y[1],b[2]=y[2],b[3]=y[3],b[4]=y[4],b[5]=y[5],b[6]=y[6],b[7]=y[7],b[8]=y[8],b[9]=y[9],b[10]=y[10],b[11]=y[11],b[12]=y[12],b[13]=y[13],b[14]=y[14],b[15]=y[15],b},ze=function(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},pq=function(G,$){var k=G[0],C=G[1],h=G[2];return G[0]=$[0]*k+$[4]*C+$[8]*h+$[12],G[1]=$[1]*k+$[5]*C+$[9]*h+$[13],G[2]=$[2]*k+$[6]*C+$[10]*h+$[14],G},wh=function(f,K){var X=f[0],o=f[1],e=f[2],k=f[3];return f[0]=K[0]*X+K[4]*o+K[8]*e+K[12]*k,f[1]=K[1]*X+K[5]*o+K[9]*e+K[13]*k,f[2]=K[2]*X+K[6]*o+K[10]*e+K[14]*k,f[3]=K[3]*X+K[7]*o+K[11]*e+K[15]*k,f},dj=function(){var Q,k,Z,P,e=Ge(Pg[1]+Pg[7]),E=Ge(Pg[0]+Pg[3]-Pg[10]),X=Ge(Pg[8]+2),o=function(){return k=Z.charAt(Q),Q+=1,k},v=function(){var s="";if(k===X)for(;o();){if(k===X)return o(),s;s+=k}else o()},I=function(){for(;k&&" ">=k;)o()},u=function(){var Z,x={};if(k===e){if(o(),I(),k===E)return o(),x;for(;k;){if(Z=v(),I(),o(),x[Z]=P(),I(),k===E)return o(),x;o(),I()}}};return P=function(){switch(I(),k){case e:return u();default:return v()}},function(J){if(C={},J){var z;if(Z=J,Q=0,k=" ",z=P(),I(),!k)return z}}}(),nd=function(o,N){if(N){var f=U(N),R=X(N),Z=o[4],P=o[5],J=o[6],Q=o[7],j=o[8],t=o[9],x=o[10],C=o[11];o[4]=Z*R+j*f,o[5]=P*R+t*f,o[6]=J*R+x*f,o[7]=Q*R+C*f,o[8]=j*R-Z*f,o[9]=t*R-P*f,o[10]=x*R-J*f,o[11]=C*R-Q*f}},Vf=function(J,h){if(h){var P=U(h),j=X(h),t=J[0],N=J[1],f=J[2],d=J[3],b=J[8],K=J[9],S=J[10],E=J[11];J[0]=t*j-b*P,J[1]=N*j-K*P,J[2]=f*j-S*P,J[3]=d*j-E*P,J[8]=t*P+b*j,J[9]=N*P+K*j,J[10]=f*P+S*j,J[11]=d*P+E*j}},Qi=function(v,J){if(J){var d=U(J),Q=X(J),a=v[0],t=v[1],z=v[2],h=v[3],W=v[4],B=v[5],j=v[6],n=v[7];v[0]=a*Q+W*d,v[1]=t*Q+B*d,v[2]=z*Q+j*d,v[3]=h*Q+n*d,v[4]=W*Q-a*d,v[5]=B*Q-t*d,v[6]=j*Q-z*d,v[7]=n*Q-h*d}},sf=function(P,V,r){return gg(i,r===!1?i:P.getFinalScale3d(),P.getFinalRotation3d(),P.getRotationMode(),P.p3(),i,V)},gg=function(A,T,F,d,L,V,M){return V||(V=Fc()),L&&Gg(V,L),Gn(V,F,d),M&&ao(V,V,M),T&&Rq(V,T),A&&ao(V,V,A),V},Eb=function(Q,g,q){g=u(g),q=u(q);var j=this;j.g=Q,j._84O=g,j._85O=q,j._70I=!0,j.F=0,j._83O=g+q,j.pen={x:0,y:0}},yn="lineDashOffset",Xo="setLineDash",Dj=function(w){for(var B in w)1===B.length&&(yn=w[B]);return B?1:0},Ek=function(A,d,Y){return Vb(d)?A:A[Xo]?(A[Xo](d),Y&&(A.lineDashOffset=Y),A):new Eb(A,d[0],d.length>1?d[1]:d[0])},Ak=function(u,Y){!Vb(Y)&&u[Xo]&&(u[Xo](zq),u.lineDashOffset=0)};if(Zi(Eb,j,{_69I:6,moveTo:function(u,F){var e=this,$=e.pen;$.x=u,$.y=F,e.g.moveTo(u,F),e.start||(e.start={x:u,y:F})},lineTo:function(V,B){var m=this,e=m.pen,N=V-e.x,W=B-e.y,A=K(W,N),v=X(A),Z=U(A),R=m._23O(e.x,e.y,V,B),H=m._85O,I=m._84O,j=m._83O;if(m.F){if(m.F>R)return m._70I?m._72I(V,B):m.moveTo(V,B),m.F-=R,void 0;if(m._70I?m._72I(e.x+v*m.F,e.y+Z*m.F):m.moveTo(e.x+v*m.F,e.y+Z*m.F),R-=m.F,m.F=0,m._70I=!m._70I,!R)return}var y=O(R/j);if(y){for(var G=v*I,Q=Z*I,S=v*H,c=Z*H,w=0;y>w;w++)m._70I?(m._72I(e.x+G,e.y+Q),m.moveTo(e.x+S,e.y+c)):(m.moveTo(e.x+S,e.y+c),m._72I(e.x+G,e.y+Q));R-=j*y}m._70I?R>I?(m._72I(e.x+v*I,e.y+Z*I),m.moveTo(V,B),m.F=H-(R-I),m._70I=!1):(m._72I(V,B),R===I?(m.F=0,m._70I=!m._70I):(m.F=I-R,m.moveTo(V,B))):R>H?(m.moveTo(e.x+v*H,e.y+Z*H),m._72I(V,B),m.F=I-(R-H),m._70I=!0):(m.moveTo(V,B),R===H?(m.F=0,m._70I=!m._70I):m.F=H-R)},quadraticCurveTo:function(N,R,G,m){var V,M=this,Z=M.pen,E=Z.x,g=Z.y,K=M._22O(E,g,N,R,G,m),H=0,u=0,B=M._85O,j=M._84O;if(M.F){if(M.F>K)return M._70I?M._71I(N,R,G,m):M.moveTo(G,m),M.F-=K,void 0;if(H=M.F/K,V=M._20O(E,g,N,R,G,m,H),M._70I?M._71I(V[2],V[3],V[4],V[5]):M.moveTo(V[4],V[5]),M.F=0,M._70I=!M._70I,!K)return}var D=K-K*H,Q=O(D/M._83O),w=j/K,W=B/K;if(Q)for(var $=0;Q>$;$++)M._70I?(u=H+w,V=M._21O(E,g,N,R,G,m,H,u),M._71I(V[2],V[3],V[4],V[5]),H=u,u=H+W,V=M._21O(E,g,N,R,G,m,H,u),M.moveTo(V[4],V[5])):(u=H+W,V=M._21O(E,g,N,R,G,m,H,u),M.moveTo(V[4],V[5]),H=u,u=H+w,V=M._21O(E,g,N,R,G,m,H,u),M._71I(V[2],V[3],V[4],V[5])),H=u;D=K-K*H,M._70I?D>j?(u=H+w,V=M._21O(E,g,N,R,G,m,H,u),M._71I(V[2],V[3],V[4],V[5]),M.moveTo(G,m),M.F=B-(D-j),M._70I=!1):(V=M._19O(E,g,N,R,G,m,H),M._71I(V[2],V[3],V[4],V[5]),K===j?(M.F=0,M._70I=!M._70I):(M.F=j-D,M.moveTo(G,m))):D>B?(u=H+W,V=M._21O(E,g,N,R,G,m,H,u),M.moveTo(V[4],V[5]),V=M._19O(E,g,N,R,G,m,u),M._71I(V[2],V[3],V[4],V[5]),M.F=j-(D-B),M._70I=!0):(M.moveTo(G,m),D===B?(M.F=0,M._70I=!M._70I):M.F=B-D)},bezierCurveTo:function(){var V=arguments;this.pen={x:V[4],y:V[5]},this.g.bezierCurveTo(V[0],V[1],V[2],V[3],V[4],V[5])},arc:function(Y,W,Z,O,g,T){T||(O=-O,g=-g),mj(this,Y,W,O,g-O,Z,Z,!1)},rect:function(L,m,M,Y){var l=this;l.pen={x:L,y:m},l.moveTo(L,m),l.lineTo(L,m+Y),l.lineTo(L+M,m+Y),l.lineTo(L+M,m),l.lineTo(L,m)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(i,Z,W,I){var D=W-i,K=I-Z;return k(D*D+K*K)},_22O:function(J,z,b,H,A,E,d){for(var v,I,V,j,e,m,r,n=0,W=J,G=z,i=d>0?d:this._69I,_=1;i>=_;_++)V=_/i,j=1-V,e=j*j,m=2*V*j,r=V*V,v=e*J+m*b+r*A,I=e*z+m*H+r*E,n+=this._23O(W,G,v,I),W=v,G=I;return n},_21O:function(E,s,h,Y,u,w,H,R){var b=this;if(0===H)return b._20O(E,s,h,Y,u,w,R);if(1===R)return b._19O(E,s,h,Y,u,w,H);var c=b._20O(E,s,h,Y,u,w,R);return c.push(H/R),b._19O.apply(b,c)},_20O:function(V,C,S,h,K,Q,u){if(1!==u){var N=S+(K-S)*u,M=h+(Q-h)*u;S=V+(S-V)*u,h=C+(h-C)*u,K=S+(N-S)*u,Q=h+(M-h)*u}return[V,C,S,h,K,Q]},_19O:function(m,X,f,y,Y,t,R){if(1!==R){var Z=m+(f-m)*R,n=X+(y-X)*R;f+=(Y-f)*R,y+=(t-y)*R,m=Z+(f-Z)*R,X=n+(y-n)*R}return[m,X,f,y,Y,t]},_72I:function(J,g){var j=this.pen;(J!==j.x||g!==j.y)&&(j.x=J,j.y=g,this.g.lineTo(J,g))},_71I:function(s,h,y,c){var r=this.pen;(s!==y||h!==c||y!==r.x||c!==r.y)&&(r.x=y,r.y=c,this.g.quadraticCurveTo(s,h,y,c))}}),t&&x){var Wf=x.toString();a=Wf.indexOf(jg.substr(0,2))>0&&Wf.indexOf(bm+bm.substr(1,1))>1||Wf.indexOf(Gr.substr(0,2)+jg.substr(2,2)+br[0]+jg[4])>1?!0:!1}var yl=i,Fn=i,hj=z.checkLoadingCompType=function(u){yl&&!u._72O&&(Fn||(Fn={}),Fn[u._72O=xj()]=u)},Ep=function(t,y){if(y||(y=t),y&&(yl||(yl={}),!yl[t])){var n=new Lr;if(yl[y]={request:n,url:y},y=z.beforeLoadURL(y),y.data){var P=z.parse(y.data);Qk(t,P),z.handleCompTypeLoaded(t,P)}else{n.onload=function(){if(200===this.status||0===this.status){var p=z.parse(n.getResponseText());Qk(t,p),z.handleCompTypeLoaded(t,p)}else Qk(t,i)},n.onerror=function(){Qk(t,i)};var D={};D.url=encodeURI(y),D.sync=!1,n.send(D)}}},Qk=function(c,k){if(Ah[c]=k,delete yl[c],rg(yl)&&(yl=i,Fn)){for(var t in Fn){var R=Fn[t];R.invalidateAll&&R.invalidateAll(s,"compTypeLoaded",c),R.redraw&&R.redraw(),R.iv(),delete R._72O}Fn=i}if(k&&Fn)for(var t in Fn){var R=Fn[t];R.invalidateAll&&R.invalidateAll(s,"compTypeLoading",c),R.redraw&&R.redraw(),R.iv()}},Bm=f.chart,Om="",xb=!0,Ei=z.compStack=[],Ii=/^style@/,ns=/^attr@/,$f=/^field@/,mm={x:.5,y:.5},Wp=function(){xb=!0},Vq=function(){return xb},gq=function(w,q,X,p){if(!w)return 0;if(gf(w.fitSize,q,X)&&p)return p;var k=gf(w.width,q,X);return null==k?20:k},eo=function(d,Z,D,w){if(!d)return 0;if(gf(d.fitSize,Z,D)&&w)return w;var c=gf(d.height,Z,D);return null==c?20:c},gf=function(z,P,d){if(!z||!z.func)return z;var y,R=z.func,V=z.value;return y=Nf(R)?d&&d.vectorDataBindingDisabled&&!z.isSafeFunc?V:R(P,d):P instanceof El||(r.ui?P instanceof r.ui.View:0)?ns.test(R)?P.a(Om+R.slice(5)):Ii.test(R)?P.s(Om+R.slice(6)):$f.test(R)?P[R.slice(6)]:P[R]?P[R](d):V:V,V!==s&&y==i?V:y},ui=z.drawImage=function(){var k,N,j,I,w,K,Q=function(y,Z){y.getValue&&y.getValue.compType===Z||(y.getValue=function(l){var A=o(y,l);if(A===s&&Z.properties){var p=Z.properties[l];p&&(A=p.defaultValue)}return A},y.getColor=function(L){return q(y.getValue(L))},y.getValue.compType=Z)},o=function(P,c,r){var n,F=!1;if(P.prefix&&N instanceof El){var I=N.a(Om+c);I!==s&&(F=!0,n=I)}return n===s&&(n=P[c]),n&&n.func&&(F=!0,n=gf(n,N,j)),r&&(n=r(n),F||(P[c]=n)),n},q=function(j,N){var P;if(P=N?o(j,N):j,k&&k.compGray&&P)return z.toGrayColor(P);if(w&&P){if("override"===K)return w;if("override_rgb"===K){var g=tl(w);return P=xk(P),"rgba("+G(255*g[0])+","+G(255*g[1])+","+G(255*g[2])+","+P[3]/255+")"}if("override_a"===K){var g=tl(w);return P=xk(P),"rgba("+P[0]+","+P[1]+","+P[2]+","+g[3]+")"}var g=tl(w);return P=xk(P),"rgba("+G(P[0]*g[0])+","+G(P[1]*g[1])+","+G(P[2]*g[2])+","+P[3]/255*g[3]+")"}return P},S=function(H){if(Qb(H)){for(var k=new Yi,N=H.length,M=0;N>M;M+=2)k.add({x:H[M],y:H[M+1]});H=k}return H},v=function(k){var A=o(k,"anchorX"),g=o(k,"anchorY");if(A!==s||g!==s)return{x:A===s?mm.x:A,y:g===s?mm.y:g};var J=o(k,"type"),X=o(k,"name");if("image"!==J||!X)return mm;var H=Ij(X);return H&&H.anchorX!==s&&H.anchorY!==s?{x:H.anchorX,y:H.anchorY}:mm},p=function(i,c){var V=o(i,kk),g=v(i);if(Qb(V)){var $=V.length,f=o(i,"relative"),G=c.width,Q=c.height;if(4===$)V={x:V[0],y:V[1],width:V[2],height:V[3]},f&&(V.x*=G,V.y*=Q,V.width*=G,V.height*=Q);else if(3===$){var z=V[0];V={width:V[1],height:V[2]},f&&(V.width*=G,V.height*=Q),"object"==typeof z?z.length&&(z={x:z[0],y:z[1]}):z=cg(z,c,V),V.x=z.x-V.width*g.x,V.y=z.y-V.height*g.y}V.x+=o(i,"offsetX")||0,V.y+=o(i,"offsetY")||0,!f&&c.fitSize&&(V=R(i,V,c))}return V},R=function(Y,A,x){if(A){var V,a,I,s={x:A.x,y:A.y,width:A.width,height:A.height},C=v(Y),k=o(Y,"layoutH"),h=o(Y,"layoutV"),M=1,r=1,X=0,L=0,z=1,_=1;switch(k){case"left":break;case"right":s.x+=x.width-x.rw;break;case"center":s.x+=.5*(x.width-x.rw);break;case"scale":case"leftright":default:V=o(Y,oq)||0,V&&(X=Math.abs(L=Math.sin(V)),z=Math.abs(_=Math.cos(V))),"leftright"!==k?(M+=z*(x.widthScale-1),r+=X*(x.widthScale-1)):(M+=s.width?z*(x.width-x.rw)/s.width:0,r+=s.height?X*(x.width-x.rw)/s.height:0,a=-Math.min(-C.x*_+C.y*L,-C.x*_-(1-C.y)*L,(1-C.x)*_+C.y*L,(1-C.x)*_-(1-C.y)*L))}switch(h){case"top":break;case"bottom":s.y+=x.height-x.rh;break;case"center":s.y+=.5*(x.height-x.rh);break;case"scale":case"topbottom":default:V==i&&(V=o(Y,oq),V&&(X=Math.abs(L=Math.sin(V)),z=Math.abs(_=Math.cos(V)))),"topbottom"!==h?(M+=X*(x.heightScale-1),r+=z*(x.heightScale-1)):(M+=s.width?X*(x.height-x.rh)/s.width:0,r+=s.height?z*(x.height-x.rh)/s.height:0,I=-Math.min(-C.x*L-C.y*_,-C.x*L+(1-C.y)*_,(1-C.x)*L-C.y*_,(1-C.x)*L+(1-C.y)*_))}return(1!==M||1!==r)&&("scale"!==k&&k?"leftright"===k&&(s.x+=s.width*(1-M)*C.x+a*(x.width-x.rw)):s.x+=s.x*(x.widthScale-1)+C.x*s.width*(x.widthScale-M),"scale"!==h&&h?"topbottom"===h&&(s.y+=s.height*(1-r)*C.y+I*(x.height-x.rh)):s.y+=s.y*(x.heightScale-1)+C.y*s.height*(x.heightScale-r),s.width*=M,s.height*=r),s.width<0&&(s.width=0),s.height<0&&(s.height=0),s}},x=function(v){return Qb(v)?new Yi(v):v},T=function(h,V,N,M,F,R,d){var C=k.interactiveInfo,y=h.transform;if(y)return k.save(),k.setTransform(y.a,y.b,y.c,y.d,y.tx,y.ty),C&&C.compInfos.push({comp:h,rect:V,matrix:y.clone(),prefix:Om}),!0;F===s&&(F=1),R===s&&(R=1);var l=o(h,"clipPercentage"),a=Mo(N,V);if(a&&!M&&1===F&&1===R&&!(1>l))return C&&C.compInfos.push({comp:h,rect:V,matrix:C.matrix.clone(),prefix:Om}),!1;d=d||mm;var x=V.x+V.width*d.x,Q=V.y+V.height*d.y,U=N.x+N.width*d.x,e=N.y+N.height*d.y,g=N.width?F*(V.width/N.width):1,T=N.height?R*(V.height/N.height):1;if(k.save(),C&&(C.matrix.appendTranslate(x,Q).appendRotate(M).appendScale(g,T).appendTranslate(-U,-e),C.compInfos.push({comp:h,rect:V,matrix:C.matrix.clone()})),Ag(k,x,Q),_p(k,M||0),vf(k,g,T),Ag(k,-U,-e),1>l){0>l&&(l=0);var r=oo(N,o(h,"clipDirection"),l);k.beginPath(),k.rect(r.x,r.y,r.width,r.height),k.clip()}return!0},L=function(){k.restore()},d=function(Y,Q,P){var h=o(Y,"path"),Z=o(Y,oq),m=o(Y,"scaleX"),H=o(Y,"scaleY"),j=v(Y),F=i,r=lm(null,h);if(P||(P=Y.unionRect,P||(P=xn(r),Y.path.func||(Y.unionRect=P)),F=P),P){F||(F=Y.unionRect,F||(F=xn(r),Y.path.func||(Y.unionRect=F)));var b=T(Y,P,F,Z,m,H,j),J=o(Y,"borderPattern"),d=Ek(k,J),M=q(Y,"background"),t=q(Y,"borderColor"),a=o(Y,"borderWidth"),e=o(Y,"gradient"),p=q(Y,"gradientColor"),W=o(Y,"border3d"),g=q(Y,"border3dColor"),X=o(Y,"border3dAccuracy"),x=k.lineJoin,u=k.lineCap;k.lineJoin=o(Y,"borderJoin")||Pj,k.lineCap=o(Y,"borderCap")||Vo,M?(qp(k,M,e,p,F),lm(k,h),k.fill(),d!==k&&lm(k,h)):lm(k,h);var A=o(Y,"borderWidthAbsolute");if(A&&(k.save(),k.setTransform(1,0,0,1,0,0)),a&&t&&(k.lineWidth=a,k.strokeStyle=t,k.stroke(),W&&ap(k,t,g,a,I,X)),Ak(k,J),o(Y,"dash")){var l=o(Y,"dashWidth")||a;if(l>0){J=o(Y,"dashPattern")||Co;var d=Ek(k,J,o(Y,"dashOffset")),N=q(Y,"dashColor")||q(Vp);d!==k&&lm(k,h),k.strokeStyle=N,k.lineWidth=l,k.stroke(),o(Y,"dash3d")&&ap(k,N,q(Y,"dash3dColor"),l,I,o(Y,"dash3dAccuracy")),Ak(k,J)}}A&&k.restore(),Q===kk&&Vj(k,M,o(Y,"depth"),F),k.lineJoin=x,k.lineCap=u,b&&L()}},h=function(f,$,e,E){var d=o(f,hb,S),m=o(f,oq),t=v(f);if(d&&E.fitSize){var P=new Yi,C=xn(d),s=R(f,C,E),l=C.x+t.x*C.width,M=C.y+t.y*C.height,_=s.x+t.x*s.width,b=s.y+t.y*s.height,D=C.width?s.width/C.width:1,c=C.height?s.height/C.height:1;d.each(function(w){P.add({x:_+(w.x-l)*D,y:b+(w.y-M)*c})}),d=P,f.unionRect=null}var u=o(f,"scaleX"),Z=o(f,"scaleY"),B=$===rd,h=i;if(!e&&B&&(e=f.unionRect,e||(e=xn(d),f.points.func||(f.unionRect=e)),h=e),e){B?h||(h=f.unionRect,h||(h=xn(d),f.points.func||(f.unionRect=h))):h=e;var F,A,y,G,Y=T(f,e,h,m,u,Z,t),n=o(f,"borderPattern"),O=Ek(k,n),Q=q(f,"background"),p=Ij(o(f,"repeatImage"),w,K),z=o(f,"gradientPack"),r=q(f,"borderColor"),J=o(f,"borderWidth"),g=o(f,"segments",x),W=o(f,"gradient"),a=q(f,"gradientColor"),H=o(f,"border3d"),X=q(f,"border3dColor"),U=o(f,"border3dAccuracy"),V=o(f,"closePath"),Yg=o(f,"fillRule")||"nonzero",Sh=k.lineJoin,qs=k.lineCap;if(k.lineJoin=o(f,"borderJoin")||Pj,k.lineCap=o(f,"borderCap")||Vo,B)if(Q||p||z){var ej=o(f,"fillClipPercentage");if(1>ej){0>ej&&(ej=0);var bd=oo(h,o(f,"fillClipDirection"),ej);k.save(),k.beginPath(),k.rect(bd.x,bd.y,bd.width,bd.height),k.clip()}Dh(k,d,g,V),z?Pr(k,z):p?hf(k,p,w,K,N,j):qp(k,Q,W,a,h),k.fill(Yg),1>ej&&k.restore(),z&&k.restore(),O!==k&&Dh(O,d,g,V)}else Dh(O,d,g,V);else if("roundRect"===$?F=o(f,"cornerRadius"):"polygon"===$?F=o(f,"polygonSide"):"arc"===$&&(F=o(f,"arcFrom"),A=o(f,"arcTo"),y=o(f,"arcClose"),G=o(f,"arcOval")),Q||p||z){var ej=o(f,"fillClipPercentage");if(1>ej){0>ej&&(ej=0);var bd=oo(h,o(f,"fillClipDirection"),ej);k.save(),k.beginPath(),k.rect(bd.x,bd.y,bd.width,bd.height),k.clip()}xi(k,$,h,F,A,y,G),z?Pr(k,z):p?hf(k,p,w,K,N,j):qp(k,Q,W,a,h),k.fill(Yg),1>ej&&k.restore(),z&&k.restore(),k!==O&&xi(O,$,h,F,A,y,G)}else xi(O,$,h,F,A,y,G);var Th=o(f,"borderWidthAbsolute");if(Th&&(k.save(),k.setTransform(1,0,0,1,0,0)),J&&r&&(k.lineWidth=J,k.strokeStyle=r,k.stroke(),H&&ap(k,r,X,J,I,U)),Ak(k,n),o(f,"dash")){var tg=o(f,"dashWidth")||J;if(tg>0){n=o(f,"dashPattern")||Co;var O=Ek(k,n,o(f,"dashOffset")),ed=q(f,"dashColor")||q(Vp);O!==k&&(B?Dh(O,d,g,V):xi(O,$,h,F,A,y,G)),k.strokeStyle=ed,k.lineWidth=tg,k.stroke(),o(f,"dash3d")&&ap(k,ed,q(f,"dash3dColor"),tg,I,o(f,"dash3dAccuracy")),Ak(k,n)}}Th&&k.restore(),$===kk&&Vj(k,Q,o(f,"depth"),h),k.lineJoin=Sh,k.lineCap=qs,Y&&L()}},H=function(F,b){var E=w||o(F,nb),g=K||o(F,"blendMode"),Z=o(F,"name"),C=Ij(Z,E,g);C?ml(k,C,o(F,"stretch"),b.x,b.y,b.width,b.height,N,j,E,null,g):xb=!1},W=function(z,B){var X=o(z,"text");X!=i&&Tq(k,X,o(z,"font"),q(z,nb),B.x,B.y,B.width,B.height,o(z,"align"),o(z,"vAlign"))},e=function(w,g){Yn(k,q(w,nb),g.x,g.y,g.width,g.height,o(w,"width"))},Z=function(K,Y){var f=o(K,fr),p=0;if(f&&(f.forEach(function(y){p+=y}),p>0)){for(var r=o(K,"colors")||Bm,n=o(K,"startAngle")||0,L=o(K,"hollow"),w=o(K,Kr),G=o(K,ni),R=o(K,je),v=w?new Yi:i,m=Y.x,y=Y.y,B=Y.width,x=Y.height,e=m+B/2,g=y+x/2,z=_(B,x)/2,O=0,M=0;M<f.length;M++){var u=f[M],c=b*u/p,E=n+c;if(k.fillStyle=r[O++],O===r.length&&(O=0),k.beginPath(),L){var C=e+X(n)*z/2,j=g+U(n)*z/2,T=e+X(E)*z,a=g+U(E)*z;k.moveTo(C,j),k.arc(e,g,z/2,n,E,!1),k.lineTo(T,a),k.arc(e,g,z,E,n,!0)}else k.moveTo(e,g),k.arc(e,g,z,E,n,!0);v&&(c=(n+E)/2,v.add({text:Nf(w)?w(u,M,p,N):u,x:e+.75*X(c)*z,y:g+.75*U(c)*z})),k.closePath(),k.fill(),n=E}v&&v.each(function(T){Tq(k,T.text,G,R,T.x,T.y,0,0,io)})}},y=function(H,_){var S=o(H,bs);if(S&&S.length>0){var B=S.length,D=o(H,Kr),R=o(H,ni),X=o(H,je),h=D?new Yi:i,G=o(H,"minValue")||0,F=o(H,"maxValue");if(F==i&&(F=0,S.forEach(function(U){o(U,fr).forEach(function(J){F=$(F,J)})})),G===F)return;for(var m=_.height/(F-G),n=_.y+F*m,K=o(S[0],fr).length,y=_.width/(3*K+1),w=2*y/B,g=0,v=0;B>v;v++)for(var s=S[v],I=o(s,nb),J=o(s,"colors"),t=o(s,fr),T=0;K>T;T++){J?k.fillStyle=J[T]:I?k.fillStyle=I:(k.fillStyle=Bm[g++],g===Bm.length&&(g=0));var A=t[T],O=A*m,V=_.x+(1+3*T)*y+v*w;if(Tl(k,V,n-O,w,O),h){var E=Nf(D)?D(A,T,s,N):A,P=td(R,E).height;h.add({x:V,y:n-O-P,width:w,height:P,text:E})}}h&&h.each(function(O){Tq(k,O.text,R,X,O.x,O.y,O.width,O.height,io)})}},O=function(z,x){var I=o(z,bs);if(I&&I.length>0){var G=I.length,q=o(I[0],fr).length,Z=x.width/(3*q+1),V=0,U=o(z,"maxValue"),u=o(z,Kr),e=o(z,ni),R=o(z,je),_=u?new Yi:i;if(U==i){U=0;for(var A=0;q>A;A++){for(var j=0,w=0;G>w;w++)j+=o(I[w],fr)[A];U=$(U,j)}}if(U>0){for(var A=0;q>A;A++)for(var y=x.y+x.height,w=0;G>w;w++){var r=I[w],H=o(r,nb),X=o(r,fr)[A],Y=X/U*x.height;H?k.fillStyle=H:(k.fillStyle=Bm[V++],V===Bm.length&&(V=0)),y-=Y;var b={x:x.x+(1+3*A)*Z,y:y,width:2*Z,height:Y};Tl(k,b.x,b.y,b.width,b.height),_&&(b.text=Nf(u)?u(X,A,r,N):X,_.add(b))}_&&_.each(function(i){Tq(k,i.text,e,R,i.x,i.y,i.width,i.height,io)})}}},c=function(O,w){var x=o(O,bs);if(x&&x.length>0){for(var q=x.length,Z=o(x[0],fr).length,g=w.width/(3*Z+1),u=0,S=o(O,Kr),d=o(O,ni),_=o(O,je),R=S?new Yi:i,C=0;Z>C;C++){for(var F=0,P=0;q>P;P++)F+=o(x[P],fr)[C];if(F>0){var D=w.y+w.height;for(P=0;q>P;P++){var e=x[P],H=o(e,nb),h=o(e,fr)[C],a=h/F*w.height;H?k.fillStyle=H:(k.fillStyle=Bm[u++],u===Bm.length&&(u=0)),D-=a;var E={x:w.x+(1+3*C)*g,y:D,width:2*g,height:a};Tl(k,E.x,E.y,E.width,E.height),R&&(E.text=Nf(S)?S(h,C,e,N):h,R.add(E))}}}R&&R.each(function(o){Tq(k,o.text,d,_,o.x,o.y,o.width,o.height,io)})}},m=function(V,_){var j=o(V,bs);if(j&&j.length>0){var H=j.length,h=o(V,"minValue")||0,f=o(V,"maxValue");if(f==i&&(f=0,j.forEach(function(x){o(x,fr).forEach(function(u){f=$(f,u)})})),h===f)return;for(var E=_.height/(f-h),F=_.y+f*E,l=o(j[0],fr).length,W=_.width/(3*l+1),r=0,x=o(V,"lineWidth")||2,q=o(V,"line3d"),n=o(V,"linePoint"),M=o(V,Kr),B=o(V,ni),Q=o(V,je),C=0;H>C;C++){var a=j[C],e=o(a,nb),X=o(a,fr);e?k.strokeStyle=e:(e=k.strokeStyle=Bm[r++],r===Bm.length&&(r=0)),k.beginPath();for(var D=0;l>D;D++){var z=_.x+(2+3*D)*W,L=F-X[D]*E;0===D?k.moveTo(z,L):k.lineTo(z,L)}if(k.lineWidth=x,k.stroke(),q&&ap(k,e,i,x,I),n||M){var m,Z=x/2+2;for(D=0;l>D;D++){var P=X[D];if(z=_.x+(2+3*D)*W,L=F-P*E,Nf(n)?n(k,z,L,e,D,a,N):n&&(k.fillStyle=e,k.beginPath(),k.arc(z,L,Z,0,b,!0),k.fill()),Nf(M)?m=M(P,D,a,N):M&&(m=P),m){var s=td(B,m).height,c=k.shadowBlur;if(c){var J=k.shadowOffsetX,A=k.shadowOffsetY,U=k.shadowColor;k.shadowOffsetX=0,k.shadowOffsetY=0,k.shadowBlur=0,k.shadowColor=i}Tq(k,m,B,Q,z,L-s-Z+2,0,s,io),c&&(k.shadowOffsetX=J,k.shadowOffsetY=A,k.shadowBlur=c,k.shadowColor=U)}}}}}},Y=function(Q){k=Q[0],N=Q[1],j=Q[2],I=Q[3],w=Q[4],K=Q[5]},V=function(){return[k,N,j,I,w,K]},g=function(w,Z){var u;j&&j.getState?u=j.getState(N):(u=N instanceof El?N.s(pg):null,(u===s||null===u)&&(u=o(w,pg)));var h=o(Z,pg);return h!==s&&null!==h&&h!==u?!1:o(Z,mf)},a={border:e,image:H,text:W,pieChart:Z,columnChart:y,stackedColumnChart:O,percentageColumnChart:c,lineChart:m};return function(A,B,Z,O,U,J,E,M,r,c){if(B&&U&&J){var t=V();k=A,N=E,j=M,!N&&j&&j.isSelfViewEvent&&(N=j),I=j?j._zoom?j._zoom:1:1,w=r,K=c;var C=U,l=J;if(xm()){var _,H,b;0===k[ql]?xm[0]&&(_=!0):_=!0,k.texureImage2D?xm[1]&&(H=!0):H=!0,k.texureImage3D?xm[2]&&(b=!0):b=!0,_&&H&&b&&(C=Z,l=O)}if(B.tagName)return un(Dp)&&!F[Dp]||k.drawImage(B,C,l,U,J),Y(t),void 0;if(o(B,"visible")===!1)return Y(t),void 0;w||(w=gf(B.color,N,j)),c||(K=gf(B.blendMode,N,j)),un(Dp)&&!F[Dp]&&(U=C,J=l);var R=gq(B,N,j,U),G=eo(B,N,j,J),X={x:0,y:0,width:R,height:G,fitSize:o(B,"fitSize")},m=o(B,"clip"),D=o(B,"opacity");if(X.fitSize){var W=X.rw=gf(B.width,N,j)||20;X.widthScale=R/W;var P=X.rh=gf(B.height,N,j)||20;X.heightScale=G/P}if(k.save(),k.interactiveInfo){var u=k.interactiveInfo.matrix,e=u.clone();u.appendTranslate(C,l).appendScale(U/R,J/G)}Ag(k,C,l),(R!==U||G!==J)&&k.scale(U/R,J/G),m&&(Nf(m)?m(k,R,G,N,j,B):(k.beginPath(),k.rect(0,0,R,G),k.clip())),D!=i&&(k.globalAlpha*=D),o(B,"comps").forEach(function(Y){if(Y.prefix){var A=Om,n=gf(Y.prefix,N,j);n&&(Om=Om+n+".")}if(g(B,Y)===!1)return Y.prefix&&(Om=A),void 0;if(Ei.splice(0,0,Y),k.interactiveInfo)var M=k.interactiveInfo.matrix.clone();var r=o(Y,"opacity"),R=o(Y,"shadow"),e=o(Y,"type"),K=p(Y,X);if(r!=i){var $=k.globalAlpha;k.globalAlpha*=r}if(R){var f=k.shadowOffsetX,E=k.shadowOffsetY,C=k.shadowBlur,l=k.shadowColor,Z=o(Y,"shadowOffsetX"),y=o(Y,"shadowOffsetY"),G=o(Y,"shadowBlur"),H=q(Y,"shadowColor");k.shadowOffsetX=(Z==i?3:Z)*I,k.shadowOffsetY=(y==i?3:y)*I,k.shadowBlur=(G==i?6:G)*I,k.shadowColor=H||q(Cn)}if("save"===e)k.save();else if("endClip"===e||"restore"===e)k.restore();else if("clip"===e)k.save(),Dh(k,o(Y,"points",S),o(Y,"segments",x),!0),k.clip();else if(fl[e])K=K||{x:0,y:0,width:X.width,height:X.height},h(Y,e,K,X);else if(e===rd)h(Y,e,K,X);else if("SVGPath"===e)d(Y,e,K);else{K=K||{x:0,y:0,width:X.width,height:X.height};var c=o(Y,oq),U=o(Y,"scaleX"),V=o(Y,"scaleY"),P=v(Y),w=T(Y,K,K,c,U,V,P);if(Nf(e))Q(Y,e),z.drawCompType(e,k,K,Y,N,j);else if(z.getCompType(e)){var J=z.getCompType(e),W=J.func||J;Q(Y,J),z.drawCompType(W,k,K,Y,N,j)}else a[e]?a[e](Y,K):z.getCompType(e)===s&&cp.test(e)&&Ep(e);w&&L()}R&&(k.shadowOffsetX=f,k.shadowOffsetY=E,k.shadowBlur=C,k.shadowColor=l),r!=i&&(k.globalAlpha=$),k.interactiveInfo&&(k.interactiveInfo.matrix=M),Y.prefix&&(Om=A),Ei.splice(0,1)}),k.interactiveInfo&&(k.interactiveInfo.matrix=e),k.restore(),Y(t)}}}();z.getCurrentComp=function(){return Ei[0]},z.getParentComp=function(){return Ei[1]},z.getInternal=function(){return{isEnter:Hf,isEsc:Wi,isSpace:Sd,isLeft:_r,isUp:Ub,isRight:im,isDown:mh,addMethod:Ej,superCall:Kh,toPointsArray:Wg,translateAndScale:kb,appendArray:ks,createWorldMatrix:gg,vec3TransformMat4:pq,setCanvas:Tj,createDiv:em,createView:bd,createCanvas:Uh,createImage:ud,initContext:Xc,layout:Kn,fillRect:Tl,Mat:zb,drawBorder:Yn,isString:un,setBorder:ms,getPropertyValue:qr,setPropertyValue:jf,drawVerticalLine:$d,draw3DRect:Vj,getPinchDist:iq,isSameRect:Mo,getPosition:cg,intersectionLineRect:$q,getNodeRect:zk,getEdgeAgentPosition:os,getEdgeHostPosition:gp,getImageWidth:gq,getImageHeight:eo,initItemElement:Rb,drawPoints:Dh,createG2:Ek,closePopup:Ld,isH:us,createAnim:Lb,createNormalMatrix:Xd,createNormals:Yl,toFloatArray:Yd,glMV:Rk,batchShape:vs,createNodeMatrix:sf,getFaceInfo:ph,transformAppend:Jr,drawFaceInfo:Zb,to3dPointsArray:mp,setGLDebugMode:function(Z){ob=Z},cube:function(){return{vs:Df,is:Ar,uv:Jl}},ui:function(){return{DataUI:Dd,NodeUI:sc,EdgeUI:uj,GroupUI:gh,ShapeUI:ep,GridUI:Jk,Data3dUI:Jf,Node3dUI:oe,Shape3dUI:cc}},getInternalVersion:function(){return"U2FsdGVkX1+hkvXx+DVt6n51dCEv4GEf/Z3nwX6kJak="},getDragger:function(){return ij},addMSMap:function(y){Ej(Re,y)},k:T,addEventListener:Z,removeEventListener:m}},function(F){function L(X,h){X!=i&&(h==i&&Fi!=typeof X?this._54O(X,256):this._54O(X,h))}function t(){return new L(i)}function j(g,t,v,W,C,d){for(;--d>=0;){var R=t*this[g++]+v[W]+C;C=O(R/67108864),v[W++]=67108863&R}return C}function g(S,W,p,q,g,w){for(var e=32767&W,L=W>>15;--w>=0;){var y=32767&this[S],P=this[S++]>>15,l=L*y+P*e;y=e*y+((32767&l)<<15)+p[q]+(1073741823&g),g=(y>>>30)+(l>>>15)+L*P+(g>>>30),p[q++]=1073741823&y}return g}function R(L,p,b,Y,w,j){for(var h=16383&p,Z=p>>14;--j>=0;){var i=16383&this[L],D=this[L++]>>14,H=Z*i+D*h;i=h*i+((16383&H)<<14)+b[Y]+w,w=(i>>28)+(H>>14)+Z*D,b[Y++]=268435455&i}return w}function G(o){return tj.charAt(o)}function r(r,T){var M=Si[r.charCodeAt(T)];return M==i?-1:M}function N(y){for(var C=this.t-1;C>=0;--C)y[C]=this[C];y.t=this.t,y.s=this.s}function A(w){this.t=1,this.s=0>w?-1:0,w>0?this[0]=w:-1>w?this[0]=w+this.DV:this.t=0}function B(F){var o=t();return o._58O(F),o}function I(o,$){var V,y=this;if(16==$)V=4;else if(8==$)V=3;else if(256==$)V=8;else if(2==$)V=1;else if(32==$)V=5;else{if(4!=$)return y.fromRadix(o,$),void 0;V=2}y.t=0,y.s=0;for(var c=o.length,b=!1,f=0;--c>=0;){var h=8==V?255&o[c]:r(o,c);0>h?"-"==o.charAt(c)&&(b=!0):(b=!1,0==f?y[y.t++]=h:f+V>y.DB?(y[y.t-1]|=(h&(1<<y.DB-f)-1)<<f,y[y.t++]=h>>y.DB-f):y[y.t-1]|=h<<f,f+=V,f>=y.DB&&(f-=y.DB))}8==V&&0!=(128&o[0])&&(y.s=-1,f>0&&(y[y.t-1]|=(1<<y.DB-f)-1<<f)),y._57O(),b&&L.ZERO._78O(y,y)}function S(){for(var E=this,f=E.s&E.DM;E.t>0&&E[E.t-1]==f;)--E.t}function M(m){var S=this;if(S.s<0)return"-"+S._85O()[xg](m);var y;if(16==m)y=4;else if(8==m)y=3;else if(2==m)y=1;else if(32==m)y=5;else{if(4!=m)return S.toRadix(m);y=2}var Q,i=(1<<y)-1,V=!1,x="",X=S.t,O=S.DB-X*S.DB%y;if(X-->0)for(O<S.DB&&(Q=S[X]>>O)>0&&(V=!0,x=G(Q));X>=0;)y>O?(Q=(S[X]&(1<<O)-1)<<y-O,Q|=S[--X]>>(O+=S.DB-y)):(Q=S[X]>>(O-=y)&i,0>=O&&(O+=S.DB,--X)),Q>0&&(V=!0),V&&(x+=G(Q));return V?x:"0"}function K(){var N=t();return L.ZERO._78O(this,N),N}function z(){return this.s<0?this._85O():this}function P(B){var V=this,m=V.s-B.s;if(0!=m)return m;var Y=V.t;if(m=Y-B.t,0!=m)return V.s<0?-m:m;for(;--Y>=0;)if(0!=(m=V[Y]-B[Y]))return m;return 0}function q(N){var B,r=1;return 0!=(B=N>>>16)&&(N=B,r+=16),0!=(B=N>>8)&&(N=B,r+=8),0!=(B=N>>4)&&(N=B,r+=4),0!=(B=N>>2)&&(N=B,r+=2),0!=(B=N>>1)&&(N=B,r+=1),r}function p(){var w=this;return w.t<=0?0:w.DB*(w.t-1)+q(w[w.t-1]^w.s&w.DM)}function W(h,S){var R;for(R=this.t-1;R>=0;--R)S[R+h]=this[R];for(R=h-1;R>=0;--R)S[R]=0;S.t=this.t+h,S.s=this.s}function Q(S,O){for(var p=S;p<this.t;++p)O[p-S]=this[p];O.t=$(this.t-S,0),O.s=this.s}function Y(g,v){var I,W=this,X=g%W.DB,l=W.DB-X,c=(1<<l)-1,C=O(g/W.DB),s=W.s<<X&W.DM;for(I=W.t-1;I>=0;--I)v[I+C+1]=W[I]>>l|s,s=(W[I]&c)<<X;for(I=C-1;I>=0;--I)v[I]=0;v[C]=s,v.t=W.t+C+1,v.s=W.s,v._57O()}function C(o,k){var Y=this;k.s=Y.s;var X=O(o/Y.DB);if(X>=Y.t)return k.t=0,void 0;var t=o%Y.DB,S=Y.DB-t,F=(1<<t)-1;k[0]=Y[X]>>t;for(var R=X+1;R<Y.t;++R)k[R-X-1]|=(Y[R]&F)<<S,k[R-X]=Y[R]>>t;t>0&&(k[Y.t-X-1]|=(Y.s&F)<<S),k.t=Y.t-X,k._57O()}function x(A,C){for(var o=this,H=0,v=0,l=_(A.t,o.t);l>H;)v+=o[H]-A[H],C[H++]=v&o.DM,v>>=o.DB;if(A.t<o.t){for(v-=A.s;H<o.t;)v+=o[H],C[H++]=v&o.DM,v>>=o.DB;v+=o.s}else{for(v+=o.s;H<A.t;)v-=A[H],C[H++]=v&o.DM,v>>=o.DB;v-=A.s}C.s=0>v?-1:0,-1>v?C[H++]=o.DV+v:v>0&&(C[H++]=v),C.t=H,C._57O()}function e(j,z){var Z=this.abs(),p=j.abs(),Q=Z.t;for(z.t=Q+p.t;--Q>=0;)z[Q]=0;for(Q=0;Q<p.t;++Q)z[Q+Z.t]=Z.am(0,p[Q],z,Q,0,Z.t);z.s=0,z._57O(),this.s!=j.s&&L.ZERO._78O(z,z)}function f(B){for(var N=this.abs(),A=B.t=2*N.t;--A>=0;)B[A]=0;for(A=0;A<N.t-1;++A){var e=N.am(A,N[A],B,2*A,0,1);(B[A+N.t]+=N.am(A+1,2*N[A],B,2*A+1,e,N.t-A-1))>=N.DV&&(B[A+N.t]-=N.DV,B[A+N.t+1]=1)}B.t>0&&(B[B.t-1]+=N.am(A,N[A],B,2*A,0,1)),B.s=0,B._57O()}function J(S,n,V){var j=S.abs(),A=this;if(!(j.t<=0)){var w=A.abs();if(w.t<j.t)return n!=i&&n._58O(0),V!=i&&A._77O(V),void 0;V==i&&(V=t());var R=t(),U=A.s,s=S.s,z=A.DB-q(j[j.t-1]);z>0?(j._44O(z,R),w._44O(z,V)):(j._77O(R),w._77O(V));var H=R.t,x=R[H-1];if(0!=x){var p=x*(1<<A.F1)+(H>1?R[H-2]>>A.F2:0),m=A.FV/p,N=(1<<A.F1)/p,J=1<<A.F2,G=V.t,o=G-H,y=n==i?t():n;for(R._59O(o,y),V._52O(y)>=0&&(V[V.t++]=1,V._78O(y,V)),L.ONE._59O(H,y),y._78O(R,R);R.t<H;)R[R.t++]=0;for(;--o>=0;){var C=V[--G]==x?A.DM:O(V[G]*m+(V[G-1]+J)*N);if((V[G]+=R.am(0,C,V,o,0,H))<C)for(R._59O(o,y),V._78O(y,V);V[G]<--C;)V._78O(y,V)}n!=i&&(V._45O(H,n),U!=s&&L.ZERO._78O(n,n)),V.t=H,V._57O(),z>0&&V._46O(z,V),0>U&&L.ZERO._78O(V,V)}}}function m(w){var x=t();return this.abs()._49O(w,i,x),this.s<0&&x._52O(L.ZERO)>0&&w._78O(x,x),x}function h(X){this.m=X}function Z(n){return n.s<0||n._52O(this.m)>=0?n.mod(this.m):n}function s(L){return L}function l(A){A._49O(this.m,i,A)}function o(Z,x,n){Z._47O(x,n),this._74O(n)}function y(d,E){d._48O(E),this._74O(E)}function D(){if(this.t<1)return 0;var O=this[0];if(0==(1&O))return 0;var w=3&O;return w=15&w*(2-(15&O)*w),w=255&w*(2-(255&O)*w),w=65535&w*(2-(65535&(65535&O)*w)),w=w*(2-O*w%this.DV)%this.DV,w>0?this.DV-w:-w}function n(v){var I=this;I.m=v,I.mp=v._50O(),I.mpl=32767&I.mp,I.mph=I.mp>>15,I.um=(1<<v.DB-15)-1,I.mt2=2*v.t}function c(M){var V=t();return M.abs()._59O(this.m.t,V),V._49O(this.m,i,V),M.s<0&&V._52O(L.ZERO)>0&&this.m._78O(V,V),V}function a(u){var E=t();return u._77O(E),this._74O(E),E}function d(g){for(var m=this;g.t<=m.mt2;)g[g.t++]=0;for(var F=0;F<m.m.t;++F){var r=32767&g[F],X=r*m.mpl+((r*m.mph+(g[F]>>15)*m.mpl&m.um)<<15)&g.DM;for(r=F+m.m.t,g[r]+=m.m.am(0,X,g,F,0,m.m.t);g[r]>=g.DV;)g[r]-=g.DV,g[++r]++}g._57O(),g._45O(m.m.t,g),g._52O(m.m)>=0&&g._78O(m.m,g)}function Hc(A,W){A._48O(W),this._74O(W)}function Bo(b,N,$){b._47O(N,$),this._74O($)}function Cd(){return 0==(this.t>0?1&this[0]:this.s)}function re(C,y){if(C>4294967295||1>C)return L.ONE;var J=t(),i=t(),O=y._73O(this),n=q(C)-1;for(O._77O(J);--n>=0;)if(y._76O(J,i),(C&1<<n)>0)y._75O(i,O,J);else{var U=J;J=i,i=U}return y.revert(J)}function Bi(g,l){var D;return D=256>g||l._51O()?new h(l):new n(l),this.exp(g,D)}function Qn(){var u=this;if(u.s<0){if(1==u.t)return u[0]-u.DV;if(0==u.t)return-1}else{if(1==u.t)return u[0];if(0==u.t)return 0}return(u[1]&(1<<32-u.DB)-1)<<u.DB|u[0]}function tq(X,V){return new L(X,V)}function Wq(){var V=this;V.n=i,V.e=0,V.d=i,V.p=i,V.q=i,V.dmp1=i,V.dmq1=i,V._10A=i}function es(w){return w._53O(this.e,this.n)}function Xe(p){var R,d,H,Z="",u=0;for(R=0;R<p.length&&p.charAt(R)!=tl;++R)H=cg.indexOf(p.charAt(R)),0>H||(0==u?(Z+=G(H>>2),d=3&H,u=1):1==u?(Z+=G(d<<2|H>>4),d=15&H,u=2):2==u?(Z+=G(d),Z+=G(H>>2),d=3&H,u=3):(Z+=G(d<<2|H>>4),Z+=G(15&H),u=0));return 1==u&&(Z+=G(d<<2)),Z}function Tr(B){var h=B.split(""),j=Xe(B);return h.forEach(function(Z){var F=Z.length;F>0&&j&&(sl+=u(Z))}),j}function je(m,g){var R=io._4O.Util._56O(m,"ss"),L={},v=0;return L.v=R==g,L.t=1,L.s=0>v?-1:0,$m=L.v,v>0?L[0]=v:-1>v?L[0]=v+L.DV:L.t=0,[R,L]}function nk(m){var Y=38,b=m.substring(0,Y);if(b&&30==b.indexOf("05000420")){var O=["ss",m.substring(Y)];return O}return[]}function Cm(y,Q){Q=Q.replace(db,""),Q=Q.replace(/[ \n]+/g,"");var e=tq(Q,16);if(e._55O()>this.n._55O())return 0;var c=this._37O(e),$=c[xg](16).replace(/^1f+00/,""),n=nk($);if(0==n.length)return!1;for(var u,F,Z,s=.5,O=Bn,w=[0,.5,.75,.875,.9375],d=[],R=[],k=[],v=b/O,g=n[1],T=je(y,g)[0],x=0,V=0;x<w.length;x++){var E=0===x%2?0:.5;for(u=0;O>=u;u++)F=(u+E)*v,Z=1-w[x],d.push(X(F)*s*Z,-s+2*w[x]*s,-U(F)*s*Z),R.push((u+E)/O,Z)}for(x=0;x<w.length-1;x++){var L=x*(O+1),J=(x+1)*(O+1);for(u=0;O>u;u++)k.push(L+u,J+u+1,J+u,L+u,L+u+1,J+u+1)}return k.forEach(function(w){V+=w}),g==T&&V>10}var hl,al=0xdeadbeefcafe,Sc=15715070==(16777215&al),xg="toString",El="",yf="nat",ok=function(){};v=F["D"+11182[xg](V(2,5))];var ic=L.prototype;on+=ds.substr(0,1);var Gb=F.navigator?F.navigator.appName:"";Sc&&"Microsoft Internet Explorer"==Gb?(ic.am=g,hl=30):Sc&&"Netscape"!=Gb?(ic.am=j,hl=26):(ic.am=R,hl=28),ic.DB=hl,ic.DM=(1<<hl)-1,ic.DV=1<<hl;
var ns=52;ic.FV=V(2,ns),ic.F1=ns-hl,ic.F2=2*hl-ns;var li,nl,tj="0123456789abcdefghijklmnopqrstuvwxyz",Si=[],Zo=function(G){return String.fromCharCode(G)};for(li="0".charCodeAt(0),nl=0;9>=nl;++nl)Si[li++]=nl;for(li="a".charCodeAt(0),nl=10;36>nl;++nl)Si[li++]=nl;for(li="A".charCodeAt(0),nl=10;36>nl;++nl)Si[li++]=nl;var ho=h.prototype;ho._73O=Z,ho.revert=s,ho._74O=l,ho._75O=o,ho._76O=y;var Mn=n.prototype;Mn._73O=c,Mn.revert=a,Mn._74O=d,Mn._75O=Bo,Mn._76O=Hc,ic._77O=N,ic._58O=A,ic._54O=I,ic._57O=S,ic._59O=W,ic._45O=Q,ic._44O=Y,ic._46O=C,ic._78O=x,ic._47O=e,ic._48O=f,ic._49O=J,ic._50O=D,ic._51O=Cd,ic.exp=re,ic.toString=M,ic._85O=K,ic.abs=z,ic._52O=P,ic._55O=p,ic.mod=m,ic._53O=Bi,L.ZERO=B(0),L.ONE=B(1),ic._86O=Qn;var vq=function(o,S){var v=this;v.isPublic=!0,typeof o!==Fi?(v.n=o,v.e=S):o!=i&&S!=i&&o.length>0&&S.length>0&&(v.n=tq(o,16),v.e=u(S,16))};Md=function(){var Z,S,n=Tr(Qk),A=n.substr(0,4),z=n.substr(4,2),c=n.substr(6,2),W=1,J=!W,t=T,K=[],q=wd.charAt(7);if(v&&(v[xg]().indexOf(yf)<0||v[on][xg]().indexOf(yf)<0||!n?Z=i:(n=new v(A-0,z-W,c-0),S=n.setHours(9),v[on]()>S?Z=qe[q]:J=!0)),n&&Z&&Z[0]&&Z[H(.5)]&&t){var x=dj(Z[0]),a=dj(Z[1]);for(var s in a)K.push(s);var L,U=0,e=x[K[U]],G=a[K[U++]],$=a[K[U++]],B=a[K[U++]],N=a[K[U++]],m=a[K[U++]],g=a[K[U++]],_=x[K[U]],I=a[K[U++]],r=Th._27O(t);if(e===G&&r&&I){L=G+$+B+N+m+g;var b=!g||g===Sf;if(!b&&g)for(var P,d=0,o=g.length;o>d;d++)g[d]===Yq[U]?P===Sf?b=!0:P[0]===vk[5]&&Sf&&Sf.indexOf(P.substr(1))>=0?b=!0:P=i:(P==i?P=g[d]:P+=g[d],d===o-1&&(P===Sf?b=!0:P[0]===vk[5]&&Sf&&Sf.indexOf(P.substr(1))>=0&&(b=!0)));L&&r._31O(L,I)&&r._31O(e,_)&&b&&(!m||v[on]()<m)&&(J=!0)}}return J||(xi=Vb),q};var me=Wq.prototype;me._37O=es,me._38O=vq;var cg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",tl="=",xk=25,Cg=10,Qk="ICAGFQ==",rd=rd||function(D,R){var d={},K=d._7A={},V=K._6A=function(){function O(){}return{_80O:function(t){O.prototype=this;var x=new O;return t&&x._5A(t),x.hasOwnProperty("_82O")||(x._82O=function(){x.$super._82O.apply(this,arguments)}),x._82O.prototype=x,x.$super=this,x},_3A:function(){var K=this._80O();return K._82O.apply(K,arguments),K},_82O:function(){},_5A:function(v){for(var Q in v)v.hasOwnProperty(Q)&&(this[Q]=v[Q]);v.hasOwnProperty(xg)&&(this.toString=v.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),o=K._39O=V._80O({_82O:function(s,d){s=this._84O=s||[],this._65O=d!=R?d:4*s.length},toString:function(u){return(u||t).stringify(this)},_89O:function(f){var S=this._84O,R=f._84O,y=this._65O,N=f._65O;if(this._57O(),y%4)for(var C=0;N>C;C++){var Q=255&R[C>>>2]>>>24-8*(C%4);S[y+C>>>2]|=Q<<24-8*((y+C)%4)}else if(R.length>65535)for(var C=0;N>C;C+=4)S[y+C>>>2]=R[C>>>2];else S.push.apply(S,R);return this._65O+=N,this},_57O:function(){var s=this._84O,F=this._65O;s[F>>>2]&=4294967295<<32-8*(F%4),s.length=H(F/4)},_88O:function(){var K=V._88O.call(this);return K._84O=this._84O.slice(0),K},_87O:function(E){for(var l=[],S=0;E>S;S+=4)l.push(0|4294967296*w);return new o._82O(l,E)}}),p=d._2A={},t=p._69O={stringify:function(W){var Y,f=W._84O,y=W._65O,s=[];for(Y=0;y>Y;Y++){var R=255&f[Y>>>2]>>>24-8*(Y%4);s.push((R>>>4).toString(16)),s.push((15&R).toString(16))}return s.join("")},_68O:function(R){for(var M=R.length,r=[],Y=0;M>Y;Y+=2)r[Y>>>3]|=u(R.substr(Y,2),16)<<24-4*(Y%8);return new o._82O(r,M/2)}},L=p._8A={stringify:function(K){var X,x=K._84O,g=K._65O,A=[];for(X=0;g>X;X++){var r=255&x[X>>>2]>>>24-8*(X%4);A.push(Zo(r))}return A.join("")},_68O:function(z){var C,J=z.length,H=[];for(C=0;J>C;C++)H[C>>>2]|=(255&z.charCodeAt(C))<<24-8*(C%4);return new o._82O(H,J)}},A=p._9A={stringify:function(q){try{return decodeURIComponent(escape(L.stringify(q)))}catch(x){throw new Error("")}},_68O:function(z){return L._68O(unescape(encodeURIComponent(z)))}},f=K._32O=V._80O({_1A:function(){this._83O=new o._82O,this._23O=0},_33O:function(B){typeof B==Fi&&(B=A._68O(B)),this._83O._89O(B),this._23O+=B._65O},_25O:function(D){var z=this._83O,b=z._84O,q=z._65O,W=this._79O,y=4*W,O=q/y;O=D?H(O):$((0|O)-this._22O,0);var c=O*W,I=_(4*c,q);if(c){for(var v=0;c>v;v+=W)this._20O(b,v);var Q=b.splice(0,c);z._65O-=I}return new o._82O(Q,I)},_88O:function(){var Z=V._88O.call(this);return Z._83O=this._83O._88O(),Z},_22O:0});K._66O=f._80O({cfg:V._80O(),_82O:function(C){this.cfg=this.cfg._80O(C),this._1A()},_1A:function(){f._1A.call(this),this._34O()},_81O:function(P){return this._33O(P),this._25O(),this},_72O:function(B){B&&this._33O(B);var F=this._21O();return F},_79O:16,_26O:function(u){return function(n,p){return new u._82O(p)._72O(n)}},_19O:function(E){return function(X,f){return new S._71O._82O(E,f)._72O(X)}}});var S=d._67O={};return d}();!function(){var U=rd,s=U._7A,i=s._39O,x=s._66O,y=U._67O,F=[],v=[];!function(){function H(q){for(var J=k(q),Z=2;J>=Z;Z++)if(!(q%Z))return!1;return!0}function Y(b){return 0|4294967296*(b-(0|b))}for(var r=2,s=0;64>s;)H(r)&&(8>s&&(F[s]=Y(V(r,.5))),v[s]=Y(V(r,1/3)),s++),r++}();var N=[],W=y._41O=x._80O({_34O:function(){this._64O=new i._82O(F.slice(0))},_20O:function(i,$){for(var k=this._64O._84O,_=k[0],C=k[1],t=k[2],S=k[3],u=k[4],A=k[5],e=k[6],J=k[7],m=0;64>m;m++){if(16>m)N[m]=0|i[$+m];else{var V=N[m-15],b=(V<<25|V>>>7)^(V<<14|V>>>18)^V>>>3,O=N[m-2],B=(O<<15|O>>>17)^(O<<13|O>>>19)^O>>>10;N[m]=b+N[m-7]+B+N[m-16]}var H=u&A^~u&e,n=_&C^_&t^C&t,Q=(_<<30|_>>>2)^(_<<19|_>>>13)^(_<<10|_>>>22),Y=(u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25),f=J+Y+H+v[m]+N[m],R=Q+n;J=e,e=A,A=u,u=0|S+f,S=t,t=C,C=_,_=0|f+R}k[0]=0|k[0]+_,k[1]=0|k[1]+C,k[2]=0|k[2]+t,k[3]=0|k[3]+S,k[4]=0|k[4]+u,k[5]=0|k[5]+A,k[6]=0|k[6]+e,k[7]=0|k[7]+J},_21O:function(){var g=this._83O,s=g._84O,v=8*this._23O,M=8*g._65O;return s[M>>>5]|=128<<24-M%32,s[(M+64>>>9<<4)+14]=O(v/4294967296),s[(M+64>>>9<<4)+15]=v,g._65O=4*s.length,this._25O(),this._64O},_88O:function(){var h=x._88O.call(this);return h._64O=this._64O._88O(),h}});U._41O=x._26O(W),U._42O=x._19O(W)}();var db=new RegExp("");db.compile("[^0-9a-f]","gi"),Wq._28O=-1,Wq._29O=-2,me._31O=Cm,me._63O=Cm,Wq._43O=-2;var Qm=new function(){var v=this;v._5O=function(V,S){if("8"!=V.substring(S+2,S+3))return 1;var L=u(V.substring(S+3,S+4));return 0==L?-1:L>0&&10>L?L+1:-2},v._13O=function(H,X){var G=v._5O(H,X);return 1>G?"":H.substring(X+2,X+2+2*G)},v._12O=function(D,s){var l=v._13O(D,s);if(""==l)return-1;var Z;return Z=u(l.substring(0,1))<8?new L(l,16):new L(l.substring(2),16),Z._86O()},v._6O=function(_,n){var A=v._5O(_,n);return 0>A?A:n+2*(A+1)},v._11O=function(C,I){var s=v._6O(C,I),H=v._12O(C,I);return C.substring(s,s+2*H)},v._10O=function(r,o){var D=v._6O(r,o),i=v._12O(r,o);return D+2*i},v._7O=function(k,C){var t=[],V=v._6O(k,C);t.push(V);for(var R=v._12O(k,C),F=V,B=0;;){var s=v._10O(k,F);if(s==i||s-V>=2*R)break;if(B>=200)break;t.push(s),F=s,B++}return t}};if(Qm._90O=Zo(Cg+24),Qm._91O=E+Zo(Cg*Cg+8),io==i||!io)var io={};io._4O!=i&&io._4O||(io._4O={});var qs=io._4O;io._4O.Util=new function(){var z=this;z._56O=function(y){var b=new io._4O._3O;return b._30O(y)},z._4A=function(z){var P=new io._4O._3O;return P._36O(z)},z._11A=function(Q){var i=new qs._3O;return i._30O(Q)}},io._4O._3O=function(){var d=this;d._8O=function(f,o){if("ss"==f&&"cj"==o){try{d.md=rd._67O._41O._3A()}catch(R){ok(El)}d._24O=function(W){d.md._81O(W)},d._35O=function(W){var u=rd._2A._69O._68O(W);d.md._81O(u)},d._60O=function(){var b=d.md._72O();return b[xg](rd._2A._69O)},d._30O=function(v){return d._24O(v),d._60O()},d._36O=function(h){return d._35O(h),d._60O()}}},d._24O=function(){ok(El)},d._35O=function(){ok(El)},d._60O=function(){ok(El)},d._30O=function(){ok(El)},d._36O=function(){ok(El)},d._8O("ss","cj")},mo=function(D){var F=of[Nh[7]],f=1,C=!1;if(is.a!=of[wb])return is.a;if(is.forEach(function(R){f*=R}),D>f){if(F&&F[1]&&F[0]){var T=F[0],o=F[1];o=o.split(Qm._90O),T=T.split(Qm._90O);var c=o[3],i=T[3],G=o[7],b=o[11],l=o[15],Z=o[19],v=o[23],s=o[27],L=T[7],h=c+G+b+l+Z+v,a=v?!1:!0,z=i===c;if(v){var S=v&&v.split(yd("firefox")[3]);if(S)for(var r=0;r<S.length;r++){var _=S[r];if(_[0]===cr[8]&&(_=_.substring(1)),uq.indexOf(_)>=0){a=!0;break}}}C=z&&Jj()(i,L)&&Jj()(h,s)&&a&&(!Z||Z>D)}C||(Dd.prototype._42=dl)}else C=!0;return is.a=C,C},xk=String.fromCharCode(xk+20);var cs=function(g){return g=g.replace(db,El),g=g.replace(/[ \n]+/g,El)},qd="30",Gf="06",$c="02",Vj="03",Jm=tq,yh=/^1f+00/,Th=function(){var S;return S={_18O:function(N){var h=N,d=h.replace(/\s+/g,""),c=Xe(d);return c},_14O:function(C){var W=this._18O(C),w=this._15O(W);return w},_15O:function(f){var R=this._17O(f);if("2a864886f70d010101"==R._61O){var x=this._16O(R.key),r=new Wq;return r._38O(x.n,x.e),r}ok(El)},_16O:function(q){var F={};q.substr(0,2)!=qd&&ok(El);var J=Qm._7O(q,0);return 2!=J.length&&ok(El),q.substr(J[0],2)!=$c&&ok(El),F.n=Qm._11O(q,J[0]),q.substr(J[1],2)!=$c&&ok(El),F.e=Qm._11O(q,J[1]),F},_17O:function(m){var O={};O._40O=i;var n=Qm._7O(m,0);2!=n.length&&ok(El);var S=n[0];m.substr(S,2)!=qd&&ok(El);var u=Qm._7O(m,S);return 2!=u.length&&ok(El),m.substr(u[0],2)!=Gf&&ok(El),O._61O=Qm._11O(m,u[0]),m.substr(u[1],2)==Gf?O._40O=Qm._11O(m,u[1]):m.substr(u[1],2)==qd&&(O._40O={},O._40O.p=Qm._70O(m,u[1],[0],$c),O._40O.q=Qm._70O(m,u[1],[1],$c),O._40O.g=Qm._70O(m,u[1],[2],$c)),m.substr(n[1],2)!=Vj&&ok(El),O.key=Qm._11O(m,n[1]).substr(2),O}},S._17O?S:i}(),_b=Th._27O=function(c){return Th._14O(c)};Jj=function(){return function(e,T){if(e&&T){T=cs(T);var C=Jm(T,V(2,4)),k=this;if(!k||!k.n||C._55O()>k.n._55O())return 0;var j=k._37O(C),L=j[xg](V(2,4)).replace(yh,""),Q=nk(L);if(0==Q.length)return!1;var I=Q[0],c=Q[1],H=function(V){return io._4O.Util._56O(V,I)},t=H(e);return c==t}}.bind(_b(T))};var Wi,Yi;return function(){var _=sn.length-jb.length;if(_>0)for(var C=0;_>C;C++)Wi=qs.Util,Yi=cs}(),Er=function(Y,m){m=Yi(m);var U=_b(yn),Z=De.length,o=2*Z,N=Jm(m,V(Z,o)),F=U,l=!0;if(F){var k=F[Gi[0]];k&&N._55O()<=k._55O()&&(l=!1)}if(l)return 0;var D=F._37O(N),r=D[xg](V(Z,o)).replace(yh,""),n=nk(r);if(0==n.length)return!1;var h=n[0],J=n[1],R=Wi._11A(Y,h);return J==R},Th}(F,j),Ej(z,{load:function(){var x={},W=function(K){return K?"c_"+(K.sync?"1":"0")+"_"+(K.post?"1":"0")+"_"+(K.responseType||"H")+"_"+(K.mimeType||"H")+"_"+(K.data?JSON.stringify(K.data):"H"):""};return function(I,H,S){var d,k=x[I],X=W(S);return k&&(d=k[X])?(d.push(H),void 0):(x[I]||(k=x[I]={count:0}),d=k[X]=[H],k.count++,z.xhrLoad(I,function(e){delete k[X],k.count--,k.count||delete x[I],d.forEach(function(V){V(e)})},S),void 0)}}(),asyncEach:function(u,Q,l){"function"!=typeof l&&(l=Function.prototype);var g=new Array(u.length),C=0,w=!1;u.forEach(function(e,N){Q(e,function(i,m){return w?void 0:i?(w=!0,l(null)):(g[N]=m,C++,C===u.length?l(g):void 0)})})},xhrLoad:function(v,N,H){var d=!1;Qb(v)||(d=!0,v=[v]),H=H||{};var F=H.sync,b=null,j=H.method||"GET";return H.post&&(j="POST"),H.method=j,z.asyncEach(v,function(f,Y){var A=new Lr;f=z.beforeLoadURL(f),f.data?Y(null,f.data):(H.url=encodeURI(f),H.responseType?A.setResponseType(H.responseType):A.setOverrideMimeType(H.mimeType||"text/plain"),A.onload=function(){200===this.status||0===this.status?Y(null,A.getResponseText()):Y(!0)},A.onerror=function(){Y(!0)},A.send(H))},function(_){var Q="function"==typeof N;(Q||F)&&(b=d&&_?_[0]:_,Q&&N(b))}),F?b:void 0}});var Yi=r.List=function(){this._as=[];var o,q,L=arguments.length;if(1===L){var d=arguments[0];if(Bc(d)&&(d=d._as),Qb(d))for(q=d.length,o=0;q>o;o++)this._as.push(d[o]);else d!=i&&this._as.push(d)}else if(L>1)for(o=0;L>o;o++)this._as.push(arguments[o])};zr("List",j,{forEach:function(g,G){this.each(g,G)},push:function(){for(var A=0;A<arguments.length;A++)this.add(arguments[A])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(n,J){return J===s?this._as.push(n):this._as.splice(J,0,n)},addAll:function(L){Bc(L)&&(L=L._as),Qb(L)?ks(this._as,L):this._as.push(L)},get:function(m){return this._as[m]},slice:function(t,f){return new Yi(this._as.slice(t,f))},remove:function(w){var L=this._as.indexOf(w);return L>=0&&L<this._as.length&&this.removeAt(L),L},removeAt:function(y){return this._as.splice(y,1)[0]},set:function(G,y){return this._as[G]=y},clear:function(){return this._as.splice(0,this._as.length)},contains:function(S){return this._as.indexOf(S)>=0},indexOf:function(q){return this._as.indexOf(q)},each:function(f,V){for(var z=0,T=this._as.length;T>z;z++){var o=this._as[z];V?f.call(V,o,z,this):f(o,z,this)}},reverseEach:function(q,H){for(var F=this._as.length-1;F>=0;F--){var T=this._as[F];H?q.call(H,T):q(T)}},getArray:function(){return this._as},toArray:function(S,J){if(S){for(var U,M=[],O=0,Y=this._as.length;Y>O;O++)U=this._as[O],J?S.call(J,U)&&M.push(U):S(U)&&M.push(U);return M}return this._as.concat()},toList:function(p,o){if(p){for(var R,v=new Yi,G=0,D=this._as.length;D>G;G++)R=this._as[G],o?p.call(o,R)&&v.add(R):p(R)&&v.add(R);return v}return new Yi(this)},reverse:function(){this._as.reverse()},sort:function(q){return this._as.sort(q?q:_l),this},toString:function(){return this._as.toString()}}),j.defineProperties(Yi.prototype,{length:{get:function(){return this._as.length},set:function(M){this._as.length=M}}});var zi=new Yi;Ej(zi,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:$i,each:$i,reverseEach:$i,toArray:function(){return[]},toList:function(){return new Yi},add:Nn,addAll:Nn,set:Nn,remove:Nn,removeAt:Nn,clear:Nn});var gs=r.Notifier=function(){this._f=0};zr("Notifier",j,{contains:function(e,$){if(this._ls)for(var E,i=0,W=this._ls.size();W>i;i++)if(E=this._ls.get(i),e===E.l&&$===E.s)return!0;return!1},add:function(U,K,o){var L=this,W={l:U,s:K,a:o};L._ls||(L._ls=new Yi),L._f?(L._as||(L._as=new Yi),L._as.add(W)):W.a?L._ls.add(W,0):L._ls.add(W)},remove:function(P,Q){var s=this;s._ls&&(s._f?(s._rs||(s._rs=new Yi),s._rs.add({l:P,s:Q})):s._remove(P,Q))},_remove:function(Y,E){for(var z,m=this._ls,f=0,s=m.size();s>f;f++)if(z=m.get(f),z.l===Y&&z.s===E)return m.removeAt(f),void 0},fire:function(H){var u=this,F=u._ls;if(u._b=1e4,F){++u._f;try{for(var P,d=0,K=F.size();K>d;d++)P=F.get(d),P.s?P.l.call(P.s,H):P.l(H)}catch(H){e(function(){throw H})}finally{if(--u._f)return;if(u._rs){for(K=u._rs.size(),d=0;K>d;d++)P=u._rs.get(d),u._remove(P.l,P.s);delete u._rs}if(u._as){for(K=u._as.size(),d=0;K>d;d++)P=u._as.get(d),P.a?F.add(P,0):F.add(P);delete u._as}}}}});var El=r.Data=function(){this._id=xj()};zr("Data",j,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:i,_parent:i,_children:zi,_childMap:i,_styleMap:i,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return i},_22Q:function(){return i},s:function(Q,e){var F=this;if(2===arguments.length)F.setStyle(Q,e);else{if(!zo(Q))return F.getStyle(Q);for(var L in Q)F.setStyle(L,Q[L])}return F},fp:function(o,W,f,K,_){return this.firePropertyChange(o,W,f,K,_)},firePropertyChange:function(C,t,A,x,o){if(x){if(x(t,A))return!1}else if(t===A)return!1;var e=this,c=o||{};return c.property=C,c.oldValue=t,c.newValue=A,c.data=e,e._dataModel&&e._dataModel.handleDataPropertyChange(c),e.onPropertyChanged(c),!0},onPropertyChanged:function(K){var B=this,n=B._parent,s=K.property;if(xh(n)){var z=B.s($r),t="s:ingroup"===s;(z&&Cd[s]||s===t)&&n._81I(),(z||t)&&n.fp("childChange",!0,!1)}Sp(n)&&Cd[s]&&n.updateFromChildren()},_21I:function(I){var E=this;if(I&&E._dataModel)throw"Remove data from dataModel before adding";E._dataModel=I},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var b=0,S=this._children.toArray(),Z=S.length;Z>b;b++)S[b].removeFromDataModel()},getId:function(){return this._id},setId:function(D){this._id=D},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(x,J){return this._children.toList(x,J)},eachChild:function(g,K){this._children.each(g,K)},addChild:function(s,d){var A=this;s!==A&&(A._children===zi&&(A._children=new Yi,A._childMap={}),d>=0||(d=A._children.size()),A._childMap[s._id]||A.isDescendantOf(s)||(s._parent&&s._parent.removeChild(s),(0>d||d>A._children.size())&&(d=A._children.size()),A._children.add(s,d),A._childMap[s._id]=s,s.setParent(A),A.onChildAdded(s,d),A.fp(Ll,i,s)))},onChildAdded:function(){},removeChild:function(p){var A=this;if(A._childMap&&A._childMap[p._id]){var m=A._children.remove(p);delete A._childMap[p._id],A.fp(Ll,p,i),p.setParent(i,m),A.onChildRemoved(p,m)}},onChildRemoved:function(){},getChildAt:function(L){return this._children.get(L)},clearChildren:function(){var z=this;if(!z._children.isEmpty())for(var R=0,Y=z._children.toArray(),e=Y.length;e>R;R++)z.removeChild(Y[R])},getParent:function(){return this._parent},setParent:function(u,c){var N=this;if(!(N._73I||N._parent===u||N===u||u&&u.isDescendantOf(N))){var P,W=N._parent;N._parent=u,N._73I=1,W?(c==i&&(c=W.getChildren().indexOf(N)),W.removeChild(N)):N._dataModel&&c==i&&(c=N._dataModel.getRoots().indexOf(N)),u&&(u.addChild(N),P=u.getChildren().indexOf(N)),delete N._73I,N.fp("parent",W,u,s,{oldIndex:c,newIndex:P}),N.onParentChanged(W,u)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(c){return c?this.isDescendantOf(c)||c.isDescendantOf(this):!1},isParentOf:function(d){return d&&this._childMap?!!this._childMap[d._id]:!1},isDescendantOf:function(z){if(!z||z.isEmpty())return!1;for(var B=this._parent;B;){if(z===B)return!0;B=B._parent}return!1},getStyle:function(B,f){f===s&&(f=1);var W=this._styleMap?this._styleMap[B]:s;return W===s&&f?q[B]:W},setStyle:function(S,G){var o=this;o._styleMap||(o._styleMap={});var L=o._styleMap[S];G===s?delete o._styleMap[S]:o._styleMap[S]=G,o.fp("s:"+S,L,G)&&o.onStyleChanged(S,L,G)},onStyleChanged:function(){},iv:function(Z){this.invalidate(Z)},invalidate:function(C){this.fp(C||"*",!1,!0)},toString:function(){var d=this;return d._displayName||d._name||d._tag||d._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(c,J){var $=this,Z=$.s(Wj);Z||$.s(Wj,Z={}),J?Z[c]=J:delete Z[c],$.fp(Wj,i,Z)},removeStyleIcon:function(K){var E=this.s(Wj);if(E){var c=E[K];delete E[K],this.fp(Wj,i,E)}return c},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var N,U={};for(N in this._styleMap)U[N]=1;return U},getCurrentPrefix:function(){return this._interactPrefix||Om},ca:function(m,F){var G=this.getCurrentPrefix();return m=G+m,2===arguments.length?this.a(m,F):this.a(m)}});var Bs=r.DataModel=function(){var J=this;J._datas=new Yi,J._dataMap={},J._roots=new Yi,J._rootMap={},J._fsDataMap={},J._78O={},J._reflectorMap={},J._36I=new gs,J._35I=new gs,J._serializeNotifier=new gs,J._selectionModel=new um(J);var M=J._29Q=[],h=J._scheduleCallback=function(){for(var k=Date.now(),j=0;j<M.length;j++){var n=M[j];n.enabled&&k-n.lastTime>n.interval&&(n.beforeAction&&n.beforeAction(),n.action&&J.each(function(U){n.action(U)}),n.afterAction&&n.afterAction(),n.lastTime=k)}M.length&&(J._30Q=F.requestAnimationFrame(h))}};zr("DataModel",j,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:s,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:s,_init:s,_envmap:s,_postProcessingData:s,sm:function(){return this.getSelectionModel()},mm:function(f,K,B){this.addDataModelChangeListener(f,K,B)},umm:function(L,z){this.removeDataModelChangeListener(L,z)},md:function(E,X,x){this.addDataPropertyChangeListener(E,X,x)},umd:function(s,c){this.removeDataPropertyChangeListener(s,c)},mh:function(i,n,N){this.addHierarchyChangeListener(i,n,N)},umh:function(W,n){this.removeHierarchyChangeListener(W,n)},getAttrObject:function(){return this._attrObject},setAttrObject:function(B){return this._attrObject=B},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(p){return this._dataMap[p]},removeDataById:function(o){this.remove(this.getDataById(o))},toDatas:function(m,v){return this._datas.toList(m,v)},each:function(T,Q){this._datas.each(T,Q)},getDataByTag:function(z){return this._78O[z]},getTagMap:function(){return this._78O},removeDataByTag:function(n){this.remove(this.getDataByTag(n))},add:function(e,v,R){var b=this,Y=e._id,q=e._tag,U=b._roots;if(b._dataMap[Y])throw"'"+Y+"' already exists";q!=i&&(b._78O[q]=e),b._dataMap[Y]=e,R>=0?b._datas.add(e,R):b._datas.add(e),e._parent||(b._rootMap[Y]=e,v>=0?U.add(e,v):U.add(e)),e.s("fullscreen")!==s&&(b._fsDataMap[Y]=e),e.s("shape3d.reflector")&&(b._reflectorMap[Y]=e),e._21I(b),b.onAdded(e),b._36I.fire({kind:"add",data:e,rootsIndex:v,datasIndex:R})},onAdded:function(){},remove:function(F,C){if(F){var L=this,Q=F._id,M=C&&C.keepStructure,k=C&&C.keepChildren,P=F.getTag();if(F._dataModel===L){this.beginTransaction(),M?L._removingData||(L._removingData=F):L.prepareRemove(F),k||F.toChildren().each(function(o){L.remove(o,C)},L),M?L._removingData===F&&(F._parent&&F._parent.removeChild(F),delete L._removingData):F._parent&&F._parent.removeChild(F);var A=L._datas.remove(F);delete L._dataMap[Q],P!=i&&delete L._78O[P];var H;L._rootMap[Q]&&(delete L._rootMap[Q],H=L._roots.remove(F)),L._fsDataMap[Q]&&delete L._fsDataMap[Q],L._reflectorMap[Q]&&delete L._reflectorMap[Q],F._21I(i),L.onRemoved(F),L._36I.fire({kind:lb,data:F,rootsIndex:H,datasIndex:A}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var g=this;if(g._datas.size()){var K=g._historyManager?this.toJSON():s;g._datas.toArray().forEach(function(L){L._21I(i)}),g._datas.clear(),g._dataMap={},g._roots.clear(),g._rootMap={},g._fsDataMap={},g._reflectorMap={},g._78O={},g._36I.fire({kind:th,json:K})}},contains:function(h){return h&&h._dataModel===this},handleDataPropertyChange:function(Y){var o=this,q=Y.data,W=Y.property;if("parent"===W){var G=q._id,t=o._rootMap,n=o._roots;q._parent?t[G]&&(delete t[G],n.remove(q)):t[G]||(t[G]=q,n.add(q))}else if("tag"===W){var X=Y.oldValue,V=Y.newValue,M=o._78O;X!=i&&delete M[X],V!=i&&(M[V]=q)}else if("s:fullscreen"===W){var G=q._id,k=o._fsDataMap;Y.oldValue!=i&&delete k[G],Y.newValue!=i&&(k[G]=q)}else if("s:shape3d.reflector"===W){var G=q._id,I=o._reflectorMap;Y.oldValue&&delete I[G],Y.newValue&&(I[G]=q)}this.onDataPropertyChanged(q,Y),this._35I.fire(Y)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(z,q,s){this._36I.add(z,q,s)},removeDataModelChangeListener:function(h,_){this._36I.remove(h,_)},addSerializeListener:function(A,U,C){this._serializeNotifier.add(A,U,C)},removeSerializeListener:function(P,F){this._serializeNotifier.remove(P,F)},fireSerializeEvent:function(D){this._serializeNotifier.fire(D)},addDataPropertyChangeListener:function(j,n,h){this._35I.add(j,n,h)},removeDataPropertyChangeListener:function(d,l){this._35I.remove(d,l)},_38I:function(N,V,H){this._37I&&this._37I.fire({data:N,oldIndex:V,newIndex:H})},addHierarchyChangeListener:function(x,T,b){this._37I||(this._37I=new gs),this._37I.add(x,T,b)},removeHierarchyChangeListener:function(p,l){this._37I.remove(p,l)},getSiblings:function(K){var m=K._parent;return m?m._children:this._roots},eachByHierarchical:function(U,d,j){if(d)return this._eachByHierarchical(U,d,j);for(var u=0,B=this._roots,E=B.size();E>u;u++)if(this._eachByHierarchical(U,B.get(u),j)===!1)return!1;return!0},_eachByHierarchical:function(g,B,Z){if(Z){if(g.call(Z,B)===!1)return!1}else if(g(B)===!1)return!1;for(var V=B.size(),f=0;V>f;f++)if(this._eachByHierarchical(g,B.getChildAt(f),Z)===!1)return!1;return!0},reverseEachByHierarchical:function(s,o,b){if(o)return this._reverseEachByHierarchical(s,o,b);for(var B=this._roots,Y=B.size(),h=Y-1;h>=0;h--)if(this._reverseEachByHierarchical(s,B.get(h),b)===!1)return!1;return!0},_reverseEachByHierarchical:function(v,J,o){for(var s=J.size(),P=s-1;P>=0;P--)if(this._reverseEachByHierarchical(v,J.getChildAt(P),o)===!1)return!1;if(o){if(v.call(o,J)===!1)return!1}else if(v(J)===!1)return!1;return!0},eachByDepthFirst:function(h,M,k){if(M)return this._11I(h,M,k);for(var T=0,S=this._roots,D=S.size();D>T;T++)if(this._11I(h,S.get(T),k)===!1)return!1;return!0},_11I:function(m,x,f){for(var B=x.size(),_=0;B>_;_++)if(this._11I(m,x.getChildAt(_),f)===!1)return!1;if(f){if(m.call(f,x)===!1)return!1}else if(m(x)===!1)return!1;return!0},eachByBreadthFirst:function(u,G,M){var t=new Yi;for(G?t.add(G):this._roots.each(t.add,t);t.size()>0;)if(G=t.removeAt(0),G.eachChild(t.add,t),M){if(u.call(M,G)===!1)return!1}else if(u(G)===!1)return!1;return!0},moveTo:function(A,H){var T=this.getSiblings(A),B=T.indexOf(A);B===H||0>B||H>=0&&H<=T.size()&&(T.remove(A),H>T.size()&&H--,T.add(A,H),this._38I(A,B,H))},moveUp:function(Y){this.moveTo(Y,this.getSiblings(Y).indexOf(Y)-1)},moveDown:function(l){this.moveTo(l,this.getSiblings(l).indexOf(l)+1)},moveToTop:function(y){this.moveTo(y,0)},moveToBottom:function(l){this.moveTo(l,this.getSiblings(l).size())},moveSelectionUp:function(L){this.beginTransaction(),L||(L=this.sm());var A=new Yi;cl(L,A,this._roots),A.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(h){this.beginTransaction(),h||(h=this.sm());var n=new Yi;Hb(h,n,this._roots),n.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(v){this.beginTransaction(),v||(v=this.sm());var a=new Yi;fm(v,a,this._roots),a.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(e){this.beginTransaction(),e||(e=this.sm());var d=new Yi;Oq(e,d,this._roots),d.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(f,G,N){var q=this.getDatas();null==N&&(N=q.indexOf(f)),N===G||0>N||G>=0&&G<=q.size()&&(q.remove(f),G>q.size()&&G--,q.add(f,G),this._76I(f,N,G))},bringForward:function(E){this.moveToIndex(E,this.getDatas().indexOf(E)+1)},bringToFront:function(i){this.moveToIndex(i,this.size())},sendBackward:function(l){this.moveToIndex(l,this.getDatas().indexOf(l)-1)},sendToBack:function(L){this.moveToIndex(L,0)},bringSelectionForward:function(v){this.beginTransaction(),v||(v=this.sm());for(var c=new Yi,l=this.getDatas(),V=!1,u=0;u<l.size();u++){var I=l.get(l.size()-1-u);v.contains(I)?V&&c.add(I):V=!0}c.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(g){this.beginTransaction(),g||(g=this.sm());for(var z=new Yi,h=this.getDatas(),X=0;X<h.size();X++){var x=h.get(X);g.contains(x)&&z.add(x)}z.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(x){this.beginTransaction(),x||(x=this.sm());for(var l=new Yi,M=this.getDatas(),k=!1,V=0;V<M.size();V++){var Y=M.get(V);x.contains(Y)?k&&l.add(Y):k=!0}l.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(r){this.beginTransaction(),r||(r=this.sm());for(var $=new Yi,R=this.getDatas(),v=0;v<R.size();v++){var W=R.get(R.size()-1-v);r.contains(W)&&$.add(W)}$.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(p){var Z=this;Z.removeScheduleTask(p),p.enabled==i&&(p.enabled=!0),p.interval==i&&(p.interval=10),p.lastTime=Date.now(),Z._29Q.push(p),Z._30Q==i&&(Z._30Q=F.requestAnimationFrame(Z._scheduleCallback))},removeScheduleTask:function(J){var E=this,v=E._29Q,m=v.indexOf(J);m>=0&&v.splice(m,1),v.length||E._30Q==i||(F.cancelAnimationFrame(E._30Q),delete E._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(D){this._historyManager||new r.HistoryManager(this),null!=D&&this._historyManager.setMaxHistoryCount(D),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(f){this._historyManager&&this._historyManager.undo(f)},redo:function(L){this._historyManager&&this._historyManager.redo(L)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(d){this._historyManager&&this._historyManager.addHistory(d)},onHistoryManagerChanged:function(){}});var um=r.SelectionModel=function(J){var e=this;e._68O=rl,e._map={},e._73O=new Yi,e._74I=new gs,e._21I(J)};zr("SelectionModel",j,{ms_fire:1,ms_dm:1,ms:function(W,Y,G){this.addSelectionChangeListener(W,Y,G)},ums:function(e,E){this.removeSelectionChangeListener(e,E)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===vl},co:function(W){return this._map[W._id]!=i},ss:function(h){this.setSelection(h)},as:function(c){this.appendSelection(c)},rs:function(e){this.removeSelection(e)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(u){var y=this;if(y._68O!==u&&(u===Gi||u===vl||u===rl)){y.cs();var S=y._68O;y._68O=u,y.fp("selectionMode",S,u)}},_21I:function(U){var J=this,c=J._dataModel;c!==U&&(c&&(J.cs(),c.umm(J.handleDataModelChange,J)),J._dataModel=U,U.mm(J.handleDataModelChange,J,!0),J.fp(so,c,U))},dispose:function(){var w=this;w.cs(),w._dataModel.umm(w.handleDataModelChange,w)},handleDataModelChange:function(C){var z=this;if(C.kind===lb){var E=C.data;z.co(E)&&(z._73O.remove(E),delete z._map[E._id],z._75I(lb,new Yi(E)))}else C.kind===th&&z.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(E){var o=this;if(o._filterFunc!==E){o.cs();var j=o._filterFunc;o._filterFunc=E,o.fp("filterFunc",j,o._filterFunc)}},_75I:function(A,V,n,a){n&&(this._73O.each(function(f){a[f._id]?n.remove(f):n.add(f)}),V=n.toList()),this._74I.fire({kind:A,datas:new Yi(V)})},addSelectionChangeListener:function(v,u,F){this._74I.add(v,u,F)},removeSelectionChangeListener:function(V,v){this._74I.remove(V,v)},_97O:function(I,P){for(var u,g=this,S=0,h=new Yi(I);S<h.size();S++)u=h.get(S),(g._filterFunc&&!g._filterFunc(u)||P&&g.co(u)||!P&&!g.co(u)||!g._dataModel.contains(u))&&(h.removeAt(S),S--);return h},appendSelection:function(t){var g=this;if(g._68O!==Gi){var Z,n,A=g._73O,f=g._97O(t,!0);f.isEmpty()||(g.sg()&&(Z=new Yi(A),n=g._map,A.clear(),g._map={},f=new Yi(f.get(f.size()-1))),f.each(function(S){A.add(S),g._map[S._id]=S}),g._75I("append",f,Z,n))}},removeSelection:function(w){var P=this,R=P._97O(w),T=0,h=R.size();if(0!==h){for(;h>T;T++){var V=R.get(T);P._73O.remove(V),delete P._map[V._id]}P._75I(lb,R)}},toSelection:function(R,A){return this._73O.toList(R,A)},getSelection:function(){return this._73O},each:function(f,z){this._73O.each(f,z)},setSelection:function(v){var _=this,j=_._73O;if(_._68O!==Gi&&!(j.isEmpty()&&!v||1===j.size()&&_.ld()===v)){var u=new Yi(j),h=_._map;j.clear(),_._map={};var g=_._97O(v,!0);_.sg()&&g.size()>1&&(g=new Yi(g.get(g.size()-1))),g.each(function(V){j.add(V),_._map[V._id]=V}),_._75I("set",i,u,h)}},clearSelection:function(){var m=this,k=m._73O;if(k.size()>0){var B=k.toList();k.clear(),m._map={},m._75I(th,B)}},selectAll:function(){var A=this;if(A._68O!==Gi){var b,r,L=A._dataModel.toDatas();if(A._filterFunc)for(b=0;b<L.size();b++)r=L.get(b),A._filterFunc(r)||(L.removeAt(b),b--);var U=A._73O,Q=new Yi(U),B=A._map;U.clear(),A._map={},A.sg()&&L.size()>1&&(L=new Yi(L.get(L.size()-1)));var E=L.size();for(b=0;E>b;b++)r=L.get(b),U.add(r),A._map[r._id]=r;A._75I("all",i,Q,B)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(b){return this._map[b._id]!=i},getLastData:function(){var t=this._73O;return t.size()>0?t.get(t.size()-1):i},getFirstData:function(){var S=this._73O;return S.size()>0?S.get(0):i
},isSelectable:function(Z){var d=this;return Z&&d._68O!==Gi?d._filterFunc?d._filterFunc(Z):!0:!1},getTopSelection:function(){var G=this,R=new Yi;return G._73O.each(function(z){for(var C=z.getParent();C;){if(G.contains(C)){z=i;break}C=C.parent}z&&R.add(z)}),R}});var zk=function(){return Ai(0),function(h,H){var G;if(Pn(H)){var a=h.getDataUI(H);a&&a._88I&&(G=a._88I.rect)}return G?G:H.getRect()}}();Ej(z,{edgeGroupAgentFunc:i,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:f.rectSelectBorder,graphViewRectSelectBackground:Dc,graphViewEditPointSize:Aj?17:7,graphViewEditPointBorderColor:f.editPointBorder,graphViewEditPointBackground:f.editPointBackground,setEdgeType:function(Q,M,s){Yo[Q]=M,sp[Q]=s},getEdgeType:function(v){return Yo[v]},getEdgeTypeMap:function(){return Yo},getNodeRect:zk},!0),Ej(q,{"layout.h":s,"layout.v":s,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":s,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:s,ingroup:!0,"body.color":s,"2d.gray":!1,fullscreen:s,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:s,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":Cn,"select.width":1,"select.padding":2,"select.type":kk,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":s,"border.width":2,"border.padding":2,"border.type":kk,label:s,"label.font":s,"label.color":Xi,"label.background":s,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":s,"label.max":s,"label.opacity":s,"label.scale":1,"label.align":s,"label.selectable":!0,label2:s,"label2.font":s,"label2.color":Xi,"label2.background":s,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":s,"label2.max":s,"label2.opacity":s,"label2.scale":1,"label2.align":s,"label2.selectable":!0,note:s,"note.expanded":!0,"note.font":s,"note.color":sj,"note.background":Cn,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":s,"note.toggleable":!0,"note.border.width":1,"note.border.color":s,"note.opacity":s,"note.scale":1,"note.align":s,note2:s,"note2.expanded":!0,"note2.font":s,"note2.color":sj,"note2.background":Cn,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":s,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":s,"note2.opacity":s,"note2.scale":1,"note2.align":s,"group.type":s,"group.image":s,"group.image.stretch":"fill","group.repeat.image":s,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":s,"group.title.color":sj,"group.title.background":f.groupTitleBackground,"group.title.align":br,"group.title.orientation":bm,"group.background":f.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":s,"group.border.color":Wd,"group.border.radius":0,"group.border.cap":Vo,"group.border.join":Pj,"group.splitLine":!1,"group.gradient":i,"group.gradient.color":"#FFF",shape:s,"shape.background":Wd,"shape.repeat.image":s,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Wd,"shape.border.3d":!1,"shape.border.3d.color":s,"shape.border.3d.accuracy":s,"shape.border.cap":Vo,"shape.border.join":Pj,"shape.border.pattern":s,"shape.gradient":i,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":Co,"shape.dash.offset":0,"shape.dash.color":Vp,"shape.dash.width":s,"shape.dash.3d":!1,"shape.dash.3d.color":s,"shape.dash.3d.accuracy":s,"shape.polygon.side":6,"shape.arc.from":J,"shape.arc.to":b,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":s,"shape.gradient.pack":s,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":s,"shape.foreground.gradient":i,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":s,"autolayout.hgap":s,"autolayout.vgap":s,"edge.type":s,"edge.points":s,"edge.segments":s,"edge.color":Wd,"edge.width":2,"edge.width.absolute":!1,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":s,"edge.3d.accuracy":s,"edge.cap":Vo,"edge.join":Pj,"edge.source.position":17,"edge.source.anchor.x":s,"edge.source.anchor.y":s,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":s,"edge.target.anchor.y":s,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":s,"edge.dash":!1,"edge.dash.pattern":Co,"edge.dash.offset":0,"edge.dash.color":Vp,"edge.dash.width":s,"edge.dash.3d":!1,"edge.dash.3d.color":s,"edge.dash.3d.accuracy":s,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":s,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":s,"grid.column.percents":s,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":f.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":f.gridCellBorderColor,"grid.block":s,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":f.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Xi,"text.font":Sh,"text.shadow":!1,"text.shadow.color":Cn,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,_62O:s},!0),Ej(Bs,{_76I:function(f,Y,z){this._39I&&this._39I.fire({data:f,oldIndex:Y,newIndex:z})},addIndexChangeListener:function(Z,u,Q){var g=this;g._39I||(g._39I=new gs),g._39I.add(Z,u,Q)},removeIndexChangeListener:function(Z,y){this._39I.remove(Z,y)},prepareRemove:function(l){Cc(l)&&(l.setSource(i),l.setTarget(i)),l._70O&&l._70O.toList().each(this.remove,this),l._69O&&l._69O.toList().each(function(Y){Y.setHost(i)}),l._host&&l.setHost(i)},onAdded:function(b){this.isAutoAdjustIndex()&&this.adjustIndex(b)},onDataPropertyChanged:function(x,A){Jm[A.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(x)},isAdjustable:function(B){return gj(B)||Cc(B)},isAdjustedToBottom:function(N){return xh(N)?N.isExpanded()&&Dk(N):!1},adjustIndex:function(V){var T=this;this.isHierarchicalRendering()||(T.isAdjustedToBottom(V)?(T.sendToBottom(V),V.eachChild(T.adjustIndex,T)):T.sendToTop(V))},sendToTop:function(o){var v=this;if(v.contains(o)&&v.isAdjustable(o)){var O=v._datas;if(o!==O.get(v.size()-1)){var s=O.indexOf(o);O.removeAt(s),O.add(o),v._76I(o,s,v.size()-1)}if(Cc(o)){var b=o._40I;b&&!v.isAdjustedToBottom(b)&&v.sendToTop(b),b=o._41I,b&&!v.isAdjustedToBottom(b)&&v.sendToTop(b)}o._69O&&o._69O.each(function(g){g.isRelatedTo(o)||gj(o)&&g.isLoopedHostOn(o)||v.sendToTop(g)}),o.ISubGraph||(!xh(o)||o.isExpanded())&&o._adjustChildrenToTop&&o.eachChild(function(r){Cc(r)||v.sendToTop(r)})}},sendToBottom:function(K,e){var v=this;if(K!==e&&v.contains(K)&&v.isAdjustable(K)&&(!e||v.contains(e))){var Q=v._datas,m=Q.remove(K),i=e?v._datas.indexOf(e):0;if(Q.add(K,i),m!==i){v._76I(K,m,i);var z=K._parent;!z||z.ISubGraph||Cc(z)||v.sendToBottom(K._parent,K)}}}}),Ej(Re,{ms_edit:function(Z){Z._46O=function(v){var j=this,L=j.gv.dm(),h=j._index,y=j._89I,f=j._node,Z=j._shape,r=j._edge,I=j._77I;f&&y?(this.fi({kind:"endEditRect",event:v,data:f,direction:y}),L.endTransaction()):Z&&h>=0?(j.fi({kind:"endEditPoint",event:v,data:Z,index:h}),L.endTransaction()):r&&h>=0?(j.fi({kind:"endEditPoint",event:v,data:r,index:h}),L.endTransaction()):I&&(j.fi({kind:"endEditRotation",event:v,data:I}),L.endTransaction())},Z._78I=function(O){var f=this;f.autoScroll(O);var p=f.gv.lp(O),o=f._index,d=f._89I,s=f._node,b=f._shape,h=f._edge,a=f._77I;if(s&&d)f._80O(p),f.fi({kind:"betweenEditRect",event:O,data:s,direction:d});else if(b&&o>=0)p.e=b.getPoints().get(o).e,b.setPoint(o,p),f.fi({kind:"betweenEditPoint",event:O,data:b,index:o});else if(h&&o>=0){var V=h.s(yf);p.e=V.get(o).e,V.set(o,p),h.fp(yf,i,V),f.fi({kind:"betweenEditPoint",event:O,data:h,index:o})}else if(a){var S=a.p(),k=a.getScale(),Z=L+K(p.y-S.y,p.x-S.x);k.y<0&&(Z+=J),R(Z)<.04&&(Z=0),a.setRotation(Z),f.fi({kind:"betweenEditRotation",event:O,data:a})}},Z._80O=function(p){var m=this,_=m._node,F=m._rect,v=F.x,K=F.y,i=F.width,n=F.height,k=m._89I,w=m._anchor,T=m._matrix,p=T.tfi(p);"northwest"===k?F=xn(p,{x:v+i,y:K+n}):k===Br?F=xn({x:v,y:p.y},{x:v+i,y:K+n}):"northeast"===k?F=xn({x:v,y:p.y},{x:p.x,y:K+n}):k===ds?F=xn({x:p.x,y:K},{x:v+i,y:K+n}):k===Eh?F=xn({x:v,y:K},{x:p.x,y:K+n}):"southwest"===k?F=xn({x:p.x,y:K},{x:v+i,y:p.y}):"south"===k?F=xn({x:v,y:K},{x:v+i,y:p.y}):"southeast"===k&&(F=xn({x:v,y:K},p)),_.setPosition(T.tf(F.x+F.width*w.x,F.y+F.height*w.y)),_.setWidth(F.width),_.setHeight(F.height)},Z._80I=function(P,O,S,m){var Z=this,V=Z.gv._zoom,g=(Z.gv.getEditPointSize()+2)/V;return oh({x:O-g/2,y:S-g/2,width:g,height:g},P)?(Z._89I!==m&&(Z._89I=m),!0):!1},Z._79I=function(m,N,q){var t=this,I=t.gv,$=N?I.getDataUI(N):i,Q=$?$._55O:i;if(Q){var y,f,o,s,e=I._zoom,O=(I.getEditPointSize()+2)/e,K=I.lp(m);if(gj(N)){if(Q._56O&&gj(N)&&(f=Q._98o,oh({x:f.x-O/2,y:f.y-O/2,width:O,height:O},K)))return t._77I=N,q&&t.fi({kind:"beginEditRotation",event:m,data:N}),t.setCursor("crosshair"),!0;if(Q._43O&&N instanceof yg)for(o=N.getPoints(),y=o.size()-1;y>=0;y--)if(f=o.get(y),oh({x:f.x-O/2,y:f.y-O/2,width:O,height:O},K))return t._index=y,t._shape=N,q&&t.fi({kind:"beginEditPoint",event:m,data:N,index:y}),t.setCursor("crosshair"),!0;if(Q._42O)for(var R=N.getEditControlPoints(),d=["northwest",-1,-1,ds,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Eh,1,0,"northeast",1,-1,Br,0,-1],y=0,s=R.length;s>y;y++){var p=d[3*y],Y=R[y];if(t._80I(K,Y.x,Y.y,p)){t._node=N;var W=N.getWidth(),P=N.getHeight(),b=N.getAnchor();t._rect={x:-W*b.x,y:-P*b.y,width:W,height:P},t._anchor=b,t._matrix=N.getMatrix();var x=N.getRotation(),M=X(x),T=U(x),B=d[3*y+1]*Am(N.getScale().x),c=d[3*y+2]*Am(N.getScale().y),V=Math.atan2(-T*B-M*c,M*B-T*c),w=(Math.round(V/(Math.PI/4))+8)%8,D=[ko,"nesw-resize",wd,"nwse-resize",ko,"nesw-resize",wd,"nwse-resize"][w];return t.setCursor(D),q&&t.fi({kind:"beginEditRect",event:m,data:N,direction:t._89I}),!0}}}if(Q._43O&&Cc(N)&&N.s($o)===hb&&(o=N.s(yf)))for(y=o.size()-1;y>=0;y--)if(f=o.get(y),oh({x:f.x-O/2,y:f.y-O/2,width:O,height:O},K))return t._index=y,t._edge=N,q&&t.fi({kind:"beginEditPoint",event:m,data:N,index:y}),t.setCursor("crosshair"),!0}return!1}},ms_gv:function(Y){Y._currentSubGraph=i,Y._fpsInfo={time:0,fps:0,frames:0},Y.upSubGraph=function(){this.setCurrentSubGraph(bn(this._currentSubGraph))},Y.isVisible=function(t){var x=this;if(bn(t)!==x._currentSubGraph)return!1;if(Cc(t)){var M=t._40I,$=t._41I;if(!M||!$)return!1;if(!(t.s("edge.independent")||x.isVisible(M)&&x.isVisible($)))return!1;if(t.isEdgeGroupHidden())return!1}else for(var Q=t._parent;Q&&!Q.ISubGraph;){if(xh(Q)&&(!Q.isExpanded()||!x.isVisible(Q)))return!1;Q=Q._parent}if(t._parent instanceof Mb&&!x.isVisible(t._parent))return!1;if(t._refGraph instanceof Ti&&!x.isVisible(t._refGraph))return!1;if(x instanceof rp){if(!t.s("3d.visible"))return!1}else{var C=x.getLayersInfo();if(C){var L=C[t._layer];if(L&&L.visible===!1)return!1}if(!t.s("2d.visible"))return!1}return x._visibleFunc?x._visibleFunc(t):!0},Y.handleSelectionChange=function(q){var N=this;q.datas.each(function(V){N.invalidateData(V);var A=V._parent;xh(A)&&gj(V)&&V.s($r)&&(N.invalidateData(A),A._49I&&A._49I.each(function(g){N.invalidateData(g)}))}),N.onSelectionChanged(q)},Y.onSelectionChanged=function(R){var j=this,m=j.sm();if(1===m.size()&&("set"===R.kind||"append"===R.kind)){var u=m.ld();j.isAutoMakeVisible()&&j.makeVisible(u),j.adjustIndex&&j._dataModel.isAutoAdjustIndex()&&j.adjustIndex(u)}},Y.makeVisible=function(Z){if(Z){var V=this,d=V.getDataUI?V.getDataUI(Z):V.getData3dUI(Z);if(d){var $=Z,X=bn(Z);for(X!==V._currentSubGraph&&V.setCurrentSubGraph(X);($=$._parent)&&$!==X;)xh($)&&$.setExpanded(!0);V._23I=Z,V.iv()}}},Y.getLabel=function(k){var P=k.getStyle(Kr);return P===s?k.getName():P},Y.getLabelBackground=function(l){return l.getStyle("label.background")},Y.getLabelColor=function(E){return E.getStyle("label.color")},Y.getLabel2=function(n){return n.getStyle("label2")},Y.getLabel2Background=function(Z){return Z.getStyle("label2.background")},Y.getLabel2Color=function(A){return A.getStyle("label2.color")},Y.getNote=function(s){return s.getStyle(ol)},Y.getNoteBackground=function(_){return _.getStyle("note.background")},Y.getNote2=function(Z){return Z.getStyle(Al)},Y.getNote2Background=function(H){return H.getStyle("note2.background")},Y.handleClick=function(E,Q,L){var F=this;Q?(F.fi({kind:"clickData",event:E,data:Q,part:L}),F.onDataClicked(Q,E)):(F.fi({kind:"clickBackground",event:E}),F.onBackgroundClicked(E))},Y.handleDoubleClick=function(R,y,e){var c=this;pn(R)&&(y?(c.fi({kind:"doubleClickData",event:R,data:y,part:e}),c.onDataDoubleClicked(y,R,e),c.checkDoubleClickOnNote(R,y,e)||c.checkDoubleClickOnRotation&&c.checkDoubleClickOnRotation(R,y,e)||(Cc(y)?c.onEdgeDoubleClicked(y,R,e):y.ISubGraph?c.onSubGraphDoubleClicked(y,R,e):xh(y)?c.onGroupDoubleClicked(y,R,e):y.IDoorWindow?c.onDoorWindowDoubleClicked(y,R,e):y.ICSGBox&&c.onCSGBoxDoubleClicked(y,R,e))):(c.fi({kind:"doubleClickBackground",event:R}),c.onBackgroundDoubleClicked(R)))},Y.onSubGraphDoubleClicked=function(y){this.setCurrentSubGraph(y)},Y.onEdgeDoubleClicked=function(L,_){L.ISubGraph&&!Th(_)?this.setCurrentSubGraph(L):L.s("edge.toggleable")&&L.toggle()},Y._39Q=function(D){return this.isInteractive(D)?this.preventDefaultWhenInteractive(D):!1},Y.preventDefaultWhenInteractive=function(t){return t.s("preventDefaultWhenInteractive")},Y.onGroupDoubleClicked=function(i){i.s("group.toggleable")&&i.toggle()},Y.onDoorWindowDoubleClicked=function(n){n.s("dw.toggleable")&&n.toggle(!0)},Y.onCSGBoxDoubleClicked=function(h,t){var P=this;if(P instanceof rp){var s=P.getHitFaceInfo(t);s&&s.face&&h.s(s.face+".toggleable")&&h.toggleFace(s.face,!0)}},Y.onBackgroundClicked=function(){},Y.onBackgroundDoubleClicked=function(){this.upSubGraph()},Y.onDataClicked=function(){},Y.onDataDoubleClicked=function(){},Y.onAutoLayoutEnded=function(){},Y.onMoveEnded=function(){},Y.onPanEnded=function(){},Y.onPinchEnded=function(){},Y.onRectSelectEnded=function(){},Y.onZoomEnded=function(){},Y.serialize=function(B){return this.dm().serialize(B)},Y.toJSON=function(){return this.dm().toJSON()},Y.deserialize=function(R,d){var L=this;d=d instanceof El?{rootParent:d}:Zo(d)?{setId:d}:Nf(d)?{finishFunc:d}:d||{},d.view=L;var o=L.dm(),w=d.finishFunc;return d.finishFunc=function(){w&&w.apply(d,arguments),Zo(o.a("zoomable"))&&L.setZoomable&&L.setZoomable(o.a("zoomable")),Zo(o.a("pannable"))&&L.setPannable&&L.setPannable(o.a("pannable")),Zo(o.a("rectSelectable"))&&L.setRectSelectable&&L.setRectSelectable(o.a("rectSelectable")),o.a("fitContent")===!0&&L.fitContent&&L.fitContent(!0,0)},o.deserialize(R,d.rootParent,d)},Y.showDebugTip=function(){var q=this,a=q._debugDiv;if(!a){a=q._debugDiv=B.createElement("div"),a.style.position="absolute",a.style.overflow="hidden",a.style.backgroundColor="white",a.style.color="black";var p=q.getView();q._79O?p.insertBefore(a,q._79O):p.appendChild(a);var U=function(){q.redraw();var N=q._canvas,f="FPS : "+q._fpsInfo.fps+"<br/>"+"Datas : "+q.dm().getDatas().length+(N?"<br/>Size : "+N.width+" * "+N.height:""),t=q.getDebugTip();t&&(f+="<br/>------<br/>"+t),a.innerHTML=f,q._isDebugging&&requestAnimationFrame(U)};requestAnimationFrame(U),q._isDebugging=!0}},Y.hideDebugTip=function(){var V=this,Q=V._debugDiv;Q&&(delete V._debugDiv,V.getView().removeChild(Q),V._isDebugging=!1)},Y.updateDOMAppendMatrix=function(){var F=this.getView();F&&(F.updateAppendMatrix=!0)},Y.countFrame=function(){if(this._isDebugging){var v=Date.now(),n=this._fpsInfo;v-n.time>1e3?(n.fps=Math.round(1e5*(n.frames+1)/(v-n.time))/100,n.time=v,n.frames=0):n.frames++}}},ms_icons:function(d){d.getRotation=function(m){return m==i?0:m},d._15O=function(){var q=this,Y=q.s(Wj);if(Y){var w=q,S=q.data||q._data,M=q._38o={icons:Y,rects:{}};for(var s in Y){var D=Y[s],c=gf(D.shape3d,S,w);if(!(gf(D.visible,S,w)===!1||gf(D.for3d,S,w)&&!q.I3d||c&&!q.I3d)){var Q=c?[c]:gf(D.names,S,w),o=Q?Q.length:0,j=gf(D.position,S,w)||3,u=gf(D.offsetX,S,w)||0,e=gf(D.offsetY,S,w)||0,m=gf(D.direction,S,w)||Eh,G=gf(D.gap,S,w),b=G!=i?G:1,g=gf(D.rotation,S,w),B=gf(D.keepOrien,S,w),r=gf(D.rotationFixed,S,w)?g:q.getRotation(g,B,j),W=i,z=M.rects[s]=new Array(o);z.rotation=r;for(var I=0;o>I;I++){var d,R,F,E,t=Q[I];if(c)F=0,E=0;else{var h=Ij(t);F=gf(D.width,S,w),E=gf(D.height,S,w),F==i&&(F=gq(h,S)),E==i&&(E=eo(h,S))}if(W?m===Eh?u+=F/2:m===ds?u-=F/2:m===Br?e-=E/2:e+=E/2:W={width:F,height:E},q.I3d){var p=-F/2,a=-E/2;R={width:F,height:E,mat:q._16O(gf(D.autorotate,S,w),j,W,gf(D.face,S,w)||wg,gf(D.t3,S,w),gf(D.r3,S,w),gf(D.rotationMode,S,w),u,e),vs:new $g([p,-a,0,p,-a-E,0,p+F,-a-E,0,p+F,-a,0])}}else d=q.getPosition(j,u,e,W,gf(D.positionFixed,S,w)),R={x:d.x-F/2,y:d.y-E/2,width:F,height:E},q._68o(R,r);z[I]=R,m===Eh?u+=F/2+b:m===ds?u-=F/2+b:m===Br?e-=E/2+b:e+=E/2+b}}}}}}});var Gc={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},lg={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},xc={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Jm={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Cd={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Pp={"edge.type":1,"edge.group":1},Gk={rotation:1,rotationX:1,rotationZ:1},ym={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Bf={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},pb={shape:1,thickness:1,position:1,anchor:1,scale:1},bn=function(I){if(!I)return i;if(Cc(I)){var F=I._40I,j=I._41I;if(!F||!j)return i;var G=bn(F),R=bn(j);return G===R?G:i}for(var c=I._parent;Cc(c)&&!c.ISubGraph;)c=c._parent;return c?c.ISubGraph?c:bn(c):i},fo=function(Y,I,O,V){var Q=I.getStyle(O)*V;Q&&Lg(Y,Q),Q=I.getStyle(O+".left")*V,Q&&(Y.x-=Q,Y.width+=Q),Q=I.getStyle(O+".right")*V,Q&&(Y.width+=Q),Q=I.getStyle(O+".top")*V,Q&&(Y.y-=Q,Y.height+=Q),Q=I.getStyle(O+".bottom")*V,Q&&(Y.height+=Q),Y.width<0&&(Y.width=-Y.width,Y.x-=Y.width),Y.height<0&&(Y.height=-Y.height,Y.y-=Y.height)},Dk=function(R){for(var m,b=0,Y=R.size();Y>b;b++)if(m=R.getChildAt(b),gj(m)&&Dk(m))return!0;return R.hasAgentEdges()},tr=function(G){if(!G)return i;for(var w=G._parent;xh(w);){if(!xh(w._parent))return w.isExpanded()?G:w;w.isExpanded()||(G=w),w=w._parent}return G},_k=function(h,B){if(!h||!B)return i;var j,v,T,y=bn(h),J=bn(B);if(y!==J){for(;J&&y!==J;)J=bn(J);if(y===J)return h;j=new Yi,j.add(h,0);for(var F=h._parent;gj(F)&&!B.isDescendantOf(F);)j.add(F,0),F=F._parent;for(T=j.size(),v=0;T>v;v++){var g=j.get(v);if(xh(g)&&!g.isExpanded())return g;if(g.ISubGraph)return g}return h}return h},Ib=function(m){if(m.isLooped())return m._source;var G=tr(m._source),j=tr(m._target);return G===j?m._source:_k(G,j)},pp=function(q){if(q.isLooped())return q._target;var H=tr(q._source),x=tr(q._target);return H===x?q._target:_k(x,H)},gp=function(e,o,f){"target"!==f&&(f="source");var v="target"===f?o.getTargetAgent():o.getSourceAgent(),d="edge."+f+".";if(Cc(v)){var W=e.getDataUI(v);W._79o();var P=o.s(d+"index");if(P!==s){var Q=Yj(W);return Q[Math.max(0,Math.min(P,Q.length-1))]}var V=o.s(d+"percent")||0;V=Math.max(0,Math.min(V,1));var k=yo(W);return ts(k,100*V)}return os(e,v,o.s(d+"position"),o.s(d+"offset.x"),o.s(d+"offset.y"),o.s(d+"anchor.x"),o.s(d+"anchor.y"))},os=function(M,t,T,v,P,Q,u){if(!t)return i;var x,D=t.getRotation?t.getRotation():0;if(Q!==s||u!==s){Q=Q===s?.5:Q,u=u===s?.5:u;var N=t.getScale();if(D&&!Pn(t,M)||N.x<0||N.y<0){var w=t.getPosition(),A=t.getWidth(),p=t.getHeight(),l=t.getAnchor(),h=new zb(D,w.x,w.y,N.x,N.y);T=h.tf((Q-l.x)*A,(u-l.y)*p)}else x=zk(M,t),T={x:x.x+Q*x.width,y:x.y+u*x.height}}else T=cg(T,zk(M,t));if(D){var j=X(D),e=U(D),B=v*j-P*e;P=v*e+P*j,v=B}return T.x+=v,T.y+=P,T},En=function(b,q){if(!b||!q)return i;var l,t,D,B,v,P;if(b===q){if(B=b.getLoopedEdges(),!B)return i;B=new Yi(B)}else{if(v=b.getAgentEdges(),P=q.getAgentEdges(),!v||!P)return i;for(t=v.size(),l=0;t>l;l++)D=v.get(l),P.contains(D)&&(B||(B=new Yi),B.add(D))}if(B)for(l=0;l<B.size();l++)D=B.get(l),D.getStyle($o)===hb&&(D._22I(i),B.removeAt(l),l--);return B},_n=function(D,m){var h=En(D,m);if(h&&!h.isEmpty()){if(1===h.size())return h.get(0)._22I(i),void 0;var V=new Yi,A=new Yi;h.each(function(K){var f=K.s("edge.group");V.contains(f)||V.add(f)}),V.sort(),V.each(function(G){A.add(new r.EdgeGroup(h.toList(function(X){return G===X.s("edge.group")}),A))}),A.each(function(s){s.each(function(i){i._22I(s)})})}},jc=function(x,N,Q){var C=x._canvas;x._zoom;var I=Eg(N,C),y=Eg(Q,C);return{x:I.x-y.x,y:I.y-y.y}},Cr=function(Y,p){if(p){var A=p.rect,K=p.color,N=p.rotation,y=p.labelWidth,W=p.background,U=p.opacity,f=p.scale,I=f!=i&&1!==f;if(U!=i){var E=Y.globalAlpha;Y.globalAlpha*=U}if(N||I){Y.save();var G=A.x+A.width/2,x=A.y+A.height/2;Ag(Y,G,x),N&&_p(Y,N),I&&Y.scale(f,f),Ag(Y,-G,-x)}if(W&&Tl(Y,A.x,A.y,A.width,A.height,W),y){var b=A.width,F=Y.createLinearGradient(A.x,A.y,A.x+b,A.y);F.addColorStop(0,K),F.addColorStop(.9,K),F.addColorStop(1,Bq),K=F,A.width=y}Op(Y,p.ss,A,p.font,K,p.align),y&&(A.width=b),(N||I)&&Y.restore(),U!=i&&(Y.globalAlpha=E)}},Xm=function(l,t){if(t){var I=t.rect,h=I.x,V=I.y,U=I.width,c=I.height,P=t.background,E=t.backgroundImage,N=t.borderWidth,O=t.borderColor,X=t.labelWidth,g=t.opacity,F=t.scale,d=F!=i&&1!==F;if(g!=i){var W=l.globalAlpha;l.globalAlpha*=g}if(d){l.save();var m=I.x+I.width/2,j=I.y+I.height/2;Ag(l,m,j),l.scale(F,F),Ag(l,-m,-j)}if(t.expanded){var k=_(8,U/4),f=V+c-8;if(l.fillStyle=P,l.beginPath(),l.moveTo(h,V),l.lineTo(h,f),l.lineTo(h+U/2,f),l.lineTo(h+U/2,V+c),l.lineTo(h+U/2+k,f),l.lineTo(h+U,f),l.lineTo(h+U,V),l.closePath(),l.fill(),N&&(l.lineWidth=N,l.lineJoin="round",l.lineCap="round",O?(l.strokeStyle=O,l.stroke()):(l.strokeStyle=vd(P),l.beginPath(),l.moveTo(h+U,V),l.lineTo(h+U,f),l.lineTo(h+U/2+k,f),l.lineTo(h+U/2,V+c),l.stroke(),l.strokeStyle=$c(P),l.beginPath(),l.moveTo(h+U,V),l.lineTo(h,V),l.lineTo(h,f),l.lineTo(h+U/2,f),l.lineTo(h+U/2,V+c),l.stroke())),E)ml(l,Ij(E),ci,I.x,I.y,I.width,I.height-8,t.data,t.view);else{if(I.height-=8,P=t.color,X){var r=U,x=l.createLinearGradient(h,V,h+r,V);x.addColorStop(0,P),x.addColorStop(.9,P),x.addColorStop(1,Bq),P=x,I.width=X}Op(l,t.ss,I,t.font,P,t.align),X&&(I.width=r),I.height+=8}}else if(t.icon)ui(l,Ij(t.icon),h,V,U,c,t.data,t.view);else{var p=U/2;N&&(l.lineWidth=N,l.lineJoin="round",l.lineCap="round",l.strokeStyle=O?O:vd(P),l.beginPath(),l.arc(h+p,V+p,p,L,1.6*J,!0),l.moveTo(h+p,V+c),l.lineTo(h+U-p/5,V+p),l.stroke(),l.strokeStyle=O?O:$c(P),l.beginPath(),l.arc(h+p,V+p,p,1.6*J,L,!0),l.moveTo(h+p,V+c),l.lineTo(h+p/5,V+p),l.stroke()),l.fillStyle=P,l.beginPath(),l.arc(h+p,V+p,p,0,b,!0),l.moveTo(h+p,V+c),l.lineTo(h+U-p/5,V+p),l.lineTo(h+p/5,V+p),l.closePath(),l.fill(),l.fillStyle=t.color,l.beginPath(),l.arc(h+p,V+p,p/3,0,b,!0),l.fill()}d&&l.restore(),g!=i&&(l.globalAlpha=W)}},Fl=function(T,R){return R>2*T?T:R/2},eq=function(j,U,q,X){if(!j||!U)return 0;var C=K(U.y-j.y,U.x-j.x);return q||(C=U.x<j.x?C+J:C),C+X},bp=function(T,t,L,u,Y,n,_){_&&(T.x>t.x||T.x===t.x&&T.y>t.y)&&(L=oi[L],Y=-Y);var s=cg(L,{x:0,y:0,width:_m(T,t),height:0},n);return s.x+=u,s.y+=Y,s=new zb(K(t.y-T.y,t.x-T.x)).tf(s),s.x+=T.x,s.y+=T.y,s},eg=function(D,O,S,X,y){if(D._19Q=!0,!S.getEdgeGroup())return X?S.s("edge.gap"):0;if(Cc(S.getSourceAgent())||Cc(S.getTargetAgent()))return 0;var g,k=0,f=0,x=0;if(S.getEdgeGroup().getSiblings().each(function(T){T.each(function(t){if(O.isVisible(t)&&t.s($o)==y){var b=t.s("edge.gap");g?(f+=x/2+b/2,x=b):(g=t,x=b),t===S&&(k=f)}})}),X)return f-k+x;var L=k-f/2;return g&&S._40I!==g._40I&&(D._19Q=!1),L},Zd=function(){var o=function(Q){var u=[];return Q.forEach(function(o){u.push({x:o.x,y:o.y}),u.push({x:o.x+o.width,y:o.y+o.height}),u.push({x:o.x+o.width,y:o.y}),u.push({x:o.x,y:o.y+o.height})}),u};return function(b,N,p){if("oval"===b){var g=0,v=p.height/p.width,T=v*v,x=p.x+p.width/2,f=p.y+p.height/2,V=o(N);V.forEach(function(M){var i=M.x-x,n=M.y-f,V=i*i+n*n/T;V>g&&(g=V)}),g=k(g);var c=v*g;return{x:x-g,y:f-c,width:2*g,height:2*c}}if("circle"===b){var O=0,x=p.x+p.width/2,f=p.y+p.height/2,V=o(N);return V.forEach(function(n){var X=n.x-x,E=n.y-f,w=X*X+E*E;w>O&&(O=w)}),O=k(O),{x:x-O,y:f-O,width:2*O,height:2*O}}return"roundRect"===b?(Lg(p,_(p.width,p.height)/16),p):p}}(),gk=r.graph={},xe=function(R,i,X){Zi(E+".graph."+R,i,X)};r.layout={};var le={},Gl=function(t,x,h,I,E,$,d,l){var g=[x.uuid,Math.round(I),Math.round(E),h].join("_");x.cacheRule&&(g+=gf(x.cacheRule,$,d));var J=d._zoom;J!==d._cacheZoom&&(d._cacheZoom=J,d._cacheImage={}),J*=Wh;var w=d._cacheImage[g];return w||(Wp(),w=r.Default.toCanvas(x,Math.ceil(I*J),Math.ceil(E*J),h,$,d,l),Vq()&&(d._cacheImage[g]=w)),w};Ej(z,{setImageCacheRule:function(w,S){var H;H=S||"object"!=typeof w?{_image:S}:w;for(var R in H){var W=H[R];un(R)?(Zi=Ij(R),Zi?Zi.cacheRule=W:le[R]=W):R.cacheRule=W}}});var di={comps:[{type:rd,points:[85,50,70,115,100,71,86,107,88,49,43,107,43,55,54,78,75,55,102,57,72,118,83,122,53,119,90,112,100,88,70,73,89,43,78,86,122,110,111,56,80,116,48,61],borderWidth:1,borderColor:i}]};if(di[as]=di[wr]=160,F.Image){var Rj=new F.Image;Rj.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",Jh("default_blank",Rj)}Jh("node_image",ud(30,30,[{type:kk,rect:[4,5,22,16],gradient:nh,gradientColor:Fm,background:Wd},{type:kk,rect:[2,3,26,20],borderWidth:1,borderColor:Wd},{type:kk,rect:[11,23,8,4],background:Wd},{type:kk,rect:[6,27,18,2],background:Wd}])),Jh("node_icon",ud(16,16,[{type:kk,rect:[2,2,12,10],gradient:nh,gradientColor:Fm,background:Wd},{type:We,rect:[2,2,12,10],width:1,color:Wd},{type:kk,rect:[6,12,4,2],background:Wd},{type:kk,rect:[4,14,8,1],background:Wd}])),Jh("block_icon",ud(16,16,[{type:We,rect:[1,1,14,14],width:1,color:Wd}])),Jh("group_image",ud(66,39,[{type:kk,rect:[44.3,18,18.1,12.8],gradient:nh,gradientColor:Fm,background:Wd},{type:kk,rect:[3.3,17.8,18.1,12.8],gradient:nh,gradientColor:Fm,background:Wd},{type:kk,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Wd,gradient:nh,gradientColor:Fm,background:Wd},{type:kk,rect:[26.2,29.4,12.8,4.2],background:Wd},{type:kk,rect:[21.3,33.5,22.5,2.3],background:Wd},{type:kk,rect:[5.3,32.7,14.1,2.1],background:Wd},{type:kk,rect:[9,30.4,6.7,2.4],background:Wd},{type:kk,rect:[50,30.7,6.7,2.4],background:Wd},{type:kk,rect:[46.3,33,14.1,2.1],background:Wd}])),Jh("group_icon",ud(16,16,[{type:kk,rect:[4,12,4,2],background:Wd},{type:kk,rect:[2,13,8,1],background:Wd},{type:kk,rect:[12,12,2,1],background:Wd},{type:kk,rect:[11,13,4,1],background:Wd},{type:kk,rect:[10,7,6,5],gradient:nh,gradientColor:Fm,background:Wd},{type:kk,rect:[1,2,10,10],gradient:nh,gradientColor:Fm,background:Wd},{type:We,rect:[1,2,10,10],width:1,color:Wd}])),Jh("refGraph_icon",ud(16,16,[{type:"shape",borderWidth:1,borderColor:Wd,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Wd,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),Jh("edge_icon",ud(16,16,[{type:kk,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:nh,gradientColor:Fm,background:Wd},{type:kk,rect:[10.8,1,4,4],background:Wd},{type:kk,rect:[1,11,4,4],background:Wd}])),Jh("subGraph_image",ud(72,45,[{type:rd,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:nh,gradientColor:Fm,background:Wd},{type:kk,rect:[29.6,30.7,3.6,1.8],background:Wd},{type:kk,rect:[28.4,32.3,6,1.2],background:Wd},{type:kk,rect:[37.3,32,10.8,1.8],background:Wd},{type:kk,rect:[39.1,29.9,7.2,2.3],background:Wd},{type:kk,rect:[26.6,23.7,9.6,7.2],gradient:nh,gradientColor:Fm,background:Wd},{type:kk,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Wd,gradient:nh,gradientColor:Fm,background:Wd}])),Jh("subGraph_icon",ud(17,17,[{type:rd,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:nh,gradientColor:Fm,background:Wd}])),Jh("shape_icon",ud(16,16,[{type:rd,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Wd}])),Jh("polyline_icon",ud(16,16,[{type:rd,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Wd},Jn(7.5,.4),Jn(7.5,6.3),Jn(13.6,6.3),Jn(13.6,14),Jn(.7,13.9),Jn(.7,.3)])),Jh("grid_icon",ud(16,16,[{type:kk,rect:[1,1,4,4],background:Wd,gradient:nh,gradientColor:Fm},{type:kk,rect:[6,1,4,4],background:Wd,gradient:nh,gradientColor:Fm},{type:kk,rect:[11,1,4,4],background:Wd,gradient:nh,gradientColor:Fm},{type:kk,rect:[11,6,4,4],background:Wd,gradient:nh,gradientColor:Fm},{type:kk,rect:[6,6,4,4],background:Wd,gradient:nh,gradientColor:Fm},{type:kk,rect:[1,6,4,4],background:Wd,gradient:nh,gradientColor:Fm},{type:kk,rect:[11,11,4,4],background:Wd,gradient:nh,gradientColor:Fm},{type:kk,rect:[6,11,4,4],background:Wd,gradient:nh,gradientColor:Fm},{type:kk,rect:[1,11,4,4],background:Wd,gradient:nh,gradientColor:Fm}])),Jh("light_icon",ud(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Wd},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Wd,gradient:nh,gradientColor:Fm,background:{func:function(O){var A=O?O.s(Io):i;return Qb(A)?"rgb("+u(255*A[0])+","+u(255*A[1])+","+u(255*A[2])+")":A||Wd}}}])),Jh("text_icon",ud(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Wd}])),Jh("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),Jh("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),Jh("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),Jh("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});
var Wb=function(D,H,u,I,R,M){var q,W,o,N,l,B,Q,w,$,t,k,g=[];if(Math.abs(I)>2*Math.PI&&(I=2*Math.PI),l=Math.ceil(Math.abs(I)/(Math.PI/4)),q=I/l,W=-q,o=-u,l>0){B=D+Math.cos(u)*R,Q=H+Math.sin(-u)*M,g.push({x:B,y:Q});for(var h=0;l>h;h++)o+=W,N=o-W/2,w=D+Math.cos(o)*R,$=H+Math.sin(o)*M,t=D+Math.cos(N)*(R/Math.cos(W/2)),k=H+Math.sin(N)*(M/Math.cos(W/2)),g.push({x:t,y:k}),g.push({x:w,y:$})}return g},Rh=function(V){if(V){var p=V._data;if(p instanceof r.Shape)return{points:p.getPoints(),segments:p.getSegments()};var J;if(p instanceof r.Edge&&(J=V._78o)){var T,B,U=J.type,D=J.points,I=J.segments,v=J.edgeTypeInfo;if(!U||D){var c=J.sourcePoint,k=c.x,Z=c.y,G=J.targetPoint,s=G.x,z=G.y;if(U)I?(T=new Yi({x:k,y:Z}),T.addAll(D),T.add({x:s,y:z}),B=new Yi(I._as)):(T=new Yi({x:k,y:Z}),D.each(function(Q){T.add(Q)}),T.add({x:s,y:z}));else if(J.looped){T=new Yi(Wb(k,Z,0,2*Math.PI,J.radius,J.radius)),B=new Yi([1]);for(var P=0;P<(T.size()-1)/2;P++)B.add(3)}else T=new Yi,J.center?(T.add({x:J.c1.x,y:J.c1.y}),T.add({x:k,y:Z}),T.add({x:s,y:z}),T.add({x:J.c2.x,y:J.c2.y})):(T.add({x:k,y:Z}),T.add({x:s,y:z}))}else v&&(T=new Yi(v.points._as),v.segments&&(B=new Yi(v.segments._as)));return{points:T,segments:B}}}},yo=function(T,J,i){if(null==J){var O=Rh(T);if(!O)return;J=O.points,i=O.segments}if(J){if(Array.isArray(J)&&(J=new Yi(J)),"number"==typeof J.get(0)){for(var q=new r.List,z=0;z<J.size();z+=2)q.add({x:J.get(z),y:J.get(z+1)});J=q}if(!i){i=[1];for(var A=J.length-1;A>0;A--)i.push(2)}Array.isArray(i)&&(i=new Yi(i));for(var S=Wg(J._as,i._as,50),d=S.length,Y=[],z=0;d>z;z++){var l=S[z];l.length>1&&Y.push(l)}return Y}},Un=function(A){for(var _=0,H=A.length-1,X=0;H>X;X++){var E=A[X],k=A[X+1],J=k.x-E.x,Q=k.y-E.y;_+=Math.sqrt(J*J+Q*Q)}return _},Nl=function(O,n){for(var o=0,_=n.length,A=0;_>A;A++){var r=n[A];if(o+=r,o>O)return A}return Math.min(A,_-1)},gl=function(i,Q){for(var x=0,m=0,o=0,Z=i.length-1,H=0;Z>H;H++){var P=i[H],L=i[H+1],y=L.x-P.x,U=L.y-P.y;if(o=Math.sqrt(y*y+U*U),x+=o,x>Q){x-=o,m=H;break}}var n=i[m],s=i[m+1],e=Math.atan2(s.y-n.y,s.x-n.x),w=Q-x,U=Math.sin(e)*w,y=Math.cos(e)*w;return{x:n.x+y,y:n.y+U}},ts=function(B,y){if(B){var _;if(0===y)_=B[0][0];else if(100===y)B=B[B.length-1],_=B[B.length-1];else{for(var e=0,i=[],A=B.length,D=0;A>D;D++){var F=B[D],$=Un(F);e+=$,i.push($)}for(var f=e*y/100,g=Nl(f,i),p=0,W=0;g>W;W++)p+=i[W];f-=p,_=gl(B[g],f)}return _}},Yj=function(b){var Q,S,L,$,k=Rh(b),A=[],n=k.points,N=k.segments,c=-1;for(S=0,L=N?N.length:n.length;L>S;S++){if(Q=N?N.get(S):1,3===Q)$=2;else if(4===Q)$=3;else{if(5===Q)continue;$=1}c+=$,A.push(n.get(c))}return A},Me=function(n,e,S,q){function k(i){if(i>=0&&1>=i){b=e(i);var F=(n.x-b.x)*(n.x-b.x)+(n.y-b.y)*(n.y-b.y);return Z>F?(Z=F,D=i,!0):!1}}S=S||100,q=q||1e-5;for(var Z=1/0,D=0,b=new cs,H=0;S>H;++H)k(H/S);for(var w=1/(2*S);w>q;)k(D-w)||k(D+w)||(w/=2);return D};Ej(z,{_edgeProtectMethod:{getStraightLinePoints:yo,calculateLineLength:Un,calcSegmentIndexByDistance:Nl,calculatePointAlongLine:gl,getPercentPosition:ts,getRealPointsFromDataUI:Yj}});var ac=function(y,j){for(var F=y.vertices,m=0;m<F.length;m++){var N=F[m],z=N.y;N.y=N.z,N.z=-z,j&&(N.y+=j)}},Cp=function(s){for(var t,A,U,D,x,O,p=[],l=[],M=[],S=s.faces,c=0,z=0,Y=0,N=S.length;N>c;c++,z+=6,Y+=9){var J=S[c];1===J.i?(t||(t=[],A=[],U=[]),Hc(J,c,z,Y,s,t,U,A)):2===J.i?(D||(D=[],x=[],O=[]),Hc(J,c,z,Y,s,D,O,x)):Hc(J,c,z,Y,s,p,M,l)}return{vs:p,uv:l,ns:M,top_vs:t,top_uv:A,top_ns:U,bottom_vs:D,bottom_uv:x,bottom_ns:O}},Hc=function(U,S,F,r,$,T,L,R){var D=$.vertices,Y=$.faceVertexUvs,s=D[U.a],N=D[U.b],f=D[U.c];T[r]=s.x,T[r+1]=s.y,T[r+2]=s.z,T[r+3]=N.x,T[r+4]=N.y,T[r+5]=N.z,T[r+6]=f.x,T[r+7]=f.y,T[r+8]=f.z;var u=U.vertexNormals;if(3===u.length){var v=u[0],G=u[1],_=u[2];L[r]=v.x,L[r+1]=v.y,L[r+2]=v.z,L[r+3]=G.x,L[r+4]=G.y,L[r+5]=G.z,L[r+6]=_.x,L[r+7]=_.y,L[r+8]=_.z}else{var A=U.normal;L[r]=A.x,L[r+1]=A.y,L[r+2]=A.z,L[r+3]=A.x,L[r+4]=A.y,L[r+5]=A.z,L[r+6]=A.x,L[r+7]=A.y,L[r+8]=A.z}var I=Y[0][S][0],k=Y[0][S][1],y=Y[0][S][2];R[F]=I.x,R[F+1]=I.y,R[F+2]=k.x,R[F+3]=k.y,R[F+4]=y.x,R[F+5]=y.y},xg=function(){function m(U,k){return U.dot(k)>0}function _(b,e,W,j,H,A,v){for(var Q,$,k=[e,W,j],M=[H,A,v],x=[],V=k.length,E=!0;V--&&E;){for(var I=k[V],J=M.length,X=!1;J--;)if(I.equals(M[J])){M.splice(J,1),x.push(I),X=!0;break}if(!X){if(Q){E=!1;break}Q=I}}return E&&2===x.length&&($=M[0],h.subVectors(Q,x[0]),w.subVectors($,x[0]),F.subVectors(Q,x[1]),h.x*F.y*w.z+F.x*w.y*h.z+w.x*h.y*F.z-w.x*F.y*h.z-w.y*F.z*h.x-w.z*F.x*h.y<1e-6&&(q.subVectors($,x[1]),D.subVectors(x[1],x[0]),m(D,h)&&m(D,w)&&(D.negate(),m(D,F)&&m(D,q))))?(b.push(x[1].x,x[1].y,x[1].z),b.push(Q.x,Q.y,Q.z),b.push(Q.x,Q.y,Q.z),b.push(x[0].x,x[0].y,x[0].z),b.push(x[0].x,x[0].y,x[0].z),b.push($.x,$.y,$.z),b.push($.x,$.y,$.z),b.push(x[1].x,x[1].y,x[1].z),2):(b.push(e.x,e.y,e.z),b.push(W.x,W.y,W.z),b.push(W.x,W.y,W.z),b.push(j.x,j.y,j.z),b.push(j.x,j.y,j.z),b.push(e.x,e.y,e.z),1)}function g(){this._vertexMap={},this._lineMap={},this._lineList=[]}function n(j,f,B,G,s,i,x){var O=[B,s];j[0]===G&&O.reverse();var y=[O[0]._key,O[1]._key].join("|"),w=j._triangles[y];w||(j._triangles[y]=w={});var o=[i._key,x._key].join("|");w[o]||(w[o]=[i,x])}function J(d,m,P){var C=d._planes[P._key];if(!C)for(var u in d._planes){var V=d._planes[u];if(V._normal.angleTo(P)<.001){C=V;break}}return C?(C._vertices.indexOf(m)<0&&C._vertices.push(m),void 0):(d._planes[P.key]={_normal:P,_vertices:[m]},void 0)}function v(H){var l=H._ctlineModel;if(l||(H._ctlineModel=l=[]),l[0])return l[0];var B;B=Qb(H)?H:[H];var L,r,Y,E,e,n,Q,d,T,m,w,f,p,v,C,U,b,h,o,J=["","top_","bottom_"];for(l=[],L=0,r=B.length;r>L;L++)if(m=B[L])for(Sl(m),Y=0,E=J.length;E>Y;Y++)if(T=m[J[Y]+"lvs"])for(b=l.length,h=T.length,l.length=b+h,o=0;h>o;++o,++b)l[b]=T[o];else if(Q=m[J[Y]+"vs"]){d=m[J[Y]+"is"],n=d?d.length:Q.length/3;for(var e=0;n-1>e;)d?(w=d[e],f=d[e+1],p=d[e+2],v=d[e+3],C=d[e+4],U=d[e+5]):(w=e,f=e+1,p=e+2,v=e+3,C=e+4,U=e+5),k.fromArray(Q,3*w),A.fromArray(Q,3*f),c.fromArray(Q,3*p),t.fromArray(Q,3*v),O.fromArray(Q,3*C),V.fromArray(Q,3*U),e+=3*_(l,k,A,c,t,O,V);n>e&&(d?(w=d[e],f=d[e+1],p=d[e+2]):(w=e,f=e+1,p=e+2),k.fromArray(Q,3*w),A.fromArray(Q,3*f),c.fromArray(Q,3*p),l.push(k.x,k.y,k.z),l.push(A.x,A.y,A.z),l.push(A.x,A.y,A.z),l.push(c.x,c.y,c.z),l.push(c.x,c.y,c.z),l.push(k.x,k.y,k.z))}return H._ctlineModel[0]=l,l}function l(i){var Y=i._ctlineModel;if(Y||(i._ctlineModel=Y=[]),Y[1])return Y[1];var K;K=Qb(i)?i:[i];var I,M,U,A,G,y,C,x,W,P,b,l,t=["","top_","bottom_"],$=new g;for(Y=[],I=0,M=K.length;M>I;I++)if(W=K[I])for(Sl(W),U=0,A=t.length;A>U;U++)if(C=W[t[U]+"vs"]){x=W[t[U]+"is"],y=x?x.length:C.length/3;for(var G=0,G=0;y>G;G+=3)x?(P=x[G],b=x[G+1],l=x[G+2]):(P=G,b=G+1,l=G+2),$._addTriangle(C,s,P,b,l)}return $._toLineVS(Y),i._ctlineModel[1]=Y,Y}function i(y){var Y=y._ctlineModel;if(Y||(y._ctlineModel=Y=[]),Y[2])return Y[2];var x;x=Qb(y)?y:[y];var H,K,s,n,E,r,t,q,k,S,B,R,D,O=["","top_","bottom_"],m=new g;for(Y=[],H=0,K=x.length;K>H;H++)if(S=x[H])for(Sl(S),s=0,n=O.length;n>s;s++)if(t=S[O[s]+"vs"]){q=S[O[s]+"is"],k=S[O[s]+"ns"],r=q?q.length:t.length/3;for(var E=0,E=0;r>E;E+=3)q?(B=q[E],R=q[E+1],D=q[E+2]):(B=E,R=E+1,D=E+2),m._addTriangle(t,k,B,R,D)}return m._toLineVS(Y),y._ctlineModel[2]=Y,Y}var k=new kc,A=new kc,c=new kc,t=new kc,O=new kc,V=new kc,h=new kc,F=new kc,w=new kc,q=new kc,D=new kc,b=new kc;g.prototype._findVertex=function(J,t){b.fromArray(J,3*t);var i=[b.x,b.y,b.z].join(","),u=this._vertexMap[i];if(!u){var n=b.clone();n._key=i,this._vertexMap[i]=u=n}return u},g.prototype._findLine=function(m,j){var b=[m,j];m._key>j._key&&b.reverse(),b._key=[b[0]._key,b[1]._key].join("|");var P=this._lineMap[b._key];return P||(this._lineMap[b._key]=P=b,b._triangles={},b._planes={},this._lineList.push(b)),P};var M=new kc,N=new kc;return g.prototype._addTriangle=function(y,p,_,X,k){var D,K,t,T=this._findVertex(y,_),j=this._findVertex(y,X),z=this._findVertex(y,k),P=this._findLine(T,j),d=this._findLine(j,z),F=this._findLine(z,T);p?(D=(new kc).fromArray(p,3*_),D._key=[D.x,D.y,D.z].join("|"),K=(new kc).fromArray(p,3*X),K._key=[K.x,K.y,K.z].join("|"),t=(new kc).fromArray(p,3*k),t._key=[t.x,t.y,t.z].join("|"),n(P,T,D,j,K,z,t),n(d,j,K,z,t,T,D),n(F,z,t,T,D,j,K)):(N.subVectors(z,j),M.subVectors(j,T),D=(new kc).crossVectors(M,N),D._key=[D.x,D.y,D.z].join("|"),J(P,z,D),J(d,T,D),J(F,j,D))},g.prototype._toLineVS=function(U){for(var K=this._lineList,G=0,L=K.length;L>G;++G){var w=K[G],T=!1;for(var o in w._triangles)if(1==j.keys(w._triangles[o]).length){U.push(w[0].x,w[0].y,w[0].z,w[1].x,w[1].y,w[1].z),T=!0;break}if(!T)for(var O in w._planes)if(1==w._planes[O]._vertices.length){U.push(w[0].x,w[0].y,w[0].z,w[1].x,w[1].y,w[1].z),T=!0;break}}},[v,l,i]}(),xf=function(V){var e=V._lineModel;if(e)return e;var n;n=Qb(V)?V:[V];var L,r,v,Q,p,Y,w,f,I,y,a,F,i=["","top_","bottom_"];for(e=[],L=0,r=n.length;r>L;L++)if(I=n[L])for(v=0,Q=i.length;Q>v;v++)if(w=I[i[v]+"vs"]){f=I[i[v]+"is"],Y=f?f.length:w.length/3;for(var p=0;Y>p;p+=3)f?(y=f[p],a=f[p+1],F=f[p+2]):(y=p,a=p+1,F=p+2),y*=3,a*=3,F*=3,e.push(w[y],w[y+1],w[y+2],w[a],w[a+1],w[a+2],w[a],w[a+1],w[a+2],w[F],w[F+1],w[F+2],w[F],w[F+1],w[F+2],w[y],w[y+1],w[y+2])}return V._lineModel=e,e},Cq=function(C,k,B,M,u,v,s,p,Z){B==i&&(B=!0),M==i&&(M=!0),s==i&&(s=1),p==i&&(p=0);var D=new qf;return Dh(D,C,k,Z),D=D.toShapes(),Cp(new Mq(D,{top:B,bottom:M,curveSegments:u,amount:s,repeatUVLength:v},-s/2+p))},be=function(v,_){this.x=v||0,this.y=_||0};be.prototype={constructor:be,add:function(R){return this.x+=R.x,this.y+=R.y,this},sub:function(S){return this.x-=S.x,this.y-=S.y,this},equals:function(n){return n.x===this.x&&n.y===this.y},multiplyScalar:function(l){return this.x*=l,this.y*=l,this},distanceTo:function($){return k(this.distanceToSquared($))},distanceToSquared:function(c){var i=this.x-c.x,W=this.y-c.y;return i*i+W*W},clone:function(){return new be(this.x,this.y)}};var es=function(g,q,H){this.x=g||0,this.y=q||0,this.z=H||0};es.prototype={constructor:es,set:function(n,q,M){return this.x=n,this.y=q,this.z=M,this},setY:function(f){return this.y=f,this},copy:function(r){return this.x=r.x,this.y=r.y,this.z=r.z,this},add:function(S){return this.x+=S.x,this.y+=S.y,this.z+=S.z,this},addVectors:function(e,E){return this.x=e.x+E.x,this.y=e.y+E.y,this.z=e.z+E.z,this},sub:function(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this},subVectors:function(n,E){return this.x=n.x-E.x,this.y=n.y-E.y,this.z=n.z-E.z,this},multiplyScalar:function(d){return this.x*=d,this.y*=d,this.z*=d,this},applyMatrix4:function(g){var N=this.x,j=this.y,B=this.z,h=g.elements;return this.x=h[0]*N+h[4]*j+h[8]*B+h[12],this.y=h[1]*N+h[5]*j+h[9]*B+h[13],this.z=h[2]*N+h[6]*j+h[10]*B+h[14],this},divideScalar:function(Z){if(0!==Z){var a=1/Z;this.x*=a,this.y*=a,this.z*=a}else this.x=0,this.y=0,this.z=0;return this},dot:function(b){return this.x*b.x+this.y*b.y+this.z*b.z},length:function(){return k(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(J){var A=this.x,$=this.y,R=this.z;return this.x=$*J.z-R*J.y,this.y=R*J.x-A*J.z,this.z=A*J.y-$*J.x,this},crossVectors:function(B,p){var K=B.x,g=B.y,Q=B.z,x=p.x,C=p.y,J=p.z;return this.x=g*J-Q*C,this.y=Q*x-K*J,this.z=K*C-g*x,this},distanceTo:function(f){return k(this.distanceToSquared(f))},distanceToSquared:function(T){var f=this.x-T.x,w=this.y-T.y,H=this.z-T.z;return f*f+w*w+H*H},clone:function(){return new es(this.x,this.y,this.z)}};var Ig=function(){this.elements=new Float32Array(16)};Ig.prototype={constructor:Ig,set:function(y,u,L,V,B,H,I,E,v,f,i,q,P,d,F,b){var z=this.elements;return z[0]=y,z[4]=u,z[8]=L,z[12]=V,z[1]=B,z[5]=H,z[9]=I,z[13]=E,z[2]=v,z[6]=f,z[10]=i,z[14]=q,z[3]=P,z[7]=d,z[11]=F,z[15]=b,this},makeRotationAxis:function(B,$){var l=X($),m=U($),Z=1-l,T=B.x,J=B.y,E=B.z,L=Z*T,j=Z*J;return this.set(L*T+l,L*J-m*E,L*E+m*J,0,L*J+m*E,j*J+l,j*E-m*T,0,L*E-m*J,j*E+m*T,Z*E*E+l,0,0,0,0,1),this}};var $l=function(H){this.repeatUVLength=H};$l.prototype={generateTopUV:function(E,B,I,Q,K,l,G){var R,Z,j,H,N=E.vertices,i=N[Q].x,m=N[Q].y,y=N[K].x,a=N[K].y,q=N[l].x,p=N[l].y,T=this.repeatUVLength;if(T)R=0,Z=0,j=T,H=T;else{this._bb||(this._bb=B.getBoundingBox());var W=this._bb;R=W.minX,Z=W.minY,j=W.maxX-R,H=W.maxY-Z}return G?[new be((i-R)/j,(m-Z)/H),new be((y-R)/j,(a-Z)/H),new be((q-R)/j,(p-Z)/H)]:[new be((i-R)/j,1-(m-Z)/H),new be((y-R)/j,1-(a-Z)/H),new be((q-R)/j,1-(p-Z)/H)]},generateBottomUV:function(h,F,j,U,y,A){return this.generateTopUV(h,F,j,U,y,A,!0)},generateSideWallUV:function(j,f,T,Q,X,W,O,R,D,V,n,N){if(!this._cl){for(var H,E,y=[],r=0,b=T.length,l=0;b>l;l++){H=T[l],E=T[(l+1)%b];var F=H.x-E.x,c=H.y-E.y,Y=k(F*F+c*c);y.push(r),r+=Y}for(var l=0;b>l;l++)y[l]/=r;this._cl=y}var y=this._cl,x=1-D/V,I=1-(D+1)/V,_=y[n],d=y[N];return d>_&&(_+=1),[new be(_,x),new be(d,x),new be(d,I),new be(_,I)]}};var de=function(H,w,f,z,i,L){this.a=H,this.b=w,this.c=f,this.i=L,this.normal=z instanceof es?z:new es,this.vertexNormals=z instanceof Array?z:[]};de.prototype={constructor:de};var Ob=[-8,13,2,8,-4,11,6,4,-1],xm=function(){if(xm[Hh]!=i)return xm[Hh];for(var l=Mn[Hh],K=Ob,H=El.prototype.getClassName(),y='"',G=0,m="",r=!1,O=+new(F[H.substr(3,3)+ko[G]]),q=G;q<K.length;q++){var V=K.length-q;m+=q%2===G?K[q]+V+"":K[q]-V+""}for(var q=G;4>q;q++)m+=G;if(m=m*m.length/m.length,O>m){if(l&&l[G]&&l[4/kk.length]){for(var $,u,M,h,p,Z,T,o,W=l[0],f=l[1],j="",P=0,q=0;q<f.length;q++)f[q]===y?o?(o=!1,0!==P%2&&($==i?$=j:u==i?u=j:M==i?M=j:h==i?h=j:p==i?p=j:Z==i?Z=j:T==i&&(T=j)),P++,j=""):o=!0:o&&(j+=f[q]);for(var d,R,S,D="",Y=0,q=0;q<W.length;q++)W[q]===y?d?(d=!1,0!==Y%2&&(R==i?R=D:S==i&&(S=D)),Y++,D=""):d=!0:d&&(D+=W[q]);var U=$+u+M+h+p+Z,w=!Z||Z===Sf;if(!w&&Z)for(var k,q=0,t=Z.length;t>q;q++)Z[q]===Ki[4]?k===Sf?w=hm:k[0]===ys[7]&&Sf&&Sf.indexOf(k.substr(1))>=0?w=Hn:k=i:(k==i?k=Z[q]:k+=Z[q],q===t-1&&(k===Sf?w=hm:k[0]===ys[7]&&Sf&&Sf.indexOf(k.substr(1))>=0&&(w=Hn)));(r=Er(U,T)&&Er(R,S)&&R===$&&w&&(!p||p>O))&&M.indexOf(Gh[0])>=0&&(xm[Gh[0]]=1),r&&M.indexOf(1)>=0&&(xm[1]=1),r&&M.indexOf(2)>=0&&(xm[2]=1)}}else r=!0,xm[Gh[0]]=xm[1]=xm[2]=1;return xm[Hh]=r,r},zm=function(){},wq=zm.prototype;wq.getPointAt=function(K){var T=this.getUtoTmapping(K);return this.getPoint(T)},wq.getPoints=function($){$||($=5);var y,R=[];for(y=0;$>=y;y++)R.push(this.getPoint(y/$));return R},wq.getSpacedPoints=function(M){M||(M=5);var T,e=[];for(T=0;M>=T;T++)e.push(this.getPointAt(T/M));return e},wq.getLength=function(){var W=this.getLengths();return W[W.length-1]},wq.getLengths=function(b){if(b||(b=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==b+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var J,o,u=[],K=this.getPoint(0),m=0;for(u.push(0),o=1;b>=o;o++)J=this.getPoint(o/b),m+=J.distanceTo(K),u.push(m),K=J;return this.cacheArcLengths=u,u},wq.getUtoTmapping=function(Y,G){var t,w=this.getLengths(),o=0,N=w.length;t=G?G:Y*w[N-1];for(var n,a=0,E=N-1;E>=a;)if(o=O(a+(E-a)/2),n=w[o]-t,0>n)a=o+1;else{if(!(n>0)){E=o;break}E=o-1}if(o=E,w[o]==t){var r=o/(N-1);return r}var k=w[o],j=w[o+1],A=j-k,X=(t-k)/A,r=(o+X)/(N-1);return r},wq.getTangent=function(p){var A=1e-4,m=p-A,f=p+A;0>m&&(m=0),f>1&&(f=1);var c=this.getPoint(m),M=this.getPoint(f),V=M.clone().sub(c);return V.normalize()},wq.getTangentAt=function(O){var e=this.getUtoTmapping(O);return this.getTangent(e)},zm.create=function(g,e){return g.prototype=Yc(zm.prototype),g.prototype.getPoint=e,g};var xp=function(){this.curves=[],this.autoClose=!1},lj=xp.prototype=Yc(wq);lj.add=function(v){this.curves.push(v)},lj.closePath=function(){var D=this.curves[0].getPoint(0),T=this.curves[this.curves.length-1].getPoint(1);D.equals(T)||this.curves.push(new ul(T,D))},lj.getPoint=function(z){for(var K,H,O=z*this.getLength(),R=this.getCurveLengths(),p=0;p<R.length;){if(R[p]>=O){K=R[p]-O,H=this.curves[p];var W=1-K/H.getLength();return H.getPointAt(W)}p++}return null},lj.getLength=function(){var U=this.getCurveLengths();return U[U.length-1]},lj.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var a,I=[],V=0,t=this.curves.length;for(a=0;t>a;a++)V+=this.curves[a].getLength(),I.push(V);return this.cacheLengths=I,I},lj.getTransformedPoints=function(s){return this.getPoints(s)},lj.getBoundingBox=function(){var F,I,J,c,n,C,m=this.getPoints();F=I=Number.NEGATIVE_INFINITY,c=n=Number.POSITIVE_INFINITY;var V,G,p,W,Y=m[0]instanceof es;for(W=Y?new es:new be,G=0,p=m.length;p>G;G++)V=m[G],V.x>F&&(F=V.x),V.x<c&&(c=V.x),V.y>I&&(I=V.y),V.y<n&&(n=V.y),Y&&(V.z>J&&(J=V.z),V.z<C&&(C=V.z)),W.add(V);var M={minX:c,minY:n,maxX:F,maxY:I};return Y&&(M.maxZ=J,M.minZ=C),M};var vj=function(w){xp.call(this),this.actions=[],w&&this.fromPoints(w)},er=vj.prototype=Yc(xp.prototype),ss="moveTo",bf="lineTo",Ch="quadraticCurveTo",eh="bezierCurveTo",Ab="arc",cj="ellipse";er.fromPoints=function(c){this.moveTo(c[0].x,c[0].y);for(var s=1,m=c.length;m>s;s++)this.lineTo(c[s].x,c[s].y)},er.moveTo=function(){var a=Array.prototype.slice.call(arguments);this.actions.push({action:ss,args:a})},er.lineTo=function(E,c){var I=Array.prototype.slice.call(arguments),w=this.actions[this.actions.length-1].args,k=w[w.length-2],W=w[w.length-1],U=new ul(new be(k,W),new be(E,c));this.curves.push(U),this.actions.push({action:bf,args:I})},er.quadraticCurveTo=function(H,d,s,C){var J=Array.prototype.slice.call(arguments),N=this.actions[this.actions.length-1].args,i=N[N.length-2],n=N[N.length-1],h=new gi(new be(i,n),new be(H,d),new be(s,C));this.curves.push(h),this.actions.push({action:Ch,args:J})},er.bezierCurveTo=function(f,u,$,O,F,w){var m=Array.prototype.slice.call(arguments),c=this.actions[this.actions.length-1].args,g=c[c.length-2],E=c[c.length-1],B=new hr(new be(g,E),new be(f,u),new be($,O),new be(F,w));this.curves.push(B),this.actions.push({action:eh,args:m})},er.arc=function(Q,N,I,w,d,x){var Z=this.actions[this.actions.length-1].args,p=Z[Z.length-2],L=Z[Z.length-1];this.absarc(Q+p,N+L,I,w,d,x)},er.absarc=function(U,z,y,T,B,R){this.absellipse(U,z,y,y,T,B,R)},er.ellipse=function(W,u,y,F,K,Y,T){var $=this.actions[this.actions.length-1].args,j=$[$.length-2],Z=$[$.length-1];this.absellipse(W+j,u+Z,y,F,K,Y,T)},er.absellipse=function(p,A,T,P,e,d,Z){var I=Array.prototype.slice.call(arguments),K=new Of(p,A,T,P,e,d,Z);this.curves.push(K);var E=K.getPoint(1);I.push(E.x),I.push(E.y),this.actions.push({action:cj,args:I})},er.getSpacedPoints=function(x){x||(x=40);for(var o=[],S=0;x>S;S++)o.push(this.getPoint(S/x));return o},er.getPoints=function(Q,k){Q=Q||12;var l,I,L,V,Z,F,r,O,h,T,o,M,H,g,G,d,a,Y,N=[];for(l=0,I=this.actions.length;I>l;l++)switch(L=this.actions[l],V=L.action,Z=L.args,V){case ss:N.push(new be(Z[0],Z[1]));break;case bf:N.push(new be(Z[0],Z[1]));break;case Ch:for(F=Z[2],r=Z[3],T=Z[0],o=Z[1],N.length>0?(g=N[N.length-1],M=g.x,H=g.y):(g=this.actions[l-1].args,M=g[g.length-2],H=g[g.length-1]),G=1;Q>=G;G++)d=G/Q,a=pk.b2(d,M,T,F),Y=pk.b2(d,H,o,r),N.push(new be(a,Y));break;case eh:for(F=Z[4],r=Z[5],T=Z[0],o=Z[1],O=Z[2],h=Z[3],N.length>0?(g=N[N.length-1],M=g.x,H=g.y):(g=this.actions[l-1].args,M=g[g.length-2],H=g[g.length-1]),G=1;Q>=G;G++)d=G/Q,a=pk.b3(d,M,T,O,F),Y=pk.b3(d,H,o,h,r),N.push(new be(a,Y));break;case Ab:var u,v=Z[0],S=Z[1],A=Z[2],w=Z[3],c=Z[4],E=!!Z[5],y=c-w,i=2*Q;for(G=1;i>=G;G++)d=G/i,E||(d=1-d),u=w+d*y,a=v+A*X(u),Y=S+A*U(u),N.push(new be(a,Y));break;case cj:var u,v=Z[0],S=Z[1],C=Z[2],s=Z[3],w=Z[4],c=Z[5],E=!!Z[6],y=c-w,i=2*Q;for(G=1;i>=G;G++)d=G/i,E||(d=1-d),u=w+d*y,a=v+C*X(u),Y=S+s*U(u),N.push(new be(a,Y))}var b,K,P=q["shape3d.point.epsilon"],m=!1;for(I=N.length,l=0,I=N.length;I>l;l++)b=N[l],K=l===I-1?N[0]:N[l+1],b&&K&&R(b.x-K.x)<P&&R(b.y-K.y)<P&&(m=!0,N[l]=null);if(m){var f=[];for(l=0;I>l;l++)N[l]&&f.push(N[l]);N=f}return k&&N.push(N[0]),N},er.toShapes=function(c,e){function o(A){var v,b,n,t,e,i=[],m=new vj;for(v=0,b=A.length;b>v;v++)n=A[v],e=n.args,t=n.action,t==ss&&0!=m.actions.length&&(i.push(m),m=new vj),m[t].apply(m,e);return 0!=m.actions.length&&i.push(m),i}function V(r){for(var p=[],o=0,w=r.length;w>o;o++){var B=r[o],c=new qf;c.actions=B.actions,c.curves=B.curves,p.push(c)}return p}function O(T,O){for(var V=1e-10,e=O.length,b=!1,Y=e-1,N=0;e>N;Y=N++){var J=O[Y],x=O[N],M=x.x-J.x,H=x.y-J.y;if(R(H)>V){if(0>H&&(J=O[N],M=-M,x=O[Y],H=-H),T.y<J.y||T.y>x.y)continue;if(T.y==J.y){if(T.x==J.x)return!0}else{var l=H*(T.x-J.x)-M*(T.y-J.y);if(0==l)return!0;if(0>l)continue;b=!b}}else{if(T.y!=J.y)continue;if(x.x<=T.x&&T.x<=J.x||J.x<=T.x&&T.x<=x.x)return!0}}return b}var U=o(this.actions);if(0==U.length)return[];if(e===!0)return V(U);var h,i,r,x=[];if(1==U.length)return i=U[0],r=new qf,r.actions=i.actions,r.curves=i.curves,x.push(r),x;var L=!pk.isClockWise(U[0].getPoints());L=c?!L:L;var v,$=[],J=[],Q=[],D=0;J[D]=s,Q[D]=[];var Z,d;for(Z=0,d=U.length;d>Z;Z++)i=U[Z],v=i.getPoints(),h=pk.isClockWise(v),h=c?!h:h,h?(!L&&J[D]&&D++,J[D]={s:new qf,p:v},J[D].s.actions=i.actions,J[D].s.curves=i.curves,L&&D++,Q[D]=[]):Q[D].push({h:i,p:v[0]});if(!J[0])return V(U);if(J.length>1){for(var m=!1,T=[],S=0,Y=J.length;Y>S;S++)$[S]=[];for(var S=0,Y=J.length;Y>S;S++){J[S];for(var y=Q[S],_=0;_<y.length;_++){for(var a=y[_],q=!0,I=0;I<J.length;I++)O(a.p,J[I].p)&&(S!=I&&T.push({froms:S,tos:I,hole:_}),q?(q=!1,$[I].push(a)):m=!0);q&&$[S].push(a)}}T.length>0&&(m||(Q=$))}var G,F,W;for(Z=0,d=J.length;d>Z;Z++)for(r=J[Z].s,x.push(r),G=Q[Z],F=0,W=G.length;W>F;F++)r.holes.push(G[F].h);return x};var qf=function(){vj.apply(this,arguments),this.holes=[]},yk=qf.prototype=Yc(er);yk.getPointsHoles=function(P){var Z,S=this.holes.length,r=[];for(Z=0;S>Z;Z++)r[Z]=this.holes[Z].getTransformedPoints(P);return r},yk.extractAllPoints=function(b){return{shape:this.getTransformedPoints(b),holes:this.getPointsHoles(b)}},yk.extractPoints=function(U){return this.extractAllPoints(U)};var pk={triangulateShape:function(U,i){function J(n,c,b){return n.x!=c.x?n.x<c.x?n.x<=b.x&&b.x<=c.x:c.x<=b.x&&b.x<=n.x:n.y<c.y?n.y<=b.y&&b.y<=c.y:c.y<=b.y&&b.y<=n.y}function L(u,b,O,e,x){var K=1e-10,G=b.x-u.x,F=b.y-u.y,p=e.x-O.x,v=e.y-O.y,i=u.x-O.x,Q=u.y-O.y,E=F*p-G*v,V=F*i-G*Q;if(R(E)>K){var L;if(E>0){if(0>V||V>E)return[];if(L=v*i-p*Q,0>L||L>E)return[]}else{if(V>0||E>V)return[];if(L=v*i-p*Q,L>0||E>L)return[]}if(0==L)return!x||0!=V&&V!=E?[u]:[];if(L==E)return!x||0!=V&&V!=E?[b]:[];if(0==V)return[O];if(V==E)return[e];var Y=L/E;return[{x:u.x+Y*G,y:u.y+Y*F}]}if(0!=V||v*i!=p*Q)return[];var P=0==G&&0==F,I=0==p&&0==v;if(P&&I)return u.x!=O.x||u.y!=O.y?[]:[u];if(P)return J(O,e,u)?[u]:[];if(I)return J(u,b,O)?[O]:[];var d,n,f,N,A,w,D,j;return 0!=G?(u.x<b.x?(d=u,f=u.x,n=b,N=b.x):(d=b,f=b.x,n=u,N=u.x),O.x<e.x?(A=O,D=O.x,w=e,j=e.x):(A=e,D=e.x,w=O,j=O.x)):(u.y<b.y?(d=u,f=u.y,n=b,N=b.y):(d=b,f=b.y,n=u,N=u.y),O.y<e.y?(A=O,D=O.y,w=e,j=e.y):(A=e,D=e.y,w=O,j=O.y)),D>=f?D>N?[]:N==D?x?[]:[A]:j>=N?[A,n]:[A,w]:f>j?[]:f==j?x?[]:[d]:j>=N?[d,n]:[d,w]}function N(k,t,E,u){var $=1e-10,c=t.x-k.x,W=t.y-k.y,U=E.x-k.x,r=E.y-k.y,F=u.x-k.x,B=u.y-k.y,n=c*r-W*U,J=c*B-W*F;if(R(n)>$){var p=F*r-B*U;return n>0?J>=0&&p>=0:J>=0||p>=0}return J>0}function l(e,y){function a(w,t){var B=v.length-1,V=w-1;0>V&&(V=B);var n=w+1;n>B&&(n=0);var O=N(v[w],v[V],v[n],r[t]);if(!O)return!1;var j=r.length-1,R=t-1;0>R&&(R=j);var g=t+1;return g>j&&(g=0),O=N(r[t],r[R],r[g],v[w]),O?!0:!1}function z(d,C){var I,K,W;for(I=0;I<v.length;I++)if(K=I+1,K%=v.length,W=L(d,C,v[I],v[K],!0),W.length>0)return!0;return!1}function p(i,x){var c,Z,I,j,R;for(c=0;c<_.length;c++)for(Z=y[_[c]],I=0;I<Z.length;I++)if(j=I+1,j%=Z.length,R=L(i,x,Z[I],Z[j],!0),R.length>0)return!0;return!1}for(var r,w,O,H,d,E,P,S,G,F,n,v=e.concat(),_=[],q=[],Q=0,W=y.length;W>Q;Q++)_.push(Q);for(var K=0,U=2*_.length;_.length>0&&(U--,!(0>U));)for(O=K;O<v.length;O++){H=v[O],w=-1;for(var Q=0;Q<_.length;Q++)if(E=_[Q],P=H.x+":"+H.y+":"+E,q[P]===s){r=y[E];for(var Z=0;Z<r.length;Z++)if(d=r[Z],a(O,Z)&&!z(H,d)&&!p(H,d)){w=Z,_.splice(Q,1),S=v.slice(0,O+1),G=v.slice(O),F=r.slice(w),n=r.slice(0,w+1),v=S.concat(F).concat(n).concat(G),K=O;break}if(w>=0)break;q[P]=!0}if(w>=0)break}return v}for(var k,B,q,Q,w,m,X={},P=U.concat(),A=0,y=i.length;y>A;A++)Array.prototype.push.apply(P,i[A]);for(k=0,B=P.length;B>k;k++)w=P[k].x+":"+P[k].y,X[w]!==s,X[w]=k;var r=l(U,i),e=pf.Triangulate(r,!1);for(k=0,B=e.length;B>k;k++)for(Q=e[k],q=0;3>q;q++)w=Q[q].x+":"+Q[q].y,m=X[w],m!==s&&(Q[q]=m);return e.concat()},isClockWise:function(D){return pf.Triangulate.area(D)<0},b2p0:function(R,y){var r=1-R;return r*r*y},b2p1:function(f,r){return 2*(1-f)*f*r},b2p2:function(b,Q){return b*b*Q},b2:function(I,s,S,E){return this.b2p0(I,s)+this.b2p1(I,S)+this.b2p2(I,E)},b3p0:function(y,n){var I=1-y;return I*I*I*n},b3p1:function(i,C){var f=1-i;return 3*f*f*i*C},b3p2:function(E,H){var k=1-E;return 3*k*E*E*H},b3p3:function(f,l){return f*f*f*l},b3:function(Q,F,Y,n,I){return this.b3p0(Q,F)+this.b3p1(Q,Y)+this.b3p2(Q,n)+this.b3p3(Q,I)}},pf={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var I=j.keys(this.faces);return I.length?I[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(X){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(w){var i=w.familyName.toLowerCase(),E=this;return E.faces[i]=E.faces[i]||{},E.faces[i][w.cssFontWeight]=E.faces[i][w.cssFontWeight]||{},E.faces[i][w.cssFontWeight][w.cssFontStyle]=w,w},drawText:function(E){var r,f=this.getFace(),q=this.size/f.resolution,I=0,n=String(E).split(""),R=n.length,c=[];for(r=0;R>r;r++){var C=new vj,j=this.extractGlyphPoints(n[r],f,q,I,C);j&&(I+=j.offset*this.spacing,c.push(j.path))}var P=I/2;return{paths:c,offset:P}},extractGlyphPoints:function(q,M,Z,x,b){var o,$,G,X,g,K,n,L,m,p,R,D,a,C,h,U,S,l,z,t=[],k=M.glyphs[q]||M.glyphs["?"];if(k){if(k.o)for(X=k._cachedOutline||(k._cachedOutline=k.o.split(" ")),K=X.length,n=Z,L=Z,o=0;K>o;)switch(g=X[o++]){case"m":m=X[o++]*n+x,p=X[o++]*L,b.moveTo(m,p);break;case"l":m=X[o++]*n+x,p=X[o++]*L,b.lineTo(m,p);break;case"q":if(R=X[o++]*n+x,D=X[o++]*L,h=X[o++]*n+x,U=X[o++]*L,b.quadraticCurveTo(h,U,R,D),z=t[t.length-1])for(a=z.x,C=z.y,$=1,G=this.divisions;G>=$;$++){var s=$/G;pk.b2(s,a,h,R),pk.b2(s,C,U,D)}break;case"b":if(R=X[o++]*n+x,D=X[o++]*L,h=X[o++]*n+x,U=X[o++]*L,S=X[o++]*n+x,l=X[o++]*L,b.bezierCurveTo(h,U,S,l,R,D),z=t[t.length-1])for(a=z.x,C=z.y,$=1,G=this.divisions;G>=$;$++){var s=$/G;pk.b3(s,a,h,S,R),pk.b3(s,C,U,l,D)}}return{offset:k.ha*Z,path:b}}}};pf.generateShapes=function(U,r){r=r||{};var E=r.font;if(E===s&&(E=pf.getDefaultFont(),!E))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var m=r.size!==s?r.size:1,x=r.curveSegments!==s?r.curveSegments:4,n=r.spacing!==s?r.spacing:1,f=r.weight!==s?r.weight:"normal",e=r.style!==s?r.style:"normal";pf.size=m,pf.divisions=x,pf.face=E,pf.weight=f,pf.style=e,pf.spacing=n;for(var C=pf.drawText(U),D=C.paths,S=[],u=0,X=D.length;X>u;u++)Array.prototype.push.apply(S,D[u].toShapes());return S},function(y){var m=1e-10,d=function(P,T){var L=P.length;if(3>L)return null;var y,f,k,p=[],u=[],Z=[];if(F(P)>0)for(f=0;L>f;f++)u[f]=f;else for(f=0;L>f;f++)u[f]=L-1-f;var M=L,S=2*M;for(f=M-1;M>2;){if(S--<=0)return T?Z:p;if(y=f,y>=M&&(y=0),f=y+1,f>=M&&(f=0),k=f+1,k>=M&&(k=0),N(P,y,f,k,M,u)){var v,a,V,C,E;for(v=u[y],a=u[f],V=u[k],p.push([P[v],P[a],P[V]]),Z.push([u[y],u[f],u[k]]),C=f,E=f+1;M>E;C++,E++)u[C]=u[E];M--,S=2*M}}return T?Z:p},F=function(e){for(var p=e.length,G=0,D=p-1,A=0;p>A;D=A++)G+=e[D].x*e[A].y-e[A].x*e[D].y;return.5*G},N=function(w,x,i,z,b,j){var d,U,H,r,I,N,a,$,C;if(U=w[j[x]].x,H=w[j[x]].y,r=w[j[i]].x,I=w[j[i]].y,N=w[j[z]].x,a=w[j[z]].y,m>(r-U)*(a-H)-(I-H)*(N-U))return!1;var L,J,e,f,X,h,V,K,R,Z,Y,F,v,D,Q;for(L=N-r,J=a-I,e=U-N,f=H-a,X=r-U,h=I-H,d=0;b>d;d++)if($=w[j[d]].x,C=w[j[d]].y,!($===U&&C===H||$===r&&C===I||$===N&&C===a)&&(V=$-U,K=C-H,R=$-r,Z=C-I,Y=$-N,F=C-a,Q=L*Z-J*R,v=X*K-h*V,D=e*F-f*Y,Q>=-m&&D>=-m&&v>=-m))return!1;return!0};return y.Triangulate=d,y.Triangulate.area=F,y}(pf),F._typeface_js={faces:pf.faces,loadFace:pf.loadFace};var Pl=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},yj=Pl.prototype={constructor:Pl,computeFaceNormals:function(){for(var H=new es,L=new es,w=0,E=this.faces.length;E>w;w++){var I=this.faces[w],i=this.vertices[I.a],C=this.vertices[I.b],X=this.vertices[I.c];H.subVectors(X,C),L.subVectors(i,C),H.cross(L),H.normalize(),I.normal.copy(H)}},computeVertexNormals:function(C){var h,n,$,m,X,H;for(H=new Array(this.vertices.length),h=0,n=this.vertices.length;n>h;h++)H[h]=new es;if(C){var q,E,Q,b=new es,Z=new es;for($=0,m=this.faces.length;m>$;$++)X=this.faces[$],q=this.vertices[X.a],E=this.vertices[X.b],Q=this.vertices[X.c],b.subVectors(Q,E),Z.subVectors(q,E),b.cross(Z),H[X.a].add(b),H[X.b].add(b),H[X.c].add(b)}else for($=0,m=this.faces.length;m>$;$++)X=this.faces[$],H[X.a].add(X.normal),H[X.b].add(X.normal),H[X.c].add(X.normal);for(h=0,n=this.vertices.length;n>h;h++)H[h].normalize();for($=0,m=this.faces.length;m>$;$++)X=this.faces[$],X.vertexNormals[0]=H[X.a].clone(),X.vertexNormals[1]=H[X.b].clone(),X.vertexNormals[2]=H[X.c].clone()},mergeVertices:function(){var I,r,U,e,M,u,c,T,J={},S=[],w=[],b=4,$=V(10,b);for(U=0,e=this.vertices.length;e>U;U++)I=this.vertices[U],r=G(I.x*$)+"_"+G(I.y*$)+"_"+G(I.z*$),J[r]===s?(J[r]=U,S.push(this.vertices[U]),w[U]=S.length-1):w[U]=w[J[r]];var q=[];for(U=0,e=this.faces.length;e>U;U++){M=this.faces[U],M.a=w[M.a],M.b=w[M.b],M.c=w[M.c],u=[M.a,M.b,M.c];for(var B=0;3>B;B++)if(u[B]==u[(B+1)%3]){q.push(U);break}}for(U=q.length-1;U>=0;U--){var x=q[U];for(this.faces.splice(x,1),c=0,T=this.faceVertexUvs.length;T>c;c++)this.faceVertexUvs[c].splice(x,1)}var R=this.vertices.length-S.length;return this.vertices=S,R}},Of=function(m,Y,q,H,y,X,V){this.aX=m,this.aY=Y,this.xRadius=q,this.yRadius=H,this.aStartAngle=y,this.aEndAngle=X,this.aClockwise=V};Of.prototype=Yc(wq),Of.prototype.getPoint=function(R){var C,q=this.aEndAngle-this.aStartAngle;0>q&&(q+=b),q>b&&(q-=b),C=this.aClockwise===!0?this.aEndAngle+(1-R)*(b-q):this.aStartAngle+R*q;var Z=this.aX+this.xRadius*X(C),B=this.aY+this.yRadius*U(C);return new be(Z,B)};var ul=function(x,E){this.v1=x,this.v2=E},ak=ul.prototype=Yc(wq);ak.getPoint=function(x){var S=this.v2.clone().sub(this.v1);return S.multiplyScalar(x).add(this.v1),S},ak.getPointAt=function(o){return this.getPoint(o)},ak.getTangent=function(){var I=this.v2.clone().sub(this.v1);return I.normalize()};var gi=function(l,f,Q){this.v0=l,this.v1=f,this.v2=Q};gi.prototype=Yc(wq),gi.prototype.getPoint=function(e){var Q,j;return Q=pk.b2(e,this.v0.x,this.v1.x,this.v2.x),j=pk.b2(e,this.v0.y,this.v1.y,this.v2.y),new be(Q,j)};var hr=function(k,z,s,c){this.v0=k,this.v1=z,this.v2=s,this.v3=c};hr.prototype=Yc(wq),hr.prototype.getPoint=function(r){var S,E;return S=pk.b3(r,this.v0.x,this.v1.x,this.v2.x,this.v3.x),E=pk.b3(r,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new be(S,E)},zm.create(function(g,v){this.v1=g,this.v2=v},function(A){var f=new es;return f.subVectors(this.v2,this.v1),f.multiplyScalar(A),f.add(this.v1),f});var Nd=zm.create(function(O,v,t){this.v0=O,this.v1=v,this.v2=t},function(O){var g,B,H;return g=pk.b2(O,this.v0.x,this.v1.x,this.v2.x),B=pk.b2(O,this.v0.y,this.v1.y,this.v2.y),H=pk.b2(O,this.v0.z,this.v1.z,this.v2.z),new es(g,B,H)}),wp=zm.create(function(r,E,y,S){this.v0=r,this.v1=E,this.v2=y,this.v3=S},function(x){var E,e,p;return E=pk.b3(x,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e=pk.b3(x,this.v0.y,this.v1.y,this.v2.y,this.v3.y),p=pk.b3(x,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new es(E,e,p)}),qo=function(g,w,J,v,e,z,R,K){Pl.call(this),v=v!==s?v:.5,e=e!==s?e:.5,K=K!==s?K:1,g=g||8,z=z||0,R=R||b;var u,l,d=1,E=K/2,Q=[],C=[],j=this.vertices,M=this.faces,N=this.faceVertexUvs;for(l=0;d>=l;l++){var O=[],t=[],y=l/d,n=y*(e-v)+v;for(u=0;g>=u;u++){var F=u/g,A=new es,i=-(F*R+z);A.z=n*U(i),A.y=-y*K+E,A.x=n*X(i),j.push(A),O.push(j.length-1),t.push(new be(F,y))}Q.push(O),C.push(t)}var Z,G,W=(e-v)/K;for(u=0;g>u;u++)for(0!==v?(Z=j[Q[0][u]].clone(),G=j[Q[0][u+1]].clone()):(Z=j[Q[1][u]].clone(),G=j[Q[1][u+1]].clone()),Z.setY(k(Z.x*Z.x+Z.z*Z.z)*W).normalize(),G.setY(k(G.x*G.x+G.z*G.z)*W).normalize(),l=0;d>l;l++){var L=Q[l][u],a=Q[l+1][u],r=Q[l+1][u+1],$=Q[l][u+1],T=Z.clone(),D=Z.clone(),Y=G.clone(),x=G.clone(),m=C[l][u].clone(),p=C[l+1][u].clone(),S=C[l+1][u+1].clone(),H=C[l][u+1].clone();
M.push(new de(L,a,$,[T,D,x])),N[0].push([m,p,H]),M.push(new de(a,r,$,[D.clone(),Y,x.clone()])),N[0].push([p.clone(),S,H.clone()])}if(w&&v>0)for(this.vertices.push(new es(0,E,0)),u=0;g>u;u++){var L=Q[0][u],a=Q[0][u+1],r=this.vertices.length-1,T=new es(0,1,0),D=new es(0,1,0),Y=new es(0,1,0),m=C[0][u].clone(),p=C[0][u+1].clone(),S=new be(p.x,0);M.push(new de(L,a,r,[T,D,Y],null,1));var f=u/g*b,P=X(f),o=U(f),V=(u+1)/g*b,I=X(V),h=U(V);N[0].push([new be(.5+.5*P,.5+.5*o),new be(.5+.5*I,.5+.5*h),new be(.5,.5)])}if(J&&e>0)for(this.vertices.push(new es(0,-E,0)),u=0;g>u;u++){var L=Q[l][u+1],a=Q[l][u],r=j.length-1,T=new es(0,-1,0),D=new es(0,-1,0),Y=new es(0,-1,0),m=C[l][u+1].clone(),p=C[l][u].clone();M.push(new de(L,a,r,[T,D,Y],null,2));var f=u/g*b,P=X(f),o=U(f),V=(u+1)/g*b,I=X(V),h=U(V);N[0].push([new be(.5+.5*I,.5-.5*h),new be(.5+.5*P,.5-.5*o),new be(.5,.5)])}};qo.prototype=Yc(yj);var ps=function(_,q,M,Z,i,W,v){Pl.call(this),v=v||.5,_=_||16,q=q||16,M=(M!==s?M:0)-J,Z=Z!==s?Z:b,i=i!==s?i:0,W=W!==s?W:J;var K,D,k=[],Y=[],B=this.vertices,j=this.faces,x=this.faceVertexUvs;for(D=0;q>=D;D++){var e=[],V=[];for(K=0;_>=K;K++){var Q=K/_,S=D/q,r=new es;r.x=-v*X(M+Q*Z)*U(i+S*W),r.y=v*X(i+S*W),r.z=v*U(M+Q*Z)*U(i+S*W),B.push(r),e.push(B.length-1),V.push(new be(Q,S))}k.push(e),Y.push(V)}for(D=0;q>D;D++)for(K=0;_>K;K++){var y=k[D][K+1],l=k[D][K],o=k[D+1][K],P=k[D+1][K+1],F=B[y].clone().normalize(),I=B[l].clone().normalize(),z=B[o].clone().normalize(),L=B[P].clone().normalize(),T=Y[D][K+1].clone(),h=Y[D][K].clone(),c=Y[D+1][K].clone(),t=Y[D+1][K+1].clone();R(B[y].y)===v?(T.x=(T.x+h.x)/2,j.push(new de(y,o,P,[F,z,L])),x[0].push([T,c,t])):R(B[o].y)===v?(c.x=(c.x+t.x)/2,j.push(new de(y,l,o,[F,I,z])),x[0].push([T,h,c])):(j.push(new de(y,l,P,[F,I,L])),x[0].push([T,h,t]),j.push(new de(l,o,P,[I.clone(),z,L.clone()])),x[0].push([h.clone(),c,t.clone()]))}};ps.prototype=Yc(yj);var $n=function(N,e,m,D,t,S){Pl.call(this),N=N||.33,e=e||.17,D=D||8,m=m||6,t=t||0,S=S||b;for(var O=new es,j=[],a=[],G=0;D>=G;G++)for(var r=G/D*b+J,P=0;m>=P;P++){var d=P/m*S+t;O.x=N*X(d),O.z=-N*U(d);var s=new es,K=N+e*X(r);s.x=K*X(d),s.z=-K*U(d),s.y=e*U(r),this.vertices.push(s),j.push(new be(P/m,1-G/D)),a.push(s.clone().sub(O).normalize())}for(var G=1;D>=G;G++)for(var P=1;m>=P;P++){var Q=(m+1)*G+P-1,E=(m+1)*(G-1)+P-1,C=(m+1)*(G-1)+P,I=(m+1)*G+P,u=new de(Q,E,I,[a[Q].clone(),a[E].clone(),a[I].clone()]);this.faces.push(u),this.faceVertexUvs[0].push([j[Q].clone(),j[E].clone(),j[I].clone()]),u=new de(E,C,I,[a[E].clone(),a[C].clone(),a[I].clone()]),this.faces.push(u),this.faceVertexUvs[0].push([j[E].clone(),j[C].clone(),j[I].clone()])}this.computeFaceNormals()};$n.prototype=Yc(yj);var Mq=function(G,j,m){return G?(Pl.call(this),G=G instanceof Array?G:[G],this.addShapeList(G,j),j.convertYZ!==!1&&ac(this,m),this.computeFaceNormals(),void 0):(G=[],void 0)},Xk=Mq.prototype=Yc(Pl.prototype);Xk.addShapeList=function(W,B){for(var M=W.length,Q=0;M>Q;Q++){var K=W[Q];this.addShape(K,B)}},Xk.addShape=function(E,a){function e(){if(a.bottom)for(var w=0;Q>w;w++)C=K[w],j(C[2],C[1],C[0],!0);if(a.top)for(w=0;Q>w;w++)C=K[w],j(C[0]+g*T,C[1]+g*T,C[2]+g*T,!1)}function G(){var i=0;for(o(N,i),i+=N.length,y=0,k=S.length;k>y;y++)W=S[y],o(W,i),i+=W.length}function o(d,R){for(var o,z,y=d.length;--y>=0;){o=y,z=y-1,0>z&&(z=d.length-1);var n=0,m=T;for(n=0;m>n;n++){var V=g*n,r=g*(n+1),K=R+o+V,v=R+z+V,k=R+z+r,i=R+o+r;F(K,v,k,i,d,n,m,o,z)}}}function $(i,E,j){q.vertices.push(new es(i,E,j))}function j(z,s,y,$){z+=h,s+=h,y+=h,q.faces.push(new de(z,s,y,null,null,$?2:1));var O=$?m.generateBottomUV(q,E,a,z,s,y):m.generateTopUV(q,E,a,z,s,y);q.faceVertexUvs[0].push(O)}function F(L,U,i,r,T,w,f,k,V){L+=h,U+=h,i+=h,r+=h,q.faces.push(new de(L,U,r)),q.faces.push(new de(U,i,r));var b=m.generateSideWallUV(q,E,T,a,L,U,i,r,w,f,k,V);q.faceVertexUvs[0].push([b[0],b[1],b[3]]),q.faceVertexUvs[0].push([b[1],b[2],b[3]])}var R,u,c,I,M,t=a.amount,i=a.curveSegments||cn,T=a.steps||1,X=a.extrudePath,P=!1,m=new $l(a.repeatUVLength);X&&(R=X.getSpacedPoints(T),P=!0,u=a.frames!==s?a.frames:new ai.FrenetFrames(X,T,!1),c=new es,I=new es,M=new es);var W,y,k,q=this,h=this.vertices.length,L=E.extractPoints(i),p=L.shape,S=L.holes,v=!pk.isClockWise(p);if(v){for(p=p.reverse(),y=0,k=S.length;k>y;y++)W=S[y],pk.isClockWise(W)&&(S[y]=W.reverse());v=!1}var K=pk.triangulateShape(p,S),N=p;for(y=0,k=S.length;k>y;y++)W=S[y],p=p.concat(W);for(var D,C,g=p.length,Q=K.length,Z=0;g>Z;Z++)D=p[Z],P?(I.copy(u.normals[0]).multiplyScalar(D.x),c.copy(u.binormals[0]).multiplyScalar(D.y),M.copy(R[0]).add(I).add(c),$(M.x,M.y,M.z)):$(D.x,D.y,0);var V;for(V=1;T>=V;V++)for(Z=0;g>Z;Z++)D=p[Z],P?(I.copy(u.normals[V]).multiplyScalar(D.x),c.copy(u.binormals[V]).multiplyScalar(D.y),M.copy(R[V]).add(I).add(c),$(M.x,M.y,M.z)):$(D.x,D.y,t/T*V);e(),G()};var ai=function($,_,n,A,R){function x(R,P,G){return M.vertices.push(new es(R,P,G))-1}Pl.call(this),_=_||64,n=n||1,A=A||8,R=R||!1;var k,f,G,y,j,I,l,s,r,p,g,a,J,O,C,N,v,F,L,m,Q=[],M=this,z=_+1,i=new es,D=new ai.FrenetFrames($,_,R),q=D.tangents,t=D.normals,H=D.binormals;for(this.tangents=q,this.normals=t,this.binormals=H,r=0;z>r;r++)for(Q[r]=[],y=r/(z-1),s=$.getPointAt(y),k=q[r],f=t[r],G=H[r],p=0;A>p;p++)j=p/A*b,I=-n*X(j),l=n*U(j),i.copy(s),i.x+=I*f.x+l*G.x,i.y+=I*f.y+l*G.y,i.z+=I*f.z+l*G.z,Q[r][p]=x(i.x,i.y,i.z);for(r=0;_>r;r++)for(p=0;A>p;p++)g=R?(r+1)%_:r+1,a=(p+1)%A,J=Q[r][p],O=Q[g][p],C=Q[g][a],N=Q[r][a],v=new be(r/_,p/A),F=new be((r+1)/_,p/A),L=new be((r+1)/_,(p+1)/A),m=new be(r/_,(p+1)/A),this.faces.push(new de(J,O,N)),this.faceVertexUvs[0].push([v,F,m]),this.faces.push(new de(O,C,N)),this.faceVertexUvs[0].push([F.clone(),L,m.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};ai.prototype=Yc(yj),ai.FrenetFrames=function(t,A,U){function N(){W[0]=new es,f[0]=new es,c=Number.MAX_VALUE,z=R(y[0].x),q=R(y[0].y),p=R(y[0].z),c>=z&&(c=z,K.set(1,0,0)),c>=q&&(c=q,K.set(0,1,0)),c>=p&&K.set(0,0,1),e.crossVectors(y[0],K).normalize(),W[0].crossVectors(y[0],e),f[0].crossVectors(y[0],W[0])}var v,c,z,q,p,b,V,K=new es,y=[],W=[],f=[],e=new es,h=new Ig,n=A+1,$=1e-4;for(this.tangents=y,this.normals=W,this.binormals=f,b=0;n>b;b++)V=b/(n-1),y[b]=t.getTangentAt(V),y[b].normalize();for(N(),b=1;n>b;b++)W[b]=W[b-1].clone(),f[b]=f[b-1].clone(),e.crossVectors(y[b-1],y[b]),e.length()>$&&(e.normalize(),v=I(rc(y[b-1].dot(y[b]),-1,1)),W[b].applyMatrix4(h.makeRotationAxis(e,v))),f[b].crossVectors(y[b],W[b]);if(U)for(v=I(rc(W[0].dot(W[n-1]),-1,1)),v/=n-1,y[0].dot(e.crossVectors(W[0],W[n-1]))>0&&(v=-v),b=1;n>b;b++)W[b].applyMatrix4(h.makeRotationAxis(y[b],v*b)),f[b].crossVectors(y[b],W[b])};var to=function(r,Z,Y,E){Pl.call(this),Z=Z||18,Y=Y||0,E=E==i?b:E;for(var B=1/(r.length-1),A=1/Z,N=0,W=Z;W>=N;N++)for(var t=Y+N*A*E,x=X(t),j=U(t),n=0,T=r.length;T>n;n++){var K=r[n],f=new es;f.x=x*K.x-j*K.y,f.y=j*K.x+x*K.y,f.z=K.z,this.vertices.push(f)}for(var I=r.length,N=0,W=Z;W>N;N++)for(var n=0,T=r.length-1;T>n;n++){var v=n+I*N,F=v,M=v+I,x=v+1+I,H=v+1,O=N*A,s=n*B,R=O+A,p=s+B;this.faces.push(new de(F,H,M)),this.faceVertexUvs[0].push([new be(O,s),new be(O,p),new be(R,s)]),this.faces.push(new de(M,H,x)),this.faceVertexUvs[0].push([new be(R,s),new be(O,p),new be(R,p)])}this.mergeVertices(),ac(this),this.computeFaceNormals(),this.computeVertexNormals()};to.prototype=Yc(yj);var no=function(c,K){K=K||{};var F=pf.generateShapes(c,K);K.amount=K.amount!==s?K.amount:.5,K.convertYZ=!1,K.fill!==!1&&(K.bottom=!0,K.top=!0),Mq.call(this,F,K)};no.prototype=Yc(Xk);var qk=r.Node=function(){Kh(qk,this)},_o={X:nd,Y:Vf,Z:Qi},Sg={X:0,Y:1,Z:2},Kl={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},yq="xzy",Gn=function(P,D,d){if(D){var C=D[0],r=D[1],m=D[2];"xzy"===d?(Vf(P,r),Qi(P,m),nd(P,C)):"xyz"===d?(Qi(P,m),Vf(P,r),nd(P,C)):"yxz"===d?(Qi(P,m),nd(P,C),Vf(P,r)):"yzx"===d?(nd(P,C),Qi(P,m),Vf(P,r)):"zxy"===d?(Vf(P,r),nd(P,C),Qi(P,m)):"zyx"===d?(nd(P,C),Vf(P,r),Qi(P,m)):(Vf(P,r),Qi(P,m),nd(P,C))}};zr("Node",El,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:yq,_64O:0,_rotationX:0,_53O:0,_host:i,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return sc},_22Q:function(){return oe},getX:function(){return this.p().x},setX:function(Q){this.p(Q,this.p().y)},getY:function(){return this.p().y},setY:function(V){this.p(this.p().x,V)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(m){this.setAnchor(m,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(P){this.setAnchor(this.getAnchor().x,P)},getScaleX:function(){return this.getScale().x},setScaleX:function(K){this.setScale(K,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(u){this.setScale(this.getScale().x,u)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(K,d){pq(K,gg(i,i,this.r3(),this.getRotationMode())),this.translate3d(K[0]*d,K[1]*d,K[2]*d)},translateFront:function(W){this.translate3dBy([0,0,1],W)},translateBack:function(O){this.translate3dBy([0,0,-1],O)},translateLeft:function(t){this.translate3dBy([-1,0,0],t)},translateRight:function(V){this.translate3dBy([1,0,0],V)},translateTop:function(x){this.translate3dBy([0,1,0],x)},translateBottom:function(D){this.translate3dBy([0,-1,0],D)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(S,R,Y){1===arguments.length&&(R=S[1],Y=S[2],S=S[0]),this.p(S,Y),this.setElevation(R)},translate3d:function(S,e,n){1===arguments.length&&(e=S[1],n=S[2],S=S[0]),this.translate(S,n),this.setElevation(this._54O+e)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(l,e,z){1===arguments.length&&(e=l[1],z=l[2],l=l[0]),this.setSize(l,z),this.setTall(e)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(k,X,E){1===arguments.length&&(X=k[1],E=k[2],k=k[0]),this.setRotationX(k),this.setRotation(-X),this.setRotationZ(E)},setRotationY:function(X){this.setRotation(-X)},getRotationY:function(){return-this._64O},lookAtDirection:function(D,k){k=k||wg;var c=this,G=_m(D);k===wg?(c.r3([-l(D[1]/G),-K(D[2],D[0])+L,0]),c.setRotationMode("xzy")):k===lk?(c.r3(0,-K(D[2],D[0]),l(D[1]/G)),c.setRotationMode("zyx")):k===br?(c.r3(0,-K(D[2],D[0])+J,-l(D[1]/G)),c.setRotationMode("zyx")):k===bm?(c.r3([-l(D[1]/G)+L,-K(D[2],D[0])+L,0]),c.setRotationMode("xzy")):k===Lp&&(c.r3([-l(D[1]/G)-L,-K(D[2],D[0])+L,0]),c.setRotationMode("xzy")),k===xs&&(c.r3([-l(D[1]/G)+J,-K(D[2],D[0])+L,J]),c.setRotationMode("zxy"))},lookAt:function(V,K){return this.lookAtDirection(_c(V,this.p3()),K)},lookAtX:function(){var B=new kc,p=new kc,N=new kc,I=new jq,G=new jq,F=new Ug;return function(S,X){var y=sf(this);if(I.fromArray(y),N.copy(this.p3()),B.copy(S).sub(N),!(B.lengthSq()<1e-6)){B.normalize(),X===wg?p.set(0,0,1):X===xs?p.set(0,0,-1):X===br?p.set(-1,0,0):X===lk?p.set(1,0,0):X===bm?p.set(0,1,0):X===Lp&&p.set(0,-1,0),p.applyMatrix4(I).sub(N).normalize();var L=Math.acos(B.dot(p));if(L){var T=B.clone().cross(p);T.lengthSq()<1e-6&&(X===bm||X===Lp?T.set(0,0,1).applyMatrix4(I).sub(N):T.set(0,1,0).applyMatrix4(I).sub(N)),T.normalize(),F.set(this.r3(),this.getRotationMode(),!0),I.makeRotationFromEuler(F),G.makeRotationAxis(T,-L),F.setFromRotationMatrix(G.multiply(I)),this.r3([F.x,F.y,F.z])}}}}(),getHost:function(){return this._host},setHost:function(x){var u=this;if(u!==x&&u._host!==x){var n=u._host;n&&n._removeAttach(u),u._host=x,u._host&&u._host._addAttach(u),u.fp("host",n,x),u.onHostChanged(n,x)}},getAttaches:function(){return this._69O},_addAttach:function(g){var u=this;u._69O||(u._69O=new Yi),u._69O.add(g),u.fp("attaches",i,g)},_removeAttach:function(C){var X=this;X._69O.remove(C),X._69O.isEmpty()&&delete X._69O,X.fp("attaches",C,i)},getImage:function(){if(this._pendingCheckImageJSON){var X=z.getImage(this._image);X&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Ti&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(u){var O=this,c=O._image,j=O.getWidth(),R=O.getHeight();O._image=u,O.fp("image",c,u)&&(null!=u&&(zo(u)||un(u)&&/\.json$/i.test(u))&&(this._pendingCheckImageJSON=!0),O.fp(as,j,O.getWidth()),O.fp(wr,R,O.getHeight()))},getElevation:function(){return this._54O},setElevation:function(e){var u=this;if(!u._50O){u._50O=1;var H=u._54O;u._54O=e,u.fp(Cf,H,e),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(G){var Z=this;if(!Z._49O){Z._49O=1;var H=Z._64O;Z._64O=G,Z.fp(oq,H,G),delete Z._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(b){var M=this;if(!M._51O){M._51O=1;var u=M._rotationX;M._rotationX=b,M.fp("rotationX",u,b),delete M._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(M){var $=this;if(!$._52O){$._52O=1;var r=$._53O;$._53O=M,$.fp("rotationZ",r,M),delete $._52O}},getPosition:function(){return this._position},setPosition:function(u,Z){var _=this;if(!_._50I){_._50I=1;var G;if(G=2===arguments.length?{x:u,y:Z}:u,G.x!==_._position.x||G.y!==_._position.y){var p=_._position;_._position=G,_.fp(Up,p,G)}delete _._50I}},translate:function(J,z){var b=this._position;this.p(b.x+J,b.y+z)},getWidth:function(){var g=this;if(g._width>=0)return g._width;var O=g.getStyle("shape3d");if(O){var Y=Gm(O);if(Y&&Y.rawS3)return Y.rawS3[0];if("billboard"===O||"plane"===O){var W=Ij(g.getStyle("shape3d.image"));return W?gq(W,g):20}}var W=Ij(g._image);return W?gq(W,g):20},setWidth:function(k){var D=this,G=D._width;D._width=k,D.fp(as,G,k)},getHeight:function(){var t=this;if(t._height>=0)return t._height;var m=t.getStyle("shape3d");if(m){var A=Gm(m);if(A&&A.rawS3)return A.rawS3[2];if("plane"===m){var N=Ij(t.getStyle("shape3d.image"));return N?eo(N,t):20}if("billboard"===m)return 2}var N=Ij(t._image);return N?eo(N,t):20},setHeight:function(A){var f=this,c=f._height;f._height=A,f.fp(wr,c,A)},getTall:function(){var E=this;if(E._tall>=0)return E._tall;var V=E.getStyle("shape3d");if(V){var z=Gm(V);if(z&&z.rawS3)return z.rawS3[1];if("billboard"===V){var L=Ij(E.getStyle("shape3d.image"));return L?eo(L,E):20}if("plane"===V)return 2}return 20},setTall:function(i){var W=this,j=W._tall;W._tall=i,W.fp("tall",j,i)},setSize:function(d,W){var C=this;2===arguments.length?(C.setWidth(d),C.setHeight(W)):(C.setWidth(d.width),C.setHeight(d.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(c,Q,s,g,k){var L=this,l=L.getAnchor(),T=L.getScale();arguments.length<=2&&(k=Q,Q=c.y,s=c.width,g=c.height,c=c.x);var S=k&&T.x<0?1-l.x:l.x,A=k&&T.y<0?1-l.y:l.y;L.p(c+s*S,Q+g*A),k&&(s/=Math.abs(T.x),g/=Math.abs(T.y)),L.setWidth(s),L.setHeight(g)},getMatrix:function(){var j=this,e=j._64O,q=j._position,T=j.getScale();return new zb(e,q.x,q.y,T.x,T.y)},getAnchorRect:function(){var t=this,V=t.getWidth(),Y=t.getHeight(),F=t.getAnchor();return{x:-V*F.x,y:-Y*F.y,width:V,height:Y}},toLocal:function(D){return this.getMatrix().tfi(D)},toGlobal:function(l){return this.getMatrix().tf(l)},getAttachPosition:function(){var h=new zb;return function(L,P,t,E){t=t||0,E=E||0;var v=this,k=v.getAnchor(),y=v._64O,g=v._position,z=v.getScale();return h.setFromTransform(y,g.x,g.y).tf({x:t+z.x*v.getWidth()*(L-k.x),y:E+z.y*v.getHeight()*(P-k.y)})}}(),isInRect:function(n){n=this.toLocal(n);var F=this.getWidth(),R=this.getHeight();return n.x+=F*this.getAnchorX(),n.y+=R*this.getAnchorY(),!(n.x<0||n.y<0||n.x>F||n.y>R)},getRect:function(){var V=this,d=V.getWidth(),v=V.getHeight(),C=V.getAnchor(),K={x:-d*C.x,y:-v*C.y,width:d,height:v},D=V.getMatrix();return K=xn([D.tf(K.x,K.y),D.tf(K.x+K.width,K.y),D.tf(K.x+K.width,K.y+K.height),D.tf(K.x,K.y+K.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var Z=this,H=Z.getAnchor(),R=Z._anchorElevation;return{x:H.x,y:R,z:H.y}},setAnchorElevation:function(x){var H=this,N=H._anchorElevation;return N!==x?(H._anchorElevation=x,H.fp("anchorElevation",N,x),!0):!1},setAnchor3d:function(V,X,W,G){var N,j=this;"number"==typeof V?N={x:V,y:X,z:W}:(N=V.length?{x:V[0],y:V[1],z:V[2]}:V,G=X);var k=j.getDataModel();k&&k.beginTransaction();var L=j.getAnchor3d(),S=j.setAnchor(N.x,N.z);if(j.setAnchorElevation(N.y)&&(S=!0),S&&G&&!Ji){j.getAnchor3d();var b=sf(j),y=pq([N.x-L.x,N.y-L.y,N.z-L.z],b);j.p3(y)}return k&&k.endTransaction(),S},getAnchor:function(){var S=this;if(S.hasOwnProperty("_anchor"))return S._anchor;var C=Ij(S._image);return C&&C.anchorX!==s?{x:C.anchorX,y:C.anchorY}:S._anchor},setAnchor:function(K,l,L){var j,O=this;"number"==typeof K?j={x:K,y:l}:(j=K.length?{x:K[0],y:K[1]}:K,L=l);var w=O.getAnchor();if(w.x!==j.x||w.y!==j.y){var G=O.getDataModel();if(G&&G.beginTransaction(),O._anchor=j,O.fp("anchor",w,j),L&&!Ji){var s=O.getPosition(),c=O.getSize(),e=O.getRotation(),y=O.getScale(),F=-c.width*(w.x-j.x)*y.x,n=-c.height*(w.y-j.y)*y.y,E=U(e),I=X(e);O.setPosition(s.x+I*F-E*n,s.y+E*F+I*n)}return G&&G.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(i,Y){var s,l=this;s=2===arguments.length?{x:i,y:Y}:i;var D=l.getScale();(D.x!==s.x||D.y!==s.y)&&(l._scale=s,l.fp("scale",D,s))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var A=this,P=A._scaleTall,S=A.getScale();return[S.x,P,S.y]},getFinalScale3d:function(){var p=this,P=p.s3(),Y=p._dynamicScale3d,r=p.getScale3d();return P&&(r[0]*=P[0],r[1]*=P[1],r[2]*=P[2]),Y&&(r[0]*=Y[0],r[1]*=Y[1],r[2]*=Y[2]),r},getFinalRotation3d:function(){var x=this;return x._dynamicRotation||x.r3()},setScaleTall:function(I){var b=this,s=b._scaleTall;s!==I&&(b._scaleTall=I,b.fp("scaleTall",s,I))},setScale3d:function(N,Q,R){var i,w=this;i="number"==typeof N?{x:N,y:Q,z:R}:N.length?{x:N[0],y:N[1],z:N[2]}:N,w.setScaleTall(i.y),w.setScale(i.x,i.z)},getCorners:function(V,E){V==i&&(V=0),E==i&&(E=V);var p=this,Q=p.getAnchor(),w=p.getWidth(),r=p.getHeight(),$=-w*Q.x-V,e=-r*Q.y-E,_=w+2*V,y=r+2*E,D=p.getMatrix();return[D.tf($,e),D.tf($,e+y),D.tf($+_,e+y),D.tf($+_,e)]},getEditControlPoints:function(l,B,O){B==i&&(B=0),O==i&&(O=B);var M=this,V=M.getAnchor(),c=M.getWidth(),K=M.getHeight(),I=-c*V.x-B,n=-K*V.y-O,U=c+2*B,S=K+2*O;if(l)return[{x:I,y:n},{x:I,y:0},{x:I,y:n+S},{x:0,y:n+S},{x:I+U,y:n+S},{x:I+U,y:0},{x:I+U,y:n},{x:0,y:n}];var u=M.getMatrix();return[u.tf(I,n),u.tf(I,0),u.tf(I,n+S),u.tf(0,n+S),u.tf(I+U,n+S),u.tf(I+U,0),u.tf(I+U,n),u.tf(0,n)]},rotateAt:function(V,S,Z){var y=this,v=y._position,l=y._64O,z=new zb(l,v.x,v.y).tf(V,S),P=k(V*V+S*S),F=K(v.y-z.y,v.x-z.x)+Z;y.setRotation(l+Z),y.p(z.x+P*X(F),z.y+P*U(F))},onParentChanged:function(){qk.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var w={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(n){w[n]=!0}),function(t){var O=this;qk.superClass.onPropertyChanged.call(O,t),w[t.property]&&!O._layoutUpdating&&O.updateLayoutParameters(null,t.property),O._69O&&O._69O.each(function(J){J.handleHostPropertyChange(t)}),O._49I&&O._49I.each(function(_){_.fp("agentChange",!0,!1)})}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(T){this.updateAttach(T)},onStyleChanged:function(e){qk.superClass.onStyleChanged.apply(this,arguments),Bf[e]&&this.updateAttach()},updateAttach:function(W){var i=this;return Ji?(i.updateLayoutParameters(),void 0):(i._51I||(i._51I=1,i._71O(W),delete i._51I),void 0)},_71O:function(J){var U,R,g,z,I,Y,b=this,Q=b._host,d=J?J.property:i,j=J?J.oldValue:i,$=J?J.newValue:i;if(Q instanceof r.Grid){if(d===Cf)b.setElevation(b._54O+$-j);else if(!J||ym[d]){if(U=b.s("attach.row.index"),R=b.s("attach.column.index"),g=Q.getCellRect(U,R),!g)return;z=b.s("attach.row.span"),I=b.s("attach.column.span"),(1!==z||1!==I)&&(g=qh(g,Q.getCellRect(U+z-1,R+I-1))),fo(g,b,"attach.padding",1),b.setRect(g)}}else if(Q instanceof yg&&(Y=b.s("attach.index"))>=0&&(!J||pb[d])){var A=b.s("attach.thickness");A!=i&&b.setHeight(Q.getThickness()*A);var w=b.s("attach.offset"),C=Q.getPoints(),M=C.size();if(M>Y){var o=C.get(Y),V=M===Y+1?C.get(0):C.get(Y+1),N=[V.x-o.x,V.y-o.y],Z=_m(N);if(Z){b.s("attach.offset.relative")&&(w*=Z),b.s("attach.offset.opposite")&&(w=Z-w);var k={x:o.x+N[0]/Z*w,y:o.y+N[1]/Z*w},H=b.s("attach.gap");H&&(b.s("attach.gap.relative")&&(H*=Q.getThickness()),k=he(i,k,V,H)),b.p(k),b.setRotation(K(N[1],N[0]))}}}else J&&(d===Up?b.translate($.x-j.x,$.y-j.y):d===Cf?b.setElevation(b._54O+$-j):Gk[d]?b._11Q(Q,d,$-j):("anchor"===d||"width"===d||"height"===d||"scale"===d)&&b.layout(Q))},_11Q:function(){var J=new r.Math.Euler,l=r.Math.Euler.ReverseOrder,I=new r.Math.Vector2,P=new r.Math.Vector2;return function(t,g,F){var U=this,i=t.p3(),v=t.r3(),R=U.p3(),e=U.r3();if(g===oq&&(g="rotationY",F=-F),(g===oq||"rotationY"===g)&&0===e[0]&&0===e[2]&&0===v[0]&&0===v[2]&&0===R[1]&&0===i[1])return U.setRotation(-e[1]-F),I.set(R[0],R[2]).rotateAround(P.set(i[0],i[2]),-F),U.p(I.x,I.y),void 0;var A=Kl[t.getRotationMode()],X=A[0],b=A[1],r=A[2],c=_o[X],B=_o[b],W=_o[r],y=Fc();g===oq+X?(W(y,v[Sg[r]]),B(y,v[Sg[b]]),c(y,F),B(y,-v[Sg[b]]),W(y,-v[Sg[r]])):g===oq+b?(W(y,v[Sg[r]]),B(y,F),W(y,-v[Sg[r]])):g===oq+r&&W(y,F);var $=_c(R,i);pq($,y),U.p3(i[0]+$[0],i[1]+$[1],i[2]+$[2]);var p=U.getRotationMode();Gn(y,U.r3(),p),J.setFromRotationMatrix(y,l(p)),U.r3([J.x,J.y,J.z])}}(),isHostOn:function(r){var I=this;if(I._host&&r&&r._69O)for(var C={},Q=I._host;Q&&Q!==I&&!C[Q._id];){if(Q===r)return!0;C[Q._id]=Q,Q=Q._host}return!1},isLoopedHostOn:function(D){return this.isHostOn(D)&&D.isHostOn(this)},getScaledSize:function(){var O=this.getSize(),h=this.getScale();return O.width*=Math.abs(h.x),O.height*=Math.abs(h.y),O},layout:function(i){if(i=i||this.getHost()){var d=this,f=d.s("layout.h")||"center",C=d.s("layout.v")||"center";if("center"!==f||"center"!==C){var U=new r.Math.Vector2,P=i.getPosition(),q=i.getAnchor(),t=i.getScaledSize();d.getPosition();var c,Y,e,w,$,z=1,m=1;switch(d._layoutUpdating=!0,f){case"left":U.setX(d._layoutHValue-q.x*t.width);break;case"right":U.setX((1-q.x)*t.width-d._layoutHValue);break;case"leftright":c=t.width-d._layoutHValue[2],e=d.getRotation()-i.getRotation(),w=Math.abs(Math.sin(e)),$=Math.abs(Math.cos(e)),z+=$*c/d._layoutHValue[3],m+=w*c/d._layoutHValue[4],U.setX(d._layoutHValue[1]+(d._layoutHValue[5]-q.x)*t.width);break;case"center":U.setX((.5-q.x)*t.width-d._layoutHValue);break;case"scale":e=d.getRotation()-i.getRotation(),w=Math.abs(Math.sin(e)),$=Math.abs(Math.cos(e)),U.setX((.5-q.x)*t.width-d._layoutHValue[1]*t.width/d._layoutHValue[0]),Y=t.width/d._layoutHValue[2]-1,z+=$*Y,m+=w*Y}switch(C){case"top":U.setY(d._layoutVValue-q.y*t.height);break;case"bottom":U.setY((1-q.y)*t.height-d._layoutVValue);break;case"topbottom":e||(e=d.getRotation()-i.getRotation(),w=Math.abs(Math.sin(e)),$=Math.abs(Math.cos(e))),c=t.height-d._layoutVValue[2],z+=w*c/d._layoutVValue[3],m+=$*c/d._layoutVValue[4],U.setY(d._layoutVValue[1]+(d._layoutVValue[5]-q.y)*t.height);break;case"center":U.setY((.5-q.y)*t.height-d._layoutVValue);break;case"scale":e||(e=d.getRotation()-i.getRotation(),w=Math.abs(Math.sin(e)),$=Math.abs(Math.cos(e))),U.setY((.5-q.y)*t.height-d._layoutVValue[1]*t.height/d._layoutVValue[0]),Y=t.height/d._layoutVValue[2]-1,z+=w*Y,m+=$*Y}if("leftright"===f||"scale"===f||"topbottom"===C||"scale"===C){var E=this.getScale(),g=Math.abs(E.x),u=Math.abs(E.y);"leftright"===f||"scale"===f?d.setSize(d._layoutHValue[3]*z/g,d._layoutHValue[4]*m/u):d.setSize(d._layoutVValue[3]*z/g,d._layoutVValue[4]*m/u)}U.rotateAround(null,i.getRotation()),this.setPosition(U.x+P.x,U.y+P.y),d._layoutUpdating=s}}},updateLayoutParameters:function(D,g){if(D=D||this.getHost()){var x=this,J=x.s("layout.h"),s=x.s("layout.v");if(J||s){var a,f,M,I,e,G,B=new r.Math.Vector2,N=D.getPosition(),H=D.getAnchor(),X=D.getScaledSize(),d=x.getPosition(),v=x.getScaledSize();switch(B.set(d.x-N.x,d.y-N.y),B.rotateAround(null,-D.getRotation()),J){case"left":x._layoutHValue=B.x+H.x*X.width;break;case"right":x._layoutHValue=-B.x+(1-H.x)*X.width;break;case"center":x._layoutHValue=-B.x+(.5-H.x)*X.width;break;case"leftright":case"scale":"scale"===J?a=-B.x+(.5-H.x)*X.width:(f=x.getAnchor(),M=x.getRotation()-D.getRotation(),I=Math.cos(M),e=Math.sin(M),G=-Math.min(-f.x*I+f.y*e,-f.x*I-(1-f.y)*e,(1-f.x)*I+f.y*e,(1-f.x)*I-(1-f.y)*e),a=B.x-(G-H.x)*X.width),"position"===g&&"object"==typeof x._layoutHValue?(x._layoutHValue[0]=X.width,x._layoutHValue[1]=a):x._layoutHValue=[X.width,a,X.width,v.width,v.height,G]}switch(s){case"top":x._layoutVValue=B.y+H.y*X.height;break;case"bottom":x._layoutVValue=-B.y+(1-H.y)*X.height;break;case"center":x._layoutVValue=-B.y+(.5-H.y)*X.height;break;case"topbottom":case"scale":"scale"===s?a=-B.y+(.5-H.y)*X.height:(M||(f=x.getAnchor(),M=x.getRotation()-D.getRotation(),I=Math.cos(M),e=Math.sin(M)),G=-Math.min(-f.x*e-f.y*I,-f.x*e+(1-f.y)*I,(1-f.x)*e-f.y*I,(1-f.x)*e+(1-f.y)*I),a=B.y-(G-H.y)*X.height),"position"===g&&"object"==typeof x._layoutVValue?(x._layoutVValue[0]=X.height,x._layoutVValue[1]=a):x._layoutVValue=[X.height,a,X.height,v.width,v.height,G]}}}},getSerializableProperties:function(){var c=qk.superClass.getSerializableProperties.call(this);return Ej(c,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),c}});var Pe=r.Edge=function(U,z){var C=this;Kh(Pe,C),C.setSource(U),C.setTarget(z)};zr("Edge",El,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return uj},_22Q:function(){return sg},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(Z){if(Z===this)return!1;if(gj(Z))return!0;for(var a,k,X,L,D,Y=[this],_=-1,U=0;U>_;)if(_++,a=Y[_],k=a._44I)for(k=k.getArray(),L=0,D=k.length;D>L;L++)if(X=k[L],Cc(X)&&!(Y.indexOf(X)>=0)){if(X===Z)return!1;Y.push(X),U++}return!0},setSource:function(C){var n=this;if(n._source!==C&&n.canSetSourceTarget(C)){var H=n._source;n._source=C,H&&H._16I(n),C&&C._2I(n),n._7I(),n.fp("source",H,C)}},setTarget:function(V){var W=this;if(W._target!==V&&W.canSetSourceTarget(V)){var u=W._target;W._target=V,u&&u._18I(W),V&&V._4I(W),W._7I(),W.fp("target",u,V)}},isLooped:function(){var P=this;return P._source===P._target&&gj(P._source)&&gj(P._target)},onPropertyChanged:function(){var Q=this;Q._49I&&Q._49I.each(function(V){V.fp("agentChange",!0,!1)})},_7I:function(){var u,b=this,X=Ib(b);b._40I!==X&&(u=this._40I,u&&u._15I(b),b._40I=X,X&&X._1I(b),b.fp("sourceAgent",u,X),_n(u,b._41I),_n(X,b._41I));var l=pp(b);b._41I!==l&&(u=b._41I,u&&u._17I(b),b._41I=l,l&&l._3I(b),b.fp("targetAgent",u,l),_n(u,b._40I),_n(l,b._40I))},_22I:function(E){this._52I=E,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var r=this;return r._52I&&r._52I.get(0)!==r&&!r.getStyle(Hl)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var y=this,n=y._52I;return n&&!y.getStyle(Hl)&&n.size()>1&&y===n.get(0)},toggle:function(){var E=this._52I,M=!this.s(Hl);E&&E.size()>1&&(E.each(function(E){E.s(Hl,M)}),E.getSiblings().each(function(O){O!==E&&O.each(function(H){H.fp("edgeGroup",i,O)})}))},setStyle:function(g,S){(g===yf||"edge.segments"===g)&&(S=Mr(S)),Pe.superClass.setStyle.call(this,g,S)},onStyleChanged:function(z){Pe.superClass.onStyleChanged.apply(this,arguments),Pp[z]&&_n(this._41I,this._40I)},getSerializableProperties:function(){var Z=Pe.superClass.getSerializableProperties.call(this);return Ej(Z,{source:1,target:1}),Z}});var Oc=r.Group=function(){Kh(Oc,this)};zr("Group",qk,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return gh},onChildAdded:function(){Oc.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){Oc.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var g=this;if(!g._54I&&!Ji){var N=g.getChildrenRect();N&&(g._53I=1,g.p(cg(g.s("group.position"),N,g.getSize())),delete g._53I)}},getChildrenRect:function(){var W,V=this;return V.eachChild(function(Y){gj(Y)&&(W=qh(W,V.getChildRect(Y)))}),W},getChildRect:function(I){var C;return gj(I)&&I.s($r)&&(xh(I)&&I.isExpanded()&&I.eachChild(function(g){C=qh(C,I.getChildRect(g))}),!C&&I.getRect&&(C=I.getRect())),C},setPosition:function(t,Q){var O=this;if(!O._54I){var R;R=2===arguments.length?{x:t,y:Q}:t,Ji||O._53I||(O._54I=1,ii(O._children,R.x-O._position.x,R.y-O._position.y),delete O._54I),Oc.superClass.setPosition.call(this,R)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(e){var H=this;if(H._57O!==e){var S=H._57O;H._57O=e,H.fp("expanded",S,H._57O),H._fireInvalidateDeep(),H._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(M){xh(M)?M._fireInvalidateDeep():M.iv()})},_8I:function(){Oc.superClass._8I.call(this),this.eachChild(function(F){gj(F)&&F._8I()})},onStyleChanged:function(Y){Oc.superClass.onStyleChanged.apply(this,arguments),"group.position"===Y&&this._81I()},getSerializableProperties:function(){var e=Oc.superClass.getSerializableProperties.call(this);return e.expanded=1,e}});var Mb=r.Block=function(){Kh(Mb,this)};zr("Block",qk,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return ok},onChildAdded:function(){Mb.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Mb.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var D=this;if(!Ji&&!D._updatingToChildren&&D._syncSize&&!D._freezeSyncFromChildren){var p,v,J,C,E,g=[],H=D.getRotation();if(D.eachChild(function(c){gj(c)&&g.push.apply(g,c.getCorners())}),g.length){D._updatingFromChildren=1;var z=X(-H),f=U(-H),r=1/0,b=-1/0,M=1/0,k=-1/0;for(C=0,E=g.length;E>C;C++)J=g[C],p=J.x,v=J.y,J.x=z*p-f*v,J.y=f*p+z*v,r=_(r,J.x),b=$(b,J.x),M=_(M,J.y),k=$(k,J.y);var Y=D.getScale();D.setSize(R((b-r)/Y.x),R((k-M)/Y.y));var L;Y.x<0&&(L=r,r=b,b=L),Y.y<0&&(L=M,M=k,k=L),z=X(H),f=U(H);var B=D.getAnchor();p=r+(b-r)*B.x,v=M+(k-M)*B.y,D.setPosition(z*p-f*v,f*p+z*v),delete D._updatingFromChildren}}},setPosition:function(H,l){var F=this;if(!F._updatingToChildren){var c;c=2===arguments.length?{x:H,y:l}:H,Ji||F._updatingFromChildren||(F._updatingToChildren=1,ii(F._children,c.x-F._position.x,c.y-F._position.y),delete F._updatingToChildren),Mb.superClass.setPosition.call(this,c)}},setWidth:function(A){return this.setSize(A,this.getHeight())},setHeight:function(V){return this.setSize(this.getWidth(),V)},setSize:function(s,d){1>s&&(s=1),1>d&&(d=1);var D=this;if(!D._updatingToChildren){2!==arguments.length&&(d=s.height,s=s.width);var l=D.getWidth(),y=D.getHeight();if(s!==l&&Mb.superClass.setWidth.call(D,s),d!==y&&Mb.superClass.setHeight.call(D,d),!Ji&&!D._updatingFromChildren){D._updatingToChildren=1;var G=s/l,v=d/y;D._adjustChildScaleOrSize(G,v,"size"),delete D._updatingToChildren,D.updateFromChildren()}}},_adjustChildScaleOrSize:function(q,F,l){var Z=this;if(Z._syncSize){var d=Z.getPosition(),T=Z.getRotation();Z.getScale(),Z.eachChild(function(x){if(gj(x)){var z=x.getPosition(),Q=x.getRotation(),A=x.getWidth(),C=x.getHeight(),g=x.getScale(),B=g.x*A,o=g.y*C,$=new zb(Q,z.x,z.y,B,o);$.translate(-d.x,-d.y),$.rotate(-T),Q=K($.b*Math.sign(B),$.a*Math.sign(B)),$.scale(q,F);var L,m,V,M=X(Q);if(Math.abs(M)<.001?(L=U(Q),m=$.b/L,V=-$.c/L):(m=$.a/M,V=$.d/M),"scale"===l)x.setScale(m/A,V/C);
else if("size"===l){var P=m/g.x,n=V/g.y;x.setScale(Am(m)*Math.abs(g.x),Am(V)*Math.abs(g.y)),x instanceof r.Shape?(x.setWidthForce(Math.max(Math.abs(P),1e-5)),x.setHeightForce(Math.max(Math.abs(n),1e-5))):x.setSize(Math.max(.01,Math.abs(P)),Math.max(.01,Math.abs(n)))}$.rotate(T),$.translate(d.x,d.y),x.setPosition($.tx,$.ty)}})}},_calcChangeFactor:function(F,J,i,Q){var K,v,j,T;return K=R(F),v=R(i),j=K>v?K/v:v/K,K=R(J),v=R(Q),T=K>v?K/v:v/K,$(j,T)},setAnchor:function(){var W=this;if(!W._updatingToChildren){var c=W.getAnchor();if(Mb.superClass.setAnchor.apply(W,arguments),!Ji&&!W._updatingFromChildren&&W._syncSize){W._updatingToChildren=1;var f=W.getAnchor();W.getPosition();var O=W.getSize(),C=W.getScale(),S=W.getRotation(),l=-O.width*C.x*(c.x-f.x),_=-O.height*C.y*(c.y-f.y),J=U(S),H=X(S),t=H*l-J*_,B=J*l+H*_;W.eachChild(function(z){if(gj(z)){var J=z.getPosition();z.setPosition(J.x-t,J.y-B)}}),delete W._updatingToChildren}}},setRotation:function(c){var w=this;if(!w._updatingToChildren){var p=w.getRotation();if(Mb.superClass.setRotation.apply(w,arguments),!Ji&&!w._updatingFromChildren){w._updatingToChildren=1;var N=w.getPosition(),n=c-p;w.eachChild(function(G){if(gj(G)){var Y=G.getMatrix();Y.translate(-N.x,-N.y),Y.rotate(n),Y.translate(N.x,N.y);var b=Math.sign(G.getScale().x);G.setRotation(K(Y.b*b,Y.a*b)),G.setPosition(Y.tx,Y.ty)}}),delete w._updatingToChildren}}},setScale:function(E,m){var S=this;if(!S._updatingToChildren){null==m&&(m=E.y,E=E.x);var j=S.getScale();if(R(E)<.01&&(E=.01*(Am(E)||Am(j.x))),R(m)<.01&&(m=.01*(Am(m)||Am(j.y))),Mb.superClass.setScale.call(S,E,m),!Ji&&!S._updatingFromChildren){S._updatingToChildren=1;var L=E/j.x,H=m/j.y;S._adjustChildScaleOrSize(L,H,"size"),delete S._updatingToChildren,S.updateFromChildren()}}},getSerializableProperties:function(){var Q=Mb.superClass.getSerializableProperties.call(this);return Q.clickThroughEnabled=1,Q.syncSize=1,Q}});var Ym=r.Grid=function(){Kh(r.Grid,this)};zr("Grid",qk,{IRotatable:!1,_icon:"grid_icon",_image:i,getUIClass:function(){return Jk},setRotation:function(){},getCellRect:function(O,s){var g=this,Q=g.s("grid.row.count"),$=g.s("grid.column.count");if(0>=Q||0>=$||0>O||O>=Q||0>s||s>=$)return i;var U,o,F,M=g.getRect(),n=g.s("grid.row.percents"),L=g.s("grid.column.percents");if(fo(M,g,"grid.border",-1),n&&n._as&&(n=n._as),L&&L._as&&(L=L._as),n&&n.length===Q){for(F=0,U=0;O>U;U++)F+=M.height*n[U];M.y+=F,M.height=M.height*n[O]}else M.height=M.height/Q,M.y+=M.height*O;if(L&&L.length===$){for(o=0,U=0;s>U;U++)o+=M.width*L[U];M.x+=o,M.width=M.width*L[s]}else M.width=M.width/$,M.x+=M.width*s;return Lg(M,-g.s("grid.gap")),M}});var _f=r.Text=function(){Kh(_f,this),this.setSize(100,50),this.s("text","TEXT")};zr("Text",qk,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return ir},setWidth:function(A){A||(A=.001),_f.superClass.setWidth.call(this,A)},setHeight:function(g){g||(g=.001),_f.superClass.setHeight.call(this,g)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),Jh("__text__",{width:{value:100,isSafeFunc:!0,func:function(Q){return Q._width}},height:{value:50,isSafeFunc:!0,func:function(y){return y._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var yg=r.Shape=function(){Kh(yg,this),this._59O=new Yi};yg.__de__=di,zr("Shape",qk,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return ep},_22Q:function(){return cc},getLength:function(G){return Fe(Wg(this._59O,this._58O,G,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var m=this._58O;return m?new Yi(m._as.slice(0)):m},setSegments:function(E){var u=this._58O;E=E?Qb(E)?new Yi(E.slice(0)):new Yi(E._as.slice(0)):null,(u&&E&&u._as.join(",")!==E._as.join(",")||u!==E)&&(this._58O=E,this.fp("segments",u,E))},getPoints:function(){return this._59O},toPoints:function(){var t=this._59O;return new Yi(t._as.slice(0))},setPoints:function(G,K){var X=this,i=X._59O;G=G?Qb(G)?new Yi(G.slice(0)):new Yi(G._as.slice(0)):new Yi;var t,u,e,x,B,I;K&&(t=X.getPosition(),I=new zb(X.getRotation(),0,0,X.getScale().x,X.getScale().y)),(i&&G&&i._as.join(",")!==G._as.join(",")||i!==G)&&(X._59O=G,X.fs(),X.fp("points",i,G)),K&&(u=X.getPosition(),e=u.x-t.x,x=u.y-t.y,B=I.tf(e,x),X.setPosition(u.x-e+B.x,u.y-x+B.y))},addPoint:function(U,W,u){var $=this.toPoints();$.add(U,W),this.setPoints($,u)},setPoint:function(P,N,m){var U=this.toPoints();U.set(P,N),this.setPoints(U,m)},removePointAt:function(c){var i=this.toPoints();i.removeAt(c),this.setPoints(i)},setWidthForce:function(J){var U=this;if(!U._55I&&!Ji&&U.getWidth()){U._55I=1;var u=U._position.x,K=J/U.getWidth(),G=U.toPoints(),r=new Yi;1!==K&&(G.each(function(c){r.add({x:(c.x-u)*K+u,y:c.y,e:c.e})}),U.setPoints(r),qe(U,[K,0,0,1,u*(1-K),0]),U.fs()),delete U._55I}yg.superClass.setWidth.call(U,J)},setWidth:function(a){return this.setWidthForce(1>a?1:a)},setHeightForce:function(K){var U=this;if(!U._55I&&!Ji&&U.getHeight()){U._55I=1;var z=U._position.y,G=K/U.getHeight(),w=U.toPoints(),r=new Yi;1!==G&&(w.each(function(J){r.add({x:J.x,y:(J.y-z)*G+z,e:J.e})}),U.setPoints(r),qe(U,[1,0,0,G,0,z*(1-G)]),U.fs()),delete U._55I}yg.superClass.setHeight.call(U,K)},setHeight:function(W){return this.setHeightForce(1>W?1:W)},setAnchorElevation:function(F){var g=this;g._55I=!0;var U=g._updatingAnchor3d,W=!Ji&&!U;if(W){var a,m=F,L=g.getAnchorElevation(),l=g.getTall();a=l*(L-m),0!==a&&g.shiftPointsElevation(a)}var V=yg.superClass.setAnchorElevation.apply(g,arguments);return U||delete g._55I,V},getShapeElevation:function(){var V=this,W=V._54O;return W-(V.getTall()||0)*(V._anchorElevation-.5)},setAnchor3d:function(k,P,C,e){var m,J=this;"number"==typeof k?m={x:k,y:P,z:C}:(m=k.length?{x:k[0],y:k[1],z:k[2]}:k,e=P),J._55I=!0,J._updatingAnchor3d=!0;var d=J.getDataModel();if(d&&d.beginTransaction(),!Ji){var Z=J.getAnchor3d(),A=J.getSize(),T=J.getTall(),Q=A.width*(Z.x-m.x),E=A.height*(Z.z-m.z),r=T*(Z.y-m.y);e||J.shiftPoints(Q,E,r);var M=J.p3()}var W=yg.superClass.setAnchor3d.apply(J,arguments);if(!Ji&&e){var B=J.p3();J.shiftPoints(B[0]-M[0]+Q,B[2]-M[2]+E,B[1]-M[1]+r)}return d&&d.endTransaction(),delete J._updatingAnchor3d,delete J._55I,W},setAnchor:function(z,A,n){var P=this;P._55I=!0;var X=P._updatingAnchor3d,S=!Ji&&!X;if(S){var w,d,i;"number"==typeof z?i={x:z,y:A}:(i=z.length?{x:z[0],y:z[1]}:z,n=A);var p=P.getAnchor(),v=P.getSize();w=v.width*(p.x-i.x),d=v.height*(p.y-i.y),n||P.shiftPoints(w,d);var m=P.getPosition()}var L=yg.superClass.setAnchor.apply(P,arguments);if(S){var T=P.getPosition();n&&P.shiftPoints(T.x-m.x+w,T.y-m.y+d)}return X||delete P._55I,L},shiftPoints:function(I,b,A){if(I||b||A){var M=this,T=M.getElevation()||0,m=M.toPoints(),w=new Yi;m.each(function(P){var Z=P.e;A&&(Z=(Z==i?T:Z)+A),w.add({x:P.x+I,y:P.y+b,e:Z})}),M.setPoints(w),M.fs()}},shiftPointsElevation:function(H){return this.shiftPoints(0,0,H)},setPosition:function(Q,p){var W,R=this;if(!R._28Q){if(R._28Q=1,!R._55I&&!Ji){W=2===arguments.length?{x:Q,y:p}:Q;var T=W.x-R._position.x,G=W.y-R._position.y;if(0===T&&0===G)return delete R._28Q,void 0;R._55I=1,R.shiftPoints(T,G),qe(R,[1,0,0,1,T,G]),delete R._55I}yg.superClass.setPosition.apply(R,arguments),delete R._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var w=this;if(2!==w._59O.size())return!1;var P=w._58O;return P?2===P.size()&&1===P.get(0)&&2===P.get(1)?!0:!1:!0},fireShapeChange:function(){var j=this;if(!j._55I&&!Ji){var E=xn(j._59O);E&&(j._55I=1,j.setRect(E),delete j._55I)}j.fp(rd,!1,!0)},getSerializableProperties:function(){var v=yg.superClass.getSerializableProperties.call(this);return v.segments=1,v.points=1,v.thickness=1,v.closePath=1,v}});var Gp=r.Polyline=function(){Kh(Gp,this),this.s({"shape.background":null,"shape.border.width":2})};zr("Polyline",yg,{_icon:"polyline_icon",_22Q:function(){return In},getUIClass:function(){return vr},setClosePath:function(){},setTall:function(g){var y=this,x=y.getDataModel();if(x&&x.beginTransaction(),!y._55I&&!y._24Q&&!Ji&&y.getTall()){y._24Q=1;var z=y._54O,k=g/y.getTall();if(1!==k){var G=y.toPoints(),M=new Yi;G.each(function(Z){M.add({x:Z.x,y:Z.y,e:Z.e==i?Z.e:(Z.e-z)*k+z})}),y.setPoints(M),y.fs()}delete y._24Q}Gp.superClass.setTall.call(y,g),x&&x.endTransaction()},setElevation:function(y){var q=this,u=q.getDataModel();if(u&&u.beginTransaction(),!q._55I&&!q._24Q&&!Ji){q._24Q=1;var v=y-q._54O;0!==v&&q.shiftPointsElevation(v),delete q._24Q}Gp.superClass.setElevation.apply(q,arguments),u&&u.endTransaction()},fireShapeChange:function(){var z=this,T=z._59O;if(!z._55I&&!z._24Q&&!Ji){var B=T.size();if(B){var N=1,x=T.get(0),A=z._54O;x.e==i&&(x.e=A);for(var P=x.e,t=0;B>N;N++){x=T.get(N),x.e==i&&(x.e=A);var W=_(P,x.e),Y=$(P+t,x.e);P=W,t=Y-W}z._24Q=1,z.setTall(t),z.setElevation(P+t*z._anchorElevation),delete z._24Q}}Gp.superClass.fireShapeChange.apply(z,arguments)}});var xr=r.SubGraph=function(){Kh(xr,this)};zr("SubGraph",qk,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){xr.superClass._8I.call(this),this.eachChild(function(_){gj(_)&&_._8I()})}}),z.loadingRefGraph=0;var Ti=r.RefGraph=function(){Kh(Ti,this)};zr("RefGraph",Mb,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(x){var f=this._ref;this._ref=x,this.fp("ref",f,x),this.updateRef()},_21I:function(){Ti.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var u=this;if(z.loadingRefGraph++,u.clearChildrenFromDataModel(),z.loadingRefGraph--,u._ref&&u._dataModel){u._xhrLoadHandler&&(u._xhrLoadHandler.cancel=!0);var E=Ji,F=u._xhrLoadHandler=function($){if($&&u._dataModel){z.loadingRefGraph++;var o=u._pendingUpdateInfo={needToRestore:E};E&&(o.position=u.p(),o.width=u.getWidth(),o.height=u.getHeight(),o.rotation=u.getRotation(),o.anchor=u.getAnchor(),o.scale=u.getScale()),u.p(0,0),u.setAnchor(.5,.5),u.setRotation(0),u.setScale(1,1);var m=z.parse($),H=u._dataModel.deserialize(m,u,{justDatas:!0});H.each(function(a){a._refGraph=u}),u.checkPendingUpdateInfo(),z.loadingRefGraph--,z.handleRefGraphLoaded(u,H,m)}};F.xhrLoadCalled=!1,z.load(u._ref,function(s){F.cancel||(F.xhrLoadCalled?F(s):ur(function(){F(s)}))}),F.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var u=this,N=u._pendingUpdateInfo;if(!N)return u.onPendingUpdated&&(z.loadingRefGraph++,u.onPendingUpdated(),z.loadingRefGraph--),void 0;var T=!0;this.eachChild(function(B){(B._pendingCheckImageJSON||B._pendingUpdateInfo)&&(T=!1)}),T&&(z.loadingRefGraph++,u._pendingUpdateInfo=null,u.updateFromChildren(),N.needToRestore&&(u.setSize(N.width,N.height),u.setAnchor(N.anchor),u.setRotation(N.rotation),u.setScale(N.scale),u.p(N.position)),this.getParent()instanceof Ti&&this.getParent().checkPendingUpdateInfo(),u.onPendingUpdated&&u.onPendingUpdated(),z.loadingRefGraph--)},getSerializableProperties:function(){var S=Ti.superClass.getSerializableProperties.call(this);return S.ref=1,S}}),r.EdgeGroup=function(F,T){this._70O=F,this._siblings=T;for(var f,u,e=0,N=F.size(),G=q[Hl];N>e;e++)if(f=F.get(e).getStyle(Hl,!1),f!=i){G=f;break}G==i&&(G=!0);var Q=z.edgeGroupAgentFunc;for(Q&&(u=Q(F),u&&u!==F.get(0)&&(F.remove(u),F.add(u,0))),e=0;N>e;e++)F.get(e).s(Hl,G)},zr("EdgeGroup",j,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(P){return this._70O.get(P)},indexOf:function(E){return this._70O.indexOf(E)},each:function(v,p){this._70O.each(v,p)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(G,e){this._siblings.each(function(D){D._70O.each(G,e)})}});var Fh=function(J,$,u){var q=Jc[J]={type:J,action:$};if(u)for(var G in u)q[G]=u[G]};Ej(z,{setConnectAction:Fh,getConnectAction:function(p,K){if(!K){if(!p)return null;K=p.getCurrentConnectActionType()}return Jc[K]},doConnectAction:function(Y,R,y,$){$=$||Y.getCurrentConnectActionType();var B=Jc[$];if(!B)return!1;var K=B.action;return K?(R instanceof Ac.Group?Y.sm().getSelection().each(function(c){K.call(null,Y,c,y)}):K.call(null,Y,R,y),!0):!1},doDeleteConnectionAction:function(n,y,F){F=F||n.getCurrentConnectActionType();var D=Jc[F];if(!D||!D.delete)return!1;var b=D.delete.action;return b?(y instanceof Ac.Group?n.sm().getSelection().each(function(X){b.call(null,n,X)}):b.call(null,n,y),!0):!1}});var Bp=r.JSONSerializer=function(T,n){this.dm=this._dataModel=T,this._hierarchical=z.forceHierarchicalSerialization?!0:n==i?T.isHierarchicalRendering():n};zr("JSONSerializer",j,{ms_ac:["hierarchical"],serialize:function(P){return z.stringify(this.toJSON(),P)},toJSON:function(){var n=this,w=n.dm,t=w.getRoots(),i=n.json={v:z.getVersion(),p:{},a:{},d:[]},E=w.getSerializableAttrs();w.getInit()&&(i.init=w.getInit()),w.getName()&&(i.p.name=w.getName()),w.getBackground()&&(i.p.background=w.getBackground()),w.getLayers()&&(i.p.layers=w.getLayers()),w.getEnvmap()&&(i.p.envmap=w.getEnvmap()),i.p.autoAdjustIndex=w.isAutoAdjustIndex(),i.p.hierarchicalRendering=w.isHierarchicalRendering();for(var v in E){var r=w.a(v);r!==s&&n[Nh](v,r,i.a)}return rg(i.a)&&delete i.a,n._hierarchical?t.each(n.serializeData,this):w.each(function(i){n.serializeData(i)}),w.fireSerializeEvent({type:"serialize",json:i}),w.getPostProcessingData()&&(i.p.postProcessingData=w.getPostProcessingData()),i},isSerializable:function(){return!0},getProperties:function(S){return S.getSerializableProperties()},getStyles:function(i){return i.getSerializableStyles()},getAttrs:function(r){return r.getSerializableAttrs()},serializeData:function(t){var l=this;if(l.isSerializable(t)&&!t._refGraph){var A,Y,h,a,z=yi(t.getClassName())||t.getClass(),K=new z,p={c:t.getClassName(),i:t.getId(),p:{},s:{},a:{}};l.json.d.push(p),A=l.getProperties(t);for(Y in A)if(/^_/.test(Y)){if(h=t[Y],!("_width"!==Y&&"_height"!==Y||h!=i&&-1!==h)){var o;((t.s("layout.h")||t.s("layout.v"))&&t.getHost()||t instanceof r.Node&&(o=t.getParent())&&o instanceof r.Block||t.s("fullscreen"))&&(h=t[Y]="_width"===Y?t.getWidth():t.getHeight())}h!==K[Y]&&l[Nh](Y.substr(1),h,p.p)}else a=sr(Y),t[a]&&(h=t[a](),h!==K[a]()&&l[Nh](Y,h,p.p));A=l.getStyles(t);for(Y in A)h=t.s(Y),h!==K.s(Y)&&l[Nh](Y,h,p.s);A=l.getAttrs(t);for(Y in A)h=t.a(Y),h!==K.a(Y)&&l[Nh](Y,h,p.a);rg(p.p)&&delete p.p,rg(p.s)&&delete p.s,rg(p.a)&&delete p.a}l._hierarchical&&t.getChildren().each(l.serializeData,l)},serializeValue:function(G,v,o){Bc(v)?v={__a:v._as}:v instanceof El&&(v={__i:v.getId()}),o[G]=v},deserialize:function(D,E,q){var S=this;return un(D)&&/.json$/.test(D)?(z.xhrLoad(D,function(x){S.deserializeImpl(x,E,q)}),void 0):S.deserializeImpl(D,E,q)},deserializeImpl:function(d,j,P){var N=this,x=N.dm;P=Zo(P)?{setId:P}:Nf(P)?{finishFunc:P}:P||{},d=N.json=un(d)?z.parse(d):d,d.a&&d.a.onPreDeserialize&&!P.disableOnPreDeserialize&&d.a.onPreDeserialize(d,x,P.view),x.beginTransaction(),Ji++,N._82I={};var f=new Yi,m=new Yi,G=0,E=d.d.length;if(P.justDatas||(Nf(d.init)&&d.init(x),x.setInit(d.init)),!P.justDatas){for(var D in d.a)x.a(D,N[fc](d.a[D]));for(var q in d.p)x[yd(q)](d.p[q])}for(;E>G;G++){var H=d.d[G],c=yi(H.c),S=new c,V=H.i;P.setId&&V!=i&&(S._id=V),N._82I[V]=S,f.add(S),m.add(H)}for(G=0;E>G;G++)N.deserializeData(f.get(G),m.get(G));return f.each(function(Q){j&&!Q.getParent()&&Q.setParent(j),x.add(Q)}),x.fireSerializeEvent({type:"deserialize",json:d}),Ji--,x.endTransaction(),d.a&&d.a.onPostDeserialize&&!P.disableOnPostDeserialize&&d.a.onPostDeserialize(d,x,P.view,f),P.finishFunc&&P.finishFunc(d,x,P.view,f),f},deserializeData:function(l,M){for(var j in M.p)l[yd(j)](this[fc](M.p[j]));for(j in M.s)l.s(j,this[fc](M.s[j]));for(j in M.a)l.a(j,this[fc](M.a[j]))},deserializeValue:function(r){if(zo(r)){var D=r.__i;if(D!=i)return this._82I[D];if(D=r.__a,Qb(D))return new Yi(D)}return r}}),Ej(Bs,{serialize:function(b,k){return new Bp(this,k).serialize(b)},toJSON:function(K){return new Bp(this,K).toJSON()},deserialize:function(g,I,o){return new Bp(this).deserialize(g,I,o)}});var nj=r.OverlappingBox=function(g){this.gv=g,this.boxes={}};zr("OverlappingBox",j,{clear:function(){var x,c,K=this.boxes;for(x in K)c=K[x],c.length=0},isOverlapping:function(l,W){var B,X,H=this,t=H.boxes,i=t[l];i?(B=i.rects,X=i.length):i=t[l]={rects:B=[],length:X=0};var c,G,W;for(c=0;X>c;c++)if(G=B[c],G.x<W.x+W.w&&G.x+G.w>W.x&&G.y<W.y+W.h&&G.h+G.y>W.y)return!0;return B.length<=X?(B.push(W),i.length++):B[i.length++]=W,!1}}),Ej(z,{fetch:function(v,a){var Q="GET",T=!1,Z=null,l="";a&&(Q=a.method||"GET",T=a.sync,l=a.url,Z=a.data||null),v.open(Q,l,!T),a.responseType?v.responseType=a.responseType:a.overrideMimeType&&v.overrideMimeType&&v.overrideMimeType(a.overrideMimeType),v.send(Z)},convertImageSrc:function(j,U){U&&"function"==typeof U||(U=function(){}),U(j)}});var Lr=r.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};zr("Request",j,{_responseType:null,_overrideMimeType:"text/plain",send:function(l){var v=this._xhr,k=this.onload,f=this.onerror;this.getResponseType()?l.responseType=this.getResponseType():this.getOverrideMimeType()&&(l.overrideMimeType=this.getOverrideMimeType()),v.onload=k,v.onerror=f,z.fetch(v,l)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(s){this._responseType=s},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(f){this._overrideMimeType=f},getResponseText:function(){var b=this._xhr;return b.response||b.responseText}}),gk.GraphView=function(L){var T=this;T._24I={},T._34I=new Yi,T._25I={},T._56I={},T._view=bd(1,T),T._canvas=Uh(T._view),T.dm(L?L:new Bs),this._coreInteractor=new qn(this),T.setEditable(!1),T.setScrollBarVisible(z.graphViewScrollBarVisible)},xe("GraphView",j,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[om,Zj,lh,cr,"resettable","editInteractor",ys,"zoomable","pannable","rectSelectable","autoScrollZone",Yq,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:z.graphViewZoomable,_resettable:z.graphViewResettable,_pannable:z.graphViewPannable,_rectSelectable:z.graphViewRectSelectable,_autoScrollZone:z.graphViewAutoScrollZone,_rectSelectBackground:z.graphViewRectSelectBackground,_rectSelectBorderColor:z.graphViewRectSelectBorderColor,_editPointSize:z.graphViewEditPointSize,_editPointBorderColor:z.graphViewEditPointBorderColor,_editPointBackground:z.graphViewEditPointBackground,_scrollBarColor:Cl,_scrollBarSize:Bb,_autoHideScrollBar:rm,_autoMakeVisible:Ok,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(x){this._dataModel.setLayers(x)},setEditable:function(y){var O=this,V=O.__interactorMap__;if(!V){var i=gk.XEditInteractor;V=O.__interactorMap__={scrollBar:new ti(O),select:new Hd(O),edit:i?new i(O):new nk(O),text:new ah(O),move:new Ue(O),"default":new yh(O),touch:new jk(O,{editable:!1})}}y?(O._uieditable=!0,O.setInteractors([V.scrollBar,V.select,V.edit,V.text,V.move,V.default,V.touch])):(O._uieditable=!1,O.setInteractors([V.scrollBar,V.select,V.move,V.default,V.touch]))},getCanvas:function(){return this._canvas},_33I:function(S){var k=S.getUIClass();return k?new k(this,S):i},getDataUI:function(G){var u=this,T=u._25I[G._id];return T===s&&(T=u._33I(G),u._25I[G._id]=T),T},getNodeRect:function(Z){return z.getNodeRect(this,Z)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(O){var N=this.getDataUI(O);return N?(N._79o(),N._78o):null},getEdgeSourcePosition:function(z){var l=this,N=l.getDataUI(z),b=N.s,m=N._data._40I;return os(l,m,b("edge.source.position"),b("edge.source.offset.x"),b("edge.source.offset.y"),b("edge.source.anchor.x"),b("edge.source.anchor.y"))},getEdgeTargetPosition:function(U){var z=this,b=z.getDataUI(U),F=b.s,O=b._data._41I;return os(z,O,F("edge.target.position"),F("edge.target.offset.x"),F("edge.target.offset.y"),F("edge.target.anchor.x"),F("edge.target.anchor.y"))},invalidateAll:function(Y){var s=this;if(Y){for(var P in s._25I){var q=s._25I[P];q&&q.dispose()}s._25I={},s._56I={},s._24I={},s._34I.clear(),s.redraw()}else s.dm().each(function(C){s.invalidateData(C)})},invalidateSelection:function(){var I=this;I.sm().each(function(g){I.invalidateData(g)})},invalidateData:function(f){var p=this;p._24I[f._id]=f,p._21Q(f),p.iv()},_21Q:function(B){var R=this,n=R._24I;if(Cc(B)&&sp[B.s($o)]){var h=B.getSourceAgent();h&&h.getAgentEdges().each(function($){n[$._id]=$}),h=B.getTargetAgent(),h&&h.getAgentEdges().each(function(K){n[K._id]=K}),R.iv()}},redraw:function(A){var C=this;C._32I||(A?C._34I.add(A):(C._32I=1,C._34I.clear()),C.iv())},each:function(q,t){var G,g,X,Z=0,n=this.getLayers(),S=this._dataModel,H=S._datas._as,K=H.length;if(n){for(var M=n.length;M>Z;Z++)if(X=n[Z],zo(X)&&(X=X.name),S.isHierarchicalRendering()){var r=function(A){return A._layer===X?t?q.call(t,A):q(A):void 0};if(this._dataModel.eachByHierarchical(r)===!1)return}else for(var N=0;K>N;N++)if(G=H[N],G._layer===X&&(g=t?q.call(t,G):q(G),g===!1))return}else if(S.isHierarchicalRendering())this._dataModel.eachByHierarchical(q,null,t);else for(;K>Z;Z++)if(G=H[Z],g=t?q.call(t,G):q(G),g===!1)return},reverseEach:function(S,k){var F,b,i,G,V=this._dataModel,p=V._layers,N=V._datas._as,y=N.length;if(p){for(F=p.length-1;F>=0;F--)if(G=p[F],zo(G)&&(G=G.name),V.isHierarchicalRendering()){var U=function(z){return z._layer===G?k?S.call(k,z):S(z):void 0};if(V.reverseEachByHierarchical(U)===!1)return}else for(var L=y-1;L>=0;L--)if(b=N[L],b._layer===G&&(i=k?S.call(k,b):S(b),i===!1))return}else if(V.isHierarchicalRendering())V.reverseEachByHierarchical(S,null,k);else for(F=y-1;F>=0;F--)if(b=N[F],i=k?S.call(k,b):S(b),i===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var x=this,H=x._84I;if(!H){var e=this.dm().a("width"),r=this.dm().a("height");e>0&&r>0?x._84I={x:0,y:0,width:e,height:r}:(x.each(function(K){x.isVisible(K)&&(H=qh(H,x.getDataUIBounds(K)))}),x._84I=H?H:qm)}return x._84I},getScrollRect:function(){return qh(this.getContentRect(),this._29I)},makeCenter:function(c,C,X){var i=this;if(!i.getWidth()||!i.getHeight())return X||ur(i.makeCenter,i,[c,C,!0],500),void 0;i.makeVisible(c),i.validate();var s=i.getDataUIBounds(c);if(s){var l=i.getWidth(),U=i.getHeight(),p=s.x+s.width/2,O=s.y+s.height/2,T=-p*i._zoom+l/2,P=-O*i._zoom+U/2;i.setTranslate(T,P,C)}},fitData:function(Q,n,k,Z,f){var C=this;if(!C.getWidth()||!C.getHeight())return f||ur(C.fitData,C,[Q,n,k,Z,!0],500),void 0;var H=function(){C.makeVisible(Q),C.validate();var R=C.getDataUIBounds(Q);R&&(R=Se(R),Lg(R,k==i?20:k),C.fitRect(R,n,Z))};n?z.callWhenLoaded(H):H()},fitContent:function(v,R,k,$){var O=this;if(!O.getWidth()||!O.getHeight())return $||ur(O.fitContent,O,[v,R,k,!0],500),void 0;var u=function(){O.validate();var h=Se(O.getContentRect());Lg(h,R==i?20:R),O.fitRect(h,v,k)};v?z.callWhenLoaded(u):u()},fitRect:function(T,B,i){var S=this,P=S.getWidth(),g=S.getHeight(),k=T.x+T.width/2,y=T.y+T.height/2,Y=_(P/T.width,g/T.height),A=S._zoom,p=-k*A+P/2,V=-y*A+g/2;0===Y||isNaN(Y)||(i&&(Y=_(1,Y)),B?(S._65I&&(delete S._65I.finishFunc,S._65I.stop(!0)),S._14o&&S._14o.stop(!0),S.setTranslate(p,V,{finishFunc:function(){S.setZoom(Y,B)}})):(S.setTranslate(p,V),S.setZoom(Y)))},toCanvas:function(C,c){c=c||this._zoom,this.validateImpl();var I=this,X=I.getContentRect();X.width||(X.width=10),X.height||(X.height=10);var e=Uh(),v=X.x*c,Y=X.y*c,T=X.width*c,z=X.height*c;Tj(e,T,z,1);var q=Xc(e);return C=C||this._dataModel.getBackground(),C&&Tl(q,0,0,T,z,C),Ag(q,-v,-Y),q.scale(c,c),I._42(q),q.restore(),e},toDataURL:function(C,s,g){return this.toCanvas(C,g).toDataURL(s||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(W,b){var P=this,J=P.dm().getBackground();if(J){var B=P.dm().a("width"),c=P.dm().a("height");B>0&&c>0&&Tl(W,0,0,B,c,J)}var Y=P.__htmlOrderList,I=[];if(P._93db(W,b),P.each(function(o){var g=P.getDataUI(o);if(g){var J=P._56I[o._id],e=g._htmlView;if(J){var n=g._79o();if(e=g._htmlView,r.HtmlNode&&o instanceof r.HtmlNode)g._42(W);else{var v=P.getViewRect(),x=e&&e.layoutHTML;!b||Xh(b,n)?(x&&(e.layoutHTML(),g.__outerLayout&&delete g.__outerLayout),g._42(W)):Xh(v,n)||!x||g.__outerLayout||(e.layoutHTML(),g.__outerLayout=!0)}}e&&(I.push(e),e.getView&&(e=e.getView()),e.style.display=J?"block":Gi)}}),Y&&I.length>0){var o=!1;if(Y.length!==I.length)o=!0;else for(var a=0;a<I.length;a++)if(I[a]!==Y[a]){o=!0;break}o&&(I.forEach(function(B){B.autoAdjustIndex!==!1&&P.appendHTML(B,!0)}),this.__htmlOrderList=I)}else this.__htmlOrderList=I;P._92db(W,b)},validateImpl:function(){this.tryUpdateRootData();var Z,b,l,J,g,k=this,N=k.tx(),c=k.ty(),W=k._zoom,r=k._canvas,_=this.getWidth(),i=this.getHeight(),I=k._29I,u={x:-N/W,y:-c/W,width:_/W,height:i/W},x={},A=k._34I,C=k._24I,j=k._32I,K=k._23I;k._24I={},(_!==r.clientWidth||i!==r.clientHeight)&&(Tj(r,_,i),j=1),j||Mo(u,I)||(j=1),k._29I=u,k.each(function(m){b=m._id;var s=x[b]=k.isVisible(m);s!==k._56I[b]&&(C[b]=m,l=k.getDataUI(C[b]),l&&l._84o(s),k._84o(m,s))},k);for(b in C)l=k.getDataUI(C[b]),l&&(!j&&k._56I[b]&&(g=l._79o(),g&&A.add(g)),l.invalidate()),k._83I=1;if(k._56I=x,!j)for(b in C)x[b]&&(l=k.getDataUI(C[b]),l&&(g=l._79o(),g&&A.add(g)));if(j?J=u:(A.each(function(z){Xh(u,z)&&(J=qh(J,z))}),J&&(Lg(J,$(1,1/W)),J.x=O(J.x*W)/W,J.y=O(J.y*W)/W,J.width=H(J.width*W)/W,J.height=H(J.height*W)/W,J=ff(u,J))),k._74O=J,J){Z=Xc(r);var X=J.x,R=J.y,B=J.width,v=J.height;X=Math.floor((X*W+N)*Wh),R=Math.floor((R*W+c)*Wh),B=Math.ceil(B*W*Wh)+1,v=Math.ceil(v*W*Wh)+1,j||(J.x=(X/Wh-N)/W,J.y=(R/Wh-c)/W,J.width=B/Wh/W,J.height=v/Wh/W),Z.beginPath(),Z.rect(X,R,B,v),Z.clip(),Z.clearRect(X,R,B,v),kb(Z,N,c,W),k._42(Z,J),Z.restore(),delete k._74O}if(A.clear(),delete k._32I,K&&_>0&&i>0){var l=k.getDataUI(K);if(l){var g=l._79o(),S=k._29I,z=S.x,m=S.y,e=S.width,q=S.height,W=k._zoom;g&&!Xh(g,S)&&(g.x+g.width<z&&k.tx(-g.x*W),g.x>z+e&&k.tx(-(g.x+g.width-e)*W),g.y+g.height<m&&k.ty(-g.y*W),g.y>m+q&&k.ty(-(g.y+g.height-q)*W))}delete k._23I}k._83I&&(delete k._83I,delete k._84I),k._98O(),k.countFrame(),rg(k._24I)||ur(k.iv,k)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var Z,_=this.getFullscreenDatas();for(var X in _)Z=_[X],this.scaleRootData(Z);this._rootDataUpdating=!1}},scaleRootData:function(E){var T=E.s("fullscreen");if("uniform"===T||"fill"===T){E.getRotation()&&E.setRotation(0);var m=E.s("fullscreen.gap")||0,e=this.getWidth(),C=this.getHeight();if(e&&C){var q,X,z,j=e-2*m,o=C-2*m,v=E.getAnchor(),B=E.getScaledSize(),p=B.width,d=B.height,L=E.s("fullscreen.lock");if(L)return"uniform"===T?j/o>p/d?(q=o/d,p=d*j/o):(q=j/p,d=p*o/j):"v"===L?(q=o/d,p=j/q,E.getWidth()!==p&&E.setWidth(p)):(q=j/p,d=o/q,E.getHeight()!==d&&E.setHeight(d)),this.setZoom(q),X=m-(E.getX()-v.x*p)*q,z=m-(E.getY()-v.y*d)*q,X!==this.tx()&&this.tx(X),z!==this.ty()&&this.ty(z),void 0;X=this.tx(),z=this.ty(),q=this._zoom;var D={x:(-X+m)/q,y:(-z+m)/q,width:j/q,height:o/q};if("uniform"===T){var U=p/d,I=Math.min(D.width,D.height*U),l=I/U;D.x+=.5*(D.width-I),D.y+=.5*(D.height-l),D.width=I,D.height=l}j=D.width/E.getScaleX(),o=D.height/E.getScaleY(),(E.getWidth()!=j||E.getHeight()!==o)&&E.setSize(j,o);var W=D.x+v.x*D.width,M=D.y+v.y*D.height,O=E.getPosition();(W!==O.x||M!==O.y)&&E.setPosition(W,M)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(Z){var i=this;Z!==i.isScrollBarVisible()&&(Z?(pi(i._view,i._79O=em()),pi(i._79O,i._27I=em()),pi(i._79O,i._28I=em())):(As(i._79O),delete i._79O,delete i._27I,delete i._28I),i.fp("scrollBarVisible",!Z,Z))},getDebugTip:function(){return""},showScrollBar:function(){var g=this;g._79O&&(g._85I||(e(function(){g._86I()},eb),g.iv()),g._85I=new Date)},_86I:function(){var i=this;if(i._85I){var q=new Date,p=q.getTime();p-i._85I.getTime()>=eb?(delete i._85I,i.iv()):e(function(){i._86I()},eb)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var S=this,r=this._27I,z=this._28I;if(S._79O){if(S._autoHideScrollBar&&!S._85I)return r.style.visibility=jg,z.style.visibility=jg,void 0;var b=S.getScrollBarColor(),l=S._zoom,q=S.getScrollBarSize(),U=S.getViewRect(),I=S.getScrollRect(),W=U.height*l,N=I.height*l,K=U.width*l-q-2,d=W*((U.y-I.y)*l/N),x=W*(W/N),o=r.style;N-.5>W?(ge>x&&(d=d+x/2-ge/2,0>d&&(d=0),d+ge>W&&(d=W-ge),x=ge),Kn(r,K,d,q,x),o.visibility=mf,o.background=b,o.borderRadius=q/2+De):o.visibility=jg;var T=U.width*l,M=I.width*l,d=U.height*l-q-2,K=T*((U.x-I.x)*l/M),P=T*(T/M),o=z.style;M-.5>T?(ge>P&&(K=K+P/2-ge/2,0>K&&(K=0),K+ge>T&&(K=T-ge),P=ge),Kn(z,K,d,P,q),o.visibility=mf,o.background=b,o.borderRadius=q/2+De):o.visibility=jg}},setDataModel:function(W){var B=this,g=B._dataModel,X=B._selectionModel;g!==W&&(g&&(g.ump(B.handleDataModelPropertyChange,B),g.umm(B.handleDataModelChange,B),g.umd(B.handleDataPropertyChange,B),g.removeIndexChangeListener(B._75O,B),g.removeHierarchyChangeListener(B.handleHierarchyChange,B),X||g.sm().ums(B.handleSelectionChange,B)),B._dataModel=W,W.mp(B.handleDataModelPropertyChange,B),W.mm(B.handleDataModelChange,B),W.md(B.handleDataPropertyChange,B),W.addIndexChangeListener(B._75O,B),W.addHierarchyChangeListener(B.handleHierarchyChange,B),X?X._21I(W):W.sm().ms(B.handleSelectionChange,B),B.invalidateAll(!0),B.fp(so,g,W),B.updateBackground())},getLayersInfo:function(){if(this._layersInfo===s){var g=this.getLayers();g?(this._layersInfo={},g.forEach(function(Z){var T=zo(Z)?Z.name:Z;this._layersInfo[T]=Z},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(R,K,X){var f,Q,c=this,P=c.getDataUI(R),r=yo(P),s=Me(K,function(c){return ts(r,100*c)},100,.001),H=ts(r,100*s);if(!X){var t=Yj(P),b=new cs(H.x,H.y),g=49/(c._zoom*c._zoom);for(f=0,Q=t.length;Q>f;f++)if(b.distanceToSquared(t[f])<g)return{index:f,point:t[f],distance:Math.sqrt((t[f].x-K.x)*(t[f].x-K.x)+(t[f].y-K.y)*(t[f].y-K.y))}}return{percent:s,point:H,distance:Math.sqrt((H.x-K.x)*(H.x-K.x)+(H.y-K.y)*(H.y-K.y))}},calculateAttachPoint:function(){var p=new cs,i=new cs,q=new cs;return function(o,s){var J=this.getAttachPoints(o);if(!J||!J.length)return null;q.set(s.x,s.y);for(var w,b,S,B,a=1/0,H=0,x=J.length;x>H;H++)S=J[H],i.x=S.x,i.y=S.y,p.x=S.offsetX||0,p.y=S.offsetY||0,B=os(this,o,0,p.x,p.y,i.x,i.y),b=q.distanceToSquared(B),a>b&&(w=H,a=b);a=Math.sqrt(a);var E=this.getAttachStyle(o);if("close"===E){var _=o.s("attach.close.threshold")/this._zoom;if(a>_)return null}return{index:w,distance:a,info:J[w]}}}(),getAttachPoints:function(q){var e=q.s("attach.points");if(e)return e;var l=Ij(q._image);return l?gf(l.attachPoints,q,this)||null:void 0},getAttachStyle:function(a){var X=a.s("attach.style");if(X)return X;var j=Ij(a._image);return j?gf(j.attachStyle,a,this)||"close":void 0},updateLayers:function(){this._layersInfo=s,this.invalidateSelection(),this.redraw()},updateBackground:function(){var _=this.dm().a("width"),U=this.dm().a("height");this._canvas.style.background=_>0&&U>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(U){if("background"===U.property){var Y=this._canvas.style.background,j=U.newValue||"";this.updateBackground(),this.fp("canvasBackground",Y,j),this.redraw()}else"a:width"===U.property||"a:height"===U.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===U.property?this.updateLayers():"hierarchicalRendering"===U.property&&this.redraw()},handleDataPropertyChange:function(D){this.dm().isHierarchicalRendering()&&"parent"===D.property&&D.data.hasChildren()&&this.redraw(),this.invalidateData(D.data)
},onPropertyChanged:function(d){var r=this,l=d.property;if(r.redraw(),"zoom"===l){var y=r.sm().getSelection();y.size()&&y.each(function(s){s.invalidate()})}else"dataModel"===l&&(r._83I=1);xc[l]?r.showScrollBar():l===ys&&r.onCurrentSubGraphChanged(d)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(F){var P=this,J=F.kind,f=F.data;if(P._83I=1,"add"===J)P.invalidateData(f),Cc(f)&&f.getEdgeGroup()&&f.getEdgeGroup().eachSiblingEdge(P.invalidateData,P);else if(J===lb){P._21Q(f);var g=f._id,m=P._25I[g];if(m){if(P._56I[g]){var Y=m._79o();Y&&P.redraw(Y)}m.dispose(),delete P._25I[g],delete P._24I[g],delete P._56I[g]}f===P._currentSubGraph&&P.setCurrentSubGraph(i)}else J===th&&(P.invalidateAll(!0),P.setCurrentSubGraph(i))},_75O:function(x){this.invalidateData(x.data)},handleHierarchyChange:function(E){this.dm().isHierarchicalRendering()&&E.data.hasChildren()&&this.redraw(),this.invalidateData(E.data)},adjustIndex:function(g){var I=this;if(I.isVisible(g)){I.dm().beginTransaction();for(var H=g;H._parent&&I.isVisible(H._parent);)H=H._parent;H&&H!==g&&I._dataModel.adjustIndex(H),I._dataModel.adjustIndex(g),I.dm().endTransaction()}},getImage:function(M){return M.getImage?M.getImage():s},getSelectWidth:function(A){var g=Ij(this.getImage(A));return g&&gf(g.disableSelectedBorder,A,this)?0:A.s("select.width")},getSelectColor:function(w){return w.s("select.color")},isSelectable:function(L,A){if(this.isSelected(L))return!0;if(!A&&L.getParent()instanceof Mb&&this.isSelectable(L.getParent(),!0)&&L.getParent().isSyncSize())return!1;var U=this.getLayersInfo();if(U){var j=U[L._layer];if(j&&j.selectable===!1)return!1}return L.s("2d.selectable")&&this.sm().isSelectable(L)},isMovable:function(A){var I=this;if(Cc(A)&&A.getStyle($o)!==hb)return!1;var U=this.getLayersInfo();if(U){var e=U[A._layer];if(e&&e.movable===!1)return!1}return A.s("2d.movable")?I._movableFunc?I._movableFunc(A):!0:!1},isEditable:function(R){var Q=this;if(r._uiSerializing)return Q._uieditable;if(!Q._editInteractor||!Q.isSelected(R))return!1;if(xh(R)){var G=Q.getDataUI(R);if(!G||G._88I)return!1}if(Cc(R)&&R.getStyle($o)!==hb)return!1;var q=this.getLayersInfo();if(q){var Z=q[R._layer];if(Z&&Z.editable===!1)return!1}return R.s("2d.editable")?Q._editableFunc?Q._editableFunc(R):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(I){return gj(I)&&0!==I.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(I):!0},isRectEditable:function(s){return this._rectEditableFunc?this._rectEditableFunc(s):!0},isAnchorEditable:function(n){return this._anchorEditableFunc?this._anchorEditableFunc(n):!0},isRotationEditable:function(j){return j.setRotation&&j.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(j):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(j){var M=j.getAnchor(),u=j.getScale(),v=this._zoom,x=Tb(j.getRotation(),0,-j.getHeight()*u.y*M.y-(u.y<0?-1:1)*(Aj?32:16)/v),o=j.p();return x.x+=o.x,x.y+=o.y,x},getLogicalPoint:function(R){var o=this;return Eg(R,o._canvas,o.tx(),o.ty(),o._zoom,o._zoom)},getScreenPoint:function(W,R){var B,m=this;return"object"==typeof W?W.x!==s?(B=W.x,R=W.y):(B=W[0],R=W[1]):B=W,kj(B,R,m._canvas,m.tx(),m.ty(),m._zoom,m._zoom)},getSelectedDataAt:function(X){var w=this;return this.getDataAt(X,function(P){return w.isSelected(P)})},getDataInfoAt:function(O,y,E){var l,g=this.lp(O),j=this.getDataAt(g,y,E);if(j){var x=this.getDataUI(j);l={data:j,ui:x,point:g};var Y=x._38o;if(Y){var P=Y.icons;for(var m in P){var Q=P[m],N=Y.rects[m];if(N)for(var I=gf(Q.names,j,this),C=I?I.length:0,W=N.rotation,H=C-1;H>=0;H--){var w=I[H],D=N[H];if(oh(D,g,W))return l.part="icons",l.name=m,l.icon=w,l.rect=D,l.index=H,l.rotation=W,l}}}if(this.isNoteVisible(j)){if(x.note2Info&&oh(x.note2Info.clickRect,g,i,x.note2Info.scale))return l.part="note2",l;if(x.noteInfo&&oh(x.noteInfo.clickRect,g,i,x.noteInfo.scale))return l.part="note",l}if(this.isLabelVisible(j)){if(x.label2Info&&oh(x.label2Info.rect,g,x.label2Info.rotation,x.label2Info.scale))return l.part="label2",l;if(x.labelInfo&&oh(x.labelInfo.rect,g,x.labelInfo.rotation,x.labelInfo.scale))return l.part="label",l}if(j.isInRect&&j.isInRect(g))return l.part="body",l}return l},getDataAt:function(q,D,r){q.target&&(q=this.lp(q));var L,G=this._zoom;return this.reverseEach(function(E){return(D?D(E):this.isSelectable(E))&&this.rectIntersects(E,Ke(q.x,q.y,r,G))?(L=E,!1):void 0},this),L},getIconInfoAt:function(T,e){var K=this;if(T.target&&(T=K.lp(T)),e||(e=K.getDataAt(T)),e){var y=K.getDataUI(e);if(y&&y._38o){var $,U=y._38o,q=new Yi;for($ in U.icons)q.add($);for(var v=q.size()-1;v>=0;v--){$=q.get(v);for(var f=U.rects[$],R=f.rotation,d=f.length-1;d>=0;d--){var c=f[d],l=c.width,I=c.height,W={x:T.x-c.x-l/2,y:T.y-c.y-I/2};R!=i&&(W=Tb(-R,W.x,W.y));var c={x:-l/2,y:-I/2,width:l,height:I};if(oh(c,W))return{key:$,index:d,name:U.icons[$].names[d],rect:f[d],point:T,rotation:R,relativeRect:c,relativePoint:W,data:e}}}}}return i},getDatasInRect:function(N,V,M){M===s&&(M=1);var p=this,P=new Yi;return p.reverseEach(function(t){M&&!p.isSelectable(t)||(V?p.rectIntersects(t,N):p.rectContains(t,N))&&P.add(t)}),P},moveSelection:function(C,V){var N=this;N.dm().beginTransaction(),ii(N.sm().toSelection(N.isMovable,N),C,V),N.dm().endTransaction()},moveDatas:function(A,S,z){var d=this;d.dm().beginTransaction(),A instanceof Yi||(A=new Yi(A)),ii(A,S,z),d.dm().endTransaction()},getDataUIBounds:function(y){var G=this.getDataUI(y);return G?G._79o():i},drawData:function(N,y,Y){var e=this.getDataUI(y);if(e){var G=e._79o();(!Y||Xh(Y,G))&&(e._42(N),y instanceof r.Block&&y.eachChild(function(f){this.drawData(N,f,Y)},this))}},getBoundsForGroup:function(g){return g.s($r)?this.getDataUIBounds(g):i},isPixelPerfect:function(G){return G.s("pixelPerfect")},rectIntersects:function(o,Q){this.validate();var Z=i;if(this._56I[o._id]){var G=this._25I[o._id];if(G){var $=G._79o();if(Sb(Q,$))Z=!0;else if((Q=ff(Q,$))&&(G.rectIntersects&&(Z=G.rectIntersects(Q)),Z==i)){if(!this.isPixelPerfect(o))return!0;var q=Q.x,m=Q.y,H=Q.width,w=Q.height,t=this._zoom,j=z.hitMaxArea,T=H*w*t*t;if(T>j){var y=Math.sqrt(j/T);t*=y}H*=t,w*=t,2>H&&(H=2),2>w&&(w=2),q*=t,m*=t;var a=xl(H,w);Ag(a,-q,-m),a.scale(t,t),this._drawForChecking=!0,this.drawData(a,o,Q),this._drawForChecking=!1;try{for(var x=0,W=a.getImageData(0,0,H,w).data;x<W.length;x+=4)if(0!==W[x+3]){Z=!0;break}a.restore()}catch(v){pl=i,Z=!1}}}}return Z?!0:!1},rectContains:function(X,c){if(this._56I[X._id]){var a=this._25I[X._id];if(a)return Sb(c,a._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(I){if(!z.isInput(I.target)){var e=this,Y=e._focusData,V=Y&&e._25I[Y._id],v=0,u=e._dataModel._datas;if(!(Y&&Y._enabled&&Y._editable&&V&&V.onKeyDown&&V.onKeyDown(I)===!0))if(9===I.keyCode&&(Y&&(v=u.indexOf(Y),Kq(I)?-1===--v&&(v=0):++v===u.size()&&(v=0)),e._focusData=Y=u.get(v),e.sm().setSelection(Y)),Pc(I)?e.selectAll():Sd(I)&&e.isResettable()&&e.reset(),e.sm().isEmpty()){if(e._editing)return;var t=e.tx(),N=e.ty(),Q=!1,Z=Kq()?100:10;_r(I)&&(t-=Z,Q=!0),Ub(I)&&(N-=Z,Q=!0),im(I)&&(t+=Z,Q=!0),mh(I)&&(N+=Z,Q=!0),Q&&e.setTranslate(t,N)}else{ei(I)&&e.handleDelete(I);var o=Kq()?10:1;_r(I)&&(e.moveSelection(-o,0),e.fi({kind:"moveLeft"})),Ub(I)&&(e.moveSelection(0,-o),e.fi({kind:"moveUp"})),im(I)&&(e.moveSelection(o,0),e.fi({kind:"moveRight"})),mh(I)&&(e.moveSelection(0,o),e.fi({kind:"moveDown"}))}}},handleScroll:function(d,j){if(nl(d),this.isZoomable()){if(!this.getEditInteractor()){var r=this.getDataAt(d);if(r){var p=Ij(this.getImage(r));if(p&&gf(p.scrollable,r,this))return}}var O=this.lp(d);j>0?this.scrollZoomIn(O):0>j&&this.scrollZoomOut(O)}},handlePinch:function(i,T,x){this.isZoomable()&&(T>x?this.pinchZoomIn(i):this.pinchZoomOut(i))},checkDoubleClickOnNote:function(N,p){var J=this,O=J.lp(N),w=J.getDataUI(p),Q=w.note2Info;return Q&&p.s("note2.toggleable")&&oh(Q.clickRect,O)?(p.s(aq,!p.s(aq)),J.fi({kind:"toggleNote2",event:N,data:p}),!0):(Q=w.noteInfo,Q&&p.s("note.toggleable")&&oh(Q.clickRect,O)?(p.s(ih,!p.s(ih)),J.fi({kind:"toggleNote",event:N,data:p}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(Z,M){var D=this,e=D.getAutoScrollZone(),U=e/D.getZoom(),Q=e/4,$=D._29I,m=D.lp(Z),z={x:D.tx(),y:D.ty()};return m&&e>0&&$&&(m.x-$.x<U?D.translate(Q,0):$.x+$.width-m.x<U&&D.translate(-Q,0),m.y-$.y<U?D.translate(0,Q):$.y+$.height-m.y<U&&D.translate(0,-Q)),z.x=D.tx()-z.x,z.y=D.ty()-z.y,M&&(M.x+=z.x,M.y+=z.y),z},getMoveMode:function(r,m){var k=m.s("2d.move.mode");return k?k:kp["88"]?"x":kp["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(x,n,h){var b=this;return"currentSubGraph"===n?{__i:x.getId()}:h.serializeProperty(x,n,b)},deserializeProperty:function(P,R,l){var J=this;if("currentSubGraph"===R){var H=J.dm(),j=H.__idMap;return j[P.__i]}return l.deserializeProperty(P,R,J)},setDefaultCursor:function(M,v){this._defaultCursor=M,v!==!1&&this.setCursor(M)},setCursor:function(k){"default"===k&&(k=this._defaultCursor||k);var M=this.getView().style;M.cursor=k,M.cursor="-webkit-"+k,M.cursor="-moz-"+k},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(J){return J===i||z.getConnectAction(null,J)?(this._currentActionType=J,this.redraw(),!0):!1},getEditStyle:function(h){var Z=this.getEditInteractor();return Z?Z.getStyle(h):s},setEditStyle:function(y,L,q){var i=this.getEditInteractor();return i?(i.setStyle(y,L,q),!0):!1},isConnectActionVisible:function(S){var d=z.getConnectAction(this);if(!d)return!1;var o=d.visible;return Nf(o)&&(o=o(this,S)),o},isInteractive:function(o){var F=Ij(this.getImage(o));return F&&gf(F.interactive,o,this)?!0:o.s("interactive")},appendHTML:function(c,G){var j=this.getView();if(!(G||c&&c.parentNode!==j))return!1;var K=c.getView&&c.getView();if(!G&&K&&K.parentNode===j)return!1;(c.getView||c.isSelfViewEvent)&&(c=c.getView());var r=this.getEditInteractor();return r&&r._canvas?j.insertBefore(c,r._canvas):this.isScrollBarVisible()?j.insertBefore(c,this.getView().lastChild):pi(j,c),!0},_layoutHTMLImpl:function(G,D,V){if(arguments.length>1){var S,I=this,l=I._zoom;if(D.getView&&(S=D,D=D.getView()),D.style.position="absolute",V){var m=G.getRect();Kn(S||D,I.tx()+m.x*l,I.ty()+m.y*l,m.width*l,m.height*l)}else{var h=new Ze,m=G.getAnchorRect(),r=G.getPosition(),A=G.getScale(),w=D.style;Kn(S||D,m),h.appendTranslate(I.tx(),I.ty()),h.appendScale(l,l),h.append(new Ze(G.getRotation(),r.x,r.y,A.x,A.y)),Qq(w,"transform","matrix("+h.a.toFixed(5)+", "+h.b.toFixed(5)+", "+h.c.toFixed(5)+",\n    "+h.d.toFixed(5)+", "+h.tx.toFixed(5)+", "+h.ty.toFixed(5)+")"),Qq(w,"transformOrigin",(-m.x).toFixed(5)+"px "+(-m.y).toFixed(5)+"px"),D.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(S){return S instanceof _f?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(f){var U="state",D=f.s(U);if(D)return D;var o=Ij(f._image);return o?gf(o[U],f,this)||null:void 0}}),j.defineProperties(gk.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(t){this._layoutHTML=t}}});var Dd=function(M,T){var d=this;d.gv=M,d.s=function(W){return T.getStyle(W)},d._data=T,d._87I=new Yi};Zi(Dd,j,{_6I:i,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var e=this,X=e.gv.isSelected(e._data);return!X||e.isShadowed()?0:e.gv.getSelectWidth(e._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(m){var p=this._data,Z=this.gv.getBodyColor(p);return Z?Z:m?p.getStyle(m):i},_2Q:function(B){return this.s(B)},_1Q:function(j,w,$,v){var C=this.s,N=C("2d.gray"),b=C(w+".dash.color");if(N&&(b=z.toGrayColor(b)),j.strokeStyle=b,j.lineWidth=$,j.stroke(),C(w+".dash.3d")){var G=C(w+".dash.3d.color");ap(j,b,N?z.toGrayColor(G):G,$,this.gv._zoom,C(w+".dash.3d.accuracy"))}Ak(j,v)},invalidate:function(){this._6I=i},_79o:function(){var L=this;if(!L._6I){var P=L._data,B=L.gv;L.labelInfo=L.label2Info=L.noteInfo=L.note2Info=L._38o=i,L._87I.clear(),L.interactiveInfo=B.isInteractive(P)?{}:i,L._3O(),L._55O=B.isEditable(P)?{_42O:B.isRectEditable(P),_43O:B.isPointEditable(P),_56O:B.isRotationEditable(P)}:i,L._6I=L._81o()}return L._6I},_3O:function(){},getPosition:function(){return qm},_68o:function(T,j){T&&this._87I.add(Um(T,j))},_81o:function(){var N=this,g=N.s;N._24O(Kr,"getLabel"),N._24O(al,"getLabel2"),N._26O(ol,"getNote"),N._26O(Al,"getNote2"),N._15O(),N._55O&&N._48O();var Q;if(N._87I.each(function(S){Q=qh(Q,S)}),Q&&N.isShadowed()){var F=Se(Q);F.x+=g("shadow.offset.x"),F.y+=g("shadow.offset.y"),Lg(F,g("shadow.blur")),Q=qh(Q,F)}return N._87I.clear(),Q},_42:function(j){var U=this,o=U._data,p=U.gv,q=U.s,E=q("opacity"),L=this.isShadowed();if(L){var D=j.shadowOffsetX,W=j.shadowOffsetY,M=j.shadowBlur,Z=j.shadowColor,t=p.getZoom();j.shadowOffsetX=q("shadow.offset.x")*t,j.shadowOffsetY=q("shadow.offset.y")*t,j.shadowBlur=q("shadow.blur")*t,j.shadowColor=U.getSelectColor()}if(E!=i){var J=j.globalAlpha;j.globalAlpha=E}U._80o(j),p.isLabelVisible(o)&&((!p._drawForChecking||q("label.selectable"))&&Cr(j,U.labelInfo),(!p._drawForChecking||q("label2.selectable"))&&Cr(j,U.label2Info)),p.isNoteVisible(o)&&(Xm(j,U.noteInfo),Xm(j,U.note2Info)),U._99O(j),E!=i&&(j.globalAlpha=J),L&&(j.shadowOffsetX=D,j.shadowOffsetY=W,j.shadowBlur=M,j.shadowColor=Z)},_80o:function(){},_47O:function(){},_24O:function(B,G){var C=this,o=C._data,H=C.gv,W=C.s,p=H[G](o);if(p!=i){var V=W(B+".scale"),E=W(B+".max"),N=W(B+".position"),l=C[B+"Info"]={label:p,scale:V,color:H[G+"Color"](o),font:W(B+".font"),opacity:W(B+".opacity"),align:W(B+".align"),rotation:C.getRotation(W(B+".rotation"),!1,N),background:H[G+"Background"](o)},b=_g(l,p);E>0&&E<b.width&&(l.labelWidth=b.width,b.width=E),1!==V&&(b.width*=V,b.height*=V);var q=C.getPosition(N,W(B+".offset.x"),W(B+".offset.y"),b,W(B+".position.fixed"));if(b.x=q.x-b.width/2,b.y=q.y-b.height/2,C._68o(l.rect=b,l.rotation),1!==V){var c=b.width/V,I=b.height/V;l.rect={x:q.x-c/2,y:q.y-I/2,width:c,height:I}}}},_26O:function(Y,R){var c=this,k=c.gv,T=c._data,z=c.s,d=k[R](T);if(d!=i){var f,O,w=z(Y+".scale"),q=c[Y+"Info"]={note:d,scale:w,data:T,view:k,expanded:z(Y+".expanded"),font:z(Y+".font"),color:z(Y+".color"),opacity:z(Y+".opacity"),align:z(Y+".align"),icon:z(Y+".icon"),backgroundImage:z(Y+".backgroundImage"),borderWidth:z(Y+".border.width"),borderColor:z(Y+".border.color"),background:k[R+"Background"](T)},v=c.getPosition(z(Y+".position"),z(Y+".offset.x"),z(Y+".offset.y")),K=v.x,E=v.y;if(q.expanded){var X,Q=z(Y+".max"),W=z(Y+".backgroundImage");W?(W=Ij(W),X={width:gq(W,T),height:eo(W,T)}):X=_g(q,d),X.width+=6,X.height+=2,Q>0&&Q<X.width&&(q.labelWidth=X.width,X.width=Q),f=X.width,O=X.height+8,q.clickRect={x:K-f*w/2,y:E-O*w,width:f*w,height:O*w*X.height/O}}else{var o=z(Y+".icon");o?(o=Ij(o),f=gq(o,T),O=eo(o,T)):(f=12,O=18),q.clickRect={x:K-f*w/2,y:E-O*w,width:f*w,height:O*w}}q.rect={x:K-f/2,y:E-O*w/2-O/2,width:f,height:O};var G=H(q.borderWidth/2)*w;c._68o({x:K-f*w/2-G,y:E-O*w-G,width:f*w+2*G,height:O*w+2*G})}},_48O:function(){},_99O:function(B){var l=this,r=l._38o;if(r){var S=l.gv,p=l._data,n=r.icons,b=l.interactiveInfo;b&&(b._38o={});for(var f in n){var c=n[f],W=r.rects[f];if(W){b&&(b._38o[f]=[]);var g=gf(c.opacity,p,S),o=gf(c.names,p,S),e=o?o.length:0,J=W.rotation;if(g!=i){var U=B.globalAlpha;B.globalAlpha*=g}for(var A=0;e>A;A++){var D=o[A],h=Ij(D),E=W[A];if(J){var u=E.x+E.width/2,L=E.y+E.height/2;B.save(),Ag(B,u,L),_p(B,J),Ag(B,-u,-L)}b&&b._38o[f].push(B.interactiveInfo={compInfos:[],matrix:J?new Ze(J,u,L).appendTranslate(-u,-L):new Ze}),ml(B,h,gf(c.stretch,p,S),E.x,E.y,E.width,E.height,l._data,l.gv),B.interactiveInfo=i,J&&B.restore()}g!=i&&(B.globalAlpha=U)}}}}});var sc=function(O,W){Kh(sc,this,[O,W])};Zi(sc,Dd,{_checkEmptyRect:!0,_40O:function(M,J){var f=this,i=f.s,Y=M.rect;(M.borderColor=f.gv.getBorderColor(f._data))&&(M.borderType=i("border.type"),M.borderWidth=i("border.width"),M.borderPadding=i("border.padding"),J=$(J,M.borderPadding+M.borderWidth/2));var G=f._data.getScale(),y=$(1,$(R(G.x),R(G.y)));if(M.selectWidth=f.getSelectWidth()){var Z=f.gv._zoom;M.selectType=i("select.type"),M._97o=f.getSelectColor(),M.selectPadding=i("select.padding"),J=$(J,(M.selectPadding+M.selectWidth/2/Z)/y)}J>0&&(J*=y,Y=Se(Y),Lg(Y,J)),f._68o(Y)},_39O:function(p,G){var g,v=this,b=G.rect;if(G.borderWidth>0&&(g=G.borderPadding,p.strokeStyle=G.borderColor,p.lineWidth=G.borderWidth,xi(p,G.borderType,{x:b.x-g,y:b.y-g,width:b.width+2*g,height:b.height+2*g}),p.stroke()),G.selectWidth>0){var D=v.gv._zoom;if(g=G.selectPadding,p.strokeStyle=G._97o,p.lineWidth=G.selectWidth/D,G.rotation!=i){p.save(),p.translate(G.position.x,G.position.y),p.rotate(G.rotation);var S=v._data,h=S.getWidth(),W=S.getHeight(),f=G.scale,e=G.anchor;b={x:f.x*-h*e.x,y:f.y*-W*e.y,width:f.x*h,height:f.y*W}}xi(p,G.selectType,{x:b.x-g,y:b.y-g,width:b.width+2*g,height:b.height+2*g}),G.rotation!=i&&p.restore(),p.stroke()}},dispose:function(){var R=this,u=R._htmlView;sc.superClass._3O.call(R),u&&(u.onHTMLRemoved&&u.onHTMLRemoved(),As(u))},_3O:function(){var d=this,m=d.s,u=d._data,O=d.gv,F=u.getStyle(rd),o=d.getBodyColor(),Z=d._83o=F?{shape:F,_53o:d.getBodyColor("shape.background"),_27Q:Ij(m("shape.repeat.image"),o),shapeGradientPack:m("shape.gradient.pack"),_54o:m("shape.border.width"),_55o:m("shape.border.color"),_56o:m("shape.border.3d"),_57o:m("shape.border.3d.color"),_58o:m("shape.border.3d.accuracy"),shapeGradient:m("shape.gradient"),_59o:m("shape.gradient.color"),_60o:m("shape.border.pattern"),_61o:m("shape.border.cap"),_62o:m("shape.border.join"),shapeForeground:m("shape.foreground"),bodyColor:o,gray:m("2d.gray")}:{img:Ij(O.getImage(u),o),bodyColor:o,gray:m("2d.gray"),stretch:m("image.stretch")};if(t&&!a);else{var x,n=Z.img;n&&n.renderHTML?(d._htmlInfo&&d._htmlInfo.img!==n&&(d._htmlInfo=i),d._htmlInfo||(d._htmlInfo={img:n,cache:{}}),x=n.renderHTML(u,O,d._htmlInfo.cache)):d._htmlInfo=i,d._htmlView&&d._htmlView!==x&&(d._htmlView.onHTMLRemoved&&d._htmlView.onHTMLRemoved(),As(d._htmlView.getView?d._htmlView.getView():d._htmlView)),(d._htmlView=x)&&O.appendHTML(x)&&(x.onHTMLAddedSync&&x.onHTMLAddedSync(),x.onHTMLAdded&&ur(x.onHTMLAdded)),Z.rect=u.getRect(),Z.position=u.p(),Z.scale=u.getScale(),Z.anchor=u.getAnchor(),Z.rotation=u.getRotation(),F===kk&&(Z._63o=m("shape.depth"));var Y=0;if(F)Y=Mn(i,Z._54o/2,Z._62o),d.s("shape.dash")&&(Y=$(Y,(d.s("shape.dash.width")||Z._54o)/2));else if(n&&n.boundExtend)if(Y=gf(n.boundExtend,u,O),n.boundExtendAbsolute){var C=u.getScale();Y/=O._zoom*$(1,$(R(C.x),R(C.y)))}else if(!gf(n.fitSize,u,O)){var S=gf(n.width,u,O),f=gf(n.height,u,O);Y*=$(u.getWidth()/S,u.getHeight()/f)}d._40O(Z,Y);var M=m("clip.percentage");if(1>M&&(0>M&&(M=0),Z.clipRect=oo(u.getAnchorRect(),m("clip.direction"),M)),F){var p=m("shape.fill.clip.percentage");1>p&&(0>p&&(p=0),Z.shapeClipRect=oo(u.getAnchorRect(),m("shape.fill.clip.direction"),p));var k=m("shape.foreground.clip.percentage");1>k&&(0>k&&(k=0),Z.shapeForegroundClipRect=oo(u.getAnchorRect(),m("shape.foreground.clip.direction"),k))}}},getPosition:function(t,S,o,i){var j=cg(t,this._83o.rect,i);return j.x+=S,j.y+=o,j},_80o:function(j){var r=this,t=r.s,y=r.gv,W=r._data,X=r._83o,c=X.rect,v=X.position,n=X.rotation,f=X.anchor,u=X.scale,N=X.shape,s=X.clipRect;if(!r._checkEmptyRect||c.width>0&&c.height>0){var M=W.getSize();if(M.x=-M.width*f.x,M.y=-M.height*f.y,j.save(),Ag(j,v.x,v.y),_p(j,n),vf(j,u.x,u.y),s&&(j.beginPath(),j.rect(s.x,s.y,s.width,s.height),j.clip()),y._drawForChecking&&X.img&&gf(X.img.pixelPerfect,W,y)===!1)Tl(j,M.x,M.y,M.width,M.height,"#888888");else if(r.freeDraw)r.freeDraw(j,M,X);else if(N){var l,H,x,L,d=X._60o,T=Ek(j,d),V=X._27Q,R=X._54o,k=X.shapeGradientPack,K=X.gray,I=j.lineJoin,S=j.lineCap,F=function(B){return K?z.toGrayColor(B):B};"roundRect"===N?l=t("shape.corner.radius"):"polygon"===N?l=t("shape.polygon.side"):"arc"===N&&(l=t("shape.arc.from"),H=t("shape.arc.to"),x=t("shape.arc.close"),L=t("shape.arc.oval")),j.lineJoin=X._62o,j.lineCap=X._61o;var h=F(X._53o);if(h||V||k){var b=X.shapeClipRect;b&&(j.save(),j.beginPath(),j.rect(b.x,b.y,b.width,b.height),j.clip()),xi(j,N,M,l,H,x,L),k?Pr(j,k):V?hf(j,V,F(X.bodyColor),null,W,y):qp(j,h,X.shapeGradient,F(X._59o),M),j.fill(),b&&j.restore(),k&&j.restore(),j!==T&&xi(T,N,M,l,H,x,L)}else xi(T,N,M,l,H,x,L);var o=X.shapeForeground;if(o){j.save();var E=X.shapeForegroundClipRect;E&&(j.beginPath(),j.rect(E.x,E.y,E.width,E.height),j.clip()),xi(j,N,M,l,H,x,L),qp(j,o,t("shape.foreground.gradient"),F(t("shape.foreground.gradient.color")),M),j.fill(),j.restore()}if(R>0){var G=t("shape.border.width.absolute");G&&(j.save(),j.setTransform(1,0,0,1,0,0)),j.lineWidth=R;var Y=F(X._55o);j.strokeStyle=Y,j.stroke(),G&&j.restore(),X._56o&&ap(j,Y,F(X._57o),R,y._zoom,X._58o)}if(Ak(j,d),t("shape.dash")){var a=t("shape.dash.width")||R;if(a>0){d=t("shape.dash.pattern");var T=Ek(j,d,r._2Q("shape.dash.offset"));T!==j&&xi(T,N,M,l,H,x,L),r._1Q(j,"shape",a,d)}}Vj(j,h,X._63o,M),j.lineJoin=I,j.lineCap=S}else{var D=r.interactiveInfo;D&&(j.interactiveInfo=D.bodyInfo={compInfos:[],matrix:new Ze(n,v.x,v.y,u.x,u.y)}),X.gray&&(j.compGray=!0);var O=X.img;O&&O.cacheRule!=i&&(O=Gl(j,O,X.stretch,M.width,M.height,W,y,X.bodyColor)),ml(j,O,X.stretch,M.x,M.y,M.width,M.height,W,y,X.bodyColor),j.compGray=!1,j.interactiveInfo=i}j.restore()}r._39O(j,X)},_48O:function(){},_47O:function(){}});var uj=function(I,_){Kh(uj,this,[I,_])},ik=function(e,T,p,j){var s=_m(e,T);return p=j?_(p,s):Fl(p,s),s?p/=s:p=0,{x:e.x+(T.x-e.x)*p,y:e.y+(T.y-e.y)*p}};Zi(uj,Dd,{_3O:function(){var Q,H=this,_=H._data,d=H.gv,N=H.s,f=N($o),Y=_.isLooped(),e=N("edge.width"),y=N("edge.center"),j=N("edge.offset"),E=d.getBorderColor(_),n=E?N("border.width"):0,B=H.getSelectWidth(),t=_._40I,l=_._41I,u=H._78o=t&&l?{looped:Y,type:f,width:e,center:y,color:H.getBodyColor("edge.color"),borderColor:E,borderWidth:n,_97o:B?H.getSelectColor():i,selectWidth:B,pattern:N("edge.pattern"),cap:N("edge.cap"),join:N("edge.join"),is3d:N("edge.3d"),_67o:N("edge.3d.color"),_66o:N("edge.3d.accuracy"),gray:N("2d.gray")}:i;if(u){var v=z.getEdgeType(f);if(v){var a=v(_,eg(H,d,_,Y,f),d,H._19Q);a.points&&a.points.size()>1?(u.edgeTypeInfo=a,Q=xn(u.edgeTypeInfo.points)):a[Rg]&&a.rect&&(u.edgeTypeInfo=a,Q=a.rect)}else{var o=N("edge.source.anchor.x"),S=N("edge.source.anchor.y"),h=N("edge.target.anchor.x"),p=N("edge.target.anchor.y"),k=gp(d,_,"source"),x=gp(d,_,"target");if(f===hb){var g=u.points=N(yf)||zi,D=g.size();u.segments=N("edge.segments");var c=o!==s||S!==s||Cc(t),O=h!==s||p!==s||Cc(l);if(!y)if(j)c||(k=ik(k,D?g.get(0):x,j,D)),O||(x=ik(x,D?g.get(D-1):k,j,D));else{var C;c||(C=$q(k,D?g.get(0):x,zk(d,t)),C&&(k={x:C[0],y:C[1]})),O||(C=$q(D?g.get(D-1):k,x,zk(d,l)),C&&(x={x:C[0],y:C[1]}))}Q=qh(xn(u.points),xn(k,x))}else{var G=eg(H,d,_,Y,f);if(H._19Q||(G=-G),Y)k=Se(k),k.x=d.getNodeRect(t).x,u.radius=G,Q={x:k.x-G,y:k.y-G,width:2*G,height:2*G};else{var Z=_m(k,x),P=Fl(j,Z),W={x:P,y:G},T={x:Z-P,y:G},F=K(x.y-k.y,x.x-k.x),U=u.mat=new zb(F);if(u.orienAngle=F,u.angle=x.x<k.x?F+J:F,u.rect={x:W.x,y:W.y,width:T.x-W.x,height:0},u.origin=k,W=U.tf(W),W.x+=k.x,W.y+=k.y,T=U.tf(T),T.x+=k.x,T.y+=k.y,y){var r={x:Z,y:0};r=U.tf(r),r.x+=k.x,r.y+=k.y,Q=xn([k,W,T,r]),u.c1=k,u.c2=r}else Q=xn(W,T);k=W,x=T}}u.sourcePoint=k,u.targetPoint=x,_._lastSourcePoint=k,_._lastTargetPoint=x}var A=0;N("edge.dash")&&(A=N("edge.dash.width")||e);var M="square"===u.cap?.71:.5;Mn(Q,$(A*M,e*M+n+B),u.join),H._68o(Q)}},getRotation:function(K,u,l){K=K||0;var z=this._78o;if(z){var C,_=z.angle,P=z.points,v=z.edgeTypeInfo;if(_!=i)return u?z.orienAngle+K:_+K;if(v&&v[Rg])return v.getRotation?v.getRotation(this,K,u,l):0;if(v&&v.points){var L=v.points;return C=L.size(),lg[l]?C&&0===C%2?eq(L.get(C/2-1),L.get(C/2),u,K):K:Gc[l]?eq(L.get(0),L.get(1),u,K):eq(L.get(C-2),L.get(C-1),u,K)}if(P)return C=P.size(),lg[l]?C&&0===C%2?eq(P.get(C/2-1),P.get(C/2),u,K):K:Gc[l]?eq(z.sourcePoint,C?P.get(0):z.targetPoint,u,K):eq(C?P.get(C-1):z.sourcePoint,z.targetPoint,u,K)}return K},getPosition:function(O,F,d,L,q){var B=this._78o;if(B){var H,e=B.type,a=B.points,D=B.edgeTypeInfo,u=B.sourcePoint,n=B.targetPoint;if(!e)return B.looped?{x:u.x-B.radius+F,y:u.y+d}:(q&&u&&n&&(u.x>n.x||u.x===n.x&&u.y>n.y)&&(O=oi[O],d=-d),H=cg(O,B.rect,L),H.x+=F,H.y+=d,H=B.mat.tf(H),H.x+=B.origin.x,H.y+=B.origin.y,H);if(D&&D[Rg])return D.getPosition?D.getPosition(this,O,F,d,L,q):{x:(u.x+n.x)/2,y:(u.y+n.y)/2};if(a){var H,S=a.size();if(lg[O]){if(S){var s=S%2;if(0===s)return bp(a.get(S/2-1),a.get(S/2),O,F,d,L,q);H=a.get((S-s)/2)}else H={x:(u.x+n.x)/2,y:(u.y+n.y)/2};return H=cg(O,{x:H.x,y:H.y,width:0,height:0},L),H.x+=F,H.y+=d,H}return Gc[O]?bp(u,S?a.get(0):n,O,F,d,L,q):bp(S?a.get(S-1):u,n,O,F,d,L,q)}if(D){var w=D.points,S=w.size();if(lg[O]){var s=S%2;return 0===s?bp(w.get(S/2-1),w.get(S/2),O,F,d,L,q):(H=w.get((S-s)/2),H=cg(O,{x:H.x,y:H.y,width:0,height:0},L),H.x+=F,H.y+=d,H)}return Gc[O]?bp(w.get(0),w.get(1),O,F,d,L,q):bp(w.get(S-2),w.get(S-1),O,F,d,L,q)}}return qm},_42:function(l){this._78o&&uj.superClass._42.call(this,l)},drawPath:function(m,o){m.beginPath();var g=o.type,V=o.points,z=o.segments,X=o.edgeTypeInfo;if(!g||V){var M=o.sourcePoint,y=M.x,q=M.y,u=o.targetPoint,p=u.x,r=u.y;if(g)if(z){var _=new Yi({x:y,y:q});_.addAll(V),_.add({x:p,y:r}),Dh(m,_,z)}else m.moveTo(y,q),V.each(function(a){m.lineTo(a.x,a.y)}),m.lineTo(p,r);else o.looped?m.arc(y,q,o.radius,0,b,!0):o.center?(m.moveTo(o.c1.x,o.c1.y),m.lineTo(y,q),m.lineTo(p,r),m.lineTo(o.c2.x,o.c2.y)):(m.moveTo(y,q),m.lineTo(p,r))}else X&&(X.points?Dh(m,X.points,X.segments):X[Rg]&&X[Rg](m,X))},_80o:function(e){var f=this,t=f.s,$=f._78o,T=$.width,R=$.selectWidth,n=$.borderWidth,w=e.lineJoin,g=e.lineCap,V=$.gray,L=$.pattern;e.lineJoin=$.join,e.lineCap=$.cap,f.drawPath(Ek(e,L),$);var p=t("edge.width.absolute");p&&(e.save(),e.setTransform(1,0,0,1,0,0)),R&&(e.strokeStyle=$._97o,e.lineWidth=T+2*(n+R),e.stroke()),n&&(e.strokeStyle=V?z.toGrayColor($.borderColor):$.borderColor,e.lineWidth=T+2*n,e.stroke());var G=V?z.toGrayColor($.color):$.color,J=V?z.toGrayColor($._67o):$._67o;if(e.strokeStyle=G,e.lineWidth=T,e.stroke(),$.is3d&&ap(e,G,J,T,f.gv._zoom,$._66o),Ak(e,L),t("edge.dash")){L=t("edge.dash.pattern");var K=Ek(e,L,f._2Q("edge.dash.offset"));K!==e&&f.drawPath(K,$),f._1Q(e,"edge",t("edge.dash.width")||T,L)}p&&e.restore(),e.lineJoin=w,e.lineCap=g},_48O:function(){},_47O:function(){}});var gh=function(d,n){Kh(gh,this,[d,n])};Zi(gh,sc,{_3O:function(){var M,Z,$=this,J=$.s,s=$._data,Q=$.gv;if($._88I=i,s.isExpanded()&&s.eachChild(function(w){if(gj(w)){var b=Q.getBoundsForGroup(w);b&&(Z||(Z=[]),Z.push(b),M=qh(M,b))}}),M){var O=Q.getLabel(s),N=J("group.type");M=Zd(N,Z,M),fo(M,s,"group.padding",1);var S=$._88I={type:N,rect:M,_64o:M};if(!N&&O!=i){var P,e=$.labelInfo={label:O,color:J("group.title.color"),font:J("group.title.font"),align:J("group.title.align")},F=_g(e,O),t=F.width,D=F.height,Y=J("group.title.align"),f=J("group.title.orientation");if((f===bm||f===Lp)&&t>M.width?M.width=t:(f===br||f===lk)&&t>M.height&&(M.height=t),e.rect={y:M.y-D,width:F.width,height:D},P=Y===br?M.x:Y===lk?M.x+M.width-t:M.x+M.width/2-t/2,e.rect.x=P,f===Lp)S.titleRect={x:M.x,y:M.y+M.height,width:M.width,height:D},S.rect={x:M.x,y:M.y,width:M.width,height:M.height+D},e.rect={x:P,y:M.y+M.height,width:t,height:D};else if(f===br){var v=S.titleRect={x:M.x-D,y:M.y,width:D,height:M.height};S.rect={x:M.x-D,y:M.y,width:M.width+D,height:M.height},e.rect={x:v.x+D/2-M.height/2,y:v.y+M.height/2-D/2,width:M.height,height:D},e.rotation=-Math.PI/2}else if(f===lk){var v=S.titleRect={x:M.x+M.width,y:M.y,width:D,height:M.height};S.rect={x:M.x,y:M.y,width:M.width+D,height:M.height},e.rect={x:v.x+D/2-M.height/2,y:v.y+M.height/2-D/2,width:M.height,height:D},e.rotation=Math.PI/2}else S.titleRect={x:M.x,y:M.y-D,width:M.width,height:D+1},S.rect={x:M.x,y:M.y-D,width:M.width,height:M.height+D}}$._40O(S,J("group.border.width")/2)}else gh.superClass._3O.call($)},getPosition:function(o,h,E,I){var B=this._88I;if(B){var U=cg(o,B.rect,I);return U.x+=h,U.y+=E,U}return gh.superClass.getPosition.apply(this,arguments)},_24O:function(J,S){var L=this._88I;(!L||L.type||"label2"===J)&&gh.superClass._24O.call(this,J,S)},_80o:function(r){var P=this,K=P._88I;if(K){var A=P._data,E=P.s,q=P.gv,l=K.type,d=K.rect,N=K._64o,Q=K.titleRect,F=P.getBodyColor(),O=Ij(E("group.image"),F),X=E("group.image.stretch"),w=P.getBodyColor("group.background"),b=Ij(E("group.repeat.image"),F),j=E("group.gradient.pack"),v=E("group.gradient"),f=E("group.gradient.color"),R=E("group.border.width"),M=E("group.border.color"),z=E("group.border.pattern"),e=E("group.title.orientation"),i=E("group.depth");if(l){var a=r.lineJoin,t=r.lineCap;if(r.lineJoin=E("group.border.join"),r.lineCap=E("group.border.cap"),O){if(r.save(),xi(r,l,d),r.clip(),ml(r,O,X,d.x,d.y,d.width,d.height,A,q,F),r.restore(),R>0){var I=Ek(r,z);xi(I,l,d),r.lineWidth=R,r.strokeStyle=M,r.stroke(),Ak(r,z)}}else{var I=Ek(r,z);w||b||j?(xi(r,l,d),j?Pr(r,j):b?hf(r,b,F,null,A,q):qp(r,w,v,f,d),r.fill(),j&&r.restore(),r!==I&&xi(I,l,d)):xi(I,l,d),R>0&&(r.lineWidth=R,r.strokeStyle=E("group.border.color"),r.stroke()),Ak(r,z),l===kk&&Vj(r,w,i,d)}r.lineJoin=a,r.lineCap=t}else{var h=E("group.title.background"),m=E("group.border.radius");if(O)ml(r,O,X,N.x,N.y,N.width,N.height,A,q,P.getBodyColor());else if(w||b)if(b?hf(r,b,F,null,A,q):qp(r,w,v,f,N),0===R)xi(r,kk,N),r.fill(),Vj(r,w,i,N);else{switch(r.beginPath(),e){case Lp:Hi(r,N.x,N.y,N.width,N.height,m,m,0,0);break;case br:Hi(r,N.x,N.y,N.width,N.height,0,m,0,m);break;case lk:Hi(r,N.x,N.y,N.width,N.height,m,0,m,0);break;case bm:Hi(r,N.x,N.y,N.width,N.height,0,0,m,m)}r.fill()}if(Q&&h)if(0===R)Tl(r,Q.x,Q.y,Q.width,Q.height,h),Vj(r,h,i,Q);else{switch(r.beginPath(),r.fillStyle=h,e){case Lp:Hi(r,Q.x,Q.y,Q.width,Q.height,0,0,m,m);break;case br:Hi(r,Q.x,Q.y,Q.width,Q.height,m,0,m,0);break;case lk:Hi(r,Q.x,Q.y,Q.width,Q.height,0,m,0,m);break;case bm:Hi(r,Q.x,Q.y,Q.width,Q.height,m,m,0,0)}r.fill()}if(R>0){var I=Ek(r,z);if(xi(I,"roundRect",d,m),r.lineWidth=R,r.strokeStyle=M,Q&&E("group.splitLine")){var B=Q.x,s=Q.y,y=Q.width,S=Q.height;e===Lp?(r.moveTo(B,s),r.lineTo(B+y,s)):e===br?(r.moveTo(B+y,s),r.lineTo(B+y,s+S)):e===lk?(r.moveTo(B,s),r.lineTo(B,s+S)):(r.moveTo(B,s+S),r.lineTo(B+y,s+S))}r.stroke(),Ak(r,z)}}P._39O(r,K)}else gh.superClass._80o.call(P,r)}});var ok=function(l,h){Kh(ok,this,[l,h])};Zi(ok,sc,{_80o:function(V){this._39O(V,this._83o)}});var ep=function(J,C){Kh(ep,this,[J,C])};Zi(ep,sc,{_3O:function(){var B=this,M=B._data,C=B.s,U=B.gv,l=M.getPoints(),G=U.getBorderColor(M),d=G?C("border.width"):0,v=B.getSelectWidth(),W=C("shape.border.width"),s=M.getRect(),w=M.getAnchorRect(),O=U.getBodyColor(M),N=B._99o=l.isEmpty()?i:{rect:s,rotation:M.getRotation(),fillRule:C("shape.fill.rule"),scale:M.getScale(),position:M.p(),points:l,segments:M.getSegments(),bodyColor:O,borderColor:G,borderWidth:d,_94o:C("shape.border.3d"),_95o:C("shape.border.3d.color"),_96o:C("shape.border.3d.accuracy"),_97o:v?B.getSelectColor():i,selectWidth:v,_53o:C("shape.background"),_27Q:Ij(C("shape.repeat.image"),O),shapeGradientPack:C("shape.gradient.pack"),_54o:W,_55o:C("shape.border.color"),shapeGradient:C("shape.gradient"),_59o:C("shape.gradient.color"),_60o:C("shape.border.pattern"),_61o:C("shape.border.cap"),_62o:C("shape.border.join"),shapeForeground:C("shape.foreground"),gray:C("2d.gray")};
if(N){w.x+=N.position.x,w.y+=N.position.y,N.gradientRect=w;var E=M.getScale(),b=$(1,$(R(E.x),R(E.y)));C("shape.dash")&&C("shape.dash.width")>W&&(W=C("shape.dash.width"));var t,A=C("shape.border.width.absolute");t=A?(W+d+v)/B.gv._zoom/b:W*("square"===N._61o?.71:.5)+d+v/B.gv._zoom/b,t&&(t*=b,s=Se(s),Mn(s,t,N._62o)),B._68o(s);var V=C("clip.percentage");1>V&&(0>V&&(V=0),N.clipRect=oo(M.getAnchorRect(),C("clip.direction"),V));var J=C("shape.fill.clip.percentage");1>J&&(0>J&&(J=0),N.shapeClipRect=oo(M.getAnchorRect(),C("shape.fill.clip.direction"),J));var F=C("shape.foreground.clip.percentage");1>F&&(0>F&&(F=0),N.shapeForegroundClipRect=oo(M.getAnchorRect(),C("shape.foreground.clip.direction"),F))}},getPosition:function(k,v,R,n){var Q=this._99o;if(Q){var X=cg(k,Q.rect,n);return X.x+=v,X.y+=R,X}return qm},_42:function(N){this._99o&&ep.superClass._42.call(this,N)},_80o:function(D){var K,r=this,y=r.s,f=r._99o,l=f.position,t=f.scale,O=f.rotation,P=f.borderWidth,p=f.selectWidth/r.gv._zoom,N=f._27Q,H=f.shapeGradientPack,X=f._54o,u=f.clipRect,s=f.shapeClipRect,G=f.points,v=f.segments,U=r._data.isClosePath(),R=f.fillRule,T=f.gray,n=function(H){return T?z.toGrayColor(H):H},W=n(f._53o),V=W||N||H;D.save(),Ag(D,l.x,l.y),_p(D,O),vf(D,t.x,t.y),u&&(D.beginPath(),D.rect(u.x,u.y,u.width,u.height),D.clip()),V&&s&&(D.save(),D.beginPath(),D.rect(s.x,s.y,s.width,s.height),D.clip()),Ag(D,-l.x,-l.y);var c=f._60o,$=Ek(D,c),o=D.lineJoin,Y=D.lineCap;D.lineJoin=f._62o,D.lineCap=f._61o;var C=n(f.bodyColor);V?(Dh(D,G,v,U),H?Pr(D,H):N?hf(D,N,C,null,r._data,r.gv):(K=C?C:W,qp(D,K,f.shapeGradient,n(f._59o),f.gradientRect)),D.fill(R),s&&(D.restore(),Ag(D,-l.x,-l.y)),H&&D.restore(),$!==D&&Dh($,G,v,U)):Dh($,G,v,U);var M=f.shapeForeground;if(M){D.save();var B=f.shapeForegroundClipRect;B&&(Ag(D,l.x,l.y),D.beginPath(),D.rect(B.x,B.y,B.width,B.height),D.clip(),Ag(D,-l.x,-l.y)),Dh(D,G,v,U),qp(D,M,y("shape.foreground.gradient"),n(y("shape.foreground.gradient.color")),f.gradientRect),D.fill(R),D.restore()}var E=y("shape.border.width.absolute");if(E&&(D.save(),D.setTransform(1,0,0,1,0,0)),p&&(D.strokeStyle=f._97o,D.lineWidth=X+2*(P+p),D.stroke()),P&&(D.strokeStyle=n(f.borderColor),D.lineWidth=X+2*P,D.stroke()),X&&(K=n(f._55o),!W&&C&&(K=C),D.strokeStyle=K,D.lineWidth=X,D.stroke(),f._94o&&ap(D,K,n(f._95o),X,r.gv._zoom,f._96o)),Ak(D,c),y("shape.dash")){var d=y("shape.dash.width")||X;if(d>0){c=y("shape.dash.pattern");var $=Ek(D,c,r._2Q("shape.dash.offset"));$!==D&&Dh($,G,v,U),r._1Q(D,"shape",d,c)}}E&&D.restore(),D.lineJoin=o,D.lineCap=Y,D.restore()},_48O:function(){},_47O:function(){}});var vr=function(m,q){Kh(vr,this,[m,q])};Zi(vr,ep,{getRotation:function(N,C,g){N=N||0;var o=this._data.getPoints(),O=o.size();return O>1?lg[g]?O&&0===O%2?eq(o.get(O/2-1),o.get(O/2),C,N):N:Gc[g]?eq(o.get(0),o.get(1),C,N):eq(o.get(O-2),o.get(O-1),C,N):N},getPosition:function(e,D,R,j,A){var J=this._data.getPoints(),d=J.size();if(d>1){if(lg[e]){var v=d%2;if(0===v)return bp(J.get(d/2-1),J.get(d/2),e,D,R,j,A);var i=J.get((d-v)/2),X={x:i.x,y:i.y,width:0,height:0};return i=cg(e,X,j),i.x+=D,i.y+=R,i}return Gc[e]?bp(J.get(0),J.get(1),e,D,R,j,A):bp(J.get(d-2),J.get(d-1),e,D,R,j,A)}return qm}});var Jk=function(T,N){Kh(Jk,this,[T,N])};Zi(Jk,sc,{_3O:function(){var H=this;Jk.superClass._3O.call(H);var $=H.s,J=H._83o;H._82o=J.img||J.shape?i:{background:H.getBodyColor("grid.background"),depth:$("grid.depth"),rect:J.rect,_88o:$("grid.cell.depth"),cellBorderColor:$("grid.cell.border.color"),_89o:$("grid.row.count"),_90o:$("grid.column.count"),block:$("grid.block"),_91o:$("grid.block.color"),_92o:$("grid.block.padding"),_93o:$("grid.block.width")}},_80o:function(e){var h=this,F=h._82o;if(!F)return Jk.superClass._80o.call(h,e),void 0;var i,r,p=h._data,g=F.background,k=F.rect,m=F.block,b=F._91o,t=F._92o,R=F._93o,D=F._88o,z=F.cellBorderColor,Y=F._89o,O=F._90o;if(g)if(Tl(e,k.x,k.y,k.width,k.height,g),Vj(e,g,F.depth,k),D)for(i=0;Y>i;i++)for(r=0;O>r;r++)k=p.getCellRect(i,r),k&&Vj(e,g,D,k);else if(z){for(e.beginPath(),i=0;Y>i;i++)for(r=0;O>r;r++)k=p.getCellRect(i,r),k&&e.rect(k.x,k.y,k.width,k.height);e.strokeStyle=z,e.lineWidth=1,e.stroke()}if("h"===m)for(i=0;Y>i;i++)k=qh(p.getCellRect(i,0),p.getCellRect(i,O-1)),Lg(k,t),Yn(e,b,k.x,k.y,k.width,k.height,R);else if("v"===m)for(r=0;O>r;r++)k=qh(p.getCellRect(0,r),p.getCellRect(Y-1,r)),Lg(k,t),Yn(e,b,k.x,k.y,k.width,k.height,R);h._39O(e,h._83o)}});var ir=function(b,H){Kh(ir,this,[b,H])};Zi(ir,sc,{_checkEmptyRect:!1,_81o:function(){var w=this._data,n=ir.superClass._81o.call(this),c=w.s("text");if(c!=i){var v,h,$=w.s("text.font"),l=w.s("text.align"),q=w.s("text.vAlign"),L=td($,c),_=L.width,g=L.height,Q=w.getAnchor(),W=w.getWidth(),e=w.getHeight();"left"===l?v=-W*Q.x:"center"===l?v=-W*Q.x+(W-_)/2:"right"===l&&(v=W*(1-Q.x)-L.width),"top"===q?h=-e*Q.y:"middle"===q?h=-e*Q.y+(e-g)/2:"bottom"===q&&(h=e*(1-Q.y)-L.height);var u,t=w.getMatrix();if(u=xn([t.tf(v,h),t.tf(v+_,h),t.tf(v+_,h+g),t.tf(v,h+g)]),n=qh(n,u),n&&w.s("text.shadow")){var k=Se(n);k.x+=w.s("text.shadow.offset.x"),k.y+=w.s("text.shadow.offset.y"),Lg(k,w.s("text.shadow.blur")),n=qh(n,k)}}return n}});var vi=gk.Interactor=function(V){this.gv=this._graphView=V};xe("Interactor",j,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(q){this.gv.fi(q)},setCursor:function(k){Aj||this.gv.setCursor(k)},startDragging:function(x){var I=this;I._lastClientPoint=Mi(x),I._lastLogicalPoint=I.gv.lp(x),Vn(I,x)},clearDragging:function(){var p=this;p._lastClientPoint=p._lastLogicalPoint=p._logicalPoint=i},autoScroll:function(N){return this.gv.autoScroll(N,this._lastClientPoint)}});var Yf=i,qb=function(m){Yf.handleWindowTouchMove(m)},Sc=function(E){Yf.handleWindowTouchEnd(E),m(F,me,qb),m(F,Mh,Sc),Yf=i},Vh=function(K){Yf.handleWindowMouseMove(K)},gm=function(P){Yf.handleWindowMouseUp(P),m(F,_h,Vh),m(F,ar,gm),Yf=i},Qm=function(e,t){e!==Yf&&(Yf?Aj?Yf.handleWindowTouchEnd(t):Yf.handleWindowMouseUp(t):Aj?(Z(F,me,qb),Z(F,Mh,Sc)):(Z(F,_h,Vh),Z(F,ar,gm)),Yf=e)},qn=function(j){var l=this;l.gv=j,l._is2d=j instanceof gk.GraphView,l._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",pm,"wheel"].forEach(function(g){l.addListener(g)}),l.initImageResource()};Zi(qn,vi,{enableVR:function(p){var R=this;if(!!R._vrEnable!==p)if(R._vrEnable=p,p)R.gv.vr.mp(R.onVRControllerChange,R);else if(R.gv.vr.ump(R.onVRControllerChange,R),R._vrRayPolyline){var c=R.gv.dm();c.remove(R._vrRayPolyline),c.remove(R._vrRayHitPoint),R._vrRayPolyline=s,R._vrRayHitPoint=s}},onVRControllerChange:function(U){var r=this,X=U.property,T=U.newValue,s=r.gv.vr.getController(T.id),M=s.getRay();M&&("gamepad.button.trigger"===X?"down"===T._62O?r.handle_mousedown(M):r.handleWindowMouseUp(M):"gamepad.pose"===X&&(r.handle_mousemove(M),r.handleWindowMouseMove(M)))},drawVRRay:function(L,G,t){var U,M=this,l=M.gv,Y=M._vrRayPolyline,Q=!1;if(Y)U=M._vrRayHitPoint;else{var d=l.dm();M._vrRayPolyline=Y=new r.Polyline,M._vrRayHitPoint=U=new r.Node,U.s({shape3d:"billboard","shape3d.transparent":!0,"texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),U.setAnchor3d(.5,.5,.499);var w=.2/l.vr.measureOflength;U.s3(w,w,w),Y.s("intersect",!1),U.s("intersect",!1),d.add(Y),d.add(U),Q=!0}if(G){var x=t.world,H=t.worldNormal,D=x.x,V=x.y,K=x.z;Y.s("shape.border.color","red"),Y.setPoints([{x:L.origin.x,y:L.origin.z,e:L.origin.y},{x:D,y:K,e:V}]),U.s("3d.visible",!0),U.p3(D,V,K),U.lookAtDirection([H.x,H.y,H.z],"front")}else{Y.s("shape.border.color","blue");var v=new r.Math.Vector3;v.copy(L.direction).setLength(1e3/M.gv.vr.measureOflength).add(L.origin),Y.setPoints([{x:L.origin.x,y:L.origin.z,e:L.origin.y},{x:v.x,y:v.z,e:v.y}]),U.s("3d.visible",!1)}l.fi({kind:"vrRayIntersect",ray:L,data:G,intersect:t,polyline:Y,hitNode:U,begin:Q})},setPreventEventDefault:function(S,I){var Z=this,V=Z._eventListeners[S];V?V._prevent=I:Z._eventListeners[S]=V={_removal:s,_prevent:I}},removeListener:function(q){var r=this,y=r._eventListeners[q];y&&y._removal&&(y._removal(),y._removal=s)},addListener:function(l){var a=this,K=a._eventListeners[l];if(K||(a._eventListeners[l]=K={_removal:s,_prevent:!0}),!K||!K._removal){var T=function(q){K._prevent&&z.preventDefault(q),a.disabled||("wheel"===l?oc(a,q):a["handle_"+l](q))};Z(a.gv.getView(),l,T),K._removal=function(){m(a.gv.getView(),l,T)}}},handleWindowTouchMove:function(S){this.handleWindowMouseMove(S)},handleWindowMouseMove:function(h){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",h):(this.handleDownInfo("onBeginDrag",h),this.isDragging=!0))},handleWindowTouchEnd:function(S){this.handleWindowMouseUp(S)},handleWindowMouseUp:function(k){if(this.isDragging&&(this.handleDownInfo("onEndDrag",k),this.isDragging=!1),this.downInfo){var I=this.handle("onUp",k);if(I&&I.data===this.downInfo.data){this.handleMissingUp(k);var P=this,M=2===k.button?"onContextMenu":"onClick";if(!P._dbclickTimer)return P._dbclickTimer=e(function(){delete P._dbclickTimer,P.handleClick(k,M,I),this.downInfo=i},z.clickDelay),void 0;Y(P._dbclickTimer),delete P._dbclickTimer,M="onDoubleClick",P.handleClick(k,M,I)}else this.handleDownInfo("onUp",k);this.downInfo=i}},handle_mouseleave:function(L){var b=this,A=b.gv,J=b.currentInfo?b.currentInfo.data:i;if(J){J.s("onLeave")&&J.s("onLeave")(L,J,A),b.fire("data","onLeave",L,J);var j=b.currentInfo?b.currentInfo.hits:i;if(j)for(var y in j)b.handleLeave(L,y);b.currentInfo=i}},handle_mousewheel:function(i){i.scrollDelta=i.wheelDelta/40,this.handle("onScroll",i)},handle_DOMMouseScroll:function(E){E.scrollDelta=2===E.axis?-E.detail:0,this.handle("onScroll",E)},handle_touchstart:function(O){this.handle_mousedown(O)},handle_touchmove:function(t){this.handle("onMove",t)},handle_mousedown:function(z){this.isDragging&&(this.handleDownInfo("onEndDrag",z),this.isDragging=!1),this.downInfo=this.handle("onDown",z),this.downInfo&&Qm(this,z)},handle_mousemove:function(L){var d=this,Q=d.gv;d._hoverTimer&&(Y(d._hoverTimer),delete d._hoverTimer);var J,n,g,K=d.handle("onMove",L),y=this.currentInfo?this.currentInfo.data:i,c=this.currentInfo?this.currentInfo.hits:i;if(K&&(n=K.data,g=K.hits,d._hoverTimer=e(function(){Y(d._hoverTimer),delete d._hoverTimer,d.handle("onHover",L,K)},Q.getHoverDelay()||z.hoverDelay)),n!==y){if(y&&(y.s("onLeave")&&y.s("onLeave")(L,y,Q),this.fire("data","onLeave",L,y)),n&&(n.s("onEnter")&&n.s("onEnter")(L,n,Q),this.fire("data","onEnter",L,n)),c)for(J in c)this.handleLeave(L,J);if(g)for(J in g){var W=g[J],$=n._interactPrefix=W.prefix,S=$&&n.a($+"onEnter")||W.target.onEnter;S&&S.call(W.target,L,n,Q,W.point,W.width,W.height),this.fire(W.type,"onEnter",W.event,W.data,W.image,W.comp,W.point,W),n._interactPrefix=null}}else{if(c)for(J in c)g&&g[J]||this.handleLeave(L,J);if(g)for(J in g)if(!c||!c[J]){var W=g[J],$=n._interactPrefix=W.prefix,S=$&&n.a($+"onEnter")||W.target.onEnter;S&&S.call(W.target,L,n,Q,W.point,W.width,W.height),this.fire(W.type,"onEnter",W.event,W.data,W.image,W.comp,W.point,W),n._interactPrefix=null}}this.currentInfo=K},handle:function(P,d,F){var u,M=this,$=M.gv;if(M._is2d){if(F=F||$.getDataInfoAt(d),!F||!$.isInteractive(F.data))return;if(u=F.ui.interactiveInfo){var e,k=F.data;if(k.s(P)&&k.s(P)(d,k,$),this.fire("data",P,d,k),"body"===F.part&&u.bodyInfo)e="body",F.hits=this.handleImage(e,$.getImage(k),P,d,k,F.point,u.bodyInfo);else if("icons"===F.part&&u._38o){var J=u._38o[F.name];J&&J[F.index]&&(e="icons|"+F.name+"|"+F.index,F.hits=this.handleImage(e,F.icon,P,d,k,F.point,J[F.index]))}}return F}var k,w;if(!F)if(d&&d instanceof r.Math.Ray){var Z=$.vr.intersectWorld(d);if(k=Z.data,w=Z.intersect,M.drawVRRay(d,k,w),!k)return;var G=$.getData3dUI(k);if(u=G.interactiveInfo,!u)return;F={data:k,part:w.part,ui:G}}else{if(F=$.getDataInfoAt(d),!F)return;F&&(F={data:F.data,part:F.part})}if($.isInteractive(F.data)){if(!w){k=F.data;var G=$.getData3dUI(k);if(F.ui=G,u=G.interactiveInfo,!u)return F;if(w=$.intersectObject(d,k),!w)return}k.s(P)&&k.s(P)(d,k,$),this.fire("data",P,d,k);var n,p=w.part;return"body"!==p&&(n=k.s(p+".image")||k.s("shape3d."+p+".image")),n||(n=k.s("all.image")||k.s("shape3d.image")),u="object"==typeof n?u[n.uuid]:u[n],u&&u.bodyInfo?(F.part="body",F.interactiveInfo=u,F.point=w.uv.multiply({x:u.bodyInfo.rect.width,y:u.bodyInfo.rect.height}),F.image=n,F.hits=this.handleImage("body",n,P,d,k,F.point,u.bodyInfo),F):F}},_handleLeaveOrMissing:function(s,d,V){var r="leave"===s?this.currentInfo:this.downInfo;if(r){var g=r.interactiveInfo||r.ui.interactiveInfo;if(g){var h,J,b=r.data;if(this._is2d){if(J=this.gv.lp(d),"body"===r.part&&g.bodyInfo)h="body","leave"===s?this.handleLeaveImage(V,h,this.gv.getImage(b),d,b,J,g.bodyInfo):this.handleMissingUpImage(h,this.gv.getImage(b),d,b,J,g.bodyInfo);else if("icons"===r.part&&g._38o){var y=g._38o[r.name];y&&y[r.index]&&(h="icons|"+r.name+"|"+r.index,"leave"===s?this.handleLeaveImage(V,h,r.icon,d,b,J,y[r.index]):this.handleMissingUpImage(h,r.icon,d,b,J,y[r.index]))}}else{if(!g.bodyInfo)return;var n=this.gv.intersectObject(d,b);J=n?n.uv.multiply({x:g.bodyInfo.rect.width,y:g.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===s?this.handleLeaveImage(V,"body",r.image,d,b,J,g.bodyInfo):this.handleMissingUpImage("body",r.image,d,b,J,g.bodyInfo)}}}},handleClick:function(g,c,O){var v=this,M=this.downInfo;if(M&&O){var J,N=O.interactiveInfo||O.ui.interactiveInfo,i=O.data,G=this.gv;if(i.s(c)&&i.s(c)(g,i,G),v.fire("data",c,g,i),N)if(this._is2d){if(M.part===O.part){var I=G.lp(g);"body"===O.part&&N.bodyInfo&&(J="body",this.handleClickImage(J,G.getImage(i),c,g,i,I,N.bodyInfo,O))}}else{if(!N.bodyInfo)return;var $=G.intersectObject(g,i);if(!$)return;I=$.uv.multiply({x:N.bodyInfo.rect.width,y:N.bodyInfo.rect.height}),this.handleClickImage("body",M.image,c,g,i,I,N.bodyInfo,O)}}},handleDownInfo:function(R,t){if(this.downInfo){var Y=this.downInfo,c=this.gv,y=Y.interactiveInfo||Y.ui.interactiveInfo;if(y){var j,z=Y.data;if(z.s(R)&&z.s(R)(t,z,c),this.fire("data",R,t,z),this._is2d){var a=c.lp(t);if("body"===Y.part&&y.bodyInfo)j="body",this.handleDownInfoImage(j,c.getImage(z),R,t,z,a,y.bodyInfo);else if("icons"===Y.part&&y._38o){var T=y._38o[Y.name];T&&T[Y.index]&&(j="icons|"+Y.name+"|"+Y.index,this.handleDownInfoImage(j,Y.icon,R,t,z,a,T[Y.index]))}}else{if(!y.bodyInfo)return;var E=c.intersectObject(t,z);if(!E)return;a=E.uv.multiply({x:y.bodyInfo.rect.width,y:y.bodyInfo.rect.height}),this.handleDownInfoImage("body",Y.image,R,t,z,a,y.bodyInfo)}}}},fire:function(E,b,Z,C,t,w,h,_){this.gv.fi({kind:b,type:E,event:Z,data:C,image:t,comp:w,view:this.gv,point:h,width:_?_.width:s,height:_?_.height:s})},handleImage:function(k,p,v,n,G,L,h){var b={};if(p&&(p=Ij(p))){var D=this.gv,U=h.rect,V=this.convertPoint(L,h);V.inRect&&(p[v]&&p[v](n,G,D,V,U.width,U.height),this.fire("image",v,n,G,p,s,V,U),b[k+"|image"]={target:p,type:"image",image:p,data:G,event:n,point:V,width:U.width,height:U.height});for(var X=h.compInfos,Y=p,m=X.length-1;m>=0;m--){var _=X[m],M=_.comp;if(V=this.convertPoint(L,_,Y,M,D,G),V.inRect){U=_.rect;var g=G._interactPrefix=_.prefix,y=g&&G.a(g+v)||M[v];y&&y.call(M,n,G,D,V,U.width,U.height),this.fire("comp",v,n,G,p,M,V,U),(p=U.image)&&(p[v]&&p[v](n,G,D,V,U.width,U.height),this.fire("image",v,n,G,p,s,V,U)),G._interactPrefix=null,b[k+"|"+m]={target:M,type:"comp",comp:M,image:p,data:G,event:n,point:V,width:U.width,height:U.height,prefix:g},p&&(b[k+"|"+m+"|image"]={target:p,type:"image",image:p,data:G,event:n,point:V,width:U.width,height:U.height,prefix:g})}}}return b},handleLeave:function(r,X){return this._handleLeaveOrMissing("leave",r,X)},handleMissingUp:function(w){return this._handleLeaveOrMissing("missing",w)},handleLeaveImage:function(p,G,S,q,v,X,D){if(S&&(S=Ij(S))){var j=this.gv,u=D.rect,c=this.convertPoint(X,D);p===G+"|image"&&(S.onLeave&&S.onLeave(q,v,j,c,u.width,u.height),this.fire("image","onLeave",q,v,S,s,c,u));for(var m=D.compInfos,J=S,T=m.length-1;T>=0;T--){var z=m[T],L=z.comp;c=this.convertPoint(X,z,J,L,j,v),u=z.rect;var U=v._interactPrefix=z.prefix;if(p===G+"|"+T){var O=U&&v.a(U+"onLeave")||L.onLeave;O&&O.call(L,q,v,j,c,u.width,u.height),this.fire("comp","onLeave",q,v,S,L,c,u)}(S=u.image)&&p===G+"|"+T+"|image"&&(S.onLeave&&S.onLeave(q,v,j,c,u.width,u.height),this.fire("image","onLeave",q,v,S,s,c,u)),v._interactPrefix=null}}},handleMissingUpImage:function(v,M,m,E,Y,r){var u="onUp",W=this.downInfo.hits;if(W&&M&&(M=Ij(M))){var z=this.gv,g=r.rect,p=this.convertPoint(Y,r);!p.inRect&&W[v+"|image"]&&(M[u]&&M[u](m,E,z,p,g.width,g.height),this.fire("image",u,m,E,M,s,p,g));for(var G=r.compInfos,I=M,w=G.length-1;w>=0;w--){var y=G[w],Q=y.comp;if(p=this.convertPoint(Y,y,I,Q,z,E),!p.inRect){g=y.rect;var U=E._interactPrefix=y.prefix;if(W[v+"|"+w]){var O=U&&E.a(U+u)||Q[u];O&&O.call(Q,m,E,z,p,g.width,g.height),this.fire("comp",u,m,E,M,Q,p,g)}(M=g.image)&&W[v+"|"+w+"|image"]&&(M[u]&&M[u](m,E,z,p,g.width,g.height),this.fire("image",u,m,E,M,s,p,g)),E._interactPrefix=null}}}},handleDownInfoImage:function(r,f,c,T,P,$,x){var X=this.downInfo.hits;if(X&&f&&(f=Ij(f))){var S=this.gv,F=x.rect,V=this.convertPoint($,x);X[r+"|image"]&&(f[c]&&f[c](T,P,S,V,F.width,F.height),this.fire("image",c,T,P,f,s,V,F));for(var n=x.compInfos,t=f,K=n.length-1;K>=0;K--){var w=n[K],B=w.comp;V=this.convertPoint($,w,t,B,S,P),F=w.rect;var H=P._interactPrefix=w.prefix;if(X[r+"|"+K]){var y=H&&P.a(H+c)||B[c];y&&y.call(B,T,P,S,V,F.width,F.height),this.fire("comp",c,T,P,f,B,V,F)}(f=F.image)&&X[r+"|"+K+"|image"]&&(f[c]&&f[c](T,P,S,V,F.width,F.height),this.fire("image",c,T,P,f,s,V,F)),P._interactPrefix=null}}},handleClickImage:function(u,H,R,U,w,F,K,W){var m=this.downInfo.hits,Q=W.hits;if(m&&H&&(H=Ij(H))){var D=this.gv,o=K.rect,y=this.convertPoint(F,K);m[u+"|image"]&&(H[R]&&H[R](U,w,D,y,o.width,o.height),this.fire("image",R,U,w,H,s,y,o));for(var O=K.compInfos,d=H,_=O.length-1;_>=0;_--){var t=O[_],c=t.comp;y=this.convertPoint(F,t,d,c,D,w),o=t.rect;var z=w._interactPrefix=t.prefix;if(m[u+"|"+_]&&Q[u+"|"+_]){var E=z&&w.a(z+R)||c[R];E&&E.call(c,U,w,D,y,o.width,o.height),this.fire("comp",R,U,w,H,c,y,o)}(H=o.image)&&m[u+"|"+_+"|image"]&&(H[R]&&H[R](U,w,D,y,o.width,o.height),this.fire("image",R,U,w,H,s,y,o)),w._interactPrefix=null}}},initImageResource:function(){z.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function(I,G,O,_,E,T){var Z=G.rect,C=G.matrix.applyInverse(I).sub(Z),a=C.x>=0&&C.y>=0&&C.x<=Z.width&&C.y<=Z.height;if(!a)return C;if(_&&gf(_.pixelPerfect,T,E)){var Z,m=1;this._is2d?(m=E.getZoom(),Z=Ke(I.x,I.y,s,m)):Z=Ke(I.x,I.y);var U=!1,M=Z.x,u=Z.y,k=Z.width,y=Z.height,g=z.hitMaxArea,n=k*y*m*m;if(n>g){var Q=Math.sqrt(g/n);m*=Q}k*=m,y*=m,2>k&&(k=2),2>y&&(y=2),M*=m,u*=m;var A=xl(k,y),v=new Ze(0,-M,-u,m,m);v.append(G.matrix),E._drawForChecking=!0,_.transform=v;var q=O.comps;O.comps=[_],ui(A,O,0,0,k,y,T,self),O.comps=q,delete _.transform,E._drawForChecking=!1;try{for(var L=0,c=A.getImageData(0,0,k,y).data;L<c.length;L+=4)if(0!==c[L+3]){U=!0;break}A.restore()}catch($){pl=i,U=!1}C.inRect=U}else C.inRect=!0;return C}});var yh=gk.DefaultInteractor=function(t){Kh(yh,this,[t])};xe("DefaultInteractor",vi,{handle_mousedown:function(Z){nl(Z);var M=this,S=M.gv,V=S.getDataAt(Z);if(S.setFocus(Z)&&!S._editing&&!S._scrolling){Ae(Z)?S.handleDoubleClick(Z,V):S.handleClick(Z,V);var k=wl(Z);!Sd()&&!k&&V&&(S.isMovable(V)||S._39Q(V))||!S.isPannable()||!pn(Z)&&!k||Th(Z)||(M._tx=S.tx(),M._ty=S.ty(),M.startDragging(Z))}},handleWindowMouseUp:function(k){var Y=this,P=Y.gv;P._panning&&(delete P._panning,P.onPanEnded(),Y.fi({kind:"endPan",event:k})),delete Y._tx,delete Y._ty,Y.clearDragging()},handle_mousemove:function(y){var u=this,v=u.gv;u._hoverTimer&&(Y(u._hoverTimer),delete u._hoverTimer),u._hoverTimer=e(function(){u.fi({kind:"hover",event:y}),Y(u._hoverTimer),delete u._hoverTimer},v.getHoverDelay()||z.hoverDelay)},handle_touchmove:function(G){this.handle_mousemove(G)},handleWindowMouseMove:function(e){var c=this,b=c.gv;c.fi({kind:b._panning?"betweenPan":"beginPan",event:e}),b._panning=1;var G=jc(b,e,c._lastClientPoint);b.setTranslate(c._tx+G.x,c._ty+G.y)},handle_mousewheel:function(s){this.gv.handleScroll(s,s.wheelDelta)},handle_DOMMouseScroll:function(X){2===X.axis&&this.gv.handleScroll(X,-X.detail)},handle_keydown:function(w){this.gv.handleKeyDown(w)}});var Hd=gk.SelectInteractor=function(W){Kh(Hd,this,[W])};xe("SelectInteractor",vi,{_42:function(){var u=this,Y=u.gv,w=Y.getZoom(),k=u.mark,x=u.div;x||(x=u.div=em(),pi(u.getView(),x));var C={};C.x=k.x*w+Y.tx(),C.y=k.y*w+Y.ty(),C.width=k.width*w,C.height=k.height*w,Kn(x,C),this.intersects()?(x.style.border="",x.style.background=Y.getRectSelectBackground()):(x.style.background="",x.style.border="1px solid "+Y.getRectSelectBorderColor())},handle_mousedown:function(S){var z=this,B=z.gv;if(z._57I=i,z.pendingClickThrough=i,!(B._editing||B._scrolling||Sd()||wl(S))){var Y=B.getDataAt(S),o=B.sm();Y?Th(S)?o.co(Y)?o.rs(Y):o.as(Y):o.co(Y)?Y instanceof Mb&&Y.isClickThroughEnabled()&&pn(S)&&(z.pendingClickThrough=Mi(S)):o.ss(Y):Th(S)||!B.isPannable()?pn(S)&&(Th(S)||o.cs(),B.isRectSelectable()&&(z.startDragging(S),B._77O=1)):pn(S)&&(z._57I=Mi(S))}},handle_mouseup:function(y){var B=this,m=B.gv,v=B._57I;if(v&&(_m(v,Mi(y))<=1&&m.sm().cs(),B._57I=i),B.pendingClickThrough){if(_m(B.pendingClickThrough,Mi(y))<=1){var J=m.getDataAt(y);if(J instanceof Mb&&J.isClickThroughEnabled()){var p=m.getDataAt(y,function(t){var k=t.getParent()===J&&m.isSelectable(t,!0);return k});p&&(y.clickThrough=!0,m.sm().ss(p))}}B.pendingClickThrough=i}},handleWindowMouseUp:function(y){this.clear(y)},handleWindowMouseMove:function(A){var Y=this,n=Y.gv;Y._logicalPoint=n.lp(A),Y.mark?(Y.fi({kind:"betweenRectSelect",event:A}),n.isPannable()&&Y.autoScroll(A),Y.redraw()):Y.fi({kind:"beginRectSelect",event:A}),Y.mark=xn(Y._lastLogicalPoint,Y._logicalPoint),Y.redraw()},intersects:function(){var Z=this,x=Z._lastLogicalPoint,i=Z._logicalPoint;return x.x>i.x||x.y>i.y},clear:function(h){var H=this,n=H.gv,Y=H.mark;if(H._57I=i,H.pendingClickThrough=i,H._lastLogicalPoint){if(Y){if(0!==Y.width&&0!==Y.height){var $=n.getDatasInRect(Y,H.intersects());if(!$.isEmpty()){var u=n.sm(),M=u.toSelection();$.each(function(k){u.co(k)?M.remove(k):M.add(k)}),u.ss(M)}}As(H.div),delete H.div,delete H.mark,H.redraw(),H.fi({kind:"endRectSelect",event:h}),n.onRectSelectEnded()}H.clearDragging(),delete n._77O}},redraw:function(){var Q=this;Q._draw||(Q._draw=1,e(function(){Q.mark&&Q._42(),delete Q._draw},16))}});var Ue=gk.MoveInteractor=function(P){Kh(Ue,this,[P])};xe("MoveInteractor",vi,{handle_mousedown:function(q){var W=this,U=W.gv;if(pn(q)&&!U._editing&&!U._scrolling&&!Sd()){var R=U.getSelectedDataAt(q);!R||U._39Q(R)&&!U.isMovable(R)?U._focusData=i:(W._data=R,U.handleMouseDown&&U.handleMouseDown(q,R),W.startDragging(q),U.isMovable(R)&&(U._moving=1))}},handleWindowMouseUp:function(i){var J=this,K=J.gv;K.handleMouseUp&&K.handleMouseUp(i,J._data),J.clear(i)},handleWindowMouseMove:function(p){var J=this,S=J._data,H=J.gv;if((!H._93O||!H._93O(p,S))&&H._moving){J._logicalPoint||J.fi({kind:"prepareMove",event:p});var A=J._logicalPoint?"betweenMove":"beginMove",R={kind:A,event:p},M=J._logicalPoint=H.lp(p);"beginMove"!==A||J._alreadyBeginTransaction||(J._alreadyBeginTransaction=!0,H.getDataModel().beginTransaction());var B=J._calcShift(A,p),a=B.x,o=B.y,F=J.gv.getMoveMode(p,S);F&&("x"===F?o=0:"y"===F?a=0:"xy"!==F&&(a=o=0)),H.moveSelection(a,o),J._lastLogicalPoint=M,J.autoScroll(p),J.fi(R)}},_calcShift:function(){var P=this,q=P._logicalPoint,B=P._lastLogicalPoint,D=q.x-B.x,Y=q.y-B.y;return{x:D,y:Y}},clear:function(p){var h=this,B=h.gv;h._lastLogicalPoint&&(h._lastLogicalPoint=h._data=B._moving=i,h._logicalPoint&&(h.fi({kind:"endMove",event:p}),B.onMoveEnded()),h.clearDragging()),h._alreadyBeginTransaction&&(h._alreadyBeginTransaction=!1,B.getDataModel().endTransaction())}});var ah=gk.TextEditInteractor=function(s){Kh(ah,this,[s]),this.init()};xe("TextEditInteractor",vi,{init:function(){var t=this,g=this.input=B.createElement("input"),k=g.style;g.text="text",k.border="1px solid #d8d8d8",k.position="absolute",k.padding="2px 3px",k.outline="none",k.marginLeft="-90px",k.marginTop="-16px",k.backgroundColor="rgba(255,255,255, 0.9)",k.fontSize="14px",k.width="180px",k.height="32px",k.boxShadow="0 0 13px rgba(16,142,233, 0.5)",k.textAlign="center",k.boxSizing="border-box",Z(g,"keyup",function(g){Hf(g)&&t.endTextEdit()}),Z(g,"focus",function(){g.select()});var y=this.textarea=B.createElement("textarea"),e=this.wrap=B.createElement("div");e.appendChild(y),k=y.style,k.margin=0,k.padding="4px",k.overflow="hidden",k.boxSizing="border-box",k.position="absolute",k.outline="none",k.backgroundColor="transparent",k.resize="none",k.textAlign="center",k.fontSize="14px",k.border="none",k.borderWidth=0,k.width="100%",k.top="50%",k=e.style,k.boxSizing="border-box",k.margin=0,k.padding=0,k.position="absolute",k.boxShadow="0 0 13px rgba(16,142,233, 0.5)",k.border="1px solid #d8d8d8",k.backgroundColor="rgba(255,255,255, 0.9)",k.width="180px",k.marginLeft="-90px",Z(y,"keydown",function(e){return(Kq()||Th())&&Hf(e)?(t.endTextEdit(),void 0):(t.calculateTextareaHeight(String.fromCharCode(e.keyCode)),void 0)}),Z(y,"focus",function(){y.select()});var V=function(w){w.stopPropagation()};Z(g,"mousedown",V),Z(g,"touchstart",V),Z(y,"mousedown",V),Z(y,"touchstart",V),t.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],t.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",t.handleWindowClick=function(U){var z=t._editingDOM;if(z){var k=z.getBoundingClientRect(),b=Mi(U);oh(k,b)||t.endTextEdit()}}},handle_mousedown:function(C){var G=this,N=G.gv;if(Ae(C)&&!N._editing){var B=N.getDataAt(C);if(B){var j=N.getTextEditInfo(B);j&&(this._editInfo=j,this._editTarget=B,N._editing=!0,j.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var h=this,i=h.gv,R=h._editTarget,V=h.getTargetValue(),Y=h.textarea,l=h.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===V||V===s)&&(V=""),Y.value=V,h._editingDOM=Y,i.getView().appendChild(l),this.layoutHTML(l,R),this.calculateTextareaHeight(),e(function(){Y.focus(),Z(F,"mousedown",h.handleWindowClick),Z(F,"touchstart",h.handleWindowClick)},10)},handleTextEdit:function(){var u=this,T=u.gv,z=u._editTarget,B=u.getTargetValue(),l=u.input;(null===B||B===s)&&(B=""),l.value=B,u._editingDOM=l,T.getView().appendChild(l),this.layoutHTML(l,z),e(function(){l.focus(),Z(F,"mousedown",u.handleWindowClick),Z(F,"touchstart",u.handleWindowClick)},10)},layoutHTML:function(k,g){var W=this.gv,f=W.getZoom();if(g instanceof r.Node){var p=g.getRect();k.style.left=(p.x+p.width/2)*f+W.tx()+"px",k.style.top=(p.y+p.height/2)*f+W.ty()+"px"}else if(g instanceof r.Edge){var v=W.getDataUI(g),p=v._6I;k.style.left=(p.x+p.width/2)*f+W.tx()+"px",k.style.top=(p.y+p.height/2)*f+W.ty()+"px"}},endTextEdit:function(){var z=this,W=z._editInfo.isMultiline?z.wrap:z.input,c=z._editInfo.isMultiline?z.textarea:z.input;z.setTargetValue(c.value),z.gv.getView().removeChild(W),z.gv._editing=!1,delete z._editingDOM,m(F,"mousedown",z.handlelick),m(F,"touchstart",z.handleWindowClick)},setTargetValue:function(p){var Y=this,T=Y._editTarget,O=Y._editInfo,o=O.accessType,F=O.name;if(F&&o||(o="p",F="name"),"p"===o){var d=r.Default.setter(F);T[d](p)}else"a"===o?T.a(F,p):T.s(F,p)},getTargetValue:function(){var V=this,_=V._editTarget,w=V._editInfo,K=w.accessType,c=w.name;if(c&&K||(K="p",c="name"),"p"===K){var I=r.Default.getter(c);return _[I]()}return"a"===K?_.a(c):_.s(c)},createHiddenTextarea:function(){this.hiddenTextarea=B.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(X,c){if(c&&this.computedStyleCache)return this.computedStyleCache;var J=this,T=F.getComputedStyle(X),G=T.getPropertyValue("box-sizing")||T.getPropertyValue("-moz-box-sizing")||T.getPropertyValue("-webkit-box-sizing"),M=parseFloat(T.getPropertyValue("padding-bottom"))+parseFloat(T.getPropertyValue("padding-top")),C=parseFloat(T.getPropertyValue("border-bottom-width"))+parseFloat(T.getPropertyValue("border-top-width")),B=J.SIZING_STYLE.map(function(K){return K+":"+T.getPropertyValue(K)}).join(";"),Z={sizingStyle:B,paddingSize:M,borderSize:C,boxSizing:G};return c&&(this.computedStyleCache=Z),Z},calculateTextareaHeight:function(M){M=M||"";var r=this,o=r.textarea,D=r.hiddenTextarea,f=r.wrap,n=32,F=r.calculateHTMLStyle(o,!1),d=F.paddingSize,w=F.borderSize,z=F.boxSizing,G=F.sizingStyle;D.setAttribute("style",G+";"+r.HIDDEN_TEXTAREA_STYLE),D.value=o.value+M;var u=D.scrollHeight;"border-box"===z?u+=w:"content-box"===z&&(u-=d),o.style.height=u+"px",o.style.marginTop=0-.5*u+"px",f.style.height=Math.max(u,n)+"px",f.style.marginTop=u*-.5+"px"}});var ti=gk.ScrollBarInteractor=function(W){Kh(ti,this,[W])};xe("ScrollBarInteractor",vi,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(u){var U=this.gv.getViewRect();return this._41o()&&(U.x+U.width-this.gv.lp(u).x)*this.gv.getZoom()<Fd},isH:function(q){var b=this.gv.getViewRect();return this._40o()&&(b.y+b.height-this.gv.lp(q).y)*this.gv.getZoom()<Fd},handle_mousemove:function(S){this.handle_touchmove(S)},handle_touchmove:function(V){if(!ij&&pn(V)&&this.gv.isScrollBarVisible()){var $=this,o=$.isV(V),f=$.isH(V);(o||f)&&$.gv.showScrollBar(),$.gv._scrolling=o||f}},handleWindowMouseUp:function(Z){this.handleWindowTouchEnd(Z)},handleWindowTouchEnd:function(N){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=i,this.fi({kind:"endScroll",event:N})},handle_mousedown:function(r){this.handle_touchstart(r)},handle_touchstart:function(U){var c=this;if(c.gv.setFocus(U),nl(U),c.handle_touchmove(U),!(lr(U)>1)&&c.gv._scrolling&&c.gv.isScrollBarVisible()){c._cp=Mi(U),c._tx=c.gv.tx(),c._ty=c.gv.ty();var F=c.isV(U);c._state=F?"vScroll":"hScroll",Vn(c,U),c.fi({kind:"beginScroll",event:U})}},handleWindowMouseMove:function(h){this.handleWindowTouchMove(h)},handleWindowTouchMove:function(z){var Q=Mi(z),Z=this.gv.getViewRect(),M=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-Q.y)*M.height/Z.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-Q.x)*M.width/Z.width),this.fi({kind:"betweenScroll",event:z})}});var jk=gk.TouchInteractor=function(r,N){N=N||{},N.selectable===s&&(N.selectable=!0),N.movable===s&&(N.movable=!0),N.pannable===s&&(N.pannable=!0),N.pinchable===s&&(N.pinchable=!0),N.editable===s&&(N.editable=!0),this.params=N,Kh(jk,this,[r])};xe("TouchInteractor",vi,{ms_edit:1,setUp:function(){var f=this;jk.superClass.setUp.call(f),Aj&&f.params.editable&&f.gv.setEditInteractor(f)},tearDown:function(){var u=this;jk.superClass.tearDown.call(u),Aj&&u.params.editable&&u.gv.setEditInteractor(i)},clear:function(t){var M=this,D=M.gv;D._moving&&(M.fi({kind:"endMove",event:t}),delete D._moving,D.onMoveEnded(),D.dm().endTransaction()),D._panning&&(M.fi({kind:"endPan",event:t}),delete D._panning,D.onPanEnded()),D._pinching&&(M.fi({kind:"endPinch",event:t}),delete D._pinching,D.onPinchEnded()),D._editing&&(M._46O(t),M._77I=M._node=M._edge=M._shape=M._rect=M._89I=M._index=D._editing=i),M._moving=M._panning=M._pinching=M._editing=M._57I=M._data=M._beginHistory=i,M.clearDragging()
},handle_touchstart:function(c){var d=this;if(!d.gv._editing){nl(c),d._57I=i;var l=d.params,n=d.gv,B=n.sm(),E=n.getDataAt(c),Y=lr(c);if(1===Y){if(Ae(c))return n.handleDoubleClick(c,E),void 0;n.handleClick(c,E),E&&(n.handleMouseDown&&n.handleMouseDown(c,E),d._data=E),l.selectable||(E=i),E&&(B.co(E)||B.ss(E),l.editable&&n.isEditable(E)&&d._79I(c,E,!0)?(d._editing=1,d.startDragging(c)):l.movable&&n.isMovable(E)&&(d._moving=1,d.startDragging(c))),E&&n.isMovable(E)||(d._57I=Mi(c),l.pannable&&n.isPannable()&&(d._panning=1,d.startDragging(c),d._translate={x:n.tx(),y:n.ty()}))}else if(l.pinchable&&2===Y){if(E&&n._39Q(E))return;d._pinching=1,d.startDragging(c);var m=n.getView(),o=n.getZoom(),G=m.getBoundingClientRect(),x=c.touches[0],j=c.touches[1],Z={x:(x.clientX+j.clientX)/2-G.left,y:(x.clientY+j.clientY)/2-G.top};Z.x-=n.tx(),Z.y-=n.ty(),Z.x/=o,Z.y/=o,d._p=Z,d._d=iq(c)}}},handle_touchend:function(c){var Z=this,P=Z.gv,y=Z._57I,v=Z._data;y&&(_m(y,Mi(c))<=1&&!P.getDataAt(c)&&P.sm().cs(),Z._57I=i),v&&P.handleMouseUp&&P.handleMouseUp(c,v)},handleWindowTouchEnd:function(J){this.clear(J)},handleWindowTouchMove:function(d){var a=this,k=a.gv,o=lr(d);if(1===o){if(a._editing&&(a._beginHistory||(a._beginHistory=1,k.dm().beginTransaction()),k._editing=1,a._78I(d)),a._moving)a._beginHistory||(a._beginHistory=1,k.dm().beginTransaction()),a.handleMove(d);else if(a._panning){var t=Mi(d),u=jc(k,t,a._lastClientPoint);k.setTranslate(a._translate.x+u.x,a._translate.y+u.y),a.fi({kind:k._panning?"betweenPan":"beginPan",event:d}),k._panning=1}}else if(2===o&&a._pinching){var p=iq(d);k.handlePinch(a._p,p,a._d),a._d=p,a.fi({kind:k._pinching?"betweenPinch":"beginPinch",event:d}),k._pinching=1}},handleMove:function(A){var h=this,l=h.gv,$=l.lp(A);l._93O&&l._93O(A,h._data)||(l.moveSelection($.x-h._lastLogicalPoint.x,$.y-h._lastLogicalPoint.y),h._lastLogicalPoint=$,h.autoScroll(A),h.fi({kind:l._moving?"betweenMove":"beginMove",event:A}),l._moving=1)}});var r=F.ht,Ac=r.graph._editor={Math:r.Math,Guide:{}};Ac.getStyle=function(G){var Z,k=Ac.StyleMap;return k&&(Z=k[G],Z!==s)?Z:Ac.DefaultStyleMap[G]},Ac.setStyle=function(X,U){var V=Ac.StyleMap;V||(V=Ac.StyleMap={}),V[X]=U},Ac.inEdit=function(K){return K._inXEdit===!0},Ac.startEdit=function(r){r._inXEdit=!0,Ac.Inject.doInject(r)},Ac._46O=function($){$._inXEdit=!1,Ac.Inject.undoInject($)},Ac.toScreenPosition=function(h,l){var e=h.tx(),W=h.ty(),o=h._zoom;return new Ac.Math.Vector2(l.x*o+e,l.y*o+W)},Ac.checkHit=function(d,G,$){return d.distanceTo(G)<$?!0:!1},Ac.toWorldPosition=function(H,v){var g=H.tx(),e=H.ty(),B=H._zoom;return{x:(v.x-g)/B,y:(v.y-e)/B}},Ac.setAntialias=function(a,h){for(var Q,v=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],w=0,W=v.length;W>w&&(Q=v[w],!(Q in a));w++);a[Q],a[Q]=h},Ac.getTargetCornersOnScreen=function(j,y){if(!y)return null;var X,J=[];if(Pn(y,j)){var D=zk(j,y);X=[{x:D.x,y:D.y},{x:D.x+D.width,y:D.y},{x:D.x+D.width,y:D.y+D.height},{x:D.x,y:D.y+D.height}]}else{if(!y.getCorners)return null;X=y.getCorners()}return X.forEach(function(B){var P=Ac.toScreenPosition(j,B);J.push(P.x,P.y)}),J},Ac.log=function(){};var ll=Ac.Inject={_modules:[]};ll.registAsModule=function(T,i){var E={},h={};for(var H in T){var r=i.prototype[H];E[H]=r}T.getBackup=function(y){return E[y]},T.getBackups=function(){return E},h.doInject=function(){for(var z in T)"getBackup"!==z&&(i.prototype[z]=T[z])},h.undoInject=function(){for(var H in T)"getBackup"!==H&&(i.prototype[H]=E[H])},ll._modules.push(h)},ll.doInject=function(u){for(var B,t=ll._modules,d=0,K=t.length;K>d;d++)B=t[d],B.doInject(u)},ll.undoInject=function(S){for(var Y,T=ll._modules,X=0,g=T.length;g>X;X++)Y=T[X],Y.undoInject(S)};var vi=r.graph.EditInteractor=function(c){var v=this,g=B.createElement("canvas");g.className="editCanvas",g.style.position="absolute",v._styleMap={},v._canvas=g,v._context=g.getContext("2d"),vi.superClass.constructor.call(v,c),this._editDetail=!1,Ac.setAntialias(v._context,!1),v._subModules=[new Ac.Anchor(v),new Ac.RotateX(v),new Ac.MoveDummy(v),new Ac.Rect(v),new Ac.Curve(v),new Ac.MoveHelper(v)],v._gridGuide=new Ac.Guide.Grid(v),v._rectGuide=new Ac.Guide.Rect(v),v._hoverGuide=new Ac.Guide.Hover(v)},nk=vi;r.Default.def(vi,r.graph.Interactor,{ms_edit:1,ms_fire:1}),j.defineProperties(vi.prototype,{editDetail:{get:function(){var m=!!this._editDetail;return m},set:function(w){var Y=this,u=Y._editDetail;u!==w&&(Y._editDetail=w,Y.gv._editing=w,Y.fp("editDetail",u,w),Y.fp("pointsEditingMode",u,w),Y.fi({kind:w?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(Y){(!this._editDetail||Y)&&(this.gv._editing=Y,Y||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(w){this._editing=w,this.gvEditing=w}},pointsEditingMode:{get:function(){return this.editDetail},set:function(n){var L=this;L.editDetail!==n&&(n?L._tryEnterEditDetailMode():L._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var N=this._gridEnabled;if(!N)return!1;var x=this.gv;return x?!0:!0},set:function(v){v!==this._gridEnabled&&(this._gridEnabled=v,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(C){C!==this._agEnabled&&(this._agEnabled=C,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),vi.prototype.getSubModule=function(u){var H,z,W,y=this._subModules;for(z=0,W=y.length;W>z;z++)if(H=y[z],H.catalog===u)return H},vi.prototype.invokeSubModule=function(p,o){var R=this,F=R._subModules;if(F)for(var H,f,X,W=Array.prototype.slice.call(arguments,2),C=0,Q=F.length;Q>C;C++)if(H=F[C],f=H[p],f&&(X=f.apply(H,W),X!=s&&o))return H},vi.prototype.invokeSubModuleInverse=function(G,r){var Q=this,i=Q._subModules;if(i)for(var X,W,y,z=Array.prototype.slice.call(arguments,2),t=i.length-1;t>=0;t--)if(X=i[t],W=X[G],W&&(y=W.apply(X,z),y!=s&&r))return X},vi.prototype.setUp=function(){Ac.log("setUp");var H=this,n=H.gv,w=n.getView(),D=H._canvas;vi.superClass.setUp.call(H),n.setEditInteractor(H),n._79O?w.insertBefore(D,n._79O):w.appendChild(D),Ac.startEdit(n),H.invokeSubModule("setUp"),n.dm().mm(H._onDataModelChanged,H),n.dm().md(H._onDataPropertyChanged,H)},vi.prototype.tearDown=function(){Ac.log("tearDown");var W=this,R=W.gv,C=R.getView();W._resetCustomCursorStyle(),vi.superClass.tearDown.call(W),R.dm().umm(W._onDataModelChanged,W),R.dm().umd(W._onDataPropertyChanged,W),R.setEditInteractor(null),C.removeChild(W._canvas),W._drawTimer&&(Y(W._drawTimer),W._drawTimer=null),Ac._46O(R),W.invokeSubModule("tearDown")},vi.prototype._onDataModelChanged=function(b){var y=this;("clear"===b.kind||"remove"===b.kind&&y.editDetail&&b.data===y.getSubModule("Curve").target)&&(y.editDetail=!1,y._42())},vi.prototype._onDataPropertyChanged=function(y){var W=this;if(W.editDetail){var z=W.getSubModule("Curve"),G=y.data;G===z.target&&(G._writing||z._handleDataChanged(y))}},vi.prototype.clear=function(){Ac.log("clear")},vi.prototype.redraw=function(){this._42()},vi.prototype._42=function(){var T=this;T._drawTimer||(T._drawTimer=e(function(){T._drawTimer=null,T.drawImpl()},0))},vi.prototype.drawImpl=function(){var X;for(X in{_42:!0})break;return function(){var s=this,t=s._canvas,Z=s.gv,Q=Z.getWidth(),I=Z.getHeight(),C=s._context,D=r.Default.getInternal(),B=F.devicePixelRatio;(t.width!==Q||t.height!==I)&&D.setCanvas(t,Q,I,B),C.clearRect(0,0,t.width,t.height);var g=s._getValidSelection();C.save(),C.scale(B,B),s._gridGuide._42(),s.invokeSubModuleInverse(X,!1,C,Z,g),s._rectGuide._42(),s._hoverGuide._42(),C.restore()}}(),vi.prototype._getValidSelection=function(){var D=this,C=D.gv,B=C.sm().getSelection(),S=[];return B.each(function(w){C.isVisible(w)&&C.isEditable(w)&&S.push(w)}),S},vi.prototype.handle_touchmove=function(F){return this.handle_mousemove(F)},vi.prototype.handle_mousemove=function(U){if(!r.Default.isDragging()){var u=this;if((u.editDetail||!Sd()&&!wl(U))&&!u.gv._externalEditing)if(u.gvEditing=!1,u._checkEdit(U))u.gvEditing=!0;else{if(!u.getStyle("hoverGuideVisible"))return;u.hoverData=u.gv.getDataAt(U),u._42()}}},vi.prototype.handle_touchstart=function(m){return this.handle_mousedown(m)},vi.prototype.handle_mousedown=function(m){nl(m);var E=this;if((E.editDetail||!Sd()&&!wl(m))&&!E.gv._externalEditing){if(Ae(m)&&!m.clickThrough){if(E.editDetail){if(E._tryQuitEditDetailMode(m))return}else if(E._tryEnterEditDetailMode())return;E.gv.dm().beginTransaction();var u=E.invokeSubModule("handleDoubleClick",!0,m);if(E.gv.dm().endTransaction(),u)return}var A=E._checkEdit(m);A&&(E._downPosition=E._getLogicalPoint(m),E.gv.dm().beginTransaction(),A.startEdit(E,m),E.editing=!0)}},vi.prototype._checkEdit=function(k){var h=this,P=h.gv,R=h._getLogicalPoint(k),Z=h.invokeSubModule("check",!0,P,k,R)||null;return h._editMod=Z,Z},vi.prototype.handleWindowTouchMove=function(R){return this.handleWindowMouseMove(R)},vi.prototype.handleWindowMouseMove=function(h){var B=this,q=B._downPosition;if(q){var b=B._getLogicalPoint(h);if(b.distanceTo(q)<B.getStyle("moveSensitivity"))return;delete B._downPosition}var i=B._editMod;i&&i.handleEdit(B.gv,h)},vi.prototype._getLogicalPoint=function(q){var o=this,y=r.Default.getLogicalPoint(q,o._canvas);return new Ac.Math.Vector2(y)},vi.prototype.handleWindowTouchEnd=function(q){return this.handleWindowMouseUp(q)},vi.prototype.handleWindowMouseUp=function(){var P;for(P in{_46O:!0})break;return function(Q){var j=this;j.editing=!1,j.setCursor("default"),j.invokeSubModule(P,!1,Q),j._42(),j.gv.dm().endTransaction()}}(),vi.prototype.handle_mousewheel=function(F){var b=this;nl(F),b.invokeSubModule("preHandleScroll",!0)||b.gv.handleScroll(F,F.wheelDelta)},vi.prototype.handleDelete=function(){var c=this;if(!c.editDetail){c.gv.dm().beginTransaction();var S=c.invokeSubModule("handleNormalStateDelete",!0);return c.gv.dm().endTransaction(),S||c.gv.removeSelection(),void 0}c.gv.dm().beginTransaction(),c.invokeSubModule("handleDelete",!0),c.gv.dm().endTransaction(),c._42()},vi.prototype.handle_keydown=function(V){var e=this;if((V.metaKey||V.ctrlKey)&&e._42(),Sd(V)&&!e.editing)return e.gvEditing=!1,e.setCursor("default"),e._42(),void 0;var F=Hf(V);return e.editDetail?((F||Wi(V))&&(e.editDetail=!1,e._42()),e.gv.dm().beginTransaction(),e.invokeSubModule("handle_keydown",!0,V),e.gv.dm().endTransaction(),void 0):(e.gv.dm().beginTransaction(),e.invokeSubModule("handleNormalStateKeyDown",!0,V),e.gv.dm().endTransaction(),F&&e._tryEnterEditDetailMode(),void 0)},vi.prototype.handle_keyup=function(n){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,n),this.gv.dm().endTransaction()},vi.prototype._tryEnterEditDetailMode=function(){var M=this;return!M.editDetail&&M.invokeSubModule("canEnterEditDetailMode",!0)&&1===M._getValidSelection().length?(M.editDetail=!0,M._42(),!0):void 0},vi.prototype._tryQuitEditDetailMode=function(u){var y=this;return y.editDetail?!u||y.invokeSubModule("canQuitEditDetailMode",!0,u)?(y.editDetail=!1,y._42(),!0):!1:!1},vi.prototype.setStyle=function(D,E,i){var T=this;i?Ac.setStyle(D,E):T._styleMap[D]=E,"baseColor"===D&&(Wn=E),T.fp("styleChanged",null,{key:D,value:E,base:i}),T._42()},vi.prototype.getStyle=function(d){var I=this,G=I._styleMap[d];return G!==s?G:Ac.getStyle(d)},vi.prototype.setCursor=function(w){this._resetCustomCursorStyle(),r.graph.EditInteractor.superClass.setCursor.call(this,w)},vi.prototype._resetCustomCursorStyle=function(){var w=this;if(w._customStyle){var F=this.gv.getView();F.classList&&F.classList.remove&&F.classList.remove(w._customStyle),w._customStyle=null}},vi.prototype._setRotateCursor=function(k){var n=this,$=n._cursorFactory;$||($=n._cursorFactory=new Ac.CursorFactory(n));var R=$.getRotateCursor(k),H=n.gv.getView();n._resetCustomCursorStyle(),n._customStyle=R,H.classList&&H.classList.add&&H.classList.add(R)};var Ro=Ac.Group=function(y){var Y=this;Y._entities=y,Y._64O=0,Y._position={x:0,y:0},Y._scale={x:1,y:1},Y._anchor={x:.5,y:.5},Y._anchor2={x:.5,y:.5}};Ro.prototype={},Ro.prototype.constructor=Ro;var _e=null;Ro.findOrCreateGroup=function(t){if(_e&&_e.checkIsMe(t))return _e;var c=new Ac.Group(t);return c.getKeyOb()?(_e=c,c):void 0},Ro.prototype.checkIsMe=function(c){var e=this._entities;if(e.length!==c.length)return!1;var Y,F={},u=c.length;for(Y=0;u>Y;Y++)F[c[Y]._id]=!0;for(Y=0;u>Y;Y++)if(!F[e[Y]._id])return!1;return!0},Ro.prototype.getRotation=function(){return this._64O},Ro.prototype.getPosition=function(){return this._position},Ro.prototype.getAnchor=function(){return this._anchor},Ro.prototype.getWidth=function(){return this._width},Ro.prototype.getScale=function(){return this._scale},Ro.prototype.getSize=function(){return{width:this._width,height:this._height}},Ro.prototype.getHeight=function(){return this._height},Ro.prototype.getKeyOb=function(){for(var _=this._entities,X=_.length-1;X>=0;X--){var j=_[X];if(this.isNode(j))return j}},Ro.prototype.getAnchor2=function(){var W=this,T=W.rotateCenter;if(T)return T;var H=W.getKeyOb();if(!H)return W._anchor;var B=W._anchor2,m=H.getMatrix();return m.tf({x:H.getWidth()*(B.x-H.getAnchor().x),y:H.getHeight()*(B.y-H.getAnchor().y)})},Ro.prototype.setAnchor2=function(O,U){var c=this,e=c.getKeyOb();if(e){var Z,T=e.getMatrix();Z="number"==typeof O?{x:O,y:U}:O;var X=T.tfi(Z);c._anchor2={x:e.getAnchor().x+X.x/e.getWidth(),y:e.getAnchor().y+X.y/e.getHeight()}}},Ro.prototype.setRotation=function(){},Ro.prototype.beginRotate=function(w){this.rotateCenter=w.pos,this.rotateMode=w.groupRotateMode},Ro.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Ro.prototype.addRotation=function(r,e,h){return"batch"===e?this._addRotationInBatchMode(r,h):"block"===e?this._addRotationInBlockMode(r,h):void 0},Ro.prototype._addRotationInBlockMode=function(R,$){var L=this,e=L.rotateCenter||L.getPosition();L._entities.forEach(function(q){if(L.isNode(q)&&(!$||$(q))){var g=q.getMatrix();g.translate(-e.x,-e.y),g.rotate(R),g.translate(e.x,e.y);var G=Math.sign(q.getScale().x);q.setRotation(K(g.b*G,g.a*G)),q.setPosition(g.tx,g.ty)}})},Ro.prototype._addRotationInBatchMode=function(o){var H=this,W=H._anchor2;H._entities.forEach(function(c){if(H.isNode(c)&&(!filter||filter(c))){var _=c.getAnchor(),i=c.getMatrix(),v=i.tf({x:c.getWidth()*(W.x-_.x),y:c.getHeight()*(W.y-_.y)}),Y=new Ac.Math.Matrix2d;Y.set(i.a,i.b,i.c,i.d,i.tx,i.ty),Y.translate(-v.x,-v.y),Y.rotate(o),Y.translate(v.x,v.y);var Z=Math.sign(c.getScale().x);c.setRotation(K(Y.b*Z,Y.a*Z)),c.setPosition(Y.tx,Y.ty)}})},Ro.prototype.setPosition=function(w){var X,_,Y,o,V=this,B=V._position,H=w.x-B.x,C=w.y-B.y,N=V._entities;for(_=0,Y=N.length;Y>_;_++)X=N[_],gj(X)&&(o=X.getPosition(),X.setPosition(o.x+H,o.y+C));V._position=w},Ro.prototype.setScale=function(l,z){var k=this,a=l/k._scale.x,L=z/k._scale.y;k._adjustChildScaleOrSize(a,L,"size"),k._scale={x:l,y:z}},Ro.prototype.getRect=function(){var L=this,C=L._position,K=L._width,l=L._height;return{x:C.x-K/2,y:C.y-l/2,width:K,height:l}},Ro.prototype.setSize=function(p,U){var t=this,p=Math.max(1,p),U=Math.max(1,U),h=p/t._width,u=U/t._height;t._adjustChildScaleOrSize(h,u,"size"),t._width=p,t._height=U},Ro.prototype._adjustChildScaleOrSize=function(S,Y,Z){var m,w,r,A,P,a,s,l,n,e,J,t,V,j,u=this,U=u._position,i=u._entities,G=new Ac.Math.Matrix2d;for(w=0,r=i.length;r>w;w++)if(m=i[w],u.isNode(m)){if(A=m.getPosition(),P=m.getRotation(),a=m.getWidth(),s=m.getHeight(),l=m.getScale(),J=l.x*a,t=l.y*s,G.identity().scale(J,t).rotate(P).translate(A.x,A.y).translate(-U.x,-U.y).rotate(-u._64O),P=K(G.b*Math.sign(J),G.a*Math.sign(J)),G.scale(S,Y),n=Math.cos(P),e=Math.sin(P),Math.abs(n)<.001?(V=G.b/e,j=-G.c/e):(V=G.a/n,j=G.d/n),"scale"===Z)m.setScale(V/a,j/s);else if("size"===Z){var h=V/l.x,f=j/l.y;m.setScale(Am(V)*Math.abs(l.x),Am(j)*Math.abs(l.y)),m.setSize(Math.max(.1,Math.abs(h)),Math.max(.1,Math.abs(f)))}G.rotate(u._64O).translate(U.x,U.y),m.setPosition(G.tx,G.ty)}},Ro.prototype.getMatrix=function(){var s=this,n=s._position,A=r.Default.getInternal(),x=s._scale;return new A.Mat(s._64O,n.x,n.y,x.x,x.y)},Ro.prototype.toGlobal=function(K){return this.getMatrix().tf(K)},Ro.prototype.getCorners=function(){var D=this,y=D._width,g=D._height,B=D._anchor,k=-y*B.x,i=-g*B.y,$=D.getMatrix();return[$.tf(k,i),$.tf(k,i+g),$.tf(k+y,i+g),$.tf(k+y,i)]},Ro.prototype.calcInfo=function(){var D,A,d,u,p,_,E=this,Y=[],j=E._entities,F=E._64O;for(u=0,p=j.length;p>u;u++)_=j[u],E.isNode(_)&&_.getCorners&&Y.push.apply(Y,_.getCorners());if(Y.length){var t=Math.cos(-F),S=Math.sin(-F),K=1/0,C=-1/0,l=1/0,m=-1/0;for(u=0,p=Y.length;p>u;u++)d=Y[u],D=d.x,A=d.y,d.x=t*D-S*A,d.y=S*D+t*A,K=Math.min(K,d.x),C=Math.max(C,d.x),l=Math.min(l,d.y),m=Math.max(m,d.y);E._width=(C-K)/E._scale.x,E._height=(m-l)/E._scale.y,t=Math.cos(F),S=Math.sin(F);var G=E._anchor;D=K+(C-K)*G.x,A=l+(m-l)*G.y,E._position={x:t*D-S*A,y:S*D+t*A}}},Ro.prototype.isNode=function(M){return gj(M)?Pn(M)?!1:!0:!1},Ro.prototype._42=function(O,D,h){var j,i,s,v,I,d,Z,V,f=this,$=f._entities,x=f.rotateMode;for("batch"===x&&(V=f.getKeyOb()),j=0,i=$.length;i>j;j++)s=$[j],f.isNode(s)&&(d=s.getRect(),v=Ac.toScreenPosition(h,{x:d.x,y:d.y}),I=Ac.toScreenPosition(h,{x:d.x+d.width,y:d.y+d.height}),Z={min:v,max:I},s===V&&(Z.isKeyOb=!0),Ac.Icons.DrawIcon(O,D,Ac.Icons.GroupSubEntityRect,Z))};var fe=Ac.CurveActiving=function(f,e){this._curve=f,this._interactor=f._interactor;for(var W in e)this[W]=e[W]};fe.prototype={},fe.prototype.constructor=fe,j.defineProperties(fe.prototype,{point:{get:function(){return this._point},set:function(U){var T=this;T._point=U,T.editingCtrl||T._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(k){var q=this;q._pairs=k,q.editingCtrl&&q._firePointChange()}}}),fe.prototype._firePointChange=function(){var G=this,O=G.getCurrentEditingPoint(),$=G._interactor;if(!O)return $.fi({kind:"selectPoint"}),void 0;var b=this._curve.target;if(b){var z=Ac.getDataMatrix(b).invert(),M=O.e;O=z.apply(Ac.toWorldPosition($.gv,O)),O.e=M;var u=G._lastFirePoint;u&&Math.abs(O.x-u.x)<1e-5&&Math.abs(O.y-u.y)<1e-5&&(O.e==s&&u.e==s||Math.abs(O.e-u.e)<1e-5)||(G._lastFirePoint=O,$.fi({kind:"selectPoint",x:O.x,y:O.y,e:O.e}))}},fe.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},fe.prototype.getCurrentEditingPoint=function(){var P=this,d=P.editingCtrl;if(d){var V=P.pairs;if(V){var t=V[d.pairId],K=t[d.type];if(K)return K}}return P._point};var Id=Ac.CursorFactory=function(z){var v=this;v._interactor=z,v._rotateCursorStyles={}};Id.prototype={},Id.prototype.constructor=Id,Id.prototype.getRotateCursor=function(m){var G=this;0>m&&(m+=2*Math.PI);var b=G._interactor,a=b.getStyle("rotateCursorSize"),t=b.getStyle("rotateCursorRound"),$=Math.round(180*(m/Math.PI)/t);$*t>=360&&($=0);var J=G._rotateCursorStyles,L="htCustomRotateStyle_"+a+"_"+t+"_"+$;return J[L]||(G._produceRotateCursor(L,a,t,$),J[L]=!0),L},Id.prototype._produceRotateCursor=function(H,g,Q,c){var N=this;N._interactor;var M=N._canvas;M||(M=N._canvas=B.createElement("canvas")),M.width=M.height=g*devicePixelRatio,M.style.width=M.style.height=g+" px";var q=M.getContext("2d");Ac.setAntialias(q,!1),q.scale(devicePixelRatio,devicePixelRatio);var R,E,z,S,G,b=Math.round(g/2),v=""+b+" "+b+",auto !important;",x=4;R=Math.PI/180*c*Q,q.clearRect(0,0,g,g),q.save(),q.scale(g/32,g/32),q.translate(16,15),q.rotate(R+Math.PI/2),q.beginPath(),q.moveTo(-8,0),q.lineTo(-8,x),q.lineTo(-8+x,x),q.moveTo(8,0),q.lineTo(8,x),q.lineTo(8-x,x),q.moveTo(-8,x),q.quadraticCurveTo(0,-6,8,x),q.restore(),q.lineCap="round",q.lineJoin="miter",q.strokeStyle="white",q.lineWidth=4,q.stroke(),q.strokeStyle="black",q.lineWidth=2,q.stroke(),E=JSON.stringify(M.toDataURL()),S="cursor:url("+E+")"+v,1!==devicePixelRatio&&(z='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+g+'px" height="'+g+'px"><image xlink:href='+E+' width="'+g+'" height="'+g+'"/></svg>',S+="cursor:url(data:image/svg+xml;base64,"+btoa(z)+")"+v,S+="cursor:-webkit-image-set(url("+E+")"+devicePixelRatio+"x,url("+E+")1x)"+v),G=B.createElement("style"),G.textContent="body."+H+" *, ."+H+"{"+S+"}",B.head.appendChild(G)};var Ym=Ac.Guide.Grid=function(k){var S=this;S._interactor=k,S._alignmentGuideId=0,S._xAlignmentGuide=[],S._yAlignmentGuide=[]};Ym.prototype={},Ym.prototype.constructor=Ym,j.defineProperties(Ym.prototype,{gridBlockSize:{get:function(){var u=this;return u._gridBlockSize||u._interactor.getStyle("gridBlockSize")},set:function(b){this._gridBlockSize=b,this._interactor._42()}},gridThickLinesEvery:{get:function(){var n=this;return n._gridThickLinesEvery||n._interactor.getStyle("gridThickLinesEvery")},set:function(u){this._gridThickLinesEvery=u,this._interactor._42()}},gridEnabled:{get:function(){var l=this,s=l._interactor;return s.gridEnabled&&l.isValidGrid()}}}),Ym.prototype._42=function(){var Z=this,P=Z._interactor;Z.gridEnabled&&Z.drawGrid(),P.alignmentGuideEnabled&&Z.drawAlignmentGuide()},Ym.prototype.makeMatrix=function(){var M=this,y=M._interactor.getStyle("gridAngle"),t=M._interactor.getStyle("gridRotation"),j=new Ac.Math.Matrix2d,U=Math.sin(y),W=Math.cos(y);return j.set(1,0,W,U,0,0),j.rotate(t),j},Ym.prototype.isValidGrid=function(){var V=this,N=Math.PI,Y=V._interactor,q=Y.gv;if(q._zoom<Y.getStyle("gridZoomThreshold"))return!1;var M=Y.getStyle("gridAngle"),S=Math.abs(180*(M%N/N)),x=1-1e-8;return x>S||S>180-x?!1:!0},Ym.prototype.drawAlignmentGuide=function(){var U=this,X=U._interactor,T=X.gv,q=X._canvas,f=X._context,G=q.width,Z=q.height,Q=T.tx(),k=T.ty(),R=T._zoom;f.beginPath(),f.strokeStyle=X.getStyle("gridAlignmentGuideColor"),f.lineWidth=1,U._xAlignmentGuide.forEach(function(I){var B=I.p*R+Q;f.moveTo(B,0),f.lineTo(B,Z)}),U._yAlignmentGuide.forEach(function(p){var c=p.p*R+k;f.moveTo(0,c),f.lineTo(G,c)}),f.stroke()},Ym.prototype.drawGrid=function(){function R(w,K,i,I){var R=Ac.toScreenPosition(t,n.apply({x:w,y:K})),y=Ac.toScreenPosition(t,n.apply({x:i,y:I}));T.moveTo(R.x,R.y),T.lineTo(y.x,y.y)}var U=this,m=U._interactor,k=U.gridBlockSize,E=U.gridThickLinesEvery,G=m.getStyle("gridThickColor"),v=m.getStyle("gridLightColor"),t=m.gv,g=m._canvas,T=m._context,X=g.width,x=g.height,n=U.makeMatrix(),u=n.applyInverse(Ac.toWorldPosition(t,{x:0,y:0})),J=n.applyInverse(Ac.toWorldPosition(t,{x:X,y:0})),f=n.applyInverse(Ac.toWorldPosition(t,{x:0,y:x})),P=n.applyInverse(Ac.toWorldPosition(t,{x:X,y:x})),S=Math.min(u.x,J.x,f.x,P.x),Q=Math.max(u.x,J.x,f.x,P.x),W=Math.min(u.y,J.y,f.y,P.y),q=Math.max(u.y,J.y,f.y,P.y);X=Q-S,x=q-W;var I=Math.ceil(S/k),K=Math.floor(Q/k),M=Math.ceil(W/k),a=Math.floor(q/k);t.tx(),t.ty(),t._zoom;var Y,i,$;for(T.save(),T.lineWidth=1,T.beginPath(),T.strokeStyle=G,$=Math.ceil(I/E)*E;K>=$;$+=E)Y=$*k,R(Y,W,Y,q);for($=Math.ceil(M/E)*E;a>=$;$+=E)i=$*k,R(S,i,Q,i);for(T.stroke(),T.beginPath(),T.strokeStyle=v,$=I;K>=$;$++)0!==$%E&&(Y=$*k,R(Y,W,Y,q));for($=M;a>=$;$++)0!==$%E&&(i=$*k,R(S,i,Q,i));T.stroke(),T.restore()},Ym.prototype.getAlignmentGuides=function(){var o=this;return{x:o._xAlignmentGuide,y:o._yAlignmentGuide}},Ym.prototype.addAlignmentGuide=function(M,R,L){var g=this,b="x"===M?g._xAlignmentGuide:g._yAlignmentGuide,L=L?L:++g._alignmentGuideId,r={p:R,id:L};if(b.length){var O=g._findClosestAlignmentGuide(r.p,b);O.dis<0?b.splice(O.index+1,0,r):b.splice(O.index,0,r)}else b.push(r);return g._interactor._42(),L},Ym.prototype.findClosest=function(C,r,M){var K=this,W=K._interactor,e=W.gv;M&&(C=Ac.toWorldPosition(e,C));var T,h,R,I=1/0,o=1/0,x=C.x,F=C.y;if(K.gridEnabled){var H=K.gridBlockSize,D=K.makeMatrix(),p=D.applyInverse(C);p=D.apply({x:Math.round(p.x/H)*H,y:Math.round(p.y/H)*H}),I=p.x-x,o=p.y-F,R=!0}if(W.alignmentGuideEnabled&&(T=K._findClosestAlignmentGuide(x,K._xAlignmentGuide).dis,h=K._findClosestAlignmentGuide(F,K._yAlignmentGuide).dis,Math.abs(T)<Math.abs(I)&&(I=T,R=!0),Math.abs(h)<Math.abs(o)&&(o=h,R=!0)),R){R=!1;var Q=e._zoom,O=W.getStyle("smartGuideThreshold")/Q,l={};if(Math.abs(I)<O&&"y"!==r&&(l.x=M?I*Q:I,R=!0),Math.abs(o)<O&&"x"!==r&&(l.y=M?o*Q:o,R=!0),R)return l}},Ym.prototype._findClosestAlignmentGuide=function(G,M){if(!M.length)return{dis:1/0};for(var e,J=0,Z=M.length-1;Z-J>1;)e=Math.floor((J+Z)/2),M[e].p<G?J=e:Z=e;var r=M[J].p-G,t=M[Z].p-G;return Math.abs(r)<=Math.abs(t)?{line:M[J],dis:r,index:J}:{line:M[Z],dis:t,index:Z}},Ym.prototype.removeAllAlignmentGuide=function(U){var X=this;"y"!==U&&(X._xAlignmentGuide=[]),"x"!==U&&(X._yAlignmentGuide=[]),X._interactor._42()},Ym.prototype.removeAlignmentGuide=function(m){for(var U,l,F,h=this,Y=h._xAlignmentGuide,x=0;2>x;x++)for(Y=0===x?h._xAlignmentGuide:h._yAlignmentGuide,U=0,l=Y.length;l>U;U++)if(F=Y[U],F.id===m)return Y.splice(U,1),h._interactor._42(),{axis:0===x?"x":"y",position:F.p};return!1},Ym.prototype.adjustAlignmentGuide=function(Y,j){var H=this,T=H.removeAlignmentGuide(Y);return T?(H.addAlignmentGuide(T.axis,j,Y),!0):!1};var Sr=Ac.Guide.Rect=function(z){var R=this;R._interactor=z};Sr.prototype={},Sr.prototype.constructor=Sr,Sr.prototype.gatherRects=function(){var h,i,Q,G,o=this,I=o._interactor.gv,r=[],p=[],O={x:r,y:p},m={},C=I.getDataModel(),f=C.a("width"),U=C.a("height");f&&U&&(h=0,i=0,Q=f,G=U,r.push({node:C,type:0,p:h},{node:C,type:1,p:h+Q/2},{node:C,type:2,p:h+Q}),p.push({node:C,type:0,p:i},{node:C,type:1,p:i+G/2},{node:C,type:2,p:i+G}),m[C._id||0]={x:h,y:i,width:Q,height:G}),C.each(function(U){if(gj(U)&&!I.isSelected(U)&&I.isVisible(U)&&I.isValidGuideLineSource(U)){var N=!1;if(I.sm().getSelection().each(function(k){N||(U.isHostOn(k)?N=!0:U.isDescendantOf(k)&&(N=!0))}),!N){var B=U.getRect();h=B.x,i=B.y,Q=B.width,G=B.height,r.push({node:U,type:0,p:h},{node:U,type:1,p:h+Q/2},{node:U,type:2,p:h+Q}),p.push({node:U,type:0,p:i},{node:U,type:1,p:i+G/2},{node:U,type:2,p:i+G}),m[U._id]=B}}}),r.sort(function(Z,S){return Z.p-S.p}),p.sort(function(h,b){return h.p-b.p}),o._grid=O,o._87I=m},Sr.prototype.gatherLines=function(h,e,L){var H,v,V,A,b,Y,K,t,X,g,x,s,o=this,r=[o.findClosest({x:h.x,y:h.y},e),o.findClosest({x:h.x+h.w/2,y:h.y+h.h/2},e),o.findClosest({x:h.x+h.w,y:h.y+h.h},e)],O={},p=o._87I;L=L||255;var z,F;for(o._guideLine=[],H=0;2>H;H++)for(O={},0===H?(A="y",t=h.x,X=t+h.w):(A="x",t=h.y,X=t+h.h),v=0;3>v;v++)b=r[v],b&&isFinite(b[A])&&(z=1<<3*H+v,L&z&&(Y=b[A+"Line"],K=Y.node,F=K._id||0,O[F]||(O[F]=!0,s=p[F],"y"===A?(g=s.x,x=s.x+s.width):(g=s.y,x=s.y+s.height),V=Y.p,o._guideLine.push({type:A,a:t,b:X,c:g,d:x,p:V,center:1===Y.type}))))},Sr.prototype._binarySearchClosest=function(J,U){if(!U.length)return{dis:1/0};for(var C,o=0,h=U.length-1;h-o>1;)C=Math.floor((o+h)/2),U[C].p<J?o=C:h=C;var V=U[o].p-J,z=U[h].p-J;return Math.abs(V)<=Math.abs(z)?{line:U[o],dis:V}:{line:U[h],dis:z}},Sr.prototype.findClosest=function(v,r,p){var n=this,i=n._interactor,D=i.gv,V=n._grid;p&&(v=Ac.toWorldPosition(D,v));var w,f=n._binarySearchClosest(v.x,V.x),Y=n._binarySearchClosest(v.y,V.y),I=f.dis,z=Y.dis,Q=D._zoom,q=i.getStyle("smartGuideThreshold")/Q,B={};return Math.abs(I)<q&&"y"!==r&&(B.x=p?I*Q:I,B.xLine=f.line,w=!0),Math.abs(z)<q&&"x"!==r&&(B.y=p?z*Q:z,B.yLine=Y.line,w=!0),w?B:void 0},Sr.prototype._42=function(){var f=this,h=f._guideLine;if(h&&!r.Default.isCtrlDown()){var i=f._interactor;if(i.getStyle("guideLineVisible")){var X,j,d,x,$,H,J,P,q,_,Z,l,E,F,U,I,D,w=i.gv,O=i._context,n=w.tx(),e=w.ty(),V=w._zoom,y=i.getStyle("guideLineTextSpacing");for(X=0,j=h.length;j>X;X++)d=h[X],P=d.type,q=d.p,_=d.a,Z=d.b,l=d.c,E=d.d,F=Math.min(_,l),U=Math.max(Z,E),"x"===P?(x=q*V+n,$=F*V+e,H=x,J=U*V+e):(x=F*V+n,$=q*V+e,H=U*V+n,J=$),Ac.Icons.DrawIcon(i,O,Ac.Icons.MoveLineGuide,{rect:[x,$,H,J],center:d.center}),E>=_&&Z>=l||(F=_>E?E:Z,U=_>E?_:l,D=U-F,"x"===P?(d.center2center||(x-=y,H=x),$=F*V+e,J=U*V+e,I=Ac.Icons.MoveLineGuideDistanceV):"y"===P&&(d.center2center||($-=y,J=$),x=F*V+n,H=U*V+n,I=Ac.Icons.MoveLineGuideDistanceH),Ac.Icons.DrawIcon(i,O,I,{x0:x,y0:$,x1:H,y1:J,dis:D}))}}},Sr.prototype.clear=function(){this._guideLine=null};var nc=Ac.Guide.Hover=function(g){var h=this;h._interactor=g};nc.prototype={},nc.prototype.constructor=nc,j.defineProperties(nc.prototype,{}),nc.prototype._42=function(){var u=this._interactor;if(u.getStyle("hoverGuideVisible")&&!u.gvEditing){var H=u.hoverData,l=u.gv;if(!gj(H)||l.isSelected(H))return u.hoverData=null,void 0;var e=zk(l,H),Q=Ac.toScreenPosition(l,{x:e.x,y:e.y}),z=Ac.toScreenPosition(l,{x:e.x+e.width,y:e.y+e.height});Ac.Icons.DrawIcon(u,u._context,Ac.Icons.HoverDataRect,{min:Q,max:z,color:u.getStyle("hoverGuideColor")||u.getStyle("baseColor")})}},Ac.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var nm=Ac.Icons={},Cb=1e4,So=null,Wn=Ac.DefaultStyleMap.baseColor,Ap="rgb(183,232,135)",re="rgb(255,204,153)",Cj=6;r.Default.setImage("Icons.RectPoint",{width:Cj,height:Cj,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Wn}},rect:[0,0,Cj,Cj]}]}),nm.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var e=nm.GroupSubEntityRect.data;if(!e)return[];var L=e.min,x=e.max;return[L.x,L.y,L.x,x.y,x.x,x.y,x.x,L.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return nm.GroupSubEntityRect.data.isKeyOb?Wn:Wn}}}]};var Uf=4;nm.HoverDataRect={comps:[{type:"shape",points:{func:function(){var X=nm.HoverDataRect.data;if(!X)return[];var o=X.min,Z=X.max,h=Uf;return o.x-=h,o.y-=h,Z.x+=h,Z.y+=h,[o.x,o.y,o.x,Z.y,Z.x,Z.y,Z.x,o.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return nm.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},nm.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[nm.Line.data.P1.x,nm.Line.data.P1.y],Cj,Cj]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[nm.Line.data.P2.x,nm.Line.data.P2.y],Cj,Cj]}}}]},nm.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return nm.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},nm.Rect={comps:[{type:"shape",points:{func:function(){var H=nm.Rect.data;if(!H)return[];var x=H.LT,o=H.LB,n=H.RB,S=H.RT;return[x.x,x.y,o.x,o.y,n.x,n.y,S.x,S.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Wn}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return nm.Rect.data.rotation}},rect:{func:function(){return[[nm.Rect.data.LT.x,nm.Rect.data.LT.y],Cj,Cj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return nm.Rect.data.rotation}},rect:{func:function(){return[[nm.Rect.data.LB.x,nm.Rect.data.LB.y],Cj,Cj]
}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return nm.Rect.data.rotation}},rect:{func:function(){return[[nm.Rect.data.RB.x,nm.Rect.data.RB.y],Cj,Cj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return nm.Rect.data.rotation}},rect:{func:function(){return[[nm.Rect.data.RT.x,nm.Rect.data.RT.y],Cj,Cj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return nm.Rect.data.rotation}},visible:{func:function(){return nm.Rect.data.L?!0:!1}},rect:{func:function(){return[[nm.Rect.data.L.x,nm.Rect.data.L.y],Cj,Cj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return nm.Rect.data.rotation}},visible:{func:function(){return nm.Rect.data.R?!0:!1}},rect:{func:function(){return[[nm.Rect.data.R.x,nm.Rect.data.R.y],Cj,Cj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return nm.Rect.data.rotation}},visible:{func:function(){return nm.Rect.data.T?!0:!1}},rect:{func:function(){return[[nm.Rect.data.T.x,nm.Rect.data.T.y],Cj,Cj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return nm.Rect.data.rotation}},visible:{func:function(){return nm.Rect.data.B?!0:!1}},rect:{func:function(){return[[nm.Rect.data.B.x,nm.Rect.data.B.y],Cj,Cj]}}}]};var xq=16;r.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return Wn}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return Wn}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),nm.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[nm.Anchor.data.POS.x,nm.Anchor.data.POS.y],xq,xq]}}}]},nm.TipShiftX=12,nm.TipShiftY=12;var wj=[8,28];nm.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[nm.TipHelper.data.helperPos.x,nm.TipHelper.data.helperPos.y,wj[0]*nm.TipHelper.data.size,wj[1]]}},background:{func:function(){return So.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return nm.TipHelper.data.text}},rect:{func:function(){return[nm.TipHelper.data.helperPos.x,nm.TipHelper.data.helperPos.y,wj[0]*nm.TipHelper.data.size,wj[1]]}},color:{func:function(){return So.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var $p=7;nm.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!nm.ShapePoint.data.dynamicVisible}},rect:{func:function(){var V=nm.ShapePoint.data.point,e=nm.ShapePoint.data.size||$p;return[V,e+10,e+10]}},background:{func:function(){var g=Date.now(),X=nm.ShapePoint.data.dynamicPeriod||1500,m=Math.sin(g%X/X*Math.PI);return"rgba(27,124,22,"+.5*m+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var e=nm.ShapePoint.data.point,l=nm.ShapePoint.data.size||$p;return[e,l,l]}},background:{func:function(){var p=nm.ShapePoint.data.isEnd;return p?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return nm.ShapePoint.data.color||Wn}}},{type:"rect",visible:{func:function(){return!!nm.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return Wn}},rect:{func:function(){var v=5;return[nm.ShapePoint.data.point,v,v]}}}]},nm.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!nm.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return nm.ShapeBgCurve.data.P}},segments:{func:function(){return nm.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var S=Date.now(),R=nm.ShapeBgCurve.data.dynamicPeriod||1500,G=Math.sin(S%R/R*Math.PI);return"rgba(27,124,22,"+.3*G+")"}}},{type:"shape",points:{func:function(){return nm.ShapeBgCurve.data.P}},segments:{func:function(){return nm.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return nm.ShapeBgCurve.data.color||Wn}}}]};var op=8;nm.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var a=nm.ShapeHighlighPoint.data;return[[a.x,a.y],op,op]}},background:{func:function(){return So.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var dr=10;nm.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var Y=nm.ShapeHighlighRealPoint.data;return[[Y.x,Y.y],dr,dr]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return Wn}}}]};var nq=8;nm.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var s=nm.ShapeHighlighCtrlPoint.data,J=s.x,o=s.y,S=nq/2;return[J-S,o-S,J-S,o+S,J+S,o+S,J+S,o-S]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return So.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return So.getStyle("shapeCtrlPointBorderColor")||Wn}}}]};var Go=3;nm.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return nm.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Go,borderColor:{func:function(){return So.getStyle("curveHighlightColor")}}}]},nm.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return nm.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},nm.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return nm.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return nm.MoveLineGuide.data.center?Ap:re}}}]};var Oi=5;nm.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var E=nm.MoveLineGuideDistanceH.data,P=E.x0,L=E.y0;return[P,L-Oi,P,L+Oi]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:re},{type:"shape",points:{func:function(){var G=nm.MoveLineGuideDistanceH.data,B=G.x1,O=G.y1;return[B,O-Oi,B,O+Oi]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:re},{type:"text",text:{func:function(){return Math.round(nm.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var Z=nm.MoveLineGuideDistanceH.data;return[[(Z.x0+Z.x1)/2,Z.y0-10],20,20]}},color:re,font:"12px Arial",align:"center"}]},nm.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var n=nm.MoveLineGuideDistanceV.data,e=n.x0,c=n.y0;return[e-Oi,c,e+Oi,c]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:re},{type:"shape",points:{func:function(){var J=nm.MoveLineGuideDistanceV.data,h=J.x1,S=J.y1;return[h-Oi,S,h+Oi,S]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:re},{type:"text",text:{func:function(){return Math.round(nm.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var u=nm.MoveLineGuideDistanceV.data;return[[u.x0-10,(u.y0+u.y1)/2],20,20]}},color:re,font:"12px Arial",align:"center"}]},r.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),nm.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var Y=nm.EdgeElevationGuide.data,y=Y.x,M=Y.y,j=So.getStyle("curveElevationIntersectSize"),C=So.getStyle("curveElevationGuideShift");return y+=C[0],M+=C[1],[y-j,M-j,2*j,2*j]}}}]},r.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),r.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),nm.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return nm.ConnectGuide.data.rotation}},rect:{func:function(){var h=nm.ConnectGuide.data.connect;h.x,h.y;var s=So.getStyle("connectGuideIntersectSize");return[[h.x,h.y],2*s,2*s]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var l=nm.ConnectGuide.data.cursorPos||nm.ConnectGuide.data.connect,p=So.getStyle("connectGuideIntersectSize");return[[l.x,l.y],2*p-2,2*p-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var v=nm.ConnectGuide.data.connect,f=nm.ConnectGuide.data.cursorPos||v;return[v.x,v.y,v.x+.5*(f.x-v.x),v.y,f.x+.5*(v.x-f.x),f.y,f.x,f.y]}}}]},r.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),r.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),nm.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var a=nm.ConnectGuideGarbage.data.hover;return a?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var d=nm.ConnectGuideGarbage.data,q=So.getStyle("connectGuideGarbageIntersectsize");return d.hover&&(q+=5),[[d.x,d.y],2*q,2*q]}}}]};var Qo=6;nm.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return nm.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var h=nm.ShapeActivingCtrl.data;return[h.point.x,h.point.y,h.c1.x,h.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Wn}}},{type:"shape",visible:{func:function(){return nm.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var M=nm.ShapeActivingCtrl.data;return[M.point.x,M.point.y,M.c2.x,M.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Wn}}},{type:"shape",visible:{func:function(){return nm.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var s=nm.ShapeActivingCtrl.data.c1,O=s.x,n=s.y,g=Qo/2;return"c1"===nm.ShapeActivingCtrl.data.hl&&(g+=.5),[O-g,n-g,O-g,n+g,O+g,n+g,O+g,n-g]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return So.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===nm.ShapeActivingCtrl.data.hl?So.getStyle("shapeCtrlPointHighlightBorder")||Wn:So.getStyle("shapeCtrlPointBorderColor")||Wn}}},{type:"shape",visible:{func:function(){return nm.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var g=nm.ShapeActivingCtrl.data.c2,Q=g.x,X=g.y,i=Qo/2;return"c2"===nm.ShapeActivingCtrl.data.hl&&(i+=.5),[Q-i,X-i,Q-i,X+i,Q+i,X+i,Q+i,X-i]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return So.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===nm.ShapeActivingCtrl.data.hl?So.getStyle("shapeCtrlPointHighlightBorder")||Wn:So.getStyle("shapeCtrlPointBorderColor")||Wn}}}]},nm.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Wn}},rect:{func:function(){return[[nm.RoundPoint.data.x,nm.RoundPoint.data.y],Cj,Cj]}}}]},nm.AttachPoint={comps:[{type:"rect",background:{func:function(){return nm.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return Wn}},rect:{func:function(){var q=nm.AttachPoint.data.isAttach?Cj+4:Cj;return[[nm.AttachPoint.data.x,nm.AttachPoint.data.y],q,q]}}}]},nm.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return nm.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return nm.SimpleRect.data.color||Wn}},rect:{func:function(){var L=nm.SimpleRect.data;return[L.x,L.y,L.width,L.height]}}}]},r.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),nm.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var X=nm.MoveDummy.data;return[[X.pos.x,X.pos.y],2*X.size,2*X.size]}}}]},Ac.Icons.DrawIcon=function(s,V,q,p){q.width=q.height=Cb,q.data=p,So=s,r.Default.drawImage(V,q,0,0,Cb,Cb)},Ac.Icons.MapPoints=function(N,X){for(var j=0,G=N.length;G>j;j++)N[j]/=X},Ac.roundTo=function(n,s,h){var I=Math.abs(n%s);return h>I||h>s-I?s*Math.round(n/s):n},Ac.toFixed=function(_){return Math.round(100*_)/100},Ac.getDataMatrix=function(X){if(X instanceof r.Shape){var B=new r.Math.Matrix2d,d=X.getPosition();return B.translate(-d.x,-d.y).scale(X.getScale().x,X.getScale().y).rotate(X.getRotation()).translate(d.x,d.y),B}return X.getMatrix?X.getMatrix():new r.Math.Matrix2d};var Xj=Ac.Math.Curve=function(){this._curves=[]};Xj.prototype={},Xj.prototype.constructor=Xj,Xj.prototype.createFromHtShape=function(B,x,O){x instanceof r.List&&(x=x.toArray());var u,j,d,U,b,T,Y,z=this,C=null,X=null,Q=0,Z=Ac.Math.Vector2,N=Ac.Math.CubicBezier,i=function(I){return new Z(B[I],B[I+1],O?O[I/2]:s)};for(j=0,d=x.length;d>j;j++){switch(U=x[j],b=null,U){case 1:X=i(Q),C=X,Q+=2;break;case 2:u=i(Q),Q+=2,b=new N(X,X.clone(),u.clone(),u),X=u;break;case 3:T=i(Q),u=i(Q+2),Q+=4,b=new N(X,T.clone().sub(X).multiplyScalar(2/3).add(X),T.clone().sub(u).multiplyScalar(2/3).add(u),u),X=u;break;case 4:T=i(Q),Y=i(Q+2),u=i(Q+4),Q+=6,b=new N(X,T,Y,u),X=u;break;case 5:if(!C)break;b=new N(X,X.clone(),C.clone(),C),X=null,C=null}b&&(b._index=z._curves.length,z._curves.push(b))}},Xj.prototype.checkPoint=function(L,e){var _,K,V,j,i,s=this,t=s._curves;for(_=0,K=t.length;K>_;_++)if(j=t[_],i=j.intersectRect(L,e,e),i.length)return V=0,i.forEach(function(G){V+=G.t}),V/=i.length,L=j.getPointAt(V),L.t=V,{bezier:j,intersection:L}},Xj.prototype.insertKnot=function($,L){var d=$.insertKnot(L),c=this,K=c._curves;K.splice($._index,1,d[0],d[1])},Xj.prototype._isCloseEnough=function(d,g){return Math.abs(d.x-g.x)<1e-6&&Math.abs(d.y-g.y)<1e-6},Xj.prototype._isSamePoint=function(V,U){return V===U},Xj.prototype.moveRealPoint=function(e,l){var H=this,C=H._curves,h=l.clone().sub(e);C.forEach(function(j){var O=j._p1;j._p2,j._p3;var Q=j._p4;H._isSamePoint(O,e)&&(j._p2.add(h),j._p1=l),H._isSamePoint(Q,e)&&(j._p3.add(h),j._p4=l)})},Xj.prototype.moveCtrlDueToRealPointMovement=function(a,M){var D=this,y=D._curves,E=function(j){j.add(M),j.e&&M.e&&(j.e+=M.e)};y.forEach(function(s){var o=s._p1;s._p2,s._p3;var d=s._p4;D._isSamePoint(o,a)&&E(s._p2),D._isSamePoint(d,a)&&E(s._p3)})},Xj.prototype.moveCtrlPoint=function(r,b,x){var I=r[x];if(I){I.e!==s&&(b.e=I.e);var g=this,M=g._curves;b.clone().sub(I),M.forEach(function(k){var G;"c2"===x?G="_p2":"c1"===x&&(G="_p3"),g._isSamePoint(k[G],I)&&(k[G]=b)}),r[x]=b}},Xj.prototype.deleteRealPoint=function(_,S){var O,p,j,F,W,n,A,B=this,U=B._curves,M={},z=[],i=Ac.Math.CubicBezier;for(p=0,j=U.length;j>p;p++)O=U[p],F=O._p1,W=O._p2,n=O._p3,A=O._p4,(M[p]||!B._isSamePoint(F,_))&&(B._isSamePoint(A,_)?j>p+1&&B._isSamePoint(U[p+1]._p1,_)&&(S||z.push(new i(F,W,U[p+1]._p3,U[p+1]._p4))):z.push(O));B._curves=z},Xj.prototype.findPairs=function(O,m){var t,I,b,r,p,q,P,M,f=this,z=f._curves,u={},Q=[];for(I=0,b=z.length;b>I;I++)t=z[I],r=t._p1,p=t._p2,q=t._p3,P=t._p4,!u[I]&&f._isSamePoint(r,O)&&(m?Q.push({point:r,r2:P}):Q.push({point:r,c2:p})),f._isSamePoint(P,O)&&(M=m?{point:P,r1:r}:{point:P,c1:q},b>I+1&&f._isSamePoint(z[I+1]._p1,O)&&(m?M.r2=z[I+1]._p4:M.c2=z[I+1]._p2,u[I+1]=!0),Q.push(M));return Q},Xj.prototype.toHtShape=function(){var H=this,A=H._curves,M=[],s=[],i={x:1/0,y:1/0};return A.forEach(function(R){var j=R._p1,h=R._p2,Q=R._p3,z=R._p4;return H._isCloseEnough(j,i)||(M.push(1),s.push(j.clone())),i=z,H._isCloseEnough(j,h)&&H._isCloseEnough(Q,z)?(M.push(2),s.push(z.clone()),void 0):(M.push(4),s.push(h.clone(),Q.clone(),z.clone()),void 0)}),{segments:M,points:s}};var ie=Ac.Math.CubicBezier=function(D,r,B,O){var N=this;N._id=Ac.Math.CubicBezier._globalId++,N._p1=D,N._p2=r,N._p3=B,N._p4=O};ie._globalId=1,ie.prototype={},ie.prototype.constructor=ie,ie.prototype.toString=function(){return this._id},ie.prototype.intersectRect=function(x,M,w){var t=M/2,l=w/2,V=x.x,S=x.y,Z=Ac.Math.Vector2,c=new Z(-t+V,-l+S),$=new Z(t+V,l+S),K=new Z($.x,c.y),m=new Z(c.x,$.y),P=this,n=P.intersectLine(c,K),L=P.intersectLine(K,$),N=P.intersectLine($,m),B=P.intersectLine(m,c),f=n.concat(L).concat(N).concat(B);return f},ie.prototype.intersectLine=function(S,l){var Q,A,Z,h,$,U,D,O,C,k,B,t,f,V=this,s=S.clone().min(l),y=S.clone().max(l);h=V._p1,$=V._p2,U=V._p3,D=V._p4,Q=h.clone().multiplyScalar(-1),A=$.clone().multiplyScalar(3),Z=U.clone().multiplyScalar(-3),B=Q.add(A).add(Z).add(D),Q=h.clone().multiplyScalar(3),A=$.clone().multiplyScalar(-6),Z=U.clone().multiplyScalar(3),k=Q.add(A).add(Z),Q=h.clone().multiplyScalar(-3),A=$.clone().multiplyScalar(3),C=Q.add(A),O=h.clone(),f=new Ac.Math.Vector2(S.y-l.y,l.x-S.x),t=S.x*l.y-l.x*S.y;for(var p=V.getRoots(f.dot(B),f.dot(k),f.dot(C),f.dot(O)+t),b=new Array,M=0,G=p.length;G>M;M++){var n=p[M];if(!(0>n||n>1)){var c=h.clone().lerp($,n),X=$.clone().lerp(U,n),K=U.clone().lerp(D,n),e=c.lerp(X,n),g=X.lerp(K,n),N=e.lerp(g,n);N.t=n,S.x==l.x?s.y<=N.y&&N.y<=y.y&&b.push(N):S.y==l.y?s.x<=N.x&&N.x<=y.x&&b.push(N):N.x>=s.x&&N.y>=s.y&&N.x<=y.x&&N.y<=y.y&&b.push(N)}}return b},ie.prototype.solveTForPoint=function(q){var F,J,t,Z,h=this;F=h._p1.x-q.x,J=h._p2.x-q.x,t=h._p3.x-q.x,Z=h._p4.x-q.x;for(var W=h.getRoots(Z-3*t+3*J-F,3*t-6*J+3*F,3*J-3*F,F),m=s,U=1/0,P=0,B=W.length;B>P;P++){var j=W[P];if(!(0>j||j>1)){var w=h._p1.clone().lerp(h._p2,j),u=h._p2.clone().lerp(h._p3,j),f=h._p3.clone().lerp(h._p4,j),$=w.lerp(u,j),a=u.lerp(f,j),M=$.lerp(a,j);M.t=j;var G=Math.abs(M.y-q.y);U>G&&(U=G,m=M)}}return m},ie.prototype.getPointAt=function(d){var S=this,A=S._p1,h=S._p2,Y=S._p3,R=S._p4,P=A.clone().lerp(h,d),u=h.clone().lerp(Y,d),B=Y.clone().lerp(R,d),t=P.lerp(u,d),N=u.lerp(B,d);return t.lerp(N,d)},ie.prototype.getRoots=function(M,g,D,s){var k,Z,K,w,G,a=new Array;if(Math.abs(M)<1e-6){var k=g,Z=D/k,K=s/k,w=Z*Z-4*K;if(w>0){var G=Math.sqrt(w);a.push(.5*(-Z+G)),a.push(.5*(-Z-G))}else 0==w&&a.push(.5*-Z)}g/=M,D/=M,s/=M,k=(3*D-g*g)/3,Z=(2*g*g*g-9*D*g+27*s)/27;var X=g/3,x=Z*Z/4+k*k*k/27,F=Z/2;if(Math.abs(x)<=1e-6&&(x=0),x>0){var l,n,G=Math.sqrt(x);l=-F+G,n=l>=0?Math.pow(l,1/3):-Math.pow(-l,1/3),l=-F-G,l>=0?n+=Math.pow(l,1/3):n-=Math.pow(-l,1/3),a.push(n-X)}else if(0>x){var E=Math.sqrt(-k/3),T=Math.atan2(Math.sqrt(-x),-F)/3,I=Math.cos(T),C=Math.sin(T),Q=Math.sqrt(3);a.push(2*E*I-X),a.push(-E*(I+Q*C)-X),a.push(-E*(I-Q*C)-X)}else{var l;l=F>=0?-Math.pow(F,1/3):Math.pow(-F,1/3),a.push(2*l-X),a.push(-l-X)}return a},ie.prototype._70I=function(){var E=this;return E._p1.distanceToSquared(E._p2)<1e-10&&E._p3.distanceToSquared(E._p4)<1e-10},ie.prototype.insertKnot=function(Q){var p=this,v=p._p1,$=p._p2,l=p._p3,y=p._p4,F=v.clone().lerp($,Q),H=$.clone().lerp(l,Q),o=l.clone().lerp(y,Q),k=F.clone().lerp(H,Q),e=H.clone().lerp(o,Q),w=k.clone().lerp(e,Q);return p._70I()?(v.clone().lerp(y,Q),[new Ac.Math.CubicBezier(v,v.clone(),w.clone(),w),new Ac.Math.CubicBezier(w,w.clone(),y.clone(),y)]):[new Ac.Math.CubicBezier(v,F,k,w),new Ac.Math.CubicBezier(w,e,o,y)]};var uj=r.Default.getInternal().ui().EdgeUI,Vm={_47O:function(v){var C=this,q=Vm.getBackups()._47O;Ac.inEdit(C.gv)||q.call(C,v)}};Ac.Inject.registAsModule(Vm,uj);var sc=r.Default.getInternal().ui().NodeUI,Aq={_47O:function(h){var O=this,k=Aq.getBackups()._47O;Ac.inEdit(O.gv)||k.call(O,h)},getSelectWidth:function(){var Q=this,V=Q.gv,j=Q._data;if(V.isEditable(j)&&Ac.inEdit(V))return 0;var w=Aq.getBackup("getSelectWidth");return w.call(Q)}};Ac.Inject.registAsModule(Aq,sc);var xo=r.graph.GraphView,Ad={_editPointSize:function(){var d=r.Default.isTouchable,B=Ac.getStyle("pointSize");return B[d?0:1]}(),isPointEditable:function(M){var h=this;if(Ac.inEdit(h))return h._pointEditableFunc?h._pointEditableFunc(M):!0;var P=Ad.getBackup("isPointEditable");P.call(h,M)},isEditable:function(Q){var o,T=this,N=Ad.getBackup("isEditable");if(o=Q instanceof Ac.Group?!0:N.call(T,Q),!Ac.inEdit(T))return o;if(!(Q instanceof r.Edge))return o;if(!Q.s("2d.editable"))return!1;var P=T.getEditableFunc();return P?P(Q):!0},_42:function(m,w){var b=this,g=Ad.getBackups()._42;if(g.call(b,m,w),Ac.inEdit(b)){var f=b.getEditInteractor();f.drawImpl()}}};Ac.Inject.registAsModule(Ad,xo);var ep=r.Default.getInternal().ui().ShapeUI,tg={_47O:function(O){var Q=this,A=tg.getBackups()._47O;Ac.inEdit(Q.gv)||A.call(Q,O)}};Ac.Inject.registAsModule(tg,ep);var yh=r.graph.DefaultInteractor,ib={handle_mousewheel:function(J){var O=this,r=ib.getBackup("handle_mousewheel");Ac.inEdit(O.gv)||r.call(O,J)}};Ac.Inject.registAsModule(ib,yh);var Ue=r.graph.MoveInteractor,Af={_calcShift:function(_,H){var d=this,k=Af.getBackup("_calcShift"),f=d.gv;if(!Ac.inEdit(f))return k.call(d,_,H);var l=f.getEditInteractor(),G=l.getSubModule("Move").calcShift(_,H,d);return G||k.call(d,_,H)},clear:function(C){var z=this,g=Af.getBackup("clear");g.call(z,C);var I=z.gv;if(Ac.inEdit(I)){var Q=I.getEditInteractor();Q.getSubModule("Move").clear(C)}}};Ac.Inject.registAsModule(Af,Ue);var Sr=Ac.Rect=function(Q){this.catalog="Rect",this._interactor=Q};Sr.prototype={},Sr.prototype.constructor=Sr,Sr.prototype.gatherInfo=function(R,b){var E=this;if(1===b.length){var J=b[0];return J instanceof r.Shape&&J._70I()?E.gatherLine(R,J):Pn(J,R)?!1:E.gatherSingleTarget(R,J)}return b.length>1?E.gatherMultiTargets(R,b):!1},Sr.prototype.gatherSingleTarget=function(R,c){if(c.getCorners){var S,Q=this,H=Q.info;Q.target=c,S=Q.screenInfo={};var G=c.getCorners();H.LT=new Ac.Math.Vector2(G[0]),H.LB=new Ac.Math.Vector2(G[1]),H.RB=new Ac.Math.Vector2(G[2]),H.RT=new Ac.Math.Vector2(G[3]),H.T=H.LT.clone().add(H.RT).divideScalar(2),H.B=H.LB.clone().add(H.RB).divideScalar(2),H.L=H.LT.clone().add(H.LB).divideScalar(2),H.R=H.RT.clone().add(H.RB).divideScalar(2);for(var V in H)S[V]=Ac.toScreenPosition(R,H[V]);var $=Q._interactor,u=$.getStyle("checkSize"),F=function(A,U,p){var k=U.clone().sub(A).setLength(-u),V=p.clone().sub(A).setLength(-u),H=k.add(V).add(A);return H};return S.rotLT=F(S.LT,S.RT,S.LB),S.rotLB=F(S.LB,S.LT,S.RB),S.rotRB=F(S.RB,S.LB,S.RT),S.rotRT=F(S.RT,S.LT,S.RB),S.rotT=S.rotLT.clone().add(S.rotRT).divideScalar(2),S.rotB=S.rotLB.clone().add(S.rotRB).divideScalar(2),S.rotL=S.rotLT.clone().add(S.rotLB).divideScalar(2),S.rotR=S.rotRT.clone().add(S.rotRB).divideScalar(2),S.rotation=c.getRotation(),Q.gatherConnectInfo(),!0}},Sr.prototype.gatherConnectInfo=function(){var l=this,a=l.target,P=l._interactor,m=l.screenInfo,J=P.gv;if(J.isConnectActionVisible(a)&&P.getStyle("connectGuideVisible")){var E;a.s&&(E=a.s("connectGuideShift")),E||(E=P.getStyle("connectGuideShift"));var B=a.getAnchor(),t=a.getSize(),D=a.toGlobal({x:t.width*(E[0]-B.x),y:t.height*(E[1]-B.y)});D=Ac.toScreenPosition(J,D),m.P1?D.add(m.P2.clone().sub(m.P1).setLength(E[2])):(D.add(m.RT.clone().sub(m.LT).setLength(E[2])),D.add(m.LB.clone().sub(m.LT).setLength(E[3]))),m.connect=D}},Sr.prototype.gatherMultiTargets=function(s,Q){var $=Ac.Group.findOrCreateGroup(Q);if(!$)return!1;var l=this;return l.editing&&"rotate"!==l.editing.mode||$.calcInfo(),l.gatherSingleTarget(s,$)},Sr.prototype.gatherLine=function(x,w){this.target=w;var n=this.screenInfo={},k=w.getPoints(),B=Ac.getDataMatrix(w);return n.P1=Ac.toScreenPosition(x,B.apply(k.get(0))),n.P2=Ac.toScreenPosition(x,B.apply(k.get(1))),this.gatherConnectInfo(),!0},Sr.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Sr.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Sr.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Sr.prototype.check=function(U,W,z){if(r.Default.isLeftButton(W)){var D=this;if(D.editing=null,D.tipInfo=null,D.screenInfo){var y=D.target,n=U.isEditable(y),I=D.screenInfo;if(n&&I.connect){var Z=D._checkConnect(z);if(Z)return Z}if(I.P1)return D._checkLine(z);var w,B,Y,P=null,k=D._interactor,u=k.getStyle("checkSize");if(n&&U.isRectEditable(y))for(B=0;B<Ac.Rect.ResizeKeys.length;B++)if(Y=Ac.Rect.ResizeKeys[B],Ac.checkHit(z,I[Y],u)){P=Y,w="resize";break}if(!P&&n&&U.isRotationEditable(y)&&!k.getStyle("rotateAsClock")){var l=k.getStyle("rotateCheckSize");for(B=0;B<Ac.Rect.RotateKeys.length;B++)if(Y=Ac.Rect.RotateKeys[B],Ac.checkHit(z,I[Y],l)){P=Y,w="rotate";break}}if(!P)return k.setCursor("default"),void 0;if("rotate"===w){var b,M=U.lp(W);if(y instanceof Ac.Group){var j=k.getStyle("groupRotateModeKey");"string"==typeof j&&(j=[j]);for(var p=!1,x=0,O=j.length;O>x;x++)if(W[j[x]]){p=!0;break}var d=k.getStyle("groupRotateModeDefault");b=p?"batch"===d?"block":"batch":d}var q="batch"===b?y.getAnchor2():y.getPosition(),L=Math.atan2(M.y-q.y,M.x-q.x);k._setRotateCursor(L),D.editing={mode:w,key:P,pos:q,flipY:y.getScale().y<0,rotation:y.getRotation(),hitRot:L},b&&(D.editing.groupRotateMode=b)}else{var X=Ac.Rect.ResizeKeys.indexOf(P),$=Ac.Rect.ResizeDirection[X],G=Math.cos(y.getRotation()),f=Math.sin(y.getRotation()),i=$.x*Math.sign(y.getScale().x),K=$.y*Math.sign(y.getScale().y),m=Math.atan2(-f*i-G*K,G*i-f*K),Q=(Math.round(m/(Math.PI/4))+8)%8,v=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][Q];this._interactor.setCursor(v);var a=y.getWidth(),J=y.getHeight(),s=y.getAnchor();D.editing={mode:w,key:P,rect:{x:-a*s.x,y:-J*s.y,width:a,height:J},anchor:s,matrix:y.getMatrix()}}return P}}},Sr.prototype._checkLine=function(J){var f=this;f.screenInfo;var D,M=f._interactor.getStyle("checkSize");if(Ac.checkHit(J,f.screenInfo.P1,M))D="P1";else{if(!Ac.checkHit(J,f.screenInfo.P2,M))return this._interactor.setCursor("default"),void 0;D="P2"}return f.editing={mode:"line",key:D},D},Sr.prototype._checkConnect=function(K){var o=this,r=o.screenInfo,c=o._interactor,L=c.getStyle("connectGuideIntersectSize"),G=r.connect,t=K.x,w=G.x;if(w>t&&L>w-t&&Math.abs(G.y-K.y)<L||t>=w&&Ac.checkHit(K,G,L)){var N="connect",s=z.getConnectAction(c.gv);if(o.editing={mode:N},s&&s.delete)if(o.target instanceof Ac.Group){var Q=!0;c.gv.sm().getSelection().each(function(O){s.delete.visible.call(null,c.gv,O)||(Q=!1)}),o.editing.hasDeleteAction=Q}else s.delete.visible.call(null,c.gv,o.target)&&(o.editing.hasDeleteAction=!0);return c.setCursor("default"),N}},Sr.prototype._fireEditEvent=function(C,F){var W=this._interactor,O=this.editing;if(O){var K=O.mode;K="rotate"===K?"Rotation":"connect"===K?"Connection":"resize"===K?"Rect":K[0].toUpperCase()+K.slice(1),W.fi({kind:C+"Edit"+K,event:F})}},Sr.prototype.startEdit=function(p,t){p.startDragging(t);var k=this;k._interactor.fi({kind:"prepareEdit",event:t});var T=k.editing,f=k.target;if(T){if(k._fireEditEvent("begin",t),"rotate"===T.mode)return T.groupRotateMode&&f.beginRotate(T),void 0;if("connect"!==T.mode)("line"===T.mode||f&&0===f.getRotation())&&(k._inSmartGuide=!0,k._interactor.rectGuide.gatherRects());else if(T.hasDeleteAction){var z=p.gv,L=k._interactor.getStyle("connectGuideGarbageShift");T.garbageInfo={x:z.getWidth()*L[0]+L[2],y:z.getHeight()*L[1]+L[3],size:k._interactor.getStyle("connectGuideGarbageIntersectsize")},p._42()}}},Sr.prototype._46O=function(C){var A,f,L=this,h=L.editing,P=L.target;if(h){if("connect"===h.mode&&!h.canceled&&!h.deleted)try{h.garbageInfo&&h.garbageInfo.hover?z.doDeleteConnectionAction(L._interactor.gv,P):z.doConnectAction(L._interactor.gv,P,h.target)}catch(q){console.error(q)}f=h.freezeFlag,A=L.editing.groupRotateMode,L._fireEditEvent("end",C),L.editing=null}L.tipInfo=null,L._inSmartGuide&&(L._interactor.rectGuide.clear(),L._inSmartGuide=!1),A&&P&&P.endRotate(),P instanceof r.Block&&(f===s?delete P._freezeSyncFromChildren:P._freezeSyncFromChildren=f,P.updateFromChildren())},Sr.prototype.handleNormalStateDelete=function(){var q=this,F=q.editing;if(F&&"connect"===F.mode&&!F.canceled&&!F.deleted){if(F.garbageInfo){try{z.doDeleteConnectionAction(q._interactor.gv,q.target)}catch(e){console.error(e)}F.garbageInfo=null
}return F.cursorPos=null,F.targetCorners=null,F.deleted=!0,q._interactor._42(),!0}},Sr.prototype.handleNormalStateKeyDown=function(b){var S=this,U=S.editing;return!U||"connect"!==U.mode||U.canceled||U.deleted?void 0:r.Default.isEsc(b)?(U.cursorPos=null,U.targetCorners=null,U.canceled=!0,S._interactor._42(),!0):void 0},Sr.prototype.handleEdit=function(x,Q){var _=this,Y=_.editing;if(Y){var h,N,z,l,p,i=_.target,j=Y.key,f=Y.mode,S=x.lp(Q),d=_._interactor;if("connect"===f){if(Y.canceled)return;if(Y.deleted)return;Y.cursorPos=d._getLogicalPoint(Q);var y=Y.garbageInfo;return y&&Ac.checkHit(Y.cursorPos,y,y.size)?(y.hover=!0,Y.target=null,Y.targetCorners=null):(y&&(y.hover=!1),Y.target=x.getDataAt(S,function(o){return x.isSelectable(o)?gj(o)?!0:!1:!1})||null,Y.targetCorners=Ac.getTargetCornersOnScreen(x,Y.target)),d._42(),void 0}if("rotate"===f){var e,a,I=Y.pos,c=Math.atan2(S.y-I.y,S.x-I.x);if(Y.groupRotateMode?a=c-Y.hitRot:(e=c-Y.hitRot,a=Y.rotation+e),a%=2*Math.PI,0>a&&(a+=2*Math.PI),!r.Default.isCtrlDown(Q)){var A,q;Kq(Q)?(A=d.getStyle("shiftRotateRound"),q=A/2):(A=d.getStyle("rotateRound"),q=d.getStyle("rotateSensitivity")),a=Ac.roundTo(a,A,q)}Y.groupRotateMode?(e=a-(Y.lastRotation||0),0!==e&&(i.addRotation(e,Y.groupRotateMode,function(Q){return x.isRotationEditable(Q)}),Y.lastRotation=a)):i.setRotation(a),d._setRotateCursor(c),a>Math.PI&&(a-=2*Math.PI);var u=180*(a/Math.PI);u=u.toFixed(2),h=""+u+""}else if("resize"===f){var V=Y.rect;z=V.x,l=V.y;var L,o=V.width,W=V.height,M=Y.anchor,K=Y.matrix,H=i.s&&i.s("keepAspectRatio")||d.getStyle("keepAspectRatio");Kq(Q)&&(H=!H);var R=_._unionPointMode1,G=_._unionPointMode2;if(_._inSmartGuide&&!r.Default.isCtrlDown(Q)&&!H){var B;"L"===j||"R"===j?B="x":("T"===j||"B"===j)&&(B="y"),_._adsorbedToClosest(S,B),p=!0}L=K.tfi(S);var $;"LT"===j?(V=R(L,{x:z+o,y:l+W},o,W,H),$=9):"T"===j?(V=G({x:z,y:L.y},{x:z+o,y:l+W},o,W,H,"v"),$=1):"RT"===j?(V=R(L,{x:z,y:l+W},o,W,H),$=33):"L"===j?(V=G({x:L.x,y:l},{x:z+o,y:l+W},o,W,H,"h"),$=8):"R"===j?(V=G({x:z,y:l},{x:L.x,y:l+W},o,W,H,"h"),$=32):"LB"===j?(V=R(L,{x:z+o,y:l},o,W,H),$=12):"B"===j?(V=G({x:z,y:l},{x:z+o,y:L.y},o,W,H,"v"),$=4):"RB"===j&&(V=R(L,{x:z,y:l},o,W,H),$=36);var v=K.tf(V.x+V.width*M.x,V.y+V.height*M.y);i instanceof r.Block&&(Y.hasOwnProperty("freezeFlag")||(Y.freezeFlag=i._freezeSyncFromChildren,i._freezeSyncFromChildren=!0)),i.setPosition(v),i.setSize(V.width,V.height),p&&(N=i.getRect(),d.rectGuide.gatherLines({node:i,x:N.x,y:N.y,w:N.width,h:N.height},B,$)),h=""+Math.round(V.width)+" * "+Math.round(V.height)}else if("line"===f){if(Kq(Q)){var k=i.getPoints(),b="P1"===j?k.get(1):k.get(0),F={x:S.x-b.x,y:S.y-b.y},w=d.getStyle("shiftLineRotateRound"),g=_._shiftDirList;if(!g||_._shiftRotateRound!==w){_._shiftRotateRound=w,_._shiftDirList=g=[];for(var Z=0;Z<Math.PI;Z+=w)g.push({x:U(Z),y:X(Z)})}for(var J,n=0,m=0,D=g.length;D>m;m++){var E=g[m],t=E.x*F.x+E.y*F.y;Math.abs(t)>Math.abs(n)&&(n=t,J=E)}S={x:b.x+J.x*n,y:b.y+J.y*n},d.rectGuide.clear()}else _._inSmartGuide&&!r.Default.isCtrlDown(Q)&&(_._adsorbedToClosest(S),p=!0);var P=Ac.getDataMatrix(i).applyInverse(S);i.setPoint("P1"===j?0:1,P,!0);var O=i.getPoints(),C=O.get(0),T=O.get(1);z=C.x-T.x,l=C.y-T.y,h=" "+Math.round(Math.sqrt(z*z+l*l))+" ",p&&(N=i.getRect(),d.rectGuide.gatherLines({node:i,x:N.x,y:N.y,w:N.width,h:N.height}))}if(h){var s=r.Default.getLogicalPoint(Q,d._canvas);s.x+=Ac.Icons.TipShiftX,s.y+=Ac.Icons.TipShiftY,_.tipInfo={helperPos:s,text:h,size:h.length}}_._fireEditEvent("between",Q)}},Sr.prototype._unionPointMode1=function(Q,g,R,s,E){if(E&&R&&s){var O=Q.x-g.x,H=Q.y-g.y;Math.abs(O*s)<Math.abs(H*R)?(H=Math.sign(H)*Math.abs(O*s/R),Q.y=g.y+H):(O=Math.sign(O)*Math.abs(H*R/s),Q.x=g.x+O)}return r.Default.unionPoint(Q,g)},Sr.prototype._unionPointMode2=function(T,n,i,E,f,F){var g=r.Default.unionPoint(T,n);if(f&&i&&E){var R;"v"===F?(R=g.x+g.width/2,g.width=i*g.height/E,g.x=R-g.width/2):(R=g.y+g.height/2,g.height=E*g.width/i,g.y=R-g.height/2)}return g},Sr.prototype._adsorbedToClosest=function(o,k){var V=this,W=V._interactor,C=W.rectGuide.findClosest(o,k),L=W.gridGuide.findClosest(o,k),j=1/0,n=1/0;C&&(isFinite(C.x)&&(j=C.x),isFinite(C.y)&&(n=C.y)),L&&(isFinite(L.x)&&Math.abs(L.x)<Math.abs(j)&&(j=L.x),isFinite(L.y)&&Math.abs(L.y)<Math.abs(n)&&(n=L.y)),isFinite(j)&&(o.x+=j),isFinite(n)&&(o.y+=n)},Sr.prototype._42=function(x,E,A){var h=this;h.info={},h.screenInfo=null;var L=h._interactor;if(!L.editDetail&&h.gatherInfo(E,A)){var z=h.editing,v=z?z.groupRotateMode:null,n=h.screenInfo;if("block"!==v){if(n.P1?Ac.Icons.DrawIcon(L,x,Ac.Icons.Line,n):Ac.Icons.DrawIcon(L,x,Ac.Icons.Rect,n),n.connect&&(Ac.Icons.DrawIcon(L,x,Ac.Icons.ConnectGuide,{rotation:n.rotation,connect:n.connect,cursorPos:z?z.cursorPos:null}),z)){if(z.targetCorners){for(var N={x:1/0,y:1/0},o={x:-1/0,y:-1/0},Z=0,I=z.targetCorners.length;I>Z;Z+=2)N.x=Math.min(N.x,z.targetCorners[Z]),o.x=Math.max(o.x,z.targetCorners[Z]),N.y=Math.min(N.y,z.targetCorners[Z+1]),o.y=Math.max(o.y,z.targetCorners[Z+1]);Ac.Icons.DrawIcon(L,x,Ac.Icons.HoverDataRect,{min:N,max:o,color:L.getStyle("hoverGuideColor")||L.getStyle("baseColor")})}z.garbageInfo&&Ac.Icons.DrawIcon(L,x,Ac.Icons.ConnectGuideGarbage,z.garbageInfo)}h.tipInfo&&Ac.Icons.DrawIcon(L,x,Ac.Icons.TipHelper,h.tipInfo)}h.target instanceof Ac.Group&&h.target._42(L,x,E)}};var yp=Ac.Anchor=function(i){this.catalog="Anchor",this._interactor=i};yp.prototype={},yp.prototype.constructor=yp,yp.prototype.gatherInfo=function(c,M){var f=this;if(1===M.length){var K=M[0];if(!K.getAnchor)return;if(K instanceof r.Shape&&K._70I())return;if(Pn(K,c))return;return f.gatherSingleTarget(c,M[0])}return M.length>1?f.gatherMultiTargets(c,M):!1},yp.prototype.gatherSingleTarget=function(s,c){var y=this;return y.info.POS=c.getPosition(),y.screenInfo.POS=Ac.toScreenPosition(s,y.info.POS),y.target=c,!0},yp.prototype.gatherMultiTargets=function(x,d){var e=this,_=Ac.Group.findOrCreateGroup(d);return _?(e.screenInfo.POS=Ac.toScreenPosition(x,_.getAnchor2()),e.target=_,!0):!1},yp.prototype.isVisible=function(){var x=this,R=x._interactor;if(R.getStyle("anchorVisible")===!1)return!1;var r=x.target;if(r){if(this.editing)return!0;var X=r.getAnchor(),z=R.getStyle("anchorOutsideVisibleThreshold");if(X.x<-z||X.x>1+z||X.y<-z||X.y>1+z)return!0;var T=r.getSize(),u=r.getScale(),H=Math.min(Math.abs(T.width*u.x),Math.abs(T.height*u.y));if(H*R.gv._zoom<R.getStyle("anchorHideThreshold"))return!1}return!0},yp.prototype.check=function(f,F,S){if(r.Default.isLeftButton(F)){var z=this,M=z._interactor;if(z.isVisible()&&M.getStyle("anchorMovable")!==!1){z.editing=null,z.tipInfo=null;var K=z.target;if(K&&f.isAnchorEditable(K)&&f.isEditable(K)){var Y;if(z.screenInfo&&(Y=z.screenInfo.POS)&&Ac.checkHit(S,new Ac.Math.Vector2(Y),M.getStyle("checkSize"))){if(K instanceof Ac.Group)return z.editing={},!0;var l=K.getWidth(),k=K.getHeight(),R=K.getAnchor();return z.editing={rect:{x:-l*R.x,y:-k*R.y,width:l,height:k},anchor:R,matrix:K.getMatrix()},!0}}}}},yp.prototype.startEdit=function(n,E){n.startDragging(E),n.fi({kind:"beginEditAnchor",event:E})},yp.prototype._46O=function(D){var x=this;x.editing&&(x.editing=null,x._interactor.fi({kind:"endEditAnchor",event:D})),x.tipInfo=null},yp.prototype.handleEdit=function(P,V){var b=this,c=b.target;if(c){var Y=b.editing;if(Y){var B=P.lp(V),C=b._interactor;if(c instanceof Ac.Group)return c.setAnchor2(B),C._42(),void 0;var p=Y.matrix,t=p.tfi(B),D=Y.rect,n=(t.x-D.x)/D.width,Q=(t.y-D.y)/D.height;if(!r.Default.isCtrlDown(V)){var q=C.getStyle("anchorRound"),U=C.getStyle("anchorSensitivity");n=Ac.roundTo(n,q,U),Q=Ac.roundTo(Q,q,U)}c.setAnchor(n,Q,!0);var F=r.Default.getLogicalPoint(V,C._canvas);F.x+=Ac.Icons.TipShiftX,F.y+=Ac.Icons.TipShiftY;var M=""+n.toFixed(2)+", "+Q.toFixed(2);b.tipInfo={helperPos:F,text:M,size:M.length},C.fi({kind:"betweenEditAnchor",event:V})}}},yp.prototype._42=function(U,E,l){var V=this;V.info={},V.screenInfo={};var f=V._interactor;f.editDetail||V.gatherInfo(E,l)&&V.isVisible()&&(Ac.Icons.DrawIcon(f,U,Ac.Icons.Anchor,V.screenInfo),V.tipInfo&&Ac.Icons.DrawIcon(f,U,Ac.Icons.TipHelper,V.tipInfo))};var Or=Ac.MoveDummy=function(X){this.catalog="MoveDummy",this._interactor=X};Or.prototype={},Or.prototype.constructor=Or,Or.prototype.gatherInfo=function(){var x=this,N=this._interactor.getSubModule("Rect");if(N){var M=N.screenInfo;if(M){var _=x._interactor,Z=x.getMovableTarget(N.target);if(Z){var V=_.getStyle("moveDummyThreshold");if(V!==!1){var u=M.LT||M.P1,K=M.RT||M.P2,g=M.LB||u;if(u){var T=M.P1,f=Math.min(u.distanceTo(g),u.distanceTo(K));if(!(V!==!0&&f>V)){var r=_.getStyle("moveDummyPosition"),q=K.clone().sub(u),n=g.clone().sub(u),w=r[2],k=r[3];if(T){var p=_.getStyle("moveDummyLineExtraShift");p&&(w+=p[0],k+=p[1])}var B=u.clone().add(q.clone().multiplyScalar(r[0])).add(q.setLength(w)).add(n.clone().multiplyScalar(r[1])).add(n.setLength(k));return x.screenInfo.pos=B,x.screenInfo.size=_.getStyle("moveDummySensitivity"),!0}}}}}}},Or.prototype.getMovableTarget=function(e){var y=this._interactor.gv;if(gj(e)){if(y.isMovable(e))return e}else if(e instanceof Ac.Group)for(var O=e._entities,n=O.length-1;n>=0;n--){var X=O[n];if(gj(X)&&y.isMovable(X))return X}return null},Or.prototype.getMoveInteractor=function(){for(var Z,t,w,Q=this._interactor.gv,j=Q.getInteractors(),Z=0,t=j.length;t>Z;Z++)if(w=j.get(Z),w instanceof Ue)return w},Or.prototype.startEdit=function(b,p){b.startDragging(p);var O=this.getMoveInteractor();if(O){var L=this.selectedTarget,E=b.gv;E._moving=1,O._data=L,E.handleMouseDown&&E.handleMouseDown(p,L)}},Or.prototype._46O=function(p){var j=this,K=j.getMoveInteractor();K&&(K.handleWindowMouseUp(p),j.selectedTarget=null)},Or.prototype.handleEdit=function(k,Z){var $=this.getMoveInteractor();$&&$.handleWindowMouseMove(Z)},Or.prototype.check=function(b,Y,B){if(this.selectedTarget=null,r.Default.isLeftButton(Y)&&!b._scrolling&&!Sd()){var D=this;if(D.screenInfo){var f=D.screenInfo.pos;if(f&&!(B.distanceTo(f)>D.screenInfo.size)){var q=D._interactor;return D.selectedTarget=D.getMovableTarget(q.getSubModule("Rect").target),q.setCursor("default"),!0}}}},Or.prototype._42=function($,f,G){var P=this;P.screenInfo={};var N=P._interactor;N.editDetail||P.gatherInfo(f,G)&&(!N.editing||P.selectedTarget)&&Ac.Icons.DrawIcon(N,$,Ac.Icons.MoveDummy,P.screenInfo)};var Hr=Ac.RotateX=function(p){this.catalog="RotateX",this._interactor=p};Hr.prototype={},Hr.prototype.constructor=Hr,Hr.prototype.gatherInfo=function(n,C){var t=this;if(1===C.length){var o=C[0];return o instanceof r.Shape&&o._70I()||Pn(o,n)?!1:t.gatherSingleTarget(n,o)}return C.length>1?t.gatherMultiTargets(n,C):!1},Hr.prototype.gatherSingleTarget=function(){var K=new r.Math.Vector2,W=new r.Math.Vector2,o=new r.Math.Vector2,A=new r.Math.Vector2,U=function(X,Z){var H=X.x-Z.x,N=X.y-Z.y;return H*H+N*N};return function(J,Q){if(Q.getCorners){var B=this,c=Q.getCorners(),t=15,v=Q.getPosition();K.copy(c[0]),o.copy(c[1]),A.copy(c[3]),W.copy(K).add(A).divideScalar(2).add(K.sub(o).setLength(t/J.getZoom()));var P=Math.max(U(v,c[0]),U(v,c[1]),U(v,c[2]),U(v,c[3]));return B.info.POS=W.clone(),B.screenInfo.POS=Ac.toScreenPosition(J,B.info.POS),B.screenInfo.LEN=Math.sqrt(P)*J.getZoom()+t,B.screenInfo.CENTER=Ac.toScreenPosition(J,v),B.target=Q,!0}}}(),Hr.prototype.gatherMultiTargets=function(V,K){var c=this,W=Ac.Group.findOrCreateGroup(K);if(!W)return!1;var c=this;return c.gatherSingleTarget(V,W)},Hr.prototype.isVisible=function(){var y=this._interactor;if(!y.getStyle("rotateAsClock"))return!1;var P=this.target;if(!P)return!0;var d=y.gv;return d.isEditable(P)&&d.isRotationEditable(P)?!0:!1},Hr.prototype.check=function(E,B,X){var U=this,I=U._checkImpl(E,B,X);return(I||U._clockPainted)&&U._interactor._42(),I},Hr.prototype._checkImpl=function(z,K,u){if(r.Default.isLeftButton(K)){var j=this;j.editing=null,j.tipInfo=null;var o;if(j.screenInfo&&(o=j.screenInfo.POS)&&j.isVisible()){var S=j._interactor;if(Ac.checkHit(u,o,S.getStyle("checkSize"))){var e=j.target,D=z.lp(K),n=e.getPosition(),s=Math.atan2(D.y-n.y,D.x-n.x);return S._setRotateCursor(s),j.editing={pos:n,rotation:e.getRotation(),hitRot:s,groupRotateMode:"block",screenInfo:{CENTER:j.screenInfo.CENTER,LEN:j.screenInfo.LEN}},!0}}}},Hr.prototype.startEdit=function(E,h){E.startDragging(h),E.fi({kind:"beginEditRotation",event:h}),this.target instanceof Ac.Group&&this.target.beginRotate(this.editing)},Hr.prototype._46O=function(P){var Q=this;Q.editing&&(Q.editing=null,Q._interactor.fi({kind:"endEditRotation",event:P})),Q.target instanceof Ac.Group&&Q.target.endRotate(),Q.tipInfo=null},Hr.prototype.handleEdit=function(q,k){var g=this,W=g.editing;if(W){var b,P,o=g.target,T=q.lp(k),m=g._interactor,d=W.pos,R=Math.atan2(T.y-d.y,T.x-d.x),N=o instanceof Ac.Group;if(N?P=R-W.hitRot:(b=R-W.hitRot,P=W.rotation+b),P%=2*Math.PI,0>P&&(P+=2*Math.PI),!r.Default.isCtrlDown(k)){var Z,h;Kq(k)?(Z=m.getStyle("shiftRotateRound"),h=Z/2):(Z=m.getStyle("rotateRound"),h=m.getStyle("rotateSensitivity")),P=Ac.roundTo(P,Z,h)}N?(b=P-(W.lastRotation||0),0!==b&&(o.addRotation(b,W.groupRotateMode,function(i){return q.isRotationEditable(i)}),W.lastRotation=P)):o.setRotation(P),m._setRotateCursor(R),P>Math.PI&&(P-=2*Math.PI);var D=180*(P/Math.PI),Q=""+D.toFixed(2)+"",L=r.Default.getLogicalPoint(k,m._canvas);L.x+=Ac.Icons.TipShiftX,L.y+=Ac.Icons.TipShiftY,g.tipInfo={helperPos:L,text:Q,size:Q.length},m.fi({kind:"betweenEditRotation",event:k})}},Hr.prototype._42=function(I,r,e){var J=this;J._clockPainted=!1,J.info={},J.screenInfo={};var z=J._interactor;z.editDetail||J.gatherInfo(r,e)&&J.isVisible()&&(Ac.Icons.DrawIcon(z,I,Ac.Icons.RoundPoint,J.screenInfo.POS),J.tipInfo&&Ac.Icons.DrawIcon(z,I,Ac.Icons.TipHelper,J.tipInfo),J.editing&&J.drawClock(I))},Hr.prototype.drawClock=function(C){C.save();var p=this;p._clockPainted=!0;var k=p.editing||{},A=k.screenInfo||p.screenInfo,r=A.LEN,w=r+8,y=r+18;C.save(),C.translate(A.CENTER.x,A.CENTER.y),C.beginPath(),C.strokeStyle="rgb(150, 150, 150)";for(var j,_,O,B,m,h=0;360>h;h++)j=h*Math.PI/180,0===h%5&&(_=X(j)*r,O=U(j)*r,B=X(j)*w,m=U(j)*w,C.moveTo(_,O),C.lineTo(B,m)),0===h%45&&(_=X(j)*r,O=U(j)*r,B=X(j)*y,m=U(j)*y,C.moveTo(_,O),C.lineTo(B,m));C.stroke(),C.rotate(-L);var K=k.lastRotation||p.target.getRotation();C.beginPath(),C.fillStyle="rgba(255, 0, 0, 0.1)",C.strokeStyle="rgb(157, 157, 157)",C.moveTo(0,0),C.arc(0,0,y,0,K,!1),C.fill(),C.beginPath(),C.moveTo(0+y,0),C.arc(0,0,y,0,K,!1),C.stroke(),C.restore()};var Xj=Ac.Curve=function(q){this.catalog="Curve",this._interactor=q};Xj.prototype={},Xj.prototype.constructor=Xj,j.defineProperties(Xj.prototype,{activing:{get:function(){return this._activing},set:function(C){var a=this;if(C)a._activing=new Ac.CurveActiving(this,C);else{var B=a._activing;B&&B.dispose(),a._activing=null}}}}),Xj.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Xj.prototype.setUp=function(){var L=this,R=L._interactor;R&&R.gv.mp(L._onGraphviewPropertyChanged,L)},Xj.prototype._onGraphviewPropertyChanged=function(I){("zoom"===I.property||"translateX"===I.property||"translateY"===I.property)&&this._handleDataChanged()},Xj.prototype.tearDown=function(){var v=this,l=v._interactor;l&&l.gv.ump(v._onGraphviewPropertyChanged,v)},Xj.prototype.canEnterEditDetailMode=function(){var V=this,u=V._interactor,p=u._getValidSelection();if(1===p.length){var i=p[0],j=i instanceof r.Edge;if(i instanceof r.Shape||j){if(j){var t=i.s("edge.type");if(t&&"points"!==t)return}var Q=u.gv;if(Q.isPointEditable(i)&&Q.isEditable(i))return V.target=i,!0}}},Xj.prototype.canQuitEditDetailMode=function(d){var p=this,E=p._interactor._getLogicalPoint(d);return p._checkEditRealPoint(E)?void 0:p._interactor.gv.getDataAt(d)!==p.target?!0:void 0},Xj.prototype.preHandleScroll=function(){var Z=this.editing;return Z&&Z.inEdit?!0:void 0},Xj.prototype.getCurrentSelectintStatus=function(){var j=this;if(j.activing&&!j.activing.selections){if(j.activing.status!=s)return j.activing.status;var o=function(n){var k=j.activing.status;j.activing.status=n,j._interactor.fp("shapePointStatus",k,n)},d=Ac.Curve.PointType,U=j.activing.point,C=j.activing.pairs;if(!C||1!==C.length)return o(d.Mirrored);var r=C[0],K=r.c1&&r.c1.isNearEnough(U),W=r.c2&&r.c2.isNearEnough(U);if(!r.c1||!r.c2)return K||W?o(d.Straight):o(d.Disconnected);if(K&&W)return o(d.Straight);if(K||W)return o(d.Asymmetric);var H=r.c1.clone().sub(U),F=r.c2.clone().sub(U);return Math.abs(H.x*F.y-H.y*F.x)>1e-5||H.x*F.x>0?o(d.Disconnected):Math.abs(H.length()-F.length())>1e-5?o(d.Asymmetric):o(d.Mirrored)}},Xj.prototype.handle_keydown=function(S){var u=this;if(u._interactor.editDetail){var W=Ac.Curve.PointType;"1"===S.key?u._setCurrentSelectionStatus(W.Straight):"2"===S.key?u._setCurrentSelectionStatus(W.Mirrored):"3"===S.key?u._setCurrentSelectionStatus(W.Disconnected):"4"===S.key&&u._setCurrentSelectionStatus(W.Asymmetric)}},Xj.prototype.setCurrentSelectionStatus=function(g){var s=this,Z=s._interactor;if(Z){var P=Z.gv;P.dm().beginTransaction(),this._setCurrentSelectionStatus(g),P.dm().endTransaction()}},Xj.prototype._setCurrentSelectionStatus=function(A){var R=this,p=R.activing;if(p){var e=R.getCurrentSelectintStatus();if(null!==e&&e!==A){p.status=A;var x=R.activing.point,Z=R.activing.pairs;if(Z&&1===Z.length){var D=Z[0],l=R.screenInfo.curve,L=Ac.Curve.PointType,g=R._interactor,J=function(){R._writeToHt(),g.fp("shapePointStatus",e,A),R.check(g.gv,null,new Ac.Math.Vector2(g._lastLogicalPoint))};if(A===L.Straight)return l.moveCtrlPoint(D,x,"c1"),l.moveCtrlPoint(D,x,"c2"),J(),void 0;if(e===L.Straight){var d=l.findPairs(x,!0),j=d[0],W=j.r1||x,M=j.r2||x,u=M.clone().sub(W).multiplyScalar(.25);return l.moveCtrlPoint(D,x.clone().sub(u),"c1"),l.moveCtrlPoint(D,x.clone().add(u),"c2"),J(),void 0}var y=D.c1,C=D.c2;if(y&&C){if(A===L.Mirrored)return l.moveCtrlPoint(D,x.clone().multiplyScalar(2).sub(C),"c1"),J(),void 0;if(A===L.Asymmetric&&e===L.Disconnected){var T=y.clone().sub(x).length(),u=x.clone().sub(C).setLength(T).add(x);return l.moveCtrlPoint(D,u,"c1"),J(),void 0}}p._firePointChange(),g.fp("shapePointStatus",e,A),R.check(g.gv,null,new Ac.Math.Vector2(g._lastLogicalPoint))}}}},Xj.prototype._handleDataChanged=function(){var A="points,segments,shape,position,rotation,scale".split(",");return function(P){var p=this;if(p.screenInfo&&p.target){if(P&&A.indexOf(P.property)<0)return;var s=p._interactor;p.gatherSingleTarget(s.gv,p.target,!0),p.check(s.gv,null,new Ac.Math.Vector2(s._lastLogicalPoint)),s._42()}}}(),Xj.prototype.gatherSingleTarget=function(V,Z,N){var R,b,z=this;z.screenInfo&&z.screenInfo.curve&&(b=z.screenInfo.curve._curves);var S=z.editing;R=S?z.screenInfo:z.screenInfo={};var x,e,P=Z instanceof r.Edge;P?(x=Z.s("edge.segments"),e=Z.s("edge.points")||new r.List):(x=Z._58O,e=Z._59O),R.S=x;var y,A=R.P=[],v=Ac.getDataMatrix(Z);if(Z instanceof r.Polyline||Z instanceof r.Edge&&z._interactor.getStyle("edgeElevationEditable"))y=Z.getElevation&&Z.getElevation()||0,R.E=[];else{var E=!1;e.each(function(I){I.e!==s&&(E=!0)}),E&&(R.E=[])}if(e.each(function(O){R.E&&R.E.push(O.e||y),O=v.apply(O);var x=Ac.toScreenPosition(V,O);A.push(x.x,x.y)}),P){var B=A.length,h=Ac.toScreenPosition(V,Z._lastSourcePoint||(B?{x:A[0],y:A[1]}:{x:0,y:0})),D=Ac.toScreenPosition(V,Z._lastTargetPoint||(B?{x:A[B-2],y:A[B-1]}:{x:0,y:0}));A.splice(0,0,h.x,h.y),A.push(D.x,D.y),R.E&&(R.E.splice(0,0,"head"),R.E.push("tail"))}if(!R.S||!R.S.size()){R.S=new r.List,R.S.add(1);for(var C=0;C<A.length/2-1;C++)R.S.add(2)}if((!S||N)&&z.convertToCubicBezier(b),z.activing&&(N||!z.editing||"realPoint"===z.editing.type)){var m=R.curve.findPairs(z.activing.point);z.activing.pairs=m}P&&"points"!==Z.s("edge.type")&&z._writeToHt()},Xj.prototype._convertToNewPoint=function(U,Q,c,D){var o,C,b;for(o=0,C=Q.length;C>o;o++){if(b=Q[o],b._p1.isNearEnough(U)&&(!D||D.indexOf(b._p1)<0))return b._p1;if(b._p4.isNearEnough(U)&&(!D||D.indexOf(b._p4)<0))return b._p4}if(c)for(o=0,C=Math.min(c.length,C);C>o;o++){if(b=c[o],b._p1===U&&(!D||D.indexOf(Q[o]._p1)<0))return Q[o]._p1;if(b._p4===U&&(!D||D.indexOf(Q[o]._p4)<0))return Q[o]._p4}},Xj.prototype.convertToCubicBezier=function(g){var L,Y,$=this,r=new Ac.Math.Curve,p=$.screenInfo;if(r.createFromHtShape(p.P,p.S,p.E),p.curve=r,$.activing){var K=r._curves;L=$.activing.point,Y=$._convertToNewPoint(L,K,g);var V=[];if(Y&&($.activing.point=Y,V.push(Y)),$.activing.selections){var u=-1,e=$.activing.selections;e.forEach(function(N){u++,Y=$._convertToNewPoint(N,K,g,V),Y&&(e[u]=Y,V.push(Y))})}}},Xj.prototype.check=function(k,l,d){if(!l||pn(l)||wl(l)){var R=this;if(R._interactor.setCursor("default"),R.editing=null,R.highlight=null,R.tipInfo=null,R.edgeEditResult=null,R.screenInfo){if(Sd()||wl(l))return R._interactor._42(),!0;if(R._checkEditCtrlPoint(d))return R._interactor._42(),!0;if(R._checkEditRealPoint(d))return R._interactor._42(),!0;if(R._checkEditElevation(d))return R._interactor._42(),!0;var V=R.screenInfo.curve,G=V.checkPoint(d,R._interactor.getStyle("curveIntersectSize"));if(G){var X=R.highlight={};X.type="insertKnot",X.bezier=G.bezier,X.point=G.intersection}return R._interactor._42(),!0}}},Xj.prototype._checkEditRealPoint=function(m){var T,l,P,$,Q,i,a=this,g=a.screenInfo.curve._curves,u=a._interactor.getStyle("curvePointIntersectSize"),v=1/0;for(u*=u,P=0,$=g.length;$>P;P++)T=g[P],Q=T._p1,i=m.distanceToSquared(Q),v>i&&(v=i,l=Q),Q=T._p4,i=m.distanceToSquared(Q),v>i&&(v=i,l=Q);if(v>u)return!1;var Y=a.highlight={};return Y.type="changeRealPoint",Y.point=l,a.editing={type:"realPoint",point:l,shiftGuide:{point:l.clone(),dir:"x",limit:0}},a._interactor.setCursor("crosshair"),!0},Xj.prototype._checkEditElevation=function(U){var N=this;if(!N._interactor.getStyle("curveElevationVisible"))return!1;var D=N.activing;if(!D)return!1;var o=D.getCurrentEditingPoint();if(!o)return!1;var E=N._interactor,F=E.getStyle("curveElevationGuideShift"),Y=E.getStyle("curveElevationIntersectSize"),w=U.distanceToSquared({x:o.x+F[0],y:o.y+F[1]});if(!(w>Y*Y)){var V=N.highlight={};V.type="elevation";var q=new Ac.Math.Vector2(U.x,U.y,o.e);return N.editing={type:"elevation",startPoint:q},N._interactor.setCursor("crosshair"),!0}},Xj.prototype._checkEditCtrlPoint=function(T){var A=this;if(A.activing&&!A.activing.selections){var S=A.getCurrentSelectintStatus();if(S!==Ac.Curve.PointType.Straight){var C=A.activing.pairs;if(C){var i=A._interactor.getStyle("curvePointIntersectSize");i*=i;var O,Y,d,G,D,v,a,$,M,I=1/0;for(a=0,M=C.length;M>a;a++)for(G=C[a],$=0;2>$;$++)D=0===$?"c1":"c2",G[D]&&(v=T.distanceToSquared(G[D]),I>v&&(I=v,O=G,Y=a,d=D));if(I>i)return!1;A.activing.hlpair=O,A.activing.hltype=d;var k=A.highlight={};return k.type="changeCtrlPoint",k.point=O[d],A.editing={type:"ctrlPoint",pair:O,pairId:Y,ctrlType:d,direction:O[d].clone().sub(A.activing.point).normalize()},A._interactor.setCursor("crosshair"),!0}}}},Xj.prototype.startEdit=function(D,N){D.startDragging(N);var h=this;h.highlight&&"insertKnot"===h.highlight.type&&(h.insertKnot(),h.gatherSingleTarget(h._interactor.gv,h.target),h.activing=null,h._checkEditRealPoint(h._interactor._getLogicalPoint(N)));var E=h._activing;if(E){var u=h.editing?h.editing.type:null;"ctrlPoint"===u?E.editingCtrl={pairId:h.editing.pairId,type:E.hltype}:"realPoint"===u&&(E.editingCtrl=!1)}var d=h.highlight,t=r.Default.isCtrlDown(N);if(!d||Sd()||wl(N)){var S=h._interactor.gv;if(!S.setFocus(N)||S._scrolling)return;return t?h._multiSelect={startPoint:S.lp(N)}:S.isPannable()&&(pn(N)||wl(N))&&(h._pan={tx:S.tx(),ty:S.ty()},D.fi({kind:"beginPan",event:N})),void 0}if("changeRealPoint"===d.type){var J,R=h.activing?h.activing.point:null,A=h.activing?h.activing.selections:null;if(t&&h.activing)R===d.point?(A?(h.activing={point:A[0]},A.length>1&&(A.splice(0,1),h.activing.selections=A)):h.activing=null,h.editing=null):A&&(J=A.indexOf(d.point))>=0?(A.length>1?A.splice(J,1):delete h.activing.selections,h.editing=null):A?(A.push(R),h.activing={point:d.point,selections:A}):h.activing={point:d.point,selections:[R]};else if(A)R===d.point||((J=A.indexOf(d.point))>=0?(A.splice(J,1,R),h.activing={point:d.point,selections:A}):h.activing={point:d.point});else{var U;R===d.point&&(U=h.activing.status),h.activing={point:d.point},U&&(h.activing.status=U)}D.fi({kind:"beginEditPoint",event:N})}},Xj.prototype.insertKnot=function(){var j=this,u=j.highlight,O=j.screenInfo.curve;O.insertKnot(u.bezier,u.point.t),j._writeToHt()},Xj.prototype._writeToHt=function(){var Z,G,b,H,J=this,j=J.screenInfo.curve,n=j.toHtShape(),W=n.points,m=[],K=n.segments,d=J._interactor.gv,e=J.target,k=e instanceof r.Edge,F=Ac.getDataMatrix(e).invert();H=e instanceof r.Polyline||e instanceof r.Edge&&J._interactor.getStyle("edgeElevationEditable"),H&&(b=e.getElevation&&e.getElevation()||0);for(var A=0,f=W.length;f>A;A++)Z=W[A],G=Ac.toWorldPosition(d,Z),G=F.apply(G),Z.e!=s&&Z.e!==b&&(G.e=Z.e),m.push(G);if(e._writing=!0,k){e.s("edge.type","points"),e.setStyle("edge.segments",K),e.setStyle("edge.points",m.slice(1,m.length-1)),e.setStyle("edge.source.offset.x",0),e.setStyle("edge.source.offset.y",0),e.setStyle("edge.target.offset.x",0),e.setStyle("edge.target.offset.y",0);var h=J._nextChangeEdgeHost;delete J._nextChangeEdgeHost,h&&("source"===h.type?e.setSource(h.host):e.setTarget(h.host)),J._writeEdgeHostAnchor("source",m[0]),J._writeEdgeHostAnchor("target",m[m.length-1])}else m.length?(e.setSegments(K),e.setPoints(m,!0)):e.removeFromDataModel();delete e._writing},Xj.prototype._writeEdgeHostAnchor=function(j,r){var z=this,N=z.target,e=z._calcHostAnchor(N,j,r);e.index!==s?(N.setStyle("edge."+j+".index",e.index),N.setStyle("edge."+j+".percent",s),N.setStyle("edge."+j+".anchor.x",s),N.setStyle("edge."+j+".anchor.y",s)):e.percent!==s?(N.setStyle("edge."+j+".percent",e.percent),N.setStyle("edge."+j+".index",s),N.setStyle("edge."+j+".anchor.x",s),N.setStyle("edge."+j+".anchor.y",s)):(N.s("edge."+j+".anchor.x",e.x),N.s("edge."+j+".anchor.y",e.y),e.offsetX||e.offsetY?(N.s("edge."+j+".offset.x",e.offsetX),N.s("edge."+j+".offset.y",e.offsetY)):(N.s("edge."+j+".offset.x",0),N.s("edge."+j+".offset.y",0)))},Xj.prototype._calcHostAnchor=function(E,i,F,u){u||(u="source"===i?E.getSource():E.getTarget());var e=this._interactor.gv,x=e.calculateAttachPoint(u,F);if(x)return x.info;if(Cc(u)){var b=e.calculateEdgePosition(u,F);return b}var H=u.getRotation(),q=u.getAnchor();Pn(u,e)&&(H=0);var r=u.getScale();if(H||r.x<0||r.y<0){var s=u.getMatrix(),L=s.tfi(F),J=u.getSize();return{x:L.x/J.width+q.x,y:L.y/J.height+q.y}}var o=zk(e,u),X={x:(F.x-o.x)/o.width,y:(F.y-o.y)/o.height};return X},Xj.prototype._handlePanning=function(M){var W=this,G=W._pan;if(G){G.started=!0;var d=W._interactor,x=d.gv,q=d._lastClientPoint,Z=Mi(M),m=jc(x,Z,q);x.setTranslate(G.tx+m.x,G.ty+m.y),W.gatherSingleTarget(d.gv,W.target),d._42(),d.fi({kind:"betweenPan",event:M})}},Xj.prototype.handleEdit=function(P,U){var d=this,J=d.editing;if(d._pan)return d._handlePanning(U),void 0;if(d._multiSelect)return d._multiSelect.endPoint=P.lp(U),d._interactor.redraw(),void 0;if(J){J.inEdit=!0;var T,G,M,O=d._interactor._getLogicalPoint(U),B=r.Default.isCtrlDown(U),e=r.Default.isShiftDown(U),C=J.type,K=d.activing;if(d._guideInfo=null,"ctrlPoint"===C&&e){var N=d.editing.direction.clone();T=K.point;var A=N.dot(O.clone().sub(T));O=N.setLength(A).add(T)}else if("ctrlPoint"===C||"realPoint"===C){var N;if("realPoint"===C&&e){var W=d.editing.shiftGuide;G=W.point;var w=Math.abs(O.x-G.x),L=Math.abs(O.y-G.y);w>L&&w>W.limit&&"y"===W.dir&&(W.dir="x"),L>w&&L>W.limit&&"x"===W.dir&&(W.dir="y"),N=W.dir,"x"===N?(O.y=G.y,W.limit=Math.max(W.limit,w)):"y"===N&&(O.x=G.x,W.limit=Math.max(W.limit,L))}var z=d._isEditEdgeSourceTarget();if(z){var F=d._editEdgeSourceTarget(z,O,B);F&&(d.edgeEditResult=F,M=F.tipText)}else if(!B){var Z=d._guidingToEdit(O,N),$="realPoint"===C?d._interactor.gridGuide.findClosest(O,N,!0):null,l=1/0,f=1/0;$&&($.x&&(l=$.x),$.y&&(f=$.y));var V=!1;Z&&(Z.xList&&(Math.abs(Z.x)<=Math.abs(l)?(V=!0,l=Z.x):delete Z.xList),Z.yList&&(Math.abs(Z.y)<=Math.abs(f)?(V=!0,f=Z.y):delete Z.yList),V&&(d._guideInfo=Z)),isFinite(l)&&(O.x+=l),isFinite(f)&&(O.y+=f),V&&(Z.v=O)}}var X=d.screenInfo.curve;if("realPoint"===J.type){T=J.point,T.e!==s&&(O.e=T.e),X.moveRealPoint(T,O),J.point=O,d.highlight.point=O;var n=K.status,o=K.selections;if(d.activing={point:O,status:n},o){var H=O.clone().sub(T),D=0;o.forEach(function(c){var t=c.clone().add(H);X.moveRealPoint(c,t),o[D++]=t}),d.activing.selections=o}}else if("ctrlPoint"===J.type){var b=K.pairs,k=b[J.pairId];X.moveCtrlPoint(k,O,J.ctrlType);var h=K.status,S=Ac.Curve.PointType;if((h===S.Mirrored||h===S.Asymmetric)&&k.c1&&k.c2){var T=new Ac.Math.Vector2(K.point),E="c1"===J.ctrlType?"c2":"c1";if(h===Ac.Curve.PointType.Mirrored)X.moveCtrlPoint(k,T.clone().multiplyScalar(2).sub(O),E);else if(h===S.Asymmetric){var A=k[E].clone().sub(T).length(),I=T.clone().sub(k[J.ctrlType]).setLength(A).add(T);isNaN(I.x)||X.moveCtrlPoint(k,I,E)}}K._firePointChange()}else if("elevation"===J.type){G=J.startPoint;var j=G.e+(G.y-O.y)/P._zoom;d._setCurrentPointImpl("e",j),K._firePointChange(),M="E: "+Ac.toFixed(j)}var Q=r.Default.getLogicalPoint(U,d._interactor._canvas);if(Q.x+=Ac.Icons.TipShiftX,Q.y+=Ac.Icons.TipShiftY,!M){var u=Ac.toWorldPosition(P,O);M=""+Ac.toFixed(u.x)+", "+Ac.toFixed(u.y)}d.tipInfo={helperPos:Q,text:M,size:M.length},d._writeToHt(),d._interactor.fi({kind:"betweenEditPoint",event:U})}},Xj.prototype._setCurrentPointImpl=function(C,N){var G=this,R=G._activing;if(!R)return!1;var b=G.target;if(!b)return!1;var B=R.getCurrentEditingPoint();if(!B)return!1;var j=R.editingCtrl;if(!j)var E=B.clone();if("e"===C)B.e=N;else{var t;if("x"===C||"y"===C){var P=R._lastFirePoint;t="x"===C?{x:N,y:P?P.y:0}:{x:P?P.x:0,y:N}}else"object"==typeof C?(t=C,C.e!==s&&(B.e=C.e)):(t={x:arguments[0],y:arguments[1]},arguments[2]!==s&&(B.e=arguments[2]));var y=Ac.getDataMatrix(b);t=Ac.toScreenPosition(G._interactor.gv,y.apply(t)),B.x=t.x,B.y=t.y}if(!j){var p=E.multiplyScalar(-1).add(B);B.e&&E.e&&(p.e=B.e-E.e),G.screenInfo.curve.moveCtrlDueToRealPointMovement(B,p)}return!0},Xj.prototype.setCurrentPoint=function(Q,L){return this._setCurrentPointImpl(Q,L)?(this._writeToHt(),!0):!1},Xj.prototype._isEditEdgeSourceTarget=function(){var $=this,t=$.target;if(!(t instanceof r.Edge))return!1;var M=$.editing.point,K=$.screenInfo.curve._curves;return M===K[0]._p1?"source":M===K[K.length-1]._p4?"target":!1},Xj.prototype._editEdgeSourceTarget=function(O,L,U){var o,u=this,t=u.target;if(o="source"===O?t.getSource():t.getTarget()){var D,v=u._interactor.gv,P=Ac.toWorldPosition(v,L),x=u._calcHostAnchor(t,O,P,o);if(D=x.index!==s||x.percent!==s?x.distance*v.getZoom()>u._interactor.getStyle("edgeHostEdgeMaxDistance"):u._interactor.getStyle("edgeHostDetectPerFrame")?!0:x.x<0||x.x>1||x.y<0||x.y>1?!0:!1){var Z=v.getDataAt(P,function(g){return v.isSelectable(g)?v.isSourceTargetEditable(t,g,O)?t.canSetSourceTarget(g,O)?!0:!1:!1:!1});if(Z){var e=u._calcHostAnchor(t,O,P,Z);o=Z,u._nextChangeEdgeHost={type:O,host:Z},x=e}}var R,l,T;if(U||x.x===s)(x.percent!==s||x.index!==s)&&(l=x.point);else{var y=u._interactor.getStyle("anchorRound"),Q=u._interactor.getStyle("anchorSensitivity");R=v.calculateAttachPoint(o,P),R?x=R.info:(x.x=Ac.roundTo(x.x,y,Q),x.y=Ac.roundTo(x.y,y,Q)),l=os(v,o,0,x.offsetX||0,x.offsetY||0,x.x,x.y)}l&&(T=Ac.toScreenPosition(v,l),L.x=T.x,L.y=T.y),u._edgeHostGuideInfo={corners:Ac.getTargetCornersOnScreen(v,o),attach:R?R.index:-1,host:o};var I;return x.percent!==s?I="percent: "+x.percent.toFixed(2):x.index!==s?I="index: "+x.index:(I=""+x.x.toFixed(2)+", "+x.y.toFixed(2),(x.offsetX||x.offsetY)&&(I+=" offset: "+x.offsetX.toFixed(2)+", "+x.offsetY.toFixed(2))),{host:o,anchor:x,tipText:I}}},Xj.prototype._guidingToEdit=function(q,p){var A,H,B=this;if(A=B.screenInfo.curve){H=A._curves;var x,y,V,F,n,D,T,j,w=1/0,O=1/0,k=[];for(B.editing&&"realPoint"===B.editing.type&&(j=B.editing.point),n=0,D=2*H.length;D>n;n++)T=H[Math.floor(n/2)][n%2?"_p4":"_p1"],k.indexOf(T)>=0||(k.push(T),j&&j===T||(V=T.x-q.x,F=T.y-q.y,Math.abs(V)<Math.abs(w)?(w=V,x=[T]):V===w&&x.push(T),Math.abs(F)<Math.abs(O)?(O=F,y=[T]):F===O&&y.push(T)));var E=B._interactor.getStyle("smartGuideThreshold");if((Math.abs(w)>E||"y"===p)&&(x=null),(Math.abs(O)>E||"x"===p)&&(y=null),x||y){var $=!1,e={};
if(x&&($=!0,e.xList=x,e.x=w),y&&($=!0,e.yList=y,e.y=O),$)return e}}},Xj.prototype._46O=function(X){var V=this;V.editing&&(V.editing=null,V._interactor.fi({kind:"endEditPoint",event:X})),V._guideInfo=null,V._edgeHostGuideInfo=null,V._pan&&(V._pan=null,V._interactor.fi({kind:"endPan",event:X})),V._multiSelect&&(V._handleMultiSelect(V._multiSelect),V._multiSelect=null),V.tipInfo=null,V.edgeEditResult=null},Xj.prototype._handleMultiSelect=function(u){if(u.startPoint&&u.endPoint){var g,k,v,o,B,H=this,V=H._interactor,y=V.gv,A=Ac.toScreenPosition(y,u.startPoint),S=Ac.toScreenPosition(y,u.endPoint),P=r.Default.unionPoint(A,S),p=H.screenInfo.curve._curves,t=[],D=function(i){i.x>=P.x&&i.y>=P.y&&i.x<=P.x+P.width&&i.y<=P.y+P.height&&t.indexOf(i)<0&&t.push(i)};for(g=0,k=p.length;k>g;g++)B=p[g],D(B._p1),D(B._p4);if(t.length){var Z=H.activing||{},L=Z.selections||[];for(Z.point&&L.push(Z.point),g=0,k=L.length;k>g;g++)v=L[g],o=t.indexOf(v),o>=0?t[o]=s:t.push(v);var J=t;for(t=[],g=0,k=J.length;k>g;g++)J[g]&&t.push(J[g]);k=t.length,0===k?H.activing=null:1===k?H.activing={point:t[0]}:(v=t[k-1],H.activing={point:v,selections:t.splice(0,k-1)}),V.redraw()}}},Xj.prototype._canDeletePoint=function(U,M){var Q=this.target;if(!(Q instanceof r.Edge))return!0;var y=U._curves[0],K=U._curves[U._curves.length-1];return y._p1===M||K._p4===M?!1:!0},Xj.prototype.handleDelete=function(){var S=this;if(S.activing&&S.screenInfo){var C=r.Default.isShiftDown(),Y=S.screenInfo.curve;S._canDeletePoint(Y,S.activing.point)&&Y.deleteRealPoint(S.activing.point,C),S.activing.selections&&S.activing.selections.forEach(function(G){S._canDeletePoint(Y,G)&&Y.deleteRealPoint(G,C)}),S.activing=null,delete S.editing,delete S.tipInfo,delete S.edgeEditResult,delete S._pan,delete S._multiSelect,S._writeToHt(),S._interactor.fp("deleteShapePoint",!1,!0)}},Xj.prototype.handleDoubleClick=function(b){var R=this,S=R._interactor._getLogicalPoint(b);if(R.screenInfo&&R._checkEditRealPoint(S)){var r=R.getCurrentSelectintStatus(),c=Ac.Curve.PointType;return r=r===c.Mirrored?c.Straight:c.Mirrored,R._setCurrentSelectionStatus(r),R._interactor._42(),!0}},Xj.prototype._drawHighlight=function(H){var f=this,A=f.highlight;if(A){var S=A.bezier,$=f._interactor;S&&Ac.Icons.DrawIcon($,H,Ac.Icons.ShapeHighlightCurve,[S._p1.x,S._p1.y,S._p2.x,S._p2.y,S._p3.x,S._p3.y,S._p4.x,S._p4.y]);var M=A.point;M&&"insertKnot"===A.type&&Ac.Icons.DrawIcon($,H,Ac.Icons.ShapeHighlighPoint,M)}},Xj.prototype._drawGuide=function(i){var o=this,C=o._guideInfo;if(C){var I,M,g,q,K=C.v;for(I=0;2>I;I++)if(q=0===I?C.xList:C.yList)for(M=0,g=q.length;g>M;M++)Ac.Icons.DrawIcon(o._interactor,i,Ac.Icons.ShapeGuideLine,[K.x,K.y,q[M].x,q[M].y])}},Xj.prototype._drawCurrentPoint=function(b){var F=this;if(F.activing){var v=F.activing,g=F.getCurrentSelectintStatus(),I=F._interactor;if(g!==Ac.Curve.PointType.Straight){var x=v.pairs;v.hlpair,v.hltype;var z=v.selections,R=v.editingCtrl;if(x&&!z){var n,U,q;for(U=0,q=x.length;q>U;U++)n=x[U],R&&U===R.pairId&&n[R.type]?Ac.Icons.DrawIcon(I,b,Ac.Icons.ShapeActivingCtrl,{point:n.point,c1:n.c1,c2:n.c2,hl:R.type}):Ac.Icons.DrawIcon(I,b,Ac.Icons.ShapeActivingCtrl,n)}}Ac.Icons.DrawIcon(I,b,Ac.Icons.ShapeHighlighRealPoint,F.activing.point),z&&z.forEach(function(X){Ac.Icons.DrawIcon(I,b,Ac.Icons.ShapeHighlighRealPoint,X)})}},Xj.prototype.clear=function(){var o=this;o.editing=null,o._guideInfo=null,o.activing=null,o.highlight=null},Xj.prototype._42=function(G){var T=this;T.info={},T.editing||(T.screenInfo=null);var D=T._interactor;if(!D.editDetail)return T.clear(),void 0;var y=D.gv;if(!T.target||!y.isSelected(T.target)||!y.isVisible(T.target))return D.editDetail=!1,T.clear(),void 0;if(T.gatherSingleTarget(y,T.target),Ac.Icons.DrawIcon(D,G,Ac.Icons.ShapeBgCurve,T.screenInfo),T._drawHighlight(G),T._drawCurrentPoint(G),T._getRealPoint().forEach(function(f){Ac.Icons.DrawIcon(D,G,Ac.Icons.ShapePoint,f)}),T._drawGuide(G),T.tipInfo&&Ac.Icons.DrawIcon(D,G,Ac.Icons.TipHelper,T.tipInfo),T._edgeHostGuideInfo){Ac.Icons.DrawIcon(D,G,Ac.Icons.NodeHoverGuide,T._edgeHostGuideInfo.corners);var x=T._edgeHostGuideInfo.host;if(x){var m=y.getAttachPoints(x);if(m&&m.length)for(var d=0,u=m.length;u>d;d++){var K=m[d],i=os(y,x,0,K.offsetX||0,K.offsetY||0,K.x,K.y);i=Ac.toScreenPosition(y,i),i.isAttach=T._edgeHostGuideInfo.attach===d,Ac.Icons.DrawIcon(D,G,Ac.Icons.AttachPoint,i)}}}if(T._interactor.getStyle("curveElevationVisible")&&(T.target instanceof r.Polyline||T.target instanceof r.Edge&&T._interactor.getStyle("edgeElevationEditable"))&&T.activing){var J=T.activing.getCurrentEditingPoint();J&&"string"!=typeof J.e&&Ac.Icons.DrawIcon(D,G,Ac.Icons.EdgeElevationGuide,J)}if(T.edgeEditResult&&T._drawEdgeHostHighlight(G,T.edgeEditResult.host,T.edgeEditResult.anchor),T._multiSelect&&T._multiSelect.endPoint){var H=r.Default.unionPoint(Ac.toScreenPosition(y,T._multiSelect.startPoint),Ac.toScreenPosition(y,T._multiSelect.endPoint));H.color=y.getRectSelectBorderColor(),G.save(),G.setTransform(1,0,0,1,0,0);var U=F.devicePixelRatio,S=H.borderWidth=Math.round(U);S/=2,H.x=Math.round(H.x*U)+S,H.y=Math.round(H.y*U)+S,H.width=Math.round(H.width*U),H.height=Math.round(H.height*U),Ac.Icons.DrawIcon(D,G,Ac.Icons.SimpleRect,H),G.restore()}},Xj.prototype._drawEdgeHostHighlight=function(G,h,e){this.drawEdgeHostHighlight(G,h,e),this._interactor.redraw()},Xj.prototype.drawEdgeHostHighlight=function(c,j,_){if(Cc(j)){var p,z,Z,u,q=this,e=q._interactor,W=e.gv,v=W.getDataUI(j),C=Rh(v),y=[];for(Z=0,u=C.points.length;u>Z;Z++)z=Ac.toScreenPosition(W,C.points.get(Z)),y.push(z.x,z.y);C.segments&&(p=C.segments.toArray());var i=e.getStyle("edgeHostHighlighPeriod"),L=e.getStyle("edgeHostEdgeHighlighColor");Ac.Icons.DrawIcon(e,c,Ac.Icons.ShapeBgCurve,{P:y,S:p,color:L,dynamicVisible:_.index===s,dynamicPeriod:i}),L=e.getStyle("edgeHostPointHighlighColor");var S=Yj(v);for(Z=0,u=S.length;u>Z;Z++){var K=S[Z],f=Ac.toScreenPosition(W,K);Ac.Icons.DrawIcon(e,c,Ac.Icons.ShapePoint,{point:{x:f.x,y:f.y},color:L,size:12,dynamicVisible:Z===_.index,dynamicPeriod:i})}}},Xj.prototype._getRealPoint=function(){var y,e=this.screenInfo,m=e.P,W=e.S,T=-1,D=[],Y=-1,p=W.length;return W.each(function(E){Y++;var a=1;if(3===E)a=2;else if(4===E)a=3;else if(5===E)return;T+=a,y=Y+1>=p?!0:1===W.get(Y+1)?!0:!1,D.push({point:{x:m[2*T],y:m[2*T+1]},segmentIndex:Y,pointIndex:T,isEnd:y})}),D},Xj.prototype.getEditingPointsInfo=function(D){var c=this,I=c.activing;if(!I)return!1;var g=I.point;if(!g)return!1;var k=this._getRealPoint(),Q=[{screen:g}];I.selections&&I.selections.forEach(function(w){Q.push({screen:w})});var U,_,u=k.length;return Q.forEach(function(E){for(U=0;u>U;U++)if(_=k[U],E.screen.isNearEnough(_.point)){E.segmentIndex=_.segmentIndex,E.pointIndex=_.pointIndex,E.point=c.target.getPoints().get(_.pointIndex);break}}),D&&Q.sort(function(o,t){return o.segmentIndex-t.segmentIndex}),Q};var Qf=Ac.MoveHelper=function(J){var O=this;O.catalog="Move",O._interactor=J};Qf.prototype={},Qf.prototype.constructor=Qf,Qf.prototype.calcShift=function(A,$,w){var F,D,x=this,V=x._interactor.gv,B=V.lp($);if("beginMove"===A&&x._gatherGridInfo(w._lastLogicalPoint||B),F=x._target){var _=F.downPosition;if(_){var a=x._interactor.getStyle("moveSensitivity")/V._zoom;if(_.distanceTo(B)<a)return{x:0,y:0};delete F.downPosition}var M;D=r.Default.isShiftDown($),D&&(B=x._dealShiftDown(B),M=F.shiftGuide.dir);var n,J=F.rawPos={x:F.pos.x+B.x-F.lp.x,y:F.pos.y+B.y-F.lp.y};if(r.Default.isCtrlDown($)){if(n=x._calcShiftByAddon(),x._target.node instanceof Ac.Group){var f=x._target.node;f._position.x+=n.x,f._position.y+=n.y}return n}for(var R,Z=F.x+J.x,W=F.y+J.y,S={x:Z,y:W},g={x:Z+F.w/2,y:W+F.h/2},o={x:Z+F.w,y:W+F.h},c=x._interactor.rectGuide,k=x._interactor.gridGuide,C=[c.findClosest(S,M),c.findClosest(g,M),c.findClosest(o,M),k.findClosest(S,M),k.findClosest(g,M),k.findClosest(o,M)],U=1/0,G=1/0,X=0,E=C.length;E>X;X++)R=C[X],R&&(Z=R.x,W=R.y,isFinite(Z)&&Math.abs(Z)<Math.abs(U)&&(U=Z),isFinite(W)&&Math.abs(W)<Math.abs(G)&&(G=W));if(isFinite(U)||(U=0),isFinite(G)||(G=0),n=x._calcShiftByAddon(U,G),x._target.node instanceof Ac.Group){var f=x._target.node;f._position.x+=n.x,f._position.y+=n.y}var I=F.node;if(!Pn(I,V)){var j=J.x+U,p=J.y+G;x._interactor.rectGuide.gatherLines({node:I,x:F.x+j,y:F.y+p,w:F.w,h:F.h},M)}return n}},Qf.prototype._calcShiftByAddon=function(u,V){var g=this._target,A=g.rawPos,m=g.node.getPosition();return u=u||0,V=V||0,{x:A.x-m.x+u,y:A.y-m.y+V}},Qf.prototype._dealShiftDown=function(K){var f=this,n=f._target.shiftGuide,D=f._target.lp,$=Math.abs(K.x-D.x),w=Math.abs(K.y-D.y);$>w&&$>n.limit&&"y"===n.dir&&(n.dir="x"),w>$&&w>n.limit&&"x"===n.dir&&(n.dir="y");var v=n.dir;return"x"===v?(K.y=D.y,n.limit=Math.max(n.limit,$)):"y"===v&&(K.x=D.x,n.limit=Math.max(n.limit,w)),K},Qf.prototype._gatherGridInfo=function(D){var b,E=this,i=E._interactor,F=i._getValidSelection();if(F.length){if(1===F.length){if(b=F[0],!b.getRect)return E._target=null,void 0}else if(b=Ac.Group.findOrCreateGroup(F),!b)return E._target=null,void 0}else{var F=i.gv.sm().getSelection();if(F.length&&(b=F.get(0),!b.getRect))return E._target=null,void 0}var a=b.getPosition(),h=b.getRect();E._target={node:b,x:h.x-a.x,y:h.y-a.y,w:h.width,h:h.height,lp:{x:D.x,y:D.y},pos:{x:a.x,y:a.y},shiftGuide:{dir:"x",limit:0},downPosition:new Ac.Math.Vector2(D)},i.rectGuide.gatherRects()},Qf.prototype.clear=function(){var r=this;r._interactor.rectGuide.clear(),r._interactor._42()};var Hp="directional",jn="point",Ni="spot",Io="light.color",Ko={},or=function(x,J){un(J)&&cp.test(J)?Bi(x,J):zo(J)&&J.modelType?ye(x,J):Kc[x]=J},Km=function(W){return W},Gm=function(h){h=z.convertShape3dModelName(h);var E;if(zo(h)){if(h.modelType){if(h.uuid){if(E=Kc[h.uuid])return E}else h.uuid=r.Math.generateUUID();return ye(h.uuid,h),s}return h}return E=Kc[h],h&&E===s&&cp.test(h)&&(ek&&ek[h]||Bi(h,h)),E},hl=function(d,Z){d.frameStack?d.frameStack.push(Z):d.frameStack=[Z],d.bindFramebuffer(d.FRAMEBUFFER,Z)},Ln=function(R){var H=R.frameStack;if(H){if(H.pop(),H.length)return R.bindFramebuffer(R.FRAMEBUFFER,H[H.length-1]),void 0;R.frameStack=null}R.bindFramebuffer(R.FRAMEBUFFER,null)};Ej(z,{graph3dViewAttributes:i,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:J/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Dc,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewMaxPhi:J,graph3dViewMinPhi:0,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:J/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,setShape3dModel:or,getShape3dModel:Gm,convertShape3dModelName:Km,getShape3dModelMap:function(){return Kc},getCachedShape3dModelMap:function(){return ls},createMatrix:function(F,i){Qb(F)||(F=[F]);for(var S=F.length-1;S>=0;S--){var Z=F[S];i=gg(Z.mat,Z.s3,Z.r3,Z.rotationMode,Z.t3,i)}return i},transformVec:function(v,Q){return pq(v,Q)},glBindFrame:hl,glUnbindFrame:Ln,createBoxModel:function(){return{vs:Df,ns:Ed,uv:Jl,is:Ar}},createRoundRectModel:function(_,W){return rj.roundRect(_,W)},createStarModel:function(s,w){return rj.star(s,w)},createRectModel:function(m,r){return rj.rect(m,r)},createTriangleModel:function(p,F){return rj.triangle(p,F)},createRightTriangleModel:function(y,X){return rj.rightTriangle(y,X)},createParallelogramModel:function(J,I){return rj.parallelogram(J,I)},createTrapezoidModel:function(m,R){return rj.trapezoid(m,R)},createSmoothSphereModel:function(k,p,G,s,R,h,l){return Cp(new ps(k,p,G,s,R,h,l))},createSphereModel:function(A,q,F,k,b,a,$){return A?Gb(A,q,F,k,b,a,$):z.createSmoothSphereModel()},createSmoothConeModel:function(u,o,r,F,J){return Jd(u,o,r,F,J)},createConeModel:function(E,p,P,G,y,Q){return E?Gj(E,p,P,G,y,Q):Jd(Q)},createSmoothCylinderModel:function(m,I,W,w,F,G,N,s){return Cp(new qo(m,I,W,w,F,G,N,s))},createCylinderModel:function($,c,R,J,w,u,O,g){return $?pd($,c,R,J,w,u,O,g):wm(u,O)},createSmoothTorusModel:function(L,a,V,i,I,B){return Cp(new $n(L,a,V,i,I,B))},createTorusModel:function(b,M,D,P,a,K,d,J){return b?Jp(b,M,D,P,a,K,d,J):Dq(K,d)},createExtrusionModel:function(U,j,r,f,E,J,W,Q){return Mf(U,j,r,f,E,J,W,Q)},createSmoothRingModel:function(z,m,U,G,i,f){for(var j=[],w=0;w<z.length-1;w+=2)j.push({x:z[w],y:z[w+1]});for(z=Wg(j,m,U)[0],j=[],w=0;w<z.length;w++){var E=z[w];j.push(new es(E.x,0,E.y))}return Cp(new to(j,f,G,i))},createTextGeometry:function(e,W){return Cp(new no(e,W))},loadFontFace:function(D,p){z.xhrLoad(D,function(K){if(!K)return p();var S;try{S=JSON.parse(K)}catch(F){S=JSON.parse(K.substring(65,K.length-2))}pf.loadFace(S),p&&p(S.familyName.toLowerCase())},p?null:{sync:!0})},createRingModel:function(v,F,y,P,K,o,f,q,W,Q){for(var r=[],w=0;w<v.length-1;w+=2)r.push({x:v[w],y:v[w+1]});o=o||z.shapeSide,f=f||0,q=q||o;var s,l,E,L,J,D,j,Y,m,a,w,c,A,C,x,g,G,M,S=[],T=[],$=W?[]:i,d=W?[]:i,n=Q?[]:i,N=Q?[]:i,Z=P?[]:i,b=P?[]:i,h=K?[]:i,O=K?[]:i,v=Wg(r,F,y),t=Fe(v),R=0,H=2*Math.PI/o;return v.forEach(function(_){if(E=_.length,E>1){if(L=_[0],P)for(D=L.x,Y=L.y,w=f;q>w;w++)c=w+1,A=w*H,C=c*H,x=X(A),g=U(A),G=X(C),M=U(C),Z.push(x*D,Y,-g*D,G*D,Y,-M*D,0,Y,0),b.push(.5-.5*x,.5-.5*g,.5-.5*G,.5-.5*M,.5,.5);for(a=0;E>a;a++){for(J=_[a],D=L.x,j=J.x,Y=L.y,m=J.y,s=R/t,R+=_m(L,J),l=R/t,w=f;q>w;w++)c=w+1,A=w*H,C=c*H,x=X(A),g=U(A),G=X(C),M=U(C),S.push(x*j,m,-g*j,G*j,m,-M*j,x*D,Y,-g*D,G*j,m,-M*j,G*D,Y,-M*D,x*D,Y,-g*D),T.push(w/o,l,c/o,l,w/o,s,c/o,l,c/o,s,w/o,s),W&&w===f&&($.push(0,Y,0,0,m,0,x*j,m,-g*j,x*j,m,-g*j,x*D,Y,-g*D,0,Y,0),d.push(0,.5-Y,0,.5-m,2*j,.5-m,2*j,.5-m,2*D,.5-Y,0,.5-Y)),Q&&c===q&&(n.push(0,Y,0,G*j,m,-M*j,0,m,0,G*j,m,-M*j,0,Y,0,G*D,Y,-M*D),N.push(1,.5-Y,1-2*j,.5-m,1,.5-m,1-2*j,.5-m,1,.5-Y,1-2*D,.5-Y));L=J}if(K)for(D=L.x,Y=L.y,w=f;q>w;w++)c=w+1,A=w*H,C=c*H,x=X(A),g=U(A),G=X(C),M=U(C),h.push(G*D,Y,-M*D,x*D,Y,-g*D,0,Y,0),O.push(.5-.5*G,.5+.5*M,.5-.5*x,.5+.5*g,.5,.5)}}),{vs:S,uv:T,bottom_vs:h,bottom_uv:O,top_vs:Z,top_uv:b,from_vs:$,from_uv:d,to_vs:n,to_uv:N}}},!0),Ej(q,{"3d.move.mode":s,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percent":1,"shape.border.gradient.color":s,"edge.gradient.color":s,"edge.source.t3":s,"edge.target.t3":s,"light.type":jn,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":J/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":Cn,"wf.short":!1,"wf.mat":s,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:s,"transparent.mask":!1,brightness:s,"select.brightness":.7,"repeat.uv.length":s,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,alwaysOnTop:!1,"texture.cache":!1,"hide.overlapping.group":s,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"label.face":wg,"label.t3":s,"label.r3":s,"label.texture.scale":2,"label.rotationMode":yq,"label.light":!1,"label.blend":s,"label.reverse.flip":!1,"label.reverse.color":$j,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":wg,"label2.t3":s,"label2.r3":s,"label2.texture.scale":2,"label2.rotationMode":yq,"label2.light":!1,"label2.blend":s,"label2.reverse.flip":!1,"label2.reverse.color":$j,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":wg,"note.t3":s,"note.r3":s,"note.texture.scale":2,"note.rotationMode":yq,"note.light":!1,"note.blend":s,"note.reverse.flip":!1,"note.reverse.color":$j,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":wg,"note2.t3":s,"note2.r3":s,"note2.texture.scale":2,"note2.rotationMode":yq,"note2.light":!1,"note2.blend":s,"note2.reverse.flip":!1,"note2.reverse.color":$j,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:s,"shape3d.color":Wd,"shape3d.top.color":s,"shape3d.bottom.color":s,"shape3d.from.color":s,"shape3d.to.color":s,"shape3d.image":s,"shape3d.top.image":s,"shape3d.bottom.image":s,"shape3d.from.image":s,"shape3d.to.image":s,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":s,"shape3d.side.to":s,"shape3d.smooth":s,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":s,"shape3d.opacity":s,"shape3d.reverse.flip":!1,"shape3d.reverse.color":$j,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":s,"shape3d.uv.scale":s,"shape3d.top.uv.offset":s,"shape3d.top.uv.scale":s,"shape3d.bottom.uv.offset":s,"shape3d.bottom.uv.scale":s,"shape3d.from.uv.offset":s,"shape3d.from.uv.scale":s,"shape3d.to.uv.offset":s,"shape3d.to.uv.scale":s,"shape3d.top.cap":s,"shape3d.bottom.cap":s,"shape3d.start.angle":0,"shape3d.sweep.angle":b,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":!1,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"shape3d.vector.dynamic":!1,"shape3d.texture.scale":1,"texture.mipmap.max":s,"texture.filter":s,"texture.filter.min":s,"texture.filter.mag":s,"all.light":!0,"all.visible":!0,"all.color":Wd,"all.image":s,"all.blend":s,"all.opacity":s,"all.reverse.flip":!1,"all.reverse.color":$j,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":s,"all.uv.offset":s,"all.uv.scale":s,"all.discard.selectable":!0,mat:s,"left.mat":s,"right.mat":s,"top.mat":s,"bottom.mat":s,"front.mat":s,"back.mat":s},!0);var ob,Zp=!1,Eo=[0,0,0,0],Jq={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:br,2:lk,3:bm,4:Lp,5:wg,6:xs}},Fk=function(Y,g,d,Z){if(g.getFaceVisible(Y,d)){Rk(g,sf(Y,g.getFaceMat(Y,d)||g.getMat(Y)));var D=g._26I;g.getFaceReverseCull(Y,d)?D.enable(D.CULL_FACE):D.disable(D.CULL_FACE),Ir(D,g._prg.uFixPickReverseColor,Jq[d]),km(D),dm(D,Z,6),qg(D),Zr(g)}},od=function(C){return C instanceof Sm},zg=function(R){return[R.x,R.e||0,R.y]},rb=function(x,C,z){for(var C=tl(C),d=C[0],Q=C[1],R=C[2];z--;)x.push(d,Q,R)},Yh=function(U,F,c){for(var F=tl(F),x=F[0],V=F[1],j=F[2],y=F[3];c--;)U.push(x,V,j,y)},Jr=function(P,i,u){if(i)for(var b,m,W,q=i[0],O=i[1],l=i[2],I=i[4],f=i[5],Y=i[6],H=i[8],o=i[9],j=i[10],k=i[12],U=i[13],K=i[14],w=u.length,B=0,B=0;w>B;B+=3)b=u[B],m=u[B+1],W=u[B+2],P.push(q*b+I*m+H*W+k,O*b+f*m+o*W+U,l*b+Y*m+j*W+K);else ks(P,u)},Ml=function(q,W){var u=W.s("light.intensity"),x=tl(W.s(Io)),y=x[0],Q=x[1],w=x[2];1!==u&&(y*=u,Q*=u,w*=u),q.push(y,Q,w,W.s("light.disabled")?1:0)},zp=function(h,s,u){Ir(s,u.uHeadlightRange,h._headlightRange),Ir(s,u.uHeadlightAmbientIntensity,h._headlightAmbientIntensity);var c=h._headlightIntensity,j=tl(h._headlightColor);1!==c&&(j=[j[0]*c,j[1]*c,j[2]*c]),Ir(s,u.uHeadlightColor,[j[0],j[1],j[2],h._headlightDisabled?1:0]);var C=h._59O,V=h._spots,K=h._dirs;if(C.length){var J=[],L=[],d=[];C.forEach(function(o){Ml(J,o),ks(L,h._transformPointToViewSpace(o.p3())),d.push(o.s("light.range"))}),s.uniform4fv(u.uPointColor,J),s.uniform1fv(u.uPointRange,d),s.uniform3fv(u.uPointPosition,L)}if(V.length){var t=[],I=[],O=[],Q=[],x=[],g=[];V.forEach(function(F){Ml(t,F),ks(I,h._transformPointToViewSpace(F.p3())),ks(x,h._transformDirectionToViewSpace(F.p3(),F.s("light.center"))),O.push(F.s("light.range")),Q.push(X(F.s("light.angle")/2)),g.push(F.s("light.exponent"))}),s.uniform4fv(u.uSpotColor,t),s.uniform1fv(u.uSpotRange,O),s.uniform1fv(u.uSpotAngle,Q),s.uniform1fv(u.uSpotExponent,g),s.uniform3fv(u.uSpotPosition,I),s.uniform3fv(u.uSpotDirection,x)}if(K.length){var Y=[],M=[];K.forEach(function(s){Ml(Y,s),ks(M,h._transformDirectionToViewSpace(s.p3()))}),s.uniform4fv(u.uDirColor,Y),s.uniform3fv(u.uDirDirection,M)}},Kg=function(g){return Math.max(z.graph3dViewMinPhi+vo,Math.min(z.graph3dViewMaxPhi-vo,g))},Po=function(){return.05+w()/2},Tp=function(v,w,A,V){var Z,M=v.getEye();return v.isOrtho()?(Z=_c(v.getCenter(),M),Z[0]+=V[0],Z[1]+=V[1],Z[2]+=V[2]):Z=M,Lk(w,A,V,Z)},Lk=function(I,r,Z,H){var K=Wc(I,r),S=_c(H,Z,!0),A=Wc(S,r);if(R(A)<vo)return i;var X=(K-Wc(Z,r))/A;return[Z[0]+S[0]*X,Z[1]+S[1]*X,Z[2]+S[2]*X]},Hk=function(P,W){return{x:2*P.x-W.x,y:2*P.y-W.y}},he=function(n,p,w,l){var r,F;if(!n)return r=K(p.y-w.y,w.x-p.x),{x:p.x+l*U(r),y:p.y+l*X(r)};if(!w)return r=K(n.y-p.y,p.x-n.x),{x:p.x+l*U(r),y:p.y+l*X(r)};var O=_c([n.x,n.y,0],[p.x,p.y,0],!0),Q=_c([w.x,w.y,0],[p.x,p.y,0],!0),G=-(O[0]+Q[0])/2,S=-(O[1]+Q[1])/2,Z=k(G*G+S*S);if(vo>Z)return r=K(n.y-p.y,p.x-n.x),{x:p.x+l*U(r),y:p.y+l*X(r)};var e=n.x-p.x,M=n.y-p.y,q=w.x-p.x,c=w.y-p.y,z=k(e*e+M*M),B=k(q*q+c*c);r=I(Wc(O,Q))/2,F=O[1]*Q[0]-O[0]*Q[1]>0?-1:1,G/=Z,S/=Z;var d=l/U(r),W=$(z,B)/X(r);Z=Math.min(d,W);var _={x:p.x+F*Z*G,y:p.y+F*Z*S};return w.b&&d>B/X(r)&&(_.adjust=!0),_},lo=function(L){var f=L[1],y=L[2],r=L[3],Z=L[6],I=L[7],a=L[11];L[1]=L[4],L[2]=L[8],L[3]=L[12],L[4]=f,L[6]=L[9],L[7]=L[13],L[8]=y,L[9]=Z,L[11]=L[14],L[12]=r,L[13]=I,L[14]=a},se=function(s){var w=s[0],Y=s[1],F=s[2],R=s[3],h=s[4],W=s[5],L=s[6],d=s[7],o=s[8],y=s[9],u=s[10],j=s[11],X=s[12],A=s[13],P=s[14],I=s[15],c=w*W-Y*h,H=w*L-F*h,l=w*d-R*h,v=Y*L-F*W,G=Y*d-R*W,$=F*d-R*L,r=o*A-y*X,J=o*P-u*X,C=o*I-j*X,_=y*P-u*A,Q=y*I-j*A,n=u*I-j*P,V=c*n-H*Q+l*_+v*C-G*J+$*r;return V?(V=1/V,s[0]=(W*n-L*Q+d*_)*V,s[1]=(F*Q-Y*n-R*_)*V,s[2]=(A*$-P*G+I*v)*V,s[3]=(u*G-y*$-j*v)*V,s[4]=(L*C-h*n-d*J)*V,s[5]=(w*n-F*C+R*J)*V,s[6]=(P*l-X*$-I*H)*V,s[7]=(o*$-u*l+j*H)*V,s[8]=(h*Q-W*C+d*r)*V,s[9]=(Y*C-w*Q-R*r)*V,s[10]=(X*G-A*l+I*c)*V,s[11]=(y*l-o*G-j*c)*V,s[12]=(W*J-h*_-L*r)*V,s[13]=(w*_-Y*J+F*r)*V,s[14]=(A*H-X*v-P*c)*V,s[15]=(o*v-y*H+u*c)*V,void 0):i},Gg=function(A,w){if(w){var m=w[0],p=w[1],I=w[2];A[12]=A[0]*m+A[4]*p+A[8]*I+A[12],A[13]=A[1]*m+A[5]*p+A[9]*I+A[13],A[14]=A[2]*m+A[6]*p+A[10]*I+A[14],A[15]=A[3]*m+A[7]*p+A[11]*I+A[15]}},Rq=function(m,L){if(L){var D=L[0],Y=L[1],b=L[2];m[0]=m[0]*D,m[1]=m[1]*D,m[2]=m[2]*D,m[3]=m[3]*D,m[4]=m[4]*Y,m[5]=m[5]*Y,m[6]=m[6]*Y,m[7]=m[7]*Y,m[8]=m[8]*b,m[9]=m[9]*b,m[10]=m[10]*b,m[11]=m[11]*b}},ao=function(O,D,v){var S=D[0],z=D[1],i=D[2],Z=D[3],e=D[4],E=D[5],C=D[6],h=D[7],t=D[8],J=D[9],b=D[10],n=D[11],y=D[12],k=D[13],r=D[14],f=D[15],a=v[0],d=v[1],p=v[2],M=v[3];return O[0]=a*S+d*e+p*t+M*y,O[1]=a*z+d*E+p*J+M*k,O[2]=a*i+d*C+p*b+M*r,O[3]=a*Z+d*h+p*n+M*f,a=v[4],d=v[5],p=v[6],M=v[7],O[4]=a*S+d*e+p*t+M*y,O[5]=a*z+d*E+p*J+M*k,O[6]=a*i+d*C+p*b+M*r,O[7]=a*Z+d*h+p*n+M*f,a=v[8],d=v[9],p=v[10],M=v[11],O[8]=a*S+d*e+p*t+M*y,O[9]=a*z+d*E+p*J+M*k,O[10]=a*i+d*C+p*b+M*r,O[11]=a*Z+d*h+p*n+M*f,a=v[12],d=v[13],p=v[14],M=v[15],O[12]=a*S+d*e+p*t+M*y,O[13]=a*z+d*E+p*J+M*k,O[14]=a*i+d*C+p*b+M*r,O[15]=a*Z+d*h+p*n+M*f,O},To=function(p,$,u,x){var F,Z,G,g,r,d,S,J,o,I,T=$[0],t=$[1],y=$[2],E=x[0],c=x[1],_=x[2],X=u[0],O=u[1],b=u[2];return R(T-X)<vo&&R(t-O)<vo&&R(y-b)<vo?ze(p):(S=T-X,J=t-O,o=y-b,I=1/k(S*S+J*J+o*o),S*=I,J*=I,o*=I,F=c*o-_*J,Z=_*S-E*o,G=E*J-c*S,I=k(F*F+Z*Z+G*G),I?(I=1/I,F*=I,Z*=I,G*=I):(F=0,Z=0,G=0),g=J*G-o*Z,r=o*F-S*G,d=S*Z-J*F,I=k(g*g+r*r+d*d),I?(I=1/I,g*=I,r*=I,d*=I):(g=0,r=0,d=0),p[0]=F,p[1]=g,p[2]=S,p[3]=0,p[4]=Z,p[5]=r,p[6]=J,p[7]=0,p[8]=G,p[9]=d,p[10]=o,p[11]=0,p[12]=-(F*T+Z*t+G*y),p[13]=-(g*T+r*t+d*y),p[14]=-(S*T+J*t+o*y),p[15]=1,p)},xd=function(b,I,S,v,p){var Q=1/N(I/2),O=1/(v-p);return b[0]=Q/S,b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[5]=Q,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[10]=(p+v)*O,b[11]=-1,b[12]=0,b[13]=0,b[14]=2*p*v*O,b[15]=0,b},Wk=function(g,R,F,S,O,D,X){var $=1/(R-F),G=1/(S-O),k=1/(D-X);return g[0]=-2*$,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=-2*G,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=2*k,g[11]=0,g[12]=(R+F)*$,g[13]=(O+S)*G,g[14]=(X+D)*k,g[15]=1,g},Xp=function(l,z){var $=z[0],I=z[1],D=z[2],L=z[3],M=$*$+I*I+D*D+L*L,X=M?1/M:0;return l[0]=-$*X,l[1]=-I*X,l[2]=-D*X,l[3]=L*X,l},$b=function(g,h){var H=h[0]+h[5]+h[10],R=0;return H>0?(R=2*Math.sqrt(H+1),g[3]=.25*R,g[0]=(h[6]-h[9])/R,g[1]=(h[8]-h[2])/R,g[2]=(h[1]-h[4])/R):h[0]>h[5]&h[0]>h[10]?(R=2*Math.sqrt(1+h[0]-h[5]-h[10]),g[3]=(h[6]-h[9])/R,g[0]=.25*R,g[1]=(h[1]+h[4])/R,g[2]=(h[8]+h[2])/R):h[5]>h[10]?(R=2*Math.sqrt(1+h[5]-h[0]-h[10]),g[3]=(h[8]-h[2])/R,g[0]=(h[1]+h[4])/R,g[1]=.25*R,g[2]=(h[6]+h[9])/R):(R=2*Math.sqrt(1+h[10]-h[0]-h[5]),g[3]=(h[1]-h[4])/R,g[0]=(h[8]+h[2])/R,g[1]=(h[6]+h[9])/R,g[2]=.25*R),g},po=function(Z,G,N){var l=G[0],o=G[1],I=G[2],R=G[3],p=l+l,b=o+o,i=I+I,q=l*p,S=l*b,Y=l*i,W=o*b,y=o*i,Q=I*i,a=R*p,E=R*b,w=R*i;return Z[0]=1-(W+Q),Z[1]=S+w,Z[2]=Y-E,Z[3]=0,Z[4]=S-w,Z[5]=1-(q+Q),Z[6]=y+a,Z[7]=0,Z[8]=Y+E,Z[9]=y-a,Z[10]=1-(q+W),Z[11]=0,Z[12]=N[0],Z[13]=N[1],Z[14]=N[2],Z[15]=1,Z},Le=function(z,c){if(z.vr.enable){var J=z.vr.getViewMatrix(c);if(J)return J}return To(c?c:Fc(),z._eye,z._center,z._up)},Lc=function(f,J){if(f.vr.enable){var d=f.vr.getProjectMatrix();if(d)return d}if(!J&&f._computedProjectMatrix)return Hq(f._computedProjectMatrix);var q=f.getAspect(),S=f._near,m=f._far,D=Fc();if(f._ortho){var w=f._orthoWidth/2,N=w/q;Wk(D,-w,w,-N,N,S,m)}else xd(D,f._fovy,q,S,m);return D},Yl=function(E,o){if(!E)return i;var O=0,V=1,N=2,v=[],S=0,n=E.length,W=n/3;if(o){for(;n>S;S++)v[S]=0;for(S=0;S<o.length;S+=3){var J=[],K=[],b=[];J[O]=E[3*o[S+1]+O]-E[3*o[S]+O],J[V]=E[3*o[S+1]+V]-E[3*o[S]+V],J[N]=E[3*o[S+1]+N]-E[3*o[S]+N],K[O]=E[3*o[S+2]+O]-E[3*o[S+1]+O],K[V]=E[3*o[S+2]+V]-E[3*o[S+1]+V],K[N]=E[3*o[S+2]+N]-E[3*o[S+1]+N],b[O]=J[V]*K[N]-J[N]*K[V],b[V]=J[N]*K[O]-J[O]*K[N],b[N]=J[O]*K[V]-J[V]*K[O];for(var H=0;3>H;H++)v[3*o[S+H]+O]+=b[O],v[3*o[S+H]+V]+=b[V],v[3*o[S+H]+N]+=b[N]}}else for(S=0;W>S;S+=3){var J=[],K=[],b=[];J[O]=E[3*(S+1)+O]-E[3*S+O],J[V]=E[3*(S+1)+V]-E[3*S+V],J[N]=E[3*(S+1)+N]-E[3*S+N],K[O]=E[3*(S+2)+O]-E[3*(S+1)+O],K[V]=E[3*(S+2)+V]-E[3*(S+1)+V],K[N]=E[3*(S+2)+N]-E[3*(S+1)+N],b[O]=J[V]*K[N]-J[N]*K[V],b[V]=J[N]*K[O]-J[O]*K[N],b[N]=J[O]*K[V]-J[V]*K[O];for(var H=0;3>H;H++)v[3*(S+H)+O]=b[O],v[3*(S+H)+V]=b[V],v[3*(S+H)+N]=b[N]}for(S=0;n>S;S+=3){var m=[];m[O]=v[S+O],m[V]=v[S+V],m[N]=v[S+N];var D=k(m[O]*m[O]+m[V]*m[V]+m[N]*m[N]);0===D&&(D=vo),m[O]=m[O]/D,m[V]=m[V]/D,m[N]=m[N]/D,v[S+O]=m[O],v[S+V]=m[V],v[S+N]=m[N]}return new $g(v)},mr=function(E,C,X,$){if(X||(X=E.createTexture()),C){var m=E.TEXTURE_2D,n=E.REPEAT,R=E.CLAMP_TO_EDGE,A=E.TEXTURE_MIN_FILTER;$=$||ej;var r=$.minFilter||$.filter||E.LINEAR,z=$.magFilter||$.filter||E.LINEAR;Bg(E,X),E.texImage2D(m,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,C),Mp(E,E.TEXTURE_MAG_FILTER,z);var k=C.naturalWidth||C.width,S=C.naturalHeight||C.height;Xn.isPOT(k)&&Xn.isPOT(S)&&!C.clampToEdge?(Mp(E,E.TEXTURE_WRAP_S,n),Mp(E,E.TEXTURE_WRAP_T,n),Mp(E,A,r===E.NEAREST?E.NEAREST_MIPMAP_NEAREST:E.LINEAR_MIPMAP_LINEAR),$.mipmapMaxLevel!==s&&Mp(E,E.TEXTURE_MAX_LEVEL,$.mipmapMaxLevel),E.generateMipmap(m)):(Mp(E,E.TEXTURE_WRAP_S,R),Mp(E,E.TEXTURE_WRAP_T,R),Mp(E,A,r)),Bg(E,i)}return X},si=function(w,d){var e=new Uint8Array(4);return d=d||w.createTexture(),Bg(w,d),Mp(w,w.TEXTURE_MIN_FILTER,w.LINEAR),w.texImage2D(w.TEXTURE_2D,0,w.RGBA,1,1,0,w.RGBA,w.UNSIGNED_BYTE,e),d},Dr=function(p){p._26I&&p._prg&&(p._26I.deleteProgram(p._prg),p._prg=i)},Wl=function(j,K,I,Y){var E=j.createShader(I);return j.shaderSource(E,Y),j.compileShader(E),j.attachShader(K,E),E},dk=function(n){return n.createBuffer()},Bg=function(j,U){j.bindTexture(j.TEXTURE_2D,U)},Mp=function(N,$,A){N.texParameteri(N.TEXTURE_2D,$,A)},up=function(y,z){y.enable(y.POLYGON_OFFSET_FILL),y.polygonOffset(z[0],z[1])},fj=function(c){c.disable(c.POLYGON_OFFSET_FILL)},mk=function(k,Q){if(Q){var Q=tl(Q);k.clearColor(Q[0],Q[1],Q[2],Q[3])}},wf=function(A,W){Ir(A,W.uFix,!0),vc(A,W.aNormal)},kd=function(G,B){Ir(G,B.uFix,!1),Hj(G,B.aNormal)},Pq=function(H,t,A,T,D,p,c,S){H._picking||(A?(Ir(H,t.uBlend,!0),Ir(H,t.uBlendColor,A)):Ir(H,t.uBlend,!1),Ir(H,t.uLight,T==i?!0:T),Dn(D)&&1!==D&&Ir(H,t.uPartOpacity,D),Ir(H,t.uReverseFlip,p==i?!1:p),Ir(H,t.uFixPickReverseColor,c||$j)),S?H.enable(H.CULL_FACE):H.disable(H.CULL_FACE)},ub=function(l,D){l._picking||Ir(l,D.uPartOpacity,1)},km=function(){var Y=[0,0,1,1];return function(N,j,s,C,D,v,o,p,u){return s?(Ir(N,j.uTexture,!0),Ir(N,j.uDiscardSelectable,Zo(C)?C:!0),Hj(N,j.aUv),zn(N,D,v,j.aUv,2),u?(Ir(N,j.uBlendTexture,!0),N.activeTexture(N.TEXTURE1),Bg(N,u),N.uniform1i(j.uBlendSampler,1)):(Ir(N,j.uBlendTexture,!1),N.activeTexture(N.TEXTURE1),Bg(N,N._emptyBlendTexture)),N.activeTexture(N.TEXTURE0),Bg(N,s),N.uniform1i(j.uSampler,0),o?(Y[0]=o[0],Y[1]=o[1]):(Y[0]=0,Y[1]=0),p?(Y[2]=p[0],Y[3]=p[1]):(Y[2]=1,Y[3]=1),Ir(N,j.uOffsetScale,Y),void 0):(N.activeTexture(N.TEXTURE0),Bg(N,N._emptyTexture),N.activeTexture(N.TEXTURE1),Bg(N,N._emptyBlendTexture),void 0)}}(),qg=function(B,r,A){B.activeTexture(B.TEXTURE0),Bg(B,i),B.activeTexture(B.TEXTURE1),Bg(B,i),A&&(vc(B,r.aUv),Ir(B,r.uTexture,!1),Ir(B,r.uBlendTexture,!1))},Nb=function(O,v,R,E,i,X){!R||Ph||Fp||O.lineWidth(R),E&&!O._picking&&Ir(O,v.uFixPickReverseColor,E),i&&zn(O,i,X,v.aPosition)},Zq=function(Y,O,S,C){ob&&(C=Y[ob]),Y.drawArrays(C==i?Y.TRIANGLES:C,O,S);var A=Y._renderInfo;A&&(A.calls++,A.vertices+=S,(C==i||C===Y.TRIANGLES)&&(A.faces+=S/3),C===Y.LINES&&(A.lines+=S/2))},dm=function(s,I,n,f){ob&&(f=s[ob]),s.drawElements(f==i?s.TRIANGLES:f,n,s.UNSIGNED_SHORT,I==i?0:2*I);var Y=s._renderInfo;Y&&(Y.calls++,Y.vertices+=n,(f==i||f===s.TRIANGLES)&&(Y.faces+=n/3),f===s.LINES&&(Y.lines+=n/2))},Sj=function(H,E,u,s,N){var V=H.ARRAY_BUFFER;H.bindBuffer(V,E),u&&H.bufferData(V,u,H.STATIC_DRAW),s!=i&&H.vertexAttribPointer(s,N?N:3,H.FLOAT,!1,0,0)},zn=function(X,J,W,Z,E){return W?(fd(X,X.ARRAY_BUFFER,J,W),Z!=i&&X.vertexAttribPointer(Z,E?E:3,X.FLOAT,!1,0,0),void 0):Sj(X,J,W,Z,E)},cd=function(Q,O,D){var E=Q.ELEMENT_ARRAY_BUFFER;Q.bindBuffer(E,O),D&&Q.bufferData(E,D,Q.STATIC_DRAW)},Jb=function(s,H,b){fd(s,s.ELEMENT_ARRAY_BUFFER,H,b)},fd=function(K,Q,z,X){var A=X._bufId;A||(A=X._bufId=r.Math.generateIncreasingID());var z,R=K._bufPool;(z=R[A])&&z._buf?K.bindBuffer(Q,z._buf):(z=R[A]={_buf:dk(K)},K.bindBuffer(Q,z._buf),K.bufferData(Q,X,K.STATIC_DRAW)),z._fid=K._renderInfo.frame},Ir=function(p,h,y){if(y!=i&&h!=i){y=tl(y);var r=y.length;3===r?p.uniform3fv(h,y):4===r?p.uniform4fv(h,y):16===r?p.uniformMatrix4fv(h,!1,y):Zo(y)?p.uniform1i(h,y?1:0):2===r?p.uniform2fv(h,y):p.uniform1f(h,y)}},Hj=function(Y,u){u!=i&&u>=0&&Y.enableVertexAttribArray(u)},vc=function($,x){x!=i&&x>=0&&$.disableVertexAttribArray(x)},Zr=function(O,V){var I=O.getGL(),_=O._prg;O._7O=O._8O.pop(),V&&(Ir(I,_.uMVMatrix,O._7O),O._6O=V,Ir(I,_.uNMatrix,V))},Xd=function(D,w){return w||(w=Fc()),dh(w,D),se(w),lo(w),w},Rk=function(Z,H){var y=Z.getGL(),X=Z._prg,C=Z._7O;H&&(Z._8O.push(Hq(C)),Ir(y,X.uMMatrix,H),ao(C,C,H),Z._7O=C),Ir(y,X.uMVMatrix,C),Ir(y,X.uNMatrix,Xd(C,Z._6O))},Te=function(C,M,U,V,t,E){if(U){if(V){var X=U.value++,Z=2147483648|X,r=[(255&Z>>16)/255,(255&Z>>8)/255,(255&Z)/255,(255&Z>>24)/255];U[X]={data:t,part:E}}else r=Eo;return Ir(C,M.uFixPickReverseColor,r),r}},ri=function(){var x={center:function(q,C,s,m,O){var o=-C[1]/2,D={x:-C[0]/2,y:o,width:C[0],height:C[1]},c=cg(q,D,s);return[c.x+m,-c.y-O,Po()]},front:function(c,l,W,j,K){var P=-l[1]/2,M={x:-l[0]/2,y:P,width:l[0],height:l[1]},G=cg(c,M,W);return[G.x+j,-G.y-K,l[2]/2+Po()]},back:function($,x,A,M,W){var k=-x[0]/2,Y=-x[1]/2,v={x:k,y:Y,width:x[0],height:x[1]},r=cg($,v,A);return[-r.x-M,-r.y-W,-x[2]/2-Po()]},left:function(b,u,H,l,c){var K=-u[1]/2,y={x:-u[2]/2,y:K,width:u[2],height:u[1]},M=cg(b,y,H);return[-u[0]/2-Po(),-M.y-c,M.x+l]
},right:function(g,E,F,l,I){var W=-E[2]/2,A=-E[1]/2,s={x:W,y:A,width:E[2],height:E[1]},h=cg(g,s,F);return[E[0]/2+Po(),-h.y-I,-h.x-l]},top:function(d,E,Q,H,N){var p={x:-E[0]/2,y:-E[2]/2,width:E[0],height:E[2]},W=cg(d,p,Q);return[W.x+H,E[1]/2+Po(),W.y+N]},bottom:function(k,$,R,_,c){var f=-$[2]/2,l={x:-$[0]/2,y:f,width:$[0],height:$[2]},y=cg(k,l,R);return[y.x+_,-$[1]/2-Po(),-y.y-c]}};return function(e,H,T,w,G,u){return x[w](e,H,T,G||0,u||0)}}(),Bh=function(c,F,j,h,d,V,R,f,y,Y){if(d&&(F[0]+=d[0],F[1]+=d[1],F[2]+=d[2]),Gg(c,j),f){var S=Fc();if(Gn(S,y,Y),pq(F,S),Gg(c,F),c.auto=f,c.pos=pq([0,0,0],c),V){var U=c.mat2=Fc();Gn(U,V,R)}}else Gn(c,y,Y),Gg(c,F),h===br?Vf(c,-L):h===lk?Vf(c,L):h===bm?nd(c,-L):h===Lp?nd(c,L):h===xs&&Vf(c,J),Gn(c,V,R);return c},Zg=function(Z,n){var O=n.auto,q=n.mat2,K=Z.gv;if(O){var o,Y=Fc(),H=[0,0,0,0];o="string"==typeof O?[O.indexOf("x")<0?K._eye[0]:K._center[0],O.indexOf("y")<0?K._eye[1]:K._center[1],O.indexOf("z")<0?K._eye[2]:K._center[2]]:K._eye,$b(H,To(Fc(),o,K._center,K._up)),po(Y,Xp(H,H),n.pos),q&&ao(Y,Y,q),Rk(K,Y)}else Rk(K,n)},Rm=function(N,I,T,X,o){var g=N.s,a=N.gv,Z=a.getGL(),K=a._prg,r=a._buffer,E=a._1O;mr(Z,pl,E),Zg(N,T),Pq(Z,K,g(I+".blend"),g(I+".light"),g(I+".opacity"),g(I+".reverse.flip"),g(I+".reverse.color"),g(I+".reverse.cull")),km(Z,K,E,o,r.uv,ad),zn(Z,r.vs,X,K.aPosition),zn(Z,r.ns,Zk,K.aNormal),Jb(Z,r.is,fn),dm(Z,0,fn.length),qg(Z,K,E),ub(Z,K),Zr(a)},ph=function(T,Y,L){var y=T.gv,q=T.data,h=T[Y]={blend:y.getBodyColor(q)||y.getFaceBlend(q,Y),light:y.getFaceLight(q,Y),color:y.getFaceColor(q,Y),opacity:y.getFaceOpacity(q,Y),transparent:y.getFaceTransparent(q,Y),reverseFlip:y.getFaceReverseFlip(q,Y),reverseColor:y.getFaceReverseColor(q,Y),reverseCull:y.getFaceReverseCull(q,Y),texture:y.getFaceImage(q,Y),blendTexture:y.getFaceBlendImage(q,Y),discardSelectable:y.getFaceDiscardSelectable(q,Y)};if("csg"!==Y){h.uv=y.getFaceUv(q,Y)||L&&L[Y+"Uv"],h.uvScale=y.getFaceUvScale(q,Y)||L&&L[Y+"UvScale"],h.uvOffset=y.getFaceUvOffset(q,Y)||L&&L[Y+"UvOffset"];var v=y.getFaceMat(q,Y);v&&(h.mat=sf(q,v))}return h},Zb=function(u,e,j,t,a){var W=u[t];if(W){if(!a(W.transparent))return;var p=u.data,R=u.gv,B=R._buffer,Y=R.getTexture(W.texture,p,t),H=R.getTexture(W.blendTexture,p);km(e,j,Y,W.discardSelectable,B.uv,W.tuv,W.uvOffset,W.uvScale,H),Pq(e,j,W.blend,W.light,W.opacity,W.reverseFlip,W.reverseColor,W.reverseCull),Ir(e,j.uDiffuse,W.color||q["color.empty"]),zn(e,B.vs,W.vs,j.aPosition),zn(e,B.ns,W.ns,j.aNormal),Zq(e,0,W.vs.length/3),ub(e,j),qg(e,j,Y)}},Kd=function(g,j,b,V,i,J){var t,f,W,k,o,v,I,s,h,O,G,q=[V-j,i-b],Z=g?g.length:0;for(W=0;Z>W;W++){for(k=2,t=g[W],o=t[0],v=t[1];k+1<t.length;){if(I=t[k],s=t[k+1],f=go(j,b,V,i,o,v,I,s,!0)){h=[I-o,s-v],O=_m(h),h[0]/=O,h[1]/=O,O=Wc(q,h),O=O>0?J:-J,G=[h[0]*O,h[1]*O];break}o=I,v=s,k+=2}if(G)break}if(G)for(V=j+G[0],i=b+G[1],W=0;Z>W;W++)for(k=2,t=g[W],o=t[0],v=t[1];k+1<t.length;){if(I=t[k],s=t[k+1],f=go(j,b,V,i,o,v,I,s,!0))return[0,0];o=I,v=s,k+=2}return G?G:[V-j,i-b]},Ri=r.graph3d={},Xr=function(g,Y,s){Zi(E+".graph3d."+g,Y,s)},Td="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",vn="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";Ej(z,{setBatchInfo:function(Z,n){lp[Z]=n},getBatchInfo:function(m){return lp[m]}},!0);var Yg=[1,1,1],Vc=[1,0,0,0,0,1,0,1,1,1,1,0],An=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],bo=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],bh=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Yk=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],aj=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],pj=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Cm=function(L,r){Xq(L,r,"_batchModelMap","_batchIndexMap"),pc(L,r,"_wireframeModelMap","_wireframeIndexMap"),pc(L,r,"_polylineModelMap","_polylineIndexMap"),pc(L,r,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),pc(L,r,"_polylineModelMapSwap","_polylineIndexMapSwap")},Xq=function(J,N,v,B){if(!N)return J[v]={},J[B]={},void 0;var $=N._id,q=J[B],D=q[$];if(D){var n=J[v],k=D.batch,W=n[k],K=W.ds,x=D.index;if(W.invalidate=!0,delete q[$],K.splice(x,1),Vb(K))return delete n[k],void 0;for(var P=D.begin,X=D.size,g=3*P,I=3*X,C=4*P,R=4*X,L=W.vs,U=W.ps,E=W.uv,b=W.cs,c=W.bs,f=W.rs,_=W.ns,i=W.ls;x<K.length;x++)D=q[K[x]._id],D.index--,D.begin-=X;L.splice(g,I),U.splice(C,R),E&&E.splice(2*P,2*X),b&&b.splice(C,R),c&&c.splice(g,I),f&&f.splice(P,X),_&&_.splice(g,I),i&&i.splice(P,X)}},pc=Xq,bi=function(E,N,K,z){if(!z)return i;var F=N[z];if(!F){var U=lp[z]||ej,b=U.image?[]:i;F=N[z]={vs:[],ns:[],uv:b,cs:b?i:U.color?i:[],bs:U.blend?[]:i,ps:[],rs:U.brightness?[]:i,ds:[]}}return F.invalidate=!0,E[K._id]={index:F.ds.length,begin:F.vs.length/3,batch:z},F.ds.push(K),F},Tg=function(X,V){return V!=i&&1!==V?[X[0]*V,X[1]*V,X[2]*V,X[3]]:X},Qh=function(){var L;return function(q,h,p){var v=q.getData3dUI(h),g=v.shapeModel;g||(g=ch(v));var u,O=h.s("wf.combineTriangle");if(p.geometry){if(!g&&(h instanceof r.Node&&!(h instanceof r.Shape)?(L||(L={vs:Df,is:Ar,uv:Jl}),g=L):g=[v.left,v.front,v.right,v.back,v.top,v.bottom],!g))return s;if(O?(O=0|Math.min(3,Math.max(1,isNaN(O)?1:O)),u=xg[O-1](g)):u=xf(g),!u||0===u.length)return}else u=p.short?Em:qj;var W=q.getBrightness(h),k=tl(p.color||"white"),K=k[3]<1,j=Math.ceil(p.width)||1,B=(K?"T":"O")+j,d=q._wireframeIndexMap,Z=q._wireframeModelMap,c=Z[B];c||(c=Z[B]={vs:[],cs:[],ps:[],ds:[],T:K,W:j}),c.invalidate=!0;var R=c.vs,F=c.cs,i=c.ds,T=d[h._id]={index:i.length,begin:R.length/3,batch:B};i.push(h);var X=v.mat;if(!X||!p.geometry&&h instanceof r.Shape){X=sf(h,p.mat);var x=v._calcAnchorMat(h);x&&ao(X,X,x)}Jr(R,X,u);var G=T.size=R.length/3-T.begin;Yh(F,Tg(k,W),G)}}(),tn=function(E,C,X,d,r,p,s,W,h){var Y=E.getBrightness(C);Y==i&&(Y=1);var H=Tg(tl(d),Y),G=H[3]<1;p=Math.ceil(p)||1;var J=(G?"T":"O")+p;if(s){var O=s[0],e=(s[1]||O)+O;J+="-"+O+"-"+e,h&&(J+="-"+xk(h)+"-"+Y,h=Tg(tl(h),Y))}var V=E._polylineIndexMap,t=E._polylineModelMap,M=t[J];M||(M=t[J]={vs:[],cs:[],ps:[],ds:[],ls:s?[]:i,T:G,W:p},s&&(M.D=O,M.G=e,M.A=h)),M.invalidate=!0;var v,n=M.vs,f=M.cs,S=M.ds,c=M.ls,q=V[C._id]={index:S.length,begin:n.length/3,batch:J};S.push(C),ks(n,X);var u,T=q.size=n.length/3-q.begin,w=X.length,L=0,$=[];if(s||r)for(v=0;w>v;v+=6)u=_m([X[v],X[v+1],X[v+2]],[X[v+3],X[v+4],X[v+5]]),$.push(u),L+=u;if(L&&r){var j,R=Tg(tl(r),Y),K=[R[0]-H[0],R[1]-H[1],R[2]-H[2],R[3]-H[3]],x=0;for(v=0;w>v;v+=6)j=x/L,Yh(f,[H[0]+K[0]*j,H[1]+K[1]*j,H[2]+K[2]*j,H[3]+K[3]*j],1),x+=$[v/6],j=x/L,Yh(f,[H[0]+K[0]*j,H[1]+K[1]*j,H[2]+K[2]*j,H[3]+K[3]*j],1)}else Yh(f,H,T);if(s)for(x=W||0,v=0;w>v;v+=6)c.push(x),x+=$[v/6],c.push(x)},Kj=function(Q,E,C){if(E)for(var v=4*E.begin,K=C[E.batch].ps,Z=0;Z<E.size;Z++)K[v++]=Q[0],K[v++]=Q[1],K[v++]=Q[2],K[v++]=Q[3]},Pd=function(A,R){var d=R+["32"],B=A[R],w=A[d];B?w&&w.length===B.length?(w.set(B),w._bufId=null):A[d]=new $g(B):delete A[d]},dd=function(k,B,g,E,I,L,C,V,z){if(Qb(g))g.forEach(function(g){dd(k,B,g,E,I,L,C,V,z)});else if(un(g))dd(k,B,ch(E,g),E,I,L,C,V,z);else if(zo(g)){var b,R=gf(g.mat,B,k),c=gf(g.s3,B,k),O=gf(g.t3,B,k),A=gf(g.r3,B,k);if((c||A||O||R)&&(b=gg(R,c,A,gf(g.rotationMode,B,k),O),L.push(b)),g.shape3d)dd(k,B,g.shape3d,E,I,L,C,V,g);else{var a=E.s;z=z||ej;var T=L[0],m=L.length,D=a("shape3d.color",g.color,z.color);if(I||(I=a("shape3d.blend",g.blend,z.blend)),m>1){T=Hq(T);for(var q=1;m>q;q++)ao(T,T,L[q])}g.vs&&a(ki,g.visible,z.visible)&&jm(T,C,V,g.vs,g.uv,g.is,I,D),g.top_vs&&a(Ul,g.topVisible,z.topVisible)&&jm(T,C,V,g.top_vs,g.top_uv,g.top_is,I,a("shape3d.top.color",g.topColor,z.topColor)||D),g.bottom_vs&&a(jr,g.bottomVisible,z.bottomVisible)&&jm(T,C,V,g.bottom_vs,g.bottom_uv,g.bottom_is,I,a("shape3d.bottom.color",g.bottomColor,z.bottomColor)||D),g.from_vs&&a(cm,g.fromVisible,z.fromVisible)&&jm(T,C,V,g.from_vs,g.from_uv,g.from_is,I,a("shape3d.from.color",g.fromColor,z.fromColor)||D),g.to_vs&&a(bl,g.toVisible,z.toVisible)&&jm(T,C,V,g.to_vs,g.to_uv,g.to_is,I,a("shape3d.to.color",g.toColor,z.toColor)||D)}b&&L.pop()}},jm=function(w,R,K,F,r,z,X,c){var B,U=R.cs,I=R.uv,T=R.bs;if(z){B=z.length;for(var q=0;B>q;q++){var h=z[q];Jr(K,w,[F[3*h],F[3*h+1],F[3*h+2]]),I&&ks(I,[r[2*h],r[2*h+1]])}}else B=F.length/3,Jr(K,w,F),I&&ks(I,r);U&&Yh(U,c,B),T&&(X?rb(T,X,B):ks(T,Yg,B))},vs=function(r,t,m,Y){var u=[];Y?dd(r.gv,r.data,Y,r,r.getBodyColor(),[t],m,u):(Pk(r,br,t,m,u),Pk(r,lk,t,m,u),Pk(r,wg,t,m,u),Pk(r,xs,t,m,u),Pk(r,bm,t,m,u),Pk(r,Lp,t,m,u),Pk(r,"csg",t,m,u)),u.length&&(ks(m.vs,u),ks(m.ns,Yl(u)))},Pk=function(T,K,P,d,j){var _=T[K];if(_){var G=_.tuv;if(G){var m,r,e,C,E=_.uvScale,t=_.uvOffset;if(E)for(m=G.length,r=E[0],e=E[1],C=0;m>C;C+=2)G[C]*=r,G[C+1]*=e;if(t)for(m=G.length,r=t[0],e=t[1],C=0;m>C;C+=2)G[C]+=r,G[C+1]+=e}jm(P,d,j,_.vs,G,i,_.blend,_.color)}},uc=function(O,H,Q,D,f,m,Y,w){var e,E=Q.cs,t=Q.uv,b=Q.bs;if(O.getFaceVisible(H,m)){var a=O.getFaceMat(H,m);if(a&&(f=sf(H,a)),Jr(Y,f,w),E&&Yh(E,O.getFaceColor(H,m),6),t){var M=O.getFaceUv(H,m)||D[m+"Uv"],q=O.getFaceUvScale(H,m)||D[m+"UvScale"],F=O.getFaceUvOffset(H,m)||D[m+"UvOffset"];M=M?[M[6],M[7],M[0],M[1],M[2],M[3],M[2],M[3],M[4],M[5],M[6],M[7]]:Vc;var G=M[0],V=M[1],I=M[2],n=M[3],z=M[4],i=M[5],R=M[6],s=M[7],l=M[8],S=M[9],g=M[10],U=M[11];if(q){var x=q[0],$=q[1];G*=x,V*=$,I*=x,n*=$,z*=x,i*=$,R*=x,s*=$,l*=x,S*=$,g*=x,U*=$}if(F){var r=F[0],N=F[1];G+=r,V+=N,I+=r,n+=N,z+=r,i+=N,R+=r,s+=N,l+=r,S+=N,g+=r,U+=N}t.push(G,V,I,n,z,i,R,s,l,S,g,U)}b&&(e=O.getBodyColor(H)||O.getFaceBlend(H,m),e?rb(b,e,6):ks(b,Yg,6))}},hs=function(G,Y,h,D){var g=G.getGL(),O=G._prg,r=G._buffer;if(!G.drawFilter&&!rg(Y)){Rk(G),wf(g,O);for(var u in Y){var W=Y[u];if(!(D&&!W.T||!D&&W.T)){W.invalidate?(W.invalidate=!1,Pd(W,"vs"),Pd(W,"cs"),Pd(W,"ls"),Pd(W,"ps")):h&&Pd(W,"ps");var f=W.vs32,v=h?W.ps32:W.cs32;Nb(g,O,W.W,i,r.vs,f);var z=W.D,C=!G._dashDisabled&&z;Ir(g,O.uAlphaTest,q.alphaTest),C&&(Ir(g,O.uDash,!0),Ir(g,O.uDashDistance,z),Ir(g,O.uDashGapDistance,W.G),Hj(g,O.aLineDistance),zn(g,r.lineDistance,W.ls32,O.aLineDistance,1),Ir(g,O.uDiffuse,W.A||q["color.empty"]));var l=!G._batchColorDisabled;l&&(Ir(g,O.uBatchColor,!0),Hj(g,O.aBatchColor),zn(g,r.batchColor,v,O.aBatchColor,4)),km(g),Zq(g,0,f.length/3,g.LINES),qg(g),l&&(Ir(g,O.uBatchColor,!1),vc(g,O.aBatchColor)),C&&(Ir(g,O.uDash,!1),vc(g,O.aLineDistance))}}kd(g,O)}},hn=function(I,k,N){var C,U,y,z,E,f,u,c,V,g,e,n=I.getGL(),b=I._prg,d=I._buffer,Z=I._batchModelMap;if(!rg(Z)){Rk(I);for(C in Z)if(U=lp[C]||ej,!(N&&!U.transparent||!N&&U.transparent)&&(y=Z[C],k||!U.transparentMask)){var H=N&&U.autoSort!==!1&&(I._33Q||y.invalidate);if(y.invalidate?(y.invalidate=!1,Pd(y,"vs"),Pd(y,"ns"),Pd(y,"cs"),Pd(y,"rs"),Pd(y,"ps"),Pd(y,"bs"),Pd(y,"uv")):k&&Pd(y,"ps"),E=y.vs32,f=k?y.ps32:y.cs32,V=y.uv32,u=y.bs32,c=y.rs32,e=E.length/3,H&&(y.is=fp(E,I.getEye())),e){z=U.light,g=I.getTexture(U.image),Pq(n,b,i,U.light,U.opacity,U.reverseFlip,U.reverseColor,U.reverseCull),f?I._batchColorDisabled||(Ir(n,b.uBatchColor,!0),Hj(n,b.aBatchColor),zn(n,d.batchColor,f,b.aBatchColor,4)):Ir(n,b.uDiffuse,U.color||q["color.empty"]);var m=U.alphaTest;Ir(n,b.uAlphaTest,m===s?q.alphaTest:m),U.envmap!==s?(Ir(n,b.uUseEnvMap,!0),Ir(n,b.uReflectivity,U.envmap)):(Ir(n,b.uUseEnvMap,!1),Ir(n,b.uReflectivity,0));var p=u&&!I._batchBlendDisabled;p&&(Ir(n,b.uBatchBlend,!0),Hj(n,b.aBatchBlend),zn(n,d.batchBlend,u,b.aBatchBlend));var P=c&&!I._batchBrightnessDisabled;P&&(Ir(n,b.uBatchBrightness,!0),Hj(n,b.aBatchBrightness),zn(n,d.batchBrightness,c,b.aBatchBrightness,1)),V?km(n,b,g,U.discardSelectable,d.uv,V,U.uvOffset,U.uvScale):km(n),zn(n,d.vs,E,b.aPosition),zn(n,d.ns,y.ns32,b.aNormal),y.is?(cd(n,d.is,y.is),dm(n,0,e)):Zq(n,0,e),V?qg(n,b,g):qg(n),f&&!I._batchColorDisabled&&(Ir(n,b.uBatchColor,!1),vc(n,b.aBatchColor)),p&&(Ir(n,b.uBatchBlend,!1),vc(n,b.aBatchBlend)),P&&(Ir(n,b.uBatchBrightness,!1),vc(n,b.aBatchBrightness)),ub(n,b)}}}},fp=function(O,i){for(var B=O.length/3,A=new Array(B),x=B/3,T=new Array(x),P=0;x>P;P++)T[P]=P;T.sort(function(Q,A){var d=9*Q,s=[(O[d]+O[d+3]+2*O[d+6])/4,(O[d+1]+O[d+4]+2*O[d+7])/4,(O[d+2]+O[d+5]+2*O[d+8])/4];d=9*A;var F=[(O[d]+O[d+3]+2*O[d+6])/4,(O[d+1]+O[d+4]+2*O[d+7])/4,(O[d+2]+O[d+5]+2*O[d+8])/4],S=_m(i,s)-_m(i,F);return S>0?-1:0>S?1:0});for(var P=0;x>P;P++){var u=3*P,g=3*T[P];A[u]=g,A[u+1]=g+1,A[u+2]=g+2}return new Wr(A)},Ck={obj:function(v,y){var d={mat:v.mat,s3:v.s3,r3:v.r3,rotationMode:v.rotationMode,t3:v.t3,cube:v.cube==i?!0:v.cube,center:v.center==i?!0:v.center,ignoreMtls:v.ignoreMtls,ignoreTransparent:v.ignoreTransparent,ignoreColor:v.ignoreColor,ignoreImage:v.ignoreImage,ignoreNormal:v.ignoreNormal,prefix:v.prefix,flipY:v.flipY,flipFace:v.flipFace,reverseFlipMtls:v.reverseFlipMtls,finishFunc:function(E,P){if(E){var P=[];for(var l in E){var m=E[l];P.rawS3=m.rawS3,P.push(m),v.eachModel&&v.eachModel(l,m)}P.json=v,y(P)}else y()}};z.loadObj(v.obj,v.mtl,d)}};z.getModelTypeHandlers=function(){return Ck},z.setModelTypeHandler=function(f,W){Ck[f]=W},z.getModelTypeHandler=function(O){return Ck[O]},z.handleModelLoaded=function(){},z.handleUnfoundModel=function(){};var ek=i,ip=i,Vi=function(F){ek&&!F._loadingModelView_&&(ip||(ip={}),ip[F._loadingModelView_=xj()]=F)},Bi=function(w,t){ek||(ek={});var H=ek[w];if(H){if(H.url===t)return;H.request.onload=$i,H.request.onerror=$i}var c=new Lr;if(ek[w]={request:c,url:t},t=z.beforeLoadURL(t),t.data){var T=z.parse(t.data);ye(w,T,t)}else{c.onload=function(){if(200===this.status||0===this.status){delete ek[w];var Z=z.parse(c.getResponseText());ye(w,Z,t)}else Je(w,z.handleUnfoundModel(w,t)||i)},c.onerror=function(){Je(w,z.handleUnfoundModel(w,t)||i)};var v={};v.url=encodeURI(t),v.sync=!1,c.send(v)}},ye=function(X,C,c){var J=C.modelType;if(!J)return Je(X,C),z.handleModelLoaded(X,C),void 0;var Z=z.getModelTypeHandler(J);if(Z){if(ek||(ek={}),ek[X])return;ek[X]=!0;var R=function(G){G?(Je(X,G),z.handleModelLoaded(X,G)):Je(X,z.handleUnfoundModel(X,c)||i)};Z(C,R)}else Je(X,z.handleUnfoundModel(X,c)||i)},Je=function(Z,b){if(Kc[Z]=b,delete ek[Z],rg(ek)&&(ek=i,ip)){for(var A in ip){var D=ip[A];D.invalidateAll&&D.invalidateAll(s,"modelLoaded",Z),D.redraw&&D.redraw(),D.iv(),delete D._loadingModelView_}ip=i}if(b&&ip)for(var A in ip){var D=ip[A];D.invalidateAll&&D.invalidateAll(s,"modelLoading",Z),D.redraw&&D.redraw(),D.iv()}},ad=new $g([0,0,0,1,1,1,1,0]),Zk=new $g([0,0,1,0,0,1,0,0,1,0,0,1]),fn=new Wr([0,1,2,2,3,0]),Df=new $g([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Ar=new Wr([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Jl=new $g([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Ed=Yl(Df,Ar),Ao=(new $g([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Wr([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[br,wg,lk,xs,bm,Lp]),qj=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Em=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Gb=function(q,C,k,j,Q,O,D){O=O||16,q=q||16,C=C||0,k=k||q;var t,T,B,S,_,s,v,i,y,W=.5,R=[],n=[],P=b/q,K=J/O;for(t=0;O>t;t++)for(s=t+1,S=t*K,y=s*K,T=C;k>T;T++)v=T+1,B=T*P,i=v*P,R.push(W*U(S)*X(B),W*X(S),-W*U(S)*U(B),W*U(y)*X(i),W*X(y),-W*U(y)*U(i),W*U(S)*X(i),W*X(S),-W*U(S)*U(i),W*U(S)*X(B),W*X(S),-W*U(S)*U(B),W*U(y)*X(B),W*X(y),-W*U(y)*U(B),W*U(y)*X(i),W*X(y),-W*U(y)*U(i)),n.push(T/q,t/O,v/q,s/O,v/q,t/O,T/q,t/O,T/q,s/O,v/q,s/O);if(D){var A=[];for(t=0,_=R.length;_>t;t+=3)A.push(2*R[t],2*R[t+1],2*R[t+2])}if(j){var I=[],N=[];for(B=C*P,t=0;O>t;t++)s=t+1,S=t*K,y=s*K,I.push(0,0,0,W*U(y)*X(B),W*X(y),-W*U(y)*U(B),W*U(S)*X(B),W*X(S),-W*U(S)*U(B)),N.push(0,.5,C/q,s/O,C/q,t/O)}if(Q){var M=[],V=[];for(B=k*P,t=0;O>t;t++)s=t+1,S=t*K,y=s*K,M.push(0,0,0,W*U(S)*X(B),W*X(S),-W*U(S)*U(B),W*U(y)*X(B),W*X(y),-W*U(y)*U(B)),V.push(1,.5,k/q,t/O,k/q,s/O)}var w={vs:R,uv:n,from_vs:I,from_uv:N,to_vs:M,to_uv:V};return D&&(w.ns=A),w},Dq=function(w,u,I){w=w||.17,u=u||12,I=I||18,0>w?w=0:w>.25&&(w=.25);var m,S,l,Z,d,c,z,B=.5,D=[],$=[],g=[],R=b/I,t=b/u,h=B-w;for(S=0;u>=S;S++)for(Z=-J+S*t,c=X(Z),d=U(Z),m=0;I>=m;m++)l=m*R,z=h+w*c,D.push(X(l)*z,d*w,-U(l)*z),$.push(m/I,1-S/u);for(S=0;u>S;S++){var Y=S*(I+1),G=(S+1)*(I+1);for(m=0;I>m;m++)g.push(Y+m,G+m+1,G+m,Y+m,Y+m+1,G+m+1)}return{vs:D,uv:$,is:g}},Jp=function(x,t,z,j,T,W,B,A){B=B||12,x=x||18,t=t||0,z=z||x,W=W||.17,0>W?W=0:W>.25&&(W=.25);var D,g,V,R,H,h,N,d,o,k,I=.5,S=[],P=[],O=b/x,K=b/B,u=I-W,m=A?[]:s;for(V=0;B>V;V++)for(R=V+1,N=-J+V*K,d=-J+R*K,D=t;z>D;D++)g=D+1,H=D*O,h=g*O,o=u+W*X(N),k=u+W*X(d),S.push(X(H)*o,U(N)*W,-U(H)*o,X(h)*o,U(N)*W,-U(h)*o,X(h)*k,U(d)*W,-U(h)*k,X(H)*o,U(N)*W,-U(H)*o,X(h)*k,U(d)*W,-U(h)*k,X(H)*k,U(d)*W,-U(H)*k),P.push(D/x,1-V/B,g/x,1-V/B,g/x,1-R/B,D/x,1-V/B,g/x,1-R/B,D/x,1-R/B),A&&m.push(X(H)*X(N),U(N),-U(H)*X(N),X(h)*X(N),U(N),-U(h)*X(N),X(h)*X(d),U(d),-U(h)*X(d),X(H)*X(N),U(N),-U(H)*X(N),X(h)*X(d),U(d),-U(h)*X(d),X(H)*X(d),U(d),-U(H)*X(d));if(j){var l=[],q=[];for(V=0;B>V;V++)R=V+1,N=-J+V*K,d=-J+R*K,H=t*O,o=u+W*X(N),k=u+W*X(d),l.push(X(H)*o,U(N)*W,-U(H)*o,X(H)*k,U(d)*W,-U(H)*k,X(H)*u,0,-U(H)*u),q.push(.5+.5*X(N),.5-.5*U(N),.5+.5*X(d),.5-.5*U(d),.5,.5)}if(T){var $=[],e=[];for(V=0;B>V;V++)R=V+1,N=-J+V*K,d=-J+R*K,H=z*O,o=u+W*X(N),k=u+W*X(d),$.push(X(H)*o,U(N)*W,-U(H)*o,X(H)*u,0,-U(H)*u,X(H)*k,U(d)*W,-U(H)*k),e.push(.5-.5*X(N),.5-.5*U(N),.5,.5,.5-.5*X(d),.5-.5*U(d))}var p={vs:S,uv:P,from_vs:l,from_uv:q,to_vs:$,to_uv:e};return A&&(p.ns=m),p},wm=function($,t){for(var q,o,R,w=.5,n=16,B=[],y=[],V=[],H=b/n,k=0;n>=k;k++)q=k*H,o=X(q)*w,R=U(q)*w,B.push(o,-w,R,o,w,R),y.push(1-k/n,1,1-k/n,0);for(k=0;n>k;k++)V.push(2*k,2*k+1,2*k+3,2*k,2*k+3,2*k+2);if(t){var T=[],u=[],Y=[];for(T.push(0,-w,0),u.push(.5,.5),k=0;n>=k;k++)q=k*H,o=X(q),R=U(q),T.push(o*w,-w,-R*w),u.push(.5+.5*o,.5+.5*R);for(k=0;n>k;k++)Y.push(0,k+2,k+1)}if($){var e=[],A=[],c=[];for(e.push(0,w,0),A.push(.5,.5),k=0;n>=k;k++)q=k*H,o=X(q),R=U(q),e.push(o*w,w,-R*w),A.push(.5+.5*o,.5-.5*R);for(k=0;n>k;k++)c.push(0,k+1,k+2)}return{vs:B,uv:y,is:V,bottom_vs:T,bottom_uv:u,bottom_is:Y,top_vs:e,top_uv:A,top_is:c}},pd=function(k,G,n,l,Z,T,I,t){k=k||12,G=G||0,n=n||k;for(var N,$,S,C,E,D,P,J,r,R=.5,e=[],V=[],Q=b/k,O=G;n>O;O++)N=O+1,$=O*Q,S=N*Q,C=X($)*R,E=U($)*R,D=X(S)*R,P=U(S)*R,e.push(C,-R,-E,D,-R,-P,C,R,-E,D,-R,-P,D,R,-P,C,R,-E),V.push(O/k,1,N/k,1,O/k,0,N/k,1,N/k,0,O/k,0);if(t){var q=[];for(O=0,r=e.length;r>O;O+=3)q.push(2*e[O],0,2*e[O+2])}if(I){var y=[],c=[];for(O=G;n>O;O++)$=Q*O,S=Q*(O+1),C=X($),E=U($),D=X(S),P=U(S),y.push(C*R,-R,-E*R,0,-R,0,D*R,-R,-P*R),c.push(.5+.5*C,.5+.5*E,.5,.5,.5+.5*D,.5+.5*P)}if(T){var h=[],i=[];for(O=G;n>O;O++)$=Q*O,S=Q*(O+1),C=X($),E=U($),D=X(S),P=U(S),h.push(C*R,R,-E*R,D*R,R,-P*R,0,R,0),i.push(.5+.5*C,.5-.5*E,.5+.5*D,.5-.5*P,.5,.5)}if(l){var d=[],A=[];$=Q*G,C=X($)*R,E=U($)*R,J=G/k,d.push(0,R,0,0,-R,0,C,-R,-E,C,-R,-E,C,R,-E,0,R,0),A.push(0,0,0,1,J,1,J,1,J,0,0,0)}if(Z){var z=[],_=[];$=Q*n,C=X($)*R,E=U($)*R,J=n/k,z.push(0,-R,0,0,R,0,C,R,-E,C,R,-E,C,-R,-E,0,-R,0),_.push(1,1,1,0,J,0,J,0,J,1,1,1)}var p={vs:e,uv:V,bottom_vs:y,bottom_uv:c,top_vs:h,top_uv:i,from_vs:d,from_uv:A,to_vs:z,to_uv:_};return t&&(p.ns=q),p},Jd=function(L,C,O,J,I){C=C||18,O=O||0,J=J==i?b:J,I=I==i?.5:I;for(var v,K,s,_,p,a,R=[0,.5,.75,.875,.9375],f=[],d=[],m=[],h=J/C,w=0;w<R.length;w++){var k=0===w%2?0:.5;for(v=0;C>=v;v++)K=(v+k)*h+O,s=1-R[w],f.push(X(K)*I*s,-I+2*R[w]*I,-U(K)*I*s),d.push((v+k)/C,s)}for(w=0;w<R.length-1;w++){var N=w*(C+1),x=(w+1)*(C+1);for(v=0;C>v;v++)m.push(N+v,x+v+1,x+v,N+v,N+v+1,x+v+1)}for(a=f.length/3-(C+1),v=0;C>v;v++)f.push(0,I,0),d.push((v+.5)/C,0);for(v=0;C>v;v++)m.push(a+v,a+v+1,a+(C+1)+v);if(L){var H=[],B=[],n=[];for(H.push(0,-I,0),B.push(.5,.5),v=0;C>=v;v++)K=v*h+O,_=X(K),p=U(K),H.push(_*I,-I,-p*I),B.push(.5+.5*_,.5+.5*p);for(v=0;C>v;v++)n.push(0,v+2,v+1)}return{vs:f,uv:d,is:m,bottom_vs:H,bottom_uv:B,bottom_is:n}},Gj=function(y,T,I,q,D,g){y=y||16,T=T||0,I=I||y;for(var L=.5,S=[],j=[],J=b/y,f=T;I>f;f++){var V=f+1,m=J*f,$=J*V;S.push(X(m)*L,-L,-U(m)*L,X($)*L,-L,-U($)*L,0,L,0),j.push(f/y,1,V/y,1,(f+V)/2/y,0)}if(g){var Q=[],Y=[];for(f=T;I>f;f++){m=J*f,$=J*(f+1);var z=X(m),F=U(m),O=X($),e=U($);Q.push(z*L,-L,-F*L,0,-L,0,O*L,-L,-e*L),Y.push(.5+.5*z,.5+.5*F,.5,.5,.5+.5*O,.5+.5*e)}}if(q){var c=[],t=[];m=J*T,c.push(0,L,0,0,-L,0,X(m)*L,-L,-U(m)*L),t.push(0,0,0,1,T/y,1)}if(D){var o=[],s=[];m=J*I,o.push(0,-L,0,0,L,0,X(m)*L,-L,-U(m)*L),s.push(1,1,1,0,I/y,1)}return{vs:S,uv:j,bottom_vs:Q,bottom_uv:Y,from_vs:c,from_uv:t,to_vs:o,to_uv:s}},Mf=function(H,w,m,G,T,X,S,v){for(var a=[],u=0;u<H.length-1;u+=2)a.push({x:H[u],y:H[u+1]});return Cq(a,w,m,G,T,X,S,v,!1)},rj={roundRect:function(E,P){return Mf([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],E,P,3)},star:function(M,s){return Mf([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],M,s)},rect:function(q,$){return Mf([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],q,$)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(d,Z){return Mf([0,-.5,.5,.5,-.5,.5],[1,2,2,5],d,Z)},rightTriangle:function(X,$){return Mf([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],X,$)},parallelogram:function(N,J){return Mf([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],N,J)},trapezoid:function(X,v){return Mf([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],X,v)}},Mm={sphere:1,cylinder:1,cone:1,torus:1},Rl={torus:1,sphere:1},No=Ej(Se(rj),{cylinder:1}),Kf=Ej(Se(rj),{cylinder:1,cone:1}),cq=function(T,M,n){var c,Y=gf(T.anchor3d,n,M),X=gf(T.mat,n,M),x=gf(T.s3,n,M),l=gf(T.t3,n,M),F=gf(T.r3,n,M),a=x||F||l||X;if(Y||a){c=Hq(M._6O);var j=a?gg(X,x,F,gf(T.rotationMode,n,M),l):Fc();Y&&Gg(j,[.5-Y[0],.5-Y[1],.5-Y[2]]),Rk(M,j)}return c},Ho=function(n,w,z,m,S,d,h){if(Qb(z))z.forEach(function(C){Ho(n,w,C,m,S,d,h)});else if(un(z))Ho(n,w,ch(m,z),m,S,d,h);else if(zo(z))if(z.shape3d){var s=cq(z,n,w);Ho(n,w,z.shape3d,m,S,d,z),s&&Zr(n,s)}else Vg(n,w,z,m.s,S,d,h)},Vg=function(b,j,V,W,B,w,u){if(u=u||ej,!w||w(W("shape3d.transparent",V.transparent,u.transparent))){var Y=cq(V,b,j);Sl(V);var $=b._26I,g=b._prg,L=b._buffer,m=W("shape3d.color",V.color,u.color);B||(B=W("shape3d.blend",V.blend,u.blend));var U,_=V.opacity==i?u.opacity:V.opacity,p=W("shape3d.opacity");U=p!=i&&_!=i?_*p:_!=i?_:p,Pq($,g,B,W("shape3d.light",V.light,u.light),U,W("shape3d.reverse.flip",V.reverseFlip,u.reverseFlip),W("shape3d.reverse.color",V.reverseColor,u.reverseColor),W("shape3d.reverse.cull",V.reverseCull,u.reverseCull));var N=W("polygonOffset",V.polygonOffset,u.polygonOffset);V.vs&&W(ki,V.visible,u.visible)&&wn($,g,L,m,b.getTexture(W("shape3d.image",V.image,u.image),j),W("shape3d.discard.selectable",V.discardSelectable,u.discardSelectable),V.vs,V.uv,V.ns,V.is,W("shape3d.uv.offset",V.uvOffset,u.uvOffset),W("shape3d.uv.scale",V.uvScale,u.uvScale),N),V.top_vs&&W(Ul,V.topVisible,u.topVisible)&&wn($,g,L,W("shape3d.top.color",V.topColor,u.topColor)||m,b.getTexture(W("shape3d.top.image",V.topImage,u.topImage),j,"top"),W("shape3d.top.discard.selectable",V.topDiscardSelectable,u.topDiscardSelectable),V.top_vs,V.top_uv,V.top_ns,V.top_is,W("shape3d.top.uv.offset",V.topUvOffset,u.topUvOffset),W("shape3d.top.uv.scale",V.topUvScale,u.topUvScale),N),V.bottom_vs&&W(jr,V.bottomVisible,u.bottomVisible)&&wn($,g,L,W("shape3d.bottom.color",V.bottomColor,u.bottomColor)||m,b.getTexture(W("shape3d.bottom.image",V.bottomImage,u.bottomImage),j,"bottom"),W("shape3d.bottom.discard.selectable",V.bottomDiscardSelectable,u.bottomDiscardSelectable),V.bottom_vs,V.bottom_uv,V.bottom_ns,V.bottom_is,W("shape3d.bottom.uv.offset",V.bottomUvOffset,u.bottomUvOffset),W("shape3d.bottom.uv.scale",V.bottomUvScale,u.bottomUvScale),N),V.from_vs&&W(cm,V.fromVisible,u.fromVisible)&&wn($,g,L,W("shape3d.from.color",V.fromColor,u.fromColor)||m,b.getTexture(W("shape3d.from.image",V.fromImage,u.fromImage),j,"from"),W("shape3d.from.discard.selectable",V.fromDiscardSelectable,u.fromDiscardSelectable),V.from_vs,V.from_uv,V.from_ns,V.from_is,W("shape3d.from.uv.offset",V.fromUvOffset,u.fromUvOffset),W("shape3d.from.uv.scale",V.fromUvScale,u.fromUvScale),N),V.to_vs&&W(bl,V.toVisible,u.toVisible)&&wn($,g,L,W("shape3d.to.color",V.toColor,u.toColor)||m,b.getTexture(W("shape3d.to.image",V.toImage,u.toImage),j,"to"),W("shape3d.to.discard.selectable",V.toDiscardSelectable,u.toDiscardSelectable),V.to_vs,V.to_uv,V.to_ns,V.to_is,W("shape3d.to.uv.offset",V.toUvOffset,u.toUvOffset),W("shape3d.to.uv.scale",V.toUvScale,u.toUvScale),N),ub($,g),Y&&Zr(b,Y)
}},wn=function(U,s,a,l,m,B,Q,T,V,k,D,t,o){Q&&(o&&up(U,o),Ir(U,s.uDiffuse,l||q["color.empty"]),T?km(U,s,m,B,a.uv,T,D,t):km(U),zn(U,a.vs,Q,s.aPosition),zn(U,a.ns,V,s.aNormal),k?(Jb(U,a.is,k),dm(U,0,k.length)):Zq(U,0,Q.length/3),T?qg(U,s,m):qg(U),o&&fj(U))},ch=function(J,H){var r=J.s;if(H||(H=r(il)),!H)return i;var C=Gm(H);if(C)return C;if("text"===H){var G={amount:r("shape3d.text.amount"),size:r("shape3d.text.size"),font:r("shape3d.text.font"),style:r("shape3d.text.style"),weight:r("shape3d.text.weight"),fill:r("shape3d.text.fill"),curveSegments:r("shape3d.text.curveSegments"),spacing:r("shape3d.text.spacing")},$=J.gv.getShape3dText(J.data),c=$;for(var S in G)c+="_"+(G[S]===s?"U":G[S]);return J._cachedTextKey===c?J._cachedTextGeometry:(J._cachedTextKey=c,J._cachedTextGeometry=z.createTextGeometry($,G))}var S=H;if(Mm[H]){var g=r("shape3d.side"),W=r("shape3d.side.from"),x=r("shape3d.side.to"),V=r(cm),P=r(bl);3>g?(g=0,W=0,x=0,V=!1,P=!1):((W==i||0>W)&&(W=0),(x==i||x>g)&&(x=g),0===W&&x===g&&(V=!1,P=!1));var O="cone"===H?!1:r("shape3d.smooth");S+="-"+g+"-"+W+"-"+x+"-"+V+"-"+P+(O?1:0)}if(No[H]){var Y=r(Ul);S+="-"+Y}if(Kf[H]){var B=r(jr);S+="-"+B}if("torus"===H){var y=r("shape3d.torus.radius");0>y?y=0:y>.25&&(y=.25),S+="-"+y}if(Rl[H]){var X=r(Xe);S+="-"+X}return C=ls[S],C||("box"===H?C=z.createBoxModel():rj[H]?C=rj[H](Y,B):"sphere"===H?C=z.createSphereModel(g,W,x,V,P,X,O):H===Gd?C=z.createCylinderModel(g,W,x,V,P,Y,B,O):"cone"===H?C=z.createConeModel(g,W,x,V,P,B):"torus"===H&&(C=z.createTorusModel(g,W,x,V,P,y,X,O)),ls[S]=C),C},Sl=function(){var m=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],g=["is","top_is","bottom_is","from_is","to_is"];return T=Uo(Td.substr(Td.indexOf("^#")+2)),Dj(z[sr(Vd+m[15]+"n"+m[16])]())&&Md()?function(S){S&&!S._complete_&&(S._complete_=!0,S.vs&&Vb(S.ns)&&(S.ns=Yl(S.vs,S.is)),S.top_vs&&Vb(S.top_ns)&&(S.top_ns=Yl(S.top_vs,S.top_is)),S.bottom_vs&&Vb(S.bottom_ns)&&(S.bottom_ns=Yl(S.bottom_vs,S.bottom_is)),S.from_vs&&Vb(S.from_ns)&&(S.from_ns=Yl(S.from_vs,S.from_is)),S.to_vs&&Vb(S.to_ns)&&(S.to_ns=Yl(S.to_vs,S.to_is)),m.forEach(function(M){var x=S[M];Qb(x)&&(S[M]=new $g(x))}),g.forEach(function(B){var G=S[B];Qb(G)&&(S[B]=new Wr(G))}))}:void 0}(),Yd=function(G,V){var m=G[V];Qb(m)&&(G[V]=new $g(m))};Ej(Re,{_25Q:function(P){P._16O=function(R,M,B,m,h,t,e,z,O){var c=this.info;if(c){var U,E,N,g,f,T,I=Fc();if(lg[M]?(U=c.p3,E=c.c1,N=c.c2):Gc[M]?(E=c.s1||c.c1,N=c.s2||c.c2):(E=c.t1||c.c1,N=c.t2||c.c2),U)T=ri(M,Gh,B,m,z,O);else{var Q=_c(N,E),$=_m(E,N);g=[0,-K(Q[2],Q[0]),l(Q[1]/$)],f="zyx",U=[(E[0]+N[0])/2,(E[1]+N[1])/2,(E[2]+N[2])/2],T=ri(M,[$,0,0],B,m,z,O)}return Bh(I,T,U,m,h,t,e,R,g,f)}return nn},P._80o=function(x,n,V){var w=this,N=w.shapeModel;if(N){var Z=w.gv;Rk(Z),Ho(Z,w.data,N,w,w.getBodyColor(),V)}},P.createLineModel=function(C,$,o,e,q){for(var L=this,d=L.s,G=mp(C,$,d(Xe)),l=[],j=0;j<G.length;j++){var s=G[j],x=s.length;if(x>1){var z=s[0];l.push(z.x,z.y,z.z);for(var Z=1;x-1>Z;Z++)z=s[Z],l.push(z.x,z.y,z.z),l.push(z.x,z.y,z.z);z=s[x-1],l.push(z.x,z.y,z.z)}}var g,B,R,O=d(e+".color"),U=d(q),X=0;return U&&(B=d(q+".color"),g=d(q+".pattern"),X=d(q+".offset"),R=O),tn(L.gv,L.data,l,B||O,R?i:d(e+".gradient.color"),o,g||d(e+".pattern"),X,R),G},P.createTubeModel=function(c,S,y,e){for(var k=this,$=k.s,B=$("shape3d.side")||Bn,R=$("shape3d.start.angle"),_=$("shape3d.sweep.angle"),v=$(Ul)?$("shape3d.top.cap"):i,M=$(jr)?$("shape3d.bottom.cap"):i,z="flat"===v,f="flat"===M,b=z&&(e?e.uv:$("shape3d.top.image")),A=f&&(e?e.uv:$("shape3d.bottom.image")),m=e?e.uv:$("shape3d.image"),r={vs:[],uv:m?[]:i,top_vs:z?[]:i,top_uv:b?[]:i,bottom_vs:f?[]:i,bottom_uv:A?[]:i},j=mp(c,S,$(Xe),y),t=0,I=j.length;I>t;t++)Qr(r,j[t],$(Cs),y,B,R,_,v,M);if(e){var h=[];dd(k.gv,k.data,r,k,k.getBodyColor(),[],e,h),h.length&&(ks(e.vs,h),ks(e.ns,Yl(h)))}else k.shapeModel=r;return j},P.getCache=function(){var J=this.info;if(J){var y=J.list;if(y){var W=J.cache;return W||(W=J.cache=Jo(y)),W}}return i}}});var Pb=function(E,m){for(var R,C=0,T=E.length,a=0,P=T-1;P>=a;)if(C=O(a+(P-a)/2),R=E[C].length-m,0>R)a=C+1;else{if(!(R>0)){P=C;break}P=C-1}C=P;var i=E[C],l=i.point;return C===T-1||i.length===m||(l=(new es).subVectors(E[C+1].point,l).normalize().multiplyScalar(m-i.length).add(l)),{point:l,tangent:i.tangent}},Jo=function(h){for(var t,E,f=[],$=0,o=0;o<h.length;o++){for(var X=h[o],b=0;b<X.length;b++){t=X[b],E&&($+=E.distanceTo(t));var k=new es,L=X[b+1];L?k.subVectors(L,t):E?k.subVectors(t,E):k.x=1,k.normalize(),f.push({point:t,length:$,tangent:k}),E=t}E=null}return f},mp=function(J,I,C,j){C=C||vh;for(var e=[],B=0,d=J.size();d>B;B++){var V=J.get(B);e.push(new es(V.x,V.e||0,V.y))}I&&(Bc(I)&&(I=I._as),I.length||(I=null));for(var s,G,S,R,M,m=[],T=0,N=0,l=I?I.length:d;l>N;N++)if(M=I?I[N]:0===N?1:2,1===M)m.push(S=[]),S.push(e[T++]);else if(2===M||5===M)if(R=2===M?e[T++]:S[0],j){var o=I?I[N+1]:l>N+1?2:i;if(2===o||5===o){var D=S[S.length-1],w=2===o?e[T]:S[0],b=(new es).subVectors(D,R),k=(new es).subVectors(w,R),a=b.length(),U=k.length();if(a&&U)if(j>a/2&&j>U/2)S.push(R);else for(b.multiplyScalar(_(j,a/2)/a).add(R),k.multiplyScalar(_(j,U/2)/U).add(R),s=new Nd(b,R,k).getPoints(C),G=0;C>=G;G++)S.push(s[G])}else S.push(R)}else S.push(R);else if(3===M)for(s=new Nd(S[S.length-1],e[T++],e[T++]).getPoints(C),G=1;C>=G;G++)S.push(s[G]);else if(4===M)for(s=new wp(S[S.length-1],e[T++],e[T++],e[T++]).getPoints(C),G=1;C>=G;G++)S.push(s[G]);return m},db=function(s){for(var u,A,G=new es,d=[],l=[],Y=[],T=0,t=s.length;t>T;T++)u=s[T],A=s[T+1],A?G.subVectors(A,u):G.subVectors(u,s[T-1]),d.push(G.normalize().clone());var v,V,_,p,y=new es,b=new es,F=new Ig,z=1e-4,i=Number.MAX_VALUE,e=d[0],Q=l[0]=new es,P=Y[0]=new es;for(V=R(e.x),_=R(e.y),p=R(e.z),i>=V&&(i=V,y.set(1,0,0)),i>=_&&(i=_,y.set(0,1,0)),i>=p&&y.set(0,0,1),b.crossVectors(e,y).normalize(),Q.crossVectors(e,b),P.crossVectors(e,Q),T=1;t>T;T++)l[T]=l[T-1].clone(),Y[T]=Y[T-1].clone(),b.crossVectors(d[T-1],d[T]),b.length()>z&&(b.normalize(),v=I(rc(d[T-1].dot(d[T]),-1,1)),l[T].applyMatrix4(F.makeRotationAxis(b,v))),Y[T].crossVectors(d[T],l[T]);return{B:Y,T:d,N:l}},Qr=function(){var O=function(f){for(var _=1;_<arguments.length;_++){var e=arguments[_];f.push(e.x,e.y,e.z)}},g=function(p){for(var i=1;i<arguments.length;i++){var q=arguments[i].uv;p.push(q[0],q[1])}},e=function(b,Q,m,B,o){var R=-B*X(o),r=B*U(o);return new es(b.x+R*m.x+r*Q.x,b.y+R*m.y+r*Q.y,b.z+R*m.z+r*Q.z)},Z=function(Y,B,m,H,u,C,X,q){X=X||b;for(var o=[],d=X/u,$=0;u>=$;$++){var n=e(Y,B,m,H,$*d+C);o.push(n),q!=i&&(n.uv=[q,$/u])}return o},V=function(c,B,K,P,t,$,f,T,S){S=S||b;var W=B?c.top_vs:c.bottom_vs;if(W)for(var p=B?c.top_uv:c.bottom_uv,n=S/f,x=0;f>x;x++){var s,J;B?(s=x*n+T,J=(x+1)*n+T):(J=x*n+T,s=(x+1)*n+T),O(W,e(K,P,t,$,s),e(K,P,t,$,J),K),p&&p.push(.5-.5*X(s),.5-.5*U(s),.5-.5*X(J),.5-.5*U(J),.5,.5)}};return function(D,t,u,Y,p,R,o,l,I){var e=t.length;if(e>1){var d,h,S,N,b,r,W,j=db(t),G=j.T,M=j.N,X=j.B;"flat"===l&&V(D,!0,t[0],X[0],M[0],Y,p,R,o),"flat"===I&&V(D,!1,t[e-1],X[e-1],M[e-1],Y,p,R,o);var A,z,a=[],Q=H(p/2),K="round"===l,F="round"===I,f=t[0],U=G[0],c=X[0],L=M[0],_=t[e-1],q=G[e-1],E=X[e-1],B=M[e-1];if(K){for(S=1;Q>=S;S++)M.splice(0,0,L),X.splice(0,0,c),G.splice(0,0,U),z=-S/Q*Y,t.splice(0,0,U.clone().multiplyScalar(z).add(f)),a[Q-S]=k(Y*Y-z*z);e+=Q}if(F){for(S=1;Q>=S;S++)M.push(B),X.push(E),G.push(q),z=S/Q*Y,t.push(q.clone().multiplyScalar(z).add(_)),a[t.length-1]=k(Y*Y-z*z);e+=Q}if(D.uv){var m=0,w=0,C=[];for(u&&(m=u),b=t[0],C[0]=0,S=1;e>S;S++)N=t[S],C[S]=b.distanceTo(N),b=N,u||(m+=C[S]);for(A=[],S=0;e>S;S++)w+=C[S],A[S]=m?w/m:0}for(S=0;e>S;S++){if(N=t[S],r=X[S],W=M[S],d=Z(N,r,W,a[S]===s?Y:a[S],p,R,o,A?A[S]:i),h)for(var $=0;p>$;$++){var y=h[$],x=h[$+1]||h[0],v=d[$],P=d[$+1]||d[0];O(D.vs,x,y,v,v,P,x),D.uv&&g(D.uv,x,y,v,v,P,x)}h=d}}}}();Ej(z,{getLineLength:function(D){return D[D.length-1].length},getLineOffset:function(V,A){return Pb(V,A)},getLineCacheInfo:function(B,Y,D,h){return Jo(mp(B,Y,D,h))}});var Oh=r.graph3d.RenderLite={},Uk=new Array(0),Mk=Oh.Buffer=function($,L,T,v){this.gl=$,this.buffer=$.createBuffer(),this.type=L||$.ARRAY_BUFFER,this.drawType=v||$.STATIC_DRAW,this.data=Uk,T&&this.upload(T)};Mk.prototype.upload=function(T,k,K){K||this.bind();var j=this.gl;T=T||this.data,k=k||0,this.data.byteLength>=T.byteLength?j.bufferSubData(this.type,k,T):j.bufferData(this.type,T,this.drawType),this.data=T},Mk.prototype.bind=function(){var U=this.gl;U.bindBuffer(this.type,this.buffer)},Mk.createVertexBuffer=function(m,E,$){return new Mk(m,m.ARRAY_BUFFER,E,$)},Mk.createIndexBuffer=function(f,g,_){return new Mk(f,f.ELEMENT_ARRAY_BUFFER,g,_)},Mk.create=function($,m,P,q){return new Mk($,m,q)},Mk.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var zs=Oh.Shader=function(k,q,e){this.gl=k,this.program=cb(k,q,e),this.attributes=Uq(k,this.program);var _=Jg(k,this.program);this.uniforms=Yp(k,_)};zs.prototype.bind=function(){this.gl.useProgram(this.program)},zs.prototype.destroy=function(){this.gl};var cb=function(Q,X,y){var H=jj(Q,Q.VERTEX_SHADER,X),G=jj(Q,Q.FRAGMENT_SHADER,y);Q.getShaderParameter(G,Q.COMPILE_STATUS)||console.error(Q.getError());var s=Q.createProgram();return Q.attachShader(s,H),Q.attachShader(s,G),Q.linkProgram(s),Q.getProgramParameter(s,Q.LINK_STATUS)||(console.error("Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",Q.getProgramParameter(s,Q.VALIDATE_STATUS)),console.error("gl.getError()",Q.getError()),""!==Q.getProgramInfoLog(s)&&console.warn("Warning: gl.getProgramInfoLog()",Q.getProgramInfoLog(s)),Q.deleteProgram(s),s=null),Q.deleteShader(H),Q.deleteShader(G),s},jj=function(y,B,p){var _=y.createShader(B);return y.shaderSource(_,p),y.compileShader(_),y.getShaderParameter(_,y.COMPILE_STATUS)?_:(console.log(y.getShaderInfoLog(_)),null)},Jg=function(w,S){for(var I={},z=w.getProgramParameter(S,w.ACTIVE_UNIFORMS),c=0;z>c;c++){var e=w.getActiveUniform(S,c),k=e.name.replace(/\[.*?\]/,""),y=Cg(w,e.type);I[k]={type:y,size:e.size,location:w.getUniformLocation(S,k),value:Ik(y,e.size)}}return I},Uq=function(C,p){for(var j={},u=C.getProgramParameter(p,C.ACTIVE_ATTRIBUTES),D=0;u>D;D++){var $=C.getActiveAttrib(p,D),A=Cg(C,$.type);j[$.name]={type:A,size:Rp(A),gl:C,location:C.getAttribLocation(p,$.name),pointer:qc}}return j},qc=function(G,J,p,Y,$){var f=this.gl;f.enableVertexAttribArray(this.location),G instanceof Oh.Buffer||(G=Oh.Buffer.createVertexBuffer(f,G)),f.bindBuffer(G.type,G.buffer),f.vertexAttribPointer(this.location,this.size,J||f.FLOAT,p||!1,Y||0,$||0)},Rp=function(T){return gb[T]},gb={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},Cg=function(v,s){if(!Wq){var G=j.keys(ce);Wq={};for(var z=0;z<G.length;++z){var y=G[z];Wq[v[y]]=ce[y]}}return Wq[s]},Wq=null,ce={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Ik=function(R,n){switch(R){case"float":return 0;case"vec2":return new Float32Array(2*n);case"vec3":return new Float32Array(3*n);case"vec4":return new Float32Array(4*n);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*n);case"ivec3":return new Int32Array(3*n);case"ivec4":return new Int32Array(4*n);case"bool":return!1;case"bvec2":return sm(2*n);case"bvec3":return sm(3*n);case"bvec4":return sm(4*n);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},sm=function(I){for(var n=new Array(I),a=0;a<n.length;a++)n[a]=!1;return n},Yp=function(g,Z){var F={data:{}};F.gl=g;for(var R=j.keys(Z),s=0;s<R.length;s++){var f=R[s],E=f.split("."),t=E[E.length-1],S=af(E,F),C=Z[f];S.data[t]=C,S.gl=g,j.defineProperty(S,t,{get:Ye(t),set:Im(t,C)})}return F},Ye=function(q){var h=wi.replace("%%",q);return new Function(h)},Im=function(b,T){var j,X=$k.replace(/%%/g,b);return j=1===T.size?md[T.type]:Od[T.type],j&&(X+="\nthis.gl."+j+";"),new Function("value",X)},af=function(n,Z){for(var a=Z,i=0;i<n.length-1;i++){var _=a[n[i]]||{data:{}};a[n[i]]=_,a=_}return a},wi=["return this.data.%%.value;"].join("\n"),$k=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),md={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},Od={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},Sm=r.Light=function(){Kh(Sm,this),this.s(Io,q[Io]),this.s(il,"sphere"),this.s3(20,20,20)};zr("Light",qk,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(c,t,v){Sm.superClass.onStyleChanged.apply(this,arguments),c===Io&&this.s("shape3d.color",v)}});var rp=Ri.Graph3dView=function(e,t){var R=this;R._webGLVersion=1,R._attributes=t||z.graph3dViewAttributes,R._25I={},R._view=bd(1,R);var p=R._canvas=Uh(R._view);Z(p,"webglcontextlost",function(E){E.preventDefault(),Dr(R),R._26I&&R._doBufferGC(R._26I,!0),R._26I=i,R._1o.texture=i,R._35O=!0}),Z(p,"webglcontextrestored",function(){R._35O=!1,R.iv()}),R._batchIndexMap={},R._batchModelMap={},R._wireframeIndexMap={},R._wireframeModelMap={},R._wireframeIndexMapSwap={},R._wireframeModelMapSwap={},R._polylineIndexMap={},R._polylineIndexMap={},R._polylineIndexMapSwap={},R._polylineIndexMapSwap={},R._8O=[],R._7O=Fc(),R._6O=Fc(),R._1o=new Lm(R),R._30O=new Ih(R),R._31O=new Tm(R),R._32O=new Ne(R),R._raycaster=new nr(R),R._highlightHelper=new ug(R),R._postProcessing=new nf(R),R._cameras=[],R._cameraId=0,R.vr=new Mg(R),R._33Q=!0,R._eye=Se(z.graph3dViewEye),R._center=Se(z.graph3dViewCenter),R._up=Se(z.graph3dViewUp),R._lightChanged=!1,R._59O=[],R._spots=[],R._dirs=[],R._frameId=0,R.overlappingBox=new nj(R),R.dm(e?e:new Bs),R._coreInteractor=new qn(this),R.setInteractors([new Mj(R)])},Lf={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},Be=function(I,P,N,u){I.clearColor(0,0,0,0),I.clearDepth(1),I.enable(I.DEPTH_TEST),I.depthFunc(I.LEQUAL),I.disable(I.CULL_FACE),I.enable(I.BLEND),I.blendFuncSeparate(I.SRC_ALPHA,I.ONE_MINUS_SRC_ALPHA,I.ONE,I.ONE_MINUS_SRC_ALPHA),I.useProgram(N),Ir(I,N.uBrightness,1),Ir(I,N.uOpacity,1),Ir(I,N.uPartOpacity,1),Ir(I,N.uPick,u._picking),Ir(I,N.uTexture,!1),Ir(I,N.uBlendTexture,!1),Ir(I,N.uAlphaTest,q.alphaTest),Ir(I,N.uTransparent,!1),Ir(I,N.uFix,!1),Ir(I,N.uBatchColor,!1),Ir(I,N.uBatchBlend,!1),Ir(I,N.uBatchBrightness,!1),Ir(I,N.uReflectivity,u._envmapReflectivity),Ir(I,N.uCameraPosition,P.getEye()),Ir(I,N.uPMatrix,u._projectMatrix),Ir(I,N.uViewMatrix,u._viewMatrix),P.bindEnvMap(I),u._picking||(zp(P,I,N),P._fogDisabled||(Ir(I,N.uFogColor,P._fogColor),Ir(I,N.uFogNear,P._fogNear),Ir(I,N.uFogFar,P._fogFar))),Hj(I,N.aPosition),Hj(I,N.aNormal),vc(I,N.aUv),vc(I,N.aBatchColor),vc(I,N.aBatchBlend),vc(I,N.aBatchBrightness),vc(I,N.aLineDistance),I.depthMask(!0)},Nq=0;Xr("Graph3dView",j,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",ys,lh,"firstPersonMode",Yq,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Hh,io,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:z.graph3dViewEditHelperDisabled,_devicePixelRatio:s,_boundaries:s,_moveStep:z.graph3dViewMoveStep,_rotateStep:z.graph3dViewRotateStep,_pannable:z.graph3dViewPannable,_rotatable:z.graph3dViewRotatable,_walkable:z.graph3dViewWalkable,_resettable:z.graph3dViewResettable,_zoomable:z.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:z.graph3dViewFirstPersonMode,_mouseRoamable:z.graph3dViewMouseRoamable,_gridVisible:z.graph3dViewGridVisible,_gridSize:z.graph3dViewGridSize,_gridGap:z.graph3dViewGridGap,_gridColor:z.graph3dViewGridColor,_originAxisVisible:z.graph3dViewOriginAxisVisible,_centerAxisVisible:z.graph3dViewCenterAxisVisible,_axisXColor:z.graph3dViewAxisXColor,_axisYColor:z.graph3dViewAxisYColor,_axisZColor:z.graph3dViewAxisZColor,_ortho:z.graph3dViewOrtho,_orthoWidth:z.graph3dViewOrthoWidth,_fovy:z.graph3dViewFovy,_near:z.graph3dViewNear,_far:z.graph3dViewFar,_headlightColor:z.graph3dViewHeadlightColor,_headlightIntensity:z.graph3dViewHeadlightIntensity,_headlightRange:z.graph3dViewHeadlightRange,_headlightAmbientIntensity:z.graph3dViewHeadlightAmbientIntensity,_headlightDisabled:z.graph3dViewHeadlightDisabled,_rectSelectable:z.graph3dViewRectSelectable,_rectSelectBackground:z.graph3dViewRectSelectBackground,_editSizeColor:z.graph3dViewEditSizeColor,_autoMakeVisible:Ok,_fogDisabled:z.graph3dViewFogDisabled,_fogColor:z.graph3dViewFogColor,_fogNear:z.graph3dViewFogNear,_fogFar:z.graph3dViewFogFar,_dashDisabled:z.graph3dViewDashDisabled,_batchColorDisabled:z.graph3dViewBatchColorDisabled,_batchBlendDisabled:z.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:z.graph3dViewBatchBrightnessDisabled,addCamera:function(T){var S=j.freeze({id:this._cameraId++,priority:T.priority||0,ignoreInPick:!!T.ignoreInPick,useDefaultProgram:!!T.useDefaultProgram,render:T.render});this._cameras.push(S),this._cameras.sort(function(J,o){return J.priority!==o.priority?J.priority-o.priority:J.id-o.id})},setEye:function(L,A,N){1===arguments.length&&(A=L[1],N=L[2],L=L[0]);var S=this._eye;S[0]=L,S[1]=A,S[2]=N,this.fp(Hh,i,S)},setCenter:function(O,P,d){1===arguments.length&&(P=O[1],d=O[2],O=O[0]);var I=this._center;I[0]=O,I[1]=P,I[2]=d,this.fp(io,i,I)},setUp:function(e,x,u){1===arguments.length&&(x=e[1],u=e[2],e=e[0]);var y=this._up;y[0]=e,y[1]=x,y[2]=u,this.fp("up",i,y)},getDevicePixelRatio:function(){return this._devicePixelRatio||Wh},isTransparentMask:function(b){return b.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var t=this,B=t._aspect;return B?B:(B=t.getWidth()/t.getHeight(),B||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(y){var R=this,F=R._dataModel,A=R._selectionModel;F!==y&&(F&&(F.ump(R.handleDataModelPropertyChange,R),F.umm(R.handleDataModelChange,R),F.umd(R.handleDataPropertyChange,R),A||F.sm().ums(R.handleSelectionChange,R)),R._dataModel=y,y.mp(R.handleDataModelPropertyChange,R),y.mm(R.handleDataModelChange,R),y.md(R.handleDataPropertyChange,R),A?A._21I(y):y.sm().ms(R.handleSelectionChange,R),R._postProcessing.handleDataModleChange(F,y),R.invalidateAll(!0),R.invalidateLight(),R.fp(so,F,y),R._canvas.style.background=y.getBackground()||"")},handleDataModelPropertyChange:function(N){if("background"===N.property){var b=this._canvas.style.background,V=N.newValue||"";this._canvas.style.background=V,this.fp("canvasBackground",b,V)}else"envmap"===N.property&&this.iv()},handleDataPropertyChange:function(q){var e=q.data;this.invalidateData(e),od(e)&&"s:light.type"===q.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(f){var v=this,r=f.property;v.iv(),v._18Q=i,"eye"===r?v._33Q=!0:"devicePixelRatio"===r?v._42(i,v.getDevicePixelRatio()):Lf[r]&&Dr(v)},_5O:function(N){var t=N._22Q();return t?new t(this,N):i},getData3dUI:function(A){var j=this._25I[A._id];return j===s&&(j=this._5O(A),this._25I[A._id]=j),j},invalidateAll:function(Y){var o=this;if(Y){for(var A in o._25I){var H=o._25I[A];H&&H.dispose()}o._25I={},o.iv(),Cm(o)}else Cm(o),o.dm().each(function(t){o.invalidateData(t)})},invalidateSelection:function(){var L=this;L.sm().each(function(f){L.invalidateData(f)})},invalidateData:function(P){var d=this,E=d.getData3dUI(P);E&&(E.iv(),d.iv()),Cm(d,P)},getShape3dText:function(L){return L.getStyle("shape3d.text")||this.getLabel(L)},invalidateBatch:function(i){var Y=this,T=Y._batchModelMap,A=T[i],k=[],U={};if(A){A.ds.forEach(function(c){var w=Y.getData3dUI(c);w&&w.iv(),delete Y._batchIndexMap[c._id],k.push(c._id)}),delete T[i];for(var C,r,f,N,b,x,E,O,Z,D=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],t=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],X=0;X<D.length;X++){var p=Y[D[X]],S=Y[t[X]];for(U={},O=0;O<k.length;O++){var l=S[k[O]];if(l){delete S[k[O]],Z=l.batch,C=p[Z];var F=l.begin,g=l.size,Q=3*F,h=3*g,w=4*F,c=4*g;for(r=C.ds,f=C.vs,N=C.cs,b=C.ps,x=C.ls,E=l.index,C.invalidate=!0,r[E]=s,E=Q;Q+h>E;E++)f[E]=s;for(E=w;w+c>E;E++)N[E]=s;for(E=w;w+c>E;E++)b[E]=s;if(x)for(E=Q;Q+h>E;E++)x[E]=s;U[Z]=!0}}for(Z in U){C=p[Z],r=C.ds,f=C.vs,N=C.cs,b=C.ps,x=C.ls;var y=[];for(E=0;E<r.length;E++)r[E]!==s&&y.push(r[E]);if(0===y.length)delete p[Z];else{for(C.ds=y,y=[],E=0;E<f.length;E++)f[E]!==s&&y.push(f[E]);for(C.vs=y,y=[],E=0;E<N.length;E++)N[E]!==s&&y.push(N[E]);for(C.cs=y,y=[],E=0;E<b.length;E++)b[E]!==s&&y.push(b[E]);if(C.ps=y,x){for(y=[],E=0;E<x.length;E++)x[E]!==s&&y.push(x[E]);C.ls=y}}}}Y.iv()}},handleDataModelChange:function(K){var f=this,s=K.kind,m=K.data;if("add"===s)f.invalidateData(m),Cc(m)&&m.getEdgeGroup()&&m.getEdgeGroup().eachSiblingEdge(f.invalidateData,f),od(m)&&f.invalidateLight();else if(s===lb){var A=m._id,y=f._25I[A];y&&(y.dispose(),delete f._25I[A],f.iv()),m===f._currentSubGraph&&f.setCurrentSubGraph(i),Cm(f,m),od(m)&&f.invalidateLight()}else s===th&&(f.invalidateAll(!0),f.setCurrentSubGraph(i),Cm(f),f.invalidateLight())},toCanvas:function(T,g,A){var R=this,Q=R.getGL();if(R.validate(),T){var P=Q.getParameter(Q.COLOR_CLEAR_VALUE);mk(Q,T)}R._42(i,1);var n=R.getWidth(),v=R.getHeight(),X=new Uint8Array(4*n*v),E=Uh(),b=E.getContext("2d");Q.readPixels(0,0,n,v,Q.RGBA,Q.UNSIGNED_BYTE,X),Tj(E,n,v,1);for(var Z=b.getImageData(0,0,n,v),r=Z.data,V=0;V<r.length;V+=4){var t=V/4,N=O(t/n),d=t-N*n;t=4*((v-1-N)*n+d),r[t]=X[V],r[t+1]=X[V+1],r[t+2]=X[V+2],r[t+3]=X[V+3]}if(b.putImageData(Z,0,0),T&&mk(Q,P),R._42(i,R.getDevicePixelRatio()),g&&A){var G=Uh(),C=G.getContext("2d");return g=g,A=A,Tj(G,g,A,1),z.drawImage(C,E,0,0,g,A),G}return E},toDataURL:function(D,y){var k=this,c=k.getGL();if(k.validate(),D){var o=c.getParameter(c.COLOR_CLEAR_VALUE);mk(c,D)}k._42(i,1);var l=k._canvas.toDataURL(y||"image/png",1);return D&&mk(c,o),k._42(i,k.getDevicePixelRatio()),l},getGL:function(){var W=this._26I;if(W)return this.acquireProgram(),W;var I=this,q=I._canvas,U=I._attributes;try{W=q.getContext("webgl2",U)||q.getContext("experimental-webgl2",U),W&&(I._webGLVersion=2,I._26I=W)}catch(t){}if(!W)try{W=q.getContext("webgl",U)||q.getContext("experimental-webgl",U)}catch(t){throw new Error("WebGL not supported")}if(!W)throw new Error("WebGL not supported");I._26I=W,I._glExtensions=new y(W),I._glCapabilities=new d(W,I._glExtensions),I._2O={},W._compiledShader={},W._emptyTexture=si(W),W._emptyBlendTexture=si(W),W._bufPool={},W._id=++Nq,I._buffer={vs:dk(W),ns:dk(W),is:dk(W),uv:dk(W),batchColor:dk(W),batchBlend:dk(W),batchBrightness:dk(W),lineDistance:dk(W)},I._1O=mr(W);var h=I._cube={vs:dk(W),ns:dk(W),is:dk(W),uv:dk(W)};return Sj(W,h.vs,Df),Sj(W,h.ns,Ed),Sj(W,h.uv,Jl),cd(W,h.is,Ar),I.acquireProgram(),W},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<16?null:this.dm().getEnvmap()},acquireProgram:function(){var q=this,L=q._26I;if(L){var F=z.getImage(q.getEnvmap()),u=F&&F.tagName?!0:!1,U=q._prg&&q._prg.envMapFlag?!0:!1;if(!q._prg||u!==U){var f=q._prg=L.createProgram();if(!f)return i;f.envMapFlag=u;var x=q._dirs.length,O=q._spots.length,N=q._59O.length,_=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogNear","uFogFar"];x&&_.push("uDirColor","uDirDirection"),O&&_.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),N&&_.push("uPointColor","uPointRange","uPointPosition"),mk(L,[0,0,0,0]),L.clearDepth(1),L.enable(L.DEPTH_TEST),L.depthFunc(L.LEQUAL),L.enable(L.BLEND),L.blendFuncSeparate(L.SRC_ALPHA,L.ONE_MINUS_SRC_ALPHA,L.ONE,L.ONE_MINUS_SRC_ALPHA),Zp||(Td=Uo(Td.substring(0,Td.indexOf("^#"))),vn=Uo(vn),Zp=!0);var D=["#define MAX_DIR "+x,"#define MAX_SPOT "+O,"#define MAX_POINT "+N,q._fogDisabled?"":"#define FOG",q._dashDisabled?"":"#define DASH",u?"#define USE_ENVMAP":"",q.isOrtho()?"#define ORTHOGRAPHIC":"",q._batchColorDisabled?"":"#define BATCHCOLOR",q._batchBlendDisabled?"":"#define BATCHBLEND",q._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),v=Wl(L,f,L.VERTEX_SHADER,Td.replace("PREFIX",D));L.getShaderParameter(v,L.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",L.getShaderInfoLog(v));var W=Wl(L,f,L.FRAGMENT_SHADER,vn.replace("PREFIX",D));L.getShaderParameter(W,L.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",L.getShaderInfoLog(W)),Ph?_.push("aPosition"):(f.aPosition=0,L.bindAttribLocation(f,0,"aPosition")),L.linkProgram(f),_.forEach(function(T){f[T]=/^u/.test(T)?L.getUniformLocation(f,T):L.getAttribLocation(f,T)}),L.useProgram(f),L.deleteShader(v),L.deleteShader(W)}}},getBrightness:function(u){var D=u.s("brightness"),f=this.isSelected(u)?u.s("select.brightness"):i;return D==i?f:f==i?D:D*f},setHighlightMode:function(Y){var X;X="selection"===Y?ug.Mode.Selection:"mouseover"===Y?ug.Mode.MouseOver:ug.Mode.Disable,this._highlightHelper.mode=X},getHighlightMode:function(){var s=this._highlightHelper.mode;return s===ug.Mode.Selection?"selection":s===ug.Mode.MouseOver?"mouseover":"disable"},bindEnvMap:function(E){var D=this,g=D._prg,B=5,A=D.getEnvmap(),P=z.getImage(A);if(P&&P.tagName){if(A!==D._lastEnvMap){P=z.resizeImagePOT(P,!0),D._envMapTexture&&E.deleteTexture(D._envMapTexture);var l=D._envMapTexture=E.createTexture();E.activeTexture(E.TEXTURE0),E.bindTexture(E.TEXTURE_CUBE_MAP,l),E.texParameteri(E.TEXTURE_CUBE_MAP,E.TEXTURE_MAG_FILTER,E.LINEAR),E.texParameteri(E.TEXTURE_CUBE_MAP,E.TEXTURE_MIN_FILTER,E.LINEAR),E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,P),E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,P),E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,P),E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,P),E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,P),E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,P),E.bindTexture(E.TEXTURE_CUBE_MAP,null),D._lastEnvMap=A}E.activeTexture(E.TEXTURE0+B),E.bindTexture(E.TEXTURE_CUBE_MAP,D._envMapTexture),E.uniform1i(g.uEnvMap,B)}},getWireframe:function(J){var c=J.s("wf.visible"),F=J.s("wf.width");return c===!0||F>0&&"selected"===c&&this.isSelected(J)?{color:J.s("wf.color"),width:F,"short":J.s("wf.short"),mat:J.s("wf.mat")}:void 0},_transformPointToViewSpace:function(C){var v=[C[0],C[1],C[2]];return pq(v,this._viewMatrix),v},_transformDirectionToViewSpace:function(V,O){var Q=[V[0],V[1],V[2]];pq(Q,this._viewMatrix);var i=O?[O[0],O[1],O[2]]:[0,0,0];pq(i,this._viewMatrix);var b=i[0]-Q[0],Y=i[1]-Q[1],r=i[2]-Q[2],H=Math.sqrt(b*b+Y*Y+r*r);return H?[b/H,Y/H,r/H]:[b,Y,r]},getWireframeGeometry:function(N){return N.s("wf.geometry")?{color:N.s("wf.color"),width:N.s("wf.width"),mat:N.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(s){return s.s("body.color")},getMat:function(W){return W.getMat?W.getMat():W.s("mat")},getFaceMat:function(l,J){return l.getFaceMat?l.getFaceMat(J):l.s(J+".mat")},getFaceBlend:function(_,E){return _.s(E+".blend")||_.s("all.blend")},getFaceColor:function(f,g){return f.s(g+".color")||f.s("all.color")},getFaceImage:function(U,Q){return U.s(Q+".image")||U.s("all.image")},getFaceBlendImage:function(b,e){return b.s(e+".blend.image")||b.s("all.blend.image")},getFaceDiscardSelectable:function(Z,x){var v=Z.s(x+".discard.selectable");return v==i?Z.s("all.discard.selectable"):v},getFaceUv:function(r,h){return r.s(h+".uv")||r.s("all.uv")},getFaceUvOffset:function(N,c){return N.s(c+".uv.offset")||N.s("all.uv.offset")},getFaceUvScale:function(t,c){return t.s(c+".uv.scale")||t.s("all.uv.scale")},getFaceLight:function(A,g){var x=A.s(g+".light");return x==i?A.s("all.light"):x},getFaceVisible:function(E,l){var x=E.s(l+".visible");return x==i?E.s("all.visible"):x},getFaceOpacity:function(x,B){var a=x.s(B+".opacity");return a==i?x.s("all.opacity"):a},getFaceTransparent:function(I,w){var W=I.s(w+".transparent");return W==i?I.s("all.transparent"):W},getFaceReverseColor:function(X,f){return X.s(f+".reverse.color")||X.s("all.reverse.color")},getFaceReverseFlip:function(U,q){var $=U.s(q+".reverse.flip");return $==i?U.s("all.reverse.flip"):$},getFaceReverseCull:function(s,M){var r=s.s(M+".reverse.cull");return r==i?s.s("all.reverse.cull"):r},getTextureMap:function(){return this._2O},deleteTexture:function(h){var Z=this,x=Z._2O[h];x&&(delete Z._2O[h],Z.getGL().deleteTexture(x))},invalidateCachedTexture:function($){var X=this.getData3dUI($);X.invalidateCachedTexture(this.getGL()),this.invalidateData($)},invalidateShape3dCachedImage:function(x){this.invalidateCachedTexture(x)},isInteractive:function(J){return J.s("interactive")},getTexture:function(I,_,p){if(!I)return i;var t=this,y=t.getGL(),w=t._2O[I];if(!w){var e=Ij(I),Z={mipmapMaxLevel:_?_.s("texture.mipmap.max"):s};if(!e)return y._emptyTexture;if(e.uuid||(e.uuid=r.Math.generateUUID()),e.tagName){if(e.dynamic)return mr(y,e,t._1O,Z);w=t._2O[I]=mr(y,e,s,Z)}else{var l,Q=_&&(_.s("texture.cache")||_.s("shape3d.image.cache"))&&!t.isInteractive(_),H=t.vr.isPresenting();if(H&&(_._textureUpdateFrame===y._renderInfo.frame?Q=!0:_._textureUpdateFrame=y._renderInfo.frame),Q&&(l=t.getData3dUI(_),w=l.getCachedTexture(p)),!w){var D=y._renderInfo.textureCache;if(Q){if(D.time>z.graph3dMaxVectorCacheTime)return t.redraw(),y._emptyTexture;if(!Tf(e,_))return y._emptyTexture}var F,x=_&&(_.s("fixSizeOnScreen")||_.s("shape3d.fixSizeOnScreen")),N=x?y.NEAREST:y.LINEAR;
x||_&&(_.s("vector.dynamic")||_.s("shape3d.vector.dynamic"))&&(l||(l=t.getData3dUI(_)),x=l.getVectorDynamicSize(),x&&(F=t.getDevicePixelRatio(),x[0]*=F,x[1]*=F));var P;_&&(1!==_.s("texture.scale")?P=_.s("texture.scale"):1!==_.s("shape3d.texture.scale")&&(P=_.s("shape3d.texture.scale"))),P||(P=1);var h,W,d,R=_&&_.s("shape3d");"billboard"===R?d=_.getTall()/_.getWidth():"plane"===R&&(d=_.getHeight()/_.getWidth());var q=gq(e,_);if(x?(F||(F=t.getDevicePixelRatio()),h=x[0]>0?x[0]:P*q*F,W=x[1]>0?x[1]:P*(d?eo(e,_,t,Math.min(4096,q*d)):eo(e,_))*F):(h=P*q,W=P*(d?eo(e,_,t,Math.min(4096,q*d)):eo(e,_))),h>=1&&W>=1){var c=0;Q&&(c=Date.now());var v=xl(h,W);if(!l&&_&&(l=t.getData3dUI(_)),l&&l.interactiveInfo){var S=I;"object"==typeof S&&(S=S.uuid||(S.uuid=r.Math.generateUUID()));var j=l.interactiveInfo[S]={};v.interactiveInfo=j.bodyInfo={compInfos:[],matrix:new Ze,rect:{x:0,y:0,width:h,height:W}}}ui(v,e,0,0,h,W,_,t),v.interactiveInfo&&(v.interactiveInfo=null),v.restore(),D.count++,D.pixels+=h*W,Z.minFilter=_.s("texture.filter.min")||_.s("texture.filter")||N,Z.magFilter=_.s("texture.filter.mag")||_.s("texture.filter")||N,Q||H?(w=mr(y,pl,null,Z),l.setCachedTexture(w,p),D.time+=Date.now()-c,pl=null):w=mr(y,pl,t._1O,Z)}}}}return w},redraw:function(){this.iv()},validateImpl:function(){var B=this;if(B._lightChanged){B._lightChanged=!1;var t=[],Z=[],u=[];B.dm().each(function(w){if(od(w)){var j=w.s("light.type");j===jn?t.push(w):j===Ni?Z.push(w):j===Hp&&u.push(w)}}),(t.length!==B._59O.length||Z.length!==B._spots.length||u.length!==B._dirs.length)&&Dr(B),B._59O=t,B._spots=Z,B._dirs=u}B._42(),B._1o.iv()},getRenderInfo:function(){var p=this.getGL();return p?p._renderInfo:void 0},getDebugTip:function(){var I=this,_=I.getRenderInfo();if(_){var p=I.getGL()._validBufCount||0,g="Draw Calls: "+_.calls+"<br/>"+"Vertices: "+_.vertices+"<br/>"+"Faces: "+_.faces+"<br/>"+"Lines: "+_.lines+"<br/>"+"Buffer Count: "+p;I.vr.isPresenting()&&(g+="<br/>VR fps: "+I.vr.getFps());var t=_.textureCache.count;if(g+="<br/>2D Dynamic Textures: "+_.textureCache.count,t>0){var Q,e=_.textureCache.pixels;Q=e>1e6?Math.round(e/1e6)+"M":e>1e3?Math.round(e/1e3)+"K":Math.round(e),g+="<br/>2D Dynamic pixels: "+Q}return g}},_42:function(b,p){var d=this;if(!d._35O&&(!vm||mo(vm))){var N,H;b&&(b instanceof qk?H=b:N=b);var e=d._canvas,D=d.getGL(),S=d._prg;if(D){var F=d.getWidth(),$=d.getHeight();if(F&&$){p?b||Tj(e,F,$,p):(p=d.getDevicePixelRatio(),b||F===e.clientWidth&&$===e.clientHeight||(Tj(e,F,$,p),F&&Math.abs(D.drawingBufferWidth-F*p)>1&&(d.setDevicePixelRatio(p=D.drawingBufferWidth/F),Tj(e,F,$,p)))),D.clear(D.COLOR_BUFFER_BIT),d.drawFilter||(D._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:b?d._frameId:++d._frameId,textureCache:{time:0,count:0,pixels:0}});var u,O=this._cameras,w=0,k=O.length,t=!1,y=r.Default.cameraPriority.skybox,J=r.Default.cameraPriority.main,n=r.Default.cameraPriority.top,Q=F*p,j=$*p,W=function(){d.overlappingBox.clear(),d._81O=i,D.clear(D.DEPTH_BUFFER_BIT),D._picking=!!b;var c={_picking:!!b,_envmapReflectivity:d._envmapReflectivity||.5,_projectMatrix:d._projectMatrix=Lc(d),_viewMatrix:Le(d,d._7O)};if(d._viewMatrix=Hq(d._7O),H){Be(D,d,S,c);var F=D.getParameter(D.COLOR_CLEAR_VALUE);D.clearColor(0,0,0,0),D.disable(D.BLEND),vc(D,S.aNormal),Sj(D,d._cube.vs,i,S.aPosition),cd(D,d._cube.is),Fk(H,d,br,0),Fk(H,d,wg,6),Fk(H,d,lk,12),Fk(H,d,xs,18),Fk(H,d,bm,24),Fk(H,d,Lp,30),Hj(D,S.aNormal),mk(D,F)}else if(N){for(N.value=2;k>w;w++)if(u=O[w],!u.ignoreInPick){if(u.priority>=J)break;u.useDefaultProgram&&Be(D,d,S,c),u.render(D,d,N)}Be(D,d,S,c);var F=D.getParameter(D.COLOR_CLEAR_VALUE);for(D.clearColor(0,0,0,0),D.disable(D.BLEND),d._95I(D,S,N),hn(d,N),hs(d,d._polylineModelMap,N),hs(d,d._wireframeModelMap,N),Ir(D,S.uTransparent,!0),d._95I(D,S,N,!0),hn(d,N,!0),hs(d,d._polylineModelMap,N,!0),hs(d,d._wireframeModelMap,N,!0),Ir(D,S.uTransparent,!1);k>w;w++)if(u=O[w],!u.ignoreInPick){if(u.priority>=n)break;u.useDefaultProgram&&Be(D,d,S,c),u.render(D,d,N),t=!0}for(t&&(Be(D,d,S,c),t=!1),D.clear(D.DEPTH_BUFFER_BIT),d._swapLineMap(),d._95I(D,S,N,!1,!0),hs(d,d._polylineModelMap,N),hs(d,d._wireframeModelMap,N),d._swapLineMap(),d._swapLineMap(),d._95I(D,S,N,!1,!0),hs(d,d._polylineModelMap,N),hs(d,d._wireframeModelMap,N),Ir(D,S.uTransparent,!0),d._95I(D,S,N,!0,!0),hs(d,d._polylineModelMap,N,!0),hs(d,d._wireframeModelMap,N,!0),Ir(D,S.uTransparent,!1),d._swapLineMap(),D.disable(D.DEPTH_TEST),d.drawFilter||d._30O._42(D,S,N),D.enable(D.DEPTH_TEST);k>w;w++)u=O[w],u.ignoreInPick||(u.useDefaultProgram&&Be(D,d,S,c),u.render(D,d,N));mk(D,F)}else{for(;k>w&&(u=O[w],!(u.priority>=y));w++)u.useDefaultProgram&&Be(D,d,S,c),u.render(D,d);for(Be(D,d,S,c),D.disable(D.BLEND),d.drawSky(D,S),d.drawReflectors(D,Q,j,W,b)&&(c._projectMatrix=d._projectMatrix=Lc(d),c._viewMatrix=Le(d,d._7O),d._viewMatrix=Hq(d._7O),Be(D,d,S,c));k>w&&(u=O[w],!(u.priority>=J));w++)u.useDefaultProgram&&Be(D,d,S,c),u.render(D,d),t=!0;for(t&&(Be(D,d,S,c),t=!1),d._31O._42(D,S),d._95I(D,S),hn(d),hs(d,d._polylineModelMap),hs(d,d._wireframeModelMap),D.enable(D.BLEND),D.depthMask(!1),Ir(D,S.uTransparent,!0),d._95I(D,S,i,!0),hn(d,i,!0),hs(d,d._polylineModelMap,i,!0),hs(d,d._wireframeModelMap,i,!0),D.depthMask(!0),Ir(D,S.uTransparent,!1);k>w&&(u=O[w],!(u.priority>=n));w++)u.useDefaultProgram&&Be(D,d,S,c),u.render(D,d),t=!0;for(t&&(Be(D,d,S,c),t=!1),D.clear(D.DEPTH_BUFFER_BIT),d._swapLineMap(),D.disable(D.BLEND),d._95I(D,S,i,!1,!0),hs(d,d._polylineModelMap),hs(d,d._wireframeModelMap),D.enable(D.BLEND),Ir(D,S.uTransparent,!0),D.depthMask(!1),d._95I(D,S,i,!0,!0),hs(d,d._polylineModelMap,i,!0),hs(d,d._wireframeModelMap,i,!0),D.depthMask(!0),Ir(D,S.uTransparent,!1),d._swapLineMap(),D.disable(D.DEPTH_TEST),D.disable(D.BLEND),d._32O._42(D,S),d._30O._42(D,S),d._highlightHelper._42(D,S),D.enable(D.DEPTH_TEST);k>w;w++)u=O[w],u.useDefaultProgram&&Be(D,d,S,c),u.render(D,d)}Sj(D,i),cd(D,i)},Z=!1,V=d.vr;V.enable&&V._42(D,Q,j,W)&&(Z=!0);var L=d.envRenderer;L&&L.enable&&L._42(D,Q,j,W)&&(Z=!0);var P=d._postProcessing;P._42(D,Q,j,W,b)&&(Z=!0),Z||(d.setViewport(D,0,0,F*p,$*p),W()),d._33Q=!1,d.drawFilter||d.countFrame(),d._doBufferGC(D)}}}},drawReflectors:function(t,g,E,V,h){var O,Q,f,S=this,x=S._dataModel.getReflectors(),o=!1;for(O in x)Q=x[O],S.isVisible(Q)&&(f=S.getData3dUI(Q),f&&f.drawReflector(t,g,E,V,h)&&(o=!0));return o},enablePostProcessing:function(O,L){return this._postProcessing.enableModule(O,L)},getPostProcessingModule:function(n){return this._postProcessing.getModule(n)},setViewport:function(d,F,K,U,O){this._viewport=[F,K,U,O],d.viewport(F,K,U,O)},getViewport:function(){return this._viewport},setBufferGCInterval:function(E){this._bufferGCInterval=E},_doBufferGC:function(U,T){var v,N,P=U._bufPool,i=0,l=0,f=U._renderInfo.frame,s=this._bufferGCInterval||10;for(v in P)i++,N=P[v],N&&(T||f-N._fid>s?(U.deleteBuffer(N._buf),N._buf=null,P[v]=null):l++);if(i/2>l&&i>128){var G={};for(v in P)P[v]&&(G[v]=P[v]);U._bufPool=G}U._validBufCount=l},_swapLineMap:function(){var Q=this;Uc=Q._polylineModelMap,Q._polylineModelMap=Q._polylineModelMapSwap,Q._polylineModelMapSwap=Uc,Uc=Q._wireframeModelMap,Q._wireframeModelMap=Q._wireframeModelMapSwap,Q._wireframeModelMapSwap=Uc,Uc=Q._polylineIndexMap,Q._polylineIndexMap=Q._polylineIndexMapSwap,Q._polylineIndexMapSwap=Uc,Uc=Q._wireframeIndexMap,Q._wireframeIndexMap=Q._wireframeIndexMapSwap,Q._wireframeIndexMapSwap=Uc},_updateSkyBox:function(C){if(this._skyBox&&C){var H=C.property,d=!1,r=this._skyBox;if("eye"===H||"forceUpdate"===H){var O=this._eye;r.p3(O[0],O[1],O[2]),d=!0}if("near"===H||"far"===H||"forceUpdate"===H){var q=this._near,l=this._far,p=r.getFinalScale3d();if(p[0]/=2,p[1]/=2,p[2]/=2,p[0]<=q||p[0]>=l||p[1]<=q||p[1]>=l||p[2]<=q||p[2]>=l){var y=2*q*l/(q+l),x=Math.min(p[0],p[1],p[2]),W=y/x,b=r.getScale3d();r.setScale3d(b[0]*W,b[1]*W,b[2]*W),d=!0}}d&&this.invalidateData(r)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(H){var q=this._skyBox;q&&(this._skyBoxStyleMap&&q.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&q.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&q.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=H,this.ump(this._updateSkyBox,this),H&&(H.dm()&&H.dm().remove(H),this._skyBoxStyleMap=r.Default.clone(H.getStyleMap()),this._skyBoxAnchor3d=H.getAnchor3d(),H.setAnchor3d(.5,.5,.5),this._skyBoxP3=H.p3().slice(0),H.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",q,H)},drawSky:function(E,B,L){var t=this,o=t._skyBox;if(o){var l=t._headlightIntensity,D=tl(t._headlightColor),B=t._prg;1!==l&&(D=[D[0]*l,D[1]*l,D[2]*l]),Ir(E,B.uHeadlightColor,[D[0],D[1],D[2],1]);var W=t.getData3dUI(o);if(W){var S,J=t.isOrtho(),b=J||this._computedProjectMatrix;b&&(S=t._projectMatrix,J&&(t._ortho=!1),Ir(E,B.uPMatrix,t._projectMatrix=Lc(t,!0)));var X=o.p3(),Q=this._eye;(X[0]!==Q[0]||X[1]!==Q[1]||X[2]!==Q[2])&&(o._position.x=Q[0],o._54O=Q[1],o._position.y=Q[2]),W._42(E,B,L,function(){return!0}),b&&(J&&(t._ortho=!0),Ir(E,B.uPMatrix,t._projectMatrix=S))}E.clear(E.DEPTH_BUFFER_BIT),Ir(E,B.uHeadlightColor,[D[0],D[1],D[2],t._headlightDisabled?1:0])}},_95I:function(A,B,Y,v,N){function h(O){if(!(!O.s("alwaysOnTop")&&!O.s("shape3d.alwaysOnTop"))==!!N&&Q.isVisible(O)&&(!t||a)){if(!Y&&Q.isTransparentMask(O))return;var I=Q.getData3dUI(O);I&&I._42(A,B,Y,f)}}var Q=this,f=function(k){return v?k:!k};Q.sky&&A.clear(A.DEPTH_BUFFER_BIT);var m=Q.drawFilter;m?Q.dm().each(function(P){m(P)||h(P)}):Q.dm().each(function(b){h(b)})},getLogicalPoint:function(w){return Eg(w,this._canvas)},isRectOverlapping:function(o){var f=this.getData3dUI(o);return f._rectOverlapping},getHitFaceInfo:function(V){V.target&&(V=this.lp(V));var L=this.getDataInfoAt(V);if(L){var F=this._1o.face(L.data,Ke(V.x,V.y));if(F)return{data:L.data,face:F}}return i},unproject:function(r,m){var F=this,P=F.getWidth(),L=F.getHeight(),y=r.target?F.lp(r):r,M=y.x-P/2,E=y.y-L/2,w=2*(M/P),B=2*(-1*E/L);m=m||0;var K=Fc(),G=Lc(F),H=Le(F);ao(K,G,H),se(K);var O=wh([w,B,m,1],K);return[O[0]/O[3],O[1]/O[3],O[2]/O[3]]},getDataAt:function(V){var l=this.getDataInfoAt(V);return l?l.data:i},getDataInfoAt:function(J,g){return J.target&&(J=this.lp(J)),this._1o.get(Ke(J.x,J.y,g),!0)},getDatasInRect:function(_){return this._1o.get(_)},setEditable:function(W){var L=this,m=L._editable;L._editable=W,this.fp(Qj,m,W)},isEditable:function(D){var r=this;return r._editable?gj(D)?D.s("3d.editable")?r._editableFunc?r._editableFunc(D):!0:!1:!1:!1},isSelectable:function(s){return s.s("3d.selectable")&&this.sm().isSelectable(s)},isMovable:function(D){var l=this;return Cc(D)&&D.getStyle($o)!==hb?!1:D.s("3d.movable")?l._movableFunc?l._movableFunc(D):!0:!1},isSizeEditable:function(_){return gj(_)?this._sizeEditableFunc?this._sizeEditableFunc(_):!0:!1},isRotationEditable:function(I){return gj(I)&&I.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(I):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(g){this.setZoom(Xg,g)},zoomOut:function(B){this.setZoom(1/Xg,B)},setZoom:function(){var H=new kc,Z=new kc,M=new kc,m=new kc;return function(F,G){if(1!==F){var x=this;x._14o&&x._14o.stop(!0);var k,C=1/F;H.copy(x.getCenter()),Z.copy(x.getEye());var $=x._ortho;if($){if(k=x._orthoWidth,k<x._moveStep&&F>1)return}else if(H.distanceTo(Z)<x._moveStep&&1>C)return;var V=!1;return x._zoomToCenter===!1&&x._lastZoomLP&&(M.copy(Z).sub(H).normalize(),x._81O=null,m.copy(x.getHitPosition(x._lastZoomLP,H.toArray(),M.toArray())),V=!0,x._lastZoomHit=m),(G=Lb(G))?(G.action=function(Q){x.fi({kind:x._zooming?"betweenZoom":"beginZoom"}),x._zooming=1;var p=(C-1)*Q+1;$&&x.setOrthoWidth(k*p),V?(x.setEye(M.lerpVectors(m,Z,p).toArray()),x.setCenter(M.lerpVectors(m,H,p).toArray())):$||x.setEye(M.lerpVectors(H,Z,p).toArray())},G._37o=function(){delete x._14o,delete x._zooming,x.fi({kind:"endZoom"}),x.onZoomEnded()},x._14o=Tk(G)):($&&x.setOrthoWidth(k*C),V?(x.setEye(M.lerpVectors(m,Z,C).toArray()),x.setCenter(M.lerpVectors(m,H,C).toArray())):$||x.setEye(M.lerpVectors(H,Z,C).toArray()),void 0)}}}(),setOrthoZoom:function(s,q){return this.setZoom(s,q)},getPositionInfo:function(x){var c=this,L=c._eye,p=c._center,t=c.getAspect(),W=x?Wc(_c(p,L,!0),_c(x,L)):_m(L,p);if(c._ortho){var n=c._orthoWidth;return{length:W,height:n/t,width:n}}var H=2*N(c._fovy/2)*W;return{length:W,height:H,width:H*t}},getCenterInfo:function(){var S=this;return S._81O||(S._81O=S.getPositionInfo()),Se(S._81O)},rotate:function(M,O,q,p){var r=this;if(M||O){p==i&&(p=r._firstPersonMode),r._88O&&r._88O.stop(!0);var h=r._center,j=r._eye,C=r.getCenterInfo().length,t=p?h:j,Y=p?j:h,o=_c(t,Y),S=K(o[0],o[2]),m=K(k(o[0]*o[0]+o[2]*o[2]),o[1]),L=p?io:Hh;return p&&(O=-O),(q=Lb(q))?(q.action=function(x){r.fi({kind:r._rotating?"betweenRotate":"beginRotate"}),r._rotating=1;var n=S+M*x,z=m+O*x;z=p?J-Kg(J-z):Kg(z),o[0]=C*U(z)*U(n),o[1]=C*X(z),o[2]=C*U(z)*X(n),t[0]=Y[0]+o[0],t[1]=Y[1]+o[1],t[2]=Y[2]+o[2],r.fp(L,i,t)},q._37o=function(){delete r._88O,delete r._rotating,r.fi({kind:"endRotate"}),r.onRotateEnded()},r._88O=Tk(q)):(S+=M,m+=O,m=p?J-Kg(J-m):Kg(m),o[0]=C*U(m)*U(S),o[1]=C*X(m),o[2]=C*U(m)*X(S),t[0]=Y[0]+o[0],t[1]=Y[1]+o[1],t[2]=Y[2]+o[2],r.fp(L,i,t),void 0)}},pan:function(c,e,W,x){if(c||e){var u=this;x==i&&(x=u._firstPersonMode),u._89O&&u._89O.stop(!0);var f=Le(u),B=[f[0]*c,f[4]*c,f[8]*c],t=[f[1]*e,f[5]*e,f[9]*e],D=B[0]+t[0],w=B[1]+t[1],_=B[2]+t[2],L=u._center,K=u._eye;if(x){var y=Kd(u.getBoundaries(),K[0],K[2],K[0]+D,K[2]+_,k(D*D+_*_));D=y[0],_=y[1]}if(W=Lb(W)){var P=Se(K),q=Se(L);return W.action=function(M){u.fi({kind:u._panning?"betweenPan":"beginPan"}),u._panning=1,L[0]=q[0]+D*M,L[1]=q[1]+w*M,L[2]=q[2]+_*M,K[0]=P[0]+D*M,K[1]=P[1]+w*M,K[2]=P[2]+_*M,u.fp(Hh,i,K),u.fp(io,i,L)},W._37o=function(){delete u._89O,delete u._panning,u.fi({kind:"endPan"}),u.onPanEnded()},u._89O=Tk(W)}L[0]+=D,L[1]+=w,L[2]+=_,K[0]+=D,K[1]+=w,K[2]+=_,u.fp(Hh,i,K),u.fp(io,i,L)}},walk:function(e,p,Q){if(e){var C=this;Q==i&&(Q=C._firstPersonMode),C._90O&&C._90O.stop(!0);var v=C._center,j=C._eye,X=_c(v,j,!0);if(Q){var K=Kd(C.getBoundaries(),j[0],j[2],j[0]+X[0]*e,j[2]+X[2]*e,R(e));if(e=_m(K),!e)return;X=[K[0]/e,0,K[1]/e]}if(p=Lb(p)){var m=Se(j),q=Se(v);return p.action=function(H){C.fi({kind:C._walking?"betweenWalk":"beginWalk"}),C._walking=1;var W=e*H;j[0]=m[0]+X[0]*W,j[1]=m[1]+X[1]*W,j[2]=m[2]+X[2]*W,v[0]=q[0]+X[0]*W,v[1]=q[1]+X[1]*W,v[2]=q[2]+X[2]*W,C.fp(Hh,i,j),C.fp(io,i,v)},p._37o=function(){delete C._90O,delete C._walking,C.fi({kind:"endWalk"}),C.onWalkEnded()},C._90O=Tk(p)}j[0]+=X[0]*e,j[1]+=X[1]*e,j[2]+=X[2]*e,v[0]+=X[0]*e,v[1]+=X[1]*e,v[2]+=X[2]*e,C.fp(Hh,i,j),C.fp(io,i,v)}},handleScroll:function(q,H){q.preventDefault();var L=this,K=L._moveStep,r=L.getDataInfoAt(q);if(r){var w=r.data;if(w&&L.isInteractive(w)){var n=L.intersectObject(q,w);if(n){var G=n.part,$=Ij(w.s(G+".image")||w.s("shape3d."+G+".image")||w.s("all.image")||w.s("shape3d.image"));if($&&gf($.scrollable,w,L))return}}}return L.isFirstPersonMode()?(L.isPannable()&&L.pan(0,H>0?K:-K),void 0):(L.isZoomable()&&(L._lastZoomLP=L.lp(q),L.setZoom(0>H?1/hg:hg),L._lastZoomLP=L._lastZoomHit=null),void 0)},handlePinch:function(L,$){this.isZoomable()&&this.setZoom($>L?1/fi:fi)},reset:function(){this.setCenter(z.graph3dViewCenter),this.setEye(z.graph3dViewEye),this.setUp(z.graph3dViewUp)},moveSelection:function(B,v,E){var n=this;n.dm().beginTransaction(),ii(this.sm().toSelection(this.isMovable,this),B,v,E),n.dm().endTransaction()},getMoveMode:function(t,e){var J=e.s("3d.move.mode");if(J)return J;var n="88",k="89",Q="90";return Kq(t)||kp[n]&&kp[k]&&kp[Q]?"xyz":kp[n]&&kp[k]?"xy":kp[n]&&kp[Q]?"xz":kp[k]&&kp[Q]?"yz":kp[n]?"x":kp[k]?"y":kp[Q]?"z":"xz"},handleTick:function(){var j=this,s=!1,E=j._moveStep,z=E,Y=!1,P=!0,S=j._rotateStep*(P?-1:1);if(j.isWalkable()||(z=0),j.isPannable()||(E=0),j.isRotatable()||(S=0),j._32Q){var W=(Ql()-j._32Q)/50;z*=W,E*=W,S*=W}j._31Q&&(Zh(j._31Q),delete j._31Q,delete j._32Q),jh()&&(s=!0,j.pan(-E,0,Y,P)),Qc()&&(s=!0,j.pan(E,0,Y,P)),an()&&(s=!0,Kq()?j.pan(0,E,Y,P):j.walk(z,Y,P)),Kb()&&(s=!0,Kq()?j.pan(0,-E,Y,P):j.walk(-z,Y,P)),_r()&&(s=!0,j.rotate(-S,0,Y,P)),im()&&(s=!0,j.rotate(S,0,Y,P)),Ub()&&(s=!0,j.rotate(0,-S/2,Y,P)),mh()&&(s=!0,j.rotate(0,S/2,Y,P)),s&&(j._32Q=Ql(),j._31Q=ur(j.handleTick,j))},handleKeyDown:function(M){var o=this;!Th(M)&&Nj[M.keyCode]?o.handleTick():Pc(M)?o.selectAll():ei(M)?o.handleDelete(M):Sd(M)&&this.isResettable()&&o.reset()},checkDoubleClickOnNote:function(E,T,i){var n=this;if(i===ol){if(T.s("note.toggleable"))return T.s(ih,!T.s(ih)),n.fi({kind:"toggleNote",event:E,data:T,part:i}),!0}else if(i===Al&&T.s("note2.toggleable"))return T.s(aq,!T.s(aq)),n.fi({kind:"toggleNote2",event:E,data:T,part:i}),!0;return!1},checkDoubleClickOnRotation:function(Q,E,w){return w===mc?(E.setRotationX(0),!0):w===Bo?(E.setRotationY(0),!0):w===ic?(E.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(y){var j=this;if(j.isOrtho())return j.getWidth()/j.getOrthoWidth();var A=j.getCenter(),p=j.getHeight(),i=j.getEye(),E=[A[0]-i[0],A[1]-i[1],A[2]-i[2]],c=[y[0]-i[0],y[1]-i[1],y[2]-i[2]],f=Math.sqrt(E[0]*E[0]+E[1]*E[1]+E[2]*E[2]),U=1/Math.tan(j.getFovy()/2);return p*f*U/(c[0]*E[0]+c[1]*E[1]+c[2]*E[2])},inViewSpace:function(p){var t,Y=this,u=Y._transformPointToViewSpace(p),J=Y.getAspect(),b=Y.getNear(),y=Y.getFar();return-u[2]<b||-u[2]>y?!1:Y.isOrtho()?(t=Y.getOrthoWidth()/2,Math.abs(u[0])<=t&&Math.abs(u[1]*J)<=t):(t=Math.sqrt(u[0]*u[0]+u[1]*u[1]+u[2]*u[2])*Math.tan(Y.getFovy()/2),Math.abs(u[1]<=t)&&Math.abs(u[0])<=t*J)},getPVMatrix:function(){var m=this,d=m.getWidth()/2,I=m.getHeight()/2,R=m._18Q;return R&&R._wh===d/I||(R=Lc(m),m._18Q=ao(R,R,Le(m)),m._18Q._wh=d/I),R},getFrustum:function(){var W=new jq,O=new qs,c=new Array(16);return function(){for(var d=this.getPVMatrix(),u=!1,L=0;16>L;L++)d[L]!==c[L]&&(u=!0,c[L]=d[L]);return u&&O.setFromMatrix(W.fromArray(d)),O}}(),toViewPosition:function(j){var G=this,H=G.getWidth()/2,k=G.getHeight()/2,I=G.getPVMatrix();return j=wh([j[0],j[1],j[2],1],I),{x:H+H*j[0]/j[3],y:k-k*j[1]/j[3],z:j[2]/j[3]}},getHitPosition:function(W,L,B){var G=this,M=G.getWidth(),N=G.getHeight(),a=W.target?G.lp(W):W,F=a.x-M/2,n=a.y-N/2,c=G.getCenterInfo(),z=Le(G);L=L?L:[0,0,0],B=B?B:[0,1,0],F=F/M*c.width,n=-1*n/N*c.height;var d=[z[0]*F,z[4]*F,z[8]*F],u=[z[1]*n,z[5]*n,z[9]*n],k=[d[0]+u[0],d[1]+u[1],d[2]+u[2]],h=G.getCenter(),l=Tp(G,L,B,[k[0]+h[0],k[1]+h[1],k[2]+h[2]]);return l?l:[0,0,0]},intersectObject:function(j,I){return this._raycaster.intersectObject(j,I)},intersectObjects:function(p,N,i){return this._raycaster.intersectObjects(p,N,i)},getLineLength:function(u){this.validate();var n=this.getData3dUI(u);if(n&&n.getCache){var m=n.getCache();if(m)return m[m.length-1].length}return 0},getLineOffset:function(Q,r){var n=this.getData3dUI(Q);if(n&&n.getCache){var U=n.getCache();if(U){var G=Pb(U,r),_=Q.r3();if(0===_[0]&&0===_[1]&&0===_[2])return G;var l=new kc(Q.p3()),T=new kc(G.point).sub(l),Z=new kc(G.tangent).add(T),s=(new ke).setFromEuler(new Ug(_,Q.getRotationMode(),!0));return T.applyQuaternion(s),Z.applyQuaternion(s),{point:T.add(l),tangent:Z.sub(T).normalize()}}}return i},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(I,J,m){var K=this,q=K.getEye();q=[q[0],q[1],q[2]];var W=K.getCenter();if(W=[W[0],W[1],W[2]],I||(I=q),J||(J=W),K._flyAnim&&K._flyAnim.stop(!0),m=Lb(m),!m)return K.setEye(I[0],I[1],I[2]),K.setCenter(J[0],J[1],J[2]),delete K._flyAnim,!0;var L=[I[0]-q[0],I[1]-q[1],I[2]-q[2]],v=[J[0]-W[0],J[1]-W[1],J[2]-W[2]];return m.action=function(U){K.setCenter(W[0]+v[0]*U,W[1]+v[1]*U,W[2]+v[2]*U),K.setEye(q[0]+L[0]*U,q[1]+L[1]*U,q[2]+L[2]*U)},m._37o=function(){delete K._flyAnim},K._flyAnim=Tk(m)},flyTo:function(){function x(D,X,_){if(_ instanceof r.Node){f.fromArray(sf(_,X.getMat(_)));var Y=_.getAnchor3d();D.push((new kc).set(0-Y.x,0-Y.y,0-Y.z).applyMatrix4(f)),D.push((new kc).set(0-Y.x,0-Y.y,1-Y.z).applyMatrix4(f)),D.push((new kc).set(0-Y.x,1-Y.y,0-Y.z).applyMatrix4(f)),D.push((new kc).set(0-Y.x,1-Y.y,1-Y.z).applyMatrix4(f)),D.push((new kc).set(1-Y.x,0-Y.y,0-Y.z).applyMatrix4(f)),D.push((new kc).set(1-Y.x,0-Y.y,1-Y.z).applyMatrix4(f)),D.push((new kc).set(1-Y.x,1-Y.y,0-Y.z).applyMatrix4(f)),D.push((new kc).set(1-Y.x,1-Y.y,1-Y.z).applyMatrix4(f))}}var u=new kc,y=new kc,E=new kc,Z=new kc,f=new jq,D=new r.Math.Quaternion,B=new Ug;return function(I,F,J){var O=this;if(J!==s)F={animation:F,ratio:J};else{var j=typeof F;("boolean"===j||"object"===j&&F.duration)&&(F={animation:F})}F=F||{},u.fromArray(O.getEye()),y.fromArray(O.getCenter());var l,_,M=[],K=F.center,c=F.distance===s;if(K&&E.fromArray(K),I instanceof r.Node)K||E.fromArray(I.p3()),c&&(x(M,O,I),l=M.length);else{if(I||(I=O.dm().getDatas()),!I.length)return;if((c||!K)&&(M=[],I.forEach(function(Q){x(M,O,Q)}),l=M.length,!l))return;if(!K){for(E.set(0,0,0),_=0;l>_;_++)E.add(M[_]);E.multiplyScalar(1/l)}}if(O.setCenter(E.x,E.y,E.z),Z.subVectors(u,y),F.direction||F.worldDirection){!F.worldDirection&&I instanceof r.Node?D.setFromEuler(B.set(I.r3(),I.getRotationMode(),!0)):D.set(0,0,0,1);var k=Z.length();Z.fromArray(F.worldDirection||F.direction).applyQuaternion(D).setLength(k)}var W=0;if(c){var i,T,f,J=F.ratio||.8,m=F.xRatio||J,U=F.yRatio||J;if(O.isOrtho()){var b=-1/0;for(O._eye[0]=Z.x+E.x,O._eye[1]=Z.y+E.y,O._eye[2]=Z.z+E.z,i=Lc(O),ao(i,i,Le(O)),_=0;l>_;_++)f=M[_],T=wh([f.x,f.y,f.z,1],i),b=Math.max(b,Math.max(Math.abs(T[0])/m,Math.abs(T[1])/U));W=O.getOrthoWidth()*b,Z.add(E)}else{for(var g,q,v=O.getNear(),G=10;G--;){for(O._eye[0]=Z.x+E.x,O._eye[1]=Z.y+E.y,O._eye[2]=Z.z+E.z,i=Lc(O),ao(i,i,Le(O)),g=!0,q=-1/0,_=0;l>_;_++){if(f=M[_],T=wh([f.x,f.y,f.z,1],i),T[3]<v&&G){Z.multiplyScalar(2),g=!1;break}q=Math.max(q,Math.max(Math.abs(T[0])/m,Math.abs(T[1])/U)-T[3])}if(g)break}Z.setLength(q+Z.length()).add(E)}}else Z.setLength(F.distance).add(E);O._flyAnim&&O._flyAnim.stop(!0);var w=Lb(F.animation);if(w){O.setEye(u.x,u.y,u.z),O.setCenter(y.x,y.y,y.z);var R=(new kc).subVectors(Z,u),Y=(new kc).subVectors(E,y);if(W)var A=O.getOrthoWidth();var p=new kc,L=new kc,V=w.action,d=w._37o;return w.action=function(G,d){p.copy(u).addScaledVector(R,G),L.copy(y).addScaledVector(Y,G),O.setCenter(L.x,L.y,L.z),O.setEye(p.x,p.y,p.z),W&&O.setOrthoWidth((W-A)*G+A),V&&V(G,d)},w._37o=function(){delete O._flyAnim,d&&d()},{lastEye:u,lastCenter:y,eye:Z,center:E,orthoWidth:W,animation:O._flyAnim=Tk(w)}}return O.setEye(Z.x,Z.y,Z.z),W&&O.setOrthoWidth(W),delete O._flyAnim,{lastEye:u,lastCenter:y,eye:Z,center:E,orthoWidth:W}}}(),getBoundingBox:function(){function x(Y,G,u){j.fromArray(sf(u,G.getMat(u)));var L=u.getAnchor3d();Y.push((new kc).set(0-L.x,0-L.y,0-L.z).applyMatrix4(j)),Y.push((new kc).set(0-L.x,0-L.y,1-L.z).applyMatrix4(j)),Y.push((new kc).set(0-L.x,1-L.y,0-L.z).applyMatrix4(j)),Y.push((new kc).set(0-L.x,1-L.y,1-L.z).applyMatrix4(j)),Y.push((new kc).set(1-L.x,0-L.y,0-L.z).applyMatrix4(j)),Y.push((new kc).set(1-L.x,0-L.y,1-L.z).applyMatrix4(j)),Y.push((new kc).set(1-L.x,1-L.y,0-L.z).applyMatrix4(j)),Y.push((new kc).set(1-L.x,1-L.y,1-L.z).applyMatrix4(j))}var j=new jq;return function(S){if(S=S||this.sm().getSelection(),S instanceof r.Node&&(S=[S]),0===S.length)return i;var e=[];S.forEach(function(D){x(e,this,D)},this);var s=[1/0,1/0,1/0],Z=[-1/0,-1/0,-1/0];return e.forEach(function(M){s[0]=Math.min(M.x,s[0]),s[1]=Math.min(M.y,s[1]),s[2]=Math.min(M.z,s[2]),Z[0]=Math.max(M.x,Z[0]),Z[1]=Math.max(M.y,Z[1]),Z[2]=Math.max(M.z,Z[2])}),{min:s,max:Z}}}()}),Ri.RenderEnv=function(t){this.gv=t,this.enable=!1},j.defineProperties(Ri.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(I){this._debugOn=I,this.capture&&this.capture()}}}),j.assign(Ri.RenderEnv.prototype,{renderEnvToCube:function(z,l,j,Q){var $=this,A=$.gv;if(!z||!l||!j)return $.enable=!1,$._42=null,void 0;$.enable=!0;var D=Math.floor(Q/z*l),c=A.getGL(),s=$._renderTargets;s?s.length<j&&(s=$._renderTargets=s.concat(new Array(j-s.length))):s=$._renderTargets=new Array(j);for(var e=0;j>e;e++)s[e]?s[e].setSize(c,Q,D):s[e]=new Ri.RenderTarget(A,c,Q,D);var k=!1;$.capture=function(){k=!0,A._42(),k=!1};var d=new kc,L=new kc,_=new kc,X=new kc,o=(new kc).setY(0),I=2*Math.PI/j,B=z/2/Math.tan(Math.PI/j),i=2*Math.atan2(l/2,B),C=z/l;$._42=function(v,z,R,N){var l=$._debugOn;if(!k&&!l)return!1;d.copy(A.getEye()),X.copy(A.getCenter()).sub(d);var E=Math.atan2(X.z,X.x),W=A.getNear(),r=A.getFovy(),c=A.getAspect();L.copy(A.getCenter());for(var Q,H=0;j>H;H++)if(Q=s[H],o.setZ(Math.cos(E)).setX(Math.sin(E)).multiplyScalar(B),E-=I,_.addVectors(d,o),A.setNear(B),A.setCenter([_.x,_.y,_.z]),A.setFovy(i),A.setAspect(C),l){var D=Math.round(z/j);v.viewport(D*H,0,D,R),N()}else hl(v,Q.frame),v.viewport(0,0,Q.width,Q.height),v.clear(v.COLOR_BUFFER_BIT),N(),Ln(v),Q.assureTexture();return A.setNear(W),A.setCenter([L.x,L.y,L.z]),A.setFovy(r),A.setAspect(c),!0},$.capture()},getTextureInfo:function(w){var u=this._renderTargets;if(!u)return null;var e=this._renderTargets[w];return e?{index:w,texture:e.texture,textureName:e.uuid}:null}}),j.assign(Ri.Graph3dView.prototype,{renderEnvToCube:function(L,A,$,O){var X=this;X.envRenderer||(X.envRenderer=new Ri.RenderEnv(X)),X.envRenderer.renderEnvToCube(L,A,$,O)}}),Ri.RenderTarget=function(i,z,$,t,g){var Q=this;g=g||{},g.samples=Math.min(i._glCapabilities.maxSamples,g.samples&&g.samples>1&&2===i._webGLVersion?g.samples:0),Q.options=g,Q.uuid=r.Math.generateUUID(),Q.gv=i,Q.init(i,z,g),g.samples&&!i._glCapabilities._maxSamplesChecked?Q.setSize(z,$||1,t||1):Q.setSize(z,$,t)},j.assign(Ri.RenderTarget.prototype,{bind:function(U){hl(U,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(j){Ln(j),this.options.samples&&(j.bindFramebuffer(j.READ_FRAMEBUFFER,this._MSAAFbo),j.bindFramebuffer(j.DRAW_FRAMEBUFFER,this.frame),j.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,j.COLOR_BUFFER_BIT,j.NEAREST),j.bindFramebuffer(j.READ_FRAMEBUFFER,null),j.bindFramebuffer(j.DRAW_FRAMEBUFFER,null))},init:function(s,q,F){var P=this,j=P.texture=q.createTexture();q.activeTexture(q.TEXTURE0),q.bindTexture(q.TEXTURE_2D,j),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE);var p=F.samples,Z=p?q.NEAREST:q.LINEAR;q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MIN_FILTER,F.minFilter||Z),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MAG_FILTER,F.magFilter||Z),q.bindTexture(q.TEXTURE_2D,null),P.render=q.createRenderbuffer(),P.frame=q.createFramebuffer(),s._2O[P.uuid]=j},assureTexture:function(){var x=this,Q=x.uuid,P=x.gv._2O;P[Q]||(P[Q]=x.texture)},setSize:function(T,b,P){var u=this;if(b&&P&&(u.width!==b||u.height!==P)){var A=T.RGBA,I=T.TEXTURE_2D,G=T.RENDERBUFFER,K=T.FRAMEBUFFER,N=u.options.samples;if(Bg(T,u.texture),T.texImage2D(I,0,A,b,P,0,A,T.UNSIGNED_BYTE,i),T.bindRenderbuffer(G,u.render),N){var _=u.gv._glCapabilities;if(_._maxSamplesChecked)T.renderbufferStorageMultisample(G,N,T.DEPTH_COMPONENT16,b,P);else{for(T.getError();N>1&&(T.renderbufferStorageMultisample(G,N,T.DEPTH_COMPONENT16,b,P),T.getError());)N=Math.floor(N>>1);1>=N&&(N=0,T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,u.options.minFilter||T.LINEAR),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,u.options.magFilter||T.LINEAR),T.renderbufferStorage(G,T.DEPTH_COMPONENT16,b,P)),_._maxSamplesChecked=!0,_.maxSamples=u.options.samples=N}}else T.renderbufferStorage(G,T.DEPTH_COMPONENT16,b,P);N&&!u._MSAAFbo&&(u._MSAAFbo=T.createFramebuffer(),u._MSAARbO=T.createRenderbuffer()),hl(T,u.frame),T.framebufferTexture2D(K,T.COLOR_ATTACHMENT0,I,u.texture,0),N||T.framebufferRenderbuffer(K,T.DEPTH_ATTACHMENT,G,u.render),Ln(T),N&&(T.bindRenderbuffer(T.RENDERBUFFER,u._MSAARbO),T.renderbufferStorageMultisample(T.RENDERBUFFER,N,T.RGBA8,b,P),hl(T,u._MSAAFbo),T.framebufferRenderbuffer(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,T.RENDERBUFFER,u._MSAARbO),T.framebufferRenderbuffer(K,T.DEPTH_ATTACHMENT,G,u.render),Ln(T)),Bg(T,i),T.bindRenderbuffer(G,i),u.width=b,u.height=P}},toCanvas:function(){var O=this,p=O.gv.getGL();hl(p,O.frame);var U=O.width,i=O.height,o=new Uint8Array(4*U*i);p.readPixels(0,0,U,i,p.RGBA,p.UNSIGNED_BYTE,o),Ln(p);var x=B.createElement("canvas");x.width=U,x.height=i;var m=x.getContext("2d"),k=m.createImageData(U,i);return k.data.set(o),m.putImageData(k,0,0),x}});var sd=Ri.Interactor=function(d){this.gv=d};Xr("Interactor",j,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Mj=Ri.DefaultInteractor=function(h){Kh(Mj,this,[h])};Xr("DefaultInteractor",sd,{handle_contextmenu:function(J){nl(J)},handle_mousewheel:function(H){this.gv.handleScroll(H,H.wheelDelta/40)},handle_DOMMouseScroll:function(N){2===N.axis&&this.gv.handleScroll(N,-N.detail)},handle_keydown:function(G){this.gv.handleKeyDown(G)},handle_mousedown:function(S){this.handle_touchstart(S)},handle_touchstart:function(u){nl(u);var N=this,U=N.gv,z=pn(u),W=U.getDataInfoAt(u),r=W?W.data:i,V=W?W.part:i,J=U.sm(),T=Zf(u),m=lr(u);U.setFocus(u)&&(N._62O=i,N._57I=i,r?Th(u)?J.co(r)?J.rs(r):J.as(r):J.co(r)||J.ss(r):z&&(Th(u)?U.isRectSelectable()&&(N._62O=Hg):N._57I=Mi(u)),N._31Q&&(Zh(N._31Q),delete N._31Q,delete N._32Q),N._62O||(U.isFirstPersonMode()&&(Kq(u)||wl(u)||m>2?N._62O="pan":U.isMouseRoamable()||Aj?(N._62O="roaming",N.foward=T&&pn(u),N._32Q=Ql(),N._31Q=ur(N.tick,N)):z||(N._62O="roaming")),N._62O||(z&&T&&sq[V]?(N._62O=V,N.p3=r.p3()):z&&T&&gj(r)&&U.isSelected(r)?U.isMovable(r)?(N._62O="move",N.p3=r.p3(),N.movedata=r):U._39Q(r)&&(N._62O="none"):Aj&&(m>2?N._62O="pan":2===m&&(N.dist=iq(u),N._62O="pinch")))),N.point=U.lp(u),Vn(N,u),Ae(u)?U.handleDoubleClick(u,r,V):U.handleClick(u,r,V))},tick:function(){var x=this,f=x.gv,C=f._moveStep;x.point&&f.isWalkable()&&(x._32Q&&(C*=(Ql()-x._32Q)/50),f.walk(x.foward?C:-C),x._32Q=Ql(),x._31Q=ur(x.tick,x))},handle_mouseup:function(c){this.handle_touchend(c)},handle_touchend:function(H){var k=this._57I;k&&(_m(k,Mi(H))<=1&&this.gv.sm().cs(),this._57I=i)},handleWindowMouseMove:function(X){this.handleWindowTouchMove(X)},handleWindowTouchMove:function(w){var r,h,T=this,X=T.gv,x=T._62O,m=T.point,A=X.dm(),G=X.lp(w),v=G.x-m.x,$=G.y-m.y,t=X.getWidth(),s=X.getHeight();if(t&&s){var K=-b*v/t,H=-b*$/s;if("roaming"===x)T.rotate(w,K/2,H/2);else if(x===mc||x===Bo||x===ic)X._86O||A.beginTransaction(),X.fi({kind:X._86O?"betweenEditRotation":"beginEditRotation",event:w}),X._86O=1,X.sm().each(function(T){if(gj(T)&&X.isRotationEditable(T)){var p=R(K)>R(H)?K:H;x===mc?T.setRotationX(T.getRotationX()+p):x===Bo?T.setRotationY(T.getRotationY()+p):x===ic&&T.setRotationZ(T.getRotationZ()+p)}});else if("move"===x||sq[x]){x===ln||x===wk||x===qq?(X._87O||A.beginTransaction(),X.fi({kind:X._87O?"betweenEditScale":"beginEditScale",event:w}),X._87O=1):(X._moving||A.beginTransaction(),X.fi({kind:X._moving?"betweenMove":"beginMove",event:w}),X._moving=1);var C,y=T.p3,z=X.getPositionInfo(y),d=Le(X);C=x===Vk?"x":x===rh?"y":x===Pm?"z":x===ln?"sx":x===wk?"sy":x===qq?"sz":X.getMoveMode(w,T.movedata),v=v/t*z.width,$=-1*$/s*z.height;var N,k,n=[d[0]*v,d[4]*v,d[8]*v],J=[d[1]*$,d[5]*$,d[9]*$],u=n[0]+J[0],D=n[1]+J[1],l=n[2]+J[2],S=[y[0]+u,y[1]+D,y[2]+l],F=_c(X.getEye(),S,!0);if("xyz"===C?(N=S,X.moveSelection(u,D,l)):"xz"===C?(N=Tp(X,y,[0,1,0],S),N&&X.moveSelection(N[0]-y[0],0,N[2]-y[2])):"xy"===C?(N=Tp(X,y,[0,0,1],S),N&&X.moveSelection(N[0]-y[0],N[1]-y[1],0)):"yz"===C?(N=Tp(X,y,[1,0,0],S),N&&X.moveSelection(0,N[1]-y[1],N[2]-y[2])):"x"===C||"sx"===C?(F[0]=0,N=Tp(X,y,F,S),N&&(k=N[0]-y[0],"x"===C?X.moveSelection(k,0,0):X.sm().each(function(l){gj(l)&&X.isSizeEditable(l)&&(r=l.getScaleX()+k/100,h=r/l.getScaleX(),l.setScaleX(r),Kq(w)&&(l.setScaleY(l.getScaleY()*h),l.setScaleTall(l.getScaleTall()*h)))
}))):"y"===C||"sy"===C?(F[1]=0,N=Tp(X,y,F,S),N&&(k=N[1]-y[1],"y"===C?X.moveSelection(0,k,0):X.sm().each(function(z){gj(z)&&X.isSizeEditable(z)&&(r=z.getScaleTall()+k/100,h=r/z.getScaleTall(),z.setScaleTall(r),Kq(w)&&(z.setScaleY(z.getScaleY()*h),z.setScaleX(z.getScaleX()*h)))}))):("z"===C||"sz"===C)&&(F[2]=0,N=Tp(X,y,F,S),N&&(k=N[2]-y[2],"z"===C?X.moveSelection(0,0,k):X.sm().each(function(e){gj(e)&&X.isSizeEditable(e)&&(r=e.getScaleY()+k/100,h=r/e.getScaleY(),e.setScaleY(r),Kq(w)&&(e.setScaleX(e.getScaleX()*h),e.setScaleTall(e.getScaleTall()*h)))}))),!N)return;T.p3=N}else if(x===Hg){var L=T.div;L||(L=T.div=em(),pi(T.getView(),L),L.op=m,L.style.background=X.getRectSelectBackground()),X.fi({kind:X._rectSelecting?"betweenRectSelect":"beginRectSelect",event:w}),X._rectSelecting=1,L.rect=xn(L.op,G),Kn(L,L.rect)}else if("pinch"===x&&2===lr(w)){X.fi({kind:X._pinching?"betweenPinch":"beginPinch",event:w}),X._pinching=1;var k=iq(w);X._lastZoomLP||(X._lastZoomLP=zj(w)),X.handlePinch(k,T.dist),T.dist=k}else"pan"===x||Kq(w)||wl(w)?T.pan(w,v,$):"none"===x||X.isFirstPersonMode()||T.rotate(w,K,H);T.point=G}},pan:function(l,z,y){var P=this.gv;if(P.isPannable()){var M=P.getWidth(),x=P.getHeight();if(!M||!x)return;var J=P.getCenterInfo(),C=z/M*J.width,j=-1*y/x*J.height;P.fi({kind:P._panning?"betweenPan":"beginPan",event:l}),P._panning=1,P.pan(-C,-j)}},rotate:function(n,Q,y){var r=this.gv;r.isRotatable()&&(r.fi({kind:r._rotating?"betweenRotate":"beginRotate",event:n}),r._rotating=1,r.rotate(Q,y))},handleWindowMouseUp:function(j){this.handleWindowTouchEnd(j)},handleWindowTouchEnd:function(E){var Y=this,w=Y.gv,R=w.dm(),b=Y.div;if(b){var h=w.getDatasInRect(b.rect);if(!h.isEmpty()){var x=w.sm(),L=x.toSelection();h.each(function(n){x.co(n)?L.remove(n):L.add(n)}),x.ss(L)}As(b)}w._moving&&(delete w._moving,w.fi({kind:"endMove",event:E}),w.onMoveEnded(),R.endTransaction()),w._panning&&(delete w._panning,w.fi({kind:"endPan",event:E}),w.onPanEnded()),w._rotating&&(delete w._rotating,w.fi({kind:"endRotate",event:E}),w.onRotateEnded()),w._86O&&(delete w._86O,w.fi({kind:"endEditRotation",event:E}),R.endTransaction()),w._87O&&(delete w._87O,w.fi({kind:"endEditScale",event:E}),R.endTransaction()),w._pinching&&(delete w._pinching,w.fi({kind:"endPinch",event:E}),w.onPinchEnded()),w._rectSelecting&&(delete w._rectSelecting,w.fi({kind:"endRectSelect",event:E}),w.onRectSelectEnded()),w._walking&&(delete w._walking,w.fi({kind:"endWalk",event:E}),w.onWalkEnded()),w._lastZoomLP=w._lastZoomHit=null,Y.dist=Y.point=Y._62O=Y.p3=Y.movedata=Y.div=Y._57I=Y._32Q=Y._31Q=Y.foward=i}});var gr=Ri.MapInteractor=function(x){Kh(gr,this,[x]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this.maxPhi=5*Math.PI/12};Xr("MapInteractor",sd,{handle_contextmenu:function(K){nl(K)},handle_mousewheel:function(R){this.gv.handleScroll(R,R.wheelDelta/40)},handle_DOMMouseScroll:function(z){2===z.axis&&this.gv.handleScroll(z,-z.detail)},handle_keydown:function(t){this.gv.handleKeyDown(t)},handle_mousedown:function(U){this.handle_touchstart(U)},handle_touchstart:function(E){nl(E);var j=this,D=j.gv;if(D.setFocus(E)){var h=D.getDataInfoAt(E),Q=h?h.data:i,a=h?h.part:i,I=j.editing={point:D.lp(E)};Aj?I.touch=!0:(I.touch=!1,I.clickLeft=pn(E),I.pan=wl(E)?!0:"left"===this.panButton===I.clickLeft),Q&&D._39Q(Q)&&(I.preventDefault=!0),Vn(j,E),Ae(E)?D.handleDoubleClick(E,Q,a):D.handleClick(E,Q,a)}},handle_mouseup:function(o){this.handle_touchend(o)},handle_touchend:function(){},handleWindowMouseMove:function(l){this.handleWindowTouchMove(l)},handleWindowTouchMove:function(H){var Q=this,r=Q.gv,e=Q.editing;if(e){var l=r.lp(H),d=e.point,m=l.x-d.x,h=l.y-d.y;if(!e.moved){if(Math.abs(m)<Q.threshold&&Math.abs(h)<Q.threshold&&!(H.touches&&H.touches.length>1))return;e.moved=!0}if(!e.preventDefault)if(e.point=l,e.touch){var c=H.touches.length;if(2!==c)Q.pan(H,m,h);else{if(1>=c)return;var n=H.touches,z={x:n[0].clientX,y:n[0].clientY},t={x:n[1].clientX,y:n[1].clientY},Y={x:t.x-z.x,y:t.y-z.y},$=e.lastCenter,F=Math.atan2(Y.y,Y.x),B=e.theta,I=0;B==i?B=e.theta=F:(I=F-B,e.thetaStarted||Math.abs(I)>Q.touchRotateThreshold?(e.thetaStarted=!0,e.theta=F):I=0);var O=J*(z.y+t.y)/2/r.getHeight(),f=e.phi,G=0;f==i?f=e.phi=O:(G=O-f,e.phiStarted||Math.abs(G)>Q.touchRotateThreshold?(e.phiStarted=!0,e.phi=O):G=0);var S,k=Math.sqrt(Y.x*Y.x+Y.y*Y.y),g=e.vlen;if(g){var E=z.x-$.x,p=z.y-$.y,v=t.x-$.x,D=t.y-$.y,V=Math.sqrt(E*E+p*p),s=Math.sqrt(v*v+D*D),U=g/2,a=Q._sign2(V-U),R=Q._sign2(s-U);0>a*R||0===a&&0===R?(S=1,e.vlen=k):(S||(S=k/g),e.scaleStarted||Math.abs(S-1)>Q.touchScaleThreshold?(e.vlen=k,e.scaleStarted=!0):S=1)}else g=e.vlen=k,S=1;1!==S&&r.setZoom(S),(G||I)&&Q.rotate(H,I,-G),e.lastCenter={x:(t.x+z.x)/2,y:(t.y+z.y)/2}}}else if(e.pan)Q.pan(H,m,h);else{var A=r.getWidth(),y=r.getHeight();if(!A||!y)return;var N=-b*m/A,q=-b*h/y;Q.rotate(H,N,q)}}},_sign2:function(B){return Math.abs(B)<this._touchScaleCheckAccuracy?0:B>0?1:-1},handleWindowMouseUp:function(J){this.handleWindowTouchEnd(J)},handleWindowTouchEnd:function(S){var K=this,O=K.editing;if(K.editing=null,O){var v=K.gv;if(O.moved||!O.clickLeft&&!O.touch)v._panning=null,v._rotating=null,v.fi({kind:O.pan?"endPan":"endRotate",event:S});else{var I=v.getDataAt(S);I?v.sm().setSelection([I]):v.sm().clearSelection()}}},pan:function(H,W,S){var x=this,$=x.gv;if($.isPannable()){var O=$.getWidth(),Z=$.getHeight();if(O&&Z){var N=$.getCenterInfo(),o=-W/O*N.width,M=1*S/Z*N.height;$.fi({kind:$._panning?"betweenPan":"beginPan",event:H}),$._panning=1;var j=x.keepHorizon,h=x.editing.touch;if((h&&H.touches&&H.touches.length>1||!h&&Kq(H))&&(j=!j),!j)return $.pan(o,M);if(o||M){var Q=Le($),R=[Q[0]*o,Q[4]*o,Q[8]*o],D=[Q[1],0,Q[9]],B=Math.sqrt(D[0]*D[0]+D[2]*D[2]);B&&(D=[D[0]/B*M,0,D[2]/B*M]);var V=R[0]+D[0],t=R[1]+D[1],p=R[2]+D[2],n=$._center,E=$._eye;n[0]+=V,n[1]+=t,n[2]+=p,E[0]+=V,E[1]+=t,E[2]+=p,$.fp(Hh,i,E),$.fp(io,i,n)}}}},rotate:function(D,I,c){var t=this,e=t.gv;if(e.isRotatable()){var $=e._center,o=e._eye,s=_c(o,$),P=K(k(s[0]*s[0]+s[2]*s[2]),s[1]),q=Kg(P+c);c=q-P,e.fi({kind:e._rotating?"betweenRotate":"beginRotate",event:D}),e._rotating=1,e.rotate(I,c)}}}),j.defineProperties(gr.prototype,{panButton:{get:function(){return this._panButton},set:function(p){this._panButton=p}},minPhi:{get:function(){return z.graph3dViewMinPhi},set:function(a){z.graph3dViewMinPhi=a}},maxPhi:{get:function(){return z.graph3dViewMaxPhi},set:function(_){z.graph3dViewMaxPhi=_}},keepHorizon:{get:function(){return this._keepHorizon},set:function(C){this._keepHorizon=C}},threshold:{get:function(){return this._threshold},set:function(c){this._threshold=c}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(m){this._touchScaleThreshold=m}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(w){this._touchRotateThreshold=w}}});var dc,tq="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",Eq=32,Bj=Ri.GlobeInteractor=function(S,r){Kh(Bj,this,[S]);var t,Z=r.radius||6378137,Y=this,Q=null;dc||(dc=em(),dc.style.border="",dc.style.backgroundImage="url("+tq+")");var H=new ke,y=new kc,T=new kc,z=new kc,x=new jo,q="number"==typeof Z?{x:Z,y:Z,z:Z}:Z,F={center:new kc(0,0,0),radius:q},O=function(b){S._81O=null;var Q=S.getHitPosition(b,S.getCenter(),y.copy(S.getEye()).sub(T.copy(S.getCenter())).toArray());return x.origin.copy(S.getEye()),x.direction.copy(Q).sub(x.origin).normalize(),x.intersectEllipsoid(F)},D=function(N,L){S._81O=null,x.origin.copy(S.getEye());for(var J,R,$=S.getCenter(),I=y.copy(S.getEye()).sub(T.copy(S.getCenter())).toArray(),A=1,Y=16,z=0,m=1,E={x:0,y:0};Y--;){if(E.x=L.x+(N.x-L.x)*A,E.y=L.y+(N.y-L.y)*A,J=S.getHitPosition(E,$,I),x.direction.copy(J).sub(x.origin).normalize(),R=x.intersectEllipsoid(F),R&&1===A)return{hit:R};R?z=A:m=A,A=(z+m)/2}return{hit:R,out:1>A}},R=function(t,X){if(Q){var M=Date.now();Q.deltaTime=Q.lastTime?M-Q.lastTime:1e3,Q.lastTime=M,Q.lastAxis=t,Q.lastAngle=X}X&&(H.setFromAxisAngle(t,X),S.setEye(y.copy(S.getEye()).applyQuaternion(H).toArray()),S.setCenter(y.copy(S.getCenter()).applyQuaternion(H).toArray()),S.setUp(y.copy(S.getUp()).applyQuaternion(H).toArray()))};Y._showCrossIcon=function(G){pi(Y.getView(),dc),Kn(dc,{x:G.clientX-Eq/2,y:G.clientY-Eq/2,width:Eq,height:Eq})},Y._hideCrossIcon=function(){As(dc)},Y._scrollImpl=function(v,x){Q={point:S.lp(v),screen:Mi(v),hit:O(v),type:"right"},Q.hitNormalize=Q.hit?Q.hit.clone().normalize():new kc;var D={clientX:Q.screen.x,clientY:Q.screen.y+10*x};Y._handleMoveImpl(D),Y._endMoveImpl(D)},Y._startMoveImpl=function(L){t&&(t.stop(!0),t=null),Q={point:S.lp(L),screen:Mi(L),hit:O(L)},Q.hitNormalize=Q.hit?Q.hit.clone().normalize():new kc,Aj?1===L.touches.length?Q.hit&&(Q.type="left"):2===L.touches.length&&(Q.type="touch2"):(pn(L)?Q.hit&&(Q.type="left"):Nk(L)?Q.type="right":wl(L)&&Q.hit&&(Q.type="middle"),!Q.hit||"right"!==Q.type&&"middle"!==Q.type||Y._showCrossIcon(L)),Q.type&&Vn(Y,L)},Y._handleMoveImpl=function(Z){if(Q)switch(Q.type){case"left":return Y._handleLeft(Z);case"right":return Y._handleRight(Z);case"middle":return Y._handleMiddle(Z);case"touch2":return Y._handleTouch2(Z)}},Y._endMoveImpl=function(){if(Q){if(this._hideCrossIcon(),"left"===Q.type||"middle"===Q.type){var U=1e3*(Q.lastAngle/(Q.deltaTime||30)),P=Q.lastAxis,o=Q.lastTime,Z=function(){var g=Date.now(),n=(g-o)/1e3;return o=g,U*=Math.pow(Math.abs(Y.decelerationRate),3*n),Math.abs(U)<.01?(U=0,t&&t.stop(),void 0):(R(P,U*n),void 0)};t=Tk({action:function(){Z(arguments)},duration:5e3})}Q=null}},Y._handleLeft=function(w){if(!Q.finished){var f=Mi(w),U=D(f,Q.lastScreen||Q.screen);if(Q.lastScreen=f,!U.hit)return Q.finished=!0,Y._endMoveImpl(w),void 0;var P=U.hit;P.normalize();var n=Q.hitNormalize,k=Math.acos(P.dot(n)),s=P.cross(n).normalize();R(s,k),U.out&&(Q.finished=!0,Y._endMoveImpl(w))}},Y._handleRight=function(Z){var B=Q.lastScreen||Q.screen,_=B.y;B=Q.lastScreen=Mi(Z);var c=B.y,n=c-_;if(n){var V=Math.min(.5,n*Y.scaleSpeed);y.copy(S.getEye());var U=Q.hit;U||(U=y.clone().divide(q).normalize().multiply(q)),T.copy(y).lerp(U,V),S.setEye(T.toArray()),y.copy(S.getUp()),T.normalize();var H=y.clone().cross(T).normalize();if(z.copy(S.getCenter()),z.sub(H.multiplyScalar(z.dot(H))),S.setCenter(z.toArray()),Q.hit){var d=O(Q.screen),l=Q.hitNormalize;if(d){d.normalize();var N=Math.acos(d.dot(l)),P=d.cross(l).normalize();N&&R(P,N)}}}};var w=function(r){return Math.abs(r)<.01?0:r>0?1:-1};Y._handleTouch2=function(t){var o=t.touches.length;if(2===o){var M=t.touches,g={x:M[0].clientX,y:M[0].clientY},u={x:M[1].clientX,y:M[1].clientY},X={x:u.x-g.x,y:u.y-g.y},J=Q.lastCenter,m=Math.atan2(X.y,X.x),B=Q.theta,P=0;B==i?B=Q.theta=m:(P=m-B,Q.thetaStarted||Math.abs(P)>.03?(Q.thetaStarted=!0,Q.theta=m):P=0);var E,s=Math.sqrt(X.x*X.x+X.y*X.y),A=Q.vlen;if(A){var F=g.x-J.x,r=g.y-J.y,L=u.x-J.x,h=u.y-J.y,q=Math.sqrt(F*F+r*r),k=Math.sqrt(L*L+h*h),l=A/2,n=w(q-l),p=w(k-l);0>n*p||0===n&&0===p?(E=1,Q.vlen=s):(E||(E=s/A),Q.scaleStarted||Math.abs(E-1)>.05?(Q.vlen=s,Q.scaleStarted=!0):E=1)}else A=Q.vlen=s,E=1;var X=T.copy(S.getEye()).clone();1!==E&&S.setEye(X.setLength((X.length()-Z)/E+Z).toArray()),P&&R(X.normalize(),P),Q.lastCenter={x:(u.x+g.x)/2,y:(u.y+g.y)/2}}},Y._handleMiddle=function(L){var k=Mi(L),X=Q.screen;Q.screen=k;var o=(k.y-X.y)/180*Math.PI*Y.rollSpeed;T.copy(S.getCenter()).sub(y.copy(S.getEye())).normalize(),y.copy(S.getUp()).cross(T).normalize(),T.copy(S.getEye()).sub(Q.hit).applyAxisAngle(y,o).add(Q.hit);var c=T.clone();T.copy(S.getCenter()).sub(Q.hit).applyAxisAngle(y,o).add(Q.hit);var s=T.clone(),H=T.copy(S.getUp()).applyAxisAngle(y,o).clone(),O=!1;o>0&&(z.copy(H),T.copy(s).sub(c).normalize(),y.copy(c).multiplyScalar(-1).normalize(),y.dot(z)-T.dot(z)>0&&(O=!0)),O||z.copy(Q.hit).sub(c).dot(Q.hitNormalize)>=0&&(O=!0),O||(S.setEye(c.toArray()),S.setCenter(s.toArray()),S.setUp(H.toArray()));var Z=-(k.x-X.x)/180*Math.PI*Y.rotateSpeed;R(Q.hitNormalize,Z)}};Xr("GlobeInteractor",sd,{handle_contextmenu:function(s){nl(s)},handle_mousewheel:function(m){this._scrollImpl(m,m.wheelDelta/40)},handle_DOMMouseScroll:function(H){2===H.axis&&this._scrollImpl(H,-H.detail)},handle_keydown:function(L){this.gv.handleKeyDown(L)},handle_mousedown:function(v){this.handle_touchstart(v)},handle_touchstart:function(m){nl(m);var I=this.gv;if(I.setFocus(m)){var S=I.getDataInfoAt(m),y=S?S.data:i;y&&I.isInteractive(y)||this._startMoveImpl(m);var n=S?S.part:i;Ae(m)?I.handleDoubleClick(m,y,n):I.handleClick(m,y,n)}},handle_mouseup:function(h){this.handle_touchend(h)},handle_touchend:function(){},handleWindowMouseMove:function(i){this.handleWindowTouchMove(i)},handleWindowTouchMove:function(K){this._handleMoveImpl(K)},handleWindowMouseUp:function(Q){this.handleWindowTouchEnd(Q)},handleWindowTouchEnd:function(N){this._endMoveImpl(N)}}),j.defineProperties(Bj.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(R){this._rotateSpeed=R}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(Y){this._rollSpeed=Y}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(I){this._scaleSpeed=I}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function($){this._decelerationRate=$}}});var Lm=function(O){this.gv=O};Zi(Lm,j,{_iv:!0,iv:function(){this._iv=!0},face:function(Z,I){var F=this,N=F.gv.getGL();if(!N||!gj(Z))return i;var e=I.x,f=I.width,$=I.height,v=F.height-I.y-$,a=O(f/2),u=new Uint8Array(4*f*$),c=0;for(F.iv(),F.validate(Z),hl(N,F.frame),N.readPixels(e,v,f,$,N.RGBA,N.UNSIGNED_BYTE,u),Ln(N),F.iv();a>=c;c++)for(var L=a-c,z=a+c,w=L;z>=w;w++)for(var Y=L;z>=Y;Y++)if(w===L||w===z||Y===L||Y===z){var l=Jq.m[u[4*(w*f+Y)]];if(l)return l}},get:function(C,G){this.validate();var f=this,W=f.gv.getGL();if(!W)return i;var e,R,j=C.x,A=C.width,V=C.height,U=f.height-C.y-V,z=O(A/2),s=new Uint8Array(4*A*V),H=0,t=s.length,k=G?i:new Yi,L=G?i:{};if(hl(W,f.frame),W.readPixels(j,U,A,V,W.RGBA,W.UNSIGNED_BYTE,s),Ln(W),G){for(;z>=H;H++)for(var D=z-H,o=z+H,T=D;o>=T;T++)for(var w=D;o>=w;w++)if((T===D||T===o||w===D||w===o)&&(e=f.info(s,4*(T*A+w))))return e}else for(;t>H;H+=4)e=f.info(s,H),e&&(R=e.data,L[R._id]||(k.add(R),L[R._id]=R));return k},info:function(h,s){return this.colorMap[(h[s]<<16)+(h[s+1]<<8)+h[s+2]+((127&h[s+3])<<24)]},validate:function(I){var j=this,Z=j.gv,b=Z.getGL();if(b){var L=Z.getWidth(),R=Z.getHeight(),K=b.RGBA,P=b.TEXTURE_2D,B=b.RENDERBUFFER,y=b.FRAMEBUFFER;j.texture||(j.texture=mr(b),j.render=b.createRenderbuffer(),j.frame=b.createFramebuffer()),(j.width!==L||j.height!==R)&&(Bg(b,j.texture),b.texImage2D(P,0,K,L,R,0,K,b.UNSIGNED_BYTE,i),Mp(b,b.TEXTURE_MIN_FILTER,b.LINEAR),b.bindRenderbuffer(B,j.render),b.renderbufferStorage(B,b.DEPTH_COMPONENT16,L,R),hl(b,j.frame),b.framebufferTexture2D(y,b.COLOR_ATTACHMENT0,P,j.texture,0),b.framebufferRenderbuffer(y,b.DEPTH_ATTACHMENT,B,j.render),Bg(b,i),b.bindRenderbuffer(B,i),Ln(b),j.width=L,j.height=R),j._iv&&(j._iv=!1,hl(b,j.frame),Z._42(I||(j.colorMap={}),1),Ln(b))}}});var Tm=function(B){this.gv=B};Zi(Tm,j,{gap:0,size:0,_42:function(p,B){var w=this,s=w.gv,c=s._gridGap,E=s._gridSize;if(s._gridVisible){if(w.gap!==c||w.size!==E){for(var h=[],r=s._gridSize/2,d=c*r,F=0;2*r+1>F;F++){var K=6*F,S=6*(2*r+1)+K;h[K]=-d,h[K+1]=0,h[K+2]=-d+F*c,h[K+3]=d,h[K+4]=0,h[K+5]=-d+F*c,h[S]=-d+F*c,h[S+1]=0,h[S+2]=-d,h[S+3]=-d+F*c,h[S+4]=0,h[S+5]=d}w.vs=new $g(h),w.gap=c,w.size=E}Rk(s),wf(p,B),km(p),Nb(p,B,1,s._gridColor,s._buffer.vs,w.vs),Zq(p,0,w.vs.length/3,p.LINES),qg(p),kd(p,B)}else w.vs=w.gap=w.size=i}});var Ne=function(U){this.gv=U};Zi(Ne,j,{_42:function(q,v){var I=this.gv,j=I._buffer.vs,B=I._axisXColor,Y=I._axisYColor,H=I._axisZColor,S=I._originAxisVisible,$=I._centerAxisVisible;if(S||$){var C=Ph?q.TRIANGLES:q.TRIANGLE_FAN,G=q.LINES;if(Rk(I),wf(q,v),km(q),S){var L=I.getCenterInfo(),E=_(L.width,L.height)/5,U=.8*E,P=.05*E;Nb(q,v,1.5,B,j,new $g([0,0,0,E,0,0,U,P,0,U,0,P,U,-P,0,U,0,-P,U,P,0,0,0,0,0,E,0,P,U,0,0,U,P,-P,U,0,0,U,-P,P,U,0,0,0,0,0,0,E,P,0,U,0,P,U,-P,0,U,0,-P,U,P,0,U])),Zq(q,0,2,G),Zq(q,1,6,C),Nb(q,v,i,Y),Zq(q,7,2,G),Zq(q,8,6,C),Nb(q,v,i,H),Zq(q,14,2,G),Zq(q,15,6,C)}if($){var f=I._center,V=f[0],T=f[1],h=f[2],L=I.getPositionInfo(f);E=_(L.width,L.height)/20,Nb(q,v,1.5,B,j,new $g([V,T,h,V+E,T,h,V,T,h,V,T+E,h,V,T,h,V,T,h+E])),Zq(q,0,2,G),Nb(q,v,i,Y),Zq(q,2,2,G),Nb(q,v,i,H),Zq(q,4,2,G)}qg(q),kd(q,v)}}});var ug=function(q){this.gv=q,this.onMouseOver=this.onMouseOver.bind(this),this.mode=ug.Mode.Disable};ug.Mode={Disable:0,Selection:1,MouseOver:2},Zi(ug,j,{onMouseOver:function(t){z.preventDefault(t);var g=this.gv.getDataAt(t);g!==this.mouseOverData&&(this.mouseOverData=g,this.gv.iv())},setFetchTargetFunc:function(O){this.fetchTargetFunc=O},_42:function(D,N){var w,x=this,A=x._mode;if(A!==ug.Mode.Disable&&(A===ug.Mode.Selection?w=x.gv.sm().getSelection().toArray(function(V){return V.s("highlight.visible")}):A===ug.Mode.MouseOver&&x.mouseOverData&&x.mouseOverData.s("highlight.visible")&&(w=[x.mouseOverData]),x.fetchTargetFunc&&(w=x.fetchTargetFunc(w)),w&&w.length)){var B=x.gv,H=B.vr.isPresenting(),O=B.getWidth();if(H){var u=B.getWidth;O/=2,B.getWidth=function(){return O};var t=B.getViewport()}var k,v=B.getDevicePixelRatio(),g=O*v,G=B.getHeight()*v;(k=x._renderTarget)?k.setSize(D,g,G):x._renderTarget=k=new Ri.RenderTarget(B,D,g,G),hl(D,k.frame),B.drawFilter=function(k){return w.indexOf(k)<0?!0:void 0},B._42({}),B.drawFilter=null,Ln(D),H&&(B.getWidth=u,B.setViewport(D,t[0],t[1],t[2],t[3]));var J=D._compiledShader.highlight;if(J||(J=D._compiledShader.highlight=new Oh.Shader(D,ld.vs,ld.fs)),J.bind(),D.enable(D.BLEND),D.activeTexture(D.TEXTURE0+0),D.bindTexture(D.TEXTURE_2D,k.texture),J.uniforms.image=0,J.uniforms.textureSize=[g,G],J.uniforms.edgeWidth=q["highlight.width"],x.highlightColor!==q["highlight.color"]){var $=xk(x.highlightColor=q["highlight.color"]);x.highlightColorData=[$[0]/255,$[1]/255,$[2]/255,$[3]/255]}J.uniforms.edgeColor=x.highlightColorData,x.ibuffer?(x.ibuffer.upload(),x.vbuffer.upload()):(x.ibuffer=Oh.Buffer.createIndexBuffer(D,new Uint16Array([0,2,1,1,2,3])),x.vbuffer=Oh.Buffer.createVertexBuffer(D,new Float32Array([0,0,1,0,0,1,1,1]))),J.attributes.pos.pointer(x.vbuffer),D.drawElements(D.TRIANGLES,6,D.UNSIGNED_SHORT,0),D.disable(D.BLEND),D.bindTexture(D.TEXTURE_2D,null),D.useProgram(N)}}}),j.defineProperties(ug.prototype,{mode:{get:function(){return this._mode},set:function(T){var j=this._mode;T!==j&&(this._mode=T,T===ug.Mode.MouseOver?Z(this.gv.getView(),"mousemove",this.onMouseOver):j===ug.Mode.MouseOver&&m(this.gv.getView(),"mousemove",this.onMouseOver))}}});var ld={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},Ih=function(m){this.gv=m},Vk="edit_tx",rh="edit_ty",Pm="edit_tz",mc="edit_rx",Bo="edit_ry",ic="edit_rz",ln="edit_sx",wk="edit_sy",qq="edit_sz",sq={};sq[Vk]=1,sq[rh]=1,sq[Pm]=1,sq[mc]=1,sq[Bo]=1,sq[ic]=1,sq[ln]=1,sq[wk]=1,sq[qq]=1,Zi(Ih,j,{_42:function(C,p,c){var w=this,H=w.gv,E=H.sm().ld();if(E&&H.isEditable(E)&&!H.isEditHelperDisabled()&&gj(E)&&(!H.isFirstPersonMode()||!H.isMouseRoamable()&&!Aj)){Rk(H);var Y,o,b=H.isMovable(E),N=H.isRotationEditable(E),F=H.isSizeEditable(E),V=H._axisXColor,v=H._axisYColor,W=H._axisZColor,Z=H._editSizeColor,L=E.p3(),d=_m(H.getEye(),L)/10,g=d/(c?5:10),i=.7*d,P=.4*i,U=L[0],u=L[1],I=L[2];Y=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],b&&w._17O(C,p,E,c,Vk,V,Y,[U,u-g,I,U+i,u-g,I,U+i,u,I,U+i,u,I,U,u,I,U,u-g,I,U,u-g,I+g,U+i,u-g,I+g,U+i,u-g,I,U+i,u-g,I,U,u-g,I,U,u-g,I+g]),o=U+i,F&&w._17O(C,p,E,c,ln,Z,Y,[o,u-g,I,o+P,u-g,I,o+P,u,I,o+P,u,I,o,u,I,o,u-g,I,o,u-g,I+g,o+P,u-g,I+g,o+P,u-g,I,o+P,u-g,I,o,u-g,I,o,u-g,I+g]),o+=P,N&&w._17O(C,p,E,c,mc,V,Y,[o,u-g,I,o+P,u-g,I,o+P,u,I,o+P,u,I,o,u,I,o,u-g,I,o,u-g,I+g,o+P,u-g,I+g,o+P,u-g,I,o+P,u-g,I,o,u-g,I,o,u-g,I+g]),Y=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],b&&w._17O(C,p,E,c,rh,v,Y,[U,u,I,U,u+i,I,U-g,u+i,I,U-g,u+i,I,U-g,u,I,U,u,I,U,u,I,U,u,I-g,U,u+i,I-g,U,u+i,I-g,U,u+i,I,U,u,I]),o=u+i,F&&w._17O(C,p,E,c,wk,Z,Y,[U,o,I,U,o+P,I,U-g,o+P,I,U-g,o+P,I,U-g,o,I,U,o,I,U,o,I,U,o,I-g,U,o+P,I-g,U,o+P,I-g,U,o+P,I,U,o,I]),o+=P,N&&w._17O(C,p,E,c,Bo,v,Y,[U,o,I,U,o+P,I,U-g,o+P,I,U-g,o+P,I,U-g,o,I,U,o,I,U,o,I,U,o,I-g,U,o+P,I-g,U,o+P,I-g,U,o+P,I,U,o,I]),Y=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],b&&w._17O(C,p,E,c,Pm,W,Y,[U,u,I,U,u,I+i,U,u-g,I+i,U,u-g,I+i,U,u-g,I,U,u,I,U,u-g,I,U-g,u-g,I,U-g,u-g,I+i,U-g,u-g,I+i,U,u-g,I+i,U,u-g,I]),o=I+i,F&&w._17O(C,p,E,c,qq,Z,Y,[U,u,o,U,u,o+P,U,u-g,o+P,U,u-g,o+P,U,u-g,o,U,u,o,U,u-g,o,U-g,u-g,o,U-g,u-g,o+P,U-g,u-g,o+P,U,u-g,o+P,U,u-g,o]),o+=P,N&&w._17O(C,p,E,c,ic,W,Y,[U,u,o,U,u,o+P,U,u-g,o+P,U,u-g,o+P,U,u-g,o,U,u,o,U,u-g,o,U-g,u-g,o,U-g,u-g,o+P,U-g,u-g,o+P,U,u-g,o+P,U,u-g,o])}},_17O:function(Y,c,n,P,v,X,b,G){var A=this.gv._buffer;Te(Y,c,P,!0,n,v),Pq(Y,c,i,!0,i,!0,i,!1),Ir(Y,c.uDiffuse,X),Sj(Y,A.vs,new $g(G),c.aPosition),Sj(Y,A.ns,new $g(b),c.aNormal),km(Y),Zq(Y,0,12),qg(Y),ub(Y,c)}});var nr=r.Raycaster=function(x){this.gv=x,this.maxTriangleTest=1/0,this.backfaceCulling=!0};zr("Raycaster",j,{intersect:function(J){var u=this,c=u.gv,q=c.getDataAt(J);return q?u.intersectObject(J,q):null},intersectObjects:function(p,M,C){var b,F,f,R,m=this,A=1/0,w=p.origin||(new kc).fromArray(m.gv.getEye()),o=m.maxTriangleTest,T=[];return M.forEach(function(x){C&&C(x)===!1||x.s("intersect")!==!1&&T.push(x)}),T.sort(function($,H){return w.distanceToSquared2($.p3())-w.distanceToSquared2(H.p3())}),m.countTriangles=0,T.forEach(function(g){m.countTriangles>o||(b=m.intersectObject(p,g),b&&(F=w.distanceToSquared(b.world),A>F&&(f=g,R=b,A=F)))}),m.countTriangles=0,{data:f,intersect:R}},intersectObject:function(d,B){if(d instanceof jo)return this._intersectObjectImpl(d,B);var L=this,I=L.gv,p=I.unproject(d),i=new kc,A=I.getEye(),v=new kc;if(I.isOrtho()){var N=new kc(A);v.copy(I.getCenter()).sub(N).normalize();var K=i.copy(p).sub(N).dot(v);i.copy(v).setLength(-K).add(N.copy(p))}else i.copy(A),v.copy(p).sub(i).normalize();var J=new r.Math.Ray(i,v);return L._intersectObjectImpl(J,B)},_intersectObjectImpl:function(){function y(){var Z=new kc;return Z.subVectors(p,x),E.subVectors(q,x),Z.cross(E).normalize(),Z}function $(g,k,e,h,A,G,U){return Ud.barycoordFromPoint(g,k,e,h,O),A.multiplyScalar(O.x),G.multiplyScalar(O.y),U.multiplyScalar(O.z),A.add(G).add(U),A.clone()}function b(x,p,Z){Qb(x)?x.forEach(function(l){b(l,p,Z)}):un(x)?b(ch(p,x),p,Z):zo(x)&&(x.shape3d?b(x.shape3d,p,Z):Z.push(x))}var N=new jq,A=new jq,P=new jo,V=new kc,F=new kc,J=new kc,n=new kc,c=new kc,q=new kc,x=new kc,p=new kc,Y=new cs,G=new cs,z=new cs,E=new kc,I={vs:Df,is:Ar,uv:Jl},O=new kc;return function(C,L){var m=this.gv.getData3dUI(L),X=L.mat||m.mat;if(X){N.fromArray(X),A.getInverse(N),P.copy(C).applyMatrix4(A);var B,T,Q="body",o=m.shapeModel;if(o||(o=ch(m)),o||(L instanceof r.Node&&!(L instanceof r.Shape)?(B=!0,o=I):(T=!0,o=[m.left,m.front,m.right,m.back,m.top,m.bottom])),!o)return console.log("Can not find shape model."),null;Qb(o)||(o=[o]);var H,i,D,l,k,E,h,e,O,W,g,f,u,S,Z,t,K=1/0,j=["","top_","bottom_"],U=!1,w=this.backfaceCulling,R=[];for(b(o,m,R),H=0,i=R.length;i>H;H++)if(u=R[H])for(D=0,l=j.length;l>D;D++)if(S=j[D],h=u[S+"vs"],e=u[S+"is"],O=u[S+"uv"]||u[S+"tuv"],h){if(Z=u[S+"boundingBox"]){var g=P.intersectBox(Z);if(!g)continue;if(P.origin.distanceTo(g)>K)continue;t=!1}else u[S+"boundingBox"]=Z=new r.Math.Box3,t=!0;for(k=0,E=e?e.length:h.length/3;E>k;k+=3)this.countTriangles++,e?(F.fromArray(h,3*e[k]),J.fromArray(h,3*e[k+1]),n.fromArray(h,3*e[k+2])):(F.fromArray(h,3*k),J.fromArray(h,3*(k+1)),n.fromArray(h,3*(k+2))),t&&(Z.expandByPoint(F),Z.expandByPoint(J),Z.expandByPoint(n)),W=P.intersectTriangle(F,J,n,w,V),W&&(f=P.origin.distanceTo(W),K>f&&(K=f,c.copy(W),q.copy(F),x.copy(J),p.copy(n),""!==S?Q=S.slice(0,-1):B?Q=Ao[Math.floor(k/6)]:T&&(Q=Ao[H]),O&&(U=!0,e?(Y.fromArray(O,2*e[k]),G.fromArray(O,2*e[k+1]),z.fromArray(O,2*e[k+2])):(Y.fromArray(O,2*k),G.fromArray(O,2*(k+1)),z.fromArray(O,2*(k+2))))))}if(!isFinite(K))return null;var d,s=c.clone().applyMatrix4(N);U&&(d=$(c,q,x,p,Y,G,z));var v=y(q,x,p),a=y(q.applyMatrix4(N),x.applyMatrix4(N),p.applyMatrix4(N)),M=P.direction.dot(v);return M>0&&(v.multiplyScalar(-1),a.multiplyScalar(-1)),{world:s,local:c.clone(),worldNormal:a,normal:v,uv:d,part:Q}}}}()});var Jf=function(Q,O){this.gv=Q,this.s=function(l,d,u){return d==i&&(d=u),d==i?O.getStyle(l):gf(d,O,Q)},this.data=O};Zi(Jf,j,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(H,Q,y,o){var S=this,c=S.data;if(!(c instanceof Mb)){var v,I,P,L,N,V,E,k=S.gv,Y=c._id,T=S.s("alwaysOnTop")||S.s("shape3d.alwaysOnTop")?null:S.s("batch"),R=k._batchIndexMap,u=k._batchModelMap,U=k.isSelectable(c),w=k.getBrightness(c),b=w!=i&&1!==w;if(S.needValidate(H)){if(P=bi(R,u,c,T),S.validate(P,T?lp[T]||ej:i),P&&(L=R[Y],N=L.size=P.vs.length/3-L.begin,E=P.rs))for(w=b?w:1,V=0;N>V;V++)E.push(w);if(gj(c)){var l=k.getWireframeGeometry(c);if(l)Qh(k,c,l);else{var M=k.getWireframe(c);M&&Qh(k,c,M)}}S.labelInfo=S.label2Info=S.noteInfo=S.note2Info=S._38o=i,S._24O(Kr,"getLabel"),S._24O(al,"getLabel2"),S._26O(ol,"getNote"),S._26O(Al,"getNote2"),S._15O(),S.interactiveInfo=k.isInteractive(c)?{}:i,S._iv=!1}b&&Ir(H,Q.uBrightness,w),Ir(H,Q.uAlphaTest,S.s("alphaTest")),Ir(H,Q.uUseEnvMap,c.s("envmap")?!0:!1),Ir(H,Q.uReflectivity,c.s("envmap")||.01);var Z=S.s("3d.clip.direction");if(Z){var J=S.s("3d.clip.percent");switch(Z){case"left":Z=2;break;case"top":Z=3;break;case"bottom":Z=4;break;case"front":Z=5;break;case"back":Z=6;break;case"right":default:Z=1}if(0===Z%2&&(J=1-J),c instanceof r.Shape){var _=c.s3(),e=c.p3(),q=c.getAnchor3d();J=3>Z?(J-q.x)*_[0]+e[0]:5>Z?(J-q.y)*_[1]+e[1]:(J-q.z)*_[2]+e[2]}else J-=.5;Ir(H,Q.uClipPercent,J)}H.uniform1i(Q.uClipDirection,Z||0),I=Te(H,Q,y,U,c,Oj),I&&(Kj(I,R[Y],u),Kj(I,k._polylineIndexMap[Y],k._polylineModelMap),Kj(I,k._wireframeIndexMap[Y],k._wireframeModelMap)),R[Y]||S._80o(H,Q,o),k.isLabelVisible(c)&&((v=S.labelInfo)&&(Te(H,Q,y,U,c,Kr),S._28O(v,Kr,o)),(v=S.label2Info)&&(Te(H,Q,y,U,c,al),S._28O(v,al,o))),k.isNoteVisible(c)&&((v=S.noteInfo)&&(Te(H,Q,y,U,c,ol),S._29O(v,ol,o)),(v=S.note2Info)&&(Te(H,Q,y,U,c,Al),S._29O(v,Al,o))),(v=S._38o)&&S._99O(H,Q,v,y,U,o),b&&Ir(H,Q.uBrightness,1),Z&&H.uniform1i(Q.uClipDirection,0)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return nn},_80o:function(){},dispose:function(){},_calcAnchorMat:function(l){if(l.hasOwnProperty("_anchor")||l.hasOwnProperty("_anchorElevation")){var I=l.getAnchor3d(),J={x:I.x-.5,y:I.y-.5,z:I.z-.5},$=Fc();return Gg($,[-J.x,-J.y,-J.z]),$}},getBodyColor:function(e){var R=this.data,M=this.gv.getBodyColor(R);return M?M:e?R.getStyle(e):i},getCachedTexture:function(S){var G=this._cachedTextures;return G?G[S||"main"]:null},setCachedTexture:function(f,V){var X=this._cachedTextures;return X||(X=this._cachedTextures={}),X[V||"main"]=f,f},invalidateCachedTexture:function(j){var W=this._cachedTextures;for(var q in W)j.deleteTexture(W[q]);this._cachedTextures={}},_24O:function(t,F){var o=this,g=o.data,O=o.gv,r=o.s,k=O[F](g);if(k!=i){var w=r(t+".scale"),x=r(t+".max"),A=o[t+"Info"]={label:k,textureScale:r(t+".texture.scale"),color:O[F+"Color"](g),font:r(t+".font"),align:r(t+".align"),background:O[F+"Background"](g)},T=A.rect=_g(A,k);x>0&&x<T.width&&(A.labelWidth=T.width,T.width=x),T.x=T.y=0,T.width*=w,T.height*=w,A.mat=o._16O(r(t+".autorotate"),r(t+".position"),T,r(t+".face"),r(t+".t3"),r(t+".r3"),r(t+".rotationMode"));var q=T.width/2,h=T.height/2;A.vs=new $g([-q,h,0,-q,-h,0,q,-h,0,q,h,0]),T.width/=w,T.height/=w}},_26O:function(I,s){var p=this,B=p.data,F=p.gv,C=p.s,z=F[s](B);if(z!=i){var o=C(I+".scale"),q=this[I+"Info"]={note:z,textureScale:C(I+".texture.scale"),expanded:C(I+".expanded"),font:C(I+".font"),color:C(I+".color"),align:C(I+".align"),borderWidth:C(I+".border.width"),borderColor:C(I+".border.color"),background:F[s+"Background"](B)};if(q.expanded){var M=C(I+".max"),f=_g(q,z);f.width+=6,f.height+=2,M>0&&M<f.width&&(q.labelWidth=f.width,f.width=M);var k={x:-f.width/2,y:-8-f.height,width:f.width,height:f.height+8}}else k={x:-6,y:-18,width:12,height:18};q.mat=p._16O(C(I+".autorotate"),C(I+".position"),i,C(I+".face"),C(I+".t3"),C(I+".r3"),C(I+".rotationMode")),q.rect=k,1!==o&&(k=Se(k),k.x*=o,k.height*=o,k.y=-k.height,k.width*=o);var b=k.x,Y=k.y,W=k.width,Z=k.height;q.vs=new $g([b,-Y,0,b,-Y-Z,0,b+W,-Y-Z,0,b+W,-Y,0])}},_28O:function(k,E,q){if(q(this.s(E+".transparent"))){var e=k.rect,u=k.textureScale,p=e.width*u,x=e.height*u;if(p>=1&&x>=1){var I=xl(p,x);1!==u&&(I.translate(I,e.x,e.y),I.scale(u,u),I.translate(I,-e.x,-e.y)),Cr(I,k),I.restore(),Rm(this,E,k.mat,k.vs,!0)}}},_29O:function(i,G,$){if($(this.s(G+".transparent"))){var H=i.rect,M=i.textureScale,C=H.x,S=H.y,Q=H.width*M,h=H.height*M;if(Q>=1&&h>=1){H.x=H.y=0;var a=xl(Q,h);1!==M&&a.scale(M,M),Xm(a,i),a.restore(),H.x=C,H.y=S,Rm(this,G,i.mat,i.vs,!1)}}},_99O:function(J,s,e,j,K,E){if(e){var d=this,c=d.gv,b=d.data,h=c._buffer,o=c._1O,F=e.icons;for(var Y in F){var N=F[Y],z=e.rects[Y];if(z&&E(gf(N.transparent,b,c))){Te(J,s,j,K,b,Y);var q=gf(N.shape3d,b,c),v=q?[q]:gf(N.names,b,c),y=v?v.length:0,T=gf(N.textureScale,b,c)||1,n=gf(N.light,b,c);n==i&&(n=q?!0:!1),Pq(J,s,gf(N.blend,b,c),n,gf(N.opacity,b,c),gf(N.reverseFlip,b,c),gf(N.reverseColor,b,c),gf(N.reverseCull,b,c));
for(var M=0;y>M;M++){var D=v[M],m=z[M];if(Zg(d,m.mat),q)Ho(c,b,ch(d,q),d);else{var $=Ij(D);if($){var U=m.width*T,P=m.height*T;if(U>=1&&P>=1){var f=xl(U,P);ml(f,$,gf(N.stretch,b,c),0,0,U,P,b,c),f.restore(),mr(J,pl,o),km(J,s,o,gf(N.discardSelectable,b,c),h.uv,ad),Sj(J,h.vs,m.vs,s.aPosition),zn(J,h.ns,Zk,s.aNormal),Jb(J,h.is,fn),dm(J,0,fn.length),qg(J,s,o)}}}Zr(c)}ub(J,s)}}}}});var oe=function(C,V){Kh(oe,this,[C,V])};Zi(oe,Jf,{_16O:function(r,P,p,w,V,W,g,U,$){var C=this.data,h=C.getFinalScale3d(),o=ri(P,h,p,w,U,$);if(C.hasOwnProperty("_anchor")||C.hasOwnProperty("_anchorElevation")){var Z=C.getAnchor3d();o[0]-=(Z.x-.5)*h[0],o[1]-=(Z.y-.5)*h[1],o[2]-=(Z.z-.5)*h[2]}return Bh(Fc(),o,C.p3(),w,V,W,g,r,C.getFinalRotation3d(),C.getRotationMode())},clear:function(){var s=this;s.faceMat=s.mat=s.shapeModel=s.left=s.right=s.front=s.back=s.top=s.bottom=s.csg=i},needValidate:function(H){if(this._iv)return this._validateFrameId=H._renderInfo.frame,!0;if(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var C=H._renderInfo.frame;if(this._validateFrameId!==C)return this._validateFrameId=C,!0}return!1},validate:function(t,E){var T=this,J=T.gv,Q=T.data,e=T.shapeName=T.s(il),z=ch(T,e);T._updateAutoRotation(),T._updateFixSize2d(),T._updateOverlapping(),(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen"))&&(pc(J,Q,"_wireframeModelMap","_wireframeIndexMap"),pc(J,Q,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var f=sf(Q,J.getMat(Q),z?T.s("shape3d.scaleable"):!0),k=T._calcAnchorMat(Q);if(k&&ao(f,f,k),Q.mat=f,T.clear(),z||!e)if(t){var $=[];z?dd(J,Q,z,T,T.getBodyColor(),[f],t,$):(uc(J,Q,t,E,f,br,$,An),uc(J,Q,t,E,f,lk,$,bo),uc(J,Q,t,E,f,bm,$,bh),uc(J,Q,t,E,f,Lp,$,Yk),uc(J,Q,t,E,f,wg,$,aj),uc(J,Q,t,E,f,xs,$,pj)),$.length&&(ks(t.vs,$),ks(t.ns,Yl($)))}else T.mat=f,(T.shapeModel=z)||(T._cubeUvs=null,T.vf(br,0),T.vf(lk,16),T.vf(wg,8),T.vf(xs,24),T.vf(bm,32),T.vf(Lp,40))},_updateAutoRotation:function(){var B=new Ug,z=new jq,S=new kc,A=new kc,y=new kc;return function(){var p=this,U=p.data,W=p.s("autorotate")||p.s("shape3d.autorotate");if(!W)return U._dynamicRotation&&delete U._dynamicRotation,void 0;var w=p.gv;y.copy(p.s("shape3d.autorotate.up")||w._up);var D;D="string"==typeof W?[W.indexOf("x")<0?w._eye[0]:w._center[0],W.indexOf("y")<0?w._eye[1]:w._center[1],W.indexOf("z")<0?w._eye[2]:w._center[2]]:w._eye;var M=w._center,Q=U.p3();S.copy(Q),A.set(D[0]-M[0],D[1]-M[1],D[2]-M[2]).add(S),z.lookAt(A,S,y),B.set(0,0,0,U.getRotationMode(),!0).setFromRotationMatrix(z);var o=U._dynamicRotation;o&&Math.abs(o[0]-B.x)<1e-5&&Math.abs(o[1]-B.y)<1e-5&&Math.abs(o[2]-B.z)<1e-5||(U._dynamicRotation=[B.x,B.y,B.z])}}(),_updateFixSize2d:function(){var R=this,c=R.data,F=R.s("fixSizeOnScreen")||R.s("shape3d.fixSizeOnScreen");if(!F)return c._dynamicScale3d&&delete c._dynamicScale3d,void 0;var W=R.gv,u=sf(c,W.getMat(c)),Z=pq([0,0,0],u),I=W.toViewPosition(Z);if(!isNaN(I.x)&&!isNaN(I.y)){var N=pq([1,0,0],u),G=W.toViewPosition(N),q=pq([0,1,0],u),T=W.toViewPosition(q),Y=G.x-I.x,f=T.y-I.y;if(Y&&f){var $,n,t=c._dynamicScale3d||[1,1,1],d=Ij(c.s("shape3d.image"));if(F[0]>0&&($=F[0]),F[1]>0&&(n=F[1]),!$||!n){var D=F>0?F:1;$||($=(gq(d,c)||c.getWidth())*D),n||(n=(eo(d,c)||c.getTall())*D)}var _=Math.abs(Y/$),U=Math.abs(f/n);Math.abs(_-1)<.001&&Math.abs(U-1)<.001||(c._dynamicScale3d=[t[0]/_,t[1]/U,t[2]])}}},_updateOverlapping:function(){var I=this,$=I.s("hide.overlapping.group");if(!$)return I._rectOverlapping&&(I._rectOverlapping=s),void 0;var c,P,h,L=I.gv,r=I.data,m=sf(r,L.getMat(r)),b=1/0,A=1/0,R=-1/0,J=-1/0,N=r.getAnchor3d(),w=N.x,t=N.y,i=N.z;for(c=0;8>c;c++){if(P=pq([(c>>2)-w,(1&c>>1)-t,(1&c)-i],m),h=L.toViewPosition(P),isNaN(h.x)||isNaN(h.y))return;b=Math.min(b,h.x),R=Math.max(R,h.x),A=Math.min(A,h.y),J=Math.max(J,h.y)}var W={x:b,y:A,w:R-b,h:J-A};I._rectOverlapping=L.overlappingBox.isOverlapping($,W)},getVectorDynamicSize:function(){var o,T=this,n=T.s("shape3d"),g=T.data;if("billboard"===n||"plane"===n||(o=g._currentCubeElementId)!=i){var W,K,c=T.gv,e=sf(g,c.getMat(g)),$=g.getAnchor3d(),t=.5-$.x,d=.5-$.y,y=.5-$.z,N=T.s("vector.dynamic.maxsize"),Q=function(p,X){p[0]+=t,p[1]+=d,p[2]+=y,X[0]+=t,X[1]+=d,X[2]+=y;var P=c.toViewPosition(pq(p,e)),S=c.toViewPosition(pq(X,e)),H=P.x-S.x,E=P.y-S.y;return Math.min(N,Math.sqrt(H*H+E*E))};if("billboard"===n)W=Q([-.5,0,0],[.5,0,0]),K=Q([0,-.5,0],[0,.5,0]);else if("plane"===n)W=Q([-.5,0,0],[.5,0,0]),K=Q([0,0,-.5],[0,0,.5]);else if(g._currentCubeElementId!=i){var D=3*Ar[o+1],f=3*Ar[o],L=3*Ar[o+2];W=Q([Df[D],Df[D+1],Df[D+2]],[Df[L],Df[L+1],Df[L+2]]),K=Q([Df[D],Df[D+1],Df[D+2]],[Df[f],Df[f+1],Df[f+2]])}return[W,K]}},vf:function(j,c){var L=this;if(L.gv.getFaceVisible(L.data,j)){var B=ph(L,j);B.mat&&(L.faceMat=!0);var y=B.uv;if(y){var f=L._cubeUvs;f||(f=L._cubeUvs=new $g([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var n=0;8>n;n++)f[c+n]=y[n]}return B}},_billboardInView:function(){var _=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],L=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],R=new id,I=new kc,v=new jq;return function(q){var G=this;if(!G.mat)return!0;var N=G.gv.getFrustum(),b="billboard"===q?_:L;R.makeEmpty(),v.fromArray(G.mat);for(var m=0,X=b.length;X>m;m+=3)R.expandByPoint(I.fromArray(b,m).applyMatrix4(v));return N.intersectsBox(R)}}(),_80o:function(U,O,A){var e=this;if(e._rectOverlapping)return!0;var K=e.shapeModel;if(K||!e.shapeName){var y=e.s("shape3d");if(("billboard"===y||"plane"===y)&&!e._billboardInView(y))return!0;var h=e.gv,o=e.data,H=h._cube;Rk(h,e.mat),e.s("shape3d.reflector")&&!U._picking||(K?Ho(h,o,K,e,e.getBodyColor(),A):(Sj(U,H.vs,i,O.aPosition),Sj(U,H.ns,i,O.aNormal),cd(U,H.is),e._18O(U,O,"left",0,A),e._18O(U,O,"front",6,A),e._18O(U,O,"right",12,A),e._18O(U,O,"back",18,A),e._18O(U,O,"top",24,A),e._18O(U,O,"bottom",30,A))),Zr(h),e.faceMat&&(e._18O(U,O,"left",0,A,!0),e._18O(U,O,"front",6,A,!0),e._18O(U,O,"right",12,A,!0),e._18O(U,O,"back",18,A,!0),e._18O(U,O,"top",24,A,!0),e._18O(U,O,"bottom",30,A,!0))}},_18O:function(y,K,N,H,M,$){var w=this[N];if(w){if(!M(w.transparent))return;if($&&!w.mat||!$&&w.mat)return;var R=this.data.s("polygonOffset");R&&up(y,R),$&&Rk(this.gv,w.mat);var g=this,m=g.data;m._currentCubeElementId=H;var L=g.gv,d=L.getTexture(w.texture,m,N),Z=w.uv,a=w.uvScale,f=w.uvOffset,s=w.discardSelectable;d?Z?km(y,K,d,s,L._buffer.uv,g._cubeUvs,f,a):km(y,K,d,s,L._cube.uv,i,f,a):km(y),Pq(y,K,w.blend,w.light,w.opacity,w.reverseFlip,w.reverseColor,w.reverseCull),Ir(y,K.uDiffuse,w.color||q["color.empty"]),dm(y,H,6),ub(y,K),qg(y,K,d),$&&Zr(L),R&&fj(y),m._currentCubeElementId=null}},drawReflector:function(){var Z=new kc,g=new kc,x=new Ug,T=new jq,R=new kc,l=new kc,_=new kc,X=new kc,j=new jq,N=new jq,G=new Xb,r=new jd,V=new jd,P=function(s,x,l){s[l]=x[0],s[l+1]=x[1],s[l+2]=x[2]},y=function(e,t){P(e,t.getEye(),0),P(e,t.getCenter(),3),P(e,t.getUp(),6)},W=function(h,A){A._eye=[h[0],h[1],h[2]],A._center=[h[3],h[4],h[5]],A._up=[h[6],h[7],h[8]],A._18Q=i;var U=A._skyBox;U&&(U.p3([h[0],h[1],h[2]]),A.getData3dUI(U).iv())};return function(b,d,e,m,o){var w=this;w._reflectorInfo=null;var I=w.data;if(I._reflecting)return!1;var H=w.gv;if(o)return!1;var F=w._reflectorRenderTarget;F?F.setSize(b,d,e):F=w._reflectorRenderTarget=new Ri.RenderTarget(H,b,d,e),Z.copy(I.p3()),g.copy(H.getEye()),T.makeRotationFromEuler(x.set(I.r3(),I.getRotationMode(),!0));var $;if(!w._reflectNormal){var $=ch(w,w.s("shape3d"));if(!$)return!1;if(!$.ns&&$.length&&($=$[0]),!$.ns||!$.vs)return!1;w._reflectNormal=[$.ns[0],$.ns[1],$.ns[2]],w._reflectorVbuffer=Oh.Buffer.createVertexBuffer(b,new Float32Array($.vs))}if(R.copy(w._reflectNormal),R.applyMatrix4(T),l.subVectors(Z,g),l.dot(R)>0)return!1;l.reflect(R).negate(),l.add(Z),_.copy(H.getCenter()).negate().add(Z),_.reflect(R).negate(),_.add(Z),X.copy(H.getUp()),X.reflect(R);var O=[0,0,0,0,0,0,0,0,0];y(O,H),H._eye=l.toArray(),H._center=_.toArray(),H._up=X.toArray(),H._18Q=i;var M=H._skyBox;M&&(M.p3(H._eye),H.getData3dUI(M).iv()),hl(b,F.frame),b.viewport(0,0,F.width,F.height),b.clearColor(0,0,0,1),b.clear(b.COLOR_BUFFER_BIT);var Q=Lc(H),Y=Le(H);G.setFromNormalAndCoplanarPoint(R,Z),G.applyMatrix4(N.fromArray(Y)),r.set(G.normal.x,G.normal.y,G.normal.z,G.constant),V.x=(Math.sign(r.x)+Q[8])/Q[0],V.y=(Math.sign(r.y)+Q[9])/Q[5],V.z=-1,V.w=(1+Q[10])/Q[14],r.multiplyScalar(2/r.dot(V));var K=I.s("shape3d.reflector.clip"),k=K===s?.003:K;Q[2]=r.x,Q[6]=r.y,Q[10]=r.z+1-k,Q[14]=r.w;var A=H._computedProjectMatrix;H._computedProjectMatrix=Q,I._reflecting=!0,m(),H._computedProjectMatrix=A,j.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),j.multiply(N.fromArray(H._projectMatrix)),j.multiply(N.fromArray(H._viewMatrix)),Ln(b),W(O,H);var h=b._compiledShader.reflector;return h||(h=b._compiledShader.reflector=new Oh.Shader(b,Ko.Reflector.vs,Ko.Reflector.fs)),h.bind(),b.activeTexture(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,F.texture),h.uniforms.tDiffuse=0,h.uniforms.color=tl(I.s("shape3d.reflector.color")||"rgb(128,128,128)"),h.uniforms.textureMatrix=j.toArray(),h.uniforms.modelMatrix=sf(I),h.uniforms.viewMatrix=Le(H),h.uniforms.projectionMatrix=Lc(H),w._reflectorVbuffer.upload(),h.attributes.pos.pointer(w._reflectorVbuffer),b.drawArrays(b.TRIANGLES,0,6),I._reflecting=!1,b.useProgram(H._prg),!0}}()}),Ko.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};var sg=function(e,H){Kh(sg,this,[e,H])};Zi(sg,Jf,{_25Q:1,validate:function(f){var R=this,M=R.gv,g=R.data,t=R.s,w=t("edge.width"),L=g._40I,K=g._41I;if(R.shapeModel=R.info=i,L&&K){var H,v,o,p,h,e,x,V,X,D,N=g.isLooped(),J=t($o),Z=z.getEdgeType(J);if(Z){var E=Z(g,eg(R,M,g,N,J),M,R._19Q);if(!E.points||E.points.isEmpty())return;e=R.info={},x=E.segments,h=E.points,V=h.size();for(var j=L.getElevation(),q=K.getElevation(),r=0;V>r;r++){var u=h.get(r);u.e==i&&(u.e=j+(q-j)*r/(V-1))}X=zg(h.get(0)),D=zg(h.get(V-1));var P=V%2;0===P?(e.c1=zg(h.get(V/2-1)),e.c2=zg(h.get(V/2))):e.p3=zg(h.get((V-P)/2)),e.s1=X,e.s2=zg(h.get(1)),e.t1=zg(h.get(V-2)),e.t2=D}else{h=new Yi,e=R.info={};var n=t("edge.offset"),y=t("edge.center"),k=t("edge.source.t3"),Y=t("edge.target.t3"),G=R._getEdge3dHostPoint(L,"source"),Q=R._getEdge3dHostPoint(K,"target");if(k&&(G[0]+=k[0],G[1]+=k[1],G[2]+=k[2]),Y&&(Q[0]+=Y[0],Q[1]+=Y[1],Q[2]+=Y[2]),J===hb){x=t("edge.segments");var T=e.points=t(yf)||zi;if(V=T.size()){X=zg(T.get(0)),D=zg(T.get(V-1)),!y&&n&&(o=_c(X,G,!0),n=_(n,_m(G,X)),G=[G[0]+o[0]*n,G[1]+o[1]*n,G[2]+o[2]*n],o=_c(Q,D,!0),n=_(n,_m(D,Q)),Q=[Q[0]-o[0]*n,Q[1]-o[1]*n,Q[2]-o[2]*n]);var P=V%2;0===P?(H=zg(T.get(V/2-1)),v=zg(T.get(V/2))):e.p3=zg(T.get((V-P)/2)),e.s1=G,e.s2=X,e.t1=D,e.t2=Q}else!y&&n&&(o=_c(Q,G,!0),p=_m(G,Q),n=Fl(n,p),G=[G[0]+o[0]*n,G[1]+o[1]*n,G[2]+o[2]*n],Q=[Q[0]-o[0]*n,Q[1]-o[1]*n,Q[2]-o[2]*n]),H=G,v=Q;h.add({x:G[0],y:G[2],e:G[1]}),h.addAll(T),h.add({x:Q[0],y:Q[2],e:Q[1]})}else{var l=eg(R,M,g,N,J);if(R._19Q||(l=-l),N){var s=G[0],m=G[1],B=G[2],c=L.getTall()/2+l;H=[s-l,m+c,B],v=[s+l,m+c,B],h.add({x:s-l,y:B,e:m}),h.add({x:s-l,y:B,e:m+c}),h.add({x:s+l,y:B,e:m+c}),h.add({x:s+l,y:B,e:m})}else{o=_c(Q,G,!0),p=_m(G,Q);var C={x:G[0],y:G[2]},O={x:Q[0],y:Q[2]},b=he(i,C,O,l),S=b.x-C.x,F=b.y-C.y;n=Fl(n,p),o[0]*=n,o[1]*=n,o[2]*=n,H=[G[0]+o[0]+S,G[1]+o[1],G[2]+o[2]+F],v=[Q[0]-o[0]+S,Q[1]-o[1],Q[2]-o[2]+F],y?(h.add({x:G[0],y:G[2],e:G[1]}),h.add({x:H[0],y:H[2],e:H[1]}),h.add({x:v[0],y:v[2],e:v[1]}),h.add({x:Q[0],y:Q[2],e:Q[1]})):(h.add({x:H[0],y:H[2],e:H[1]}),h.add({x:v[0],y:v[2],e:v[1]}))}}e.c1=H,e.c2=v}e.list=t(il)===Gd?R.createTubeModel(h,x,w/2,f):R.createLineModel(h,x,w,"edge","edge.dash")}},_getEdge3dHostPoint:function(T,Z){if(!gj(T))return T.p3();var h=this;Z="edge."+Z+".anchor.";var j=h.s(Z+"x"),R=h.s(Z+"elevation"),m=h.s(Z+"y"),n=sf(T,h.gv.getMat(T)),i=T.getAnchor3d();return pq([(j===s?.5:j)-i.x,(R===s?.5:R)-i.y,(m===s?.5:m)-i.z],n)}});var cc=function(c,O){Kh(cc,this,[c,O])};Zi(cc,oe,{_80o:function(L,O,B){var p=this,H=p.gv,k=p.shapeModel;Rk(H,p.mat),k?Ho(H,p.data,k,p,p.getBodyColor(),B):(Zb(p,L,O,"left",B),Zb(p,L,O,"front",B),Zb(p,L,O,"right",B),Zb(p,L,O,"back",B),Zb(p,L,O,"top",B),Zb(p,L,O,"bottom",B)),Zr(H)},validate:function(P,a){var v,y,o=this,l=o.s,c=o.data,V=c.p3(),g=c._thickness/2,T=c.isClosePath(),Q=c.getPoints(),O=c.getSegments(),S=l(Xe),h=P&&P.uv;if(o.clear(),0>g){try{y=o.shapeModel=Cq(Q,O,l(Ul),l(jr),S,l(Cs),c.getTall(),c.getShapeElevation(),T)}catch(e){y=o.shapeModel={}}l(ki)?l("shape3d.image")||delete y.uv:(delete y.vs,delete y.ns,delete y.uv),l("shape3d.top.image")||delete y.top_uv,l("shape3d.bottom.image")||delete y.bottom_uv}else if(l(il)===Gd)v=Wg(Q,O,S,T),y=o.shapeModel={vs:[]},l("shape3d.image")&&(y.uv=[],y.sum=l(Cs)||Fe(v)||1,y.len=0),l(Ul)&&!T&&(y.top_vs=[],l("shape3d.top.image")&&(y.top_uv=[])),l(jr)&&!T&&(y.bottom_vs=[],l("shape3d.bottom.image")&&(y.bottom_uv=[])),o._12O(v,g);else{var j,m,_,W,G,b,R,B,J,f;if(v=Wg(Q,O,S,T),G=o.vf(wg,h,!1,a),g&&(b=o.vf(xs,h,!1,a),R=T?i:o.vf(br,h,!1,a),B=T?i:o.vf(lk,h,!1,a),J=o.vf(bm,h,!1,a),f=o.vf(Lp,h,!1,a)),g){for(var A=0,Z=v.length;Z>A;A++)v[A]=o._tryRemoveBezierPoints(v[A],g);o._12O(v,g)}else G&&v.forEach(function(q){if(W=q.length,W>0)for(j=q[0],_=1;W>_;_++)m=q[_],o.addV(G.vs,j,m),j=m});o._20Q(v),P||(G&&(G.ns=Yl(G.vs),Yd(G,"vs"),Yd(G,ve)),g&&(b&&(b.ns=Yl(b.vs),Yd(b,"vs"),Yd(b,ve)),R&&(R.ns=Yl(R.vs),Yd(R,"vs"),Yd(R,ve)),B&&(B.ns=Yl(B.vs),Yd(B,"vs"),Yd(B,ve)),J&&(J.ns=Yl(J.vs),Yd(J,"vs"),Yd(J,ve)),f&&(f.ns=Yl(f.vs),Yd(f,"vs"),Yd(f,ve))))}var H=o.mat=Fc();Gg(H,V),Gn(H,c.getFinalRotation3d(),c.getRotationMode());var s=c.getScale3d(),D=c._dynamicScale3d;D&&(s[0]*=D[0],s[1]*=D[1],s[2]*=D[2]),Rq(H,s),Gg(H,tc(V)),P&&(vs(o,H,P,y),o.clear())},_20Q:function(s){var _,z,L,D,J,r,H,k=this,p=k.front,v=k.back,O=k.top,c=k.bottom,d=p?p.tuv:i,t=v?v.tuv:i,X=O?O.tuv:i,u=c?c.tuv:i,I=0;(d||t||X||u)&&(_=k.s(Cs)||Fe(s)||1,s.forEach(function(h){if(z=h.length,z>0)for(r=h[0],L=1;z>L;L++)H=h[L],D=I/_,I+=_m(r,H),J=I/_,k._14O(p,D,J),k._14O(v,1-J,1-D),k._14O(O,D,J),k._14O(c,D,J),r=H}))},_14O:function(T,V,k){if(T){var g=T.uv,B=T.tuv;if(B){if(g)var E=g[0]+(g[6]-g[0])*V,O=g[1]+(g[7]-g[1])*V,j=g[2]+(g[4]-g[2])*V,s=g[3]+(g[5]-g[3])*V,_=g[2]+(g[4]-g[2])*k,d=g[3]+(g[5]-g[3])*k,X=g[0]+(g[6]-g[0])*k,W=g[1]+(g[7]-g[1])*k;else E=V,O=0,j=V,s=1,_=k,d=1,X=k,W=0;B.push(j,s,_,d,X,W,X,W,E,O,j,s)}}},_13O:function(m){var j=m.uv,T=m.tuv;T&&(j?T.push(j[2],j[3],j[4],j[5],j[6],j[7],j[6],j[7],j[0],j[1],j[2],j[3]):T.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(N,K){var V=N.length;if(4>V)return N;var u,F,E,c,R,z,b=!1,t=function(J){return N[J]},P=function(U){return N[V-1-U]};for(R=0;1>=R;R++)for(z=R?P:t,F=z(0),E=z(1),u=2;V-1>u;u++)if(c=z(u),!c.remove)if(c.b){var e=he(F,E,c,K);e.adjust?(c.remove=!0,b=!0):(F=E,E=c)}else F=E,E=c;if(!b)return N;var j=[];for(u=0;V>u;u++)N[u].remove||j.push(N[u]);return j},_12O:function(m,E){var Z,v,l,p,X,h=this.s("shape3d.point.epsilon"),Y=this;m.forEach(function(P){if(X=P.length,X>0)for(Z={p:P[0],n:!0},p=1;X>p;p++)v=P[p],l=X-1>p?P[p+1]:i,l&&Math.abs(v.x-l.x)<h&&Math.abs(v.y-l.y)<h||Y.addPoint(Z,v,l,E,P)})},addPoint:function(B,T,V,m,h){var L,c,g,R,Y,j,M,Q,W,k=this,S=B.p,Z=B.f,x=B.b,P=k.s("shape3d.side")||Bn,E=k.s("shape3d.start.angle"),d=k.s("shape3d.sweep.angle"),H=k.shapeModel,t=k.data.isClosePath();if(B.n&&(B.n=!1,Z=t&&h.length>2?he(h[h.length-2],S,T,m):he(i,S,T,m),x=Hk(S,Z),H?H.top_vs&&k._10O(x,Z,P,E,d,H.top_vs,H.top_uv):(L=k.left)&&(k.addV(L.vs,x,Z),k._13O(L))),c=V?he(S,T,V,m):t&&h.length>2?he(S,T,h[1],m):he(S,T,i,m),g=Hk(T,c),H){var X,I,s=H.vs,f=H.uv,J=H.sum;for(f&&(X=H.len/J,H.len+=_m(S,T),I=H.len/J),j=k._9O(x,Z,P,E,d),M=k._9O(g,c,P,E,d),Q=0;P>Q;Q++)W=Q+1,ks(s,j[W]),ks(s,M[Q]),ks(s,j[Q]),ks(s,M[Q]),ks(s,j[W]),ks(s,M[W]),f&&(R=Q/P,Y=W/P,f.push(X,Y,I,R,X,R,I,R,X,Y,I,Y));!V&&H.bottom_vs&&k._10O(g,c,P,E,d,H.bottom_vs,H.bottom_uv,!0)}else!V&&(L=k.right)&&(k.addV(L.vs,c,g),k._13O(L)),(L=k.front)&&k.addV(L.vs,Z,c),(L=k.back)&&k.addV(L.vs,g,x),(L=k.top)&&k.addH(L.vs,Z,c,g,x,!0),(L=k.bottom)&&k.addH(L.vs,x,g,c,Z);B.p=T,B.f=c,B.b=g},_10O:function(d,c,w,e,H,s,P,Y){var l,v,g=this,J=g.data,O=g._9O(d,c,w,e,H),D=(d.x+c.x)/2,N=(d.y+c.y)/2,y=J.getShapeElevation(),Z=0;for(Z=0;w>Z;Z++)Y?(ks(s,O[Z]),ks(s,O[Z+1])):(ks(s,O[Z+1]),ks(s,O[Z])),ks(s,[D,y,N]),P&&(Y?(l=b*(Z+1)/w+e,v=b*Z/w+e):(l=b*Z/w+e,v=b*(Z+1)/w+e),P.push(.5-.5*X(v),.5-.5*U(v),.5-.5*X(l),.5-.5*U(l),.5,.5))},_9O:function(s,$,r,M,n){var B,E,t=this,Q=t.data,R=[],h=(s.x+$.x)/2,F=(s.y+$.y)/2,k=Q.getTall()/2,P=Q.getShapeElevation(),J=0;for(n=n||b;r>=J;J++)B=n*J/r+M,E=X(B),R.push([h+(s.x-h)*E,P+k*U(B),F+(s.y-F)*E]);return R},addV:function(z,O,q){var j=O.x,L=O.y,N=q.x,l=q.y,_=this.data,E=_.getShapeElevation(),t=_.getTall()/2;z.push(j,E-t,L,N,E-t,l,N,E+t,l,N,E+t,l,j,E+t,L,j,E-t,L)},addH:function(r,R,P,C,S,p){var a=this.data,X=a.getTall()/2,l=a.getShapeElevation()+(p?X:-X);r.push(R.x,l,R.y,P.x,l,P.y,C.x,l,C.y,C.x,l,C.y,S.x,l,S.y,R.x,l,R.y)},vf:function(a,p,A,s){var L,c=this,z=c.gv.getFaceVisible(c.data,a);return(A||z)&&(L=ph(c,a,s),L.vs=[],L.tuv=z&&(L.texture||p)?[]:i,L.visible=z),L}});var In=function(j,l){Kh(In,this,[j,l])};Zi(In,Jf,{_25Q:1,validate:function(_){var U=this,P=U.data,f=U.s,v=P.getPoints(),e=v.size();if((!U.s("shape3d.geometry.cache")||!U.shapeModel)&&(U.shapeModel=U.info=i,e>1)){var Z=U.info={},N=P.getSegments(),g=P.getThickness(),Y=zg(v.get(0)),h=zg(v.get(e-1)),M=e%2;0===M?(Z.c1=zg(v.get(e/2-1)),Z.c2=zg(v.get(e/2))):Z.p3=zg(v.get((e-M)/2)),Z.s1=Y,Z.s2=zg(v.get(1)),Z.t1=zg(v.get(e-2)),Z.t2=h,Z.list=f(il)===Gd?U.createTubeModel(v,N,g/2,_):U.createLineModel(v,N,g,"shape.border","shape.dash")}var I=P.p3(),t=U.mat=Fc();Gg(t,I),Gn(t,P.getFinalRotation3d(),P.getRotationMode());var E=P.getScale3d(),s=P._dynamicScale3d;s&&(E[0]*=s[0],E[1]*=s[1],E[2]*=s[2]),Rq(t,E),Gg(t,tc(I))},_80o:function(z,Y,t){var B=this,N=B.shapeModel;if(N){var P=B.gv;Rk(P,B.mat),Ho(P,B.data,N,B,B.getBodyColor(),t),Zr(P)}}});var Mg=r.graph3d.VR=function(U){var n=this;n.gv=U,n._controllers=[],n.switch=new Fj(n),n._enable=!1,n._defaultCallLater=r.Default.callLater,n._defaultCancelLater=Zh,"undefined"!=typeof F&&"VRFrameData"in F&&(n._frameData=new F.VRFrameData),n.measureOflength=1,n.eyesOffset=[0,0,0],n._orientation=new r.Math.Quaternion,n._lastHeadPose=[0,0,0],n._offsetToBeAdd=[0,0,0],n._fpsInfo={time:0,fps:0,frames:0}};Zi(Mg,j,{ms_fire:!0,_42:function(M,J,z,R){var P=this,_=P.gv;if(!_.drawFilter&&P._deviceInAction){var t=P._device;if(t){var y=P._measureOflength;t.depthNear=_.getNear()*y,t.depthFar=_.getFar()*y;var q=P._offsetToBeAdd;if(P.eyesOffset[0]+=q[0],P.eyesOffset[1]+=q[1],P.eyesOffset[2]+=q[2],q[0]=0,q[1]=0,q[2]=0,t.isPresenting===!1)return P._controllers.forEach(function(D){D&&D.update()}),_.iv(),!1;var k=P._frameData;t.getFrameData(k);var f=k.pose.position;if(f){var v=P.toViewPosition(f);_.setEye(v),P._orientation.fromArray(k.pose.orientation);var K=new r.Math.Vector3(0,0,-10*P._scaleFactor);K.applyQuaternion(P._orientation),_.setCenter([v[0]+K.x,v[1]+K.y,v[2]+K.z])}P._controllers.forEach(function(P){P&&P.update()}),_.setViewport(M,0,0,J/2,z),P._viewMatrix=P._copyViewMatrix(k.leftViewMatrix),P._projectMatrix=P._copyProjectMatrix(k.leftProjectionMatrix),R(),_.setViewport(M,J/2,0,J/2,z),P._viewMatrix=P._copyViewMatrix(k.rightViewMatrix),P._projectMatrix=P._copyProjectMatrix(k.rightProjectionMatrix),R(),P._lastViewMatrix=P._viewMatrix,P._lastProjectMatrix=P._projectMatrix,P._viewMatrix=null,P._projectMatrix=null,P.submitFrame();var L=Date.now(),C=P._fpsInfo;return L-C.time>1e3?(C.fps=Math.round(1e3*(C.frames+1)/(L-C.time)),C.time=L,C.frames=0):C.frames++,!0}}},onVRDisplayPresentChange:function(){var D=this.isPresenting();this._injectGraphView(D),this.fp("present",!D,D)},getOrientation:function(){return this._orientation},addController:function(p){p=p||0;var G=this,d=G.getController(p);return d?d:(d=new Qn(G,p),G._controllers.push(d),d)},getController:function(Y){Y=Y||0;for(var T=this._controllers,z=0,E=T.length;E>z;z++)if(T[z]&&T[z].id===Y)return T[z];return null},removeController:function(C){C=C||0;for(var d=this._controllers,n=0,J=d.length;J>n;n++)if(d[n]&&d[n].id===C)return d.splice(n,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(T,S){var W=this,C=W._scaleFactor,B=W._eyesOffset,f=W._lastHeadPose;return f[0]=T[0]*C,f[1]=T[1]*C,f[2]=T[2]*C,S?(S[0]=f[0]+B[0],S[1]=f[1]+B[1],S[2]=f[2]+B[2],S):[f[0]+B[0],f[1]+B[1],f[2]+B[2]]},addEyesOffset:function(t,B,V){var x=this._offsetToBeAdd;x[0]+=t,x[1]+=B,x[2]+=V},_copyViewMatrix:function(v){var Z=this.dup(v),N=this._scaleFactor;Z[12]*=N,Z[13]*=N,Z[14]*=N;var I=this._eyesOffset;if(I&&(I[0]||I[1]||I[2])){var f=I[0],k=I[1],y=I[2];Z[12]-=Z[0]*f+Z[4]*k+Z[8]*y,Z[13]-=Z[1]*f+Z[5]*k+Z[9]*y,Z[14]-=Z[2]*f+Z[6]*k+Z[10]*y}return Z},shutdown:function(){var I=this._device;I&&I.isPresenting&&I.exitPresent()},isPresenting:function(){var T=this._device;return T&&T.isPresenting},_copyProjectMatrix:function(W){var j=this.dup(W),A=this._scaleFactor;return j[14]*=A,j},dup:function(n,S){for(var b=n.length,m=S||new Array(b);b--;)m[b]=n[b];return m},getViewMatrix:function(y){var r=this._viewMatrix;return r?this.dup(r,y):void 0},getProjectMatrix:function(){var f=this._projectMatrix;return f?this.dup(f):void 0},submitFrame:function(){var y=this;if(y._enable&&y._deviceInAction){var Y=y._device;Y&&Y.isPresenting&&(Y.submitFrame(),y.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(P){var D=this.gv;return D.intersectObjects(P,D.dm().getDatas())},setDevice:function(D){var C=this;C._device=D},_injectGraphView:function(){var U,Y,L;return function(C){var R=this.gv;if(!C)return U&&(R.getWidth=U,R.getHeight=Y,R.getDevicePixelRatio=L),void 0;var d=this._device,F=d.getEyeParameters("left"),b=F.renderWidth,q=F.renderHeight;U=R.getWidth,Y=R.getHeight,L=R.getDevicePixelRatio,R.getWidth=function(){return 2*b},R.getHeight=function(){return q},R.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(A){var P=this;if(!A)return ur=r.Default.callLater=P._defaultCallLater,Zh=r.Default.cancelLater=P._defaultCancelLater,void 0;var P=this;ur=r.Default.callLater=function(d,C,v,L){var h=P._device;return h&&h.isPresenting?L?e(function(){ur(d,C,v)},L):h.requestAnimationFrame(function(){P._deviceInAction=!0,d.apply(C,v),P._deviceInAction=!1}):P._defaultCallLater(d,C,v,L)},Zh=r.Default.cancelLater=function(f,z){var s=P._device;return s&&s.isPresenting?z?Y(f):s.cancelAnimationFrame(f):P._defaultCancelLater(f,z)}}}),j.defineProperties(Mg.prototype,{enable:{get:function(){return this._enable},set:function(C){var o=this;o._enable!==C&&(o._enable=C,C?(o.switch.showButton(),o._injectCallLaterFunc(!0)):(o.shutdown(),o.switch.hideButton(),o._injectCallLaterFunc(!1)),o.fp("enable",!C,C))}},measureOflength:{get:function(){return this._measureOflength},set:function(I){this._measureOflength=I;var Q=this._scaleFactor=1/I;this._controllers.forEach(function(M){M&&M._setScaleFactor(Q)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(L){this._eyesOffset=L}},controllerModel:{get:function(){return this._controllerModel},set:function(_){var g;"object"==typeof _?(g=_.mtl,_=_.obj):(g=_+".mtl",_+=".obj");var F=this,I=F._controllerModel;I&&I.obj===_&&I.mtl===g||(I=F._controllerModel={obj:_,mtl:g},z.loadObj(_,g,{finishFunc:function(v,N){F._controllerModel===I&&z.setShape3dModel("vrControllerModel",N)}}))}},interactive:{get:function(){return!!this._interactive},set:function(f){!!f!=!!this._interactive&&(this._interactive=f,f&&this.addController(0),this.gv.getCoreInteractor().enableVR(f))}}});var Qn=function(J,r){function b(o){var Y=navigator.getGamepads&&navigator.getGamepads();if(Y)for(var t=0,X=0,l=Y.length;l>t;t++){var E=Y[t];if(E){var $=E.id;if("OpenVR Gamepad"===$||0===$.indexOf("Oculus Touch")||$.indexOf("Controller")>=0){if(X===o)return E;X++}}}}function D($,S,h){return Math.abs($[0]-S[0])<h&&Math.abs($[1]-S[1])<h&&Math.abs($[2]-S[2])<h?!0:!1}var H=this;H.vr=J,H.id=r;var P,h,L=[0,0],_=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],O=new qk;O.s("shape3d","vrControllerModel"),O.isController=!0,O.s("intersect",!1),H.getGamepad=function(){return h},H.isButtonPressed=function(N){for(var A,h=0,r=_.length;r>h;h++)if(A=_[h],A.id===N)return A.pressed;return!1},H.getNode=function(){return O};var c=.003;H.setRotationEpsilon=function(h){c=h};var i=5e-4,w=i;H.setPositionEpsilon=function(F){i=F,w=F*H.vr._scaleFactor},H._setScaleFactor=function(U){O.s3(U,U,U),w=i*U},H._setScaleFactor(H.vr._scaleFactor);var m,W=new ke,j=new jq,$=[0,0,0],t=[0,0,0],p=new Ug,E=new kc,F=new jo;H.getRay=function(){return m?(F.origin.fromArray($),F.direction.copy(E),m=!1,F):F},H.update=function(){if(P=h,h=b(r),P!=h&&console.log("gamepad changed",h),!h||h.pose===s)return h=null,O.s("3d.visible",!1),void 0;if(z.getShape3dModel("vrControllerModel")){O.dm()||J.gv.dm().add(O),O.s("3d.visible",!0);var T=h.pose;if(null!==T){T.position&&(H.vr.toViewPosition(T.position,$),D(O.p3(),$,w)||(m=!0,O.p3($))),T.orientation&&(W.fromArray(T.orientation),E.set(0,0,-1).applyQuaternion(W).normalize(),j.makeRotationFromQuaternion(W),p.set(0,0,0,O.getRotationMode(),!0).setFromRotationMatrix(j),t[0]=p.x,t[1]=p.y,t[2]=p.z,D(O.r3(),t,c)||(m=!0,O.r3(t))),m&&J.fp("gamepad.pose",null,{position:$,rotation:t,id:r});var Y=h.axes;(L[0]!==Y[0]||L[1]!==Y[1])&&(L=[Y[0],Y[1]],J.fp("gamepad.axes",null,{id:r,axes:L}));var M,F,a,C,A=h.buttons;for(M=0,F=A.length;F>M;M++)if(a=A[M],a&&(C=a.pressed,_[M]||(_[M]={id:"button"+M,pressed:!1}),C!==_[M].pressed)){_[M].pressed=C;var K={id:r},X="state";K[X]=K._62O=C?"down":"up",J.fp("gamepad.button."+_[M].id,null,K)}}}}},Fj=function(s){this.vr=s,this._button=null};Zi(Fj,j,{showButton:function(){var _=this.assureButton();if(!_.parentNode){var m=this.vr.gv,Y=m.getView();m._79O?Y.insertBefore(_,m._79O):Y.appendChild(_)}},hideButton:function(){var D=this._button;D&&D.parentNode&&D.parentNode.removeChild(D)},assureButton:function(){var m=this._button;return m?m:this._button=this.createButton(this.vr.gv)},createButton:function(n){function w($,y){$.textContent=y&&y.isPresenting?" VR ":" VR "}function I(F){S.style.display="",S.style.cursor="pointer",S.style.left="calc(50% - 50px)",S.style.width="100px",w(S,F),S.onmouseenter=function(){S.style.opacity="1.0"},S.onmouseleave=function(){S.style.opacity="0.5"},S.onclick=function(){F.isPresenting?F.exitPresent():F.requestPresent([{source:n.getCanvas()}])},n.vr.setDevice(F)}function z(){S.style.display="",S.style.cursor="auto",S.style.left="calc(50% - 75px)",S.style.width="150px",w(S,null),S.onmouseenter=null,S.onmouseleave=null,S.onclick=null,n.vr.setDevice(null)}function G(d){d.style.position="absolute",d.style.bottom="20px",d.style.padding="12px 6px",d.style.border="1px solid #fff",d.style.borderRadius="4px",d.style.color="#000",d.style.font="normal 13px sans-serif",d.style.textAlign="center",d.style.opacity="0.5",d.style.outline="none",d.style.zIndex="999"}if("getVRDisplays"in navigator){var S=this._button=B.createElement("button");return S.style.display="none",G(S),Z(F,"vrdisplayconnect",function(R){I(R.display)}),Z(F,"vrdisplaydisconnect",function(){z()}),Z(F,"vrdisplaypresentchange",function(y){w(S,y.display),n.vr.onVRDisplayPresentChange()}),navigator.getVRDisplays().then(function(R){R.length>0?I(R[0]):z()}),S}var g=B.createElement("a");return g.href="https://webvr.info",g.innerHTML=" webvr",g.style.left="calc(50% - 90px)",g.style.width="180px",g.style.textDecoration="none",G(g),g}}),j.defineProperties(Fj.prototype,{});var nf=r.graph3d.PostProcessing=function(A){function G(){if(!D){var Y=A.getGL();D=new Ri.RenderTarget(A,Y,null,null,{samples:q.renderTextureSamples||1}),y=new Oh.Shader(Y,c.vs,c.fs),Q=Oh.Buffer.createIndexBuffer(Y,new Uint16Array([0,2,1,1,2,3])),n=Oh.Buffer.createVertexBuffer(Y,new Float32Array([0,0,1,0,0,1,1,1]))}}var D,y,Q,n,R=this,H={},I=!1;!function(){j.keys(nf).forEach(function(E){H[E]=new nf[E](A)})}(),R.getModule=function(l){return l?H[l]:R},R.getModuleList=function(){return j.keys(H)},R.handleDataModleChange=function(P,t){P&&(P.setPostProcessingData(R.serialize()),P.removeSerializeListener(R.onDataModelSerialize,R)),t&&(t.addSerializeListener(R.onDataModelSerialize,R),R.deserialize(t.getPostProcessingData()))},R.onDataModelSerialize=function(Q){"serialize"===Q.type?A.dm()._postProcessingData=R.serialize():"deserialize"===Q.type&&R.deserialize(A.dm().getPostProcessingData())},R.serialize=function(){var s,I,e,E,R={};for(I in H)if(e=H[I],E=e.serializeProperties){s={},e.enable&&(s.enable=!0);for(var C in E){var l=e[C];l!=E[C]&&(s[C]=l)}j.keys(s).length&&(R[I.toLowerCase()]=s)}return R},R.deserialize=function(k){var X,J,e,v,Q,h={};if(k)for(J in k)if(J&&(X=J[0].toUpperCase()+J.slice(1),e=H[X])){h[X]=!0,v=k[J],R.enableModule(X,!!v.enable),e.resetProperties&&e.resetProperties();for(Q in v)"enable"!==Q&&(e[Q]=v[Q])}for(X in H)h[X]||(e=H[X],e.enable=!1,e.resetProperties&&e.resetProperties())},R.decodeShader=function(w){var b,A,$,R="",D="";for($=0;$<w.length;$++)b=w[$],"%"===b?b="'":"a"===b?b='"':"]"===b&&(b="\\"),A=String.fromCharCode(b.charCodeAt(0)-1),$%2?D+=A:R=A+R;return D+R},R.createShader=function(c,H,C){var A=H.indexOf("^#"),m=R.decodeShader(H.substr(0,A)),t=R.decodeShader(H.substr(A+2));if(C){var G=C(m,t);G&&G.vs&&(m=G.vs),G&&G.fs&&(t=G.fs)}return new Oh.Shader(c,m,t)},R.enableModule=function(g,b){var u,W,i,q=g.split(",");for(u=0,W=q.length;W>u;u++)i=q[u].trim(),H[i]&&(H[i].enable=b);I=!1;for(i in H)if(H[i].enable){I=!0;break}I&&G()};var c={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};R._42=function(C,J,b,k,K){if(I&&!K){D.setSize(C,J,b),D.bind(C),C.clear(C.COLOR_BUFFER_BIT|C.DEPTH_BUFFER_BIT),A.setViewport(C,0,0,J,b),k(),D.unbind(C);for(var v=0,W=A._glCapabilities.maxAttributes;W>v;v++)C.disableVertexAttribArray(v);var x,M=D;for(x in H)M=H[x]._42(C,M)||M;return A.setViewport(C,0,0,J,b),C.clear(C.COLOR_BUFFER_BIT|C.DEPTH_BUFFER_BIT),y.bind(),C.activeTexture(C.TEXTURE0+0),C.bindTexture(C.TEXTURE_2D,M.texture),y.uniforms.image=0,Q.upload(),n.upload(),y.attributes.pos.pointer(n),C.drawElements(C.TRIANGLES,6,C.UNSIGNED_SHORT,0),C.bindTexture(C.TEXTURE_2D,null),C.useProgram(A._prg),!0}}},jl=r.graph3d.PostProcessing.Bloom=function(T){function k(){var N=T.getGL();if(N)for(var j=T._postProcessing,v=0;l>v;v++)u[v]=j.createShader(N,jl._35Q,function(r,G){return{fs:G.replace(/DEFINE_VALUE/g,W[v]).replace("%OVERRIDE_ALPHA_DEFINE%",Y?"#define OVERRIDE_ALPHA":"")}})}function $(){var R=T.getWidth(),G=T.getHeight();if(R&&G){D=[R,G],b=!0;var r,M=T.getGL(),L=Math.round(D[0]/2),y=Math.round(D[1]/2);for(E=new Ri.RenderTarget(T,M,L,y),r=0;l>r;r++)d.push(new Ri.RenderTarget(T,M,L,y)),z.push(new Ri.RenderTarget(T,M,L,y)),L=Math.round(L/2),y=Math.round(y/2);var e=T._postProcessing;Q=e.createShader(M,jl._34Q),k(),V=e.createShader(M,jl._36Q,function(t,s){return{fs:s.replace(/NUM_MIPS/g,l)}
}),s=e.createShader(M,jl.finalShader),t=Oh.Buffer.createIndexBuffer(M,new Uint16Array([0,2,1,1,2,3])),i=Oh.Buffer.createVertexBuffer(M,new Float32Array([0,0,1,0,0,1,1,1]))}}var N,o,m,Y,t,i,_=this,A=!1,b=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0},this.resetProperties=function(){var t=this.serializeProperties;for(var j in t)this[j]=t[j]},j.defineProperties(_,{enable:{get:function(){return A},set:function(Z){!!A!=!!Z&&(A=Z,Z&&!b&&$())}},strength:{get:function(){return N},set:function(J){N=J}},threshold:{get:function(){return o},set:function(t){o=t}},radius:{get:function(){return m},set:function(i){m=i}},overrideAlpha:{get:function(){return Y},set:function(n){!!Y!=!!n&&(Y=n,b&&k())}}}),this.resetProperties();var E,Q,V,s,D=[256,256],d=[],z=[],l=5,W=[3,5,7,9,11],u=[];_._42=function(H,f){function p(x,w,k,P){hl(H,w.frame),T.setViewport(H,0,0,w.width,w.height),P?P(H):H.clear(H.COLOR_BUFFER_BIT|H.DEPTH_BUFFER_BIT),e!==x&&x.bind();var f=0;for(var N in k){var I=k[N];I instanceof WebGLTexture&&(H.activeTexture(H.TEXTURE0+f),H.bindTexture(H.TEXTURE_2D,I),I=f,f++),x.uniforms[N]=I}for(e!==x&&(t.upload(),i.upload(),x.attributes.pos.pointer(i),e=x),H.drawElements(H.TRIANGLES,6,H.UNSIGNED_SHORT,0);f--;)H.activeTexture(H.TEXTURE0+f),H.bindTexture(H.TEXTURE_2D,null);Ln(H)}if(A&&(b||($(),b))){var e;p(Q,E,{smoothWidth:.01,luminosityThreshold:o,tDiffuse:f.texture});var C,Y=E,I=Math.round(D[0]/2),K=Math.round(D[1]/2);for(C=0;l>C;C++)p(u[C],d[C],{colorTexture:Y.texture,direction:[1,0],texSize:[I,K]}),p(u[C],z[C],{colorTexture:d[C].texture,direction:[0,1],texSize:[I,K]}),I=Math.round(I/2),K=Math.round(K/2),Y=z[C];return p(V,d[0],{blurTexture1:z[0].texture,blurTexture2:z[1].texture,blurTexture3:z[2].texture,blurTexture4:z[3].texture,blurTexture5:z[4].texture,bloomStrength:N,bloomRadius:m,bloomTintColor:[1,1,1]}),p(s,f,{image:d[0].texture},function(D){D.enable(D.BLEND),D.blendEquation(D.FUNC_ADD),D.blendFunc(D.SRC_ALPHA,D.ONE)}),H.blendEquationSeparate(H.FUNC_ADD,H.FUNC_ADD),H.blendFuncSeparate(H.SRC_ALPHA,H.ONE_MINUS_SRC_ALPHA,H.ONE,H.ONE_MINUS_SRC_ALPHA),f}}};jl._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",jl._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",jl._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",jl.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var _q=r.graph3d.PostProcessing.Dof=function(T){function E(){N=!0;var J=T.getGL();M=new Ri.RenderTarget(T,J),$=T._postProcessing.createShader(J,_q._38Q),U=Oh.Buffer.createIndexBuffer(J,new Uint16Array([0,2,1,1,2,3])),H=Oh.Buffer.createVertexBuffer(J,new Float32Array([0,0,1,0,0,1,1,1]))}var M,$,U,H,u,n,Y,Z,b=this,k=!1,N=!1;this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var e=this.serializeProperties;for(var l in e)this[l]=e[l]},j.defineProperties(b,{enable:{get:function(){return k},set:function(g){!!k!=!!g&&(k=g,g&&!N&&E())}},image:{get:function(){return n},set:function(o){n!==o&&(n=o,u&&(T.getGL().deleteTexture(u),u=null),T.iv())}},maxblur:{get:function(){return Y},set:function(A){Y!==A&&(Y=A,T.iv())}},aperture:{get:function(){return Z},set:function(s){Z!==s&&(Z=s,T.iv())}}}),this.resetProperties(),b._42=function(L,S){function X(N,p,v,$){hl(L,p.frame),T.setViewport(L,0,0,p.width,p.height),$?$(L):L.clear(L.COLOR_BUFFER_BIT|L.DEPTH_BUFFER_BIT),C!==N&&N.bind();var J=0;for(var A in v){var Z=v[A];Z instanceof WebGLTexture&&(L.activeTexture(L.TEXTURE0+J),L.bindTexture(L.TEXTURE_2D,Z),Z=J,J++),N.uniforms[A]=Z}for(C!==N&&(U.upload(),H.upload(),N.attributes.pos.pointer(H),C=N),L.drawElements(L.TRIANGLES,6,L.UNSIGNED_SHORT,0);J--;)L.activeTexture(L.TEXTURE0+J),L.bindTexture(L.TEXTURE_2D,null);Ln(L)}if(k){N||E();var C;if(!u){var Y=Ij(this.image);if(!Y||!Y.tagName)return S;u=mr(L,Y)}var B=S.width,e=S.height;if(B&&e)return M.setSize(L,B,e),X($,M,{tColor:S.texture,tDepth:u,aspect:B/e,aperture:this.aperture,maxblur:this.maxblur}),M}}};_q._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E",Ej(z,{accordionViewExpandIcon:Sk(kn),accordionViewCollapseIcon:Sk(kn,!0),accordionViewLabelColor:sj,accordionViewLabelFont:Sh,accordionViewTitleBackground:zl,accordionViewSelectBackground:Cn,accordionViewSelectWidth:3,accordionViewSeparatorColor:s,splitViewDividerSize:1,splitViewDividerBackground:zl,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:gc,rect:[2,2,12,12],background:kn}]},propertyViewLabelColor:Xi,propertyViewLabelSelectColor:sj,propertyViewLabelFont:Sh,propertyViewExpandIcon:Sk(kq),propertyViewCollapseIcon:Sk(kq,!0),propertyViewBackground:bj,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:pr,propertyViewColumnLineColor:pr,propertyViewSelectBackground:Cn,listViewLabelColor:Xi,listViewLabelSelectColor:sj,listViewLabelFont:Sh,listViewRowLineVisible:!1,listViewRowLineColor:pr,listViewSelectBackground:Cn,treeViewLabelColor:Xi,treeViewLabelSelectColor:sj,treeViewLabelFont:Sh,treeViewExpandIcon:Sk(hq),treeViewCollapseIcon:Sk(hq,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:pr,treeViewSelectBackground:Cn,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Xi,tableViewLabelSelectColor:sj,tableViewLabelFont:Sh,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:pr,tableViewColumnLineColor:pr,tableViewSelectBackground:Cn,treeTableViewLabelColor:Xi,treeTableViewLabelSelectColor:sj,treeTableViewLabelFont:Sh,treeTableViewExpandIcon:Sk(hq),treeTableViewCollapseIcon:Sk(hq,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:pr,treeTableViewColumnLineColor:pr,treeTableViewSelectBackground:Cn,tableHeaderLabelColor:Xi,tableHeaderLabelFont:Sh,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Sn,tableHeaderBackground:bj,tableHeaderMoveBackground:kh,tableHeaderInsertColor:Cn,tableHeaderSortDescIcon:dg(kq,!0),tableHeaderSortAscIcon:dg(kq),tabViewTabGap:1,tabViewLabelColor:sj,tabViewLabelFont:Sh,tabViewTabBackground:zl,tabViewSelectWidth:3,tabViewSelectBackground:Cn,tabViewMoveBackground:kh,tabViewInsertColor:Cn,toolbarLabelColor:Xi,toolbarLabelSelectColor:sj,toolbarLabelFont:Sh,toolbarBackground:bj,toolbarSelectBackground:Cn,toolbarItemGap:8,toolbarSeparatorColor:rk},!0);var Ef={translateX:1,sortColumn:1},mg={sortable:1,sortOrder:1,sortFunc:1},Rn={focusData:1},ng={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Dg={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},hk=function(o,U){U.add(o),o.hasChildren()&&o.eachChild(function(h){hk(h,U)})},gn=function(a,P,e,G,U,l,b,n,N,T,V){var u,L=e.getValueType(T),k=e.getAlign(T);if(e.getEnumValues(T)){var W=e.toEnumLabel(P,T),x=Wo||0,r=0,A=l,Q=z.getTextSize(G,W).width;return u=Ij(e.toEnumIcon(P,T)),u&&(r=l+Wo/2,"center"===k?r+=(n-(x+Q))/2:"right"===k&&(r=r+n-(x+Q)),tp(a,u,r,b+N/2,T,V),A=r+Wo/2),W!=i&&(u?Tq(a,W,G,U,A,b,n-(A-l),N):Tq(a,W,G,U,l,b,n,N,k)),void 0}return P=e.formatValue(P),P!=i?L===nb?(Tl(a,l,b,n,N,P),void 0):L===ck||!L&&Zo(P)?(u=Ij(P?vg:Ic),tp(a,u,l+n/2,b+N/2,T,V),void 0):(Tq(a,P,G,U,l,b,n,N,k),void 0):void 0},mq=function(Y,W){var q=W.view,N=Lq(Y),B=W.column||W.property;q.getDataModel().beginTransaction(),W.editor=Y,Y.info=W,q.setCurrentEditor(Y),q.getView().insertBefore(N,q._79O),Kn(Y,W.editorRect),Y.setFocus?Y.setFocus():Pf(Y),Y.commitValue=function(F,t){Y._17Q&&(Y=Y._17Q),t||q.setValue(W.data,B,Y.getValue?Y.getValue():Y.value),Y.close&&Y.close(),As(N)},B.onEditorCreated&&B.onEditorCreated(W)},Rd=function(M,$,I,h,G){var H=kl(M,I),j=$.value,Y=$.view,O=G.getValueType($.data);return H.onblur=H.onchange=function(){Y.endEditing()},"input"===M?(j=G.formatValue(j),j!=i&&(H.value=j),H.onkeydown=function(u){Hf(u)?Y.endEditing():Wi(u)&&Y.endEditing(!0)},(O===Vd||O===wb)&&Z(H,tk,z.numberListener)):M===Hg&&h.forEach(function(V){var $=B.createElement("option");$.innerHTML=G.toEnumLabel(V),$.value=V,G.isEnumEqual(j,V)&&($.selected=!0),pi(H,$)}),mq(H,$),H},vq=r.widget={},ef=function(r,M,c){Zi(E+".widget."+r,M,c)};Ej(Re,{ms_value:function(K){K.getValue=function(p){var $=this.getItemById(p),b=$.element;return un(b)?b:b?b.getValue?b.getValue():b.value:$.selected},K.setValue=function(D,f){var p=this.getItemById(D);if(p){var L=p.element;L&&!un(L)?L.setValue?L.setValue(f):L.value=f:Zo(f)?(p.selected=f,this.iv()):(p.element=f,this.iv())}},K.v=function(R,p){var F=this;if(2===arguments.length)F.setValue(R,p);else{if(!zo(R))return F.getValue(R);for(var O in R)F.setValue(O,R[O])}return F}},_46o:function(w){w._icon=i,w._accessType=i,w._valueType=i,w._editable=!1,w._batchEditable=!0,w._align=br,w._nullable=!0,w._emptiable=!1,w.setParent=Nn,w.formatValue=function(s){var y=this,J=y._valueType;return y.getEnumValues()?y.toEnumLabel(s):J===ck?!!s:s!=i&&J===Vd?G(s):s},w.setEnum=function(w,S,x,Y,k,N,j){var G=this;w&&!Qb(w)&&w.values&&(Y=w.editable,x=w.icons,S=w.labels,k=w.strict,N=w.maxHeight,j=w.dropDownWidth,w=w.values),Bc(w)&&(w=w._as),Bc(S)&&(S=S._as),Bc(x)&&(x=x._as),G._enumValues=w,G._enumLabels=S,G._enumIcons=x,G._enumEditable=Y,G._enumStrict=k==i?!0:k,G._enumMaxHeight=N,G._enumDropDownWidth=j,w&&w.length&&Dn(w[0])&&(G._valueType=wb),G.fp("enum",!1,!0)},w.getEnumDropDownWidth=function(){return this._enumDropDownWidth},w.getEnumMaxHeight=function(){return this._enumMaxHeight},w.isEnumEditable=function(){return this._enumEditable},w.getEnumValues=function(){return this._enumValues},w.getEnumLabels=function(){return this._enumLabels},w.getEnumIcons=function(){return this._enumIcons},w.isEnumStrict=function(){return this._enumStrict},w.isEnumEqual=function(_,U){return this._enumStrict?_===U:_==U},w.toEnumLabel=function(D,H){var s=this,v=s.getEnumValues(H),S=s.getEnumLabels(H);if(v&&S)for(var a=0;a<v.length;a++)if(s.isEnumEqual(D,v[a]))return S[a];return D},w.toEnumIcon=function(_,F){var V=this,i=V.getEnumValues(F),j=V.getEnumIcons(F);if(i&&j)for(var D=0;D<i.length;D++)if(V.isEnumEqual(_,i[D]))return j[D];return s}},_45o:function(I){I._87o=function(A,B,R,X,y,V){if(A){var j=this,P=j._90I,J=em(1);j._columnLineVisible&&(y-=1),j._rowLineVisible&&(V-=1),0>=y||0>=V||(j._90I||(P=j._90I={}),P[B]||(P[B]=new Yi),Kn(J,j.tx()+R,j.ty()+X,y,V),pi(J,A),j._view.insertBefore(J,j._79O),A.onParentAdded&&A.onParentAdded(J),P[B].add(J))}},I._76o=function(){var D=this,R=D._90I;if(R){for(var F in R)R[F].each(function(q){As(q)});delete D._90I}},I._77o=function(f){var Y=this;if(Y._90I){var R=Y._90I[f];R&&(R.each(function(c){As(c)}),delete Y._90I[f])}}},_47o:function(g){g.getValue=function(M,C){return C.getValue?C.getValue(M,C,this):qr(M,C.getAccessType(),C.getName())},g.setValue=function(J,C,A){if(C.isEmptiable(J)||""!==A||(A=s),C.isNullable(J)||A!=i){var N=this,b=C.getName(J),P=C.getAccessType(J),M=C.getValueType(J);M===Vd&&un(A)?A=u(A):M===wb&&un(A)?A=parseFloat(A):M===ck&&un(A)&&(A="true"===A),N._batchEditable&&C._batchEditable&&N.isSelected(J)?N.sm().each(function(e){C.setValue?C.setValue(e,C,A,N):jf(e,P,b,A)}):C.setValue?C.setValue(J,C,A,N):jf(J,P,b,A)}},g.setCurrentEditor=function(x){this.endEditing(),this._currentEditor=x,this.redraw()},g.isEditing=function(I,B){var k=this,z=k._currentEditor;if(!z)return!1;if(B){var S=z.info;return S?(S.column||S.property)===B&&S.data===I:!1}return!0},g.endEditing=function(r){var w=this,A=w._currentEditor;A&&(delete w._currentEditor,A.commitValue&&A.commitValue(A.info,r),w.redraw(),w.getDataModel().endTransaction())},g.beginEditing=function(c){this.endEditing();var $=this,f=c.column||c.property;if(f.beginEditing)f.beginEditing(c);else{var Q=c.data,l=c.value,G=$.getSelectBackground(Q),k=f.getEnumValues(Q),J=f.getSlider(Q),I=f.getColorPicker(Q);if(J){var z=_b(vq.Slider,J);return z.setValue(l),z.getView().onblur=function(){$.endEditing()},z.isInstant()&&(z.onValueChanged=function(){$.setValue(Q,f,z.getValue())}),mq(z,c),void 0}if(I||f.getValueType(Q)===nb){var L=_b(vq.ColorPicker,I);return L.setValue(l),L.onClosed=function(){$.endEditing()},L.isInstant()&&(L.onValueChanged=function(N,E){$.setValue(Q,f,E)}),mq(L,c),L.open(),void 0}if(k){if(vq.ComboBox){var U=new vq.ComboBox;U.setValue(l),U.setValues(k),U.setLabels(f.getEnumLabels(Q)),U.setIcons(f.getEnumIcons(Q)),U.setEditable(f.isEnumEditable(Q)),U.setStrict(f.isEnumStrict(Q)),U.setMaxHeight(f.getEnumMaxHeight(Q)),U.setDropDownWidth(f.getEnumDropDownWidth(Q)),U.onClosed=function(){$.endEditing()},mq(U,c),U.open()}else Rd(Hg,c,G,k,f);return}var V=f.getValueType(Q);if(V===ck||Zo(l))return $.setValue(Q,f,!l),void 0;if(f.getItemEditor(Q)){var b=yi(f.getItemEditor(Q)),_=new b(Q,f,$,c),j=_.getView();return j._17Q=_,_.setValue(l),Wm(j),mq(j,c),_.editBeginning&&_.editBeginning(),void 0}Rd("input",c,G,i,f)}}},_44o:function(E){E.init=function(R){var J=this,E=J.th=new Ve(R),K=J._view=bd(1,J);J.tv=J._tableView=R,pi(K,E.getView()),pi(K,R.getView()),E.mp(function(p){p.property===wr&&J.iv()}),J.iv()},E.getTableView=function(){return this.tv},E.getTableHeader=function(){return this.th},E.getDataModel=function(){return this.tv.dm()},E.getColumnModel=function(){return this.tv.getColumnModel()},E.setColumns=function(K){this.tv.setColumns(K)},E.addColumns=function(k){this.tv.addColumns(k)},E.endEditing=function(){this.tv.endEditing()},E.validateImpl=function(){var U=this,Z=U.th,V=fb(Z),n={x:0,y:0,width:U.getWidth(),height:V};Kn(Z,n),n.y=V,n.height=$(0,U.getHeight()-V),Kn(U.tv,n)}},ms_vs:function(g){g._41o=function(){return this._29I.height<this._59I},g._43o=function(){var U=this;U._41o()&&(U._58I||(e(function(){U._94O()},eb),U.iv()),U._58I=new Date)},g._94O=function(){var Q=this;if(Q._58I){var I=new Date;I.getTime()-Q._58I.getTime()>=eb?(delete Q._58I,Q.iv()):e(function(){Q._94O()},eb)}},g._93I=function(){var j=this,N=j._27I;if(j._58I||!j._autoHideScrollBar){N||pi(j._79O,N=j._27I=em());var D=j._29I,K=D.height,c=j._59I,T=j.getScrollBarSize(),e=D.width-T-2,G=K*(-j.ty()/c),B=K*(K/c),b=N.style;c>K?(ge>B&&(G=G+B/2-ge/2,0>G&&(G=0),G+ge>K&&(G=K-ge),B=ge),b.visibility=mf,b.background=j.getScrollBarColor(),b.borderRadius=T/2+De,Kn(N,e,G,T,B)):b.visibility=jg}else N&&(N.style.visibility=jg)}},ms_hs:function(L){L._40o=function(){return this._29I.width<this._91I},L._42o=function(){var $=this;$._40o()&&($._95O||(e(function(){$._94I()},eb),$.iv()),$._95O=new Date)},L._94I=function(){var Y=this;if(Y._95O){var T=new Date;T.getTime()-Y._95O.getTime()>=eb?(delete Y._95O,Y.iv()):e(function(){Y._94I()},eb)}},L._92I=function(){var s=this,H=s._28I;if(s._95O||!s._autoHideScrollBar){H||pi(s._79O,H=s._28I=em());var M=s._29I,e=M.width,Y=s._91I,K=s.getScrollBarSize(),t=M.height-K-2,g=e*(-s.tx()/Y),N=e*(e/Y),d=H.style;Y>e?(ge>N&&(g=g+N/2-ge/2,0>g&&(g=0),g+ge>e&&(g=e-ge),N=ge),d.visibility=mf,d.background=s.getScrollBarColor(),d.borderRadius=K/2+De,Kn(H,g,t,N,K)):d.visibility=jg}else H&&(H.style.visibility=jg)}}}),Jh(vg,ud(16,16,[{type:kk,rect:[1,1,14,14],background:Cn},{type:We,rect:[1,1,14,14],width:1,color:kf},{type:rd,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),Jh(Ic,ud(16,16,{type:We,rect:[1,1,14,14],width:1,color:kf})),Jh(Bd,ud(16,16,[{type:oj,rect:[2,2,12,12],borderWidth:1,borderColor:kf,background:"#FFF"},{type:oj,rect:[4,4,8,8],background:Cn}])),Jh(Gf,ud(16,16,{type:oj,rect:[2,2,12,12],borderWidth:1,borderColor:kf})),Re._15Q=function(S){S._29I=qm,S._59I=0,S._91I=0,S._5o=function(H){var R=this;R._30I=new Yi,R._rows=new Yi,R._rowMap={},R._31I=0,R._14I=0,R._view=bd(1,R),R._canvas=Uh(R._view),pi(R._view,R._79O=em()),R.dm(H?H:new Bs)},S.getCheckIcon=function(C){var x=this.sm(),B=x.co(C);return x.sg()?Ij(B?Bd:Gf):Ij(B?vg:Ic)},S.checkData=function(m){var j=this.sm(),U=j.co(m);j.sg()&&U||(this._32o=1,U?j.rs(m):j.as(m),delete this._32o)},S.getDataAt=function(z){z.target&&(z=this.lp(z));var c=O(z.y/this._rowHeight),k=this._rows;return 0>c||c>=k.size()?i:k.get(c)},S.onDataDoubleClicked=function(){},S.onDataClicked=function(){},S.adjustTranslateX=function(){return 0},S.adjustTranslateY=function(i){var D=this.getHeight()-this._59I;return D>i&&(i=D),i>0?0:G(i)},S.onPropertyChanged=function(H){var u=this,$=H.property;ng[$]?u.ivm():Rn[$]||u.redraw(),$===Bl?u._42o():$===Fq&&u._43o()},S.getLabel=function(f){return f.toLabel()},S.getLabelFont=function(){return this._labelFont},S.getLabelColor=function(o){var F=this;if(F.isCheckMode()){if(F._focusData===o)return F._labelSelectColor}else if(F.isSelected(o))return F._labelSelectColor;return F._labelColor},S.getStartRowIndex=function(){return this._31I},S.getEndRowIndex=function(){return this._14I},S.getRowDatas=function(){return this._rows},S.getRowIndex=function(s){return this._rowMap[s._id]},S.getRowSize=function(){return this._rows.size()},S.getViewRect=function(){return Se(this._29I)},S.isVisible=function(o){return this._visibleFunc?this._visibleFunc(o):!0},S.getCurrentSortFunc=function(){return this._sortFunc},S.setDataModel=function(r){var V=this,g=V._dataModel,w=V._selectionModel;g!==r&&(g&&(g.umm(V.handleDataModelChange,V),g.umd(V.handleDataPropertyChange,V),g.umh(V.handleHierarchyChange,V),w||g.sm().ums(V.handleSelectionChange,V)),V._dataModel=r,r.mm(V.handleDataModelChange,V),r.md(V.handleDataPropertyChange,V),r.mh(V.handleHierarchyChange,V),w?w._21I(r):r.sm().ms(V.handleSelectionChange,V),V.fp("dataModel",g,r))},S.validateModel=function(){var l=this;l._rows.clear(),l._rowMap={},l.buildChildren(l._dataModel._roots);var E=l._rows=l._rows.toList(l.isVisible,l),t=0,L=l.getCurrentSortFunc(),d=E.size();for(L&&E.sort(L);d>t;t++)l._rowMap[E.get(t)._id]=t},S.buildChildren=function(E){var T=this;E.each(function(I){T._rows.add(I),T.buildChildren(I._children)})},S.handleDataModelChange=function(){this.ivm()},S.handleDataPropertyChange=function(F){"parent"===F.property?this.ivm():this.invalidateData(F.data)},S.handleHierarchyChange=function(){this.ivm()},S.handleSelectionChange=function(A){A.datas.each(this.invalidateData,this),this.onSelectionChanged(A)},S.onSelectionChanged=function(w){var s=this,j=s.sm();!s.isAutoMakeVisible()||1!==j.size()||"set"!==w.kind&&"append"!==w.kind||s._32o||s.makeVisible(j.ld())},S.handleBackgroundClick=function(e){pn(e)&&!this.isCheckMode()&&this.sm().cs()},S.makeVisible=function(Q){Q&&(this._23I=Q,this.iv())},S.scrollToIndex=function(t){var T=this,S=T._29I,z=S.height,s=T._rowHeight,Y=s*t;t>=0&&t<T._rows.size()&&z>0&&(Y+s>S.y+z?T.ty(-Y+z-s):Y<S.y&&T.ty(-Y))},S.autoScroll=function(k,p){var v=this,L=v._rowHeight,A=L,C=L/4,P=v._29I,V=v.lp(k),j={x:v.tx(),y:v.ty()};return L>0&&P&&(V.x-P.x<A?v.translate(C,0):P.x+P.width-V.x<A&&v.translate(-C,0),V.y-P.y<A?v.translate(0,C):P.y+P.height-V.y<A&&v.translate(0,-C)),j.x=v.tx()-j.x,j.y=v.ty()-j.y,p&&(p.x+=j.x,p.y+=j.y),j},S.getTopRowOrderSelection=function(){var J=this.sm().getTopSelection(),l={},U=new Yi;return J.each(function(X){l[X._id]=X}),this._rows.each(function(I){l[I._id]&&U.add(I)}),U},S.getRowOrderSelection=function(){var O=new Yi;return this._rows.each(function(J){this.isSelected(J)&&O.add(J)},this),O},S.ivm=function(){this.invalidateModel()},S.invalidateModel=function(){var x=this;x._96I||(x._96I=1,x._32I=1,delete x._24I),x.iv()},S.redraw=function(){var q=this;q._32I||(q._32I=1,delete q._24I,q.iv())},S.invalidateData=function(r){var z=this;uk?z.redraw():z._32I||(z._24I||(z._24I={}),z._24I[r._id]=r,z.iv())},S.getFocusData=function(){return this._focusData},S.setFocusDataById=function(U){this.setFocusData(this.dm().getDataById(U))},S.setFocusData=function(n){var p=this,F=p._focusData;F!==n&&(p._focusData=n,p.fp("focusData",F,n),F&&p.invalidateData(F),n&&(p.invalidateData(n),p.isAutoMakeVisible()&&p.makeVisible(n)))},S.drawRowBackground=function(w,J,A,C,l,I,v){var N=this,n=N.isCheckMode();(J===N._focusData&&n||A&&!n)&&Tl(w,C,l,I,v,N.getSelectBackground(J))},S.drawData=function(n,D,l){var k=this,t=k._rowHeight,P=t*l,w=k._29I,y=w.x,B=w.width;n.save(),n.beginPath(),n.rect(y,P,B,t),n.clip(),k._87o(k.drawRow(n,D,k.isSelected(D),y,P,B,t),l,y,P,B,t),n.restore(),k._rowLineVisible&&Tl(n,y,P+t-1,B,1,k._rowLineColor)},S._12I=function(l){var g=this,J=g._31I,U=g._29I,i=U.x,k=U.y,s=U.width,q=U.height;for(l.beginPath(),l.rect(i,k,s,q),l.clip(),l.clearRect(i,k,s,q),g._76o(),g._93db(l);J<g._14I;J++)g.drawData(l,g._rows.get(J),J);g._92db(l)},S._13I=function(R){for(var c,I=this,y=I._rowHeight,$=I._29I,o=$.x,W=$.width,Z=I._31I,N=I._30I;Z<I._14I;Z++)c=I._rows.get(Z),I._24I[c._id]&&N.add({data:c,index:Z});N.isEmpty()||(R.beginPath(),N.each(function(U){R.rect(o,U.index*y,W,y)}),R.clip(),N.each(function(S){R.clearRect(o,S.index*y,W,y)}),N.each(function(s){I._77o(s.index)}),I._93db(R),N.each(function(X){I.drawData(R,X.data,X.index)}),I._92db(R),N.clear())},S.preValidateModel=function(){this.endEditing&&this.endEditing()},S.validateImpl=function(){var T=this,N=T._canvas,q=T.getWidth(),R=T.getHeight(),P=T._rowHeight,D=T._32I;(q!==N.clientWidth||R!==N.clientHeight)&&(Tj(N,q,R),D=1);var d=t&&!a;T._96I&&!d&&(T.preValidateModel(),T.validateModel());var Q=T._29I,K={x:-T.tx(),y:-T.ty(),width:q,height:R},p=T._rows.size(),k=Xc(N),z=T._23I;D||Mo(K,Q)||(D=1),T._29I=K,T._59I=p*P+T.getScrollBarSize(),T._31I=O(K.y/P),T._14I=H((K.y+K.height)/P),T._31I<0&&(T._31I=0),T._14I>p&&(T._14I=p),T._99I&&D&&T._99I(),kb(k,T.tx(),T.ty(),1),D?T._12I(k):T._24I&&T._13I(k),T._93I(),T._92I(),k.restore(),T._32I=T._24I=T._96I=i,z&&(T.scrollToIndex(T.getRowIndex(z)),delete T._23I),T.tx(T.tx()),T.ty(T.ty())}},Re._48o=function(J){J._rootVisible=!0,J._rootData=i,J._35o=function(){this._expandMap={},this._levelMap={}},J.validateModel=function(){var r=this,J=r._rootData;r._rows.clear(),r._levelMap={},r._rowMap={},r._currentLevel=0,J?r._rootVisible?r.isVisible(J)&&r.buildData(J):r.buildChildren(J):r.buildChildren(),delete r._currentLevel},J.buildData=function(q){var a=this,V=q._id,C=a._rows;a._rowMap[V]=C.size(),C.add(q),a._levelMap[V]=a._currentLevel,a.isExpanded(q)&&(a._currentLevel++,a.buildChildren(q),a._currentLevel--)},J.buildChildren=function(k){var l=this,I=k?k._children:l._dataModel._roots,n=l.getCurrentSortFunc();n&&l.isChildrenSortable(k)?I.toList(l.isVisible,l).sort(n).each(l.buildData,l):I.each(function(V){l.isVisible(V)&&l.buildData(V)})},J.getLevel=function(y){return this._levelMap[y._id]},J.getToggleIcon=function(j){var d=this,m=d._loader,c=d._collapseIcon;return m&&!m.isLoaded(j)?c:j.hasChildren()?d.isExpanded(j)?d._expandIcon:c:i},J.isCheckMode=function(){return this._checkMode!=i},J.isChildrenSortable=function(){return!0},J.handleDataModelChange=function($){var y=this;$.kind===lb?delete y._expandMap[$.data._id]:$.kind===th&&(y._expandMap={}),y.ivm()},J.toggle=function(V){var f=this;f.isExpanded(V)?f.collapse(V):f.expand(V)},J.isExpanded=function($){return 1===this._expandMap[$._id]},J.expand=function($){var P=this,d=P._loader;P.isExpanded($)||(d&&!d.isLoaded($)&&d.load($),P._expandMap[$._id]=1,P.ivm(),P.onExpanded($))},J.onExpanded=function(){},J.collapse=function(M){var H=this;H.isExpanded(M)&&(delete H._expandMap[M._id],H.ivm(),H.onCollapsed(M))},J.onCollapsed=function(){},J.expandAll=function(b){if(b)this.expand(b),b.eachChild(function(w){this.expandAll(w)},this);else{var s=this;s._dataModel.each(function(Y){Y.hasChildren()&&(s._expandMap[Y._id]=1)}),s.ivm()}},J.collapseAll=function(){this._expandMap={},this.ivm()},J.makeVisible=function(q){if(q){var v=this;if(!v._rootData||q.isDescendantOf(v._rootData)){for(var t=q._parent;t;)v.expand(t),t=t._parent;v._23I=q,v.iv()}}},J.checkData=function(_){var C,t=this,E=t._checkMode,n=t.sm(),e=n.co(_);if(!n.sg()||!e){if(t._32o=1,E===jp)e?n.rs(_):n.as(_);else if(E===Ll)C=new Yi(_),C.addAll(_._children);else if("descendant"===E)C=new Yi,hk(_,C);else if("all"===E&&(C=new Yi,hk(_,C),!e))for(var $=_._parent;$;)C.add($),$=$._parent;C&&(e?n.rs(C):n.as(C)),delete t._32o}},J._97I=function(O,G,k,L,j,M,D){var Q=this,U=Q._indent,B=Q._levelMap[G._id],m=Q.getIconWidth(G),T=Ij(Q.getToggleIcon(G));T?(L+=U*B,tp(O,T,L+U/2,j+D/2,G,Q),L+=U):L+=U*(B+1),Q._checkMode&&(tp(O,Q.getCheckIcon(G),L+U/2,j+D/2,G,Q),L+=U),Q.drawIcon(O,G,L,j,m,D),Q.drawLabel(O,G,L+m,j,D)}},Re._14Q=function(w){w.getIcon=function(Q){return Q.getIcon()},w.getIconWidth=function(J){return this.getIcon(J)?this._indent:0
},w.drawIcon=function(F,Y,a,Z,w,E){if(w){var c=this,j=c.getBodyColor(Y),T=Ij(c.getIcon(Y),j);T&&(E-=c.isRowLineVisible()?1:0,ml(F,T,ci,a,Z,w,E,Y,c,j),Yn(F,c.getBorderColor(Y),a,Z,w,E))}},w.drawLabel=function(s,Y,r,J,j){var m=this;Tq(s,m.getLabel(Y),m.getLabelFont(Y),m.getLabelColor(Y),r,J,0,j)}},Re._50o=function(j){j._98I=function(){var N=this,Y=N._39o=new Bs;N._60I=new Yi,Y.mm(N._17o,N),Y.md(N._18o,N),Y.mh(N._19o,N)},j.setColumns=function(s){this._39o.clear(),this.addColumns(s)},j.addColumns=function(y){var v=this._39o;y.forEach(function(b){if(!(b instanceof bk)){var R=yi(b.className);b=_b(R?R:bk,b)}v.add(b)})},j.onColumnClicked=function(){},j.onCheckColumnClicked=function(){},j._3Q=function(H){for(var q,$=0,_=this._60I,d=_.size();d>$;$++)if(q=_.get($),q.column===H)return q;return i},j.getColumnAt=function(X){var Y=this._4Q(X);return Y?Y.column:i},j._4Q=function(J){for(var K=this,z=J.target?K.lp(J).x:J.x,T=K._60I,X=0;X<T.size();X++){var t=T.get(X),n=t.startX;if(z>=n&&z<n+t.column.getWidth())return t}return i},j.getToolTip=function(r){var y=this,L=y.getDataAt(r),E=y.getColumnAt(r);return L&&E?E.getToolTip(L,y):i},j.adjustTranslateX=function(x){var B=this.getWidth()-this._91I;return B>x&&(x=B),x>0?0:G(x)},j._99I=function(){var v=this,j=v._29I,L=v._60I;L.clear(),v._91I=0,v._39o._roots.each(function(X){if(X.isVisible()){var F=v._91I+X.getWidth();v._91I<=j.x+j.width&&F>=j.x&&L.add({column:X,startX:v._91I}),v._91I=F}}),v._91I+=v.getScrollBarSize()},j.drawData=function(J,G,r){var S=this,U=S._rowHeight,H=U*r,K=S.isSelected(G),b=S._29I,M=b.x,y=b.width;S.drawRowBackground(J,G,K,M,H,y,U),S._60I.each(function(f){var $=f.column,V=f.startX,W=$.getWidth();W>0&&!S.isEditing(G,$)&&(J.save(),J.beginPath(),J.rect(V,H,W,U),J.clip(),S._87o(S.drawCell(J,G,K,$,V,H,W,U),r,V,H,W,U),S._columnLineVisible&&Tl(J,V+W-1,H,1,U,S._columnLineColor),J.restore())}),S._rowLineVisible&&Tl(J,M,H+U-1,y,1,S._rowLineColor)},j.drawCell=function(t,Q,E,S,C,x,H,R){var w=this;if(S.drawCell)return S.drawCell(t,Q,E,S,C,x,H,R,w);var g=w.getValue(Q,S);gn(t,g,S,w.getLabelFont(Q,S,g),w.getLabelColor(Q,S,g),C,x,H,R,Q,w)},j.getColumnModel=function(){return this._39o},j._17o=function(){this.redraw()},j._18o=function(S){var i=this;S.data===i._sortColumn&&mg[S.property]?i.ivm():(i._42o(),i.redraw())},j._19o=function(){this.redraw()},j.getCurrentSortFunc=function(){var j=this,J=j._sortColumn;if(J&&J.isSortable()){var C=J.getSortFunc(),x=hd===J.getSortOrder()?1:-1;return C||(C=_l),function(Z,r){return C.call(j,j.getValue(Z,J),j.getValue(r,J),Z,r)*x}}return j._sortFunc},j.isCellEditable=function(o,m,u){return m.isEditable()&&this.isEditable()?m.isCellEditable?m.isCellEditable(o,m,u,this):!0:!1},j._37O=function(e,N){if(pn(N))for(var t=this,J=t.lp(N),U=t._60I,$=t._rowHeight,D=t._29I,L=D.x,G=D.y,s=D.width,m=D.height,E=0;E<U.size();E++){var i=U.get(E),R=i.startX,y=i.column,Q=y.getWidth();if(y!==t._31o&&y!==t._4o&&J.x>=R&&J.x<R+Q&&t.isCellEditable(e,y,N)){var j={x:R,y:t.getRowIndex(e)*$,width:Q,height:$},q={x:j.x+t.tx(),y:j.y+t.ty(),width:j.width,height:j.height},V=0,z=0;return j.x<L?V=j.x-L:j.x+j.width>L+s&&(V=j.x+j.width-L-s),V&&(t.tx(t.tx()-V),q.x-=V),j.y<G?z=j.y-G:j.y+$>G+m&&(z=j.y+$-G-m),z&&(t.ty(t.ty()-z),q.y-=z),t.beginEditing({data:e,column:y,value:t.getValue(e,y),event:N,rect:j,editorRect:q,view:t}),void 0}}}},vq.BaseItemEditor=function(M,y,j,O){this._data=M,this._column=y,this._master=j,this._editInfo=O},ef("BaseItemEditor",j,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var zd=r.Tab=function(){Kh(zd,this)};zr("Tab",El,{ms_ac:["view","closable","disabled","visible"],_icon:i,_closable:!1,_disabled:!1,_visible:!0,setParent:Nn});var bk=r.Column=function(){Kh(bk,this)};zr("Column",El,{_46o:1,ms_ac:["accessType","valueType",mf,Qj,Si,as,"align",nb,"sortOrder",Ki,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:hd,_sortFunc:i,_sortable:!0,_clickable:!0,setWidth:function(M){16>M&&(M=16);var I=this._width;this._width=M,this.fp(as,I,M)},getToolTip:function(X,n){return this.formatValue(n.getValue(X,this))}});var Dm=r.Property=function(){Kh(Dm,this)};zr("Property",El,{_46o:1,ms_ac:["accessType","valueType",Qj,Si,"categoryName",nb,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:i,getToolTip:function(x,Y,A){var p=this;return Y?p.formatValue(A.getValue(x,p)):A.getPropertyName(p)}}),vq.AccordionView=function(){var O=this;O._20o={},O._21o=new Yi,O._10o=i,O._9o=i,O._11o=i,O._view=bd(0,O),O.iv()},ef("AccordionView",j,{ms_v:1,ms_fire:1,ms_ac:[jb,sn,"titleHeight",je,ni,"titleBackground","selectWidth",te,"orientation","separatorColor"],_expandIcon:z.accordionViewExpandIcon,_collapseIcon:z.accordionViewCollapseIcon,_titleHeight:Qp,_labelColor:z.accordionViewLabelColor,_labelFont:z.accordionViewLabelFont,_titleBackground:z.accordionViewTitleBackground,_selectBackground:z.accordionViewSelectBackground,_selectWidth:z.accordionViewSelectWidth,_orientation:"v",_separatorColor:z.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(y,r,N,A){var J=this,H=em();if(J._20o[y])throw y+" already exists";H.onmousedown=nl,H.style.cursor=zc,Z(H,Aj?Do:yr,function(O){nl(O)}),Z(H,Aj?Mh:ar,function(m){nl(m),pn(m)&&(J._10o===y?J.collapse():J.expand(y))}),pi(J._view,H),J._20o[y]={content:r,div:H,canvas:Uh(H),icon:A},J._21o.add(y),N&&J.expand(y),J.iv()},remove:function(N){var m=this,o=m._20o[N];o&&(As(o.div),delete m._20o[N],m._21o.remove(N),m.iv())},clear:function(){var b=this;b._21o.toArray().forEach(b.remove,b),b._20o={},b._21o.clear(),b.iv()},isExpanded:function(r){return this._10o===r},expand:function(C){var V=this;V._20o[C]&&V._10o!==C&&(V._10o=C,V.onExpanded(C),V.iv())},onExpanded:function(){},collapse:function(){var $=this;$._10o&&($.onCollapsed($._10o),delete $._10o,$.iv())},onCollapsed:function(){},initCanvas:function(B,H,h){Tj(B,H,h);var G=Xc(B);return kb(G,0,0,1),G.clearRect(0,0,H,h),G},drawTitle:function(C,p,m,R,i){var U=this,Y=Ij(i.icon),T=U.isExpanded(p),Q=U._titleHeight,V=U._titleBackground,z=U._selectWidth,D=U._separatorColor,S=Ij(T?U._expandIcon:U._collapseIcon),s=z+4;Tl(C,0,0,m,R,V),T&&z&&Tl(C,0,0,z,R,U._selectBackground),(T||U._21o.get(U._21o.size()-1)!==p)&&Tl(C,0,R-1,m,1,D?D:$c(V)),Y&&(tp(C,Y,s+gq(Y)/2,Q/2),s+=gq(Y)+2),Tq(C,p,U.getLabelFont(p),U.getLabelColor(p),s,0,0,Q),S&&tp(C,S,m-gq(S)/2-4,Q/2)},validateImpl:function(){var H=this,h=H._view,S=0,U=0,y=H.getWidth(),q=H.getHeight(),n=H._titleHeight,w=H._21o.size()*n,b=H._11o,Q=H._9o;delete H._11o,delete H._9o,H._21o.each(function(J){var d,j,h=H._20o[J],T=h.content,M=H._10o===J;us(H)?(Kn(h.div,S,0,n,q),d=H.initCanvas(h.canvas,n,q),Ag(d,0,q),_p(d,-L),H.drawTitle(d,J,q,n,h),d.restore(),M?(j=$(0,y-w),T&&(H._11o=T,H._9o=Lq(T),Kn(T,S+n,0,j,q)),S+=n+j):S+=n):(Kn(h.div,0,U,y,n),d=H.initCanvas(h.canvas,y,n),H.drawTitle(d,J,y,n,h),d.restore(),M?(j=$(0,q-w),T&&(H._11o=T,H._9o=Lq(T),Kn(T,0,U+n,y,j)),U+=n+j):U+=n)});var g=H._9o;b&&b!==H._11o&&b.endEditing&&b.endEditing(),g&&g!==Q&&pi(h,g),Q&&Q!==g&&As(Q)}}),vq.SplitView=function(D,j,W,e){var b=this,g=b._dividerDiv=em(),T=b._60O=Uh(),v=b._61O=Uh(),H=T.style,c=v.style;b._view=bd(1,b),pi(b._view,g),H.msTouchAction=bc,H.pointerEvents=bc,H.cursor=zc,c.msTouchAction=bc,c.pointerEvents=bc,c.cursor=zc,D&&b.setLeftView(D),j&&b.setRightView(j),W&&b.setOrientation(W),e!=i&&b.setPosition(e),b.setStatus(ne),new Pi(b)},ef("SplitView",j,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:z.splitViewDividerSize,_dividerBackground:z.splitViewDividerBackground,_dragOpacity:z.splitViewDragOpacity,_toggleIcon:z.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(T,P){var y=this,F=y._position;isNaN(T)||(P||(y._82O=0>T?-1:T>1?1:0),y._position=T,y.fp(Up,F,T))},getLeftView:function(){return this._leftView},setLeftView:function(u){var c=this,D=c._leftView,b=c._view;if(c._leftView!==u){if(D&&D!==c._rightView){var e=Lq(D);e.parentNode===b&&As(e)}if(c._leftView=u,u){var O=Lq(u);O.parentNode!==b&&b.insertBefore(O,c._dividerDiv)}c.fp("leftView",D,u)}},getRightView:function(){return this._rightView},setRightView:function(W){var t=this,_=t._rightView,f=t._view;if(t._rightView!==W){if(_&&_!==t._leftView){var r=Lq(_);r.parentNode===f&&As(r)}if(t._rightView=W,W){var O=Lq(W);O.parentNode!==f&&f.insertBefore(O,t._dividerDiv)}t.fp("rightView",_,W)}},validateImpl:function(){var r=this,i=r._draggable,Q=r._position,R=r.getWidth(),l=r.getHeight(),W=r._dividerSize,h=r._dividerBackground,I=Aj?18:8,t=r._dividerDiv,g=r._82O,P=r._60O,w=r._61O,m=r._toggleIcon,O=r._status,B=t.style,k=null,n=Aj?20:4,A=m.comps[0];W>=I||0===W?r._coverDiv&&(As(r._coverDiv),delete r._coverDiv):r._coverDiv||(r._coverDiv=em(),Ph&&(r._coverDiv.style.background=Bq),pi(t,r._coverDiv)),r._togglable?P.parentNode||(pi(t,P),pi(t,w)):(As(P),As(w));var o=r._coverDiv,N=r._leftView,S=r._rightView;if(us(r)){if(W>R&&(W=R),O===ne)if(1===g)var f=_(Q,R),C=$(0,R-W-f);else-1===g?(C=_(-Q,R),f=$(0,R-W-C)):(f=G((R-W)*Q),C=$(0,R-W-f));else"cl"===O?(f=0,C=$(0,R-W)):"cr"===O&&(C=0,f=$(0,R-W));N&&Kn(N,0,0,f,l),S&&Kn(S,f+W,0,C,l),Kn(t,f,0,W,l),r._22o=f,o&&(Kn(o,W/2-I/2,0,I,l),o.style.cursor=i?ko:""),t.style.cursor=i?ko:"";var F=t.clientHeight/2,b=t.clientWidth;Tj(P,b,b),Kn(P,0,F-b-n,b,b),k=Xc(P),kb(k,0,0,1),A.rotation=-L,ui(k,m,0,0,b,b),k.restore(),Tj(w,b,b),Kn(w,0,F+n,b,b),k=Xc(w),kb(k,0,0,1),A.rotation=L,ui(k,m,0,0,b,b),k.restore()}else{if(W>l&&(W=l),O===ne)if(1===g)var Y=_(Q,l),E=$(0,l-W-Y);else-1===g?(E=_(-Q,l),Y=$(0,l-W-E)):(Y=G((l-W)*Q),E=$(0,l-W-Y));else"cl"===O?(Y=0,E=$(0,l-W)):"cr"===O&&(E=0,Y=$(0,l-W));N&&Kn(N,0,0,R,Y),S&&Kn(S,0,Y+W,R,E),Kn(t,0,Y,R,W),r._22o=Y,o&&(Kn(o,0,W/2-I/2,R,I),o.style.cursor=i?wd:""),B.cursor=i?wd:"";var p=t.clientWidth/2,b=t.clientHeight;Tj(P,b,b),Kn(P,p-b-n,0,b,b),k=Xc(P),kb(k,0,0,1),A.rotation=0,ui(k,m,0,0,b,b),k.restore(),Tj(w,b,b),Kn(w,p+n,0,b,b),k=Xc(w),kb(k,0,0,1),A.rotation=J,ui(k,m,0,0,b,b),k.restore()}B.background=h}});var Pi=function(u){this.sv=u,this.addListeners()};Zi(Pi,j,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(C){var p=this,P=p.sv,S=P._dividerDiv,d=P._60O,L=P._61O,O=P._status,B=C.target;if(B===d)O===ne?P.setStatus("cl"):"cr"===O&&P.setStatus(ne);else if(B===L)O===ne?P.setStatus("cr"):"cl"===O&&P.setStatus(ne);else if(Zf(C)&&(B===S||B===P._coverDiv)&&(nl(C),P.isDraggable())){P.getLeftView(),P.getRightView();var G=p.maskDiv=em();if(G.style.left=0,G.style.top=0,G.style.width=P.getWidth()+"px",G.style.height=P.getHeight()+"px",P.getView().appendChild(G),!P.isContinuousLayout()){var U=p.resizeDiv=em();U.style.left=S.style.left,U.style.top=S.style.top,U.style.width=S.style.width,U.style.height=S.style.height,U.style.opacity=P.getDragOpacity(),U.style.background=P.getDividerBackground(),pi(p.getView(),U)}p._lastAbsPosition=P._22o,p._86o=us(P)?Mi(C).x:Mi(C).y,Vn(p,C)}},handleWindowTouchMove:function(f){Zf(f)&&this.update(f,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(u){var v=this;v.update(u,!0),v.sv.setStatus(ne),v.maskDiv&&As(v.maskDiv),v.resizeDiv&&As(v.resizeDiv),v.maskDiv=v.resizeDiv=i},handle_mousedown:function(F){pn(F)&&this.handle_touchstart(F)},handleWindowMouseMove:function(K){this.handleWindowTouchMove(K)},handleWindowMouseUp:function(y){this.handleWindowTouchEnd(y)},update:function(B,V){var H=this,c=H.sv,Q=us(c)?c.getWidth():c.getHeight(),F=c._dividerSize,R=H._lastAbsPosition-H._86o;us(c)?(R+=Mi(B).x,R>Q-F&&(R=Q-F),0>R&&(R=0),H.resizeDiv&&(H.resizeDiv.style.left=R+De)):(R+=Mi(B).y,R>Q-F&&(R=Q-F),0>R&&(R=0),H.resizeDiv&&(H.resizeDiv.style.top=R+De)),V&&Q!==F&&(1===c._82O?c.setPosition(R,1):-1===c._82O?c.setPosition(R-Q+F,1):c.setPosition(R/(Q-F),1))}}),vq.TabView=function(){var R=this,X=R._view=bd(1,R),q=R._91O=em(1),c=R._tabModel=new Bs,m=c.sm(),K=R.invalidate;R._7o=new Yi,R._canvas=Uh(q),pi(X,q),pi(X,R._92O=em(1)),m.setSelectionMode(vl),m.ms(R.handleSelectionChange,R),c.mm(K,R),c.mh(K,R),c.md(K,R),R._interactor=new Qd(R),R.iv()},ef("TabView",j,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",je,ni,"tabHPadding","tabBackground","selectWidth",te,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:bm,_tabHeight:Qp,_tabGap:z.tabViewTabGap,_labelColor:z.tabViewLabelColor,_labelFont:z.tabViewLabelFont,_tabBackground:z.tabViewTabBackground,_selectWidth:z.tabViewSelectWidth,_selectBackground:z.tabViewSelectBackground,_moveBackground:z.tabViewMoveBackground,_insertColor:z.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(o,B,V){var $,P=this._tabModel;return o instanceof zd?($=o,B&&$.setView(B)):($=new zd,$.setName(o),$.setView(B)),P.add($),V&&P.sm().ss($),$},getLabel:function(E){return E.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(E){this._23o=E,this.iv()},get:function(u){var S=this,J=S._tabModel;if(Dn(u))return J._roots.get(u);if(un(u)){var o;return J.each(function(A){u===S.getLabel(A)&&(o=A)}),o}return u instanceof zd?u:i},select:function(R){this._tabModel.sm().ss(this.get(R))},remove:function(k){var i=this;if(k=i.get(k)){var f=i._tabModel,j=f._roots.indexOf(k);i._tabModel.remove(k),i.selectByIndex(--j)}},getCurrentTab:function(){return this._8o},hideTabView:function(b,k){k.parentNode===this._92O&&(li(k)?(k.style.display=Gi,k._tab_=b):As(k),Ui())},showTabView:function(u,C){li(C)&&(C.style.display="block",C._tab_=u),C.parentNode!==this._92O&&(pi(this._92O,C),Ui())},_24o:function(){var W,i=this,I=i._8o,E=i._9o,Q=i._tabModel.sm().ld();Q&&(W=Lq(Q.getView())),W!==E&&(E&&(I.getView()&&I.getView().endEditing&&I.getView().endEditing(),i.hideTabView(I,E)),W&&i.showTabView(Q,W)),i._8o=Q,i._9o=W,I!==Q&&i.onTabChanged(I,Q)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(k,H){this.selectByIndex(--H)},selectByIndex:function(E){var h=this,z=h._tabModel,f=z.size();if(f&&!z.sm().ld()){E==i&&(E=0),E>=f&&(E=f-1),0>E&&(E=0);for(var w=E;w>=0;w--){var N=h.get(w);if(!N.isDisabled())return h.select(N),N}for(w=E+1;f>w;w++)if(N=h.get(w),!N.isDisabled())return h.select(N),N}},getTabWidth:function(N){var w=this.getTabHPadding(),Q=4+2*w,t=Ij(N.getIcon());t&&(Q+=gq(t,N)+4);var T=this.getLabel(N);return T&&(Q+=td(this.getLabelFont(N),T).width+4),N.isClosable()&&(Q+=10),Q},drawTab:function(s,f,U,$,T,R,q){var W,a=this,M=a._tabPosition,P=this.getTabHPadding(),Z=U+4+P,Y=a._selectWidth,t=Ij(f.getIcon()),g=f.isDisabled(),r=a.getLabelColor(f),b=a.getLabelFont(f),E=a.getLabel(f),Q=a._selectBackground,d=M===br+"-vertical",w=M===lk+"-vertical";(d||w)&&(Z=$+4+P),g&&(s.globalAlpha=sb),Tl(s,U,$,T,R,q),f===a._8o&&Y&&(M===bm?Tl(s,U,$+R-Y,T,Y,Q):M===br?Tl(s,U+T-Y,$,Y,R,Q):M===lk?Tl(s,U,$,Y,R,Q):d?Tl(s,U+T-Y,$,Y,R,Q):w?Tl(s,U,$,Y,R,Q):Tl(s,U,$,T,Y,Q));var o=T/2;if(d&&(Ag(s,o,$+R/2),_p(s,J),Ag(s,-o,-$-R/2)),t){var l=eo(t,f),n=gq(t,f);if(d||w){var z=U+T/2,C=Z+l/2;Ag(s,z,C),_p(s,L),Ag(s,-z,-C),tp(s,t,U+T/2,Z+l/2,f,a),Ag(s,z,C),_p(s,-L),Ag(s,-z,-C),Z+=l+4}else tp(s,t,Z+n/2,$+R/2,f,a),Z+=n+4}return d||w?(Ag(s,T/2,Z+T/2),_p(s,L),Ag(s,-T/2,-Z-T/2),Tq(s,E,b,r,U,Z,R,T),Ag(s,T/2,Z+T/2),_p(s,-L),Ag(s,-T/2,-Z-T/2)):Tq(s,E,b,r,Z,$,T,R),d&&(Ag(s,o,$+R/2),_p(s,-J),Ag(s,-o,-$-R/2)),f.isClosable()&&(W=w?{x:U+T-12,y:$+R-12,width:12,height:12}:{x:U+T-12,y:$+2,width:12,height:12},this.drawCloseIcon(f,s,r,W)),g&&(s.globalAlpha=1),W},drawCloseIcon:function(A,L,l,X){var s=X.x,U=X.y;L.strokeStyle=l,L.lineWidth=1,L.beginPath(),L.moveTo(s+2,U+8),L.lineTo(s+8,U+2),L.moveTo(s+8,U+8),L.lineTo(s+2,U+2),L.stroke()},getTabAt:function(e){var B=this._interactor._8Q(e);return B?B.tab:null},validateImpl:function(){var k=this;k._24o();var G,y=k._canvas,P=k._tabPosition,X=k._91O,s=k._92O,b=k._tabModel,N=k.getWidth(),F=k.getHeight(),g=k._tabHeight,r=k._7o,j=k._tabGap,w=P===bm,J=P===br,e=P===lk,p=P===br+"-vertical",f=P===lk+"-vertical",n=k._23o,H=0;if((J||e)&&b._roots.each(function(P){H=$(k.getTabWidth(P),H)}),w?(Kn(X,0,0,N,g),G={x:0,y:g,width:N,height:$(0,F-g)}):J?(Kn(X,0,0,H,F),G={x:H,y:0,width:$(0,N-H),height:F}):e?(Kn(X,N-H,0,H,F),G={x:0,y:0,width:$(0,N-H),height:F}):p?(Kn(X,0,0,g,F),G={x:g,y:0,width:$(0,N-g),height:F}):f?(Kn(X,N-g,0,g,F),G={x:0,y:0,width:$(0,N-g),height:F}):(Kn(X,0,F-g,N,g),G={x:0,y:0,width:N,height:$(0,F-g)}),Kn(s,G),p||f){k._9o&&(G.x=0,Kn(k._8o.getView(),G)),Tj(y,g,F);var l=Xc(y),I=0;if(kb(l,0,k.ty(),1),l.clearRect(0,0,g,F),r.clear(),b._roots.each(function(f){if(f.isVisible()){var S,D=k.getTabWidth(f);n&&n.tab===f||(S=k.drawTab(l,f,0,I,g,D,k._tabBackground)),r.add({_75o:S,tab:f,startY:I,endY:I+D,height:D}),I+=D+j}}),k._23Q=$(0,I-j),n){var q=n.position;k.drawTab(l,n.tab,0,n.startY,g,n.height,k._moveBackground),Tl(l,0,q,g,1,k._insertColor)}if(l.restore(),k._selectionChanged){k._selectionChanged=!1;for(var D=k.ty(),R=0;R<r.size();R++){var d=r.get(R);if(d.tab===k._8o){if(d.endY+D<0){k.ty(-d.startY);break}if(d.startY+D>F){k.ty(F-d.endY);break}}}}k.ty(k.ty())}else if(J||e){k._9o&&(G.x=0,Kn(k._8o.getView(),G)),Tj(y,H,F);var l=Xc(y),I=0;if(kb(l,0,k.ty(),1),l.clearRect(0,0,H,F),r.clear(),b._roots.each(function(x){if(x.isVisible()){var S;n&&n.tab===x||(S=k.drawTab(l,x,0,I,H,g,k._tabBackground)),r.add({_75o:S,tab:x,startY:I,endY:I+g,height:g}),I+=g+j}}),k._23Q=$(0,I-j),n){var q=n.position;k.drawTab(l,n.tab,0,n.startY,H,n.height,k._moveBackground),Tl(l,0,q,H,1,k._insertColor)}if(l.restore(),k._selectionChanged){k._selectionChanged=!1;for(var D=k.ty(),R=0;R<r.size();R++){var d=r.get(R);if(d.tab===k._8o){if(d.endY+D<0){k.ty(-d.startY);break}if(d.startY+D>F){k.ty(F-d.endY);break}}}}k.ty(k.ty())}else{k._9o&&(G.y=0,Kn(k._8o.getView(),G)),Tj(y,N,g);var l=Xc(y),O=0;if(kb(l,k.tx(),0,1),l.clearRect(0,0,N,g),r.clear(),b._roots.each(function(C){if(C.isVisible()){var S,X=k.getTabWidth(C);n&&n.tab===C||(S=k.drawTab(l,C,O,0,X,g,k._tabBackground)),r.add({_75o:S,tab:C,startX:O,endX:O+X,width:X}),O+=X+j}}),k._64I=$(0,O-j),n){var q=n.position;k.drawTab(l,n.tab,n.startX,0,n.width,g,k._moveBackground),$d(l,k._insertColor,q,0,g)}if(l.restore(),k._selectionChanged){k._selectionChanged=!1;for(var A=k.tx(),R=0;R<r.size();R++){var d=r.get(R);if(d.tab===k._8o){if(d.endX+A<0){k.tx(-d.startX);break}if(d.startX+A>N){k.tx(N-d.endX);break}}}}k.tx(k.tx())}for(var _=[],S=s.children,R=0;R<S.length;R++){var B=S[R],o=B._tab_;o&&!b.contains(o)&&_.push(B)}_.forEach(function(F){s.removeChild(F)})}});var Qd=function(g){this.tv=g,this.addListeners()};Zi(Qd,j,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(p){this.handleScroll(p,10*(p.wheelDelta/40))},handle_DOMMouseScroll:function(a){this.handleScroll(a,10*-a.detail)},handleScroll:function(o,Y){nl(o);var y=this.tv,F=y._tabPosition;!y._40o()||F!==bm&&F!==Lp||y.tx(this.tv.tx()+Y),!y._41o()||F!==br&&F!==lk&&F!==br+"-vertical"&&F!==lk+"-vertical"||y.ty(this.tv.ty()+Y)},_8Q:function(A){var g,S,H=this.tv,m=H._tabPosition,O=H._7o;if(m===bm||m===Lp){var e=H.lp(A).x;for(g=0;g<O.size();g++)if(S=O.get(g),S.startX<=e&&e<=S.endX)return S}else if(m===br||m===lk||m===br+"-vertical"||m===lk+"-vertical"){var Y=H.lp(A).y;for(g=0;g<O.size();g++)if(S=O.get(g),S.startY<=Y&&Y<=S.endY)return S}return i},isClickable:function(H){var n=this.tv,t=n._tabPosition,V=this._73o=this._8Q(H);return!n._40o()||t!==bm&&t!==Lp?!n._41o()||t!==br&&t!==lk&&t!==br+"-vertical"&&t!==lk+"-vertical"?V&&(!V.tab.isDisabled()||n.isMovable()):!0:!0},handle_mousemove:function(k){var J=this;ij?J._74o=J._8Q(k):J.getView().style.cursor=J.isClickable(k)?zc:""},handle_mousedown:function(i){this.handle_mousemove(i),this.handle_touchstart(i)},handle_touchstart:function(Q){var V=this,h=V.tv,t=h._tabPosition;nl(Q),pn(Q)&&V.isClickable(Q)&&(t===bm||t===Lp?(V.x=Mi(Q).x,V.lp=h.lp(Q),V.tx=h.tx()):(V.y=Mi(Q).y,V.lp=h.lp(Q),V.ty=h.ty()),Vn(V,Q))},handleWindowMouseMove:function(H){this.handleWindowTouchMove(H)},handleWindowTouchMove:function(w){var z,y=this,m=y.tv,G=m._tabPosition,I=y._73o;if(G===bm||G===Lp){if(z=Mi(w).x-y.x,!y._25o&&!y.moving&&R(z)>2&&(m._40o()&&!Th(w)?y._25o=1:I&&m.isMovable()&&(y.moving=1)),y._25o)m.tx(y.tx+z);else if(y.moving){var K=y.lp.x+z,B=m._tabGap/2;m._7o.each(function(E){var p=E.endX,u=K-E.startX<p-K;K>=E.startX&&p>=K&&m._7Q({tab:I.tab,startX:I.startX+z,width:I.width,front:u,insertTab:E.tab,position:u?$(0,E.startX-B):_(m._64I,p+B)})})}}else if(z=Mi(w).y-y.y,!y._25o&&!y.moving&&R(z)>2&&(m._41o()&&!Th(w)?y._25o=1:I&&m.isMovable()&&(y.moving=1)),y._25o)m.ty(y.ty+z);else if(y.moving){var D=y.lp.y+z,B=m._tabGap/2;m._7o.each(function(w){var k=w.endY,U=D-w.startY<k-D;D>=w.startY&&k>=D&&m._7Q({tab:I.tab,startY:I.startY+z,height:I.height,front:U,insertTab:w.tab,position:U?$(0,w.startY-B):_(m._23Q,k+B)})})}},handleWindowMouseUp:function(I){this.handleWindowTouchEnd(I)},handleWindowTouchEnd:function(){var G=this,H=G.tv,Q=H._tabPosition,S=H.getTabModel(),a=S._roots,z=G._73o;if(G.moving){var C=H._23o;if(C&&C.insertTab!==C.tab){var T=C.tab,R=a.remove(T),g=a.indexOf(C.insertTab);g>=0&&(C.front||g++,g<=a.size()&&(a.add(T,g),S._38I(T,R,g)))}H._7Q(i),delete G.moving}else if(!G._25o&&z){T=z.tab;var V=G._74o;if(!V||V.tab===T)if(!T.isDisabled()&&oh(z._75o,G.lp)){var F=function(){var F=a.indexOf(T);S.remove(T),H.onTabClosed(T,F)};H.onTabClosing(T,F)&&F()}else T.isDisabled()||H._8o===T||S.sm().ss(T)}G._25o=G._73o=G._74o=Q===bm||Q===Lp?G.x=G.lp=G.tx=i:G.y=G.lp=G.ty=i}}),vq.PropertyView=function(k){var c=this;c._view=bd(1,c),c._canvas=Uh(c._view),pi(c._view,c._79O=em()),c._rows=new Yi,c._28o=new Yi,c._26o={},c._26Q={};var N=c._propertyModel=new Bs,r=c.ivm;N.mm(r,c),N.md(r,c),N.mh(r,c),c.dm(k?k:new Bs),new gd(c)},ef("PropertyView",j,{ms_ac:[je,vk,ni,Qj,Si,"categorizable",Dl,Ki,Yq,jb,sn,om,Zj,cr,"selectRowIndex",te,"background",hm,ee,Hn,Hm,_d],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:qm,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Wo,_background:z.propertyViewBackground,_expandIcon:z.propertyViewExpandIcon,_collapseIcon:z.propertyViewCollapseIcon,_scrollBarColor:Cl,_scrollBarSize:Bb,_autoHideScrollBar:rm,_selectBackground:z.propertyViewSelectBackground,_rowHeight:yc,_rowLineVisible:z.propertyViewRowLineVisible,_rowLineColor:z.propertyViewRowLineColor,_10I:.5,_columnLineVisible:z.propertyViewColumnLineVisible,_columnLineColor:z.propertyViewColumnLineColor,_labelColor:z.propertyViewLabelColor,_labelSelectColor:z.propertyViewLabelSelectColor,_labelFont:z.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(O){0>O&&(O=0),O>1&&(O=1);var Y=this,I=Y._10I;Y._10I=O,Y.fp("columnPosition",I,O)},getPropertyName:function(v){return v.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(V,M,T){return T===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(S,H){return H===this._selectRowIndex?this._labelSelectColor:S.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(N){var P=this.getHeight()-this._59I;return P>N&&(N=P),N>0?0:G(N)},isExpanded:function(g){if(!g)return!0;var X=this._26o[g];return X?X.isExpanded:!(this._26Q[g]===!1)},toggle:function(T){var K=this;K.isExpanded(T)?K.collapse(T):K.expand(T)},expandAll:function(){this.validate();for(var L in this._26o)this.expand(L)},expand:function(f){if(f&&f!==Gi){var d=this,o=d._26o[f];o&&!o.isExpanded&&(o.isExpanded=!0,d.onExpanded(f),d.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var F in this._26o)this.collapse(F)},collapse:function(G){if(G&&G!==Gi){var r=this,W=r._26o[G];W&&W.isExpanded&&(W.isExpanded=!1,r.onCollapsed(G),r.ivm())}},onCollapsed:function(){},getCategoryName:function(e){if(!this.isCategorizable())return Gi;var T=e.getCategoryName();return T?T:Gi},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(V){var Y=this,g=Y._dataModel;g!==V&&(g&&(g.umd(Y.handlePropertyChange,Y),Y._selectionModel||g.sm().ums(Y.handleSelectionChange,Y)),Y._dataModel=V,V.md(Y.handlePropertyChange,Y),Y._selectionModel?Y._selectionModel._21I(V):V.sm().ms(Y.handleSelectionChange,Y),Y.fp(so,g,V))},isVisible:function(O){return this._visibleFunc?this._visibleFunc(O):!0},onPropertyChanged:function(p){var Z=this,T=p.property;Dg[T]?Z.ivm():Z.iv(),T===Fq&&Z._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:zi},handlePropertyChange:function(r){this._27o===r.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var t=this;t._96I||(t.setSelectRowIndex(-1),t._96I=1,t.iv())},redraw:function(){this.iv()},validateModel:function(){var G=this,m=G._rows,q=G._28o,x={},g=new Yi,P=G._27o;G.updateCurrentData(),P!==G._27o&&G.endEditing(),m.clear(),q.clear(),G.getRawProperties().each(function(m){if(G.isVisible(m)){g.add(m);var A=G.getCategoryName(m);x[A]||(q.add(A,A===Gi?0:s),x[A]={isExpanded:G.isExpanded(A),properties:new Yi})}}),G._sortFunc&&g.sort(G._sortFunc);for(var I in G._26o)G._26Q[I]=G.isExpanded(I);G._26o=x,q.each(function(A){A!==Gi&&m.add(A);var D=x[A];D.isExpanded&&g.each(function(g){G.getCategoryName(g)===A&&(D.properties.add(g),m.add({property:g,data:G._27o}))},G)})},validateImpl:function(){var E=this;E._76o(),E._96I&&(E.validateModel(),delete E._96I);var k=E._canvas,R=E.getWidth(),U=E.getHeight(),m=-E.ty(),I=E._rowHeight,L=E._indent,u=R-L,e=E._rows,M=e.size(),v=E._9I=L+u*E._10I,l=E._59I=M*I;Tj(k,R,U),E._29I={x:0,y:m,width:R,height:U},E._31I=O(m/I),E._14I=H((m+U)/I),E._31I<0&&(E._31I=0),E._14I>M&&(E._14I=M);var r,W=Xc(k),T=E._background;kb(W,0,-m,1),W.beginPath(),W.rect(0,m,R,U),W.clip(),W.clearRect(0,m,R,U),E._93db(W),T&&Tl(W,0,0,L,l,T);for(var P=E._31I;P<E._14I;P++){var A=e.get(P),m=I*P;if(un(A))T&&Tl(W,L,m,u,I,T),r=Ij(E.isExpanded(A)?E._expandIcon:E._collapseIcon),r&&ml(W,r,ci,0,m,L,I),W.save(),W.beginPath(),W.rect(L,m,u,I),W.clip(),E.drawCategoryName(W,A,P,L,m,u,I),W.restore();else{var j=A.property,b=A.data,r=Ij(j.getIcon()),h=E._selectRowIndex===P?E.getSelectBackground():i;if(r&&ml(W,r,ci,0,m,L,I),h&&Tl(W,L,m,u,I,h),W.save(),W.beginPath(),W.rect(L,m,v-L,I),W.clip(),E.drawPropertyName(W,j,P,L,m,v-L,I),W.restore(),!E.isEditing(b,j)){var N=v+1,V=R-v-1;W.save(),W.beginPath(),W.rect(N,m,V,I),W.clip(),E._87o(E.drawPropertyValue(W,j,E.getValue(b,j),P,N,m,V,I,b),P,N,m,V,I),W.restore()}}E._rowLineVisible&&Tl(W,L,m+I-1,u,1,E._rowLineColor)}E._columnLineVisible&&(Tl(W,v,0,1,l,E._columnLineColor),Tl(W,R-1,0,1,l)),E._92db(W),E._93I(),W.restore(),E.ty(E.ty())},drawCategoryName:function(y,k,A,j,D,J,M){Tq(y,k,this.getCategoryFont(k),this.getCategoryColor(k),j,D,J,M)},drawPropertyName:function(v,u,w,B,i,D,R){return u.drawPropertyName?(u.drawPropertyName(v,u,w,B,i,D,R,this),void 0):(Tq(v,this.getPropertyName(u),this.getPropertyFont(u,w),this.getPropertyColor(u,w),B,i,D,R),void 0)},drawPropertyValue:function(m,C,t,K,q,g,J,x,k){return C.drawPropertyValue?C.drawPropertyValue(m,C,t,K,q,g,J,x,k,this):(gn(m,t,C,this.getLabelFont(C,t,K),this.getLabelColor(C,t,K),q,g,J,x,k,this),void 0)},isPropertyEditable:function(p){return p.isEditable()&&this.isEditable()},setProperties:function(L){this._propertyModel.clear(),this.addProperties(L)},addProperties:function(g){if(g){var O=this._propertyModel;g.forEach(function(r){if(!(r instanceof Dm)){var f=yi(r.className);r=_b(f?f:Dm,r)}O.add(r)})}},getRowIndexAt:function(J){var A=this,V=O(A.lp(J).y/A._rowHeight);return V>=0&&V<A._rows.size()?V:-1},getPropertyAt:function(R){var d=this,J=d.getRowIndexAt(R);return J>=0?d._rows.get(J).property:i},getToolTip:function(m){var $=this,T=$.getPropertyAt(m),N=$._27o;return T&&N?T.getToolTip(N,$._9I<$.lp(m).x,$):i}});var gd=function(y){this.pv=y,this.addListeners()};Zi(gd,j,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(x){this.getView().style.cursor=x},clear:function(){var P=this;P._62O=P.cp=P.ty=P.p=i,P.setCursor(jp)},handle_mousedown:function(Y){this.handle_touchstart(Y)},handle_touchstart:function(J){var E=this,Q=E.pv;nl(J),Q.setFocus(J)&&(pn(J)?(E.cp=Mi(J),E.ty=Q.ty(),E.p=Q.getColumnPosition(),E.handle_touchmove(J)):Q.setSelectRowIndex(Q.getRowIndexAt(J)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(g){this.handle_touchend(g)},handle_touchend:function(M){var t=this;if(t.cp&&!t._62O){var R=t.pv,g=R.lp(M),U=g.x,j=g.y,r=R._indent,v=R.getRowIndexAt(M),p=R._9I;if(v>=0){var Z=R._rowHeight,L=Z*v,V=R._rows.get(v),H=V.property;if(un(V))Ij(R.isExpanded(V)?R._expandIcon:R._collapseIcon)&&U>=0&&r>=U&&j>=L&&L+Z>=j?R.toggle(V):Ae(M)&&R.toggle(V);else if(U>p&&R.isPropertyEditable(H,M)){var l={x:p+1,y:L,width:R.getWidth()-p-1,height:Z},E={x:l.x+R.tx(),y:l.y+R.ty(),width:l.width,height:l.height},o=0,N=R._29I;l.y<N.y?o=l.y-N.y:l.y+Z>N.y+N.height&&(o=l.y+Z-N.y-N.height),o&&(R.ty(R.ty()-o),E.y-=o),R.beginEditing({data:V.data,property:H,value:R.getValue(V.data,H),event:M,rect:l,editorRect:E,view:R})}}R.setSelectRowIndex(v)}t.clear()},handleWindowMouseMove:function(M){this.handleWindowTouchMove(M)},handleWindowTouchMove:function(g){var y=this,U=y.pv,p=y.ty,m=y.cp,T=Mi(g),f=y._62O;if("p"===f)U.setTranslateY(p+T.y-m.y);else if("c"===f){var W=U.getWidth()-U._indent;if(W>16){var b=y.p-(m.x-T.x)/W,O=16/W;O>b&&(b=O),b>1-O&&(b=1-O),U.setColumnPosition(b)}}else"s"===f&&U.setTranslateY(p+(m.y-T.y)*U._59I/U._29I.height)},handle_mousemove:function(K){this.handle_touchmove(K)},handle_touchmove:function(Q){if(!ij&&pn(Q)){var z=this,B=z.pv,b=R(B.lp(Q).x-B._9I)<=(Aj?8:3);z.cp?z._62O||(b?(z._62O="c",Vn(z)):R(Mi(Q).y-z.cp.y)>=2&&(z._62O=z.isV(Q)?"s":"p",Vn(z))):(b?z.setCursor(ko):z.setCursor(jp),z.isV(Q)&&B._43o())}},isV:function(O){var F=this.pv,i=F._29I;return F._41o()&&i.x+i.width-F.lp(O).x<Fd},handle_mousewheel:function(F){this.handleScroll(F,F.wheelDelta/40)},handle_DOMMouseScroll:function(V){2===V.axis&&this.handleScroll(V,-V.detail)},handleScroll:function(J,R){var l=this.pv;nl(J),l.endEditing(),l.translate(0,R*l.getRowHeight())},handle_keydown:function(C){var v=this.pv,f=v._rows.size(),t=v._selectRowIndex+(Ub(C)?-1:1);(Ub(C)||mh(C))&&(0>t&&(t=0),t>=f&&(t=f-1),v.setSelectRowIndex(t))}}),vq.ListView=function(B){this._5o(B),new Fo(this)},ef("ListView",j,{ms_ac:[je,vk,ni,hm,Dl,ee,Hn,Ki,Yq,om,Zj,cr,lh,te],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Wo,_rowHeight:yc,_rowLineVisible:z.listViewRowLineVisible,_rowLineColor:z.listViewRowLineColor,_scrollBarColor:Cl,_scrollBarSize:Bb,_autoMakeVisible:Ok,_autoHideScrollBar:rm,_selectBackground:z.listViewSelectBackground,_labelColor:z.listViewLabelColor,_labelSelectColor:z.listViewLabelSelectColor,_labelFont:z.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(j){var G=this,S=G._checkMode;G._checkMode=j,G.fp(mb,S,j)},drawRow:function(b,s,L,Y,A,B,$){var H=this,E=0,q=H._indent,r=H.getIconWidth(s);H.drawRowBackground(b,s,L,Y,A,B,$),H._checkMode&&(tp(b,Ij(H.getCheckIcon(s)),E+q/2,A+$/2,s,H),E+=q),H.drawIcon(b,s,E,A,r,$),H.drawLabel(b,s,E+r,A,$)}});var Fo=function(m){this.list=m,this._lastSelectDataTime=Ql(),this.addListeners()};
Zi(Fo,j,{ms_listener:1,getView:function(){return this.list._view},clear:function(p){var m=this,s=m.list;p&&"d"===m._62O&&!m.dragCancel&&s.handleDragAndDrop(p,"end"),s.draggingData&&(s.draggingData=null,s.redraw()),m.dragCancel=m._62O=m._isV=m._isH=m.cp=m.tx=m.ty=i},handle_mousedown:function(B){this.handle_touchstart(B)},handle_touchstart:function(R){var o=this,L=o.list;if(nl(R),L.setFocus(R)){var t=L.getDataAt(R);o.cp=Mi(R),o.tx=L.tx(),o.ty=L.ty(),pn(R)?t&&L.handleDragAndDrop&&!o.isV(R)&&!o.isH(R)&&(L.draggingData=t,L.redraw(),L.handleDragAndDrop(R,"prepare")):(t&&o._33o(R,t),o.clear(R))}},handleWindowMouseUp:function(e){this.clear(e)},handleWindowTouchEnd:function(I){this.clear(I)},handle_mouseup:function(X){this.handle_touchend(X)},handle_touchend:function(u){var R=this,l=R.list;if(!R._isV&&!R._isH&&R.cp&&!R._62O){var I=l.getDataAt(u);I?(l.isCheckMode()?R._34o(u,I):R._33o(u,I),Ae(u)?l.onDataDoubleClicked(I,u):l.onDataClicked(I,u)):l.handleBackgroundClick(u)}R.clear(u)},handleWindowMouseMove:function(L){this.handleWindowTouchMove(L)},handleWindowTouchMove:function(k){var i=this,D=i.list,y=i._62O,m=i.tx,Z=i.ty,J=i.cp,V=Mi(k),f=D._29I;"p"===y?D.setTranslate(m+V.x-J.x,Z+V.y-J.y):"v"===y?D.ty(Z+(J.y-V.y)*D._59I/f.height):"h"===y?D.tx(m+(J.x-V.x)*D._91I/f.width):"d"===y&&(i.dragCancel||D.handleDragAndDrop(k,"between"))},handle_mousemove:function(k){this.handle_touchmove(k)},handle_touchmove:function(I){if(!ij&&pn(I)){var C=this,V=C.list;if(C._isV=C.isV(I),C._isH=C.isH(I),C.cp){if(!C._62O){if(_m(Mi(I),C.cp)<2)return;C._isV?C._62O="v":C._isH?C._62O="h":V.draggingData&&!this.dragCancel?(C._62O="d",V.handleDragAndDrop(I,"begin")):C._62O="p",C._62O&&"d"!==C._62O&&V.draggingData&&(V.draggingData=null,V.redraw()),Vn(C)}}else C._isV&&V._43o(),C._isH&&V._42o()}},isV:function(R){var w=this.list,g=w._29I;return w._41o()&&g.x+g.width-w.lp(R).x<Fd},isH:function(R){var n=this.list,p=n._29I;return n._40o()&&p.y+p.height-n.lp(R).y<Fd},handle_mousewheel:function(j){this.handleScroll(j,j.wheelDelta/40,j.wheelDelta!==j.wheelDeltaX)},handle_DOMMouseScroll:function($){this.handleScroll($,-$.detail,1)},handleScroll:function(K,N,V){var y=this.list;nl(K),y.endEditing&&y.endEditing(),V&&y._41o()?y.translate(0,N*y.getRowHeight()):y._40o()&&y.translate(10*N,0)},handle_keydown:function(t){if(!z.isInput(t.target)){var Z,_=this.list,p=_.sm(),v=_._rows,m=v.size();if(Pc(t))_.selectAll();else if(ei(t))_.handleDelete&&_.handleDelete(t);else if(Wi(t))"d"!==this._62O||this.dragCancel||(_.handleDragAndDrop(t,"cancel"),this.dragCancel=!0);else if(Sd(t))_.isCheckMode()&&(Z=_.getFocusData(),Z&&_.checkData(Z));else if(Ub(t)||mh(t)){var D=_.isCheckMode();if(Z=D?_.getFocusData():p.ld()){var g=_.getRowIndex(Z);g>=0&&(Ub(t)?0!==g&&(Z=v.get(g-1),D?_.setFocusData(Z):p.ss(Z)):g!==m-1&&(Z=v.get(g+1),D?_.setFocusData(Z):p.ss(Z)))}else m>0&&(Z=v.get(0),D?_.setFocusData(Z):p.ss(Z))}}},_34o:function(Y,m){var p=this.list,y=p.lp(Y).x;return y>=0&&y<=p._indent?(p.checkData(m),void 0):(p.setFocusData(m),void 0)},_33o:function(j,_){var K=this.list,g=K.sm(),E=g.ld();if(Th(j))K.isSelected(_)?g.rs(_):g.as(_);else if(Kq(j))if(E)for(var U=K.getRowIndex(E),z=K.getRowIndex(_);U!==z;)U+=z>U?1:-1,g.as(K._rows.get(U));else g.ss(_);else if(pn(j)){var M=Ql();if(g.contains(_)){var n=M-this._lastSelectDataTime;K.handleDataDoubleSelect&&n>500&&1500>n&&K.handleDataDoubleSelect(j,_)}g.ss(_),this._lastSelectDataTime=M}else g.contains(_)||g.ss(_)}}),vq.TreeView=function(p){var f=this;f._35o(),f._5o(p),new ab(f)},ef("TreeView",j,{ms_ac:[je,vk,ni,"rootVisible",mb,"rootData",Ki,Yq,om,Zj,cr,Dl,hm,ee,Hn,jb,sn,lh,te,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:i,_indent:Wo,_rowHeight:yc,_rowLineVisible:z.treeViewRowLineVisible,_rowLineColor:z.treeViewRowLineColor,_scrollBarColor:Cl,_scrollBarSize:Bb,_autoHideScrollBar:rm,_expandIcon:z.treeViewExpandIcon,_collapseIcon:z.treeViewCollapseIcon,_autoMakeVisible:Ok,_selectBackground:z.treeViewSelectBackground,_labelColor:z.treeViewLabelColor,_labelSelectColor:z.treeViewLabelSelectColor,_labelFont:z.treeViewLabelFont,_doubleClickToToggle:z.treeViewDoubleClickToToggle,drawRow:function(H,K,S,g,M,r,t){var x=this;x.drawRowBackground(H,K,S,g,M,r,t),x._97I(H,K,S,0,M,r,t)},isOnToggleIcon:function(p){var N=this.getDataAt(p);if(N){var b=this.getIndent(),W=this.lp(p).x;if(Ij(this.getToggleIcon(N))){var s=b*this.getLevel(N);if(W>=s&&s+b>=W)return!0}}return!1}});var ab=function(d){Kh(ab,this,[d])};Zi(ab,Fo,{toggle:function(K,c,B,E){var Y=this.list,h=Y.lp(K).x;if(Ij(Y.getToggleIcon(c))){var F=B*E;if(h>=F&&F+B>=h)return Y.toggle(c),!0}return Y.isDoubleClickToToggle()&&Ae(K)?(Y.toggle(c),!0):!1},_34o:function(x,O){var J=this.list,V=J.lp(x).x,r=J._levelMap[O._id],y=J._indent,v=y*(r+1);return V>=v&&v+y>=V?(J.checkData(O),void 0):(this.toggle(x,O,y,r)||J.setFocusData(O),void 0)},_33o:function(e,B){var r=this,K=r.list;if(!r.toggle(e,B,K._indent,K.getLevel(B)))if(Kq(e)){var C=K.sm();if(C.size()>0){for(var S=K._rows,I=null,M=0,s=S.size();s>M;M++)if(K.isSelected(S.get(M))){I=M;break}for(var X=null,M=S.size()-1;M>=0;M--)if(K.isSelected(S.get(M))){X=M;break}var g,w,O=K.getRowIndex(B);for(I>O?(g=O-1,w=I):O>X?(g=X,w=O):(g=I,w=X);g!==w;)g++,C.as(K._rows.get(g))}else C.ss(B)}else ab.superClass._33o.call(r,e,B)},handle_keydown:function(u){if(_r(u)||im(u)){var f=this.list,L=f._rows,i=f.isCheckMode(),W=f.sm(),S=i?f.getFocusData():W.ld();S?S.hasChildren()&&(_r(u)?f.collapse(S):f.expand(S)):L.size()>0&&(S=L.get(0),i?f.setFocusData(S):W.ss(S))}else ab.superClass.handle_keydown.call(this,u)}});var Ol=vq.TableView=function(p){this._98I(),this._5o(p),new Ee(this)};ef("TableView",j,{ms_ac:[je,vk,ni,"sortMode",Qj,Si,hm,ee,Hn,Hm,_d,"sortColumn",Ki,Yq,om,Zj,cr,lh,te],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:ho,_editable:!0,_batchEditable:!1,_rowHeight:yc,_rowLineVisible:z.tableViewRowLineVisible,_rowLineColor:z.tableViewRowLineColor,_columnLineVisible:z.tableViewColumnLineVisible,_columnLineColor:z.tableViewColumnLineColor,_scrollBarColor:Cl,_scrollBarSize:Bb,_autoHideScrollBar:rm,_autoMakeVisible:Ok,_selectBackground:z.tableViewSelectBackground,_labelColor:z.tableViewLabelColor,_labelSelectColor:z.tableViewLabelSelectColor,_labelFont:z.tableViewLabelFont,getCheckColumn:function(){var D=this;if(!D._31o){var n=D._31o=new bk;n.setEditable(!0),n.setWidth(40),n.getValue=D.getCheckColumValue,n.drawCell=D.drawCheckColumnCell}return D._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(n){var e=this,k=e._39o,$=e.getCheckColumn();n!==e.isCheckMode()&&(n?k.add($,0):k.remove($),e.fp(mb,!n,n))},getCheckColumValue:function(e,n,w){return w.isSelected(e)},drawCheckColumnCell:function(Y,r,V,X,v,M,n,C,Q){tp(Y,Q.getCheckIcon(r),v+n/2,M+C/2,r,Q)}});var Ee=function(o){Kh(Ee,this,[o])};Zi(Ee,Fo,{_34o:function(z,F){var f=this.list,k=f._31o;if(f.isCellEditable(F,k,z)){var C=f._3Q(k),l=f.lp(z).x;if(C&&l>=C.startX&&l<C.startX+k.getWidth())return f.checkData(F),void 0}f._37O(F,z),f.setFocusData(F)},_33o:function(m,X){this.list._37O(X,m),Ee.superClass._33o.apply(this,arguments)}});var mi=vq.TreeTableView=function(H){var D=this,x=D._4o=new bk;D._35o(),D._98I(),D._5o(H),x.setDisplayName("Name"),x.setEditable(!0),x.setWidth(180),x.drawCell=fq,x.getValue=Kp,D._39o.add(x),new bq(D)},fq=function(d,o,V,N,F,W,P,y,h){h._97I(d,o,V,F,W,P,y)},Kp=function(F,m,U){return U.getLabel(F)};ef("TreeTableView",j,{ms_ac:[je,vk,ni,"sortMode",Qj,Si,Dl,mb,"rootData","rootVisible",Ki,Yq,"sortColumn",jb,sn,om,Zj,cr,lh,Hn,hm,ee,Hm,_d,te,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:ho,_checkMode:i,_editable:!0,_batchEditable:!1,_indent:Wo,_rowHeight:yc,_rowLineVisible:z.treeTableViewRowLineVisible,_rowLineColor:z.treeTableViewRowLineColor,_columnLineVisible:z.treeTableViewColumnLineVisible,_columnLineColor:z.treeTableViewColumnLineColor,_expandIcon:z.treeTableViewExpandIcon,_collapseIcon:z.treeTableViewCollapseIcon,_scrollBarColor:Cl,_scrollBarSize:Bb,_autoHideScrollBar:rm,_autoMakeVisible:Ok,_selectBackground:z.treeTableViewSelectBackground,_labelColor:z.treeTableViewLabelColor,_labelSelectColor:z.treeTableViewLabelSelectColor,_labelFont:z.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var bq=function(q){Kh(bq,this,[q])};Zi(bq,Fo,{_34o:function(g,C){var F=this.list,E=F._4o,f=F._3Q(E),v=F.lp(g).x;if(f){var w=F._indent,y=f.startX+w*F.getLevel(C);if(Ij(F.getToggleIcon(C))&&v>=y&&y+w>=v)return F.toggle(C),void 0;if(F.isCellEditable(C,E)&&(y+=w,v>=y&&y+w>=v))return F.checkData(C),void 0}F._37O(C,g),F.setFocusData(C)},_33o:function(k,q){var Q=this.list,I=Q.lp(k).x;if(Ij(Q.getToggleIcon(q))){var n=Q._3Q(Q._4o);if(n){var d=Q._indent,J=n.startX+d*Q.getLevel(q);if(I>=J&&J+d>=I)return Q.toggle(q),void 0}}Q._37O(q,k),bq.superClass._33o.apply(this,arguments)}});var Ve=vq.TableHeader=function(j){var b=this,D=b._view=bd(1,b),V=b._39o=j.getColumnModel(),f=b.iv;b.tv=b._tableView=j,b._60I=new Yi,b._canvas=Uh(D),D.style.background=z.tableHeaderBackground||"",D.style.height=fg+De,V.mm(f,b),V.md(f,b),V.mh(f,b),j.mp(function($){Ef[$.property]&&b.iv()},b),new Zc(b),b.iv()};ef("TableHeader",j,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",je,ni,Dl,"moveBackground","insertColor",Hm,_d,"resizable","movable"],_checkIcon:Ic,_movable:!0,_resizable:!0,_labelColor:z.tableHeaderLabelColor,_labelFont:z.tableHeaderLabelFont,_columnLineColor:z.tableHeaderColumnLineColor,_columnLineVisible:z.tableHeaderColumnLineVisible,_sortDescIcon:z.tableHeaderSortDescIcon,_sortAscIcon:z.tableHeaderSortAscIcon,_moveBackground:z.tableHeaderMoveBackground,_insertColor:z.tableHeaderInsertColor,_indent:Wo,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(A){return A.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(E){return E.getColor()||this._labelColor},getLabelAlign:function(P){return P._align},onPropertyChanged:function(){this.iv()},_5Q:function(H){this._61I=H,this.iv()},getLogicalPoint:function(E){return Eg(E,this._canvas,this.tv.tx())},validateImpl:function(){var B=this,w=B._canvas,U=B.getWidth(),y=B.getHeight(),A=B.tv,J=B._60I,W=B._61I,k=-A.tx(),T=0;(U!==w.clientWidth||y!==w.clientHeight)&&Tj(w,U,y),J.clear(),B._39o._roots.each(function(v){if(v.isVisible()){var E=T+v.getWidth();k+U>=T&&E>=k&&J.add({column:v,startX:T}),T=E}});var i=Xc(w);if(kb(i,-k,0,1),i.beginPath(),i.rect(k,0,U,y),i.clip(),i.clearRect(k,0,U,y),J.each(function(b){var v=b.column,N=b.startX,S=v.getWidth();S>0&&(i.save(),i.beginPath(),i.rect(N,0,S,y),i.clip(),W&&W.column===v||B.drawColumn(i,v,N,0,S,y),B._columnLineVisible&&Tl(i,N+S-1,0,1,y,B._columnLineColor),i.restore())}),W){var Z=W.column,T=W.startX,p=W.position,j=Z.getWidth();i.save(),i.beginPath(),i.rect(T,0,j,y),i.clip(),i.fillStyle=B._moveBackground,i.fill(),B.drawColumn(i,Z,T,0,j,y),i.restore(),$d(i,B._insertColor,p,0,y)}i.restore()},_6Q:function(Y){var w=this.tv;return w._31o===Y&&w.sm().getSelectionMode()===rl},drawColumn:function(E,x,o,Z,b,I){var R=this,j=R.tv,h=Ij(x.getIcon()),v=R.getLabelAlign(x);if(R._6Q(x)){var r=Ij(R._checkIcon);tp(E,r,o+b/2,Z+I/2,x,R)}else{var $=R.getLabel(x),Q=R.getLabelFont(x),F=R.getLabelColor(x),U=td(Q,$).width,u=h?R._indent:0;v===br?(h&&ml(E,h,ci,o,Z,u,I),Tq(E,$,Q,F,o+u,Z,b,I,br)):v===lk?(h&&ml(E,h,ci,o+b-U-u,Z,u,I),Tq(E,$,Q,F,o,Z,b,I,lk)):(h&&ml(E,h,ci,o+(b-U-u)/2,Z,u,I),Tq(E,$,Q,F,o+(b-U+u)/2,Z,0,I,br))}if(x.isSortable()&&j.getSortColumn()===x&&(h=Ij(x.getSortOrder()===hd?R._sortAscIcon:R._sortDescIcon))){var P=gq(h,x)/2+2;tp(E,h,v===lk?o+P:o+b-P,Z+I/2,x,j)}}});var Zc=function(b){var q=this;q.th=b,q.tv=b._tableView,q.addListeners()};Zi(Zc,j,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(l){this.getView().style.cursor=l},handle_mousemove:function(q){if(!ij){var I=this;delete I._29o,I.setCursor(jp);for(var V=I.th,g=V._60I,T=V.lp(q).x,f=g.size()-1;f>=0;f--){var $=g.get(f),_=$.column,o=$.startX+_.getWidth();if(V.isResizable()&&R(o-T)<=(Aj?10:3))return I._29o=$,I.setCursor(ko),void 0;T>$.startX&&o>T&&(I._29o=$),(_.isClickable()||_.isSortable()||V.isMovable()||I.tv.getCheckColumn&&_===I.tv.getCheckColumn())&&T>$.startX&&o>T&&I.setCursor(zc)}}},handle_mousedown:function(C){this.handle_touchstart(C)},handle_touchstart:function(j){var B=this;nl(j),B.tv.endEditing(),B.handle_mousemove(j),B._29o&&(B.x=Mi(j).x,B.lx=B.th.lp(j).x,B.w=B._29o.column.getWidth(),Vn(B,j))},handleWindowMouseMove:function(Y){this.handleWindowTouchMove(Y)},handleWindowTouchMove:function(T){var V=this,b=V.th,Y=V.getView().style.cursor,M=V._29o,X=Mi(T).x-V.x;if(V.resizing||V.moving||(Y===ko?V.resizing=1:b.isMovable()&&Y===zc&&R(X)>2&&(V.moving=1)),V.resizing)M.column.setWidth(V.w+X);else if(V.moving){var G=V.lx+X;b._60I.each(function(O){var p=O.startX,J=p+O.column.getWidth();if(G>=p&&J>=G){var n={column:M.column,startX:M.startX+X,front:J-G>G-p,insertColumn:O.column};n.position=n.front?p:J,b._5Q(n)}})}},_16Q:function(O,R){var b=this,q=b.tv,B=b.th,u=B._checkIcon;if(B._6Q(O)){var I=Ij(u),U=b.lx,P=O.getWidth(),l=gq(I,O);if(U>=R+P/2-l&&R+P/2+l>=U){B.setCheckIcon(u===vg?Ic:vg);var Q=q.sm(),J=q._rows;return u===vg?Q.rs(J):Q.ss(J),q.onCheckColumnClicked(O),!0}}return!1},handleWindowMouseUp:function(Y){this.handleWindowTouchEnd(Y)},handleWindowTouchEnd:function(z){var G=this,l=G.tv,E=G.th,V=G._29o;if(G.moving){var O=E._61I;if(O&&O.insertColumn!==O.column){var U=O.column,J=l.getColumnModel()._roots,x=J.remove(U),q=J.indexOf(O.insertColumn);q>=0&&(O.front||q++,q<=J.size()&&(J.add(U,q),l.getColumnModel()._38I(U,x,q)))}E._5Q(i),delete G.moving}else if(!G.resizing&&V){U=V.column;var u=E.lp(z).x,o=V.startX,b=!0;if(E.onColumnClicked){var T=E.onColumnClicked(U,z,o);T===!1&&(b=!1)}if(b&&u>=o&&u<=o+U.getWidth()&&!G._16Q(U,o)){if(U.isSortable()){var D=l.getSortMode(),W=U.getSortOrder();D===ho?l.getSortColumn()===U?(W===$h&&l.setSortColumn(i),U.setSortOrder(W===hd?$h:hd)):l.setSortColumn(U):"bistate"===D&&(l.getSortColumn()===U?U.setSortOrder(W===hd?$h:hd):l.setSortColumn(U))}l.onColumnClicked(U,z,o)}}G._29o=G.resizing=G.x=G.lx=G.w=i}}),vq.TablePane=function(U){this.init(new Ol(U))},ef("TablePane",j,{ms_v:1,_44o:1}),vq.TreeTablePane=function(D){this.init(new mi(D))},ef("TreeTablePane",j,{ms_v:1,_44o:1}),vq.Toolbar=function(c){var E=this,f=E._view=bd(1,E),a=f.style;a.background=z.toolbarBackground||"",a.height=Qp+De,E._canvas=Uh(f),E._30o=new Yi,E._90I=new Yi,E.setItems(c||[]),f.handleGroupSelectedChanged=function(t){if(t.isSelected()){var V=t.getGroupId();null!=V&&E._items.forEach(function(u){var c=u.element;c&&c!==t&&c.setSelected&&c.getGroupId&&c.getGroupId()===V&&c.setSelected(!1)})}},new Ie(E)},ef("Toolbar",j,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[bb,je,ni,vk,te,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:z.toolbarLabelColor,_labelSelectColor:z.toolbarLabelSelectColor,_labelFont:z.toolbarLabelFont,_selectBackground:z.toolbarSelectBackground,_itemGap:z.toolbarItemGap,_separatorColor:z.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(V){var m=this.getItemInfoAt(V);return m?m.item.toolTip:i},getLabelColor:function(H){return H&&H.selected&&H.type!==vg&&H.type!==Qg?this._labelSelectColor:this._labelColor},onPropertyChanged:function(y){this.iv(),y.property===bb&&this._items.forEach(function(O){Rb(O)})},redraw:function(){this.iv()},addItem:function(r,$){var l=this._items;$==i?l.push(r):l.splice($,0,r),this.fp(bb,i,l)},removeItem:function(x){if(x)for(var M=this._items,Y=0;Y<M.length;Y++)x===M[Y]&&(M.splice(Y,1),this.fp(bb,i,M))},removeItemById:function(M){if(M!=i)for(var A=this._items,K=0;K<A.length;K++)if(M===A[K].id){var l=A.splice(K,1)[0];return this.fp(bb,i,A),l}},getItemById:function(I){if(I!=i)for(var F=this._items,l=0;l<F.length;l++){var O=F[l];if(I===O.id)return O}},setItemVisible:function(V,C){var t=this.getItemById(V);t&&(t.visible=C)},getItemInfos:function(){return this._30o},getItemInfoAt:function(O){var d=this,T=0,F=d._30o,R=d.lp(O),j=R.x,_=R.y;if(_>=0&&_<=d.getHeight())for(;T<F.size();T++){var n=F.get(T);if(n.startX<=j&&j<=n.endX)return n}return i},drawItem:function($,j,v,H,R){if(j.visible===!1)return 0;if(Nf(j.visible)&&!j.visible())return 0;var m=this,D=j.disabled;D&&($.globalAlpha=sb);var i=m.drawItemImpl($,j,v,H,R),J=m._itemGap;return D&&($.globalAlpha=1),this._currentItem!==j||"separator"===j||j.separator===!0||j.unfocusable||Yn($,m._separatorColor,v-J/2,0,i+J,H),i},drawItemImpl:function(Y,R,C,S,M){var Q=this,p=Q._view,N=Q._itemGap,x=S/2,V=R.type,s=R.element,O=R.label;un(s)&&(O=s,s=i);var q,b=Q.getLabelFont(R),k=Q.getLabelColor(R),u=R.selected,J=Ij(R.icon),P=gq(J,R),c=0,d=P+(O?td(b,O).width:0);if("separator"===R||R.separator===!0)return $d(Y,Q._separatorColor,C,S/4,x),1;if(s){J&&tp(Y,J,C+P/2,x,R,Q),Tq(Y,O,b,k,C+P,0,0,S);var I=Lq(s);M||Q._90I.add(I),I.parentNode!==p&&pi(p,I),s.iv&&s.iv(),s.validate&&s.validate();var D=I.getBoundingClientRect(),n=D.width,e=I.style;return Wm(I),e.left=Q.tx()+C+d+De,e.top=(S-D.height)/2+De,d+n}return V===Qg?q=Ij(u?Bd:Gf):V===vg&&(q=Ij(u?vg:Ic)),q?(c=gq(q,R),tp(Y,q,C+c/2,x,R,Q),C+=c,d+=c):u&&Tl(Y,C-N/2,0,d+N,S,Q.getSelectBackground(R)),J&&tp(Y,J,C+P/2,x,R,Q),Tq(Y,O,b,k,C+P,0,0,S),d},validateImpl:function(){var v=this,A=v._canvas,s=v.getWidth(),O=v.getHeight(),U=v._30o,M=v._items;Tj(A,s,O);var z=Xc(A),G=v._itemGap,w=G/2;kb(z,v.tx(),0,1),z.clearRect(0,0,s,O);var h=v._90I;v._90I=new Yi,U.clear(),M.forEach(function(Q){var y=v.drawItem(z,Q,w,O);U.add({item:Q,startX:w,endX:w+y,width:y}),y&&(w+=y+G)}),h.each(function(C){v._90I.contains(C)||As(C)});var b=v._64I;v._64I=$(0,w),z.restore(),v._stickToRight?(v._65O=0,z=Xc(A),w=s-v._64I+G,kb(z,0,0,1),z.clearRect(0,0,s,O),U.clear(),M.forEach(function(s){var J=v.drawItem(z,s,w,O,!0);U.add({item:s,startX:w,endX:w+J,width:J}),J&&(w+=J+G)}),z.restore()):v.tx(v.tx()),b!==v._64I&&v.onSumWidthChanged(b,v._64I)},onSumWidthChanged:function(){},handleClick:function($,L){var K=this,E=$.type,o=$.action,b=$.groupId,p=$.selected;$.disabled||(b!=i?p||($.selected=!0,this._items.forEach(function(E){E.groupId===b&&$!==E&&(E.selected=!1)}),o&&$.action($,K,L)):E===vg||"toggle"===E?($.selected=!p,o&&$.action($,K,L)):o&&$.action($,K,L)),Ui(),K.iv()}});var Ie=function(k){this.tb=k,this.addListeners()};Zi(Ie,j,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(C){this.handleScroll(C,10*(C.wheelDelta/40))},handle_DOMMouseScroll:function(y){this.handleScroll(y,10*-y.detail)},handleScroll:function(E,$){nl(E);var V=this.tb;V.isScrollable()&&!V._stickToRight&&(V.tx(V.tx()+$),Ld())},handle_mousemove:function(o){var N=this;ij||N.setItem(o)},handle_mouseout:function(X){var C=this;X.target===C.getView()?C.tb.setCurrentItem(i):C.handle_mousemove(X)},handle_mousedown:function(Q){this.handle_mousemove(Q),this.handle_touchstart(Q)},handle_touchstart:function(U){var j=this,k=j.tb,G=U.target;pn(U)&&(G===j.getView()||G===k._canvas)&&(nl(U),k.setFocus(U)&&(this.setItem(U,!0),(k.isScrollable()||j.info&&!j.info.item.disabled)&&(j.x=Mi(U).x,j.tx=k.tx(),Vn(j,U))))},handleWindowMouseMove:function(y){this.handleWindowTouchMove(y)},handleWindowTouchMove:function(X){var S=this,M=S.tb;if(!M._stickToRight){var n=Mi(X).x-S.x;!S._25o&&R(n)>2&&M.isScrollable()&&(S._25o=1),S._25o&&M.tx(S.tx+n)}},handleWindowMouseUp:function(f){this.handleWindowTouchEnd(f)},handleWindowTouchEnd:function(J){var y=this,O=y.tb,U=y.info,A=y.tb.getItemInfoAt(J);if(!y._25o&&U){var w=U.item;A&&A.item===w&&O.handleClick(w,J)}y._25o=y.x=y.tx=i,y.setItem()},setItem:function(g,n){var x=this,f=x.tb,b=x.info=g?f.getItemInfoAt(g):i,m=b?b.item:i;f.setCurrentItem(m),n&&m&&Nf(m.onDown)&&m.onDown(g)}}),vq.BorderPane=function(){this._view=bd(1,this),this.iv()},ef("BorderPane",j,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(Q,p){this._12o("leftView",Q),p!=i&&this.setLeftWidth(p)},getRightView:function(){return this._rightView},setRightView:function(L,X){this._12o("rightView",L),X!=i&&this.setRightWidth(X)},getTopView:function(){return this._topView},setTopView:function(w,V){this._12o("topView",w),V!=i&&this.setTopHeight(V)},getBottomView:function(){return this._bottomView},setBottomView:function(v,y){this._12o("bottomView",v),y!=i&&this.setBottomHeight(y)},getCenterView:function(){return this._centerView},setCenterView:function(R){this._12o("centerView",R)},_12o:function(e,B){var v=this,E="_"+e,m=v._view,G=v[E];G!==B&&(G&&(G.getView?As(G.getView()):As(G)),v[E]=B,B&&(B.getView?pi(m,B.getView(),1):pi(m,B,1)),v.fp(e,G,B))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var n=this,S=n._topView,g=n._bottomView,J=n._leftView,D=n._rightView,v=n._centerView,w=n.getWidth(),f=n.getHeight(),B=0,U=0,R=w,A=f,X=0,E=0,a=0,m=0;S&&(X=n._topHeight==i?fb(S):n._topHeight,U=X),g&&(E=n._bottomHeight==i?fb(g):n._bottomHeight,A=f-E),J&&(a=n._leftWidth==i?Qe(J):n._leftWidth,B=a),D&&(m=n._rightWidth==i?Qe(D):n._rightWidth,R=w-m);var c=$(0,R-B),T=$(0,A-U);S&&Kn(S,0,0,w,X),g&&Kn(g,0,A,w,E),J&&Kn(J,0,U,a,T),D&&Kn(D,R,U,m,T),v&&Kn(v,B,U,c,T)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);